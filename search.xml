<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è£…é¥°è€…æ¨¡å¼</title>
      <link href="/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è£…é¥°è€…æ¨¡å¼Overview"><a href="#1-è£…é¥°è€…æ¨¡å¼Overview" class="headerlink" title="1. è£…é¥°è€…æ¨¡å¼Overview"></a>1. è£…é¥°è€…æ¨¡å¼Overview</h1><ul><li>Attach additional responsibilities to an object <strong>dynamically</strong>. Decorator provides a flexible alternative to subclassing for extending functionality.<ul><li>inheriting behavior at runtime through composition and delegation</li><li>open for extension but close for modification</li><li>decorator has the same super type as the objects they decorate</li><li>we could use one or more decorators to wrap an object</li><li>the decorator <strong>adds its own behavior</strong> before and/or after delegating to the object it decorates to do the rest of the job</li></ul></li></ul><h1 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2. ä½¿ç”¨åœºæ™¯"></a>2. ä½¿ç”¨åœºæ™¯</h1><ul><li>when we want to give some other responsibility at run time</li><li>kind of like continue to wrap the intrinsic object with some new responsibility, still an is-a relationship</li></ul><h1 id="3-ä½¿ç”¨ç›®çš„"><a href="#3-ä½¿ç”¨ç›®çš„" class="headerlink" title="3. ä½¿ç”¨ç›®çš„"></a>3. ä½¿ç”¨ç›®çš„</h1><ul><li>Extends the class at run time instead of compile time</li><li>To give objects some new responsibilities without making any code changes to the underlying classes</li><li>pitfall<ul><li>sometimes it could lead to a lot of new classes</li></ul></li></ul><h1 id="4-å…·ä½“å®ç°"><a href="#4-å…·ä½“å®ç°" class="headerlink" title="4. å…·ä½“å®ç°"></a>4. å…·ä½“å®ç°</h1><ul><li><p>One highlight</p><ul><li><p>the condimentDecorator is a beverage, and also need to has a beverage</p></li><li><p>we are using inheritance to achieve the type matching, but we arenâ€™t using inheritance to get behavior</p><p><img src="https://s2.loli.net/2022/09/19/YshIa9SnT65NH17.png" alt="Class Diagram"></p></li></ul></li></ul><h2 id="4-1-æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰"><a href="#4-1-æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰" class="headerlink" title="4.1 æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰"></a>4.1 æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰</h2><pre><code class="java">public abstract class Beverage &#123;    String description = &quot;Unknown Beverage&quot;;    public abstract double cost();    public String getDescription() &#123;        return description;    &#125;&#125;public abstract class CondimentDecorator extends Beverage&#123;    Beverage beverage;    public abstract String getDescription();&#125;</code></pre><h2 id="4-2-å…·ä½“å®ç°ç±»çš„å®šä¹‰"><a href="#4-2-å…·ä½“å®ç°ç±»çš„å®šä¹‰" class="headerlink" title="4.2 å…·ä½“å®ç°ç±»çš„å®šä¹‰"></a>4.2 å…·ä½“å®ç°ç±»çš„å®šä¹‰</h2><pre><code class="java">public class DecafCoffee extends Beverage &#123;    @Override    public double cost() &#123;        return 2.5f;    &#125;    String description() &#123;        return &quot;Decat coffee&quot;;    &#125;&#125;public class Espresso extends Beverage&#123;    public Espresso() &#123;        description = &quot;Espresso&quot;;    &#125;    @Override    public double cost() &#123;        return 4;    &#125;&#125;public class HouseBlend extends Beverage&#123;    public HouseBlend() &#123;        description = &quot;House Blend Coffee&quot;;    &#125;    @Override    public double cost() &#123;        return 0.99;    &#125;&#125;public class MilkDecorator extends CondimentDecorator&#123;    public MilkDecorator(Beverage beverage) &#123;        this.beverage = beverage;    &#125;    @Override    public double cost() &#123;        return beverage.cost() + 0.8;    &#125;    @Override    public String getDescription() &#123;        return beverage.getDescription() + &quot;with milk&quot;;    &#125;&#125;public class MochaDecorator extends CondimentDecorator&#123;    public MochaDecorator(Beverage beverage) &#123;        this.beverage = beverage;    &#125;    @Override    public double cost() &#123;        return beverage.cost() + 0.5;    &#125;    @Override    public String getDescription() &#123;        return beverage.getDescription() + &quot;with Mocha&quot;;    &#125;&#125;</code></pre><h2 id="4-3-æµ‹è¯•"><a href="#4-3-æµ‹è¯•" class="headerlink" title="4.3 æµ‹è¯•"></a>4.3 æµ‹è¯•</h2><pre><code class="java">@GetMapping(&quot;/decorator&quot;)    public String decorator() &#123;        Beverage decafCoffee = new DecafCoffee();        log.info(&quot;before decoration&quot; + decafCoffee.cost());        Beverage decafWithMocha = new MochaDecorator(decafCoffee);        log.info(&quot;after decoration&quot; + decafWithMocha.cost());        log.info(&quot;after decoration 2&quot; + new MochaDecorator(new MochaDecorator(decafCoffee)).cost());        return &quot;check the log&quot;;    &#125;</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://learning.oreilly.com/library/view/head-first-design/9781492077992/ch02.html">https://learning.oreilly.com/library/view/head-first-design/9781492077992/ch02.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Design Pattern </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è§‚å¯Ÿè€…æ¨¡å¼å®ç°</title>
      <link href="/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F-1/"/>
      <url>/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F-1/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è§‚å¯Ÿè€…æ¨¡å¼Overview"><a href="#1-è§‚å¯Ÿè€…æ¨¡å¼Overview" class="headerlink" title="1. è§‚å¯Ÿè€…æ¨¡å¼Overview"></a>1. è§‚å¯Ÿè€…æ¨¡å¼Overview</h1><ul><li>å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„äº¤äº’æ–¹å¼ï¼Œå¯ä»¥è¢«è§‚å¯Ÿçš„å¯¹è±¡å¯ä»¥é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ä»–ä»¬æœŸå¾…çš„å¯¹è±¡çš„å˜åŒ–ï¼ŒPull vs Push.<ul><li>å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€çš„æ—¶å€™ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶ä¸”ä¼šè‡ªåŠ¨æ›´æ–°</li></ul></li><li>Subject/ Observable<ul><li>ç®¡ç†æŸäº›æ•°æ®</li><li>å½“æ•°æ®æ”¹å˜çš„æ—¶å€™ï¼Œé€šçŸ¥è®¢é˜…è€…</li></ul></li><li>Observer<ul><li>åœ¨è®¢é˜…çš„æ•°æ®å‘ç”Ÿæ”¹å˜äº†ä»¥åï¼Œå¾—åˆ°é€šçŸ¥</li></ul></li></ul><h1 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2. ä½¿ç”¨åœºæ™¯"></a>2. ä½¿ç”¨åœºæ™¯</h1><ul><li>å‡ºç‰ˆè€… + è®¢é˜…è€…</li><li>Check Java Observable, though deprecated</li></ul><h1 id="3-ä½¿ç”¨ç›®çš„"><a href="#3-ä½¿ç”¨ç›®çš„" class="headerlink" title="3. ä½¿ç”¨ç›®çš„"></a>3. ä½¿ç”¨ç›®çš„</h1><ul><li>è´£ä»»çš„åˆ†å¼€ï¼Œåªæœ‰ä¸€ä»½æ•°æ®ï¼Œç”±Observableæ¥è¿›è¡Œç®¡ç†ï¼Œ</li><li>Observeråªæ˜¯æ‹¿åˆ°äº†æ•°æ®çš„æ›´æ–°ï¼Œç„¶ååšè‡ªå·±ç‰¹å®šçš„äº‹æƒ…ï¼Œobservableå®Œå…¨ä¸éœ€è¦çŸ¥é“è¿™é‡Œçš„ç»†èŠ‚ã€‚ç”¨è¿™ç§æ–¹å¼å®ç°äº†äº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆ</li></ul><h1 id="4-å…·ä½“å®ç°"><a href="#4-å…·ä½“å®ç°" class="headerlink" title="4. å…·ä½“å®ç°"></a>4. å…·ä½“å®ç°</h1><p><img src="https://s2.loli.net/2022/09/17/pSb5gUW3ynxAroB.png" alt="Class Diagram"></p><h2 id="4-1-æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰"><a href="#4-1-æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰" class="headerlink" title="4.1 æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰"></a>4.1 æ¥å£å’Œæ•°æ®å¯¹è±¡å®šä¹‰</h2><pre><code class="java">/** * Observer other abilities */public interface IDisplay &#123;    void display();&#125;/*** Observable interface, used to register/remove/notify observers */public interface IObservable &#123;    ActionResult registerObserver(IObserver observer);    ActionResult removeObserver(IObserver observer);    void notifyObservers();&#125;/** * Observable will call update method for regiestered observer to update the status in observer side */public interface IObserver &#123;    void update(SharebleData data);@Data@RequiredArgsConstructor@AllArgsConstructorpublic class SharebleData &#123;    Double temperature;    Double humidity;    Double pressure;&#125;public enum Status &#123;    SUCCESS,    FAILURE&#125;@Data@AllArgsConstructorpublic class ActionResult &#123;    @NonNull    Status status;    @Nullable    List&lt;String&gt; errorReason;&#125;</code></pre><h2 id="4-2-å…·ä½“å®ç°ç±»çš„å®šä¹‰"><a href="#4-2-å…·ä½“å®ç°ç±»çš„å®šä¹‰" class="headerlink" title="4.2 å…·ä½“å®ç°ç±»çš„å®šä¹‰"></a>4.2 å…·ä½“å®ç°ç±»çš„å®šä¹‰</h2><pre><code class="java">public class ObservableImpl implements IObservable&#123;    private static List&lt;IObserver&gt; observerList;    private SharebleData data;    public ObservableImpl() &#123;        observerList = new ArrayList&lt;&gt;();        data = new SharebleData();    &#125;    public void setSharebleData(double tem, double humidity, double pressure) &#123;        data.setHumidity(humidity);        data.setTemperature(tem);        data.setPressure(pressure);        notifyObservers();    &#125;    @Override    public ActionResult registerObserver(IObserver observer) &#123;        observerList.add(observer);        return new ActionResult(Status.SUCCESS, null);    &#125;    @Override    public ActionResult removeObserver(IObserver observer) &#123;        observerList.remove(observer);        return new ActionResult(Status.SUCCESS, null);    &#125;    @Override    public void notifyObservers() &#123;        observerList.forEach(observer -&gt; &#123;observer.update(data);&#125;);    &#125;&#125;public class CurrentConditionDisplay implements IObserver, IDisplay&#123;    private double temp;    private double pressure;    private IObservable observable;    public CurrentConditionDisplay(IObservable subject) &#123;        this.observable = subject;        observable.registerObserver(this);    &#125;    @Override    public void display() &#123;        System.out.println(String.format(&quot;======= print out current tem and pressure! temp: %f, pressure: %f &quot;, temp, pressure));    &#125;    @Override    public void update(SharebleData data) &#123;        temp = data.getTemperature();        pressure = data.getPressure();        display();    &#125;&#125;</code></pre><h2 id="4-3-æµ‹è¯•"><a href="#4-3-æµ‹è¯•" class="headerlink" title="4.3 æµ‹è¯•"></a>4.3 æµ‹è¯•</h2><pre><code class="java">@RestControllerpublic class TestController &#123;    @GetMapping(&quot;/observer&quot;)    public String observer() &#123;        StringBuilder sb = new StringBuilder();        ObservableImpl observable = new ObservableImpl();        observable.setSharebleData(30, 0.7, 80);        CurrentConditionDisplay currentConditionDisplay = new CurrentConditionDisplay(observable);        observable.setSharebleData(31, 0.7, 80);        observable.setSharebleData(32, 0.7, 80);        observable.setSharebleData(33, 0.7, 80);        return &quot;Please check log&quot;;    &#125;&#125;// Output from console ======= print out current tem and pressure! temp: 31.000000, pressure: 80.000000 ======= print out current tem and pressure! temp: 32.000000, pressure: 80.000000 ======= print out current tem and pressure! temp: 33.000000, pressure: 80.000000 </code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://learning.oreilly.com/library/view/head-first-design/9781492077992/ch02.html">https://learning.oreilly.com/library/view/head-first-design/9781492077992/ch02.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Design Pattern </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>How to use Sprint transactional annotation</title>
      <link href="/How-to-use-Sprint-transactional-annotation/"/>
      <url>/How-to-use-Sprint-transactional-annotation/</url>
      
        <content type="html"><![CDATA[<h1 id="How-to-use-Sprint-transactional-annotation"><a href="#How-to-use-Sprint-transactional-annotation" class="headerlink" title="How to use Sprint transactional annotation"></a>How to use Sprint transactional annotation</h1><h1 id="1-Attributes"><a href="#1-Attributes" class="headerlink" title="1. Attributes"></a>1. Attributes</h1><ul><li><code>value</code> and <code>transactionManager</code><ul><li>used to provide a TransactionManager reference to be used when handling the transaction for the annotated block</li></ul></li><li><code>propagation</code><ul><li>define how the transaction boundaries propagate to other methods that will be called either directly or indirectly from within the annotated block</li><li>default is <code>REQUIRED</code><ul><li>means a transaction is started if no transaction is already available</li><li>otherwise use the current running thread</li></ul></li></ul></li><li><code>timeout</code> and <code>timeoutString</code><ul><li>define the max number of seconds the current method is allowed to run</li></ul></li><li><code>readOnly</code><ul><li>defines if the current transaction is read-only or read-write</li></ul></li><li><code>rollbackFor</code> and <code>rollbackForClassName</code><ul><li>define one or more Throwable classes for which the current transaction will be rolled back</li><li>default is RuntimeException or an Error is thrown, but not for a checked Exception</li></ul></li><li><code>noRollbackFor</code> and <code>noRollbackForClassName</code><ul><li>used for one or more RuntimeException</li></ul></li></ul><h1 id="2-Transaction-Override"><a href="#2-Transaction-Override" class="headerlink" title="2. Transaction Override"></a>2. Transaction Override</h1><ul><li><code>addStatementReportOperation</code> is using the serializeble level, which override the class level readonly transaction</li></ul><pre><code class="java">@Service@Transactional(readOnly = true)public class OperationService &#123;    @Transactional(isolation = Isolation.SERIALIZABLE)    public boolean addStatementReportOperation(        String statementFileName,        long statementFileSize,        int statementChecksum,        OperationType reportType) &#123;        ...    &#125;&#125;</code></pre><ul><li>we use readOnly in class level because Spring could perform some read only optimization<ul><li>we could save memory when loading read only entities since the loaded state is discarded right away, and not kept for the whole duration of the currently running persistence context</li><li>also, in the cluster, read only data source could be redirected to DB replica instead of DB primary, this could also reduce the burden for primary</li></ul></li></ul><ol><li><a href="https://stackoverflow.com/questions/10394857/how-to-use-transactional-with-spring-data#:~:text=Thus%20we%20recommend%20using%20%40Transactional,re%2Ddecorated%20in%20that%20interface">https://stackoverflow.com/questions/10394857/how-to-use-transactional-with-spring-data#:~:text=Thus we recommend using %40Transactional,re-decorated in that interface</a> </li><li><a href="https://vladmihalcea.com/spring-read-only-transaction-hibernate-optimization/">https://vladmihalcea.com/spring-read-only-transaction-hibernate-optimization/</a>  </li><li><a href="https://vladmihalcea.com/spring-transactional-annotation/">https://vladmihalcea.com/spring-transactional-annotation/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PG::DuplicatePstatement Error prepared statement axxx already exists</title>
      <link href="/PG-DuplicatePstatement-Error-prepared-statement-axxx-already-exists/"/>
      <url>/PG-DuplicatePstatement-Error-prepared-statement-axxx-already-exists/</url>
      
        <content type="html"><![CDATA[<p>Thatâ€™s an interesting issue we faced in production during one deployment which only contain some frontend changes. </p><p>Upon check, this happens in such scenario: </p><pre><code class="java">A prepared statement is generated in postgresql, but never stored in rails. Since the code was interrupted before storing the statement, the @counter variable was never incremented even though it was used to generate a prepared statement.</code></pre><p>That pretty much described the issue, prepared statement on postgres side is a server side object that can be used to optimize performance. When the <code>PREPARE</code><br> statement is executed, the specified statement is parsed, analyzed, and rewritten. When an <code>EXECUTE</code>command is subsequently issued, the prepared statement is planned and executed.  </p><p>When the identifiers already bound to existing prepared statements but rails does not realize it, this issue will be happened. </p><p>here is the fix </p><p><a href="https://github.com/rails/rails/pull/41356/files">https://github.com/rails/rails/pull/41356/files</a></p><pre><code class="java">def next_key     &quot;a#&#123;@counter + 1&#125;&quot;end def next_key     &quot;a#&#123;@counter += 1&#125;&quot;end This change make the postgres prepared statement counter before makeing a prepared statementThus if the statemnt is aborted in rails side, app won&#39;t end up in perpetual crash state </code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://github.com/rails/rails/issues/1627">https://github.com/rails/rails/issues/1627</a></li><li><a href="https://github.com/rails/rails/pull/25827">https://github.com/rails/rails/pull/25827</a></li><li><a href="https://github.com/rails/rails/pull/17607">https://github.com/rails/rails/pull/17607</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Ruby </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Postgres </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Equity 101</title>
      <link href="/Equity-101/"/>
      <url>/Equity-101/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-equity"><a href="#1-What-is-equity" class="headerlink" title="1. What is equity?"></a>1. What is equity?</h1><ul><li>A form of compensation<ul><li>give you partial ownership in the company<ul><li>shares<ul><li>options</li><li>RSUs</li></ul></li></ul></li><li>can have seriously life changing result</li></ul></li><li>Liquidity<ul><li>the ability to sell your shares</li></ul></li></ul><h1 id="2-Cap-Table"><a href="#2-Cap-Table" class="headerlink" title="2. Cap Table"></a>2. Cap Table</h1><ul><li>A document that details who has ownership in a company</li><li>records<ul><li>how and when youâ€™ll get your shares</li><li>how many shares youâ€™ll get</li><li>how youâ€™ll be paid out</li></ul></li><li>employee option pool<ul><li>investors require it, to hire talented people</li><li>let talented stay longer</li></ul></li><li>different types of equity<ul><li>preferred shares â€” investors</li><li>stock options â€” employees</li><li>advisory shares â€” advisors</li></ul></li></ul><h1 id="3-Equity-grants"><a href="#3-Equity-grants" class="headerlink" title="3. Equity grants"></a>3. Equity grants</h1><ul><li><p>equity grant agreements</p><ul><li>how many shares you are getting</li><li>how much each share is worth</li><li>how long it will take to vest all your shares</li></ul></li><li><p>types of equity</p><ul><li>stock option â€” early stage<ul><li>you have the option to buy shares, but not obligated to</li><li>only vest on a single trigger</li><li>taxed when you buy/ sell your shares</li><li>option types<ul><li>incentive stock option<ul><li>pay tax when you sell your shares</li></ul></li><li>non qualified stock option<ul><li>pay taxes when you buy and sell shares</li></ul></li></ul></li></ul></li><li>restricted stock units - large startup<ul><li>you receive shares that you own automatically</li><li>often vest on a double trigger</li><li>taxed when get vested</li></ul></li></ul></li></ul><h1 id="4-How-vesting-work"><a href="#4-How-vesting-work" class="headerlink" title="4. How vesting work"></a>4. How vesting work</h1><ul><li>Earning the right to buy your shares<ul><li>when you are taxed</li><li>when you are able to buy shares</li></ul></li><li>vesting structures<ul><li>time based vesting</li><li>event based vesting</li><li>hybrid vesting</li></ul></li><li>option outstanding<ul><li>options has not been granted</li></ul></li></ul><h1 id="5-How-exercising-equity-works"><a href="#5-How-exercising-equity-works" class="headerlink" title="5. How exercising equity works"></a>5. How exercising equity works</h1><ul><li>Being granted stock options doesnâ€™t mean youâ€™re automatically a shareholder in a company.</li><li>Stock option not means share, you need to buy it</li><li>exercise<ul><li>means you purchase stock at a specified price</li><li>purchase your options</li><li>then company give stock certificate</li></ul></li><li>strike price<ul><li>option price you could leverage on to buy stocks</li><li>fixed price</li></ul></li><li>409A valuation<ul><li>an analysis of your companyâ€™s financials, which determines the value of the companyâ€™s shares</li><li>usually done every 12 months</li><li>Fair Market Value - FMV<ul><li>the value of one share of common stock</li></ul></li></ul></li><li>Spread/ Gain<ul><li>the difference between stock price and strike price</li></ul></li><li>PTEP - post termination exercise period<ul><li>the amount of time you have to exercise your options after you leave the company</li></ul></li><li>early exercise<ul><li>company let you buy everything today</li><li>then you just need to pay taxes at strike price</li><li>83b election<ul><li>a form sent to IRS</li><li>you want to pay tax now</li></ul></li></ul></li></ul><h1 id="6-How-to-sell-shares"><a href="#6-How-to-sell-shares" class="headerlink" title="6. How to sell shares"></a>6. How to sell shares</h1><ul><li>How and when can you sell your shares<ul><li>think about<ul><li>any restrictions on selling?</li><li>do you need the cash?</li><li>is the value increasing?</li><li>only chance to sell?</li></ul></li></ul></li><li>ways<ul><li>public company<ul><li>public shares pretty liquid,<ul><li>as itâ€™s easy to convert them into cash at market price</li></ul></li></ul></li><li>private company<ul><li>strongly restrict sell usually</li><li>ways<ul><li>IPO<ul><li>usually 6 month lock up period after going public</li></ul></li><li>M&amp;A<ul><li>bought or merge   acquisition</li><li>another company buys your shares<ul><li>pay for cash or other stocks</li></ul></li></ul></li><li>tender offer<ul><li>company buy from employee</li><li>could happen while the company still private</li></ul></li></ul></li></ul></li></ul></li></ul><h1 id="7-How-are-equity-grants-taxed"><a href="#7-How-are-equity-grants-taxed" class="headerlink" title="7. How are equity grants taxed?"></a>7. How are equity grants taxed?</h1><ul><li>ISO shares<ul><li>when sell it, tax rate come to be different</li></ul></li><li>qualifying disposition<ul><li>1 year after exercise</li><li>2 years after option grant date</li></ul></li><li>long term capital gains tax<ul><li>0% 0 20%</li></ul></li><li>short term capital gains<ul><li>taxed at ordinary income rates</li></ul></li><li>AMT<ul><li>alternative minimum tax</li><li>a low threshold, or floor, defining the minimum amount of taxes you are obligated to pay</li></ul></li></ul><h1 id="8-Valuations"><a href="#8-Valuations" class="headerlink" title="8. Valuations"></a>8. Valuations</h1><ul><li>dilution<ul><li>affect the percentage you have</li></ul></li><li>how valuation works<ul><li>term sheet<ul><li>a legal document defining the terms of an investment</li></ul></li><li>valuation<ul><li>an appraisal of a companyâ€™s worth</li><li>affect<ul><li>how many shares</li><li>price per shares</li><li>percentage</li></ul></li></ul></li></ul></li><li>stage<ul><li>pre money valuation<ul><li>post money matters you</li><li>the employee stock option poolâ€”that percentage of the company that gets carved out for new hires and new employees? Well, if you think about how dilution works, when an option pool gets carved out, it reduces the ownership percentage of all of the other shareholders. So thatâ€™s why a lot of the time, when an investor puts money into a company, theyâ€™ll require that this option pool gets sliced out of the company on a pre-money basis.</li></ul></li><li>investment</li><li>post money valuation</li></ul></li><li>how valuations are calculated<ul><li>valuation for startup come to be complex,<ul><li>revenue, profit, tax, etc.</li><li>growth rate</li><li>user count</li><li>industry</li><li>founding team</li></ul></li><li>section 409A<ul><li>let 3rd party help do valuation for the startup</li><li>every 12 months</li><li>or every time do a new fund raising</li></ul></li></ul></li></ul><h1 id="9-Who-can-invest-in-startups"><a href="#9-Who-can-invest-in-startups" class="headerlink" title="9. Who can invest in startups"></a>9. Who can invest in startups</h1><ul><li>For private company<ul><li>no need to release any info to public</li><li>less info and more risk comparing with public company investment</li></ul></li><li>who can invest in a startup<ul><li>accredited investor<ul><li>more relevant to individuals</li><li>criteria (either one of them)<ul><li>net worth  over a million, not include the primary living place;</li><li>income  net income 200k per year for last 2 years. reasonable expectation in following year; for a family is 300k</li><li>passing a financial exam, hold a license</li></ul></li></ul></li><li>qualified purchaser<ul><li>more relevant for funds, institution,</li><li>all about investment, purchasing power</li><li>an entity that has a significant amount of investment capital â€” their purchasing power</li></ul></li></ul></li></ul><h1 id="10-How-venture-capital-works"><a href="#10-How-venture-capital-works" class="headerlink" title="10. How venture capital works"></a>10. How venture capital works</h1><ul><li>venture capital system<ul><li>equity financing<ul><li>angel investors</li><li>venture capital fund<ul><li>invest other peopleâ€™s money through fund</li></ul></li></ul></li><li>debt financing</li></ul></li><li>type of fundraising instruments<ul><li>convertible instrument<ul><li>investor iou, convert the note into shares, owns equity in the future<ul><li>control - startup not lose control in this way</li></ul></li><li>used for very early stage of startups</li></ul></li><li>priced round<ul><li>used at later stages, when the company is growing</li></ul></li></ul></li><li>type of investors<ul><li>accredited investor - angel investor</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://carta.com/equity/learn/what-is-equity/">https://carta.com/equity/learn/what-is-equity/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Equity </tag>
            
            <tag> RSU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>System.nanoTime vs System.currentTimeMillis</title>
      <link href="/System-nanoTime-vs-System-currentTimeMillis/"/>
      <url>/System-nanoTime-vs-System-currentTimeMillis/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Monotonic-Clock"><a href="#1-Monotonic-Clock" class="headerlink" title="1. Monotonic Clock"></a>1. Monotonic Clock</h1><ul><li>suitable for measuring a duration, such as a timeout or a serviceâ€™s response time<ul><li><code>clock_gettime(CLOCK_MONOTONIC)</code></li><li><code>System.nanoTime()</code></li></ul></li><li>They are guaranteed to always move forward</li><li>However, the <em>absolute</em> value of the clock is meaningless: it might be the number of nanoseconds since the computer was started, or something similarly arbitrary. In particular, it makes no sense to compare monotonic clock values from two different computers, because they donâ€™t mean the same thing.<ul><li>On a server with multiple CPU sockets, there may be a separate timer per CPU, which is not necessarily synchronized with other CPUs</li></ul></li></ul><h1 id="2-Time-of-day-clock"><a href="#2-Time-of-day-clock" class="headerlink" title="2. Time of day clock"></a>2. Time of day clock</h1><ul><li>It returns the current date and time according to some calendar<ul><li><code>clock_gettime(CLOCK_REALTIME)</code></li><li><code>System.currentTimeMillis()</code><ul><li>return the number of seconds since the epoch</li></ul></li></ul></li><li>this time is synchronized with NTP, which means a timestamp from one machine ideally means the same as a timestamp on another machine</li><li>Oddies<ul><li>In particular, if the local clock is too far ahead of the NTP server, it may be forcibly reset and appear to jump back to a previous point in time. These jumps, as well as similar jumps caused by leap seconds, make time-of-day clocks unsuitable for measuring elapsed time</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Transaction Understanding</title>
      <link href="/Transaction-Understanding/"/>
      <url>/Transaction-Understanding/</url>
      
        <content type="html"><![CDATA[<h1 id="Transaction-Understanding"><a href="#Transaction-Understanding" class="headerlink" title="Transaction Understanding"></a>Transaction Understanding</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-Things-can-go-wrong"><a href="#1-1-Things-can-go-wrong" class="headerlink" title="1.1 Things can go wrong"></a>1.1 Things can go wrong</h2><ul><li>db software or hardware could fail at any time</li><li>application could crash at any time</li><li>interruptions in the network can unexpectedly cut off the application from the db, or one db node from another</li><li>several clients may write to the db at the same time, overwriting each otherâ€™s change</li><li>race conditions between clients can cause surprising bugs</li></ul><h2 id="1-2-Transaction"><a href="#1-2-Transaction" class="headerlink" title="1.2 Transaction"></a>1.2 Transaction</h2><ul><li>Transaction is the mechanism for us to simplify those issues<ul><li>Group several reads and writes together is a logical unit</li><li>either the entire transaction succeeds or it fails<ul><li>application can safely retry if it fails</li></ul></li></ul></li><li>Transaction makes error handling much more easier<ul><li>no need to worry about partial failure</li></ul></li><li>Transaction is created with a purpose, to simplify the programming model for applications accessing a database<ul><li>database take care of such issue</li></ul></li><li>for transaction, we need to understand<ul><li>what safety guarantees transactions can provide</li><li>what costs are associated with them</li></ul></li></ul><h1 id="2-ACID"><a href="#2-ACID" class="headerlink" title="2. ACID"></a>2. ACID</h1><ul><li>ACID are the safety guarantees provided by transactions<ul><li>Atomicity</li><li>Consistency</li><li>Isolation</li><li>Durability</li></ul></li></ul><h2 id="2-1-Atomicity"><a href="#2-1-Atomicity" class="headerlink" title="2.1 Atomicity"></a>2.1 Atomicity</h2><aside>ğŸ’¡ The ability to abort a transaction on error and have all writes from that transaction discarded is the defining feature of ACID atomicity</aside><ul><li>Atomic means sth <strong>cannot be</strong> broken down into smaller parts</li><li>Describes what happens if a client want to make several writes, but a fault occurs after some of the writes have been processed<ul><li>if the writes are grouped together into an atomic transaction</li><li>the transaction cannot be completed due to a fault,</li><li>then the transaction is aborted</li><li>the database must discard or undo any writes it has made so far in that transaction</li></ul></li><li>The ability to abort a transaction on error and have all writes from that transaction discarded is the defining feature of ACID atomicity</li></ul><h2 id="2-2-Consistency"><a href="#2-2-Consistency" class="headerlink" title="2.2 Consistency"></a>2.2 Consistency</h2><ul><li>Consistency refers to an application specific notion of the database being in a good state</li><li>The idea of ACID consistency is that you have certain statements about your data (<em>invariants</em>) that must always be trueâ€”for example, in an accounting system, credits and debits across all accounts must always be balanced</li><li>But this ususally is application code responsibility to define what data is valid or invalid</li></ul><h2 id="2-3-Isolation"><a href="#2-3-Isolation" class="headerlink" title="2.3 Isolation"></a>2.3 Isolation</h2><ul><li>Isolation means that concurrently executing transactions are isolated from each other: they cannot step on each otherâ€™s toe</li></ul><h2 id="2-4-Durability"><a href="#2-4-Durability" class="headerlink" title="2.4 Durability"></a>2.4 Durability</h2><ul><li>Purpose of a db system is to provide a safe place where data can be stored without fear of losing it</li><li><em>Durability</em> is the promise that once a transaction has committed successfully, any data it has written will not be forgotten, even if there is a hardware fault or the database crashes.</li><li>In a single node database<ul><li>means data has been written to nonvolatile storage such as a hard drive or SSD</li><li>could also involves a write ahead log</li></ul></li><li>In a replicated db,<ul><li>means data has been successfully copied to some number of nodes</li></ul></li></ul><h1 id="3-Single-and-Multi-Objects-Operations-Atomicity-Isolation"><a href="#3-Single-and-Multi-Objects-Operations-Atomicity-Isolation" class="headerlink" title="3. Single and Multi Objects Operations - Atomicity + Isolation"></a>3. Single and Multi Objects Operations - Atomicity + Isolation</h1><h2 id="3-1-Multi-Object-Transactions"><a href="#3-1-Multi-Object-Transactions" class="headerlink" title="3.1 Multi Object Transactions"></a>3.1 Multi Object Transactions</h2><h3 id="3-1-1-Why-we-need-it"><a href="#3-1-1-Why-we-need-it" class="headerlink" title="3.1.1 Why we need it"></a>3.1.1 Why we need it</h3><ul><li>Need some way to determine which read and write operations belong to the same transaction<ul><li>In relational db, typically done based on the <strong>clientâ€™s TCP connection to the database server</strong></li><li>on any particular connection, everything between a <strong>BEGIN TRANSACTION and a COMMIT statement</strong> is considered to be part of the same transaction</li></ul></li></ul><h3 id="3-1-2-Scenarios"><a href="#3-1-2-Scenarios" class="headerlink" title="3.1.2 Scenarios"></a>3.1.2 Scenarios</h3><ul><li>In a relational data model, a row in one table often has a foreign key reference to a row in another table<ul><li>multi object transactions allow you to ensure that these references remain valid</li></ul></li><li>In a document data model, the fields that need to be updated together are often <strong>within the same document</strong>, which is treated as a single objectâ€”no multi-object transactions are needed when updating a single document. However, document databases lacking join functionality also encourage denormalization. When denormalized information needs to be updated, you need to update several documents in one go. Transactions are very useful in this situation to prevent denormalized data from going out of sync</li><li>In db with secondary indexes, indexes also need to be updated every time you change a value<ul><li>These indexes are different database objects from a transaction point of view: for example, without transaction isolation, itâ€™s possible for a record to appear in one index but not another, because the update to the second index hasnâ€™t happened yet.</li></ul></li></ul><h2 id="3-2-Single-Object-Writes"><a href="#3-2-Single-Object-Writes" class="headerlink" title="3.2 Single Object Writes"></a>3.2 Single Object Writes</h2><ul><li>Atomicity and isolation also apply when a single object is being changed<ul><li>all storage engines universally aim to provide atomicity and isolation on the level of a single object on one node</li></ul></li><li>Atomicity<ul><li>Using a log for crash recovery</li><li>increment operation</li><li>compare and set</li></ul></li><li>Isolation<ul><li>Using a lock on each object</li></ul></li></ul><h2 id="3-3-Handling-errors-and-aborts"><a href="#3-3-Handling-errors-and-aborts" class="headerlink" title="3.3 Handling errors and aborts"></a>3.3 Handling errors and aborts</h2><ul><li>ACID DB Philosophy</li></ul><aside>ğŸ’¡ if the database is in danger of violating its guarantee of atomicity, isolation, or durability, it would rather abandon the transaction entirely than allow it to remain half-finished.</aside><ul><li>Aborts of transaction point is to safely retry, thus we should have some retry mechanism build for such scenario</li></ul><h1 id="4-Isolation-Levels"><a href="#4-Isolation-Levels" class="headerlink" title="4. Isolation Levels"></a>4. Isolation Levels</h1><p>Concurrency bugs are hard to find by testing, cause they are rare, and difficult to reproduce. For such reasons, databases have long tried to hide concurrency issues from application developers by providing transaction isolation </p><p>In theory, isolation should make your life easier by letting you pretend that no concurrency is happening: <em>serializable</em> isolation means that the database guarantees that transactions have the same effect as if they ran <em>serially</em></p><p>In practice, isolation has a performance cost, and many databased donâ€™t want to pay that price. Thus itâ€™s common for systems to use weaker levels of isolation, which protect against some concurrency issues, but not all </p><h2 id="4-1-Read-Committed"><a href="#4-1-Read-Committed" class="headerlink" title="4.1 Read Committed"></a>4.1 Read Committed</h2><h3 id="4-1-1-Guarantees"><a href="#4-1-1-Guarantees" class="headerlink" title="4.1.1 Guarantees"></a>4.1.1 Guarantees</h3><ul><li>when reading from the database, you will only see data that has been committed(no dirty reads)</li><li>when writing to the database, you will only overwrite data that has been committed (no dirty writes)</li></ul><h3 id="4-1-2-No-dirty-reads-Explanation"><a href="#4-1-2-No-dirty-reads-Explanation" class="headerlink" title="4.1.2 No dirty reads Explanation"></a>4.1.2 No dirty reads Explanation</h3><p><img src="https://s2.loli.net/2022/03/25/IPV8vCO1M93YxZT.png" alt=""></p><ul><li><p>Prevent dirty read, only committed record could be seen</p></li><li><p>reasons for dirty read prevention</p><ul><li>See the database in a partially updated state is confusing to users and may cause other transactions to take incorrect decisions</li><li>If a transaction aborts, any writes it has made need to be rolled back (like in <a href="https://learning.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/ch07.html#fig_transactions_atomicity">Figure 7-3</a>). If the database allows dirty reads, that means a transaction may see data that is later rolled backâ€”i.e., which is never actually committed to the database. Reasoning about the consequences quickly becomes mind-bending.</li></ul></li></ul><h3 id="4-1-3-No-Dirty-Write-Explanation"><a href="#4-1-3-No-Dirty-Write-Explanation" class="headerlink" title="4.1.3 No Dirty Write Explanation"></a>4.1.3 No Dirty Write Explanation</h3><ul><li>If two transactions concurrently try to update the same object in a db, we normally assume that the later write overwrites the earlier write</li><li>Dirty write happen when<ul><li>the earlier write is part of a transaction that has not yet committed, so the later write overwrites an uncommitted value</li></ul></li><li>how does committed isolation level work?<ul><li>by delaying the second write until the first writeâ€™s transaction has committed or aborted</li></ul></li></ul><p><img src="https://s2.loli.net/2022/03/25/3Z6NycPtjEGU9dB.png" alt=""></p><h3 id="4-1-4-Implementation"><a href="#4-1-4-Implementation" class="headerlink" title="4.1.4 Implementation"></a>4.1.4 Implementation</h3><ul><li><p>Dirty writes â€” Row level lock</p><ul><li>when a transaction wants to modify a particular object (row or document), it must first acquire a lock on that object.</li><li>It must then hold that lock until the transaction is committed or aborted.</li><li>Only one transaction can hold the lock for any given object;</li><li>if another transaction wants to write to the same object, it must wait until the first transaction is committed or aborted before it can acquire the lock and continue.</li><li>This locking is done automatically by databases in <strong>read committed mode (or stronger isolation levels)</strong>.</li></ul></li><li><p>Dirty Reads â€”</p><ul><li><p>still use row level lock</p><ul><li>the approach of requiring read locks does not work well in practice, because one long-running write transaction can force many other transactions to wait until the long-running transaction has completed, even if the other transactions only read and do not write anything to the database</li></ul></li><li><p>This harms the response time of read-only transactions and is bad for operability: a slowdown in one part of an application can have a knock-on effect in a completely different part of the application, due to waiting for locks.</p></li><li><p>most databases prevent dirty reads using the approach illustrated  here</p><p>  <img src="https://s2.loli.net/2022/03/25/IPV8vCO1M93YxZT.png" alt=""></p></li><li><p>for every object that is written, the database remembers <strong>both the old committed value and the new value</strong> set by the transaction that currently holds the write lock.</p></li><li><p>While the transaction is ongoing, any other transactions that read the object are simply given the old value. Only when the new value is committed do transactions switch over to reading the new value.</p></li></ul></li></ul><h2 id="4-2-Snapshot-Isolation-and-Repeatable-Read"><a href="#4-2-Snapshot-Isolation-and-Repeatable-Read" class="headerlink" title="4.2 Snapshot Isolation and Repeatable Read"></a>4.2 Snapshot Isolation and Repeatable Read</h2><h3 id="4-2-1-Issue-with-Read-Committed"><a href="#4-2-1-Issue-with-Read-Committed" class="headerlink" title="4.2.1 Issue with Read Committed"></a>4.2.1 Issue with Read Committed</h3><p><img src="https://s2.loli.net/2022/03/25/1rRcBlD7Funjztg.png" alt=""></p><ul><li>Read committed can still have concurrency bug<ul><li>In the image above, there will be certain time the amount of 2 accounts are not equal to 1000</li><li>called read skew â€” nonrepeatable read<ul><li>there will be temporary inconsistency</li><li><strong>read the committed data by another transaction</strong></li></ul></li></ul></li><li>But there are certain situations, that cannot tolerate such temporary inconsistency<ul><li>Backup<ul><li>Taking a backup requires making a copy of the entire database, which may take hours on a large database. During the time that the backup process is running, writes will continue to be made to the database. Thus, you could end up with some parts of the backup containing an older version of the data, and other parts containing a newer version. If you need to restore from such a backup, the inconsistencies (such as disappearing money) become permanent.</li></ul></li><li>Analytic queries and integrity checks<ul><li>nonsensical results will be returned if the database is at different points in time</li></ul></li></ul></li></ul><h3 id="4-2-2-Solution-Snapshot-isolation"><a href="#4-2-2-Solution-Snapshot-isolation" class="headerlink" title="4.2.2 Solution: Snapshot isolation"></a>4.2.2 Solution: Snapshot isolation</h3><ul><li>Each transaction reads from a consistent snapshot of the database,<ul><li>the transaction sees all the data that was committed in the db at the start of the transaction</li></ul></li></ul><h3 id="4-2-3-Snapshot-Isolation-Implementation"><a href="#4-2-3-Snapshot-Isolation-Implementation" class="headerlink" title="4.2.3 Snapshot Isolation Implementation"></a>4.2.3 Snapshot Isolation Implementation</h3><ul><li><p>Use write locks to prevent dirty writes</p><ul><li>a transaction that makes a write can block the progress of another transaction that writes to the same object</li></ul></li><li><p>reads do not require any locks.</p><ul><li>From a performance point of view, a key principle of snapshot isolation is <em>readers never block writers, and writers never block readers</em></li><li>This allows a database to handle long-running read queries on a consistent snapshot at the same time as processing writes normally, without any lock contention between the two.</li></ul></li><li><p>To implement snapshot isolation, db uses a generalization of the mechanism</p><ul><li>db must potentially keep several different committed versions of an object, because various in progress transactions may need to see the state of the db at different points in time</li><li>â€” named as multi version concurrency control â€” MVCC</li></ul></li><li><p>If a database only needed to provide read committed isolation, but not snapshot isolation, it would be sufficient to keep two versions of an object:</p><ul><li>the committed version and the overwritten-but-not-yet-committed version.</li></ul></li><li><p>However, storage engines that support snapshot isolation typically use MVCC for their read committed isolation level as well.</p><ul><li><strong>A typical approach is that read committed uses a separate snapshot for each query, while snapshot isolation uses the same snapshot for an entire transaction.</strong></li></ul></li></ul><h3 id="4-2-4-Visibility-rules-for-observing-a-consistent-snapshot"><a href="#4-2-4-Visibility-rules-for-observing-a-consistent-snapshot" class="headerlink" title="4.2.4 Visibility rules for observing a consistent snapshot"></a>4.2.4 Visibility rules for observing a consistent snapshot</h3><ul><li>Transaction IDs are used to decide which objects it can see and which are invisible</li><li>Rules<ol><li>At the start of each transaction, the database makes a list of all the other transactions that are in progress (not yet committed or aborted) at that time. Any writes that those transactions have made are ignored, even if the transactions subsequently commit.</li><li>Any writes made by aborted transactions are ignored.</li><li>Any writes made by transactions with a later transaction ID (i.e., which started after the current transaction started) are ignored, regardless of whether those transactions have committed.</li><li>All other writes are visible to the applicationâ€™s queries.</li></ol></li></ul><h2 id="4-3-Preventing-Lost-Updates"><a href="#4-3-Preventing-Lost-Updates" class="headerlink" title="4.3 Preventing Lost Updates"></a>4.3 Preventing Lost Updates</h2><h3 id="4-3-1-Issues"><a href="#4-3-1-Issues" class="headerlink" title="4.3.1 Issues"></a>4.3.1 Issues</h3><p>The lost update problem can occur if an application reads some value from the database, modifies it, and writes back the modified value (a <em>read-modify-write cycle</em>). <strong>If two transactions do this concurrently, one of the modifications can be lost, because the second write does not include the first modification.</strong> (We sometimes say that the later write <em>clobbers</em> the earlier write.) This pattern occurs in various different scenarios: </p><ul><li>Incrementing a counter or updating an account balance (requires reading the current value, calculating the new value, and writing back the updated value)</li><li>Making a local change to a complex value, e.g., adding an element to a list within a JSON document (requires parsing the document, making the change, and writing back the modified document)</li><li>Two users editing a wiki page at the same time, where each user saves their changes by sending the entire page contents to the server, overwriting whatever is currently in the database</li></ul><h3 id="4-3-2-Solution-1-Atomic-Write-Operations"><a href="#4-3-2-Solution-1-Atomic-Write-Operations" class="headerlink" title="4.3.2 Solution 1: Atomic Write Operations"></a>4.3.2 Solution 1: Atomic Write Operations</h3><ul><li>Using atomic update provided by database,</li></ul><pre><code class="ruby">UPDATE counters SET value = value + 1 WHERE key = &#39;foo&#39;;</code></pre><ul><li>Atomic operations are usually implemented by taking an <strong>exclusive lock on the object when it is read</strong> so that no other transaction can read it until the update has been applied</li><li>Also, we could force all atomic operations to be executed on a single thread</li></ul><h3 id="4-3-3-Solution-2-Explicit-Locking"><a href="#4-3-3-Solution-2-Explicit-Locking" class="headerlink" title="4.3.3 Solution 2: Explicit Locking"></a>4.3.3 Solution 2: Explicit Locking</h3><ul><li>Explicitly lock objects that are going to be updated<ul><li>then the application can perform a read modify write cycle</li><li>if any other transaction tries to concurrently read the same object, it is forced to wait until the first read-modify-write cycle has completed</li></ul></li></ul><pre><code class="ruby">BEGIN TRANSACTION;SELECT * FROM figures  WHERE name = &#39;robot&#39; AND game_id = 222// For Update will let databse take a lock o  FOR UPDATE; 1-- Check whether move is valid, then update the position-- of the piece that was returned by the previous SELECT.UPDATE figures SET position = &#39;c4&#39; WHERE id = 1234;COMMIT;</code></pre><h3 id="4-3-4-Solution-3-Automatically-detecting-lost-updates"><a href="#4-3-4-Solution-3-Automatically-detecting-lost-updates" class="headerlink" title="4.3.4 Solution 3: Automatically detecting lost updates"></a>4.3.4 Solution 3: Automatically detecting lost updates</h3><ul><li>Atomic operations and locks are ways of preventing lost updates by forcing the read-modify-write cycles to happen sequentially.</li><li>An alternative is to allow them to <strong>execute in parallel</strong> and, if the transaction manager <strong>detects a lost update, abort the transaction</strong> and <strong>force it to retry its read-modify-write cycle</strong>.</li><li>Lost update detection is great because it doesnâ€™t require application code to use any special database features, you could forget to use a lock or an atomic operation, but lost update detection happens automatically and thus less error prone</li></ul><h3 id="4-3-5-Solution-4-Compare-and-set"><a href="#4-3-5-Solution-4-Compare-and-set" class="headerlink" title="4.3.5 Solution 4: Compare and set"></a>4.3.5 Solution 4: Compare and set</h3><ul><li>Avoid lost updates by allowing an update to happen only if the value has not changed since you last read it</li></ul><pre><code class="ruby">UPDATE wiki_pages SET content = &#39;new content&#39;  WHERE id = 1234 AND content = &#39;old content&#39;;</code></pre><ul><li>But notice the compare and set operation is possible to be unsafe if db by default read from the old snapshot</li></ul><h3 id="4-3-6-Solution-5-Conflict-resolution-and-replication"><a href="#4-3-6-Solution-5-Conflict-resolution-and-replication" class="headerlink" title="4.3.6 Solution 5: Conflict resolution and replication"></a>4.3.6 Solution 5: Conflict resolution and replication</h3><p>In multi leader or leaderless replication system, a common approach in such replicated databases is to allow concurrent writes to create several conflicting versions of a value (also known as <em>siblings</em>), and to use application code or special data structures to resolve and merge these versions after the fact.</p><h2 id="4-4-Write-Skew-and-Phantoms"><a href="#4-4-Write-Skew-and-Phantoms" class="headerlink" title="4.4 Write Skew and Phantoms"></a>4.4 Write Skew and Phantoms</h2><p><img src="https://s2.loli.net/2022/03/25/pFhAQWIU8O4bEZY.png" alt=""></p><ul><li>In each transaction, we first check that two or more doctors are currently on call,<ul><li>since db is using snapshot isolation, both checks return 2, so both of them proceed to the next stage</li></ul></li><li>Write Skew<ul><li>itâ€™s neither a dirty write nor a lost update, because the two transactions are updating two different objects</li><li>But itâ€™s a race condition as the anomalous behavior was only possible because the transactions ran concurrently</li></ul></li><li>You can think of write skew as a generalization of the lost update problem.<ul><li>Write skew can occur if <strong>two transactions read the same objects</strong>, and <strong>then update some of those objects (different transactions may update different objects).</strong></li><li>In the special case where different transactions update the same object, you get a dirty write or lost update anomaly (depending on the timing).</li></ul></li></ul><h3 id="4-4-2-Solution"><a href="#4-4-2-Solution" class="headerlink" title="4.4.2 Solution"></a>4.4.2 Solution</h3><ul><li>We need to explicitly lock the rows as solution in isolation snapshot works for one object, now the case come to be multiple objects, so that comes to be different</li></ul><pre><code class="ruby">BEGIN TRANSACTION;SELECT * FROM doctors  WHERE on_call = true  AND shift_id = 1234 FOR UPDATE; 1UPDATE doctors  SET on_call = false  WHERE name = &#39;Alice&#39;  AND shift_id = 1234;COMMIT;</code></pre><h3 id="4-4-3-Phantoms"><a href="#4-4-3-Phantoms" class="headerlink" title="4.4.3 Phantoms"></a>4.4.3 Phantoms</h3><p>All of these examples follow a similar pattern:</p><ol><li><p>A <code>SELECT</code> query checks whether some requirement is satisfied by searching for rows that match some search condition (there are at least two doctors on call, there are no existing bookings for that room at that time, the position on the board doesnâ€™t already have another figure on it, the username isnâ€™t already taken, there is still money in the account).</p></li><li><p>Depending on the result of the first query, the application code decides how to continue (perhaps to go ahead with the operation, or perhaps to report an error to the user and abort).</p></li><li><p>If the application decides to go ahead, it makes a write (<code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code>) to the database and commits the transaction.</p><p> The effect of this write changes the precondition of the decision of step 2. In other words, if you were to repeat the <code>SELECT</code> query from step 1 after committing the write, you would get a different result, because the write changed the set of rows matching the search condition (there is now one fewer doctor on call, the meeting room is now booked for that time, the position on the board is now taken by the figure that was moved, the username is now taken, there is now less money in the account).</p></li></ol><p>The steps may occur in a different order. For example, you could first make the write, then the <code>SELECT</code> query, and finally decide whether to abort or commit based on the result of the query.</p><p>In the case of the doctor on call example, the row being modified in step 3 was one of the rows returned in step 1, so we could make the transaction safe and avoid write skew by locking the rows in step 1 (<code>SELECT FOR UPDATE</code>). However, the other four examples are different: they check for the <em>absence</em> of rows matching some search condition, and the write <em>adds</em> a row matching the same condition. If the query in step 1 doesnâ€™t return any rows, <code>SELECT FOR UPDATE</code> canâ€™t attach locks to anything.</p><p>This effect, where a write in one transaction changes the result of a search query in another transaction, is called a <em>phantom</em> [<a href="https://learning.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/ch07.html#Eswaran1976uu">3</a>]. Snapshot isolation avoids phantoms in read-only queries, but in read-write transactions like the examples we discussed, phantoms can lead to particularly tricky cases of write skew.</p><h3 id="4-4-4-Materializing-conflicts-for-Phantoms"><a href="#4-4-4-Materializing-conflicts-for-Phantoms" class="headerlink" title="4.4.4 Materializing conflicts for Phantoms"></a>4.4.4 Materializing conflicts for Phantoms</h3><ul><li>Pre create all rows in the db, thus phantoms problems could be converted to the doctor appointment problem we discussed before</li></ul><h3 id="4-4-5-Predicate-Locks"><a href="#4-4-5-Predicate-Locks" class="headerlink" title="4.4.5 Predicate Locks"></a>4.4.5 Predicate Locks</h3><ul><li>We could use a predicate lock for booking case, works similarly to  the shared/ exclusive lock, but rather than belong to a particular object, it belongs to all objects that match some search condition</li></ul><pre><code class="ruby">SELECT * FROM bookings  WHERE room_id = 123 AND    end_time   &gt; &#39;2018-01-01 12:00&#39; AND    start_time &lt; &#39;2018-01-01 13:00&#39;;</code></pre><ul><li>If transaction A wants to read objects matching some condition, like in that <code>SELECT</code> query, it must acquire a shared-mode predicate lock on the conditions of the query. If another transaction B currently has an exclusive lock on any object matching those conditions, A must wait until B releases its lock before it is allowed to make its query.</li><li>If transaction A wants to insert, update, or delete any object, it must first check whether either the old or the new value matches any existing predicate lock. If there is a matching predicate lock held by transaction B, then A must wait until B has committed or aborted before it can continue.</li></ul><h2 id="4-5-Serializability"><a href="#4-5-Serializability" class="headerlink" title="4.5 Serializability"></a>4.5 Serializability</h2><ul><li>There are a lot of different isolation levels, and each db declare their isolation level slightly different,<ul><li>We could use serializable isolation to simplify it</li></ul></li><li>Serializable isolation<ul><li>Strongest isolation level</li><li>without any concurrency</li></ul></li><li>Serializable Mechanism<ul><li>Literally executing transactions in a serail order</li><li>Two Phase Locking</li><li>Optimistic concurrency control techniques such as serializable snapshot isolation</li></ul></li></ul><h3 id="4-5-1-Actual-Serial-Execution"><a href="#4-5-1-Actual-Serial-Execution" class="headerlink" title="4.5.1 Actual Serial Execution"></a>4.5.1 Actual Serial Execution</h3><ul><li><p>We could try to only execute one transaction at a time, in serial order, on a single thread</p></li><li><p>This comes to be realistic recently around 2007 because</p><ul><li>RAM became cheap enough, thus itâ€™s now feasible to keep the entire active dataset in memory</li><li>OLTP transactions are usually short and only make a small number of reads and writes<ul><li>by contrast, long running analytic queries are typically read only, so they can be run on a consistent snapshot outside of the serial execution loop</li></ul></li></ul></li><li><p>This approach is implemented in VoltDB/ Hstore, Redis, and Datomic</p></li><li><p>Notice</p><ul><li>A system designed for a single threaded execution can sometimes perform better than a system that supports concurrency, because it can avoid the coordination overhead of locking</li></ul></li></ul><h3 id="4-5-2-Encapsulating-transactions-in-stored-procedures"><a href="#4-5-2-Encapsulating-transactions-in-stored-procedures" class="headerlink" title="4.5.2 Encapsulating transactions in stored procedures"></a>4.5.2 Encapsulating transactions in stored procedures</h3><ul><li><p>Philosophy</p><ul><li>Keep transactions short by avoiding interactively waiting for a user within a transaction</li><li>means a transaction is committed within the same HTTP request,</li></ul></li><li><p>IN the interactive style of transaction, network and db will take a lot time, we need to make sure we could handle enough throughput, we need to process multiple transactions concurrently in order to get reasonable performance.</p></li><li><p>Systems with single threaded serial transaction processing could receive the entier transaction code to db ahead of time , as a <strong>stored procedure</strong></p></li></ul><p><img src="https://s2.loli.net/2022/03/25/W1TFbpKA5JGhwXd.png" alt=""></p><ul><li>Pros and Cons<ul><li>Each db has its own language for stored procedures</li><li>Code running in db is difficult to manage, more awkward to keep in version control and deploy</li><li>db is often much more performance sensitive,because a single db instance is often shared by a lot of application servers. A bad written stored procedure can cause much more trouble than equivalent badly written code in an application server</li></ul></li></ul><h3 id="4-5-3-Partitioning"><a href="#4-5-3-Partitioning" class="headerlink" title="4.5.3 Partitioning"></a>4.5.3 Partitioning</h3><ul><li>Partition data to scale to multiple CPU cores, and multiple nodes.</li><li>However, for any transaction that needs to access multiple partitions, the database must coordinate the transaction across all the partitions that it touches. The stored procedure needs to be performed in lock-step across all partitions to ensure serializability across the whole system.</li></ul><h1 id="5-Two-Phase-Locking"><a href="#5-Two-Phase-Locking" class="headerlink" title="5. Two Phase Locking"></a>5. Two Phase Locking</h1><h2 id="5-1-Concepts"><a href="#5-1-Concepts" class="headerlink" title="5.1 Concepts"></a>5.1 Concepts</h2><ul><li>Several transactions are allowed to concurrently read the same object as long as nobody is writing to it</li><li>But as soon as anyone wants to write(modify or delete) an object, exclusive access is required<ul><li>Writes not only block other writers, it also block all readers</li></ul></li></ul><h2 id="5-2-Implementation"><a href="#5-2-Implementation" class="headerlink" title="5.2 Implementation"></a>5.2 Implementation</h2><ul><li>If a transaction wants to read an object, it must first acquire the lock in shared mode. Several transactions are allowed to hold the lock in shared mode simultaneously, but if another transaction already has an exclusive lock on the object, these transactions must wait.</li><li>If a transaction wants to write to an object, it must first acquire the lock in exclusive mode. No other transaction may hold the lock at the same time (either in shared or in exclusive mode), so if there is any existing lock on the object, the transaction must wait.</li><li>If a transaction first reads and then writes an object, it may upgrade its shared lock to an exclusive lock. The upgrade works the same as getting an exclusive lock directly.</li><li>After a transaction has acquired the lock, it must continue to hold the lock until the end of the transaction (commit or abort). This is where the name â€œtwo-phaseâ€ comes from: the first phase (while the transaction is executing) is when the locks are acquired, and the second phase (at the end of the transaction) is when all the locks are released.</li></ul><h2 id="5-3-Performance"><a href="#5-3-Performance" class="headerlink" title="5.3 Performance"></a>5.3 Performance</h2><ul><li>transaction throughput and response times of queries are significantly worse under two-phase locking than under weak isolation.<ul><li>overhead of <strong>acquiring and releasing all those locks</strong>, but more importantly due to <strong>reduced concurrency</strong>.</li></ul></li></ul><h1 id="6-Serializable-Snapshot-Isolation"><a href="#6-Serializable-Snapshot-Isolation" class="headerlink" title="6. Serializable Snapshot Isolation"></a>6. Serializable Snapshot Isolation</h1><ul><li>It provides full serializability, but has only a small performance penalty compared to snapshot isolation</li><li>Snapshot + Serializable<ul><li>optimistic concurrency control mechanism</li><li>It performs badly if there is high contention (many transactions trying to access the same objects), as this leads to a high proportion of transactions needing to abort. If the system is already close to its maximum throughput, the additional transaction load from retried transactions can make performance worse.</li></ul></li><li>to achieve serialization, db need to know if the query result has been changed within the transaction<ul><li>Detecting reads of a stale MVCC object version (uncommitted write occurred before the read)</li><li>Detecting writes that affect prior reads (the write occurs after the read)</li></ul></li></ul><h2 id="6-1-Detecting-stale-MVCC-reads"><a href="#6-1-Detecting-stale-MVCC-reads" class="headerlink" title="6.1 Detecting stale MVCC reads"></a>6.1 Detecting stale MVCC reads</h2><p>In order to prevent this anomaly, the database needs to track when a transaction ignores another transactionâ€™s writes due to MVCC visibility rules. When the transaction wants to commit, the database checks whether any of the ignored writes have now been committed. If so, the transaction must be aborted.</p><p><img src="https://s2.loli.net/2022/03/25/kyCJZvs5QB93b1u.png" alt=""></p><h2 id="6-2-Detecting-writes-that-affect-prior-reads"><a href="#6-2-Detecting-writes-that-affect-prior-reads" class="headerlink" title="6.2 Detecting writes that affect prior reads"></a>6.2 Detecting writes that affect prior reads</h2><p>When a transaction writes to the database, it must look in the indexes for any other transactions that have recently read the affected data. This process is similar to acquiring a write lock on the affected key range, but rather than blocking until the readers have committed, the lock acts as a tripwire: it simply notifies the transactions that the data they read may no longer be up to date.</p><h2 id="6-3-Performance"><a href="#6-3-Performance" class="headerlink" title="6.3 Performance"></a>6.3 Performance</h2><p>Compared to two-phase locking, the big advantage of serializable snapshot isolation is that one transaction doesnâ€™t need to block waiting for locks held by another transaction. Like under snapshot isolation, writers donâ€™t block readers, and vice versa. This design principle makes query latency much more predictable and less variable. In particular, read-only queries can run on a consistent snapshot without requiring any locks, which is very appealing for read-heavy workloads.</p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> transaction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½®èº«äº‹å†… ç¬”è®°</title>
      <link href="/%E7%BD%AE%E8%BA%AB%E4%BA%8B%E5%86%85-%E7%AC%94%E8%AE%B0/"/>
      <url>/%E7%BD%AE%E8%BA%AB%E4%BA%8B%E5%86%85-%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ•´ä½“æ¡†æ¶"><a href="#1-æ•´ä½“æ¡†æ¶" class="headerlink" title="1. æ•´ä½“æ¡†æ¶"></a>1. æ•´ä½“æ¡†æ¶</h1><ul><li>å¾®è§‚æœºåˆ¶<ul><li>åœ°æ–¹æ”¿åºœçš„æƒåŠ›å’Œäº‹åŠ¡</li><li>è´¢ç¨ä¸æ”¿åºœè¡Œä¸º</li><li>æ”¿åºœæŠ•èèµ„å’Œå€ºåŠ¡</li><li>å·¥ä¸šåŒ–å½“ä¸­çš„æ”¿åºœè§’è‰²</li></ul></li><li>å®è§‚ç°è±¡<ul><li>åŸå¸‚åŒ–å’Œä¸å¹³è¡¡</li><li>å€ºåŠ¡ä¸é£é™©</li><li>å›½å†…å›½é™…å¤±è¡¡</li><li>æ”¿åºœä¸ç»æµå‘å±•</li></ul></li></ul><h1 id="2-åœ°æ–¹æ”¿åºœçš„æƒåŠ›å’Œäº‹åŠ¡"><a href="#2-åœ°æ–¹æ”¿åºœçš„æƒåŠ›å’Œäº‹åŠ¡" class="headerlink" title="2. åœ°æ–¹æ”¿åºœçš„æƒåŠ›å’Œäº‹åŠ¡"></a>2. åœ°æ–¹æ”¿åºœçš„æƒåŠ›å’Œäº‹åŠ¡</h1><aside>ğŸ’¡ åœ°æ–¹æ”¿åºœä¸åªæä¾›äº†å…¬å…±æœåŠ¡ï¼Œä¹Ÿæ·±åº¦å‚ä¸ç”Ÿäº§å’Œåˆ†é…ã€‚</aside><h2 id="2-1-ä½“åˆ¶ç‰¹ç‚¹"><a href="#2-1-ä½“åˆ¶ç‰¹ç‚¹" class="headerlink" title="2.1 ä½“åˆ¶ç‰¹ç‚¹"></a>2.1 ä½“åˆ¶ç‰¹ç‚¹</h2><ul><li>æ”¿åºœç®¡ç†ä½“ç³»<ul><li>ä¸­å¤® - çœ - å¸‚ - å¿åŒº - ä¹¡é•‡</li></ul></li><li>ä½“åˆ¶ç‰¹ç‚¹<ul><li>ä¸­å¤®ä¸åœ°æ–¹æ”¿åºœ<ul><li>æ—¥å¸¸è¿ä½œä»¥åœ°æ–¹æ”¿åºœä¸ºä¸»</li></ul></li><li>å…šä¸æ”¿åºœ<ul><li>å…šè´Ÿè´£é‡å¤§å†³ç­–å’Œäººäº‹ä»»å…</li><li>æ”¿åºœè´Ÿè´£æ‰§è¡Œ</li></ul></li><li>æ¡å—åˆ†å‰²ï¼Œå¤šé‡é¢†å¯¼<ul><li>å±‚å±‚å¤åˆ¶</li><li>å…šå§”æ”¿åºœäººå¤§æ”¿åå››å¥—ç­å­</li><li>æ¡æ¡å…³ç³»æ˜¯ä¸šåŠ¡å…³ç³»ï¼Œå—å—å…³ç³»æ˜¯é¢†å¯¼å…³ç³»â€”åœ°æ–¹å…šå§”å’Œæ”¿åºœå¯ä»¥å†³å®šäººäº‹ä»»å…</li></ul></li><li>ä¸Šå±‚é¢†å¯¼ä¸åè°ƒ<ul><li>æƒåŠ›åˆ†æ•£ï¼Œå†³ç­–å®¹æ˜“å‘ä¸Šé›†ä¸­</li><li>å°½é‡åœ¨èƒ½è¾¾æˆå…±è¯†çš„æœ€ä½å±‚çº§ä¸Šè§£å†³é—®é¢˜</li></ul></li><li>å®˜åƒšä½“ç³»<ul><li>å®˜å‘˜å¿…é¡»å­¦ä¹ å’Œè´¯å½»ç»Ÿä¸€çš„æ„è¯†å½¢æ€</li><li>å®˜å‘˜ç”±ä¸Šçº§ä»»å‘½</li><li>åœ°æ–¹ä¸»å®˜éœ€è¦åœ¨å¤šåœ°è½®æ¢ä»»èŒ</li></ul></li></ul></li><li>æ”¿åºœæ²»ç†å’Œè¿ä½œçš„æ¨¡å¼<ul><li>äº†è§£æƒåŠ›å’Œèµ„æºåœ¨æ”¿åºœä½“ç³»ä¸­çš„åˆ†å¸ƒè§„åˆ™<ul><li>ä¸Šä¸‹çº§æ”¿åºœé—´çš„çºµå‘åˆ†å¸ƒ</li><li>åŒçº§æ”¿åºœé—´çš„æ¨ªå‘åˆ†å¸ƒ</li></ul></li></ul></li><li>äº‹æƒåˆ’åˆ†çš„åŸåˆ™<ul><li>å…¬å…±æœåŠ¡çš„è§„æ¨¡ç»æµ</li><li>ä¿¡æ¯çš„å¤æ‚æ€§</li><li>æ¿€åŠ±ç›¸å®¹</li></ul></li></ul><h2 id="2-2-å¤–éƒ¨æ€§-è§„æ¨¡ç»æµ"><a href="#2-2-å¤–éƒ¨æ€§-è§„æ¨¡ç»æµ" class="headerlink" title="2.2 å¤–éƒ¨æ€§ è§„æ¨¡ç»æµ"></a>2.2 å¤–éƒ¨æ€§ è§„æ¨¡ç»æµ</h2><ul><li>ä¸€ä¸ªäº‹ç‰©æ˜¯åªåœ¨åˆ’å®šçš„åŒºåŸŸèŒƒå›´å†…æœ‰å½±å“ è¿˜æ˜¯å¯¹å¤–ä¹Ÿæœ‰å½±å“</li><li>è¡Œæ”¿åŒºåŸŸåˆ’åˆ†<ul><li>äººå£å¯†åº¦ â€” æä¾›å…¬å…±ç‰©å“å’ŒæœåŠ¡éœ€è¦æˆæœ¬</li><li>å±±å·æ²³æµ</li><li>è¯­è¨€æ–‡åŒ–å·®å¼‚</li></ul></li><li>åŸå¸‚ç¾¤çš„è§„åˆ’<ul><li>å› ä¸ºç»æµæ´»åŠ¨å’Œäººå£é›†èšï¼Œéœ€è¦æ‰“ç ´ç°æœ‰çš„è¡Œæ”¿è¾¹ç•Œï¼Œåœ¨æ›´å¤§èŒƒå›´å†…æä¾›æ— ç¼å¯¹æ¥çš„æ ‡å‡†åŒ–å…¬å…±æœåŠ¡</li></ul></li><li>è¡Œæ”¿äº¤ç•Œåœ°åŒºç»æµå‘å±•å¼±<ul><li>åœ°ç†åŸå› </li><li>äºšæ–‡åŒ–åŒºï¼Œè·ç¦»ä¸»æµæ–‡åŒ–ç›¸å¯¹è¿œ â€” æ–‡åŒ–ï¼Œè¯­è¨€ä¸Š</li><li>çœæ”¿åºœä¹Ÿä¸ä¼šæŠŠæœ‰é™èµ„æºä¼˜å…ˆé…ç½®åˆ°è¾¹ç•Œåœ°åŒº</li><li>ç¯å¢ƒæ±¡æŸ“è°æ¥æ²»ç†çš„é—®é¢˜</li></ul></li></ul><h2 id="2-3-å¤æ‚ä¿¡æ¯"><a href="#2-3-å¤æ‚ä¿¡æ¯" class="headerlink" title="2.3 å¤æ‚ä¿¡æ¯"></a>2.3 å¤æ‚ä¿¡æ¯</h2><ul><li>ä¿¡æ¯ä¸æƒåŠ›<ul><li>åŸåˆ™ä¸Š  ä¸Šçº§å½¢å¼æƒå¨</li><li>å®é™…ä¸Šç»™ä¸‹çº§  ä¸‹çº§æœ‰å®é™…æƒå¨</li><li>ä¿¡æ¯ä¼˜åŠ¿  æƒå¨çš„å¹³è¡¡æ˜¯æ ¸å¿ƒé—®é¢˜</li></ul></li><li>ä¿¡æ¯è·å–+éšç’<ul><li>ä¿¡æ¯ä¼ é€’å¾ˆé‡è¦<ul><li>å¤§é‡çš„ä¼šè®®å’Œæ–‡ä»¶</li></ul></li><li>å¤æ‚çš„æ–‡ä»¶å’Œä¼šè®®åˆ¶åº¦<ul><li>æ–‡ä»¶ç±»å‹ï¼Œæ ¼å¼ï¼Œä»¥åŠæŠ¥é€éƒ½æœ‰ä¸¥æ ¼çš„æµç¨‹</li></ul></li></ul></li><li>ä¸Šå±‚çš„ç›‘ç£å’Œå®¡è®¡</li></ul><aside>ğŸ’¡ æ‰€è°“æƒåŠ›ï¼Œå®è´¨ä¸Šå°±æ˜¯åœ¨è¯´ä¸æ¸…æ¥šçš„æƒ…å†µä¸‹ç”±è°æ¥æ‹æ¿å†³ç­–çš„é—®é¢˜</aside><h2 id="2-4-æ¿€åŠ±ç›¸å®¹"><a href="#2-4-æ¿€åŠ±ç›¸å®¹" class="headerlink" title="2.4 æ¿€åŠ±ç›¸å®¹"></a>2.4 æ¿€åŠ±ç›¸å®¹</h2><ul><li>å‚ç›´ç®¡ç†<ul><li>ä¸“ä¸šæ€§å¼ºï¼Œæ ‡å‡†åŒ–ç¨‹åº¦é«˜çš„éƒ¨é—¨</li><li>é¢å¯¹æœ‰åŒé‡é¢†å¯¼çš„éƒ¨é—¨ï¼Œéƒ½æœ‰ä¸€ä¸ªæ ¹æœ¬çš„æ¿€åŠ±è®¾è®¡çš„é—®é¢˜<ul><li>èƒ½è¯„ä»·å’Œå¥–æƒ©å·¥ä½œä¸šç»©çš„ä¸Šçº§ï¼Œèƒ½å†³å®šå·¥ä½œå†…å®¹çš„ä¸Šçº§ï¼Œå—ä¸‹çº§å·¥ä½œå½±å“æœ€å¤§çš„ä¸Šçº§ï¼Œåº”è¯¥å°½é‡æ˜¯åŒä¸€ä¸ªä¸Šçº§</li></ul></li></ul></li><li>åœ°æ–¹ç®¡ç†<ul><li>æ›´åŠ å®è§‚ï¼Œæ›´åŠ éœ€è¦å¤šéƒ¨é—¨åˆä½œçš„æ–¹é¢ï¼Œæ¯”å¦‚ç»æµå‘å±•</li><li>éœ€è¦ç»™åœ°æ–¹æ”¾æƒï¼Œåœ°æ–¹è´Ÿè´£ä¸”åœ°æ–¹èƒ½å¤Ÿåˆ†äº«å‘å±•æˆæœ</li></ul></li></ul><h2 id="2-5-æ‹›å•†å¼•èµ„"><a href="#2-5-æ‹›å•†å¼•èµ„" class="headerlink" title="2.5 æ‹›å•†å¼•èµ„"></a>2.5 æ‹›å•†å¼•èµ„</h2><aside>ğŸ’¡ åœ°æ–¹æ”¿åºœä¸ä»…åœ¨ä¸ºç»æµå‘å±•åˆ›é€ ç¯å¢ƒï¼Œå®ƒæœ¬èº«å°±æ˜¯ç»æµå‘å±•çš„æ·±åº¦å‚ä¸è€…ã€‚</aside><ul><li>å…¨æ°‘æ‹›å•†æ”¿ç­–<ul><li>å³æ‹›å•†ä¸æ˜¯å•ä¸ªéƒ¨é—¨è¦åšçš„ï¼Œæ˜¯æ‰€æœ‰éƒ¨é—¨éƒ½éœ€è¦ç†Ÿæ‚‰æ”¿ç­–ï¼Œå¯»æ‰¾æ‹›å•†æœºä¼šçš„</li></ul></li><li>åœ°æ–¹æ”¿åºœæ˜¯åŸå¸‚åœŸåœ°æ‰€æœ‰è€…<ul><li>ä¼šå°†å·¥ä¸šç”¨åœ°ä»¥éå¸¸ä¼˜æƒ çš„ä»·æ ¼è½¬è®©ç»™ä¼ä¸šä½¿ç”¨</li><li>è´Ÿè´£å¯¹åœŸåœ°è¿›è¡Œä¸€ç³»åˆ—åˆæœŸå¼€å‘ â€” ä¸ƒé€šä¸€å¹³</li></ul></li><li>é‡‘èæ”¯æŒ<ul><li>æ”¿åºœæ§åˆ¶çš„æŠ•èµ„å¹³å°å…¥è‚¡</li><li>è°ƒåŠ¨æœ¬åœ°å›½ä¼å‚ä¸æŠ•èµ„</li><li>é€šè¿‡å„ç§æ–¹å¼ååŠ©ä¼ä¸šè·å¾—é“¶è¡Œè´·æ¬¾</li></ul></li><li>äº‹åŠ¡ä¸Šæ”¯æŒ<ul><li>å„ç§è®¸å¯</li></ul></li><li>è¡¥è´´ï¼Œç¨æ”¶ä¼˜æƒ </li></ul><h1 id="3-è´¢ç¨ä¸æ”¿åºœè¡Œä¸º"><a href="#3-è´¢ç¨ä¸æ”¿åºœè¡Œä¸º" class="headerlink" title="3. è´¢ç¨ä¸æ”¿åºœè¡Œä¸º"></a>3. è´¢ç¨ä¸æ”¿åºœè¡Œä¸º</h1><ul><li><p>æŠŠæ¡æ”¿åºœçš„çœŸå®æ„å›¾ï¼Œä¸èƒ½å…‰è¯»æ–‡ä»¶ï¼Œè¿˜è¦çœ‹æ”¿åºœèµ„é‡‘çš„æµå‘å’Œæ•°é‡</p></li><li><p>äº‹æƒä¸è´¢åŠ›åŒ¹é… â€” äº‹æƒå’Œæ”¯å‡ºè´£ä»»åŒ¹é…</p></li><li><p>å®é™…æƒ…å†µ</p><ul><li>äº‹æƒä¸è´¢æƒé«˜åº¦ä¸åŒ¹é…<ul><li>è‡ª1994å¹´å®è¡Œåˆ†ç¨åˆ¶æ”¹é©ä¾èµ–ï¼Œåœ°æ–¹è´¢æ”¿é¢„ç®—æ”¯å‡ºji</li></ul></li></ul></li></ul><h2 id="3-1-åˆ†ç¨åˆ¶æ”¹é©"><a href="#3-1-åˆ†ç¨åˆ¶æ”¹é©" class="headerlink" title="3.1 åˆ†ç¨åˆ¶æ”¹é©"></a>3.1 åˆ†ç¨åˆ¶æ”¹é©</h2><ul><li>1985å¹´ â€” 1993å¹´ è´¢æ”¿åŒ…å¹²<ul><li>æ‰¿åŒ…åˆ¶<ul><li>åœŸåœ°æ‰¿åŒ…</li><li>ä¼ä¸šæ‰¿åŒ…</li><li>è´¢æ”¿æ‰¿åŒ…</li></ul></li><li>æ‰¿åŒ…åˆ¶åŸå› ï¼Œæˆ‘å›½åŸºæœ¬å›½ç­–å†³å®šäº†ä¸èƒ½å¯¹æ‰€æœ‰æƒåšå‡ºæ ¹æœ¬æ€§å˜é©ï¼Œåªèƒ½å¯¹ä½¿ç”¨æƒå’Œç»è¥æƒå®è¡Œæ‰¿åŒ…åˆ¶</li><li>å®è¡Œæ–¹å¼<ul><li>1988å¹´åŒ—äº¬  ä»¥1987å¹´è´¢æ”¿æ”¶å…¥ä¸ºåŸºæ•°ï¼Œè®¾å®šä¸€ä¸ªå›ºå®šçš„å¹´æ”¶å…¥å¢é•¿ç‡4%ï¼Œè¶…è¿‡4%çš„éƒ¨åˆ†éƒ½å½’åŒ—äº¬ï¼Œæ²¡è¶…è¿‡çš„éƒ¨åˆ†åˆ™å’Œä¸­å¤®äº”äº”åˆ†æˆ</li></ul></li><li>åœ°æ–¹å®ç°æ–¹å¼<ul><li>å¤§åŠ›å‘å±•ä¹¡é•‡ä¼ä¸š</li></ul></li><li>å½±å“<ul><li>ä¸­å¤®è´¢æ”¿é¢„ç®—æ”¶å…¥å å…¨å›½è´¢æ”¿é¢„ç®—æ€»æ”¶å…¥çš„æ¯”é‡è¶Šæ¥è¶Šä½</li><li>å…¨å›½è´¢æ”¿é¢„ç®—æ€»æ”¶å…¥å GDPçš„æ¯”é‡ä¹Ÿè¶Šæ¥è¶Šä½<ul><li>å¤®åœ°åˆ†æˆæ¯”ä¾‹æ¯è¿‡å‡ å¹´å°±è¦é‡æ–°è°ˆåˆ¤</li><li>é¢„ç®—å¤–æ”¶å…¥å¯ç‹¬äº«ï¼Œå› æ­¤åœ°æ–¹æ”¿åºœç–¯ç‹‚ç»™æ”¿åºœå‡ç¨ï¼Œè—å¯Œäºä¼ä¸šï¼Œå†é€šè¿‡è¡Œæ”¿æ”¶è´¹ï¼Œé›†èµ„ï¼Œæ‘Šæ´¾ï¼ŒèµåŠ©ç­‰æ–¹å¼æ”¶å›ä¸€éƒ¨åˆ†</li></ul></li></ul></li></ul></li><li>1994å¹´åˆ†ç¨åˆ¶æ”¹é©<ul><li>ç¨åŠ¡åˆ†ç±»<ul><li>ä¸­å¤®ç¨</li><li>åœ°æ–¹ç¨</li><li>å…±äº«ç¨<ul><li>å¢å€¼ç¨ â€” å å…¨å›½ç¨æ”¶çš„1/4<ul><li>ä¸­å¤®æ‹¿75% åœ°æ–¹ç•™25%</li><li>è½¬æ¢è¿‡ç¨‹<ul><li>ä¸ºäº†é˜²æ­¢åœ°æ–¹è´¢æ”¿æ”¶å…¥çš„å‰§çƒˆä¸‹è·Œï¼Œè®¾ç«‹äº†ç¨æ”¶è¿”è¿˜çš„æœºåˆ¶ï¼Œä¿è¯æ”¹é©ååœ°æ–¹å¢å€¼ç¨æ”¶å…¥å’Œæ”¹é©å‰ä¸€æ ·ï¼Œæ–°å¢éƒ¨åˆ†æ‰å’Œä¸­å¤®åˆ†</li></ul></li></ul></li></ul></li></ul></li><li>æœºæ„è®¾ç½® â€” ä¸åœ°æ–¹è´¢æ”¿è„±é’©<ul><li>å›½ç¨</li><li>åœ°ç¨</li></ul></li><li>è¡Œæ”¿æ–¹å¼<ul><li>çœä»¥ä¸‹ç¨åŠ¡æœºå…³ä»¥å‚ç›´ç®¡ç†ä¸ºä¸»ï¼Œç”±ä¸Šçº§ç¨åŠ¡æœºæ„è´Ÿè´£ç®¡ç†äººå‘˜å’Œå·¥èµ„</li></ul></li></ul></li></ul><aside>ğŸ’¡ å…¬ä¼—æ‰€æ¥è§¦çš„ä¿¡æ¯å’Œçœ‹åˆ°çš„ç°è±¡ï¼Œå¤§éƒ½æ˜¯å·²ç»åšå¼ˆäº†çš„ç»“æœï¼Œè€Œç¼ºå°‘ç¤¾ä¼šé˜…å†çš„å­¦ç”Ÿå®¹æ˜“æŠŠåšå¼ˆç»“æœé”™å½“æˆåšå¼ˆè¿‡ç¨‹ã€‚æˆåŠŸçš„æ”¿ç­–èƒŒåæ˜¯æˆåŠŸçš„åå•†å’Œå¦¥åï¼Œè€Œä¸æ˜¯æœºæ¢°çš„å‘½ä»¤å’Œæ‰§è¡Œï¼Œæ‰€ä»¥ç†è§£åˆ©ç›Šå†²çªï¼Œç†è§£åè°ƒå’Œè§£å†³æœºåˆ¶ï¼Œæ˜¯ç†è§£æ”¿ç­–çš„åŸºç¡€ã€‚</aside><ul><li>åˆ†ç¨åˆ¶æ”¹é©ä¸­çš„æƒè¡¡<ul><li>93å¹´è°ˆï¼Œæƒ³ä»¥92å¹´ä½œä¸ºåŸºå¹´ï¼Œä½†æ˜¯åå•†åæ”¹æˆ93å¹´ï¼Œå› æ­¤å„ä¸ªåœ°æ–¹æ”¿åºœå¼€å§‹93å¹´çªå‡»ç¼´ç¨</li></ul></li><li>åˆ†ç¨åˆ¶æ”¹é©çš„å½±å“<ul><li>ä¸­å¤®å å…¨å›½é¢„ç®—æ€»æ”¶å…¥çš„æ¯”é‡ä»æ”¹é©å‰20% åˆ°äº†55%</li><li>å›½å®¶é¢„ç®—æ”¶å…¥å GDPçš„æ¯”é‡ä»11%å¢åŠ åˆ°äº†20%ä»¥ä¸Š</li></ul></li></ul><h2 id="3-2-åœŸåœ°è´¢æ”¿"><a href="#3-2-åœŸåœ°è´¢æ”¿" class="headerlink" title="3.2 åœŸåœ°è´¢æ”¿"></a>3.2 åœŸåœ°è´¢æ”¿</h2><aside>ğŸ’¡ åˆ†ç¨åˆ¶æ”¹é©å‡å°‘äº†åœ°æ–¹æ”¿åºœçš„å¯æ”¯é…çš„è´¢æ”¿èµ„æºï¼Œä½†æ˜¯æ²¡æœ‰æ”¹å˜ä»¥ç»æµå»ºè®¾ä¸ºä¸­å¿ƒçš„ä»»åŠ¡ï¼›å‘å±•ç»æµæ‰€éœ€çš„è¯¸å¤šé¢å¤–æ”¯å‡ºï¼Œæ¯”å¦‚æ‹›å•†å¼•èµ„ï¼ŒåœŸåœ°å¼€å‘ç­‰ï¼Œéœ€è¦å¦ç­¹èµ„é‡‘äº†</aside><ul><li>è§£å†³æ–¹æ¡ˆ<ul><li>åŠªåŠ›æé«˜ç¨æ”¶è§„æ¨¡</li><li>å¢åŠ é¢„ç®—å¤–æ”¶å…¥<ul><li>å›´ç»•åœŸåœ°å‡ºè®©å’ŒåœŸåœ°å¼€å‘æ‰€äº§ç”Ÿçš„çš„åœŸåœ°è´¢æ”¿</li></ul></li></ul></li><li>åœ°æ–¹æ”¿åºœé’çé‡èµ„äº§çš„åˆ¶é€ ä¸š<ul><li>æŠ•èµ„è§„æ¨¡å¤§ï¼Œå¯¹GDPçš„æ‹‰åŠ¨ä½œç”¨æ˜æ˜¾</li><li>å¢å€¼ç¨åœ¨ç”Ÿäº§ç¯èŠ‚å¢æ”¶ï¼Œè·Ÿç”Ÿäº§è§„æ¨¡ç›´æ¥æŒ‚é’©</li><li>åˆ¶é€ ä¸šä¸ä»…å¯ä»¥å¸çº³ä»å†œä¸šéƒ¨é—¨è½¬ç§»å‡ºæ¥çš„ä½æŠ€èƒ½åŠ³åŠ¨åŠ›ï¼Œä¹Ÿå¯ä»¥å¸¦åŠ¨ç¬¬ä¸‰äº§ä¸šå‘å±•ï¼Œå¢åŠ ç›¸å…³ç¨æ”¶</li></ul></li><li>æ¼”å˜è¿›ç¨‹<ul><li>1998å¹´ å•ä½åœæ­¢ç¦åˆ©åˆ†æˆ¿</li><li>1997 - 2002å¹´ åŸé•‡ä½å®…æ–°å¼€å·¥é¢ç§¯å¹´å‡å¢é•¿26%</li><li>2001å¹´ å›½å®¶æ¨è¡Œæ‹›æ ‡æ‹å–</li><li>2002å¹´ å›½åœŸéƒ¨æ˜ç¡®å››ç±»ç»è¥ç”¨åœ° å•†ä¸šï¼Œæ—…æ¸¸ï¼Œå¨±ä¹ï¼Œæˆ¿åœ°äº§é‡‡ç”¨æ‹›æ‹æŒ‚çš„åˆ¶åº¦</li><li>å›½æœ‰åœŸåœ°è½¬è®©æ”¶å…¥å åœ°æ–¹å…¬å…±é¢„ç®—æ”¶å…¥çš„æ¯”é‡åœ¨60%å·¦å³ ä»1999å¹´ä½äº10% åˆ°ç°åœ¨çš„é«˜åº¦</li></ul></li><li>åœŸåœ°è´¢æ”¿å›Šæ‹¬<ul><li>åœŸåœ°ä½¿ç”¨æƒè½¬è®©æ”¶å…¥</li><li>å’ŒåœŸåœ°ä½¿ç”¨å¼€å‘æœ‰å…³çš„å„ç§ç¨æ”¶æ”¶å…¥<ul><li>å¤§éƒ¨åˆ†ç¨åŸºæ˜¯ä»·å€¼è€Œéé¢ç§¯</li></ul></li></ul></li><li>é—®é¢˜<ul><li>åœŸåœ°èµ„æœ¬åŒ–è¿ä½œï¼Œæ˜¯åœ¨å°†æœªæ¥çš„æ”¶ç›ŠæŠµæŠ¼åˆ°ä»Šå¤©æ¥å€Ÿé’±ï¼Œå› ä¸ºåœ°æ–¹å®˜å‘˜ä»»æœŸæœ‰é™ï¼ŒæŠ•èµ„è´¨é‡æ˜¯éš¾ä»¥ä¿è¯çš„</li></ul></li></ul><h2 id="3-3-æ¨ªå‘çºµå‘çš„ä¸å¹³è¡¡"><a href="#3-3-æ¨ªå‘çºµå‘çš„ä¸å¹³è¡¡" class="headerlink" title="3.3 æ¨ªå‘çºµå‘çš„ä¸å¹³è¡¡"></a>3.3 æ¨ªå‘çºµå‘çš„ä¸å¹³è¡¡</h2><p>åˆ†ç¨åˆ¶æ”¹é©ä»¥åï¼Œä¸­å¤®æ‹¿èµ°äº†å¤§å¤´ï¼Œä½†äº‹æƒ…è¿˜æ˜¯åœ°æ–¹åŠï¼Œåœ°æ–¹æ”¶æ”¯å·®è·éœ€è¦ä¸­å¤®è¿›è¡Œè½¬ç§»æ”¯ä»˜ã€‚å…¨å›½æ€»æ•°ä¸Šæ¥çœ‹ï¼Œèƒ½è¡¥å¾—ä¸Šã€‚ä½†æ€»æ•°ä¸å¾—ä¸Šä¸ä»£è¡¨æ¯ä¸€çº§æ”¿åºœéƒ½èƒ½å¤Ÿè¡¥å¾—ä¸Šã€‚</p><ul><li><p>é—®é¢˜</p><ul><li>è´¢æƒå±‚å±‚ä¸Šæ”¶ï¼Œäº‹æƒå±‚å±‚ä¸‹å‹<ul><li>2000å¹´ æ¹–åŒ—ç›‘åˆ©å¿â€œå†œæ°‘çœŸè‹¦ï¼Œå†œæ‘çœŸç©·ï¼Œå†œä¸šçœŸå±é™©â€ â€” ä¸‰å†œé—®é¢˜<ul><li>å†œæ‘ç¨è´¹æ”¹é©ï¼Œåˆ¶æ­¢åŸºå±‚çš„ä¹±æ‘Šæ´¾ä¹±æ”¶è´¹é—®é¢˜</li><li>åºŸæ­¢å†œä¸šç¨</li></ul></li></ul></li><li>è´¢ç¨ä½“åˆ¶çš„å±‚çº§é—®é¢˜</li></ul></li><li><p>è§£å†³æ–¹æ¡ˆ</p><ul><li>å†œæ‘åŸºæœ¬å…¬å…±æœåŠ¡å¼€å§‹ çº³å…¥å›½å®¶å…¬å…±è´¢æ”¿ä¿éšœèŒƒå›´ï¼Œä¸­å¤®åœ°æ–¹æ”¿åºœå…±åŒæ‰¿æ‹…</li><li>åœ¨è½¬ç§»æ”¯ä»˜ä¸­åŠ å…¥æ¿€åŠ±æœºåˆ¶ï¼Œé¼“åŠ±åŸºå±‚æ”¿åºœè¾¾æˆç‰¹å®šç›®æ ‡ï¼Œå¹¶ç»™äºˆå¥–åŠ±</li><li>å°†åŸºå±‚è´¢æ”¿èµ„æºå‘ä¸Šä¸€çº§æ”¿åºœç»Ÿç­¹<ul><li>ä¹¡è´¢å¿ç®¡</li><li>æ‰©æƒå¼ºå¿</li><li>è´¢æ”¿çœç›´ç®¡å¿</li></ul></li></ul></li><li><p>ä¸­å¤®æ”¿åºœé€šè¿‡å†åˆ†é…  è½¬ç§»æ”¯ä»˜ï¼Œæ”¯æ´ä¸­è¥¿éƒ¨</p></li></ul><h1 id="4-æ”¿åºœæŠ•èèµ„ä¸å€ºåŠ¡"><a href="#4-æ”¿åºœæŠ•èèµ„ä¸å€ºåŠ¡" class="headerlink" title="4. æ”¿åºœæŠ•èèµ„ä¸å€ºåŠ¡"></a>4. æ”¿åºœæŠ•èèµ„ä¸å€ºåŠ¡</h1><aside>ğŸ’¡ åœŸåœ°ä¸ä¼šç§»åŠ¨ä¹Ÿä¸ä¼šæ¶ˆå¤±ï¼Œå¤©ç„¶é€‚åˆä½œæŠµæŠ¼ï¼Œåšå„ç§èµ„æœ¬äº¤æ˜“çš„å‹ä»“æ ‡çš„ï¼Œèº«ä»·è‡ªç„¶é£™å‡ã€‚åœŸåœ°èµ„æœ¬åŒ–çš„é­”åŠ›ï¼Œåœ¨äºå¯ä»¥æŒ£è„±ç‰©ç†å±æ€§ï¼Œåœ¨æŠ½è±¡çš„æ„ä¹‰ä¸Šäº¤æ˜“æ‰¿è¯ºå’Œå¸Œæœ›ï¼Œå°†è¿‡å»çš„å‚¨è“„ï¼Œç°åœ¨çš„æ”¶å…¥ï¼Œæœªæ¥çš„å‰é€”ï¼Œç»Ÿç»Ÿæ±‡èšå’Œå°å­˜åœ¨ä¸€å°ç‰‡åœŸåœ°ä¸Šï¼Œä½¿å…¶ä»·å€¼æš´å¢ã€‚ç»æµå‘å±•çš„å¥¥ç§˜ä¹‹ä¸€ï¼Œå°±æ˜¯å°†æœ‰å½¢èµ„äº§è½¬å˜æˆä¸ºè¿™ç§æŠ½è±¡èµ„æœ¬ï¼Œä»è€Œèšåˆè·¨è¶Šç©ºé—´å’Œæ—¶é—´çš„èµ„æºã€‚</aside><h2 id="4-1-åŸæŠ•å…¬å¸å’ŒåœŸåœ°é‡‘è-â€”-åœŸåœ°å¼€å‘å’ŒåŸºç¡€è®¾æ–½æŠ•èµ„"><a href="#4-1-åŸæŠ•å…¬å¸å’ŒåœŸåœ°é‡‘è-â€”-åœŸåœ°å¼€å‘å’ŒåŸºç¡€è®¾æ–½æŠ•èµ„" class="headerlink" title="4.1 åŸæŠ•å…¬å¸å’ŒåœŸåœ°é‡‘è â€” åœŸåœ°å¼€å‘å’ŒåŸºç¡€è®¾æ–½æŠ•èµ„"></a>4.1 åŸæŠ•å…¬å¸å’ŒåœŸåœ°é‡‘è â€” åœŸåœ°å¼€å‘å’ŒåŸºç¡€è®¾æ–½æŠ•èµ„</h2><ul><li>æ³•å¾‹è§„å®šï¼Œåœ°æ–¹æ”¿åºœä¸å¯ä»¥ä»é“¶è¡Œè´·æ¬¾ï¼Œ2015å¹´å‰ä¹Ÿä¸å…è®¸å‘è¡Œå€ºåˆ¸ â€” å› æ­¤åœ°æ–¹æ”¿åºœéœ€è¦æˆç«‹å…¬å¸<ul><li>å›½æœ‰ç‹¬èµ„ä¼ä¸š â€” åœ°æ–¹æ”¿åºœèèµ„å¹³å° â€” åŸæŠ•å…¬å¸<ul><li>å»ºè®¾æŠ•èµ„ + æŠ•èµ„å¼€å‘ + æ—…æ¸¸å‘å±•</li></ul></li></ul></li><li>åŸæŠ•å…¬å¸çš„ä¸€èˆ¬ç‰¹å¾<ul><li>æŒæœ‰ä»æ”¿åºœå–å¾—çš„å¤§é‡åœŸåœ°ä½¿ç”¨æƒ<ul><li>åœŸåœ°ä½¿ç”¨æƒå¯ä»¥ç”¨æ¥æ’¬åŠ¨é“¶è¡Œè´·æ¬¾ï¼Œä»¥åŠå„ç§å…¶ä»–èµ„é‡‘</li></ul></li><li>ç›ˆåˆ©çŠ¶å†µä¾èµ–æ”¿åºœè¡¥è´´<ul><li>å› ä¸ºæ‰¿æ¥çš„é¡¹ç›®å¾ˆå¤šéƒ½æœ‰åŸºç¡€è®¾æ–½å±æ€§</li><li>é¡¹ç›®æœ¬èº«ç›ˆåˆ©èƒ½åŠ›å¾€å¾€æ¯”è¾ƒå¼±</li></ul></li><li>æ”¿åºœçš„éšæ€§æ‹…ä¿å¯ä»¥è®©ä¼ä¸šå¤§é‡å€Ÿæ¬¾</li></ul></li><li>åœŸåœ°ä¸€çº§å¼€å‘<ul><li>å¹³æ•´æ•´ç†åœŸåœ°</li><li>æŠ•å…¥å¤§ï¼Œåˆ©æ¶¦ä½ï¼Œæ¶‰åŠæ‹†è¿ç­‰é—®é¢˜</li><li>ä¸€èˆ¬ç”±æ”¿åºœèèµ„å¹³å°å…¬å¸å®Œæˆ</li></ul></li><li>åœŸåœ°äºŒçº§å¼€å‘<ul><li>åœŸåœ°çš„å»ºè®¾è¿è¥</li><li>ç”±æˆ¿åœ°äº§å…¬å¸æ¥åš</li></ul></li><li>åå¤å¹¸ç¦çš„æ–¹å¼â€”- æ”¿åºœå’Œç¤¾ä¼šèµ„æœ¬åˆä½œ Public Private Partnership â€” PPP<ul><li>äº§åŸç»“åˆ</li><li>æ”¿åºœå§”æ‰˜åå¤å¹¸ç¦åšä½å®…ç”¨åœ°çš„ä¸€çº§å¼€å‘</li><li>è¿™ç‰‡ç†Ÿåœ°è¦è¿˜ç»™æ”¿åºœçš„</li><li>å†ä»¥æ‹›æ‹æŒ‚ç­‰å…¬å¼€æ–¹å¼å‡ºè®©ç»™ä¸­æ ‡çš„æˆ¿åœ°äº§ä¼ä¸š</li><li>ä»å·¥ä¸šå›­åŒºçš„å‘å±•å½“ä¸­ï¼Œå…¶å¯ä»¥å’Œæ”¿åºœåˆ†äº«ç¨æ”¶æ”¶ç›Š<ul><li>æŒ‰ç…§æ³•å¾‹ï¼Œæ”¿åºœä¸èƒ½å’Œä¼ä¸šç›´æ¥åˆ†äº«ç¨æ”¶ï¼Œä½†æ˜¯å¯ä»¥è´­ä¹°ä¼ä¸šæœåŠ¡ï¼Œç”¨äº§ä¸šå‘å±•æœåŠ¡è´¹çš„åä¹‰æ¥æ”¯ä»˜çº¦å®šçš„åˆ†æˆ</li></ul></li></ul></li></ul><h2 id="4-2-åœ°æ–¹æ”¿åºœå€ºåŠ¡"><a href="#4-2-åœ°æ–¹æ”¿åºœå€ºåŠ¡" class="headerlink" title="4.2 åœ°æ–¹æ”¿åºœå€ºåŠ¡"></a>4.2 åœ°æ–¹æ”¿åºœå€ºåŠ¡</h2><ul><li><p>æ”¿åºœä¾é åœŸåœ°ä½¿ç”¨æƒè½¬è®©æ”¶å…¥æ”¯æ’‘èµ·åœŸåœ°è´¢æ”¿ï¼Œå¹¶å°†æœªæ¥çš„åœŸåœ°æ”¶ç›Šèµ„æœ¬åŒ–ï¼Œä»é“¶è¡Œå’Œå…¶ä»–æ¸ é“å€Ÿå…¥å¤©é‡èµ„é‡‘ï¼Œåˆ©ç”¨åœŸåœ°é‡‘èï¼Œå¿«é€Ÿæ¨åŠ¨å·¥ä¸šåŒ–å’ŒåŸå¸‚åŒ–ï¼Œä½†ä¹ŸåŒæ—¶ç§¯ç´¯äº†å¤§é‡å€ºåŠ¡</p></li><li><p>æ¨¡å¼çš„å…³é”®</p><ul><li>åœŸåœ°ä»·æ ¼<ul><li>åªè¦ä¸æ–­åœ°æŠ•èµ„å’Œå»ºè®¾èƒ½å¸¦æ¥æŒç»­çš„ç»æµå¢é•¿ï¼ŒåŸå¸‚å°±ä¼šæ‰©å¼ ï¼Œåœ°ä»·å°±ä¼šä¸Šæ¶¨</li><li>è¿™æ ·å°±èƒ½å¤Ÿå¿è¿˜è¿æœ¬å¸¦åˆ©è¶Šæ¥è¶Šå¤šçš„å€ºåŠ¡</li><li>ä½†æ˜¯ç»æµå¢é€Ÿä¸€æ—¦æ”¾ç¼“ï¼Œåœ°ä»·ä¸‹è·Œï¼ŒåœŸåœ°å‡ºè®©æ”¶å…¥å‡å°‘ï¼Œç´¯ç§¯çš„å€ºåŠ¡å°±ä¼šæˆä¸ºæ²‰é‡è´Ÿæ‹…ï¼Œå¯èƒ½å‹å®èèµ„å¹³å°ç”šè‡³åœ°æ–¹æ”¿åºœ</li></ul></li></ul></li><li><p>å›½å®¶å¼€å‘é“¶è¡Œå’ŒåŸæŠ•å€º</p><ul><li>ä¸ºä»€ä¹ˆéœ€è¦ä¸Šè¿°äºŒè€…<ul><li>å› ä¸ºåœ°æ–¹æ”¿åºœç©·ï¼Œä½†æ˜¯è¿˜è¦å‘å±•ç»æµï¼ŒåšåŸå¸‚åŒ–</li><li>æƒ³è¦åœ¨åŸå¸‚å»ºè®¾å¼€å‘å½“ä¸­å¼•å…¥é“¶è¡Œèµ„é‡‘ï¼Œéœ€è¦è§£å†³ä¸‰ä¸ªé—®é¢˜<ul><li>éœ€è¦ä¸€ä¸ªèƒ½å€Ÿæ¬¾çš„å…¬å¸ï¼Œæ”¿åºœä¸èƒ½ç›´æ¥ä»é“¶è¡Œè´·æ¬¾</li><li>åŸå»ºå¼€å‘é¡¹ç›®å¤æ‚ï¼Œæœ‰äº›èµšé’±ï¼Œæœ‰äº›èµ”é’±ï¼Œæ‰€ä»¥éœ€è¦æ‰“åŒ…æ†ç»‘</li><li>ä¾é è´¢æ”¿é¢„ç®—æ”¶å…¥ä¸å¤Ÿè¿˜å€ºçš„ï¼Œè¦èƒ½æŠŠè·ŸåœŸåœ°æœ‰å…³çš„æ”¶ç›Šç”¨èµ·æ¥</li></ul></li></ul></li><li>ä¸ºäº†è§£å†³ä¸Šè¿°å¼•å…¥èµ„é‡‘çš„é—®é¢˜ï¼Œå‡ºç°äº†<strong>åŸæŠ•å…¬å¸</strong><ul><li>å›½å®¶å¼€å‘é“¶è¡Œåˆ›ç«‹çš„è¿™ç§æ¨¡å¼<ul><li>è´·æ¬¾ï¼Œç„¶åå¯ä»¥ç”¨åœŸåœ°å‡ºè®©æ”¶ç›Šä½œä¸ºè´¨æŠ¼è¿›è¡Œè¿˜æ¬¾ä¿è¯</li></ul></li></ul></li><li>åŸå•†è¡Œ<ul><li>ä¸ƒæˆå·¦å³ç¬¬ä¸€è‚¡ä¸œä¸ºåœ°æ–¹æ”¿åºœ</li><li>ä¸ºäº†æ–¹ä¾¿ä¸ºèèµ„å¹³å°å…¬å¸å’ŒåŸºç¡€è®¾æ–½å»ºè®¾æä¾›è´·æ¬¾</li><li>é£é™©<ul><li>åŸºç¡€è®¾æ–½å»ºè®¾é¡¹ç›®å‘¨æœŸé•¿ï¼Œéœ€è¦ä¸­é•¿æœŸè´·æ¬¾<ul><li>å›½å¼€è¡Œæ˜¯æ”¿ç­–æ€§é“¶è¡Œï¼Œæœ‰ç¨³å®šçš„é•¿æœŸèµ„é‡‘æ¥æº</li><li>ä½†æ˜¯å•†ä¸šé“¶è¡Œçš„å­˜æ¬¾å¤§éƒ½æ¥è‡ªçŸ­æœŸå­˜æ¬¾ï¼Œä¸ä¸­é•¿æœŸè´·æ¬¾æœŸé™ä¸åŒ¹é…ï¼Œå®¹æ˜“äº§ç”Ÿé£é™©</li></ul></li><li>å››å¤§è¡Œå­˜æ¬¾æ¥æºåºå¤§ï¼Œå¯ä»¥æ‰¿å—ä¸€å®šç¨‹åº¦æœŸé™é”™é…ï¼Œä½†æ˜¯åŸå•†è¡Œä¸èƒ½ï¼Œç»å¸¸éœ€è¦åœ¨èµ„æœ¬å¸‚åœºèèµ„ï¼Œå®¹æ˜“å‡ºç°é£é™©<ul><li>åŒ…å•†é“¶è¡Œ</li></ul></li></ul></li></ul></li><li>åŸæŠ•å…¬å¸èèµ„æ–¹å¼<ul><li>é“¶è¡Œè´·æ¬¾</li><li>å‘è¡Œå€ºåˆ¸<ul><li>ç†è®ºä¼˜åŠ¿<ul><li>åˆ†æ•£é£é™©</li><li>å€ºåˆ¸å¯äº¤æ˜“ï¼Œä»·æ ¼å’Œåˆ©ç‡å¯å˜ï¼Œé…ç½®æ•ˆç‡é«˜</li></ul></li><li>å®é™…<ul><li>ä¸ƒå…«æˆå•†ä¸šé“¶è¡Œæ‰€æœ‰</li><li>éšæ€§èƒŒä¹¦ï¼Œå°½ç®¡æœ‰é£é™©ï¼Œä½†æ˜¯å¤§å®¶æœ‰ç‚¹ä¸ç®¡ä¸é¡¾</li></ul></li></ul></li></ul></li><li>åœ°æ–¹å€ºåŠ¡<ul><li>éšæ€§è´Ÿå€ºå¾ˆå¤š</li><li>å±€éƒ¨é£é™©å¤§</li><li>å¾ˆå¤šåœ°æ–¹éƒ½é ç€ä¸­å¤®çš„è¡¥è´´ä¿è¯ä¸è¿çº¦ï¼Œä½†æ˜¯å¦‚æœç»æµé‡å†·ï¼Œåœ°ä»·ä¸‹è·Œï¼Œæ”¿åºœä¹Ÿæ— æ³•èƒŒèµ·è¿™æ²‰é‡çš„å€ºåŠ¡äº†</li></ul></li></ul></li><li><p>åœ°æ–¹å€ºçš„æ²»ç†</p><ul><li>å€ºåŠ¡ç½®æ¢<ul><li>ç”¨åœ°æ–¹æ”¿åºœå‘è¡Œçš„å…¬å€ºï¼Œæ›¿æ¢ä¸€éƒ¨åˆ†èèµ„å¹³å°å…¬å¸çš„é“¶è¡Œè´·æ¬¾å’ŒåŸæŠ•å€º<ul><li>å¥½å¤„<ul><li>åˆ©ç‡ä»ä¹‹å‰çš„7% - 8% é™ä½åˆ°4%å·¦å³<ul><li>åŸå…ˆå› ä¸ºæœ‰æ”¿åºœçš„éšæ€§æ‹…ä¿ï¼Œæ‰€ä»¥é“¶è¡Œéƒ½æ„¿æ„è´·ç»™åŸæŠ•ï¼Œè¿™æ ·è¿˜æ‹‰é«˜äº†ä¸€èˆ¬ä¼ä¸šçš„è´·æ¬¾æˆæœ¬å’Œéš¾åº¦</li></ul></li><li>æ”¿åºœå…¬å€ºæœŸé™è¦é•¿å¾ˆå¤š<ul><li>é™ä½äº†æœŸé™é”™é…å’ŒæµåŠ¨æ€§çš„é£é™©</li></ul></li><li>ä¿¡ç”¨çº§åˆ«å‡é«˜</li></ul></li></ul></li><li>å¦‚ä½•ç¡®å®šå€ºåŠ¡ç½®æ¢çš„è§„æ¨¡<ul><li>å›½åŠ¡é™¢ç¡®å®šå¹¶æŠ¥å…¨å›½äººå¤§æˆ–è€…äººå¤§å¸¸å§”ä¼šæ‰¹å‡†</li></ul></li></ul></li><li>æ¨åŠ¨èèµ„å¹³å°è½¬å‹<ul><li>å‰¥ç¦»ä¸ºæ”¿åºœèèµ„çš„åŠŸèƒ½ï¼ŒåŒæ—¶ç ´é™¤æ”¿åºœçš„éšæ€§æ‹…ä¿</li></ul></li><li>çº¦æŸé“¶è¡Œå’Œå„ç±»é‡‘èæœºæ„ï¼Œé¿å…å¤§é‡èµ„é‡‘æµå…¥èèµ„å¹³å°</li><li>é—®è´£å®˜å‘˜ï¼Œå¯¹äºè¿‡åº¦è´Ÿå€ºçš„è¡Œä¸ºç»ˆèº«è¿½è´£</li></ul></li></ul><h2 id="4-3-æ‹›å•†å¼•èµ„å½“ä¸­çš„åœ°æ–¹å®˜å‘˜"><a href="#4-3-æ‹›å•†å¼•èµ„å½“ä¸­çš„åœ°æ–¹å®˜å‘˜" class="headerlink" title="4.3 æ‹›å•†å¼•èµ„å½“ä¸­çš„åœ°æ–¹å®˜å‘˜"></a>4.3 æ‹›å•†å¼•èµ„å½“ä¸­çš„åœ°æ–¹å®˜å‘˜</h2><ul><li>å®˜å‘˜æ”¿ç»©ä¸æ¿€åŠ±æœºåˆ¶<ul><li>åœ°æ–¹ä¸»å®˜å¹³å‡ä»»æœŸä¸‰å››å¹´ï¼Œè€ŒåŸºå»ºé¡¹ç›®ä¸€èˆ¬éƒ½è¦ä¸¤ä¸‰å¹´å®Œæˆ</li><li>æ•…è€Œåˆšä¸Šä»»ä¼šä¸Šé©¬å¤§é‡è¿™ç§é¡¹ç›®</li><li>å„åœ°çš„æŠ•èµ„ æ”¿æ²»æŠ•èµ„å‘¨æœŸæ¯”è¾ƒé¢‘ç¹<ul><li>æ–°å®˜ä¸Šä»»ï¼ŒåœŸåœ°å‡ºè®©æ•°é‡ä¼šå¢åŠ </li><li>æ–°å¢çš„åœŸåœ°ä¾›åº”å¤§å¤šä½äºåŸå¸‚å‘¨è¾¹éƒŠåŒº</li><li>æ‘Šå¤§é¥¼çš„æ€åŠ¿</li></ul></li></ul></li><li>åé‡æŠ•èµ„çš„å¢é•¿æ¨¡å¼å¸¦æ¥çš„é—®é¢˜<ul><li>æ”¿åºœå€ºåŠ¡çš„ä¸æ–­æ”€å‡</li><li>é‡è§†çœ‹å¾—è§çš„ä¸œè¥¿ï¼Œå¿½ç•¥çœ‹ä¸è§çš„</li></ul></li><li>2019è€ƒæ ¸å®˜å‘˜æ ‡å‡†å‘ç”Ÿå˜åŒ–<ul><li>çœ‹å…¨é¢å·¥ä½œï¼Œçœ‹æ¨åŠ¨æœ¬åœ°åŒºç»æµå»ºè®¾ï¼Œæ”¿æ²»å»ºè®¾ï¼Œæ–‡åŒ–å»ºè®¾ï¼Œç¤¾ä¼šå»ºè®¾ï¼Œç”Ÿæ€æ–‡æ˜å»ºè®¾</li><li>è§£å†³å‘å±•ä¸å¹³è¡¡ä¸å……åˆ†çš„é—®é¢˜</li><li>æ»¡è¶³äººæ°‘æ—¥ç›Šå¢é•¿çš„ç¾å¥½ç”Ÿæ´»éœ€è¦çš„æƒ…å†µå’Œå®é™…æˆæ•ˆ</li></ul></li></ul><h1 id="5-å·¥ä¸šåŒ–ä¸­çš„æ”¿åºœè§’è‰²"><a href="#5-å·¥ä¸šåŒ–ä¸­çš„æ”¿åºœè§’è‰²" class="headerlink" title="5. å·¥ä¸šåŒ–ä¸­çš„æ”¿åºœè§’è‰²"></a>5. å·¥ä¸šåŒ–ä¸­çš„æ”¿åºœè§’è‰²</h1><ul><li><p>æ”¿åºœä¸å…·ä½“çš„å·¥ä¸šä¼ä¸šçš„åˆä½œ</p><ul><li>äº¬ä¸œæ–¹<ul><li>ä¸å…¶è¯´æ˜¯ä¸€å®¶å…¬å¸çš„å¥‹æ–—å²ï¼Œä¸å¦‚è¯´æ˜¯æ¶²æ™¶å±äº§ä¸šåœ¨ä¸­å›½çš„å¥‹æ–—å²</li></ul></li></ul></li><li><p>ç°ä»£ç»æµçš„è§„æ¨¡ç»æµæ•ˆåº”éå¸¸å¼ºï¼Œæ–°ä¼ä¸šçš„è¿›å…¥é—¨æ§›éå¸¸é«˜ï¼Œä¸ä»…æŠ•èµ„é¢åº¦å¤§ï¼Œè¿˜è¦é¢å¯¹å…ˆè¿›å…¥è€…å·²ç»ç§¯ç´¯èµ·æ¥çš„å·¨å¤§æˆæœ¬å’ŒæŠ€æœ¯çš„ä¼˜åŠ¿</p></li><li><p>ä¸œäºšç»æµå¥‡è¿¹ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹ç‚¹</p><ul><li>æ”¿åºœå¸®åŠ©æœ¬åœŸä¼ä¸šè¿›å…¥å¤æ‚åº¦å¾ˆé«˜çš„è¡Œä¸š</li><li>å……åˆ†åˆ©ç”¨å…¶ä¸­çš„å­¦ä¹ æ•ˆåº”ï¼Œè§„æ¨¡æ•ˆåº”ä»¥åŠæŠ€æœ¯å¤–æº¢æ•ˆåº”</li><li>è¿…é€Ÿæå‡æœ¬åœŸåˆ¶é€ ä¸šçš„æŠ€æœ¯èƒ½åŠ›å’Œå›½é™…ç«äº‰åŠ›</li></ul></li><li><p>æ–°å…´åˆ¶é€ ä¸šåœ¨åœ°ç†ä¸Šçš„é›†èšæ•ˆåº”æ˜¯å¾ˆå¼ºçš„ï¼Œå› ä¸ºæ‰å †ç”Ÿäº§å¯ä»¥èŠ‚çº¦åŸææ–™å’Œä¸­é—´æŠ•å…¥çš„è¿è¾“æˆæœ¬</p><ul><li>ä¸”åŒè¡Œèšé›†åœ¨ä¸€èµ·æœ‰åˆ©äºçŸ¥è¯†å’ŒæŠ€æœ¯äº¤æµï¼Œå¤–æº¢æ•ˆåº”å¾ˆå¼º</li><li>å› æ­¤äº§ä¸šé›†ç¾¤ä¸€æ—¦å½¢æˆï¼Œè‡ªèº«å¼•åŠ›å°±ä¼šä¸æ–­å¢å¼ºï¼Œå¾ˆéš¾è¢«å¤–åŠ›æ‰“ç ´</li></ul></li><li><p>å…‰ä¼äº§ä¸š</p><ul><li>æ–°æŠ€æœ¯å¼€å§‹æˆæœ¬ä¼šéå¸¸é«˜ï¼Œå…¶å®éƒ½æ˜¯é æ”¿åºœè¡¥è´´èµšé’±</li><li>æ”¿åºœé€šè¿‡è¡¥è´´é¢åº¦çš„é™ä½æ¥å¼•å¯¼å„ä¸ªä¼ä¸šçš„å‘å±•</li></ul></li><li><p>æ”¿åºœäº§ä¸šå¼•å¯¼åŸºé‡‘ä¸ç§å‹ŸåŸºé‡‘</p><ul><li>LP limited partner  ç»™é’±çš„</li><li>GP general partner æŠ•èµ„çš„</li><li>å¯ä»¥æŠ•ä¸€çº§å¸‚åœºä»¥åŠäºŒçº§å¸‚åœº</li><li>å›½å†…çš„æœ€å¤§ä¸€ç±»LPå°±æ˜¯æ”¿åºœå¼•å¯¼åŸºé‡‘</li></ul></li><li><p>äº§ä¸šå¼•å¯¼åŸºé‡‘çš„ç‰¹ç‚¹</p><ul><li>å¤§å¤šäº§ä¸šå¼•å¯¼åŸºé‡‘ä¸ç›´æ¥æŠ•èµ„ä¼ä¸šï¼Œè€Œæ˜¯åšLPï¼Œå°†é’±äº¤ç»™å¸‚åœºåŒ–çš„ç§å‹ŸåŸºé‡‘çš„GPå»æŠ•èµ„ä¼ä¸š<ul><li>å› ä¸ºä¸€æ”¯ç§å‹Ÿä¸ä»…æœ‰æ”¿åºœèµ„é‡‘ï¼Œè¿˜ä¼šæœ‰å¾ˆå¤šç¤¾ä¼šèµ„æœ¬ï¼Œè¿™æ ·å¯ä»¥åšäº§ä¸šå¼•å¯¼</li></ul></li><li>æ”¿åºœå¼•å¯¼åŸºé‡‘æœ¬èº«å°±æ˜¯ä¸€åªåŸºé‡‘ï¼ŒæŠ•èµ„å¯¹è±¡æ˜¯å„ç§ç§å‹ŸåŸºé‡‘ï¼Œè¢«ç§°ä¸ºæ¯åŸºé‡‘  funds of funds</li><li>å€ŸåŠ©å¸‚åœºåŠ›é‡å»ä½¿ç”¨è´¢æ”¿èµ„é‡‘</li><li>å¤§å¤šæ•°å¼•å¯¼åŸºé‡‘çš„æœ€ç»ˆæŠ•å‘éƒ½æ˜¯æˆ˜ç•¥æ–°å…´äº§ä¸šï¼Œæ¯”å¦‚èŠ¯ç‰‡ï¼Œæ–°èƒ½æºæ±½è½¦ï¼Œè€Œä¸å…è®¸åŸºç¡€è®¾æ–½å’Œæˆ¿åœ°äº§</li></ul></li><li><p>è®¾ç½®äº§ä¸šå¼•å¯¼åŸºé‡‘ä¹‹åï¼Œä¹Ÿéœ€è¦ä¸“é—¨çš„å…¬å¸æ¥è¿è¥å’Œç®¡ç†è¿™åªåŸºé‡‘</p><ul><li>è¿ä½œæ¨¡å¼åˆ†ç±»<ul><li>æ”¿åºœç‹¬èµ„å…¬å¸</li><li>æ··åˆæ‰€æœ‰åˆ¶å…¬å¸</li><li>æ”¿åºœå°†é’±å§”æ‰˜ç»™å¸‚åœºåŒ–çš„æ¯åŸºé‡‘ç®¡ç†äººå»è¿è¥</li></ul></li></ul></li><li><p>æ”¿åºœå¼•å¯¼åŸºé‡‘å‘å±•çš„å¤–éƒ¨æ¡ä»¶</p><ul><li>åˆ¶åº¦æ¡ä»¶<ul><li>åˆ¶åº¦å’Œæ”¿ç­–çš„æŒ‡å¼•</li><li>æä¾›æ”¿ç­–åŸºç¡€ï¼šè®¾ç«‹å¼•å¯¼åŸºé‡‘å‘æŒ¥è´¢æ”¿èµ„é‡‘çš„æ æ†æ”¾å¤§æ•ˆåº”ï¼Œå¢åŠ åˆ›ä¸šæŠ•èµ„èµ„æœ¬çš„ä¾›ç»™ï¼Œå…‹æœå•çº¯é€šè¿‡å¸‚åœºé…ç½®åˆ›ä¸šæŠ•èµ„èµ„æœ¬çš„å¸‚åœºå¤±çµé—®é¢˜</li></ul></li><li>äº§ä¸šæ¡ä»¶<ul><li>ç»æµéœ€è¦å‘å±•åˆ°ä¸€å®šçš„æ°´å¹³ï¼Œä½¿å¾—é«˜æŠ€æœ¯ï¼Œé«˜é£é™©çš„æˆ˜ç•¥æ–°å…´è¡Œä¸šå¾—ä»¥å‡ºç°</li></ul></li><li>èµ„æœ¬å¸‚åœºæˆç†Ÿç¨‹åº¦<ul><li>GP ï¼Œè¶³å¤Ÿå¤§çš„è‚¡æƒäº¤æ˜“å¸‚åœºï¼Œé€€å‡ºæ¸ é“</li></ul></li></ul></li></ul><h1 id="6-åœ°æ–¹æ”¿åºœæ¨åŠ¨ç»æµå‘å±•çš„æ¨¡å¼ä¸ç‰¹ç‚¹"><a href="#6-åœ°æ–¹æ”¿åºœæ¨åŠ¨ç»æµå‘å±•çš„æ¨¡å¼ä¸ç‰¹ç‚¹" class="headerlink" title="6. åœ°æ–¹æ”¿åºœæ¨åŠ¨ç»æµå‘å±•çš„æ¨¡å¼ä¸ç‰¹ç‚¹"></a>6. åœ°æ–¹æ”¿åºœæ¨åŠ¨ç»æµå‘å±•çš„æ¨¡å¼ä¸ç‰¹ç‚¹</h1><h2 id="6-1-é‡åœŸåœ°ï¼Œè½»äºº"><a href="#6-1-é‡åœŸåœ°ï¼Œè½»äºº" class="headerlink" title="6.1 é‡åœŸåœ°ï¼Œè½»äºº"></a>6.1 é‡åœŸåœ°ï¼Œè½»äºº</h2><ul><li>ä¼˜ç‚¹<ul><li>å¯ä»¥å¿«é€Ÿæ¨è¿›åŸå¸‚åŒ–å’ŒåŸºç¡€è®¾æ–½å»ºè®¾</li></ul></li><li>ç¼ºç‚¹<ul><li>å…¬å…±æœåŠ¡ä¾›ç»™ä¸è¶³ï¼Œæé«˜äº†æ”¾å‡å’Œå±…æ°‘å€ºåŠ¡è´Ÿæ‹…</li><li>æ‹‰å¤§äº†åœ°åŒºå·®è·å’Œè´«å¯Œå·®è·</li></ul></li></ul><h2 id="6-2-é‡è§„æ¨¡ï¼Œé‡æ‰©å¼ "><a href="#6-2-é‡è§„æ¨¡ï¼Œé‡æ‰©å¼ " class="headerlink" title="6.2 é‡è§„æ¨¡ï¼Œé‡æ‰©å¼ "></a>6.2 é‡è§„æ¨¡ï¼Œé‡æ‰©å¼ </h2><ul><li>ä¼˜ç‚¹<ul><li>æ¨åŠ¨äº†ä¼ä¸šæˆé•¿å’Œå¿«é€Ÿå·¥ä¸šåŒ–</li></ul></li><li>ç¼ºç‚¹<ul><li>åŠ é‡äº†å€ºåŠ¡è´Ÿæ‹…</li><li>ä¼ä¸šï¼Œåœ°æ–¹æ”¿åºœï¼Œå±…æ°‘ä¸‰éƒ¨é—¨å€ºåŠ¡äº’ç›¸ä½œç”¨ï¼ŒåŠ å¤§äº†ç»æµæ•´ä½“çš„å€ºåŠ¡å’Œé‡‘èé£é™©</li></ul></li></ul><h2 id="6-3-é‡æŠ•èµ„ï¼Œé‡ç”Ÿäº§ï¼Œè½»æ¶ˆè´¹"><a href="#6-3-é‡æŠ•èµ„ï¼Œé‡ç”Ÿäº§ï¼Œè½»æ¶ˆè´¹" class="headerlink" title="6.3 é‡æŠ•èµ„ï¼Œé‡ç”Ÿäº§ï¼Œè½»æ¶ˆè´¹"></a>6.3 é‡æŠ•èµ„ï¼Œé‡ç”Ÿäº§ï¼Œè½»æ¶ˆè´¹</h2><ul><li>ä¼˜ç‚¹<ul><li>æ‹‰åŠ¨äº†ç»æµçš„å¿«é€Ÿå¢é•¿ï¼Œæ‰©å¤§äº†å¯¹å¤–è´¸æ˜“</li><li>ä½¿å¾—æˆ‘å›½è¿…é€Ÿæˆä¸ºäº†åˆ¶é€ ä¸šå¼ºå›½</li></ul></li><li>ç¼ºç‚¹<ul><li>ç»æµç»“æ„çš„ä¸å¹³è¡¡</li><li>å¯¹å†…<ul><li>èµ„æºå‘ä¼ä¸šéƒ¨é—¨è½¬ç§»ï¼Œå±…æ°‘æ”¶å…¥å’Œæ¶ˆè´¹å æ¯”åä½ï¼Œä¸åˆ©äºç»æµé•¿æœŸç¨³å®šå‘å±•</li></ul></li><li>å¯¹å¤–<ul><li>å›½å†…æ— æ³•æ¶ˆçº³çš„äº§èƒ½å‘å›½å¤–è¾“å‡ºï¼ŒåŠ å‰§äº†è´¸æ˜“å†²çª</li></ul></li></ul></li></ul><h1 id="7-åŸå¸‚åŒ–ä¸ä¸å¹³è¡¡"><a href="#7-åŸå¸‚åŒ–ä¸ä¸å¹³è¡¡" class="headerlink" title="7. åŸå¸‚åŒ–ä¸ä¸å¹³è¡¡"></a>7. åŸå¸‚åŒ–ä¸ä¸å¹³è¡¡</h1><aside>ğŸ’¡ ä¸­å›½ç‰¹æœ‰çš„åŸå¸‚åœŸåœ°å›½æœ‰åˆ¶åº¦ï¼Œä¸ºæ”¿åºœå„æ–­åœŸåœ°ä¸€çº§å¸‚åœºåˆ›é€ äº†æ¡ä»¶ï¼Œå°†è¿™ç¬”éšåŒ¿çš„è´¢å¯Œå˜æˆäº†å¯åŠ¨åŸå¸‚åŒ–çš„å·¨å¤§èµ„æœ¬ï¼Œä½†ä¹Ÿè®©åœ°æ–¹è´¢æºé«˜åº¦ä¾èµ–åœŸåœ°ä»·å€¼ï¼Œä¾èµ–æˆ¿åœ°äº§å’Œæˆ¿ä»·ã€‚æˆ¿ä»·è¿ç€åœ°ä»·ï¼Œåœ°ä»·è¿ç€è´¢æ”¿ï¼Œè´¢æ”¿è¿ç€åŸºç¡€è®¾æ–½æŠ•èµ„ï¼Œäºæ˜¯ç»æµå¢é•¿ï¼Œåœ°æ–¹è´¢æ”¿ï¼Œé“¶è¡Œï¼Œæˆ¿åœ°äº§ä¹‹é—´å½¢æˆäº†â€œä¸€è£ä¿±è£ï¼Œä¸€æŸä¿±æŸâ€çš„å¤æ‚å…³ç³»ã€‚</aside><h2 id="7-1-æˆ¿ä»·ä¸å±…æ°‘å€ºåŠ¡"><a href="#7-1-æˆ¿ä»·ä¸å±…æ°‘å€ºåŠ¡" class="headerlink" title="7.1 æˆ¿ä»·ä¸å±…æ°‘å€ºåŠ¡"></a>7.1 æˆ¿ä»·ä¸å±…æ°‘å€ºåŠ¡</h2><ul><li><p>1994å¹´åˆ†ç¨åˆ¶æ”¹é©æ˜¯å¾ˆå¤šé‡å¤§ç»æµç°è±¡çš„åˆ†æ°´å²­</p></li><li><p>åœ°åŒºæˆ¿ä»·å·®å¼‚çš„ä¸»è¦åŸå› æ˜¯ä¾›éœ€å¤±è¡¡</p><ul><li>500ä¸‡äººå’Œ1000ä¸‡äººä»¥ä¸Šçš„å¤§åŸå¸‚åŸåŒºäººå£å¢é‡å å…¨å›½åŸåŒºäººå£å¢é‡çš„è¿‘å››æˆï¼Œä½†å±…ä½ç”¨åœ°å¢é‡æ‰å äº®ç¨‹ï¼Œæˆ¿ä»·äºæ˜¯å°±å¿«é€Ÿä¸Šæ¶¨äº†</li></ul></li><li><p>ä¸­å›½å¯¹å»ºè®¾ç”¨åœ°æŒ‡æ ‡å®è¡Œä¸¥æ ¼çš„ç®¡ç†ï¼Œæ¯å¹´çš„æ–°å¢æŒ‡æ ‡ç”±ä¸­å¤®åˆ†é…åˆ°çœï¼Œå†ç”±çœåˆ†é…åˆ°åœ°æ–¹ã€‚</p><ul><li>è¿™äº›æŒ‡æ ‡æ— æ³•è·¨çœäº¤æ˜“</li><li>ä½†æ˜¯è¿™äº›åœŸåœ°å€¾æ–œæ”¿ç­–æ— æ³•æ”¹å˜äººå£æµå‘ï¼Œäººè¿˜æ˜¯ä¸æ–­å‘ä¸œéƒ¨æ²¿æµ·å’Œå¤§åŸå¸‚èšé›†</li></ul></li><li><p>æˆ¿åœ°äº§</p><ul><li>è¢«ç§°ä¸ºç»æµå‘¨æœŸä¹‹æ¯</li><li>æ ¹æºåœ¨äºå…¶å†…åœ¨çš„ä¾›éœ€çŸ›ç›¾<ul><li>é“¶è¡Œå¯ä»¥é€šè¿‡æŒ‰æ­åˆ›é€ å‡ ä¹æ— é™çš„æ–°è´­ä¹°åŠ›</li><li>ä¸å¯å†ç”Ÿçš„åŸå¸‚åœŸåœ°ä¾›ç»™æ˜¯æœ‰é™çš„</li></ul></li><li>è¿™ç§çŸ›ç›¾ç»å¸¸ä¼šå¯¼è‡´èµ„äº§æ³¡æ²«å’Œç ´è£‚çš„å‘¨æœŸå¾ªç¯ï¼Œæ˜¯é‡‘èå’Œæˆ¿åœ°äº§ä¸ç¨³å®šçš„æ ¸å¿ƒçŸ›ç›¾</li></ul></li><li><p>ä¸­å›½æƒ…å†µ</p><ul><li>ä¸­å›½åŸé•‡å±…æ°‘çš„ä¸»è¦è´¢äº§æ˜¯æˆ¿å­ï¼Œæˆ¿äº§å æ®å®¶åº­èµ„äº§çš„å°†è¿‘ä¸ƒæˆ<ul><li>å…­æˆæ˜¯ä½æˆ¿ï¼Œä¸€æˆæ˜¯å•†é“º</li><li>è€Œç¾å›½72%æ˜¯é‡‘èèµ„äº§ï¼Œ28%æ˜¯æˆ¿äº§</li><li>å³ä¸­ç¾ä¸¤å›½è´¢å¯Œçš„å‹èˆ±çŸ³ä¸ä¸€æ ·ï¼Œä¹Ÿå°±èƒ½çœ‹å‡ºä¸ºä»€ä¹ˆä¸­å›½çœ‹ä¸­æˆ¿å¸‚ï¼Œè€Œç¾å›½çœ‹ä¸­è‚¡å¸‚äº†</li></ul></li><li>æˆ¿ä»·ä¸Šæ¶¨çš„å½±å“<ul><li>å¢åŠ æŒ‰æ­å€ºåŠ¡è´Ÿæ‹…</li><li>æ‹‰å¤§è´«å¯Œå·®è·</li><li>åˆºæ¿€ä½æ”¶å…¥äººç¾¤ä¸¾å€ºæ¶ˆè´¹</li></ul></li><li>ä¹¦é‡Œå¯¹äºæˆ¿äº§ï¼Œå½“å‰æƒ…å†µçš„æè¿°æˆ‘è®¤ä¸ºæ˜¯æµ…å°è¾„æ­¢çš„ï¼Œåªç¨å¾®è¯´äº†ä¸‹ï¼Œå‘å‡ºæ¥ä¸å®¹æ˜“~</li></ul></li></ul><h2 id="7-2-ä¸å¹³è¡¡ä¸è¦ç´ å¸‚åœºæ”¹é©"><a href="#7-2-ä¸å¹³è¡¡ä¸è¦ç´ å¸‚åœºæ”¹é©" class="headerlink" title="7.2 ä¸å¹³è¡¡ä¸è¦ç´ å¸‚åœºæ”¹é©"></a>7.2 ä¸å¹³è¡¡ä¸è¦ç´ å¸‚åœºæ”¹é©</h2><ul><li>äººå£æµåŠ¨å’Œæ”¶å…¥å¹³è¡¡<ul><li>æˆ‘å›½äººå£æµåŠ¨ä¾æ—§å—é™<ul><li>é‡åœŸåœ°è½»äººï¼Œå¯¼è‡´æ°‘ç”Ÿæ”¯å‡ºä¸è¶³ï¼Œä¸åˆ©äºå¤–æ¥äººå£åœ¨åŸå¸‚ä¸­çœŸæ­£å®‰å®¶è½æˆ·</li></ul></li></ul></li><li>è¦å¹³è¡¡çš„æ˜¯äººå‡å·®è·ï¼Œè€Œä¸æ˜¯åœ°åŒºå·®è·</li><li>åœŸåœ°æµè½¬<ul><li>å½“å‰æƒ…å†µæ˜¯å¤§åŸå¸‚ä¸ä»…åœŸåœ°é¢ç§¯æœ‰é™ï¼Œè€Œä¸”æœ‰å¯¹å»ºè®¾ç”¨åœ°æŒ‡æ ‡çš„ç®¡åˆ¶</li><li>å¦‚æœç”¨åœ°æŒ‡æ ‡èƒ½å¤Ÿè·Ÿç€äººå£æµåŠ¨ï¼Œä¼šå¾ˆå¤§ç¨‹åº¦ç¯èŠ‚åœŸåœ°ä¾›éœ€çŸ›ç›¾çš„é—®é¢˜</li><li>è¿˜éœ€è¦è®©å†œæ‘é›†ä½“ç”¨åœ°å‚ä¸æµè½¬ â€” å†œæ‘åœŸåœ°å½’é›†ä½“æ‰€æœ‰</li></ul></li><li>æ”¹é©çš„ç›®æ ‡æ˜¯ä¸ºäº†è®©å„ç§èµ„æºæŒ‰ç…§å¸¸ä½äººå£çš„è§„æ¨¡è¿›è¡Œé…ç½®<ul><li>é‡Œé¢æ¶‰åŠåˆ°<ul><li>å»ºç«‹å¥å…¨åŸä¹¡ç»Ÿä¸€çš„å»ºè®¾ç”¨åœ°å¸‚åœº</li><li>æ·±åŒ–æˆ·ç±åˆ¶åº¦çš„æ”¹é©</li><li>ä»¥ç»å¸¸å±…ä½åœ°ç™»è®°æˆ·å£åˆ¶åº¦</li><li>å»ºç«‹åŸé•‡æ•™è‚²ï¼Œå°±ä¸šåˆ›ä¸šï¼ŒåŒ»ç–—å«ç”Ÿç­‰åŸºæœ¬å…¬å…±æœåŠ¡å’Œå¸¸ä½äººå£æŒ‚é’©çš„æœºåˆ¶</li></ul></li></ul></li></ul><h2 id="7-3-ç»æµå‘å±•ä¸è´«å¯Œå·®è·"><a href="#7-3-ç»æµå‘å±•ä¸è´«å¯Œå·®è·" class="headerlink" title="7.3 ç»æµå‘å±•ä¸è´«å¯Œå·®è·"></a>7.3 ç»æµå‘å±•ä¸è´«å¯Œå·®è·</h2><ul><li>é™ä½äº†å…¨çƒçš„ä¸å¹³ç­‰<ul><li>æ”¹å˜äº†å…¨çƒæ”¶å…¥åˆ†å¸ƒçš„æ ¼å±€</li></ul></li><li>å¤§å®¶éƒ½åœ¨å˜å¯Œ<ul><li>2019å¹´æ”¶å…¥æœ€é«˜çš„20%äººç¾¤å æœ‰å…¨éƒ¨æ”¶å…¥çš„48%ï¼Œè€Œæ”¶å…¥æœ€ä½çš„20%åªå æœ‰å…¨éƒ¨æ”¶å…¥çš„8%</li><li>å¦å¤–ä¸€ä¸ªè§†è§’æ˜¯30å¹´é—´ï¼Œå®é™…æ”¶å…¥æ¶¨äº†8 - 13å€ å¹³å‡ä¸‹æ¥</li></ul></li><li>ç»æµå¢é•¿çš„è¿‡ç¨‹<ul><li>å°½ç®¡ä¸ä¸€å®šå‡å°‘æ”¶å…¥å·®è·ï¼Œä½†æ˜¯å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šéåˆ¶è´«å¯Œå·®è·åœ¨ä»£é™…ä¹‹é—´ä¼ é€’</li><li>å½“å‰æƒ…å†µæ˜¯è´¢äº§æ€§æ”¶å…¥å æ”¶å…¥æ¯”é‡è¶Šæ¥è¶Šå¤§ï¼ŒäººåŠ›èµ„æœ¬æ— æ³•åœ¨ä»£é™…ä¹‹é—´ä¼ æ‰¿çš„ï¼Œä½†æ˜¯æˆ¿äº§ç­‰æœ‰å½¢èµ„äº§æ˜¯å¯ä»¥çš„</li><li>ç»æµå¢é€Ÿä¸‹æ»‘ï¼Œç¤¾ä¼šå¯¹ä¸å¹³ç­‰çš„å®¹å¿ç¨‹åº¦å°±ä¼šä¸‹é™äº†ï¼Œä¸å®‰å®šå› ç´ ä¼šå¢åŠ </li></ul></li><li>å¯¹æ”¶å…¥å·®è·çš„å®¹å¿åº¦<ul><li>éš§é“æ•ˆåº”<ul><li>ä¸€æ¡åœ¨åŠ¨ï¼Œåå‘ä¸åŠ¨çš„æ—¶å€™çš„æåº¦ç„¦èº</li></ul></li><li>ç»æµå½¢åŠ¿ä¸å¥½ï¼Œå¯ŒäººåŠ¨çš„æ…¢ï¼Œç©·äººå¯èƒ½å®Œå…¨æ— æ³•æœ‰è´¢å¯Œå¢é•¿äº†</li></ul></li></ul><h1 id="8-å€ºåŠ¡ä¸é£é™©"><a href="#8-å€ºåŠ¡ä¸é£é™©" class="headerlink" title="8. å€ºåŠ¡ä¸é£é™©"></a>8. å€ºåŠ¡ä¸é£é™©</h1><ul><li>å€ºåŠ¡æœ¬èº«çš„é£é™©<ul><li>äººä»¬åœ¨ä¹è§‚çš„æ—¶å€™å¾€å¾€ä¼šä½ä¼°è´Ÿå€ºçš„é£é™©ï¼Œè¿‡å¤šå€Ÿå€ºã€‚å½“é£é™©å‡ºç°çš„æ—¶å€™ï¼Œåˆä¼šå› ä¸ºå€ºåŠ¡è´Ÿæ‹…æ²‰é‡è€Œç¼ºä¹è…¾æŒªçš„ç©ºé—´ï¼Œæ²¡æœ‰åŠæ³•åº”å¯¹ã€‚</li></ul></li></ul><h2 id="8-1-å€ºåŠ¡ä¸ç»æµè¡°é€€"><a href="#8-1-å€ºåŠ¡ä¸ç»æµè¡°é€€" class="headerlink" title="8.1 å€ºåŠ¡ä¸ç»æµè¡°é€€"></a>8.1 å€ºåŠ¡ä¸ç»æµè¡°é€€</h2><ul><li>è´Ÿå€ºç‡æå¾—ç»æµä¸­ï¼Œèµ„äº§ä»·æ ¼çš„ä¸‹è·Œå¾€å¾€éå¸¸è¿…çŒ›ã€‚è‹¥å€ºåŠ¡å¤ªé‡ï¼Œæ”¶å…¥ä¸å¤Ÿè¿˜æœ¬ï¼Œç”šè‡³ä¸å¤Ÿè¿˜æ¯ï¼Œå°±åªèƒ½å˜å–èµ„äº§ï¼ŒæŠ›å”®çš„äººå¤šäº†ï¼Œèµ„äº§ä»·æ ¼å°±è·³æ°´äº†</li><li>èµ„äº§ä»·æ ¼çš„ä¸‹è·Œä¼šå¼•èµ·ä¿¡è´·æ”¶ç¼©ï¼Œå¯¼è‡´èµ„é‡‘é“¾çš„æ–­è£‚</li><li>ç»æµè¡°é€€ä¼šåŠ å‰§ä¸å¹³ç­‰<ul><li>å› ä¸ºå€ºåŠ¡å±æœºå¯¹ç©·äººå’Œå¯Œäººçš„æ‰“å‡»é«˜åº¦ä¸å¯¹ç§°</li><li>æ³•å¾‹ä¼˜å…ˆä¿æŠ¤å€ºæƒäººçš„ç´¢èµ”æƒï¼Œå³æ¬ å€ºçš„æ— è®ºæ˜¯å…¬å¸è¿˜æ˜¯ä¸ªäººï¼Œå³ä½¿ç ´äº§ä¹Ÿè¦æ¸…ç®—å¿å€º</li></ul></li></ul><h2 id="8-2-å€ºå°ä¸ºä½•é«˜ç­‘"><a href="#8-2-å€ºå°ä¸ºä½•é«˜ç­‘" class="headerlink" title="8.2 å€ºå°ä¸ºä½•é«˜ç­‘"></a>8.2 å€ºå°ä¸ºä½•é«˜ç­‘</h2><ul><li>èµ„é‡‘ä¾›ç»™å’Œé“¶è¡Œç®¡åˆ¶<ul><li>èµ„é‡‘ä¾›ç»™çš„å¢åŠ æºäºé‡‘èç®¡åˆ¶çš„æ”¾æ¾</li><li>é“¶è¡Œè¶Šåšè¶Šå¤§ï¼Œåˆ›é€ çš„ä¿¡è´·è¶Šæ¥è¶Šå¤š</li><li>é‡‘èåˆ›æ–°å’Œè¡ç”Ÿå“ä¸æ–­å¢åŠ ï¼Œå¯¼è‡´é‡‘èéƒ¨é—¨çš„è§„æ¨¡å’Œé£é™©ä¹Ÿåœ¨å¢åŠ </li></ul></li><li>å…¨çƒé“¶è¡Œçš„å±æœºçš„é¢‘ç‡å’Œå›½é™…èµ„æœ¬æµåŠ¨è§„æ¨¡é«˜åº¦ç›¸å…³ï¼Œé‡‘èå±æœºåŸºæœ¬éƒ½ä¼´éšç€é“¶è¡Œçš„å±æœº<ul><li>é“¶è¡Œè§„æ¨¡è¾¾ï¼Œæ æ†é«˜</li><li>é“¶è¡Œå€Ÿæ¥çŸ­æœŸçš„é’±ï¼Œä½†æ˜¯å€Ÿå‡ºå»çš„é’±å´å¤§éƒ½æ˜¯é•¿æœŸçš„<ul><li>è¿™ç§è´Ÿå€ºå’Œèµ„äº§çš„æœŸé™ä¸åŒ¹é…ä¼šå¸¦æ¥æµåŠ¨æ€§é£é™©</li></ul></li><li>é“¶è¡Œä¿¡è´·å¤§éƒ½ä¸æˆ¿åœ°äº§æœ‰å…³ï¼Œå¸¸å¸¸å’ŒåœŸåœ°ï¼Œä»¥åŠæˆ¿äº§ä»·å€¼ä¸€åŒèµ·è½ï¼Œæ”¾å¤§ç»æµæ³¢åŠ¨</li><li>é“¶è¡Œé£é™©ä¼šä¼ å¯¼ç»™å…¶ä»–é‡‘èéƒ¨é—¨<ul><li>æ¯”å¦‚é“¶è¡Œå°†å„ç§æŒ‰æ­è´·æ¬¾æ‰“åŒ…æˆè¯åˆ¸ç»„åˆï¼Œå–ç»™å…¶ä»–é‡‘èæœºæ„</li></ul></li></ul></li><li>è„±å®å‘è™šï¼Œå®é™…ä¸Šä¸€ç›´æ˜¯å¯Œäººçš„é’± è´·ç»™äº†ç©·äººä»¬</li><li>ä¸ºä»€ä¹ˆæŠ•èµ„å˜å°‘äº†ï¼Ÿ<ul><li>åˆ¶é€ ä¸šå¤–è¿ â€” åˆ¶é€ ä¸šæœ¬èº«æ˜¯é‡èµ„äº§ï¼Œé‡æŠ•èµ„çš„è¡Œä¸š</li><li>å½“ä»ŠæŠ€æœ¯æå‡ï¼Œéœ€è¦è¿ç”¨å¤§é‡è½¯ä»¶ä¸æœåŠ¡ï¼Œè€ŒæœåŠ¡ä¸šæ›´ä¾èµ–äºäººçš„é›†èšï¼Œä¹Ÿæ¨å‡äº†å¯¹ç‰¹å®šåœ°æ®µçš„ä½æˆ¿å’Œç¤¾äº¤ç©ºé—´çš„éœ€æ±‚</li></ul></li></ul><aside>ğŸ’¡ åœ¨ç¼ºä¹å¢é•¿ç‚¹çš„æƒ…å†µä¸‹ï¼Œå¤®è¡Œç»™é“¶è¡Œä½“ç³»æä¾›æµåŠ¨æ€§ï¼Œä½†å•†ä¸šé“¶è¡Œèµ„é‡‘è´·ä¸å‡ºå»ï¼Œå®¹æ˜“æµå‘èµ„äº§å¸‚åœºã€‚æ”¾æ¾è´§å¸æ¡ä»¶æ€»ä½“ä¸Šæœ‰åˆ©äºèµ„äº§æŒæœ‰è€…ï¼Œè¶…å®½æ¾çš„è´§å¸æ”¿ç­–å¯èƒ½åŠ å‰§è´¢å¯Œåˆ†åŒ–ï¼Œå›ºåŒ–ç»“æ„æ‰­æ›²ï¼Œä½¿å±æœºè°ƒæ•´çš„è¿‡ç¨‹è¿‡é•¿ã€‚</aside><h2 id="8-3-ä¸­å›½çš„å€ºåŠ¡ä¸é£é™©"><a href="#8-3-ä¸­å›½çš„å€ºåŠ¡ä¸é£é™©" class="headerlink" title="8.3 ä¸­å›½çš„å€ºåŠ¡ä¸é£é™©"></a>8.3 ä¸­å›½çš„å€ºåŠ¡ä¸é£é™©</h2><ul><li>å§‹äº2008å¹´çš„è´¢æ”¿åˆºæ¿€è®¡åˆ’<ul><li>ä¸­å¤®æ”¾æ¾äº†å¯¹åœ°æ–¹èèµ„å¹³å°çš„é™åˆ¶ï¼ŒåŒæ—¶ä¸æ–­é™å‡†é™æ¯ï¼Œæ”¾å®½é“¶è¡Œä¿¡è´·</li><li>è¿™äº›èµ„é‡‘æ‰¾åˆ°äº†åŸºå»ºå’Œæˆ¿åœ°äº§ä¸¤å¤§è½½ä½“</li></ul></li><li>2011 å› ä¸ºç»æµå‡ºç°è¿‡çƒ­ç°è±¡ï¼Œè´§å¸æ”¿ç­–æ”¶ç´§</li><li>ä½†æ˜¯2011å¹´ä¸­ï¼Œæ¬§å€ºå±æœºçˆ†å‘ï¼Œå›½å†…åˆ¶é€ ä¸šé™·å…¥å›°å¢ƒ</li><li>2012å¹´åˆå¼€å§‹é™å‡†é™æ¯</li><li>2015å¹´è‚¡ç¾<ul><li>ç¾å›½é€€å‡ºé‡åŒ–å®½æ¾ï¼Œäººæ°‘å¸æ±‡ç‡è¿…é€Ÿè´¬å€¼</li><li>ä¸­å¤®æ”¾æ¾äº†å¯¹æˆ¿åœ°äº§çš„è°ƒæ§</li><li>å…¨å›½æ£šæˆ·åŒºæ”¹é€ ä»å®ç‰©å®‰ç½®è½¬å˜ä¸ºè´§å¸åŒ–å®‰ç½®ï¼Œå¸¦åŠ¨æˆ¿ä»·è¿›ä¸€æ­¥ä¸Šæ¶¨</li></ul></li><li>æˆ‘å›½ä¼ä¸šå€ºåŠ¡è´Ÿæ‹…éå¸¸é‡ï¼Œåº”å¯¹é£é™©èƒ½åŠ›å¾ˆæœ‰é™</li><li>å½±å­é“¶è¡Œ<ul><li>ç±»ä¼¼é“¶è¡Œçš„ä¿¡è´·ä¸šåŠ¡ï¼Œä½†æ˜¯ä¸åœ¨é“¶è¡Œçš„èµ„äº§è´Ÿå€ºè¡¨å½“ä¸­ï¼Œä¸å—åˆ°é“¶è¡Œç›‘ç®¡è§„åˆ™çš„çº¦æŸ</li><li>æ¯”å¦‚é“¶è¡Œå–ç»™è€ç™¾å§“ä¸€ä¸ªç†è´¢äº§å“ï¼Œåˆ©æ¯5%</li><li>ç„¶åå°†ç­¹æ¥çš„é’±å§”æ‰˜ç»™ä¿¡æ‰˜å…¬å¸</li><li>ä¿¡æ‰˜å…¬å¸å°†é’±å€Ÿç»™å…¬å¸</li><li>è¿™æ ·åšçš„è¯ï¼Œå‘è¡Œçš„ç†è´¢äº§å“ä¸ç®—é“¶è¡Œå‚¨è“„ï¼Œå§”æ‰˜ç»™ä¿¡æ‰˜å…¬å¸çš„æŠ•èµ„ä¸ç®—é“¶è¡Œè´·æ¬¾ï¼Œæ‰€ä»¥å°±ç»•å¼€äº†é“¶è¡Œçš„ç›‘ç®¡</li></ul></li></ul><h2 id="8-4-åŒ–è§£å€ºåŠ¡é£é™©"><a href="#8-4-åŒ–è§£å€ºåŠ¡é£é™©" class="headerlink" title="8.4 åŒ–è§£å€ºåŠ¡é£é™©"></a>8.4 åŒ–è§£å€ºåŠ¡é£é™©</h2><ul><li>è§£å†³æ–¹æ¡ˆ<ul><li>å¿è¿˜å·²æœ‰å€ºåŠ¡<ul><li>å¯èƒ½ä¼šé™·å…¥åˆ°ç»æµè¡°é€€å½“ä¸­ï¼Œå› ä¸ºéƒ½è¦å‹’ç´§è£¤è…°å¸¦è¿‡æ—¥å­</li><li>ä½ çš„æ”¯å‡ºå°±æ˜¯æˆ‘çš„æ”¶å…¥äº†å‘€</li><li>å¢å‘è´§å¸<ul><li>å¢å‘è´§å¸æ¥é™ä½åˆ©ç‡<ul><li>å¯ä»¥åˆºæ¿€æ¶ˆè´¹å’ŒæŠ•èµ„ï¼ŒææŒ¯ç»æµ</li><li>è®¡ç®—å®é™…æ”¶å…¥ä¸å¢åŠ ï¼Œéšç€ç‰©ä»·ä¸Šæ¶¨å’Œæ—¶é—´æ¨ç§»ï¼Œå€ºåŠ¡è´Ÿæ‹…ä¹Ÿä¼šå‡è½»</li></ul></li><li>é‡åŒ–å®½æ¾<ul><li>å¤®è¡Œå¢å‘è´§å¸æ¥ä¹°å…¥å„ç±»èµ„äº§ï¼Œå°†è´§å¸æ³¨å…¥ç»æµ</li><li>æ‰˜ä½èµ„äº§ä»·æ ¼ï¼Œä¸ºç»æµæ³¨å…¥æµåŠ¨æ€§</li><li>é—®é¢˜æ˜¯éš¾ä»¥å°†å¢å‘çš„è´§å¸å‘åˆ°ç©·äººæ‰‹é‡Œï¼Œå› æ­¤éš¾ä»¥åˆºæ¿€æ¶ˆè´¹æ”¯å‡ºï¼Œè¿˜ä¼šæ‹‰å¤§è´«å¯Œå·®è·</li><li>è´­ä¹°å„ç§é‡‘èèµ„äº§å—ç›Šçš„æ˜¯å„ç§èµ„äº§çš„æ‰€æœ‰è€…</li></ul></li><li>å€ºåŠ¡è´§å¸åŒ–<ul><li>æ”¿åºœåŠ å¤§è´¢æ”¿æ”¯å‡ºå»åˆºæ¿€ç»æµ</li><li>ç”±è´¢æ”¿éƒ¨å‘å€ºèèµ„ï¼Œå¤®è¡Œç›´æ¥å°é’±ä¹°è¿‡æ¥ï¼Œæ— éœ€å…¶ä»–é‡‘èæœºæ„å‚ä¸ä¹Ÿæ— éœ€æ”¯ä»˜åˆ©æ¯</li></ul></li></ul></li></ul></li><li>éåˆ¶æ–°å¢å€ºåŠ¡ï¼Œæ”¹é©æ»‹ç”Ÿå€ºåŠ¡çš„æ”¿æ²»ç»æµç¯å¢ƒ<ul><li>æ ¸å¿ƒç‚¹<ul><li>é™åˆ¶æˆ¿ä»·ä¸Šæ¶¨</li><li>é™åˆ¶åœŸåœ°è´¢æ”¿å’ŒåœŸåœ°é‡‘è</li><li>é™åˆ¶æ”¿åºœæ‹…ä¿å’Œå›½æœ‰ä¼ä¸šè¿‡åº¦å€Ÿè´·</li><li>èµ„æœ¬å¸‚åœºæ”¹é©<ul><li>æ”¹å˜ä»¥é“¶è¡Œè´·æ¬¾ä¸ºä¸»çš„é—´æ¥èèµ„ä½“ç³»ï¼Œæ‰©å±•ç›´æ¥èèµ„æ¸ é“<ul><li>èƒ½å¤Ÿé™ä½å€ºåŠ¡è´Ÿæ‹…</li><li>ä¹Ÿèƒ½æé«˜èµ„é‡‘çš„ä½¿ç”¨æ•ˆç‡</li><li>è‚¡æƒçš„çº¦æŸåŠ›è¦æ›´å¼º<ul><li>é£é™©å…±æ‹…</li><li>è‚¡æƒå¯ä»¥è½¬è®©</li></ul></li></ul></li><li>æ”¹é©å¾ˆæ…¢çš„åŸå› å…¶å®æ˜¯æˆ‘å›½é‡‘èèµ„äº§ä¸­72%çš„é£é™©æ˜¯ç”±é‡‘èæœºæ„å’Œæ”¿åºœæ‰¿æ‹…çš„</li></ul></li></ul></li><li>å€ºåŠ¡é—®é¢˜<ul><li>ä»¥å‡ºå£å’ŒæŠ•èµ„é©±åŠ¨çš„ç»æµä½“ç³»çš„äº§ç‰©</li></ul></li></ul></li></ul></li></ul><h1 id="9-å›½å†…å›½é™…çš„å¤±è¡¡"><a href="#9-å›½å†…å›½é™…çš„å¤±è¡¡" class="headerlink" title="9. å›½å†…å›½é™…çš„å¤±è¡¡"></a>9. å›½å†…å›½é™…çš„å¤±è¡¡</h1><ul><li>ä¸­å›½æˆä¸ºåˆ¶é€ ä¸šå¤§å›½èƒŒåçš„ä¸¤ä¸ªé—®é¢˜<ul><li>å†…éƒ¨ç»æµç»“æ„å¤±è¡¡<ul><li>é‡ç”Ÿäº§ï¼Œé‡æŠ•èµ„ï¼Œç›¸å¯¹è½»æ°‘ç”Ÿï¼Œè½»æ¶ˆè´¹</li><li>å¯¼è‡´å’Œå·¨å¤§çš„äº§èƒ½å¯¹æ¯”ï¼Œå›½å†…æ¶ˆè´¹ä¸è¶³ï¼Œæ¶ˆåŒ–ä¸äº†çš„äº§å“åªèƒ½å¯¹å¤–è¾“å‡º</li></ul></li><li>å›½å¤–éœ€æ±‚çš„ä¸ç¨³å®šå’Œè´¸æ˜“å†²çª<ul><li>å®é™…åˆ¶é€ ä¸šä¸­ ä¸­å›½å æ¯”ä»5% åˆ°28%ï¼Œè€Œä¸ƒå›½é›†å›¢ä»72%åˆ°37%ï¼Œå…¶ä»–å›½å®¶åŸºæœ¬æ²¡æœ‰å˜åŒ–</li></ul></li></ul></li></ul><h2 id="9-1-ä½æ¶ˆè´¹å’Œäº§èƒ½è¿‡å‰©"><a href="#9-1-ä½æ¶ˆè´¹å’Œäº§èƒ½è¿‡å‰©" class="headerlink" title="9.1 ä½æ¶ˆè´¹å’Œäº§èƒ½è¿‡å‰©"></a>9.1 ä½æ¶ˆè´¹å’Œäº§èƒ½è¿‡å‰©</h2><ul><li><p>é¢ä¸´æ¶ˆè´¹ä¸è¶³çš„é—®é¢˜</p><ul><li>æˆ‘å›½å±…æ°‘æœ€ç»ˆæ¶ˆè´¹å GDPåªæœ‰44%ï¼Œç¾å›½æœ‰70%ï¼Œæ¬§ç›Ÿå’Œæ—¥æœ¬ä¹Ÿæœ‰55%</li><li>GDPä¸­å¯ä¾›è€ç™¾å§“æ”¯é…çš„æ”¶å…¥ä»½é¢ä¸‹é™äº†ï¼Œæˆ–è€…è€ç™¾å§“æŠŠæ›´å¤§ä¸€éƒ¨åˆ†æ”¶å…¥å­˜äº†èµ·æ¥ï¼Œå‚¨è“„ç±»ä¸Šå‡äº†â€” æˆ‘å›½è¿™ä¸¤ç§æƒ…å†µéƒ½å‡ºç°äº†</li><li>å­©å­æ•°é‡å‡å°‘ä»¥åï¼Œå…»å„¿é˜²è€åŠŸæ•ˆé™ä½ï¼Œçˆ¶æ¯å¼€å§‹å¢åŠ å‚¨è“„æ¥å…»è€äº†</li></ul></li><li><p>å½“å‰çš„é æ”¿åºœ é æŠ•èµ„æ‹‰åŠ¨ç»æµå‘å±•ä¼šå­˜åœ¨å‡ ä¸ªæ–¹é¢çš„é—®é¢˜</p><ul><li>åŸºç¡€è®¾æ–½å’Œå·¥ä¸šä½“ç³»å·²ç»å®Œå–„ï¼ŒæŠ•èµ„éš¾åº¦åŠ å¤§<ul><li>å› æ­¤æŠ•èµ„å†³ç­–å’Œè°ƒé…èµ„æºçš„ä½“åˆ¶éœ€è¦æ”¹å˜</li><li>åœ°æ–¹æ”¿åºœä¸»å¯¼æŠ•èµ„çš„å±€é¢éœ€è¦æ”¹å˜</li></ul></li><li>ç”±äºè€ç™¾å§“æ”¶å…¥å’Œæ¶ˆè´¹éƒ½ä¸è¶³ï¼Œæ— æ³•æ¶ˆåŒ–æŠ•èµ„å½¢æˆçš„äº§èƒ½ï¼Œå¾ˆå¤šæŠ•èµ„ä¸èƒ½å˜æˆæœ‰æ•ˆçš„æ”¶å…¥ï¼Œæ‰€ä»¥å€ºåŠ¡è´Ÿæ‹…è¶Šæ¥è¶Šé‡ï¼Œå¸¦æ¥äº†ä¸€ç³»åˆ—çš„é£é™©</li><li>åŠ³åŠ¨æ”¶å…¥ä»½é¢ä¸‹é™ï¼Œèµ„æœ¬æ”¶å…¥ä»½é¢çš„ä¸Šå‡ï¼Œä¼šæ‰©å¤§è´«å¯Œå·®è·</li><li>ç”±äºæ¶ˆè´¹ä¸è¶³å’ŒæŠ•èµ„è¿‡å‰©ï¼Œè¿‡å‰©äº§èƒ½ä¼šå‘å›½å¤–è¾“å‡ºï¼Œå› ä¸ºæˆ‘å›½ä½“é‡å¾ˆå¤§ï¼Œè¾“å‡ºäº§èƒ½ä¼šå®¶ä¸­å…¨çƒè´¸æ˜“å¤±è¡¡ï¼Œå¼•å‘è´¸æ˜“å†²çª</li></ul></li><li><p>åä¹å¤§æå‡ºäº†</p><ul><li>æé«˜å°±ä¸šè´¨é‡å’Œäººæ°‘æ”¶å…¥æ°´å¹³<ul><li>ç ´é™¤å¦¨ç¢åŠ³åŠ¨åŠ›ï¼Œäººæ‰ç¤¾ä¼šæ€§æµåŠ¨çš„ä½“åˆ¶æœºåˆ¶å¼Šç«¯</li><li>å®Œå–„æ”¿åºœï¼Œå·¥ä¼šï¼Œä¼ä¸šå…±åŒå‚ä¸çš„åå•†åè°ƒæœºåˆ¶</li><li>åšæŒæŒ‰åŠ³åˆ†é…ï¼Œå®Œå–„æŒ‰è¦ç´ åˆ†é…çš„ä½“åˆ¶æœºåˆ¶</li><li>æ‰©å¤§ä¸­ç­‰æ”¶å…¥ç¾¤ä½“ï¼Œå¢åŠ ä½æ”¶å…¥è€…æ”¶å…¥ï¼Œè°ƒèŠ‚è¿‡é«˜æ”¶å…¥ï¼Œå–ç¼”éæ³•æ”¶å…¥</li><li>è¦åŠªåŠ›ä½¿å±…æ°‘æ”¶å…¥å¢é•¿å¿«äºç»æµå¢é•¿</li></ul></li></ul></li><li><p>å‡ºå£å æ¯”é«˜è¿™ç§ç»æµç»“æ„æ¯”è¾ƒè„†å¼±</p><ul><li>å¤–å›½æ”¶åˆ°æ”¿æ²»ç»æµçš„å½±å“å¾ˆå¤§ï¼Œéš¾ä»¥æŒæ§</li></ul></li></ul><h2 id="9-2-ä¸­ç¾è´¸æ˜“å†²çª"><a href="#9-2-ä¸­ç¾è´¸æ˜“å†²çª" class="headerlink" title="9.2 ä¸­ç¾è´¸æ˜“å†²çª"></a>9.2 ä¸­ç¾è´¸æ˜“å†²çª</h2><ul><li><p>åå…¨çƒåŒ–ï¼Œæ°‘ç²¹ä¸»ä¹‰ï¼Œ</p></li><li><p>ä¸­ç¾ä¹‹é—´çš„æŠ€æœ¯å†²å‡»ï¼ŒæŠ€æœ¯ç«äº‰æ‰æ˜¯çœŸæ­£çš„åšå¼ˆ</p></li><li><p>å¯¹äºä¸€ä¸ªç«™åœ¨ç§‘æŠ€å‰æ²¿çš„å›½å®¶æ¥è¯´ï¼Œæ–°æŠ€æœ¯çš„å‘æ˜å’Œåº”ç”¨ä¸€èˆ¬ä»ç§‘å­¦ç ”ç©¶å’Œå®éªŒå®¤å¼€å§‹ï¼Œå†åˆ°æŠ€æœ¯åº”ç”¨å’Œä¸“åˆ©é˜¶æ®µï¼Œç„¶åå†åˆ°å¤§è§„æ¨¡çš„å·¥ä¸šé‡äº§</p></li><li><p>ä½†æ˜¯å¯¹äºä¸€ä¸ªåèµ·çš„å‘å±•ä¸­å›½å®¶æ¥è¯´ï¼Œå¾ˆå¤šæ—¶å€™é¡ºåºæ˜¯åçš„</p><ul><li>å…ˆä»åˆ¶é€ ç¯èŠ‚å¼€å§‹ï¼Œè¾¹å¹²è¾¹å­¦ï¼Œç§¯ç´¯æŠ€æœ¯å’Œç»éªŒ</li><li>æ ¹æ®è‡ªèº«éœ€è¦æ”¹è¿›æŠ€æœ¯ï¼Œåˆ›é€ ä¸€äº›ä¸“åˆ©</li><li>äº§å“é”€é‡é€æ­¥æ‰©å¤§ï¼ŒæŠ€æœ¯é€æ­¥å‘å‰æ²¿é æ‹¢ä»¥åï¼Œæ‹¿å‡ºæ›´å¤šèµ„æºæŠ•å…¥ç ”å‘ï¼Œæ¨è¿›æ›´ä¸ºåŸºç¡€ï¼Œåº”ç”¨èŒƒå›´æ›´å¹¿çš„ç§‘ç ”é¡¹ç›®</li></ul></li></ul><h2 id="9-3-å†å¹³è¡¡ä¸å›½å†…å¤§å¾ªç¯"><a href="#9-3-å†å¹³è¡¡ä¸å›½å†…å¤§å¾ªç¯" class="headerlink" title="9.3 å†å¹³è¡¡ä¸å›½å†…å¤§å¾ªç¯"></a>9.3 å†å¹³è¡¡ä¸å›½å†…å¤§å¾ªç¯</h2><ul><li>åŠ å¿«æ„å»ºä»¥å›½å†…å¤§å¾ªç¯ä¸ºä¸»ä½“ï¼Œå›½å†…å›½é™…åŒå¾ªç¯ç›¸äº’ä¿ƒè¿›çš„æ–°å‘å±•æ ¼å±€<ul><li>éœ€è¦æé«˜å±…æ°‘çš„æ”¶å…¥å’Œæ¶ˆè´¹</li><li>éœ€è¦é æœåŠ¡ä¸šçš„å¤§åŠ›å‘å±•äº†ï¼Œè€Œè¿™äº›åªèƒ½å‘å±•åœ¨äººå£å¯†åº¦éå¸¸é«˜çš„åŸå¸‚å½“ä¸­</li><li>éœ€è¦æˆ·ç±åˆ¶åº¦ï¼Œè¿˜æœ‰åœŸåœ°åˆ¶åº¦çš„æ”¹é©</li><li>éœ€è¦æŠŠæ›´å¤šçš„è¥¿è‹‘ä»æ”¿åºœå’Œä¼ä¸šæ‰‹ä¸­è½¬ç§»å‡ºæ¥ï¼Œåˆ†é…ç»™å±…æ°‘</li><li>éœ€è¦æ”¹å˜åœ°æ–¹æ”¿åºœåœ¨ç»æµä¸­æ‰®æ¼”çš„è§’è‰²ï¼Œéåˆ¶å…¶æŠ•èµ„å†²åŠ¨ï¼Œé™ä½å…¶ç”Ÿäº§æ€§æ”¯å‡ºï¼ŒåŠ å¤§æ°‘ç”Ÿæ”¯å‡º</li></ul></li></ul><h1 id="10-æ”¿åºœä¸ç»æµå‘å±•çš„æ€»ç»“"><a href="#10-æ”¿åºœä¸ç»æµå‘å±•çš„æ€»ç»“" class="headerlink" title="10. æ”¿åºœä¸ç»æµå‘å±•çš„æ€»ç»“"></a>10. æ”¿åºœä¸ç»æµå‘å±•çš„æ€»ç»“</h1><ul><li>ä¸€å¥—ä¸¥æ ¼çš„æ¦‚å¿µæ¡†æ¶æ— ç–‘æœ‰åŠ©äºå˜æ¸…é—®é¢˜ï¼Œä½†ä¹Ÿç»å¸¸è®©äººé”™æŠŠé—®é¢˜å½“æˆç­”æ¡ˆ</li><li>éœ€è¦å°†ç«äº‰æœºåˆ¶å¼•å…¥æ”¿åºœ<ul><li>ä»¥ä¸­å¤®æ”¿åºœä¸ºä¸»ï¼Œéƒ¨å§”ä¸ºå•ä½ï¼Œ</li></ul></li><li>ç“¦æ ¼çº³æ³•åˆ™<ul><li>å›½å®¶è¶Šå¯Œè£•ï¼Œæ”¿åºœåœ¨å›½æ°‘ç»æµä¸­æ‰€å çš„æ¯”é‡ä¹Ÿå¾€å¾€ä¼šè¶Šå¤§ï¼Œè€Œä¸æ˜¯è¶Šå°</li><li>å› ä¸ºéšç€æ„ˆå‘å¯Œè£•ï¼Œæ°‘ä¼—å¯¹æ”¿åºœæœåŠ¡çš„éœ€æ±‚ä¼šè¶Šæ¥è¶Šå¤šï¼Œæ”¿åºœåœ¨å…¬ç«‹æ•™è‚²ï¼ŒåŒ»ç–—ï¼Œé€€ä¼‘é‡‘ï¼Œå¤±ä¸šä¿é™©ç­‰æ–¹é¢çš„æ”¯å‡ºä¹Ÿä¼šéšä¹‹å¢åŠ </li></ul></li><li>ç»æµå‘å±•çš„æ ¸å¿ƒæ˜¯æé«˜ç”Ÿäº§ç‡<ul><li>å¯¹äºå¤„äºæŠ€æœ¯å‰æ²¿çš„å‘è¾¾å›½å®¶æ¥è¯´ï¼Œæé«˜ç”Ÿäº§ç‡çš„å…³é”®æ˜¯ä¸æ–­æ¢ç´¢å’Œåˆ›æ–°</li><li>ä½†æ˜¯å¯¹äºå‘å±•ä¸­å›½å®¶æ¥è¯´ï¼Œæé«˜ç”Ÿäº§ç‡çš„å…³é”®ä¸æ˜¯æ¢ç´¢æœªçŸ¥å’Œåˆ›æ–°ï¼Œè€Œæ˜¯å­¦ä¹ å·²çŸ¥çš„æŠ€æœ¯å’Œç®¡ç†æ¨¡å¼ï¼Œå°†æ›´å¤šçš„èµ„æºå°½å¿«ç»„ç»‡å’ŒæŠ•å…¥åˆ°å­¦ä¹ è¿‡ç¨‹å½“ä¸­ï¼Œæ¥æé«˜å­¦ä¹ æ•ˆç‡</li><li>åè¿›å›½å®¶è™½ç„¶æœ‰æ¨¡ä»¿å’Œå­¦ä¹ å…ˆè¿›å›½å®¶æŠ€æœ¯çš„åå‘ä¼˜åŠ¿ï¼Œä½†æ˜¯å…¶ç»„ç»‡å­¦ä¹ æ¨¡å¼ä¸å¯èƒ½ä¸€ç›´æŒç»­ä¸‹å»</li><li>å½“æŠ€æœ¯å’Œç”Ÿäº§ç‡æé«˜åˆ°ä¸€å®šçš„æ°´å¹³ä»¥åï¼Œéœ€è¦æˆåŠŸè½¬å‹æˆæ¢ç´¢åˆ›æ–°æ¨¡å¼ã€‚</li></ul></li><li>åŸå¸‚åŒ– â€” æ˜¯ä¸ªå†œæ°‘è½¬åŒ–ä¸ºå·¥äººçš„è¿‡ç¨‹</li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>äººæœˆç¥è¯ç¬”è®°</title>
      <link href="/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D%E7%AC%94%E8%AE%B0/"/>
      <url>/%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<ul><li>è½¯ä»¶æ´»åŠ¨çš„æ ¹æœ¬ä»»åŠ¡<ul><li>æ‰“é€ æ„æˆæŠ½è±¡è½¯ä»¶å®ä½“çš„å¤æ‚æ¦‚å¿µç»“æ„</li></ul></li><li>è½¯ä»¶æ´»åŠ¨çš„æ¬¡è¦ä»»åŠ¡1<ul><li>ä½¿ç”¨ç¼–ç¨‹è¯­è¨€æ¥è¡¨è¾¾è¿™äº›æŠ½è±¡å®ä½“ï¼Œåœ¨ç©ºé—´å’Œæ—¶é—´çš„é™åˆ¶ä¸‹å°†ä»–ä»¬æ˜ å°„æˆæœºå™¨è¯­è¨€</li></ul></li></ul><blockquote><p>ä¸€ä¸ªç›¸äº’ç‰µåˆ¶çš„æ¦‚å¿µç»“æ„æ˜¯è½¯ä»¶å®ä½“å¿…ä¸å¯å°‘çš„éƒ¨åˆ†ï¼Œå®ƒåŒ…æ‹¬ï¼šæ•°æ®é›†åˆï¼Œæ•°æ®æ¡ç ä¹‹é—´çš„å…³ç³»ï¼Œç®—æ³•ä»¥åŠåŠŸèƒ½è°ƒç”¨ç­‰ã€‚è¿™äº›è¦ç´ æœ¬èº«æ˜¯æŠ½è±¡çš„ï¼Œä½“ç°åœ¨ä¸åŒçš„è¡¨ç°å½¢å¼ä¸‹çš„æ¦‚å¿µæ„é€ æ˜¯ç›¸åŒçš„ã€‚</p></blockquote><ul><li>è½¯ä»¶ç³»ç»Ÿæ— æ³•è§„é¿çš„å†…åœ¨ç‰¹æ€§<ul><li>å¤æ‚åº¦<ul><li>å…ƒç´ ä¹‹é—´çš„äº¤äº’ï¼Œä½¿å¾—è½¯ä»¶çš„å¤æ‚åº¦æ¯”éçº¿æ€§å¢é•¿è¦é«˜å¾—å¤š</li><li>è½¯ä»¶çš„å¤æ‚åº¦æ˜¯æ ¹æœ¬å±æ€§ï¼ŒæŠ½æ‰å¤æ‚åº¦çš„è½¯ä»¶å®ä½“æè¿°å®é™…ä¸Šä¹Ÿå»æ‰äº†ä¸€äº›æœ¬è´¨å±æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬æ— æ³•åšå¤ªå¤šçš„ç®€åŒ–çš„</li></ul></li><li>ä¸€è‡´æ€§<ul><li>è½¯ä»¶å·¥ç¨‹å½“ä¸­æ²¡æœ‰å¤ªå¤šçš„ä¸€è‡´æ€§ï¼Œæ›´å¤šçš„æ ¸å¿ƒå¼€å‘å·¥ç¨‹å¸ˆæœ¬èº«çš„ç†å¿µ</li></ul></li><li>å¯å˜æ€§<ul><li>è½¯ä»¶ä¸­çš„åŠŸèƒ½ï¼ŒåŠŸèƒ½å±æ€§å¾ˆå®¹æ˜“æ„Ÿå—åˆ°å˜æ›´çš„å‹åŠ›</li></ul></li><li>ä¸å¯è§æ€§<ul><li>è½¯ä»¶æ˜¯ä¸å¯è§ä»¥åŠæ— æ³•å¯è§†åŒ–çš„<ul><li>ä¾‹å¦‚å‡ ä½•æŠ½è±¡æ˜¯å¼ºå¤§çš„å·¥å…·ï¼ŒåŒ…æ‹¬æœºæ¢°åˆ¶å›¾ï¼Œä»¥åŠåŒ–å­¦åˆ†å­æ¨¡å‹ï¼Œä½†æ˜¯è½¯ä½“çš„å®¢è§‚å­˜åœ¨ä¸å…·æœ‰ç©ºé—´çš„å½¢ä½“ç‰¹å¾</li></ul></li></ul></li></ul></li></ul><ul><li><p>ç¼–ç¨‹ç³»ç»Ÿäº§å“(Programming Systems Product) å¼€å‘çš„å·¥ä½œé‡æ˜¯ä¾›ä¸ªäººä½¿ç”¨çš„ï¼Œç‹¬ç«‹å¼€å‘çš„æ„ä»¶ç¨‹åºçš„9å€ã€‚ä¼°è®¡è½¯ä»¶æ„ä»¶äº§å“åŒ–å¼•èµ·äº†3å€å·¥ä½œé‡ï¼Œå°†è½¯ä»¶æ„ä»¶æ•´åˆæˆå®Œæ•´ç³»ç»Ÿæ‰€éœ€è¦çš„è®¾è®¡ã€é›†æˆå’Œæµ‹è¯•åˆåŠ å¼ºäº†3å€çš„å·¥ä½œé‡ï¼Œè¿™äº›é«˜æˆæœ¬çš„æ„ä»¶åœ¨æ ¹æœ¬ä¸Šæ˜¯ç›¸äº’ç‹¬ç«‹çš„</p></li><li><p>ç¼–ç¨‹è¡Œä¸šæ»¡è¶³äº†æˆ‘ä»¬å†…å¿ƒæ·±å¤„çš„åˆ›é€ æ¸´æœ›å’Œæ„‰æ‚¦æ‰€æœ‰äººçš„å…±æœ‰æƒ…æ„Ÿï¼Œæä¾›äº†5ç§ä¹è¶£</p><ul><li>åˆ›å»ºäº‹ç‰©çš„å¿«ä¹</li><li>å¼€å‘å¯¹å…¶ä»–äººæœ‰ç”¨çš„ä¸œè¥¿çš„ä¹è¶£</li><li>å°†å¯ä»¥æ´»åŠ¨ï¼Œç›¸äº’é½¿åˆçš„é›¶éƒ¨ä»¶ç»„è£…æˆç±»ä¼¼è¿·å®«çš„ä¸œè¥¿ï¼Œè¿™ä¸ªè¿‡ç¨‹ä½“ç°å‡ºçš„ä»¤äººç¥é­‚é¢ å€’çš„ç¾ä¸½</li><li>é¢å¯¹ä¸é‡å¤çš„ä»»åŠ¡ï¼Œä¸æ–­å­¦ä¹ çš„ä¹è¶£</li><li>å·¥ä½œåœ¨å¦‚æ­¤æ˜“äºé©¾é©­çš„ä»‹è´¨ä¸Šçš„ä¹è¶£â€”â€” çº¯ç²¹çš„æ€ç»´æ´»åŠ¨ â€”â€” å…¶å­˜åœ¨ï¼Œç§»åŠ¨å’Œè¿è½¬æ–¹å¼å®Œå…¨ä¸åŒäºå®é™…ç‰©ä½“</li></ul></li><li><p>åŒæ ·ï¼Œè¿™ä¸ªè¡Œä¸šæœ‰ä¸€äº›å†…åœ¨å›ºæœ‰çš„çƒ¦æ¼</p><ul><li>å°†åšäº‹æ–¹å¼è°ƒæ•´åˆ°è¿½æ±‚å®Œç¾æ˜¯å­¦ä¹ ç¼–ç¨‹çš„æœ€å›°éš¾éƒ¨åˆ†</li><li>æƒå¨ä¸ç­‰åŒäºè´£ä»»ï¼›çœŸæ­£çš„æƒå¨æ¥è‡ªäºæ¯æ¬¡ä»»åŠ¡çš„å®Œæˆ</li><li>ä»»ä½•åˆ›é€ æ€§æ´»åŠ¨éƒ½ä¼´éšç€æ¯ç‡¥è‰°è‹¦çš„åŠ³åŠ¨ï¼Œç¼–ç¨‹ä¹Ÿä¸ä¾‹å¤–</li><li>äººä»¬é€šå¸¸å¸Œæœ›é¡¹ç›®åœ¨æ¥è¿‘ç»“æŸçš„æ—¶å€™ï¼Œè½¯ä»¶é¡¹ç›®èƒ½æ”¶æ•›å¾—å¿«ä¸€äº›ï¼Œç„¶è€Œï¼Œæƒ…å†µå´æ˜¯è¶Šæ¥è¿‘å®Œæˆï¼Œæ”¶æ•›å¾—è¶Šæ…¢</li><li>äº§å“åœ¨å®Œæˆå‰æ€»é¢ä¸´ç€é™ˆæ—§è¿‡æ—¶çš„å¨èƒï¼Œåªæœ‰å®é™…éœ€è¦çš„æ—¶å€™ï¼Œæ‰ä¼šç”¨åˆ°æœ€æ–°çš„è®¾æƒ³</li></ul></li><li><p>ç¼ºä¹åˆç†çš„æ—¶é—´è¿›åº¦æ˜¯é€ æˆé¡¹ç›®æ»åçš„æœ€ä¸»è¦åŸå› ï¼Œå®ƒæ¯”å…¶ä»–æ‰€æœ‰å› ç´ çš„æ€»å’Œå½±å“è¿˜å¤§</p></li><li><p>æ‰€æœ‰ç¼–ç¨‹äººå‘˜éƒ½æ˜¯ä¹è§‚ä¸»ä¹‰è€…ï¼Œä¸€åˆ‡éƒ½å°†è¿ä½œè‰¯å¥½</p></li><li><p>ç”±äºç¼–ç¨‹äººå‘˜é€šè¿‡çº¯ç²¹çš„æ€ç»´æ´»åŠ¨æ¥å¼€å‘ï¼Œæˆ‘ä»¬æœŸå¾…åœ¨å®ç°è¿‡ç¨‹å½“ä¸­ä¸ä¼šç¢°åˆ°å›°éš¾ã€‚ä½†æ˜¯æˆ‘ä»¬æœ¬èº«çš„æ„æ€æ˜¯ä¼šæœ‰ç¼ºé™·çš„ï¼Œå› æ­¤æ€»ä¼šæœ‰bug</p></li><li><p>å›´ç»•ç€æˆæœ¬æ ¸ç®—çš„ä¼°è®¡æŠ€æœ¯ï¼Œæ··æ·†äº†å·¥ä½œé‡å’Œé¡¹ç›®è¿›å±•ã€‚äººæœˆæ˜¯å±é™©çš„ï¼Œå› ä¸ºå®ƒæš—ç¤ºç€äººå‘˜æ•°é‡å’Œæ—¶é—´æ˜¯å¯ä»¥ç›¸äº’æ›¿æ¢çš„ã€‚</p></li><li><p>åœ¨è‹¥å¹²äººå‘˜ä¸­åˆ†è§£ä»»åŠ¡ä¼šå¼•å‘é¢å¤–çš„æ²Ÿé€šå·¥ä½œé‡ â€” åŸ¹è®­å’Œç›¸äº’æ²Ÿé€šã€‚</p></li><li><p>Brooksæ³•åˆ™ï¼š ä¸ºè¿›åº¦è½åçš„é¡¹ç›®å¢åŠ äººæ‰‹ï¼Œåªä¼šä½¿å¾—è¿›åº¦æ›´åŠ è½å</p><ul><li>å¢æ´¾äººæ‰‹å¯èƒ½å¢åŠ çš„å·¥ä½œé‡<ul><li>ä»»åŠ¡é‡æ–°åˆ†é…æœ¬èº«å’Œæ‰€é€ æˆçš„å·¥ä½œä¸­æ–­</li><li>åŸ¹è®­æ–°äººå‘˜</li><li>é¢å¤–çš„ç›¸äº’æ²Ÿé€š</li></ul></li></ul></li><li><p>åŒæ ·æœ‰ä¸¤å¹´ç»éªŒè€Œä¸”åœ¨å—åˆ°åŒæ ·åŸ¹è®­çš„æƒ…å†µä¸‹ï¼Œä¼˜ç§€çš„ä¸“ä¸šç¨‹åºå‘˜çš„ç”Ÿäº§åŠ›æ˜¯è¾ƒå·®çš„ç¨‹åºå‘˜çš„10å€ã€‚</p></li><li><p>ä¸€ä½é¦–å¸­ç¨‹åºå‘˜ï¼Œç±»ä¼¼äºå¤–ç§‘æ‰‹æœ¯é˜Ÿä¼çš„å›¢é˜Ÿæ¶æ„æä¾›äº†ä¸€ç§æ–¹æ³•â€”â€” æ—¢èƒ½è·å¾—ç”±å°‘æ•°å¤´è„‘äº§ç”Ÿçš„äº§å“å®Œæ•´æ€§ï¼Œåˆèƒ½å¤Ÿå¾—åˆ°å¤šä½ååŠ©äººå‘˜çš„æ€»ä½“ç”Ÿäº§ç‡ï¼Œè¿˜å½»åº•å‡å°‘äº†æ²Ÿé€šçš„å·¥ä½œé‡ã€‚</p></li><li><p>æ¦‚å¿µå®Œæ•´æ€§æ˜¯ç³»ç»Ÿè®¾è®¡ä¸­æœ€é‡è¦çš„è€ƒè™‘å› ç´ </p><ul><li>ä¸ºäº†è·å¾—æ¦‚å¿µçš„å®Œæ•´æ€§ï¼Œè®¾è®¡å¿…é¡»ç”±ä¸€ä¸ªäººæˆ–è€…å…·æœ‰å…±è¯†çš„å°å‹å›¢é˜Ÿæ¥å®Œæˆ</li><li>ä¸ºäº†è·å¾—æ¦‚å¿µçš„å®Œæ•´æ€§ï¼Œå°±å¿…é¡»æœ‰äººæ§åˆ¶è¿™äº›æ¦‚å¿µï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ç§æ— éœ€ä»»ä½•æ­‰æ„çš„è´µæ—ä¸“åˆ¶ç»Ÿæ²»</li></ul></li><li><p>åŠŸèƒ½å’Œç†è§£ä¸Šçš„å¤æ‚ç¨‹åº¦çš„æ¯”å€¼æ‰æ˜¯ç³»ç»Ÿè®¾è®¡çš„æœ€ç»ˆæµ‹è¯•æ ‡å‡†ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸°å¯Œçš„åŠŸèƒ½</p></li><li><p>å°½æ—©äº¤æµå’ŒæŒç»­æ²Ÿé€šèƒ½å¤Ÿä½¿å¾—ç»“æ„å¸ˆæœ‰è¾ƒå¥½çš„æˆæœ¬æ„è¯†ï¼Œä½¿å¼€å‘äººå‘˜è·å¾—å¯¹è®¾è®¡çš„ä¿¡å¿ƒï¼Œå¹¶ä¸”ä¸ä¼šæ··æ·†å„è‡ªçš„è´£ä»»åˆ†å·¥</p></li><li><p>äº¤æµ</p><ul><li>å·´æ¯”ä¼¦é¡¹ç›®çš„å¤±è´¥æ˜¯å› ä¸ºç¼ºä¹äº¤æµä»¥åŠäº¤æµçš„ç»“æœ â€”â€” ç»„ç»‡</li><li>å› ä¸ºå·¦æ‰‹ä¸çŸ¥é“å³æ‰‹åœ¨åšä»€ä¹ˆï¼Œä»è€Œè¿›åº¦ç¾éš¾ï¼ŒåŠŸèƒ½çš„ä¸åˆç†ï¼Œä»¥åŠç³»ç»Ÿçš„ç¼ºé™·çº·çº·å‡ºç°ã€‚ç”±äºå­˜åœ¨å¯¹å…¶ä»–äººçš„å„ç§å‡è®¾ï¼Œå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„ç†è§£å¼€å§‹å‡ºç°åå·®äº†ã€‚</li></ul></li><li><p>é¡¹ç›®å·¥ä½œæ‰‹å†Œ</p><ul><li>é¡¹ç›®å·¥ä½œæ‰‹å†Œæ˜¯å¯¹é¡¹ç›®å¿…é¡»äº§ç”Ÿçš„ä¸€äº›åˆ—æ–‡æ¡£è¿›è¡Œç»„ç»‡çš„ä¸€ç§ç»“æ„</li><li>æ¯ä¸€ä¸ªå›¢é˜Ÿæˆå‘˜åº”è¯¥äº†è§£æ‰€æœ‰çš„ææ–™</li><li>å®æ—¶æ›´æ–°å¾ˆé‡è¦</li><li>å·¥ä½œæ‰‹å†Œçš„ä½¿ç”¨è€…åº”è¯¥å°†æ³¨æ„åŠ›é›†ä¸­åœ¨ä¸Šæ¬¡é˜…è¯»ä¹‹åçš„å˜æ›´ä»¥åŠå…³äºè¿™äº›å˜æ›´é‡è¦æ€§çš„è¯„è¿°ä¸Š</li><li>æ¯ä¸ªéƒ¨åˆ†åº”è¯¥è¢«å°è£…ï¼Œä»è€Œæ²¡æœ‰äººéœ€è¦æˆ–è€…è¢«å…è®¸çœ‹åˆ°å…¶ä»–éƒ¨åˆ†çš„å†…éƒ¨ç»“æ„ï¼Œåªéœ€è¦äº†è§£æ¥å£</li></ul></li><li><p>ç»„ç»‡æ¶æ„</p><ul><li>å›¢é˜Ÿç»„ç»‡çš„ç›®æ ‡æ˜¯ä¸ºäº†å‡å°‘å¿…è¦çš„äº¤æµå’Œåä½œé‡</li><li>ä¸ºäº†å‡å°‘äº¤æµï¼Œç»„ç»‡ç»“æ„åŒ…æ‹¬äº†äººåŠ›åˆ’åˆ†(Division of labor) å’Œé™å®šèŒè´£èŒƒå›´(Specialization of function)</li><li>ç»„ç»‡å†…çš„äº¤æµæ˜¯ç½‘çŠ¶çš„ï¼Œè€Œä¸æ˜¯æ ‘çŠ¶ç»“æ„ï¼Œå› æ­¤æ‰€æœ‰çš„ç‰¹æ®Šç»„ç»‡æœºåˆ¶éƒ½æ˜¯ä¸ºäº†è¿›è¡Œè°ƒæ•´ï¼Œæ¥å…‹æœæ ‘çŠ¶ç»„ç»‡ç»“æ„ä¸­äº¤æµç¼ºä¹çš„å›°éš¾</li></ul></li><li><p>åœ¨å¤§å‹å›¢é˜Ÿå½“ä¸­ï¼Œå„ä¸ªå°ç»„å€¾å‘äºä¸æ–­çš„å»åšå±€éƒ¨ä¼˜åŒ–ï¼Œæ¥æ»¡è¶³è‡ªå·±çš„ç›®æ ‡ï¼Œè€Œæ¯”è¾ƒå°‘çš„è€ƒè™‘å¯¹ç”¨æˆ·çš„æ•´ä½“å½±å“ã€‚è¿™ç§æ–¹å‘æ€§çš„é—®é¢˜æ˜¯å¤§å‹é¡¹ç›®çš„ä¸»è¦å±é™©</p></li><li><p>ä»ç³»ç»Ÿæ•´ä½“å‡ºå‘å’Œé¢å‘ç”¨æˆ·çš„æ€åº¦æ˜¯è½¯ä½“ç¼–ç¨‹ç®¡ç†äººå‘˜æœ€é‡è¦çš„èŒèƒ½</p></li><li><p>æ–‡æ¡£çš„è§„èŒƒï¼Œç›®æ ‡ï¼Œç”¨æˆ·æ‰‹å†Œï¼Œå†…éƒ¨æ–‡æ¡£ï¼Œè¿›åº¦ï¼Œé¢„ç®—ï¼Œç»„ç»‡æœºæ„å›¾ï¼Œå’Œå·¥ä½œç©ºé—´åˆ†é…</p><ul><li>æ¯ä¸ªæ–‡æ¡£æœ¬èº«å°±å¯ä»¥ä½œä¸ºæ£€æŸ¥åˆ—è¡¨æˆ–è€…æ•°æ®åº“</li></ul></li><li><p>é¡¹ç›®ç»ç†çš„åŸºæœ¬èŒè´£æ˜¯ä½¿æ¯ä¸ªäººéƒ½å‘ç€ç›¸åŒçš„æ–¹å‘å‰è¿›</p></li><li><p>é¡¹ç›®ç»ç†çš„ä¸»è¦æ—¥å¸¸å·¥ä½œæ˜¯æ²Ÿé€šï¼Œè€Œä¸æ˜¯åšå‡ºå†³å®šï¼›æ–‡æ¡£ä½¿å¾—å„é¡¹è®¡åˆ’å’Œå†³ç­–åœ¨æ•´ä¸ªå›¢é˜ŸèŒƒå›´å†…å¾—åˆ°äº¤æµ</p></li><li><p>ç”¨æˆ·çš„å®é™…éœ€è¦å’Œç”¨æˆ·æ„Ÿè§‰ä¼šéšç€ç¨‹åºæ„å»ºï¼Œæµ‹è¯•å’Œä½¿ç”¨è€Œå‘ç”Ÿå˜åŒ–ã€‚</p></li><li><p>å¯¹äºæ–‡æ¡£ï¼Œéœ€è¦é‡‡ç”¨å®šä¹‰è‰¯å¥½çš„æ•°å­—åŒ–ç‰ˆæœ¬å°†å˜æ›´é‡å­åŒ–</p></li><li><p>ç¨‹åºå‘˜ä¸æ„¿æ„ä¸ºè®¾è®¡ä¹¦å†™æ–‡æ¡£ï¼Œä¸ä»…ä»…æ˜¯å› ä¸ºæƒ°æ€§ï¼Œæ›´å¤šçš„æ˜¯æºäºè®¾è®¡äººå‘˜çš„è¸Œèº‡ â€”â€” è¦ä¸ºè‡ªå·±å°è¯•æ€§çš„è®¾è®¡å†³ç­–è¿›è¡Œè¾©è§£ã€‚</p></li><li><p>åªè¦ç®¡ç†äººå‘˜å’ŒæŠ€æœ¯äººå‘˜çš„å¤©èµ‹å…è®¸ï¼Œè€æ¿å¿…é¡»å¯¹ä»–ä»¬çš„èƒ½åŠ›åŸ¹å…»ç»™äºˆæå¤§çš„å…³æ³¨ï¼Œä½¿å¾—ç®¡ç†äººå‘˜å’ŒæŠ€æœ¯äººå‘˜å…·æœ‰äº’æ¢æ€§ï¼›ç‰¹åˆ«æ˜¯å¸Œæœ›åœ¨æŠ€æœ¯å’Œç®¡ç†è§’è‰²ä¹‹é—´è‡ªç”±çš„åˆ†é…äººæ‰‹çš„æ—¶å€™</p></li><li><p>å…·æœ‰ä¸¤æ¡æ™‹å‡çº¿çš„é«˜æ•ˆç»„ç»‡æœºæ„å­˜åœ¨ç€ä¸€äº›ç¤¾ä¼šæ€§çš„éšœç¢ï¼Œäººä»¬å¿…é¡»è­¦æƒ•å¹¶ç§¯æçš„åŒå®ƒåšæŒç»­çš„æ–—äº‰</p></li><li><p>ç¨‹åºç»´æŠ¤åŸºæœ¬ä¸Šä¸åŒäºç¡¬ä»¶çš„ç»´æŠ¤ï¼šä¸»è¦ç”±å„ç§å˜æ›´ç»„æˆï¼Œå…¥ä¿®å¤è®¾è®¡ç¼ºé™·ï¼Œæ–°å¢åŠŸèƒ½ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨ç¯å¢ƒæˆ–è€…é…ç½®å˜æ¢å¼•èµ·çš„è°ƒæ•´</p></li><li><p>å¯¹äºä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ç¨‹åºï¼Œå…¶ç»´æŠ¤æ€»æˆæœ¬é€šå¸¸æ˜¯å¼€å‘æˆæœ¬çš„40%æˆ–è€…æ›´å¤š</p></li><li><p>CampbellæŒ‡å‡ºäº†ä¸€ä¸ªæ˜¾ç¤ºäº§å“ç”Ÿå‘½æœŸä¸­æ¯æœˆbugæ•°çš„æœ‰è¶£æ›²çº¿ï¼Œå…¶å…ˆæ˜¯ä¸‹é™ï¼Œåé¢æ˜¯ä¸Šå‡</p></li><li><p>æ¯æ¬¡ä¿®å¤ä¹‹åï¼Œå¿…é¡»é‡æ–°è¿è¡Œå…ˆå‰æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿ç³»ç»Ÿä¸ä¼šä»¥æ›´éšè”½çš„æ–¹å¼è¢«ç ´å</p></li><li><p>æ‰€æœ‰çš„ä¿®æ”¹éƒ½å€¾å‘äºç ´åç³»ç»Ÿçš„æ¶æ„ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æ··ä¹±ç¨‹åº¦(ç†µ)ã€‚å³ä½¿æ˜¯æœ€ç†Ÿç»ƒçš„è½¯ä»¶ç»´æŠ¤å·¥ä½œï¼Œä¹Ÿåªæ˜¯å»¶ç¼“äº†ç³»ç»Ÿé€€åŒ–åˆ°ä¸å¯ä¿®å¤çš„æ··ä¹±çŠ¶æ€çš„è¿›ç¨‹ï¼Œä»¥è‡´å¿…é¡»é‡æ–°è¿›è¡Œè®¾è®¡ã€‚</p></li><li><p>é¡¹ç›®ç»ç†åº”è¯¥åˆ¶å®šä¸€å¥—ç­–ç•¥ï¼Œå¹¶ä¸ºé€šç”¨å·¥å…·çš„å¼€å‘åˆ†é…èµ„æºï¼Œä¸æ­¤åŒæ—¶ï¼Œè¿˜å¿…é¡»æ„è¯†åˆ°ä¸“ä¸šå·¥å…·çš„éœ€æ±‚</p></li><li><p>è°ƒè¯•æ˜¯ç³»ç»Ÿç¼–ç¨‹ä¸­è¾ƒæ…¢å’Œè¾ƒå›°éš¾çš„éƒ¨åˆ†ï¼Œè€Œæ¼«é•¿çš„è°ƒè¯•å‘¨è½¬æ—¶é—´æ˜¯è°ƒè¯•çš„ç¥¸æ ¹</p></li><li><p>åœ¨ç¼–å†™ä»»ä½•ä»£ç ä¹‹å‰ï¼Œè§„æ ¼è¯´æ˜å¿…é¡»æäº¤ç»™å¤–éƒ¨çš„æµ‹è¯•äººå‘˜ï¼Œæ¥è¯¦ç»†çš„æ£€æŸ¥è¯´æ˜çš„å®Œæ•´æ€§å’Œæ˜ç¡®æ€§ã€‚å¼€å‘äººå‘˜è‡ªå·±æ— æ³•å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p></li><li><p>å¼€å‘å¤§é‡çš„è¾…åŠ©æµ‹è¯•å¹³å°å’Œæµ‹è¯•ä»£ç æ˜¯å¾ˆå€¼å¾—çš„ï¼Œä»£ç é‡ç”šè‡³å¯èƒ½æœ‰æµ‹è¯•å¯¹è±¡çš„ä¸€åŠ</p></li><li><p>é¡¹ç›®æ˜¯æ€ä¹ˆæ ·è¢«å»¶è¿Ÿäº†æ•´æ•´ä¸€å¹´çš„æ—¶é—´çš„â€¦.. ä¸€æ¬¡ä¸€å¤©ã€‚ä¸€æ¬¡ä¸€å¤©çš„è¿›åº¦è½åæ¯”é‡å¤§ç¾éš¾æ›´éš¾ä»¥è¯†åˆ«ï¼Œæ›´ä¸å®¹æ˜“é˜²èŒƒå’Œæ›´åŠ éš¾ä»¥å¼¥è¡¥ã€‚</p></li><li><p>æ ¹æ®ä¸€ä¸ªä¸¥æ ¼çš„è¿›åº¦è¡¨æ¥æ§åˆ¶å¤§å‹é¡¹ç›®çš„ç¬¬ä¸€ä¸ªæ­¥éª¤æ˜¯åˆ¶å®šè¿›åº¦è¡¨ï¼Œè¿›åº¦è¡¨ç”±é‡Œç¨‹ç¢‘å’Œæ—¥æœŸç»„æˆ</p><ul><li>é‡Œç¨‹ç¢‘å¿…é¡»æ˜¯å…·ä½“çš„ï¼Œç‰¹å®šçš„ï¼Œå¯åº¦é‡çš„äº‹ä»¶ï¼Œéœ€è¦èƒ½å¤Ÿè¿›è¡Œæ¸…æ™°çš„å®šä¹‰</li></ul></li><li><p>æ…¢æ€§è¿›åº¦åç¦»æ˜¯å£«æ°”æ€æ‰‹ã€‚</p></li><li><p>çŠ¶æ€çš„è·å–æ˜¯å›°éš¾çš„ï¼Œå› ä¸ºä¸‹å±ç»ç†æœ‰å……åˆ†çš„ç†ç”±ä¸æä¾›ä¿¡æ¯å…±äº«</p></li><li><p>è€æ¿çš„ä¸è‰¯ååº”è‚¯å®šä¼šå¯¹ä¿¡æ¯çš„å®Œå…¨å…¬å¼€é€ æˆå‹åˆ¶ï¼›ç›¸åï¼Œä»”ç»†åŒºåˆ†çŠ¶æ€æŠ¥å‘Šï¼Œæ¯«æ— æƒŠæ…Œåœ°æ¥æ”¶æŠ¥å‘Šï¼Œå†³ä¸è¶Šä¿ä»£åº–ï¼Œå°†èƒ½å¤Ÿé¼“åŠ±è¯šå®çš„æ±‡æŠ¥ã€‚</p></li><li><p>å¿…é¡»æœ‰è¯„å®¡æœºåˆ¶ï¼Œä½¿å¾—æ‰€æœ‰æˆå‘˜å¯ä»¥é€šè¿‡å®ƒäº†è§£çœŸæ­£çš„çŠ¶æ€ã€‚å‡ºäºè¿™ä¸ªç›®çš„ï¼Œé‡Œç¨‹ç¢‘çš„è¿›åº¦å’Œå®Œæˆæ–‡æ¡£æ˜¯å…³é”®ã€‚</p></li><li><p>ç¨‹åºä¿®æ”¹äººå‘˜æ‰€ä½¿ç”¨çš„æ–‡æ¡£ä¸­ï¼Œé™¤äº†æè¿°äº‹æƒ…å¦‚ä½•ï¼Œè¿˜åº”å½“é˜è¿°å®ƒä¸ºä»€ä¹ˆé‚£æ ·ã€‚å¯¹äºåŠ æ·±ç†è§£ï¼Œç›®çš„æ˜¯éå¸¸å…³é”®çš„ï¼Œå³ä½¿æ˜¯é«˜çº§è¯­è¨€çš„è¯­æ³•ï¼Œä¹Ÿä¸èƒ½è¡¨è¾¾ç›®çš„</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äººæœˆç¥è¯ </tag>
            
            <tag> Project Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Real time dataâ€™s unifying abstraction</title>
      <link href="/Real-time-data%E2%80%99s-unifying-abstraction/"/>
      <url>/Real-time-data%E2%80%99s-unifying-abstraction/</url>
      
        <content type="html"><![CDATA[<h1 id="Real-time-dataâ€™s-unifying-abstraction"><a href="#Real-time-dataâ€™s-unifying-abstraction" class="headerlink" title="Real time dataâ€™s unifying abstraction"></a>Real time dataâ€™s unifying abstraction</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>Logs play a key role in distributed data systems and real time application architectures.<ul><li>write ahead log</li><li>commit log</li><li>transaction logs</li></ul></li></ul><h1 id="2-What-is-a-log"><a href="#2-What-is-a-log" class="headerlink" title="2. What is a log?"></a>2. What is a log?</h1><h2 id="2-1-Some-Concepts"><a href="#2-1-Some-Concepts" class="headerlink" title="2.1 Some Concepts"></a>2.1 Some Concepts</h2><ul><li>Storage abstraction<ul><li>append only</li><li>totally ordered sequence of records ordered by time</li></ul></li><li>Records<ul><li>appended to the end of the log</li><li>read from left to right</li><li>each entry has a unique sequential log entry number</li></ul></li><li>Log<ul><li>record what happened and when</li><li>for distributed system, thatâ€™s the very heart of the problem</li><li>types<ul><li>text logs<ul><li>meant primarily for humans to read</li></ul></li><li>journal/ data logs<ul><li>built for programmatic access</li></ul></li></ul></li></ul></li></ul><h2 id="2-2-Log-in-different-scenario"><a href="#2-2-Log-in-different-scenario" class="headerlink" title="2.2 Log in different scenario"></a>2.2 Log in different scenario</h2><h3 id="2-2-1-Logs-in-DB"><a href="#2-2-1-Logs-in-DB" class="headerlink" title="2.2.1 Logs in DB"></a>2.2.1 Logs in DB</h3><ul><li>Function 1: Authoritative source for restoring data<ul><li>DB need to keep in sync the variety of data structures and indexes in the presense of crashes</li><li>To make this atomic and durable, a db uses a log to <strong>write out information about the records</strong> they will be modifying, <strong>before applying the changes</strong> to all the various data structures it maintains</li><li>Since the log is <strong>immediately persisted</strong> it is used as the <strong>authoritative source</strong> in restoring all other persistent structures in the event of a crash.</li></ul></li><li>Function 2: Replicating data between DBs<ul><li>Oracle, MySQL and Postgres SQL include <strong>log shipping protocols</strong> to <strong>transmit portions of log to replica databases</strong> which act as slaves</li></ul></li></ul><h3 id="2-2-2-Logs-in-distributed-systems"><a href="#2-2-2-Logs-in-distributed-systems" class="headerlink" title="2.2.2 Logs in distributed systems"></a>2.2.2 Logs in distributed systems</h3><ul><li>Log Centric Approach</li></ul><aside>ğŸ’¡ State Machine Replication Principle: If two identical, deterministic processes begin in the same state and get the same inputs in the same order, they will produce the same output and end in the same state.</aside><ul><li>we could reduce the problem of making multiple machines all do the same thing to the problem of <strong>implementing a distributed consistent log to feed these processes input</strong><ul><li>squeeze all the non-determinism out of the input stream to ensure that each replica processing this input stays in sync.</li><li>time stamps that index the log now act as <strong>the clock for the state of the replicas</strong>â€”you can describe each replica by a single number, the timestamp for the maximum log entry it has processed.</li></ul></li></ul><h1 id="3-Log-Types"><a href="#3-Log-Types" class="headerlink" title="3. Log Types"></a>3. Log Types</h1><ul><li>What we could put in log<ul><li>log the incoming requests to a service</li><li>the state changes the service undergoes in response to request</li><li>the transformation commands it executes.</li></ul></li><li>For DB usage<ul><li>physical logging<ul><li>log the contents of each row that is changed</li></ul></li><li>logical logging<ul><li>log not the changed rows but the SQL commands that lead to the row chagnes</li></ul></li></ul></li><li>For Distributed Systems to process and replicate<ul><li>Primary Backup<ul><li>elect one replica as the leader</li><li>allow this leader to process requests in the order they arrive</li><li>log out the changes to its state from processing the requests.</li><li>The other replicas apply in order the state changes the leader makes so that they will be in sync and ready to take over as leader should the leader fail.</li><li><strong>backup will copy the result from the primary, no logical action to walk through all action primary did</strong></li></ul></li></ul></li></ul><pre><code>- State Machine Replication    - active-active model where we keep a log of the incoming requests and each replica processes each request    - **each machine will do real execution, do the logical stuff**    ![State Machine Replication](https://s2.loli.net/2022/01/29/6JtLFNpmXBYW9wO.png)</code></pre><aside>ğŸ’¡ Below 3 sections has a centric idea:  Log as a stand-alone service. The usefulness of the log comes from simple function that the log provides: **producing a persistent, re-playable record of history**. At the core of these problems is the ability to **have many machines playback history at their own rate in a deterministic manner**</aside><h1 id="4-Changelog-in-Database"><a href="#4-Changelog-in-Database" class="headerlink" title="4. Changelog in Database"></a>4. Changelog in Database</h1><ul><li>duality between a log of changes and a table<ul><li>The log is similar to the list of all credits and debits and bank processes;</li><li>a table is all the current account balances.</li><li>If you have a log of changes, you can apply these changes in order to create the table capturing the current state.</li></ul></li><li>if you have a table taking updates, you can record these changes and publish a â€œchangelogâ€ of all the updates to the state of the table. This changelog is exactly what you need to <strong>support near-real-time replicas</strong>.</li><li>Table support data at rest and logs capture changes</li></ul><aside>ğŸ’¡ The magic of the log is that if itâ€™s complete log of changes, it holds not only the contents of the final version of the table, but also allows recreating all other versions that might have existed. Thatâ€™s a backup of every previous state of the table</aside><h1 id="5-Data-Integration"><a href="#5-Data-Integration" class="headerlink" title="5. Data Integration"></a>5. Data Integration</h1><blockquote><p>Make all of an organizationâ€™s data easily available in all its storage and processing systems</p></blockquote><h2 id="5-1-Expected-workflow-for-data-integration"><a href="#5-1-Expected-workflow-for-data-integration" class="headerlink" title="5.1 Expected workflow for data integration"></a>5.1 Expected workflow for data integration</h2><ul><li>Definition in authorâ€™s scope: Making all the data an organization has available in all its services and systems.</li><li>Effective Use of Data<ul><li>Capture all relevant data</li><li>Put it together in an applicable processing env<ul><li>real time query system</li><li>text files</li><li>python scripts, etc.</li></ul></li><li>Infra to process data<ul><li>mapReduce</li><li>Real time query systems</li></ul></li><li>Good data models and consistent well understood semantics</li><li>Sophisticated processing<ul><li>visualization</li><li>reporting</li><li>algorithmic processing and prediction</li></ul></li></ul></li></ul><h2 id="5-2-Problem1-The-event-data-firehose"><a href="#5-2-Problem1-The-event-data-firehose" class="headerlink" title="5.2 Problem1: The event data firehose"></a>5.2 Problem1: The event data firehose</h2><ul><li>Event data rising</li><li>googleâ€™s fortune is actually generated by a relevance pipeline built on clicks and impressions â€” events</li><li>that would be huge amount of data,</li></ul><h2 id="5-3-Problem-2-The-explosion-of-specialized-data-systems"><a href="#5-3-Problem-2-The-explosion-of-specialized-data-systems" class="headerlink" title="5.3 Problem 2: The explosion of specialized data systems"></a>5.3 Problem 2: The explosion of specialized data systems</h2><ul><li>Explosion of specialized data systems</li><li>The combination of more data of more varieties and a desire to get this data into more systems leads to a huge data integration problem.</li></ul><h2 id="5-4-Log-Structured-Data-Flow"><a href="#5-4-Log-Structured-Data-Flow" class="headerlink" title="5.4 Log Structured Data Flow"></a>5.4 Log Structured Data Flow</h2><h3 id="5-4-1-How-the-flow-work"><a href="#5-4-1-How-the-flow-work" class="headerlink" title="5.4.1 How the flow work"></a>5.4.1 How the flow work</h3><ul><li>Recipe: Take all the organizationâ€™s data and put it into a central log for <strong>real time subscription</strong></li><li>How the flow works<ul><li>Each logical data source can be modeled as its own log</li><li>A data source could be an application that logs out events, or a db table that accepts modifications</li><li>each subscribing system reads from this log <strong>as quickly as it can</strong>, <strong>applied each new record to its own store</strong>, and <strong>advances its position</strong> in the log</li></ul></li></ul><p><img src="https://s2.loli.net/2022/01/29/ykIEs4XwnBD3LUF.png" alt="How the flow work"></p><ul><li><p>Log gives a <strong>logical clock</strong> for each change against which all subscriber can be measured</p><ul><li>Consider a case where there is a database and a collection of caching servers</li><li>log provides a way to synchronize the updates to all these systems and reason about the point of time of each of these systems</li><li>Letâ€™s say we <strong>write a record with log entry X</strong> and then need to do a read from the cache. If we want to guarantee we donâ€™t see stale data, we just need to ensure we <strong>donâ€™t read from any cache which has not replicated up to X.</strong></li></ul></li><li><p>Log also acts as a <strong>buffer</strong> that makes <strong>data production asynchronous from data consumption</strong></p><ul><li>satisfy different requirements like<ul><li>A batch system such as Hadoop or a data warehouse may consume only hourly or daily,</li><li>A real-time query system may need to be up-to-the-second.</li></ul></li></ul></li><li><p>Consumer only need to know about the log and not any details of the system of origin</p></li><li><p>What values most from author perspective</p><ul><li>The pipeline they built for process data, though a bit of a mess, were actually extremely valuable . Just the process of makeing data available in a new processing system (Hadoop) unblocked a lot of possibilities<ul><li>Many new products and analysis just came from putting together multiple pieces of data that had previously been locked up in specialized systems</li></ul></li></ul></li><li><p>LinkedIn Went Through from O(N^2) to O(2N)</p></li></ul><p><img src="https://s2.loli.net/2022/01/29/fXnmrpYFLSVGoR9.png" alt="Pre Architecture LinkedIn"><br><img src="https://s2.loli.net/2022/01/29/9dZa67tYEl1yc8e.png" alt="Cur Architecture LinkedIn"></p><ul><li>Actions for the migration<ul><li>Isolate each consumer from the source of the data</li><li>Create a new data system to be both a data source and a data destination</li><li>Here LinkedIn create Kafka</li><li>Kinesis is similar to Kafka as AWS use it to connects all different distributed systems as a piping</li></ul></li></ul><h3 id="5-4-2-Relationship-to-ETL-and-the-Data-Warehouse"><a href="#5-4-2-Relationship-to-ETL-and-the-Data-Warehouse" class="headerlink" title="5.4.2  Relationship to ETL and the Data Warehouse"></a>5.4.2  Relationship to ETL and the Data Warehouse</h3><ul><li><p>Data Warehouse</p><ul><li>target<ul><li>A repository of the clean, integrated data structured to support analysis</li></ul></li><li>what be involved<ul><li>periodically extracting data from source databases</li><li>munging it into some kind of understandable form</li><li>loading it into a central data warehouse</li></ul></li><li>Problems<ul><li>coupling the clean integrated data to the data warehouse.<ul><li>cannot get real time feed</li></ul></li><li>organization perspective<ul><li>The incentives are not aligned: data producers are often not very aware of the use of the data in the data warehouse and end up creating data that is hard to extract or requires heavy, hard to scale transformation to get into usable form.</li><li>the central team never quite manages to scale to match the pace of the rest of the organization, so data coverage is always spotty, data flow is fragile, and changes are slow.</li></ul></li></ul></li></ul></li><li><p>ETL</p><ul><li>tasks<ul><li>extraction and data cleanup process, liberating data locked up in a variety of systems in the organization and removing an system-specific non-sense</li><li>data is restructured for data warehousing queries (i.e. made to fit the type system of a relational DB, forced into a star or snowflake schema, perhaps broken up into a high performance <a href="http://parquet.io/">column</a> <a href="http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.0.0.2/ds_Hive/orcfile.html">format</a>,</li></ul></li><li>problems<ul><li>still, we need such data in real time as well for low latency processing as well as indexing in real time storage systems</li></ul></li></ul></li><li><p>A better approach as ETL and Data Warehouse substitution</p><ul><li><p>Have a central pipeline, the log, with a well defined API for adding data</p></li><li><p>Responsibility Classification</p><ul><li><p>Producer of the data feed: integrating with this pipeline and providing a clean, well-structured data feed</p></li><li><p>Datawarehouse team now <strong>only care about loading structured feeds</strong> of data from the <strong>central log</strong> and <strong>carrying out transformation specific to their system</strong></p><p>  <img src="https://s2.loli.net/2022/01/29/fMl9IQwDGk8TL4o.png" alt="Workflow and ownership classification">            </p></li></ul></li></ul></li></ul><h3 id="5-4-3-Log-Files-and-Events"><a href="#5-4-3-Log-Files-and-Events" class="headerlink" title="5.4.3 Log Files and Events"></a>5.4.3 Log Files and Events</h3><ul><li>Current structure also enables decoupled and event driven systems</li></ul><h3 id="5-4-4-How-to-build-scalable-logs"><a href="#5-4-4-How-to-build-scalable-logs" class="headerlink" title="5.4.4 How to build scalable logs"></a>5.4.4 How to build scalable logs</h3><ul><li>Need a log system thatâ€™s fast, cheap, scalable enough to make this practical at scale</li><li>LinkedIn in 2013 actually has already support 60 billion unique message writes through Kafka per day</li><li>Kafka achieve such high throughput via<ul><li>Partitioning the log<ul><li>each partition is a <strong>totally ordered log</strong>, but there is <strong>no global ordering between partitions</strong></li><li>Assignment of the messages to a particular partition is controllable by the writer, with most users choosing to partition by some kind of key</li><li>Replication<ul><li>Each partition is replicated across a configurable number of replicas</li><li>At any time, a single one of them will act as the leader, if the leader fails, one of the replicas will take over as leader</li></ul></li><li>Order Guarantee<ul><li>each partition is order preserving, and Kafka guarantees that appends to a particular partition from a single sender will be delivered in the order they are sent.</li></ul></li></ul></li><li>Optimizing throughput by batching reads and writes<ul><li>occurs when<ul><li>sending data</li><li>writes to disk</li><li>replication between servers</li><li>data transfer to consumers</li><li>acknowledging committed data</li></ul></li></ul></li><li>Avoiding needless data copies<ul><li>Use a simple binary format that is maintained between in memory log, on disk log and in network data transfers</li><li>Thus we could make use of numerous optimizations including zero copy data transfer <a href="https://en.wikipedia.org/wiki/Zero-copy">https://en.wikipedia.org/wiki/Zero-copy</a></li></ul></li></ul></li></ul><h1 id="6-Real-Time-Data-Processing"><a href="#6-Real-Time-Data-Processing" class="headerlink" title="6. Real Time Data Processing"></a>6. Real Time Data Processing</h1><blockquote><p>Computing derived data streams</p></blockquote><h2 id="6-1-Definition-of-Stream-Processing"><a href="#6-1-Definition-of-Stream-Processing" class="headerlink" title="6.1 Definition of Stream Processing"></a>6.1 Definition of Stream Processing</h2><ul><li>Infrastructure for continuous data processing<ul><li>computational model can be general like MapReduce or other distributed processing frameworks,</li><li>need the ability to produce low latency results</li></ul></li><li>Instead of batch get and process, we could do continuous changes</li><li>it is just processing which includes a notion of time in the underlying data being processed and does not require a static snapshot of the data so it can produce output at a user-controlled frequency instead of waiting for the â€œendâ€ of the data set to be reached. In this sense, stream processing is a generalization of batch processing, and, given the prevalence of real-time data, a very important generalization</li><li>Log role<ul><li>making data available in real-time multi-subscriber data feeds.</li></ul></li></ul><h2 id="6-2-Stateful-Real-Time-Processing"><a href="#6-2-Stateful-Real-Time-Processing" class="headerlink" title="6.2 Stateful Real Time Processing"></a>6.2 Stateful Real Time Processing</h2><ul><li>Stateful real time processing means some more sophisticated operations, like counts, aggregations, or joins over windows in the stream</li><li>We need to maintain certain state in such case</li><li>Strategies for that<ul><li>Keep state in memory<ul><li>cons<ul><li>if the process crash, it would lose its intermediate state</li><li>if the state is only maintained over a window, the process could fall back to the point where the window began</li></ul></li></ul></li><li>Store all state in a remote storage system, and join over the network to that store<ul><li>cons<ul><li>no locality of data and lots of network round trips</li></ul></li></ul></li><li>Duality of tables and logs<ul><li>a stream processor can keep its state in a local table or index â€” a bdb, leveldb</li><li>the contents of this store is fed from its input streams</li><li>it could journal out a changelog for this local index it keeps to allow it to restore its state in the event of a crash and restart</li><li>This mechanism allows a generic mechanism for keeping co-partitioned state in arbitrary index types local with the incoming stream data.</li><li>when facing process fails<ul><li>recover its index from the changelog</li><li>changelog itself is the transformation of the local state into a sort of incremental record at a time backup</li></ul></li></ul></li></ul></li></ul><h2 id="6-3-Log-Compaction"><a href="#6-3-Log-Compaction" class="headerlink" title="6.3 Log Compaction"></a>6.3 Log Compaction</h2><ul><li>Log need to be cleaned up someway to save the space</li><li>In Kafka, clean up has two options depending on whether the data contains keyed updates or event data<ul><li>for event data, supports just retain a window of data<ul><li>configured to be few days</li><li>also could be configured as space</li></ul></li><li>for keyed data<ul><li>as the complete log give you ability to replay it to recreate the state of the source system</li><li>but we could do log compaction by removing obsolete records â€” records whose primary key has a more recent update</li></ul></li></ul></li></ul><h1 id="7-Distributed-System-Design"><a href="#7-Distributed-System-Design" class="headerlink" title="7. Distributed System Design"></a>7. Distributed System Design</h1><blockquote><p>How practical systems can be simplified with a log centric design</p></blockquote><h2 id="7-1-Distributed-system-design-thought"><a href="#7-1-Distributed-system-design-thought" class="headerlink" title="7.1 Distributed system design thought"></a>7.1 Distributed system design thought</h2><p>Log here is responsible for data flow, consistency and recovery </p><ul><li><p>Directions</p><ul><li>Coalescing lots of little instances of each system into a few big clusters</li></ul></li><li><p>Possibility 1</p><ul><li>separation of systems remains more or less as it is for a good deal longer.</li><li>an external log that integrates data will be very important.</li></ul></li><li><p>Possibility 2</p><ul><li>re-consolidation in which a single system with enough generality starts to merge back in all the different functions into a single uber-system.</li><li>extremely hard</li></ul></li><li><p>Possibility 3</p><ul><li>data infrastructure could be unbundled into a collection of services and application-facing system apis</li><li>use open source, like in Java stacks<ul><li>zookeeper<ul><li>handle system coordination</li></ul></li><li>mesos and yarn<ul><li>process virtualization</li><li>resource management</li></ul></li><li>netty, jetty<ul><li>handle remote communication</li></ul></li><li>protobuf<ul><li>handle serialization</li></ul></li><li>kafka and bookeeper<ul><li>provide a backing log</li></ul></li></ul></li><li>path towards getting the simplicity of the single system in a more diverse and modular world that continues to evolve. If the implementation time for a distributed system goes from years to weeks because reliable, flexible building blocks emerge, then the pressure to coalesce into a single monolithic system disappears.</li></ul></li></ul><h2 id="7-2-Usage-of-log-in-system-architecture"><a href="#7-2-Usage-of-log-in-system-architecture" class="headerlink" title="7.2 Usage of log in system architecture"></a>7.2 Usage of log in system architecture</h2><ul><li><p>Usage of log in system architecture</p><ul><li>Handle data consistency (whether eventual or immediate) by sequencing concurrent updates to nodes</li><li>Provide data replication between nodes</li><li>Provide â€œcommitâ€ semantics to the writer (i.e. acknowledging only when your write guaranteed not to be lost)</li><li>Provide the external data subscription feed from the system</li><li>Provide the capability to restore failed replicas that lost their data or bootstrap new replicas</li><li>Handle rebalancing of data between nodes.</li></ul></li><li><p>What mentioned above is actually a large portion of what a distributed data system does. left over is mainly related with client facing query API and indexing strategy</p></li><li><p>System Look</p><ul><li>System is divided into two logical pieces<ul><li>log<ul><li>capture the state changes in sequential order</li></ul></li><li>serving layer<ul><li>store whatever index is required to serve queries</li></ul></li></ul></li><li>writes could go directly to the log or may be proxied by the serving layer</li><li>writes to the log yields a logical timestamp, if the system is partitioned, then the log and serving nodes will have the same number of partitions, though they may have very different numbers of machines</li></ul></li></ul><p><img src="https://s2.loli.net/2022/01/29/EXfRmnKxbGs8kHT.png" alt="Log and serving layer">    </p><ul><li><p>The client can get <strong>read-your-write semantics</strong> from any node by providing the <strong>timestamp of a write</strong> as part of its queryâ€”a serving node receiving such a query will <strong>compare the desired timestamp</strong> to <strong>its own index point</strong> and if necessary delay the request until it has indexed up to at least that time to avoid serving stale data.</p></li><li><p>For handling restoring failed nodes or moving partitions from node to node</p><ul><li>have the log retain only a fixed window of data and combine this with a snapshot of the data stored in the partition</li><li>itâ€™s possible for the log to retain a complete copy of data and garbage collect the log itself</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying">https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying</a> </li><li><a href="https://kafka.apache.org/documentation.html#design">https://kafka.apache.org/documentation.html#design</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log </tag>
            
            <tag> distributed system </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flyway</title>
      <link href="/Flyway/"/>
      <url>/Flyway/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>An open source database migration tool</li><li>Favors simplicity and convention over configuration</li><li>has 7 basic commands<ul><li>migrate</li><li>clean</li><li>info</li><li>validate</li><li>undo</li><li>baseline</li><li>repair</li></ul></li></ul><h2 id="1-1-Why-DB-migrations"><a href="#1-1-Why-DB-migrations" class="headerlink" title="1.1 Why DB migrations?"></a>1.1 Why DB migrations?</h2><ul><li>we need a way to version the table</li><li>we need to know what state is the db on this machine</li><li>database migration help us<ul><li>recreate a database from scratch</li><li>make it clear at all times what state a database is in</li><li>migrate in a deterministic way from your current version of the database to a newer one</li></ul></li></ul><h2 id="1-2-How-Flyway-works"><a href="#1-2-How-Flyway-works" class="headerlink" title="1.2 How Flyway works?"></a>1.2 How Flyway works?</h2><ul><li><p>Flyway first try to locate its schema history table</p><ul><li>if db empty, then flyway will create it instead</li><li>this default db named as <code>flyway_schema_history</code></li></ul></li><li><p>Then flyway will begin scanning the filesystem or the classpath of the application for migrations</p></li><li><p>The migrations are then sorted based on the version number and applied in order</p></li><li><p>The schema history table will be updated accordingly as each migration gets applied</p></li><li><p>we use <code>flyway migrate</code> to execute the migration</p></li></ul><h1 id="2-Flyway-Commands"><a href="#2-Flyway-Commands" class="headerlink" title="2. Flyway Commands"></a>2. Flyway Commands</h1><h2 id="2-1-migrate"><a href="#2-1-migrate" class="headerlink" title="2.1 migrate"></a>2.1 <code>migrate</code></h2><ul><li>help migrate the db</li></ul><h2 id="2-2-clean"><a href="#2-2-clean" class="headerlink" title="2.2 clean"></a>2.2 <code>clean</code></h2><ul><li>drop all objects in the confgured schemas</li></ul><h2 id="2-3-info"><a href="#2-3-info" class="headerlink" title="2.3 info"></a>2.3 <code>info</code></h2><ul><li>print the details and status information about all migrations</li></ul><h2 id="2-4-validate"><a href="#2-4-validate" class="headerlink" title="2.4 validate"></a>2.4 <code>validate</code></h2><ul><li>validates the applied migrations against the ones available on the classpath</li></ul><h2 id="2-5-undo"><a href="#2-5-undo" class="headerlink" title="2.5 undo"></a>2.5 <code>undo</code></h2><ul><li>undoes the most recently applied versioned migration</li></ul><h2 id="2-6-baseline"><a href="#2-6-baseline" class="headerlink" title="2.6 baseline"></a>2.6 <code>baseline</code></h2><ul><li>baselines an existing database, excluding all migrations up and including baseline version</li></ul><h2 id="2-7-repair"><a href="#2-7-repair" class="headerlink" title="2.7 repair"></a>2.7 <code>repair</code></h2><ul><li>repair the schema history table</li></ul><h1 id="3-Concepts"><a href="#3-Concepts" class="headerlink" title="3. Concepts"></a>3. Concepts</h1><h2 id="3-1-Migrations"><a href="#3-1-Migrations" class="headerlink" title="3.1 Migrations"></a>3.1 Migrations</h2><ul><li>all changes to the db are called migrations</li><li>migrations can be<ul><li>versioned<ul><li>types<ul><li>regular</li><li>undo<ul><li>the effect can be undone by supplying an undo migration</li></ul></li></ul></li><li>contains<ul><li><strong>version</strong><ul><li>must be unique</li></ul></li><li><strong>description</strong><ul><li>purely informative for you to be able to remember what each migration does</li></ul></li><li><strong>checksum</strong><ul><li>detect accidental changes</li></ul></li></ul></li></ul></li><li>repeatable<ul><li>contains<ul><li><strong>description</strong></li><li><strong>checksum</strong></li></ul></li><li>instead of being run just once, they are re-applied every time their checksum changes</li><li>Within a single migration run, repeatable migrations are always <strong>applied last</strong>, after all pending versioned migrations have been executed. Repeatable migrations are applied in the order of their description</li></ul></li></ul></li></ul><h3 id="3-1-1-Versioned-Migrations"><a href="#3-1-1-Versioned-Migrations" class="headerlink" title="3.1.1 Versioned Migrations"></a>3.1.1 Versioned Migrations</h3><ul><li>contains<ul><li>version<ul><li><strong>must be unique</strong></li><li>applied in order exactly once</li></ul></li><li>description<ul><li>purely informative for you to be able to remember what each migration does</li></ul></li><li>checksum<ul><li>detect accidental changes</li></ul></li></ul></li><li>used for<ul><li>creating/ altering/ dropping tables/ indexes/ foreign keys/ enums</li><li>reference data updates</li><li>user data corrections</li></ul></li></ul><h3 id="3-1-2-Undo-Migrations"><a href="#3-1-2-Undo-Migrations" class="headerlink" title="3.1.2 Undo Migrations"></a>3.1.2 Undo Migrations</h3><ul><li>A migration can fail at any point. If you have 10 statements, it is possible for the 1st, the 5th, the 7th or the 10th to fail. There is simply no way to know in advance. In contrast, undo migrations are written to undo an entire versioned migration and will not help under such conditions.</li><li>we should <strong>maintain backwards compatibility</strong> between the <strong>DB and all versions of the code</strong> currently deployed in production</li></ul><h3 id="3-1-3-Repeatable-Migrations"><a href="#3-1-3-Repeatable-Migrations" class="headerlink" title="3.1.3 Repeatable Migrations"></a>3.1.3 Repeatable Migrations</h3><ul><li><p>contains</p><ul><li>description and a checksum, but no version</li></ul></li><li><p>repeatable migrations are re-applied every time their checksum changes</p></li><li><p>Very useful for managing database objects whose definition can then simply be maintained in a single file in version control</p></li><li><p>Repeatable migrations are always applied last, after all pending versioned migrations have been executed; always applied in the order of their description</p></li></ul><h3 id="3-1-4-SQL-Based-Migrations"><a href="#3-1-4-SQL-Based-Migrations" class="headerlink" title="3.1.4 SQL Based Migrations"></a>3.1.4 SQL Based Migrations</h3><ul><li>used for<ul><li>DDL change â€” CREATE/ALTER/DROP statements for TABLES,VIEWS,TRIGGERS,SEQUENCES,â€¦</li><li>Simple reference data changes</li><li>simple bulk data changes</li></ul></li><li>Naming  Patterns<ul><li>Prefix<ul><li>v for versioned</li><li>u for undo</li><li>r for repeatable migrations</li></ul></li><li>version<ul><li>with dots or underscores separate as many parts as you like</li></ul></li><li>Separator<ul><li>__ two underscores</li></ul></li><li>Suffix<ul><li><code>.sql</code></li></ul></li></ul></li><li>Discovery<ul><li>Flyway discover sql migrations from directories <strong>referenced by the location property</strong></li></ul></li></ul><h3 id="3-1-5-Script-Based-Migrations"><a href="#3-1-5-Script-Based-Migrations" class="headerlink" title="3.1.5 Script Based Migrations"></a>3.1.5 Script Based Migrations</h3><ul><li>name patten<ul><li>``V1__execute_batch_tool.sh`</li></ul></li><li>could be used for<ul><li>triggering execution of a 3rd party application as part of the migrations</li><li>cleaning up local files</li></ul></li></ul><h3 id="3-1-6-Transactions"><a href="#3-1-6-Transactions" class="headerlink" title="3.1.6 Transactions"></a>3.1.6 Transactions</h3><ul><li>By default, Flyway <strong>wraps the execution of an entire migration within a single transaction</strong></li></ul><h2 id="3-2-Callbacks"><a href="#3-2-Callbacks" class="headerlink" title="3.2 Callbacks"></a>3.2 Callbacks</h2><ul><li><p>For the case we need to execute same action over and over again</p></li><li><p>we could hook into its lifecycle</p></li><li><p>there are certain keywords we could use, and invoke them during the process</p></li></ul><p><a href="https://flywaydb.org/documentation/concepts/callbacks">https://flywaydb.org/documentation/concepts/callbacks</a> </p><h2 id="3-3-Error-Overrides"><a href="#3-3-Error-Overrides" class="headerlink" title="3.3 Error Overrides"></a>3.3 Error Overrides</h2><ul><li>By default, in case an error is returned, flyway displays it with all necessary details, marks the migration as failed and automatically rolls it back if possible</li><li>But we could change the behavior like<ul><li>treat an error as a waring</li><li>treat a waring as an error</li><li>perform an additional action</li></ul></li></ul><h2 id="3-4-Dry-Runs"><a href="#3-4-Dry-Runs" class="headerlink" title="3.4 Dry Runs"></a>3.4 Dry Runs</h2><ul><li>Used for<ul><li>preview changes Flyway will make to the db</li><li>submit the SQL statements for review</li><li>use Flyway to determine what needs updating,</li></ul></li><li>how it works<ul><li>flyway sets up a read only connection to the db,</li><li>assesses what migrations need to run and generates a single SQL file containing all statements it would have executed in case of a regular migration run</li></ul></li></ul><h2 id="3-5-Baseline-Migrations"><a href="#3-5-Baseline-Migrations" class="headerlink" title="3.5 Baseline Migrations"></a>3.5 Baseline Migrations</h2><ul><li><p>Over the lifetime of a project, there would be tons of db objects be created/ destroyed across many migrations</p><ul><li>we want to simplify with a single, cumulative migration that represents the state of db after all of those migrations have been applied without disrupting existing env</li></ul></li><li><p>How it works?</p><ul><li>Prefixed with B followed by the version of your db they represent</li><li>Only used when deploying to new env</li><li>If used in an env where some Flyway migrations have already been applied, <strong>baseline migrations will be ignored,</strong> <strong>new env will choose the latest baseline migration as the starting point</strong><ul><li>every migration with a version below the latest baseline migrationâ€™s version is marked as ignored</li></ul></li><li>baseline migration are executed during the migrate process</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://flywaydb.org/documentation/">https://flywaydb.org/documentation/</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> database </tag>
            
            <tag> migration </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Protobuf Rampup</title>
      <link href="/Protobuf-Rampup/"/>
      <url>/Protobuf-Rampup/</url>
      
        <content type="html"><![CDATA[<h1 id="Protobuf-Learning"><a href="#Protobuf-Learning" class="headerlink" title="Protobuf Learning"></a>Protobuf Learning</h1><h1 id="1-What-are-Protocol-Buffers"><a href="#1-What-are-Protocol-Buffers" class="headerlink" title="1. What are Protocol Buffers?"></a>1. What are Protocol Buffers?</h1><ul><li>Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing structured data â€“ think XML, but smaller, faster, and simpler.</li><li>You <strong>define how you want your data to be structured</strong> once, then you <strong>use special generated source code to easily write and read your structured data</strong></li></ul><h1 id="2-Why-use-Protocol-Buffers"><a href="#2-Why-use-Protocol-Buffers" class="headerlink" title="2. Why use Protocol Buffers?"></a>2. Why use Protocol Buffers?</h1><ul><li>XML is human readable and wide language supports<ul><li>but is notoriously space intensive</li><li>encoding/ decoding can impose a huge performance penalty on applications</li></ul></li><li>With protocol buffers<ul><li>write a <code>.proto</code> description of the data structure</li><li>the <strong>protocol buffer compiler</strong> then <strong>creates a class</strong> that implements <strong>automatic encoding and parsing</strong> of the protocol buffer data with an <strong>efficient binary format</strong></li><li>the generated class <strong>provides getters and setters</strong> for the fields</li><li>take care of the details of reading and writing the protocol buffer <strong>as a unit</strong></li></ul></li></ul><h1 id="3-Java-Tutorial-In-Proto2"><a href="#3-Java-Tutorial-In-Proto2" class="headerlink" title="3. Java Tutorial (In Proto2)"></a>3. Java Tutorial (In Proto2)</h1><h2 id="3-1-Define-Protocol-Format"><a href="#3-1-Define-Protocol-Format" class="headerlink" title="3.1 Define Protocol Format"></a>3.1 Define Protocol Format</h2><pre><code class="protobuf">syntax = &quot;proto2&quot;;// starts with package delcaration // we should define this to get rid of name conflict package tutorial;// enable generating a separate .java file for each generated class option java_multiple_files = true;// specify in what java package name your generated classes should live// if not set here, it will simply match the pkg name given by the package declaration option java_package = &quot;com.example.tutorial.protos&quot;;// define the class name of the wrapper class which will represent this file // if not given, it will be auto generated by converting the file name to upper camel case option java_outer_classname = &quot;AddressBookProtos&quot;;/**Message Definition: An aggregate containing a set of typed fields Contain certain standard types    + boo1    + int32     + float     + double     + string we could also add further structure to msgs by using other msg types as field types + marker     + identify the unique tag field use in binary encoding     + try to use 1 - 15 as it neeeds one less byte+ modifier     + optional         + field may or may not be set         + if not, a default value will be used             + we could set our own default values             + or system will provide defaults                 + numeric types -- zero                 + strings -- empty string                 + bools -- false                 + embedded messages -- default instance or prototype of the message, which has none of its fields set     + repeated         + the field may be repeated any number of times [0, xxx)         + order will be preserved in the protocol buffer         + act like a dynamic sized array     + required         + a value for the field must be provided        + try to build an uninitialized msg will throw runtime exception         + parse an uninitialzied msg will throw IOException         + required is not favored as it cannot be backward compatible */message Person &#123;    // =1 marker identify the unique tag that field uses in the binary encoding   optional string name = 1;  optional int32 id = 2;  optional string email = 3;  enum PhoneType &#123;    MOBILE = 0;    HOME = 1;    WORK = 2;  &#125;  message PhoneNumber &#123;    optional string number = 1;    optional PhoneType type = 2 [default = HOME];  &#125;  repeated PhoneNumber phones = 4;&#125;message AddressBook &#123;  repeated Person people = 1;&#125;</code></pre><h2 id="3-2-Compiling-Protocol-Buffers"><a href="#3-2-Compiling-Protocol-Buffers" class="headerlink" title="3.2 Compiling Protocol Buffers"></a>3.2 Compiling Protocol Buffers</h2><ul><li>To generate the classes, we need to run the protocol buffer compiler</li><li>specify the source directory, the destination directory and the path to our <code>.proto</code></li></ul><pre><code class="protobuf">protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto </code></pre><h2 id="3-3-Protocol-Buffer-API"><a href="#3-3-Protocol-Buffer-API" class="headerlink" title="3.3 Protocol Buffer API"></a>3.3 Protocol Buffer API</h2><ul><li>compiler helps auto generate source file<ul><li>getters and setters</li><li>each field also has <code>clear</code> method to set the field back to its empty state</li></ul></li><li>Builders vs Messages<ul><li>message classes are immutable</li><li>builder is used when you first construct a builder, then we could call the builderâ€™s build() method</li></ul></li><li>standard message methods<ul><li><code>isInitialized</code> check if all the required fields have been set</li><li><code>toString</code> returns a human readable representation of the msg</li><li><code>mergeFrom(Message other)</code> merge the contents of other into this msg, overwrite singular scalar fields</li><li><code>clear</code> clear all the fields back to the empty state</li></ul></li><li>Parsing and Serialization<ul><li><code>byte[] toByteArray();</code><ul><li>serializes the msg and returns a byte array containing its raw bytes</li></ul></li><li><code>static xxx parseFrom(byte[] data);</code><ul><li>parse a msg from the given byte array</li></ul></li><li><code>void writeTo(OutputStream output);</code><ul><li>serialize the msg and writes to an OutputStream</li></ul></li><li><code>static xxx parseFrom(InputStream input);</code><ul><li>reads and parses a msg from an InputStream</li></ul></li></ul></li></ul><h2 id="3-4-How-to-extend-a-Protocol-Buffer"><a href="#3-4-How-to-extend-a-Protocol-Buffer" class="headerlink" title="3.4 How to extend a Protocol Buffer"></a>3.4 How to extend a Protocol Buffer</h2><ul><li>In the new version of the protocol buffer<ul><li>must not change the tag numbers of any existing fields</li><li>must not add or delete any required fields</li><li>may delete optional or repeated fields</li><li>may add new optional or repeated fields but must use fresh tag numbers</li></ul></li></ul><h1 id="4-Overall-Guide-In-Proto3"><a href="#4-Overall-Guide-In-Proto3" class="headerlink" title="4. Overall Guide (In Proto3)"></a>4. Overall Guide (In Proto3)</h1><h2 id="4-1-Define-message-type"><a href="#4-1-Define-message-type" class="headerlink" title="4.1 Define message type"></a>4.1 Define message type</h2><ul><li>Each field in the msg definition need to have a <strong>unique number</strong><ul><li>those numbers are used to identify fields in the message binary format</li><li>the number should never be changed</li></ul></li><li>specify field rules<ul><li>singular<ul><li>default field rule for proto3 syntax</li><li>can have <strong>zero or one of this field</strong></li></ul></li><li>repeated<ul><li>can be repeated any number of times (including zero)</li></ul></li></ul></li><li>reserved fields<ul><li>if you update a msg type by entirely removing a field or commenting it out, future users can reuse the field number but it would bring severe issues,</li><li>thus we could reserved the number for deleted fields and tag number</li></ul></li></ul><pre><code class="protobuf">message Foo &#123;  reserved 2, 15, 9 to 11;  reserved &quot;foo&quot;, &quot;bar&quot;;&#125;</code></pre><ul><li>Post compiler running<ul><li>Compiler generates a <code>.java</code> file with a class for each message type, as well as Builder classes for creating message class instances</li></ul></li><li>For enum values<ul><li>every enum definition must contain a constant that maps to zero as its first element</li><li>we can allow alias thus we could assign the same value to different enum constants</li></ul></li><li>import<ul><li>we could do import thus we could use definitions from other <code>.proto</code> file</li></ul></li></ul><h2 id="4-2-Scalar-Value-Types"><a href="#4-2-Scalar-Value-Types" class="headerlink" title="4.2 Scalar Value Types"></a>4.2 Scalar Value Types</h2><p><a href="https://developers.google.com/protocol-buffers/docs/proto3#scalar">Language Guide (proto3) | Protocol Buffers | Google Developers</a></p><h2 id="4-3-Nested-Types"><a href="#4-3-Nested-Types" class="headerlink" title="4.3 Nested Types"></a>4.3 Nested Types</h2><ul><li>we could define and use msg types inside other msg types</li></ul><pre><code class="protobuf">message SearchResponse &#123;  message Result &#123;    string url = 1;    string title = 2;    repeated string snippets = 3;  &#125;  repeated Result results = 1;&#125;// to use the msg type outside its parent message type message SomeOtherMessage &#123;  SearchResponse.Result result = 1;&#125;</code></pre><h2 id="4-4-Updating-a-Message-Type"><a href="#4-4-Updating-a-Message-Type" class="headerlink" title="4.4 Updating a Message Type"></a>4.4 Updating a Message Type</h2><ul><li>donâ€™t change the field numbers for any existing fields</li><li>if you add new fields, any msg serialized by code using your old msg format can still be parsed by your new generated code<ul><li>keep in mind the default values for these elements so that new code can properly interact with msgs generated by old code</li></ul></li><li>to remove a field<ul><li>rename the field with prefix like <code>OBSOLETE_</code></li><li>or make the filed number reserved,</li></ul></li><li>int32, uint32, int64, uint64 and bool are all compatible</li><li>string and bytes are compatible as long as the bytes are valid UTF-8</li></ul><h2 id="4-5-Special-Keywords"><a href="#4-5-Special-Keywords" class="headerlink" title="4.5 Special Keywords"></a>4.5 Special Keywords</h2><h3 id="4-5-1-Any"><a href="#4-5-1-Any" class="headerlink" title="4.5.1 Any"></a>4.5.1 <code>Any</code></h3><ul><li>let you use messages as embedded types without having their .proto definition</li><li>it contains an aribitrary serialized messages as bytes</li></ul><h3 id="4-5-2-Oneof"><a href="#4-5-2-Oneof" class="headerlink" title="4.5.2 Oneof"></a>4.5.2 Oneof</h3><ul><li>if we have a msg with many fields and where at most one field will be set at the same time, we can enforce the behavior and save memory by using the oneof feature</li><li>at most one field can be set at the same time</li><li>setting any member of the oneof automatically clears all the other members</li></ul><h2 id="4-6-Maps"><a href="#4-6-Maps" class="headerlink" title="4.6 Maps"></a>4.6 Maps</h2><ul><li><code>map&lt;key_type, value_type&gt; map_field = N;</code></li></ul><h2 id="4-7-Define-Service"><a href="#4-7-Define-Service" class="headerlink" title="4.7 Define Service"></a>4.7 Define Service</h2><ul><li>If you want to use message types with an RPC system, we can define an RPC service interface in a <code>.proto</code> file</li><li>then the protocol buffer compiler will <strong>generate service interface code and stubs</strong> in chosen language</li></ul><h2 id="4-8-Options"><a href="#4-8-Options" class="headerlink" title="4.8 Options"></a>4.8 Options</h2><ul><li><p>Options do not change the overall meaning of a declaration, but may affect the way it is handled in a particular context.</p></li><li><p>java_package</p><ul><li>pkg you want to use for your generated Java classes</li></ul></li><li><p>java_outer_classname</p><ul><li>class name for the wrapper java class you want to generate</li></ul></li><li><p>java_multiple_files</p></li><li><p><code>optimize_for</code></p><ul><li><code>SPEED</code><ul><li>Compiler will generate code for serializing, parsing and performing other common operations on your msg types.</li><li>Code is highly optimized</li></ul></li><li><code>CODE_SIZE</code><ul><li>generate minimal classes</li><li>operations will be slower</li></ul></li><li><code>LITE_RUNTIME</code><ul><li>only depend on the lite runtime library</li><li>usefyl for apps running on constrained platform like mobile phones</li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>Overview <a href="https://developers.google.com/protocol-buffers">https://developers.google.com/protocol-buffers</a> </li><li>Language Guide <a href="https://developers.google.com/protocol-buffers/docs/overview">https://developers.google.com/protocol-buffers/docs/overview</a> </li><li>Java Tutorial <a href="https://developers.google.com/protocol-buffers/docs/javatutorial">https://developers.google.com/protocol-buffers/docs/javatutorial</a> </li><li>Java Generated Code <a href="https://developers.google.com/protocol-buffers/docs/reference/java-generated">https://developers.google.com/protocol-buffers/docs/reference/java-generated</a> </li><li>Java Encoding <a href="https://developers.google.com/protocol-buffers/docs/encoding">https://developers.google.com/protocol-buffers/docs/encoding</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Protobuf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bazel Intro</title>
      <link href="/Bazel-Intro/"/>
      <url>/Bazel-Intro/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-Bazel"><a href="#1-What-is-Bazel" class="headerlink" title="1. What is Bazel?"></a>1. What is Bazel?</h1><ul><li><p>Bazel is a build and test tool built that supports building and testing multiple projects for multiple languages and build outputs</p></li><li><p>What</p><ul><li>Build and Test tool similar to Make, Maven, Gradle</li><li>Caches all the previously done work, tests or builds faster everytime</li><li>Support multi languages, multi platforms,</li><li>Support large code base across multi repos</li><li>build, test, and query to trace dependencies in the code</li></ul></li><li><p>Why</p><ul><li>scales</li><li>multi platform</li></ul></li><li><p>How</p><ul><li>Need a BUILD file</li></ul></li></ul><h1 id="2-Concepts"><a href="#2-Concepts" class="headerlink" title="2. Concepts"></a>2. Concepts</h1><ul><li>Workspace - With WORKSPACE<ul><li>dir contains the source file</li><li>considered as root</li></ul></li><li>WORKSPACE<ul><li>a blank text file, which identifies the directory and its content as a Bazel workspace</li><li>at the root of the projectâ€™s directory structure</li></ul></li><li>Repos - With WORKSPACE<ul><li>External repos are defined in the WORKSPACE file using workspace rules</li></ul></li><li>Packages - With BUILD<ul><li>A package is defined as a directory containing a file named BUILD or BUILD.bazel</li><li>which reside beneath top level directory in the ws</li><li>This file has instructions on how to <strong>run or build or test</strong> the project</li></ul></li><li>Rules<ul><li>written using a DSL named Starlark</li><li>thus are built for certain language already like rules_java, etc.</li></ul></li><li>Targets<ul><li>Pkg is container, element of pkg â€”- target</li><li>Most targets are files or rules<ul><li>File<ul><li>source files - written by people</li><li>generated files â€” generated by build tool</li></ul></li><li>rule<ul><li>specify relationship between set of inputs and output</li><li>output are always generated files</li></ul></li></ul></li></ul></li></ul><h1 id="3-Best-Practices"><a href="#3-Best-Practices" class="headerlink" title="3. Best Practices"></a>3. Best Practices</h1><ul><li>A project should always be able to run <code>bazel build //...</code> and <code>bazel test //...</code></li><li>You may declare third party dependencies<ul><li>either declare them as remote repositories in the WORKSPACE file</li><li>or put them in a directory called third_party under workspace directory</li></ul></li><li>everything should be built from source whenever possible, instead of depending on a library so file, we should create a BUILD file and build so from its sources, then depend on that target</li><li>for project specific options, use the configuration file under <code>workspace/.bazelrc</code></li><li>every directory that contains buildable files should be a package</li></ul><h1 id="4-Build-a-Java-Project"><a href="#4-Build-a-Java-Project" class="headerlink" title="4. Build a Java Project"></a>4. Build a Java Project</h1><h2 id="4-1-Bazel-Jave-Basic"><a href="#4-1-Bazel-Jave-Basic" class="headerlink" title="4.1 Bazel Jave Basic"></a>4.1 Bazel Jave Basic</h2><ul><li><p>Refer <a href="https://docs.bazel.build/versions/1.2.0/tutorial/java.html">https://docs.bazel.build/versions/1.2.0/tutorial/java.html</a></p></li><li><p>build rule tells bazel how to build the desired outputs, executable binaries or libraries</p><ul><li>the java binary rule tells bazel to build a jar file and a wrapper shell script</li></ul></li><li><p><code>bazel build //:ProjectRunner</code></p><ul><li>the <code>//</code> part is the location of our BUILD file relative to the root of the workspace</li><li><code>ProjectRunner</code> is the target name we define in the BUILD file</li></ul></li><li><p>we could review our dependency graph by using</p><ul><li><code>bazel query --notool_deps --noimplicit_deps &quot;deps(//:ProjectRunner)&quot; --output graph</code></li></ul></li></ul><pre><code class="ruby">// generate graph for class in use, and output as a svg file bazel query  --notool_deps --noimplicit_deps &quot;deps(//booking)&quot; --output graph &gt; /Users/lchen1/Documents/bookingGraph.in dot -Tsvg &lt; bookingGraph.in &gt; graph.svg</code></pre><h2 id="4-2-Specify-multiple-build-targets"><a href="#4-2-Specify-multiple-build-targets" class="headerlink" title="4.2 Specify multiple build targets"></a>4.2 Specify multiple build targets</h2><ul><li><p>Package Splits</p><ul><li><p>for larger project, we may want to split into multiple targets and packages to allow for fast incremental builds, this could also speed up builds by building multiple parts of a project at once</p><pre><code class="json">java_binary(  name = &quot;ProjectRunner&quot;,  srcs = [&quot;src/main/java/com/example/ProjectRunner.java&quot;],  main_class = &quot;com.example.ProjectRunner&quot;,  deps = [&quot;:greeter&quot;],)java_library(  name = &quot;greeter&quot;,  srcs = [&quot;src/main/java/com/example/Greeting.java&quot;],)</code></pre></li></ul></li></ul><ul><li>with this configuration, bazel will first build greeter library, then the projectRunner binary<ul><li>deps attribute tells bazel the greeter library is required to build the projectRunner binary</li></ul></li></ul><h2 id="4-3-Use-multiple-packages"><a href="#4-3-Use-multiple-packages" class="headerlink" title="4.3 Use multiple packages"></a>4.3 Use multiple packages</h2><pre><code class="json">java_binary(    name = &quot;runner&quot;,    srcs = [&quot;Runner.java&quot;],    main_class = &quot;com.example.cmdline.Runner&quot;,    deps = [&quot;//:greeter&quot;])</code></pre><ul><li>To make sure above works, we need to let greeter be visible to cmdline.Runner<ul><li>Let the resource owner set the visibility attribute</li><li>we need to do this cause Bazel by default makes target only visible to other targets in the same BUILD file</li><li>bazel uses target visibility to prevent issues such as libraries containing implementation details leaking into public APIs</li></ul></li></ul><pre><code class="json">java_library(    name = &quot;greeter&quot;,    srcs = [&quot;src/main/java/com/example/Greeting.java&quot;],    visibility = [&quot;//src/main/java/com/example/cmdline:__pkg__&quot;],    )</code></pre><h2 id="4-4-Use-labels-to-reference-targets"><a href="#4-4-Use-labels-to-reference-targets" class="headerlink" title="4.4 Use labels to reference targets"></a>4.4 Use labels to reference targets</h2><ul><li>Bazel uses target labels to reference targets<ul><li><code>//:ProjectRunner</code></li><li>sync as follow:<ul><li><code>//path/to/package:target-name</code></li></ul></li></ul></li><li>when referencing targets within the same BUILD file, we can skip the <code>//</code> workspace root identifier and just use <code>:target_name</code></li></ul><h1 id="5-E-G"><a href="#5-E-G" class="headerlink" title="5. E.G"></a>5. E.G</h1><ul><li>java_binary<ul><li>pre defined rule telling bazel to create a binary when a target is invoked</li></ul></li></ul><pre><code class="json">java_binary(        // target name     name = &quot;mymain&quot;,        // all source files, passed as glob, inside the fully qualified directory names on classpath     srcs = glob([&quot;src/main/java/com/abhi/*.java&quot;]),        // main runner class     main_class = &quot;com.abhi.MyMain&quot;,        // dependent classes/ interfaces to be included, not part of srcs     deps = [&quot;//another-dir:animal&quot;])</code></pre><ul><li>java_library<ul><li>pre-defined to create library as the name suggests</li></ul></li></ul><pre><code class="json">java_library(    name = &quot;animal&quot;,    srcs = [&quot;src/main/java/com/abhi/Animal.java&quot;],        // if other class is implemented in a different pkg, it has to be visible to main-dir     visibility = [&quot;//main-dir:__pkg__&quot;])</code></pre><ul><li>CLI Reference<ul><li><code>bazel build //main-dir:mymain</code><ul><li>// means a valid package name</li><li>mymain is the target name</li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>Bazel best practice <a href="https://docs.bazel.build/versions/main/best-practices.html">https://docs.bazel.build/versions/main/best-practices.html</a> </li><li>Bazel Overview  <a href="https://docs.bazel.build/versions/1.2.0/bazel-overview.html">https://docs.bazel.build/versions/1.2.0/bazel-overview.html</a> </li><li>Java Tutorial <a href="https://docs.bazel.build/versions/1.2.0/tutorial/java.html">https://docs.bazel.build/versions/1.2.0/tutorial/java.html</a> </li><li>How to specify targets to build <a href="https://docs.bazel.build/versions/main/guide.html#target-patterns">https://docs.bazel.build/versions/main/guide.html#target-patterns</a> </li></ol><p><a href="https://docs.bazel.build/versions/4.2.1/command-line-reference.html">Command-Line Reference</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bazel </tag>
            
            <tag> Package Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GraphQL Read</title>
      <link href="/GraphQL-Read/"/>
      <url>/GraphQL-Read/</url>
      
        <content type="html"><![CDATA[<h1 id="GraphQL-Read"><a href="#GraphQL-Read" class="headerlink" title="GraphQL Read"></a>GraphQL Read</h1><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><ul><li>QraphQL is<ul><li>a query language</li><li>a server side runtime for executing queries using a type system you define</li></ul></li></ul><h1 id="2-Queries-and-Mutations"><a href="#2-Queries-and-Mutations" class="headerlink" title="2. Queries and Mutations"></a>2. Queries and Mutations</h1><ul><li>Fields<ul><li>GraphQL is about asking specific fields on objects</li><li>Query has the same shape as result<ul><li>server knows exactly what fields the client is asking for</li></ul></li></ul></li></ul><pre><code class="ruby">&#123;    hero &#123;        name    &#125;&#125;&#123;    &quot;data&quot;: &#123;        &quot;hero&quot;: &#123;            &quot;name&quot;: &quot;12test&quot;        &#125;    &#125;&#125;</code></pre><ul><li><p>Arguments</p><ul><li>we could pass arguments to fields</li><li>comparing with Restful, in GraphQL every field and nested object can get its own set of arguments, making GraphQL a complete replacement for making multiple APU fetches</li></ul></li><li><p>Fragments</p><ul><li>Thatâ€™s the reusable units in GraphQL</li><li>Fragments let you construct sets of fields, and then include them in queries where you need to</li><li>Itâ€™s commonly used to split complicated application data requirements into smaller chunks</li></ul></li><li><p>Operation Name</p><ul><li>Operation Type<ul><li>Query</li><li>Mutation</li><li>Subscription</li></ul></li><li>Operation Name</li></ul></li><li><p>Variables</p><ul><li>It want to give dynamic power to graphql, as in most applications, the arguments to fields will be dynamic</li><li>Graphql supports this use case via variables</li><li>we could do:<ul><li>replace the static value in the query with <code>$variable</code></li><li>declare <code>$variable</code> as one of the variables accepted by the query</li><li>pass <code>variable: value</code> in the separate transport specific variables dictionary</li></ul></li><li>using variable could help us denote which arguments are expected to be dynamic</li><li>we should never do string interpolation to construct queries from user supplied values</li></ul></li></ul><pre><code class="ruby">query HeroNameAndFriends($episode: Episode) &#123;  hero(episode: $episode) &#123;    name    friends &#123;      name    &#125;  &#125;&#125;&#123;  &quot;episode&quot;: &quot;JEDI&quot;&#125; </code></pre><ul><li>Default variables</li></ul><pre><code class="ruby">query HeroNameAndFriends($episode: Episode = &quot;defaultOne&quot;) &#123;  hero(episode: $episode) &#123;    name    friends &#123;      name    &#125;  &#125;&#125;&#123;  &quot;episode&quot;: &quot;JEDI&quot;&#125; </code></pre><ul><li><p>Directives</p><ul><li>use this variable to dynamically change the structure and shape of our queries using variables</li><li><code>@include(if: Boolean)</code> only includes this field in the result if the argument is true</li><li><code>@skip(if: Boolean)</code> skip this field if the argument is true</li></ul></li><li><p>Mutations</p><ul><li>A way to modify server side data</li><li>A convention that any operations that cause writes should be sent explicitly via a mutation</li><li>!!! While query fields are executed in parallel, mutation fields run in series, one after the other<ul><li>means if we send two incrementCredits mutations in one request, the first is guranteed to finish before the second begins, ensuring that we donâ€™t end up with a race condition with ourselves</li></ul></li></ul></li><li><p>Inline Fragments</p><ul><li><p>GraphQL schemas include the ability to define interfaces and union types</p></li><li><p>EG below, we need to return different attributes based on hero character</p><pre><code class="ruby">query HeroForEpisode($ep: Episode!) &#123;hero(episode: $ep) &#123;  name  ... on Droid &#123;    primaryFunction  &#125;  ... on Human &#123;    height  &#125;&#125;&#125;</code></pre></li></ul></li><li><p>Meta fields</p><ul><li>there are situations where you donâ€™t know what type youâ€™ll get back from the service</li><li>we need to determine how to handle that data on the client</li><li>we could use <code>__typename</code></li></ul></li></ul><h1 id="3-Schemas-and-Types"><a href="#3-Schemas-and-Types" class="headerlink" title="3. Schemas and Types"></a>3. Schemas and Types</h1><h2 id="3-1-how-the-schema-work"><a href="#3-1-how-the-schema-work" class="headerlink" title="3.1 how the schema work"></a>3.1 how the schema work</h2><ul><li><p>How does GraphQL work</p><ul><li><p>start with a <code>root</code> object</p></li><li><p>select the hero field on that</p></li><li><p>for the object returned by hero, we select the name and appearsIn fields</p><pre><code class="ruby">&#123;hero &#123;  name  appearsIn&#125;&#125;</code></pre></li></ul></li><li><p>we should know what we could query for</p><ul><li>an exact description of the data we can ask for</li><li>what kind of objects might they return</li><li>what fields are available on those sub objects</li></ul></li><li><p>Schema</p><ul><li>Each graphQL services defines a set of types which completely describe the set of possible data you can query on the service</li></ul></li></ul><h2 id="3-2-Type-Language"><a href="#3-2-Type-Language" class="headerlink" title="3.2 Type Language"></a>3.2 Type Language</h2><ul><li>GraphQL use its won Schema Language</li></ul><h3 id="3-2-1-Object-Types-and-Fields"><a href="#3-2-1-Object-Types-and-Fields" class="headerlink" title="3.2.1 Object Types and Fields"></a>3.2.1 Object Types and Fields</h3><ul><li>Object types<ul><li>represent a kind of object you can fetch from your service, and what fields it has</li></ul></li></ul><pre><code class="ruby">type Character &#123;  name: String!// means an array of Episode objects, notnull, 0 or more items, and each item would be an episode object   appearsIn: [Episode!]!&#125;</code></pre><h3 id="3-2-2-Query-and-Mutation-types"><a href="#3-2-2-Query-and-Mutation-types" class="headerlink" title="3.2.2 Query and Mutation types"></a>3.2.2 Query and Mutation types</h3><ul><li>Entry points into the schema</li></ul><h3 id="3-2-3-Scalar-Types"><a href="#3-2-3-Scalar-Types" class="headerlink" title="3.2.3 Scalar Types"></a>3.2.3 Scalar Types</h3><ul><li>Scalar types represent the leaves of the query</li><li>default scalar types<ul><li>Int</li><li>Float</li><li>String</li><li>Boolean</li><li>ID<ul><li>it represents a unique identifier</li><li>The ID type is serialized in the same way as a String, but it means itâ€™s not intended to be human readable</li></ul></li></ul></li><li>We could also define our own Scalar type in this way<ul><li><code>scalar Date</code></li></ul></li></ul><h3 id="3-2-4-Enumeration-Types"><a href="#3-2-4-Enumeration-Types" class="headerlink" title="3.2.4 Enumeration Types"></a>3.2.4 Enumeration Types</h3><ul><li>Restricted to a particular set of allowed values</li><li>Allow you to<ul><li>validate that any arguments of this type are one of the allowed values</li><li>communicate through the type system that a field will always be one of a finite set of values</li></ul></li></ul><h3 id="3-2-5-Lists-and-Non-Null"><a href="#3-2-5-Lists-and-Non-Null" class="headerlink" title="3.2.5 Lists and Non-Null"></a>3.2.5 Lists and Non-Null</h3><pre><code>type Character &#123;  name: String!  appearsIn: [Episode]!&#125;</code></pre><ul><li>We could use <code>!</code> to indicate it should never return null</li><li>We could use <code>[]</code> to indicate that should be an array</li></ul><h3 id="3-2-6-Interfaces"><a href="#3-2-6-Interfaces" class="headerlink" title="3.2.6 Interfaces"></a>3.2.6 Interfaces</h3><ul><li>An abstract type that includes a certain set of fields that a type must include to implement the interface</li></ul><pre><code class="ruby">interface Character &#123;    id: ID!  name: String!  friends: [Character]  appearsIn: [Episode]!&#125;type Human implements Character &#123;  id: ID!  name: String!  friends: [Character]  appearsIn: [Episode]!  starships: [Starship]  totalCredits: Int&#125;type Droid implements Character &#123;  id: ID!  name: String!  friends: [Character]  appearsIn: [Episode]!  primaryFunction: String&#125;</code></pre><ul><li>Type implement the interface need to have all those fields, but they could also have their own fields</li></ul><h3 id="3-2-7-Union-Types"><a href="#3-2-7-Union-Types" class="headerlink" title="3.2.7 Union Types"></a>3.2.7 Union Types</h3><p><code>union SearchResult = Human | Droid | Starship</code></p><h3 id="3-2-8-Input-Types"><a href="#3-2-8-Input-Types" class="headerlink" title="3.2.8 Input Types"></a>3.2.8 Input Types</h3><ul><li>we need to pass complex objects especially when we are using mutations, where we want to pass in a whole object to be created</li></ul><pre><code class="ruby">input ReviewInput &#123;  stars: Int!  commentary: String&#125;mutation CreateReviewForEpisode($ep: Episode!, $review: ReviewInput!) &#123;  createReview(episode: $ep, review: $review) &#123;    stars    commentary  &#125;&#125;</code></pre><h1 id="4-Validation"><a href="#4-Validation" class="headerlink" title="4. Validation"></a>4. Validation</h1><ul><li>Graph ql has validation module to fulfill the validation phase of fulfilling a graphQL result</li></ul><h1 id="5-Execution"><a href="#5-Execution" class="headerlink" title="5. Execution"></a>5. Execution</h1><h2 id="5-1-Resolvers"><a href="#5-1-Resolvers" class="headerlink" title="5.1 Resolvers"></a>5.1 Resolvers</h2><ul><li>Each field in a GraphQL query is a function or method of the previous type which returns the next type</li><li>Each field is backed by a function called the resolver. When a field is executed, the corresponding resolver is called to produce the next value</li><li>The resolver continue to work until reach scalar values</li></ul><h2 id="5-2-Root-fields"><a href="#5-2-Root-fields" class="headerlink" title="5.2 Root fields"></a>5.2 Root fields</h2><pre><code class="ruby">Query: &#123;  human(obj, args, context, info) &#123;    return context.db.loadHumanByID(args.id).then(      userData =&gt; new Human(userData)    )  &#125;&#125;</code></pre><ul><li>obj<ul><li>previous object</li></ul></li><li>args<ul><li>arguments provided to the field in the graphQL query</li></ul></li><li>context<ul><li>a value which is provided to every resolver and holds important contextual information like the currently logged in user, or access to a database</li></ul></li><li>info<ul><li>a value which holds field specific information relevant to the current query as well as the schema details</li></ul></li></ul><h1 id="6-Best-Practices"><a href="#6-Best-Practices" class="headerlink" title="6. Best Practices"></a>6. Best Practices</h1><h2 id="6-1-HTTP"><a href="#6-1-HTTP" class="headerlink" title="6.1 HTTP"></a>6.1 HTTP</h2><ul><li><p>Mostly use HTTP with graphQL</p></li><li><p>Normally web frameworks use a pipeline model where requests are passed through a stack of middle ware</p></li><li><p>Requests could be inspected, transformed, modified or terminated with a response</p></li><li><p>GraphQL should be placed after all authentication middlewareâ€” thus you have access to the same session and user info you would in your HTTP endpoints handler</p></li><li><p>GraphQL server operates on a single URL/ endpoint, usually <code>graphql</code> , and all graphql requests for a given service should be directed at this endpoint</p></li></ul><h2 id="6-2-JSON-with-GZIP"><a href="#6-2-JSON-with-GZIP" class="headerlink" title="6.2 JSON with GZIP"></a>6.2 JSON with GZIP</h2><ul><li>typically respond using JSON, and we compress it with GZIP</li></ul><h2 id="6-3-Versioning"><a href="#6-3-Versioning" class="headerlink" title="6.3 Versioning"></a>6.3 Versioning</h2><ul><li>No need to do versioning for graphql api</li><li>Why do most APIs version? When thereâ€™s limited control over the data thatâ€™s returned from an API endpoint, <em>any change</em> can be considered a breaking change, and breaking changes require a new version. If adding new features to an API requires a new version, then a tradeoff emerges between releasing often and having many incremental versions versus the understandability and maintainability of the API.</li><li>In contrast, GraphQL only returns the data thatâ€™s explicitly requested, so new capabilities can be added via new types and new fields on those types without creating a breaking change. This has led to a common practice of always avoiding breaking changes and serving a versionless API.</li></ul><h2 id="6-4-Nullability"><a href="#6-4-Nullability" class="headerlink" title="6.4 Nullability"></a>6.4 Nullability</h2><ul><li>GraphQL default to nullable unless you specifically declare nonnull</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.graphql-java-kickstart.com/">https://www.graphql-java-kickstart.com/</a>  </li><li><a href="https://graphql.org/learn/">https://graphql.org/learn/</a>  </li><li><a href="https://www.apollographql.com/docs/federation/">https://www.apollographql.com/docs/federation/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç¼“è§£ç–²åŠ³</title>
      <link href="/%E5%A6%82%E4%BD%95%E7%BC%93%E8%A7%A3%E7%96%B2%E5%8A%B3/"/>
      <url>/%E5%A6%82%E4%BD%95%E7%BC%93%E8%A7%A3%E7%96%B2%E5%8A%B3/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/11/02/zEvGV8uDnJxoITr.png" alt="å¦‚ä½•æŠµæŠ—ç¼“è§£ç–²åŠ³.png"></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¢³è¾¾å³°ä¸ç¢³ä¸­å’Œ</title>
      <link href="/%E7%A2%B3%E8%BE%BE%E5%B3%B0%E4%B8%8E%E7%A2%B3%E4%B8%AD%E5%92%8C/"/>
      <url>/%E7%A2%B3%E8%BE%BE%E5%B3%B0%E4%B8%8E%E7%A2%B3%E4%B8%AD%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/09/30/XGS6Qey4qHki2FC.png" alt="ç¢³è¾¾å³°ä¸ç¢³ä¸­å’Œ"></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Cassandra</title>
      <link href="/Cassandra/"/>
      <url>/Cassandra/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/09/17/IGdzKBJwD9TbZ6f.png" alt="Cassandra MindMap.png"></p><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><h2 id="1-1-Background"><a href="#1-1-Background" class="headerlink" title="1.1 Background"></a>1.1 Background</h2><ul><li>We wanna have a distributed and scalable system that can store a <strong>huge amount of structured data</strong>, which is indexed by a row key where each row can have an <strong>unbounded</strong> number of columns.</li><li>Cassandra was originally developed at Facebook in 2007 for index search feature. Itâ€™s designed to provide scalability, availability, and reliability to store large amounts of data.</li><li>It combines nature of Dynamo which is a <strong>key value store</strong> and the data model of Bigtable which is a <strong>column based</strong> data store</li><li>Cassandra is in favor of availability and partition tolerance, it could be tuned with <strong>replication factor</strong> and <strong>consistency levels</strong> to meet <strong>strong consistency</strong> requirements, and of course with a performance cost.</li><li>It uses peer to peer architecture, with each node connected to all other nodes</li><li>Each Cassandra node performs all database operations and can serve client requests without the need for any leader node.</li></ul><h2 id="1-2-Use-cases"><a href="#1-2-Use-cases" class="headerlink" title="1.2 Use cases"></a>1.2 Use cases</h2><ul><li>Store key value data with high availability</li><li>Time series data model<ul><li>Due to its data model and log structured storage engine, cassandra benefits from high performing write operations, This also make it well suited for storing and analyzing sequentially captured metrics</li></ul></li><li>Write Heavy Applications<ul><li>Suited for write intensive applications such as time series streaming services, sensor logs, and IoT applications</li></ul></li></ul><h1 id="2-High-Level-Architecture"><a href="#2-High-Level-Architecture" class="headerlink" title="2. High Level Architecture"></a>2. High Level Architecture</h1><h2 id="2-1-Common-Terms"><a href="#2-1-Common-Terms" class="headerlink" title="2.1 Common Terms"></a>2.1 Common Terms</h2><p><img src="https://i.loli.net/2021/09/17/IrfBD5HFqAX76NJ.png" alt="Primary and Clustering Keys"></p><ul><li>Column<ul><li>A key value pair and is the most basic unit of data structure</li><li>Column Key: Uniquely identifies a column in a row</li><li>Column Value: Store a value or a collection of values</li></ul></li><li>Row<ul><li>A container for columns referenced by primary key. Cassandra does not store a column that has a null value, this saves a lot of space</li></ul></li><li>Table<ul><li>A container of rows</li></ul></li><li>Keyspace<ul><li>A container for tables that span over one or more Cassandra nodes</li></ul></li><li>Cluster<ul><li>Container of Keyspace</li></ul></li><li>Node<ul><li>A computer system running an instance of Cassandra,</li><li>Can be a physical host, a machine instance in the cloud or even a docker container</li></ul></li></ul><h2 id="2-2-Data-Partitioning"><a href="#2-2-Data-Partitioning" class="headerlink" title="2.2 Data Partitioning"></a>2.2 Data Partitioning</h2><ul><li>Cassandra use consistent hashing as DynamoDB does</li></ul><h2 id="2-3-Primary-Key"><a href="#2-3-Primary-Key" class="headerlink" title="2.3 Primary Key"></a>2.3 Primary Key</h2><ul><li>The primary key consists of two parts:  E.G Primary Key as (city_id, employee_id)<ul><li>Partition Key<ul><li>Decides how data is distributed across nodes</li><li>city_id is the primary key, means the data will be partitioned by the city_id field, all rows with the same city_id will reside on the same node</li></ul></li><li>Clustering Key<ul><li>Decides how data is stored within a node</li><li>We could have multiple clustering keys, clustering columns specify the order that the data is arranged on a node.</li><li>employee_id is the clustering key. Within each node, the data is stored in sorted order according to the employee_id column.</li></ul></li></ul></li></ul><h2 id="2-4-Partitioner"><a href="#2-4-Partitioner" class="headerlink" title="2.4 Partitioner"></a>2.4 Partitioner</h2><p><img src="https://i.loli.net/2021/09/17/3NdkOaXUpbgnWq9.png" alt="Partitioner Flow"></p><ul><li>Responsible for determining how data is distributed on the consistent hash ring.</li><li>Cassandra use <strong>Murmur3 hashing function</strong> â€” which will always produce the same hash for a given partition key</li><li>All Cassandra nodes learn about the <strong>token assignments of other nodes</strong> through gossip. This means any node can handle a request for any other nodeâ€™s range. The node receiving the request is called the <strong>coordinator</strong>, and any node can act in this role. If a key does not belong to the coordinatorâ€™s range, it <strong>forwards the request</strong> to the replicas responsible for that range.</li></ul><h2 id="2-5-Coordinator-Node"><a href="#2-5-Coordinator-Node" class="headerlink" title="2.5 Coordinator Node"></a>2.5 Coordinator Node</h2><ul><li>A client may connect to any node in the cluster to initiate a read or write query. This node is known as the coordinator node, the coordinator identifies the nodes responsible for the data that is being written or read    and forwards the queries to them</li></ul><h1 id="3-Low-Level-Architecture"><a href="#3-Low-Level-Architecture" class="headerlink" title="3. Low Level Architecture"></a>3. Low Level Architecture</h1><h2 id="3-1-Replication-Strategy"><a href="#3-1-Replication-Strategy" class="headerlink" title="3.1 Replication Strategy"></a>3.1 Replication Strategy</h2><ul><li><p>Each node in Cassandra serves as a replica for a different range of data.</p></li><li><p>It stores <strong>multiple copies of data</strong> and <strong>spreads them across various replicas</strong>.</p></li><li><p>The replication behavior is controlled by two factors</p><ul><li><p>Replication Factor</p><ul><li>Decides how many replicas the system will have</li><li>This represents the <strong>number of nodes that will receive the copy of the same data</strong></li><li>Each keyspace in cassandra can have a different replication factor</li></ul></li><li><p>Replication Strategy</p><ul><li><p>Decides which nodes will be responsible for the replicas</p></li><li><p>The node that owns the range in which the hash of the partition key falls will be the first replica</p></li><li><p>All the additional replicas are placed on the <strong>consecutive nodes</strong></p></li><li><p>Cassandra places the subsequent replicas on the next nodes in a clockwise manner</p></li><li><p>Two kinds of replication strategies</p><ul><li><p>Simple Replication Strategy</p><p>  <img src="https://i.loli.net/2021/09/17/cnz12lGFWEPw4fS.png" alt="Simple Replication Strategy"></p><ul><li>Used for a <strong>single data center cluster</strong></li><li>Cassandra places the first replica on a node determined by the partitioner and the subsequent replicas on the next node in a clockwise manner</li></ul></li><li><p>Network Topology Strategy</p><p>  <img src="https://i.loli.net/2021/09/17/TSAZbXKCYf9IsoN.png" alt="Network Topology Strategy"></p><ul><li>Used for multiple data centers</li><li>We can specify different replication factors for different data centers. We could then specify how many replicas will be placed in each data center</li><li>Additional replicas, in the same data center, are placed by <strong>walking the ring clockwise until reaching the 1st node in another rack</strong>. This is done to guard against a complete rack failure, as nodes in the same rack(or similar physical grouping) tend to fail together due to power, cooling or network issues.</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id="3-2-Consistency-Levels"><a href="#3-2-Consistency-Levels" class="headerlink" title="3.2 Consistency Levels"></a>3.2 Consistency Levels</h2><ul><li>Definition<ul><li><strong>Minimum number of nodes</strong> that must fulfill a read or write operation before the operation can be considered successful</li><li>It allows use to <strong>specify different consistency levels</strong> for read and write</li><li>It also has <strong>tunable consistency level</strong></li><li>Tradeoff between consistency and response time<ul><li>As a higher consistency level means more nodes need to respond to a read or write query, giving user more assurance that the values present on each replica are the same</li></ul></li></ul></li></ul><h3 id="3-2-1-Write-Consistency-Levels"><a href="#3-2-1-Write-Consistency-Levels" class="headerlink" title="3.2.1 Write Consistency Levels"></a>3.2.1 Write Consistency Levels</h3><ul><li>Consistency Levels specify how many replica nodes must respond for the write to be reported as successful to the client</li><li>Level is specified <strong>per query by the client</strong></li><li>Cassandra is eventually consistent, updates to other replica nodes may continue in the background</li><li>How does Cassandra perform a write operation?<ul><li>Coordinator node contacts all replicas, as determined by the <strong>replication factor</strong> , and consider the write successful when a number of replicas equal to the consistency level acknowledge the write</li></ul></li><li>Write Consistency Levels List:<ul><li>One/ Two/ Three<ul><li>The data must be written to at least the specified number of replica nodes before a write is considered successful</li></ul></li><li>Quorum<ul><li>Data must be written to at least a quorum of replica nodes</li><li>Quorum is defined as <code>floor(RF/2 + 1)</code>  RF represents replication factor</li></ul></li><li>All<ul><li>ensures the data is written to all replica nodes</li><li>provides the highest consistency but lowest availability as writes will fail if any replica is down</li></ul></li><li>Local Quorum<ul><li>Ensure that data is written to a quorum of nodes in the same datacenter as the coordinator</li><li>Does not wait for the response from the other data centers</li></ul></li><li>Each Quorum<ul><li>Ensures that the data is written to a quorum of nodes in each datacenter</li></ul></li><li>Any<ul><li>The data must be written to at least one node</li><li>In the extreme case, when all replica nodes for the given partition key are down, the write can still succeed after a hinted handoff (see 3.2.4 section) has been written.<ul><li>In this case, an any write could succeed with hinted handoff, but it will not be readable until the replica nodes for that partition has recovered and the latest data is written on them</li></ul></li></ul></li></ul></li></ul><h3 id="3-2-2-Read-Consistency-Levels"><a href="#3-2-2-Read-Consistency-Levels" class="headerlink" title="3.2.2 Read Consistency Levels"></a>3.2.2 Read Consistency Levels</h3><ul><li><p>Read Query Consistency Level specify how many replica nodes must respond to a read request before returning the data</p></li><li><p>It has the same consistency levels for read operations as that of write operations exception Each_Quorum cause itâ€™s too expensive</p></li><li><p>To achieve strong consistency, we need to do <code>R + W &gt; RF</code> R represents read replica count, W represents write replication count, RF represents replication factor</p><ul><li>All client reads will see the most recent write in this scenario, and we will have strong consistency</li></ul></li><li><p>How does Cassandra perform a read operation?</p><ul><li><p>Coordinator always sends the read request to the fastest node</p><ul><li>E.G  for quorum=2, the coordinator sends the requests to the fastest node and the <strong>digest of the data</strong> from the second fastest node<ul><li>digest is the checksum of the data, we use this to save network bandwidth</li></ul></li></ul></li><li><p>if the digest doesnâ€™t match, means some replica do not have the latest version of data</p><ul><li><p>Coordinator then <strong>reads the data from all the replicas</strong> to determine the latest data</p></li><li><p>Then coordinator <strong>returns the latest data to the client and initiates a read repair request</strong></p></li><li><p>The read repair request will help push the newer version of data to nodes with the older version</p><p>  <img src="https://i.loli.net/2021/09/17/sPM6HnKthBpT945.png" alt="Read Operation with Snitch"></p></li></ul></li><li><p>latest write timestamp is used as a mark for the correct version of data, read repair operation is performed only in a portion of the total reads to avoid performance degradation</p></li></ul></li></ul><h3 id="3-2-3-Snitch"><a href="#3-2-3-Snitch" class="headerlink" title="3.2.3 Snitch"></a>3.2.3 Snitch</h3><ul><li><p>Functions</p><ul><li>Application that determines the proximity of nodes within the ring, also tells which nodes are faster â€” monitor the read latencies</li><li>It keeps track of the network topology of Cassandra nodes, determines which <strong>data centers and racks</strong> nodes belong to</li><li>Replication strategy use this information provided by the Snitch to spread the replicas across the cluster intelligently. It could do its best by not having more than one replica on the same rack</li></ul></li><li><p>Cassandra nodes use this info to route read/ write requests efficiently</p><p>  <img src="https://i.loli.net/2021/09/17/ZnaOJqIvgdcMmAW.png" alt="Request when set consistency to one"></p></li></ul><h3 id="3-2-4-Hinted-Handoff"><a href="#3-2-4-Hinted-Handoff" class="headerlink" title="3.2.4 Hinted Handoff"></a>3.2.4 Hinted Handoff</h3><p><img src="https://i.loli.net/2021/09/17/QvSmb5wntE2AHJd.png" alt="Hinted Handoff"></p><ul><li>To let Cassandra still serve write requests even when nodes are down</li><li>When a node is down, the coordinator nodes <strong>writes a hint in a text file on local disk</strong><ul><li>Hint contains the data itself along with information about which node the data belongs to</li><li>Recover from gossiper â€” When the coordinator node discovers from the gossiper that a node for which it holds hints has recovered, it forwards the write request for each hint to the target</li><li>Recover from routine call â€” each node every ten minutes checks to see if the failing node, for which it is holding any hints, has recovered</li></ul></li><li>With consistency level â€˜Any,â€™<ul><li>if all the replica nodes are down, the coordinator node will <strong>write the hints for all the nodes and report success to the client.</strong></li><li>However, this data will <strong>not reappear in any subsequent reads</strong> until one of the replica nodes comes back online, and the coordinator node successfully forwards the write requests to it.</li><li>This is assuming that the coordinator node is up when the replica node comes back.</li><li>This also means that we can lose our data if the coordinator node dies and never comes back. For this reason, we should avoid using the â€˜Anyâ€™ consistency level</li></ul></li><li>For node offline for quite long<ul><li>Hints can build up considerably on other nodes</li><li>When it back online, other nodes tend to flood that node with write requests</li><li>It would cause issues on the node, as it is already trying to come back after a failure</li><li>To address this, Cassandra <strong>limits the storage of hints to a configurable time window</strong></li><li>By default, set the time window to 3 hours. Post that, older hints will be removed  â€” now the recovered nodes will have stale data<ul><li>The stale data would be fixed during the read path, it will issue a read repair when it sees the stale data</li></ul></li></ul></li><li>When the cluster cannot meet the consistency level specified by the client, Cassandra fails the write request and does not store a hint .</li></ul><h2 id="3-3-Gossiper"><a href="#3-3-Gossiper" class="headerlink" title="3.3 Gossiper"></a>3.3 Gossiper</h2><h3 id="3-3-1-How-does-Cassandra-use-Gossip-Protocol"><a href="#3-3-1-How-does-Cassandra-use-Gossip-Protocol" class="headerlink" title="3.3.1 How does Cassandra use Gossip Protocol?"></a>3.3.1 How does Cassandra use Gossip Protocol?</h3><ul><li>Whatâ€™s for?<ul><li>Cassandra uses gossip protocol that allows each node to keep track of state information about the other nodes in the cluster.</li><li>Itâ€™s a Peer to Peer communication mechanism in which nodes <strong>periodically exchange state information about themselves and other nodes they know about</strong></li></ul></li><li>How it works?<ul><li>Each node initiates a gossip round every second to exchange state info about themselves with one to three other random nodes</li><li>Each gossip message has a version associated with it, so during a gossip exchange, older info is overwritten with the most current state for a particular node</li></ul></li><li>Generation number<ul><li>Each node stores a generation number which will be incremented every time a node restart</li><li>Node receiving the gossip message can compare the generation number it knows and the gossip messageâ€™s generation number</li><li>If the generation number in the gossip message is higher, it knows the node was restarted</li></ul></li><li>Seed nodes<ul><li>For node starting up for the first time</li><li>Assist in gossip convergence, thus guarantee schema/ state changes propagate regularly</li></ul></li></ul><h3 id="3-3-2-Node-Failure-Detection"><a href="#3-3-2-Node-Failure-Detection" class="headerlink" title="3.3.2 Node Failure Detection"></a>3.3.2 Node Failure Detection</h3><ul><li>Disadvantages for heartbeat<ul><li>outputs a boolean value telling us if the system is alive or not;</li><li>there is no middle ground.</li><li>Heartbeating uses a fixed timeout, and if there is no heartbeat from a server, the system, after the timeout, assumes that the server has crashed.</li><li>If we keep the timeout short, the system will be able to detect failures quickly but with many false positives due to slow machines or faulty networks.</li><li>On the other hand, if we keep the timeout long, the false positives will be reduced, but the system will not perform efficiently for being slow in detecting failures.</li></ul></li><li>Use adaptive failure detection mechanism  â€”â€” Phi Accrual Failure Detector<ul><li>Use historical heartbeat information to make the threshold adaptive</li><li>It outputs the suspicion level about a server</li><li>As a nodeâ€™s suspicion level increases, the system can gradually decide to stop sending new requests to it</li><li>It makes the distributed system efficient as it takes into account fluctuations in the network env and other intermittent server issues before declaring a system completely dead</li></ul></li></ul><h2 id="3-4-Anatomy-of-Cassandraâ€™s-Write-Operation"><a href="#3-4-Anatomy-of-Cassandraâ€™s-Write-Operation" class="headerlink" title="3.4 Anatomy of Cassandraâ€™s Write Operation"></a>3.4 Anatomy of Cassandraâ€™s Write Operation</h2><p>Cassandra stores data both <strong>in memory and on disk</strong> to provide both high performance and durability. Every write includes a timestamp, write path involves a lot of components: </p><p><img src="https://i.loli.net/2021/09/17/LrMK7ckIS2zEsU1.png" alt="Write Path"></p><ul><li>Each write is appended to a commit log, which is stored on disk</li><li>It is then written to Memtable in memory</li><li>Periodically, MemTables are flushed to SSTables on the disk</li><li>Periodically, compaction runs to merge SSTables</li></ul><h3 id="3-4-1-Commit-Log"><a href="#3-4-1-Commit-Log" class="headerlink" title="3.4.1 Commit Log"></a>3.4.1 Commit Log</h3><ul><li>When a node receives a write request, it immediately writes data to a commit log</li><li>Commit log is a <strong>write ahead log</strong> stored on disk</li><li>Used as a crash recovery mechanism to support Cassandraâ€™s durability goals</li><li>A write will not be considered successful on the node until itâ€™s <strong>written to the commit log</strong><ul><li>This ensures if a write operation does not make it to the in-memory store, it will still be possible to recover the data</li></ul></li><li>If we shut down the node or it crashes unexpectedly, the commit log can ensure that data is not lost; thatâ€™s because if the node restart, the commit log gets replayed</li></ul><h3 id="3-4-2-MemTable"><a href="#3-4-2-MemTable" class="headerlink" title="3.4.2 MemTable"></a>3.4.2 MemTable</h3><ul><li>After written to the commit log, the data is written to a memory resident data structure called memTable<ul><li>Each node has a MemTable in memory for each Cassandra table</li><li>Each MemTable contains data for a specific Cassandra table, and it resembles that table in memory</li><li>Each MemTable accrues writes and <strong>provides reads for data not yet flushed to disk</strong></li><li>Commit log stores all the writes in sequential order, with each new write appended to the end; whereas MemTable stores data in the sorted order of partition key and clustering columns</li><li>After writing data to the commit log and MemTable, the node <strong>sends an acknowledgement to the coordinator</strong> that the data has been successfully written</li></ul></li></ul><h3 id="3-4-3-SStable"><a href="#3-4-3-SStable" class="headerlink" title="3.4.3 SStable"></a>3.4.3 SStable</h3><ul><li>When the number of objects stored in the MemTable reaches a threshold, the contents of the MemTable are <strong>flushed to disk</strong> in a file called <strong>SSTable</strong><ul><li>At this point, a new MemTable is created to store subsequent data</li><li>The flush is non blocking operation</li><li>Multiple Memtables may exist for a single table<ul><li>One current, and the rest waiting to be flushed</li></ul></li><li>When the MemTable is flushed to SStables, <strong>corresponding entries in the commit log</strong> are removed</li></ul></li><li>SStable â€”Sorted String Table<ul><li>Once a MemTable is flushed to disk as an SStable, it is immutable and cannot be changed later</li><li>Each delete or update is considered as a new write operation</li></ul></li><li>The current data state of a Cassandra table consists of its MemTables in memory and SSTables on the disk.<ul><li>Therefore, on reads, Cassandra will read both SSTables and MemTables to find data values, as the MemTable may contain values that have not yet been flushed to the disk.</li><li>The MemTable works like a write-back cache that Cassandra looks up by key</li></ul></li></ul><p><img src="https://i.loli.net/2021/09/17/Qd7x4M6HRrtuAoZ.png" alt="Whole Write Path"></p><h2 id="3-5-Anatomy-of-Cassandraâ€™s-Read-Operation"><a href="#3-5-Anatomy-of-Cassandraâ€™s-Read-Operation" class="headerlink" title="3.5 Anatomy of Cassandraâ€™s Read Operation"></a>3.5 Anatomy of Cassandraâ€™s Read Operation</h2><p><img src="https://i.loli.net/2021/09/17/wIZKE97YqVNAsrP.png" alt="Whole Read Path"></p><h3 id="3-5-1-Caching"><a href="#3-5-1-Caching" class="headerlink" title="3.5.1 Caching"></a>3.5.1 Caching</h3><ul><li>Row Cache<ul><li>Cache frequently read/ hot rows</li><li>Stores a complete data row, which can be returned directly to the client if requested by a read operation</li><li>Could significantly speed up read access for frequently accessed rows, at the cost of more memory usage</li></ul></li><li>Key Cache<ul><li>Stores a map of recently read partition keys to their <strong>SSTable offsets</strong></li><li>This facilitates faster read access into SSTables and improves the read performance</li><li>Use less memory comparing with row cache and provides a considerable improvement for read operations</li></ul></li><li>Chunk Cache<ul><li>Chunk Cache is used to store umcompressed chunks of data read from SSTable files that are accessed frequently</li></ul></li></ul><h3 id="3-5-2-Read-From-MemTable"><a href="#3-5-2-Read-From-MemTable" class="headerlink" title="3.5.2 Read From MemTable"></a>3.5.2 Read From MemTable</h3><ul><li>When a read request come in, node performs a binary search on the partition key to find the required partition and then return the row</li></ul><h3 id="3-5-3-Read-From-SSTable"><a href="#3-5-3-Read-From-SSTable" class="headerlink" title="3.5.3 Read From SSTable"></a>3.5.3 Read From SSTable</h3><ul><li><p>Bloom Filters</p><ul><li>Each SSTable has a Bloom Filter associated with it, which tells if a particular key is present in it or not</li><li>Used to boost performance of read operations</li><li>Itâ€™s a very fast, non deterministic algorithms for testing whether an element is a member of a set</li><li>Itâ€™s possible to get a false positive but never a false negative</li><li>Theory<ul><li>It works by <strong>mapping the values in a data set into a bit array</strong> and <strong>condensing a larger data set into a digest string</strong> with a hash function</li><li>Filters are stored in memory and are used to improve performance by reducing the need for disk access on key lookups</li></ul></li></ul></li><li><p>How are SSTables stored on the disk?</p><ul><li><p>Consists of two files</p><ul><li><p>Data File</p><ul><li>Actual data is stored here</li><li>It has partitions and rows associated with those partitions</li><li>Partitions are in sorted order</li></ul></li><li><p>Partition Index File</p><ul><li><p>Stored on disk, partition index file stores the sorted partition keys mapped to their SSTable offsets</p></li><li><p>Enable locating a partition exactly in an SSTable rather than scanning data</p><p><img src="https://i.loli.net/2021/09/17/9gUpTXZyLSksDdK.png" alt="Read via Partition Index File"></p></li></ul></li></ul></li></ul></li><li><p>Partition Index Summary File</p><ul><li><p>Itâ€™s stored in memory, stores the summary of the partition index file for performance improvement</p><ul><li><p>Two level index, e.g, search for key=19</p></li><li><p>in partition index summary file, it lays to key range 10 - 21</p></li><li><p>then we could go to byte offset 32,</p></li><li><p>in partition index file , we start from 32, to find partition key 19, and then we could go to 5450</p><p><img src="https://i.loli.net/2021/09/17/efsVEmvGAkIldF6.png" alt="Read via Partition Index Summary File"></p></li></ul></li></ul></li><li><p>Read from KeyCache</p><ul><li><p>As the Key Cache stores a map of recently read partition keys to their SSTable offset, itâ€™s the fastest way to find the required row in the SSTable</p><p>  <img src="https://i.loli.net/2021/09/17/5KPTohGmWpecr1a.png" alt="Read From KeyCache"></p></li></ul></li><li><p>Overall workflow</p><p>  <img src="https://i.loli.net/2021/09/17/2zKlRtS48NQYkud.png" alt="Overall Workflow"></p></li></ul><h2 id="3-6-Compaction"><a href="#3-6-Compaction" class="headerlink" title="3.6 Compaction"></a>3.6 Compaction</h2><h3 id="3-6-1-Why-we-need-compaction-And-How-it-Works"><a href="#3-6-1-Why-we-need-compaction-And-How-it-Works" class="headerlink" title="3.6.1 Why we need compaction? And How it Works?"></a>3.6.1 Why we need compaction? And How it Works?</h3><p><img src="https://i.loli.net/2021/09/17/2DgirVjkeq6AI4T.png" alt="Compaction"></p><ul><li>SSTables are immutable, which helps Cassandra achieve high write speeds</li><li>And flushing from MemTable to SSTable is a continuous process, which means we could have a large number of SSTables lying on the disk</li><li>Itâ€™s tedious to scan all these SSTables while reading</li><li>We need compaction thus we could merge multiple related SSTables into a single one to improve reading speed</li><li>During compaction, the data in SSTables is merged, keys are merged, columns are combined, obsolete values are discarded, and a new index is created</li></ul><h3 id="3-6-2-Compaction-Strategies"><a href="#3-6-2-Compaction-Strategies" class="headerlink" title="3.6.2 Compaction Strategies"></a>3.6.2 Compaction Strategies</h3><ul><li>SizeTiered Compaction Strategy<ul><li>Suitable for insert-heavy and general workloads</li><li>Triggered when multiple SSTables of a similar size are present</li></ul></li><li>Leveled Compaction Strategy<ul><li>Optimize read performance</li><li>Groups SSTables into levels, each of which has a fixed size limit which is ten times larger than the previous level</li></ul></li><li>Time Window Compaction Strategy<ul><li>Work on time series data</li><li>Compact SSTables within a configured time window</li><li>Ideal for time series data which is immutable after a fixed time interval</li></ul></li></ul><h3 id="3-6-3-Sequential-Writes"><a href="#3-6-3-Sequential-Writes" class="headerlink" title="3.6.3 Sequential Writes"></a>3.6.3 Sequential Writes</h3><ul><li>Main reason that writes perform so well in Cassandra</li><li>No reads or seeks of any kind are required for writing a value to Cassandra because all writes are append operations</li><li>Compaction is intended to amortize the reorganization of data, but it uses sequential I/O to do so, which makes it efficient</li></ul><h2 id="3-7-Tombstones"><a href="#3-7-Tombstones" class="headerlink" title="3.7 Tombstones"></a>3.7 Tombstones</h2><h3 id="3-7-1-What-are-Tombstones"><a href="#3-7-1-What-are-Tombstones" class="headerlink" title="3.7.1 What are Tombstones?"></a>3.7.1 What are Tombstones?</h3><ul><li>Scenario<ul><li>We delete some data for a node that is down or unreachable, it would miss a delete</li><li>When the node com back online later and a repair occurs, the node could resurrect the data due to re-sharing it with other nodes</li><li>To prevent deleted data from being reintroduced, Cassandra used a concept of a Tombstone</li></ul></li><li>Tombstone<ul><li>Similar to the idea of soft delete from the relational database</li><li>When we delete, Cassandra does not delete it right away, instead, it associated a tombstone with it, with Time to Expiry</li><li>Itâ€™s a marker to indicate data that has been deleted</li><li>When we execute a delete operation, data is not immediately deleted</li><li>Instead, itâ€™s treated as an update operation that places a tombstone on the value</li><li>Default Time to Expiry is set to 10 days<ul><li>If the node is down longer than this value, it should be treated as failed and replaced</li></ul></li><li>Tombstones are removed as part of compaction</li></ul></li></ul><h3 id="3-7-2-Common-problems-associated-with-Tombstones"><a href="#3-7-2-Common-problems-associated-with-Tombstones" class="headerlink" title="3.7.2 Common problems associated with Tombstones"></a>3.7.2 Common problems associated with Tombstones</h3><ul><li>Takes storage space</li><li>When a table accumulates many tombstones, read queries on that table could become slow and can cause serious performance problems like timeouts.</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cassandra </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Logical Fallacies</title>
      <link href="/Logical-Fallacies/"/>
      <url>/Logical-Fallacies/</url>
      
        <content type="html"><![CDATA[<h1 id="Logical-Fallacies"><a href="#Logical-Fallacies" class="headerlink" title="Logical Fallacies"></a>Logical Fallacies</h1><h2 id="Overconfidence"><a href="#Overconfidence" class="headerlink" title="Overconfidence"></a>Overconfidence</h2><ul><li>Overconfidence â€” wishful thinking bias<ul><li>most people think they are above avg</li><li>overestimate possibilities that they want to happen</li><li><strong>this could explain the trade in financial market</strong></li><li>overconfidence in friends and leaders</li></ul></li></ul><h2 id="Cognitive-Dissonance"><a href="#Cognitive-Dissonance" class="headerlink" title="Cognitive Dissonance"></a>Cognitive Dissonance</h2><ul><li>Cognitive Dissonance  è®¤çŸ¥å¤±è°ƒ<ul><li>this concept used to describe the mental discomfort that results from holding two conflicting beliefs, values or attitudes</li><li>People tend to seek consistency in their attitudes and perceptions, so this conflict causes feelings of unease or discomfort</li><li>This inconsistency between <strong>what people believe and how they behave</strong> motivates people to <strong>engage in actions</strong> that will help minimize feelings of discomfort</li><li>when we made decision, most people will still look for info about it, to self prove hisself rightâ€¦ in a lot different aspectsâ€¦ to make themselves happy, and to prove they are make right decision</li><li>disposition effect â€” gonna avoid that</li><li>whatâ€™s the causes for that?<ul><li>Forced Compliance<ul><li>Engaging in behaviors that are opposed to your own beliefs due to external expectations, often for work, school, or a social situation</li></ul></li><li>New Information</li><li>Decisions<ul><li>People make decisions both large and small, on a daily basis</li><li>When faced with two similar choices, people often are left with feelings of dissonance because both options are equally appealing</li><li>Once they make decisions, people need to find a way to <strong>reduce feelings of discomfort</strong></li><li>Accomplish by justifying why their choice was the best option so that they can believe they made the right decision</li></ul></li></ul></li></ul></li></ul><h2 id="Mental-Compartments"><a href="#Mental-Compartments" class="headerlink" title="Mental Compartments"></a>Mental Compartments</h2><ul><li>Mental compartments<ul><li>people donâ€™t look at whole portfolio, in fact, people has two or more portfolio<ul><li>usually they have a safe part and a risky part</li></ul></li></ul></li></ul><h2 id="Attention-Anomalies"><a href="#Attention-Anomalies" class="headerlink" title="Attention Anomalies"></a>Attention Anomalies</h2><ul><li>Attention Anomalies<ul><li>We cannot pay attention to anything</li><li>Attention is fundamental aspect of human intelligence and its limits</li><li>Social Basis for attention<ul><li>We incline to pay more attention to what other s pay attention to</li></ul></li></ul></li></ul><h2 id="Anchoring"><a href="#Anchoring" class="headerlink" title="Anchoring"></a>Anchoring</h2><ul><li>Anchoring<ul><li>A tendency in ambiguous situations to allow oneâ€™s decisions to be affected by some anchor</li><li>Our subconscious will do anchoring for us, lol</li><li>subjects unaware of their own anchoring behavior</li><li>stock prices anchored to past values, or to other stock in same market</li></ul></li></ul><h2 id="Representativeness-Heuristic"><a href="#Representativeness-Heuristic" class="headerlink" title="Representativeness Heuristic"></a>Representativeness Heuristic</h2><ul><li>Representativeness Heuristic<ul><li>People judge by similarity to familiar types, without regard to <strong>base rate probabilities</strong><ul><li>For example, we describe a person as artist, and skeptical, then whatâ€™s the highest possible occupation of him/ her?<ul><li>two choice: banker, and sculptress</li><li>should be banker, cause there are so many more bank tellers than sculptresses</li></ul></li></ul></li><li>Tendency to see patterns in what is really random walk</li><li>Stock price manipulators try to create patterns to fool investors</li></ul></li></ul><h2 id="Disjunction-Effect"><a href="#Disjunction-Effect" class="headerlink" title="Disjunction Effect"></a>Disjunction Effect</h2><ul><li>inability to make decisions in advance in anticipation of future information</li></ul><h2 id="Magical-Thinking-amp-Quasi-Magical-Thinking"><a href="#Magical-Thinking-amp-Quasi-Magical-Thinking" class="headerlink" title="Magical Thinking  &amp; Quasi Magical Thinking"></a>Magical Thinking  &amp; Quasi Magical Thinking</h2><ul><li>Some coincidence lead you to build superstitious, but there are actually no karma (cause and effect)</li><li>Belief that unrelated events are causally connected despite the absence of any plausible causal link between them, particularly as a result of supernatural effects.</li><li>E.G<ul><li>For voting, though our vote actually has basically 0 possibility to influence president election, but a lot people do it</li><li>For lottery, we somehow put more money if we select the number</li></ul></li></ul><h2 id="Personality-Disorders"><a href="#Personality-Disorders" class="headerlink" title="Personality Disorders"></a>Personality Disorders</h2><ul><li>culture and social contagion â€” collective memory<ul><li>same effect, same memory, then similar decisions</li></ul></li><li>Antisocial Personality Disorder</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŠ—é€†åŠ›</title>
      <link href="/%E6%8A%97%E9%80%86%E5%8A%9B/"/>
      <url>/%E6%8A%97%E9%80%86%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å¾ˆåº†å¹¸å¬äº†è¿™åœºè®²åº§ï¼Œå›æƒ³èµ·åŸå…ˆåšçš„ä¸€äº›å†³å®šï¼Œä¼šå›¿äºå›ºå®šæ€§æ€ç»´ï¼Œå› ä¸ºå®³æ€•å¤±è´¥ï¼Œå®³æ€•è¢«è¯å®ä¸å¤Ÿèªæ˜ï¼Œå¤±å»äº†å¾ˆå¤šå¾ˆå¤šæˆé•¿çš„æœºä¼šã€‚æ„Ÿè§‰æ— è®ºæ˜¯å·¥ä½œè¿˜æ˜¯ç”Ÿæ´»ï¼Œåœ¨åº¦è¿‡äº†åˆšåˆšå¼€å§‹çš„ç†Ÿæ‚‰äº†è§£é˜¶æ®µä»¥åï¼ŒåæœŸé™¤äº†ä¸“ä¸šæŠ€èƒ½ä¸Šçš„æå‡ä¹‹å¤–ï¼Œæ›´åŠ é‡è¦çš„æ˜¯mindsetçš„æå‡ â€” å…³äºä½ æ˜¯æ€ä¹ˆçœ‹å¾…è‡ªå·±çš„ï¼Œæ€ä¹ˆçœ‹å¾…ä½ ç»å†çš„äº‹æƒ…ã€‚ä¸çŸ¥é“æœ€ç»ˆç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯è¿™ç¯‡é‡Œé¢è¯´çš„ä¸œè¥¿è‡³å°‘å‘Šè¯‰äº†æˆ‘æƒ³è¦è¾¾åˆ°ç†æƒ³çš„çŠ¶æ€ï¼Œä½ éœ€è¦æ¯å¤©åšäº›ä»€ä¹ˆ :)  å€¼å¾—è¿‡ä¸€æ®µæ—¶é—´å›æ¥å†çœ‹çœ‹å„ç§action items å‘€</p></blockquote><h1 id="1-å¿ƒç†éŸ§æ€§"><a href="#1-å¿ƒç†éŸ§æ€§" class="headerlink" title="1. å¿ƒç†éŸ§æ€§"></a>1. å¿ƒç†éŸ§æ€§</h1><ul><li>é«˜å¿ƒç†éŸ§æ€§æ˜¯æˆåŠŸè€…çš„å…±æ€§<ul><li>å› ä¸ºå¯¹äºä»»ä½•ä¸€ä¸ªæˆåŠŸè€…æ¥è¯´ï¼Œç£¨éš¾æ˜¯å¿…ä¸å¯å°‘çš„ä¸€éƒ¨åˆ†</li><li>æˆåŠŸè€… åšéŸ§ä¸æ‹”çš„ç²¾ç¥</li><li>å¿ƒç†å­¦ç ”ç©¶<ul><li>é¢„æµ‹æˆåŠŸçš„æ¦‚ç‡ å’Œ åšéŸ§ä¸æ‹”çš„ç‰¹è´¨æœ‰å¾ˆæ˜æ˜¾çš„æ­£ç›¸å…³ï¼Œå’Œæ™ºå•†çš„å…³ç³»åå€’å¹¶ä¸æ˜¯å¾ˆå¼º</li><li>ç”Ÿå­˜ä¸‹æ¥çš„ä¸æ˜¯æœ€å¼ºå¤§çš„ç”Ÿç‰©ï¼Œä¹Ÿä¸æ˜¯æœ€èªæ˜çš„ç”Ÿç‰©ï¼Œè€Œæ˜¯æœ€èƒ½å¤Ÿé€‚åº”å˜åŒ–çš„ç”Ÿç‰©</li></ul></li></ul></li></ul><h2 id="1-1-å¿ƒç†å­¦å®šä¹‰"><a href="#1-1-å¿ƒç†å­¦å®šä¹‰" class="headerlink" title="1.1 å¿ƒç†å­¦å®šä¹‰"></a>1.1 å¿ƒç†å­¦å®šä¹‰</h2><ul><li>å¤åŸåŠ› resilence<ul><li>äººä»é€†å¢ƒï¼Œå†²çªï¼Œç—›æ¥šï¼Œå¤±è´¥ï¼Œå‹åŠ›å½“ä¸­è¿…é€Ÿæ¢å¤çš„å¿ƒç†èƒ½åŠ›</li></ul></li><li>åšæ¯…åŠ› grip</li><li>åˆ›ä¼¤åçš„æˆé•¿ PTG â€” Post Traumatic Growth<ul><li>ä¸æ¶ˆæ²‰ï¼Œå¥‹è¿›</li></ul></li></ul><h2 id="1-2-é«˜å¿ƒç†éŸ§æ€§äººçš„ç‰¹è´¨"><a href="#1-2-é«˜å¿ƒç†éŸ§æ€§äººçš„ç‰¹è´¨" class="headerlink" title="1.2 é«˜å¿ƒç†éŸ§æ€§äººçš„ç‰¹è´¨"></a>1.2 é«˜å¿ƒç†éŸ§æ€§äººçš„ç‰¹è´¨</h2><ul><li>èƒ½åŠ›<ul><li>é€‚åº”åŠ›</li><li>æˆé•¿åŠ›</li><li>æŠ—æŒ«åŠ›</li><li>ç§¯æåŠ› â€” æƒ…ç»ªçš„è°ƒèŠ‚çš„æ–¹æ³•</li><li>å…³ç³»åŠ› â€” å¦‚ä½•å»ºç«‹å…³ç³»</li><li>æ§åˆ¶åŠ› â€” æ·¡å®šä»å®¹ï¼Œè‡ªæˆ‘æ§åˆ¶</li></ul></li><li>ç‰¹è´¨<ul><li>æœ‰ç§¯æçš„è®¤çŸ¥æ–¹å¼  â€” the power of positive thinking<ul><li>å†³å®šæˆ‘ä»¬çš„å¹¸ç¦æŒ‡æ•°çš„ä¸æ˜¯äº‹æƒ…æœ¬èº«ï¼Œè€Œæ˜¯æˆ‘ä»¬å¦‚ä½•çœ‹å¾…è¿™ä¸ªäº‹æƒ…</li></ul></li><li>ä¹è§‚çš„æƒ…ç»ªè°ƒèŠ‚</li><li>å¥åº·çš„èº«å¿ƒçŠ¶æ€</li><li>å¼ºå¤§çš„è‡ªæˆ‘æ•ˆèƒ½æ„Ÿ  â€” æ„Ÿè§‰è‡ªå·±èƒ½æˆï¼Œæ„Ÿè§‰è‡ªå·±æœ‰ç”¨  lol<ul><li>ç»“å©šèƒ½è®©ç”·æ€§é•¿å¯¿7å¹´ lol</li></ul></li><li>è§£å†³é—®é¢˜çš„è¡ŒåŠ¨ç²¾ç¥</li><li>è‰¯å¥½çš„äººé™…å…³ç³»</li></ul></li></ul><h1 id="2-å¦‚ä½•æå‡å¿ƒç†éŸ§æ€§"><a href="#2-å¦‚ä½•æå‡å¿ƒç†éŸ§æ€§" class="headerlink" title="2. å¦‚ä½•æå‡å¿ƒç†éŸ§æ€§"></a>2. å¦‚ä½•æå‡å¿ƒç†éŸ§æ€§</h1><h2 id="2-1-è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„æå‡"><a href="#2-1-è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„æå‡" class="headerlink" title="2.1 è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„æå‡"></a>2.1 è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„æå‡</h2><ul><li>è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„æå‡ Self Efficacy<ul><li>å®šä¹‰ â€” æ˜¯ä¸ªäººå¯¹è‡ªå·±å®ŒæˆæŸæ–¹é¢å·¥ä½œèƒ½åŠ›çš„ä¸»è§‚è¯„ä¼°ï¼Œé€šè¿‡ä¸¤æ¡è·¯å¾„ä½“ç°å‡ºæ¥</li><li>é«˜è‡ªæˆ‘æ•ˆèƒ½æ„Ÿçš„äººï¼Œç”šè‡³ä¼šæŠŠå‹åŠ› æŒ«æŠ˜ æ‰“å‡»å½“åšä¸€ç§è¯æ˜è‡ªå·±çš„èƒ½åŠ›çš„æœºé‡</li><li>ä½“ç°è·¯å¾„<ul><li>ç»“æœé¢„æœŸ<ul><li>ç›¸ä¿¡è‡ªå·±ï¼Œè®¤ä¸ºæˆ‘å¯ä»¥åšåˆ°ï¼Œæ˜¯ä¸€ç§è‡ªæˆ‘å®ç°çš„é¢„è¨€</li></ul></li><li>æ•ˆèƒ½é¢„æœŸ<ul><li>æˆ‘è®¤ä¸ºæˆ‘èƒ½åšåˆ°ä¸æ˜¯å› ä¸ºè¿æ°”å¥½æˆ–è€…ç¯å¢ƒå¥½ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘çš„èƒ½åŠ›</li><li>å› æ­¤æˆ‘è¦æ–½å±•æˆ‘çš„èƒ½åŠ›ï¼Œä¸ºç»“æœåšè¶³å‡†å¤‡</li></ul></li></ul></li></ul></li><li>å¦‚ä½•å»åš<ul><li>åšå‡ºæˆåŠŸçš„æ¨¡æ ·<ul><li>è£…ç§¯æï¼Œæ˜¯ä¼šå˜æˆçœŸç§¯æçš„</li><li>æ­¥ä¼æ›´å¿«</li><li>è¯´è¯æ›´å¤š</li><li>åšäº‹ä¸»åŠ¨</li><li>ç©¿è¡£æ›´æ­£å¼äº›</li><li>é”»ç‚¼æ›´é¢‘ç¹äº›</li></ul></li><li>è¢«æˆåŠŸè€…æ¥çº³<ul><li>ä¸ç§¯æçš„äººåŒè¡Œ</li><li>æ›¿ä»£æ€§å¼ºåŒ–<ul><li>è§‚å¯Ÿè€…çœ‹åˆ°æ¦œæ ·æˆ–è€…ä»–äººæ”¶åˆ°å¼ºåŒ–ï¼ŒæˆåŠŸäº†; ä»è€Œä½¿å¾—è‡ªå·±ä¹Ÿå€¾å‘äºåšå‡ºæ¦œæ ·çš„è¡Œä¸º</li></ul></li></ul></li><li>ç¤¾ä¼šæ”¯æŒ<ul><li>è¿›åŒ–é€‰æ‹©çš„æ˜¯åˆä½œè€…</li><li>ç¤¾ä¼šç½‘ç»œé¢ç§¯è¶Šå¤§ï¼Œæ›´å®¹æ˜“äº§ç”Ÿä¼˜åŠ¿æ•ˆåº”</li><li><strong>å¼±è”ç³»çš„å¼ºåŠ¿æ•ˆåº”</strong><ul><li>å¼±è”ç³»æœ‰ç€å¾ˆå¿«çš„ä½æˆæœ¬å’Œé«˜æ•ˆèƒ½çš„ä¼ æ’­æ•ˆç‡</li><li>åœ¨å…­åº¦åˆ†éš”è¯•éªŒå½“ä¸­ï¼Œæ­£æ˜¯å±‚å±‚å åŠ çš„å¼±è”ç³»å°†ä¸–ç•Œä¸ŠåŸæœ¬æ¯«ä¸ç›¸å…³çš„äººè”ç³»åˆ°äº†ä¸€èµ·</li></ul></li></ul></li><li>æ¨¡æ‹Ÿå®æˆ˜<ul><li>é¢„è§</li><li>å¤§è„‘ä¼‘é—²çš„æ—¶å€™å¤„äºé»˜è®¤æ¨¡å¼çŠ¶æ€  hh<ul><li>ä¼šç•…æƒ³æœªæ¥ï¼Œæ˜¯ä¸€ç§ç«äº‰ä¼˜åŠ¿çš„~</li><li>å¯¹äºäº‹æƒ…è¿›è¡Œé‡è§ï¼Œæ˜¯å¯¹æˆ‘ä»¬å¸®åŠ©å¾ˆå¤§çš„</li></ul></li><li>Visualization  é¢„è§æƒ³è±¡<ul><li>å°†è‡ªå·±å°†è¦åšçš„äº‹æƒ…å»æå‰æƒ³è±¡ä¸€ä¸‹</li><li>è¿‡ä¸€éè‡ªå·±éœ€è¦æ€ä¹ˆåš</li><li>è®­ç»ƒè¶Šå¤šï¼Œæ„å‘è¶Šæ¸…æ™°</li><li>è®¾æƒ³é‡åˆ°æ‰“å‡»ï¼Œå›°éš¾çš„æ—¶å€™ä½ è¦æ€ä¹ˆåš</li></ul></li></ul></li><li>ä¸æ–­ç§¯ç´¯æˆåŠŸ<ul><li>äººæœ€å¯æ€•çš„æ˜¯å‘ç°è‡ªå·±ä¸€æˆä¸å˜</li><li>è¦å»åš</li></ul></li></ul></li></ul><h2 id="2-2-åŸ¹å…»æˆé•¿æ€§æ€ç»´"><a href="#2-2-åŸ¹å…»æˆé•¿æ€§æ€ç»´" class="headerlink" title="2.2 åŸ¹å…»æˆé•¿æ€§æ€ç»´"></a>2.2 åŸ¹å…»æˆé•¿æ€§æ€ç»´</h2><ul><li><p>äººçš„æ€ç»´æ¨¡å¼</p><ul><li>æˆé•¿æ€§æ€ç»´  Growth Mindset<ul><li>å¤©èµ‹åªæ˜¯èµ·ç‚¹</li><li>æ€åº¦å’ŒåŠªåŠ›å¯ä»¥å†³å®šä¸€åˆ‡</li><li>å¯ä»¥å­¦ä¼šä»»ä½•æˆ‘æƒ³å­¦ä¼šçš„ä¸œè¥¿</li><li>å–œæ¬¢è‡ªæˆ‘æŒ‘æˆ˜</li><li>å½“æˆ‘å¤±è´¥çš„æ—¶å€™ï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿</li><li>æˆ‘å¸Œæœ›ä½ è¡¨æ‰¬æˆ‘å¾ˆåŠªåŠ›</li><li>å¦‚æœåˆ«äººæˆåŠŸäº†ï¼Œæˆ‘ä¼šæ”¶åˆ°åˆ«äººçš„å¯å‘</li></ul></li><li>å›ºå®šæ€§æ€ç»´ â€” å“è¶Šçš„åŒ…è¢±<ul><li>æˆ‘çš„èªæ˜æ‰æ™ºå†³å®šäº†ä¸€åˆ‡</li><li>æˆ‘æ“…é•¿æŸäº›äº‹ï¼Œä¸æ“…é•¿å¦å¤–ä¸€äº›äº‹</li><li>æˆ‘ä¸æƒ³å°è¯•æˆ‘å¯èƒ½ä¸æ“…é•¿çš„ä¸œè¥¿</li><li>å¦‚æœæˆ‘å¤±è´¥äº†ï¼Œæˆ‘å°±æ— åœ°è‡ªå®¹äº†</li><li>æˆ‘å¸Œæœ›ä½ è¡¨æ‰¬æˆ‘å¾ˆèªæ˜</li><li>å¦‚æœåˆ«äººæˆåŠŸäº†ï¼Œä»–ä¼šå¨èƒåˆ°æˆ‘</li></ul></li></ul></li><li><p>å›ºå®šæ€§æ€ç»´å¯¹äºäººçš„å½±å“å¾ˆå¤§</p><ul><li>ä½ ä¼šå› ä¸ºè®¤ä¸ºè‡ªå·±èªæ˜ï¼Œä¸æ•¢åšæ›´å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºä¸€æ—¦å¤±è´¥ï¼Œä½ ä¼šå®³æ€•åˆ«äººè®¤ä¸ºä½ ä¸èªæ˜äº† ä¼šè¶Šæ¥è¶Šéš¾è¾¾åˆ°åˆ«äººçš„é¢„æœŸçš„</li><li>è¢«è¡¨æ‰¬åŠªåŠ›çš„å¾€å¾€ä¼šé€‰æ‹©æ›´åŠ å›°éš¾çš„ä»»åŠ¡ï¼Œä¹Ÿä¼šæ›´æ„¿æ„é€šè¿‡å­¦ä¹ ï¼Œå»å°è¯•è§£å†³æ–¹æ¡ˆ</li><li>å“è¶Šçš„åŒ…è¢±<ul><li>è£…é…·çš„å­©å­çš„åŒ…è¢±</li><li>ä¸æ„¿æ„å»å†’é™©ï¼Œä¸æ„¿æ„å»å¥‹æ–—</li><li>åŠªåŠ›æ„šè ¢ï¼Œè£…èªæ˜</li><li>ç²¾è‹±çˆ¶æ¯çš„è¿‡é«˜çš„æœŸæœ›é€ æˆçš„å¿ƒç†å‹åŠ›å’Œå¿ƒç†é˜´å½±</li><li>ä¼˜ç§€å¥³å­©çš„è¯…å’’ï¼Œè¿™ç§åŒ…è¢±å¾€å¾€å¯¹å¥³å­©çš„æ‰“å‡»æ›´å¤§ï¼Œå¥¹ä»¬å¾€å¾€æ›´åœ¨æ„å¤–åœ¨çš„è¯„ä»·ï¼Œä¸æ•¢å†’é™©å’ŒåŠªåŠ›</li><li>we are supposed to be dumb all the way, hhh</li></ul></li></ul></li><li><p>å¦‚ä½•åŸ¹å…»æˆé•¿æ€§æ€ç»´</p><ul><li>æ”¹å˜è€ƒæ ¸çš„æ ‡å‡†<ul><li>å…³æ³¨è¿›æ­¥ï¼Œè€Œä¸æ˜¯ç»“æœ</li></ul></li><li>æ”¹å˜æ²Ÿé€šçš„æ–¹å¼<ul><li>åœ¨è¯„ä»·è¡¨ç°çš„æ—¶å€™ï¼Œç”¨æš‚æ—¶ä¸è¡Œä»£æ›¿å°±æ˜¯ä¸è¡Œ</li><li>çŸ­æš‚ å±€éƒ¨ å¯ä»¥æ”¹çš„</li><li>ä¸è¦æŠŠäº‹æƒ…è¯´æˆç¨³å®šçš„é•¿æœŸçš„ä¸å¯æ”¹å˜çš„</li><li>not yet instead of failed</li></ul></li><li>æ”¹å˜è®¤çŸ¥çš„ä¹ æƒ¯ â€” Albert Ellis çš„è®¤çŸ¥æ²»ç–—ABC</li><li>å‘æŒ¥è¾©è¯æ€ç»´çš„ä¼˜åŠ¿ â€” ä»è´Ÿé¢ä½“éªŒä¸­å¸å–æˆåŠŸçš„ç»éªŒ<ul><li>å½“ä¸€ä¸ªäººå‡ºäºè‡ªæˆ‘ä¿æŠ¤è€ŒæŠ—æ‹’å†…å¿ƒçš„åœ°ç‹±çš„æ—¶å€™ï¼Œä»–ä¸€å¹¶åˆ‡æ–­äº†é€šå¾€å†…åœ¨å¤©å ‚çš„é“è·¯ã€‚<ul><li>ä¸æ‰¿è®¤è‡ªå·±å†…å¿ƒçš„é˜´æš—é¾Œé¾Šï¼Œé‚£ä¹ˆå°±æ— ä»æ”¹è¿›äº†</li></ul></li></ul></li></ul></li></ul><ul><li>è®¤çŸ¥æ²»ç–—ABC<ul><li>æ„æˆ<ul><li>A â€” Activating Events  è¯±å‘åˆºæ¿€</li><li>B â€” Beliefs  ä¿¡å¿µååº”</li><li>C â€” Consequences  è¡Œä¸ºåæœ</li></ul></li><li>åŸç†<ul><li>æˆ‘ä»¬æ˜¯æ”¹ä¸äº†Açš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ”¹Bï¼Œç„¶åCå°±ä¼šå‘ç”Ÿå˜åŒ–ï¼ï¼</li><li>å…³é”®æ˜¯ä½ æ€ä¹ˆçœ‹å¾…Açš„ ï¼ æ”¹å˜è®¤çŸ¥</li><li>çœŸæ­£å›°æ‰°æˆ‘ä»¬çš„å¹¶ä¸æ˜¯å‘ç”Ÿåœ¨æˆ‘ä»¬èº«ä¸Šçš„äº‹æƒ…ï¼Œè€Œæ˜¯æˆ‘ä»¬å›´ç»•è¿™ä¸ªäº‹æƒ…å¯¹å®ƒç¼–ç»‡çš„æ•…äº‹ï¼Œå’Œç”±æ­¤å¼•èµ·çš„èº«å¿ƒååº”</li></ul></li></ul></li><li>æƒ…ç»ªçš„ABCDç†è®º â€” å¯¹äºå­©å­è€Œè¨€<ul><li>å‡ºç°äº†ABCä»¥åï¼Œç»™ä¸€ä¸ªæœºä¼šè®©å…¶åé©³</li><li>è®©å­©å­å»åé©³ä»–å½“æ—¶çš„å¿µå¤´</li><li>å¹²é¢„B  ä»è€Œå¹²é¢„C</li></ul></li></ul><h2 id="2-3-æé«˜è‡ªæˆ‘è°ƒæ§çš„èƒ½åŠ›"><a href="#2-3-æé«˜è‡ªæˆ‘è°ƒæ§çš„èƒ½åŠ›" class="headerlink" title="2.3 æé«˜è‡ªæˆ‘è°ƒæ§çš„èƒ½åŠ›"></a>2.3 æé«˜è‡ªæˆ‘è°ƒæ§çš„èƒ½åŠ›</h2><ul><li>å»¶è¿Ÿæ»¡è¶³ï¼Œ è‡ªæˆ‘æ§åˆ¶</li><li>è‡ªæˆ‘è°ƒæ§èƒ½åŠ›æ˜¯å¯ä»¥é”»ç‚¼ä»è€Œè·å¾—æå‡çš„</li><li>å¦‚ä½•è¿›è¡Œè®­ç»ƒ<ul><li>ä½“è‚²é”»ç‚¼</li><li>æ­£å¿µå†¥æƒ³ â€” åšäº‹æƒ…æ²‰æµ¸å…¶ä¸­å°±å¥½å•Šï¼ï¼</li><li>è‡ªæˆ‘æŒ‘æˆ˜</li><li>ç›®æ ‡æƒ³è±¡</li><li>æœ‰æ•ˆä¼‘æ¯</li><li>ç§¯æå¿ƒæ€</li></ul></li></ul><h1 id="3-ç»„ç»‡éŸ§æ€§"><a href="#3-ç»„ç»‡éŸ§æ€§" class="headerlink" title="3. ç»„ç»‡éŸ§æ€§"></a>3. ç»„ç»‡éŸ§æ€§</h1><ul><li><p>å¤åŸåŠ›</p><ul><li>ä¼ä¸šé‡åˆ°å›°éš¾åï¼Œå¦‚ä½•å›å½’æ­£å¸¸</li></ul></li><li><p>å¤åŸåçš„å‘å±•èƒ½åŠ›</p></li><li><p>å½±å“ç»„ç»‡éŸ§æ€§çš„ç»´åº¦</p><ul><li>ç»„ç»‡èµ„æœ¬<ul><li>äººåŠ›èµ„æºçš„ä¿éšœ<ul><li>ä»€ä¹ˆæ”¿ç­–</li></ul></li></ul></li><li>ç»„ç»‡æ‰¿è¯º<ul><li>å‘˜å·¥å¯¹äºç»„ç»‡çš„æ„Ÿæƒ…</li><li>ä¿¡ä»»</li></ul></li><li>ç»„ç»‡é¢†å¯¼<ul><li>leaderæœ¬èº«çš„æ€åº¦ï¼Œæ€è€ƒï¼ŒéŸ§æ€§</li></ul></li><li>ç»„ç»‡å­¦ä¹ </li><li>ç»„ç»‡æ–‡åŒ–<ul><li>ç»„ç»‡çš„ä¼ ç»Ÿå’Œä¿¡ä»°</li></ul></li><li>ç¤¾ä¼šç½‘ç»œ</li></ul></li><li><p>æå‡ç»„ç»‡éŸ§æ€§çš„æ–¹å¼</p><ul><li>Staff  é€‰æ‹©å¿ƒç†éŸ§æ€§é«˜çš„äººæ‰ï¼Œé”»ç‚¼å¿ƒç†éŸ§æ€§<ul><li>ç§¯æçš„è‡ªæˆ‘è®¤è¯†</li><li>æå€¡ç§¯æçš„æ€ç»´</li><li>åŠ å¼ºå…³ç³»å»ºè®¾</li><li>æœªæ¥å¯¼å‘</li><li>ä¹è§‚ä¸»ä¹‰ç²¾ç¥<ul><li>å¯¹äºè·¯å¾„çš„ä¹è§‚</li><li>å¯¹äºç»“æœçš„ä¹è§‚</li></ul></li></ul></li><li>System åˆ›é€ ç§¯æçš„å¿ƒç†å¥åº·ç¯å¢ƒ</li><li>Skill</li></ul></li></ul><h1 id="4-å‹åŠ›çš„åº”å¯¹æŠ€å·§"><a href="#4-å‹åŠ›çš„åº”å¯¹æŠ€å·§" class="headerlink" title="4. å‹åŠ›çš„åº”å¯¹æŠ€å·§"></a>4. å‹åŠ›çš„åº”å¯¹æŠ€å·§</h1><h2 id="4-1-å‹åŠ›çš„åº”æ¿€ååº”"><a href="#4-1-å‹åŠ›çš„åº”æ¿€ååº”" class="headerlink" title="4.1 å‹åŠ›çš„åº”æ¿€ååº”"></a>4.1 å‹åŠ›çš„åº”æ¿€ååº”</h2><ul><li>åº”æ¿€ååº”çš„ä¸‰è½´å¿ƒ<ul><li>ä¸‹ä¸˜è„‘</li><li>å‚ä½“</li><li>è‚¾ä¸Šè…º</li></ul></li><li>ä¸‰ä¸ªå™¨å®˜ä¼šé‡Šæ”¾å‹åŠ›æ¿€ç´ ï¼Œä½¿å¾—æˆ‘ä»¬çš„ååº”æ˜¯fight or flight lol</li><li>è€Œåæ¿€ç´ æ°´å¹³ä¸‹é™</li><li>å„ç§æƒ…ç»ª<ul><li>ç„¦è™‘  ä¸ºæœªæ¥çš„ææ…Œ</li><li>æŠ‘éƒ  ä¸ºè¿‡å»ä¼¤å¿ƒ</li><li>è‡ªæ®‹</li></ul></li></ul><h2 id="4-2-ä¸æƒ…ç»ªæœ‰å…³çš„è„‘åŒº"><a href="#4-2-ä¸æƒ…ç»ªæœ‰å…³çš„è„‘åŒº" class="headerlink" title="4.2 ä¸æƒ…ç»ªæœ‰å…³çš„è„‘åŒº"></a>4.2 ä¸æƒ…ç»ªæœ‰å…³çš„è„‘åŒº</h2><ul><li><p>æä»æ ¸  Amygdala</p><ul><li>ä¼šå½±å“æˆ‘ä»¬çš„æƒ…ç»ª</li><li>æƒ…ç»ªä¸å¥½çš„æ—¶å€™ä¼šè®©æä»æ ¸å……è¡€ï¼Œç„¶åæä»æ ¸æ¸©åº¦å‡é«˜</li></ul></li><li><p>å¤§è„‘çš®å±‚ Cerebral Cortex</p></li><li><p>å¦‚ä½•åº”å¯¹å‹åŠ› â€” <strong>æŠ‘åˆ¶</strong>æä»æ ¸çš„æ´»åŠ¨</p><ul><li>å¸å…¥å‡‰æ°”ï¼Œé™ä½æä»æ ¸çš„æ¸©åº¦  hhh</li><li>é¦™æ°”  è®©æˆ‘ä»¬äº§ç”Ÿæ„‰æ‚¦çš„æ„Ÿè§‰</li><li>å†™å†™æ—¥è®°</li></ul></li><li><p>æ¿€æ´»å¤§è„‘çš„å¥–åŠ±ä¸­æ¢</p><ul><li><p>ç¥ç»å…ƒä¹‹é—´çš„é—´éš™ é ç¥ç»é€’è´¨è¿æ¥</p></li><li><p>å½“å¥–èµä¸­æ¢é‡Šæ”¾ç¥ç»é€’è´¨çš„æ—¶å€™ï¼Œä¼šé‡Šæ”¾ç§¯æçš„æƒ…ç»ª</p></li><li><p>ï¼ï¼å¿ƒç†æ´»åŠ¨ä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ç‰‡ä¸€ç‰‡çš„äº§ç”Ÿçš„</p></li><li><p>å¤šå·´èƒº</p><ul><li>åº†ç¥è‡ªå·±çš„æˆåŠŸ â€” è®©è‡ªå·±çš„æˆåŠŸå’Œå¿«ä¹çš„ä½“éªŒå»¶ç»­ä¸€æ®µæ—¶é—´<ul><li>å°†å¿«ä¹çš„ä½“éªŒå»¶ç»­4åˆ†é’Ÿï¼Œå°±å¯ä»¥åœ¨å¤§è„‘ä¸­å½¢æˆè®°å¿†ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå¿«ä¹çš„ç¥ç»ç½‘ç»œ</li></ul></li><li>åšè‡ªå·±å–œæ¬¢åšçš„äº‹æƒ…</li><li>äº«å—è‰ºæœ¯çš„ç¾å¦™</li></ul></li><li><p>è¡€æ¸…ç´ </p><ul><li>èƒ½å¤ŸæŒ¯å¥‹äººçš„å¿ƒæƒ…</li><li>ä»€ä¹ˆæ—¶å€™ä¼šåˆ†æ³Œ<ul><li>ä½“éªŒåˆ°è‡ªæˆ‘çš„ä»·å€¼</li><li>å¸®åŠ©åˆ«äººçš„æ—¶å€™</li><li>è‡ªå°Šå¿ƒçš„å‘µæŠ¤<ul><li>ä¿æŠ¤è‡ªå°Šå¿ƒ  ä½“ç°å…¶ä»·å€¼</li></ul></li></ul></li><li>ä¸€äº›è¡Œä¸º<ul><li>æ™’å¤ªé˜³~</li></ul></li></ul></li><li><p>å†…å•¡è‚½</p><ul><li>åªæœ‰æˆ‘ä»¬èº«å¿ƒç—›è‹¦çš„æ—¶å€™ï¼Œæ‰ä¼šé‡Šæ”¾</li><li>è¡Œä¸º<ul><li>æœ‰è§„å¾‹çš„è¿åŠ¨</li><li>å…ˆè‹¦åç”œçš„ä½“éªŒ</li><li>çœ‹å–œå‰§ï¼Œç›¸å£°~ çƒ§è„‘çš„å¹½é»˜</li></ul></li></ul></li><li><p>å‚¬äº§ç´ </p><ul><li>ç”·äººä¹Ÿæœ‰å‚¬äº§ç´ </li><li>ä¸»è¦ä½œç”¨æ˜¯å¢åŠ äººçš„çˆ±çš„æ„Ÿå—ï¼Œè€Œä¸æ˜¯ä¸ºäº†æ€€å­•</li><li>è¡Œä¸º<ul><li>å¤¸å¥–ï¼Œèµç¾</li><li>é™ªä¼´</li></ul></li></ul><h2 id="4-3-åº”å¯¹å‹åŠ›çš„é•¿æœŸç­–ç•¥"><a href="#4-3-åº”å¯¹å‹åŠ›çš„é•¿æœŸç­–ç•¥" class="headerlink" title="4.3 åº”å¯¹å‹åŠ›çš„é•¿æœŸç­–ç•¥"></a>4.3 åº”å¯¹å‹åŠ›çš„é•¿æœŸç­–ç•¥</h2></li><li><p>å‹åŠ›å®¹æ˜“è®©äººå¤±æ§å¤±å¸¸</p></li><li><p>åŸ¹å…»åº”å¯¹å‹åŠ›çš„ç§¯æä¹ æƒ¯</p><ul><li>strength based approach  å‘æŒ¥è‡ªå·±çš„é•¿å¤„ä¼˜åŠ¿  æ‰¾åˆ°è‡ªå·±çš„ä¼˜åŠ¿ï¼Œç„¶åå……åˆ†åœ¨å·¥ä½œç”Ÿæ´»å½“ä¸­ä½¿ç”¨  ä½¿ç”¨è‡ªå·±çš„ä¼˜åŠ¿ï¼ï¼ï¼</li><li>æ‰¾åˆ°è‡ªå·±çš„æµ  find your flow<ul><li>å–œæ¬¢åšçš„äº‹æƒ…ï¼Œè¿›å…¥å¿ƒæµçŠ¶æ€</li></ul></li><li>å€ŸåŠ©ä¸€äº›ç§‘å­¦æ–¹æ³•ï¼Œè‡ªä¿®ï¼ŒåŒä¿®ï¼Œä¸“ä¿®<ul><li>reading &amp; learning</li></ul></li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>å½­å‡¯å¹³ æ¼”è®²  â€” æŠ—é€†åŠ›â€” é‡å‹ä¸‹çš„å¿ƒç†éŸ§æ€§ä¸æˆåŠŸ</li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç§¯æå¿ƒç†å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Make Body Language Your Super Power</title>
      <link href="/Make-Body-Language-Your-Super-Power/"/>
      <url>/Make-Body-Language-Your-Super-Power/</url>
      
        <content type="html"><![CDATA[<ul><li>Stand Strong</li><li>Gesture Effectively</li><li>Mind Your Audience</li></ul><h1 id="1-Posture"><a href="#1-Posture" class="headerlink" title="1. Posture"></a>1. Posture</h1><ul><li>Communication begins before you open your mouth</li><li>How to stand<ul><li>no<ul><li>hands in the pocket  â€” cannot convey strong msg</li><li>hands in the hip â€” tend to look overwhelming and powerful</li><li>hands in front of family jewels lol</li></ul></li><li>yes<ul><li>base posture â€” feet should be shoulder width apart<ul><li>thatâ€™s the first impression</li></ul></li><li>movement<ul><li>give</li><li>show</li><li>chop â€” strong msg</li></ul></li><li>palms up has better impact! comparing with palm down and pointing</li></ul></li></ul></li><li>Where to stand<ul><li>face your audience</li><li>move around in the center box</li><li>get rid of potential distraction<ul><li>like window, by nature we are attracted by moving thing, will break the concentration</li></ul></li></ul></li></ul><h1 id="2-Audience"><a href="#2-Audience" class="headerlink" title="2. Audience"></a>2. Audience</h1><ul><li>Speaker need to understand what audience is doing , make sure we are all in the journey</li><li>How to engage with audience more<ul><li>gesture</li><li>notice<ul><li>how your audience sitting</li><li>eye contact</li></ul></li><li>surprise<ul><li>cold call, lol</li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.youtube.com/watch?v=cFLjudWTuGQ&ab_channel=StanfordGraduateSchoolofBusiness">https://www.youtube.com/watch?v=cFLjudWTuGQ&amp;ab_channel=StanfordGraduateSchoolofBusiness</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Distributed Messaging System: Kafka</title>
      <link href="/Distributed-Messaging-System-Kafka/"/>
      <url>/Distributed-Messaging-System-Kafka/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview-of-Messaging-Systems"><a href="#1-Overview-of-Messaging-Systems" class="headerlink" title="1. Overview of Messaging Systems"></a>1. Overview of Messaging Systems</h1><h2 id="1-1-Why-we-need-a-messaging-system"><a href="#1-1-Why-we-need-a-messaging-system" class="headerlink" title="1.1 Why we need a messaging system"></a>1.1 Why we need a messaging system</h2><ul><li><p>Aim:</p><ul><li>Reliably transfer a high throughput of messages between different entities</li></ul></li><li><p>Challenges</p><ul><li>how we handle a spike of messages</li><li>how we divide the work among a set of instances</li><li>how could we receive messages from different types of sources</li><li>what will happen if the service is down?</li></ul></li><li><p>We need messaging systems in distributed architecture due to challenges above</p></li></ul><h2 id="1-2-What-is-a-messaging-system"><a href="#1-2-What-is-a-messaging-system" class="headerlink" title="1.2 What is a messaging system?"></a>1.2 What is a messaging system?</h2><ul><li><p>responsible for transferring data among services /applications/ processes/ servers</p></li><li><p>help decouple different parts of a distributed system by providing an asynchronous way of transferring messaging between the sender and the receiver</p></li><li><p>Two common ways to handle messages</p><ul><li>Queuing<ul><li>msgs are stored sequentially in a queue</li><li>producers push msg to the rear of the queue</li><li>consumers extract the msgs from the front of the queue</li><li>a particular msg can be consumed by a <strong>max of one consumer</strong> only</li></ul></li><li>Publish - Subscribe<ul><li>messages are divided into topics</li><li>a publisher sends a message to a topic</li><li>subscribers subscribe to a topic to receive every message published to that topic</li><li>msg system that stores and maintains the msg named as <strong>message broker</strong></li></ul></li></ul></li></ul><h1 id="2-Kafka"><a href="#2-Kafka" class="headerlink" title="2. Kafka"></a>2. Kafka</h1><h2 id="2-1-General"><a href="#2-1-General" class="headerlink" title="2.1 General"></a>2.1 General</h2><ul><li><strong>publish subscribe based</strong> messaging system</li><li>takes streams of messages from applications known as producers, stores them reliably on a central cluster, and allows those messages to be received by applications that process the messages</li><li>kafka is mainly used for<ul><li>reliably storing a huge amount of data</li><li>enabling high throughput of message transfer between different entities</li><li>streaming real time data</li></ul></li><li>kafka is a distributed commit log â€” write ahead log<ul><li>append-only data structure that can <strong>persistently store a sequence of records</strong></li><li>all messages are stored <strong>on disk</strong></li><li>since all reads and writes happen <strong>in sequence</strong>, Kafka takes advantage of <strong>sequential disk reads</strong></li></ul></li></ul><h2 id="2-2-Use-Cases"><a href="#2-2-Use-Cases" class="headerlink" title="2.2 Use Cases"></a>2.2 Use Cases</h2><ul><li>Metrics<ul><li>collect and aggregate monitoring data</li></ul></li><li>Log Aggregation<ul><li>collect logs from multiple sources and make them available in a standard format to multiple consumers</li></ul></li><li>Stream Processing<ul><li>the raw data consumed from a topic is transformed, enriched, or aggregated and pushed to a <strong>new topic</strong> for further consumption. This way of data processing is known as stream processing.</li></ul></li><li>Commit Log<ul><li>can be used as an external commit log for any distributed system</li><li>Distributed services can log their transactions to Kafka to keep track of what is happening. This transaction data can be used for replication between nodes and also becomes very useful for disaster recovery, for example, to help failed nodes to recover their states.</li></ul></li><li>Website activity tracking<ul><li>Build a user activity tracking pipeline</li><li>User activities like page clicks, searches, etc., are published to Kafka into separate topics. These topics are available for subscription for a range of use cases, including real-time processing, real-time monitoring, or loading into Hadoop or data warehousing systems for offline processing and reporting</li></ul></li><li>Product Suggestion</li></ul><h1 id="3-High-Level-Architecture"><a href="#3-High-Level-Architecture" class="headerlink" title="3. High Level Architecture"></a>3. High Level Architecture</h1><h2 id="3-1-Common-Terms"><a href="#3-1-Common-Terms" class="headerlink" title="3.1 Common Terms"></a>3.1 Common Terms</h2><ul><li>Brokers<ul><li>A Kafka server</li><li>responsible for reliably storing data provided by the producers and making it available to the consumers</li></ul></li><li>Records<ul><li>A message or an event that get stored in Kafka</li><li>A record contains<ul><li>key</li><li>value</li><li>timestamp</li><li>optional metadata headers</li></ul></li></ul></li><li>Topics<ul><li>Messages are divided into categories called topics</li><li>Each msg that Kafka receives from a producer is associated with a topic</li><li>consumers can subscribe to a topic to get notified when new messages are added to the topic</li><li>a topic can have multiple subscribers that read messages from it</li><li>a topic is identified by its name and must be unique</li><li>mes in a topic can be read as often as needed â€” message are not deleted after consumption, instead, Kafka <strong>retains messages for a configurable amount of time or until a storage size is exceeded</strong></li></ul></li><li>Producers<ul><li>Applications that publish or write records to Kafka</li></ul></li><li>Consumers<ul><li>Applications that subscribe to read and process data from Kafka topics</li><li>Consumers subscribe to one or more topics and consume published messages by pulling data from the brokers</li><li>In Kafka, producers and consumers are fully decoupled and agnostic of each other, which is a key design element to achieve the high scalability that Kafka is known for</li></ul></li></ul><h2 id="3-2-Architecture"><a href="#3-2-Architecture" class="headerlink" title="3.2 Architecture"></a>3.2 Architecture</h2><p><img src="https://i.loli.net/2021/08/25/Chuwtvg4mNfFU58.png" alt="Overall Architecture"></p><ul><li>Kafka cluster<ul><li>Kafka is run as a cluster of one or more servers, where each server is responsible for running one Kafka broker</li></ul></li><li>ZooKeeper<ul><li>Distributed key value store</li><li>Used for coordination and storing configurations</li><li>Kafka uses ZooKeeper to coordinate between Kafka brokers; ZooKeeper maintains metadata information about the Kafka cluster</li></ul></li></ul><h2 id="3-3-Performance-concern"><a href="#3-3-Performance-concern" class="headerlink" title="3.3 Performance concern"></a>3.3 Performance concern</h2><h3 id="3-3-1-Storing-messages-to-disks"><a href="#3-3-1-Storing-messages-to-disks" class="headerlink" title="3.3.1 Storing messages to disks"></a>3.3.1 Storing messages to disks</h3><ul><li>there is a huge difference in disk performance between <strong>random block access and sequential access</strong>. Random block access is slower because of <strong>numerous disk seeks</strong>, whereas the sequential nature of writing or reading, enables disk operations to be <strong>thousands of times faster</strong> than random access.</li><li>OS level optimization<ul><li>Read Ahead â€” prefetch large block multiples</li><li>Write Behind â€” group small logical writes into big physical writes</li><li>PageCache â€” cache the disk in free RAM</li></ul></li><li>Zero Copy optimization<ul><li>OS copy data from the pageCache directly to a socket, effectively bypassing the kafka broker application entirely</li></ul></li><li>Kafka protocol to group msg together<ul><li>reduce network overhead</li></ul></li></ul><h1 id="4-Dive-Deep-in-Kafka-Cluster"><a href="#4-Dive-Deep-in-Kafka-Cluster" class="headerlink" title="4. Dive Deep in Kafka Cluster"></a>4. Dive Deep in Kafka Cluster</h1><h2 id="4-1-Topic-Partitions"><a href="#4-1-Topic-Partitions" class="headerlink" title="4.1 Topic Partitions"></a>4.1 Topic Partitions</h2><ul><li><p>Topics are partitioned, spread over a number of fragments</p></li><li><p>Each partition can be placed on a separate Kafka broker</p></li><li><p>A new message get appended to one of the topicâ€™s partition</p><ul><li>producer controls which partition it publishes to based on the data</li></ul></li><li><p>One partition is an <strong>ordered sequence</strong> of messages</p><ul><li>producers continually append new messages to partition</li><li>ordering of messages is <strong>maintained at the partition level, not across the topic</strong></li></ul></li><li><p>Unique sequence ID â€” offset</p><ul><li>It will get assigned to every message that enters a partition</li><li>used to identify every messageâ€™s sequential position within a topicâ€™s partition</li><li>offset sequences are unique only to each partition</li><li>to locate a specific message<ul><li>topic</li><li>partition</li><li>offset number</li></ul></li><li>producers can choose to publish a message to any partition<ul><li>if ordering within a partition is not needed, a round robin partition strategy can be used</li><li>Placing each partition on separate Kafka brokers enables multiple consumers to read from a topic in parallel. That means, different consumers can concurrently read different partitions present on separate brokers</li></ul></li></ul></li><li><p>Messages once written to partitions are immutable and cannot be updated.</p></li><li><p>Kafka guarantees that messages with the same key are written to the same partition.</p></li></ul><h2 id="4-2-Dumb-Broker-and-Smart-Consumer"><a href="#4-2-Dumb-Broker-and-Smart-Consumer" class="headerlink" title="4.2 Dumb Broker and Smart Consumer"></a>4.2 Dumb Broker and Smart Consumer</h2><ul><li>Kafka does not keep track of what records are read by the consumer</li><li>Consumers themselves poll kafka for new messages and say what records they want to read<ul><li>this allow them to increment/ decrement the offset they are as they wish</li></ul></li></ul><h2 id="4-3-Leader-and-Follower"><a href="#4-3-Leader-and-Follower" class="headerlink" title="4.3 Leader and Follower"></a>4.3 Leader and Follower</h2><p>Every topic can be replicated to multiple Kafka brokers to make the data fault-tolerant and highly available. Each topic partition has one leader broker and multiple replica (follower) brokers. </p><ul><li>Structure<ul><li>the broker cluster could have multiple brokers, each broker could have multiple partitions which belong to different topics</li><li>Each topic partition would have one lead broker and multiple replica brokers</li></ul></li></ul><h3 id="4-3-1-Leader"><a href="#4-3-1-Leader" class="headerlink" title="4.3.1 Leader"></a>4.3.1 Leader</h3><ul><li>A leader is the node responsible for all reads and writes for the given partition</li><li>Each partition has one kafka broker acting as a leader</li></ul><h3 id="4-3-2-Follower"><a href="#4-3-2-Follower" class="headerlink" title="4.3.2 Follower"></a>4.3.2 Follower</h3><ul><li><p>To handle single point of failure, Kafka replicate partitions and distribute them across multiple broker servers called followers.</p></li><li><p>Each followerâ€™s responsibility is to replicate the leaderâ€™s data to serve as a backup partition</p><ul><li><p>any follower can take over the leadership if the leader goes down</p><ul><li><p>from the image below, you could see only the leader take read and write requests, follower acts as replica but not take any read and write reqeusts</p><p><img src="https://i.loli.net/2021/08/25/4t7kVJfv3jliZyK.png" alt="Leader and Follower"></p></li></ul></li></ul></li></ul><h3 id="4-3-3-In-Sync-Replicas"><a href="#4-3-3-In-Sync-Replicas" class="headerlink" title="4.3.3 In Sync Replicas"></a>4.3.3 In Sync Replicas</h3><ul><li>In Sync Replicas means the broker has the latest data for a given partition</li><li>A leader is always an in sync replica</li><li>A follower is an in sync replica only if it has fully caught up to the partition it is following</li><li>Only ISRs are eligible to become partition leaders.</li><li>Kafka can choose the minimum number of ISRs required before the data becomes available for consumers to read</li></ul><h3 id="4-3-4-High-Water-mark"><a href="#4-3-4-High-Water-mark" class="headerlink" title="4.3.4 High Water mark"></a>4.3.4 High Water mark</h3><ul><li><p>To ensure data consistency, the leader broker never returns (or exposes) messages which have not been replicated to a minimum set of ISRs</p></li><li><p>For this, brokers keep track of the high-water mark, which is the highest offset that all ISRs of a particular partition share</p></li><li><p>The leader exposes data only up to the high-water mark offset and propagates the high-water mark offset to all followers</p><p>  <img src="https://i.loli.net/2021/08/25/pyDKzGCRow6O2Wu.png" alt="High Water Mark"></p></li></ul><h1 id="5-Consumer-Group"><a href="#5-Consumer-Group" class="headerlink" title="5. Consumer Group"></a>5. Consumer Group</h1><ul><li>A set of one or more consumers working together in parallel to consume messages from topic partitions, messages are equally divided among all the consumers of a group. with no two consumers receiving the same message</li></ul><h2 id="5-1-How-to-distribute-a-specific-message-to-only-a-single-consumer"><a href="#5-1-How-to-distribute-a-specific-message-to-only-a-single-consumer" class="headerlink" title="5.1 How to distribute a specific message to only a single consumer"></a>5.1 How to distribute a specific message to only a single consumer</h2><ul><li><p>only a single consumer reads messages from any partition within a consumer group</p><ul><li>means only one consumer can work on a partition in a consumer group at a time</li><li>every time a consumer is added to or removed from a group, the consumption is rebalanced within the group</li></ul></li><li><p>with consumer groups, consumers can be parallelized so that multiple consumers can read from multiple partitions on a topic, allowing a very high message processing throughput</p></li><li><p>number of partitions impacts consumersâ€™ maximum parallelism. as there cannot be more consumers than partitions</p></li><li><p>Kafka stores the <strong>current offset per consumer group per topic per partition</strong>, as it would for a single consumer. This means that unique messages are only sent to a single consumer in a consumer group, and the load is balanced across consumers as equally as possible</p></li><li><p><strong>Number of consumers in a group = number of partitions:</strong> each consumer consumes one partition.</p></li><li><p><strong>Number of consumers in a group &gt; number of partitions:</strong> some consumers will be idle.</p></li><li><p><strong>Number of consumers in a group &lt; number of partitions:</strong> some consumers will consume more partitions than others.</p></li></ul><h1 id="6-Kafka-Workflow"><a href="#6-Kafka-Workflow" class="headerlink" title="6. Kafka Workflow"></a>6. Kafka Workflow</h1><h2 id="6-1-Pub-sub-messaging"><a href="#6-1-Pub-sub-messaging" class="headerlink" title="6.1 Pub sub messaging"></a>6.1 Pub sub messaging</h2><ul><li>Producer publish messages on a topic</li><li>Kafka broker stores messages in the partitions configured for that particular topic.<ul><li>If the producer did not specify the partition in which the msg should be stored, the broker ensures that the msg are equally shared between partitions</li><li>If the producer sends two msgs and there are two partitions, Kafka will store those two in two partitions separately.</li></ul></li><li>consumer subscribe to a specific topic</li><li>Kafka will provide the current offset of the topic to the consumer and also saves that offset in the zookeeper</li><li>consumer request kafka at regular intervals for new msgs</li><li>once kafka receives msg from producers, it forward these messages to the consumer</li><li>consumer will receive msg and process it</li><li>once processed, consumer will send an acknowledgement to the kafka broker</li><li>upon receiving the acknowledgement, kafka <strong>increments the offset and updates it in the zooKeeper</strong><ul><li>this info is stored in zooKeeper, thus consumer could read the next msg correctly even during broker outages</li></ul></li><li>consumers can rewind/ skip to the desired offset of a topic at any time and read all the subsequent messages</li></ul><h2 id="6-2-Kafka-workflow-for-consumer-group"><a href="#6-2-Kafka-workflow-for-consumer-group" class="headerlink" title="6.2 Kafka workflow for consumer group"></a>6.2 Kafka workflow for consumer group</h2><ul><li>Producers publish messages on a topic.</li><li>Kafka stores all messages in the partitions configured for that particular topic, similar to the earlier scenario.</li><li>A single consumer subscribes to a specific topic, assume <code>Topic-01</code> with Group ID as <code>Group-1</code>.</li><li>Kafka interacts with the consumer in the same way as pub-sub messaging until a new consumer subscribes to the same topic, <code>Topic-01</code>, with the same Group ID as <code>Group-1</code>.</li><li>Once the new consumer arrives, Kafka switches its operation to share mode, such that each message is passed to only one of the subscribers<br>of the consumer group <code>Group-1</code>. This message transfer is<br>similar to queue-based messaging, as only one consumer of the group<br>consumes a message. Contrary to queue-based messaging, messages are not<br>removed after consumption.</li><li>This message transfer can go on until the number of consumers<br>reaches the number of partitions configured for that particular topic.</li><li>Once the number of consumers exceeds the number of partitions, the<br>new consumer will not receive any message until an existing consumer<br>unsubscribes. This scenario arises because each consumer in Kafka will<br>be assigned a minimum of one partition. Once all the partitions are<br>assigned to the existing consumers, the new consumers will have to wait.</li></ul><h1 id="7-ZooKeeper"><a href="#7-ZooKeeper" class="headerlink" title="7. ZooKeeper"></a>7. ZooKeeper</h1><h2 id="7-1-What-is-ZooKeeper"><a href="#7-1-What-is-ZooKeeper" class="headerlink" title="7.1 What is ZooKeeper"></a>7.1 What is ZooKeeper</h2><ul><li>A distributed configuration and synchronization service</li><li>In Kafka case, help to store basic metadata<ul><li>information about brokers</li><li>topics</li><li>partitions</li><li>partition leader/ followers</li><li>consumer offsets</li></ul></li></ul><h2 id="7-2-Act-as-central-coordinator"><a href="#7-2-Act-as-central-coordinator" class="headerlink" title="7.2 Act as central coordinator"></a>7.2 Act as central coordinator</h2><p>ZooKeeper is used for storing all sorts of metadata about the Kafka cluster:</p><ul><li>It maintains the <strong>last offset position</strong> of each consumer group per partition, so that consumers can quickly recover from the last position in case of a failure (although modern clients store offsets in a<br>separate Kafka topic).</li><li>It tracks the topics, number of partitions assigned to those topics, and leadersâ€™/followersâ€™ location in each partition.</li><li>It also manages the access control lists (ACLs) to different topics in the cluster. ACLs are used to enforce access or authorization.</li></ul><h2 id="7-3-How-to-find-leaders"><a href="#7-3-How-to-find-leaders" class="headerlink" title="7.3 How to find leaders"></a>7.3 How to find leaders</h2><ul><li>The producer connects to any broker and asks for the leader of Partition 1<ul><li>each broker contains metadata</li><li>each brokers will talk to zooKeeper to get the latest metadata</li></ul></li><li>The broker responds with the identification of the leader broker responsible for partition 1</li><li>The producer connects to the leader broker to publish the message</li></ul><h1 id="8-Controller-Broker"><a href="#8-Controller-Broker" class="headerlink" title="8. Controller Broker"></a>8. Controller Broker</h1><ul><li>Within the Kafka cluster, one broker will be elected as the Controller</li><li>Responsibility<ul><li>admin operations<ul><li>creating/ deleting a topic</li><li>adding partitions</li><li>assigning leaders to partitions</li><li>monitoring broker failures</li></ul></li><li>check the health of other brokers in the system periodically</li><li>communicates the result of the partition leader election to other brokers in the system</li></ul></li></ul><h2 id="8-1-Split-brain-issue"><a href="#8-1-Split-brain-issue" class="headerlink" title="8.1 Split brain issue"></a>8.1 Split brain issue</h2><ul><li>some controller has temporary issue, during the period, we assign a new controller, but the previous one auto recover, so we have two controllers and it could bring inconsistency easily.</li><li>Solution:<ul><li>Generation Clock<ul><li>simply a monotonically increasing number to indicate a serverâ€™s generation</li><li>If the old leader had an epoch number of â€˜1â€™, the new one would have â€˜2â€™.</li><li>This epoch is included in every request that is sent from the Controller to other brokers.</li><li>This way, brokers can now easily differentiate the real Controller by simply trusting the Controller with the highest number.</li><li>The Controller with the highest number is undoubtedly the latest one, since the epoch number is always increasing.</li><li>This epoch number is stored in ZooKeeper.</li></ul></li></ul></li></ul><h1 id="9-Delivery-Semantics"><a href="#9-Delivery-Semantics" class="headerlink" title="9. Delivery Semantics"></a>9. Delivery Semantics</h1><h2 id="9-1-Producer-Delivery-Semantics"><a href="#9-1-Producer-Delivery-Semantics" class="headerlink" title="9.1 Producer Delivery Semantics"></a>9.1 Producer Delivery Semantics</h2><ul><li>How can a producer know that the data is successfully stored at the leader or that the followers are keeping up with the leader</li><li>Kafka offers three options to denote the <strong>number of brokers</strong> that <strong>must receive the record</strong> before the <strong>producer considers the write as successful</strong><ul><li>Async<ul><li>Producer sends a msg to kafka and does not wait for acknowledgement from the server</li><li>fire-and-forget approach gives the best performance as we can write data to Kafka at network speed, but <strong>no guarantee can be made</strong> that the server has received the record in this case.</li></ul></li><li>Committed to Leader<ul><li>Producer waits for an acknowledgment from the leader.</li><li>This ensures that the data is committed at the leader; it will be slower than the â€˜Asyncâ€™ option, as the data has to be written on disk on the leader.</li><li>Under this scenario, the leader will respond without waiting for acknowledgments from the followers.</li><li>In this case, the record <strong>will be lost if the leader crashes immediately after acknowledging the producer but before the followers have replicated it</strong>.</li></ul></li><li>Committed to Leader and Quorum<ul><li>Producer waits for an acknowledgment from the leader and the quorum. This means the leader will wait for the full set of in-sync replicas to acknowledge the record. This will be the slowest write but guarantees that the record will not be lost as long as at least one in-sync replica remains alive. This is the strongest available guarantee.</li></ul></li></ul></li></ul><h2 id="9-2-Consumer-Delivery-Semantics"><a href="#9-2-Consumer-Delivery-Semantics" class="headerlink" title="9.2 Consumer Delivery Semantics"></a>9.2 Consumer Delivery Semantics</h2><ul><li>Ways to provide consistency to the consumer<ul><li>At most once<ul><li>Message may be lost but are never redelivered</li><li>Under this option, the consumer upon receiving a message, commit (or increment) the offset to the broker. Now, if the consumer crashes before fully consuming the message, that message will be lost, as when the consumer restarts, it will receive the next message from the last committed offset.</li></ul></li><li>At least once<ul><li>Messages are never lost but maybe redelivered</li><li>This scenario occurs when the consumer receives a message from Kafka, and it does not immediately commit the offset.</li><li>Instead, it waits till it completes the processing.</li><li>So, if the consumer crashes after processing the message but before committing the offset, it has to reread the message upon restart.</li><li>Since, in this case, the consumer never committed the offset to the broker, the broker will redeliver the same message. Thus, duplicate message delivery could happen in such a scenario.</li></ul></li><li>Exactly once<ul><li>It is very hard to achieve this unless the consumer is working with a transactional system.</li><li>Under this option, the consumer puts the message processing and the offset increment in one transaction.</li><li>This will ensure that the offset increment will happen only if the whole transaction is complete.</li><li>If the consumer crashes while processing, the transaction will be rolled back, and the offset will not be incremented. When the consumer restarts, it can reread the message as it failed to process it last time. This option leads to no data duplication and no data loss but can lead to decreased throughput.</li></ul></li></ul></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è´§è¿ä»£ç†æ³•å¾‹é£é™©</title>
      <link href="/%E8%B4%A7%E8%BF%90%E4%BB%A3%E7%90%86%E6%B3%95%E5%BE%8B%E9%A3%8E%E9%99%A9/"/>
      <url>/%E8%B4%A7%E8%BF%90%E4%BB%A3%E7%90%86%E6%B3%95%E5%BE%8B%E9%A3%8E%E9%99%A9/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è´§è¿ä»£ç†æ³•å¾‹é£é™©åŸºæœ¬å†…å®¹"><a href="#1-è´§è¿ä»£ç†æ³•å¾‹é£é™©åŸºæœ¬å†…å®¹" class="headerlink" title="1. è´§è¿ä»£ç†æ³•å¾‹é£é™©åŸºæœ¬å†…å®¹"></a>1. è´§è¿ä»£ç†æ³•å¾‹é£é™©åŸºæœ¬å†…å®¹</h1><h2 id="1-1-å›½é™…è´§è¿ä»£ç†äººå®šä¹‰"><a href="#1-1-å›½é™…è´§è¿ä»£ç†äººå®šä¹‰" class="headerlink" title="1.1 å›½é™…è´§è¿ä»£ç†äººå®šä¹‰"></a>1.1 å›½é™…è´§è¿ä»£ç†äººå®šä¹‰</h2><ul><li>å†å²è§†è§’ä¸Šæ¥çœ‹<ul><li>å›½é™…è´§è¿ä»£ç†ç»å†äº†ç”±æ˜¾æ˜ä»£ç†äººåˆ°éšåä»£ç†äººå†åˆ°<strong>è¿è¾“åˆåŒå½“äº‹äºº</strong>çš„è¿‡ç¨‹  Fright Agency â€”â†’ Freight Forwarder</li><li>ç ”ç©¶å†…å®¹ä»å•çº¯çš„ä»£ç†æ³•å¾‹å…³ç³»å‘è¿è¾“æ³•å¾‹å…³ç³»æ‰©å±•</li><li>ç°ä»£è´§è¿ä»£ç†çš„å®šä¹‰ 1992 ã€Šè´§è¿ä»£ç†ã€‹<ul><li>æä¾›å¹¶å®‰æ’è´§ç‰©è¿è¾“ä»¥å–å¾—æŠ¥é…¬ï¼Œ</li><li>æˆ–è€…ä¸ºè´§ç‰©åˆå¹¶æ‹¼ç®±å¹¶æ‰¿æ‹…å°†è¿™äº›è´§ç‰©ç”±æ”¶è´§åœ°è¿è‡³ç›®çš„åœ°çš„<strong>è¿è¾“è´£ä»»</strong></li></ul></li><li>2002 ã€Šè´§è¿ä»£ç†æ³•ã€‹  Legal Classification of Fright Forwarders<ul><li>å¥ å®šäº†å›½é™…è´§è¿ä»£ç†åˆ¶åº¦çš„FIATAçš„ç«‹æ³•æ¨¡å¼ä¸‹ï¼Œä»¥è´§ç‰©è¿è¾“åˆåŒçš„å½“äº‹äºº (as principal) å’Œéå½“äº‹äºº (except as principal) æ¥åŒºåˆ†å›½é™…è´§ç‰©ä»£ç†ä¼ä¸šä½œä¸º<strong>å¥‘çº¦æ‰¿è¿äººå’Œçº¯ç²¹ä»£ç†äºº</strong>çš„æƒ…å†µ</li></ul></li><li>FIATA (International Federation of Freight Forwarders Association)ã€Šå›½é™…è´§è¿ä»£ç†ä¸šç¤ºèŒƒæ³•ã€‹<ul><li>å›½é™…è´§è¿ä»£ç†äººæ˜¯æŒ‡ä¸å®¢æˆ·è¾¾æˆè´§è¿ä»£ç†åå®šï¼Œä¸ºå…¶æä¾›å„ç±»è¿è¾“ç›¸å…³æœåŠ¡åŠå…¶ä»–è¾…åŠ©å’Œå’¨è¯¢æœåŠ¡ï¼Œæˆ–è€…åœ¨å‰è¿°æœåŠ¡ä¹‹å¤–è¿˜ä»¥ä½¿ç”¨è‡ªæœ‰è¿è¾“å·¥å…·æˆ–è€…ç­¾å‘è‡ªå·±çš„è¿è¾“å•æ®çš„æ–¹å¼ä¸ºå®¢æˆ·æ‰¿è¿è´§ç‰©çš„äºº</li></ul></li></ul></li><li>æ— èˆ¹æ‰¿è¿äºº<ul><li>å¯¹äºå®é™…è´§ä¸»è€Œè¨€ï¼Œä½œä¸ºå…¬å…±æ‰¿è¿äººä¸ä¹‹è®¢ç«‹æµ·ä¸Šè´§ç‰©è¿è¾“åˆåŒ</li><li>å¯¹äºå®é™…æ‰¿è¿äººè€Œè¨€ï¼Œåˆæ‰¿æ‹…ç€æ‰˜è¿äººçš„ä¹‰åŠ¡</li></ul></li><li>å›½é™…è´§è¿ä»£ç†äººå®šä¹‰<ul><li>International Freight Forwarder</li></ul></li><li>å¯¹è´§ä»£çš„ä¸¤ç±»ç•Œå®š<ul><li>ä»£ç†äººè¯´<ul><li>å°†å›½é™…è´§è¿ä»£ç†äººè§„å®šä¸ºå—å§”æ‰˜äººçš„æŒ‡ç¤ºä¸ºå…¶è´§ç‰©åœ¨å›½é™…é—´çš„è¿è¾“åŠå…¶ä»–æœ‰å…³äº‹åŠ¡æä¾›åˆç†å®¡æ…æœåŠ¡çš„è‡ªç„¶äººæˆ–ç»æµç»„ç»‡ï¼Œæœ¬èº«ä¸šåŠ¡ä¸æ¶‰åŠè´§ç‰©çš„æ‰¿è¿</li><li>ä¸è´§ä¸»æˆ–å§”æ‰˜äººä¹‹é—´æ˜¯çº¯ç²¹çš„ä»£ç†å…³ç³»</li></ul></li><li>åŒé‡èº«ä»½è¯´<ul><li>è§„å®šäº†å›½é™…è´§è¿ä»£ç†äººæ˜¯ä¸ºå§”æ‰˜æ–¹ä»£åŠå›½é™…è´§è¿äº‹åŠ¡çš„ä»£ç†äºº</li><li>è§„å®šäº†åœ¨ä¸€å®šæ¡ä»¶ä¸‹å¯ä»¥<strong>æˆä¸ºè¿è¾“åˆåŒçš„å½“äº‹äººå¹¶å¯¹å¤–æ‰¿æ‹…æ‰¿è¿äººçš„è´£ä»»</strong></li></ul></li></ul></li></ul><h2 id="1-2-è´§è¿ä»£ç†æ³•å¾‹å…³ç³»è¾¨æ"><a href="#1-2-è´§è¿ä»£ç†æ³•å¾‹å…³ç³»è¾¨æ" class="headerlink" title="1.2 è´§è¿ä»£ç†æ³•å¾‹å…³ç³»è¾¨æ"></a>1.2 è´§è¿ä»£ç†æ³•å¾‹å…³ç³»è¾¨æ</h2><ul><li>æ³•å¾‹å…³ç³»<ul><li>æŒ‡ç›¸å…³æµ·è¿å›½é™…å…¬çº¦ï¼Œå„å›½å›½å†…æ³•ä»¥åŠè¡Œä¸šè§„èŒƒç­‰åœ¨è°ƒæ•´å›½é™…æµ·ä¸Šè´§è¿ä»£ç†è¡Œä¸ºçš„è¿‡ç¨‹ä¸­å½¢æˆçš„å„æœ‰å…³ä¸»ä½“é—´çš„æƒåˆ©å’Œä¹‰åŠ¡å…³ç³»</li><li>å›½é™…æµ·ä¸Šè´§è¿ä»£ç†æ³•å¾‹å…³ç³»åŒ…æ‹¬<ul><li>å›½é™…è´§è¿ä»£ç†ä¼ä¸šä½œä¸ºæµ·è¿ä»£ç†äººçš„æ³•å¾‹å…³ç³»</li><li>ä½œä¸ºæ— èˆ¹æ‰¿è¿äººçš„æ³•å¾‹å…³ç³»</li></ul></li></ul></li><li>ä½œä¸ºæµ·è¿ä»£ç†äººçš„æ³•å¾‹å…³ç³»<ul><li>åœ¨æä¾›æµ·ä¸Šè´§ç‰©è¿è¾“çš„ç›¸å…³ä»£ç†ä¸šåŠ¡çš„æ—¶å€™ï¼Œå‘ˆç°å‡ºçš„å…³ç³»</li><li>å†…éƒ¨å§”æ‰˜æ³•å¾‹å…³ç³»<ul><li>å›½é™…è´§è¿ä»£ç†ä¼ä¸šä¸æ‰˜è¿äººä¹‹é—´çš„å§”æ‰˜ä»£ç†åˆåŒæ³•å¾‹å…³ç³»</li></ul></li><li>å¤–éƒ¨ä»£ç†æ³•å¾‹å…³ç³»<ul><li>å›½é™…è´§è¿ä»£ç†ä¼ä¸šä¸ºæ‰˜è¿äººçš„åˆ©ç›Šå’Œæ‰¿è¿äººç­¾è®¢æµ·ä¸Šè´§ç‰©è¿è¾“åˆåŒè€Œäº§ç”Ÿçš„è¿è¾“åˆåŒæ³•å¾‹å…³ç³»</li><li>è´§ä»£ä¼ä¸šå¾€å¾€ä¼šä»¥è‡ªå·±çš„åä¹‰ä»£æ›¿å¤šç¬”æ•£è´§æ‰˜è¿äººä¸æ‰¿è¿äººç­¾è®¢ä¸€ä¸ªæ€»çš„è¿è¾“åˆåŒï¼Œè‡ªå·±å†åˆ†åˆ«åŒå„æ‰˜è¿äººç­¾è®¢è´§è¿ä»£ç†åè®®</li></ul></li><li>æˆ‘å›½åˆåŒæ³•å¯¹äºåŒ…æ‹¬è´§è¿ä»£ç†åˆåŒåœ¨å†…çš„å§”æ‰˜åˆåŒé‡‡ç”¨è¿‡é”™è´£ä»»åŸåˆ™<ul><li>è´§ä»£ä»…åœ¨è‡ªèº«ç¡®å®å—æ‰˜äº‹é¡¹å­˜åœ¨è¿‡é”™å¹¶é€ æˆæ‰˜è¿äººæŸå¤±çš„æƒ…å†µä¸‹æ‰¿æ‹…è¿çº¦æŸå®³èµ”å¿è´£ä»»</li><li>ä¸”åªè¦åœ¨ç¬¬ä¸‰æ–¹é€‰ä»»ä¸Šèƒ½å¤Ÿè¯æ˜å·²ç»å±¥è¡Œäº†åˆç†å’Œè°¨æ…çš„ä¹‰åŠ¡ï¼Œå¯¹ç”±äºç¬¬ä¸‰æ–¹é€ æˆçš„æ‰˜è¿äººæŸå¤±ï¼Œå¯ä»¥å…äºæ‰¿æ‹…è´£ä»»</li></ul></li></ul></li><li>ä½œä¸ºæ— èˆ¹æ‰¿è¿äººçš„æ³•å¾‹å…³ç³»<ul><li>å¥‘çº¦æ‰¿è¿äººçš„ä¸€ç§ï¼Œå³ä¸æ‹¥æœ‰æˆ–è€…ä¸ç»è¥èˆ¹èˆ¶ï¼Œä¸è¿›è¡Œå®é™…çš„è´§ç‰©è¿è¾“æ´»åŠ¨ï¼Œä»¥ç­¾å‘æ— èˆ¹æ‰¿è¿äººæå•(Non Vessel Operating Common Carrier Bill of Loading)çš„æ–¹å¼æ˜ç¤ºæˆ–è€…é»˜ç¤ºå¯¹è¿è¾“è´Ÿæœ‰è´£ä»»çš„äººï¼Œæ‰¿è¿è´£ä»»æ¥æºäºå’Œæ‰˜è¿äººç­¾è®¢çš„è´§ç‰©è¿è¾“å¥‘çº¦ï¼Œè€Œä¸æ˜¯å®é™…çš„è¿è¾“è¡Œä¸º</li><li>æ³•å¾‹å…³ç³»<ul><li>æ— èˆ¹æ‰¿è¿äººå’Œæ‰˜è¿äººä¹‹é—´çš„æµ·ä¸Šè´§ç‰©è¿è¾“åˆåŒå…³ç³»</li><li>æ— èˆ¹æ‰¿è¿äººå’Œèˆ¹å…¬å¸ä¹‹é—´çš„æµ·ä¸Šè´§ç‰©è¿è¾“åˆåŒå…³ç³»<ul><li>è´§ä»£ä»¥æ‰˜è¿äººçš„èº«ä»½å’Œèˆ¹å…¬å¸ â€” å®é™…æ‰¿è¿äººç­¾è®¢è¿è¾“åˆåŒå¹¶è·å¾—æµ·è¿æå•çš„ (Master Bill of Loading MBL)</li><li><strong>æ ¹æ®æµ·å•†æ³•ï¼Œ æ— èˆ¹æ‰¿è¿äººæ‰€éœ€è¦æ‰¿æ‹…çš„æ³•å¾‹è´£ä»»å’Œå®é™…æ‰¿è¿äººçš„è´£ä»»æ˜¯ä¸€æ ·çš„</strong></li><li>æ— èˆ¹æ‰¿è¿äººä¸äº«æœ‰ä¸å®Œå…¨è´£ä»»åˆ¶<ul><li>å½“å…è´£äº‹ç”±å‘ç”Ÿçš„æ—¶å€™ï¼Œèˆ¹å…¬å¸å¯ä»¥å…äºå¯¹æ— èˆ¹æ‰¿è¿äººæ‰¿æ‹…è´£ä»»ï¼Œè€Œæ— èˆ¹æ‰¿è¿äººæ— æ³•ä»¥ç›¸åŒçš„äº‹ç”±å¯¹æ‰˜è¿äººå…è´£</li></ul></li><li>å½“æ‰¿è¿äººå’Œå®é™…æ‰¿è¿äººéœ€è¦å¯¹è´§æŸè´§å·®éœ€è¦è¿›è¡Œèµ”å¿çš„æ—¶å€™ï¼ŒäºŒè€…åœ¨è´£ä»»èŒƒå›´å†…æ‰¿æ‹…è¿å¸¦è´£ä»»</li><li>å¯¹äºé™¤äº†æµ·ä¸Šè¿è¾“ä¹‹å¤–å®é™…æ‰˜è¿äººæä¾›çš„å…¶ä»–è¿è¾“æœåŠ¡ï¼Œæ— èˆ¹æ‰¿è¿äººå‡æ‰¿æ‹…ä¸¥æ ¼è´£ä»»</li></ul></li><li>æ— èˆ¹æ‰¿è¿äººå’Œèˆ¹å…¬å¸ä»£ç†äººä¹‹é—´çš„æµ·ä¸Šè´§ç‰©è¿è¾“åˆåŒå…³ç³»</li></ul></li></ul></li></ul><h1 id="2-é£é™©çŠ¶å†µåˆ†æ"><a href="#2-é£é™©çŠ¶å†µåˆ†æ" class="headerlink" title="2. é£é™©çŠ¶å†µåˆ†æ"></a>2. é£é™©çŠ¶å†µåˆ†æ</h1><ul><li><p>é£é™©çš„å®šä¹‰</p><ul><li>ç”±äºå›½é™…è´§è¿ä»£ç†ä¼ä¸šåœ¨å¼€å±•æµ·ä¸Šä¸šåŠ¡è¿‡ç¨‹ä¸­å—åˆ°å®¢è§‚æ³•å¾‹ç¯å¢ƒï¼ŒåŒ…æ‹¬è‡ªèº«åœ¨å†…çš„å„æµ·æ´‹è¿è¾“ç›¸å…³ä¸»ä½“æ‰€å®æ–½çš„æ³•å¾‹è¡Œä¸ºçš„å½±å“ï¼Œå¯¼è‡´å…¶æƒåˆ©ä¹‰åŠ¡çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œä»è€Œäº§ç”Ÿçš„å¯èƒ½ç”±è¯¥ä¼ä¸šæ‰¿æ‹…çš„æ³•å¾‹ä¸Šçš„ä¸åˆ©åæœ</li><li>æ³•å¾‹é£é™©ç”±ç¯å¢ƒè¯±å›  â€” å®¢è§‚æ³•å¾‹ç¯å¢ƒï¼Œè¡Œä¸ºè¯±å›  â€” å®æ–½çš„æ³•å¾‹è¡Œä¸ºåŠäºŒè€…æ‰€å¼•å‘çš„ä¸åˆ©åæœæ„æˆ<ul><li>æ³•å¾‹çš„ä¸å®Œå–„å’Œä¸ç¡®å®šæ€§<ul><li>ä¸å®Œå–„ â€” åˆ¶å®šæ³•å› ä¸ºæ— æ³•é¿å…åœ°æ»åäºç¤¾ä¼šçš„å‘å±•è€Œå¿…ç„¶å­˜åœ¨çš„æ¼æ´å’Œç©ºç™½</li><li>ä¸ç¡®å®šæ€§ â€” ç”±äºæ³•å¾‹æ¡æ–‡æ„ä¹‰æ™¦æ¶©ä¹‹å¤„éœ€è¦æ³•å®˜æ¥é˜é‡Šè¯´æ˜ï¼Œæ³•å®˜å¯¹äºæ³•å¾‹çš„ç†è§£ä¼šæœ‰æ‰€ä¸åŒï¼Œä»è€Œå¯¼è‡´äº†è£åˆ¤ç»“æœä¸æ€»æ˜¯ä¸€è‡´çš„</li></ul></li><li>è¡Œä¸ºè¯±å› <ul><li>è´§ä»£çš„ä¸€äº›ä¸è§„èŒƒçš„æ³•å¾‹è¡Œä¸ºï¼Œ</li></ul></li></ul></li></ul></li><li><p>è´§ä»£çº çº·æ¡ˆä»¶ç ”ç©¶ äº‰è®®ç„¦ç‚¹ä¸»è¦åœ¨ï¼š</p><ul><li>æ¶‰æ¡ˆä¸»ä½“é—´è´§è¿ä»£ç†åˆåŒå…³ç³»çš„è®¤å®š<ul><li>å› ä¸ºè½¬å§”æ‰˜è€Œå¼•å‘çš„å¯¹åŒæ–¹é—´æ˜¯å¦å­˜åœ¨ç›´æ¥æ³•å¾‹å…³ç³»çš„å¼‚è®®</li><li>å› ä¸ºè´§è¿ä»£ç†äººå’Œæ— èˆ¹æ‰¿è¿äººèº«ä»½è¯†åˆ«è€Œå¼•å‘çš„å¯¹åˆåŒå…³ç³»æ€§è´¨æ˜¯è´§ç‰©è¿è¾“åˆåŒæ³•å¾‹å…³ç³»è¿˜æ˜¯è´§ç‰©è¿è¾“ä»£ç†åˆåŒæ³•å¾‹å…³ç³»çš„å¼‚è®®</li></ul></li></ul></li><li><p>ä¸»è¦é£é™©åˆ†ç±»</p><ul><li>èº«ä»½è®¤å®šä¸Šçš„é£é™©<ul><li>æŒ‡å¯¹å›½é™…è´§è¿ä»£ç†ä¼ä¸šæ˜¯æ¶‰æ¡ˆè´§ç‰©çš„æµ·è¿ä»£ç†äººè¿˜æ˜¯æ— èˆ¹æ‰¿è¿äººçš„è®¤å®šç»“æœå’Œä¼ä¸šè‡ªèº«å¯¹æ­¤çš„è®¤è¯†ä¸åŒé€ æˆçš„é—®é¢˜</li></ul></li><li>è½¬å§”æ‰˜å’ŒåŒæ–¹ä»£ç†ä¸Šçš„é£é™©</li><li>æ¶‰å¤–æ³•å¾‹é€‚ç”¨ä¸Šçš„é£é™©<ul><li>è­¬å¦‚ç¾å›½ç»Ÿä¸€å•†æ³•å…¸ï¼Œå…è®¸ä»¥è®°åæå•çš„æ–¹å¼æ”¾è´§ï¼Œå¦‚æœåŒæ–¹åœ¨æ³•å¾‹é€‚ç”¨æ¡æ¬¾å½“ä¸­çº¦å®šé€‚ç”¨ç¾å›½æ³•ï¼Œé‚£ä¹ˆæµ·å¤–ä»£ç†æå•æ— å•æ”¾è´§çš„è¡Œä¸ºå°±ä¸å±äºè¿‡é”™è¡Œä¸º</li></ul></li></ul></li></ul><h1 id="3-é£é™©æˆå› åˆ†æ"><a href="#3-é£é™©æˆå› åˆ†æ" class="headerlink" title="3. é£é™©æˆå› åˆ†æ"></a>3. é£é™©æˆå› åˆ†æ</h1><h2 id="3-1-èº«ä»½è®¤å®šä¸Šçš„æ³•å¾‹é£é™©æˆå› "><a href="#3-1-èº«ä»½è®¤å®šä¸Šçš„æ³•å¾‹é£é™©æˆå› " class="headerlink" title="3.1 èº«ä»½è®¤å®šä¸Šçš„æ³•å¾‹é£é™©æˆå› "></a>3.1 èº«ä»½è®¤å®šä¸Šçš„æ³•å¾‹é£é™©æˆå› </h2><ul><li>å›½é™…è´§è¿ä»£ç†ä¼ä¸šæ˜¯æ¶‰æ¡ˆè´§ç‰©çš„æµ·è¿ä»£ç†äººè¿˜æ˜¯æ— èˆ¹æ‰¿è¿äººçš„è®¤å®šç»“æœçš„ä¸åŒï¼Œä¼šå¯¼è‡´ä¼ä¸šéœ€è¦æ‰¿æ‹…çš„æ³•å¾‹è´£ä»»å’Œé£é™©å®Œå…¨ä¸åŒ<ul><li>ç«‹æ³•ä¸Šçš„å°æ··ä¹±<ul><li>å› ä¸ºå¾ˆæœ‰å¯èƒ½è´§è¿ä»£ç†ä¼ä¸šåŒæ—¶æ‹…å½“ç€æ— èˆ¹æ‰¿è¿äººè¿˜æœ‰ä»£ç†äººçš„è§’è‰²</li></ul></li><li>å¸æ³•è£åˆ¤çš„ä¸ç¡®å®š<ul><li>ã€Šæµ·ä¸Šè´§ä»£çº çº·è§„å®šã€‹çš„ä¸€äº›åˆ¤æ–­é€»è¾‘<ul><li>åŒæ–¹ä¹‹é—´æ˜¯å¦è®¢ç«‹äº†æµ·ä¸Šè´§è¿ä»£ç†åˆåŒï¼Œåæ˜ å‡ºæ¥çš„æ˜¯ä»£ç†åè®®è¿˜æ˜¯è¿è¾“åè®®</li><li>å—æ‰˜äººå‘å§”æ‰˜äººæ˜¯å¦ç­¾å‘äº†æå•ï¼Œæ˜¯æ‰¿è¿æå•è¿˜æ˜¯ä»£ç†äººçš„åˆ†æå•</li><li>å—æ‰˜äººæ”¶å–è´¹ç”¨çš„åä¹‰æ˜¯ä½£é‡‘è¿˜æ˜¯è¿è´¹</li><li>åŒæ–¹ä»¥å¾€çš„äº¤æ˜“å†å²å’Œäº¤æ˜“ä¹ æƒ¯</li></ul></li></ul></li><li>ä»ä¸šè€…è‡ªèº«è¡Œä¸ºçš„ä¸è§„èŒƒ<ul><li>æ˜¯å¦ä¿ç•™äº†é‡è¦çš„å¾€æ¥æ–‡ä»¶ï¼Œå‘ç¥¨å’Œæå•</li></ul></li></ul></li></ul><h2 id="3-2-è½¬å§”æ‰˜ä¸åŒæ–¹ä»£ç†ä¸Šçš„æ³•å¾‹é£é™©æˆå› "><a href="#3-2-è½¬å§”æ‰˜ä¸åŒæ–¹ä»£ç†ä¸Šçš„æ³•å¾‹é£é™©æˆå› " class="headerlink" title="3.2 è½¬å§”æ‰˜ä¸åŒæ–¹ä»£ç†ä¸Šçš„æ³•å¾‹é£é™©æˆå› "></a>3.2 è½¬å§”æ‰˜ä¸åŒæ–¹ä»£ç†ä¸Šçš„æ³•å¾‹é£é™©æˆå› </h2><h3 id="3-2-1-è½¬å§”æ‰˜è¡Œä¸ºçš„æ³•å¾‹é£é™©æˆå› "><a href="#3-2-1-è½¬å§”æ‰˜è¡Œä¸ºçš„æ³•å¾‹é£é™©æˆå› " class="headerlink" title="3.2.1 è½¬å§”æ‰˜è¡Œä¸ºçš„æ³•å¾‹é£é™©æˆå› "></a>3.2.1 è½¬å§”æ‰˜è¡Œä¸ºçš„æ³•å¾‹é£é™©æˆå› </h3><ul><li>ä»€ä¹ˆæ˜¯è½¬å§”æ‰˜<ul><li>å—æ‰˜äººå°†å§”æ‰˜äººå§”æ‰˜å…¶ä»£ä¸ºå¤„ç†çš„äº‹åŠ¡è½¬äº¤ç»™ç¬¬ä¸‰äººå¤„ç†çš„è¡Œä¸º</li></ul></li><li>è½¬å§”æ‰˜è¡Œä¸ºçš„æ³•å¾‹é£é™©æˆå› <ul><li>åˆåŒæ³•è§„å®šï¼Œå¯¹äºå§”æ‰˜äº‹åŠ¡ï¼Œé™¤äº†ç»è¿‡å§”æ‰˜äººåŒæ„æˆ–è€…å‡ºç°ç´§æ€¥çŠ¶å†µå¯ä»¥è½¬å§”æ‰˜ä¹‹å¤–ï¼Œå—æ‰˜äººå‡åº”å½“äº²è‡ªå¤„ç†ï¼Œå¦åˆ™å°±è¦ä¸ºç¬¬ä¸‰äººçš„è¡Œä¸ºæ‰¿æ‹…è´£ä»»</li><li>ä½†æ˜¯å¯¹äºå›½é™…è´§è¿ä»£ç†è¡Œä¸šæ¥è¯´ï¼Œè½¬å§”æ‰˜æ˜¯ä¸€ä¸ªå¸¸è§„æ–¹å¼<ul><li>åŸå› åœ¨äºæµ·è¿è´§ä»£å§”æ‰˜äººæ›´ä¸ºçœ‹é‡æˆæœ¬å’Œæ•ˆç‡ï¼Œè®©è´§ä»£ä¼ä¸šå»å®Œå…¨å¤„ç†æ¯ä¸€ä»¶å§”æ‰˜äº‹åŠ¡æ˜¯ä¸ç»æµä¹Ÿä¸ç°å®çš„</li></ul></li><li>é€ æˆè´§ä»£ä¼ä¸šè½¬å§”æ‰˜é£é™©çš„æ˜¯æ˜¯å¦å–å¾—äº†å§”æ‰˜äººçš„åŒæ„</li><li>å½“å‰ã€Šæµ·ä¸Šè´§ä»£çº çº·è§„å®šã€‹æ˜ç¡®æ’é™¤äº†æ¨å®šæ‰˜è¿äººé»˜ç¤ºåŒæ„è´§è¿ä»£ç†äººè½¬å§”æ‰˜çš„å¯èƒ½<ul><li>è½¬å§”æ‰˜å…·ä½“æƒé™çº¦å®šä¸æ˜çš„æ—¶å€™ï¼Œå§”æ‰˜äººå°†è´Ÿæœ‰å°±ä¸æ˜æƒé™æƒ³å§”æ‰˜äººæŠ¥å‘Šçš„ä¹‰åŠ¡</li><li>å§”æ‰˜äººåœ¨å—æ‰˜äººæŒ‡ç¤ºä¸‹ä¸ç¬¬ä¸‰äººçš„é€šå¸¸æ¥è§¦è¡Œä¸ºä¸èƒ½è®¤å®šä¸ºå§”æ‰˜äººä»¥è¯¥è¡Œä¸ºå¯¹è½¬å§”æ‰˜çš„æ˜ç¡®åŒæ„</li></ul></li></ul></li></ul><h3 id="3-2-2-åŒæ–¹ä»£ç†è¡Œä¸ºä¸Šçš„æ³•å¾‹é£é™©æˆå› "><a href="#3-2-2-åŒæ–¹ä»£ç†è¡Œä¸ºä¸Šçš„æ³•å¾‹é£é™©æˆå› " class="headerlink" title="3.2.2 åŒæ–¹ä»£ç†è¡Œä¸ºä¸Šçš„æ³•å¾‹é£é™©æˆå› "></a>3.2.2 åŒæ–¹ä»£ç†è¡Œä¸ºä¸Šçš„æ³•å¾‹é£é™©æˆå› </h3><ul><li>ä»€ä¹ˆæ˜¯åŒæ–¹ä»£ç†ï¼Ÿ<ul><li>æŒ‡åœ¨åŒä¸€æ³•å¾‹å…³ç³»å†…ï¼Œä¸€æ–¹å½“äº‹äººçš„ä»£ç†äººåŒæ—¶åˆæ¥å—å¦ä¸€æ–¹å½“äº‹äººå§”æ‰˜ï¼Œå¹¶ä¸ºå…¶ä»£ç†çš„è¡Œä¸º</li><li>ç”±äºåˆåŒå…³ç³»ä¸­åŒæ–¹æ˜¯ç›¸å¯¹çš„ï¼ŒåŒæ–¹ä»£ç†ä¼šä½¿å¾—æœ¬æ˜¯å†²çªçš„åˆåŒåŒæ–¹æ„æ€è¡¨ç¤ºè¢«ä»£ç†çš„ä¸ªäººæ„å¿—äºˆä»¥æ›¿ä»£ï¼Œåç¦»äº†åˆåŒçš„æœ¬è´¨å±æ€§</li></ul></li><li>æµ·è¿è´§ä»£è¡Œä¸šéœ€è¦è¿™æ ·åšï¼Œå› ä¸ºæ•ˆç‡ä¸Šçš„æå‡ã€‚ä½†ä¼šæœ‰æ³•å¾‹ä¸Šçš„é£é™©</li></ul><h2 id="3-3-æ¶‰å¤–æ³•å¾‹é€‚ç”¨ä¸Šçš„é£é™©æˆå› "><a href="#3-3-æ¶‰å¤–æ³•å¾‹é€‚ç”¨ä¸Šçš„é£é™©æˆå› " class="headerlink" title="3.3 æ¶‰å¤–æ³•å¾‹é€‚ç”¨ä¸Šçš„é£é™©æˆå› "></a>3.3 æ¶‰å¤–æ³•å¾‹é€‚ç”¨ä¸Šçš„é£é™©æˆå› </h2><ul><li>ä½œä¸ºæ³•é™¢è£åˆ¤ä¾æ®çš„å›½å¤–æ³•å¾‹è§„å®šå¯èƒ½ä¼šè®©å›½é™…è´§è¿ä»£ç†ä¼ä¸šåœ¨è¯‰è®¼ä¸­å¤„äºä¸åˆ©åœ°ä½</li><li>æ¶‰å¤–å•†äº‹ä»£ç†æ³•å¾‹å…³ç³»ï¼Œä¼šå—åˆ°é€”ç»å›½å®¶çš„æ³•å¾‹ç®¡è¾–</li><li>å¦‚æœåŒæ–¹æœªçº¦å®šå‡†æ®æ³•ï¼Œæˆ–æ¶‰è¯‰çš„å›½é™…è´§ä»£ä¼ä¸šæ²¡æœ‰å‡†ç¡®ç†è§£å’ŒæŠŠæ¡å·²çº¦å®šçš„å‡†æ®æ³•ï¼Œå°±ä¼šå¤§å¤§å¢åŠ è¯‰è®¼ä¸­çš„ä¸ç¨³å®šå› ç´ </li><li>è‹±ç¾æ³•ç³»ï¼Œåˆ¤ä¾‹æ³•ï¼› æˆæ–‡æ³•å›½å®¶ï¼Œæœ‰ä¸“é—¨çš„è´§è¿ä»£ç†æ³•å¾‹</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>ã€Šå›½é™…æµ·ä¸Šè´§è¿ä»£ç†æ³•å¾‹é£é™©ç ”ç©¶ã€‹  é‚“å¤§é¸£</li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è´§è¿ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›½é™…è´§è¿ä»£ç†è¡Œä¸šåˆæ¢</title>
      <link href="/%E5%9B%BD%E9%99%85%E8%B4%A7%E8%BF%90%E4%BB%A3%E7%90%86%E8%A1%8C%E4%B8%9A%E5%88%9D%E6%8E%A2/"/>
      <url>/%E5%9B%BD%E9%99%85%E8%B4%A7%E8%BF%90%E4%BB%A3%E7%90%86%E8%A1%8C%E4%B8%9A%E5%88%9D%E6%8E%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="å›½é™…è´§è¿ä»£ç†è¡Œä¸šåˆæ¢"><a href="#å›½é™…è´§è¿ä»£ç†è¡Œä¸šåˆæ¢" class="headerlink" title="å›½é™…è´§è¿ä»£ç†è¡Œä¸šåˆæ¢"></a>å›½é™…è´§è¿ä»£ç†è¡Œä¸šåˆæ¢</h1><h1 id="1-è´§è¿å…¬å¸ä¸šåŠ¡ä¸å·¥ä½œå†…å®¹"><a href="#1-è´§è¿å…¬å¸ä¸šåŠ¡ä¸å·¥ä½œå†…å®¹" class="headerlink" title="1. è´§è¿å…¬å¸ä¸šåŠ¡ä¸å·¥ä½œå†…å®¹"></a>1. è´§è¿å…¬å¸ä¸šåŠ¡ä¸å·¥ä½œå†…å®¹</h1><h2 id="1-1-ä¸»è¦ä¸šåŠ¡"><a href="#1-1-ä¸»è¦ä¸šåŠ¡" class="headerlink" title="1.1 ä¸»è¦ä¸šåŠ¡"></a>1.1 ä¸»è¦ä¸šåŠ¡</h2><h3 id="1-1-1-Overview"><a href="#1-1-1-Overview" class="headerlink" title="1.1.1 Overview"></a>1.1.1 Overview</h3><blockquote><p>å®¢æˆ·å§”æ‰˜è´§è¿ä»£ç†è¿è¾“è´§ç‰©ï¼Œå®¢æˆ·æœ¬äººå¹¶ä¸æ‰¿æ‹…æ‰¿è¿è´£ä»»ï¼›è´§ä»£æ¥å—å‘è´§äººå§”æ‰˜åï¼Œä¸ºå‘è´§äººæä¾›ç›¸å…³æœåŠ¡ï¼Œæ»¡è¶³å‘è´§äººçš„å…·ä½“è¦æ±‚ï¼ŒåŒæ—¶è¦æ±‚å‘è´§äººæ ¹æ®æœåŠ¡æ¥æ”¯ä»˜ä¸€å®šæŠ¥é…¬çš„è¡Œä¸š</p></blockquote><h3 id="1-1-2-ä¸»è¥ä¸šåŠ¡"><a href="#1-1-2-ä¸»è¥ä¸šåŠ¡" class="headerlink" title="1.1.2 ä¸»è¥ä¸šåŠ¡"></a>1.1.2 ä¸»è¥ä¸šåŠ¡</h3><ul><li>çº¯ç²¹ä»£ç†äººçš„ä¸šåŠ¡<ul><li>å–å¾—å§”æ‰˜äººæˆæƒ</li><li>è´Ÿè´£è´§ç‰©ç¦»å¼€æ¸¯å£ä»¥åŠåˆ°è¾¾æ¸¯å£çš„å…¬åŠ¡å¤„ç†å·¥ä½œ<ul><li>æŠ¥å…³</li><li>æŠ¥æ£€</li><li>ä¿é™©</li></ul></li><li>è¿™ä¸ªæ¸…å…³ç¯èŠ‚ä¸»è¦æ˜¯é…åˆå½“åœ°æµ·å…³è¿›è¡Œæ–‡ä»¶å‡†å¤‡å·¥ä½œ</li></ul></li><li>å›½é™…å¤šå¼è”è¿ä¸šåŠ¡<ul><li>å¤šå¼è”è¿ï¼Œå‘å±•è‡ªé›†è£…ç®±è¿è¾“</li></ul></li><li>æ— èˆ¹æ‰¿è¿ä¸šåŠ¡<ul><li>å…·æœ‰æ— èˆ¹å…¬å…±æ‰¿è¿äººNVOCC (Non Vessel Operating Common Carrier)èµ„è´¨çš„è´§ä»£ä¼ä¸šå¯ä»¥ä»¥æ‰¿è¿äººçš„èº«ä»½æ¥å—è´§è½½å§”æ‰˜</li><li>è´§ç‰©æ¸…å…³çš„æ—¶å€™ç”¨è´§ä»£ä¼ä¸šçš„æå•ï¼Œæ‰¿æ‹…æ‰¿è¿äººçš„è´£ä»»ï¼Œå®Œæˆè´§ç‰©ç¦»æ¸¯åˆ°å²¸çš„å›½é™…æµ·è¿ç»è¥ä¸šåŠ¡</li><li>æ— èˆ¹æ‰¿è¿äººåªæ˜¯å¥‘çº¦æ‰¿è¿äººï¼Œè€Œå®é™…å®Œæˆè¿è¾“çš„æ‰¿è¿äººæ˜¯è´§ä»£ä¼ä¸šæ‰€å§”æ‰˜çš„å…¶ä»–å›½é™…èˆ¹èˆ¶è¿è¾“ç»è¥è€…</li></ul></li><li>ç‰©æµä¸šåŠ¡<ul><li>å¯ä»¥é’ˆå¯¹ä¸åŒå®¢æˆ·æä¾›å®šåˆ¶åŒ–çš„ä¾›åº”é“¾è§£å†³æ–¹æ¡ˆï¼Œå›Šæ‹¬äº†è´§ç‰©ä»ç”Ÿäº§ï¼Œå‡ºå‚ï¼Œè½¬è¿ï¼Œæ¸…ä»“æŠ¥å…³ï¼Œåˆ°è¾¾ç›®æ ‡å¸‚åœºç­‰å„ä¸ªç¯èŠ‚</li></ul></li><li>å›½é™…å¿«é€’ä¸šåŠ¡</li></ul><h2 id="1-2-åŸºæœ¬å·¥ä½œæµç¨‹"><a href="#1-2-åŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="1.2 åŸºæœ¬å·¥ä½œæµç¨‹"></a>1.2 åŸºæœ¬å·¥ä½œæµç¨‹</h2><ul><li>æµ·è¿æµç¨‹<ul><li>ä»–å›½ä¹°ä¸»å’Œä¸­å›½ä¼ä¸šå°±è´¸æ˜“è¡Œä¸ºç­¾è®¢è´¸æ˜“åˆåŒ</li><li>ä¸­å›½å·¥å‚ç¡®å®šè´§è¿ä»£ç†ä¼ä¸šï¼Œå¹¶ä¸ä¹‹å•†è®¨å‡ºè´§</li><li>ä¸­å›½è´§è¿ä»£ç†ä¼ä¸šå’Œèˆ¹è¿å…¬å¸å•†è®¨è®¢èˆ±äº‹å®œ</li><li>æ‹¿åˆ°æ‰¿è½½è´§ç‰©çš„èˆ¹çš„åå­—å’Œè¾¾åˆ°ç›®çš„åœ°çš„å‡†ç¡®ä¿¡æ¯</li><li>å›½å†…å¤–è´§è¿ä»£ç†ä¼ä¸šå…±åŒç¡®è®¤è´§ç‰©è¿è¾“ä¿¡æ¯ï¼Œä»¥åŠåˆ°è¾¾ç›®çš„åœ°çš„æ—¶é—´ä¿¡æ¯ï¼Œå¹¶å°†å…·ä½“ä¿¡æ¯ä¼ é€’ç»™å›½å¤–ä¹°å®¶</li></ul></li><li>location / key points<ul><li>å–æ–¹ï¼Œå‡ºå£å•†åœ°ç‚¹</li><li>å‡ºå£å•è¯æ‰‹ç»­</li><li>è¾¹å¢ƒ/ æœºåœº/ ç å¤´äº¤è´§</li><li>è£…è¿æ¸¯</li><li>èˆ¹èˆ·</li><li>èˆ¹ä¸Š</li><li>èˆ¹ä¸Š</li><li>èˆ¹èˆ·</li><li>åˆ°è¾¾å¸è´§æ¸¯</li><li>æŒ‡å®šç›®çš„åœ°äº¤è´§; è¾¹å¢ƒ/ æœºåœº/ ç å¤´</li><li>è¿›å£å•è¯æ‰‹ç»­</li><li>å–æ–¹/ è¿›å£å•†åœ°ç‚¹</li></ul></li></ul><h2 id="1-3-è´§ä»£ä¼ä¸šç­‰çº§"><a href="#1-3-è´§ä»£ä¼ä¸šç­‰çº§" class="headerlink" title="1.3 è´§ä»£ä¼ä¸šç­‰çº§"></a>1.3 è´§ä»£ä¼ä¸šç­‰çº§</h2><ul><li>ä¸€çº§è´§ä»£ä¼ä¸š<ul><li>éœ€è¦è·å¾—å›½é™…è´§ä»£èµ„æ ¼è¯ä¹¦</li><li>å•†åŠ¡éƒ¨é¢å‘çš„ï¼Œä¸€çº§è´§ä»£ä¼ä¸šæœ‰æƒä»ä¸­å›½ä¸åŒæ¸¯å£è®¢èˆ±</li></ul></li><li>å°å‹è´§ä»£å…¬å¸<ul><li>ä¾æ‰˜äºä¸€çº§è´§ä»£ä¼ä¸šï¼Œæ¥è¿›è¡Œè®¢èˆ±çš„å…¬å¸</li></ul></li></ul><h1 id="2-å›½é™…è´§è¿è¡Œä¸šå‘å±•çš„å¤–éƒ¨ç¯å¢ƒ"><a href="#2-å›½é™…è´§è¿è¡Œä¸šå‘å±•çš„å¤–éƒ¨ç¯å¢ƒ" class="headerlink" title="2. å›½é™…è´§è¿è¡Œä¸šå‘å±•çš„å¤–éƒ¨ç¯å¢ƒ"></a>2. å›½é™…è´§è¿è¡Œä¸šå‘å±•çš„å¤–éƒ¨ç¯å¢ƒ</h1><ul><li><p>PESTåˆ†ææ–¹å¼</p><ul><li>ç»´åº¦<ul><li>æ”¿æ²»<ul><li>2010å¹´è´§ä»£æ ‡å‡†åŒ–å§”å‘˜ä¼š</li><li>2015å¹´ã€Šæ¨åŠ¨å…±å»ºä¸ç»¸ä¹‹è·¯ç»æµå¸¦å’Œ21ä¸–çºªæµ·ä¸Šä¸ç»¸ä¹‹è·¯çš„æ„¿æ™¯ä¸è¡ŒåŠ¨ã€‹</li><li>2016å¹´ã€Šå…³äºåŠ å¿«å›½é™…è´§è¿ä»£ç†ç‰©æµä¸šå¥åº·å‘å±•çš„æŒ‡å¯¼æ„è§ã€‹</li><li>ã€Šä¸­åäººæ°‘å…±å’Œå›½æµ·å•†æ³•ã€‹</li></ul></li><li>ç»æµ</li><li>æŠ€æœ¯</li><li>ç¤¾ä¼šæ–‡åŒ–</li></ul></li><li>å¤–éƒ¨çš„å˜åŒ–æ˜¯ç»„ç»‡æ— æ³•æ§åˆ¶çš„ï¼Œè„±ç¦»äºç»„ç»‡å†…éƒ¨ï¼Œå´ç¯ç»•åœ¨ç»„ç»‡å››å‘¨ï¼Œä»ä¸åŒæ–¹é¢ä½œç”¨åœ¨ç»„ç»‡å†…éƒ¨</li></ul></li><li><p>æ³¢ç‰¹äº”åŠ›ç«äº‰ç†è®º</p><ul><li>ç»´åº¦<ul><li>æ›¿ä»£è€…<ul><li>è´§ä»£çš„ä¾›åº”å•†</li></ul></li><li>å®¢æˆ·</li><li>ä¾›åº”å•†<ul><li>ä¾›åº”å•† å°¤å…¶æ˜¯èˆ¹èˆ¶å…¬å¸èˆªç©ºå…¬å¸æœ‰ç€æ¯”è¾ƒå¼ºçš„è®®ä»·èƒ½åŠ›ï¼Œå°¤å…¶å¯¹äºä¸­å°å‹è´§ä»£è€Œè¨€</li></ul></li><li>æ½œåœ¨ç«äº‰è€…<ul><li>æ”¿ç­–å£å’æ•´ä½“åœ¨é™ä½</li><li>ä¼ ç»Ÿä¸šåŠ¡ â€” æŠ¥å…³æŠ¥æ£€ï¼Œç å¤´ç‰©æµï¼ŒçŸ­é€”ä¸“çº¿è¿è¾“</li><li>æ–°å…´ä¸šåŠ¡ â€” ä¾›åº”é“¾ç®¡ç†ï¼Œéå¸¸è§„è´§ç‰©æ‰˜è¿ï¼Œå¤šå¼è”è¿</li></ul></li><li>åŒè¡Œä¸šç«äº‰è€…<ul><li>èˆ¹èˆ¶å…¬å¸æ——ä¸‹è‡ªå·±è®¾ç«‹çš„è´§ä»£ç‰©æµå…¬å¸<ul><li>æœ‰ç›´æ¥å®¢æˆ·æº</li><li>åº•ä»·æµ·è¿è´¹å’Œè®¢èˆ±è´¹å‡å…çš„ä¼˜åŠ¿</li><li>å¯ä»¥é€šè¿‡èˆ¹å…¬å¸å®Œå–„çš„æµ·å¤–ç½‘ç»œæŒ‡å®šå›½å†…çš„å‡ºå£ä¾›åº”å•†ï¼Œå¯ä»¥æä¾›æ›´å¤šç§çš„è´¸æ˜“æ–¹å¼<ul><li>è´¸æ˜“æ–¹å¼<ul><li>Exxxx<ul><li>EXW<ul><li>å–æ–¹ä»…åœ¨è‡ªå·±çš„åœ°ç‚¹ä¸ºä¹°æˆ¿å¤‡å¦¥è´§ç‰©äº¤ä»˜ï¼Œå‡ºå·¥å‚ä»¥åå°±æ²¡æœ‰è´¹ç”¨å’Œå®‰å…¨è´£ä»»äº†</li></ul></li></ul></li><li>Fxxx  â€” å–æ–¹éœ€è¦å°†è´§ç‰©äº¤åˆ°åˆ¶å®šçš„æ‰¿è¿äººå¤„<ul><li>FCA  è´§äº¤æ‰¿è¿äºº</li><li>FAS  è£…è¿æ¸¯ èˆ¹è¾¹  äº¤è´§ â€” åˆ°ç å¤´</li><li>FOB è£…è¿æ¸¯ èˆ¹ä¸Š äº¤è´§  â€” åˆ°èˆ¹èˆ·<ul><li>ä»·æ ¼è®¡ç®—  = (äº§å“å«ç¨æˆæœ¬ + åˆ©æ¶¦ + å›½å†…è¿è¾“è´¹ç”¨ - å‡ºå£é€€ç¨)/ æ±‡ç‡</li><li>å–æ–¹çš„ä¹‰åŠ¡<ul><li>å°†åˆåŒè§„å®šçš„è´§ç‰©äº¤åˆ°ä¹°æˆ¿æ‰€æŒ‡æ´¾çš„èˆ¹ä¸Šå¹¶åŠæ—¶é€šçŸ¥ä¹°æ–¹</li><li>æ‰¿æ‹…è´§ç‰©è¶Šè¿‡è£…è¿æ¸¯èˆ¹èˆ·ä¹‹å‰çš„ä¸€åˆ‡é£é™©</li><li>åŠç†è´§ç‰©çš„å‡ºå£æ‰‹ç»­</li><li>æäº¤å•†ä¸šå‘ç¥¨ç­‰æ‰€éœ€çš„å‡­è¯</li></ul></li><li>ä¹°æ–¹çš„ä¹‰åŠ¡<ul><li>ç§Ÿèˆ¹è®¢èˆ±ï¼Œæ”¯ä»˜è¿è´¹</li><li>å°†èˆ¹åï¼Œè£…è´§åœ°ç‚¹å’Œè¦æ±‚äº¤è´§çš„æ—¶é—´åŠæ—¶é€šçŸ¥å–æ–¹</li><li>å—é¢†è´§ç‰©ï¼Œæ”¯ä»˜è´§æ¬¾</li><li>æ‰¿æ‹…è´§ç‰©è¶Šè¿‡è£…è¿æ¸¯èˆ¹èˆ·ä¹‹åçš„ä¸€åˆ‡é£é™©</li><li>åŠç†è´§ç‰©çš„è¿›å£æ‰‹ç»­</li></ul></li></ul></li></ul></li><li>Cxxx â€” å–æ–¹éœ€è¦è®¢ç«‹è¿è¾“åˆåŒï¼Œä½†æ˜¯å¯¹äºè´§ç‰©æŸå¤±çš„é£é™©ä»¥åŠè£…èˆ¹å’Œå¯è¿ä¹‹åå‘ç”Ÿçš„æ„å¤–æ‰€äº§ç”Ÿçš„é¢å¤–è´¹ç”¨ï¼Œå–æ–¹ä¸æ‰¿æ‹…è´£ä»»<ul><li>CFR  æˆæœ¬+è¿è´¹<ul><li>CFR = FOB + æµ·è¿è´¹</li></ul></li><li>CIF  æˆæœ¬è¿è´¹ä¿é™©<ul><li>CIF = FOB + æµ·è¿è´¹ + æµ·è¿ä¿é™©è´¹</li></ul></li><li>CIP  è¿è´¹/ ä¿é™©è´¹ä»˜åˆ°ç›®çš„åœ°</li></ul></li><li>Dxxx â€” å–æ–¹æ‰¿æ‹…å°†è´§ç‰©äº¤åˆ°å‡ºå£å›½è¾¹å¢ƒæˆ–è€…ç›®çš„å›½æ‰€éœ€çš„å…¨éƒ¨è´¹ç”¨å’Œé£é™©<ul><li>DAF  å‡ºå£å›½è¾¹å¢ƒäº¤è´§</li><li>DES  ç›®çš„æ¸¯èˆ¹ä¸Šäº¤è´§</li><li>DEQ  ç›®çš„æ¸¯ç å¤´äº¤è´§</li><li>DDU  æœªå®Œç¨äº¤è´§</li><li>DDP  å®Œç¨åäº¤è´§</li></ul></li><li>FOB</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><p>SWOT æˆ˜ç•¥ç®¡ç†åˆ†æ</p><ul><li>S - Strength<ul><li>ä¼ä¸šå†…éƒ¨ä¼˜åŠ¿</li></ul></li><li>W - Weakness<ul><li>ä¼ä¸šé¢ä¸´çš„ç«äº‰å¼±åŠ¿</li></ul></li><li>O - Opportunity<ul><li>å‘å±•è¿‡ç¨‹å½“ä¸­çš„æœ‰åˆ©å¤–éƒ¨ç¯å¢ƒ</li></ul></li><li>T  - Threat<ul><li>ä¼ä¸šè‡ªèº«ä¸šåŠ¡çš„å¤–éƒ¨å¨èƒ</li><li>å½“å¤–éƒ¨ç¯å¢ƒä¸åˆ©äºä¼ä¸šçš„å‘å±•ï¼Œä¼ä¸šä¸ºäº†é¿å…å¤–éƒ¨ç¯å¢ƒå¸¦æ¥çš„å¨èƒï¼Œåº”å½“åŠæ—¶è°ƒæ•´ç»è¥æˆ˜ç•¥</li></ul></li></ul></li></ul><h1 id="3-å†…éƒ¨ç¯å¢ƒåˆ†æ"><a href="#3-å†…éƒ¨ç¯å¢ƒåˆ†æ" class="headerlink" title="3. å†…éƒ¨ç¯å¢ƒåˆ†æ"></a>3. å†…éƒ¨ç¯å¢ƒåˆ†æ</h1><ul><li>ä»·å€¼é“¾åˆ†ææ³•<ul><li>å°†æ´»åŠ¨åˆ†ä¸ºåŸºç¡€æ´»åŠ¨ä»¥åŠè¾…åŠ©æ´»åŠ¨ä¸¤å¤§ç±»<ul><li>åŸºç¡€æ´»åŠ¨<ul><li>å†…éƒ¨ç‰©æµæ´»åŠ¨<ul><li>å„ä¸ªéƒ¨é—¨å’Œç¯èŠ‚ä¹‹é—´çš„åˆä½œï¼Œå¦‚ä½•èƒ½ç›´è§‚äº†è§£åˆ°é¡¹ç›®çš„è¿›å±•æ­¤ç±»é—®é¢˜</li></ul></li><li>ç”Ÿäº§ç»è¥æ´»åŠ¨<ul><li>ç”Ÿäº§ é”€å”®  ä¾›åº” è´¢åŠ¡</li></ul></li><li>å¤–éƒ¨ç‰©æµæ´»åŠ¨<ul><li>è´§ç‰©çš„å‘¨è½¬</li><li>æŠ¥å…³ æŠ¥æ£€ æŸ¥éªŒ æ¸…å…³ ç¼´ç¨ç­‰</li></ul></li><li>æœåŠ¡æ€§æ´»åŠ¨</li></ul></li><li>è¾…åŠ©æ´»åŠ¨<ul><li>äººåŠ›èµ„æºç®¡ç†æ´»åŠ¨</li><li>æ”¹å–„åŸºç¡€è®¾æ–½æ¡ä»¶çš„æ´»åŠ¨</li><li>åŸææ–™é‡‡è´­æ´»åŠ¨</li><li>æ–°äº§å“ç ”å‘æ´»åŠ¨ç­‰</li></ul></li></ul></li><li>åªæœ‰åœ¨ä¸€äº›ç‰¹å®šç¯èŠ‚ï¼Œæ‰ä¼šçœŸçš„å»åˆ›é€ ä»·å€¼ï¼Œè¿™äº›æ˜¯æˆ˜ç•¥ç¯èŠ‚ï¼Œéœ€è¦åœ¨æ­¤æ„å»ºæˆ˜ç•¥ä¼˜åŠ¿</li></ul></li></ul><h1 id="4-Other-Notes"><a href="#4-Other-Notes" class="headerlink" title="4. Other Notes"></a>4. Other Notes</h1><ul><li><p>ä¼ä¸šæˆ˜ç•¥</p><ul><li>ç”¨äºæ•´åˆä¸é‡æ–°ä¼˜åŒ–é…ç½®çš„æªæ–½åŠå¯è¡Œæ€§æ–¹æ¡ˆ</li><li>ä¼ä¸šç»„ç»‡ç»“æ„è¦è·Ÿéšä¼ä¸šæˆ˜ç•¥è¿›è¡Œè°ƒæ•´</li></ul></li><li><p>å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç«äº‰æˆ˜ç•¥</p><ul><li>å¯¹æœ‰å¸å¼•åŠ›ï¼Œé«˜æ½œåŠ›çš„äº§ä¸šçš„æ­£ç¡®é€‰æ‹©</li><li>åœ¨é€‰æ‹©çš„è¡Œä¸šå½“ä¸­ç¡®ç«‹è‡ªå·±çš„ç«äº‰ä¼˜åŠ¿åœ°ä½</li><li>é™¤æ­¤ä»¥å¤–è¿˜éœ€è¦ä»ä¼ä¸šå†…éƒ¨ç¯å¢ƒï¼Œç ”ç©¶ä»·å€¼é“¾</li></ul></li><li><p>ä¼ä¸šå†…éƒ¨æ€§çš„æ·±å…¥ç ”ç©¶ â€” ä¼ä¸šæ ¸å¿ƒèƒ½åŠ›</p><ul><li>è®©ä¼ä¸šæ„æˆå…¶ä»–ä¼ä¸šå¹¶ä¸å…·å¤‡çš„èƒ½åŠ›ï¼ŒåŒæ—¶èµ„æºæ— æ³•åœ¨ä¸åŒçš„ä¼ä¸šä¹‹é—´è¿›è¡Œæµé€š</li><li>ä¼ä¸šå†…éƒ¨çš„èµ„æºçš„ç‹¬ç‰¹æ€§ï¼Œç›´æ¥å…³ç³»åˆ°ä¼ä¸šåˆ©æ¶¦çš„è·å¾—ä»¥åŠç«äº‰ä¼˜åŠ¿çš„ä¿æŒ</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>1.<a href="https://www.52by.com/article/2584">https://www.52by.com/article/2584</a><br>2. ã€Šå°å‹å›½é™…è´§è¿ä»£ç†Xå…¬å¸çš„å‘å±•æˆ˜ç•¥ç ”ç©¶ã€‹</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è´§è¿ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>System Design Patterns - Quorum</title>
      <link href="/System-Design-Patterns-Quorum/"/>
      <url>/System-Design-Patterns-Quorum/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a>1. Background</h1><p>In distributed system, data is replicated across multiple servers for fault tolerance and high availability.</p><p>Once system decides to maintain multiple copies of data, another problem arises: how to make sure that all replicas are consistent?? </p><h1 id="2-Dive-Deep"><a href="#2-Dive-Deep" class="headerlink" title="2. Dive Deep"></a>2. Dive Deep</h1><h2 id="2-1-Definition"><a href="#2-1-Definition" class="headerlink" title="2.1 Definition"></a>2.1 Definition</h2><ul><li>Quorum<ul><li>Minimum number of servers on which a distributed operation needs to be performed successfully before declaring the operationâ€™s overall success</li></ul></li></ul><h2 id="2-2-How-it-works"><a href="#2-2-How-it-works" class="headerlink" title="2.2 How it works?"></a>2.2 How it works?</h2><ul><li>Suppose a database is replicated on 5 machines, then quorum refers to the minimum number of machines that perform the same action for a given transaction in order to decide the final operation for that transaction</li><li>So in a set of 5, three machines form the majority quorum, quorum <strong>enforces the consistency requirement</strong> needed for distributed operations</li><li>Quorum Number<ul><li>N / 2 + 1</li></ul></li><li>Quorum is achieved when nodes follow the below protocol R + W &gt; N<ul><li>R  minimum read nodes</li><li>W minimum write nodes</li><li>N  nodes in the quorum group</li></ul></li></ul><h2 id="2-3-Where-is-it-used"><a href="#2-3-Where-is-it-used" class="headerlink" title="2.3 Where is it used?"></a>2.3 Where is it used?</h2><ul><li>Chubby<ul><li>Use paxos for leader election, which use quorum to ensure strong consistency</li></ul></li><li>Cassandra<ul><li>Ensure data consistency, each write request can be configured to be successful only if the data has been written to at least a quorum of replica nodes</li></ul></li><li>Dynamodb<ul><li>Writes to a sloppy quorum of other nodes in the system</li><li>All read/ write operations are performed on the first N healthy nodes from the preference list, which may not always be the first N nodes encountered walking the consistent hashing ring</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>System Design Patterns - Bloom Filters</title>
      <link href="/System-Design-Patterns-Bloom-Filters/"/>
      <url>/System-Design-Patterns-Bloom-Filters/</url>
      
        <content type="html"><![CDATA[<h1 id="System-Design-Patterns-Bloom-Filters"><a href="#System-Design-Patterns-Bloom-Filters" class="headerlink" title="System Design Patterns - Bloom Filters"></a>System Design Patterns - Bloom Filters</h1><p>Created: August 8, 2021 10:06 PM<br>Status: Finished<br>Tags: System Design<br>Type: Tech Resource</p><h1 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a>1. Background</h1><ul><li>Suppose we have a large set of structured data(identified by record IDs) stored in a set of data files, and we want to know which file might contain our required data<ul><li>we donâ€™t want to read each file, as itâ€™s slow and we have to read a lot of data from the disk</li></ul></li><li>Solution 1: Build an index on each data file and store it in a separate index file, to map each record ID to its offset in the data file; each index file will be sorted on the record ID. Then we could do a binary search in index file</li><li>Solution 2: We could use Bloom Filters</li></ul><h1 id="2-How-does-Bloom-Filter-work"><a href="#2-How-does-Bloom-Filter-work" class="headerlink" title="2. How does Bloom Filter work?"></a>2. How does Bloom Filter work?</h1><ul><li>The Bloom filter data structure tells whether an element <strong>may be in a set, or definitely is not</strong><ul><li>which means the only possible errors are false positives</li></ul></li><li>How it looks<ul><li>An empty bloom filter is a bit array of m bits, all set to 0</li><li>There are also k different hash functions, each of which maps a set element to one of the m bit positions</li></ul></li><li>Workflow<ul><li>To add an element, feed it to the hash functions to get k bit positions, and set the bits at these positions to 1</li><li>To test if an element is in the set, feed it to the hash functions to get k bit positions<ul><li>if any of the bits at these positions is 0, the element is definitely not in the set</li><li>if all are 1, then the element may be in the set</li></ul></li></ul></li></ul><h1 id="3-When-will-we-use-Bloom-Filter"><a href="#3-When-will-we-use-Bloom-Filter" class="headerlink" title="3. When will we use Bloom Filter?"></a>3. When will we use Bloom Filter?</h1><ul><li>In BigTable, any read operation has to read from all SSTables that make up a tablet<ul><li>if these SSTables are not in memory, the read operation may end up doing many disk accesses</li><li>BigTable uses bloom filters to reduce the number of disk accesses</li><li>Store of BloomFilter could drastically reduces the number of disk seeks, thereby improving read performance</li></ul></li></ul><h1 id="4-How-to-use-Bloom-Filter-in-Java"><a href="#4-How-to-use-Bloom-Filter-in-Java" class="headerlink" title="4. How to use Bloom Filter in Java?"></a>4. How to use Bloom Filter in Java?</h1><ul><li>We could use BloomFilter class from the Guava library to achieve this</li></ul><pre><code class="jsx">BloomFilter&lt;Integer&gt; filter = BloomFilter.create(    Funnels.integerFunnel(),     500,     0.01);</code></pre><ul><li>How to implement from scratch   <a href="https://www.inlighting.org/archives/java-implement-bloom-filter/">https://www.inlighting.org/archives/java-implement-bloom-filter/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redisé›†åˆç»Ÿè®¡æ¨¡å¼</title>
      <link href="/Redis%E9%9B%86%E5%90%88%E7%BB%9F%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/Redis%E9%9B%86%E5%90%88%E7%BB%9F%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="Redisé›†åˆç»Ÿè®¡æ¨¡å¼"><a href="#Redisé›†åˆç»Ÿè®¡æ¨¡å¼" class="headerlink" title="Redisé›†åˆç»Ÿè®¡æ¨¡å¼"></a>Redisé›†åˆç»Ÿè®¡æ¨¡å¼</h1><h1 id="1-èšåˆç»Ÿè®¡"><a href="#1-èšåˆç»Ÿè®¡" class="headerlink" title="1. èšåˆç»Ÿè®¡"></a>1. èšåˆç»Ÿè®¡</h1><h2 id="1-1-æ¦‚å¿µ"><a href="#1-1-æ¦‚å¿µ" class="headerlink" title="1.1 æ¦‚å¿µ"></a>1.1 æ¦‚å¿µ</h2><ul><li>ç»Ÿè®¡å¤šä¸ªé›†åˆå…ƒç´ çš„èšåˆç»“æœ<ul><li>äº¤é›†ç»Ÿè®¡ â€” ç»Ÿè®¡å¤šä¸ªé›†åˆçš„å…±æœ‰å…ƒç´ </li><li>å·®é›†ç»Ÿè®¡ â€” ç»Ÿè®¡å…¶ä¸­ä¸€ä¸ªé›†åˆç‹¬æœ‰çš„å…ƒç´ </li><li>å¹¶é›†ç»Ÿè®¡ â€” ç»Ÿè®¡å¤šä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ </li></ul></li><li>èšåˆç»Ÿè®¡å¯ä»¥ä½¿ç”¨Setç±»å‹æ¥åš</li><li>ä½†æ˜¯Setçš„å·®é›†ï¼Œå¹¶é›†ï¼Œäº¤é›†çš„è®¡ç®—å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ‰§è¡Œå¯èƒ½ä¼šå¯¼è‡´Rediså®ä¾‹é˜»å¡ã€‚</li><li>å¯ä»¥ä»ä¸»ä»é›†ç¾¤å½“ä¸­é€‰æ‹©ä¸€ä¸ªä»åº“ï¼Œä½¿å…¶ä¸“é—¨è´Ÿè´£èšåˆè®¡ç®—ï¼Œæˆ–è€…å°†æ•°æ®è¯»å–åˆ°å®¢æˆ·ç«¯ï¼Œåœ¨å®¢æˆ·ç«¯å®Œæˆèšåˆç»Ÿè®¡</li></ul><h2 id="1-2-æ¡ˆä¾‹åˆ†æ"><a href="#1-2-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="1.2 æ¡ˆä¾‹åˆ†æ"></a>1.2 æ¡ˆä¾‹åˆ†æ</h2><ul><li>ç»Ÿè®¡ä¸€ä¸ªæ‰‹æœºAppçš„æ¯å¤©çš„æ–°å¢ç”¨æˆ·æ•°å’Œç¬¬äºŒå¤©çš„ç•™å­˜ç”¨æˆ·æ•°</li><li>ç”¨ä¸€ä¸ªé›†åˆè®°å½•æ‰€æœ‰ç™»é™†è¿‡Appçš„ç”¨æˆ·Id<ul><li>key â€” user:id</li><li>value â€” setç±»å‹ è®°å½•ç”¨æˆ·id</li></ul></li><li>å¦å¤–ä¸€ä¸ªé›†åˆè®°å½•æ¯å¤©ç”¨æˆ·set<ul><li>key â€” user:id:20210808</li><li>value â€” setç±»å‹  è®°å½•ç”¨æˆ·id</li></ul></li></ul><pre><code class="jsx">// å·®å€¼ç»Ÿè®¡SUNIONSTORE user:id user:id user:id:20210808// è®¡ç®—æ–°ç”¨æˆ·SDIFFSTORE user:new user:id:20210808 user:id // è®¡ç®—ç•™å­˜ç”¨æˆ·SINTERSTOPRE user:id:rem user:id:20210808 user:id:20210809</code></pre><h1 id="2-æ’åºç»Ÿè®¡"><a href="#2-æ’åºç»Ÿè®¡" class="headerlink" title="2. æ’åºç»Ÿè®¡"></a>2. æ’åºç»Ÿè®¡</h1><h2 id="2-1-æ¦‚å¿µ"><a href="#2-1-æ¦‚å¿µ" class="headerlink" title="2.1 æ¦‚å¿µ"></a>2.1 æ¦‚å¿µ</h2><ul><li>éœ€è¦èƒ½å¯¹è¾“å‡ºè¿›è¡Œæ’åºï¼ŒRediså¸¸ç”¨çš„4ä¸ªé›†åˆç±»å‹å½“ä¸­ (List, Hash, Set, Sorted Set)ï¼Œ Listå’ŒSorted Setå±äºæœ‰åºé›†åˆ</li><li>ListæŒ‰ç…§å…ƒç´ è¿›å…¥Listçš„é¡ºåºæ’åºï¼Œè€ŒSorted Setå¯ä»¥æ ¹æ®å…ƒç´ çš„æƒé‡æ¥æ’åº</li></ul><h2 id="2-2-æ¡ˆä¾‹"><a href="#2-2-æ¡ˆä¾‹" class="headerlink" title="2.2 æ¡ˆä¾‹"></a>2.2 æ¡ˆä¾‹</h2><ul><li>ç”µå•†ç½‘ç«™ä¸Šæä¾›æœ€æ–°è¯„è®ºåˆ—è¡¨çš„åœºæ™¯</li><li>Liståœ¨è¿™ä¸ªåœºæ™¯é‡Œé¢çš„é—®é¢˜<ul><li>å› ä¸ºæ ¹æ®ä½ç½®æ’åºï¼Œå½“æœ‰æ–°çš„è¯„ä»·åŠ è¿›æ¥ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæœ‰ä¸€äº›è¯„ä»·ä¼šåœ¨ä¸åŒé¡µé¢é‡å¤å‡ºç°</li></ul></li><li>Sorted Setä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒæ˜¯æ ¹æ®å…ƒç´ çš„å®é™…æƒé‡æ¥æ’åºå’Œè·å–æ•°æ®çš„<ul><li>æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¯„è®ºæ—¶é—´çš„å…ˆåç»™æ¯æ¡è¯„è®ºè®¾ç½®ä¸€ä¸ªæƒé‡å€¼ï¼Œç„¶åå°†è¯„è®ºä¿å­˜åˆ°Sorted Setå½“ä¸­</li><li>ZRANGEBYSCOREå‘½ä»¤å°±å¯ä»¥æŒ‰ç…§æƒé‡æ’åºä»¥åè¿”å›å…ƒç´ </li></ul></li></ul><h1 id="3-äºŒå€¼çŠ¶æ€ç»Ÿè®¡"><a href="#3-äºŒå€¼çŠ¶æ€ç»Ÿè®¡" class="headerlink" title="3. äºŒå€¼çŠ¶æ€ç»Ÿè®¡"></a>3. äºŒå€¼çŠ¶æ€ç»Ÿè®¡</h1><h2 id="3-1-æ¦‚å¿µ"><a href="#3-1-æ¦‚å¿µ" class="headerlink" title="3.1 æ¦‚å¿µ"></a>3.1 æ¦‚å¿µ</h2><ul><li>æŒ‡é›†åˆå…ƒç´ çš„å–å€¼åªæœ‰0å’Œ1ä¸¤ç§</li><li>è®¡ç®—æµ·é‡äºŒå€¼çŠ¶æ€æ•°æ®çš„æ—¶å€™ï¼Œbitmapå¯ä»¥æœ‰æ•ˆå‡å°‘æ‰€éœ€çš„å†…å­˜ç©ºé—´</li></ul><h2 id="3-2-æ¡ˆä¾‹"><a href="#3-2-æ¡ˆä¾‹" class="headerlink" title="3.2 æ¡ˆä¾‹"></a>3.2 æ¡ˆä¾‹</h2><ul><li>ç­¾åˆ°ç»Ÿè®¡<ul><li>æ¯ä¸ªç”¨æˆ·ä¸€å¤©çš„ç­¾åˆ°ç”¨ä¸€ä¸ªbitä½å°±èƒ½è¡¨ç¤º</li><li>å› æ­¤å¹¶ä¸éœ€è¦éå¸¸å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œä½¿ç”¨bitmapå°±å¯ä»¥äº†</li></ul></li><li>Redisæä¾›äº†Bitmapç±»å‹<ul><li>GETBIT</li><li>SETBIT<ul><li>å°†æŸä¸€ä½è®¾ç½®ä¸º1</li></ul></li><li>BITCOUNT<ul><li>ç”¨æ¥ç»Ÿè®¡æ‰€æœ‰1çš„ä¸ªæ•°</li></ul></li></ul></li></ul><pre><code class="jsx">// è®°å½•ç”¨æˆ·8 3 ç­¾åˆ°äº†SETBIT uid:sign:3000:202008 2 1 // æ£€æŸ¥æ˜¯å¦8 3 ç­¾åˆ°äº†GETBIT uid:sign:3000:202008 2 // ç»Ÿè®¡è¯¥ç”¨æˆ·8æœˆä»½çš„ç­¾åˆ°æ¬¡æ•°BITCOUNT uid:sign:3000:202008 </code></pre><ul><li>å¦‚ä½•ç»Ÿè®¡ä¸€äº¿ä¸ªç”¨æˆ·è¿ç»­10å¤©çš„ç­¾åˆ°æƒ…å†µ<ul><li>å°†æ¯å¤©æ—¥æœŸä½œä¸ºkeyï¼Œæ¯ä¸ªkeyå¯¹åº”ä¸€ä¸ª1äº¿ä½çš„bitmap  æ¯ä¸€ä¸ªbitå¯¹åº”ä¸€ä¸ªç”¨æˆ·å½“å¤©çš„ç­¾åˆ°æƒ…å†µ</li><li>å¯¹10ä¸ªbitmapåšä¸æ“ä½œ</li><li>ç„¶åç”¨BITCOUNTç»Ÿè®¡ä¸‹æœ€ç»ˆç”Ÿæˆçš„Bitmapå½“ä¸­1çš„ä¸ªæ•°</li></ul></li></ul><h1 id="4-åŸºæ•°ç»Ÿè®¡"><a href="#4-åŸºæ•°ç»Ÿè®¡" class="headerlink" title="4. åŸºæ•°ç»Ÿè®¡"></a>4. åŸºæ•°ç»Ÿè®¡</h1><h2 id="4-1-æ¦‚å¿µ"><a href="#4-1-æ¦‚å¿µ" class="headerlink" title="4.1 æ¦‚å¿µ"></a>4.1 æ¦‚å¿µ</h2><ul><li>åŸºæ•°ç»Ÿè®¡æŒ‡ç»Ÿè®¡ä¸€ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ çš„ä¸ªæ•°</li></ul><h2 id="4-2-æ¡ˆä¾‹"><a href="#4-2-æ¡ˆä¾‹" class="headerlink" title="4.2 æ¡ˆä¾‹"></a>4.2 æ¡ˆä¾‹</h2><ul><li>ç»Ÿè®¡ä¸€ä¸ªç½‘é¡µçš„UV<ul><li>éœ€è¦å»é‡ï¼Œä¸€ä¸ªç”¨æˆ·ä¸€å¤©å†…çš„å¤šæ¬¡è®¿é—®åªèƒ½ç®—ä¸€æ¬¡</li></ul></li><li>å¯ä»¥ä½¿ç”¨SETæˆ–è€…HASHç±»å‹æ¥è¿›è¡Œè®°å½•ï¼Œä½†æ˜¯ä¼šæ¶ˆè€—å¾ˆå¤§çš„å†…å­˜ç©ºé—´</li><li>å¯ä»¥ä½¿ç”¨HyperLogLog<ul><li>ç”¨äºç»Ÿè®¡åŸºæ•°çš„æ•°æ®é›†åˆç±»å‹</li><li>ä¼˜åŠ¿åœ¨äºå½“é›†åˆå…ƒç´ æ•°é‡éå¸¸å¤šçš„æ—¶å€™ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”è¿˜å¾ˆå°</li><li>Redisä¸­æ¯ä¸ªHyperLogLogåªéœ€è¦ä½¿ç”¨12KBå†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘2^64ä¸ªå…ƒç´ çš„åŸºæ•°</li></ul></li><li>HyperLogLogçš„ç»Ÿè®¡è§„åˆ™æ˜¯åŸºäºæ¦‚ç‡å®Œæˆçš„ï¼Œå› æ­¤å…¶ç»™å‡ºçš„ç»Ÿè®¡ç»“æœæ˜¯æœ‰ä¸€å®šè¯¯å·®çš„ï¼Œæ ‡å‡†è¯¯ç®—ç‡ä¸º0.81% ; å¦‚æœåº”ç”¨åœºæ™¯æ˜¯å¿…é¡»éå¸¸ç²¾ç¡®ï¼Œé‚£å°±è¿˜éœ€è¦ä½¿ç”¨Setæˆ–è€…Hashç±»å‹</li></ul><pre><code class="jsx">PFADD page1:uv  user1 user2 user3 user4 PFCOUNT page1:uv </code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DynamoDB Architecture (Paper Reading)</title>
      <link href="/DynamoDB-Architecture-Paper-Reading/"/>
      <url>/DynamoDB-Architecture-Paper-Reading/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>Designed to be always on</li><li>Dynamo falls within the category of AP systems (available and partition tolerant) and is designed for high availability and partition tolerance at the expense of strong consistency</li></ul><h2 id="1-1-Design-Goals"><a href="#1-1-Design-Goals" class="headerlink" title="1.1 Design Goals"></a>1.1 Design Goals</h2><ul><li>Scalable<ul><li>System need to be highly scalable. We should be able to throw a machine into the system to see proportional improvement</li></ul></li><li>Decentralized<ul><li>To avoid single points of failures and performance bottlenecks, there should not be any central/ leader process</li></ul></li><li>Eventually Consistent<ul><li>Data can be optimistically replicated to become eventually consistent</li></ul></li></ul><h2 id="1-2-Use-cases"><a href="#1-2-Use-cases" class="headerlink" title="1.2 Use cases"></a>1.2 Use cases</h2><ul><li>eventually consistent database</li></ul><h2 id="1-3-System-APIs"><a href="#1-3-System-APIs" class="headerlink" title="1.3 System APIs"></a>1.3 System APIs</h2><ul><li>put(key, context, object)<ul><li>find the nodes where the object associated with the given key should locate</li><li>context is a value that is returned with a get operation and then sent back with the put operation</li><li>context is always stored along with the object</li><li>used like a cookie to verify the validity of the object supplied in the put request</li></ul></li><li>get(key)<ul><li>find the nodes where the object associated with the given key is located</li><li>return a single object or a list of objects with conflicting versions along with a context</li><li>context contains encoded metadata about the object, and <strong>version of the object</strong></li></ul></li></ul><h1 id="2-High-Level-Design"><a href="#2-High-Level-Design" class="headerlink" title="2. High Level Design"></a>2. High Level Design</h1><h2 id="2-1-Data-Distribution"><a href="#2-1-Data-Distribution" class="headerlink" title="2.1 Data Distribution"></a>2.1 Data Distribution</h2><h3 id="2-1-1-What-is-it"><a href="#2-1-1-What-is-it" class="headerlink" title="2.1.1 What is it"></a>2.1.1 What is it</h3><ul><li>Consistent hashing to distribute its data among nodes</li><li>Also make it easy to add/ remove nodes from a dynamo cluster</li></ul><h3 id="2-1-2-Challenge"><a href="#2-1-2-Challenge" class="headerlink" title="2.1.2 Challenge"></a>2.1.2 Challenge</h3><ul><li>how do we know on which node a particular piece of data will be stored?</li><li>when we add/ remove nodes, how do we know what data will be moved from existing nodes to the new nodes?</li><li>how can we minimize data movement when nodes join or leave?</li></ul><h3 id="2-1-3-Consistent-Hashing"><a href="#2-1-3-Consistent-Hashing" class="headerlink" title="2.1.3 Consistent Hashing"></a>2.1.3 Consistent Hashing</h3><ul><li><p>Represents the data managed by a cluster as a ring</p></li><li><p>Each node in the ring is assigned a range of data</p></li><li><p>Token</p><ul><li><p>The start of the range is called a token</p></li><li><p>each node will be assigned with one token</p><p>  <img src="https://i.loli.net/2021/08/08/8jFPMEDNmn4cXaf.png" alt=""></p></li></ul></li><li><p>Process for a put or get request</p><ul><li>DDB performs a MD5 hashing algorithm to the key</li><li>Output determines within which range the data lies â€”â†’ which node the data will be stored</li></ul></li><li><p>Problems for only use physical nodes</p><ul><li>for adding or removing nodes, it only influence the next node, but it would cause uneven distribution of traffic</li><li>recomputing the tokens causing a significant administrative overhead for a large cluster</li><li>Since each node is assigned one large range, if the data is not evenly distributed, some nodes can become hotspots</li><li>Since each nodeâ€™s data is replicated on a fixed number of nodes (discussed later), when we need to rebuild a node, only its replica nodes can provide the data. This puts a lot of pressure on the replica nodes and can lead to service degradation</li></ul></li></ul><h3 id="2-1-4-Virtual-Nodes"><a href="#2-1-4-Virtual-Nodes" class="headerlink" title="2.1.4 Virtual Nodes"></a>2.1.4 Virtual Nodes</h3><p><img src="https://i.loli.net/2021/08/08/YWwxt9eMmToQ3qn.png" alt=""></p><ul><li><p>Hash range is divided into multiple smaller ranges, and each physical node is assigned multiple of these smaller ranges</p></li><li><p>Each of these subranges is called a Vnode</p></li><li><p>Vnodes are randomly distributed across the cluster and are generally non contiguous (ä¸è¿ç»­çš„)</p><p>  <img src="https://i.loli.net/2021/08/08/RVgrPm8T19nbKZB.png" alt=""></p></li><li><p>Benefits of Vnodes</p><ul><li>Help spread the load more evenly across the physical nodes on the cluster by dividing the hash range into smaller subranges<ul><li>speeds up the rebalancing process after adding or removing nodes</li><li>When a new node is added, it receives many Vnodes from the existing nodes to maintain a balanced cluster. Similarly, when a node needs to be rebuilt, instead of getting data from a fixed number of replicas, many nodes participate in the rebuild process.</li></ul></li><li>Vnodes make it easier to maintain a cluster containing heterogeneous machines. This means, with Vnodes, we can assign a high number of ranges to a powerful server and a lower number of ranges to a less powerful server</li><li>Since Vnodes help assign smaller ranges to each physical node, the probability of hotspots is much less than the basic Consistent Hashing scheme which uses one big range per node</li></ul></li></ul><h2 id="2-2-Data-Replication-and-Consistency"><a href="#2-2-Data-Replication-and-Consistency" class="headerlink" title="2.2 Data Replication and Consistency"></a>2.2 Data Replication and Consistency</h2><ul><li>Data is replicated optimistically</li><li>Dynamo provides eventual consistency</li></ul><h3 id="2-2-1-Optimistic-Replication"><a href="#2-2-1-Optimistic-Replication" class="headerlink" title="2.2.1 Optimistic Replication"></a>2.2.1 Optimistic Replication</h3><ul><li><p>To ensure high availability and durability, Dynamo replicates each data item on multiple N nodes in the system where the value N is equivalent to the <strong>replication factor</strong>, also is configured per instance of Dynamo</p></li><li><p>Each key is assigned to a coordinator node, which first stores the data locally and then replicates it to N-1 clockwise successor nodes on the ring</p><ul><li>Thus each node owns the region on the ring between it and its Nth predecessor</li></ul></li><li><p>Replication is done asynchronously and Dynamo provides an eventually consistent model</p></li><li><p>Itâ€™s called optimistic replication, as the replicas are not guaranteed to be identical at all times</p><p>  <img src="https://i.loli.net/2021/08/08/QaHhmPTI6XcYfwu.png" alt=""></p></li><li><p>Preference List</p><ul><li>List of nodes responsible for storing a particular key</li><li>Dynamo is designed so that every node in the system can determine which nodes should be in the list for any specific key</li><li>The list contains more than N nodes to account for failures and skip virtual nodes on the ring so that the list only contains distinct physical nodes</li></ul></li></ul><h2 id="2-3-Handling-Temporary-Failures"><a href="#2-3-Handling-Temporary-Failures" class="headerlink" title="2.3 Handling Temporary Failures"></a>2.3 Handling Temporary Failures</h2><ul><li>To handle temporary failures, dynamo replicates data to a <strong>sloppy quorum</strong> of other nodes in the system instead of a strict majority quorum</li></ul><h3 id="2-3-1-Quorum-Approach"><a href="#2-3-1-Quorum-Approach" class="headerlink" title="2.3.1 Quorum Approach"></a>2.3.1 Quorum Approach</h3><ul><li>Traditional quorum approach<ul><li>any distributed system becomes unavailable during server failures or network partitions and would have reduced availability even under simple failure conditions</li></ul></li><li>Sloppy quorum<ul><li>all read/ write operations are performed on the first N healthy nodes from the preference list. may not always be the first N nodes encountered while moving clockwise on the consistent hashing ring</li></ul></li></ul><h3 id="2-3-2-Hinted-Handoff"><a href="#2-3-2-Hinted-Handoff" class="headerlink" title="2.3.2 Hinted Handoff"></a>2.3.2 Hinted Handoff</h3><ul><li>When a node is unreachable, another node can accept writes on its behalf</li><li>Write is then kept in a local buffer and sent out once the destination node is reachable again</li><li>Problem<ul><li>Sloppy quorum is not a strict majority, the data can and will diverge</li><li>It is possible for two concurrent writes to the same key to be accepted by non-overlapping sets of nodes. This means that multiple conflicting values against the same key can exist in the system, and we can get stale or conflicting data while reading. Dynamo allows this and resolves these conflicts using Vector Clocks.</li></ul></li></ul><h2 id="2-4-Inter-node-communication-and-failure-detection"><a href="#2-4-Inter-node-communication-and-failure-detection" class="headerlink" title="2.4 Inter node communication and failure detection"></a>2.4 Inter node communication and failure detection</h2><ul><li>Use gossip protocol to keep track of the cluster state</li></ul><h3 id="2-4-1-Gossip-Protocol"><a href="#2-4-1-Gossip-Protocol" class="headerlink" title="2.4.1 Gossip Protocol"></a>2.4.1 Gossip Protocol</h3><ul><li><p>Enable each node to keep track of state information about the other nodes in the cluster</p><ul><li>which nodes are reachable</li><li>what key ranges they are responsible for</li></ul></li><li><p>Gossip Protocol</p><ul><li><p>Peer to peer communication mechanism</p></li><li><p>nodes periodically exchange state information about themselves and other nodes they know about</p></li><li><p>each node initiate a gossip round every second with a random node</p><p>  <img src="https://i.loli.net/2021/08/08/hgBPER5e2kuxvMw.png" alt=""></p></li></ul></li><li><p>External discovery through seed nodes</p><ul><li>An administrator joins node A to the ring and then joins node B to the ring. Nodes A and B consider themselves part of the ring, yet neither would be immediately aware of each other. To prevent these logical partitions, Dynamo introduced the concept of seed nodes. Seed nodes are fully functional nodes and can be obtained either from a static configuration or a configuration service. This way, all nodes are aware of seed nodes. Each node communicates with seed nodes through gossip protocol to reconcile membership changes; therefore, logical partitions are highly unlikely.</li></ul></li></ul><h2 id="2-5-Conflict-Resolution-and-Handling-permanent-failures"><a href="#2-5-Conflict-Resolution-and-Handling-permanent-failures" class="headerlink" title="2.5 Conflict Resolution and Handling permanent failures"></a>2.5 Conflict Resolution and Handling permanent failures</h2><h3 id="2-5-1-Clock-Skew"><a href="#2-5-1-Clock-Skew" class="headerlink" title="2.5.1 Clock Skew"></a>2.5.1 Clock Skew</h3><ul><li>Dynamo resolves potential conflicts using below mechanisms<ul><li>use vector clocks to keep track of value history and reconcile divergent histories at read time</li><li>in the background, dynamo use an <strong>anti entropy mechanism</strong> like <strong>Merkle trees</strong> to handle permanent failures</li></ul></li></ul><h3 id="2-5-2-Vector-Clock"><a href="#2-5-2-Vector-Clock" class="headerlink" title="2.5.2 Vector Clock"></a>2.5.2 Vector Clock</h3><ul><li><p>Used to capture causality between different versions of the same object</p></li><li><p>A vector clock is a <code>node, counter</code> pair</p></li><li><p>Each version of every object associate with a vector clock</p><ul><li>one can determine whether two versions of an object are on parallel branches or have a causal ordering by examining vector clocks</li><li>If the counters on the first objectâ€™s clock are less-than-or-equal to all of the nodes in the second clock, then the first is an ancestor of the second and can be forgotten. Otherwise, the two changes are considered to be in conflict and require reconciliation.</li></ul></li><li><p>  <img src="https://i.loli.net/2021/08/08/9fKB418IrMezTun.png" alt=""></p></li><li><p>Issue occur when there are network partition, that same data cannot be shared / communicated via different servers</p></li><li><p>In this case, DynamoDB will return it back and let client reads and reconciles</p></li></ul><h3 id="2-5-3-Conflict-free-replicated-data-types-CRDTs"><a href="#2-5-3-Conflict-free-replicated-data-types-CRDTs" class="headerlink" title="2.5.3 Conflict free replicated data types (CRDTs)"></a>2.5.3 Conflict free replicated data types (CRDTs)</h3><ul><li>we need to model our data in such a way that concurrent changes can be applied to the data in any order and will produce the same end result</li></ul><h2 id="2-6-put-and-get-Operations"><a href="#2-6-put-and-get-Operations" class="headerlink" title="2.6 put() and get() Operations"></a>2.6 put() and get() Operations</h2><h3 id="2-6-1-Strategies-for-choosing-the-coordinator-node"><a href="#2-6-1-Strategies-for-choosing-the-coordinator-node" class="headerlink" title="2.6.1 Strategies for choosing the coordinator node"></a>2.6.1 Strategies for choosing the coordinator node</h3><ul><li><p>Strategies</p><p>  <img src="https://i.loli.net/2021/08/08/MB8qFbQGdwhoZAJ.png" alt=""></p><ul><li>Clients can route their requests through a generic load balancer<ul><li>client is unaware of the dynamo ring<ul><li>helps scalability</li><li>make ddb architecture loosely coupled</li></ul></li><li>itâ€™s possible node it select is not part of the perference list, this will result in an extra hop</li></ul></li><li>Clients can use a partition aware client library that routes the request to the appropriate coordinator nodes with lower latency<ul><li>helps to achieve lower latency  â€” achieve zero hop</li><li>DDB doesnâ€™t have much control over the load distribution and request handling</li></ul></li></ul></li></ul><h3 id="2-6-2-Consistency-Protocol"><a href="#2-6-2-Consistency-Protocol" class="headerlink" title="2.6.2 Consistency Protocol"></a>2.6.2 Consistency Protocol</h3><ul><li>R W is the min number of nodes that must participate in a successful read/ write operation</li><li>R + W &gt; N yields a quorun like system</li><li>A Common (N,R,WN, R, WN,R,W) configuration used by Dynamo is (3, 2, 2)</li><li>In general, low values of WWW and RRR increase the risk of inconsistency, as write requests are deemed successful and returned to the clients even if a majority of replicas have not processed them. This also introduces a vulnerability window for durability when a write request is successfully returned to the client even though it has been persisted at only a small number of nodes</li></ul><h3 id="2-6-3-put-process"><a href="#2-6-3-put-process" class="headerlink" title="2.6.3  put() process"></a>2.6.3  <code>put()</code> process</h3><ul><li>the coordinator generates a new data version and vector clock component</li><li>saves new data locally</li><li>sends the write request to N-1 highest ranked healthy nodes from the preference list</li><li>the put() operation is considered successful after receiving W - 1 confirmation</li></ul><h3 id="2-6-4-get-process"><a href="#2-6-4-get-process" class="headerlink" title="2.6.4 get() process"></a>2.6.4 <code>get()</code> process</h3><ul><li>coordinator requests the data version from N - 1 highest ranked healthy nodes from the preference list</li><li>waits until R - 1 replies</li><li>coordinator handles causal data versions through a vector clock</li><li>returns all relevant data versions to the caller</li></ul><h3 id="2-6-5-Request-handling-through-state-machine"><a href="#2-6-5-Request-handling-through-state-machine" class="headerlink" title="2.6.5 Request handling through state machine"></a>2.6.5 Request handling through state machine</h3><ul><li>Each client request results in creating a state machine on the node that received the client request</li><li>A read operation workflow would be:<ul><li>send read requests to the nodes</li><li>wait for the minimum number of required responses</li><li>if too few replies were received within a given time limit, fail the request</li><li>otherwise, gather all the data versions and determine the ones to be returned</li><li>if versioning is enabled, perform syntactic reconciliation and generate an opaque write context that contains the vector clock that subsumes all the remaining versions</li><li>At this point, read response has been returned to the caller</li><li>the state machine waits for a short period to receive any outstanding responces</li><li>if stale versions were returned in any of the responses, the coordinator updates those nodes with the latest version â€” READ REPAIR</li></ul></li></ul><h2 id="2-7-Anti-entropy-Through-Merkle-Trees"><a href="#2-7-Anti-entropy-Through-Merkle-Trees" class="headerlink" title="2.7 Anti-entropy Through Merkle Trees"></a>2.7 Anti-entropy Through Merkle Trees</h2><ul><li>Vector clocks are useful to remove conflicts while serving read requests</li><li>But if a replica falls significantly behind others, it might take a very long time to resolve conflicts using just vector clocks</li></ul><hr><p>â€”&gt; we need to quickly compare two copies of a range of data residing on different replicas and figure out exactly which parts are different </p><h3 id="2-7-1-What-are-MerkleTrees"><a href="#2-7-1-What-are-MerkleTrees" class="headerlink" title="2.7.1 What are MerkleTrees?"></a>2.7.1 What are MerkleTrees?</h3><ul><li><p>Dynamo use Merkel Trees to compare replicas of a range</p></li><li><p>A merkle tree is a binary tree of hashes, where each internal node is the hash of its two children, each leaf node is a hash of a portion of the original data</p></li><li><p>Then compare the merkle tree come to be super easy, just compare the root hashes of both trees, if equal, then stop; else, recurse on the left and right children</p></li><li><p>The principal advantage of using a Merkle tree is that each branch of the tree can be checked independently without requiring nodes to download the entire tree or the whole data set. Hence, Merkle trees minimize the amount of data that needs to be transferred for synchronization and reduce the number of disk reads performed during the anti-entropy process.</p></li><li><p>The disadvantage of using Merkle trees is that many key ranges can change when a node joins or leaves, and as a result, the trees need to be recalculated.</p></li></ul><h2 id="2-8-Dynamo-Characteristics"><a href="#2-8-Dynamo-Characteristics" class="headerlink" title="2.8 Dynamo Characteristics"></a>2.8 Dynamo Characteristics</h2><h3 id="2-8-1-Dynamoâ€™s-Node-Responsibilities"><a href="#2-8-1-Dynamoâ€™s-Node-Responsibilities" class="headerlink" title="2.8.1 Dynamoâ€™s Node Responsibilities"></a>2.8.1 Dynamoâ€™s Node Responsibilities</h3><ul><li>Each node serves three functions:<ul><li>Managing <code>get()</code> and <code>put()</code> requests<ul><li>A node may act as a coordinator and manage all operations for a particular key</li><li>A node also could forward the request to the appropriate node</li></ul></li></ul></li><li>Keep track of membership and detecting failures<ul><li>Every node uses gossip protocol to keep track of other nodes in the system and their associated hash ranges</li></ul></li><li>Local persistent storage<ul><li>Each node is responsible for being either the primary or replica store for keys that hash to a specific range of values</li><li>These pairs are stored within that node using various storage systems depending on application needs</li><li>E.G<ul><li>BerkeleyDB Transactional Data Store</li><li>MySQL</li><li>In memory buffer backed by persistent storage</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DynamoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“ç´¢å¼•</title>
      <link href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95/"/>
      <url>/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç´¢å¼•çš„å®ç°ï¼Œåº•å±‚ä¸€èˆ¬ä¼šä¾èµ–äºå“ªäº›æ•°æ®ç»“æ„ï¼Ÿ</p></blockquote><h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦ç´¢å¼•"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦ç´¢å¼•" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦ç´¢å¼•"></a>1. ä¸ºä»€ä¹ˆéœ€è¦ç´¢å¼•</h1><ul><li>ä¸ºäº†èƒ½å¤Ÿå°½å¿«å¾—åˆ°æƒ³è¦çš„æ•°æ® â€” æé«˜æ€§èƒ½</li><li>é€‰å–é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œåœ¨é’ˆå¯¹è®¿é—®ç‰¹æ€§æœ‰æ¯”è¾ƒå¥½çš„è®¿é—®é€Ÿåº¦çš„åŒæ—¶ï¼Œå‡å°‘ç©ºé—´ä¸Šçš„å ç”¨<ul><li>å¦‚ä½•èŠ‚çœå­˜å‚¨ç©ºé—´</li><li>å¦‚ä½•æé«˜æ•°æ®å¢åˆ æ”¹æŸ¥çš„æ‰§è¡Œæ•ˆç‡</li></ul></li></ul><h1 id="2-åŠŸèƒ½æ€§éœ€æ±‚"><a href="#2-åŠŸèƒ½æ€§éœ€æ±‚" class="headerlink" title="2. åŠŸèƒ½æ€§éœ€æ±‚"></a>2. åŠŸèƒ½æ€§éœ€æ±‚</h1><ul><li>æ ¼å¼åŒ–æ•°æ®è¿˜æ˜¯éæ ¼å¼åŒ–æ•°æ®ï¼Ÿ<ul><li>ç»“æ„åŒ–æ•°æ®<ul><li>æ¯”å¦‚MySQLæ•°æ®</li></ul></li><li>éç»“æ„åŒ–æ•°æ®<ul><li>æ¯”å¦‚æœç´¢å¼•æ“å½“ä¸­çš„ç½‘é¡µ</li><li>ä¸€èˆ¬éœ€è¦è¿›è¡Œé¢„å¤„ç†ï¼Œæå–å‡ºæŸ¥è¯¢å…³é”®è¯ï¼Œå¯¹å…³é”®è¯å»ºç«‹ç´¢å¼•</li></ul></li></ul></li><li>é™æ€æ•°æ®è¿˜æ˜¯åŠ¨æ€æ•°æ®ï¼Ÿ<ul><li>é™æ€æ•°æ®<ul><li>æ„å‘³ç€æ²¡æœ‰å¢åˆ æ”¹æŸ¥</li><li>åªéœ€è¦è€ƒè™‘æŸ¥è¯¢æ•ˆç‡å³å¯</li></ul></li><li>åŠ¨æ€æ•°æ®<ul><li>å½“åŸå§‹æ•°æ®æ›´æ–°çš„åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åŠ¨æ€çš„æ›´æ–°ç´¢å¼•</li></ul></li></ul></li><li>ç´¢å¼•å­˜å‚¨åœ¨å†…å­˜è¿˜æ˜¯ç¡¬ç›˜ï¼Ÿ<ul><li>å­˜å‚¨åœ¨å†…å­˜<ul><li>è®¿é—®é€Ÿåº¦å¿«</li><li>åŸå§‹æ•°æ®é‡å¤§çš„å‰æä¸‹ï¼Œå¯¹åº”çš„ç´¢å¼•ä¹Ÿä¼šéå¸¸å¤§</li><li>å› ä¸ºå†…å­˜æœ‰é™ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸å­˜æ”¾åˆ°å†…å­˜å½“ä¸­</li></ul></li><li>å­˜å‚¨åœ¨ç¡¬ç›˜</li><li>éƒ¨åˆ†å­˜å‚¨åœ¨å†…å­˜ï¼Œéƒ¨åˆ†åœ¨ç¡¬ç›˜</li></ul></li><li>å•å€¼æŸ¥æ‰¾è¿˜æ˜¯åŒºé—´æŸ¥æ‰¾<ul><li>å•å€¼æŸ¥æ‰¾<ul><li>æŸ¥è¯¢å…³é”®è¯ç­‰äºæŸä¸ªå€¼çš„æ•°æ®</li></ul></li><li>åŒºé—´æŸ¥æ‰¾<ul><li>æŸ¥æ‰¾å…³é”®è¯å¤„äºæŸä¸ªåŒºé—´å€¼çš„æ•°æ®</li></ul></li></ul></li><li>å•å…³é”®è¯è¿˜æ˜¯å¤šå…³é”®è¯ç»„åˆçš„æŸ¥æ‰¾<ul><li>å¤šå…³é”®è¯æŸ¥è¯¢<ul><li>å¯¹äºç»“æ„åŒ–æ•°æ®çš„ï¼Œ<ul><li>å®ç°é’ˆå¯¹å¤šä¸ªå…³é”®è¯çš„ç»„åˆå»ºç«‹ç´¢å¼•</li></ul></li><li>å¯¹äºéç»“æ„åŒ–æ•°æ®çš„<ul><li>å»ºç«‹é’ˆå¯¹å•ä¸ªå…³é”®è¯çš„ç´¢å¼•</li><li>ç„¶åé€šè¿‡é›†åˆæ“ä½œï¼Œè®¡ç®—å‡ºæŸ¥è¯¢ç»“æœ</li></ul></li></ul></li></ul></li></ul><h1 id="3-éåŠŸèƒ½æ€§éœ€æ±‚"><a href="#3-éåŠŸèƒ½æ€§éœ€æ±‚" class="headerlink" title="3. éåŠŸèƒ½æ€§éœ€æ±‚"></a>3. éåŠŸèƒ½æ€§éœ€æ±‚</h1><ul><li>æ— è®ºå­˜æ”¾åœ¨å†…å­˜è¿˜æ˜¯ç£ç›˜å½“ä¸­ï¼Œå¯¹äºå­˜å‚¨ç©ºé—´çš„æ¶ˆè€—ä¸èƒ½è¿‡å¤§</li><li>åœ¨è€ƒè™‘ç´¢å¼•æŸ¥è¯¢æ•ˆç‡çš„åŒæ—¶ï¼Œè¿˜è¦è€ƒè™‘ç´¢å¼•çš„ç»´æŠ¤æˆæœ¬</li></ul><h1 id="4-æ„å»ºç´¢å¼•å¸¸ç”¨çš„æ•°æ®ç»“æ„"><a href="#4-æ„å»ºç´¢å¼•å¸¸ç”¨çš„æ•°æ®ç»“æ„" class="headerlink" title="4. æ„å»ºç´¢å¼•å¸¸ç”¨çš„æ•°æ®ç»“æ„"></a>4. æ„å»ºç´¢å¼•å¸¸ç”¨çš„æ•°æ®ç»“æ„</h1><ul><li>æ•£åˆ—è¡¨<ul><li>æ„å»ºå†…å­˜ç´¢å¼•</li><li>å¦‚Redis Memcache</li></ul></li><li>çº¢é»‘æ ‘<ul><li>æ„å»ºå†…å­˜ç´¢å¼•</li><li>Extæ–‡ä»¶ç³»ç»Ÿä¸­å¯¹ç£ç›˜å—çš„ç´¢å¼•</li></ul></li><li>B+æ ‘<ul><li>æ¯”èµ·çº¢é»‘æ ‘ï¼Œæ›´é€‚åˆåœ¨ç£ç›˜å½“ä¸­æ„å»ºç´¢å¼•</li><li>å¤šå‰æ ‘ï¼Œæ¯”èµ·çº¢é»‘æ ‘ï¼Œé«˜åº¦æ›´ä½ï¼ŒIOæ›´å°‘</li><li>å¤§éƒ¨åˆ†å…³ç³»å‹æ•°æ®åº“çš„ç´¢å¼•ï¼Œä¼šä½¿ç”¨B+æ ‘æ¥å®ç°<ul><li>MySQL</li><li>Oracle</li></ul></li></ul></li><li>è·³è¡¨<ul><li>Redisä¸­çš„æœ‰åºé›†åˆ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>B+æ ‘</title>
      <link href="/B-%E6%A0%91/"/>
      <url>/B-%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="B-æ ‘"><a href="#B-æ ‘" class="headerlink" title="B+æ ‘"></a>B+æ ‘</h1><h1 id="1-ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ï¼Ÿ"></a>1. ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ï¼Ÿ</h1><h2 id="1-1-æ•°æ®åº“ç´¢å¼•"><a href="#1-1-æ•°æ®åº“ç´¢å¼•" class="headerlink" title="1.1 æ•°æ®åº“ç´¢å¼•"></a>1.1 æ•°æ®åº“ç´¢å¼•</h2><p>å·¥ä½œä¸­ä¸ºäº†åŠ å¿«æ•°æ®åº“ä¸­æ•°æ®çš„æŸ¥æ‰¾é€Ÿåº¦ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„å¤„ç†æ€è·¯æ˜¯å¯¹è¡¨ä¸­æ•°æ®åˆ›å»ºç´¢å¼•ï¼Œè€Œæ•°æ®åº“çš„ç´¢å¼•åº•å±‚å°±ä½¿ç”¨äº†B+æ ‘çš„ç»“æ„</p><p>å¯¹äºæ•°æ®åº“ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ç´¢å¼•å®ç°æŸ¥è¯¢æ•°æ®çš„æ•ˆç‡çš„æå‡ï¼›åŒæ—¶ä¸è¦æ¶ˆè€—å¤ªå¤šçš„å†…å­˜ç©ºé—´ã€‚è€Œæ•°æ®åº“ç´¢å¼•æŸ¥æ‰¾çš„è¿‡ç¨‹å½“ä¸­ï¼Œå…¶ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li>éœ€è¦è¿›è¡Œç›´æ¥æŸ¥æ‰¾</li><li>éœ€è¦æ”¯æŒæŒ‰ç…§ä¸€å®šåŒºé—´çš„å¿«é€ŸæŸ¥æ‰¾</li></ul><h2 id="1-2-Overview"><a href="#1-2-Overview" class="headerlink" title="1.2 Overview"></a>1.2 Overview</h2><ul><li>B + æ ‘ç‰¹å¾<ul><li>æ¯ä¸ªèŠ‚ç‚¹ä¸­å­èŠ‚ç‚¹çš„ä¸ªæ•°ä¸èƒ½è¶…è¿‡ mï¼Œä¹Ÿä¸èƒ½å°äº m/2ï¼›</li><li>æ ¹èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ªæ•°å¯ä»¥ä¸è¶…è¿‡ m/2ï¼Œè¿™æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼›</li><li>m å‰æ ‘åªå­˜å‚¨ç´¢å¼•ï¼Œå¹¶ä¸çœŸæ­£å­˜å‚¨æ•°æ®ï¼Œè¿™ä¸ªæœ‰ç‚¹å„¿ç±»ä¼¼è·³è¡¨ï¼›</li><li>é€šè¿‡é“¾è¡¨å°†å¶å­èŠ‚ç‚¹ä¸²è”åœ¨ä¸€èµ·ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æŒ‰åŒºé—´æŸ¥æ‰¾ï¼›</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ ¹èŠ‚ç‚¹ä¼šè¢«å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå…¶ä»–èŠ‚ç‚¹å­˜å‚¨åœ¨ç£ç›˜ä¸­</li></ul></li><li>Bæ ‘<ul><li>èŠ‚ç‚¹ä¸­å­˜å‚¨æ•°æ®</li><li>å¶å­èŠ‚ç‚¹å¹¶æ²¡æœ‰ä½¿ç”¨é“¾è¡¨æ¥ä¸²è”</li><li>æ˜¯ä¸€ä¸ªæ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ªæ•°ä¸å°‘äºm/2çš„må‰æ ‘</li></ul></li></ul><h1 id="2-ä¸ºä»€ä¹ˆåœ¨æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™ä¼šä½¿ç”¨åˆ°B-æ ‘å‘¢ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆåœ¨æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™ä¼šä½¿ç”¨åˆ°B-æ ‘å‘¢ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆåœ¨æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™ä¼šä½¿ç”¨åˆ°B+æ ‘å‘¢ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆåœ¨æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™ä¼šä½¿ç”¨åˆ°B+æ ‘å‘¢ï¼Ÿ</h1><h2 id="2-1-ä½¿ç”¨äºŒå‰æŸ¥æ‰¾æ ‘æ¥å®ç°ç´¢å¼•ï¼Ÿ"><a href="#2-1-ä½¿ç”¨äºŒå‰æŸ¥æ‰¾æ ‘æ¥å®ç°ç´¢å¼•ï¼Ÿ" class="headerlink" title="2.1 ä½¿ç”¨äºŒå‰æŸ¥æ‰¾æ ‘æ¥å®ç°ç´¢å¼•ï¼Ÿ"></a>2.1 ä½¿ç”¨äºŒå‰æŸ¥æ‰¾æ ‘æ¥å®ç°ç´¢å¼•ï¼Ÿ</h2><ul><li>ä»äºŒå‰æŸ¥æ‰¾æ ‘å¼€å§‹è¯´èµ· æˆ‘ä»¬å¯ä»¥æ”¹ä¸€ä¸‹<ul><li>æ ‘ä¸­çš„èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®æœ¬èº«ï¼Œåªä½œä¸ºç´¢å¼•</li><li>æ¯ä¸ªå¶å­èŠ‚ç‚¹ä¸²åœ¨ä¸€æ¡é“¾è¡¨ä¸Š</li><li>é“¾è¡¨å½“ä¸­çš„æ•°æ®ä»å°åˆ°å¤§æœ‰åº</li></ul></li><li>å¯¹äºåŒºé—´æŸ¥æ‰¾çš„æ”¯æŒç¨‹åº¦<ul><li>å…ˆåœ¨æ ‘ä¸­éå†ï¼Œç„¶ååˆ°å¶å­èŠ‚ç‚¹ä»¥åå†é¡ºç€é“¾è¡¨æ¥å¾€åéå†</li><li>ç›´åˆ°é“¾è¡¨å½“ä¸­çš„ç»“ç‚¹æ•°æ®å€¼å¤§äºåŒºé—´çš„ç»ˆæ­¢å€¼ä¸ºæ­¢</li></ul></li><li>é—®é¢˜<ul><li>å ç”¨çš„å†…å­˜ç©ºé—´éå¸¸å¤§<ul><li>è§£å†³æ–¹æ¡ˆ<ul><li>æ”¾åˆ°ç¡¬ç›˜ä¸Šï¼Œä½†æ˜¯è®¿é—®é€Ÿåº¦ä¼šå˜æ…¢å¾ˆå¤šäº†</li><li>å†…å­˜è®¿é—®é€Ÿåº¦åœ¨çº³ç§’çº§åˆ«</li><li>ç¡¬ç›˜è®¿é—®é€Ÿåº¦åœ¨æ¯«ç§’çº§åˆ«</li></ul></li><li>è§£å†³æ–¹æ¡ˆçš„é—®é¢˜åœ¨äº<ul><li>ç£ç›˜IOæ“ä½œçš„æ¬¡æ•°ç­‰äºæ ‘çš„é«˜åº¦</li><li>æˆ‘ä»¬éœ€è¦å°½å¯èƒ½çš„å‡å°‘æ ‘çš„é«˜åº¦æ¥å‡å°‘ç£ç›˜IOçš„æ¬¡æ•°</li></ul></li></ul></li></ul></li></ul><h2 id="2-2-ä½¿ç”¨må‰æ ‘æ¥å®ç°"><a href="#2-2-ä½¿ç”¨må‰æ ‘æ¥å®ç°" class="headerlink" title="2.2 ä½¿ç”¨må‰æ ‘æ¥å®ç°"></a>2.2 ä½¿ç”¨må‰æ ‘æ¥å®ç°</h2><ul><li>ä½¿ç”¨må‰æ ‘çš„å¥½å¤„<ul><li>å‡å°‘äº†è®¿é—®ç£ç›˜çš„IOæ¬¡æ•°</li></ul></li></ul><pre><code class="jsx">/** * è¿™æ˜¯B+æ ‘éå¶å­èŠ‚ç‚¹çš„å®šä¹‰ã€‚ * * å‡è®¾keywords=[3, 5, 8, 10] * 4ä¸ªé”®å€¼å°†æ•°æ®åˆ†ä¸º5ä¸ªåŒºé—´ï¼š(-INF,3), [3,5), [5,8), [8,10), [10,INF) * 5ä¸ªåŒºé—´åˆ†åˆ«å¯¹åº”ï¼šchildren[0]...children[4] * * må€¼æ˜¯äº‹å…ˆè®¡ç®—å¾—åˆ°çš„ï¼Œè®¡ç®—çš„ä¾æ®æ˜¯è®©æ‰€æœ‰ä¿¡æ¯çš„å¤§å°æ­£å¥½ç­‰äºé¡µçš„å¤§å°ï¼š * PAGE_SIZE = (m-1)*4[keywordsså¤§å°]+m*8[childrenå¤§å°] */public class BPlusTreeNode &#123;  public static int m = 5; // 5å‰æ ‘  public int[] keywords = new int[m-1]; // é”®å€¼ï¼Œç”¨æ¥åˆ’åˆ†æ•°æ®åŒºé—´  public BPlusTreeNode[] children = new BPlusTreeNode[m];//ä¿å­˜å­èŠ‚ç‚¹æŒ‡é’ˆ&#125;/** * è¿™æ˜¯B+æ ‘ä¸­å¶å­èŠ‚ç‚¹çš„å®šä¹‰ã€‚ * * B+æ ‘ä¸­çš„å¶å­èŠ‚ç‚¹è·Ÿå†…éƒ¨èŠ‚ç‚¹æ˜¯ä¸ä¸€æ ·çš„, * å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯å€¼ï¼Œè€ŒéåŒºé—´ã€‚ * è¿™ä¸ªå®šä¹‰é‡Œï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹å­˜å‚¨3ä¸ªæ•°æ®è¡Œçš„é”®å€¼åŠåœ°å€ä¿¡æ¯ã€‚ * * kå€¼æ˜¯äº‹å…ˆè®¡ç®—å¾—åˆ°çš„ï¼Œè®¡ç®—çš„ä¾æ®æ˜¯è®©æ‰€æœ‰ä¿¡æ¯çš„å¤§å°æ­£å¥½ç­‰äºé¡µçš„å¤§å°ï¼š * PAGE_SIZE = k*4[keyw..å¤§å°]+k*8[dataAd..å¤§å°]+8[prevå¤§å°]+8[nextå¤§å°] */public class BPlusTreeLeafNode &#123;  public static int k = 3;  public int[] keywords = new int[k]; // æ•°æ®çš„é”®å€¼  public long[] dataAddress = new long[k]; // æ•°æ®åœ°å€  public BPlusTreeLeafNode prev; // è¿™ä¸ªç»“ç‚¹åœ¨é“¾è¡¨ä¸­çš„å‰é©±ç»“ç‚¹  public BPlusTreeLeafNode next; // è¿™ä¸ªç»“ç‚¹åœ¨é“¾è¡¨ä¸­çš„åç»§ç»“ç‚¹&#125;</code></pre><ul><li>må€¼çš„è®¾å®š<ul><li>æ“ä½œç³»ç»Ÿæ˜¯æŒ‰é¡µæ¥è¯»å–æ•°æ®çš„ï¼Œä¸€é¡µé€šå¸¸å¤§å°ä¸º4KB</li><li>ä¸€æ¬¡ä¼šè¯»å–ä¸€é¡µçš„æ•°æ®</li><li>å¦‚æœè¦è¯»å–çš„æ•°æ®é‡è¶…è¿‡ä¸€é¡µçš„å¤§å°ï¼Œå°±ä¼šè§¦å‘å¤šæ¬¡IOæ“ä½œäº†</li><li>å› æ­¤æˆ‘ä»¬é€‰å®šmå¤§å°çš„æ—¶å€™å°½é‡è®©æ¯ä¸ªèŠ‚ç‚¹çš„å¤§å°ç­‰äºä¸€ä¸ªé¡µçš„å¤§å°</li><li>è¿™æ ·çš„è¯è¯»å–ä¸€ä¸ªèŠ‚ç‚¹åªéœ€è¦ä¸€æ¬¡ç£ç›˜IOæ“ä½œå³å¯</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/11/148A67p9Y3dre2g.png" alt="B+æ ‘æ•°æ®å­˜å‚¨"></p><h2 id="2-3-ç´¢å¼•çš„é—®é¢˜-å¯¼è‡´å†™å…¥æ•ˆç‡ä¸‹é™"><a href="#2-3-ç´¢å¼•çš„é—®é¢˜-å¯¼è‡´å†™å…¥æ•ˆç‡ä¸‹é™" class="headerlink" title="2.3 ç´¢å¼•çš„é—®é¢˜ - å¯¼è‡´å†™å…¥æ•ˆç‡ä¸‹é™"></a>2.3 ç´¢å¼•çš„é—®é¢˜ - å¯¼è‡´å†™å…¥æ•ˆç‡ä¸‹é™</h2><ul><li>æ•°æ®å†™å…¥è¿‡ç¨‹ï¼Œä¼šæ¶‰åŠåˆ°ç´¢å¼•çš„æ›´æ–°ï¼Œè¿™æ˜¯å¯¼è‡´ç´¢å¼•å†™å…¥å˜æ…¢çš„ä¸»è¦åŸå› </li><li>åœºæ™¯æè¿°<ul><li>må€¼æ˜¯æå‰è®¡ç®—å¥½çš„</li><li>å‘æ•°æ®åº“å†™å…¥è¿‡ç¨‹å½“ä¸­ï¼Œæœ‰å¯èƒ½ä¼šä½¿å¾—ç´¢å¼•å½“ä¸­æŸäº›èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„ä¸ªæ•°è¶…è¿‡m</li><li>è¿™ä¸ªèŠ‚ç‚¹çš„å¤§å°è¶…è¿‡ä¸€ä¸ªé¡µçš„å¤§å°ï¼Œé‚£ä¹ˆè¯»å–è¿™æ ·ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´å¤šæ¬¡ç£ç›˜IOæ“ä½œï¼Œè¿™æ˜¯æˆ‘ä»¬æåŠ›é¿å…çš„</li></ul></li><li>è§£å†³æ–¹æ¡ˆ<ul><li>å°†è¿™ä¸ªèŠ‚ç‚¹åˆ†è£‚æˆä¸¤ä¸ªèŠ‚ç‚¹</li><li>è¿™ä¸ªé—®é¢˜ä¼šå‘ä¸Šä¼ å¯¼ï¼Œå³ä¸Šå±‚çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ªæ•°æœ‰å¯èƒ½è¶…è¿‡mä¸ªäº†</li><li>å› æ­¤æˆ‘ä»¬å°±éœ€è¦å‘ä¸Šé€’å½’æ¥é‡æ„è¿™æ£µB+æ ‘äº†</li><li>æ­£æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦ä¿è¯B+æ ‘ç´¢å¼•æ˜¯ä¸€ä¸ªmå‰æ ‘ï¼Œæ‰€ä»¥ç´¢å¼•çš„å­˜åœ¨ä¼šå¯¼è‡´æ•°æ®åº“å†™å…¥é€Ÿåº¦é™ä½</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/11/9qAHTSmnlUeVPjb.png" alt="B+æ ‘ç´¢å¼•ä¿®æ”¹"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Rediså“¨å…µæœºåˆ¶</title>
      <link href="/Redis%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6/"/>
      <url>/Redis%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Rediså¤šæœºæ•°æ®åº“-å“¨å…µæœºåˆ¶"><a href="#Rediså¤šæœºæ•°æ®åº“-å“¨å…µæœºåˆ¶" class="headerlink" title="Rediså¤šæœºæ•°æ®åº“-å“¨å…µæœºåˆ¶"></a>Rediså¤šæœºæ•°æ®åº“-å“¨å…µæœºåˆ¶</h1><p>ä¸»ä»åº“çš„é›†ç¾¤æ¨¡å¼ä½¿å¾—å½“ä»åº“å‘ç”Ÿæ•…éšœä»¥åï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘ä¸»åº“æˆ–è€…å…¶ä»–ä»åº“å‘é€è¯·æ±‚ï¼Œè¿›è¡Œç›¸å…³çš„æ“ä½œï¼›ä½†æ˜¯å¦‚æœä¸»åº“å‘ç”Ÿäº†æ•…éšœï¼Œé‚£ä¼šç›´æ¥å½±å“åˆ°ä»åº“çš„åŒæ­¥ã€‚æ— è®ºæ˜¯å†™ä¸­æ–­è¿˜æ˜¯ä»åº“æ— æ³•è¿›è¡Œæ•°æ®åŒæ­¥éƒ½æ˜¯Redisæ‰€ä¸èƒ½æ¥å—çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€äº›æœºåˆ¶ï¼Œæ¥èƒ½å¤Ÿ<strong>å°†ä¸€ä¸ªä»åº“åˆ‡æ¢ä¸ºä¸»åº“</strong>ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†Redisçš„å“¨å…µæœºåˆ¶ã€‚</p><h1 id="1-å“¨å…µæœºåˆ¶çš„åŸºæœ¬æµç¨‹"><a href="#1-å“¨å…µæœºåˆ¶çš„åŸºæœ¬æµç¨‹" class="headerlink" title="1. å“¨å…µæœºåˆ¶çš„åŸºæœ¬æµç¨‹"></a>1. å“¨å…µæœºåˆ¶çš„åŸºæœ¬æµç¨‹</h1><ul><li>å“¨å…µå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¿è¡Œåœ¨ç‰¹æ®Šæ¨¡å¼ä¸‹çš„<strong>Redisè¿›ç¨‹</strong>ï¼Œå…¶åœ¨ä¸»ä»åº“å®ä¾‹è¿è¡Œçš„åŒæ—¶ä¹Ÿåœ¨è¿è¡Œ</li><li>å“¨å…µä¸»è¦çš„ä¸‰ä¸ªä»»åŠ¡ä¸ºï¼š<ul><li>ç›‘æ§ â€” å†³ç­–ï¼šåˆ¤æ–­ä¸»åº“æ˜¯å¦å¤„äºä¸‹çº¿çŠ¶æ€<ul><li>å‘¨æœŸæ€§çš„pingä¸»åº“ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä»ç„¶åœ¨çº¿è¿è¡Œ</li><li>å¦‚æœä»åº“æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å“åº”å“¨å…µçš„Pingå‘½ä»¤ï¼Œå“¨å…µå°±ä¼šå°†å…¶æ ‡è®°ä¸ºä¸‹çº¿çŠ¶æ€</li><li>å¯¹ä¸»åº“æ¥è¯´åŒç†ï¼Œåœ¨åˆ¤å®šä¸»åº“ä¸‹çº¿ä»¥åä¼šå¼€å§‹ä¸€ä¸ªè‡ªåŠ¨åˆ‡æ¢ä¸»åº“çš„æµç¨‹</li></ul></li><li>é€‰ä¸» â€” å†³ç­–ï¼šå†³å®šé€‰æ‹©å“ªä¸ªä»åº“å®ä¾‹ä½œä¸ºä¸»åº“<ul><li>ä¸»åº“æŒ‚äº†ä»¥åï¼Œå“¨å…µå°±éœ€è¦ä»å¾ˆå¤šä»åº“é‡ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™é€‰æ‹©ä¸€ä¸ªä»åº“å®ä¾‹ï¼Œå°†å…¶ä½œä¸ºæ–°çš„ä¸»åº“</li></ul></li><li>é€šçŸ¥<ul><li>å°†æ–°ä¸»åº“çš„è¿æ¥ä¿¡æ¯å‘ç»™å…¶ä»–ä»åº“ï¼Œè®©å®ƒä»¬æ‰§è¡Œreplicaofå‘½ä»¤ï¼Œä¸æ–°ä¸»åº“å»ºç«‹è¿æ¥ï¼Œå¹¶è¿›è¡Œæ•°æ®å¤åˆ¶</li><li>å“¨å…µä¼šå°†æ–°ä¸»åº“çš„è¿æ¥ä¿¡æ¯é€šçŸ¥ç»™å®¢æˆ·ç«¯ï¼Œè®©å®ƒä»¬å°†è¯·æ±‚æ“ä½œå‘åˆ°æ–°ä¸»åº“å½“ä¸­</li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2021/01/07/z7o6Kkdfp2IaPsx.png" alt="å“¨å…µæœºåˆ¶ä»»åŠ¡"></p><p>å“¨å…µä¸‰å¤§ä»»åŠ¡</p><h1 id="2-åˆ¤æ–­ä¸»åº“çš„ä¸‹çº¿çŠ¶æ€"><a href="#2-åˆ¤æ–­ä¸»åº“çš„ä¸‹çº¿çŠ¶æ€" class="headerlink" title="2. åˆ¤æ–­ä¸»åº“çš„ä¸‹çº¿çŠ¶æ€"></a>2. åˆ¤æ–­ä¸»åº“çš„ä¸‹çº¿çŠ¶æ€</h1><h2 id="2-1-å“¨å…µé›†ç¾¤ä½¿ç”¨åŸå› "><a href="#2-1-å“¨å…µé›†ç¾¤ä½¿ç”¨åŸå› " class="headerlink" title="2.1 å“¨å…µé›†ç¾¤ä½¿ç”¨åŸå› "></a>2.1 å“¨å…µé›†ç¾¤ä½¿ç”¨åŸå› </h2><h3 id="2-1-1-ä¸ºä»€ä¹ˆéœ€è¦å“¨å…µé›†ç¾¤ï¼Ÿ"><a href="#2-1-1-ä¸ºä»€ä¹ˆéœ€è¦å“¨å…µé›†ç¾¤ï¼Ÿ" class="headerlink" title="2.1.1 ä¸ºä»€ä¹ˆéœ€è¦å“¨å…µé›†ç¾¤ï¼Ÿ"></a>2.1.1 ä¸ºä»€ä¹ˆéœ€è¦å“¨å…µé›†ç¾¤ï¼Ÿ</h3><ul><li>å¦‚æœå“¨å…µå‘ç”Ÿè¯¯åˆ¤ï¼Œåç»­çš„é€‰ä¸»å’Œé€šçŸ¥æ“ä½œéƒ½ä¼šå¸¦æ¥é¢å¤–çš„è®¡ç®—å’Œé€šä¿¡çš„å¼€é”€</li><li>è¯¯åˆ¤é€šå¸¸å‘ç”Ÿåœ¨<ul><li>é›†ç¾¤ç½‘ç»œå‹åŠ›è¾ƒå¤§</li><li>ç½‘ç»œæ‹¥å¡</li><li>ä¸»åº“æœ¬èº«å‹åŠ›è¾ƒå¤§çš„æƒ…å†µ</li></ul></li><li>å“¨å…µæœºåˆ¶ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå®ƒé€šå¸¸ä¼šé‡‡ç”¨å¤šå®ä¾‹ç»„æˆçš„é›†ç¾¤æ¨¡å¼è¿›è¡Œéƒ¨ç½²ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸ºå“¨å…µé›†ç¾¤ã€‚å¼•å…¥å¤šä¸ªå“¨å…µå®ä¾‹ä¸€èµ·æ¥åˆ¤æ–­ï¼Œå°±å¯ä»¥é¿å…å•ä¸ªå“¨å…µå› ä¸ºè‡ªèº«ç½‘ç»œçŠ¶å†µä¸å¥½ï¼Œè€Œè¯¯åˆ¤ä¸»åº“ä¸‹çº¿çš„æƒ…å†µã€‚åŒæ—¶ï¼Œå¤šä¸ªå“¨å…µçš„ç½‘ç»œåŒæ—¶ä¸ç¨³å®šçš„æ¦‚ç‡è¾ƒå°ï¼Œç”±å®ƒä»¬ä¸€èµ·åšå†³ç­–ï¼Œè¯¯åˆ¤ç‡ä¹Ÿèƒ½é™ä½ã€‚</li></ul><h3 id="2-1-2-å¦‚ä½•ä½¿ç”¨å“¨å…µé›†ç¾¤ï¼Ÿ"><a href="#2-1-2-å¦‚ä½•ä½¿ç”¨å“¨å…µé›†ç¾¤ï¼Ÿ" class="headerlink" title="2.1.2 å¦‚ä½•ä½¿ç”¨å“¨å…µé›†ç¾¤ï¼Ÿ"></a>2.1.2 å¦‚ä½•ä½¿ç”¨å“¨å…µé›†ç¾¤ï¼Ÿ</h3><ul><li>ç®€å•æ¥è¯´ï¼Œâ€œå®¢è§‚ä¸‹çº¿â€çš„æ ‡å‡†å°±æ˜¯ï¼Œå½“æœ‰ N ä¸ªå“¨å…µå®ä¾‹æ—¶ï¼Œæœ€å¥½è¦æœ‰ N/2 + 1 ä¸ªå®ä¾‹åˆ¤æ–­ä¸»åº“ä¸ºâ€œä¸»è§‚ä¸‹çº¿â€ï¼Œæ‰èƒ½æœ€ç»ˆåˆ¤å®šä¸»åº“ä¸ºâ€œå®¢è§‚ä¸‹çº¿â€ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥å‡å°‘è¯¯åˆ¤çš„æ¦‚ç‡ï¼Œä¹Ÿèƒ½é¿å…è¯¯åˆ¤å¸¦æ¥çš„æ— è°“çš„ä¸»ä»åº“åˆ‡æ¢ã€‚ï¼ˆå½“ç„¶ï¼Œæœ‰å¤šå°‘ä¸ªå®ä¾‹åšå‡ºâ€œä¸»è§‚ä¸‹çº¿â€çš„åˆ¤æ–­æ‰å¯ä»¥ï¼Œå¯ä»¥ç”± Redis ç®¡ç†å‘˜è‡ªè¡Œè®¾å®šï¼‰ã€‚</li></ul><h2 id="2-2-å“¨å…µé›†ç¾¤åŸç†-â€”-åŸºäºPubSubæœºåˆ¶"><a href="#2-2-å“¨å…µé›†ç¾¤åŸç†-â€”-åŸºäºPubSubæœºåˆ¶" class="headerlink" title="2.2 å“¨å…µé›†ç¾¤åŸç† â€” åŸºäºPubSubæœºåˆ¶"></a>2.2 å“¨å…µé›†ç¾¤åŸç† â€” åŸºäºPubSubæœºåˆ¶</h2><h3 id="2-2-1-pubsubæœºåˆ¶"><a href="#2-2-1-pubsubæœºåˆ¶" class="headerlink" title="2.2.1 pubsubæœºåˆ¶"></a>2.2.1 pubsubæœºåˆ¶</h3><p>å“¨å…µå®ä¾‹ä¹‹é—´çš„ç›¸äº’å‘ç°æ˜¯åŸºäºRedisæä¾›çš„pubsubæœºåˆ¶çš„ï¼Œ<strong>å“¨å…µåªè¦å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥</strong>ï¼Œå°±å¯ä»¥åœ¨ä¸»åº“ä¸Šå‘å¸ƒæ¶ˆæ¯äº†</p><ul><li>å¯ä»¥é€‰æ‹©å‘å¸ƒè‡ªå·±çš„è¿æ¥ä¿¡æ¯åˆ°ä¸»åº“ä¸Š</li><li>ä¹Ÿå¯ä»¥ä»ä¸»åº“ä¸Šè®¢é˜…æ¶ˆæ¯ï¼Œè·å¾—å…¶ä»–å“¨å…µå‘å¸ƒçš„è¿æ¥ä¿¡æ¯</li><li>å½“å¤šä¸ªå“¨å…µå®ä¾‹éƒ½åœ¨ä¸»åº“ä¸Šåšäº†å‘å¸ƒå’Œè®¢é˜…æ“ä½œä¹‹åï¼Œä»–ä»¬ä¹‹é—´å°±èƒ½çŸ¥é“å½¼æ­¤çš„IPåœ°å€å’Œç«¯å£</li></ul><h3 id="2-2-2-é¢‘é“"><a href="#2-2-2-é¢‘é“" class="headerlink" title="2.2.2 é¢‘é“"></a>2.2.2 é¢‘é“</h3><ul><li>Redisé€šè¿‡é¢‘é“æ¥åŒºåˆ†ä¸åŒåº”ç”¨çš„æ¶ˆæ¯ï¼Œå¯¹è¿™äº›æ¶ˆæ¯è¿›è¡Œåˆ†é—¨åˆ«ç±»çš„ç®¡ç†ã€‚é¢‘é“å°±æ˜¯æŒ‡æ¶ˆæ¯çš„ç±»åˆ«ï¼Œå½“æ¶ˆæ¯ç±»åˆ«ç›¸åŒæ—¶ï¼Œå°±ä¼šå±äºåŒä¸€ä¸ªé¢‘é“ï¼Œå¦åˆ™å±äºä¸åŒçš„é¢‘é“ã€‚</li><li>ä¸»åº“ä¼šæ„å»ºä¸€ä¸ªå«åš <code>__sentinel__:hello</code> çš„é¢‘é“ï¼Œæ¥è®©å„ä¸ªå“¨å…µäº’ç›¸å‘ç°</li><li>åªæœ‰è®¢é˜…äº†åŒä¸€ä¸ªé¢‘é“çš„åº”ç”¨ï¼Œæ‰èƒ½é€šè¿‡å‘å¸ƒçš„æ¶ˆæ¯è¿›è¡Œä¿¡æ¯äº¤æ¢</li></ul><p><img src="https://i.loli.net/2021/01/11/LIhj62iuDBbPEve.png" alt="pubsubæœºåˆ¶"></p><p>é¢‘é“è®¢é˜…æœºåˆ¶</p><ul><li>å“¨å…µ1 å‘é¢‘é“helloå‘é€ä¿¡æ¯ï¼Œå› ä¸ºå“¨å…µ2 å“¨å…µ3 subscribeäº†helloé¢‘é“ï¼Œä»–ä»¬å°±èƒ½ä»è¿™ä¸ªé¢‘é“è·å–åˆ°å“¨å…µ1çš„IPåœ°å€å’Œç«¯å£å·ä¿¡æ¯</li></ul><h3 id="2-2-3-å“¨å…µå’Œä»åº“çš„è¿æ¥æ²Ÿé€š"><a href="#2-2-3-å“¨å…µå’Œä»åº“çš„è¿æ¥æ²Ÿé€š" class="headerlink" title="2.2.3 å“¨å…µå’Œä»åº“çš„è¿æ¥æ²Ÿé€š"></a>2.2.3 å“¨å…µå’Œä»åº“çš„è¿æ¥æ²Ÿé€š</h3><ul><li><p>å“¨å…µå‘ä¸»åº“å‘å‡ºINFOå‘½ä»¤</p></li><li><p>ä¸»åº“æ”¶åˆ°å‘½ä»¤åï¼Œå°±ä¼šå°†ä»åº“åˆ—è¡¨è¿”å›ç»™å“¨å…µ</p></li><li><p>æ¥ç€å“¨å…µå°±å¯ä»¥æ ¹æ®ä»åº“åˆ—è¡¨ä¸­çš„ä¿¡æ¯ï¼Œå’Œæ¯ä¸ªä»åº“å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨è¿™ä¸ªè¿æ¥ä¸ŠæŒç»­å¯¹ä»åº“è¿›è¡Œç›‘æ§</p><p>  <img src="https://i.loli.net/2021/01/11/sPTRS1mkhU2lLQn.png" alt="å“¨å…µä¸ä»åº“ä¹‹é—´çš„è¿æ¥"></p><p>  å“¨å…µå’Œä»åº“çš„è¿æ¥</p></li><li><p>å“¨å…µé™¤äº†ä¸Šè¿°çš„å’Œä¸»åº“ä¹‹é—´çš„è¿æ¥ï¼Œè·å–ä»åº“åˆ—è¡¨ï¼Œå¹¶å’Œä»åº“ä»¬å»ºç«‹è¿æ¥ä¹‹å¤–ï¼Œè¿˜æ‰¿æ‹…ç€åœ¨å‘ç”Ÿä¸»åº“æ›´æ¢ä»¥åï¼Œå°†æ–°ä¸»åº“çš„ä¿¡æ¯å‘Šè¯‰å®¢æˆ·ç«¯è¿™ä¸ªä»»åŠ¡</p></li></ul><h2 id="2-3-å®¢æˆ·ç«¯äº‹ä»¶é€šçŸ¥æœºåˆ¶"><a href="#2-3-å®¢æˆ·ç«¯äº‹ä»¶é€šçŸ¥æœºåˆ¶" class="headerlink" title="2.3 å®¢æˆ·ç«¯äº‹ä»¶é€šçŸ¥æœºåˆ¶"></a>2.3 å®¢æˆ·ç«¯äº‹ä»¶é€šçŸ¥æœºåˆ¶</h2><ul><li><p>å“¨å…µæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ç‰¹å®šæ¨¡å¼ä¸‹çš„Rediså®ä¾‹ï¼Œåªæ˜¯å®ƒä¸æœåŠ¡è¯·æ±‚æ“ä½œï¼Œåªæ˜¯å®Œæˆç›‘æ§ï¼Œé€‰ä¸»å’Œé€šçŸ¥çš„ä»»åŠ¡</p></li><li><p>å› æ­¤æ¯ä¸ªå“¨å…µå®ä¾‹ä¹Ÿæä¾›pubsubæœºåˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä»å“¨å…µè®¢é˜…æ¶ˆæ¯</p><ul><li><p>å“¨å…µæä¾›äº†å¾ˆå¤šçš„æ¶ˆæ¯è®¢é˜…é¢‘é“ï¼Œä¸åŒé¢‘é“åŒ…å«äº†ä¸»ä»åº“åˆ‡æ¢è¿‡ç¨‹ä¸­çš„ä¸åŒå…³é”®äº‹ä»¶</p><p>  <img src="https://i.loli.net/2021/07/06/lBP5xJYieohTZXw.png" alt="å“¨å…µå¸¸ç”¨çš„æ¶ˆæ¯è®¢é˜…é¢‘é“"></p></li><li><p>å®¢æˆ·ç«¯å¯ä»¥æ‰§è¡Œè®¢é˜…å‘½ä»¤ï¼Œæ¥è®¢é˜…ä¸åŒçš„é¢‘é“ï¼Œç„¶åæ¥è·å–ä¸åŒçš„äº‹ä»¶ä¿¡æ¯</p><ul><li>å½“å“¨å…µå°†æ–°çš„ä¸»åº“é€‰å‡ºæ¥ä»¥åï¼Œå®¢æˆ·ç«¯ä¼šçœ‹åˆ°switch-masteräº‹ä»¶ï¼Œäº‹ä»¶ä¸­ä¼šåŒ…å«æ–°çš„ä¸»åº“çš„IPåœ°å€è¿˜æœ‰ç«¯å£ä¿¡æ¯</li><li>æ­¤æ—¶å®¢æˆ·ç«¯å°±ä¼šä½¿ç”¨æ–°ä¸»åº“åœ°å€å’Œç«¯å£æ¥è¿›è¡Œé€šä¿¡äº†</li></ul></li></ul></li></ul><h1 id="3-å¦‚ä½•é€‰å®šæ–°ä¸»åº“ï¼Ÿ"><a href="#3-å¦‚ä½•é€‰å®šæ–°ä¸»åº“ï¼Ÿ" class="headerlink" title="3. å¦‚ä½•é€‰å®šæ–°ä¸»åº“ï¼Ÿ"></a>3. å¦‚ä½•é€‰å®šæ–°ä¸»åº“ï¼Ÿ</h1><blockquote><p>å“¨å…µç­›é€‰æ–°ä¸»åº“çš„è¿‡ç¨‹ç§°ä¸ºç­›é€‰+æ‰“åˆ†</p></blockquote><ul><li>ç­›é€‰ â€” æŒ‰ç…§ä¸€å®šæ¡ä»¶ç­›é€‰ï¼Œå°†ä¸ç¬¦åˆæ¡ä»¶çš„ä»åº“å»æ‰<ul><li>ç¡®ä¿ä»åº“ä»ç„¶åœ¨çº¿è¿è¡Œ</li><li>åˆ¤æ–­å…¶ä¹‹å‰çš„ç½‘ç»œçŠ¶æ€ çœ‹è¯¥ä»åº“å’Œä¸»åº“ä¹‹é—´æ˜¯å¦ç»å¸¸æ–­è”ï¼Œå‡ºç°ç½‘ç»œç›¸å…³çš„é—®é¢˜<ul><li>é€šè¿‡ä½¿ç”¨down-after-millisecondså±æ€§ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¤ä¸ºçš„æœ€å¤§ä¸»ä»é—´çš„è¿æ¥è¶…æ—¶ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´æˆ‘ä»¬å°±è®¤ä¸ºæ–­è”äº†ï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°å°±è®¤ä¸ºä»åº“ç½‘ç»œçŠ¶å†µä¸å¥½</li></ul></li></ul></li><li>æ‰“åˆ† â€” <strong>åªè¦æœ‰å¾—åˆ†æœ€é«˜çš„ï¼Œé‚£ä¹ˆå°±åœ¨å½“å‰è½®åœæ­¢å¹¶ä¸”è®¤å®šå…¶ä¸ºä¸»åº“</strong><ul><li>ä»åº“ä¼˜å…ˆçº§ â€” æ‰‹åŠ¨è®¾ç½®çš„<ul><li>ç”¨æˆ·å¯ä»¥é€šè¿‡slave-priorityé…ç½®é¡¹ï¼Œç»™ä¸åŒçš„ä»åº“è®¾ç½®ä¸åŒçš„ä¼˜å…ˆçº§<ul><li>è­¬å¦‚ï¼šä¸¤ä¸ªä»åº“å†…å­˜å¤§å°ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰‹åŠ¨ç»™å†…å­˜å¤§çš„å®ä¾‹è®¾ç½®ä¸€ä¸ªé«˜ä¼˜å…ˆçº§</li></ul></li></ul></li><li>ä»åº“å¤åˆ¶è¿›åº¦<ul><li>é€‰æ‹©å’Œæ—§ä¸»åº“<strong>åŒæ­¥æœ€ä¸ºæ¥è¿‘</strong>çš„é‚£ä¸ªä»åº“ä½œä¸ºä¸»åº“</li><li>å¦‚ä½•åˆ¤æ–­ä»åº“å’Œæ—§ä¸»åº“çš„åŒæ­¥è¿›åº¦ï¼Ÿ<ul><li>ä¸»ä»åº“ä¹‹é—´å‘½ä»¤ä¼ æ’­æœºåˆ¶é‡Œé¢çš„master_repl_offset å’Œslave_repl_offset</li><li>çœ‹äºŒè€…çš„æ¥è¿‘ç¨‹åº¦</li></ul></li></ul></li><li>ä»åº“IDå·<ul><li>å½“ä¼˜å…ˆçº§å’Œå¤åˆ¶è¿›åº¦éƒ½ç›¸åŒçš„æƒ…å†µä¸‹ï¼ŒIDå·æœ€å°çš„ä»åº“å¾—åˆ†æœ€é«˜ï¼Œè¢«é€‰ä¸ºæ–°ä¸»åº“</li></ul></li></ul></li></ul><h1 id="4-ç”±å“ªä¸ªå“¨å…µæ¥æ‰§è¡Œä¸»ä»åˆ‡æ¢ï¼Ÿ"><a href="#4-ç”±å“ªä¸ªå“¨å…µæ¥æ‰§è¡Œä¸»ä»åˆ‡æ¢ï¼Ÿ" class="headerlink" title="4. ç”±å“ªä¸ªå“¨å…µæ¥æ‰§è¡Œä¸»ä»åˆ‡æ¢ï¼Ÿ"></a>4. ç”±å“ªä¸ªå“¨å…µæ¥æ‰§è¡Œä¸»ä»åˆ‡æ¢ï¼Ÿ</h1><ul><li><h2 id="ä»»ä½•ä¸€ä¸ªå®ä¾‹åªè¦è‡ªèº«åˆ¤æ–­ä¸»åº“ä¸»è§‚ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šç»™å…¶ä»–åŠ¿åŠ›å‘é€is-master-down-by-addrå‘½ä»¤ã€‚æ¥ç€å…¶ä»–å®ä¾‹ä¼šæ ¹æ®è‡ªå·±å’Œä¸»åº“çš„è¿æ¥æƒ…å†µï¼Œåšå‡ºYæˆ–Nçš„å“åº”"><a href="#ä»»ä½•ä¸€ä¸ªå®ä¾‹åªè¦è‡ªèº«åˆ¤æ–­ä¸»åº“ä¸»è§‚ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šç»™å…¶ä»–åŠ¿åŠ›å‘é€is-master-down-by-addrå‘½ä»¤ã€‚æ¥ç€å…¶ä»–å®ä¾‹ä¼šæ ¹æ®è‡ªå·±å’Œä¸»åº“çš„è¿æ¥æƒ…å†µï¼Œåšå‡ºYæˆ–Nçš„å“åº”" class="headerlink" title="ä»»ä½•ä¸€ä¸ªå®ä¾‹åªè¦è‡ªèº«åˆ¤æ–­ä¸»åº“ä¸»è§‚ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šç»™å…¶ä»–åŠ¿åŠ›å‘é€is-master-down-by-addrå‘½ä»¤ã€‚æ¥ç€å…¶ä»–å®ä¾‹ä¼šæ ¹æ®è‡ªå·±å’Œä¸»åº“çš„è¿æ¥æƒ…å†µï¼Œåšå‡ºYæˆ–Nçš„å“åº”"></a>ä»»ä½•ä¸€ä¸ªå®ä¾‹åªè¦è‡ªèº«åˆ¤æ–­ä¸»åº“ä¸»è§‚ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šç»™å…¶ä»–åŠ¿åŠ›å‘é€is-master-down-by-addrå‘½ä»¤ã€‚æ¥ç€å…¶ä»–å®ä¾‹ä¼šæ ¹æ®è‡ªå·±å’Œä¸»åº“çš„è¿æ¥æƒ…å†µï¼Œåšå‡ºYæˆ–Nçš„å“åº”</h2><pre><code>  ![å“¨å…µæ²Ÿé€šï¼Œç¡®å®šä¸»åº“æ˜¯å¦ä¸‹çº¿](https://i.loli.net/2021/01/11/HpT5MAdKX9fmo2S.png)  is master down by addr</code></pre><ul><li><p>ä¸€ä¸ªå“¨å…µè·å¾—äº†<strong>ä»²è£æ‰€éœ€çš„èµæˆç¥¨æ•°åï¼Œå°±å¯ä»¥æ ‡è®°ä¸»åº“ä¸ºå®¢è§‚ä¸‹çº¿</strong></p><ul><li>è¿™ä¸ªæ‰€éœ€çš„èµæˆç¥¨æ•°æ˜¯é€šè¿‡å“¨å…µé…ç½®æ–‡ä»¶ä¸­çš„quorumé…ç½®é¡¹è®¾å®šçš„</li></ul></li><li><p>å½“è·å¾—äº†æ‰€éœ€èµæˆç¥¨æ•°ä»¥åï¼Œè¿™ä¸ªå“¨å…µä¼šå†ç»™å…¶ä»–å“¨å…µå‘é€å‘½ä»¤ï¼Œå¸Œæœ›ç”±è‡ªå·±æ¥æ‰§è¡Œä¸»ä»åˆ‡æ¢ï¼Œå¹¶è®©æ‰€æœ‰å…¶ä»–å“¨å…µè¿›è¡ŒæŠ•ç¥¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>Leaderé€‰ä¸¾</strong>ã€‚</p></li><li><p>åœ¨æŠ•ç¥¨è¿‡ç¨‹ä¸­ï¼Œä»»ä½•ä¸€ä¸ªæƒ³æˆä¸º Leader çš„å“¨å…µï¼Œè¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>ç¬¬ä¸€ï¼Œæ‹¿åˆ°åŠæ•°ä»¥ä¸Šçš„èµæˆç¥¨ï¼›</li><li>ç¬¬äºŒï¼Œæ‹¿åˆ°çš„ç¥¨æ•°åŒæ—¶è¿˜éœ€è¦å¤§äºç­‰äºå“¨å…µé…ç½®æ–‡ä»¶ä¸­çš„ quorum å€¼ã€‚ä»¥ 3 ä¸ªå“¨å…µä¸ºä¾‹ï¼Œå‡è®¾æ­¤æ—¶çš„ quorum è®¾ç½®ä¸º 2ï¼Œé‚£ä¹ˆï¼Œä»»ä½•ä¸€ä¸ªæƒ³æˆä¸º Leader çš„å“¨å…µåªè¦æ‹¿åˆ° 2 å¼ èµæˆç¥¨ï¼Œå°±å¯ä»¥äº†ã€‚</li></ul><p><img src="https://i.loli.net/2021/01/11/RAaq7KZr2LSUdVx.png" alt="å“¨å…µæŠ•ç¥¨ï¼Œé€‰ä¸¾leader"></p><p>ç¥¨é€‰æ‰§è¡Œä¸»ä»åˆ‡æ¢å“¨å…µçš„è¿‡ç¨‹</p></li></ul><ol><li>åœ¨ T1 æ—¶åˆ»ï¼ŒS1 åˆ¤æ–­ä¸»åº“ä¸ºâ€œå®¢è§‚ä¸‹çº¿â€ï¼Œå®ƒæƒ³æˆä¸º Leaderï¼Œå°±å…ˆç»™è‡ªå·±æŠ•ä¸€å¼ èµæˆç¥¨ï¼Œç„¶ååˆ†åˆ«å‘ S2 å’Œ S3 å‘é€å‘½ä»¤ï¼Œè¡¨ç¤ºè¦æˆä¸º Leaderã€‚</li><li>åœ¨ T2 æ—¶åˆ»ï¼ŒS3 åˆ¤æ–­ä¸»åº“ä¸ºâ€œå®¢è§‚ä¸‹çº¿â€ï¼Œå®ƒä¹Ÿæƒ³æˆä¸º Leaderï¼Œæ‰€ä»¥ä¹Ÿå…ˆç»™è‡ªå·±æŠ•ä¸€å¼ èµæˆç¥¨ï¼Œå†åˆ†åˆ«å‘ S1 å’Œ S2 å‘é€å‘½ä»¤ï¼Œè¡¨ç¤ºè¦æˆä¸º Leaderã€‚</li><li>åœ¨ T3 æ—¶åˆ»ï¼ŒS1 æ”¶åˆ°äº† S3 çš„ Leader æŠ•ç¥¨è¯·æ±‚ã€‚<strong>å› ä¸º S1 å·²ç»ç»™è‡ªå·±æŠ•äº†ä¸€ç¥¨ Yï¼Œæ‰€ä»¥å®ƒä¸èƒ½å†ç»™å…¶ä»–å“¨å…µæŠ•èµæˆç¥¨äº†ï¼Œæ‰€ä»¥ S1 å›å¤ N è¡¨ç¤ºä¸åŒæ„</strong>ã€‚åŒæ—¶ï¼ŒS2 æ”¶åˆ°äº† T2 æ—¶ S3 å‘é€çš„ Leader æŠ•ç¥¨è¯·æ±‚ã€‚å› ä¸º S2 ä¹‹å‰æ²¡æœ‰æŠ•è¿‡ç¥¨ï¼Œå®ƒä¼šç»™ç¬¬ä¸€ä¸ªå‘å®ƒå‘é€æŠ•ç¥¨è¯·æ±‚çš„å“¨å…µå›å¤ Yï¼Œç»™åç»­å†å‘é€æŠ•ç¥¨è¯·æ±‚çš„å“¨å…µå›å¤ Nï¼Œæ‰€ä»¥ï¼Œåœ¨ T3 æ—¶ï¼ŒS2 å›å¤ S3ï¼ŒåŒæ„ S3 æˆä¸º Leaderã€‚</li><li>åœ¨ T4 æ—¶åˆ»ï¼ŒS2 æ‰æ”¶åˆ° T1 æ—¶ S1 å‘é€çš„æŠ•ç¥¨å‘½ä»¤ã€‚å› ä¸º S2 å·²ç»åœ¨ T3 æ—¶åŒæ„äº† S3 çš„æŠ•ç¥¨è¯·æ±‚ï¼Œæ­¤æ—¶ï¼ŒS2 ç»™ S1 å›å¤ Nï¼Œè¡¨ç¤ºä¸åŒæ„ S1 æˆä¸º Leaderã€‚å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸º S3 å’Œ S2 ä¹‹é—´çš„ç½‘ç»œä¼ è¾“æ­£å¸¸ï¼Œè€Œ S1 å’Œ S2 ä¹‹é—´çš„ç½‘ç»œä¼ è¾“å¯èƒ½æ­£å¥½æ‹¥å¡äº†ï¼Œå¯¼è‡´æŠ•ç¥¨è¯·æ±‚ä¼ è¾“æ…¢äº†ã€‚</li><li>åœ¨ T5 æ—¶åˆ»ï¼ŒS1 å¾—åˆ°çš„ç¥¨æ•°æ˜¯æ¥è‡ªå®ƒè‡ªå·±çš„ä¸€ç¥¨ Y å’Œæ¥è‡ª S2 çš„ä¸€ç¥¨ Nã€‚è€Œ S3 é™¤äº†è‡ªå·±çš„èµæˆç¥¨ Y ä»¥å¤–ï¼Œè¿˜æ”¶åˆ°äº†æ¥è‡ª S2 çš„ä¸€ç¥¨ Yã€‚æ­¤æ—¶ï¼ŒS3 ä¸ä»…è·å¾—äº†åŠæ•°ä»¥ä¸Šçš„ Leader èµæˆç¥¨ï¼Œä¹Ÿè¾¾åˆ°é¢„è®¾çš„ quorum å€¼ï¼ˆquorum ä¸º 2ï¼‰ï¼Œæ‰€ä»¥å®ƒæœ€ç»ˆæˆä¸ºäº† Leaderã€‚æ¥ç€ï¼ŒS3 ä¼šå¼€å§‹æ‰§è¡Œé€‰ä¸»æ“ä½œï¼Œè€Œä¸”åœ¨é€‰å®šæ–°ä¸»åº“åï¼Œä¼šç»™å…¶ä»–ä»åº“å’Œå®¢æˆ·ç«¯é€šçŸ¥æ–°ä¸»åº“çš„ä¿¡æ¯ã€‚</li></ol><ul><li><p>å¦‚æœ S3 æ²¡æœ‰æ‹¿åˆ° 2 ç¥¨ Yï¼Œé‚£ä¹ˆè¿™è½®æŠ•ç¥¨å°±ä¸ä¼šäº§ç”Ÿ Leaderã€‚<strong>å“¨å…µé›†ç¾¤ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆä¹Ÿå°±æ˜¯å“¨å…µæ•…éšœè½¬ç§»è¶…æ—¶æ—¶é—´çš„ 2 å€ï¼‰</strong>ï¼Œå†é‡æ–°é€‰ä¸¾ã€‚è¿™æ˜¯å› ä¸ºï¼Œå“¨å…µé›†ç¾¤èƒ½å¤Ÿè¿›è¡ŒæˆåŠŸæŠ•ç¥¨ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºé€‰ä¸¾å‘½ä»¤çš„æ­£å¸¸ç½‘ç»œä¼ æ’­ã€‚<strong>å¦‚æœç½‘ç»œå‹åŠ›è¾ƒå¤§æˆ–æœ‰çŸ­æ—¶å µå¡ï¼Œå°±å¯èƒ½å¯¼è‡´æ²¡æœ‰ä¸€ä¸ªå“¨å…µèƒ½æ‹¿åˆ°åŠæ•°ä»¥ä¸Šçš„èµæˆç¥¨</strong>ã€‚æ‰€ä»¥ï¼Œç­‰åˆ°ç½‘ç»œæ‹¥å¡å¥½è½¬ä¹‹åï¼Œå†è¿›è¡ŒæŠ•ç¥¨é€‰ä¸¾ï¼ŒæˆåŠŸçš„æ¦‚ç‡å°±ä¼šå¢åŠ ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå“¨å…µé›†ç¾¤åªæœ‰ 2 ä¸ªå®ä¾‹ï¼Œæ­¤æ—¶ï¼Œä¸€ä¸ªå“¨å…µè¦æƒ³æˆä¸º Leaderï¼Œå¿…é¡»è·å¾— 2 ç¥¨ï¼Œè€Œä¸æ˜¯ 1 ç¥¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœæœ‰ä¸ªå“¨å…µæŒ‚æ‰äº†ï¼Œé‚£ä¹ˆï¼Œæ­¤æ—¶çš„é›†ç¾¤æ˜¯æ— æ³•è¿›è¡Œä¸»ä»åº“åˆ‡æ¢çš„ã€‚å› æ­¤ï¼Œé€šå¸¸æˆ‘ä»¬è‡³å°‘ä¼šé…ç½® 3 ä¸ªå“¨å…µå®ä¾‹ã€‚</p><h1 id="5-FAQs"><a href="#5-FAQs" class="headerlink" title="5. FAQs"></a>5. FAQs</h1><h2 id="5-1-å“¨å…µåœ¨æ“ä½œä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹å½“ä¸­ï¼Œå®¢æˆ·ç«¯èƒ½å¦æ­£å¸¸è¿›è¡Œè¯·æ±‚æ“ä½œï¼Ÿ"><a href="#5-1-å“¨å…µåœ¨æ“ä½œä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹å½“ä¸­ï¼Œå®¢æˆ·ç«¯èƒ½å¦æ­£å¸¸è¿›è¡Œè¯·æ±‚æ“ä½œï¼Ÿ" class="headerlink" title="5.1 å“¨å…µåœ¨æ“ä½œä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹å½“ä¸­ï¼Œå®¢æˆ·ç«¯èƒ½å¦æ­£å¸¸è¿›è¡Œè¯·æ±‚æ“ä½œï¼Ÿ"></a>5.1 å“¨å…µåœ¨æ“ä½œä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹å½“ä¸­ï¼Œå®¢æˆ·ç«¯èƒ½å¦æ­£å¸¸è¿›è¡Œè¯·æ±‚æ“ä½œï¼Ÿ</h2></li><li><p>å¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨äº†è¯»å†™åˆ†ç¦»ï¼Œé‚£ä¹ˆ<strong>è¯»è¯·æ±‚</strong>å¯ä»¥åœ¨ä»åº“ä¸Šæ­£å¸¸æ‰§è¡Œï¼Œä¸ä¼šå—åˆ°å½±å“ã€‚ä½†æ˜¯ç”±äºæ­¤æ—¶ä¸»åº“å·²ç»æŒ‚äº†ï¼Œè€Œä¸”å“¨å…µè¿˜æ²¡æœ‰é€‰å‡ºæ–°çš„ä¸»åº“ï¼Œæ‰€ä»¥åœ¨è¿™æœŸé—´<strong>å†™è¯·æ±‚ä¼šå¤±è´¥</strong>ï¼Œå¤±è´¥æŒç»­çš„æ—¶é—´ = å“¨å…µåˆ‡æ¢ä¸»ä»çš„æ—¶é—´ + å®¢æˆ·ç«¯æ„ŸçŸ¥åˆ°æ–°ä¸»åº“ çš„æ—¶é—´ã€‚</p></li><li><p>å¦‚æœä¸æƒ³è®©ä¸šåŠ¡æ„ŸçŸ¥åˆ°å¼‚å¸¸ï¼Œå®¢æˆ·ç«¯åªèƒ½æŠŠå†™å¤±è´¥çš„è¯·æ±‚å…ˆç¼“å­˜èµ·æ¥æˆ–<strong>å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶</strong>ä¸­ï¼Œç­‰å“¨å…µåˆ‡æ¢å®Œä¸»ä»åï¼Œå†æŠŠè¿™äº›å†™è¯·æ±‚å‘ç»™æ–°çš„ä¸»åº“ï¼Œä½†è¿™ç§åœºæ™¯åªé€‚åˆå¯¹å†™å…¥è¯·æ±‚è¿”å›å€¼ä¸æ•æ„Ÿçš„ä¸šåŠ¡ï¼Œè€Œä¸”è¿˜éœ€è¦ä¸šåŠ¡å±‚åšé€‚é…ï¼Œå¦å¤–ä¸»ä»åˆ‡æ¢æ—¶é—´è¿‡é•¿ï¼Œä¹Ÿä¼šå¯¼è‡´å®¢æˆ·ç«¯æˆ–æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ç¼“å­˜å†™è¯·æ±‚è¿‡å¤šï¼Œåˆ‡æ¢å®Œæˆä¹‹åé‡æ”¾è¿™äº›è¯·æ±‚çš„æ—¶é—´å˜é•¿ã€‚</p></li><li><p>å“¨å…µæ£€æµ‹ä¸»åº“å¤šä¹…æ²¡æœ‰å“åº”å°±æå‡ä»åº“ä¸ºæ–°çš„ä¸»åº“ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯å¯ä»¥é…ç½®çš„ï¼ˆdown-after-millisecondså‚æ•°ï¼‰ã€‚é…ç½®çš„æ—¶é—´è¶ŠçŸ­ï¼Œå“¨å…µè¶Šæ•æ„Ÿï¼Œå“¨å…µé›†ç¾¤è®¤ä¸ºä¸»åº“åœ¨çŸ­æ—¶é—´å†…è¿ä¸ä¸Šå°±ä¼šå‘èµ·ä¸»ä»åˆ‡æ¢ï¼Œè¿™ç§é…ç½®å¾ˆå¯èƒ½å› ä¸ºç½‘ç»œæ‹¥å¡ä½†ä¸»åº“æ­£å¸¸è€Œå‘ç”Ÿä¸å¿…è¦çš„åˆ‡æ¢ï¼Œå½“ç„¶ï¼Œå½“ä¸»åº“çœŸæ­£æ•…éšœæ—¶ï¼Œå› ä¸ºåˆ‡æ¢å¾—åŠæ—¶ï¼Œå¯¹ä¸šåŠ¡çš„å½±å“æœ€å°ã€‚å¦‚æœé…ç½®çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œå“¨å…µè¶Šä¿å®ˆï¼Œè¿™ç§æƒ…å†µå¯ä»¥å‡å°‘å“¨å…µè¯¯åˆ¤çš„æ¦‚ç‡ï¼Œä½†æ˜¯ä¸»åº“æ•…éšœå‘ç”Ÿæ—¶ï¼Œä¸šåŠ¡å†™å¤±è´¥çš„æ—¶é—´ä¹Ÿä¼šæ¯”è¾ƒä¹…ï¼Œç¼“å­˜å†™è¯·æ±‚æ•°æ®é‡è¶Šå¤šã€‚</p></li><li><p>åº”ç”¨ç¨‹åºä¸æ„ŸçŸ¥æœåŠ¡çš„ä¸­æ–­ï¼Œè¿˜éœ€è¦å“¨å…µå’Œå®¢æˆ·ç«¯åšäº›ä»€ä¹ˆï¼Ÿå½“å“¨å…µå®Œæˆä¸»ä»åˆ‡æ¢åï¼Œå®¢æˆ·ç«¯éœ€è¦åŠæ—¶æ„ŸçŸ¥åˆ°ä¸»åº“å‘ç”Ÿäº†å˜æ›´ï¼Œç„¶åæŠŠç¼“å­˜çš„å†™è¯·æ±‚å†™å…¥åˆ°æ–°åº“ä¸­ï¼Œä¿è¯åç»­å†™è¯·æ±‚ä¸ä¼šå†å—åˆ°å½±å“ï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p><ul><li>å“¨å…µæå‡ä¸€ä¸ªä»åº“ä¸ºæ–°ä¸»åº“åï¼Œå“¨å…µä¼šæŠŠæ–°ä¸»åº“çš„åœ°å€å†™å…¥è‡ªå·±å®ä¾‹çš„pubsubï¼ˆswitch-masterï¼‰ä¸­ã€‚å®¢æˆ·ç«¯éœ€è¦è®¢é˜…è¿™ä¸ªpubsubï¼Œå½“è¿™ä¸ªpubsubæœ‰æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯å°±èƒ½æ„ŸçŸ¥åˆ°ä¸»åº“å‘ç”Ÿå˜æ›´ï¼ŒåŒæ—¶å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„ä¸»åº“åœ°å€ï¼Œç„¶åæŠŠå†™è¯·æ±‚å†™åˆ°è¿™ä¸ªæ–°ä¸»åº“å³å¯ï¼Œè¿™ç§æœºåˆ¶å±äºå“¨å…µä¸»åŠ¨é€šçŸ¥å®¢æˆ·ç«¯ã€‚</li><li>å¦‚æœå®¢æˆ·ç«¯å› ä¸ºæŸäº›åŸå› é”™è¿‡äº†å“¨å…µçš„é€šçŸ¥ï¼Œæˆ–è€…å“¨å…µé€šçŸ¥åå®¢æˆ·ç«¯å¤„ç†å¤±è´¥äº†ï¼Œå®‰å…¨èµ·è§ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€è¦æ”¯æŒä¸»åŠ¨å»è·å–æœ€æ–°ä¸»ä»çš„åœ°å€è¿›è¡Œè®¿é—®ã€‚</li><li>æ‰€ä»¥ï¼Œå®¢æˆ·ç«¯éœ€è¦è®¿é—®ä¸»ä»åº“æ—¶ï¼Œä¸èƒ½ç›´æ¥å†™æ­»ä¸»ä»åº“çš„åœ°å€äº†ï¼Œè€Œæ˜¯éœ€è¦ä»å“¨å…µé›†ç¾¤ä¸­è·å–æœ€æ–°çš„åœ°å€ï¼ˆsentinel get-master-addr-by-nameå‘½ä»¤ï¼‰ï¼Œè¿™æ ·å½“å®ä¾‹å¼‚å¸¸æ—¶ï¼Œå“¨å…µåˆ‡æ¢åæˆ–è€…å®¢æˆ·ç«¯æ–­å¼€é‡è¿ï¼Œéƒ½å¯ä»¥ä»å“¨å…µé›†ç¾¤ä¸­æ‹¿åˆ°æœ€æ–°çš„å®ä¾‹åœ°å€ã€‚</li><li>ä¸€èˆ¬Redisçš„SDKéƒ½æä¾›äº†é€šè¿‡å“¨å…µæ‹¿åˆ°å®ä¾‹åœ°å€ï¼Œå†è®¿é—®å®ä¾‹çš„æ–¹å¼ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å³å¯ï¼Œä¸éœ€è¦è‡ªå·±å®ç°è¿™äº›é€»è¾‘ã€‚å½“ç„¶ï¼Œå¯¹äºåªæœ‰ä¸»ä»å®ä¾‹çš„æƒ…å†µï¼Œå®¢æˆ·ç«¯éœ€è¦å’Œå“¨å…µé…åˆä½¿ç”¨ï¼Œè€Œåœ¨åˆ†ç‰‡é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œè¿™äº›é€»è¾‘éƒ½å¯ä»¥åšåœ¨proxyå±‚ï¼Œè¿™æ ·å®¢æˆ·ç«¯ä¹Ÿä¸éœ€è¦å…³å¿ƒè¿™äº›é€»è¾‘äº†ï¼ŒCodiså°±æ˜¯è¿™ä¹ˆåšçš„</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1></li></ul><ol><li>æå®¢æ—¶é—´Redisè¯¾ç¨‹</li><li>Redisè®¾è®¡ä¸å®ç°</li></ol></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis Cluster</title>
      <link href="/Redis-Cluster/"/>
      <url>/Redis-Cluster/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis-Cluster"><a href="#Redis-Cluster" class="headerlink" title="Redis Cluster"></a>Redis Cluster</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>Redisé›†ç¾¤æ˜¯Redisæä¾›çš„åˆ†å¸ƒå¼æ•°æ®åº“æ–¹æ¡ˆï¼Œé›†ç¾¤é€šè¿‡åˆ†ç‰‡ - shardingæ¥è¿›è¡Œæ•°æ®å…±äº«ï¼Œå¹¶æä¾›å¤åˆ¶å’Œæ•…éšœè½¬ç§»åŠŸèƒ½</li></ul><h1 id="2-èŠ‚ç‚¹"><a href="#2-èŠ‚ç‚¹" class="headerlink" title="2. èŠ‚ç‚¹"></a>2. èŠ‚ç‚¹</h1><ul><li>æ¦‚è¿°<ul><li>ä¸€ä¸ªredisé›†ç¾¤é€šå¸¸ç”±å¤šä¸ªèŠ‚ç‚¹ node ç»„æˆ</li><li>å¼€å§‹çš„æ—¶å€™æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œç›¸å½“äºå„è‡ªåœ¨è‡ªå·±çš„é›†ç¾¤å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†å„ä¸ªç‹¬ç«‹çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥ï¼Œæ„æˆä¸€ä¸ªåŒ…å«å¤šä¸ªèŠ‚ç‚¹çš„é›†ç¾¤</li><li><code>CLUSTER MEET &lt;ip&gt; &lt;port&gt;</code> æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæŒ‡ä»¤æ¥è¿æ¥å„ä¸ªèŠ‚ç‚¹<ul><li>ä»¥èŠ‚ç‚¹A æ”¶åˆ°å‘½ä»¤ï¼Œè¦åŠ èŠ‚ç‚¹Bä¸ºä¾‹<ul><li>Aå’ŒB æ¡æ‰‹ï¼Œç¡®è®¤å½¼æ­¤å­˜åœ¨</li><li>Aä¸ºèŠ‚ç‚¹Båˆ›å»ºä¸€ä¸ªclusterNodeç»“æ„ï¼Œå¹¶æ·»åŠ åˆ°è‡ªå·±çš„clusterState.nodeså­—å…¸é‡Œé¢</li><li>Aæ ¹æ®IP è¿˜æœ‰ç«¯å£ï¼Œå‘Bå‘é€MEETæ¶ˆæ¯</li><li>èŠ‚ç‚¹B æ”¶åˆ°ä¿¡æ¯ï¼Œä¸ºAåˆ›å»ºclusterNodeç»“æ„ï¼Œå¹¶æ·»åŠ åˆ°è‡ªå·±çš„ <code>clustState.nodes</code> å­—å…¸é‡Œé¢</li><li>Bå‘Aå‘å‡ºPONGæ¶ˆæ¯ï¼Œè®©AçŸ¥é“è‡ªå·±æˆåŠŸæ¥æ”¶åˆ°äº†</li><li>Aå‘Bå‘å‡ºPINGæ¶ˆæ¯</li><li>èŠ‚ç‚¹Bæ”¶åˆ°ï¼Œç¡®è®¤Aæ”¶åˆ°äº†è‡ªå·±çš„PONG  æ•´ä¸ªè¿‡ç¨‹ç»“æŸ</li></ul></li></ul></li></ul></li><li>å¯åŠ¨èŠ‚ç‚¹<ul><li>RedisæœåŠ¡å™¨æ ¹æ® <code>cluster-enabled</code> é…ç½®é€‰é¡¹åˆ¤æ–­æ˜¯å¦å¼€å¯æœåŠ¡å™¨çš„é›†ç¾¤æ¨¡å¼</li></ul></li><li>é›†ç¾¤æ¨¡å¼å’Œstandaloneæ¨¡å¼çš„èŠ‚ç‚¹åŒºåˆ«<ul><li>ç›¸åŒä¹‹å¤„<ul><li>å•æœºæ¨¡å¼ä¸‹çš„åŠŸèƒ½ç…§æ—§<ul><li>æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨</li><li>æ—¶é—´äº‹ä»¶å¤„ç†å™¨</li><li>æŒä¹…åŒ–</li><li>Pubsub</li><li>å¤åˆ¶æ¨¡å—</li><li>luaè„šæœ¬</li></ul></li></ul></li><li>ä¸åŒç‚¹<ul><li>é›†ç¾¤æ¨¡å¼ä¸‹çš„æ•°æ®ä¼šè¢«ä¿å­˜åˆ°clusterNode, clusterLinkä»¥åŠclusterStateç»“æ„é‡Œé¢<ul><li>ä¸‹é¢æ˜¯ä¸‰ä¸ªç»“æ„çš„ä»£ç å®ç°</li><li>ä»¥åŠä¸€ä¸ªæœ‰ä¸‰ä¸ªèŠ‚ç‚¹çš„clusterStateç»“æ„</li></ul></li></ul></li></ul></li></ul><pre><code class="jsx">struct clusterNode &#123;    mstime_t ctime;    char name[REDIS_CLUSTER_NAMELEN];    // è®°å½•èŠ‚ç‚¹è§’è‰²ï¼ˆä¸»/ä»); è®°å½•èŠ‚ç‚¹ç›®å‰æ‰€å¤„çŠ¶æ€(åœ¨çº¿/ ä¸‹çº¿)    int flags;    // èŠ‚ç‚¹å½“å‰é…ç½®è®°å½•    unit64_t configEpoch;    char ip[REDIS_IP_STR_LEN];    int port;    // ä¿å­˜è¿æ¥èŠ‚ç‚¹éœ€è¦çš„ä¿¡æ¯    clusterLink *link;    // ....&#125;</code></pre><pre><code class="jsx">typedef struct clusterLink &#123;    mstime_t ctime;    // TCP å¥—æ¥å­—æè¿°ç¬¦    int fd;    // è¾“å‡ºç¼“å†²åŒºï¼Œä¿å­˜ç­‰å¾…è¦å‘é€ç»™å…¶ä»–èŠ‚ç‚¹çš„æ¶ˆæ¯    sds sndbuf;    // è¾“å…¥ç¼“å†²åŒºï¼Œä¿å­˜ç€ä»å…¶ä»–èŠ‚ç‚¹æ¥æ”¶åˆ°çš„æ¶ˆæ¯    sds rcvbuf;    // ä¸è¿™ä¸ªè¿æ¥ç›¸å…³è”çš„èŠ‚ç‚¹    struct clusterNode *node;    // ....&#125; clusterLink; </code></pre><pre><code class="jsx">typedef struct clusterState &#123;    clustNode *myself;    unit64_t currentEpoch;    // é›†ç¾¤å½“å‰çŠ¶æ€    int state;    // é›†ç¾¤ä¸­è‡³å°‘å¤„ç†ç€ä¸€ä¸ªæ§½çš„èŠ‚ç‚¹çš„æ•°é‡    int size;    // é›†ç¾¤èŠ‚ç‚¹åå•    dict *nodes;    // ....&#125; clusterState; </code></pre><p><img src="https://i.loli.net/2021/07/06/XxiOA9Qjz763K1Y.png" alt="clusterStateç¤ºæ„å›¾"></p><h1 id="3-æ§½æŒ‡æ´¾"><a href="#3-æ§½æŒ‡æ´¾" class="headerlink" title="3. æ§½æŒ‡æ´¾"></a>3. æ§½æŒ‡æ´¾</h1><ul><li>Redisé›†ç¾¤é€šè¿‡åˆ†ç‰‡çš„æ–¹å¼ä¿å­˜æ•°æ®åº“å½“ä¸­çš„é”®å€¼å¯¹<ul><li>æ•´ä¸ªæ•°æ®åº“è¢«åˆ†ä¸ºäº†16384ä¸ªslot</li><li>æ¯ä¸ªé”®éƒ½å±äºè¿™äº›æ§½å…¶ä¸­ä¹‹ä¸€</li><li>é›†ç¾¤å½“ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å¤„ç†0ä¸ªæˆ–è€…æœ€å¤š16384ä¸ªæ§½</li><li>å½“16383ä¸ªæ§½éƒ½æœ‰èŠ‚ç‚¹åœ¨å¤„ç†çš„æ—¶å€™ï¼Œé›†ç¾¤å¤„åœ¨ä¸Šçº¿çŠ¶æ€</li><li>åä¹‹ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªæ§½æ²¡æœ‰å¾—åˆ°å¤„ç†ï¼Œé‚£ä¹ˆé›†ç¾¤å°±åœ¨ä¸‹çº¿çŠ¶æ€</li></ul></li><li>å¦‚ä½•æŒ‡æ´¾æ§½<ul><li><code>CLUSTER ADDSLOTS &lt;slot&gt; [slot...]</code></li></ul></li></ul><h2 id="3-1-å¦‚ä½•è®°å½•æ§½æŒ‡æ´¾çš„ä¿¡æ¯"><a href="#3-1-å¦‚ä½•è®°å½•æ§½æŒ‡æ´¾çš„ä¿¡æ¯" class="headerlink" title="3.1 å¦‚ä½•è®°å½•æ§½æŒ‡æ´¾çš„ä¿¡æ¯"></a>3.1 å¦‚ä½•è®°å½•æ§½æŒ‡æ´¾çš„ä¿¡æ¯</h2><ul><li><p>clusterNodeç»“æ„é‡Œé¢æœ‰slotså±æ€§å’Œnumslotå±æ€§</p><ul><li><p>slots</p><ul><li><p>bit array</p></li><li><p>æ ¹æ®ç´¢å¼•iä¸Šçš„äºŒè¿›åˆ¶ä½çš„å€¼æ¥åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦è´Ÿè´£å¤„ç†æ§½i</p><p>  <img src="https://i.loli.net/2021/07/06/Zthejck4Xz2bPKl.png" alt="ç”¨bit arrayè®°å½•æ§½æŒ‡æ´¾ä¿¡æ¯"></p></li></ul></li></ul></li></ul><pre><code class="jsx">struct clusterNode &#123;    // ...    unsigned char slots[16384/8];    int numslots; &#125;</code></pre><h2 id="3-2-å¦‚ä½•ä¼ æ’­-æ§½æŒ‡æ´¾çš„ä¿¡æ¯"><a href="#3-2-å¦‚ä½•ä¼ æ’­-æ§½æŒ‡æ´¾çš„ä¿¡æ¯" class="headerlink" title="3.2 å¦‚ä½•ä¼ æ’­ æ§½æŒ‡æ´¾çš„ä¿¡æ¯"></a>3.2 å¦‚ä½•ä¼ æ’­ æ§½æŒ‡æ´¾çš„ä¿¡æ¯</h2><ul><li>ä¸€ä¸ªèŠ‚ç‚¹é™¤äº†è¦è®°å½•è‡ªå·±è´Ÿè´£å¤„ç†çš„æ§½ä»¥å¤–ï¼Œè¿˜è¦å°†è‡ªå·±çš„slotsé€šè¿‡æ¶ˆæ¯å‘é€ç»™é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œä»¥æ­¤å‘ŠçŸ¥å…¶ä»–ç»“ç‚¹è‡ªå·±ç›®å‰è´Ÿè´£çš„æ§½ä½</li><li>è€Œåæ§½ä¿¡æ¯ä¼šè¢«å­˜å‚¨åœ¨clusterState é‡Œé¢<ul><li>æŒ‡å‘çš„æ˜¯ä¸€ä¸ªclusterNodeç»“æ„ï¼</li></ul></li><li>è¿™é‡Œå¯¹æ¯” <code>clusterState.slots</code> ä»¥åŠ <code>clusterNode.slots</code> ï¼Œ å‰è€…è®°å½•äº†æ‰€æœ‰æ§½çš„æŒ‡æ´¾ä¿¡æ¯ï¼Œåè€…è®°å½•äº†å½“å‰çš„clusterNodeç»“æ„æ‰€ä»£è¡¨çš„èŠ‚ç‚¹çš„æ§½æŒ‡æ´¾ä¿¡æ¯  ä¸€ä¸ªè®°å½•äº†æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸€ä¸ªè®°å½•äº†éƒ¨åˆ†ä¿¡æ¯</li></ul><pre><code class="jsx">typedef struct clusterState &#123;    // ...    clusterNode *slots[16384];    // ... &#125;</code></pre><p><img src="https://i.loli.net/2021/07/06/4n1tgixR2NXOHdr.png" alt="æ§½æŒ‡æ´¾ä¿¡æ¯çš„ä¼ æ’­"></p><h1 id="4-åœ¨é›†ç¾¤ä¸­æ‰§è¡Œå‘½ä»¤"><a href="#4-åœ¨é›†ç¾¤ä¸­æ‰§è¡Œå‘½ä»¤" class="headerlink" title="4. åœ¨é›†ç¾¤ä¸­æ‰§è¡Œå‘½ä»¤"></a>4. åœ¨é›†ç¾¤ä¸­æ‰§è¡Œå‘½ä»¤</h1><h2 id="4-1-å‘é€æŒ‡ä»¤è¿‡ç¨‹"><a href="#4-1-å‘é€æŒ‡ä»¤è¿‡ç¨‹" class="headerlink" title="4.1 å‘é€æŒ‡ä»¤è¿‡ç¨‹"></a>4.1 å‘é€æŒ‡ä»¤è¿‡ç¨‹</h2><ul><li><p>å½“å®¢æˆ·ç«¯å‘èŠ‚ç‚¹å‘é€å’Œæ•°æ®åº“é”®æœ‰å…³çš„å‘½ä»¤çš„æ—¶å€™ï¼Œæ¥æ”¶å‘½ä»¤çš„èŠ‚ç‚¹ä¼šè®¡ç®—å‡ºå‘½ä»¤è¦å¤„ç†çš„æ•°æ®åº“é”®å±äºå“ªä¸€ä¸ªæ§½</p></li><li><p>æ£€æŸ¥è¿™ä¸ªæ§½æ˜¯å¦æŒ‡æ´¾ç»™äº†è‡ªå·±</p><ul><li><p>å¦‚æœæ­£å¥½æŒ‡æ´¾äº†ï¼ŒèŠ‚ç‚¹ç›´æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤</p></li><li><p>å¦‚æœæ²¡æœ‰ï¼ŒèŠ‚ç‚¹å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªMOVEDé”™è¯¯ï¼ŒæŒ‡å¼•å®¢æˆ·ç«¯è½¬å‘æ­£ç¡®çš„èŠ‚ç‚¹ï¼Œå¹¶å†æ¬¡å‘é€ä¹‹å‰æƒ³è¦æ‰§è¡Œçš„æŒ‡ä»¤</p><p>  <img src="https://i.loli.net/2021/07/06/MamzjpOhCXvwNI4.png" alt="movedæ‰§è¡Œé€»è¾‘"></p><p>  <img src="https://i.loli.net/2021/07/06/3rBPwlGVoITAJn7.png" alt="èŠ‚ç‚¹è¿”å›MOVED,IPä»¥åŠç«¯å£å·"></p><p>  <img src="https://i.loli.net/2021/07/06/zIOFRiGWZutUce9.png" alt="èŠ‚ç‚¹è½¬å‘"></p></li></ul></li></ul><h2 id="4-2-slots-to-keysè·³è·ƒè¡¨"><a href="#4-2-slots-to-keysè·³è·ƒè¡¨" class="headerlink" title="4.2 slots_to_keysè·³è·ƒè¡¨"></a>4.2 slots_to_keysè·³è·ƒè¡¨</h2><ul><li>å½“æœ‰æ–°çš„é”®å€¼å¯¹å¢åˆ çš„æ“ä½œæ—¶ï¼ŒèŠ‚ç‚¹ä¼šç”¨clusterStateç»“æ„ä¸­çš„slots_to_keysè·³è·ƒè¡¨æ¥ä¿å­˜æ§½å’Œé”®ä¹‹é—´çš„å…³ç³»</li></ul><pre><code class="jsx">typedef struct clusterState &#123;    // ...    zskiplist *slots_to_keys;    // ...&#125; clusterState; </code></pre><h1 id="5-é‡æ–°åˆ†ç‰‡æ“ä½œ"><a href="#5-é‡æ–°åˆ†ç‰‡æ“ä½œ" class="headerlink" title="5. é‡æ–°åˆ†ç‰‡æ“ä½œ"></a>5. é‡æ–°åˆ†ç‰‡æ“ä½œ</h1><h2 id="5-1-é‡åˆ†ç‰‡æµç¨‹"><a href="#5-1-é‡åˆ†ç‰‡æµç¨‹" class="headerlink" title="5.1 é‡åˆ†ç‰‡æµç¨‹"></a>5.1 é‡åˆ†ç‰‡æµç¨‹</h2><ul><li><p>å°†ä»»æ„æ•°é‡å·²ç»æŒ‡æ´¾ç»™æŸä¸ªèŠ‚ç‚¹çš„æ§½æ”¹ä¸ºæŒ‡æ´¾ç»™å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›¸å…³æ§½æ‰€å±çš„é”®å€¼å¯¹ä¹Ÿä¼šä»æºèŠ‚ç‚¹è¢«ç§»åŠ¨åˆ°ç›®æ ‡èŠ‚ç‚¹</p><p>  <img src="https://i.loli.net/2021/07/06/t5wivjMnQuIT2rG.png" alt="é‡åˆ†ç‰‡"></p></li></ul><h2 id="5-2-ASKé”™è¯¯"><a href="#5-2-ASKé”™è¯¯" class="headerlink" title="5.2 ASKé”™è¯¯"></a>5.2 ASKé”™è¯¯</h2><ul><li>å‘ç”Ÿäº†é‡åˆ†ç‰‡çš„è¿‡ç¨‹å½“ä¸­ï¼Œä¸€éƒ¨åˆ†é”®å·²ç»è½¬ç§»åˆ°äº†ç›®æ ‡èŠ‚ç‚¹ï¼Œå¦å¤–ä¸€éƒ¨åˆ†è¿˜åœ¨æºèŠ‚ç‚¹</li><li>è¿™ç§æƒ…å†µä¸‹ï¼Œå½“æ¥æ”¶åˆ°è¯·æ±‚ä¹‹å<ul><li>æºèŠ‚ç‚¹é¦–å…ˆåœ¨è‡ªå·±çš„æ•°æ®åº“é‡Œé¢æŸ¥æ‰¾æŒ‡å®šçš„é”®ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œç›´æ¥æ‰§è¡Œ</li><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼ŒæºèŠ‚ç‚¹ä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªASKï¼ŒæŒ‡å¼•å®¢æˆ·ç«¯è½¬å‘æ­£åœ¨å¯¼å…¥æ§½çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œå¹¶å†æ¬¡å‘é€ä¹‹å‰æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/06/nD7Ybyk1BHGzOC4.png" alt="ASKåˆ¤æ–­é€»è¾‘"></p><h1 id="6-å¤åˆ¶ä¸æ•…éšœè½¬ç§»"><a href="#6-å¤åˆ¶ä¸æ•…éšœè½¬ç§»" class="headerlink" title="6. å¤åˆ¶ä¸æ•…éšœè½¬ç§»"></a>6. å¤åˆ¶ä¸æ•…éšœè½¬ç§»</h1><ul><li><p>Redisé›†ç¾¤å½“ä¸­çš„èŠ‚ç‚¹åˆ†ä¸ºä¸»èŠ‚ç‚¹è¿˜æœ‰ä»èŠ‚ç‚¹</p></li><li><p>ä¸»èŠ‚ç‚¹ç”¨äºå¤„ç†æ§½ï¼Œè€Œä»èŠ‚ç‚¹ç”¨äºå¤åˆ¶æŸä¸ªä¸»èŠ‚ç‚¹ï¼Œå¹¶åœ¨è¢«å¤åˆ¶çš„ä¸»èŠ‚ç‚¹ä¸‹çº¿ä»¥åï¼Œä»£æ›¿ä¸‹çº¿ä¸»èŠ‚ç‚¹ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚</p></li><li><p>é€šè¿‡ <code>CLUSTER REPLICATE &lt;node_id&gt;</code> æ¥è®©æ¥å—å‘½ä»¤çš„èŠ‚ç‚¹æˆä¸ºä»èŠ‚ç‚¹ï¼Œå¹¶å¼€å§‹å¯¹ä¸»èŠ‚ç‚¹è¿›è¡Œå¤åˆ¶</p><ul><li>ä»èŠ‚ç‚¹ä¼šåœ¨è‡ªå·±çš„ clusterState.nodeså­—å…¸é‡Œ æ‰¾åˆ°ä¸»èŠ‚ç‚¹å¯¹è±¡çš„clusterNodeç»“æ„ï¼Œå¹¶å°†è‡ªå·±çš„ <code>clusterState.myself.slaveof</code>æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªç»“æ„ï¼Œä»¥æ­¤æ¥è®°å½•è¿™ä¸ªèŠ‚ç‚¹æ­£åœ¨å¤åˆ¶çš„ä¸»èŠ‚ç‚¹</li><li>è€Œåä¿®æ”¹åœ¨ <code>clusterStat.myslef.flags</code>ä¸­çš„å±æ€§  å…³é—­åŸæ¥çš„REDIS_NODE_MASTERæ ‡è¯†ï¼Œæ‰“å¼€REDIS_NODE_SLAVEæ ‡è¯†ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹å·²ç»ç”±åŸæ¥çš„ä¸»èŠ‚ç‚¹å˜æˆäº†ä»èŠ‚ç‚¹</li><li>æ ¹æ® <code>clusterState.myself.slaveof</code>æŒ‡å‘çš„clusterNodeç»“æ„çš„IPè¿˜æœ‰ç«¯å£å·ï¼Œå¼€å§‹å¯¹ä¸»èŠ‚ç‚¹çš„å¤åˆ¶å·¥ä½œ</li></ul></li><li><p>æ•…éšœæ£€æµ‹</p><ul><li>é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šå®šæœŸå‘å…¶ä»–èŠ‚ç‚¹å‘é€PINGæ¶ˆæ¯ï¼Œä»¥æ­¤æ£€æµ‹å¯¹æ–¹æ˜¯å¦åœ¨çº¿</li><li>å¦‚æœæ¥æ”¶PINGæ¶ˆæ¯çš„èŠ‚ç‚¹æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…ï¼Œè¿”å›PONGæ¶ˆæ¯ï¼Œé‚£ä¹ˆæ²¡å‘å›æ¶ˆæ¯çš„èŠ‚ç‚¹ä¼šè¢«æ ‡è®°ä¸ºprobable fail</li><li>é›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹ä¼šé€šè¿‡äº’ç›¸å‘é€æ¶ˆæ¯çš„æ–¹å¼æ¥äº¤æ¢é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ä¿¡æ¯<ul><li>åœ¨çº¿</li><li>ç–‘ä¼¼ä¸‹çº¿çŠ¶æ€ PFAIL</li><li>å·²ä¸‹çº¿çŠ¶æ€ FAIL</li></ul></li><li>ä¸»èŠ‚ç‚¹ä¼šè®°å½•å„ä¸ªèŠ‚ç‚¹çš„æŠ¥å‘Šå¦‚æœåŠæ•°ä»¥ä¸Šçš„è´Ÿè´£å¤„ç†æ§½çš„ä¸»èŠ‚ç‚¹éƒ½å°†æŸä¸ªä¸»èŠ‚ç‚¹xæŠ¥å‘Šä¸ºç–‘ä¼¼ä¸‹çº¿ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸»èŠ‚ç‚¹ä¼šè¢«æ ‡è®°ä¸ºå·²ä¸‹çº¿</li><li>è¯¥æ¶ˆæ¯ä¼šå‘é›†ç¾¤å¹¿æ’­å‡ºå»</li></ul></li><li><p>æ•…éšœè½¬ç§»</p><ul><li>åœ¨ä¸‹çº¿çš„ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹é‡Œé¢ï¼Œé€‰å‡ºä¸€ä¸ªä»èŠ‚ç‚¹<ul><li>é€šè¿‡é€‰ä¸¾äº§ç”Ÿ</li><li>å½“ä»èŠ‚ç‚¹å‘ç°ä¸»èŠ‚ç‚¹è¿›å…¥å·²ä¸‹çº¿çŠ¶æ€çš„æ—¶å€™ï¼Œä»èŠ‚ç‚¹ä¼šå‘é›†ç¾¤å¹¿æ’­ä¸€æ¡ <code>CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST</code> æ¶ˆæ¯ï¼Œè¦æ±‚æ‰€æœ‰æ”¶åˆ°è¿™æ¡æ¶ˆæ¯å¹¶ä¸”æœ‰æŠ•ç¥¨æƒçš„ä¸»èŠ‚ç‚¹å‘è¿™ä¸ªä»èŠ‚ç‚¹æŠ•ç¥¨</li><li>å¦‚æœä¸€ä¸ªä¸»èŠ‚ç‚¹æœ‰æŠ•ç¥¨æƒ(è´Ÿè´£å¤„ç†æ§½) ï¼Œä¸”è¿˜æœªæŠ•ç¥¨ç»™å…¶ä»–ä»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šå‘è¦æ±‚æŠ•ç¥¨çš„ä»èŠ‚ç‚¹è¿”å›ä¸€æ¡ <code>CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK</code></li><li>æ¯ä¸ªå‚ä¸é€‰ä¸¾çš„ä»èŠ‚ç‚¹ç»Ÿè®¡æ”¶è·åˆ°çš„ACKçš„æ•°é‡</li><li>å…·æœ‰æŠ•ç¥¨æƒçš„ä¸»èŠ‚ç‚¹æ•°é‡ä¸ºN  é‚£ä¹ˆä»èŠ‚ç‚¹éœ€è¦æ”¶é›†åˆ°å¤§äºç­‰äº N/2 +1 å¼ æ”¯æŒç¥¨æ¥è·å¾—ä¸»èŠ‚ç‚¹çš„æ”¯æŒ</li><li>å¦‚æœæ²¡æœ‰èŠ‚ç‚¹è·å¾—å¤§äºç­‰äº N/2 +1 å¼ æ”¯æŒç¥¨ï¼Œé‚£ä¹ˆå°±é‡æ–°å¼€å§‹é€‰ä¸¾</li></ul></li><li>è¢«é€‰ä¸­çš„ä»èŠ‚ç‚¹ä¼šæ‰§è¡ŒSLAVEOF no oneå‘½ä»¤ï¼Œæˆä¸ºæ–°çš„ä¸»èŠ‚ç‚¹</li><li>æ–°ä¸»èŠ‚ç‚¹ä¼šæ’¤é”€æ‰€æœ‰å¯¹å·²ä¸‹çº¿çš„ä¸»èŠ‚ç‚¹çš„æ§½æŒ‡æ´¾ï¼Œå¹¶å°†è¿™äº›æ§½å…¨éƒ¨æŒ‡æ´¾ç»™è‡ªå·±</li><li>æ–°çš„ä¸»èŠ‚ç‚¹å‘é›†ç¾¤å¹¿æ’­ä¸€æ¡PONGæ¶ˆæ¯ï¼Œä½¿å¾—é›†ç¾¤ä¸­çš„å…¶ä»–ç»“ç‚¹çŸ¥é“è¿™ä¸ªèŠ‚ç‚¹å·²ç»å˜æˆäº†ä¸»èŠ‚ç‚¹</li></ul></li></ul><h1 id="7-æ¶ˆæ¯"><a href="#7-æ¶ˆæ¯" class="headerlink" title="7. æ¶ˆæ¯"></a>7. æ¶ˆæ¯</h1><p>èŠ‚ç‚¹å‘é€çš„æ¶ˆæ¯ä¸»è¦æœ‰ä»¥ä¸‹5ç§ï¼š </p><ul><li>MEET<ul><li>è¦æ±‚æ¥å—è€…åŠ å…¥åˆ°å‘é€è€…å½“å‰æ‰€å¤„çš„é›†ç¾¤å½“ä¸­</li></ul></li><li>PING<ul><li>é›†ç¾¤é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹é»˜è®¤æ¯éš”ä¸€ç§’ä»å·²çŸ¥èŠ‚ç‚¹åˆ—è¡¨ä¸­éšæœºæŒ‘é€‰5ä¸ªç»“ç‚¹</li><li>ç„¶åå¯¹5ä¸ªå½“ä¸­æœ€é•¿æ—¶é—´æ²¡æœ‰å‘é€è¿‡PINGæ¶ˆæ¯çš„èŠ‚ç‚¹å‘é€PINGæ¶ˆæ¯</li></ul></li><li>PONG<ul><li>æ¥å‘ŠçŸ¥å‘é€è€…æˆåŠŸæ”¶åˆ°äº†MEETæˆ–è€…PINGæ¶ˆæ¯</li><li>ä¹Ÿå¯ä»¥é€šè¿‡é›†ç¾¤å¹¿æ’­PONG æ¥è®©å…¶ä»–èŠ‚ç‚¹åˆ·æ–°å¯¹è‡ªå·±çš„è®¤çŸ¥</li></ul></li><li>FAIL<ul><li>å½“ä¸»èŠ‚ç‚¹Aåˆ¤æ–­å¦ä¸€ä¸ªä¸»èŠ‚ç‚¹Bè¿›å…¥FAILçŠ¶æ€äº†ä»¥å</li><li>èŠ‚ç‚¹Aä¼šå‘é›†ç¾¤å¹¿æ’­ä¸€æ¡å…³äºèŠ‚ç‚¹B FAILçš„æ¶ˆæ¯</li><li>æ‰€æœ‰æ”¶åˆ°æ¶ˆæ¯çš„èŠ‚ç‚¹ä¼šå°†èŠ‚ç‚¹Bæ ‡è®°ä¸ºå·²ä¸‹çº¿</li></ul></li><li>PUBLISH<ul><li>å½“èŠ‚ç‚¹æ¥åˆ°ä¸€ä¸ªPUBLISHå‘½ä»¤çš„æ—¶å€™ï¼ŒèŠ‚ç‚¹ä¼šæ‰§è¡Œï¼Œå¹¶å‘é›†ç¾¤å¹¿æ’­ä¸€æ¡PUBLISHæ¶ˆæ¯</li><li>æ‰€æœ‰æ¥æ”¶åˆ°çš„èŠ‚ç‚¹éƒ½ä¼šæ‰§è¡Œç›¸åŒçš„PUBLISHå‘½ä»¤</li></ul></li></ul><h1 id="8-Redis-é›†ç¾¤æ‰©å±•ä¸è°ƒä¼˜"><a href="#8-Redis-é›†ç¾¤æ‰©å±•ä¸è°ƒä¼˜" class="headerlink" title="8. Redis é›†ç¾¤æ‰©å±•ä¸è°ƒä¼˜"></a>8. Redis é›†ç¾¤æ‰©å±•ä¸è°ƒä¼˜</h1><blockquote><p>å®é™…æ¡ˆä¾‹ï¼š 5000ä¸‡ä¸ªé”®å€¼å¯¹ï¼Œæ¯ä¸ªé”®å€¼å¯¹512B, å¦‚ä½•é€‰æ‹©äº‘ä¸»æœºçš„å†…å­˜å®¹é‡ï¼Ÿ</p></blockquote><ul><li><p>å ç”¨çš„å†…å­˜ç©ºé—´</p><ul><li>50MM x 512B = 25GB</li></ul></li><li><p>ä½¿ç”¨32GBä¸»æœºï¼Œä½†æ˜¯å‘ç°Rediså“åº”æœ‰æ—¶å€™ä¼šéå¸¸æ…¢</p><ul><li>æŸ¥è¯¢latest_fork_usec æŒ‡æ ‡ï¼Œå‘ç°å¿«åˆ°ç§’çº§åˆ«äº†</li></ul></li><li><p>RedisæŒä¹…åŒ–æœºåˆ¶</p><ul><li>RDBæŒä¹…åŒ–è¿‡ç¨‹å½“ä¸­ï¼ŒRedisä¼šforkå­è¿›ç¨‹æ¥å®Œæˆ</li><li>forkç”¨æ—¶å’ŒRedisçš„æ•°æ®é‡æ­£ç›¸å…³</li><li>forkåœ¨æ‰§è¡Œæ—¶ä¼šé˜»å¡ä¸»çº¿ç¨‹<ul><li>æ•°æ®é‡è¶Šå¤§ï¼Œforkæ“ä½œé€ æˆçš„ä¸»çº¿ç¨‹é˜»å¡æ—¶é—´å°±ä¼šè¶Šé•¿</li><li>å½“æˆ‘ä»¬å¯¹25GBçš„æ•°æ®è¿›è¡ŒæŒä¹…åŒ–çš„æ—¶å€™ï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œåå°è¿è¡Œçš„å­è¿›ç¨‹åœ¨forkåˆ›å»ºæ—¶é˜»å¡äº†ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´Rediså“åº”å˜æ…¢</li></ul></li></ul></li><li><p>åœ¨ä¸Šè¿°çš„ä¾‹å­é‡Œé¢ï¼Œä½¿ç”¨å•ä¸€redis instanceå·²ç»ä¸å¤Ÿäº†ï¼Œå› ä¸ºæˆ‘ä»¬è¦é€šè¿‡æ•°æ®åˆ‡ç‰‡æ¥å®ç°</p></li></ul><h2 id="8-1-å¦‚ä½•ä¿å­˜æ›´å¤šçš„æ•°æ®"><a href="#8-1-å¦‚ä½•ä¿å­˜æ›´å¤šçš„æ•°æ®" class="headerlink" title="8.1 å¦‚ä½•ä¿å­˜æ›´å¤šçš„æ•°æ®"></a>8.1 å¦‚ä½•ä¿å­˜æ›´å¤šçš„æ•°æ®</h2><ul><li>çºµå‘æ‰©å±•<ul><li>å‡çº§å•ä¸ªRediså®ä¾‹çš„èµ„æºé…ç½®<ul><li>å¢åŠ å†…å­˜å®¹é‡</li><li>å¢åŠ ç£ç›˜å®¹é‡</li><li>ä½¿ç”¨æ›´é«˜é…ç½®çš„CPU</li></ul></li></ul></li><li>æ¨ªå‘æ‰©å±•<ul><li>æ¨ªå‘å¢åŠ å½“å‰Rediså®ä¾‹çš„ä¸ªæ•°</li></ul></li></ul><h2 id="8-2-æ•°æ®åˆ‡ç‰‡å’Œå®ä¾‹çš„å¯¹è±¡åˆ†å¸ƒå…³ç³»"><a href="#8-2-æ•°æ®åˆ‡ç‰‡å’Œå®ä¾‹çš„å¯¹è±¡åˆ†å¸ƒå…³ç³»" class="headerlink" title="8.2 æ•°æ®åˆ‡ç‰‡å’Œå®ä¾‹çš„å¯¹è±¡åˆ†å¸ƒå…³ç³»"></a>8.2 æ•°æ®åˆ‡ç‰‡å’Œå®ä¾‹çš„å¯¹è±¡åˆ†å¸ƒå…³ç³»</h2><ul><li>Redis clusteré‡‡ç”¨å“ˆå¸Œæ§½æ¥å¤„ç†æ•°æ®å’Œå®ä¾‹ä¹‹é—´çš„æ˜ å°„å…³ç³»<ul><li>ä¸€ä¸ªåˆ‡ç‰‡é›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½</li><li>æ¯ä¸ªé”®å€¼éƒ½ä¼šæ ¹æ®å®ƒçš„keyï¼Œè¢«æ˜ å°„åˆ°ä¸€ä¸ªå“ˆå¸Œæ§½å½“ä¸­</li></ul></li><li>å…·ä½“æ˜ å°„è¿‡ç¨‹<ul><li>æ ¹æ®é”®å€¼å¯¹çš„keyï¼ŒæŒ‰ç…§CRC16ç®—æ³•è®¡ç®—ä¸€ä¸ª16bitçš„å€¼</li><li>ç”¨è¿™ä¸ª16bitçš„å€¼å¯¹16384å–æ¨¡</li></ul></li><li>reidså¦‚ä½•åˆå§‹åŒ–å„ä¸ªå®ä¾‹æ¥åˆ†é…è¿™äº›æ§½çš„ï¼Ÿ<ul><li>éƒ¨ç½²çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°cluster createå‘½ä»¤åˆ›å»ºé›†ç¾¤</li><li>Redisä¼šåœ¨æ­¤æ—¶å°†è¿™äº›æ§½å¹³å‡åˆ†åˆ«åœ¨é›†ç¾¤å®ä¾‹å½“ä¸­</li></ul></li></ul><h2 id="8-3-å®¢æˆ·ç«¯å¦‚ä½•å®šä½æ•°æ®çš„"><a href="#8-3-å®¢æˆ·ç«¯å¦‚ä½•å®šä½æ•°æ®çš„" class="headerlink" title="8.3 å®¢æˆ·ç«¯å¦‚ä½•å®šä½æ•°æ®çš„"></a>8.3 å®¢æˆ·ç«¯å¦‚ä½•å®šä½æ•°æ®çš„</h2><ul><li><p>å®¢æˆ·ç«¯å®šä½é”®å€¼å¯¹çš„æ—¶å€™ï¼Œclient libraryæ˜¯å¯ä»¥è®¡ç®—å‡ºå“ˆå¸Œæ§½æ˜¯å“ªä¸ªçš„ï¼Œä½†æ˜¯å¦‚ä½•å®šä½åˆ°åœ¨å“ªä¸ªå®ä¾‹ä¸Šæ˜¯ä¸ªé—®é¢˜</p><ul><li>æ‹¿åˆ°å®ä¾‹å‘è¿‡æ¥çš„ä¿¡æ¯ï¼Œç¼“å­˜åˆ°æœ¬åœ°ä¸Š</li></ul></li><li><p>æœ€å¼€å§‹</p><ul><li>æ¯ä¸ªå®ä¾‹éƒ½åªçŸ¥é“è‡ªå·±è¢«åˆ†é…äº†å“ªäº›å“ˆå¸Œæ§½çš„ä¿¡æ¯ï¼Œå¹¶ä¸çŸ¥é“å…¶ä»–å®ä¾‹æ‹¥æœ‰çš„å“ˆå¸Œæ§½ä¿¡æ¯</li></ul></li><li><p>å®¢æˆ·ç«¯å’Œé›†ç¾¤å®ä¾‹å»ºç«‹è¿æ¥å</p><ul><li>å®ä¾‹ä¼šæŠŠå“ˆå¸Œæ§½çš„åˆ†é…ä¿¡æ¯å‘å›ç»™å®¢æˆ·ç«¯</li><li>å„ä¸ªRediså®ä¾‹ä¼šäº’ç›¸è¿é€šï¼Œå®Œæˆå“ˆå¸Œæ§½ä¿¡æ¯çš„æ‰©æ•£</li></ul></li><li><p>Redis Clusterçš„é‡å®šå‘æœºåˆ¶</p><ul><li>ä¸ºä»€ä¹ˆéœ€è¦<ul><li>å®¢æˆ·ç«¯çš„ç¼“å­˜æ²¡æœ‰æ‹¿åˆ°æœ€æ–°çš„ä¿¡æ¯<ul><li>é›†ç¾¤ä¸­å®ä¾‹æœ‰æ–°å¢æˆ–è€…åˆ é™¤</li><li>Redis é‡æ–°åˆ†é…å“ˆå¸Œæ§½</li></ul></li></ul></li><li>å¦‚ä½•å®ç°çš„<ul><li>å®¢æˆ·ç«¯ç»™ä¸€ä¸ªå®ä¾‹å‘é€è¯»å†™æ“ä½œï¼Œä½†æ˜¯è¿™ä¸ªå®ä¾‹æ²¡æœ‰ç›¸åº”çš„æ•°æ®</li><li>å®ä¾‹å‘å›ä¸€ä¸ªMOVEDå“åº”ï¼ŒåŒ…æ‹¬äº†æ–°å®ä¾‹çš„è®¿é—®åœ°å€</li></ul></li></ul></li></ul><p>Redisä½¿ç”¨é›†ç¾¤æ–¹æ¡ˆå°±æ˜¯ä¸ºäº†è§£å†³å•ä¸ªèŠ‚ç‚¹æ•°æ®é‡å¤§ã€å†™å…¥é‡å¤§äº§ç”Ÿçš„æ€§èƒ½ç“¶é¢ˆçš„é—®é¢˜ã€‚å¤šä¸ªèŠ‚ç‚¹ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå¯ä»¥æé«˜é›†ç¾¤çš„æ€§èƒ½å’Œå¯é æ€§ï¼Œä½†éšä¹‹è€Œæ¥çš„å°±æ˜¯é›†ç¾¤çš„ç®¡ç†é—®é¢˜ï¼Œæœ€æ ¸å¿ƒé—®é¢˜æœ‰2ä¸ªï¼šè¯·æ±‚è·¯ç”±ã€æ•°æ®è¿ç§»ï¼ˆæ‰©å®¹/ç¼©å®¹/æ•°æ®å¹³è¡¡ï¼‰ã€‚</p><p>1ã€è¯·æ±‚è·¯ç”±ï¼šä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨å“ˆå¸Œæ§½çš„æ˜ å°„å…³ç³»è¡¨æ‰¾åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶ååœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šæ“ä½œçš„æ–¹æ¡ˆã€‚</p><p>Redis</p><p>Clusteråœ¨æ¯ä¸ªèŠ‚ç‚¹è®°å½•å®Œæ•´çš„æ˜ å°„å…³ç³»(ä¾¿äºçº æ­£å®¢æˆ·ç«¯çš„é”™è¯¯è·¯ç”±è¯·æ±‚)ï¼ŒåŒæ—¶ä¹Ÿå‘ç»™å®¢æˆ·ç«¯è®©å®¢æˆ·ç«¯ç¼“å­˜ä¸€ä»½ï¼Œä¾¿äºå®¢æˆ·ç«¯ç›´æ¥æ‰¾åˆ°æŒ‡å®šèŠ‚ç‚¹ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é…åˆå®Œæˆæ•°æ®çš„è·¯ç”±ï¼Œè¿™éœ€è¦ä¸šåŠ¡åœ¨ä½¿ç”¨Redis<br> Clusteræ—¶ï¼Œå¿…é¡»å‡çº§ä¸ºé›†ç¾¤ç‰ˆçš„SDKæ‰æ”¯æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åè®®äº¤äº’ã€‚</p><p>å…¶ä»–Redisé›†ç¾¤åŒ–æ–¹æ¡ˆä¾‹å¦‚Twemproxyã€Codiséƒ½æ˜¯ä¸­å¿ƒåŒ–æ¨¡å¼ï¼ˆå¢åŠ Proxyå±‚ï¼‰ï¼Œå®¢æˆ·ç«¯é€šè¿‡Proxyå¯¹æ•´ä¸ªé›†ç¾¤è¿›è¡Œæ“ä½œï¼ŒProxyåé¢å¯ä»¥æŒ‚Nå¤šä¸ªRediså®ä¾‹ï¼ŒProxyå±‚ç»´æŠ¤äº†è·¯ç”±çš„è½¬å‘é€»è¾‘ã€‚æ“ä½œProxyå°±åƒæ˜¯æ“ä½œä¸€ä¸ªæ™®é€šRedisä¸€æ ·ï¼Œå®¢æˆ·ç«¯ä¹Ÿä¸éœ€è¦æ›´æ¢SDKï¼Œè€ŒRedis<br> Clusteræ˜¯æŠŠè¿™äº›è·¯ç”±é€»è¾‘åšåœ¨äº†SDKä¸­ã€‚å½“ç„¶ï¼Œå¢åŠ ä¸€å±‚Proxyä¹Ÿä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚</p><p>2ã€æ•°æ®è¿ç§»ï¼šå½“é›†ç¾¤èŠ‚ç‚¹ä¸è¶³ä»¥æ”¯æ’‘ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œå°±éœ€è¦æ‰©å®¹èŠ‚ç‚¹ï¼Œæ‰©å®¹å°±æ„å‘³ç€èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®éœ€è¦åšè¿ç§»ï¼Œè€Œè¿ç§»è¿‡ç¨‹ä¸­æ˜¯å¦ä¼šå½±å“åˆ°ä¸šåŠ¡ï¼Œè¿™ä¹Ÿæ˜¯åˆ¤å®šä¸€ä¸ªé›†ç¾¤æ–¹æ¡ˆæ˜¯å¦æˆç†Ÿçš„æ ‡å‡†ã€‚</p><p>Twemproxyä¸æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œå®ƒåªè§£å†³äº†è¯·æ±‚è·¯ç”±çš„é—®é¢˜ï¼Œæ‰©å®¹æ—¶éœ€è¦åœæœºåšæ•°æ®é‡æ–°åˆ†é…ã€‚è€ŒRedis</p><p>Clusterå’ŒCodiséƒ½åšåˆ°äº†åœ¨çº¿æ‰©å®¹ï¼ˆä¸å½±å“ä¸šåŠ¡æˆ–å¯¹ä¸šåŠ¡çš„å½±å“éå¸¸å°ï¼‰ï¼Œé‡ç‚¹å°±æ˜¯åœ¨æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å¯¹äºæ­£åœ¨è¿ç§»çš„keyè¿›è¡Œæ“ä½œæ—¶ï¼Œé›†ç¾¤å¦‚ä½•å¤„ç†ï¼Ÿè¿˜è¦ä¿è¯å“åº”æ­£ç¡®çš„ç»“æœï¼Ÿ</p><p>Redis</p><p>Clusterå’ŒCodiséƒ½éœ€è¦æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯/Proxyå±‚äº’ç›¸é…åˆï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯é’ˆå¯¹æ­£åœ¨è¿ç§»çš„keyï¼Œéœ€è¦è®©å®¢æˆ·ç«¯æˆ–Proxyå»æ–°èŠ‚ç‚¹è®¿é—®ï¼ˆé‡å®šå‘ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸ºäº†ä¿è¯ä¸šåŠ¡åœ¨è®¿é—®è¿™äº›keyæ—¶ä¾æ—§ä¸å—å½±å“ï¼Œè€Œä¸”å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ç”±äºé‡å®šå‘çš„å­˜åœ¨ï¼Œæ‰€ä»¥è¿™ä¸ªæœŸé—´çš„è®¿é—®å»¶è¿Ÿä¼šå˜å¤§ã€‚ç­‰è¿ç§»å®Œæˆä¹‹åï¼ŒRedis</p><p>Clusteræ¯ä¸ªèŠ‚ç‚¹ä¼šæ›´æ–°è·¯ç”±æ˜ å°„è¡¨ï¼ŒåŒæ—¶ä¹Ÿä¼šè®©å®¢æˆ·ç«¯æ„ŸçŸ¥åˆ°ï¼Œæ›´æ–°å®¢æˆ·ç«¯ç¼“å­˜ã€‚Codisä¼šåœ¨Proxyå±‚æ›´æ–°è·¯ç”±è¡¨ï¼Œå®¢æˆ·ç«¯åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­æ— æ„ŸçŸ¥ã€‚</p><p>é™¤äº†è®¿é—®æ­£ç¡®çš„èŠ‚ç‚¹ä¹‹å¤–ï¼Œæ•°æ®è¿ç§»è¿‡ç¨‹ä¸­è¿˜éœ€è¦è§£å†³å¼‚å¸¸æƒ…å†µï¼ˆè¿ç§»è¶…æ—¶ã€è¿ç§»å¤±è´¥ï¼‰ã€æ€§èƒ½é—®é¢˜ï¼ˆå¦‚ä½•è®©æ•°æ®è¿ç§»æ›´å¿«ã€bigkeyå¦‚ä½•å¤„ç†ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­çš„ç»†èŠ‚ä¹Ÿå¾ˆå¤šã€‚</p><p>Redis Clusterçš„æ•°æ®è¿ç§»æ˜¯åŒæ­¥çš„ï¼Œè¿ç§»ä¸€ä¸ªkeyä¼šåŒæ—¶é˜»å¡æºèŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚è€ŒCodisæä¾›äº†å¼‚æ­¥è¿ç§»æ•°æ®çš„æ–¹æ¡ˆï¼Œè¿ç§»é€Ÿåº¦æ›´å¿«ï¼Œå¯¹æ€§èƒ½å½±å“æœ€å°ï¼Œå½“ç„¶ï¼Œå®ç°æ–¹æ¡ˆä¹Ÿæ¯”è¾ƒå¤æ‚ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>æå®¢æ—¶é—´-Redisæ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Rediså¤šæœºæ•°æ®åº“-æ•°æ®åŒæ­¥</title>
      <link href="/Redis%E5%A4%9A%E6%9C%BA%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/"/>
      <url>/Redis%E5%A4%9A%E6%9C%BA%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="Rediså¤šæœºæ•°æ®åº“-æ•°æ®åŒæ­¥"><a href="#Rediså¤šæœºæ•°æ®åº“-æ•°æ®åŒæ­¥" class="headerlink" title="Rediså¤šæœºæ•°æ®åº“-æ•°æ®åŒæ­¥"></a>Rediså¤šæœºæ•°æ®åº“-æ•°æ®åŒæ­¥</h1><h1 id="1-Redisçš„é«˜å¯é æ€§"><a href="#1-Redisçš„é«˜å¯é æ€§" class="headerlink" title="1. Redisçš„é«˜å¯é æ€§"></a>1. Redisçš„é«˜å¯é æ€§</h1><p>Redisçš„é«˜å¯é æ€§ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š</p><ul><li>æ•°æ®å°½é‡å°‘ä¸¢å¤±<ul><li>AOF</li><li>RDB</li></ul></li><li>æœåŠ¡å°½é‡å°‘ä¸­æ–­<ul><li>å¢åŠ å‰¯æœ¬å†—ä½™é‡ â€” å°†ä¸€ä»½æ•°æ®åŒæ—¶ä¿å­˜åœ¨å¤šä¸ªå®ä¾‹ä¸Š</li></ul></li></ul><h1 id="2-æ•°æ®åŒæ­¥-â€”-ä¸»ä»åº“æ¨¡å¼"><a href="#2-æ•°æ®åŒæ­¥-â€”-ä¸»ä»åº“æ¨¡å¼" class="headerlink" title="2. æ•°æ®åŒæ­¥ â€” ä¸»ä»åº“æ¨¡å¼"></a>2. æ•°æ®åŒæ­¥ â€” ä¸»ä»åº“æ¨¡å¼</h1><ul><li><p>ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼</p><ul><li><p>è¯»æ“ä½œ</p><ul><li>ä¸»åº“ï¼Œä»åº“éƒ½å¯ä»¥æ¥æ”¶</li></ul></li><li><p>å†™æ“ä½œ</p><ul><li><p>é¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œ</p></li><li><p>ç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“</p><p>  <img src="https://i.loli.net/2021/01/04/8wE4dPDgFxqRX6r.png" alt="https://i.loli.net/2021/01/04/8wE4dPDgFxqRX6r.png"></p><p>  ä¸»ä»è¯»å†™åˆ†ç¦»</p></li></ul></li></ul></li><li><p>ä¸»ä»åº“çš„å¥½å¤„æ˜¯ä¿®æ”¹æ“ä½œéƒ½åªä¼šåœ¨ä¸€ä¸ªåº“å®ç°</p><ul><li>å¯ä»¥å‡å°‘åŠ é”ï¼Œå®ä¾‹é—´åå•†è¿™ç±»å¼€é”€</li></ul></li></ul><h2 id="2-1-ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ"><a href="#2-1-ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ" class="headerlink" title="2.1 ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ"></a>2.1 ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ</h2><ul><li><p>å¤šä¸ªRediså®ä¾‹ä¹‹é—´é€šè¿‡replicaof/ slaveofå‘½ä»¤å½¢æˆä¸»åº“å’Œä»åº“çš„å…³ç³»ï¼Œç„¶åæŒ‰ç…§ä¸‰ä¸ªé˜¶æ®µå®Œæˆæ•°æ®çš„ç¬¬ä¸€æ¬¡åŒæ­¥ï¼š</p><p>  <img src="https://i.loli.net/2021/01/04/KZemoVB6CFjNlJI.png" alt="https://i.loli.net/2021/01/04/KZemoVB6CFjNlJI.png"></p><p>  ä¸»ä»é¦–æ¬¡åŒæ­¥è¿‡ç¨‹</p></li><li><p>ç¬¬ä¸€é˜¶æ®µ</p><ul><li><p>ä¸»ä»åº“ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œåå•†åŒæ­¥</p></li><li><p>ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡</p></li><li><p>ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤ä»¥åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†</p><ul><li><p>ä»åº“ç»™ä¸»åº“å‘é€psyncå‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥</p></li><li><p>ä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶</p><ul><li>psyncå‘½ä»¤åŒ…å«ä¸»åº“çš„runIdå’Œå¤åˆ¶è¿›åº¦çš„offsetä¸¤ä¸ªå‚æ•°<ul><li>runID â€” Rediså®ä¾‹å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨éšæœºç”Ÿæˆçš„IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†å½“å‰å®ä¾‹<ul><li>runIdå¾ˆå…³é”®ï¼Œæ¯”å¦‚ä»æœåŠ¡å™¨æ–­çº¿é‡è¿ä¸»æœåŠ¡å™¨ä»¥åï¼Œä¼šå‘é€ä¹‹å‰ä¿å­˜çš„ä¸»æœåŠ¡å™¨çš„è¿è¡ŒIDï¼Œå¦‚æœIDä¸€è‡´ï¼Œè¯´æ˜å‰åè¿æ¥çš„æ˜¯åŒä¸€ä¸ªä¸»æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç»§ç»­å°è¯•æ‰§è¡Œéƒ¨åˆ†çš„é‡åŒæ­¥æ“ä½œ</li><li>ç›¸åï¼Œå¦‚æœè¿è¡ŒIDä¸åŒï¼Œé‚£ä¹ˆå°±å¿…é¡»é€šè¿‡RDBå®Œæˆæ•´ä¸ªé‡åŒæ­¥æ“ä½œ</li></ul></li><li>offset æ­¤æ—¶è®¾ä¸º-1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶</li></ul></li></ul></li><li><p>ä¸»åº“æ”¶åˆ°psyncå‘½ä»¤åï¼Œä½¿ç”¨FULLRESYNCå“åº”å‘½ä»¤ï¼ŒåŒ…æ‹¬äº†ä¸»åº“çš„runIDè¿˜æœ‰ä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦offsetï¼Œè¿”å›ç»™ä»åº“</p><ul><li>ä»åº“è®°å½•ä¸‹ä¸¤ä¸ªå‚æ•°</li></ul></li><li><p>FULLRESYNCè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ä½¿ç”¨çš„æ˜¯å…¨é‡å¤åˆ¶</p></li><li><p>ä¸»åº“ä¸æ­¤åŒæ—¶æ‰§è¡ŒBGSAVEå‘½ä»¤ï¼Œåœ¨åå°ç”Ÿæˆä¸€ä¸ªRDBæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªç¼“å†²åŒºè®°å½•ä»ç°åœ¨å¼€å§‹æ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤</p><p>  <img src="https://i.loli.net/2021/07/05/Kmw8ZsWuzGki25V.png" alt="ä¸»ä»æœåŠ¡å™¨åŒæ­¥è¿‡ç¨‹"></p></li></ul></li></ul></li><li><p>ç¬¬äºŒé˜¶æ®µ</p><ul><li>ä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“</li><li>ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ â€” ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„RDBæ–‡ä»¶<ul><li>ä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚</li><li>ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆ<strong>æ¸…ç©ºå½“å‰æ•°æ®åº“</strong>ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚<ul><li>è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©º</li></ul></li></ul></li><li>åœ¨åšæ•°æ®åŒæ­¥çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ã€‚å¯¹äºè¿™ä¸ªè¿‡ç¨‹ä¸­æ¥æ”¶åˆ°çš„æ­£å¸¸è¯·æ±‚ï¼Œå†™æ“ä½œä¼šè®°å½•åœ¨ä¸»åº“çš„<strong>Replication Buffer</strong>å½“ä¸­</li></ul></li><li><p>ç¬¬ä¸‰é˜¶æ®µ</p><ul><li>ä¸»åº“ä¼šå°†ç¬¬äºŒé˜¶æ®µæ–°æ”¶åˆ°çš„ä¿®æ”¹å‘½ä»¤ï¼Œå†å‘ç»™ä»åº“</li><li>å½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†</li></ul></li></ul><h2 id="2-2-ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›"><a href="#2-2-ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›" class="headerlink" title="2.2 ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›"></a>2.2 ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›</h2><ul><li><p>ç°çŠ¶/ é—®é¢˜</p><ul><li>ä¸€æ¬¡å…¨é‡å¤åˆ¶ä¸»åº“éœ€è¦å®Œæˆä¸¤ä¸ªè€—æ—¶æ“ä½œ<ul><li>ç”ŸæˆRDBæ–‡ä»¶å’Œä¼ è¾“RDBæ–‡ä»¶</li></ul></li><li>å¦‚æœä»åº“æ•°é‡å¾ˆå¤šï¼Œè€Œä¸”éƒ½è¦å’Œä¸»åº“è¿›è¡Œå…¨é‡å¤åˆ¶çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ä¸»åº“å¿™äº fork å­è¿›ç¨‹ç”Ÿæˆ RDB æ–‡ä»¶ï¼Œè¿›è¡Œæ•°æ®å…¨é‡åŒæ­¥ã€‚fork è¿™ä¸ªæ“ä½œä¼šé˜»å¡ä¸»çº¿ç¨‹å¤„ç†æ­£å¸¸è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ä¸»åº“å“åº”åº”ç”¨ç¨‹åºçš„è¯·æ±‚é€Ÿåº¦å˜æ…¢ã€‚</li><li>ä¼ è¾“ RDB æ–‡ä»¶ä¹Ÿä¼šå ç”¨ä¸»åº“çš„ç½‘ç»œå¸¦å®½ï¼ŒåŒæ ·ä¼šç»™ä¸»åº“çš„èµ„æºä½¿ç”¨å¸¦æ¥å‹åŠ›</li></ul></li><li><p>è§£å†³æ–¹æ¡ˆ â€” ä¸»ä»ä»æ¨¡å¼</p><ul><li><p>æˆ‘ä»¬åœ¨éƒ¨ç½²ä¸»ä»é›†ç¾¤çš„æ—¶å€™ï¼Œå¯ä»¥æ‰‹åŠ¨é€‰æ‹©ä¸€ä¸ªä»åº“ï¼ˆæ¯”å¦‚é€‰æ‹©å†…å­˜èµ„æºé…ç½®è¾ƒé«˜çš„ä»åº“ï¼‰ï¼Œç”¨äºçº§è”å…¶ä»–çš„ä»åº“ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å†é€‰æ‹©ä¸€äº›ä»åº“ï¼ˆä¾‹å¦‚ä¸‰åˆ†ä¹‹ä¸€çš„ä»åº“ï¼‰ï¼Œåœ¨è¿™äº›ä»åº“ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè®©å®ƒä»¬å’Œåˆšæ‰æ‰€é€‰çš„ä»åº“ï¼Œå»ºç«‹èµ·ä¸»ä»å…³ç³»ã€‚replicaof æ‰€é€‰ä»åº“çš„IP 6379</p><p><img src="https://i.loli.net/2021/01/04/eihQpmN6FJdRxLy.png" alt="https://i.loli.net/2021/01/04/eihQpmN6FJdRxLy.png"></p></li></ul></li></ul><h2 id="2-3-çªå‘æƒ…å†µä¸‹-æš‚æ—¶æ–­ç½‘-çš„å¢é‡å¤åˆ¶"><a href="#2-3-çªå‘æƒ…å†µä¸‹-æš‚æ—¶æ–­ç½‘-çš„å¢é‡å¤åˆ¶" class="headerlink" title="2.3 çªå‘æƒ…å†µä¸‹(æš‚æ—¶æ–­ç½‘)çš„å¢é‡å¤åˆ¶"></a>2.3 çªå‘æƒ…å†µä¸‹(æš‚æ—¶æ–­ç½‘)çš„å¢é‡å¤åˆ¶</h2><ul><li><p>æ—§ç‰ˆredisåœ¨æ–­å¼€é‡è¿ä»¥åä»æœåŠ¡å™¨ä¼šå‘ä¸»æœåŠ¡å™¨å‘å‡ºSYNCå‘½ä»¤ï¼Œä»å¤´å¼€å§‹è¿›è¡Œbootstrapï¼Œæ—¶é—´ä¼šéå¸¸é•¿ï¼Œéå¸¸ä½æ•ˆ</p></li><li><p>æ–°ç‰ˆæœ¬ä½¿ç”¨PSYNC</p><ul><li>PSYNCå…·æœ‰full resynchronization, partial resynchronizationä¸¤ç§æ¨¡å¼</li><li>partial resyncä½¿å¾—æ–­çº¿é‡è¿ä»¥åå¯ä»¥é€šè¿‡å¢é‡æ¥åšå¤åˆ¶ï¼Œè€Œä¸æ˜¯ç”¨RDBé‡å¤´å¼€å§‹</li></ul></li><li><p>ç½‘ç»œæ–­äº†ä»¥åæˆ‘ä»¬éœ€è¦ä¸€ç§å¼€é”€ç›¸å¯¹åˆç†çš„å¤åˆ¶æ–¹å¼ï¼Œå³å¢é‡å¤åˆ¶</p><ul><li>å°†ä¸»ä»åº“æ–­è”æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“</li></ul></li><li><p>å¢é‡å¤åˆ¶çš„æ—¶å€™ï¼Œä¸»ä»åº“ä¹‹é—´ä¾é repl_backlog_bufferè¿™ä¸ªç¼“å†²åŒºæ¥åšåŒæ­¥</p></li><li><p>æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>å½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ <strong>replication buffer</strong>ï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ <strong>repl_backlog_buffer</strong> è¿™ä¸ªç¼“å†²åŒºã€‚</p></li><li><p>repl_backlog_buffer æ˜¯ä¸€ä¸ª<strong>ç¯å½¢ç¼“å†²åŒº</strong>ï¼Œä¸»åº“ä¼šè®°å½•è‡ªå·±å†™åˆ°çš„ä½ç½®ï¼Œä»åº“åˆ™ä¼šè®°å½•è‡ªå·±å·²ç»è¯»åˆ°çš„ä½ç½®ã€‚</p></li><li><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œä¸»åº“å’Œä»åº“çš„å†™è¯»ä½ç½®åœ¨ä¸€èµ·ï¼Œè¿™ç®—æ˜¯å®ƒä»¬çš„èµ·å§‹ä½ç½®ã€‚éšç€ä¸»åº“ä¸æ–­æ¥æ”¶æ–°çš„å†™æ“ä½œï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„å†™ä½ç½®ä¼šé€æ­¥åç¦»èµ·å§‹ä½ç½®ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åç§»é‡æ¥è¡¡é‡è¿™ä¸ªåç§»è·ç¦»çš„å¤§å°ï¼Œå¯¹ä¸»åº“æ¥è¯´ï¼Œå¯¹åº”çš„åç§»é‡å°±æ˜¯ master_repl_offsetã€‚ä¸»åº“æ¥æ”¶çš„æ–°å†™æ“ä½œè¶Šå¤šï¼Œè¿™ä¸ªå€¼å°±ä¼šè¶Šå¤§ã€‚</p></li><li><p>åŒæ ·ï¼Œä»åº“åœ¨å¤åˆ¶å®Œå†™æ“ä½œå‘½ä»¤åï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„è¯»ä½ç½®ä¹Ÿå¼€å§‹é€æ­¥åç§»åˆšæ‰çš„èµ·å§‹ä½ç½®ï¼Œæ­¤æ—¶ï¼Œä»åº“å·²å¤åˆ¶çš„åç§»é‡ slave_repl_offset ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªåç§»é‡åŸºæœ¬ç›¸ç­‰ã€‚</p></li><li><p>ä¸»ä»åº“çš„è¿æ¥æ¢å¤ä¹‹åï¼Œä»åº“é¦–å…ˆä¼šç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œå¹¶æŠŠè‡ªå·±å½“å‰çš„ slave_repl_offset å‘ç»™ä¸»åº“ï¼Œä¸»åº“ä¼šåˆ¤æ–­è‡ªå·±çš„ master_repl_offset å’Œ slave_repl_offset ä¹‹é—´çš„å·®è·</p></li><li><p>åœ¨ç½‘ç»œæ–­è¿é˜¶æ®µï¼Œä¸»åº“å¯èƒ½ä¼šæ”¶åˆ°æ–°çš„å†™æ“ä½œå‘½ä»¤ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œmaster_repl_offset ä¼šå¤§äº slave_repl_offsetã€‚æ­¤æ—¶ï¼Œä¸»åº“åªç”¨æŠŠ master_repl_offset å’Œ slave_repl_offset ä¹‹é—´çš„å‘½ä»¤æ“ä½œåŒæ­¥ç»™ä»åº“å°±è¡Œã€‚å°±åƒåˆšåˆšç¤ºæ„å›¾çš„ä¸­é—´éƒ¨åˆ†ï¼Œä¸»åº“å’Œä»åº“ä¹‹é—´ç›¸å·®äº† put d e å’Œ put d f ä¸¤ä¸ªæ“ä½œï¼Œåœ¨å¢é‡å¤åˆ¶æ—¶ï¼Œä¸»åº“åªéœ€è¦æŠŠå®ƒä»¬åŒæ­¥ç»™ä»åº“ï¼Œå°±è¡Œäº†ã€‚</p><p><img src="https://i.loli.net/2021/01/04/w3TLhzRgOH2A65d.png" alt="https://i.loli.net/2021/01/04/w3TLhzRgOH2A65d.png"></p></li></ul></li></ul><blockquote><p>å› ä¸º repl_backlog_buffer æ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œæ‰€ä»¥åœ¨ç¼“å†²åŒºå†™æ»¡åï¼Œä¸»åº“ä¼šç»§ç»­å†™å…¥ï¼Œæ­¤æ—¶ï¼Œå°±ä¼šè¦†ç›–æ‰ä¹‹å‰å†™å…¥çš„æ“ä½œã€‚å¦‚æœä»åº“çš„è¯»å–é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´ä»åº“è¿˜æœªè¯»å–çš„æ“ä½œè¢«ä¸»åº“æ–°å†™çš„æ“ä½œè¦†ç›–äº†ï¼Œè¿™ä¼šå¯¼è‡´ä¸»ä»åº“é—´çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p></blockquote><p>æˆ‘ä»¬è¦æƒ³åŠæ³•é¿å…è¿™ä¸€æƒ…å†µï¼Œä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ repl_backlog_size è¿™ä¸ªå‚æ•°ã€‚è¿™ä¸ªå‚æ•°å’Œæ‰€éœ€çš„ç¼“å†²ç©ºé—´å¤§å°æœ‰å…³ã€‚ç¼“å†²ç©ºé—´çš„è®¡ç®—å…¬å¼æ˜¯ï¼š<strong>ç¼“å†²ç©ºé—´å¤§å° = ä¸»åº“å†™å…¥å‘½ä»¤é€Ÿåº¦ * æ“ä½œå¤§å° - ä¸»ä»åº“é—´ç½‘ç»œä¼ è¾“å‘½ä»¤é€Ÿåº¦ * æ“ä½œå¤§å°</strong>ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè€ƒè™‘åˆ°å¯èƒ½å­˜åœ¨ä¸€äº›çªå‘çš„è¯·æ±‚å‹åŠ›ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æŠŠè¿™ä¸ªç¼“å†²ç©ºé—´æ‰©å¤§ä¸€å€ï¼Œå³ repl_backlog_size = ç¼“å†²ç©ºé—´å¤§å° * 2ï¼Œè¿™ä¹Ÿå°±æ˜¯ repl_backlog_size çš„æœ€ç»ˆå€¼</p><ul><li>repl_backlog_buffer<ul><li>æ˜¯ä¸ºäº†ä»åº“æ–­å¼€ä¹‹åï¼Œå¦‚ä½•æ‰¾åˆ°ä¸»ä»å·®å¼‚æ•°æ®è€Œè®¾è®¡çš„ç¯å½¢ç¼“å†²åŒºï¼Œä»è€Œé¿å…å…¨é‡åŒæ­¥å¸¦æ¥çš„æ€§èƒ½å¼€é”€</li><li>å¦‚æœä»åº“æ–­å¼€æ—¶é—´å¤ªä¹…ï¼Œrepl_backlog_bufferç¯å½¢ç¼“å†²åŒºè¢«ä¸»åº“çš„å†™å‘½ä»¤è¦†ç›–äº†ï¼Œé‚£ä¹ˆä»åº“è¿ä¸Šä¸»åº“ååªèƒ½ä¹–ä¹–åœ°è¿›è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥ï¼Œæ‰€ä»¥repl_backlog_bufferé…ç½®å°½é‡å¤§ä¸€äº›ï¼Œå¯ä»¥é™ä½ä¸»ä»æ–­å¼€åå…¨é‡åŒæ­¥çš„æ¦‚ç‡</li><li>è€Œåœ¨repl_backlog_bufferä¸­æ‰¾ä¸»ä»å·®å¼‚çš„æ•°æ®åï¼Œå¦‚ä½•å‘ç»™ä»åº“å‘¢ï¼Ÿè¿™å°±ç”¨åˆ°äº†replication buffer</li></ul></li><li>replication_buffer<ul><li>Rediså’Œå®¢æˆ·ç«¯é€šä¿¡ä¹Ÿå¥½ï¼Œå’Œä»åº“é€šä¿¡ä¹Ÿå¥½ï¼ŒRediséƒ½éœ€è¦ç»™åˆ†é…ä¸€ä¸ª å†…å­˜bufferè¿›è¡Œæ•°æ®äº¤äº’</li><li>å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªclientï¼Œä»åº“ä¹Ÿæ˜¯ä¸€ä¸ªclientï¼Œæˆ‘ä»¬æ¯ä¸ªclientè¿ä¸ŠRedisåï¼ŒRediséƒ½ä¼šåˆ†é…ä¸€ä¸ªclient bufferï¼Œæ‰€æœ‰æ•°æ®äº¤äº’éƒ½æ˜¯é€šè¿‡è¿™ä¸ªbufferè¿›è¡Œçš„</li><li>Rediså…ˆæŠŠæ•°æ®å†™åˆ°è¿™ä¸ªbufferä¸­ï¼Œç„¶åå†æŠŠbufferä¸­çš„æ•°æ®å‘åˆ°client socketä¸­å†é€šè¿‡ç½‘ç»œå‘é€å‡ºå»ï¼Œè¿™æ ·å°±å®Œæˆäº†æ•°æ®äº¤äº’ã€‚</li><li>æ‰€ä»¥ä¸»ä»åœ¨å¢é‡åŒæ­¥æ—¶ï¼Œä»åº“ä½œä¸ºä¸€ä¸ªclientï¼Œä¹Ÿä¼šåˆ†é…ä¸€ä¸ªbufferï¼Œåªä¸è¿‡è¿™ä¸ªbufferä¸“é—¨ç”¨æ¥ä¼ æ’­ç”¨æˆ·çš„å†™å‘½ä»¤åˆ°ä»åº“ï¼Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠå®ƒå«åšreplication buffer</li><li>è¿™ä¸ªbufferéœ€è¦åšå¤§å°çš„é™åˆ¶<ul><li>å¦‚æœä¸»ä»åœ¨ä¼ æ’­å‘½ä»¤æ—¶ï¼Œå› ä¸ºæŸäº›åŸå› ä»åº“å¤„ç†å¾—éå¸¸æ…¢ï¼Œé‚£ä¹ˆä¸»åº“ä¸Šçš„è¿™ä¸ªbufferå°±ä¼šæŒç»­å¢é•¿ï¼Œæ¶ˆè€—å¤§é‡çš„å†…å­˜èµ„æºï¼Œç”šè‡³OOM</li><li>æ‰€ä»¥Redisæä¾›äº†<strong>client-output-buffer-limit</strong>å‚æ•°é™åˆ¶è¿™ä¸ªbufferçš„å¤§å°ï¼Œå¦‚æœè¶…è¿‡é™åˆ¶ï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€è¿™ä¸ªclientçš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä»åº“å¤„ç†æ…¢å¯¼è‡´ä¸»åº“å†…å­˜bufferçš„ç§¯å‹è¾¾åˆ°é™åˆ¶åï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€ä»åº“çš„è¿æ¥ï¼Œæ­¤æ—¶ä¸»ä»å¤åˆ¶ä¼šä¸­æ–­ï¼Œä¸­æ–­åå¦‚æœä»åº“å†æ¬¡å‘èµ·å¤åˆ¶è¯·æ±‚ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯èƒ½ä¼šå¯¼è‡´æ¶æ€§å¾ªç¯ï¼Œå¼•å‘å¤åˆ¶é£æš´ï¼Œè¿™ç§æƒ…å†µéœ€è¦æ ¼å¤–æ³¨æ„ã€‚</li></ul></li></ul></li></ul><h2 id="2-4-ä¸»ä»å…¨é‡åŒæ­¥-RDB-vs-AOF"><a href="#2-4-ä¸»ä»å…¨é‡åŒæ­¥-RDB-vs-AOF" class="headerlink" title="2.4 ä¸»ä»å…¨é‡åŒæ­¥ RDB vs AOF"></a>2.4 ä¸»ä»å…¨é‡åŒæ­¥ RDB vs AOF</h2><p>1ã€RDBæ–‡ä»¶å†…å®¹æ˜¯<strong>ç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆä¸åŒæ•°æ®ç±»å‹æ•°æ®åšäº†é’ˆå¯¹æ€§ä¼˜åŒ–ï¼‰</strong>ï¼Œæ–‡ä»¶å¾ˆå°ã€‚è€ŒAOFæ–‡ä»¶è®°å½•çš„æ˜¯æ¯ä¸€æ¬¡å†™æ“ä½œçš„å‘½ä»¤ï¼Œå†™æ“ä½œè¶Šå¤šæ–‡ä»¶ä¼šå˜å¾—å¾ˆå¤§ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬å¾ˆå¤šå¯¹åŒä¸€ä¸ªkeyçš„å¤šæ¬¡å†—ä½™æ“ä½œã€‚åœ¨ä¸»ä»å…¨é‡æ•°æ®åŒæ­¥æ—¶ï¼Œä¼ è¾“RDBæ–‡ä»¶å¯ä»¥å°½é‡é™ä½å¯¹ä¸»åº“æœºå™¨ç½‘ç»œå¸¦å®½çš„æ¶ˆè€—ï¼Œä»åº“åœ¨åŠ è½½RDBæ–‡ä»¶æ—¶ï¼Œä¸€æ˜¯æ–‡ä»¶å°ï¼Œè¯»å–æ•´ä¸ªæ–‡ä»¶çš„é€Ÿåº¦ä¼šå¾ˆå¿«ï¼ŒäºŒæ˜¯å› ä¸º<strong>RDBæ–‡ä»¶å­˜å‚¨çš„éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä»åº“ç›´æ¥æŒ‰ç…§RDBåè®®è§£æè¿˜åŸæ•°æ®å³å¯</strong>ï¼Œé€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œè€ŒAOFéœ€è¦ä¾æ¬¡é‡æ”¾æ¯ä¸ªå†™å‘½ä»¤ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šç»å†å†—é•¿çš„å¤„ç†é€»è¾‘ï¼Œæ¢å¤é€Ÿåº¦ç›¸æ¯”RDBä¼šæ…¢å¾—å¤šï¼Œæ‰€ä»¥ä½¿ç”¨RDBè¿›è¡Œä¸»ä»å…¨é‡åŒæ­¥çš„æˆæœ¬æœ€ä½ã€‚</p><p>2ã€å‡è®¾è¦ä½¿ç”¨AOFåšå…¨é‡åŒæ­¥ï¼Œæ„å‘³ç€å¿…é¡»æ‰“å¼€AOFåŠŸèƒ½ï¼Œæ‰“å¼€AOFå°±è¦é€‰æ‹©æ–‡ä»¶åˆ·ç›˜çš„ç­–ç•¥ï¼Œé€‰æ‹©ä¸å½“ä¼šä¸¥é‡å½±å“Redisæ€§èƒ½ã€‚è€ŒRDBåªæœ‰åœ¨éœ€è¦å®šæ—¶å¤‡ä»½å’Œä¸»ä»å…¨é‡åŒæ­¥æ•°æ®æ—¶æ‰ä¼šè§¦å‘ç”Ÿæˆä¸€æ¬¡å¿«ç…§ã€‚è€Œåœ¨å¾ˆå¤šä¸¢å¤±æ•°æ®ä¸æ•æ„Ÿçš„ä¸šåŠ¡åœºæ™¯ï¼Œå…¶å®æ˜¯ä¸éœ€è¦å¼€å¯AOFçš„ã€‚</p><h1 id="3-å¤åˆ¶è¿‡ç¨‹çš„å…·ä½“å®ç°"><a href="#3-å¤åˆ¶è¿‡ç¨‹çš„å…·ä½“å®ç°" class="headerlink" title="3. å¤åˆ¶è¿‡ç¨‹çš„å…·ä½“å®ç°"></a>3. å¤åˆ¶è¿‡ç¨‹çš„å…·ä½“å®ç°</h1><ul><li>è®¾ç½®ä¸»æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£</li><li>å»ºç«‹å¥—æ¥å­—è¿æ¥<ul><li>ä»æœåŠ¡å™¨æ ¹æ®å‘½ä»¤æ‰€è®¾ç½®çš„IPå’Œç«¯å£ï¼Œåˆ›å»ºè¿å‘ä¸»æœåŠ¡å™¨çš„å¥—æ¥å­—è¿æ¥</li><li>å¦‚æœè¿æ¥æˆåŠŸï¼Œä¼šä¸ºè¿™ä¸ªå¥—æ¥å­—å…³è”ä¸€ä¸ªä¸“é—¨ç”¨äºå¤„ç†å¤åˆ¶å·¥ä½œçš„æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨</li><li>ä»æœåŠ¡å™¨è¿™ä¸ªæ—¶å€™ç›¸å½“äºä¸»æœåŠ¡å™¨çš„å®¢æˆ·ç«¯</li></ul></li><li>å»ºç«‹å®Œæˆä»¥åï¼Œä»PINGä¸»<ul><li>æ£€æŸ¥å¥—æ¥å­—è¯»å†™æ­£å¸¸</li><li>æ£€æŸ¥ä¸»æœåŠ¡å™¨èƒ½å¦æ­£å¸¸å¤„ç†å‘½ä»¤è¯·æ±‚</li></ul></li><li>èº«ä»½éªŒè¯<ul><li>masterauth</li></ul></li><li>éªŒè¯æˆåŠŸä»¥åä»æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤  <code>REPLCONF listerning-port &lt;port-numer&gt;</code> å‘ä¸»æœåŠ¡å™¨å‘é€ä»æœåŠ¡å™¨çš„ç›‘å¬ç«¯å£å·</li><li>ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ°ä»¥åï¼Œä¼šå°†ç«¯å£å·è®°å½•åœ¨ä»æœåŠ¡å™¨æ‰€å¯¹åº”çš„å®¢æˆ·ç«¯çŠ¶æ€çš„å±æ€§å½“ä¸­ <code>slave_listening_port</code></li><li>åŒæ­¥<ul><li>ä»å‘ä¸»å‘PSYNCå‘½ä»¤ï¼Œæ‰§è¡ŒåŒæ­¥æ“ä½œ</li></ul></li><li>å‘½ä»¤ä¼ æ’­</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>æå®¢æ—¶é—´</li><li>redisè®¾è®¡ä¸å®ç°</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>RedisæŒä¹…åŒ–æœºåˆ¶-RDB</title>
      <link href="/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6-RDB/"/>
      <url>/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6-RDB/</url>
      
        <content type="html"><![CDATA[<h1 id="1-AOFæ•°æ®æ¢å¤å­˜åœ¨çš„é—®é¢˜"><a href="#1-AOFæ•°æ®æ¢å¤å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="1. AOFæ•°æ®æ¢å¤å­˜åœ¨çš„é—®é¢˜"></a>1. AOFæ•°æ®æ¢å¤å­˜åœ¨çš„é—®é¢˜</h1><ul><li>AOFæ–¹æ³•æ¯æ¬¡æ‰§è¡Œè®°å½•çš„æ˜¯æ“ä½œå‘½ä»¤ï¼Œéœ€è¦æŒä¹…åŒ–çš„æ•°æ®é‡ä¸å¤§</li><li>ä½†æ˜¯ä¹Ÿå› ä¸ºè®°å½•çš„æ˜¯æ“ä½œå‘½ä»¤ï¼Œè€Œä¸æ˜¯å®é™…æ•°æ®ï¼Œæ‰€ä»¥ç”¨AOFæ–¹æ³•è¿›è¡Œæ•…éšœæ¢å¤çš„æ—¶å€™ï¼Œéœ€è¦é€ä¸€æŠŠæ“ä½œæ—¥å¿—éƒ½æ‰§è¡Œä¸€é<ul><li>å¦‚æœæ“ä½œæ—¥å¿—å¾ˆå¤šï¼ŒRedisçš„æ¢å¤å°±ä¼šå¾ˆç¼“æ…¢ï¼Œå¯èƒ½å½±å“åˆ°æ­£å¸¸</li></ul></li></ul><h1 id="2-å†…å­˜å¿«ç…§Overview"><a href="#2-å†…å­˜å¿«ç…§Overview" class="headerlink" title="2. å†…å­˜å¿«ç…§Overview"></a>2. å†…å­˜å¿«ç…§Overview</h1><ul><li>å†…å­˜å¿«ç…§å¯ä»¥è§£å†³ä¸Šè¿°çš„é—®é¢˜<ul><li>å†…å­˜å¿«ç…§æŒ‡çš„æ˜¯è®°å½•ä¸‹å†…å­˜ä¸­çš„æ•°æ®åœ¨æŸä¸€æ—¶åˆ»çš„çŠ¶æ€</li><li>å°†æŸä¸€æ—¶åˆ»çš„çŠ¶æ€ä»¥æ–‡ä»¶çš„å½¢å¼å†™åˆ°ç£ç›˜ä¸Š è¿™æ ·å³ä½¿å®•æœºï¼Œå¿«ç…§æ–‡ä»¶ä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œæ•°æ®çš„å¯é æ€§ä¹Ÿå°±æœ‰äº†ä¿è¯</li><li>å¿«ç…§æ–‡ä»¶ç§°ä¸ºRDBæ–‡ä»¶ï¼ŒRDB â€” Redis DataBase</li></ul></li><li>RDBç‰¹å¾<ul><li>è®°å½•çš„æ˜¯æŸä¸€ä¸ªæ—¶åˆ»çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯æ“ä½œ</li><li>å› æ­¤åœ¨æ•°æ®æ¢å¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°†RDBæ–‡ä»¶ç›´æ¥è¯»å…¥å†…å­˜ï¼Œå¾ˆå¿«å®Œæˆæ¢å¤</li></ul></li><li>ä»€ä¹ˆæ—¶å€™ä¼šå®ç°RDEçš„è½½å…¥ï¼Ÿ<ul><li>åªè¦RedisæœåŠ¡å™¨åœ¨å¯åŠ¨çš„æ—¶å€™æ£€æµ‹åˆ°RDBæ–‡ä»¶å­˜åœ¨ï¼Œå°±ä¼šè‡ªåŠ¨è½½å…¥RDBæ–‡ä»¶</li><li>å¦‚æœæœåŠ¡å™¨å¼€å¯äº†AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œå› ä¸ºAOFæ–‡ä»¶æ›´æ–°é¢‘ç‡ä¸€èˆ¬æ¯”RDBé«˜å¾ˆå¤šï¼Œæ‰€ä»¥æœåŠ¡å™¨ä¼šä¼˜å…ˆä½¿ç”¨AOFæ–‡ä»¶æ¥è¿˜åŸæ•°æ®åº“çŠ¶æ€ã€</li><li>åªæœ‰å½“AOFåŠŸèƒ½å¤„äºå…³é—­çŠ¶æ€çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æ‰ä¼šä½¿ç”¨RDBæ–‡ä»¶æ¥è¿˜åŸæ•°æ®åº“çŠ¶æ€</li></ul></li><li>å¦‚ä½•å·¥ä½œçš„<ul><li>æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ç³»åˆ—è§„åˆ™ï¼Œè¢«ä¿å­˜åœ¨saveparamsé‡Œé¢<ul><li>seconds</li><li>changes</li><li>â€”&gt; å½“åœ¨xxç§’é‡Œ æœ‰è¶…è¿‡xxxæ›´æ–°æ•°é‡çš„æ—¶å€™ä¼šè§¦å‘RDB</li></ul></li><li>dirtyè®¡æ•°å™¨<ul><li>è®°å½•åœ¨ä¸Šæ¬¡æˆåŠŸæ‰§è¡Œäº†SAVEæˆ–è€…BGSAVEå‘½ä»¤ä¹‹åï¼ŒæœåŠ¡å™¨å¯¹æ•°æ®åº“çŠ¶æ€è¿›è¡Œäº†å¤šå°‘æ¬¡ä¿®æ”¹</li></ul></li><li>lastsaveå±æ€§<ul><li>UNIXæ—¶é—´æˆ³ï¼Œè®°å½•äº†ä¸Šæ¬¡æˆåŠŸæ‰§è¡Œçš„æ—¶é—´</li></ul></li><li>Redisçš„serverCronå‡½æ•°é»˜è®¤æ¯éš”100msæ‰§è¡Œä¸€æ¬¡ï¼Œæ¥ç»´æŠ¤æœåŠ¡å™¨<ul><li>å…¶ä¸­ä¸€é¡¹å·¥ä½œå°±æ˜¯æ£€æŸ¥saveé€‰é¡¹è®¾ç½®çš„ä¿å­˜æ¡ä»¶æ˜¯å¦æ»¡è¶³</li><li>å¦‚æœæ»¡è¶³å°±æ‰§è¡ŒBGSAVEå‘½ä»¤</li></ul></li></ul></li></ul><h2 id="2-1-ç»™å“ªäº›æ•°æ®åšå¿«ç…§ï¼Ÿ"><a href="#2-1-ç»™å“ªäº›æ•°æ®åšå¿«ç…§ï¼Ÿ" class="headerlink" title="2.1 ç»™å“ªäº›æ•°æ®åšå¿«ç…§ï¼Ÿ"></a>2.1 ç»™å“ªäº›æ•°æ®åšå¿«ç…§ï¼Ÿ</h2><ul><li>Redisçš„æ•°æ®éƒ½åœ¨å†…å­˜å½“ä¸­ï¼Œä¸ºäº†æä¾›æ‰€æœ‰æ•°æ®çš„å¯é æ€§ä¿è¯ï¼Œå…¶æ‰§è¡Œçš„æ˜¯<strong>å…¨é‡å¿«ç…§</strong><ul><li>å³å°†å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½è®°å½•åˆ°ç£ç›˜å½“ä¸­</li><li>ä¸ä¹‹ä¸€èµ·æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå½“éœ€è¦å¯¹å†…å­˜çš„å…¨é‡æ•°æ®åšå¿«ç…§çš„æ—¶å€™ï¼Œå°†å…¶å…¨éƒ¨å†™å…¥ç£ç›˜ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´</li><li>è€Œä¸”å…¨é‡æ•°æ®è¶Šå¤šï¼ŒRDBæ–‡ä»¶å°±è¶Šå¤§ï¼Œå¾€ç£ç›˜ä¸Šå†™æ•°æ®çš„æ—¶é—´å¼€é”€å°±è¶Šå¤§</li><li>è€ŒRedisçš„å•çº¿ç¨‹æ¨¡å‹å†³å®šäº†æˆ‘ä»¬è¦å°½é‡é¿å…é˜»å¡ä¸»çº¿ç¨‹çš„æ“ä½œ</li></ul></li><li>Redisç”ŸæˆRDBæ–‡ä»¶çš„å‘½ä»¤<ul><li>save<ul><li>åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¼šå¯¼è‡´é˜»å¡</li><li>åœ¨æœåŠ¡å™¨è¿›ç¨‹é˜»å¡æœŸé—´ï¼ŒæœåŠ¡å™¨ä¸èƒ½å¤„ç†ä»»ä½•å‘½ä»¤è¯·æ±‚</li></ul></li><li>bgsave<ul><li>åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸“é—¨ç”¨äºå†™å…¥RDBæ–‡ä»¶ï¼Œå¯ä»¥é¿å…å¯¹äºä¸»çº¿ç¨‹çš„é˜»å¡ â€” æ˜¯Redis RDBçš„æ–‡ä»¶ç”Ÿæˆçš„é»˜è®¤é…ç½®</li></ul></li></ul></li></ul><h2 id="2-2-åšå¿«ç…§çš„æ—¶å€™æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«å¢åˆ æ”¹ï¼Ÿ"><a href="#2-2-åšå¿«ç…§çš„æ—¶å€™æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«å¢åˆ æ”¹ï¼Ÿ" class="headerlink" title="2.2 åšå¿«ç…§çš„æ—¶å€™æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«å¢åˆ æ”¹ï¼Ÿ"></a>2.2 åšå¿«ç…§çš„æ—¶å€™æ•°æ®æ˜¯å¦èƒ½å¤Ÿè¢«å¢åˆ æ”¹ï¼Ÿ</h2><ul><li><p>æˆ‘ä»¬éœ€è¦ä½¿ç³»ç»Ÿåœ¨è¿›è¡Œå¿«ç…§çš„æ—¶å€™ä»ç„¶èƒ½å¤Ÿæ¥å—ä¿®æ”¹è¯·æ±‚ï¼Œè¦ä¸ç„¶ä¼šä¸¥é‡å½±å“ç³»ç»Ÿçš„æ‰§è¡Œæ•ˆç‡</p></li><li><p>Redisä¼šå€ŸåŠ©æ“ä½œç³»ç»Ÿæä¾›çš„<strong>å†™æ—¶å¤åˆ¶æŠ€æœ¯ â€” copy on write</strong>ï¼Œåœ¨æ‰§è¡Œå¿«ç…§çš„åŒæ—¶ï¼Œæ­£å¸¸å¤„ç†å†™æ“ä½œ</p><ul><li><p>copy on write</p><ul><li><p>copy operation is deferred until the first write,</p></li><li><p>could significantly reduce the resource consumption of unmodified copies, while adding a small overhead to resource-modifying operations</p><p><a href="https://en.wikipedia.org/wiki/Copy-on-write">Copy-on-write</a></p><p><img src="https://i.loli.net/2021/01/03/I8kwNqF41KlezWL.png" alt="Copy On Writeçš„å®ç°"></p><p>Copy on Writeå®ç°</p></li></ul></li></ul></li><li><p>ä¾‹å›¾å½“ä¸­é”®å€¼å¯¹Cå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆbgsaveå­è¿›ç¨‹è¿˜ä¼šå¯¹åŸé”®å€¼å¯¹C è¿›è¡Œsnapshotï¼Œç„¶åè¿‡ç¨‹å½“ä¸­çš„å†™æ“ä½œä¼šè¢«å†™åˆ°å‰¯æœ¬é‡Œé¢</p></li></ul><h2 id="2-3-å¤šä¹…åšä¸€æ¬¡å¿«ç…§ï¼Ÿ"><a href="#2-3-å¤šä¹…åšä¸€æ¬¡å¿«ç…§ï¼Ÿ" class="headerlink" title="2.3 å¤šä¹…åšä¸€æ¬¡å¿«ç…§ï¼Ÿ"></a>2.3 å¤šä¹…åšä¸€æ¬¡å¿«ç…§ï¼Ÿ</h2><ul><li>å°½ç®¡bgsaveæ‰§è¡Œæ—¶ä¸é˜»å¡ä¸»çº¿ç¨‹ï¼Œä½†æ˜¯é¢‘ç¹çš„æ‰§è¡Œå…¨é‡å¿«ç…§ï¼Œä¼šå¸¦æ¥ä¸¤æ–¹é¢çš„å¼€é”€<ul><li>ç£ç›˜å¸¦å®½å‹åŠ›<ul><li>é¢‘ç¹å°†å…¨é‡æ•°æ®å†™å…¥ç£ç›˜ï¼Œä¼šç»™ç£ç›˜å¸¦æ¥å¾ˆå¤§çš„å‹åŠ›</li><li>å¤šä¸ªå¿«ç…§ç«äº‰æœ‰é™çš„ç£ç›˜è´·æ¬¾ï¼Œå‰ä¸€ä¸ªå¿«ç…§è¿˜æ²¡æœ‰åšå®Œï¼Œåä¸€ä¸ªåˆå¼€å§‹åšäº†ï¼Œå®¹æ˜“é€ æˆæ¶æ€§å¾ªç¯</li></ul></li><li>forkæ“ä½œçš„é˜»å¡<ul><li>bgsaveå­è¿›ç¨‹éœ€è¦é€šè¿‡forkæ“ä½œä»ä¸»çº¿ç¨‹åˆ›å»ºå‡ºæ¥</li><li>forkåˆ›å»ºè¿‡ç¨‹æœ¬èº«ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œè€Œä¸”ä¸»çº¿ç¨‹çš„å†…å­˜è¶Šå¤§ï¼Œé˜»å¡æ—¶é—´å°±è¶Šé•¿</li></ul></li></ul></li></ul><h2 id="2-4-RDBæ–‡ä»¶ç»“æ„"><a href="#2-4-RDBæ–‡ä»¶ç»“æ„" class="headerlink" title="2.4 RDBæ–‡ä»¶ç»“æ„"></a>2.4 RDBæ–‡ä»¶ç»“æ„</h2><ul><li>ä¸€ä¸ªRDBæ–‡ä»¶åˆ†æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†<ul><li>REDIS<ul><li>ç”¨æ¥æ£€æµ‹è½½å…¥çš„æ–‡ä»¶æ˜¯å¦ä¸ºRDBæ–‡ä»¶</li></ul></li><li>db_version<ul><li>è®°å½•RDBæ–‡ä»¶çš„ç‰ˆæœ¬å·</li></ul></li><li>databased<ul><li>åŒ…å«ä»»æ„å¤šä¸ªæ•°æ®åº“ï¼Œä»¥åŠæ¯ä¸ªæ•°æ®åº“ä¸­çš„é”®å€¼å¯¹æ•°æ®</li></ul></li><li>EOF<ul><li>1å­—èŠ‚</li><li>æ ‡å¿—ç€RDBæ–‡ä»¶æ­£æ–‡éƒ¨åˆ†çš„ç»“æŸ</li></ul></li><li>check_sum<ul><li>é€šè¿‡å¯¹ä¸Šé¢å››ä¸ªéƒ¨åˆ†çš„å†…å®¹è¿›è¡Œè®¡ç®—å¾—å‡ºçš„</li><li>è½½å…¥RDBæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå°†è½½å…¥æ•°æ®æ‰€è®¡ç®—å‡ºæ¥çš„æ ¡éªŒå’Œä¸check_sumæ‰€è®°å½•çš„è¿›è¡Œå¯¹æ¯”</li></ul></li></ul></li></ul><h1 id="3-AOFå’ŒRDBæ··ç”¨æ¨¡å¼"><a href="#3-AOFå’ŒRDBæ··ç”¨æ¨¡å¼" class="headerlink" title="3. AOFå’ŒRDBæ··ç”¨æ¨¡å¼"></a>3. AOFå’ŒRDBæ··ç”¨æ¨¡å¼</h1><ul><li>ä¸ºä»€ä¹ˆè¦æ··ç”¨<ul><li>AOFæ‰§è¡Œé€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢</li><li>RDBçš„å…¨é‡å¤åˆ¶é¢‘ç‡éš¾ä»¥æŠŠæ§ï¼Œå¤ªä½ï¼Œä¼šå®¹æ˜“ä¸¢å¤±æ•°æ®ï¼›å¤ªé«˜ï¼Œç³»ç»Ÿå¼€é”€ä¼šå¾ˆå¤§</li></ul></li><li>å¦‚ä½•å®ç°çš„<ul><li>RDBä»¥ä¸€å®šçš„é¢‘ç‡æ¥æ‰§è¡Œ</li><li>åœ¨ä¸¤æ¬¡å¿«ç…§ä¹‹é—´ï¼Œä½¿ç”¨AOFæ—¥å¿—è®°å½•è¿™æœŸé—´æ‰€æœ‰çš„å‘½ä»¤æ“ä½œ</li></ul></li></ul><p><img src="https://i.loli.net/2021/01/03/C98RNZ7PanDWyUr.png" alt="RDBå¢é‡å¿«ç…§çš„å®ç°"></p><p>AOF &amp; RDB Mix</p><ul><li>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåˆ°äº†ç¬¬äºŒæ¬¡åšå…¨é‡å¿«ç…§çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ¸…ç©ºAOFæ—¥å¿—ï¼Œå› ä¸ºæ‰€æœ‰çš„æ“ä½œéƒ½å·²ç»ä¿å­˜åˆ°äº†ç¬¬äºŒæ¬¡çš„å…¨é‡å¿«ç…§å½“ä¸­äº†</li></ul><h1 id="4-å®é™…åœºæ™¯æ¢ç©¶"><a href="#4-å®é™…åœºæ™¯æ¢ç©¶" class="headerlink" title="4. å®é™…åœºæ™¯æ¢ç©¶"></a>4. å®é™…åœºæ™¯æ¢ç©¶</h1><blockquote><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª 2 æ ¸ CPUã€4GB å†…å­˜ã€500GB ç£ç›˜çš„äº‘ä¸»æœºè¿è¡Œ Redisï¼ŒRedis æ•°æ®åº“çš„æ•°æ®é‡å¤§å°å·®ä¸å¤šæ˜¯ 2GBï¼Œæˆ‘ä»¬ä½¿ç”¨äº† RDB åšæŒä¹…åŒ–ä¿è¯ã€‚å½“æ—¶ Redis çš„è¿è¡Œè´Ÿè½½ä»¥ä¿®æ”¹æ“ä½œä¸ºä¸»ï¼Œå†™è¯»æ¯”ä¾‹å·®ä¸å¤šåœ¨ 8:2 å·¦å³ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰ 100 ä¸ªè¯·æ±‚ï¼Œ80 ä¸ªè¯·æ±‚æ‰§è¡Œçš„æ˜¯ä¿®æ”¹æ“ä½œã€‚ä½ è§‰å¾—ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œç”¨ RDB åšæŒä¹…åŒ–æœ‰ä»€ä¹ˆé£é™©å—ï¼Ÿ</p></blockquote><ul><li>å†…å­˜èµ„æºé£é™©<ul><li>Redis forkå­è¿›ç¨‹åšRDBæŒä¹…åŒ–ï¼Œç”±äºå†™çš„æ¯”ä¾‹ä¸º80%ï¼Œé‚£ä¹ˆåœ¨æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œâ€œå†™å®å¤åˆ¶â€ä¼šé‡æ–°åˆ†é…æ•´ä¸ªå®ä¾‹80%çš„å†…å­˜å‰¯æœ¬ï¼Œå¤§çº¦éœ€è¦é‡æ–°åˆ†é…1.6GBå†…å­˜ç©ºé—´ï¼Œè¿™æ ·æ•´ä¸ªç³»ç»Ÿçš„å†…å­˜ä½¿ç”¨æ¥è¿‘é¥±å’Œï¼Œ</li><li>å¦‚æœæ­¤æ—¶çˆ¶è¿›ç¨‹åˆæœ‰å¤§é‡æ–°keyå†™å…¥ï¼Œå¾ˆå¿«æœºå™¨å†…å­˜å°±ä¼šè¢«åƒå…‰ï¼Œå¦‚æœæœºå™¨å¼€å¯äº†Swapæœºåˆ¶ï¼Œé‚£ä¹ˆRedisä¼šæœ‰ä¸€éƒ¨åˆ†æ•°æ®è¢«æ¢åˆ°ç£ç›˜ä¸Šï¼Œå½“Redisè®¿é—®è¿™éƒ¨åˆ†åœ¨ç£ç›˜ä¸Šçš„æ•°æ®æ—¶ï¼Œæ€§èƒ½ä¼šæ€¥å‰§ä¸‹é™ï¼Œå·²ç»è¾¾ä¸åˆ°é«˜æ€§èƒ½çš„æ ‡å‡†ï¼ˆå¯ä»¥ç†è§£ä¸ºæ­¦åŠŸè¢«åºŸï¼‰ã€‚å¦‚æœæœºå™¨æ²¡æœ‰å¼€å¯Swapï¼Œä¼šç›´æ¥è§¦å‘OOMï¼Œçˆ¶å­è¿›ç¨‹ä¼šé¢ä¸´è¢«ç³»ç»Ÿkillæ‰çš„é£é™©ã€‚<ul><li>swap æœºåˆ¶<ul><li>å°†ä¸€å—ç£ç›˜æˆ–è€…ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶å½“åšå†…å­˜æ¥ä½¿ç”¨<ul><li>æ¢å…¥<ul><li>å½“è¿›ç¨‹å†æ¬¡è®¿é—®å†…å­˜çš„æ—¶å€™ï¼Œä»ç£ç›˜è¯»å–æ•°æ®åˆ°å†…å­˜å½“ä¸­</li></ul></li><li>æ¢å‡º<br><a href="https://blog.csdn.net/qq_24436765/article/details/103822548">Linuxç³»ç»Ÿçš„swapæœºåˆ¶_å›šç‰¢-å³°å­çš„åšå®¢-CSDNåšå®¢</a><ul><li>å°†è¿›ç¨‹æš‚æ—¶ä¸ç”¨çš„å†…å­˜æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œå†é‡Šæ”¾å†…å­˜ç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨</li><li>å½“è¿›ç¨‹å†æ¬¡è®¿é—®å†…å­˜çš„æ—¶å€™ï¼Œä»ç£ç›˜è¯»å–æ•°æ®åˆ°å†…å­˜ä¸­</li></ul></li></ul></li></ul></li></ul></li></ul></li><li>CPUèµ„æºé£é™©<ul><li>è™½ç„¶å­è¿›ç¨‹åœ¨åšRDBæŒä¹…åŒ–ï¼Œä½†ç”ŸæˆRDBå¿«ç…§è¿‡ç¨‹ä¼šæ¶ˆè€—å¤§é‡çš„CPUèµ„æºï¼Œ</li><li>è™½ç„¶Rediså¤„ç†å¤„ç†è¯·æ±‚æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†Redis Serverè¿˜æœ‰å…¶ä»–çº¿ç¨‹åœ¨åå°å·¥ä½œï¼Œä¾‹å¦‚AOFæ¯ç§’åˆ·ç›˜ã€å¼‚æ­¥å…³é—­æ–‡ä»¶æè¿°ç¬¦è¿™äº›æ“ä½œã€‚</li><li>ç”±äºæœºå™¨åªæœ‰2æ ¸CPUï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€çˆ¶è¿›ç¨‹å ç”¨äº†è¶…è¿‡ä¸€åŠçš„CPUèµ„æºï¼Œæ­¤æ—¶å­è¿›ç¨‹åšRDBæŒä¹…åŒ–ï¼Œå¯èƒ½ä¼šäº§ç”ŸCPUç«äº‰ï¼Œå¯¼è‡´çš„ç»“æœå°±æ˜¯çˆ¶è¿›ç¨‹å¤„ç†è¯·æ±‚å»¶è¿Ÿå¢å¤§ï¼Œå­è¿›ç¨‹ç”ŸæˆRDBå¿«ç…§çš„æ—¶é—´ä¹Ÿä¼šå˜é•¿ï¼Œæ•´ä¸ªRedis Serveræ€§èƒ½ä¸‹é™ã€‚</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>æå®¢æ—¶é—´</li><li>Redisè®¾è®¡ä¸å®ç°</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>RedisæŒä¹…åŒ–æœºåˆ¶-AOF</title>
      <link href="/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6-AOF/"/>
      <url>/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6-AOF/</url>
      
        <content type="html"><![CDATA[<h1 id="RedisæŒä¹…åŒ–æœºåˆ¶-AOF"><a href="#RedisæŒä¹…åŒ–æœºåˆ¶-AOF" class="headerlink" title="RedisæŒä¹…åŒ–æœºåˆ¶-AOF"></a>RedisæŒä¹…åŒ–æœºåˆ¶-AOF</h1><h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><p>Rediså¾ˆå¤§çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯å°±æ˜¯ç¼“å­˜ï¼Œå› ä¸ºé€Ÿåº¦å¾ˆå¿«ï¼Œé€šè¿‡å°†åç«¯æ•°æ®åº“ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å†…å­˜å½“ä¸­ï¼Œç„¶åç›´æ¥ä»å†…å­˜ä¸­è¯»å–æ•°æ®ã€‚</p><p>ä½†æ˜¯è¿™æ ·åšçš„ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å¦‚æœæœåŠ¡å™¨å®•æœºï¼Œå†…å­˜ä¸­çš„æ•°æ®å°†ä¼šå…¨éƒ¨ä¸¢å¤±æ‰ã€‚å¯¹äºæ¢å¤æ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š</p><ul><li>ä»åç«¯æ•°æ®åº“è®¿é—®<ul><li>å¯¹æ•°æ®åº“çš„é¢‘ç¹è®¿é—®ä¼šç»™æ•°æ®åº“é€ æˆå·¨å¤§çš„å‹åŠ›</li><li>ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå“åº”é€Ÿåº¦å˜æ…¢</li></ul></li><li>ç†å¿µ - ä¸ä»åç«¯æ•°æ®åº“è¯»å–ï¼Œå®ç°æ•°æ®çš„æŒä¹…åŒ–<ul><li>AOFæ—¥å¿—</li><li>RDBå¿«ç…§</li></ul></li></ul><h1 id="2-AOFæ—¥å¿—çš„å®ç°"><a href="#2-AOFæ—¥å¿—çš„å®ç°" class="headerlink" title="2. AOFæ—¥å¿—çš„å®ç°"></a>2. AOFæ—¥å¿—çš„å®ç°</h1><h2 id="2-1-ä»€ä¹ˆæ˜¯AOF"><a href="#2-1-ä»€ä¹ˆæ˜¯AOF" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯AOF"></a>2.1 ä»€ä¹ˆæ˜¯AOF</h2><ul><li><p>AOF - Append Only File</p></li><li><p>å†™åæ—¥å¿—</p><ul><li><p>Rediså…ˆæ‰§è¡Œå‘½ä»¤ï¼Œå°†æ•°æ®å†™å…¥å†…å­˜ï¼Œç„¶åæ‰è®°å½•æ—¥å¿—</p><p>  [å†™åæ—¥å¿—]](<a href="https://i.loli.net/2020/12/29/bNUOftoVI19G8Wj.png">https://i.loli.net/2020/12/29/bNUOftoVI19G8Wj.png</a>)</p></li></ul></li></ul><h2 id="2-2-AOFè®°å½•äº†ä»€ä¹ˆ"><a href="#2-2-AOFè®°å½•äº†ä»€ä¹ˆ" class="headerlink" title="2.2 AOFè®°å½•äº†ä»€ä¹ˆ"></a>2.2 AOFè®°å½•äº†ä»€ä¹ˆ</h2><ul><li><p>ä¼ ç»Ÿæ•°æ®åº“æ—¥å¿—</p><ul><li>è®°å½•ä¿®æ”¹åçš„æ•°æ®</li></ul></li><li><p>AOF</p><ul><li><p>å†™åæ—¥å¿—</p></li><li><p>è®°å½•Redisæ”¶åˆ°çš„æ¯ä¸€æ¡æŒ‡ä»¤ï¼Œè¿™äº›å‘½ä»¤ä»¥æ–‡æœ¬å½¢å¼ä¿å­˜</p></li><li><p><strong>AOFè®°å½•æ—¥å¿—çš„æ—¶å€™ï¼Œä¸ä¼šè¿›è¡Œè¯­æ³•æ£€æŸ¥çš„</strong>ï¼ å› æ­¤ï¼Œå¦‚æœå…ˆè®°å½•æ—¥å¿—ï¼Œå†åšæ‰§è¡Œçš„è¯ï¼Œæ—¥å¿—å½“ä¸­å°±æœ‰å¯èƒ½è®°å½•é”™è¯¯çš„å‘½ä»¤ï¼Œåœ¨ä½¿ç”¨æ—¥å¿—æ¢å¤æ•°æ®çš„æ—¶å€™ï¼Œå°±æœ‰å¯èƒ½å‡ºé”™</p><ul><li><p>è¿˜æ˜¯å¯¹äºé€Ÿåº¦å’Œä¿è¯æ€§çš„tradeoff</p><p><img src="https://i.loli.net/2020/12/29/qn9adxRcv2ZSJiD.png" alt="AOFæ–‡ä»¶EG"></p><p>AOFæ—¥å¿—èŒƒä¾‹</p></li></ul></li><li><p>å†™åæ—¥å¿—å¯ä»¥é¿å…å‡ºç°è®°å½•é”™è¯¯å‘½ä»¤çš„æƒ…å†µ</p></li><li><p>è€Œä¸”å› ä¸ºæ˜¯åœ¨å‘½ä»¤æ‰§è¡Œåæ‰è®°å½•æ—¥å¿—ï¼Œæ‰€ä»¥ä¸ä¼šé˜»å¡å½“å‰çš„å†™æ“ä½œ</p></li></ul></li></ul><h3 id="2-2-1-å†™åæ—¥å¿—çš„é£é™©"><a href="#2-2-1-å†™åæ—¥å¿—çš„é£é™©" class="headerlink" title="2.2.1 å†™åæ—¥å¿—çš„é£é™©"></a>2.2.1 å†™åæ—¥å¿—çš„é£é™©</h3><ul><li>å¦‚æœåˆšæ‰§è¡Œå®Œä¸€ä¸ªå‘½ä»¤ï¼Œè¿˜æ²¡æœ‰è®°å½•æ—¥å¿—å°±å®•æœºäº†ï¼Œé‚£ä¹ˆå‘½ä»¤å’Œç›¸åº”çš„æ•°æ®éƒ½æœ‰ä¸¢å¤±çš„é£é™©ã€‚</li><li>AOFè™½ç„¶é¿å…äº†å¯¹å½“å‰å‘½ä»¤çš„é˜»å¡ï¼Œä½†æ˜¯å¯èƒ½ä¼šç»™ä¸‹ä¸€ä¸ªæ“ä½œå¸¦æ¥é˜»å¡é£é™©<ul><li>å› ä¸ºAOFæ—¥å¿—ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå¦‚æœå°†æ—¥å¿—æ–‡ä»¶å†™å…¥ç£ç›˜çš„æ—¶å€™ï¼Œç£ç›˜å†™å‹åŠ›å¤§ï¼Œä¼šå¯¼è‡´å†™ç›˜éå¸¸æ…¢</li></ul></li></ul><p>è§£å†³æ–¹æ¡ˆï¼š éœ€è¦æ§åˆ¶å†™å‘½ä»¤æ‰§è¡Œå®ŒæˆåAOFæ—¥å¿—å†™å›ç£ç›˜çš„æ—¶æœº</p><h2 id="2-3-AOFæ–‡ä»¶è½½å…¥ä¸æ•°æ®è¿˜åŸ"><a href="#2-3-AOFæ–‡ä»¶è½½å…¥ä¸æ•°æ®è¿˜åŸ" class="headerlink" title="2.3 AOFæ–‡ä»¶è½½å…¥ä¸æ•°æ®è¿˜åŸ"></a>2.3 AOFæ–‡ä»¶è½½å…¥ä¸æ•°æ®è¿˜åŸ</h2><ul><li>è¯¦ç»†æ­¥éª¤<ul><li>åˆ›å»ºä¸€ä¸ªä¸å¸¦ç½‘ç»œè¿æ¥çš„fake client<ul><li>å› ä¸ºRediså‘½ä»¤åªèƒ½åœ¨å®¢æˆ·ç«¯çš„ä¸Šä¸‹æ–‡å½“ä¸­æ¥æ‰§è¡Œ</li></ul></li><li>ä»AOFæ–‡ä»¶å½“ä¸­åˆ†æå¹¶è¯»å–ä¸€æ¡å†™å‘½ä»¤</li><li>ä½¿ç”¨ä¼ªå®¢æˆ·ç«¯æ¥æ‰§è¡Œè¢«è¯»å‡ºçš„å†™å‘½ä»¤</li><li>é‡å¤æ‰§è¡Œä¸Šè¿°çš„è¯»å–å’Œæ‰§è¡ŒæŒ‡ä»¤ï¼Œç›´åˆ°å¤„ç†å®Œæ¯•</li></ul></li></ul><h1 id="3-å•ç‚¹ç ”ç©¶"><a href="#3-å•ç‚¹ç ”ç©¶" class="headerlink" title="3. å•ç‚¹ç ”ç©¶"></a>3. å•ç‚¹ç ”ç©¶</h1><h2 id="3-1-å†™å›ç­–ç•¥"><a href="#3-1-å†™å›ç­–ç•¥" class="headerlink" title="3.1 å†™å›ç­–ç•¥"></a>3.1 å†™å›ç­–ç•¥</h2><ul><li>Redisçš„æœåŠ¡å™¨è¿›ç¨‹æ˜¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯å½“ä¸­çš„æ–‡ä»¶äº‹ä»¶è´Ÿè´£<ul><li>æ¥æ”¶å®¢æˆ·ç«¯çš„å‘½ä»¤è¯·æ±‚</li><li>å‘å®¢æˆ·ç«¯å‘é€å‘½ä»¤å›å¤</li></ul></li><li>æ—¶é—´äº‹ä»¶è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯çš„å‘½ä»¤è¯·æ±‚</li></ul><pre><code class="jsx">def eventLoop():     while true:         // å¤„ç†æ–‡ä»¶äº‹ä»¶ï¼Œå¯èƒ½ä¼šæœ‰æ–°å†…å®¹è¿½åŠ åˆ°aof_butç¼“å†²åŒº        processFileEvents()        processTimeEvents()        flushAppendOnlyFile()</code></pre><ul><li><p>å¯ç”¨çš„å†™å›ç­–ç•¥ - AOFå½“ä¸­çš„appendfsyncçš„ä¸‰ä¸ªå¯é€‰å€¼</p><ul><li><p>Always åŒæ­¥å†™å›</p><ul><li>æ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œç«‹åˆ»åŒæ­¥å°†æ—¥å¿—å†™å›ç£ç›˜</li></ul></li><li><p>EverySec æ¯ç§’å†™å›</p><ul><li>æ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œåªæ˜¯å…ˆæŠŠæ—¥å¿—å†™åˆ°<strong>AOFæ–‡ä»¶çš„å†…å­˜ç¼“å†²åŒº</strong>ï¼Œæ¯éš”ä¸€ç§’å°†ç¼“å†²åŒºä¸­çš„å†…å®¹å†™å…¥ç£ç›˜</li></ul></li><li><p>No æ“ä½œç³»ç»Ÿæ§åˆ¶çš„å†™å›</p><ul><li>æ¯ä¸ªå†™å‘½ä»¤æ‰§è¡Œå®Œï¼Œåªæ˜¯å°†æ—¥å¿—å†™åˆ°AOFæ–‡ä»¶çš„ç¼“å†²åŒºï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å†²åŒºå†…å®¹å†™å›ç£ç›˜</li></ul><p><img src="https://i.loli.net/2020/12/29/RkfhClbVDv5JKzp.png" alt="appendfsync è§„å®šçš„å†™å›ç­–ç•¥"></p><p>å†™å›ç­–ç•¥å¯¹æ¯”</p></li></ul></li><li><p>å†™å›ç­–ç•¥çš„é€‰æ‹© â€” æ ¹æ®å¯¹äºæ€§èƒ½å’Œå¯é æ€§çš„è¦æ±‚ï¼Œæ¥é€‰æ‹©é€‰ç”¨å“ªä¸€ç§å†™å›ç­–ç•¥</p><ul><li>æƒ³è¦è·å¾—é«˜æ€§èƒ½ï¼Œé€‰ç”¨Noç­–ç•¥</li><li>æƒ³è¦é«˜å¯é æ€§çš„ä¿è¯ï¼Œé€‰ç”¨Alwaysç­–ç•¥</li><li>å¦‚æœå…è®¸æ•°æ®æœ‰ä¸€ç‚¹ä¸¢å¤±ï¼Œåˆå¸Œæœ›æ€§èƒ½ä¸å—å¤ªå¤§çš„å½±å“ï¼Œé€‰ç”¨EverySecç­–ç•¥</li></ul></li></ul><h2 id="3-2-å¦‚ä½•å¤„ç†è¿‡å¤§çš„æ—¥å¿—æ–‡ä»¶-â€”-AOFé‡å†™æœºåˆ¶"><a href="#3-2-å¦‚ä½•å¤„ç†è¿‡å¤§çš„æ—¥å¿—æ–‡ä»¶-â€”-AOFé‡å†™æœºåˆ¶" class="headerlink" title="3.2 å¦‚ä½•å¤„ç†è¿‡å¤§çš„æ—¥å¿—æ–‡ä»¶ â€” AOFé‡å†™æœºåˆ¶"></a>3.2 å¦‚ä½•å¤„ç†è¿‡å¤§çš„æ—¥å¿—æ–‡ä»¶ â€” AOFé‡å†™æœºåˆ¶</h2><p>æ—¥å¿—è¿‡å¤§ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ï¼Œä¸»è¦åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š </p><ol><li><p>æ–‡ä»¶ç³»ç»Ÿæœ¬èº«å¯¹æ–‡ä»¶å¤§å°çš„é™åˆ¶ï¼Œæ— æ³•ä¿å­˜è¿‡å¤§çš„æ–‡ä»¶ </p></li><li><p>å¦‚æœæ–‡ä»¶å¤ªå¤§ï¼Œå†å‘é‡Œé¢è¿½åŠ å‘½ä»¤è®°å½•ï¼Œæ•ˆç‡ä¼šé™ä½ </p></li><li><p>å¦‚æœå‘ç”Ÿå®•æœºï¼ŒAOFä¸­è®°å½•çš„å‘½ä»¤è¦ä¸€ä¸ªä¸ªè¢«é‡æ–°æ‰§è¡Œï¼Œç”¨äºæ•…éšœæ¢å¤ï¼Œå¦‚æœæ—¥å¿—æ–‡ä»¶å¤ªå¤§ï¼Œæ•´ä¸ªæ¢å¤è¿‡ç¨‹ä¼šéå¸¸ç¼“æ…¢ï¼Œè¿™å°±ä¼šå½±å“åˆ°Redisçš„æ­£å¸¸ä½¿ç”¨</p></li></ol><h3 id="3-2-1-é‡å†™å¯ä»¥ä¼˜åŒ–æ—¥å¿—å¤§å°çš„åŸç†"><a href="#3-2-1-é‡å†™å¯ä»¥ä¼˜åŒ–æ—¥å¿—å¤§å°çš„åŸç†" class="headerlink" title="3.2.1 é‡å†™å¯ä»¥ä¼˜åŒ–æ—¥å¿—å¤§å°çš„åŸç†"></a>3.2.1 é‡å†™å¯ä»¥ä¼˜åŒ–æ—¥å¿—å¤§å°çš„åŸç†</h3><ul><li><p>AOFé‡å†™æœºåˆ¶</p><ul><li><p>é‡å†™çš„æ—¶å€™ï¼Œæ ¹æ®æ•°æ®åº“ç°çŠ¶åˆ›å»ºä¸€ä¸ªæ–°çš„AOFæ–‡ä»¶</p><ul><li>è¯»å–æ•°æ®åº“æ‰€æœ‰çš„é”®å€¼å¯¹</li><li>é’ˆå¯¹æ¯ä¸€ä¸ªé”®å€¼å¯¹ç”¨ä¸€æ¡å‘½ä»¤è®°å½•å®ƒçš„å†™å…¥</li><li>éœ€è¦å›å¤çš„æ—¶å€™ï¼Œç›´æ¥æ‰§è¡Œè¿™æ¡å‘½ä»¤</li></ul></li><li><p>é‡å†™å¯ä»¥ä½¿å¾—æ—¥å¿—æ–‡ä»¶å˜å°ï¼Œå› ä¸ºå¯ä»¥å‹ç¼©å¤šæ¡æŒ‡ä»¤åˆ°ä¸€æ¡</p><ul><li><p>å³AOFæ—¥å¿—æ˜¯ç”¨æ¥åšæ¢å¤çš„ï¼Œæˆ‘ä¸éœ€è¦è®°å½•æ¯ä¸€æ­¥çš„ä¸­é—´çŠ¶æ€ï¼Œåªè¦çŸ¥é“æœ€ç»ˆå¯¹åº”çš„keyçš„valueæ˜¯å¤šå°‘å°±å¥½</p><p>  <img src="https://i.loli.net/2020/12/29/R7fgD2tVBvZUk8z.png" alt="AOFé‡å†™E.G"></p><p>  é‡å†™åŸç†</p></li></ul></li></ul></li></ul><h3 id="3-2-2-é‡å†™å¦‚ä½•é¿å…é˜»å¡ï¼Ÿ"><a href="#3-2-2-é‡å†™å¦‚ä½•é¿å…é˜»å¡ï¼Ÿ" class="headerlink" title="3.2.2 é‡å†™å¦‚ä½•é¿å…é˜»å¡ï¼Ÿ"></a>3.2.2 é‡å†™å¦‚ä½•é¿å…é˜»å¡ï¼Ÿ</h3><ul><li><p>AOFæ—¥å¿—ç”±ä¸»çº¿ç¨‹å†™å› â€” æ˜¯åœ¨æ‰§è¡Œäº†ä¸»æ“ä½œä»¥åï¼Œç›´æ¥callçš„AOFçš„æ–¹æ³•æ¥è¿›è¡Œæ‰§è¡Œçš„ï¼Œè€Œé‡å†™è¿‡ç¨‹æ˜¯ç”±<strong>åå°å­è¿›ç¨‹bgrewriteaof</strong>æ¥å®Œæˆçš„ï¼Œæ˜¯ä¸ºäº†é¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´æ•°æ®åº“æ€§èƒ½çš„ä¸‹é™</p></li><li><p>é‡å†™çš„æ•´ä¸ªæµç¨‹</p><ul><li><p>ä¸€å¤„æ‹·è´</p><ul><li>æ¯æ¬¡æ‰§è¡Œé‡å†™çš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹forkåˆ°bgrewriteaofå­è¿›ç¨‹</li><li>ä¸»çº¿ç¨‹çš„å†…å­˜ä¼šè¢«æ‹·è´ä¸€ä»½åˆ°bgrewriteaofå­è¿›ç¨‹å½“ä¸­ï¼Œå…¶ä¸­ä¼šåŒ…å«æ•°æ®åº“çš„æœ€æ–°æ•°æ®</li><li>ç„¶åè¯¥å­è¿›ç¨‹å°±å¯ä»¥åœ¨ä¸å½±å“ä¸»çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œé€ä¸€æŠŠæ‹·è´çš„æ•°æ®å†™æˆæ“ä½œï¼Œè®°å…¥é‡å†™æ—¥å¿—</li></ul></li><li><p>ä¸¤å¤„æ—¥å¿—</p><ul><li><p>ä¸»çº¿ç¨‹å½“ä¸­çš„AOFæ—¥å¿—</p><ul><li>ä½†æœ‰æ–°çš„æ“ä½œè¿›å…¥ï¼ŒRedisä¼šå°†è¯¥æ“ä½œå†™åˆ°AOFæ—¥å¿—ç¼“å†²åŒº</li><li>è¿™æ ·å³ä½¿å®•æœºï¼ŒAOFæ—¥å¿—çš„æ“ä½œä»é½å…¨ï¼Œå¯ä»¥ç”¨æ¥åšæ¢å¤</li></ul></li><li><p>AOFé‡å†™æ—¥å¿—</p><ul><li><p>è¯¥æ“ä½œåŒæ—¶ä¹Ÿä¼šè¢«å†™å…¥åˆ°é‡å†™æ—¥å¿—çš„ç¼“å†²åŒº</p></li><li><p>ç­‰åˆ°æ‹·è´æ•°æ®çš„æ‰€æœ‰æ“ä½œè®°å½•é‡å†™å®Œæˆåï¼Œé‡å†™æ—¥å¿—è®°å½•çš„è¿™äº›æœ€æ–°æ“ä½œä¹Ÿä¼šå†™å…¥æ–°çš„ AOF æ–‡ä»¶ï¼Œä»¥ä¿è¯æ•°æ®åº“æœ€æ–°çŠ¶æ€çš„è®°å½•ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥<strong>ç”¨æ–°çš„ AOF æ–‡ä»¶æ›¿ä»£æ—§æ–‡ä»¶</strong>äº†ã€‚</p><p><img src="https://i.loli.net/2020/12/29/6vco3pLJNDBwU52.png" alt="AOFé‡å†™ç¼“å†²"></p></li></ul></li><li><p>å¦‚ä½•è§£å†³åœ¨AOFé‡å†™è¿‡ç¨‹å½“ä¸­æ•°æ®åº“æ–°çš„æ›´æ–°å¯¼è‡´çš„æœåŠ¡å™¨å½“å‰çš„æ•°æ®åº“çŠ¶æ€å’Œé‡å†™åAOFæ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®åº“çŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜ï¼Ÿï¼Ÿ</p><ul><li>AOFé‡å†™ç¼“å†²åŒºä¼šåœ¨æœåŠ¡å™¨åˆ›å»ºäº†å­è¿›ç¨‹ä¹‹åå¼€å§‹ä½¿ç”¨</li><li>å½“redisæœåŠ¡å™¨æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤ä¹‹åï¼Œå®ƒä¼šåŒæ—¶å°†å…¶å‘ç»™AOFç¼“å†²åŒºè¿˜æœ‰AOFé‡å†™ç¼“å†²åŒº</li><li>å½“å­è¿›ç¨‹å®Œæˆäº†AOFé‡å†™å·¥ä½œä¹‹åï¼Œä¼šå‘çˆ¶è¿›ç¨‹å‘å‡ºä¿¡å·ï¼Œçˆ¶è¿›ç¨‹æ¥æ”¶åˆ°ä»¥åï¼Œä¼šè°ƒç”¨ä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼Œè€Œåï¼š<ul><li>å°†AOFé‡å†™ç¼“å†²åŒºä¸­çš„æ‰€æœ‰å†…å®¹å†™å…¥åˆ°æ–°AOFæ–‡ä»¶é‡Œ</li><li>å¯¹æ–°çš„AOFæ–‡ä»¶æ”¹åï¼Œè¦†ç›–ç°æœ‰çš„AOFæ–‡ä»¶ï¼Œå®Œæˆæ–°æ—§ä¸¤ä¸ªAOFæ–‡ä»¶çš„æ›¿æ¢</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id="3-3-AOF-æ—¥å¿—é‡å†™è¿‡ç¨‹å½“ä¸­çš„é˜»å¡é£é™©"><a href="#3-3-AOF-æ—¥å¿—é‡å†™è¿‡ç¨‹å½“ä¸­çš„é˜»å¡é£é™©" class="headerlink" title="3.3 AOF æ—¥å¿—é‡å†™è¿‡ç¨‹å½“ä¸­çš„é˜»å¡é£é™©"></a>3.3 AOF æ—¥å¿—é‡å†™è¿‡ç¨‹å½“ä¸­çš„é˜»å¡é£é™©</h2><ul><li>Forkå­è¿›ç¨‹çš„è¿‡ç¨‹<ul><li>forkå¹¶ä¸ä¼šä¸€æ¬¡æ€§æ‹·è´æ‰€æœ‰å†…å­˜æ•°æ®ç»™å­è¿›ç¨‹ï¼Œé‡‡ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„copy on writeæœºåˆ¶<ul><li>copy on writeæœºåˆ¶å°±æ˜¯ä¸ºäº†é¿å…ä¸€æ¬¡æ€§æ‹·è´å¤§é‡å†…å­˜æ•°æ®ç»™å­è¿›ç¨‹é€ æˆçš„é•¿æ—¶é—´é˜»å¡çš„é—®é¢˜<ul><li>fork()ä¹‹åï¼ŒkernelæŠŠçˆ¶è¿›ç¨‹ä¸­æ‰€æœ‰çš„å†…å­˜é¡µçš„æƒé™éƒ½è®¾ä¸ºread-onlyï¼Œç„¶åå­è¿›ç¨‹çš„åœ°å€ç©ºé—´æŒ‡å‘çˆ¶è¿›ç¨‹ã€‚å½“çˆ¶å­è¿›ç¨‹éƒ½åªè¯»å†…å­˜æ—¶ï¼Œç›¸å®‰æ— äº‹ã€‚å½“å…¶ä¸­æŸä¸ªè¿›ç¨‹å†™å†…å­˜æ—¶ï¼ŒCPUç¡¬ä»¶æ£€æµ‹åˆ°å†…å­˜é¡µæ˜¯read-onlyçš„ï¼Œäºæ˜¯è§¦å‘é¡µå¼‚å¸¸ä¸­æ–­ï¼ˆpage-faultï¼‰ï¼Œé™·å…¥kernelçš„ä¸€ä¸ªä¸­æ–­ä¾‹ç¨‹ã€‚ä¸­æ–­ä¾‹ç¨‹ä¸­ï¼Œkernelå°±ä¼š<strong>æŠŠè§¦å‘çš„å¼‚å¸¸çš„é¡µå¤åˆ¶ä¸€ä»½</strong>ï¼Œäºæ˜¯çˆ¶å­è¿›ç¨‹å„è‡ªæŒæœ‰ç‹¬ç«‹çš„ä¸€ä»½ã€‚</li></ul></li></ul></li><li>forkå­è¿›ç¨‹éœ€è¦å…ˆæ‹·è´è¿›ç¨‹å¿…è¦çš„æ•°æ®ç»“æ„<ul><li>æ‹·è´å†…å­˜é¡µè¡¨ â€” å³è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜çš„æ˜ å°„ç´¢å¼•è¡¨</li><li>è¿™ä¸ªæ‹·è´è¿‡ç¨‹ä¼šæ¶ˆè€—å¤§é‡çš„CPUèµ„æºï¼Œå¹¶ä¸”æ‹·è´å®Œæˆä¹‹å‰æ•´ä¸ªè¿›ç¨‹æ˜¯ä¼šé˜»å¡çš„</li><li>é˜»å¡æ—¶é—´å–å†³äºæ•´ä¸ªå®ä¾‹çš„å†…å­˜å¤§å°<ul><li>å®ä¾‹è¶Šå¤§ï¼Œå†…å­˜é¡µè¡¨ä¹Ÿè¶Šå¤§ï¼Œforké˜»å¡æ—¶é—´å°±ä¼šè¶Šä¹…</li></ul></li></ul></li><li>åœ¨å®Œæˆäº†æ‹·è´å†…å­˜é¡µè¡¨ä¹‹åï¼Œå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹æŒ‡å‘çš„æ˜¯ç›¸åŒçš„å†…å­˜åœ°å€ç©ºé—´<ul><li>è¿™ä¸ªæ—¶å€™è™½ç„¶äº§ç”Ÿäº†å­è¿›ç¨‹ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç”³è¯·å’Œçˆ¶è¿›ç¨‹ç›¸åŒçš„å†…å­˜å¤§å°</li><li>çœŸæ­£çš„å†…å­˜åˆ†ç¦»æ˜¯<strong>åœ¨å†™å‘ç”Ÿçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šçœŸæ­£æ‹·è´å†…å­˜çš„æ•°æ®</strong></li></ul></li></ul></li><li>AOFé‡å†™è¿‡ç¨‹ä¸­çˆ¶è¿›ç¨‹äº§ç”Ÿå†™å…¥çš„è¿‡ç¨‹<ul><li>Forkå‡ºçš„å­è¿›ç¨‹å½“å‰çŠ¶æ€æ˜¯æŒ‡å‘äº†å’Œçˆ¶è¿›ç¨‹ç›¸åŒçš„å†…å­˜åœ°å€ç©ºé—´ï¼Œè¿™ä¸ªæ—¶å€™å­è¿›ç¨‹å°±å¯ä»¥æ‰§è¡ŒAOFé‡å†™ï¼Œå°†å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®å†™å…¥åˆ°AOFæ–‡ä»¶é‡Œ</li><li>ä½†æ˜¯åŒæ—¶çˆ¶è¿›ç¨‹ä»ç„¶ä¼šæœ‰æµé‡å†™å…¥<ul><li>å¦‚æœçˆ¶è¿›ç¨‹æ“ä½œçš„æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„keyï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™çˆ¶è¿›ç¨‹å°±ä¼šçœŸæ­£æ‹·è´è¿™ä¸ªkeyå¯¹åº”çš„å†…å­˜æ•°æ®ï¼Œç”³è¯·æ–°çš„å†…å­˜ç©ºé—´ï¼Œè¿™æ ·é€æ¸åœ°ï¼Œçˆ¶å­è¿›ç¨‹å†…å­˜æ•°æ®å¼€å§‹åˆ†ç¦»</li><li>çˆ¶å­è¿›ç¨‹é€æ¸æ‹¥æœ‰å„è‡ªç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€‚å› ä¸ºå†…å­˜åˆ†é…æ˜¯ä»¥é¡µä¸ºå•ä½è¿›è¡Œåˆ†é…çš„ï¼Œé»˜è®¤4kï¼Œå¦‚æœçˆ¶è¿›ç¨‹æ­¤æ—¶æ“ä½œçš„æ˜¯ä¸€ä¸ªbigkeyï¼Œé‡æ–°ç”³è¯·å¤§å—å†…å­˜è€—æ—¶ä¼šå˜é•¿ï¼Œå¯èƒ½ä¼šäº§é˜»å¡é£é™©</li><li>å¦‚æœæ“ä½œç³»ç»Ÿå¼€å¯äº†å†…å­˜å¤§é¡µæœºåˆ¶(Huge Pageï¼Œé¡µé¢å¤§å°2M)ï¼Œé‚£ä¹ˆçˆ¶è¿›ç¨‹ç”³è¯·å†…å­˜æ—¶é˜»å¡çš„æ¦‚ç‡å°†ä¼šå¤§å¤§æé«˜ï¼Œæ‰€ä»¥åœ¨Redisæœºå™¨ä¸Šéœ€è¦å…³é—­Huge Pageæœºåˆ¶ã€‚Redisæ¯æ¬¡forkç”ŸæˆRDBæˆ–AOFé‡å†™å®Œæˆåï¼Œéƒ½å¯ä»¥åœ¨Redis logä¸­çœ‹åˆ°çˆ¶è¿›ç¨‹é‡æ–°ç”³è¯·äº†å¤šå¤§çš„å†…å­˜ç©ºé—´</li></ul></li></ul></li></ul><h2 id="3-4-AOFé‡å†™æ—¥å¿—ä¸ºä»€ä¹ˆä¸å…±äº«AOFæœ¬èº«çš„æ—¥å¿—ï¼Ÿ"><a href="#3-4-AOFé‡å†™æ—¥å¿—ä¸ºä»€ä¹ˆä¸å…±äº«AOFæœ¬èº«çš„æ—¥å¿—ï¼Ÿ" class="headerlink" title="3.4 AOFé‡å†™æ—¥å¿—ä¸ºä»€ä¹ˆä¸å…±äº«AOFæœ¬èº«çš„æ—¥å¿—ï¼Ÿ"></a>3.4 AOFé‡å†™æ—¥å¿—ä¸ºä»€ä¹ˆä¸å…±äº«AOFæœ¬èº«çš„æ—¥å¿—ï¼Ÿ</h2><p>AOFé‡å†™ä¸å¤ç”¨AOFæœ¬èº«çš„æ—¥å¿—ï¼Œä¸€ä¸ªåŸå› æ˜¯çˆ¶å­è¿›ç¨‹å†™åŒä¸€ä¸ªæ–‡ä»¶å¿…ç„¶ä¼šäº§ç”Ÿç«äº‰é—®é¢˜ï¼Œæ§åˆ¶ç«äº‰å°±æ„å‘³ç€ä¼šå½±å“çˆ¶è¿›ç¨‹çš„æ€§èƒ½ã€‚äºŒæ˜¯å¦‚æœAOFé‡å†™è¿‡ç¨‹ä¸­å¤±è´¥äº†ï¼Œé‚£ä¹ˆåŸæœ¬çš„AOFæ–‡ä»¶ç›¸å½“äºè¢«æ±¡æŸ“äº†ï¼Œæ— æ³•åšæ¢å¤ä½¿ç”¨ã€‚æ‰€ä»¥Redis AOFé‡å†™ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œé‡å†™å¤±è´¥çš„è¯ï¼Œç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶å°±å¥½äº†ï¼Œä¸ä¼šå¯¹åŸå…ˆçš„AOFæ–‡ä»¶äº§ç”Ÿå½±å“ã€‚ç­‰é‡å†™å®Œæˆä¹‹åï¼Œç›´æ¥æ›¿æ¢æ—§æ–‡ä»¶å³å¯</p><h2 id="3-5-å¦‚ä½•è§¦å‘AOFé‡å†™ï¼Ÿ"><a href="#3-5-å¦‚ä½•è§¦å‘AOFé‡å†™ï¼Ÿ" class="headerlink" title="3.5 å¦‚ä½•è§¦å‘AOFé‡å†™ï¼Ÿ"></a>3.5 å¦‚ä½•è§¦å‘AOFé‡å†™ï¼Ÿ</h2><p>æœ‰ä¸¤ä¸ªé…ç½®é¡¹åœ¨æ§åˆ¶AOFé‡å†™çš„è§¦å‘æ—¶æœºï¼š</p><ol><li>auto-aof-rewrite-min-size: è¡¨ç¤ºè¿è¡ŒAOFé‡å†™æ—¶æ–‡ä»¶çš„æœ€å°å¤§å°ï¼Œé»˜è®¤ä¸º64MB</li><li>auto-aof-rewrite-percentage: è¿™ä¸ªå€¼çš„è®¡ç®—æ–¹æ³•æ˜¯ï¼šå½“å‰AOFæ–‡ä»¶å¤§å°å’Œä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶å¤§å°çš„å·®å€¼ï¼Œå†é™¤ä»¥ä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶å¤§å°ã€‚ä¹Ÿå°±æ˜¯å½“å‰AOFæ–‡ä»¶æ¯”ä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶çš„å¢é‡å¤§å°ï¼Œå’Œä¸Šä¸€æ¬¡é‡å†™åAOFæ–‡ä»¶å¤§å°çš„æ¯”å€¼ã€‚</li></ol><p>AOFæ–‡ä»¶å¤§å°åŒæ—¶è¶…å‡ºä¸Šé¢è¿™ä¸¤ä¸ªé…ç½®é¡¹æ—¶ï¼Œä¼šè§¦å‘AOFé‡å†™ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://time.geekbang.org/column/article/271754">https://time.geekbang.org/column/article/271754</a></li><li><a href="https://juejin.cn/post/6844903702373859335">https://juejin.cn/post/6844903702373859335</a> </li><li>Redisè®¾è®¡ä¸å®ç°</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis IO æ¨¡å‹</title>
      <link href="/Redis-IO-%E6%A8%A1%E5%9E%8B/"/>
      <url>/Redis-IO-%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis-IO-æ¨¡å‹"><a href="#Redis-IO-æ¨¡å‹" class="headerlink" title="Redis IO æ¨¡å‹"></a>Redis IO æ¨¡å‹</h1><blockquote><p>ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„Redisä¼šé‚£ä¹ˆå¿«ï¼Ÿ</p></blockquote><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>è¿™é‡Œçš„å•çº¿ç¨‹ä¸»è¦æŒ‡Redisçš„ç½‘ç»œIOå’Œé”®å€¼å¯¹è¯»å†™æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹æ¥å®Œæˆçš„ï¼Œè€ŒRedisçš„å…¶ä»–åŠŸèƒ½ï¼Œæ¯”å¦‚æŒä¹…åŒ–ï¼Œå¼‚æ­¥åˆ é™¤ï¼Œé›†ç¾¤æ•°æ®åŒæ­¥ç­‰ï¼Œæ˜¯ç”±é¢å¤–çš„çº¿ç¨‹æ‰§è¡Œçš„ã€‚</p><h1 id="2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•çº¿ç¨‹ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•çº¿ç¨‹ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•çº¿ç¨‹ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•çº¿ç¨‹ï¼Ÿ</h1><ul><li><p>ä½¿ç”¨å¤šçº¿ç¨‹çš„å¼€é”€</p><ul><li><p>ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥å¢åŠ ç³»ç»Ÿçš„ååç‡/ æ‹“å±•æ€§</p></li><li><p>ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯å¤šçº¿ç¨‹æœ¬èº«æœ‰å¼€é”€ï¼Œå¹¶ä¸æ˜¯çº¿ç¨‹å¢å¤šååç‡ä¼šçº¿æ€§å¢é•¿çš„ã€‚è¾¾åˆ°äº†æŸä¸ªçº¿ç¨‹æ•°ä¹‹åï¼Œç³»ç»Ÿååç‡çš„å¢é•¿å°±ä¼šå¼€å§‹è¿Ÿç¼“äº†ï¼Œæœ‰æ—¶ç”šè‡³ä¼šå‡ºç°ä¸‹é™çš„æƒ…å†µ</p><p><img src="https://i.loli.net/2020/12/24/UNVLxyIRokWmjTQ.png" alt="ååç‡Metrics"></p><p>ååç‡éšç€çº¿ç¨‹æ•°å¢é•¿çš„å˜åŒ–</p></li><li><p>å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› åœ¨äº</p><ul><li>ç³»ç»Ÿä¸­é€šå¸¸ä¼šå­˜åœ¨è¢«<strong>å¤šçº¿ç¨‹åŒæ—¶è®¿é—®çš„å…±äº«èµ„æº</strong> â€” æ¯”å¦‚ä¸€ä¸ªå…±äº«çš„æ•°æ®ç»“æ„</li><li>å½“æœ‰å¤šä¸ªçº¿ç¨‹è¦ä¿®æ”¹è¿™ä¸ªå…±äº«èµ„æºçš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯å…±äº«èµ„æºçš„æ­£ç¡®æ€§ï¼Œå°±éœ€è¦æœ‰é¢å¤–çš„æœºåˆ¶è¿›è¡Œä¿è¯ã€‚è¿™ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€</li></ul></li></ul></li><li><p>Redisé‡‡ç”¨å•çº¿ç¨‹å°±æ˜¯å¸Œæœ›èƒ½å¤Ÿé¿å…è¿™ç§å…±äº«èµ„æºæ”¾é”çš„æƒ…å†µ</p><ul><li>è€Œä¸”CPUå¾€å¾€ä¸æ˜¯Redisçš„ç“¶é¢ˆï¼Œç“¶é¢ˆå¾ˆå¯èƒ½æ˜¯æœºå™¨å†…å­˜æˆ–è€…ç½‘ç»œå¸¦å®½</li></ul></li></ul><h1 id="3-å•çº¿ç¨‹Redisæ˜¯å¦‚ä½•å®ç°ä½å»¶æ—¶çš„"><a href="#3-å•çº¿ç¨‹Redisæ˜¯å¦‚ä½•å®ç°ä½å»¶æ—¶çš„" class="headerlink" title="3. å•çº¿ç¨‹Redisæ˜¯å¦‚ä½•å®ç°ä½å»¶æ—¶çš„"></a>3. å•çº¿ç¨‹Redisæ˜¯å¦‚ä½•å®ç°ä½å»¶æ—¶çš„</h1><ul><li>High Level Takeaway<ul><li>å†…å­˜ä¸Šå®Œæˆæ“ä½œ</li><li>é«˜æ•ˆçš„æ•°æ®ç»“æ„</li><li>å¤šè·¯å¤ç”¨æœºåˆ¶ â€” ç½‘ç»œIOèƒ½å¤Ÿå¹¶å‘å¤„ç†å¤§é‡çš„å®¢æˆ·ç«¯è¯·æ±‚</li></ul></li></ul><h2 id="3-1-åŸºæœ¬IOæ¨¡å‹å’Œé˜»å¡ç‚¹"><a href="#3-1-åŸºæœ¬IOæ¨¡å‹å’Œé˜»å¡ç‚¹" class="headerlink" title="3.1  åŸºæœ¬IOæ¨¡å‹å’Œé˜»å¡ç‚¹"></a>3.1  åŸºæœ¬IOæ¨¡å‹å’Œé˜»å¡ç‚¹</h2><p>ä»¥å‰é¢çš„SimpleKVä¸ºä¾‹ï¼Œä¸ºäº†å¤„ç†ä¸€ä¸ªGetè¯·æ±‚ï¼Œæ•°æ®åº“éœ€è¦ï¼š</p><ol><li>ç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚(bind/ listen)</li><li>å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ (accept)</li><li>ä»socketä¸­è¯»å–è¯·æ±‚(recv)</li><li>è§£æå®¢æˆ·ç«¯å‘é€è¯·æ±‚(parse)</li><li>æ ¹æ®è¯·æ±‚ç±»å‹è¯»å–é”®å€¼æ•°æ®(get)</li><li>ä»å®¢æˆ·ç«¯è¿”å›ç»“æœï¼Œå³å‘socketä¸­å†™å›æ•°æ®(send)</li></ol><p><img src="https://i.loli.net/2020/12/24/1pFsDaMO452fGkQ.png" alt="å¤„ç†IOæµç¨‹"></p><p>Getè¯·æ±‚å¤„ç†ç¤ºæ„å›¾</p><p>åœ¨ä¸Šè¿°çš„æ•´ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œå¦‚æœRedisç›‘å¬åˆ°å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä½†æ²¡æœ‰æˆåŠŸå»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ<strong>ä¼šé˜»å¡åœ¨acceptå‡½æ•°ä¸Šï¼Œå¯¼è‡´å…¶ä»–çš„å®¢æˆ·ç«¯æ— æ³•å»ºç«‹è¿æ¥</strong>ã€‚è¿™ç§åŸºæœ¬IOæ¨¡å‹æ•ˆç‡ä¼šéå¸¸ä½ï¼Œå› ä¸ºæ˜¯é˜»å¡å¼çš„ï¼Œä»»ä½•ä¸€ä¸ªè¯·æ±‚å‡ºç°äº†ä»»ä½•ä¸€ä¸ªé—®é¢˜ï¼Œéƒ½ä¼šå¯¼è‡´å…¶ä»–çš„è¯·æ±‚æ— æ³•æˆåŠŸå®Œæˆã€‚</p><h2 id="3-2-éé˜»å¡æ¨¡å¼"><a href="#3-2-éé˜»å¡æ¨¡å¼" class="headerlink" title="3.2 éé˜»å¡æ¨¡å¼"></a>3.2 éé˜»å¡æ¨¡å¼</h2><p>Socketç½‘ç»œæ¨¡å‹çš„éé˜»å¡æ¨¡å¼ä½“ç°åœ¨ä¸åŒæ“ä½œè°ƒç”¨åä¼š<strong>è¿”å›ä¸åŒçš„å¥—æ¥å­—ç±»å‹</strong>ã€‚socket() æ–¹æ³•ä¼šè¿”å›ä¸»åŠ¨å¥—æ¥å­—ï¼Œç„¶åè°ƒç”¨ listen() æ–¹æ³•ï¼Œå°†ä¸»åŠ¨å¥—æ¥å­—è½¬åŒ–ä¸ºç›‘å¬å¥—æ¥å­—ï¼Œæ­¤æ—¶ï¼Œå¯ä»¥ç›‘å¬æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚æœ€åï¼Œè°ƒç”¨ accept() æ–¹æ³•æ¥æ”¶åˆ°è¾¾çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œå¹¶è¿”å›å·²è¿æ¥å¥—æ¥å­—ã€‚</p><p>è¿™æ ·å­å¯ä»¥å®ç°éé˜»å¡ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦ä¸€äº›æœºåˆ¶æ¥ç›‘å¬å¥—æ¥å­—ï¼Œæœ‰æ•°æ®åˆ°è¾¾çš„æ—¶å€™å†é€šçŸ¥æ•°æ®åº“çº¿ç¨‹</p><h2 id="3-3-åŸºäºå¤šè·¯å¤ç”¨çš„é«˜æ€§èƒ½I-Oæ¨¡å‹"><a href="#3-3-åŸºäºå¤šè·¯å¤ç”¨çš„é«˜æ€§èƒ½I-Oæ¨¡å‹" class="headerlink" title="3.3  åŸºäºå¤šè·¯å¤ç”¨çš„é«˜æ€§èƒ½I/Oæ¨¡å‹"></a>3.3  åŸºäºå¤šè·¯å¤ç”¨çš„é«˜æ€§èƒ½I/Oæ¨¡å‹</h2><ul><li>æ˜¯ä»€ä¹ˆ<ul><li>æŒ‡è®©ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿå¤„ç†å¤šä¸ªIOæµ</li><li>select epollæœºåˆ¶<ul><li>åœ¨å†…æ ¸ä¸­ï¼Œå­˜åœ¨å¤šä¸ªç›‘å¬å¥—æ¥å­—å’Œå·²è¿æ¥å¥—æ¥å­—</li><li>å†…æ ¸ä¼šä¸€ç›´ç›‘å¬è¿™äº›å¥—æ¥å­—ä¸Šçš„è¿æ¥è¯·æ±‚æˆ–è€…æ•°æ®è¯·æ±‚</li></ul></li></ul></li><li>ä¸ºä»€ä¹ˆä½¿ç”¨I/Oå¤šè·¯å¤ç”¨è¿™ç§æŠ€æœ¯<ul><li>è§£å†³å•çº¿ç¨‹ä¸‹é˜»å¡æ“ä½œçš„é—®é¢˜</li></ul></li><li>å¦‚ä½•å®ç°çš„<ul><li>select epollæ–¹æ³•åŒæ—¶ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦FDçš„è¯»å†™æƒ…å†µï¼Œå½“æŸäº›FDå¯è¯»/ å¯å†™çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•å°±ä¼šè¿”å›å¯è¯»/ å†™çš„FDä¸ªæ•°<br><a href="https://cloud.tencent.com/developer/article/1639569">IOå¤šè·¯å¤ç”¨ï¼šRedisä¸­ç»å…¸çš„Reactorè®¾è®¡æ¨¡å¼</a><ul><li>å°†ç”¨æˆ·Socketå¯¹åº”çš„FDæ³¨å†Œè¿›epollï¼Œç„¶åepollå‘Šè¯‰é‚£äº›éœ€è¦è¿›è¡Œè¯»å†™æ“ä½œçš„socketï¼Œåªå¤„ç†é‚£äº›æ´»è·ƒçš„ï¼Œæœ‰å˜åŒ–çš„socket FD</li></ul></li></ul></li></ul><p><a href="https://draveness.me/redis-io-multiplexing/">https://draveness.me/redis-io-multiplexing/</a></p><p><a href="https://cloud.tencent.com/developer/article/1639569">https://cloud.tencent.com/developer/article/1639569</a></p><p><a href="https://blog.csdn.net/u014590757/article/details/79860766">https://blog.csdn.net/u014590757/article/details/79860766</a></p><ul><li><p>ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªIOæµ â€” select / epollæœºåˆ¶</p><p>  <img src="https://i.loli.net/2020/12/24/QUKfj9ExTgy4tMN.png" alt="select/ epollæœºåˆ¶æµç¨‹"></p><p>  epollæœºåˆ¶</p><ul><li><p>å…è®¸å†…æ ¸ä¸­ï¼ŒåŒæ—¶å­˜åœ¨å¤šä¸ªç›‘å¬å¥—æ¥å­—å’Œå·²è¿æ¥å¥—æ¥å­—</p></li><li><p>å†…æ ¸ä¼šä¸€ç›´ç›‘å¬è¿™äº›å¥—æ¥å­—ä¸Šçš„è¿æ¥è¯·æ±‚æˆ–æ•°æ®è¯·æ±‚</p></li><li><p>ä¸€æ—¦æœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šäº¤ç»™Redisçº¿ç¨‹å¤„ç†</p><p><img src="https://i.loli.net/2020/12/24/4Cp7TQMZ3csAUIm.png" alt="epollè¿‡ç¨‹"></p><p>å¤šè·¯å¤ç”¨å…¨ç¨‹</p></li></ul></li><li><p>select/ epoll ä¸€æ—¦æ£€æµ‹åˆ°FDä¸Šæœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶</p><ul><li>äº‹ä»¶ä¼šè¢«æ”¾åˆ°ä¸€ä¸ªäº‹ä»¶é˜Ÿåˆ—ï¼ŒRediså•çº¿ç¨‹å¯¹è¯¥äº‹ä»¶é˜Ÿåˆ—ä¸æ–­è¿›è¡Œå¤„ç†</li></ul></li></ul><h2 id="3-3-å•çº¿ç¨‹å¤„ç†çš„æ€§èƒ½ç“¶é¢ˆ"><a href="#3-3-å•çº¿ç¨‹å¤„ç†çš„æ€§èƒ½ç“¶é¢ˆ" class="headerlink" title="3.3 å•çº¿ç¨‹å¤„ç†çš„æ€§èƒ½ç“¶é¢ˆ"></a>3.3 å•çº¿ç¨‹å¤„ç†çš„æ€§èƒ½ç“¶é¢ˆ</h2><p>1ã€ä»»æ„ä¸€ä¸ªè¯·æ±‚åœ¨serverä¸­ä¸€æ—¦å‘ç”Ÿè€—æ—¶ï¼Œéƒ½ä¼šå½±å“æ•´ä¸ªserverçš„æ€§èƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´åé¢çš„è¯·æ±‚éƒ½è¦ç­‰å‰é¢è¿™ä¸ªè€—æ—¶è¯·æ±‚å¤„ç†å®Œæˆï¼Œè‡ªå·±æ‰èƒ½è¢«å¤„ç†åˆ°ã€‚è€—æ—¶çš„æ“ä½œåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p><p>aã€æ“ä½œbigkeyï¼šå†™å…¥ä¸€ä¸ªbigkeyåœ¨åˆ†é…å†…å­˜æ—¶éœ€è¦æ¶ˆè€—æ›´å¤šçš„æ—¶é—´ï¼ŒåŒæ ·ï¼Œåˆ é™¤bigkeyé‡Šæ”¾å†…å­˜åŒæ ·ä¼šäº§ç”Ÿè€—æ—¶ï¼›</p><p>bã€ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤ï¼šä¾‹å¦‚SORT/SUNION/ZUNIONSTOREï¼Œæˆ–è€…O(N)å‘½ä»¤ï¼Œä½†æ˜¯Nå¾ˆå¤§ï¼Œä¾‹å¦‚lrange key 0 -1ä¸€æ¬¡æŸ¥è¯¢å…¨é‡æ•°æ®ï¼›</p><p>cã€å¤§é‡keyé›†ä¸­è¿‡æœŸï¼šRedisçš„è¿‡æœŸæœºåˆ¶ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå¤§é‡keyé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´å¤„ç†ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œè€—æ—¶éƒ½åœ¨åˆ é™¤è¿‡æœŸkeyï¼Œè€—æ—¶å˜é•¿ï¼›</p><p>dã€æ·˜æ±°ç­–ç•¥ï¼šæ·˜æ±°ç­–ç•¥ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ï¼Œå½“å†…å­˜è¶…è¿‡Rediså†…å­˜ä¸Šé™åï¼Œæ¯æ¬¡å†™å…¥éƒ½éœ€è¦æ·˜æ±°ä¸€äº›keyï¼Œä¹Ÿä¼šé€ æˆè€—æ—¶å˜é•¿ï¼›</p><p>eã€AOFåˆ·ç›˜å¼€å¯alwaysæœºåˆ¶ï¼šæ¯æ¬¡å†™å…¥éƒ½éœ€è¦æŠŠè¿™ä¸ªæ“ä½œåˆ·åˆ°ç£ç›˜ï¼Œå†™ç£ç›˜çš„é€Ÿåº¦è¿œæ¯”å†™å†…å­˜æ…¢ï¼Œä¼šæ‹–æ…¢Redisçš„æ€§èƒ½ï¼›</p><p>fã€ä¸»ä»å…¨é‡åŒæ­¥ç”ŸæˆRDBï¼šè™½ç„¶é‡‡ç”¨forkå­è¿›ç¨‹ç”Ÿæˆæ•°æ®å¿«ç…§ï¼Œä½†forkè¿™ä¸€ç¬é—´ä¹Ÿæ˜¯ä¼šé˜»å¡æ•´ä¸ªçº¿ç¨‹çš„ï¼Œå®ä¾‹è¶Šå¤§ï¼Œé˜»å¡æ—¶é—´è¶Šä¹…ï¼›</p><p>2ã€å¹¶å‘é‡éå¸¸å¤§æ—¶ï¼Œå•çº¿ç¨‹è¯»å†™å®¢æˆ·ç«¯IOæ•°æ®å­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œè™½ç„¶é‡‡ç”¨IOå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œä½†æ˜¯è¯»å†™å®¢æˆ·ç«¯æ•°æ®ä¾æ—§æ˜¯åŒæ­¥IOï¼Œåªèƒ½å•çº¿ç¨‹ä¾æ¬¡è¯»å–å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œæ— æ³•åˆ©ç”¨åˆ°CPUå¤šæ ¸ã€‚</p><p>é’ˆå¯¹é—®é¢˜1ï¼Œä¸€æ–¹é¢éœ€è¦ä¸šåŠ¡äººå‘˜å»è§„é¿ï¼Œä¸€æ–¹é¢Redisåœ¨4.0æ¨å‡ºäº†lazy-freeæœºåˆ¶ï¼ŒæŠŠbigkeyé‡Šæ”¾å†…å­˜çš„è€—æ—¶æ“ä½œæ”¾åœ¨äº†å¼‚æ­¥çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé™ä½å¯¹ä¸»çº¿ç¨‹çš„å½±å“ã€‚</p><p>é’ˆå¯¹é—®é¢˜2ï¼ŒRedisåœ¨6.0æ¨å‡ºäº†å¤šçº¿ç¨‹ï¼Œå¯ä»¥åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹åˆ©ç”¨CPUå¤šæ ¸å¤šçº¿ç¨‹è¯»å†™å®¢æˆ·ç«¯æ•°æ®ï¼Œè¿›ä¸€æ­¥æå‡serveræ€§èƒ½ï¼Œå½“ç„¶ï¼Œåªæ˜¯é’ˆå¯¹å®¢æˆ·ç«¯çš„è¯»å†™æ˜¯å¹¶è¡Œçš„ï¼Œæ¯ä¸ªå‘½ä»¤çš„çœŸæ­£æ“ä½œä¾æ—§æ˜¯å•çº¿ç¨‹çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisæ•°æ®ç»“æ„</title>
      <link href="/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
      <url>/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="Redisæ•°æ®ç»“æ„"><a href="#Redisæ•°æ®ç»“æ„" class="headerlink" title="Redisæ•°æ®ç»“æ„"></a>Redisæ•°æ®ç»“æ„</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>Redisçš„å¿«é€Ÿé™¤äº†åŸºäºå†…å­˜çš„åŸå› ä»¥å¤–ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯åœ¨å…¶æ•°æ®ç»“æ„ä¸Šçš„æ“ä½œæ‰§è¡Œçš„å¾ˆå¿«ã€‚è¿™é‡Œä¼šèµ°ä¸€éRedisçš„ç°æœ‰æ•°æ®ç»“æ„ï¼Œæ€»ç»“å…¶å„è‡ªçš„ç‰¹ç‚¹ï¼ŒRedisçš„æ•°æ®ç±»å‹å’Œå…¶åº•å±‚æ•°æ®ç»“æ„çš„å¯¹åº”å…³ç³»ã€‚</p><p><img src="https://i.loli.net/2021/07/03/L6sH52KacFyROMf.png" alt="Redisæ•°æ®ç±»å‹å’Œåº•å±‚æ•°æ®ç»“æ„å¯¹åº”å…³ç³»"></p><ul><li>Redisåº•å±‚å…±æœ‰6ä¸­åŸºæœ¬æ•°æ®ç»“æ„ï¼Œå…¶æœ‰ç€ä¸åŒçš„å’ŒRedisçš„æ•°æ®ç±»å‹çš„å¯¹åº”</li><li>List, Hash, Sorted Set, ä»¥åŠSetéƒ½æœ‰ä¸¤ç§å®ç°ç»“æ„</li></ul><h1 id="2-é”®å€¼ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä½•ç»„ç»‡"><a href="#2-é”®å€¼ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä½•ç»„ç»‡" class="headerlink" title="2. é”®å€¼ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä½•ç»„ç»‡"></a>2. é”®å€¼ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä½•ç»„ç»‡</h1><h2 id="2-1-å…¨å±€å“ˆå¸Œè¡¨"><a href="#2-1-å…¨å±€å“ˆå¸Œè¡¨" class="headerlink" title="2.1 å…¨å±€å“ˆå¸Œè¡¨"></a>2.1 å…¨å±€å“ˆå¸Œè¡¨</h2><ul><li>Redisä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥ä¿å­˜æ‰€æœ‰çš„é”®å€¼å¯¹</li><li>ä¸€ä¸ªå“ˆå¸Œè¡¨ç”±å¤šä¸ªå“ˆå¸Œæ¡¶ç»„æˆï¼Œæ¯ä¸ªå“ˆå¸Œæ¡¶ä¿å­˜äº†é”®å€¼å¯¹æ•°æ®</li><li>å“ˆå¸Œæ¡¶å½“ä¸­çš„entryå…ƒç´ è¿™èƒ½å¤Ÿä¿å­˜çš„æ˜¯keyå’Œvalueçš„æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘å®é™…çš„é”®å€¼</li></ul><p><img src="https://i.loli.net/2021/07/03/tXTca4hIin1zNyH.png" alt="å…¨å±€å“ˆå¸Œè¡¨"></p><ul><li>è®¿é—®æµç¨‹ä¸º<ul><li>è®¡ç®—é”®çš„å“ˆå¸Œå€¼</li><li>è®¿é—®åˆ°å¯¹åº”çš„å“ˆå¸Œæ¡¶</li><li>æ ¹æ®å“ˆå¸Œæ¡¶æ¥æ‰¾åˆ°keyå’Œvalueçš„åœ°å€</li></ul></li><li>ä¸ºä»€ä¹ˆéœ€è¦å“ˆå¸Œæ¡¶ï¼Ÿ<ul><li>å› ä¸ºå€¼çš„åº•å±‚å®ç°ä¼šæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™æ ·å­å“ˆå¸Œæ¡¶æ‰€å å†…å­˜ç©ºé—´æ˜¯æ•´é½ä¸”å¯æ§çš„</li><li>ç„¶åé€šè¿‡æŒ‡é’ˆæ¥æ‰¾åˆ°åœ¨å†…å­˜å½“ä¸­çš„å…·ä½“åœ°å€</li><li>è¿™ä¸ªæ—¶å€™value æ˜¯å¯ä»¥åˆ†æ•£çš„æ”¾ç½®åœ¨å†…å­˜å—å½“ä¸­çš„</li></ul></li></ul><h2 id="2-2-å“ˆå¸Œè¡¨çš„å†²çªé—®é¢˜"><a href="#2-2-å“ˆå¸Œè¡¨çš„å†²çªé—®é¢˜" class="headerlink" title="2.2 å“ˆå¸Œè¡¨çš„å†²çªé—®é¢˜"></a>2.2 å“ˆå¸Œè¡¨çš„å†²çªé—®é¢˜</h2><ul><li>å“ˆå¸Œå†²çªä¸å¯é¿å…ï¼Œå³ä¸¤ä¸ªkeyçš„å“ˆå¸Œå€¼å’Œå“ˆå¸Œæ¡¶è®¡ç®—å¯¹åº”å…³ç³»çš„æ—¶å€™ï¼Œè½åˆ°äº†åŒä¸€ä¸ªå“ˆå¸Œæ¡¶å½“ä¸­äº†</li><li>è§£å†³æ–¹å¼<ul><li>çŸ­æœŸè§£å†³æ–¹æ¡ˆ<ul><li>é“¾å¼å“ˆå¸Œ<ul><li>åŒä¸€ä¸ªå“ˆå¸Œæ¡¶ä¸­å¤šä¸ªå…ƒç´ ç”¨ä¸€ä¸ªé“¾è¡¨æ¥ä¿å­˜ï¼Œä¾æ¬¡ç”¨æŒ‡é’ˆè¿æ¥</li><li>æ³¨æ„æ–°çš„å…ƒç´ ä¼šåŠ åˆ°å¤´ä¸Š</li></ul></li><li>å­˜åœ¨çš„é—®é¢˜<ul><li>å½“å“ˆå¸Œå†²çªé“¾å˜å¾—è¿‡é•¿ï¼ŒæŸ¥æ‰¾é€Ÿåº¦ä¼šé€€åŒ–ï¼Œæ— æ³•å®ç°O(1)äº†</li></ul></li></ul></li><li>ä¸­é•¿æœŸè§£å†³æ–¹æ¡ˆ<ul><li>rehash  â€”â†’ å¢åŠ ç°æœ‰çš„å“ˆå¸Œæ¡¶æ•°é‡<ul><li>æ˜¯é€æ¸å¢å¤šçš„entryåœ¨æ›´å¤šçš„æ¡¶ä¹‹é—´åˆ†æ•£ä¿å­˜</li></ul></li></ul></li></ul></li></ul><h2 id="2-3-å“ˆå¸Œè¡¨Rehashç­–ç•¥"><a href="#2-3-å“ˆå¸Œè¡¨Rehashç­–ç•¥" class="headerlink" title="2.3 å“ˆå¸Œè¡¨Rehashç­–ç•¥"></a>2.3 å“ˆå¸Œè¡¨Rehashç­–ç•¥</h2><ul><li><p>æ•´ä½“æµç¨‹</p><ul><li>é¦–å…ˆRedisé»˜è®¤æœ‰ä¸¤ä¸ªå…¨å±€å“ˆå¸Œè¡¨</li><li>å½“ä½ æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œé»˜è®¤ä½¿ç”¨å“ˆå¸Œè¡¨1ï¼Œ æ­¤æ—¶å“ˆå¸Œè¡¨2æ²¡æœ‰è¢«åˆ†é…ç©ºé—´</li><li>éšç€æ•°æ®å¢å¤šï¼ŒRediså¼€å§‹æ‰§è¡Œrehash<ul><li>ç»™å“ˆå¸Œè¡¨2åˆ†é…æ›´å¤§çš„ç©ºé—´ï¼Œä¾‹å¦‚æ˜¯1çš„ä¸¤å€</li><li>å°†å“ˆå¸Œè¡¨1ä¸­çš„æ•°æ®é‡æ–°æ˜ å°„å¹¶æ‹·è´åˆ°å“ˆå¸Œè¡¨2å½“ä¸­<ul><li>è¿™ä¸€æ­¥ä¼šæ¶‰åŠåˆ°å¤§é‡çš„æ•°æ®æ‹·è´ï¼Œä¼šé€ æˆRedisçº¿ç¨‹é˜»å¡</li></ul></li><li>é‡Šæ”¾å“ˆå¸Œè¡¨1çš„ç©ºé—´</li></ul></li><li>å¦å¤–ï¼Œ åœ¨æ¸è¿›å¼ rehash æ‰§è¡ŒæœŸé—´ï¼Œ æ–°æ·»åŠ åˆ°å­—å…¸çš„é”®å€¼å¯¹ä¸€å¾‹ä¼šè¢«ä¿å­˜åˆ° ht[1] é‡Œé¢ï¼Œ è€Œ ht[0] åˆ™ä¸å†è¿›è¡Œä»»ä½•æ·»åŠ æ“ä½œï¼š è¿™ä¸€æªæ–½ä¿è¯äº† ht[0] åŒ…å«çš„é”®å€¼å¯¹æ•°é‡ä¼šåªå‡ä¸å¢ï¼Œ å¹¶éšç€ rehash æ“ä½œçš„æ‰§è¡Œè€Œæœ€ç»ˆå˜æˆç©ºè¡¨</li></ul></li><li><p>æ¸è¿›å¼å“ˆå¸Œ</p><ul><li>æ˜¯ä¸ºäº†è§£å†³åœ¨åšå“ˆå¸Œè¡¨çš„å¤åˆ¶è¿‡ç¨‹å½“ä¸­ï¼Œå¯èƒ½é€ æˆçš„çº¿ç¨‹é˜»å¡é—®é¢˜</li><li>ä¸€æ¬¡å¤„ç†åˆ†æˆå¤šæ¬¡ï¼Œå¤„ç†è¯·æ±‚çš„æ—¶å€™é¡ºå¸¦ç€æ›´æ–°çš„å“ˆå¸Œè¡¨2å½“ä¸­</li><li>rehashçš„æ•´ä½“æµç¨‹<ol><li>ä¸º <code>ht[1]</code> åˆ†é…ç©ºé—´ï¼Œè®©å­—å…¸åŒæ—¶æŒæœ‰ <code>ht[0]</code> å’Œ <code>ht[1]</code> ä¸¤ä¸ªå“ˆå¸Œè¡¨ã€‚</li><li>åœ¨å­—å…¸ä¸­ç»´æŒä¸€ä¸ªç´¢å¼•è®¡æ•°å™¨å˜é‡ <code>rehashidx</code> ï¼Œå¹¶å°†å®ƒçš„å€¼è®¾ç½®ä¸º <code>0</code> ï¼Œè¡¨ç¤º rehash å·¥ä½œæ­£å¼å¼€å§‹ã€‚</li><li>åœ¨ rehash è¿›è¡ŒæœŸé—´ï¼Œæ¯æ¬¡å¯¹å­—å…¸æ‰§è¡Œæ·»åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾æˆ–è€…æ›´æ–°æ“ä½œæ—¶ï¼Œç¨‹åºé™¤äº†æ‰§è¡ŒæŒ‡å®šçš„æ“ä½œä»¥å¤–ï¼Œè¿˜ä¼šé¡ºå¸¦å°† <code>ht[0]</code> å“ˆå¸Œè¡¨åœ¨ <code>rehashidx</code> ç´¢å¼•ä¸Šçš„æ‰€æœ‰é”®å€¼å¯¹ rehash åˆ° <code>ht[1]</code> ï¼Œå½“ rehash å·¥ä½œå®Œæˆä¹‹åï¼Œç¨‹åºå°† <code>rehashidx</code> å±æ€§çš„å€¼å¢ <code>1</code></li><li>éšç€å­—å…¸æ“ä½œçš„ä¸æ–­æ‰§è¡Œï¼Œæœ€ç»ˆåœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œ<code>ht[0]</code> çš„æ‰€æœ‰é”®å€¼å¯¹éƒ½ä¼šè¢« rehash è‡³ <code>ht[1]</code> ï¼Œè¿™æ—¶ç¨‹åºå°† <code>rehashidx</code> å±æ€§çš„å€¼è®¾ä¸º <code>1</code> ï¼Œè¡¨ç¤º rehash æ“ä½œå·²å®Œæˆã€‚</li></ol></li><li>åœ¨æ¸è¿›å¼å“ˆå¸Œæ²¡æœ‰å®Œæˆçš„æ—¶å€™ï¼Œä¼šåŒæ—¶æ‰€ä½¿ç”¨ <code>ht[0]</code> è¿˜æœ‰ <code>ht[1]</code> ä¸¤ä¸ªå“ˆå¸Œè¡¨<ul><li>delete find updateç­‰æ“ä½œéƒ½ä¼šåœ¨ä¸¤ä¸ªå“ˆå¸Œè¡¨ä¸Šè¿›è¡Œ</li><li>å…ˆåœ¨ <code>ht[0]</code> ç„¶åå†åœ¨ <code>ht[1]</code></li><li>è€Œå¯¹äºæ·»åŠ æ“ä½œï¼Œä¼šä¸€å¾‹è¢«ä¿å­˜åˆ° <code>ht[1]</code></li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2021/07/03/pGzqNjfegolP7Lt.png" alt="æ¸è¿›å¼å“ˆå¸Œçš„å®ç°"></p><h1 id="3-å€¼çš„åº•å±‚å®ç°"><a href="#3-å€¼çš„åº•å±‚å®ç°" class="headerlink" title="3. å€¼çš„åº•å±‚å®ç°"></a>3. å€¼çš„åº•å±‚å®ç°</h1><h2 id="3-1-ç®€å•åŠ¨æ€å­—ç¬¦ä¸²"><a href="#3-1-ç®€å•åŠ¨æ€å­—ç¬¦ä¸²" class="headerlink" title="3.1 ç®€å•åŠ¨æ€å­—ç¬¦ä¸²"></a>3.1 ç®€å•åŠ¨æ€å­—ç¬¦ä¸²</h2><h3 id="3-1-1-ä»€ä¹ˆæ˜¯ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Ÿ"><a href="#3-1-1-ä»€ä¹ˆæ˜¯ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Ÿ" class="headerlink" title="3.1.1 ä»€ä¹ˆæ˜¯ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Ÿ"></a>3.1.1 ä»€ä¹ˆæ˜¯ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Ÿ</h3><ul><li>Simple Dynamic String â€” SDS</li><li>Rediséœ€è¦ä¸€ä¸ªå¯ä»¥è¢«ä¿®æ”¹çš„å­—ç¬¦ä¸²å€¼<ul><li>åˆ©ç”¨SDSæ¥åšé”®å€¼</li><li>ä¹Ÿä¼šè¢«ç”¨æ¥åšç¼“å†²åŒº<ul><li>AOFç¼“å†²åŒº</li><li>å®¢æˆ·ç«¯çŠ¶æ€ä¸‹çš„è¾“å…¥ç¼“å†²åŒº</li></ul></li></ul></li><li>å®šä¹‰</li></ul><pre><code class="jsx">struct sdshrd &#123;    // è®¡ç®—bufæ•°ç»„å·²ç»ä½¿ç”¨çš„å­—èŠ‚çš„æ•°é‡    int len;    // è®°å½•bufæ•°ç»„æœªä½¿ç”¨çš„å­—èŠ‚çš„æ•°é‡    int free;    // å­—èŠ‚æ•°ç»„ï¼Œç”¨æ¥ä¿å­˜å­—ç¬¦ä¸²    char buf[];&#125;</code></pre><p><img src="https://i.loli.net/2021/07/03/ALkWVo5jDeX1fyY.png" alt="ç®€å•åŠ¨æ€å­—ç¬¦ä¸²çš„å®ç°"></p><h3 id="3-1-2-ä¸ºä»€ä¹ˆéœ€è¦SDSï¼Ÿ"><a href="#3-1-2-ä¸ºä»€ä¹ˆéœ€è¦SDSï¼Ÿ" class="headerlink" title="3.1.2 ä¸ºä»€ä¹ˆéœ€è¦SDSï¼Ÿ"></a>3.1.2 ä¸ºä»€ä¹ˆéœ€è¦SDSï¼Ÿ</h3><ul><li>ç›¸æ¯”äºå¸¸è§„stringçš„ä¼˜åŠ¿åœ¨äºï¼š<ul><li>å¸¸æ•°å¤æ‚åº¦è·å–å­—ç¬¦ä¸²é•¿åº¦<ul><li>æœ‰lenå­—æ®µ</li><li>è®¾ç½®å’Œæ›´æ–°é•¿åº¦æ˜¯åœ¨APIæ‰§è¡Œè¿‡ç¨‹å½“ä¸­è‡ªåŠ¨å®Œæˆçš„</li></ul></li><li>æœç»äº†ç¼“å†²åŒºæº¢å‡º<ul><li>Cå­—ç¬¦ä¸²ä¸ä¼šè®°å½•è‡ªèº«é•¿åº¦ï¼Œå®¹æ˜“é€ æˆç¼“å†²åŒºæº¢å‡ºâ€”buffer overflow</li><li>å¯èƒ½é€ æˆä¸€äº›æ•°æ®æ„å¤–è¢«ä¿®æ”¹</li><li>è€ŒSDSçš„ç©ºé—´åˆ†é…ç­–ç•¥å¯ä»¥æœç»å‘ç”Ÿæº¢å‡ºçš„å¯èƒ½æ€§<ul><li>APIä¼šæ£€æµ‹freeæ ‡æ³¨çš„å¤§å°</li><li>å¦‚æœä¸å¤Ÿï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œæ‰©å±•</li></ul></li></ul></li><li>å‡å°‘äº†å†…å­˜é‡åˆ†é…æ¬¡æ•°<ul><li>åœ¨Cé‡Œé¢å¦‚æœä½ åšå¢åŠ æˆ–è€…åˆ é™¤çš„æ“ä½œï¼Œéƒ½ä¼šæ¶‰åŠå†…å­˜é‡åˆ†é…</li></ul></li></ul></li><li>ç©ºé—´ä¼˜åŒ–ç­–ç•¥<ul><li>ç©ºé—´é¢„åˆ†é…<ul><li>å½“éœ€è¦æ‰©å±•çš„æ—¶å€™ï¼Œç¨‹åºä¸ä»…ä¸ºSDSåˆ†é…ä¿®æ”¹æ‰€å¿…é¡»çš„ç©ºé—´ï¼Œè¿˜ä¼šä¸ºSDSåˆ†é…é¢å¤–çš„æœªä½¿ç”¨ç©ºé—´</li></ul></li><li>æƒ°æ€§ç©ºé—´é‡Šæ”¾<ul><li>ç¼©çŸ­çš„æ—¶å€™å¹¶ä¸ç«‹å³ä½¿ç”¨å†…å­˜é‡åˆ†é…æ¥å›æ”¶ç¼©çŸ­åå¤šå‡ºæ¥çš„å­—èŠ‚</li><li>ä½¿ç”¨freeå±æ€§å°†è¿™äº›å­—èŠ‚çš„æ•°é‡è®°å½•èµ·æ¥ï¼Œå¹¶ç­‰å¾…å°†æ¥ä½¿ç”¨</li></ul></li></ul></li><li>ä½¿ç”¨SDSçš„å¾ˆå¤§çš„ä¸€ä¸ªå¥½å¤„åœ¨äºç›¸å¯¹äºString  å‡å°‘äº†å†…å­˜å¼€é”€  é¿å…äº†å› ä¸ºå¤§å†…å­˜Rediså®ä¾‹ï¼Œç”ŸæˆRDBå¯¼è‡´å“åº”å˜æ…¢çš„é—®é¢˜ </li></ul><h3 id="3-1-3-SDSçš„å†…å­˜å¼€é”€"><a href="#3-1-3-SDSçš„å†…å­˜å¼€é”€" class="headerlink" title="3.1.3 SDSçš„å†…å­˜å¼€é”€"></a>3.1.3 SDSçš„å†…å­˜å¼€é”€</h3><ul><li><p>æ¡ˆä¾‹</p><ul><li>å¼€å‘ä¸€ä¸ªå›¾ç‰‡å­˜å‚¨ç³»ç»Ÿï¼Œè¦æ±‚è¿™ä¸ªç³»ç»Ÿèƒ½å¿«é€Ÿåœ°è®°å½•å›¾ç‰‡ ID å’Œå›¾ç‰‡åœ¨å­˜å‚¨ç³»ç»Ÿä¸­ä¿å­˜æ—¶çš„ IDï¼ˆå¯ä»¥ç›´æ¥å«ä½œå›¾ç‰‡å­˜å‚¨å¯¹è±¡ IDï¼‰ã€‚åŒæ—¶ï¼Œè¿˜è¦èƒ½å¤Ÿæ ¹æ®å›¾ç‰‡ ID å¿«é€ŸæŸ¥æ‰¾åˆ°å›¾ç‰‡å­˜å‚¨å¯¹è±¡ IDã€‚</li><li>ç”¨10ä½æ•°æ¥è¡¨ç¤ºå›¾ç‰‡IDå’Œå›¾ç‰‡å­˜å‚¨å¯¹è±¡ID   æ˜¯ä¸€ä¸ªé”® + å•å€¼çš„æ¨¡å¼</li></ul></li><li><p>æ–¹æ¡ˆä¸€</p><ul><li><p>ä½¿ç”¨String ä½œä¸ºentryæ¥ä¿å­˜æ•°æ® â€” å‘ç°Stringä¿å­˜æ•°æ®æ—¶æ¶ˆè€—çš„å†…å­˜ç©ºé—´è¾ƒå¤š</p></li><li><p>ä¸€ä¸ªé”®å€¼å¯¹éœ€è¦ä½¿ç”¨64å­—èŠ‚çš„åŸå› </p><ul><li><p>è®°å½•åŸºå‡†æ•°æ®  ä¸¤ä¸ª8å­—èŠ‚çš„longç±»å‹</p></li><li><p>é¢å¤–çš„å†…å­˜ç©ºé—´è®°å½•æ•°æ®é•¿åº¦ï¼Œç©ºé—´ä½¿ç”¨  â€” å…ƒæ•°æ®</p></li><li><p>ä¸€ä¸ªSDCåŒ…æ‹¬ä¸‰éƒ¨åˆ†çš„æ•°æ®</p><ul><li>buf â€” å­—èŠ‚æ•°ç»„ï¼Œä¿å­˜å®é™…æ•°æ®</li><li>len â€” 4å­—èŠ‚ï¼Œè¡¨ç¤ºbufå·²ç”¨é•¿åº¦</li><li>alloc â€” 4å­—èŠ‚ï¼Œè¡¨ç¤ºbufçš„å®é™…åˆ†é…é•¿åº¦ï¼Œä¸€èˆ¬å¤§äºlen</li></ul></li><li><p>RedisObject</p><ul><li>ç»Ÿä¸€è®°å½•å½“å‰æ•°æ®ç±»å‹çš„å…ƒæ•°æ® â€” è®¿é—®æ—¶é—´ï¼Œå¼•ç”¨æ¬¡æ•°ç­‰</li><li>RedisObject åŒ…æ‹¬<ul><li>8å­—èŠ‚å…ƒæ•°æ®</li><li>8å­—èŠ‚æŒ‡é’ˆ â€” æŒ‡å‘SDS ã€</li></ul></li></ul></li><li><p>æ ¹æ®SDSé•¿åº¦çš„ä¸åŒç¼–ç æ–¹å¼</p><p>  <img src="https://i.loli.net/2021/08/09/ZeP7RkmsQxhpb5w.png" alt="SDSç¼–ç æ–¹å¼"></p></li></ul></li><li><p>ä¸Šè¿°çš„RedisObject + SDS æœ¬èº«ä¼šå æ®32å­—èŠ‚çš„ç©ºé—´ï¼Œç„¶åRedisä¼šä½¿ç”¨ä¸€ä¸ªå…¨å±€å“ˆå¸Œè¡¨ä¿å­˜æ‰€æœ‰é”®å€¼å¯¹</p><ul><li>å“ˆå¸Œè¡¨çš„æ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªdickEntryç»“æ„ä½“ï¼Œç”¨æ¥æŒ‡å‘ä¸€ä¸ªé”®å€¼å¯¹</li><li>dictEntryæœ‰ä¸‰ä¸ª8å­—èŠ‚æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘key, value, dictEntry</li><li>24å­—èŠ‚ï¼Œç„¶åRedisä½¿ç”¨jemallocæ¥åˆ†é…å†…å­˜ï¼Œç”³è¯·24  ä¼šå‘ç»™32å­—èŠ‚ï¼Œ2çš„æŒ‡æ•°</li></ul></li></ul></li><li><p>æ–¹æ¡ˆäºŒ</p><ul><li>ä½¿ç”¨é›†åˆç±»å‹æ¥ä¿å­˜æ•°æ®ï¼Œä½¿ç”¨äºŒçº§ç¼–ç çš„æ–¹å¼ï¼Œå®ç°ç”¨é›†åˆç±»å‹ä¿å­˜å•å€¼é”®å€¼å¯¹ï¼Œä»¥æ­¤å‡å°‘Rediså®ä¾‹çš„å†…å­˜ç©ºé—´æ¶ˆè€—</li><li>å¯ä»¥ä½¿ç”¨å‹ç¼©åˆ—è¡¨æ¥èŠ‚çœå¯¹äºå†…å­˜çš„ä½¿ç”¨<ul><li>èŠ‚çœå†…å­˜çš„åŸå› <ul><li>ä½¿ç”¨ä¸€ç³»åˆ—è¿ç»­çš„entryä¿å­˜æ•°æ®ï¼Œå…ƒæ•°æ®åŒ…æ‹¬<ul><li>prev_len<ul><li>å¤§å°å¯ä¸º1å­—èŠ‚æˆ–è€…5å­—èŠ‚</li><li>æ ¹æ®ä¸Šä¸€ä¸ªentryçš„é•¿åº¦æ˜¯å¦å°äº254å­—èŠ‚æ¥è¿›è¡Œåˆ¤å®š</li></ul></li><li>len<ul><li>è¡¨ç¤ºè‡ªèº«é•¿åº¦  4å­—èŠ‚</li></ul></li><li>encoding<ul><li>ç¼–ç æ–¹å¼  1å­—èŠ‚</li></ul></li><li>content<ul><li>ä¿å­˜å®é™…æ•°æ®</li></ul></li></ul></li><li>å› ä¸ºè¿ç»­ä¿å­˜ï¼Œæ‰€ä»¥ä¸ç”¨é¢å¤–çš„æŒ‡é’ˆäº†</li><li>è¿™æ ·æ¯ä¸ªentryåªè¦ 1 + 4 + 1 + 8 = 14, åªéœ€è¦16å­—èŠ‚</li><li>å¦å¤–ï¼Œå¯ä»¥èŠ‚çœdictEntryçš„å¼€é”€ï¼Œå› ä¸ºåŸå…ˆçš„è¯ä½¿ç”¨Stringç±»å‹ï¼Œä¸€ä¸ªé”®å€¼å¯¹å°±æ˜¯ä¸€ä¸ªdictEntryï¼Œä½†é‡‡ç”¨é›†åˆç±»å‹çš„è¯ï¼Œä¸€ä¸ªkeyå°±å¯¹åº”ä¸€ä¸ªé›†åˆçš„æ•°æ®ï¼ŒèŠ‚çœäº†å¤§é‡dictEntryçš„å†…å­˜</li></ul></li></ul></li><li>å¦‚ä½•ç”¨é›†åˆç±»å‹ä¿å­˜å•å€¼çš„é”®å€¼å¯¹ï¼Ÿ<ul><li>é‡‡ç”¨åŸºäºHashç±»å‹çš„äºŒçº§ç¼–ç æ–¹æ³•<ul><li>å°†ä¸€ä¸ªå•å€¼çš„æ•°æ®æ‹†åˆ†æˆä¸¤éƒ¨åˆ†<ul><li>å‰ä¸€éƒ¨åˆ†ä½œä¸ºHashé›†åˆçš„key</li><li>åä¸€éƒ¨åˆ†ä½œä¸ºHashé›†åˆçš„valueçš„keyå€¼</li></ul></li><li>æ³¨æ„è¿™é‡Œå› ä¸ºæˆ‘ä»¬æƒ³è¦åˆ©ç”¨çš„æ˜¯å‹ç¼©åˆ—è¡¨æ¥èŠ‚çœç©ºé—´ï¼Œå› ä¸ºå¯¹äºHashç±»å‹ï¼Œåº•å±‚æ˜¯æœ‰ä¸¤ç§æ•°æ®ç»“æ„çš„ï¼š å‹ç¼©åˆ—è¡¨ä»¥åŠå“ˆå¸Œè¡¨<ul><li>å½“è¶…è¿‡ä¸€å®šé˜ˆå€¼çš„æ—¶å€™ï¼Œå°±ä¼šä»å‹ç¼©åˆ—è¡¨è†¨èƒ€åˆ°å“ˆå¸Œè¡¨</li><li>å› æ­¤åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„åä¸€éƒ¨åˆ†keyçš„é•¿åº¦é€‰æ‹©  æ¯”å¦‚é€‰æ‹©3ä½ï¼Œç„¶åè®¾ç½® <code>hash-max-ziplist-entries</code> è¿™ä¸ªå‚æ•°ï¼Œæ¥ä¿è¯æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨å‹ç¼©åˆ—è¡¨ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿä¸ä¼šå—åˆ°å¾ˆå¤§å½±å“</li></ul></li></ul></li></ul></li><li>ä½¿ç”¨ziplistæ–¹æ¡ˆçš„ä¸€äº›é—®é¢˜<ul><li>åœ¨æŸ¥è¯¢æŒ‡å®šå…ƒç´ çš„æ—¶å€™ï¼Œéƒ½è¦éå†æ•´ä¸ªziplistæ¥æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ ï¼›å› æ­¤ziplist max entryçš„æ•°é‡ä¸èƒ½æ”¾åˆ°è¿‡å¤§ï¼Œå¦åˆ™æŸ¥è¯¢æ€§èƒ½å°±ä¼šä¸‹é™çš„æ¯”è¾ƒå‰å®³äº†</li><li>å› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç´§å‡‘æ’åˆ—çš„ï¼Œè€Œä¸”æ¯ä¸ªå…ƒç´ å­˜å‚¨äº†ä¸Šä¸€ä¸ªå…ƒç´ çš„é•¿åº¦ï¼›å› æ­¤å¦‚æœä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå…ƒç´ è¶…è¿‡ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šå¼•å‘å¤šä¸ªå…ƒç´ çš„è”çº§è°ƒæ•´ï¼Œä¼šå¼•å‘æ€§èƒ½é—®é¢˜</li><li>è®¾ç½®è¿‡æœŸæ—¶é—´å˜å¾—éå¸¸å›°éš¾ï¼Œå› ä¸ºåªèƒ½æ•´ä¸ªkeyè¿‡æœŸï¼Œæˆ–è€…ä¸šåŠ¡å±‚å•ç‹¬ç»´æŠ¤æ¯ä¸ªå…ƒç´ è¿‡æœŸåˆ é™¤çš„é€»è¾‘</li><li>å› æ­¤é€‰ç”¨è¿™ä¸ªæ–¹æ¡ˆæ„å‘³ç€ä½ å¸Œæœ›å°†Redisä½œä¸ºæ•°æ®åº“ä½¿ç”¨ï¼Œéœ€è¦ä¿è¯å¯é æ€§ â€” ä¸»ä»å¤‡ä»½+å¤‡ä»½</li><li>ä½¿ç”¨Stringä½œä¸ºvalueçš„è¯å¯ä»¥å°†Redisä½œä¸ºç¼“å­˜æ¥ä½¿ç”¨ï¼Œæ¯ä¸ªkeyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿˜å¯ä»¥è®¾ç½®maxmemoryå’Œæ·˜æ±°ç­–ç•¥ï¼Œä»¥æ­¤æ§åˆ¶æ•´ä¸ªå®ä¾‹çš„å†…å­˜ä¸Šé™</li></ul></li></ul></li></ul><h2 id="3-2-åŒå‘é“¾è¡¨"><a href="#3-2-åŒå‘é“¾è¡¨" class="headerlink" title="3.2 åŒå‘é“¾è¡¨"></a>3.2 åŒå‘é“¾è¡¨</h2><h3 id="3-2-1-æ¦‚è¿°"><a href="#3-2-1-æ¦‚è¿°" class="headerlink" title="3.2.1 æ¦‚è¿°"></a>3.2.1 æ¦‚è¿°</h3><ul><li>é“¾è¡¨<ul><li>å¯ä»¥æä¾›é«˜æ•ˆçš„èŠ‚ç‚¹é‡æ’èƒ½åŠ›ï¼Œ</li><li>é¡ºåºæ€§çš„èŠ‚ç‚¹è®¿é—®æ–¹æ³•</li></ul></li><li>ä»€ä¹ˆæ—¶å€™ä¼šè¢«ä½¿ç”¨<ul><li>å½“ä¸€ä¸ªåˆ—è¡¨åŒ…å«äº†æ•°é‡æ¯”è¾ƒå¤šçš„å…ƒç´ </li><li>åˆ—è¡¨å½“ä¸­åŒ…å«çš„å…ƒç´ éƒ½æ˜¯æ¯”è¾ƒé•¿çš„å­—ç¬¦ä¸²</li></ul></li></ul><h3 id="3-2-2-é“¾è¡¨å’Œé“¾è¡¨èŠ‚ç‚¹çš„å®ç°"><a href="#3-2-2-é“¾è¡¨å’Œé“¾è¡¨èŠ‚ç‚¹çš„å®ç°" class="headerlink" title="3.2.2 é“¾è¡¨å’Œé“¾è¡¨èŠ‚ç‚¹çš„å®ç°"></a>3.2.2 é“¾è¡¨å’Œé“¾è¡¨èŠ‚ç‚¹çš„å®ç°</h3><pre><code class="jsx">typedef struct listNode &#123;    struct listNode *prev;    struct listNode *next;    void *value;&#125;listNode;</code></pre><pre><code class="jsx">typedef struct list &#123;    listNode *head;    listNode *tail;    // é“¾è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡    unsigned long len;    // èŠ‚ç‚¹å€¼å¤åˆ¶å‡½æ•°    void *(*dup)(void *ptr);    // èŠ‚ç‚¹å€¼é‡Šæ”¾å‡½æ•°    void (*free) (void *ptr);    // èŠ‚ç‚¹å€¼å¯¹æ¯”å‡½æ•°    void (*match)(void *ptr, void *key);&#125;</code></pre><ul><li><p>ä¸‹æ–¹æ˜¯ç”±ä¸€ä¸ªlistç»“æ„å’Œå¤šä¸ªlistNodeç»“æ„ç»„æˆçš„é“¾è¡¨</p><p>  <img src="https://i.loli.net/2021/07/03/uJoTHhdLkr4qlAc.png" alt="list + multi listNodes"></p></li></ul><h2 id="3-3-å“ˆå¸Œè¡¨-å­—å…¸"><a href="#3-3-å“ˆå¸Œè¡¨-å­—å…¸" class="headerlink" title="3.3 å“ˆå¸Œè¡¨(å­—å…¸)"></a>3.3 å“ˆå¸Œè¡¨(å­—å…¸)</h2><h3 id="3-3-1-ä»€ä¹ˆæ˜¯å­—å…¸"><a href="#3-3-1-ä»€ä¹ˆæ˜¯å­—å…¸" class="headerlink" title="3.3.1 ä»€ä¹ˆæ˜¯å­—å…¸"></a>3.3.1 ä»€ä¹ˆæ˜¯å­—å…¸</h3><ul><li>ç”¨äºä¿å­˜é”®å€¼å¯¹çš„æ•°æ®ç»“æ„</li><li>Redisè‡ªå·±æ„å»ºäº†å­—å…¸çš„å®ç°</li><li>å“ˆå¸Œè¡¨å½“ä¸­å¯ä»¥æœ‰å¤šä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹ï¼Œè€Œæ¯ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹å°±ä¿å­˜äº†å­—å…¸å½“ä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹</li></ul><h3 id="3-3-2-dictht-â€”-å“ˆå¸Œè¡¨æ•°ç»„çš„å®ç°"><a href="#3-3-2-dictht-â€”-å“ˆå¸Œè¡¨æ•°ç»„çš„å®ç°" class="headerlink" title="3.3.2 dictht â€” å“ˆå¸Œè¡¨æ•°ç»„çš„å®ç°"></a>3.3.2 dictht â€” å“ˆå¸Œè¡¨æ•°ç»„çš„å®ç°</h3><pre><code class="jsx">typedef struct dictht &#123;    // å“ˆå¸Œè¡¨æ•°ç»„    dictEntry **table;    // å“ˆå¸Œè¡¨å¤§å°    unsigned long size;    // å“ˆå¸Œè¡¨å¤§å°æ©ç ï¼Œç”¨äºè®¡ç®—ç´¢å¼•å€¼    unsigned long sizemask;    // å·²æœ‰èŠ‚ç‚¹æ•°é‡    unsigned long used;&#125; dictht;</code></pre><ul><li><p>tableæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘dictEntryç»“æ„çš„æŒ‡é’ˆ</p><ul><li>æ¯ä¸ªdictEntryç»“æ„ä¿å­˜ç€ä¸€ä¸ªé”®å€¼å¯¹</li></ul></li><li><p>sizeè®°å½•å“ˆå¸Œè¡¨å¤§å°</p></li><li><p>usedè®°å½•ç›®å‰å·²æœ‰èŠ‚ç‚¹çš„æ•°é‡</p></li><li><p>sizemaskæ€»æ˜¯ç­‰äºsize - 1</p><ul><li><p>è¿™ä¸ªå±æ€§å’Œå“ˆå¸Œå€¼ä¸€èµ·å†³å®šäº†ä¸€ä¸ªé”®åº”è¯¥è¢«æ”¾åˆ°tableæ•°ç»„çš„å“ªä¸ªç´¢å¼•ä¸Šé¢</p><p>  <img src="https://i.loli.net/2021/07/03/3QTOZK1YwX6VyfG.png" alt="dictht + dictEntry"></p></li></ul></li></ul><h3 id="3-3-3-å“ˆå¸Œè¡¨èŠ‚ç‚¹çš„å®ç°"><a href="#3-3-3-å“ˆå¸Œè¡¨èŠ‚ç‚¹çš„å®ç°" class="headerlink" title="3.3.3 å“ˆå¸Œè¡¨èŠ‚ç‚¹çš„å®ç°"></a>3.3.3 å“ˆå¸Œè¡¨èŠ‚ç‚¹çš„å®ç°</h3><ul><li>è€Œå“ˆå¸Œè¡¨èŠ‚ç‚¹æ˜¯è¿™ä¹ˆå®ç°çš„<ul><li>å€¼å¾—æ³¨æ„çš„æ˜¯æœ‰æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ˜¯ä¸ºäº†è§£å†³é”®çš„å†²çªé—®é¢˜</li></ul></li></ul><pre><code class="jsx">typedef struct dictEntry &#123;    void *key;    union &#123;        void *val;        unit64_tu64;        int64_ts64;    &#125; v;    // æŒ‡å‘ä¸‹ä¸€ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹    struct dictEntry *next;&#125; dictEntry;</code></pre><h3 id="3-3-4-å“ˆå¸Œè¡¨æ•´ä½“å®ç°"><a href="#3-3-4-å“ˆå¸Œè¡¨æ•´ä½“å®ç°" class="headerlink" title="3.3.4 å“ˆå¸Œè¡¨æ•´ä½“å®ç°"></a>3.3.4 å“ˆå¸Œè¡¨æ•´ä½“å®ç°</h3><pre><code class="jsx">typedef struct dict &#123;    dictType *type;    void *privatedata;    dictht ht[2];    // rehashç´¢å¼•  å½“rehashåœæ­¢äº†ä»¥åï¼Œå€¼ä¸º-1     in rehashidx;&#125;</code></pre><ul><li>typeå’Œprivatedataæ˜¯é’ˆå¯¹ä¸åŒç±»å‹çš„é”®å€¼å¯¹ï¼Œä¸ºåˆ›å»ºå¤šæ€å­—å…¸è€Œè®¾ç½®çš„</li><li>htæ˜¯ä¸€ä¸ªå¤§å°ä¸º2çš„æ•°ç»„ï¼Œéƒ½æ˜¯å“ˆå¸Œè¡¨<ul><li>ä¸€èˆ¬åªç”¨ht[0]çš„å“ˆå¸Œè¡¨</li><li>åªæœ‰åœ¨åšrehashçš„æ—¶å€™ç”¨ht[1]</li></ul></li><li>rehashidx è®°å½•å½“å‰çš„è¿›åº¦</li><li>hashfunction<ul><li>ä½¿ç”¨MurmurHash2ç®—æ³•<ul><li>ç‰¹ç‚¹<ul><li>å³ä½¿è¾“å…¥çš„é”®æ˜¯æœ‰è§„å¾‹çš„ï¼Œç®—æ³•ä»èƒ½ç»™å‡ºä¸€ä¸ªå¾ˆå¥½çš„éšæœºåˆ†å¸ƒæ€§</li><li>ç®—æ³•çš„è®¡ç®—é€Ÿåº¦ä¹Ÿéå¸¸å¿«</li></ul></li></ul></li></ul></li></ul><h2 id="3-4-è·³è¡¨"><a href="#3-4-è·³è¡¨" class="headerlink" title="3.4 è·³è¡¨"></a>3.4 è·³è¡¨</h2><h3 id="3-4-1-ä»€ä¹ˆæ˜¯è·³è¡¨"><a href="#3-4-1-ä»€ä¹ˆæ˜¯è·³è¡¨" class="headerlink" title="3.4.1 ä»€ä¹ˆæ˜¯è·³è¡¨"></a>3.4.1 ä»€ä¹ˆæ˜¯è·³è¡¨</h3><ul><li>ä¸ºäº†è§£å†³é“¾è¡¨çš„ä¸è¶³çš„<ul><li>æœ‰åºé“¾è¡¨åªèƒ½é€ä¸€æŸ¥æ‰¾å…ƒç´ ï¼Œå¯¼è‡´æ“ä½œèµ·æ¥éå¸¸ç¼“æ…¢</li></ul></li><li>è·³è¡¨<ul><li>åœ¨é“¾è¡¨çš„åŸºç¡€ä¸Šå¢åŠ äº†å¤šçº§ç´¢å¼•ï¼Œé€šè¿‡ç´¢å¼•ä½ç½®çš„è·³è½¬ï¼Œå®ç°æ•°æ®çš„å¿«é€Ÿå®šä½</li><li>æ˜¯æœ‰åºé›†åˆçš„åº•å±‚å®ç°ä¹‹ä¸€</li><li>æ”¯æŒå¹³å‡O(logN), æœ€åO(N)å¤æ‚åº¦çš„èŠ‚ç‚¹æŸ¥æ‰¾ï¼Œè¿˜å¯ä»¥é€šè¿‡é¡ºåºæ€§æ“ä½œæ¥æ‰¹é‡å¤„ç†èŠ‚ç‚¹</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/03/YgFw2MkjmpSvf7P.png" alt="è·³è¡¨çš„å®ç°"></p><h3 id="3-4-2-è·³è¡¨çš„å®ç°"><a href="#3-4-2-è·³è¡¨çš„å®ç°" class="headerlink" title="3.4.2 è·³è¡¨çš„å®ç°"></a>3.4.2 è·³è¡¨çš„å®ç°</h3><ul><li><p>ç”±ä¸¤å¤§éƒ¨åˆ†æ„æˆ</p><ul><li><p>zskiplist ç”¨æ¥ä¿å­˜è·³è·ƒè¡¨èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯</p><ul><li>ä¸‹å›¾æœ€å·¦ä¾§çš„æ–¹æ¡†</li><li>å±æ€§åŒ…æ‹¬<ul><li>header â€” æŒ‡å‘è·³è·ƒè¡¨çš„è¡¨å¤´èŠ‚ç‚¹</li><li>tail â€” æŒ‡å‘è·³è·ƒè¡¨çš„è¡¨å°¾èŠ‚ç‚¹</li><li>level â€” è®°å½•å½“å‰è·³è·ƒè¡¨å†…ï¼Œå±‚æ•°æœ€å¤§çš„é‚£ä¸ªèŠ‚ç‚¹çš„å±‚æ•°</li><li>length â€” è®°å½•è·³è·ƒè¡¨çš„é•¿åº¦</li></ul></li></ul></li><li><p>zskiplistNodeç”¨äºè¡¨ç¤ºè·³è·ƒè¡¨å•ä¸ªèŠ‚ç‚¹</p><ul><li><p>å±æ€§åŒ…æ‹¬</p><ul><li>level<ul><li>å‰è¿›æŒ‡é’ˆ<ul><li>ç”¨äºè®¿é—®å…¶ä»–ç»“ç‚¹</li></ul></li><li>è·¨åº¦<ul><li>è®°å½•äº†å‰è¿›æŒ‡é’ˆæ‰€æŒ‡å‘èŠ‚ç‚¹å’Œå½“å‰èŠ‚ç‚¹çš„è·ç¦»</li><li>ç´¯åŠ å¯ä»¥ç”¨æ¥è®°å½•æŸä¸ªèŠ‚ç‚¹åœ¨è·³è¡¨å½“ä¸­çš„æ’ä½</li></ul></li></ul></li><li>backward åé€€æŒ‡é’ˆ<ul><li>æŒ‡å‘ä½äºå½“å‰èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</li><li>åé€€æŒ‡é’ˆåœ¨ç¨‹åºä»è¡¨å°¾å‘è¡¨å¤´éå†çš„æ—¶å€™ä½¿ç”¨</li></ul></li><li>score</li><li>obj æˆå‘˜å¯¹è±¡<ul><li>æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œ</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/03/blB24Gdk5MzXIhH.png" alt="è·³è¡¨å®ç°"></p></li></ul></li></ul></li></ul><pre><code class="jsx">typedef struct zskiplistNode &#123;    struct zskiplistLevel &#123;        struct zskiplistNode *forward;         unsigned int span;    &#125; level[];    struct zskiplistNode *backward;    double score;    robj *obj;&#125; zskiplistNode;</code></pre><pre><code class="jsx">typedef struct zskiplist &#123;    struct zskiplistNode *header, *tail;    unsigned long length;     int level;&#125;</code></pre><h2 id="3-5-æ•´æ•°æ•°ç»„"><a href="#3-5-æ•´æ•°æ•°ç»„" class="headerlink" title="3.5 æ•´æ•°æ•°ç»„"></a>3.5 æ•´æ•°æ•°ç»„</h2><h3 id="3-5-1-ä»€ä¹ˆæ˜¯æ•´æ•°æ•°ç»„"><a href="#3-5-1-ä»€ä¹ˆæ˜¯æ•´æ•°æ•°ç»„" class="headerlink" title="3.5.1 ä»€ä¹ˆæ˜¯æ•´æ•°æ•°ç»„"></a>3.5.1 ä»€ä¹ˆæ˜¯æ•´æ•°æ•°ç»„</h3><ul><li>æ˜¯setçš„åº•å±‚å®ç°ä¹‹ä¸€ï¼Œå½“ä¸€ä¸ªé›†åˆåªåŒ…å«æ•´æ•°å€¼å…ƒç´ ï¼Œå¹¶ä¸”è¿™ä¸ªé›†åˆå…ƒç´ æ•°é‡ä¸å¤šï¼ŒRediså°±ä¼šç”¨æ•´æ•°é›†åˆä½œä¸ºé›†åˆé”®çš„åº•å±‚å®ç°</li></ul><h3 id="3-5-2-æ•´æ•°æ•°ç»„çš„å®ç°"><a href="#3-5-2-æ•´æ•°æ•°ç»„çš„å®ç°" class="headerlink" title="3.5.2 æ•´æ•°æ•°ç»„çš„å®ç°"></a>3.5.2 æ•´æ•°æ•°ç»„çš„å®ç°</h3><pre><code class="jsx">typedef struct intset &#123;    uinit32_t encoding;    uinit32_t length;  int8_t contents[];&#125;</code></pre><ul><li>encoding<ul><li>è®°å½•ç¼–ç æ–¹å¼<ul><li>INTSET_ENC_INT16</li><li>INTSET_ENC_INT32</li><li>INTSET_ENC_INT64</li></ul></li></ul></li><li>length<ul><li>è®°å½•é›†åˆåŒ…å«çš„å…ƒç´ æ•°é‡</li></ul></li><li>contents<ul><li>æ•°ç»„ï¼Œæ˜¯å…¶åº•å±‚å®ç°</li><li>æ•´æ•°æ•°ç»„çš„æ¯ä¸ªåŸè‰²éƒ½æ˜¯contentsæ•°ç»„çš„ä¸€ä¸ªitem</li><li>å„ä¸ªé¡¹åœ¨æ•°ç»„ä¸­æŒ‰ç…§å€¼çš„å¤§å°ä»å°åˆ°å¤§æœ‰åºæ’åˆ—ï¼Œæ•°ç»„ä¸­ä¸åŒ…å«ä»»ä½•é‡å¤é¡¹</li></ul></li></ul><h3 id="3-5-3-æ•´æ•°æ•°ç»„çš„å‡çº§å’Œé™çº§"><a href="#3-5-3-æ•´æ•°æ•°ç»„çš„å‡çº§å’Œé™çº§" class="headerlink" title="3.5.3 æ•´æ•°æ•°ç»„çš„å‡çº§å’Œé™çº§"></a>3.5.3 æ•´æ•°æ•°ç»„çš„å‡çº§å’Œé™çº§</h3><ul><li>ä»€ä¹ˆæ—¶å€™éœ€è¦å‡çº§ï¼Ÿ<ul><li>å½“æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ï¼Œä¸”æ–°å…ƒç´ çš„ç±»å‹æ¯”æ•´æ•°é›†åˆç°æœ‰çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹éƒ½è¦é•¿çš„æ—¶å€™</li></ul></li><li>å¦‚ä½•è¿›è¡Œå‡çº§<ul><li>æ ¹æ®æ–°å…ƒç´ çš„ç±»å‹ï¼Œæ‰©å±•æ•´æ•°é›†åˆåº•å±‚æ•°ç»„çš„ç©ºé—´å¤§å°ï¼Œå¹¶ä¸”ä¸ºæ–°å…ƒç´ åˆ†é…ç©ºé—´</li><li>å°†åº•å±‚æ•°ç»„ç°æœ‰æ‰€æœ‰å…ƒç´ éƒ½è½¬æ¢æˆå’Œæ–°å…ƒç´ ç›¸åŒçš„ç±»å‹ï¼Œå¹¶å°†ç±»å‹è½¬æ¢åçš„å…ƒç´ æ”¾ç½®åˆ°æ­£ç¡®çš„ä½ä¸Š</li><li>æ”¾ç½®è¿‡ç¨‹éœ€è¦ä¿è¯é¡ºåºä¸å˜</li><li>æ–°å…ƒç´ æ·»åŠ åˆ°åº•å±‚æ•°ç»„å½“ä¸­</li></ul></li><li>æ•´æ•°æ•°ç»„ä¸æ”¯æŒé™çº§ï¼</li></ul><h2 id="3-6-å‹ç¼©åˆ—è¡¨"><a href="#3-6-å‹ç¼©åˆ—è¡¨" class="headerlink" title="3.6 å‹ç¼©åˆ—è¡¨"></a>3.6 å‹ç¼©åˆ—è¡¨</h2><h3 id="3-6-1-ä»€ä¹ˆæ˜¯å‹ç¼©åˆ—è¡¨"><a href="#3-6-1-ä»€ä¹ˆæ˜¯å‹ç¼©åˆ—è¡¨" class="headerlink" title="3.6.1 ä»€ä¹ˆæ˜¯å‹ç¼©åˆ—è¡¨"></a>3.6.1 ä»€ä¹ˆæ˜¯å‹ç¼©åˆ—è¡¨</h3><ul><li>ç±»ä¼¼ä¸€ä¸ªæ•°ç»„<ul><li>æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯¹åº”ä¿å­˜ä¸€ä¸ªæ•°æ®</li><li>è¡¨å¤´æœ‰ä¸‰ä¸ªå­—æ®µ<ul><li>zlbytes â€” åˆ—è¡¨é•¿åº¦ï¼Œæ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨çš„å­—èŠ‚æ•°</li><li>zltail â€” åˆ—è¡¨å°¾çš„åç§»é‡</li><li>zllen â€” åˆ—è¡¨ä¸­entryä¸ªæ•°</li></ul></li><li>è¡¨å°¾ä¸€ä¸ªå­—æ®µ<ul><li>zlend â€” è¡¨ç¤ºåˆ—è¡¨çš„ç»“æŸ</li></ul></li></ul></li><li>å‹ç¼©åˆ—è¡¨æ˜¯Redisä¸ºäº†èŠ‚çº¦å†…å­˜è€Œå¼€å‘çš„ï¼Œç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å—ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„<ul><li>ä¸€ä¸ªå‹ç¼©åˆ—è¡¨å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹</li><li>æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°å€¼</li><li>æ¯”èµ·åŒç«¯é“¾è¡¨æ¥è¯´ï¼Œæ›´èŠ‚çº¦å†…å­˜ï¼Œè€Œä¸”å†…å­˜å½“ä¸­è¿ç»­çš„ä¿å­˜çš„æ–¹å¼ï¼Œèƒ½æ›´å¿«çš„è½½å…¥åˆ°ç¼“å­˜å½“ä¸­</li><li>éšç€åˆ—è¡¨å¯¹è±¡åŒ…å«çš„å…ƒç´ è¶Šæ¥è¶Šå¤šï¼Œä½¿ç”¨å‹ç¼©åˆ—è¡¨çš„ä¼˜åŠ¿ä¼šé€æ¸æ¶ˆå¤±ï¼Œå¯¹è±¡å°±ä¼šä»åº•å±‚çš„å‹ç¼©åˆ—è¡¨çš„å®ç°è½¬å‘åŒç«¯é“¾è¡¨ä¸Šé¢</li></ul></li></ul><h3 id="3-6-2-å‹ç¼©åˆ—è¡¨çš„å®ç°"><a href="#3-6-2-å‹ç¼©åˆ—è¡¨çš„å®ç°" class="headerlink" title="3.6.2 å‹ç¼©åˆ—è¡¨çš„å®ç°"></a>3.6.2 å‹ç¼©åˆ—è¡¨çš„å®ç°</h3><ul><li><p>å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹çš„æ„æˆ</p><ul><li><p>previous_entry_length</p><ul><li><p>å­—èŠ‚ä¸ºå•ä½</p></li><li><p>è®°å½•å‹ç¼©åˆ—è¡¨ä¸­å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦</p></li><li><p>å¯ä»¥å€Ÿæ­¤é€šè¿‡æŒ‡é’ˆè¿ç®—ï¼Œä»å½“å‰èŠ‚ç‚¹çš„èµ·å§‹åœ°å€æ¥è®¡ç®—å‡ºå‰ä¸€ä¸ªèŠ‚ç‚¹çš„èµ·å§‹åœ°å€</p></li><li><p>å‹ç¼©åˆ—è¡¨çš„ä»è¡¨å°¾å‘è¡¨å¤´éå†çš„æ“ä½œå°±æ˜¯ä½¿ç”¨è¿™ä¸€åŸç†å®ç°çš„</p><p>  <img src="https://i.loli.net/2021/07/03/743T9ocpMWeksxH.png" alt="å‹ç¼©åˆ—è¡¨ä»å°¾ç«¯å‘è¡¨å¤´çš„éå†"></p></li></ul></li><li><p>encoding</p><ul><li>è®°å½•äº†èŠ‚ç‚¹çš„contentå±æ€§æ‰€ä¿å­˜çš„æ•°æ®ç±»å‹å’Œé•¿åº¦</li></ul></li><li><p>content</p><ul><li>è´Ÿè´£ä¿å­˜èŠ‚ç‚¹çš„å€¼<ul><li>å¯ä»¥ä½¿ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°</li></ul></li></ul></li></ul></li></ul><h3 id="3-6-3-å‹ç¼©åˆ—è¡¨çš„è¿é”æ›´æ–°"><a href="#3-6-3-å‹ç¼©åˆ—è¡¨çš„è¿é”æ›´æ–°" class="headerlink" title="3.6.3 å‹ç¼©åˆ—è¡¨çš„è¿é”æ›´æ–°"></a>3.6.3 å‹ç¼©åˆ—è¡¨çš„è¿é”æ›´æ–°</h3><ul><li>å‡è®¾ä¸€ä¸ªåŸå…ˆèŠ‚ç‚¹é•¿åº¦å°äº254å­—èŠ‚çš„å¢é•¿å¤§äºäº†</li><li>é‚£ä¹ˆåŸå…ˆç”¨ä¸€ä¸ªå­—èŠ‚ä¿å­˜çš„previous_entry_lengthå·²ç„¶æ— æ³•ä¿å­˜æ–°çš„æ•°æ®äº†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹å‹ç¼©åˆ—è¡¨æ‰§è¡Œç©ºé—´é‡åˆ†é…æ“ä½œ</li><li>è¿é”æ›´æ–°ï¼Œæœ€åæƒ…å†µè¦å¯¹å‹ç¼©åˆ—è¡¨æ‰§è¡ŒNæ¬¡ç©ºé—´é‡åˆ†é…æ“ä½œï¼Œè€Œæ¯æ¬¡ç©ºé—´é‡åˆ†é…çš„æœ€åå¤æ‚åº¦ä¸ºO(N)  æ‰€ä»¥è¿é”æ›´æ–°çš„æœ€åå¤æ‚åº¦ä¸ºO(N^2)</li><li>è¿é”æ›´æ–°å‡ºç°æ¦‚ç‡æ¯”è¾ƒä½ï¼Œåªæœ‰åœ¨å‹ç¼©åˆ—è¡¨å½“ä¸­æ°å¥½æœ‰å¤šä¸ªè¿ç»­ï¼Œé•¿åº¦ä»‹äº250 å’Œ253å­—èŠ‚ä¹‹é—´çš„èŠ‚ç‚¹çš„æ—¶å€™</li></ul><h2 id="3-7-å¯¹è±¡"><a href="#3-7-å¯¹è±¡" class="headerlink" title="3.7 å¯¹è±¡"></a>3.7 å¯¹è±¡</h2><ul><li>ç”¨å¯¹è±¡æ¥ä»£è¡¨Rediså¯¹äºåº•å±‚æ•°æ®ç»“æ„çš„ä¸Šå±‚æŠ½è±¡<ul><li>å­—ç¬¦ä¸²</li><li>åŒå‘é“¾è¡¨</li><li>å“ˆå¸Œè¡¨</li><li>é›†åˆ</li><li>æœ‰åºé›†åˆ</li></ul></li><li>å¥½å¤„<ul><li>é’ˆå¯¹ä¸åŒä½¿ç”¨åœºæ™¯ï¼Œä¸ºå¯¹è±¡è®¾ç½®å¤šç§ä¸åŒçš„åº•å±‚æ•°æ®ç»“æ„å®ç°ï¼Œä»è€Œä¼˜åŒ–å¯¹è±¡åœ¨ä¸åŒåœºæ™¯ä¸‹çš„ä½¿ç”¨æ•ˆç‡</li><li>Rediså¯¹è±¡ç³»ç»Ÿå®ç°äº†åŸºäºå¼•ç”¨è®¡æ•°æŠ€æœ¯çš„å†…å­˜å›æ”¶æœºåˆ¶</li><li>å½“ç¨‹åºä¸å†ä½¿ç”¨æŸä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€å ç”¨çš„å†…å­˜å°±ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾</li></ul></li></ul><h3 id="3-7-1-å¯¹è±¡çš„å®ç°"><a href="#3-7-1-å¯¹è±¡çš„å®ç°" class="headerlink" title="3.7.1 å¯¹è±¡çš„å®ç°"></a>3.7.1 å¯¹è±¡çš„å®ç°</h3><ul><li>é”®å’Œå€¼éƒ½æ˜¯å¯¹è±¡ï¼Œéƒ½ç”±redisObjectç»“æ„æ¥å®ç°çš„<ul><li>type  ç”¨äºè®°å½•å¯¹è±¡çš„ç±»å‹<ul><li>REDIS_STRING</li><li>REDIS_LIST<br>REDIT_HASH</li><li>REDIS_SET</li><li>REDIS_ZSET</li></ul></li><li>encoding è®°å½•å¯¹è±¡æ‰€ä½¿ç”¨çš„ç¼–ç <ul><li>å³å¯¹è±¡è¯•ç”¨äº†ä»€ä¹ˆæ•°æ®ç»“æ„çš„åº•å±‚å®ç°</li></ul></li></ul></li></ul><pre><code class="jsx">typedef struct redisObject &#123;    unsigned type:4;    unsigned encoding:4;    void *ptr;&#125; robj;</code></pre><h3 id="3-7-2-å­—ç¬¦ä¸²å¯¹è±¡"><a href="#3-7-2-å­—ç¬¦ä¸²å¯¹è±¡" class="headerlink" title="3.7.2 å­—ç¬¦ä¸²å¯¹è±¡"></a>3.7.2 å­—ç¬¦ä¸²å¯¹è±¡</h3><ul><li><p>ç¼–ç å¯ä»¥æ˜¯</p><ul><li><p>int</p></li><li><p>raw</p><ul><li><p>å½“ä¿å­˜ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼Œä¸”é•¿åº¦å¤§äº32å­—èŠ‚</p><p>  <img src="https://i.loli.net/2021/07/03/gbGY6fzD3rF7okB.png" alt="å­—ç¬¦ä¸²å¯¹è±¡çš„rawç¼–ç æ–¹å¼"></p></li></ul></li><li><p>embstr</p><ul><li><p>å½“å­—ç¬¦ä¸²å€¼çš„é•¿åº¦å°äºç­‰äº32å­—èŠ‚çš„æ—¶å€™ï¼Œä¼šç”¨embstrç¼–ç æ–¹å¼</p></li><li><p>embsträ»‹ç»</p><ul><li><p>ä¸“é—¨ç”¨äºä¿å­˜çŸ­å­—ç¬¦ä¸²çš„ä¼˜åŒ–ç¼–ç æ–¹å¼</p></li><li><p>é€šè¿‡è°ƒç”¨ä¸€æ¬¡å†…å­˜åˆ†é…å‡½æ•°æ¥åˆ†é…ä¸€å—è¿ç»­ç©ºé—´ï¼Œä¾æ¬¡åŒ…å«redisObjectå’Œsdshdrä¸¤ä¸ªç»“æ„</p><p>  <img src="https://i.loli.net/2021/07/03/G6ozCbK1UkYRO4T.png" alt="å­—ç¬¦ä¸²å¯¹è±¡embstrç¼–ç æ–¹å¼"></p></li></ul></li></ul></li></ul></li><li><p>ç¼–ç ç±»å‹ä¼šåœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œè‡ªåŠ¨çš„è½¬æ¢</p></li></ul><h3 id="3-7-3-åˆ—è¡¨å¯¹è±¡"><a href="#3-7-3-åˆ—è¡¨å¯¹è±¡" class="headerlink" title="3.7.3 åˆ—è¡¨å¯¹è±¡"></a>3.7.3 åˆ—è¡¨å¯¹è±¡</h3><ul><li><p>åˆ—è¡¨å¯¹è±¡çš„ç¼–ç æ–¹å¼æ˜¯</p><ul><li><p>ziplist â€” ä½¿ç”¨å‹ç¼©åˆ—è¡¨æ¥å®ç°</p><p>  <img src="https://i.loli.net/2021/07/03/DHqScpNEFLiCxO7.png" alt="åˆ—è¡¨å¯¹è±¡çš„å‹ç¼©åˆ—è¡¨ç¼–ç æ–¹å¼"></p></li><li><p>linkedlist â€” ä½¿ç”¨åŒå‘é“¾è¡¨æ¥å®ç°</p><p>  <img src="https://i.loli.net/2021/07/03/zndxC5jTAhNY7Ek.png" alt="åˆ—è¡¨å¯¹è±¡çš„åŒå‘é“¾è¡¨ç¼–ç æ–¹å¼"></p></li></ul></li><li><p>æ³¨æ„ï¼šåœ¨ä¸Šé¢çš„ç¤ºæ„å›¾å½“ä¸­ï¼ŒStringObjectæ˜¯åšäº†ç®€åŒ–çš„ï¼Œç›¸å½“äºæˆ‘åœ¨é“¾è¡¨æˆ–è€…å‹ç¼©åˆ—è¡¨å¯¹è±¡é‡Œé¢åµŒå…¥äº†å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå­—ç¬¦ä¸²æœ¬èº«æ˜¯ç”¨çš„embstrç¼–ç æ–¹å¼å®ç°çš„ä¸€ä¸ªredisObject</p></li><li><p>ç¼–ç è½¬åŒ–è§„åˆ™</p><ul><li>ä½¿ç”¨ziplistçš„æ¡ä»¶<ul><li>åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å­—ç¬¦ä¸²å…ƒç´ çš„é•¿åº¦éƒ½å°äº64å­—èŠ‚</li><li>åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„å…ƒç´ æ•°é‡å°äº512ä¸ª</li></ul></li><li>æ¡ä»¶æ˜¯å¯ä»¥è¿›è¡Œæ”¹å˜çš„ï¼Œé€šè¿‡æ”¹å˜config paras:<ul><li><code>list-max-ziplist-value</code></li><li><code>list-max-ziplist-entries</code></li></ul></li></ul></li></ul><h3 id="3-7-4-å“ˆå¸Œå¯¹è±¡"><a href="#3-7-4-å“ˆå¸Œå¯¹è±¡" class="headerlink" title="3.7.4 å“ˆå¸Œå¯¹è±¡"></a>3.7.4 å“ˆå¸Œå¯¹è±¡</h3><ul><li><p>ç¼–ç æ–¹å¼</p><ul><li><p>ziplist</p><ul><li><p>æ¯å½“åŠ æ–°çš„é”®å€¼å¯¹çš„æ—¶å€™ï¼Œä¼šå°†ä¿å­˜äº†é”®çš„å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹æ¨å…¥åˆ°å‹ç¼©åˆ—è¡¨è¡¨å°¾ï¼Œç„¶åå†å°†ä¿å­˜äº†å€¼çš„å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹æ¨å…¥åˆ°å‹ç¼©åˆ—è¡¨è¡¨å°¾</p><ul><li><p>ä¿å­˜äº†åŒä¸€é”®å€¼å¯¹çš„ä¸¤ä¸ªèŠ‚ç‚¹æ€»æ˜¯ç´§æŒ¨åœ¨ä¸€èµ·</p></li><li><p>å€¼å¾—æ³¨æ„  ç”¨ziplist æ¥å®ç°å“ˆå¸Œï¼ŒæŸ¥æ‰¾æ˜¯æ— æ³•åšåˆ°O(1)çš„ï¼Œä½†åŒæ—¶å› ä¸ºå€¼å°‘ï¼Œæ‰€ä»¥å½±å“ä¸ä¼šå¾ˆå¤§  <a href="https://blog.csdn.net/zhoucheng05_13/article/details/79864568">https://blog.csdn.net/zhoucheng05_13/article/details/79864568</a></p></li><li><p>ä¿å­˜é”®çš„èŠ‚ç‚¹åœ¨å‰ï¼Œä¿å­˜å€¼çš„èŠ‚ç‚¹åœ¨å</p><p>  <img src="https://i.loli.net/2021/07/03/bOavAyDF7u2KjhU.png" alt="å“ˆå¸Œå¯¹è±¡çš„å‹ç¼©åˆ—è¡¨ç¼–ç æ–¹å¼"></p></li></ul></li></ul></li><li><p>hashtable</p><p>  <img src="https://i.loli.net/2021/07/03/5AzFotmNTxdLySB.png" alt="å“ˆå¸Œå¯¹è±¡çš„hashtableç¼–ç æ–¹å¼"></p></li></ul></li><li><p>ç¼–ç è½¬æ¢æ¡ä»¶</p><ul><li>ä½¿ç”¨ziplistçš„æ¡ä»¶<ul><li>æ‰€æœ‰é”®å€¼å¯¹é”®å€¼å­—ç¬¦ä¸²é•¿åº¦éƒ½å°äº64å­—èŠ‚</li><li>é”®å€¼å¯¹æ•°é‡å°äº512ä¸ª</li></ul></li><li>ä¿®æ”¹é˜ˆå€¼æ–¹å¼<ul><li><code>hash-max-ziplist-value</code></li><li><code>hash-max-ziplist-entries</code></li></ul></li></ul></li></ul><h3 id="3-7-5-é›†åˆå¯¹è±¡"><a href="#3-7-5-é›†åˆå¯¹è±¡" class="headerlink" title="3.7.5 é›†åˆå¯¹è±¡"></a>3.7.5 é›†åˆå¯¹è±¡</h3><ul><li><p>ç¼–ç æ–¹å¼æœ‰</p><ul><li>intset<ul><li>ä½¿ç”¨æ•´æ•°é›†åˆä½œä¸ºåº•å±‚å®ç°</li></ul></li><li>hashtable<ul><li>ä½¿ç”¨è‡ªå®šä½œä¸ºåº•å±‚å®ç°</li></ul></li></ul></li><li><p>ç¼–ç è½¬æ¢</p><ul><li>ä½¿ç”¨intsetçš„æ¡ä»¶<ul><li>é›†åˆå¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æ•´æ•°å€¼</li><li>é›†åˆå¯¹è±¡ä¿å­˜çš„å…ƒç´ æ•°é‡ä¸è¶…è¿‡512ä¸ª</li></ul></li></ul></li></ul><h3 id="3-7-6-æœ‰åºé›†åˆå¯¹è±¡"><a href="#3-7-6-æœ‰åºé›†åˆå¯¹è±¡" class="headerlink" title="3.7.6 æœ‰åºé›†åˆå¯¹è±¡"></a>3.7.6 æœ‰åºé›†åˆå¯¹è±¡</h3><ul><li><p>ç¼–ç æ–¹å¼</p><ul><li><p>ziplist</p><ul><li><p>æ¯ä¸ªé›†åˆå…ƒç´ ç”¨ä¸¤ä¸ªç´§æŒ¨åœ¨ä¸€èµ·çš„å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹æ¥è¿›è¡Œä¿å­˜</p></li><li><p>ç¬¬ä¸€ä¸ªç»“ç‚¹ä¿å­˜member</p></li><li><p>ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¿å­˜score</p><p>  <img src="https://i.loli.net/2021/07/03/1KvRnXyzwk54eLV.png" alt="æœ‰åºé›†åˆå¯¹è±¡çš„å‹ç¼©åˆ—è¡¨ç¼–ç æ–¹å¼"></p></li></ul></li><li><p>skiplist</p><ul><li><p>åŒ…æ‹¬ä¸€ä¸ªå­—å…¸è¿˜æœ‰ä¸€ä¸ªè·³è·ƒè¡¨</p><ul><li>zs1 æŒ‰ç…§åˆ†å€¼ä»å°åˆ°å¤§ä¿å­˜äº†æ‰€æœ‰é›†åˆå…ƒç´ <ul><li>è·³è·ƒè¡¨èŠ‚ç‚¹çš„objectå±æ€§ä¿å­˜äº†å…ƒç´ çš„æˆå‘˜</li><li>é€šè¿‡è·³è·ƒè¡¨ å°±å¯ä»¥å¯¹æœ‰åºé›†åˆè¿›è¡ŒèŒƒå›´æ€§æ“ä½œäº†</li></ul></li><li>è€Œå­—å…¸åˆ›å»ºäº†æˆå‘˜åˆ°åˆ†å€¼çš„æ˜ å°„<ul><li>å¯ä»¥å®ç°O(1)å¤æ‚åº¦æŸ¥æ‰¾ç»™å®šæˆå‘˜çš„åˆ†å€¼</li></ul></li></ul><pre><code class="jsx">typedef struct zset &#123;  zskiplist *zs1;  dict *dict;&#125; zset;</code></pre><p><img src="https://i.loli.net/2021/07/03/KeBGYXIasS4JL71.png" alt="æœ‰åºé›†åˆçš„è·³è¡¨ç¼–ç æ–¹å¼"></p></li></ul></li></ul></li><li><p>ç¼–ç è½¬æ¢</p><ul><li>ä½¿ç”¨ziplistçš„æ¡ä»¶<ul><li>å…ƒç´ æ•°é‡å°äº128ä¸ª</li><li>æœ‰åºé›†åˆä¿å­˜çš„å…ƒç´ æˆå‘˜é•¿åº¦å°äº64å­—èŠ‚</li></ul></li></ul></li></ul><h1 id="4-å†…å­˜å’Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#4-å†…å­˜å’Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="4. å†…å­˜å’Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ"></a>4. å†…å­˜å’Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="4-1-ç±»å‹æ£€æŸ¥"><a href="#4-1-ç±»å‹æ£€æŸ¥" class="headerlink" title="4.1 ç±»å‹æ£€æŸ¥"></a>4.1 ç±»å‹æ£€æŸ¥</h2><ul><li><p>æœ‰äº›æŒ‡ä»¤éœ€è¦åº•å±‚çš„ç‰¹å®šçš„æ•°æ®ç»“æ„çš„å®ç°ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œç±»å‹æ£€æŸ¥</p></li><li><p>é€šè¿‡redisObjectç»“æ„çš„typeå±æ€§æ¥å®ç°</p><p>  <img src="https://i.loli.net/2021/07/03/F45sjTVhqWSaQfH.png" alt="LLENç±»å‹æ£€æŸ¥é€»è¾‘"></p></li></ul><h2 id="4-2-å†…å­˜å›æ”¶"><a href="#4-2-å†…å­˜å›æ”¶" class="headerlink" title="4.2 å†…å­˜å›æ”¶"></a>4.2 å†…å­˜å›æ”¶</h2><ul><li>Cè¯­è¨€ä¸å…·å¤‡è‡ªåŠ¨å†…å­˜å›æ”¶åŠŸèƒ½ï¼Œæ‰€ä»¥Redisåœ¨è‡ªå·±çš„å¯¹è±¡ç³»ç»Ÿå½“ä¸­æ„å»ºäº†ä¸€ä¸ªå¼•ç”¨è®¡æ•° reference countingæŠ€æœ¯å®ç°çš„å†…å­˜å›æ”¶æœºåˆ¶</li><li>é€šè¿‡è¿™ä¸€æœºåˆ¶ï¼Œç¨‹åºå¯ä»¥é€šè¿‡è·Ÿè¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¿¡æ¯ï¼Œåœ¨é€‚å½“çš„æ—¶å€™è‡ªåŠ¨é‡Šæ”¾å¯¹è±¡è¿›è¡Œå†…å­˜å›æ”¶</li><li>å¼•ç”¨è®¡æ•°ä¿¡æ¯å˜åŒ–çš„æ–¹å¼<ul><li>åˆ›å»ºå¯¹è±¡ï¼Œè¢«åˆå§‹åŒ–ä¸º1</li><li>å½“å¯¹è±¡è¢«ä¸€ä¸ªæ–°ç¨‹åºä½¿ç”¨ï¼Œ+1</li><li>å½“å¯¹è±¡ä¸å†è¢«ä¸€ä¸ªç¨‹åºä½¿ç”¨ï¼Œ-1</li><li>å½“å¼•ç”¨è®¡æ•°å€¼å˜ä¸º0ï¼Œé‡Šæ”¾å†…å­˜</li></ul></li></ul><h2 id="4-3-å¯¹è±¡å…±äº«"><a href="#4-3-å¯¹è±¡å…±äº«" class="headerlink" title="4.3 å¯¹è±¡å…±äº«"></a>4.3 å¯¹è±¡å…±äº«</h2><ul><li><p>highlightï¼ åªå¯¹åŒ…å«æ•´æ•°å€¼çš„å­—ç¬¦ä¸²å¯¹è±¡æ¥è¿›è¡Œå…±äº«ï¼Œå› ä¸ºå…¶ä»–çš„ç±»å‹çš„å¯¹è±¡éªŒè¯æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜</p></li><li><p>é€šè¿‡å¼•ç”¨è®¡æ•°æ¥å®ç°</p></li><li><p>å¦‚æœé”®Aä½¿ç”¨å€¼100ï¼Œé”®Bä¹Ÿè¦ä½¿ç”¨åŒæ ·çš„å€¼</p></li><li><p>é‚£ä¹ˆé”®Bçš„å€¼æŒ‡é’ˆä¼šæŒ‡å‘ç°åœ¨æœ‰çš„é”®Açš„å€¼å¯¹è±¡</p></li><li><p>ç„¶åå…±äº«çš„å€¼å¯¹è±¡çš„å¼•ç”¨è®¡æ•°+1</p><p>  <img src="https://i.loli.net/2021/07/03/plCK4RXTqOrID8W.png" alt="SDSæ•´æ•°å€¼å¯¹è±¡å…±äº«"></p></li></ul><h2 id="4-4-å¯¹è±¡çš„ç©ºè½¬æ—¶é•¿"><a href="#4-4-å¯¹è±¡çš„ç©ºè½¬æ—¶é•¿" class="headerlink" title="4.4 å¯¹è±¡çš„ç©ºè½¬æ—¶é•¿"></a>4.4 å¯¹è±¡çš„ç©ºè½¬æ—¶é•¿</h2><ul><li>redisObjectæœ‰ä¸ªlruå±æ€§ï¼Œæ¥è®°å½•è¿™ä¸ªå¯¹è±¡ä¸Šæ¬¡è¢«è®¿é—®çš„timestamp</li><li>å¦‚æœæœåŠ¡å™¨å ç”¨çš„å†…å­˜æ•°è¶…è¿‡äº†è®¾å®šçš„maxmemoryé€‰é¡¹ï¼Œé‚£ä¹ˆç©ºè½¬æ—¶é—´æ¯”è¾ƒé•¿çš„é‚£éƒ¨åˆ†é”®å°±ä¼šä¼˜å…ˆè¢«æœåŠ¡å™¨é‡Šæ”¾ï¼Œä»è€Œå›æ”¶å†…å­˜</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>æå®¢æ—¶é—´ â€” Redisæ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜</li><li>ã€ŠRedisè®¾è®¡ä¸å®ç°ã€‹</li><li><a href="http://redisbook.com/preview/dict/incremental_rehashing.html">http://redisbook.com/preview/dict/incremental_rehashing.html</a> </li><li><a href="https://blog.csdn.net/zhoucheng05_13/article/details/79864568">https://blog.csdn.net/zhoucheng05_13/article/details/79864568</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RedisåŸºæœ¬æ¶æ„</title>
      <link href="/Redis%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84/"/>
      <url>/Redis%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="RedisåŸºæœ¬æ¶æ„"><a href="#RedisåŸºæœ¬æ¶æ„" class="headerlink" title="RedisåŸºæœ¬æ¶æ„"></a>RedisåŸºæœ¬æ¶æ„</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li><p>ä¸ºä»€ä¹ˆéœ€è¦Redis</p><ul><li>key valueå†…å­˜æ•°æ®åº“</li><li>æ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œ</li><li>æ€§èƒ½éå¸¸é«˜ï¼Œå¯ä»¥æ”¯æŒå¾ˆé«˜çš„TPS</li></ul></li><li><p>åœ¨ä½¿ç”¨Redisè¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜</p><ul><li>CPUä½¿ç”¨æ–¹é¢çš„é—®é¢˜<ul><li>æ•°æ®ç»“æ„çš„å¤æ‚åº¦</li><li>è·¨CPUæ ¸çš„è®¿é—®</li></ul></li><li>å†…å­˜ä½¿ç”¨æ–¹é¢<ul><li>ä¸»ä»åŒæ­¥å’ŒAOFçš„å†…å­˜ç«äº‰</li></ul></li><li>å­˜å‚¨æŒä¹…åŒ–æ–¹é¢<ul><li>SSDä¸Šåšå¿«ç…§çš„æ€§èƒ½æŠ–åŠ¨</li></ul></li><li>ç½‘ç»œé€šä¿¡æ–¹é¢<ul><li>å¤šå®ä¾‹æ—¶çš„å¼‚å¸¸ç½‘ç»œä¸¢åŒ…</li></ul></li></ul></li><li><p>å¦‚ä½•è¿›è¡Œå­¦ä¹  â€” éœ€è¦ç³»ç»ŸåŒ–</p><ul><li><p>ä»åº”ç”¨ç»´åº¦å’Œç³»ç»Ÿç»´åº¦è¿›è¡Œç ”ç©¶</p></li><li><p>åˆ†åˆ«çœ‹å…¶åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢çš„è¡¨ç°</p><ul><li><p>é«˜æ€§èƒ½</p><ul><li>çº¿ç¨‹æ¨¡å‹</li><li>æ•°æ®ç»“æ„</li><li>æŒä¹…åŒ–</li><li>ç½‘ç»œæ¡†æ¶</li></ul></li><li><p>é«˜å¯é </p><ul><li>ä¸»ä»å¤åˆ¶</li><li>å“¨å…µæœºåˆ¶</li></ul></li><li><p>é«˜å¯æ‰©å±•æ€§</p><ul><li><p>æ•°æ®åˆ†ç‰‡</p></li><li><p>è´Ÿè½½å‡è¡¡</p><p>  <img src="https://i.loli.net/2020/12/20/vKdkl934yUw7pOe.png" alt="Redisç³»ç»Ÿ"></p></li></ul></li></ul></li></ul></li></ul><h2 id="2-å¦‚ä½•æ„å»ºä¸€ä¸ªé”®å€¼æ•°æ®åº“"><a href="#2-å¦‚ä½•æ„å»ºä¸€ä¸ªé”®å€¼æ•°æ®åº“" class="headerlink" title="2. å¦‚ä½•æ„å»ºä¸€ä¸ªé”®å€¼æ•°æ®åº“"></a>2. å¦‚ä½•æ„å»ºä¸€ä¸ªé”®å€¼æ•°æ®åº“</h2><ul><li>ç›®æ ‡<ul><li>åˆ›å»ºä¸€ä¸ªå«åšSimpleKVçš„æ•°æ®åº“</li></ul></li><li>å‡ ä¸ªéœ€è¦æ€è€ƒçš„é—®é¢˜<ul><li>é—®é¢˜<ul><li>é‡Œé¢ä¼šå­˜ä»€ä¹ˆæ ·çš„æ•°æ® (æ•°æ®æ¨¡å‹)</li><li>éœ€è¦å¯¹æ•°æ®åšä»€ä¹ˆæ ·çš„æ“ä½œ (æ“ä½œæ¥å£)</li></ul></li><li>ä¸ºä»€ä¹ˆéœ€è¦æ€è€ƒè¿™ç§é—®é¢˜ï¼Ÿ<ul><li>è¿™å½±å“åˆ°ä½ è®¤ä¸ºè¿™ä¸ªæ•°æ®åº“åˆ°åº•èƒ½åšä»€ä¹ˆ</li><li>è­¬å¦‚å¦‚æœæ”¯æŒé›†åˆï¼Œé‚£ä¹ˆå¯¹äºå­˜å‚¨ç”¨æˆ·ä¿¡æ¯çš„ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ç”¨æˆ·Idä½œä¸ºKeyï¼Œå‰©ä½™ä¿¡æ¯ä½œä¸ºä¸€ä¸ªé›†åˆå­˜å‚¨åˆ°æˆ‘ä»¬çš„é”®å€¼æ•°æ®åº“å½“ä¸­<ul><li>è¿™ä¸ªç‚¹å¾ˆæœ‰æ„æ€ï¼Œå¯ä»¥ç›´æ¥å°†Rediså½“æˆä¸€ä¸ªæ•°æ®åº“æ¥ä½¿ç”¨</li></ul></li><li>æ¥å£çš„å®šä¹‰ç¡®å®šäº†æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“åšä»€ä¹ˆï¼Œæ˜¯ç®€å•çš„get, putæ“ä½œï¼Œè¿˜æ˜¯è¯´ç›¸å¯¹å¤æ‚çš„èšåˆå‹çš„æ“ä½œ</li></ul></li></ul></li><li>è„‰ç»œ<ul><li>è®¿é—®æ¡†æ¶</li><li>æ“ä½œæ¨¡å—<ul><li>å†…å­˜ç©ºé—´åˆ†é… â€” åˆ†é…å™¨</li><li>æŒä¹…åŒ–</li></ul></li><li>ç´¢å¼•æ¨¡å—</li></ul></li></ul><hr><h2 id="2-1-å¯ä»¥å­˜å“ªäº›æ•°æ®ï¼Ÿ"><a href="#2-1-å¯ä»¥å­˜å“ªäº›æ•°æ®ï¼Ÿ" class="headerlink" title="2.1 å¯ä»¥å­˜å“ªäº›æ•°æ®ï¼Ÿ"></a>2.1 å¯ä»¥å­˜å“ªäº›æ•°æ®ï¼Ÿ</h2><ul><li>åŸºæœ¬æ•°æ®ç±»å‹ Key - Value</li><li>å¸Œæœ›Valueèƒ½å¤Ÿæ”¯æŒå¤æ‚ç±»å‹<ul><li>memcacheåªæ”¯æŒString</li><li>Redisæ”¯æŒString, HashMap, åˆ—è¡¨ï¼Œé›†åˆç­‰<ul><li>å€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ä¸åŒçš„æ•°æ®ç»“æ„åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ä¼šæœ‰åœ¨æ€§èƒ½ï¼Œç©ºé—´æ•ˆç‡ç­‰æ–¹é¢çš„å·®å¼‚ï¼Œä»è€Œå¯¼è‡´ä¸åŒçš„valueæ“ä½œä¹‹é—´ä¹Ÿä¼šå­˜åœ¨å·®å¼‚</li></ul></li></ul></li></ul><h2 id="2-2-å¯ä»¥å¯¹æ•°æ®åšä»€ä¹ˆæ“ä½œï¼Ÿ"><a href="#2-2-å¯ä»¥å¯¹æ•°æ®åšä»€ä¹ˆæ“ä½œï¼Ÿ" class="headerlink" title="2.2 å¯ä»¥å¯¹æ•°æ®åšä»€ä¹ˆæ“ä½œï¼Ÿ"></a>2.2 å¯ä»¥å¯¹æ•°æ®åšä»€ä¹ˆæ“ä½œï¼Ÿ</h2><ul><li>PUT/ SET<ul><li>æ–°å†™å…¥æˆ–è€…æ›´æ–°ä¸€ä¸ªKVå¯¹</li></ul></li><li>GET<ul><li>æ ¹æ®KEYè¯»å–ç›¸åº”çš„VALUEå€¼</li></ul></li><li>DELETE<ul><li>æ ¹æ®KEYåˆ é™¤æ•´ä¸ªKVå¯¹</li></ul></li><li>SCAN<ul><li>æ ¹æ®ä¸€æ®µKeyçš„èŒƒå›´è¿”å›ç›¸åº”çš„valueå€¼</li></ul></li><li>Tips<ul><li>å½“ä¸€ä¸ªé”®å€¼æ•°æ®åº“çš„valueç±»å‹å¤šæ ·çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åŒ…å«ç›¸åº”çš„æ“ä½œæ¥å£çš„</li></ul></li></ul><h2 id="2-3-æ•°æ®åº“å­˜å‚¨ä½ç½®"><a href="#2-3-æ•°æ®åº“å­˜å‚¨ä½ç½®" class="headerlink" title="2.3 æ•°æ®åº“å­˜å‚¨ä½ç½®"></a>2.3 æ•°æ®åº“å­˜å‚¨ä½ç½®</h2><ul><li>å¯é€‰æ–¹æ¡ˆ<ul><li>å†…å­˜<ul><li>è¯»å†™éå¸¸å¿«</li><li>è®¿é—®é€Ÿåº¦åœ¨ç™¾nsçº§åˆ«</li><li>æ½œåœ¨é£é™©æ˜¯ä¸€æ—¦æ–­ç”µï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šä¸¢å¤±</li></ul></li><li>å¤–å­˜<ul><li>å¯ä»¥é¿å…æ•°æ®çš„ä¸¢å¤±ï¼Œä½†æ˜¯å—é™äºç£ç›˜çš„æ…¢é€Ÿè¯»å†™ï¼ˆå‡ ä¸ªmsï¼‰é”®å€¼æ•°æ®åº“çš„æ•´ä½“æ€§èƒ½ä¼šè¢«æ‹‰ä½</li></ul></li></ul></li><li>è€ƒé‡çš„å› ç´ <ul><li>ä¸»è¦åº”ç”¨åœºæ™¯<ul><li>ç¼“å­˜åœºæ™¯<ul><li>éœ€è¦èƒ½å¤Ÿå¿«é€Ÿè®¿é—®ä½†å…è®¸ä¸¢å¤± â€” å¯ä»¥é‡‡ç”¨å†…å­˜ä¿å­˜é”®å€¼æ•°æ®</li><li>memcache å’ŒRediséƒ½å±äºå†…å­˜é”®å€¼æ•°æ®åº“</li></ul></li></ul></li></ul></li></ul><h2 id="2-4-æ•°æ®åº“åŸºæœ¬ç»„ä»¶"><a href="#2-4-æ•°æ®åº“åŸºæœ¬ç»„ä»¶" class="headerlink" title="2.4 æ•°æ®åº“åŸºæœ¬ç»„ä»¶"></a>2.4 æ•°æ®åº“åŸºæœ¬ç»„ä»¶</h2><ul><li>ä¸€ä¸ªåŸºæœ¬çš„å†…éƒ¨ç»“æ„éœ€è¦åŒ…æ‹¬<ul><li>è®¿é—®æ¡†æ¶<ul><li>åŠ¨æ€åº“è®¿é—®</li><li>ç½‘ç»œè®¿é—®æ¡†æ¶</li></ul></li><li>æ“ä½œæ¨¡å—<ul><li>ä¸Šè¿°çš„ä¸€ç³»åˆ—æ“ä½œ DELETE/PUT/SCAN etc</li></ul></li><li>ç´¢å¼•æ¨¡å—</li><li>å­˜å‚¨æ¨¡å—</li></ul></li></ul><p><img src="https://i.loli.net/2020/12/20/ILR4uFc73ZVmevP.png" alt="SimpleKVåŸºæœ¬å†…éƒ¨æ¶æ„"></p><p>SimpleKV å†…éƒ¨æ¶æ„</p><ul><li>é‡‡ç”¨ä»€ä¹ˆè®¿é—®æ¨¡å¼ï¼Ÿâ€” è¿æ¥å±‚<ul><li>é€šè¿‡å‡½æ•°åº“è°ƒç”¨çš„æ–¹å¼ä¾›å¤–éƒ¨åº”ç”¨ä½¿ç”¨<ul><li>æ¯”å¦‚å›¾ç‰‡å½“ä¸­çš„<code>libsimplekv.so</code> å°±æ˜¯é€šè¿‡åŠ¨æ€é“¾æ¥åº“çš„å½¢å¼é“¾æ¥åˆ°æˆ‘ä»¬çš„ç¨‹åºå½“ä¸­ï¼Œæ¥æä¾›é”®å€¼å­˜å‚¨åŠŸèƒ½<ul><li>åœ¨è¿è¡Œçš„æ—¶å€™è½½å…¥çš„åŒ…ï¼Œè€Œä¸æ˜¯åƒé™æ€åº“ä¸€æ ·åœ¨ç¼–è¯‘çš„æ—¶å€™å°±å’Œç›®æ ‡ä»£ç è¿›è¡Œè¿æ¥</li><li>è¿™æ ·åšå¯ä»¥å‡å°‘å¯¹äºç©ºé—´çš„æµªè´¹ï¼Œè§£å†³äº†é™æ€åº“å¯¹ç¨‹åºçš„æ›´æ–°ï¼Œéƒ¨ç½²å’Œå‘å¸ƒå¸¦æ¥çš„éº»çƒ¦</li><li><a href="https://www.zhihu.com/question/20484931">https://www.zhihu.com/question/20484931</a></li></ul></li></ul></li><li>é€šè¿‡ç½‘ç»œæ¡†æ¶ä»¥Socketé€šä¿¡çš„å½¢å¼å¯¹å¤–æä¾›é”®å€¼å¯¹æ“ä½œ<ul><li>ç³»ç»Ÿè®¾è®¡ä¸Šçš„é—®é¢˜ â€” å•çº¿ç¨‹ï¼Œå¤šçº¿ç¨‹è¿˜æ˜¯å¤šä¸ªè¿›ç¨‹æ¥è¿›è¡Œäº¤äº’ï¼Ÿ<strong>IOæ¨¡å‹çš„é€‰æ‹©</strong><ul><li>ç½‘ç»œè¿æ¥çš„å¤„ç†</li><li>ç½‘ç»œè¯·æ±‚çš„è§£æ</li><li>æ•°æ®å­˜å–çš„å¤„ç†</li></ul></li></ul></li></ul></li><li>å¦‚ä½•å®šä½é”®å€¼å¯¹çš„ä½ç½®ï¼Ÿ<ul><li>éœ€è¦ä¾èµ–äºé”®å€¼æ•°æ®åº“çš„ç´¢å¼•æ¨¡å—<ul><li>è®©é”®å€¼æ•°æ®åº“èƒ½å¤Ÿæ ¹æ®keyæ‰¾åˆ°ç›¸åº”valueçš„å­˜å‚¨ä½ç½®ï¼Œè¿›è€Œæ‰§è¡Œæ“ä½œ<ul><li>ç´¢å¼•ç±»å‹<ul><li>å“ˆå¸Œè¡¨</li><li>B+æ ‘</li><li>å­—å…¸æ ‘</li></ul></li><li>Redisé€‰ç”¨çš„æ˜¯å“ˆå¸Œè¡¨ï¼Œæ˜¯å› ä¸ºä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜çš„é«˜æ€§èƒ½éšæœºè®¿é—®ç‰¹æ€§å¯ä»¥å¾ˆå¥½åœ°ä¸å“ˆå¸Œè¡¨O(1)çš„æ“ä½œå¤æ‚åº¦åŒ¹é…<ul><li>å…³äºRediså€¼å¾—æ³¨æ„çš„æ˜¯å®ƒçš„valueæ”¯æŒå¤šç§ç±»å‹ï¼Œå½“æˆ‘ä»¬é€šè¿‡ç´¢å¼•æ‰¾åˆ°ä¸€ä¸ªkeyå¯¹åº”çš„valueåï¼Œä»ç„¶éœ€è¦ä»valueçš„å¤æ‚ç»“æ„ä¸­è¿›ä¸€æ­¥æ‰¾åˆ°æˆ‘ä»¬å®é™…éœ€è¦çš„æ•°æ®</li><li>è¿™ä¸ªçš„å¤æ‚åº¦å–å†³äºå…·ä½“çš„æ•°æ®ç±»å‹</li><li>Redisé‡‡ç”¨ä¸€äº›é«˜æ•ˆç´¢å¼•ç»“æ„ä½œä¸ºæŸäº›valueç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä¸ºRediså®ç°é«˜æ€§èƒ½è®¿é—®æä¾›è‰¯å¥½çš„æ”¯æ’‘</li></ul></li></ul></li></ul></li></ul></li><li>ä¸åŒæ“ä½œçš„å…·ä½“é€»è¾‘æ˜¯ï¼Ÿ<ul><li>å¯¹äºGET/SCAN æ“ä½œè€Œè¨€ï¼Œæ ¹æ®valueçš„å­˜å‚¨ä½ç½®è¿”å›valueçš„å€¼å³å¯</li><li>å¯¹äºPUTæ“ä½œï¼Œéœ€è¦ä¸ºæ–°çš„é”®å€¼å¯¹åˆ†é…å†…å­˜ç©ºé—´<ul><li>â€”&gt; å¦‚ä½•åˆ†é…å†…å­˜ç©ºé—´å‘¢ï¼Ÿ</li><li>æ¯”è¾ƒé‡è¦ï¼Œå½“æˆ‘ä»¬çš„valueèƒ½æ”¯æŒå¤šç§ç±»å‹çš„æ—¶å€™ï¼Œé‚£ä¹ˆå¦‚ä½•é«˜æ•ˆä½¿ç”¨å†…å­˜ç©ºé—´å°±å˜å¾—å°¤ä¸ºé‡è¦äº†</li></ul></li><li>å¯¹äºDELETEæ“ä½œï¼Œéœ€è¦åˆ é™¤é”®å€¼å¯¹ï¼Œå¹¶é‡Šæ”¾ç›¸åº”çš„å†…å­˜ç©ºé—´ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”±åˆ†é…å™¨å®Œæˆ</li></ul></li><li>å†…å­˜åˆ†é…å™¨<ul><li>é‡‡ç”¨å†…å­˜åˆ†é…å™¨glibcçš„mallocå’Œfree<ul><li>ä½†æ˜¯é”®å€¼å¯¹å› ä¸ºé€šå¸¸å¤§å°ä¸ä¸€ï¼Œglibcåˆ†é…å™¨åœ¨å¤„ç†éšæœºå¤§å°çš„å†…å­˜å—åˆ†é…æ—¶è¡¨ç°ä¼šä¸å¤ªå¥½ã€‚ä¸€æ—¦ä¿å­˜çš„é”®å€¼å¯¹æ•°æ®è§„æ¨¡è¿‡å¤§ï¼Œå°±å¯èƒ½é€ æˆè¾ƒä¸ºä¸¥é‡çš„å†…å­˜ç¢ç‰‡çš„é—®é¢˜</li></ul></li></ul></li><li>å¦‚ä½•å®ç°é‡å¯åå¿«é€Ÿæä¾›æœåŠ¡ï¼Ÿ<ul><li>æŒä¹…åŒ–åŠŸèƒ½<ul><li>é‡‡ç”¨æ–‡ä»¶å½¢å¼ï¼Œå°†é”®å€¼æ•°æ®é€šè¿‡è°ƒç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„æ“ä½œæ¥å£ä¿å­˜åœ¨ç£ç›˜ä¸Š<ul><li>éœ€è¦è€ƒè™‘ä»€ä¹ˆæ—¶å€™ï¼Œä»€ä¹ˆé—´éš”æ¥åšä»å†…å­˜åˆ°æ–‡ä»¶çš„é”®å€¼æ•°æ®çš„ä¿å­˜å·¥ä½œ</li></ul></li><li>ä¹Ÿå¯ä»¥æ¯ä¸€ä¸ªé”®å€¼å¯¹éƒ½è¿›è¡ŒæŒä¹…åŒ–<ul><li>åå¤„æ˜¯å› ä¸ºæ¯æ¬¡éƒ½è¦å†™åˆ°ç£ç›˜é‡Œé¢ï¼Œæ€§èƒ½ä¼šå—åˆ°å¾ˆå¤§å½±å“</li><li>å¥½å¤„æ˜¯èƒ½ç¡®ä¿æ‰€æœ‰æ•°æ®æ›´æ–°éƒ½ä¼šåœ¨ç£ç›˜é‡Œ</li></ul></li><li>å¯ä»¥å‘¨æœŸæ€§çš„å°†å†…å­˜ä¸­çš„é”®å€¼æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶å½“ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…é¢‘ç¹å†™ç›˜æ“ä½œçš„æ€§èƒ½å½±å“<ul><li>æ½œåœ¨çš„é£é™©å°±æ˜¯æ•°æ®ä»ç„¶æœ‰å¯èƒ½ä¸¢å¤±</li></ul></li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2020/12/20/52Hgk6apwXFtzSU.png" alt="SimpleKVä¸Redisçš„æ¯”è¾ƒ"></p><p>SimpleKV vs Redis</p><ul><li>SimpleKVå’ŒRedisçš„å¯¹æ¯”<ul><li>Redisé€šè¿‡ç½‘ç»œè®¿é—®ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªåŸºç¡€æ€§çš„ç½‘ç»œæœåŠ¡æ¥è¿›è¡Œè®¿é—®</li><li>valueç±»å‹ä¸°å¯Œï¼Œå°±å¸¦æ¥äº†æ›´å¤šçš„æ“ä½œæ¥å£<ul><li>é¢å‘åˆ—è¡¨çš„LPush/ LPop</li><li>é¢å‘é›†åˆçš„SADD</li></ul></li><li>RedisæŒä¹…åŒ–æ¨¡å—æ”¯æŒæ—¥å¿—(AOF)å’Œå¿«ç…§(RDB)ä¸¤ç§æ¨¡å¼</li><li>Redisæ”¯æŒé«˜å¯é é›†ç¾¤å’Œé«˜å¯æ‰©å±•é›†ç¾¤</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.usenix.org/conference/atc17/technical-sessions/presentation/xia">HiKV: A Hybrid Index Key-Value Store for DRAM-NVM Memory Systems</a></li><li>æå®¢æ—¶é—´ - Redisæ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜</li><li><a href="https://www.zhihu.com/question/20484931">https://www.zhihu.com/question/20484931</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVMåƒåœ¾å›æ”¶</title>
      <link href="/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"/>
      <url>/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="JVMåƒåœ¾å›æ”¶"><a href="#JVMåƒåœ¾å›æ”¶" class="headerlink" title="JVMåƒåœ¾å›æ”¶"></a>JVMåƒåœ¾å›æ”¶</h1><ul><li>å†…å­˜æ˜¯å¦‚ä½•åˆ†é…å’Œå›æ”¶çš„</li><li>å“ªäº›åƒåœ¾éœ€è¦å›æ”¶</li><li>ä»€ä¹ˆæ—¶å€™å›æ”¶</li><li>å¦‚ä½•å›æ”¶</li></ul><h1 id="1-å †çš„åŸºæœ¬ç»“æ„"><a href="#1-å †çš„åŸºæœ¬ç»“æ„" class="headerlink" title="1. å †çš„åŸºæœ¬ç»“æ„"></a>1. å †çš„åŸºæœ¬ç»“æ„</h1><p><img src="https://i.loli.net/2021/07/01/h3pULFu4rDBA9ei.png" alt="å †çš„åŸºæœ¬ç»“æ„"></p><ul><li>å¯¹è±¡é¦–å…ˆåœ¨EdenåŒºåŸŸåˆ†é…</li><li>åœ¨ç¬¬ä¸€æ¬¡æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ä¹‹å<ul><li>å¦‚æœå¯¹è±¡è¿˜å­˜æ´»ï¼Œå°±ä¼šè¿›å…¥s0æˆ–è€…s1</li><li>å¯¹è±¡çš„å¹´é¾„è¿˜ä¼šåŠ 1</li><li>å½“å…¶å¹´é¾„å¢åŠ åˆ°15å²çš„æ—¶å€™ï¼Œå°±ä¼šæ™‹å‡åˆ°è€å¹´ä»£</li></ul></li><li>å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•° <code>-XX:MaxTenuringThreshold</code> æ¥è¿›è¡Œè®¾ç½®</li><li>æ¯æ¬¡GCåï¼ŒEdenåŒºå’ŒFromåŒºä¼šè¢«æ¸…ç©ºï¼Œç„¶åtoå’Œfromä¼šæ›¿æ¢<ul><li>å³æ–°çš„Toå°±æ˜¯ä¸Šæ¬¡GCçš„From</li><li>å½“toåŒºè¢«å¡«æ»¡çš„æ—¶å€™ï¼Œä¼šå°†æ‰€æœ‰å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£å½“ä¸­</li></ul></li></ul><h1 id="2-å †çš„åˆ†é…ç­–ç•¥"><a href="#2-å †çš„åˆ†é…ç­–ç•¥" class="headerlink" title="2. å †çš„åˆ†é…ç­–ç•¥"></a>2. å †çš„åˆ†é…ç­–ç•¥</h1><h2 id="2-1-å¯¹è±¡ä¼˜å…ˆåœ¨edenåŒºåˆ†é…"><a href="#2-1-å¯¹è±¡ä¼˜å…ˆåœ¨edenåŒºåˆ†é…" class="headerlink" title="2.1 å¯¹è±¡ä¼˜å…ˆåœ¨edenåŒºåˆ†é…"></a>2.1 å¯¹è±¡ä¼˜å…ˆåœ¨edenåŒºåˆ†é…</h2><ul><li>ä¼˜å…ˆåœ¨edenåŒºè¿›è¡Œåˆ†é…</li><li>å¦‚æœedenåŒºå·²ç»å‡ ä¹è¢«åˆ†é…å®Œäº†ï¼Œè™šæ‹Ÿæœºå°±ä¼šå‘èµ·ä¸€æ¬¡minor GC</li><li>å–å†³äºæ˜¯å¦survivoråŒºæœ‰è¶³å¤Ÿçš„ç©ºé—´<ul><li>ä¼šå…ˆæ”¾åˆ°survivoråŒº</li><li>æˆ–è€…å°†æ–°ç”Ÿä»£çš„å¯¹è±¡æå‰è½¬ç§»åˆ°äº†è€å¹´ä»£å½“ä¸­</li><li>å¦‚æœè€å¹´ä»£ä¹Ÿç©ºé—´ä¸å¤Ÿï¼Œé‚£å°±ä¼šå¯¼è‡´full GCçš„å‡ºç°äº†</li></ul></li></ul><h2 id="2-2-å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"><a href="#2-2-å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£" class="headerlink" title="2.2 å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"></a>2.2 å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</h2><p>å¤§å¯¹è±¡æ˜¯éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œæ•°ç»„ç­‰ã€‚  ä¸ºäº†é¿å…ä¸ºå¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶ç”±äºåˆ†é…æ‹…ä¿æœºåˆ¶å¸¦æ¥çš„å¤åˆ¶è€Œé™ä½æ•ˆç‡ã€‚</p><ul><li>åˆ†é…æ‹…ä¿æœºåˆ¶<ul><li>ä¸€ä¸ªæƒè¡¡ï¼Œæ˜¯æŠŠç°åœ¨æ­£åœ¨å¤„ç†çš„å¤§å¯¹è±¡æ”¾åˆ°æ°¸ä¹…ä»£é‡Œé¢</li><li>è¿˜æ˜¯è¯´æŠŠç°åœ¨åœ¨edençš„ä¸€äº›å¯¹è±¡æ”¾åˆ°æ°¸ä¹…ä»£å½“ä¸­</li><li><a href="https://cloud.tencent.com/developer/article/1082730" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1082730</a></li></ul></li></ul><h2 id="2-3-é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"><a href="#2-3-é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£" class="headerlink" title="2.3 é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"></a>2.3 é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</h2><p>å¦‚æœå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡ Minor GC åä»ç„¶èƒ½å¤Ÿå­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢« Survivor å®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ° Survivor ç©ºé—´ä¸­ï¼Œå¹¶å°†å¯¹è±¡å¹´é¾„è®¾ä¸º 1.å¯¹è±¡åœ¨ Survivor ä¸­æ¯ç†¬è¿‡ä¸€æ¬¡ MinorGC,å¹´é¾„å°±å¢åŠ  1 å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º 15 å²ï¼‰ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•° -XX:MaxTenuringThreshold æ¥è®¾ç½®ã€‚</p><p>â€œHotspot éå†æ‰€æœ‰å¯¹è±¡æ—¶ï¼ŒæŒ‰ç…§å¹´é¾„ä»å°åˆ°å¤§å¯¹å…¶æ‰€å ç”¨çš„å¤§å°è¿›è¡Œç´¯ç§¯ï¼Œå½“ç´¯ç§¯çš„æŸä¸ªå¹´é¾„å¤§å°è¶…è¿‡äº† survivor åŒºçš„ 50% æ—¶ï¼ˆé»˜è®¤å€¼æ˜¯ 50%ï¼Œå¯ä»¥é€šè¿‡ <strong>-XX:TargetSurvivorRatio=percent</strong> æ¥è®¾ç½®ï¼Œå‚è§ issue1199 ï¼‰ï¼Œå–è¿™ä¸ªå¹´é¾„å’Œ MaxTenuringThreshold ä¸­æ›´å°çš„ä¸€ä¸ªå€¼ï¼Œä½œä¸ºæ–°çš„æ™‹å‡å¹´é¾„é˜ˆå€¼â€ã€‚</p><pre><code class="jsx">uint ageTable::compute_tenuring_threshold(size_t survivor_capacity) { //survivor_capacityæ˜¯survivorç©ºé—´çš„å¤§å° size_t desired_survivor_size = (size_t)((((double)survivor_capacity)*TargetSurvivorRatio)/100); size_t total = 0; uint age = 1; while (age &lt; table_size) {     //sizesæ•°ç»„æ˜¯æ¯ä¸ªå¹´é¾„æ®µå¯¹è±¡å¤§å°     total += sizes[age];     if (total &gt; desired_survivor_size) {         break;     }     age++; } uint result = age &lt; MaxTenuringThreshold ? age : MaxTenuringThreshold; ...}</code></pre><h1 id="3-å¦‚ä½•åˆ¤æ–­å¯¹è±¡çš„æ­»äº¡"><a href="#3-å¦‚ä½•åˆ¤æ–­å¯¹è±¡çš„æ­»äº¡" class="headerlink" title="3. å¦‚ä½•åˆ¤æ–­å¯¹è±¡çš„æ­»äº¡"></a>3. å¦‚ä½•åˆ¤æ–­å¯¹è±¡çš„æ­»äº¡</h1><h2 id="3-1-åˆ¤æ–­å¯¹è±¡æ— æ•ˆçš„æ–¹æ³•"><a href="#3-1-åˆ¤æ–­å¯¹è±¡æ— æ•ˆçš„æ–¹æ³•" class="headerlink" title="3.1 åˆ¤æ–­å¯¹è±¡æ— æ•ˆçš„æ–¹æ³•"></a>3.1 åˆ¤æ–­å¯¹è±¡æ— æ•ˆçš„æ–¹æ³•</h2><h3 id="3-1-1-å¼•ç”¨è®¡æ•°æ³•"><a href="#3-1-1-å¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="3.1.1 å¼•ç”¨è®¡æ•°æ³•"></a>3.1.1 å¼•ç”¨è®¡æ•°æ³•</h3><ul><li>ç»™å¯¹è±¡æ·»åŠ å¼•ç”¨è®¡æ•°å™¨<ul><li>å¤šä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒï¼Œè®¡æ•°å™¨å°±åŠ 1</li><li>å½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å°±å‡1</li><li>ä»»ä½•æ—¶å€™è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„</li></ul></li><li>ä¸»æµçš„è™šæ‹Ÿæœºå¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Œå› ä¸ºå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨çš„é—®é¢˜</li></ul><h3 id="3-1-2-å¯è¾¾æ€§åˆ†æç®—æ³•"><a href="#3-1-2-å¯è¾¾æ€§åˆ†æç®—æ³•" class="headerlink" title="3.1.2 å¯è¾¾æ€§åˆ†æç®—æ³•"></a>3.1.2 å¯è¾¾æ€§åˆ†æç®—æ³•</h3><ul><li>ä»GC Rootså¯¹è±¡ä½œä¸ºèµ·ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼ŒèŠ‚ç‚¹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾</li><li>å½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿çš„è¯ï¼Œå°±è¯æ˜æ­¤å¯¹è±¡ä¸å¯ç”¨</li><li>å¯ä»¥ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…æ‹¬<ul><li>è™šæ‹Ÿæœºæ ˆå½“ä¸­å¼•ç”¨çš„å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ ˆä¸­å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li><li>æ‰€æœ‰è¢«åŒæ­¥é”æŒæœ‰çš„å¯¹è±¡</li></ul></li></ul><h2 id="3-2-å¼•ç”¨çš„ç±»åˆ«"><a href="#3-2-å¼•ç”¨çš„ç±»åˆ«" class="headerlink" title="3.2 å¼•ç”¨çš„ç±»åˆ«"></a>3.2 å¼•ç”¨çš„ç±»åˆ«</h2><h3 id="3-2-1-å¼ºå¼•ç”¨-StrongReference"><a href="#3-2-1-å¼ºå¼•ç”¨-StrongReference" class="headerlink" title="3.2.1 å¼ºå¼•ç”¨  StrongReference"></a>3.2.1 å¼ºå¼•ç”¨  StrongReference</h3><p>æˆ‘ä»¬å½“å‰å¸¸ä½¿ç”¨çš„åŸºæœ¬éƒ½å±äºå¼ºå¼•ç”¨ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœŸç»å¯¹ä¸ä¼šå›æ”¶å®ƒ</p><h3 id="3-2-2-è½¯å¼•ç”¨-SoftReference"><a href="#3-2-2-è½¯å¼•ç”¨-SoftReference" class="headerlink" title="3.2.2 è½¯å¼•ç”¨ SoftReference"></a>3.2.2 è½¯å¼•ç”¨ SoftReference</h3><p>å¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿï¼ŒGCä¸ä¼šå›æ”¶</p><p>å¦‚æœå†…å­˜ç©ºé—´ä¸è¶³ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜</p><p>è½¯å¼•ç”¨å¯ä»¥ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜, è½¯å¼•ç”¨å¯ä»¥åŠ é€Ÿ JVM å¯¹åƒåœ¾å†…å­˜çš„å›æ”¶é€Ÿåº¦ï¼Œå¯ä»¥ç»´æŠ¤ç³»ç»Ÿçš„è¿è¡Œå®‰å…¨ï¼Œé˜²æ­¢å†…å­˜æº¢å‡ºï¼ˆOutOfMemoryï¼‰ç­‰é—®é¢˜çš„äº§ç”Ÿã€‚ </p><h3 id="3-2-3-å¼±å¼•ç”¨-WeakReference"><a href="#3-2-3-å¼±å¼•ç”¨-WeakReference" class="headerlink" title="3.2.3 å¼±å¼•ç”¨ WeakReference"></a>3.2.3 å¼±å¼•ç”¨ WeakReference</h3><p>å¼±å¼•ç”¨ä¸è½¯å¼•ç”¨çš„åŒºåˆ«åœ¨äºï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œ å› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚</p><h3 id="3-2-4-è™šå¼•ç”¨-PhantomReference"><a href="#3-2-4-è™šå¼•ç”¨-PhantomReference" class="headerlink" title="3.2.4 è™šå¼•ç”¨ PhantomReference"></a>3.2.4 è™šå¼•ç”¨ PhantomReference</h3><p>â€œè™šå¼•ç”¨â€é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ï¼Œä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚</p><h2 id="3-3-ä¸å¯è¾¾çš„ç±»æ˜¯å¦å¿…é¡»è¦å›æ”¶"><a href="#3-3-ä¸å¯è¾¾çš„ç±»æ˜¯å¦å¿…é¡»è¦å›æ”¶" class="headerlink" title="3.3 ä¸å¯è¾¾çš„ç±»æ˜¯å¦å¿…é¡»è¦å›æ”¶"></a>3.3 ä¸å¯è¾¾çš„ç±»æ˜¯å¦å¿…é¡»è¦å›æ”¶</h2><p>è¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼›å¯è¾¾æ€§åˆ†ææ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡è¢«ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ<br>finalize æ–¹æ³•ã€‚å½“å¯¹è±¡æ²¡æœ‰è¦†ç›– finalize æ–¹æ³•ï¼Œæˆ– finalize<br>æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡æ—¶ï¼Œè™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µè§†ä¸ºæ²¡æœ‰å¿…è¦æ‰§è¡Œã€‚</p><p>è¢«åˆ¤å®šä¸ºéœ€è¦æ‰§è¡Œçš„å¯¹è±¡å°†ä¼šè¢«æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œç¬¬äºŒæ¬¡æ ‡è®°ï¼Œé™¤éè¿™ä¸ªå¯¹è±¡ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”ï¼Œå¦åˆ™å°±ä¼šè¢«çœŸçš„å›æ”¶ã€‚</p><h2 id="3-4-å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»"><a href="#3-4-å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»" class="headerlink" title="3.4 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»"></a>3.4 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»</h2><p>ç±»éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ 3 ä¸ªæ¡ä»¶æ‰èƒ½ç®—æ˜¯ <strong>â€œæ— ç”¨çš„ç±»â€</strong> ï¼š</p><ul><li>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚</li><li>åŠ è½½è¯¥ç±»çš„ <code>ClassLoader</code> å·²ç»è¢«å›æ”¶ã€‚</li><li>è¯¥ç±»å¯¹åº”çš„ <code>java.lang.Class</code> å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚</li></ul><h1 id="4-åƒåœ¾æ”¶é›†ç®—æ³•"><a href="#4-åƒåœ¾æ”¶é›†ç®—æ³•" class="headerlink" title="4. åƒåœ¾æ”¶é›†ç®—æ³•"></a>4. åƒåœ¾æ”¶é›†ç®—æ³•</h1><ul><li>æ ‡è®°æ¸…é™¤</li><li>æ ‡è®°å¤åˆ¶</li><li>æ ‡è®°æ•´ç†</li><li>åˆ†ä»£æ”¶é›†</li></ul><h1 id="5-åƒåœ¾æ”¶é›†å™¨"><a href="#5-åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="5. åƒåœ¾æ”¶é›†å™¨"></a>5. åƒåœ¾æ”¶é›†å™¨</h1><h2 id="5-1-HotSpot-VM-GC-åˆ†ç±»"><a href="#5-1-HotSpot-VM-GC-åˆ†ç±»" class="headerlink" title="5.1 HotSpot VM GC åˆ†ç±»"></a>5.1 HotSpot VM GC åˆ†ç±»</h2><ul><li>éƒ¨åˆ†æ”¶é›† (Partial GC)ï¼š<ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC / Young GCï¼‰ï¼šåªå¯¹æ–°ç”Ÿä»£è¿›è¡Œåƒåœ¾æ”¶é›†ï¼›</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC / Old GCï¼‰ï¼šåªå¯¹è€å¹´ä»£è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Major GC åœ¨æœ‰çš„è¯­å¢ƒä¸­ä¹Ÿç”¨äºæŒ‡ä»£æ•´å †æ”¶é›†ï¼›</li><li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šå¯¹æ•´ä¸ªæ–°ç”Ÿä»£å’Œéƒ¨åˆ†è€å¹´ä»£è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚</li></ul></li><li>æ•´å †æ”¶é›† (Full GC)ï¼šæ”¶é›†æ•´ä¸ª Java å †å’Œæ–¹æ³•åŒºã€‚</li></ul><h2 id="5-2-Serial-æ”¶é›†å™¨"><a href="#5-2-Serial-æ”¶é›†å™¨" class="headerlink" title="5.2 Serial æ”¶é›†å™¨"></a>5.2 Serial æ”¶é›†å™¨</h2><ul><li>ä¸²è¡Œæ”¶é›†å™¨<ul><li>è¿›è¡Œåƒåœ¾æ”¶é›†çš„æ—¶å€™å·¥ä½œçº¿ç¨‹éœ€è¦åœæ­¢</li></ul></li><li>æ–°ç”Ÿä»£<ul><li>æ ‡è®°å¤åˆ¶</li></ul></li><li>è€å¹´ä»£<ul><li>æ ‡è®°æ•´ç†</li></ul></li><li>ç®€å•é«˜æ•ˆï¼Œé€‚åˆåœ¨clientç«¯è¿è½¬</li></ul><p><img src="https://i.loli.net/2021/07/01/yoZaLX7NrKgldbM.png" alt="Serialæ”¶é›†å™¨"></p><h2 id="5-3-ParNewæ”¶é›†å™¨"><a href="#5-3-ParNewæ”¶é›†å™¨" class="headerlink" title="5.3 ParNewæ”¶é›†å™¨"></a>5.3 ParNewæ”¶é›†å™¨</h2><ul><li>Serailæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬</li><li>æ–°ç”Ÿä»£<ul><li>æ ‡è®°å¤åˆ¶</li></ul></li><li>è€å¹´ä»£<ul><li>æ ‡è®°æ•´ç†</li></ul></li><li>é€‚åˆåœ¨serveræ¨¡å¼ä¸‹</li></ul><p><img src="https://i.loli.net/2021/07/01/plw2YaeWKT9CERc.png" alt="ParNewæ”¶é›†å™¨"></p><h2 id="5-4-Parallel-Scavengeæ”¶é›†å™¨"><a href="#5-4-Parallel-Scavengeæ”¶é›†å™¨" class="headerlink" title="5.4 Parallel Scavengeæ”¶é›†å™¨"></a>5.4 Parallel Scavengeæ”¶é›†å™¨</h2><ul><li>æ³¨é‡å¯¹äºååé‡çš„ä¼˜åŒ– â€” æé«˜CPUçš„åˆ©ç”¨ç‡</li><li>ååé‡ â€”&gt; CPUä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´å’ŒCPUæ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼</li><li>å…¶æä¾›äº†å¾ˆå¤šçš„å‚æ•°æ¥å®ç°ä¼˜åŒ–</li><li>æ–°ç”Ÿä»£<ul><li>æ ‡è®°å¤åˆ¶</li></ul></li><li>è€å¹´ä»£<ul><li>æ ‡è®°æ•´ç†</li></ul></li></ul><h2 id="5-5-Serial-Oldæ”¶é›†å™¨"><a href="#5-5-Serial-Oldæ”¶é›†å™¨" class="headerlink" title="5.5 Serial Oldæ”¶é›†å™¨"></a>5.5 Serial Oldæ”¶é›†å™¨</h2><ul><li>Serailæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</li><li>ä¸¤ä¸ªç”¨é€”<ul><li>JDK1.5ä¹‹å‰ç‰ˆæœ¬å’ŒParallel Scavengeæ”¶é›†å™¨æ­é…ä½¿ç”¨</li><li>ä½œä¸ºCMSæ”¶é›†å™¨çš„åå¤‡æ–¹æ¡ˆ</li></ul></li></ul><h2 id="5-6-Parallel-Oldæ”¶é›†å™¨"><a href="#5-6-Parallel-Oldæ”¶é›†å™¨" class="headerlink" title="5.6 Parallel Oldæ”¶é›†å™¨"></a>5.6 Parallel Oldæ”¶é›†å™¨</h2><ul><li>Parallel Scavengeçš„è€å¹´ç‰ˆæœ¬</li><li>ä½¿ç”¨å¤šçº¿ç¨‹å’Œæ ‡è®°æ•´ç†æ³•</li></ul><h2 id="5-7-CMSæ”¶é›†å™¨"><a href="#5-7-CMSæ”¶é›†å™¨" class="headerlink" title="5.7 CMSæ”¶é›†å™¨"></a>5.7 CMSæ”¶é›†å™¨</h2><ul><li>Concurrent Mark Sweep<ul><li>ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨</li><li>éå¸¸ç¬¦åˆæ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨</li><li>å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹çš„åŒæ—¶å·¥ä½œ</li></ul></li><li>å·¥ä½œæ­¥éª¤<ul><li><strong>åˆå§‹æ ‡è®°ï¼š</strong> æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹ç›´æ¥ä¸ root ç›¸è¿çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« ï¼›</li><li><strong>å¹¶å‘æ ‡è®°ï¼š</strong> åŒæ—¶å¼€å¯ GC å’Œç”¨æˆ·çº¿ç¨‹ï¼Œç”¨ä¸€ä¸ªé—­åŒ…ç»“æ„å»è®°å½•å¯è¾¾å¯¹è±¡ã€‚ä½†åœ¨è¿™ä¸ªé˜¶æ®µç»“æŸï¼Œè¿™ä¸ªé—­åŒ…ç»“æ„å¹¶ä¸èƒ½ä¿è¯åŒ…å«å½“å‰æ‰€æœ‰çš„å¯è¾¾å¯¹è±¡ã€‚å› ä¸ºç”¨æˆ·çº¿ç¨‹å¯èƒ½ä¼šä¸æ–­çš„æ›´æ–°å¼•ç”¨åŸŸï¼Œæ‰€ä»¥ GC çº¿ç¨‹æ— æ³•ä¿è¯å¯è¾¾æ€§åˆ†æçš„å®æ—¶æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•é‡Œä¼šè·Ÿè¸ªè®°å½•è¿™äº›å‘ç”Ÿå¼•ç”¨æ›´æ–°çš„åœ°æ–¹ã€‚</li><li><strong>é‡æ–°æ ‡è®°ï¼š</strong> é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­</li><li><strong>å¹¶å‘æ¸…é™¤ï¼š</strong> å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶ GC çº¿ç¨‹å¼€å§‹å¯¹æœªæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚</li></ul></li></ul><p><img src="https://i.loli.net/2021/07/01/t5de1FrcE9bOAnf.png" alt="CMSæ”¶é›†å™¨"></p><ul><li>ä¼˜åŠ¿<ul><li>å¹¶å‘ï¼Œä½åœé¡¿</li></ul></li><li>ç¼ºé™·<ul><li>å¯¹CPUèµ„æºæ•æ„Ÿ</li><li>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾</li><li>æ ‡è®° æ¸…é™¤ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸä¼šäº§ç”Ÿå¤§é‡çš„ç©ºé—´ç¢ç‰‡</li></ul></li></ul><h2 id="5-8-G1-æ”¶é›†å™¨"><a href="#5-8-G1-æ”¶é›†å™¨" class="headerlink" title="5.8 G1 æ”¶é›†å™¨"></a>5.8 G1 æ”¶é›†å™¨</h2><ul><li>é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸»è¦é’ˆå¯¹å¤šæ ¸æœ‰å¤§å®¹é‡å†…å­˜çš„æœºå™¨ï¼Œä»¥æé«˜æ¦‚ç‡æ»¡è¶³ GC åœé¡¿æ—¶é—´è¦æ±‚çš„åŒæ—¶,è¿˜å…·å¤‡é«˜ååé‡æ€§èƒ½ç‰¹å¾.</li><li>ç‰¹å¾<ul><li><strong>å¹¶è¡Œä¸å¹¶å‘</strong>ï¼šG1 èƒ½å……åˆ†åˆ©ç”¨ CPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œä½¿ç”¨å¤šä¸ª CPUï¼ˆCPU æˆ–è€…<br>CPU æ ¸å¿ƒï¼‰æ¥ç¼©çŸ­ Stop-The-World åœé¡¿æ—¶é—´ã€‚éƒ¨åˆ†å…¶ä»–æ”¶é›†å™¨åŸæœ¬éœ€è¦åœé¡¿ Java çº¿ç¨‹æ‰§è¡Œçš„ GC åŠ¨ä½œï¼ŒG1<br>æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®© java ç¨‹åºç»§ç»­æ‰§è¡Œã€‚</li><li><strong>åˆ†ä»£æ”¶é›†</strong>ï¼šè™½ç„¶ G1 å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ª GC å †ï¼Œä½†æ˜¯è¿˜æ˜¯ä¿ç•™äº†åˆ†ä»£çš„æ¦‚å¿µã€‚</li><li><strong>ç©ºé—´æ•´åˆ</strong>ï¼šä¸ CMS çš„â€œæ ‡è®°-æ¸…ç†â€ç®—æ³•ä¸åŒï¼ŒG1 ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼›ä»å±€éƒ¨ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°-å¤åˆ¶â€ç®—æ³•å®ç°çš„ã€‚</li><li><strong>å¯é¢„æµ‹çš„åœé¡¿</strong>ï¼šè¿™æ˜¯ G1 ç›¸å¯¹äº CMS çš„å¦ä¸€ä¸ªå¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯ G1 å’Œ CMS å…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½† G1 é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ã€‚</li><li>ä¼˜å…ˆåˆ—è¡¨ï¼š åœ¨åå°ç»´æŠ¤ä¸€ä¸ªåå°åˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆé€‰æ‹©å›æ”¶ä»·å€¼æœ€å¤§çš„region</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://snailclimb.gitee.io/javaguide/#/docs/java/jvm/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6" target="_blank" rel="noopener">JavaGuide</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HotSpotè™šæ‹Ÿæœº å¯¹è±¡å£°æ˜æµç¨‹</title>
      <link href="/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%AF%B9%E8%B1%A1%E5%A3%B0%E6%98%8E%E6%B5%81%E7%A8%8B/"/>
      <url>/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%AF%B9%E8%B1%A1%E5%A3%B0%E6%98%8E%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†"><a href="#Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†" class="headerlink" title="Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†"></a>Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†</h1><h1 id="1-Java-ä»£ç è¿è¡Œæ–¹å¼"><a href="#1-Java-ä»£ç è¿è¡Œæ–¹å¼" class="headerlink" title="1. Java ä»£ç è¿è¡Œæ–¹å¼"></a>1. Java ä»£ç è¿è¡Œæ–¹å¼</h1><h2 id="1-1-ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº"><a href="#1-1-ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº"></a>1.1 ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº</h2><ul><li>è®¾è®¡ä¸€ä¸ªé¢å‘Javaè¯­è¨€ç‰¹æ€§çš„è™šæ‹Ÿæœº<ul><li>åšè¿™ä¸ªçš„åŸå› æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§æœºå™¨ä¸Šæ¥å®ç°å¯¹Javaçš„æ”¯æŒ</li><li>é€šè¿‡ç¼–è¯‘å™¨å°†Javaç¨‹åºè½¬æ¢æˆè¯¥è™šæ‹Ÿæœºæ‰€èƒ½è¯†åˆ«çš„æŒ‡ä»¤åºåˆ—ï¼Œåˆè¢«ç§°ä¸ºJavaå­—èŠ‚ç <ul><li>å«åšJavaå­—èŠ‚ç çš„åŸå› æ˜¯å­—èŠ‚ç æŒ‡ä»¤çš„æ“ä½œç opcodeè¢«å®šä¹‰æˆäº†ä¸€ä¸ªå­—èŠ‚</li></ul></li></ul></li><li>Javaçš„è™šæ‹Ÿæœºæ˜¯å¯ä»¥ç”±ç¡¬ä»¶å®ç°çš„ï¼Œä¹Ÿå¯ä»¥åœ¨å„ä¸ªå¹³å°ä¸Š(Windows/ Linux) æä¾›è½¯ä»¶çš„å®ç°<ul><li>å¥½å¤„1ï¼š ä¸€æ—¦ä¸€ä¸ªç¨‹åºè¢«è½¬æ¢æˆäº†Javaå­—èŠ‚ç ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥åœ¨ä¸åŒå¹³å°ä¸Šçš„è™šæ‹Ÿæœºé‡Œæ¥è¿è¡Œ</li><li>å¥½å¤„2ï¼š å¸¦æ¥äº†æ‰˜ç®¡ç¯å¢ƒï¼Œè¿™ä¸ªæ‰˜ç®¡ç¯å¢ƒèƒ½å¤Ÿä»£æ›¿æˆ‘ä»¬å¤„ç†ä¸€äº›ä»£ç å½“ä¸­å†—é•¿è€Œä¸”å®¹æ˜“å‡ºé”™çš„éƒ¨åˆ†<ul><li>è‡ªåŠ¨å†…å­˜ç®¡ç†</li><li>åƒåœ¾å›æ”¶</li><li>è¯¸å¦‚æ•°ç»„è¶Šç•Œï¼ŒåŠ¨æ€ç±»å‹ï¼Œå®‰å…¨æƒé™ç­‰ç­‰çš„åŠ¨æ€æ£€æµ‹åŠŸèƒ½</li></ul></li></ul></li></ul><h2 id="1-2-å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ"><a href="#1-2-å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ" class="headerlink" title="1.2 å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ"></a>1.2 å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ</h2><ul><li><p>ä»è™šæ‹Ÿæœºè§†è§’æ¥çœ‹</p><ul><li><p>é¦–å…ˆå°†å…¶ç¼–è¯‘æˆçš„classæ–‡ä»¶åŠ è½½åˆ°Javaè™šæ‹Ÿæœºå½“ä¸­</p></li><li><p>åŠ è½½åçš„Javaç±»ä¼šè¢«å­˜æ”¾äºæ–¹æ³•åŒºé‡Œ Method Area</p></li><li><p>å®é™…æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œæ–¹æ³•åŒºçš„ä»£ç </p></li><li><p>ç©ºé—´åˆ†é…</p><ul><li><p>çº¿ç¨‹å…±äº«çš„</p><ul><li><p>æ–¹æ³•åŒº</p><ul><li>ç”¨æ¥å­˜æ”¾ç±»ä¼¼äºå…ƒæ•°æ®ä¿¡æ¯æ–¹é¢çš„æ•°æ®<ul><li>ç±»ä¿¡æ¯</li><li>å¸¸é‡</li><li>é™æ€å˜é‡</li><li>ç¼–è¯‘åä»£ç </li></ul></li><li>JDK 1.8ä¹‹åï¼Œä¸å†æœ‰æ–¹æ³•åŒºäº†ï¼Œå…ƒæ•°æ®ä¼šæ”¾åˆ°æœ¬åœ°å†…å­˜çš„Metaspace å³å…ƒç©ºé—´é‡Œé¢<ul><li>ä½¿ç”¨Metaspaceçš„ä¼˜åŠ¿<ul><li>å…ƒç©ºé—´å¤§å°é»˜è®¤ä¸ºUnlimited å³åªå—åˆ°ç³»ç»Ÿå†…å­˜çš„é™åˆ¶</li><li>å› ä¸ºå…ƒæ•°æ®å¤§å°ä¸å†ç”±MaxPermSizeæ§åˆ¶ï¼Œè€Œç”±å®é™…çš„å¯ç”¨ç©ºé—´æ§åˆ¶ï¼Œè¿™æ ·èƒ½åŠ è½½çš„ç±»å°±æ›´å¤šäº†</li></ul></li></ul></li></ul></li><li><p>å †</p><ul><li><p>æ”¾ç½®å¯¹è±¡å®ä¾‹ï¼Œæ•°ç»„ç­‰</p></li><li><p>å’Œæ–¹æ³•åŒºåŒå±äºçº¿ç¨‹å…±äº«åŒºåŸŸï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</p></li><li><p>å †å†…å­˜çš„åˆ’åˆ†</p><ul><li>å¹´è½»ä»£<ul><li>Eden 8<ul><li>å½“æˆ‘ä»¬newä¸€ä¸ªå¯¹è±¡ä»¥åï¼Œä¼šæ”¾åˆ°Edenåˆ’åˆ†å‡ºæ¥çš„ä¸€å—ä½œä¸ºå­˜å‚¨ç©ºé—´çš„å†…å­˜å½“ä¸­</li><li>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šé¢„å…ˆç”³è¯·ä¸€å—è¿ç»­ç©ºé—´çš„å†…å­˜ç©ºé—´å¹¶ä¸”è§„å®šäº†å¯¹è±¡å­˜æ”¾çš„ä½ç½®ï¼Œå¦‚æœç©ºé—´ä¸è¶³å°±å†å¤šç”³è¯·å†…å­˜ç©ºé—´</li></ul></li><li>Survivor<ul><li>FromPlace 1</li><li>ToPlace 1</li></ul></li></ul></li><li>è€å¹´ä»£</li></ul></li><li><p>GCçš„è¿è¡Œé€»è¾‘</p><ul><li><p>Edenç©ºé—´æ»¡äº†ä»¥åï¼Œä¼šè§¦å‘Minor GC</p></li><li><p>å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ç§»åŠ¨åˆ°Survivor 0åŒº</p></li><li><p>Survivor 0åŒºæ»¡åè§¦å‘Minor GCï¼Œå°†å­˜æ´»å¯¹è±¡ç§»åŠ¨åˆ°Survivor 1åŒºï¼Œæ­¤æ—¶è¿˜ä¼šå°†fromå’ŒtoæŒ‡é’ˆäº¤æ¢ï¼Œä¿è¯äº†ä¸€æ®µæ—¶é—´å†…æ€»æœ‰ä¸€ä¸ªsurvivoråŒºä¸ºç©ºï¼Œä¸”toæ‰€æŒ‡å‘çš„survivoråŒºä¸ºç©º</p></li><li><p>ç»è¿‡å¤šæ¬¡Minor GCä»å­˜æ´»çš„å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ï¼Œä¸€èˆ¬æ˜¯15æ¬¡ï¼Œå› ä¸ºHotpotç»™è®°å½•å¹´é¾„åˆ†é…åˆ°çš„ç©ºé—´åªæœ‰4ä½</p></li><li><p>è€å¹´ä»£ç”¨æ¥å­˜å‚¨é•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼Œå æ»¡äº†å°±ä¼šè§¦å‘Full GCï¼ŒæœŸé—´ä¼šåœæ­¢æ‰€æœ‰çº¿ç¨‹ç­‰å¾…GCçš„å®Œæˆ â€”â†’ éœ€è¦å°½é‡é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿ</p></li><li><p>å½“è€å¹´åŒºæ‰§è¡Œäº†full GC è¿˜æ˜¯æ— æ³•å¯¹å¯¹è±¡ä¿å­˜ï¼Œå°±ä¼šäº§ç”ŸOOMï¼Œ è¿™æ„å‘³ç€è™šæ‹Ÿæœºä¸­çš„å †å†…å­˜ä¸è¶³</p><ul><li>å¯èƒ½åŸå› <ul><li>è®¾ç½®çš„å †å†…å­˜è¿‡å°</li><li>ä»£ç ä¸­åˆ›å»ºçš„å¯¹è±¡å¤§ä¸”å¤šï¼Œä¸€ç›´è¢«å¼•ç”¨å¯¼è‡´GCæ— æ³•æ”¶é›†ä»–ä»¬</li></ul></li></ul><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled.png"></p></li></ul></li></ul></li></ul></li><li><p>çº¿ç¨‹ç§æœ‰</p><ul><li>ç¨‹åºè®¡æ•°å™¨<ul><li>å®ŒæˆåŠ è½½å·¥ä½œ</li><li>æœ¬èº«æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç¨‹åºå½“ä¸­ä¸‹ä¸€å¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤<ul><li>åˆ†æ”¯ï¼Œå¾ªç¯ï¼Œè·³è½¬ï¼Œå¼‚å¸¸å¤„ç†ï¼Œçº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½ä¾èµ–äºè¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆ</li></ul></li><li>å ç”¨ç©ºé—´éå¸¸éå¸¸å°</li><li>è¿™ä¸ªå†…å­˜ä»…ä»…ä»£è¡¨äº†å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨</li><li>å­—èŠ‚ç è§£æå™¨é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤</li></ul></li><li>VM æ ˆ<ul><li>å½“è°ƒç”¨ä¸€ä¸ªJavaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šåœ¨å½“å‰çº¿ç¨‹ç”Ÿæˆä¸€ä¸ªæ ˆå¸§ï¼Œç”¨æ¥å­˜æ”¾å±€éƒ¨å˜é‡ä»¥åŠå­—èŠ‚ç çš„æ“ä½œæ•°</li><li>æ ˆå¸§å¤§å°æ˜¯å·²ç»è®¡ç®—å¥½äº†çš„ï¼Œæ ˆå¸§ä¸éœ€è¦è¿ç»­åˆ†å¸ƒ</li><li>æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹<ul><li>å¯¹å±€éƒ¨å˜é‡ï¼ŒåŠ¨æ€é“¾è¡¨ï¼Œæ–¹æ³•å‡ºå£ï¼Œæ ˆçš„æ“ä½œï¼Œå¯¹è±¡å¼•ç”¨è¿›è¡Œå­˜å‚¨ï¼Œå¹¶ä¸”çº¿ç¨‹ç‹¬äº«</li></ul></li><li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆçš„æ·±åº¦å¤§äºè™šæ‹Ÿæœºæ ˆçš„æœ€å¤§æ·±åº¦ï¼Œå°±ä¼šæŠ¥StackOverflowError</li><li>JVMæ˜¯å¯ä»¥åŠ¨æ€æ‰©å±•çš„ï¼Œä½†éšç€æ‰©å±•ä¼šä¸æ–­ç”³è¯·å†…å­˜ï¼Œå½“æ— æ³•ç”³è¯·è¶³å¤Ÿå†…å­˜çš„æ—¶å€™å°±ä¼šæŠ¥OutOfMemoryError</li><li>æ ˆå¹¶ä¸å­˜åœ¨åƒåœ¾å›æ”¶ï¼Œå› ä¸ºåªè¦ç¨‹åºè¿è¡Œç»“æŸï¼Œæ ˆçš„ç©ºé—´è‡ªç„¶ä¼šé‡Šæ”¾çš„ã€‚â€” æ ˆçš„ç”Ÿå‘½å‘¨æœŸå’Œæ‰€å¤„çš„çº¿ç¨‹æ˜¯ä¸€è‡´çš„</li></ul></li><li>æœ¬åœ°æ–¹æ³•æ ˆ<ul><li>ç”±nativeä¿®é¥°çš„æ–¹æ³•</li><li>å’Œè™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼š è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡</li></ul></li></ul></li><li><p>ç›´æ¥å†…å­˜</p><ul><li>ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯è™šæ‹Ÿæœºå®šä¹‰çš„å†…å­˜åŒºåŸŸ</li><li>æ˜¯é€šè¿‡åŸºäºé€šé“å’Œç¼“å­˜åŒºçš„NIOï¼Œç›´æ¥ä½¿ç”¨Nativeå‡½æ•°åº“æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †å½“ä¸­çš„DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨ï¼Œè¿›è€Œè¿›è¡Œæ“ä½œ</li></ul></li></ul></li></ul></li><li><p>ä»ç¡¬ä»¶è§†è§’æ¥çœ‹</p><ul><li>éœ€è¦è™šæ‹Ÿæœºå°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç </li><li>ç¿»è¯‘æ–¹å¼<ul><li>è§£é‡Šæ‰§è¡Œ<ul><li>é€æ¡å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç å¹¶ä¸”æ‰§è¡Œ</li><li>ä¼˜åŠ¿<ul><li>æ— éœ€ç­‰å¾…ç¼–è¯‘</li></ul></li></ul></li><li>å³æ—¶ç¼–è¯‘ Just In Time Compilation<ul><li>å°†ä¸€ä¸ªæ–¹æ³•ä¸­åŒ…å«çš„æ‰€æœ‰å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ä»¥åå†æ‰§è¡Œ</li><li>ä¼˜åŠ¿<ul><li>å®é™…æ‰§è¡Œé€Ÿåº¦ä¼šæ›´å¿«</li></ul></li></ul></li></ul></li><li>hotpotçš„ç¿»è¯‘æ–¹å¼<ul><li>å…ˆè§£é‡Šæ‰§è¡Œå­—èŠ‚ç </li><li>è€Œåå°†åå¤æ‰§è¡Œçš„çƒ­ç‚¹ä»£ç æŒ‰ç…§æ–¹æ³•æ¥ä½œä¸ºåŸºæœ¬å•å…ƒè¿›è¡ŒJIT å³æ—¶ç¼–è¯‘</li></ul></li></ul></li><li><p>èµ°ä¸€ä¸ªä»£ç ä¾‹å­</p></li></ul><pre><code class="jsx">@RequireAllArgConstructorpublic class People {    public String name;    public void sayName() {        System.out.println(&quot;People&#39;s name is: &quot; + name);    }}public class App {    public static void main(String[] args) {        People people = new People(&quot;test&quot;);        people.sayName();    }}</code></pre><ul><li>æ‰§è¡Œmainæ–¹æ³•çš„æ­¥éª¤å¦‚ä¸‹<ul><li>ç¼–è¯‘å¥½App.javaä¹‹åå¾—åˆ°App.classï¼Œæ‰§è¡ŒApp.class</li><li>ç³»ç»Ÿä¼šå¯åŠ¨ä¸€ä¸ªJVMè¿›ç¨‹</li><li>ä»classpathè·¯å¾„å½“ä¸­æ‰¾åˆ°ä¸€ä¸ªåä¸ºApp.classçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†Appçš„ç±»ä¿¡æ¯åŠ è½½åˆ°è¿è¡Œæ—¶æ•°æ®åŒºçš„æ–¹æ³•åŒºå†…</li><li>JVMæ‰¾åˆ°Appä¸»ç¨‹åºå…¥å£ï¼Œæ‰§è¡Œmainæ–¹æ³•</li><li>å½“è¦æ‰§è¡Œnew Peopleçš„æ—¶å€™ï¼Œå‘ç°æ–¹æ³•åŒºå½“ä¸­è¿˜æ²¡æœ‰Peopleç±»çš„ä¿¡æ¯ï¼Œæ‰€ä»¥JVMé©¬ä¸ŠåŠ è½½ï¼Œå¹¶å°†å…¶ç±»çš„ä¿¡æ¯æ”¾åˆ°æ–¹æ³•åŒºé‡Œé¢</li><li>JVMåœ¨å †å½“ä¸­ä¸ºä¸€ä¸ªæ–°çš„Peopleå®ä¾‹åˆ†é…å†…å­˜ï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–Peopleå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æŒæœ‰æŒ‡å‘æ–¹æ³•åŒºä¸­çš„Peopleç±»çš„ç±»å‹ä¿¡æ¯çš„å¼•ç”¨</li><li>æ‰§è¡Œpeople.sayName();æ—¶ï¼ŒJVM æ ¹æ® people çš„å¼•ç”¨æ‰¾åˆ° people å¯¹è±¡ï¼Œç„¶åæ ¹æ® people å¯¹è±¡æŒæœ‰çš„å¼•ç”¨å®šä½åˆ°æ–¹æ³•åŒºä¸­ people ç±»çš„ç±»å‹ä¿¡æ¯çš„æ–¹æ³•è¡¨ï¼Œè·å¾— sayName() çš„å­—èŠ‚ç åœ°å€</li><li>æ‰§è¡ŒsayName()</li></ul></li></ul><h2 id="1-3-Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡"><a href="#1-3-Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡" class="headerlink" title="1.3 Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡"></a>1.3 Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡</h2><ul><li>ä¼˜åŒ–æ–¹å¼<ul><li>å³æ—¶ç¼–è¯‘<ul><li>åº•å±‚é€»è¾‘ â€” äºŒå…«å®šå¾‹<ul><li>è®¤ä¸º20%ä»£ç ä¼šå æ®80%çš„è®¡ç®—èµ„æº</li></ul></li><li>ç¼–è¯‘å™¨ç±»åˆ« â€” tradeoff ç¼–è¯‘æ—¶é—´ vs æ‰§è¡Œæ•ˆç‡<ul><li>C1<ul><li>Clientç¼–è¯‘å™¨</li><li>é¢å‘å¯¹å¯åŠ¨æ€§èƒ½æœ‰è¦æ±‚çš„å®¢æˆ·ç«¯GUIç¨‹åº</li></ul></li><li>C2<ul><li>Serverç¼–è¯‘å™¨</li><li>é¢å‘å¯¹å³°å€¼æ€§èƒ½æœ‰è¦æ±‚çš„æœåŠ¡å™¨ç«¯ç¨‹åº</li><li>é‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹å¤æ‚ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½†åŒæ—¶ç”Ÿæˆä»£ç çš„æ•ˆç‡æ¯”è¾ƒé«˜</li></ul></li><li>Graal</li></ul></li></ul></li></ul></li><li>Hotpotå¯¹äºå„ç§ç¼–è¯‘å™¨çš„é‡‡ç”¨æ–¹å¼<ul><li>åˆ†å±‚ç¼–è¯‘<ul><li>çƒ­ç‚¹æ–¹æ³•å…ˆè¢«C1 ç¼–è¯‘</li><li>çƒ­ç‚¹æ–¹æ³•é‡Œçš„çƒ­ç‚¹ä¼šè¿›ä¸€æ­¥è¢«C2 ç¼–è¯‘å™¨ç¼–è¯‘</li></ul></li><li>ä¼šå½±å“åº”ç”¨çš„æ­£å¸¸è¿›è¡Œä¹ˆï¼Ÿ<ul><li>å³æ—¶ç¼–è¯‘æ˜¯åœ¨é¢å¤–çš„ç¼–è¯‘çº¿ç¨‹å½“ä¸­è¿›è¡Œçš„</li><li>ä¼šæ ¹æ®CPUçš„æ•°é‡è®¾ç½®ç¼–è¯‘çº¿ç¨‹çš„æ•°ç›®ï¼Œå¹¶ä¸”æŒ‰ç…§1:2çš„æ¯”ä¾‹é…ç½®ç»™C1 åŠC2 ç¼–è¯‘å™¨</li></ul></li></ul></li></ul><h1 id="2-åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°"><a href="#2-åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°" class="headerlink" title="2. åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°"></a>2. åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°</h1><ul><li><p>ä¸ºä»€ä¹ˆè¦å¼•å…¥åŸºæœ¬ç±»å‹è€Œä¸æ˜¯å…¨éƒ½ä½¿ç”¨å¯¹è±¡å‘¢ï¼Ÿ</p><ul><li>åŸºæœ¬ç±»å‹æ›´é è¿‘åº•å±‚ï¼Œåœ¨æ‰§è¡Œæ•ˆç‡å’Œå†…å­˜ä½¿ç”¨æ–¹é¢éƒ½èƒ½å¤Ÿæå‡è½¯ä»¶çš„æ€§èƒ½</li></ul></li><li><p>boolean ç±»å‹</p><ul><li><p>æ˜ å°„æˆintç±»å‹</p><ul><li><p>trueè¢«æ˜ å°„ä¸ºæ•´æ•°1</p></li><li><p>falseè¢«æ˜ å°„ä¸ºæ•´æ•°0</p><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%201.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%201.png"></p></li></ul></li></ul></li><li><p>Javaè™šæ‹Ÿæœºåœ¨è°ƒç”¨Javaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ ˆå¸§ï¼Œå¯¹äºå…¶ä¸­çš„è§£é‡Šæ ˆå¸§æ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†</p><ul><li>å±€éƒ¨å˜é‡åŒº<ul><li>å±€éƒ¨å˜é‡</li><li>thisæŒ‡é’ˆ</li><li>æ–¹æ³•æ¥æ”¶çš„å‚æ•°</li><li>å„ä¸ªåŸºæœ¬ç±»å‹åœ¨å±€éƒ¨å˜é‡åŒºçš„è¡¨ç°<ul><li>å±€éƒ¨å˜é‡åŒºç­‰ä»·äºä¸€ä¸ªæ•°ç»„<ul><li>long doubleéœ€è¦ä¸¤ä¸ªæ•°ç»„å•å…ƒå­˜å‚¨</li><li>å…¶ä»–åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å€¼å‡å ç”¨ä¸€ä¸ªæ•°ç»„å•å…ƒ</li></ul></li></ul></li></ul></li><li>å­—èŠ‚ç çš„æ“ä½œæ•°æ ˆ</li></ul></li><li><p>å­˜å‚¨æ“ä½œ</p><ul><li>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªintç±»å‹çš„å€¼æ”¾åˆ°char short ç­‰é‡Œé¢ï¼Œç›¸å½“äºåšäº†ä¸€æ¬¡æ©ç   åªä¼šä¿ç•™ä½ä½äº†</li></ul></li><li><p>åŠ è½½</p><ul><li>ç®—æ•°è¿ç®—å®Œå…¨ä¾èµ–äºæ“ä½œæ•°æ ˆ</li><li>å †å½“ä¸­çš„boolean, byte, char, short åŠ è½½åˆ°æ“ä½œæ•°æ ˆå½“ä¸­ï¼Œè€Œåå°†æ ˆä¸Šçš„å€¼å½“æˆintç±»å‹æ¥è¿ç®—</li></ul></li></ul><h1 id="3-ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹"><a href="#3-ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="3. ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹"></a>3. ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹</h1><ul><li>é¦–å…ˆ.javaæ–‡ä»¶ä¼šè¢«ç¼–è¯‘æˆ.classæ–‡ä»¶ï¼Œè€Œåæˆ‘ä»¬éœ€è¦ç±»åŠ è½½å™¨æ¥å¤„ç†.classæ–‡ä»¶ï¼Œè®©JVMå¯¹å…¶è¿›è¡Œå¤„ç†</li><li>ä»classæ–‡ä»¶åˆ°å†…å­˜å½“ä¸­çš„ç±»ï¼Œéœ€è¦ç»è¿‡ï¼š<ul><li>åŠ è½½<ul><li>æŸ¥æ‰¾å­—èŠ‚æµï¼Œå¹¶ä¸”æ ¹æ®æ­¤æ¥åˆ›å»ºç±»çš„è¿‡ç¨‹<ul><li>å°†classç±»åŠ è½½åˆ°å†…å­˜å½“ä¸­</li><li>å°†é™æ€æ•°æ®ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºå½“ä¸­è¿è¡Œæ—¶çš„æ•°æ®ç»“æ„</li><li>åœ¨å †å½“ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.classå¯¹è±¡ä½œä¸ºæ•°æ®è®¿é—®çš„å…¥å£</li></ul></li><li>å€ŸåŠ©ç±»åŠ è½½å™¨æ¥å®ŒæˆæŸ¥æ‰¾å­—èŠ‚æµçš„è¿‡ç¨‹<ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ â€” bootstrap class loader<ul><li>è´Ÿè´£åŠ è½½æœ€åŸºç¡€æœ€é‡è¦çš„ç±»ï¼Œè­¬å¦‚JRE libç›®å½•ä¸‹JaråŒ…ä¸­çš„ç±»</li><li>ç”±è™šæ‹Ÿæœºå‚æ•° -XbootclasspathæŒ‡å®šçš„ç±»</li></ul></li><li>å…¶ä»–ç±»åŠ è½½å™¨ â€” éƒ½æ˜¯java.lang.ClassLoaderçš„å­ç±»<ul><li>éœ€è¦å…ˆç”±å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå°†å…¶åŠ è½½è‡³Javaè™šæ‹Ÿæœºå½“ä¸­ï¼Œæ–¹èƒ½æ‰§è¡Œç±»çš„åŠ è½½</li><li>E.G<ul><li>æ‰©å±•ç±»åŠ è½½å™¨ â€” çˆ¶ç±»æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨<ul><li>è´Ÿè´£åŠ è½½ç›¸å¯¹æ¬¡è¦ã€ä½†åˆé€šç”¨çš„ç±»ï¼Œæ¯”å¦‚å­˜æ”¾åœ¨ JRE çš„ lib/ext ç›®å½•ä¸‹ jar åŒ…ä¸­çš„ç±»ï¼ˆä»¥åŠç”±ç³»ç»Ÿå˜é‡ java.ext.dirs æŒ‡å®šçš„ç±»ï¼‰</li></ul></li><li>åº”ç”¨ç±»åŠ è½½å™¨ â€” çˆ¶ç±»æ˜¯æ‰©å±•ç±»åŠ è½½å™¨<ul><li>è´Ÿè´£åŠ è½½åº”ç”¨ç¨‹åºè·¯å¾„ä¸‹çš„ç±»<ul><li>ä¾‹å¦‚è™šæ‹Ÿæœºå‚æ•° -cp/-classpath, ç³»ç»Ÿå˜é‡java.class.pathæˆ–è€…ç¯å¢ƒå˜é‡CLASSPATHæ‰€æŒ‡å®šçš„è·¯å¾„</li><li>é»˜è®¤åº”ç”¨ç¨‹åºé‡ŒåŒ…å«çš„ç±»åº”è¯¥ç”±åº”ç”¨ç±»åŠ è½½å™¨æ¥è¿›è¡ŒåŠ è½½</li></ul></li></ul></li></ul></li></ul></li></ul></li><li>åŒäº²å§”æ´¾æ¨¡å‹<ul><li>å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ¥æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œä¼šå…ˆå°†è¯·æ±‚è½¬å‘ç»™çˆ¶ç±»åŠ è½½å™¨</li><li>åœ¨çˆ¶ç±»åŠ è½½å™¨æ²¡æœ‰æ‰¾åˆ°æ‰€è¯·æ±‚çš„ç±»çš„æƒ…å†µä¸‹ï¼Œè¯¥ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•å»åŠ è½½</li></ul></li><li>ç±»åŠ è½½å™¨ â€” å‘½åç©ºé—´çš„ä½œç”¨<ul><li>ç±»çš„å”¯ä¸€æ€§ç”±ç±»åŠ è½½å™¨å®ä¾‹å’Œç±»çš„å…¨åå…±åŒç¡®å®š</li><li>å³ä½¿åŒä¸€ä¸²å­—èŠ‚æµï¼Œç»ç”±ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¹Ÿä¼šå¾—åˆ°ä¸åŒçš„ç±»</li></ul></li></ul></li><li>é“¾æ¥<ul><li>å°†åˆ›å»ºçš„ç±»åˆå¹¶åˆ°Javaè™šæ‹Ÿæœºå½“ä¸­ï¼Œå¹¶ä¸”ä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œçš„è¿‡ç¨‹</li><li>è¿‡ç¨‹<ul><li>éªŒè¯<ul><li>ç¡®ä¿è¢«åŠ è½½ç±»èƒ½å¤Ÿæ»¡è¶³Javaè™šæ‹Ÿæœºçš„çº¦æŸæ¡ä»¶</li><li>å®‰å…¨æ£€æŸ¥</li></ul></li><li>å‡†å¤‡<ul><li>ä¸ºè¢«åŠ è½½ç±»çš„é™æ€å­—æ®µåˆ†é…å†…å­˜<ul><li>å°±æ˜¯ä¸ºstaticå˜é‡åœ¨æ–¹æ³•åŒºå½“ä¸­åˆ†é…å†…å­˜ç©ºé—´ï¼Œè®¾ç½®å˜é‡çš„åˆå§‹å€¼</li></ul></li><li>ä¹Ÿä¼šæ¥æ„é€ å’Œå…¶ä»–ç±»å±‚æ¬¡ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚è¯´ç”¨æ¥å®ç°è™šæ–¹æ³•çš„åŠ¨æ€ç»‘å®šçš„æ–¹æ³•è¡¨</li></ul></li><li>è§£æ â€” å¯¹äºå­—èŠ‚ç ç¬¦å·å¼•ç”¨çš„è§£æ<ul><li>åœ¨ class æ–‡ä»¶è¢«åŠ è½½è‡³ Java è™šæ‹Ÿæœºä¹‹å‰ï¼Œè¿™ä¸ªç±»æ— æ³•çŸ¥é“å…¶ä»–ç±»åŠå…¶æ–¹æ³•ã€å­—æ®µæ‰€å¯¹åº”çš„å…·ä½“åœ°å€ï¼Œç”šè‡³ä¸çŸ¥é“è‡ªå·±æ–¹æ³•ã€å­—æ®µçš„åœ°å€ã€‚</li><li>å› æ­¤ï¼Œæ¯å½“éœ€è¦å¼•ç”¨è¿™äº›æˆå‘˜æ—¶ï¼ŒJava ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªç¬¦å·å¼•ç”¨ã€‚åœ¨è¿è¡Œé˜¶æ®µï¼Œè¿™ä¸ªç¬¦å·å¼•ç”¨ä¸€èˆ¬éƒ½èƒ½å¤Ÿæ— æ­§ä¹‰åœ°å®šä½åˆ°å…·ä½“ç›®æ ‡ä¸Šã€‚</li><li>ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«ç›®æ ‡æ–¹æ³•æ‰€åœ¨ç±»çš„åå­—ã€ç›®æ ‡æ–¹æ³•çš„åå­—ã€æ¥æ”¶å‚æ•°ç±»å‹ä»¥åŠè¿”å›å€¼ç±»å‹çš„ç¬¦å·å¼•ç”¨ï¼Œæ¥æŒ‡ä»£æ‰€è¦è°ƒç”¨çš„æ–¹æ³•ã€‚</li><li>è§£æé˜¶æ®µçš„ç›®çš„ï¼Œæ­£æ˜¯å°†è¿™äº›ç¬¦å·å¼•ç”¨è§£ææˆä¸ºå®é™…å¼•ç”¨ã€‚å¦‚æœç¬¦å·å¼•ç”¨æŒ‡å‘ä¸€ä¸ªæœªè¢«åŠ è½½çš„ç±»ï¼Œæˆ–è€…æœªè¢«åŠ è½½ç±»çš„å­—æ®µæˆ–æ–¹æ³•ï¼Œé‚£ä¹ˆè§£æå°†è§¦å‘è¿™ä¸ªç±»çš„åŠ è½½ï¼ˆä½†æœªå¿…è§¦å‘è¿™ä¸ªç±»çš„é“¾æ¥ä»¥åŠåˆå§‹åŒ–ã€‚ï¼‰</li></ul></li></ul></li></ul></li><li>åˆå§‹åŒ–<ul><li>å†…å®¹<ul><li>ä¸ºæ ‡è®°ä¸ºå¸¸é‡å€¼çš„å­—æ®µèµ‹å€¼</li><li>æ‰§è¡Œclinitæ–¹æ³• â€” Javaè™šæ‹Ÿæœºé€šè¿‡åŠ é”ç¡®å®šclinitæ–¹æ³•ä»…ä»…ä¼šè¢«æ‰§è¡Œä¸€æ¬¡<ul><li>å¦‚æœç›´æ¥èµ‹å€¼çš„é™æ€å­—æ®µè¢« final æ‰€ä¿®é¥°ï¼Œå¹¶ä¸”å®ƒçš„ç±»å‹æ˜¯åŸºæœ¬ç±»å‹æˆ–å­—ç¬¦ä¸²æ—¶ï¼Œé‚£ä¹ˆè¯¥å­—æ®µä¾¿ä¼šè¢« Java ç¼–è¯‘å™¨æ ‡è®°æˆå¸¸é‡å€¼ï¼ˆConstantValueï¼‰ï¼Œå…¶åˆå§‹åŒ–ç›´æ¥ç”± Java è™šæ‹Ÿæœºå®Œæˆã€‚</li><li>é™¤æ­¤ä¹‹å¤–çš„ç›´æ¥èµ‹å€¼æ“ä½œï¼Œä»¥åŠæ‰€æœ‰é™æ€ä»£ç å—ä¸­çš„ä»£ç ï¼Œåˆ™ä¼šè¢« Java ç¼–è¯‘å™¨ç½®äºåŒä¸€æ–¹æ³•ä¸­ï¼Œå¹¶æŠŠå®ƒå‘½åä¸º &lt; clinit &gt;ã€‚</li></ul></li></ul></li><li>è§¦å‘æƒ…å†µ<ul><li>å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–ç”¨æˆ·æŒ‡å®šçš„ä¸»ç±»ï¼›</li><li>å½“é‡åˆ°ç”¨ä»¥æ–°å»ºç›®æ ‡ç±»å®ä¾‹çš„ new æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ– new æŒ‡ä»¤çš„ç›®æ ‡ç±»ï¼›</li><li>å½“é‡åˆ°è°ƒç”¨é™æ€æ–¹æ³•çš„æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ–è¯¥é™æ€æ–¹æ³•æ‰€åœ¨çš„ç±»ï¼›</li><li>å½“é‡åˆ°è®¿é—®é™æ€å­—æ®µçš„æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ–è¯¥é™æ€å­—æ®µæ‰€åœ¨çš„ç±»ï¼›</li><li>å­ç±»çš„åˆå§‹åŒ–ä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–ï¼›</li><li>å¦‚æœä¸€ä¸ªæ¥å£å®šä¹‰äº† default æ–¹æ³•ï¼Œé‚£ä¹ˆç›´æ¥å®ç°æˆ–è€…é—´æ¥å®ç°è¯¥æ¥å£çš„ç±»çš„åˆå§‹åŒ–ï¼Œä¼šè§¦å‘è¯¥æ¥å£çš„åˆå§‹åŒ–ï¼›</li><li>ä½¿ç”¨åå°„ API å¯¹æŸä¸ªç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶ï¼Œåˆå§‹åŒ–è¿™ä¸ªç±»ï¼›</li><li>å½“åˆæ¬¡è°ƒç”¨ MethodHandle å®ä¾‹æ—¶ï¼Œåˆå§‹åŒ–è¯¥ MethodHandle æŒ‡å‘çš„æ–¹æ³•æ‰€åœ¨çš„ç±»ã€‚</li></ul></li></ul></li><li>å¸è½½<ul><li>GCå°†æ— ç”¨å¯¹è±¡ä»å†…å­˜å½“ä¸­å¸è½½æ‰</li></ul></li></ul></li><li>åŸºæœ¬ç±»å‹æ˜¯Javaè™šæ‹Ÿæœºå·²ç»è®¾ç½®å¥½çš„ï¼Œè€Œå¦ä¸€å¤§ç±»å¼•ç”¨ç±»å‹ï¼ŒJavaå°†å…¶ç»†åˆ†ä¸ºå››ç§<ul><li>ç±»<ul><li>æœ‰å¯¹åº”çš„å­—èŠ‚æµ â€” classæ–‡ä»¶</li></ul></li><li>æ¥å£<ul><li>æœ‰å¯¹åº”çš„å­—èŠ‚æµ - classæ–‡ä»¶</li></ul></li><li>æ•°ç»„ç±»<ul><li>ç”±Javaè™šæ‹Ÿæœºç›´æ¥ç”Ÿæˆ</li></ul></li><li>æ³›å‹å‚æ•°</li></ul></li></ul><h1 id="4-JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨"><a href="#4-JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨" class="headerlink" title="4. JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨"></a>4. JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨</h1><h2 id="4-1-é‡è½½å’Œé‡å†™"><a href="#4-1-é‡è½½å’Œé‡å†™" class="headerlink" title="4.1 é‡è½½å’Œé‡å†™"></a>4.1 é‡è½½å’Œé‡å†™</h2><ul><li>é‡è½½<ul><li>åŒä¸€ä¸ªç±»å½“ä¸­æ–¹æ³•åç§°ç›¸åŒï¼Œä½†æ˜¯æ–¹æ³•çš„å‚æ•°ä¸ç›¸åŒçš„æƒ…å†µ</li><li>åœ¨ç¼–è¯‘è¿‡ç¨‹å½“ä¸­å°±å¯ä»¥å®Œæˆè¯†åˆ«ï¼ŒJavaç¼–è¯‘å™¨æ ¹æ®ä¼ å…¥å‚æ•°çš„å£°æ˜ç±»å‹ï¼Œæ¥é€‰å–é‡è½½æ–¹æ³•<ul><li>ä¸‰ä¸ªé˜¶æ®µ<ul><li>ä¸è€ƒè™‘åŸºæœ¬ç±»å‹çš„è‡ªåŠ¨æ‹†ç®±è£…ç®±ï¼Œè¿˜æœ‰å¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰æ‹©é‡è½½æ–¹æ³•</li><li>1é˜¶æ®µæ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±åœ¨å…è®¸è‡ªåŠ¨æ‹†è£…ç®±ï¼Œä½†ä¸å…è®¸å¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•</li><li>2é˜¶æ®µæ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨å…è®¸è‡ªåŠ¨è£…æ‹†ç®±ä»¥åŠå¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•</li></ul></li><li>å¦‚æœJavaç¼–è¯‘å™¨åœ¨åŒä¸€ä¸ªé˜¶æ®µæ‰¾åˆ°äº†å¤šä¸ªé€‚é…æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¸ºè´´åˆ‡çš„ï¼Œå†³å®šè´´åˆ‡ç¨‹åº¦çš„ä¸€ä¸ªå…³é”®å°±æ˜¯å½¢å¼å‚æ•°ç±»å‹çš„ç»§æ‰¿å…³ç³»<ul><li>ä¼šé€‰æ‹©é‚£ä¸ªèŒƒå›´æ›´å°çš„ï¼Œæ¯”å¦‚æŸæŸçš„å­ç±»è¿™æ ·å­</li></ul></li></ul></li></ul></li><li>é‡å†™<ul><li>å­ç±»å®šä¹‰äº†å’Œçˆ¶ç±»éç§æœ‰æ–¹æ³•åŒåçš„æ–¹æ³•ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹ç›¸åŒ</li><li>å¦‚æœè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œé‚£ä¹ˆå­ç±»ä¸­çš„æ–¹æ³•éšè—äº†çˆ¶ç±»ä¸­çš„æ–¹æ³•</li><li>å¦‚æœéƒ½ä¸æ˜¯é™æ€ï¼Œä¹Ÿä¸æ˜¯ç§æœ‰çš„ï¼Œé‚£ä¹ˆå­ç±»çš„æ–¹æ³•é‡å†™äº†çˆ¶ç±»å½“ä¸­çš„æ–¹æ³•</li><li>æ–¹æ³•é‡å†™ â€” å…è®¸å­ç±»åœ¨ç»§æ‰¿çˆ¶ç±»éƒ¨åˆ†åŠŸèƒ½çš„åŒæ—¶ï¼Œæ‹¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„è¡Œä¸º</li></ul></li></ul><h2 id="4-2-JVM-é™æ€å’ŒåŠ¨æ€ç»‘å®š"><a href="#4-2-JVM-é™æ€å’ŒåŠ¨æ€ç»‘å®š" class="headerlink" title="4.2 JVM é™æ€å’ŒåŠ¨æ€ç»‘å®š"></a>4.2 JVM é™æ€å’ŒåŠ¨æ€ç»‘å®š</h2><ul><li>Javaè™šæ‹Ÿæœºè¯†åˆ«æ–¹æ³•<ul><li>ç±»å</li><li>æ–¹æ³•å</li><li>æ–¹æ³•æè¿°ç¬¦ â€” method descriptor<ul><li>ç”±æ–¹æ³•çš„å‚æ•°ç±»å‹ä»¥åŠ<strong>è¿”å›ç±»å‹</strong>æ‰€æ„æˆçš„</li></ul></li></ul></li><li>JVMå’ŒJavaè¯­è¨€åœ¨è¿™é‡Œä¸å¤ªä¸€æ ·ï¼ŒåŒä¸€ä¸ªç±»ä¸‹åŒæ ·æ–¹æ³•åï¼ŒåŒæ ·å‚æ•°ï¼Œä½†æ˜¯ä¸åŒè¿”å›å€¼ä»JVMè§’åº¦æ¥è¯´æ˜¯å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸åŒçš„æ–¹æ³•ï¼Œæ˜¯å¯ä»¥é€šè¿‡çš„</li><li>é™æ€ç»‘å®š<ul><li>åœ¨è§£æçš„æ—¶å€™ä¾¿èƒ½å¤Ÿè¯†åˆ«ç›®æ ‡æ–¹æ³•çš„æƒ…å†µ</li><li>é‡è½½ â€” æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°±å®Œæˆäº†çš„ï¼Œä¹Ÿå¯ä»¥æˆä¸ºstatic binding</li></ul></li><li>åŠ¨æ€ç»‘å®š<ul><li>åœ¨è¿è¡Œè¿‡ç¨‹å½“ä¸­æ ¹æ®è°ƒç”¨è€…çš„åŠ¨æ€ç±»å‹æ¥è¯†åˆ«ç›®æ ‡æ–¹æ³•çš„æƒ…å†µ</li><li>é‡å†™ â€” åœ¨JVMå½“ä¸­æ¥åšè¯†åˆ«ï¼Œdynamic binding</li></ul></li><li>Javaå­—èŠ‚ç å½“ä¸­å’Œè°ƒç”¨ç›¸å…³çš„æŒ‡ä»¤<ul><li>invokestatic  - ç”¨äºè°ƒç”¨é™æ€æ–¹æ³•</li><li>invokespecial - ç”¨äºè°ƒç”¨ç§æœ‰å®ä¾‹æ–¹æ³•ï¼Œæ„é€ å™¨  ä»¥åŠä½¿ç”¨superå…³é”®å­—è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•æˆ–è€…æ„é€ å™¨</li><li>invokevirtual  - ç”¨äºè°ƒç”¨éç§æœ‰å®ä¾‹æ–¹æ³•</li><li>invokeinterface - ç”¨äºè°ƒç”¨æ¥å£æ–¹æ³•</li><li>invokedynamic - ç”¨äºè°ƒç”¨åŠ¨æ€æ–¹æ³•</li></ul></li></ul><h2 id="4-3-è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨"><a href="#4-3-è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨" class="headerlink" title="4.3 è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨"></a>4.3 è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨</h2><ul><li>åœ¨ç¼–è¯‘è¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç›®æ ‡æ–¹æ³•çš„å…·ä½“å†…å­˜åœ°å€<ul><li>Javaç¼–è¯‘å™¨ä¼šæš‚æ—¶ç”¨ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºè¯¥ç›®æ ‡æ–¹æ³•</li><li>è¿™ä¸€ç¬¦å·å¼•ç”¨åŒ…æ‹¬ç›®æ ‡æ–¹æ³•æ‰€åœ¨çš„ç±»æˆ–æ¥å£çš„åå­—ï¼Œä»¥åŠç›®æ ‡æ–¹æ³•çš„æ–¹æ³•åå’Œæ–¹æ³•æè¿°ç¬¦ã€‚</li></ul></li></ul><h1 id="5-åƒåœ¾å›æ”¶"><a href="#5-åƒåœ¾å›æ”¶" class="headerlink" title="5. åƒåœ¾å›æ”¶"></a>5. åƒåœ¾å›æ”¶</h1><h2 id="5-1-å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡"><a href="#5-1-å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡" class="headerlink" title="5.1 å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡"></a>5.1 å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡</h2><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%202.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%202.png"></p><ul><li>ç»¿è‰²éƒ¨åˆ†æ˜¯çº¿ç¨‹æ‹¥æœ‰çš„ï¼Œä¼šéšç€çº¿ç¨‹çš„ç»“æŸè€Œè‡ªåŠ¨è¢«å›æ”¶ è¿™é‡Œä¸éœ€è¦è€ƒè™‘åƒåœ¾å›æ”¶çš„é—®é¢˜</li><li>æ©™è‰²éƒ¨åˆ†æ˜¯å…±äº«çš„ï¼Œå†…å­˜åˆ†é…å’Œå›æ”¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œå› æ­¤åƒåœ¾æ”¶é›†å™¨æ‰€å…³æ³¨çš„éƒ½æ˜¯å †å’Œæ–¹æ³•è¿™éƒ¨åˆ†å†…å­˜</li><li>åˆ¤æ–­å¯¹è±¡å­˜æ´»çš„æ–¹æ³•<ul><li>å¼•ç”¨è®¡æ•°å™¨è®¡ç®—<ul><li>ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯æ¬¡å¼•ç”¨è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™è®¡æ•°å™¨åŠ ä¸€ï¼Œå¼•ç”¨å¤±æ•ˆåˆ™å‡ä¸€</li><li>è®¡æ•°å™¨ç­‰äºé›¶çš„æ—¶å€™å°±ä¸ä¼šå†æ¬¡è¯•ç”¨äº†</li></ul></li><li>å¯è¾¾æ€§åˆ†æè®¡ç®—<ul><li>å°†ä¸€ç³»åˆ—GC ROOTSä½œä¸ºèµ·å§‹çš„å­˜æ´»å¯¹è±¡é›†ï¼Œä»è¿™ä¸ªèŠ‚ç‚¹å¾€ä¸‹æœç´¢</li><li>æœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„æˆä¸ºå¼•ç”¨é“¾ï¼Œå°†èƒ½è¢«è¯¥é›†åˆå¼•ç”¨çš„å¯¹è±¡åŠ å…¥åˆ°é›†åˆå½“ä¸­</li><li>å½“æœç´¢åˆ°ä¸€ä¸ªå¯¹è±¡åˆ°GC rootsæ²¡æœ‰ä½¿ç”¨ä»»ä½•å¼•ç”¨é“¾çš„æ—¶å€™ï¼Œå°±è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„</li></ul></li></ul></li></ul><h2 id="5-2-å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ-æ­»äº¡"><a href="#5-2-å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ-æ­»äº¡" class="headerlink" title="5.2 å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ/ æ­»äº¡"></a>5.2 å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ/ æ­»äº¡</h2><ul><li>finalize()æ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªå¯¹è±¡çš„finalize()æ–¹æ³•åªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ï¼Œç»è¿‡finalize()æ–¹æ³•é€ƒè„±æ­»äº¡çš„å¯¹è±¡ï¼ŒäºŒæ¬¡æ ‡è®°çš„æ—¶å€™ä¼šç»™ç§»å‡º</li><li>æ•´ä¸ªæµç¨‹å¦‚ä¸‹<ol><li>å¦‚æœå¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æä¹‹åæ²¡å‘ç°ä¸GC Rootsç›¸è¿çš„å¼•ç”¨é“¾ï¼Œé‚£å®ƒå°†ä¼šç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ã€‚åˆ¤æ–­çš„æ¡ä»¶æ˜¯å†³å®šè¿™ä¸ªå¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚å¦‚æœå¯¹è±¡æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œåˆ™è¢«æ”¾å…¥F-Queueé˜Ÿåˆ—ä¸­ã€‚</li><li>GCå¯¹F-Queueé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡ŒäºŒæ¬¡æ ‡è®°ã€‚å¦‚æœå¯¹è±¡åœ¨finalize()æ–¹æ³•ä¸­é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹äº†å…³è”ï¼Œé‚£ä¹ˆäºŒæ¬¡æ ‡è®°æ—¶åˆ™ä¼šå°†å®ƒç§»å‡ºâ€œå³å°†å›æ”¶â€é›†åˆã€‚å¦‚æœæ­¤æ—¶å¯¹è±¡è¿˜æ²¡æˆåŠŸé€ƒè„±ï¼Œé‚£ä¹ˆåªèƒ½è¢«å›æ”¶äº†ã€‚</li></ol></li></ul><h2 id="5-3-åƒåœ¾å›æ”¶ç®—æ³•"><a href="#5-3-åƒåœ¾å›æ”¶ç®—æ³•" class="headerlink" title="5.3 åƒåœ¾å›æ”¶ç®—æ³•"></a>5.3 åƒåœ¾å›æ”¶ç®—æ³•</h2><h3 id="5-3-1-æ ‡è®°æ¸…é™¤ç®—æ³•"><a href="#5-3-1-æ ‡è®°æ¸…é™¤ç®—æ³•" class="headerlink" title="5.3.1 æ ‡è®°æ¸…é™¤ç®—æ³•"></a>5.3.1 æ ‡è®°æ¸…é™¤ç®—æ³•</h3><ul><li><p>é˜¶æ®µ</p><ul><li>æ ‡è®°<ul><li>æ ‡è®°å¤„æ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡</li></ul></li><li>æ¸…é™¤<ul><li>æ ‡è®°ç»“æŸä»¥åè¿›è¡Œç»Ÿä¸€çš„å›æ”¶</li></ul></li></ul></li><li><p>åŸç†</p><ul><li>å°†å·²æ­»äº¡çš„å¯¹è±¡æ ‡è®°ä¸ºç©ºé—²å†…å­˜ï¼Œè®°å½•åœ¨ä¸€ä¸ªç©ºé—²åˆ—è¡¨å½“ä¸­</li><li>å½“æˆ‘ä»¬éœ€è¦newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå†…å­˜ç®¡ç†æ¨¡å—ä¼šä»ç©ºé—²åˆ—è¡¨å½“ä¸­å¯»æ‰¾ç©ºé—²çš„å†…å­˜æ¥åˆ†ç»™æ–°çš„å¯¹è±¡</li></ul></li><li><p>ç¼ºé™·</p><ul><li><p>ä¼šä½¿å¾—å†…å­˜å½“ä¸­çš„ç¢ç‰‡éå¸¸å¤š</p></li><li><p>å®¹æ˜“å¯¼è‡´å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤§å—çš„å†…å­˜çš„æ—¶å€™ï¼Œæ— æ³•åˆ†é…è¶³å¤Ÿçš„è¿ç»­å†…å­˜</p><p>  <img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%203.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%203.png"></p></li></ul></li></ul><h3 id="5-3-2-å¤åˆ¶ç®—æ³•"><a href="#5-3-2-å¤åˆ¶ç®—æ³•" class="headerlink" title="5.3.2 å¤åˆ¶ç®—æ³•"></a>5.3.2 å¤åˆ¶ç®—æ³•</h3><ul><li><p>åœ¨æ ‡è®°æ¸…é™¤ç®—æ³•çš„åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–</p><ul><li>å°†å¯ç”¨å†…å­˜æŒ‰ç…§å®¹é‡åˆ’åˆ†æˆä¸¤ç­‰åˆ†ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—</li><li>å½“ä¸€å—å­˜æ»¡äº† å°±å°†å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šï¼Œç„¶åäº¤æ¢æŒ‡é’ˆçš„å†…å®¹</li><li>ä»¥æ­¤è§£å†³ç¢ç‰‡åŒ–çš„é—®é¢˜</li></ul></li><li><p>ç¼ºé™·</p><ul><li><p>å¯ç”¨å†…å­˜å‡å°‘äº†ï¼</p><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%204.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%204.png"></p></li></ul></li></ul><h3 id="5-3-3-æ ‡è®°æ•´ç†ç®—æ³•"><a href="#5-3-3-æ ‡è®°æ•´ç†ç®—æ³•" class="headerlink" title="5.3.3 æ ‡è®°æ•´ç†ç®—æ³•"></a>5.3.3 æ ‡è®°æ•´ç†ç®—æ³•</h3><ul><li>æ ‡è®°äº†ä»¥åä¼šåšæ•´ç†ï¼Œå°†æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘å†…å­˜å—ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜</li></ul><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%205.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%205.png"></p><h3 id="5-3-4-åˆ†ä»£æ”¶é›†ç®—æ³•"><a href="#5-3-4-åˆ†ä»£æ”¶é›†ç®—æ³•" class="headerlink" title="5.3.4 åˆ†ä»£æ”¶é›†ç®—æ³•"></a>5.3.4 åˆ†ä»£æ”¶é›†ç®—æ³•</h3><ul><li>æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—</li><li>æ–°ç”Ÿä»£<ul><li>æ¯æ¬¡åƒåœ¾æ”¶é›†éƒ½æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œå°‘é‡å­˜æ´»</li><li>æ‰€ä»¥å¯ä»¥é€‰ç”¨å¤åˆ¶ç®—æ³•</li></ul></li><li>è€å¹´ä»£<ul><li>å¯¹è±¡å­˜æ´»ç‡é«˜ï¼Œæ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å…¶è¿›è¡Œåˆ†é…å’Œæ‹…ä¿</li><li>éœ€è¦ä½¿ç”¨æ ‡è®°-æ¸…ç†æˆ–è€…æ ‡è®°æ•´ç†ç®—æ³•æ¥è¿›è¡Œå›æ”¶</li></ul></li></ul><h2 id="5-4-åƒåœ¾æ”¶é›†å™¨"><a href="#5-4-åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="5.4 åƒåœ¾æ”¶é›†å™¨"></a>5.4 åƒåœ¾æ”¶é›†å™¨</h2><ul><li>jdk8 é»˜è®¤æ”¶é›†å™¨æ˜¯Parallel Scavenge å’Œ Parallel Old</li><li>jdk9å¼€å§‹ï¼ŒG1æ”¶é›†å™¨æˆä¸ºé»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨</li></ul><p><img src="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%206.png" alt="Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%20b3e8d9d4a04740b09ba93ad433759c05/Untitled%206.png"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://snailclimb.gitee.io/javaguide/#/docs/java/jvm/[%E5%8A%A0%E9%A4%90]%E5%A4%A7%E7%99%BD%E8%AF%9D%E5%B8%A6%E4%BD%A0%E8%AE%A4%E8%AF%86JVM" target="_blank" rel="noopener">JavaGuide</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>01èƒŒåŒ…é—®é¢˜</title>
      <link href="/01%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"/>
      <url>/01%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="01èƒŒåŒ…é—®é¢˜"><a href="#01èƒŒåŒ…é—®é¢˜" class="headerlink" title="01èƒŒåŒ…é—®é¢˜"></a>01èƒŒåŒ…é—®é¢˜</h1><p>Created: Jun 23, 2021 8:02 PM</p><h1 id="1-é—®é¢˜æè¿°"><a href="#1-é—®é¢˜æè¿°" class="headerlink" title="1. é—®é¢˜æè¿°"></a>1. é—®é¢˜æè¿°</h1><p>èƒŒåŒ…é—®é¢˜ å³æœ‰Nä»¶ç‰©å“ï¼Œå’Œä¸€ä¸ªæœ€å¤šèƒ½è£…é‡é‡Wçš„èƒŒåŒ…ï¼Œç¬¬iä»¶ç‰©å“çš„é‡é‡æ˜¯weight[i], å¾—åˆ°çš„ä»·å€¼æ˜¯value[i], æ¯ä»¶ç‰©å“åªèƒ½ç”¨ä¸€æ¬¡ï¼Œæ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…é‡Œç‰©å“ä»·å€¼æ€»å’Œæœ€å¤§ã€‚</p><h1 id="2-æš´åŠ›ç ´è§£æ–¹æ³•"><a href="#2-æš´åŠ›ç ´è§£æ–¹æ³•" class="headerlink" title="2. æš´åŠ›ç ´è§£æ–¹æ³•"></a>2. æš´åŠ›ç ´è§£æ–¹æ³•</h1><ul><li>æ¯ä»¶ç‰©å“åªæœ‰é€‰å’Œä¸é€‰ä¸¤ç§é€”å¾„ï¼Œå¯ä»¥ä½¿ç”¨å›æº¯æ³•æœç´¢å‡ºæ‰€æœ‰çš„æƒ…å†µï¼Œç„¶åå–æœ€å¤§çš„å€¼</li><li>è¿™æ ·å†™éå¸¸æ…¢ï¼Œå› ä¸ºéå†äº†æ¯ä¸ªç‰©å“çš„å–å’Œä¸å–çš„æ‰€æœ‰æƒ…å†µï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(2^n)</li></ul><pre><code class="jsx">class Solution {    int result = 0;  int cur = 0;    public maxValue(int[] value, int[] weight, int w) {        backTracking(value, weight, w, 0);        return result;    }    private void backTracking(int[] value, int[] weight, int w, int startIndex) {        if (startIndex &gt; value.length - 1 || w &lt; 0) {            return;        }        for (int i = startIndex; i &lt; value.length; i++) {            cur += value[i];            w -= weight[i];                        result = Math.max(result, cur);            backTracking(value, weight, w, i + 1);            cur -= value[i];            w += weight[i];        }    }}</code></pre><h1 id="3-äºŒç»´dpæ•°ç»„01èƒŒåŒ…"><a href="#3-äºŒç»´dpæ•°ç»„01èƒŒåŒ…" class="headerlink" title="3. äºŒç»´dpæ•°ç»„01èƒŒåŒ…"></a>3. äºŒç»´dpæ•°ç»„01èƒŒåŒ…</h1><p>å› ä¸ºæ¯ä¸€æ­¥éƒ½æ˜¯ä¾æ‰˜äºä¸Šä¸€æ­¥ä½ çš„ç‰©å“çš„å–æ”¾çš„é€‰æ‹©çš„ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨dpæ¥åšçš„ç±»å‹é¢˜ç›®~ </p><p>æˆ‘ä»¬éœ€è¦åšä»¥ä¸‹å‡ æ­¥æ¥æ€è€ƒæ•´ä¸ªé€»è¾‘</p><h2 id="3-1-ç¡®å®šdpæ•°ç»„å’Œä¸‹æ ‡çš„å«ä¹‰"><a href="#3-1-ç¡®å®šdpæ•°ç»„å’Œä¸‹æ ‡çš„å«ä¹‰" class="headerlink" title="3.1 ç¡®å®šdpæ•°ç»„å’Œä¸‹æ ‡çš„å«ä¹‰"></a>3.1 ç¡®å®šdpæ•°ç»„å’Œä¸‹æ ‡çš„å«ä¹‰</h2><ul><li>åœ¨äºŒç»´æ•°ç»„é‡Œé¢ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨dp[i][j] è¡¨ç¤ºæˆ‘åœ¨åšäº†å¯¹äºå‰iä¸ªäº§å“çš„é€‰æ‹©ï¼Œåœ¨å®¹é‡ä¸ºjçš„æ—¶å€™èƒ½å¤Ÿè·å¾—çš„æœ€å¤§çš„ä»·å€¼</li><li>åœ¨è¿™ä¸ªå®šä¹‰ä¸‹ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘éœ€è¦çš„å€¼å°±æ˜¯dp[n][W], è¿™å°±æ˜¯æˆ‘åœ¨åšäº†nä¸ªå…³äºè¿™äº›äº§å“çš„é€‰å–æ”¾å¼ƒçš„å†³å®šï¼Œåœ¨æ»¡è¶³é‡é‡ä¸è¶…è¿‡Wçš„é™å®šæ¡ä»¶ä¸‹èƒ½å–å¾—çš„æœ€å¤§ä»·å€¼äº†</li></ul><h2 id="3-2-ç¡®å®šé€’æ¨å…¬å¼"><a href="#3-2-ç¡®å®šé€’æ¨å…¬å¼" class="headerlink" title="3.2 ç¡®å®šé€’æ¨å…¬å¼"></a>3.2 ç¡®å®šé€’æ¨å…¬å¼</h2><pre><code class="jsx">// ä¸é€‰iè¿™ä»¶äº§å“ï¼Œå®¹é‡ä¸ºjçš„å€¼; è¿˜æœ‰é€‰äº†iè¿™ä»¶äº§å“ï¼Œé‚£ä¹ˆi-1ä»¶äº§å“çš„æ€»é‡é‡éœ€è¦æ»¡è¶³ j - weight[i], è¿™ä¸ªæ—¶å€™å†åŠ ä¸Šiè¿™ä»¶äº§å“çš„ä»·å€¼ï¼Œ  è¿™ä¸¤ä¸ªdpæ•°ç»„ä½ç½®çš„æœ€å¤§å€¼å°±æ˜¯dp[i][j]éœ€è¦å–çš„å€¼äº†dp[i][j] = Math.max(dp[i-1][j], dp[i-1][j - weight[i]] + value[i])</code></pre><h2 id="3-3-å¦‚ä½•åˆå§‹åŒ–è¿™ä¸ªæ•°ç»„"><a href="#3-3-å¦‚ä½•åˆå§‹åŒ–è¿™ä¸ªæ•°ç»„" class="headerlink" title="3.3 å¦‚ä½•åˆå§‹åŒ–è¿™ä¸ªæ•°ç»„"></a>3.3 å¦‚ä½•åˆå§‹åŒ–è¿™ä¸ªæ•°ç»„</h2><ul><li>å¯¹äºç¬¬ä¸€åˆ—  j = 0 æ„å‘³ç€ç°åœ¨èƒŒåŒ…å…è®¸çš„é‡é‡ä¸º0ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯å“ªä¸ªäº§å“ï¼Œæœ‰çš„ä»·å€¼éƒ½ä¸º0</li><li>å¯¹äºç¬¬ä¸€è¡Œ i = 0, æ­¤æ—¶æˆ‘ä»¬åªèƒ½é€‰æ‹©ç‰©å“0ï¼Œè€Œä¸”é¢˜ç›®ä¸­è¯´äº†åªèƒ½æœ€å¤šæ‹¿ä¸€ä»¶äº§å“ï¼Œæ‰€ä»¥å¯ä»¥å°†è¿™ä¸€è¡Œéƒ½å£°æ˜ä¸ºweight[0]</li></ul><h2 id="3-4-ç¡®å®šéå†é¡ºåº"><a href="#3-4-ç¡®å®šéå†é¡ºåº" class="headerlink" title="3.4 ç¡®å®šéå†é¡ºåº"></a>3.4 ç¡®å®šéå†é¡ºåº</h2><p>å…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…é‡é‡  å…¶å®å‡å¯</p><pre><code class="jsx">// weightæ•°ç»„çš„å¤§å° å°±æ˜¯ç‰©å“ä¸ªæ•°for(int i = 1; i &lt; weight.size(); i++) { // éå†ç‰©å“    for(int j = 0; j &lt;= bagWeight; j++) { // éå†èƒŒåŒ…å®¹é‡        if (j &lt; weight[i]) dp[i][j] = dp[i - 1][j]; // è¿™ä¸ªæ˜¯ä¸ºäº†å±•ç°dpæ•°ç»„é‡Œå…ƒç´ çš„å˜åŒ–        else dp[i][j] = max(dp[i - 1][j], dp[i - 1][j - weight[i]] + value[i]);    }}</code></pre><h2 id="3-5-ä»£ç "><a href="#3-5-ä»£ç " class="headerlink" title="3.5 ä»£ç "></a>3.5 ä»£ç </h2><pre><code class="jsx">public int WeightBagProblem(int[] weight, int[] value, int bagSize){        int wLen = weight.length, value0 = 0;        //å®šä¹‰dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œå‰iä¸ªç‰©å“èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼        int[][] dp = new int[wLen + 1][bagSize + 1];        //åˆå§‹åŒ–ï¼šèƒŒåŒ…å®¹é‡ä¸º0æ—¶ï¼Œèƒ½è·å¾—çš„ä»·å€¼éƒ½ä¸º0        for (int i = 0; i &lt;= wLen; i++){            dp[i][0] = value0;        }        //éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…å®¹é‡        for (int i = 1; i &lt;= wLen; i++){            for (int j = 1; j &lt;= bagSize; j++){                if (j &lt; weight[i - 1]){                    dp[i][j] = dp[i - 1][j];                }else{                    dp[i][j] = Math.max(dp[i - 1][j], dp[i - 1][j - weight[i - 1]] + value[i - 1]);                }            }        }                return dp[wLen][bagSize];    }</code></pre><h1 id="4-æ•°ç»„é™ç»´-â€”-åˆ©ç”¨æ»šåŠ¨æ•°ç»„è§£å†³01èƒŒåŒ…é—®é¢˜"><a href="#4-æ•°ç»„é™ç»´-â€”-åˆ©ç”¨æ»šåŠ¨æ•°ç»„è§£å†³01èƒŒåŒ…é—®é¢˜" class="headerlink" title="4. æ•°ç»„é™ç»´ â€” åˆ©ç”¨æ»šåŠ¨æ•°ç»„è§£å†³01èƒŒåŒ…é—®é¢˜"></a>4. æ•°ç»„é™ç»´ â€” åˆ©ç”¨æ»šåŠ¨æ•°ç»„è§£å†³01èƒŒåŒ…é—®é¢˜</h1><ul><li>åœ¨ç¬¬ä¸‰éƒ¨åˆ†å½“ä¸­ï¼Œæˆ‘ä»¬çš„é€’å½’å…¬å¼æ¨å¯¼å‡ºæ¥æ˜¯ï¼š</li></ul><pre><code class="jsx">dp[i][j] = max(dp[i-1][j], dp[i-1][j-weight[i]] + value[i])</code></pre><ul><li>å¦‚æœåœ¨è¿™é‡Œ æˆ‘ä»¬å°†dp[i-1][]é‚£ä¸€å±‚çš„ä¸œè¥¿æ‹·è´åˆ°dp[i]è¿™ä¸€å±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„</li></ul><h2 id="4-1-ç¡®å®šdpæ•°ç»„çš„å®šä¹‰"><a href="#4-1-ç¡®å®šdpæ•°ç»„çš„å®šä¹‰" class="headerlink" title="4.1 ç¡®å®šdpæ•°ç»„çš„å®šä¹‰"></a>4.1 ç¡®å®šdpæ•°ç»„çš„å®šä¹‰</h2><p>åœ¨ä¸€ç»´dpæ•°ç»„å½“ä¸­, dp[j]è¡¨ç¤ºå®¹é‡ä¸ºjçš„èƒŒåŒ…æ‰€èƒŒçš„ç‰©å“ä»·å€¼å¯ä»¥æœ€å¤§ä¸ºdp[j] </p><h2 id="4-2-ä¸€ç»´æ•°ç»„é€’æ¨å…¬å¼"><a href="#4-2-ä¸€ç»´æ•°ç»„é€’æ¨å…¬å¼" class="headerlink" title="4.2 ä¸€ç»´æ•°ç»„é€’æ¨å…¬å¼"></a>4.2 ä¸€ç»´æ•°ç»„é€’æ¨å…¬å¼</h2><pre><code class="jsx">dp[j] = max(dp[j], dp[j-weight[i]] + value[i])</code></pre><h2 id="4-3-ä¸€ç»´æ•°ç»„åˆå§‹åŒ–"><a href="#4-3-ä¸€ç»´æ•°ç»„åˆå§‹åŒ–" class="headerlink" title="4.3 ä¸€ç»´æ•°ç»„åˆå§‹åŒ–"></a>4.3 ä¸€ç»´æ•°ç»„åˆå§‹åŒ–</h2><ul><li>é¦–å…ˆç¡®å®šèƒŒåŒ…å®¹é‡ä¸º0æ‰€èƒŒçš„ç‰©å“çš„æœ€å¤§ä»·å€¼ä¹Ÿä¸º0</li><li>å‡è®¾æ‰€æœ‰äº§å“ä»·å€¼éè´Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸ç”¨åˆå§‹åŒ–æ•°ç»„å…¶ä»–ä½ç½®çš„å€¼ä¸ºè´Ÿæ— ç©·äº†ï¼Œä¿æŒä¸º0å³å¯</li></ul><h2 id="4-4-ä¸€ç»´æ•°ç»„éå†é¡ºåº"><a href="#4-4-ä¸€ç»´æ•°ç»„éå†é¡ºåº" class="headerlink" title="4.4 ä¸€ç»´æ•°ç»„éå†é¡ºåº"></a>4.4 ä¸€ç»´æ•°ç»„éå†é¡ºåº</h2><pre><code class="jsx">or(int i = 0; i &lt; weight.size(); i++) { // éå†ç‰©å“    for(int j = bagWeight; j &gt;= weight[i]; j--) { // éå†èƒŒåŒ…å®¹é‡        dp[j] = max(dp[j], dp[j - weight[i]] + value[i]);    }}</code></pre><ul><li>ä¸èƒ½æ­£åºéå†ï¼Œå› ä¸ºæ­£åºçš„è¯ç‰©å“ä¼šè¢«é‡å¤åŠ å…¥å¾ˆå¤šæ¬¡<ul><li>å› ä¸ºåœ¨éå†åä¸€ä¸ªçš„æ—¶å€™å®é™…ä¸Šå·²ç»ç”¨äº†å‰ä¸€ä¸ªçš„ç»“æœ</li><li>è­¬å¦‚<ul><li>dp[1] = dp[1 - weight[0]] + value[0]</li><li>dp[2] = dp[2 - weight[0]] + value[0]</li><li>dp[2] ä¼šç”¨åˆ°dp[1] (å½“weight[0] = 1çš„æ—¶å€™)  è¿™ä¸ªæ—¶å€™ç›¸å½“äºæˆ‘ä»¬æŠŠ0å·äº§å“ç”¨äº†ä¸¤æ¬¡äº† è¿™æ˜¯ä¸èƒ½å¤Ÿçš„</li></ul></li></ul></li></ul><pre><code class="jsx">public static void main(String[] args) {        int[] weight = {1, 3, 4};        int[] value = {15, 20, 30};        int bagWight = 4;        testWeightBagProblem(weight, value, bagWight);    }    public static void testWeightBagProblem(int[] weight, int[] value, int bagWeight){        int wLen = weight.length;        //å®šä¹‰dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œèƒ½è·å¾—çš„æœ€å¤§ä»·å€¼        int[] dp = new int[bagWeight + 1];        //éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…å®¹é‡        for (int i = 0; i &lt; wLen; i++){            for (int j = bagWeight; j &gt;= weight[i]; j--){                dp[j] = Math.max(dp[j], dp[j - weight[i]] + value[i]);            }        }        //æ‰“å°dpæ•°ç»„        for (int j = 0; j &lt;= bagWeight; j++){            System.out.print(dp[j] + &quot; &quot;);        }    }</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 01èƒŒåŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†</title>
      <link href="/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"/>
      <url>/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†"><a href="#Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†" class="headerlink" title="Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†"></a>Javaè™šæ‹ŸæœºåŸºæœ¬åŸç†</h1><h1 id="1-Java-ä»£ç è¿è¡Œæ–¹å¼"><a href="#1-Java-ä»£ç è¿è¡Œæ–¹å¼" class="headerlink" title="1. Java ä»£ç è¿è¡Œæ–¹å¼"></a>1. Java ä»£ç è¿è¡Œæ–¹å¼</h1><h2 id="1-1-ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº"><a href="#1-1-ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº"></a>1.1 ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿæœº</h2><ul><li>è®¾è®¡ä¸€ä¸ªé¢å‘Javaè¯­è¨€ç‰¹æ€§çš„è™šæ‹Ÿæœº<ul><li>åšè¿™ä¸ªçš„åŸå› æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§æœºå™¨ä¸Šæ¥å®ç°å¯¹Javaçš„æ”¯æŒ</li><li>é€šè¿‡ç¼–è¯‘å™¨å°†Javaç¨‹åºè½¬æ¢æˆè¯¥è™šæ‹Ÿæœºæ‰€èƒ½è¯†åˆ«çš„æŒ‡ä»¤åºåˆ—ï¼Œåˆè¢«ç§°ä¸ºJavaå­—èŠ‚ç <ul><li>å«åšJavaå­—èŠ‚ç çš„åŸå› æ˜¯å­—èŠ‚ç æŒ‡ä»¤çš„æ“ä½œç opcodeè¢«å®šä¹‰æˆäº†ä¸€ä¸ªå­—èŠ‚</li></ul></li></ul></li><li>Javaçš„è™šæ‹Ÿæœºæ˜¯å¯ä»¥ç”±ç¡¬ä»¶å®ç°çš„ï¼Œä¹Ÿå¯ä»¥åœ¨å„ä¸ªå¹³å°ä¸Š(Windows/ Linux) æä¾›è½¯ä»¶çš„å®ç°<ul><li>å¥½å¤„1ï¼š ä¸€æ—¦ä¸€ä¸ªç¨‹åºè¢«è½¬æ¢æˆäº†Javaå­—èŠ‚ç ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥åœ¨ä¸åŒå¹³å°ä¸Šçš„è™šæ‹Ÿæœºé‡Œæ¥è¿è¡Œ</li><li>å¥½å¤„2ï¼š å¸¦æ¥äº†æ‰˜ç®¡ç¯å¢ƒï¼Œè¿™ä¸ªæ‰˜ç®¡ç¯å¢ƒèƒ½å¤Ÿä»£æ›¿æˆ‘ä»¬å¤„ç†ä¸€äº›ä»£ç å½“ä¸­å†—é•¿è€Œä¸”å®¹æ˜“å‡ºé”™çš„éƒ¨åˆ†<ul><li>è‡ªåŠ¨å†…å­˜ç®¡ç†</li><li>åƒåœ¾å›æ”¶</li><li>è¯¸å¦‚æ•°ç»„è¶Šç•Œï¼ŒåŠ¨æ€ç±»å‹ï¼Œå®‰å…¨æƒé™ç­‰ç­‰çš„åŠ¨æ€æ£€æµ‹åŠŸèƒ½</li></ul></li></ul></li></ul><h2 id="1-2-å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ"><a href="#1-2-å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ" class="headerlink" title="1.2 å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ"></a>1.2 å¦‚ä½•è¿è¡ŒJavaå­—èŠ‚ç çš„ï¼Ÿ</h2><ul><li><p>ä»è™šæ‹Ÿæœºè§†è§’æ¥çœ‹</p><ul><li><p>é¦–å…ˆå°†å…¶ç¼–è¯‘æˆçš„classæ–‡ä»¶åŠ è½½åˆ°Javaè™šæ‹Ÿæœºå½“ä¸­</p></li><li><p>åŠ è½½åçš„Javaç±»ä¼šè¢«å­˜æ”¾äºæ–¹æ³•åŒºé‡Œ Method Area</p></li><li><p>å®é™…æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œæ–¹æ³•åŒºçš„ä»£ç </p></li><li><p>ç©ºé—´åˆ†é…</p><ul><li><p>çº¿ç¨‹å…±äº«çš„</p><ul><li><p>æ–¹æ³•åŒº</p><ul><li>ç”¨æ¥å­˜æ”¾ç±»ä¼¼äºå…ƒæ•°æ®ä¿¡æ¯æ–¹é¢çš„æ•°æ®<ul><li>ç±»ä¿¡æ¯</li><li>å¸¸é‡</li><li>é™æ€å˜é‡</li><li>ç¼–è¯‘åä»£ç </li></ul></li><li>JDK 1.8ä¹‹åï¼Œä¸å†æœ‰æ–¹æ³•åŒºäº†ï¼Œå…ƒæ•°æ®ä¼šæ”¾åˆ°æœ¬åœ°å†…å­˜çš„Metaspace å³å…ƒç©ºé—´é‡Œé¢<ul><li>ä½¿ç”¨Metaspaceçš„ä¼˜åŠ¿<ul><li>å…ƒç©ºé—´å¤§å°é»˜è®¤ä¸ºUnlimited å³åªå—åˆ°ç³»ç»Ÿå†…å­˜çš„é™åˆ¶</li><li>å› ä¸ºå…ƒæ•°æ®å¤§å°ä¸å†ç”±MaxPermSizeæ§åˆ¶ï¼Œè€Œç”±å®é™…çš„å¯ç”¨ç©ºé—´æ§åˆ¶ï¼Œè¿™æ ·èƒ½åŠ è½½çš„ç±»å°±æ›´å¤šäº†</li></ul></li></ul></li></ul></li><li><p>å †</p><ul><li><p>æ”¾ç½®å¯¹è±¡å®ä¾‹ï¼Œæ•°ç»„ç­‰</p></li><li><p>å’Œæ–¹æ³•åŒºåŒå±äºçº¿ç¨‹å…±äº«åŒºåŸŸï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</p></li><li><p>å †å†…å­˜çš„åˆ’åˆ†</p><ul><li>å¹´è½»ä»£<ul><li>Eden 8<ul><li>å½“æˆ‘ä»¬newä¸€ä¸ªå¯¹è±¡ä»¥åï¼Œä¼šæ”¾åˆ°Edenåˆ’åˆ†å‡ºæ¥çš„ä¸€å—ä½œä¸ºå­˜å‚¨ç©ºé—´çš„å†…å­˜å½“ä¸­</li><li>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šé¢„å…ˆç”³è¯·ä¸€å—è¿ç»­ç©ºé—´çš„å†…å­˜ç©ºé—´å¹¶ä¸”è§„å®šäº†å¯¹è±¡å­˜æ”¾çš„ä½ç½®ï¼Œå¦‚æœç©ºé—´ä¸è¶³å°±å†å¤šç”³è¯·å†…å­˜ç©ºé—´</li></ul></li><li>Survivor<ul><li>FromPlace 1</li><li>ToPlace 1</li></ul></li></ul></li><li>è€å¹´ä»£</li></ul></li><li><p>GCçš„è¿è¡Œé€»è¾‘</p><ul><li><p>Edenç©ºé—´æ»¡äº†ä»¥åï¼Œä¼šè§¦å‘Minor GC</p></li><li><p>å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ç§»åŠ¨åˆ°Survivor 0åŒº</p></li><li><p>Survivor 0åŒºæ»¡åè§¦å‘Minor GCï¼Œå°†å­˜æ´»å¯¹è±¡ç§»åŠ¨åˆ°Survivor 1åŒºï¼Œæ­¤æ—¶è¿˜ä¼šå°†fromå’ŒtoæŒ‡é’ˆäº¤æ¢ï¼Œä¿è¯äº†ä¸€æ®µæ—¶é—´å†…æ€»æœ‰ä¸€ä¸ªsurvivoråŒºä¸ºç©ºï¼Œä¸”toæ‰€æŒ‡å‘çš„survivoråŒºä¸ºç©º</p></li><li><p>ç»è¿‡å¤šæ¬¡Minor GCä»å­˜æ´»çš„å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ï¼Œä¸€èˆ¬æ˜¯15æ¬¡ï¼Œå› ä¸ºHotpotç»™è®°å½•å¹´é¾„åˆ†é…åˆ°çš„ç©ºé—´åªæœ‰4ä½</p></li><li><p>è€å¹´ä»£ç”¨æ¥å­˜å‚¨é•¿æœŸå­˜æ´»çš„å¯¹è±¡ï¼Œå æ»¡äº†å°±ä¼šè§¦å‘Full GCï¼ŒæœŸé—´ä¼šåœæ­¢æ‰€æœ‰çº¿ç¨‹ç­‰å¾…GCçš„å®Œæˆ â€”â†’ éœ€è¦å°½é‡é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿ</p></li><li><p>å½“è€å¹´åŒºæ‰§è¡Œäº†full GC è¿˜æ˜¯æ— æ³•å¯¹å¯¹è±¡ä¿å­˜ï¼Œå°±ä¼šäº§ç”ŸOOMï¼Œ è¿™æ„å‘³ç€è™šæ‹Ÿæœºä¸­çš„å †å†…å­˜ä¸è¶³</p><ul><li>å¯èƒ½åŸå› <ul><li>è®¾ç½®çš„å †å†…å­˜è¿‡å°</li><li>ä»£ç ä¸­åˆ›å»ºçš„å¯¹è±¡å¤§ä¸”å¤šï¼Œä¸€ç›´è¢«å¼•ç”¨å¯¼è‡´GCæ— æ³•æ”¶é›†ä»–ä»¬</li></ul></li></ul><p><img src="https://i.loli.net/2021/06/28/q7NYfmdDapVOBU9.png" alt="GCè¿è¡Œé€»è¾‘"></p></li></ul></li></ul></li></ul></li><li><p>çº¿ç¨‹ç§æœ‰</p><ul><li>ç¨‹åºè®¡æ•°å™¨<ul><li>å®ŒæˆåŠ è½½å·¥ä½œ</li><li>æœ¬èº«æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç¨‹åºå½“ä¸­ä¸‹ä¸€å¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤<ul><li>åˆ†æ”¯ï¼Œå¾ªç¯ï¼Œè·³è½¬ï¼Œå¼‚å¸¸å¤„ç†ï¼Œçº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½ä¾èµ–äºè¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆ</li></ul></li><li>å ç”¨ç©ºé—´éå¸¸éå¸¸å°</li><li>è¿™ä¸ªå†…å­˜ä»…ä»…ä»£è¡¨äº†å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨</li><li>å­—èŠ‚ç è§£æå™¨é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤</li></ul></li><li>VM æ ˆ<ul><li>å½“è°ƒç”¨ä¸€ä¸ªJavaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šåœ¨å½“å‰çº¿ç¨‹ç”Ÿæˆä¸€ä¸ªæ ˆå¸§ï¼Œç”¨æ¥å­˜æ”¾å±€éƒ¨å˜é‡ä»¥åŠå­—èŠ‚ç çš„æ“ä½œæ•°</li><li>æ ˆå¸§å¤§å°æ˜¯å·²ç»è®¡ç®—å¥½äº†çš„ï¼Œæ ˆå¸§ä¸éœ€è¦è¿ç»­åˆ†å¸ƒ</li><li>æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹<ul><li>å¯¹å±€éƒ¨å˜é‡ï¼ŒåŠ¨æ€é“¾è¡¨ï¼Œæ–¹æ³•å‡ºå£ï¼Œæ ˆçš„æ“ä½œï¼Œå¯¹è±¡å¼•ç”¨è¿›è¡Œå­˜å‚¨ï¼Œå¹¶ä¸”çº¿ç¨‹ç‹¬äº«</li></ul></li><li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆçš„æ·±åº¦å¤§äºè™šæ‹Ÿæœºæ ˆçš„æœ€å¤§æ·±åº¦ï¼Œå°±ä¼šæŠ¥StackOverflowError</li><li>JVMæ˜¯å¯ä»¥åŠ¨æ€æ‰©å±•çš„ï¼Œä½†éšç€æ‰©å±•ä¼šä¸æ–­ç”³è¯·å†…å­˜ï¼Œå½“æ— æ³•ç”³è¯·è¶³å¤Ÿå†…å­˜çš„æ—¶å€™å°±ä¼šæŠ¥OutOfMemoryError</li><li>æ ˆå¹¶ä¸å­˜åœ¨åƒåœ¾å›æ”¶ï¼Œå› ä¸ºåªè¦ç¨‹åºè¿è¡Œç»“æŸï¼Œæ ˆçš„ç©ºé—´è‡ªç„¶ä¼šé‡Šæ”¾çš„ã€‚â€” æ ˆçš„ç”Ÿå‘½å‘¨æœŸå’Œæ‰€å¤„çš„çº¿ç¨‹æ˜¯ä¸€è‡´çš„</li></ul></li><li>æœ¬åœ°æ–¹æ³•æ ˆ<ul><li>ç”±nativeä¿®é¥°çš„æ–¹æ³•</li><li>å’Œè™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼š è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡</li></ul></li></ul></li><li><p>ç›´æ¥å†…å­˜</p><ul><li>ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯è™šæ‹Ÿæœºå®šä¹‰çš„å†…å­˜åŒºåŸŸ</li><li>æ˜¯é€šè¿‡åŸºäºé€šé“å’Œç¼“å­˜åŒºçš„NIOï¼Œç›´æ¥ä½¿ç”¨Nativeå‡½æ•°åº“æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †å½“ä¸­çš„DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨ï¼Œè¿›è€Œè¿›è¡Œæ“ä½œ</li></ul></li></ul></li></ul></li><li><p>ä»ç¡¬ä»¶è§†è§’æ¥çœ‹</p><ul><li>éœ€è¦è™šæ‹Ÿæœºå°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç </li><li>ç¿»è¯‘æ–¹å¼<ul><li>è§£é‡Šæ‰§è¡Œ<ul><li>é€æ¡å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç å¹¶ä¸”æ‰§è¡Œ</li><li>ä¼˜åŠ¿<ul><li>æ— éœ€ç­‰å¾…ç¼–è¯‘</li></ul></li></ul></li><li>å³æ—¶ç¼–è¯‘ Just In Time Compilation<ul><li>å°†ä¸€ä¸ªæ–¹æ³•ä¸­åŒ…å«çš„æ‰€æœ‰å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ä»¥åå†æ‰§è¡Œ</li><li>ä¼˜åŠ¿<ul><li>å®é™…æ‰§è¡Œé€Ÿåº¦ä¼šæ›´å¿«</li></ul></li></ul></li></ul></li><li>hotpotçš„ç¿»è¯‘æ–¹å¼<ul><li>å…ˆè§£é‡Šæ‰§è¡Œå­—èŠ‚ç </li><li>è€Œåå°†åå¤æ‰§è¡Œçš„çƒ­ç‚¹ä»£ç æŒ‰ç…§æ–¹æ³•æ¥ä½œä¸ºåŸºæœ¬å•å…ƒè¿›è¡ŒJIT å³æ—¶ç¼–è¯‘</li></ul></li></ul></li><li><p>èµ°ä¸€ä¸ªä»£ç ä¾‹å­</p></li></ul><pre><code class="jsx">@RequireAllArgConstructorpublic class People {    public String name;    public void sayName() {        System.out.println(&quot;People&#39;s name is: &quot; + name);    }}public class App {    public static void main(String[] args) {        People people = new People(&quot;test&quot;);        people.sayName();    }}</code></pre><ul><li>æ‰§è¡Œmainæ–¹æ³•çš„æ­¥éª¤å¦‚ä¸‹<ul><li>ç¼–è¯‘å¥½App.javaä¹‹åå¾—åˆ°App.classï¼Œæ‰§è¡ŒApp.class</li><li>ç³»ç»Ÿä¼šå¯åŠ¨ä¸€ä¸ªJVMè¿›ç¨‹</li><li>ä»classpathè·¯å¾„å½“ä¸­æ‰¾åˆ°ä¸€ä¸ªåä¸ºApp.classçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†Appçš„ç±»ä¿¡æ¯åŠ è½½åˆ°è¿è¡Œæ—¶æ•°æ®åŒºçš„æ–¹æ³•åŒºå†…</li><li>JVMæ‰¾åˆ°Appä¸»ç¨‹åºå…¥å£ï¼Œæ‰§è¡Œmainæ–¹æ³•</li><li>å½“è¦æ‰§è¡Œnew Peopleçš„æ—¶å€™ï¼Œå‘ç°æ–¹æ³•åŒºå½“ä¸­è¿˜æ²¡æœ‰Peopleç±»çš„ä¿¡æ¯ï¼Œæ‰€ä»¥JVMé©¬ä¸ŠåŠ è½½ï¼Œå¹¶å°†å…¶ç±»çš„ä¿¡æ¯æ”¾åˆ°æ–¹æ³•åŒºé‡Œé¢</li><li>JVMåœ¨å †å½“ä¸­ä¸ºä¸€ä¸ªæ–°çš„Peopleå®ä¾‹åˆ†é…å†…å­˜ï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–Peopleå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æŒæœ‰æŒ‡å‘æ–¹æ³•åŒºä¸­çš„Peopleç±»çš„ç±»å‹ä¿¡æ¯çš„å¼•ç”¨</li><li>æ‰§è¡Œpeople.sayName();æ—¶ï¼ŒJVM æ ¹æ® people çš„å¼•ç”¨æ‰¾åˆ° people å¯¹è±¡ï¼Œç„¶åæ ¹æ® people å¯¹è±¡æŒæœ‰çš„å¼•ç”¨å®šä½åˆ°æ–¹æ³•åŒºä¸­ people ç±»çš„ç±»å‹ä¿¡æ¯çš„æ–¹æ³•è¡¨ï¼Œè·å¾— sayName() çš„å­—èŠ‚ç åœ°å€</li><li>æ‰§è¡ŒsayName()</li></ul></li></ul><h2 id="1-3-Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡"><a href="#1-3-Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡" class="headerlink" title="1.3 Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡"></a>1.3 Javaè™šæ‹Ÿæœºæ‰§è¡Œæ•ˆç‡</h2><ul><li>ä¼˜åŒ–æ–¹å¼<ul><li>å³æ—¶ç¼–è¯‘<ul><li>åº•å±‚é€»è¾‘ â€” äºŒå…«å®šå¾‹<ul><li>è®¤ä¸º20%ä»£ç ä¼šå æ®80%çš„è®¡ç®—èµ„æº</li></ul></li><li>ç¼–è¯‘å™¨ç±»åˆ« â€” tradeoff ç¼–è¯‘æ—¶é—´ vs æ‰§è¡Œæ•ˆç‡<ul><li>C1<ul><li>Clientç¼–è¯‘å™¨</li><li>é¢å‘å¯¹å¯åŠ¨æ€§èƒ½æœ‰è¦æ±‚çš„å®¢æˆ·ç«¯GUIç¨‹åº</li></ul></li><li>C2<ul><li>Serverç¼–è¯‘å™¨</li><li>é¢å‘å¯¹å³°å€¼æ€§èƒ½æœ‰è¦æ±‚çš„æœåŠ¡å™¨ç«¯ç¨‹åº</li><li>é‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹å¤æ‚ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½†åŒæ—¶ç”Ÿæˆä»£ç çš„æ•ˆç‡æ¯”è¾ƒé«˜</li></ul></li><li>Graal</li></ul></li></ul></li></ul></li><li>Hotpotå¯¹äºå„ç§ç¼–è¯‘å™¨çš„é‡‡ç”¨æ–¹å¼<ul><li>åˆ†å±‚ç¼–è¯‘<ul><li>çƒ­ç‚¹æ–¹æ³•å…ˆè¢«C1 ç¼–è¯‘</li><li>çƒ­ç‚¹æ–¹æ³•é‡Œçš„çƒ­ç‚¹ä¼šè¿›ä¸€æ­¥è¢«C2 ç¼–è¯‘å™¨ç¼–è¯‘</li></ul></li><li>ä¼šå½±å“åº”ç”¨çš„æ­£å¸¸è¿›è¡Œä¹ˆï¼Ÿ<ul><li>å³æ—¶ç¼–è¯‘æ˜¯åœ¨é¢å¤–çš„ç¼–è¯‘çº¿ç¨‹å½“ä¸­è¿›è¡Œçš„</li><li>ä¼šæ ¹æ®CPUçš„æ•°é‡è®¾ç½®ç¼–è¯‘çº¿ç¨‹çš„æ•°ç›®ï¼Œå¹¶ä¸”æŒ‰ç…§1:2çš„æ¯”ä¾‹é…ç½®ç»™C1 åŠC2 ç¼–è¯‘å™¨</li></ul></li></ul></li></ul><h1 id="2-åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°"><a href="#2-åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°" class="headerlink" title="2. åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°"></a>2. åŸºæœ¬ç±»å‹åœ¨è™šæ‹Ÿæœºå½“ä¸­çš„å®ç°</h1><ul><li><p>ä¸ºä»€ä¹ˆè¦å¼•å…¥åŸºæœ¬ç±»å‹è€Œä¸æ˜¯å…¨éƒ½ä½¿ç”¨å¯¹è±¡å‘¢ï¼Ÿ</p><ul><li>åŸºæœ¬ç±»å‹æ›´é è¿‘åº•å±‚ï¼Œåœ¨æ‰§è¡Œæ•ˆç‡å’Œå†…å­˜ä½¿ç”¨æ–¹é¢éƒ½èƒ½å¤Ÿæå‡è½¯ä»¶çš„æ€§èƒ½</li></ul></li><li><p>boolean ç±»å‹</p><ul><li>æ˜ å°„æˆintç±»å‹<ul><li>trueè¢«æ˜ å°„ä¸ºæ•´æ•°1</li><li>falseè¢«æ˜ å°„ä¸ºæ•´æ•°0<br><img src="https://i.loli.net/2021/06/28/k6pXaMj4rUJOFoH.png" alt="åŸºæœ¬ç±»å‹"></li></ul></li></ul></li><li><p>Javaè™šæ‹Ÿæœºåœ¨è°ƒç”¨Javaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ ˆå¸§ï¼Œå¯¹äºå…¶ä¸­çš„è§£é‡Šæ ˆå¸§æ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†</p><ul><li>å±€éƒ¨å˜é‡åŒº<ul><li>å±€éƒ¨å˜é‡</li><li>thisæŒ‡é’ˆ</li><li>æ–¹æ³•æ¥æ”¶çš„å‚æ•°</li><li>å„ä¸ªåŸºæœ¬ç±»å‹åœ¨å±€éƒ¨å˜é‡åŒºçš„è¡¨ç°<ul><li>å±€éƒ¨å˜é‡åŒºç­‰ä»·äºä¸€ä¸ªæ•°ç»„<ul><li>long doubleéœ€è¦ä¸¤ä¸ªæ•°ç»„å•å…ƒå­˜å‚¨</li><li>å…¶ä»–åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å€¼å‡å ç”¨ä¸€ä¸ªæ•°ç»„å•å…ƒ</li></ul></li></ul></li></ul></li><li>å­—èŠ‚ç çš„æ“ä½œæ•°æ ˆ</li></ul></li><li><p>å­˜å‚¨æ“ä½œ</p><ul><li>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªintç±»å‹çš„å€¼æ”¾åˆ°char short ç­‰é‡Œé¢ï¼Œç›¸å½“äºåšäº†ä¸€æ¬¡æ©ç   åªä¼šä¿ç•™ä½ä½äº†</li></ul></li><li><p>åŠ è½½</p><ul><li>ç®—æ•°è¿ç®—å®Œå…¨ä¾èµ–äºæ“ä½œæ•°æ ˆ</li><li>å †å½“ä¸­çš„boolean, byte, char, short åŠ è½½åˆ°æ“ä½œæ•°æ ˆå½“ä¸­ï¼Œè€Œåå°†æ ˆä¸Šçš„å€¼å½“æˆintç±»å‹æ¥è¿ç®—</li></ul></li></ul><h1 id="3-ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹"><a href="#3-ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="3. ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹"></a>3. ç±»çš„åŠ è½½ï¼Œé“¾æ¥ï¼Œåˆå§‹åŒ–è¿‡ç¨‹</h1><ul><li>é¦–å…ˆ.javaæ–‡ä»¶ä¼šè¢«ç¼–è¯‘æˆ.classæ–‡ä»¶ï¼Œè€Œåæˆ‘ä»¬éœ€è¦ç±»åŠ è½½å™¨æ¥å¤„ç†.classæ–‡ä»¶ï¼Œè®©JVMå¯¹å…¶è¿›è¡Œå¤„ç†</li><li>ä»classæ–‡ä»¶åˆ°å†…å­˜å½“ä¸­çš„ç±»ï¼Œéœ€è¦ç»è¿‡ï¼š<ul><li>åŠ è½½<ul><li>æŸ¥æ‰¾å­—èŠ‚æµï¼Œå¹¶ä¸”æ ¹æ®æ­¤æ¥åˆ›å»ºç±»çš„è¿‡ç¨‹<ul><li>å°†classç±»åŠ è½½åˆ°å†…å­˜å½“ä¸­</li><li>å°†é™æ€æ•°æ®ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºå½“ä¸­è¿è¡Œæ—¶çš„æ•°æ®ç»“æ„</li><li>åœ¨å †å½“ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.classå¯¹è±¡ä½œä¸ºæ•°æ®è®¿é—®çš„å…¥å£</li></ul></li><li>å€ŸåŠ©ç±»åŠ è½½å™¨æ¥å®ŒæˆæŸ¥æ‰¾å­—èŠ‚æµçš„è¿‡ç¨‹<ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ â€” bootstrap class loader<ul><li>è´Ÿè´£åŠ è½½æœ€åŸºç¡€æœ€é‡è¦çš„ç±»ï¼Œè­¬å¦‚JRE libç›®å½•ä¸‹JaråŒ…ä¸­çš„ç±»</li><li>ç”±è™šæ‹Ÿæœºå‚æ•° -XbootclasspathæŒ‡å®šçš„ç±»</li></ul></li><li>å…¶ä»–ç±»åŠ è½½å™¨ â€” éƒ½æ˜¯java.lang.ClassLoaderçš„å­ç±»<ul><li>éœ€è¦å…ˆç”±å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå°†å…¶åŠ è½½è‡³Javaè™šæ‹Ÿæœºå½“ä¸­ï¼Œæ–¹èƒ½æ‰§è¡Œç±»çš„åŠ è½½</li><li>E.G<ul><li>æ‰©å±•ç±»åŠ è½½å™¨ â€” çˆ¶ç±»æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨<ul><li>è´Ÿè´£åŠ è½½ç›¸å¯¹æ¬¡è¦ã€ä½†åˆé€šç”¨çš„ç±»ï¼Œæ¯”å¦‚å­˜æ”¾åœ¨ JRE çš„ lib/ext ç›®å½•ä¸‹ jar åŒ…ä¸­çš„ç±»ï¼ˆä»¥åŠç”±ç³»ç»Ÿå˜é‡ java.ext.dirs æŒ‡å®šçš„ç±»ï¼‰</li></ul></li><li>åº”ç”¨ç±»åŠ è½½å™¨ â€” çˆ¶ç±»æ˜¯æ‰©å±•ç±»åŠ è½½å™¨<ul><li>è´Ÿè´£åŠ è½½åº”ç”¨ç¨‹åºè·¯å¾„ä¸‹çš„ç±»<ul><li>ä¾‹å¦‚è™šæ‹Ÿæœºå‚æ•° -cp/-classpath, ç³»ç»Ÿå˜é‡java.class.pathæˆ–è€…ç¯å¢ƒå˜é‡CLASSPATHæ‰€æŒ‡å®šçš„è·¯å¾„</li><li>é»˜è®¤åº”ç”¨ç¨‹åºé‡ŒåŒ…å«çš„ç±»åº”è¯¥ç”±åº”ç”¨ç±»åŠ è½½å™¨æ¥è¿›è¡ŒåŠ è½½</li></ul></li></ul></li></ul></li></ul></li></ul></li><li>åŒäº²å§”æ´¾æ¨¡å‹<ul><li>å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ¥æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œä¼šå…ˆå°†è¯·æ±‚è½¬å‘ç»™çˆ¶ç±»åŠ è½½å™¨</li><li>åœ¨çˆ¶ç±»åŠ è½½å™¨æ²¡æœ‰æ‰¾åˆ°æ‰€è¯·æ±‚çš„ç±»çš„æƒ…å†µä¸‹ï¼Œè¯¥ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•å»åŠ è½½</li></ul></li><li>ç±»åŠ è½½å™¨ â€” å‘½åç©ºé—´çš„ä½œç”¨<ul><li>ç±»çš„å”¯ä¸€æ€§ç”±ç±»åŠ è½½å™¨å®ä¾‹å’Œç±»çš„å…¨åå…±åŒç¡®å®š</li><li>å³ä½¿åŒä¸€ä¸²å­—èŠ‚æµï¼Œç»ç”±ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¹Ÿä¼šå¾—åˆ°ä¸åŒçš„ç±»</li></ul></li></ul></li><li>é“¾æ¥<ul><li>å°†åˆ›å»ºçš„ç±»åˆå¹¶åˆ°Javaè™šæ‹Ÿæœºå½“ä¸­ï¼Œå¹¶ä¸”ä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œçš„è¿‡ç¨‹</li><li>è¿‡ç¨‹<ul><li>éªŒè¯<ul><li>ç¡®ä¿è¢«åŠ è½½ç±»èƒ½å¤Ÿæ»¡è¶³Javaè™šæ‹Ÿæœºçš„çº¦æŸæ¡ä»¶</li><li>å®‰å…¨æ£€æŸ¥</li></ul></li><li>å‡†å¤‡<ul><li>ä¸ºè¢«åŠ è½½ç±»çš„é™æ€å­—æ®µåˆ†é…å†…å­˜<ul><li>å°±æ˜¯ä¸ºstaticå˜é‡åœ¨æ–¹æ³•åŒºå½“ä¸­åˆ†é…å†…å­˜ç©ºé—´ï¼Œè®¾ç½®å˜é‡çš„åˆå§‹å€¼</li></ul></li><li>ä¹Ÿä¼šæ¥æ„é€ å’Œå…¶ä»–ç±»å±‚æ¬¡ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚è¯´ç”¨æ¥å®ç°è™šæ–¹æ³•çš„åŠ¨æ€ç»‘å®šçš„æ–¹æ³•è¡¨</li></ul></li><li>è§£æ â€” å¯¹äºå­—èŠ‚ç ç¬¦å·å¼•ç”¨çš„è§£æ<ul><li>åœ¨ class æ–‡ä»¶è¢«åŠ è½½è‡³ Java è™šæ‹Ÿæœºä¹‹å‰ï¼Œè¿™ä¸ªç±»æ— æ³•çŸ¥é“å…¶ä»–ç±»åŠå…¶æ–¹æ³•ã€å­—æ®µæ‰€å¯¹åº”çš„å…·ä½“åœ°å€ï¼Œç”šè‡³ä¸çŸ¥é“è‡ªå·±æ–¹æ³•ã€å­—æ®µçš„åœ°å€ã€‚</li><li>å› æ­¤ï¼Œæ¯å½“éœ€è¦å¼•ç”¨è¿™äº›æˆå‘˜æ—¶ï¼ŒJava ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªç¬¦å·å¼•ç”¨ã€‚åœ¨è¿è¡Œé˜¶æ®µï¼Œè¿™ä¸ªç¬¦å·å¼•ç”¨ä¸€èˆ¬éƒ½èƒ½å¤Ÿæ— æ­§ä¹‰åœ°å®šä½åˆ°å…·ä½“ç›®æ ‡ä¸Šã€‚</li><li>ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«ç›®æ ‡æ–¹æ³•æ‰€åœ¨ç±»çš„åå­—ã€ç›®æ ‡æ–¹æ³•çš„åå­—ã€æ¥æ”¶å‚æ•°ç±»å‹ä»¥åŠè¿”å›å€¼ç±»å‹çš„ç¬¦å·å¼•ç”¨ï¼Œæ¥æŒ‡ä»£æ‰€è¦è°ƒç”¨çš„æ–¹æ³•ã€‚</li><li>è§£æé˜¶æ®µçš„ç›®çš„ï¼Œæ­£æ˜¯å°†è¿™äº›ç¬¦å·å¼•ç”¨è§£ææˆä¸ºå®é™…å¼•ç”¨ã€‚å¦‚æœç¬¦å·å¼•ç”¨æŒ‡å‘ä¸€ä¸ªæœªè¢«åŠ è½½çš„ç±»ï¼Œæˆ–è€…æœªè¢«åŠ è½½ç±»çš„å­—æ®µæˆ–æ–¹æ³•ï¼Œé‚£ä¹ˆè§£æå°†è§¦å‘è¿™ä¸ªç±»çš„åŠ è½½ï¼ˆä½†æœªå¿…è§¦å‘è¿™ä¸ªç±»çš„é“¾æ¥ä»¥åŠåˆå§‹åŒ–ã€‚ï¼‰</li></ul></li></ul></li></ul></li><li>åˆå§‹åŒ–<ul><li>å†…å®¹<ul><li>ä¸ºæ ‡è®°ä¸ºå¸¸é‡å€¼çš„å­—æ®µèµ‹å€¼</li><li>æ‰§è¡Œclinitæ–¹æ³• â€” Javaè™šæ‹Ÿæœºé€šè¿‡åŠ é”ç¡®å®šclinitæ–¹æ³•ä»…ä»…ä¼šè¢«æ‰§è¡Œä¸€æ¬¡<ul><li>å¦‚æœç›´æ¥èµ‹å€¼çš„é™æ€å­—æ®µè¢« final æ‰€ä¿®é¥°ï¼Œå¹¶ä¸”å®ƒçš„ç±»å‹æ˜¯åŸºæœ¬ç±»å‹æˆ–å­—ç¬¦ä¸²æ—¶ï¼Œé‚£ä¹ˆè¯¥å­—æ®µä¾¿ä¼šè¢« Java ç¼–è¯‘å™¨æ ‡è®°æˆå¸¸é‡å€¼ï¼ˆConstantValueï¼‰ï¼Œå…¶åˆå§‹åŒ–ç›´æ¥ç”± Java è™šæ‹Ÿæœºå®Œæˆã€‚</li><li>é™¤æ­¤ä¹‹å¤–çš„ç›´æ¥èµ‹å€¼æ“ä½œï¼Œä»¥åŠæ‰€æœ‰é™æ€ä»£ç å—ä¸­çš„ä»£ç ï¼Œåˆ™ä¼šè¢« Java ç¼–è¯‘å™¨ç½®äºåŒä¸€æ–¹æ³•ä¸­ï¼Œå¹¶æŠŠå®ƒå‘½åä¸º &lt; clinit &gt;ã€‚</li></ul></li></ul></li><li>è§¦å‘æƒ…å†µ<ul><li>å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–ç”¨æˆ·æŒ‡å®šçš„ä¸»ç±»ï¼›</li><li>å½“é‡åˆ°ç”¨ä»¥æ–°å»ºç›®æ ‡ç±»å®ä¾‹çš„ new æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ– new æŒ‡ä»¤çš„ç›®æ ‡ç±»ï¼›</li><li>å½“é‡åˆ°è°ƒç”¨é™æ€æ–¹æ³•çš„æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ–è¯¥é™æ€æ–¹æ³•æ‰€åœ¨çš„ç±»ï¼›</li><li>å½“é‡åˆ°è®¿é—®é™æ€å­—æ®µçš„æŒ‡ä»¤æ—¶ï¼Œåˆå§‹åŒ–è¯¥é™æ€å­—æ®µæ‰€åœ¨çš„ç±»ï¼›</li><li>å­ç±»çš„åˆå§‹åŒ–ä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–ï¼›</li><li>å¦‚æœä¸€ä¸ªæ¥å£å®šä¹‰äº† default æ–¹æ³•ï¼Œé‚£ä¹ˆç›´æ¥å®ç°æˆ–è€…é—´æ¥å®ç°è¯¥æ¥å£çš„ç±»çš„åˆå§‹åŒ–ï¼Œä¼šè§¦å‘è¯¥æ¥å£çš„åˆå§‹åŒ–ï¼›</li><li>ä½¿ç”¨åå°„ API å¯¹æŸä¸ªç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶ï¼Œåˆå§‹åŒ–è¿™ä¸ªç±»ï¼›</li><li>å½“åˆæ¬¡è°ƒç”¨ MethodHandle å®ä¾‹æ—¶ï¼Œåˆå§‹åŒ–è¯¥ MethodHandle æŒ‡å‘çš„æ–¹æ³•æ‰€åœ¨çš„ç±»ã€‚</li></ul></li></ul></li><li>å¸è½½<ul><li>GCå°†æ— ç”¨å¯¹è±¡ä»å†…å­˜å½“ä¸­å¸è½½æ‰</li></ul></li></ul></li><li>åŸºæœ¬ç±»å‹æ˜¯Javaè™šæ‹Ÿæœºå·²ç»è®¾ç½®å¥½çš„ï¼Œè€Œå¦ä¸€å¤§ç±»å¼•ç”¨ç±»å‹ï¼ŒJavaå°†å…¶ç»†åˆ†ä¸ºå››ç§<ul><li>ç±»<ul><li>æœ‰å¯¹åº”çš„å­—èŠ‚æµ â€” classæ–‡ä»¶</li></ul></li><li>æ¥å£<ul><li>æœ‰å¯¹åº”çš„å­—èŠ‚æµ - classæ–‡ä»¶</li></ul></li><li>æ•°ç»„ç±»<ul><li>ç”±Javaè™šæ‹Ÿæœºç›´æ¥ç”Ÿæˆ</li></ul></li><li>æ³›å‹å‚æ•°</li></ul></li></ul><h1 id="4-JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨"><a href="#4-JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨" class="headerlink" title="4. JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨"></a>4. JVMæ‰§è¡Œæ–¹æ³•è°ƒç”¨</h1><h2 id="4-1-é‡è½½å’Œé‡å†™"><a href="#4-1-é‡è½½å’Œé‡å†™" class="headerlink" title="4.1 é‡è½½å’Œé‡å†™"></a>4.1 é‡è½½å’Œé‡å†™</h2><ul><li>é‡è½½<ul><li>åŒä¸€ä¸ªç±»å½“ä¸­æ–¹æ³•åç§°ç›¸åŒï¼Œä½†æ˜¯æ–¹æ³•çš„å‚æ•°ä¸ç›¸åŒçš„æƒ…å†µ</li><li>åœ¨ç¼–è¯‘è¿‡ç¨‹å½“ä¸­å°±å¯ä»¥å®Œæˆè¯†åˆ«ï¼ŒJavaç¼–è¯‘å™¨æ ¹æ®ä¼ å…¥å‚æ•°çš„å£°æ˜ç±»å‹ï¼Œæ¥é€‰å–é‡è½½æ–¹æ³•<ul><li>ä¸‰ä¸ªé˜¶æ®µ<ul><li>ä¸è€ƒè™‘åŸºæœ¬ç±»å‹çš„è‡ªåŠ¨æ‹†ç®±è£…ç®±ï¼Œè¿˜æœ‰å¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰æ‹©é‡è½½æ–¹æ³•</li><li>1é˜¶æ®µæ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±åœ¨å…è®¸è‡ªåŠ¨æ‹†è£…ç®±ï¼Œä½†ä¸å…è®¸å¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•</li><li>2é˜¶æ®µæ²¡æœ‰æ‰¾åˆ°é€‚é…çš„æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨å…è®¸è‡ªåŠ¨è£…æ‹†ç®±ä»¥åŠå¯å˜é•¿å‚æ•°çš„æƒ…å†µä¸‹é€‰å–é‡è½½æ–¹æ³•</li></ul></li><li>å¦‚æœJavaç¼–è¯‘å™¨åœ¨åŒä¸€ä¸ªé˜¶æ®µæ‰¾åˆ°äº†å¤šä¸ªé€‚é…æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¸ºè´´åˆ‡çš„ï¼Œå†³å®šè´´åˆ‡ç¨‹åº¦çš„ä¸€ä¸ªå…³é”®å°±æ˜¯å½¢å¼å‚æ•°ç±»å‹çš„ç»§æ‰¿å…³ç³»<ul><li>ä¼šé€‰æ‹©é‚£ä¸ªèŒƒå›´æ›´å°çš„ï¼Œæ¯”å¦‚æŸæŸçš„å­ç±»è¿™æ ·å­</li></ul></li></ul></li></ul></li><li>é‡å†™<ul><li>å­ç±»å®šä¹‰äº†å’Œçˆ¶ç±»éç§æœ‰æ–¹æ³•åŒåçš„æ–¹æ³•ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹ç›¸åŒ</li><li>å¦‚æœè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œé‚£ä¹ˆå­ç±»ä¸­çš„æ–¹æ³•éšè—äº†çˆ¶ç±»ä¸­çš„æ–¹æ³•</li><li>å¦‚æœéƒ½ä¸æ˜¯é™æ€ï¼Œä¹Ÿä¸æ˜¯ç§æœ‰çš„ï¼Œé‚£ä¹ˆå­ç±»çš„æ–¹æ³•é‡å†™äº†çˆ¶ç±»å½“ä¸­çš„æ–¹æ³•</li><li>æ–¹æ³•é‡å†™ â€” å…è®¸å­ç±»åœ¨ç»§æ‰¿çˆ¶ç±»éƒ¨åˆ†åŠŸèƒ½çš„åŒæ—¶ï¼Œæ‹¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„è¡Œä¸º</li></ul></li></ul><h2 id="4-2-JVM-é™æ€å’ŒåŠ¨æ€ç»‘å®š"><a href="#4-2-JVM-é™æ€å’ŒåŠ¨æ€ç»‘å®š" class="headerlink" title="4.2 JVM é™æ€å’ŒåŠ¨æ€ç»‘å®š"></a>4.2 JVM é™æ€å’ŒåŠ¨æ€ç»‘å®š</h2><ul><li>Javaè™šæ‹Ÿæœºè¯†åˆ«æ–¹æ³•<ul><li>ç±»å</li><li>æ–¹æ³•å</li><li>æ–¹æ³•æè¿°ç¬¦ â€” method descriptor<ul><li>ç”±æ–¹æ³•çš„å‚æ•°ç±»å‹ä»¥åŠ<strong>è¿”å›ç±»å‹</strong>æ‰€æ„æˆçš„</li></ul></li></ul></li><li>JVMå’ŒJavaè¯­è¨€åœ¨è¿™é‡Œä¸å¤ªä¸€æ ·ï¼ŒåŒä¸€ä¸ªç±»ä¸‹åŒæ ·æ–¹æ³•åï¼ŒåŒæ ·å‚æ•°ï¼Œä½†æ˜¯ä¸åŒè¿”å›å€¼ä»JVMè§’åº¦æ¥è¯´æ˜¯å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸åŒçš„æ–¹æ³•ï¼Œæ˜¯å¯ä»¥é€šè¿‡çš„</li><li>é™æ€ç»‘å®š<ul><li>åœ¨è§£æçš„æ—¶å€™ä¾¿èƒ½å¤Ÿè¯†åˆ«ç›®æ ‡æ–¹æ³•çš„æƒ…å†µ</li><li>é‡è½½ â€” æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°±å®Œæˆäº†çš„ï¼Œä¹Ÿå¯ä»¥æˆä¸ºstatic binding</li></ul></li><li>åŠ¨æ€ç»‘å®š<ul><li>åœ¨è¿è¡Œè¿‡ç¨‹å½“ä¸­æ ¹æ®è°ƒç”¨è€…çš„åŠ¨æ€ç±»å‹æ¥è¯†åˆ«ç›®æ ‡æ–¹æ³•çš„æƒ…å†µ</li><li>é‡å†™ â€” åœ¨JVMå½“ä¸­æ¥åšè¯†åˆ«ï¼Œdynamic binding</li></ul></li><li>Javaå­—èŠ‚ç å½“ä¸­å’Œè°ƒç”¨ç›¸å…³çš„æŒ‡ä»¤<ul><li>invokestatic  - ç”¨äºè°ƒç”¨é™æ€æ–¹æ³•</li><li>invokespecial - ç”¨äºè°ƒç”¨ç§æœ‰å®ä¾‹æ–¹æ³•ï¼Œæ„é€ å™¨  ä»¥åŠä½¿ç”¨superå…³é”®å­—è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•æˆ–è€…æ„é€ å™¨</li><li>invokevirtual  - ç”¨äºè°ƒç”¨éç§æœ‰å®ä¾‹æ–¹æ³•</li><li>invokeinterface - ç”¨äºè°ƒç”¨æ¥å£æ–¹æ³•</li><li>invokedynamic - ç”¨äºè°ƒç”¨åŠ¨æ€æ–¹æ³•</li></ul></li></ul><h2 id="4-3-è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨"><a href="#4-3-è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨" class="headerlink" title="4.3 è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨"></a>4.3 è°ƒç”¨æŒ‡ä»¤çš„ç¬¦å·å¼•ç”¨</h2><ul><li>åœ¨ç¼–è¯‘è¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç›®æ ‡æ–¹æ³•çš„å…·ä½“å†…å­˜åœ°å€<ul><li>Javaç¼–è¯‘å™¨ä¼šæš‚æ—¶ç”¨ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºè¯¥ç›®æ ‡æ–¹æ³•</li><li>è¿™ä¸€ç¬¦å·å¼•ç”¨åŒ…æ‹¬ç›®æ ‡æ–¹æ³•æ‰€åœ¨çš„ç±»æˆ–æ¥å£çš„åå­—ï¼Œä»¥åŠç›®æ ‡æ–¹æ³•çš„æ–¹æ³•åå’Œæ–¹æ³•æè¿°ç¬¦ã€‚</li></ul></li></ul><h1 id="5-åƒåœ¾å›æ”¶"><a href="#5-åƒåœ¾å›æ”¶" class="headerlink" title="5. åƒåœ¾å›æ”¶"></a>5. åƒåœ¾å›æ”¶</h1><h2 id="5-1-å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡"><a href="#5-1-å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡" class="headerlink" title="5.1 å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡"></a>5.1 å¦‚ä½•åˆ¤æ–­éœ€è¦æ¸…ç†ä¸€ä¸ªå¯¹è±¡</h2><p><img src="https://i.loli.net/2021/06/28/dtOa3GUh5SkbAVY.png" alt="åˆ¤æ–­æ˜¯å¦éœ€è¦æ¸…ç†å¯¹è±¡çš„é€»è¾‘"></p><ul><li>ç»¿è‰²éƒ¨åˆ†æ˜¯çº¿ç¨‹æ‹¥æœ‰çš„ï¼Œä¼šéšç€çº¿ç¨‹çš„ç»“æŸè€Œè‡ªåŠ¨è¢«å›æ”¶ è¿™é‡Œä¸éœ€è¦è€ƒè™‘åƒåœ¾å›æ”¶çš„é—®é¢˜</li><li>æ©™è‰²éƒ¨åˆ†æ˜¯å…±äº«çš„ï¼Œå†…å­˜åˆ†é…å’Œå›æ”¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œå› æ­¤åƒåœ¾æ”¶é›†å™¨æ‰€å…³æ³¨çš„éƒ½æ˜¯å †å’Œæ–¹æ³•è¿™éƒ¨åˆ†å†…å­˜</li><li>åˆ¤æ–­å¯¹è±¡å­˜æ´»çš„æ–¹æ³•<ul><li>å¼•ç”¨è®¡æ•°å™¨è®¡ç®—<ul><li>ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯æ¬¡å¼•ç”¨è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™è®¡æ•°å™¨åŠ ä¸€ï¼Œå¼•ç”¨å¤±æ•ˆåˆ™å‡ä¸€</li><li>è®¡æ•°å™¨ç­‰äºé›¶çš„æ—¶å€™å°±ä¸ä¼šå†æ¬¡è¯•ç”¨äº†</li></ul></li><li>å¯è¾¾æ€§åˆ†æè®¡ç®—<ul><li>å°†ä¸€ç³»åˆ—GC ROOTSä½œä¸ºèµ·å§‹çš„å­˜æ´»å¯¹è±¡é›†ï¼Œä»è¿™ä¸ªèŠ‚ç‚¹å¾€ä¸‹æœç´¢</li><li>æœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„æˆä¸ºå¼•ç”¨é“¾ï¼Œå°†èƒ½è¢«è¯¥é›†åˆå¼•ç”¨çš„å¯¹è±¡åŠ å…¥åˆ°é›†åˆå½“ä¸­</li><li>å½“æœç´¢åˆ°ä¸€ä¸ªå¯¹è±¡åˆ°GC rootsæ²¡æœ‰ä½¿ç”¨ä»»ä½•å¼•ç”¨é“¾çš„æ—¶å€™ï¼Œå°±è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„</li></ul></li></ul></li></ul><h2 id="5-2-å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ-æ­»äº¡"><a href="#5-2-å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ-æ­»äº¡" class="headerlink" title="5.2 å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ/ æ­»äº¡"></a>5.2 å¦‚ä½•å®£å‘Šä¸€ä¸ªå¯¹è±¡çš„ç»“æŸ/ æ­»äº¡</h2><ul><li>finalize()æ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªå¯¹è±¡çš„finalize()æ–¹æ³•åªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ï¼Œç»è¿‡finalize()æ–¹æ³•é€ƒè„±æ­»äº¡çš„å¯¹è±¡ï¼ŒäºŒæ¬¡æ ‡è®°çš„æ—¶å€™ä¼šç»™ç§»å‡º</li><li>æ•´ä¸ªæµç¨‹å¦‚ä¸‹<ol><li>å¦‚æœå¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æä¹‹åæ²¡å‘ç°ä¸GC Rootsç›¸è¿çš„å¼•ç”¨é“¾ï¼Œé‚£å®ƒå°†ä¼šç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ã€‚åˆ¤æ–­çš„æ¡ä»¶æ˜¯å†³å®šè¿™ä¸ªå¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚å¦‚æœå¯¹è±¡æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œåˆ™è¢«æ”¾å…¥F-Queueé˜Ÿåˆ—ä¸­ã€‚</li><li>GCå¯¹F-Queueé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡ŒäºŒæ¬¡æ ‡è®°ã€‚å¦‚æœå¯¹è±¡åœ¨finalize()æ–¹æ³•ä¸­é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹äº†å…³è”ï¼Œé‚£ä¹ˆäºŒæ¬¡æ ‡è®°æ—¶åˆ™ä¼šå°†å®ƒç§»å‡ºâ€œå³å°†å›æ”¶â€é›†åˆã€‚å¦‚æœæ­¤æ—¶å¯¹è±¡è¿˜æ²¡æˆåŠŸé€ƒè„±ï¼Œé‚£ä¹ˆåªèƒ½è¢«å›æ”¶äº†ã€‚</li></ol></li></ul><h2 id="5-3-åƒåœ¾å›æ”¶ç®—æ³•"><a href="#5-3-åƒåœ¾å›æ”¶ç®—æ³•" class="headerlink" title="5.3 åƒåœ¾å›æ”¶ç®—æ³•"></a>5.3 åƒåœ¾å›æ”¶ç®—æ³•</h2><h3 id="5-3-1-æ ‡è®°æ¸…é™¤ç®—æ³•"><a href="#5-3-1-æ ‡è®°æ¸…é™¤ç®—æ³•" class="headerlink" title="5.3.1 æ ‡è®°æ¸…é™¤ç®—æ³•"></a>5.3.1 æ ‡è®°æ¸…é™¤ç®—æ³•</h3><ul><li><p>é˜¶æ®µ</p><ul><li>æ ‡è®°<ul><li>æ ‡è®°å¤„æ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡</li></ul></li><li>æ¸…é™¤<ul><li>æ ‡è®°ç»“æŸä»¥åè¿›è¡Œç»Ÿä¸€çš„å›æ”¶</li></ul></li></ul></li><li><p>åŸç†</p><ul><li>å°†å·²æ­»äº¡çš„å¯¹è±¡æ ‡è®°ä¸ºç©ºé—²å†…å­˜ï¼Œè®°å½•åœ¨ä¸€ä¸ªç©ºé—²åˆ—è¡¨å½“ä¸­</li><li>å½“æˆ‘ä»¬éœ€è¦newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå†…å­˜ç®¡ç†æ¨¡å—ä¼šä»ç©ºé—²åˆ—è¡¨å½“ä¸­å¯»æ‰¾ç©ºé—²çš„å†…å­˜æ¥åˆ†ç»™æ–°çš„å¯¹è±¡</li></ul></li><li><p>ç¼ºé™·</p><ul><li><p>ä¼šä½¿å¾—å†…å­˜å½“ä¸­çš„ç¢ç‰‡éå¸¸å¤š</p></li><li><p>å®¹æ˜“å¯¼è‡´å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤§å—çš„å†…å­˜çš„æ—¶å€™ï¼Œæ— æ³•åˆ†é…è¶³å¤Ÿçš„è¿ç»­å†…å­˜</p><p> <img src="https://i.loli.net/2021/06/28/TkZEf72unqIHLBY.png" alt="æ ‡è®°æ¸…é™¤ç®—æ³•"></p></li></ul></li></ul><h3 id="5-3-2-å¤åˆ¶ç®—æ³•"><a href="#5-3-2-å¤åˆ¶ç®—æ³•" class="headerlink" title="5.3.2 å¤åˆ¶ç®—æ³•"></a>5.3.2 å¤åˆ¶ç®—æ³•</h3><ul><li><p>åœ¨æ ‡è®°æ¸…é™¤ç®—æ³•çš„åŸºç¡€ä¸Šåšçš„ä¼˜åŒ–</p><ul><li>å°†å¯ç”¨å†…å­˜æŒ‰ç…§å®¹é‡åˆ’åˆ†æˆä¸¤ç­‰åˆ†ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—</li><li>å½“ä¸€å—å­˜æ»¡äº† å°±å°†å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šï¼Œç„¶åäº¤æ¢æŒ‡é’ˆçš„å†…å®¹</li><li>ä»¥æ­¤è§£å†³ç¢ç‰‡åŒ–çš„é—®é¢˜</li></ul></li><li><p>ç¼ºé™·</p><ul><li><p>å¯ç”¨å†…å­˜å‡å°‘äº†ï¼</p><p><img src="https://i.loli.net/2021/06/28/fQY3p1658zJkIxb.png" alt="å¤åˆ¶ç®—æ³•"></p></li></ul></li></ul><h3 id="5-3-3-æ ‡è®°æ•´ç†ç®—æ³•"><a href="#5-3-3-æ ‡è®°æ•´ç†ç®—æ³•" class="headerlink" title="5.3.3 æ ‡è®°æ•´ç†ç®—æ³•"></a>5.3.3 æ ‡è®°æ•´ç†ç®—æ³•</h3><ul><li>æ ‡è®°äº†ä»¥åä¼šåšæ•´ç†ï¼Œå°†æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘å†…å­˜å—ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜</li></ul><p><img src="https://i.loli.net/2021/06/28/7CNKE8HvLgVzrPk.png" alt="æ ‡è®°æ•´ç†ç®—æ³•"></p><h3 id="5-3-4-åˆ†ä»£æ”¶é›†ç®—æ³•"><a href="#5-3-4-åˆ†ä»£æ”¶é›†ç®—æ³•" class="headerlink" title="5.3.4 åˆ†ä»£æ”¶é›†ç®—æ³•"></a>5.3.4 åˆ†ä»£æ”¶é›†ç®—æ³•</h3><ul><li>æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—</li><li>æ–°ç”Ÿä»£<ul><li>æ¯æ¬¡åƒåœ¾æ”¶é›†éƒ½æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œå°‘é‡å­˜æ´»</li><li>æ‰€ä»¥å¯ä»¥é€‰ç”¨å¤åˆ¶ç®—æ³•</li></ul></li><li>è€å¹´ä»£<ul><li>å¯¹è±¡å­˜æ´»ç‡é«˜ï¼Œæ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å…¶è¿›è¡Œåˆ†é…å’Œæ‹…ä¿</li><li>éœ€è¦ä½¿ç”¨æ ‡è®°-æ¸…ç†æˆ–è€…æ ‡è®°æ•´ç†ç®—æ³•æ¥è¿›è¡Œå›æ”¶</li></ul></li></ul><h2 id="5-4-åƒåœ¾æ”¶é›†å™¨"><a href="#5-4-åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="5.4 åƒåœ¾æ”¶é›†å™¨"></a>5.4 åƒåœ¾æ”¶é›†å™¨</h2><ul><li>jdk8 é»˜è®¤æ”¶é›†å™¨æ˜¯Parallel Scavenge å’Œ Parallel Old</li><li>jdk9å¼€å§‹ï¼ŒG1æ”¶é›†å™¨æˆä¸ºé»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨</li></ul><p><img src="https://i.loli.net/2021/06/28/hsKHpeEGm4lQydA.png" alt="åƒåœ¾æ”¶é›†å™¨åˆ—è¡¨"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://snailclimb.gitee.io/javaguide/#/docs/java/jvm/[%E5%8A%A0%E9%A4%90]%E5%A4%A7%E7%99%BD%E8%AF%9D%E5%B8%A6%E4%BD%A0%E8%AE%A4%E8%AF%86JVM" target="_blank" rel="noopener">JavaGuide</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Log4j æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ </title>
      <link href="/Log4j-%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F/"/>
      <url>/Log4j-%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="Log4j-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"><a href="#Log4j-æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ" class="headerlink" title="Log4j æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ"></a>Log4j æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h1><p>Created: Apr 24, 2021 5:02 PM<br>Tags: backend, tech<br>status: In Progress</p><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>ç»„ä»¶åŒ–è®¾è®¡çš„æ—¥å¿—ç³»ç»Ÿ</li></ul><pre><code>log.info(&quot;User signed in.&quot;); â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”€&gt;â”‚ Appender â”‚â”€â”€â”€&gt;â”‚  Filter  â”‚â”€â”€â”€&gt;â”‚  Layout  â”‚â”€â”€â”€&gt;â”‚ Console  â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”€&gt;â”‚ Appender â”‚â”€â”€â”€&gt;â”‚  Filter  â”‚â”€â”€â”€&gt;â”‚  Layout  â”‚â”€â”€â”€&gt;â”‚   File   â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€&gt;â”‚ Appender â”‚â”€â”€â”€&gt;â”‚  Filter  â”‚â”€â”€â”€&gt;â”‚  Layout  â”‚â”€â”€â”€&gt;â”‚  Socket  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><ul><li>é€šè¿‡appenderå°†åŒä¸€æ¡æ—¥å¿—è¾“å‡ºåˆ°ä¸åŒçš„ç›®çš„åœ°</li></ul><h2 id="1-1-Loggerç»„ä»¶"><a href="#1-1-Loggerç»„ä»¶" class="headerlink" title="1.1 Loggerç»„ä»¶"></a>1.1 Loggerç»„ä»¶</h2><ul><li>è´Ÿè´£äº§ç”Ÿæ—¥å¿—ï¼Œ</li><li>çº§åˆ«<ul><li>DEBUG</li><li>INFO</li><li>WARN</li><li>ERROR</li><li>FATAL</li></ul></li></ul><h2 id="1-2-Appenders-ç»„ä»¶"><a href="#1-2-Appenders-ç»„ä»¶" class="headerlink" title="1.2 Appenders ç»„ä»¶"></a>1.2 Appenders ç»„ä»¶</h2><ul><li>è´Ÿè´£å°†æ—¥å¿—è¾“å‡ºåˆ°ä¸åŒçš„åœ°æ–¹<ul><li>æ§åˆ¶å° Console</li><li>æ–‡ä»¶ Files<ul><li>æ ¹æ®å¤©æ•°æˆ–è€…æ–‡ä»¶å¤§å°æ¥äº§ç”Ÿæ–°çš„æ–‡ä»¶</li></ul></li></ul></li></ul><h2 id="1-3-Layout"><a href="#1-3-Layout" class="headerlink" title="1.3 Layout"></a>1.3 Layout</h2><ul><li>å®Œæ•´æ–‡æ¡£<ul><li><a href="https://logging.apache.org/log4j/2.x/manual/layouts.html" target="_blank" rel="noopener">https://logging.apache.org/log4j/2.x/manual/layouts.html</a></li></ul></li><li>è¯´æ˜ä½ çš„æ—¥å¿—è¦ä»¥ä½•ç§æ ¼å¼æ¥è¿›è¡Œè¾“å‡º</li></ul><pre><code class="jsx">ï¼Xå·: Xä¿¡æ¯è¾“å‡ºæ—¶å·¦å¯¹é½ï¼›%p: è¾“å‡ºæ—¥å¿—ä¿¡æ¯ä¼˜å…ˆçº§ï¼Œå³DEBUGï¼ŒINFOï¼ŒWARNï¼ŒERRORï¼ŒFATAL,%d: è¾“å‡ºæ—¥å¿—æ—¶é—´ç‚¹çš„æ—¥æœŸæˆ–æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ä¸ºISO8601ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶åæŒ‡å®šæ ¼å¼ï¼Œæ¯”å¦‚ï¼š%d{yyy MMM dd HH:mm:ss,SSS}è¾“å‡ºç±»ä¼¼ï¼š2002å¹´10æœˆ18æ—¥ 22ï¼š10ï¼š28ï¼Œ921%r: è¾“å‡ºè‡ªåº”ç”¨å¯åŠ¨åˆ°è¾“å‡ºè¯¥logä¿¡æ¯è€—è´¹çš„æ¯«ç§’æ•°%c: è¾“å‡ºæ—¥å¿—ä¿¡æ¯æ‰€å±çš„ç±»ç›®ï¼Œé€šå¸¸å°±æ˜¯æ‰€åœ¨ç±»çš„å…¨å%t: è¾“å‡ºäº§ç”Ÿè¯¥æ—¥å¿—äº‹ä»¶çš„çº¿ç¨‹å%l: è¾“å‡ºæ—¥å¿—äº‹ä»¶çš„å‘ç”Ÿä½ç½®ï¼Œç›¸å½“äº%C.%M(%F:%L)çš„ç»„åˆ,åŒ…æ‹¬ç±»ç›®åã€å‘ç”Ÿçš„çº¿ç¨‹ï¼Œä»¥åŠåœ¨ä»£ç ä¸­çš„è¡Œæ•°ã€‚ä¸¾ä¾‹ï¼šTestlog4.main(TestLog4.java:10)%x: è¾“å‡ºå’Œå½“å‰çº¿ç¨‹ç›¸å…³è”çš„NDC(åµŒå¥—è¯Šæ–­ç¯å¢ƒ),å°¤å…¶ç”¨åˆ°åƒjava servletsè¿™æ ·çš„å¤šå®¢æˆ·å¤šçº¿ç¨‹çš„åº”ç”¨ä¸­ã€‚%%: è¾“å‡ºä¸€ä¸ª&quot;%&quot;å­—ç¬¦%F: è¾“å‡ºæ—¥å¿—æ¶ˆæ¯äº§ç”Ÿæ—¶æ‰€åœ¨çš„æ–‡ä»¶åç§°%L: è¾“å‡ºä»£ç ä¸­çš„è¡Œå·%m: è¾“å‡ºä»£ç ä¸­æŒ‡å®šçš„æ¶ˆæ¯,äº§ç”Ÿçš„æ—¥å¿—å…·ä½“ä¿¡æ¯%n: è¾“å‡ºä¸€ä¸ªå›è½¦æ¢è¡Œç¬¦ï¼ŒWindowså¹³å°ä¸º&quot;/r/n&quot;ï¼ŒUnixå¹³å°ä¸º&quot;/n&quot;è¾“å‡ºæ—¥å¿—ä¿¡æ¯æ¢è¡Œ</code></pre><h1 id="2-XML-é…ç½®æ–‡ä»¶æ ¼å¼"><a href="#2-XML-é…ç½®æ–‡ä»¶æ ¼å¼" class="headerlink" title="2. XML é…ç½®æ–‡ä»¶æ ¼å¼"></a>2. XML é…ç½®æ–‡ä»¶æ ¼å¼</h1><ul><li>é€šè¿‡Filteræ¥è¿‡æ»¤å“ªäº›éœ€è¦è¾“å‡ºï¼Œå“ªäº›ä¸éœ€è¦</li><li>é€šè¿‡Layoutæ¥æ ¼å¼åŒ–æ—¥å¿—ä¿¡æ¯</li></ul><pre><code class="jsx">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;Configuration&gt;    &lt;Properties&gt;        &lt;!-- å®šä¹‰æ—¥å¿—æ ¼å¼ --&gt;        &lt;Property name=&quot;log.pattern&quot;&gt;%d{MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36}%n%msg%n%n&lt;/Property&gt;        &lt;!-- å®šä¹‰æ–‡ä»¶åå˜é‡ --&gt;        &lt;Property name=&quot;file.err.filename&quot;&gt;log/err.log&lt;/Property&gt;        &lt;Property name=&quot;file.err.pattern&quot;&gt;log/err.%i.log.gz&lt;/Property&gt;    &lt;/Properties&gt;    &lt;!-- å®šä¹‰Appenderï¼Œå³ç›®çš„åœ° --&gt;    &lt;Appenders&gt;        &lt;!-- å®šä¹‰è¾“å‡ºåˆ°å±å¹• --&gt;        &lt;Console name=&quot;console&quot; target=&quot;SYSTEM_OUT&quot;&gt;            &lt;!-- æ—¥å¿—æ ¼å¼å¼•ç”¨ä¸Šé¢å®šä¹‰çš„log.pattern --&gt;            &lt;PatternLayout pattern=&quot;${log.pattern}&quot; /&gt;        &lt;/Console&gt;        &lt;!-- å®šä¹‰è¾“å‡ºåˆ°æ–‡ä»¶,æ–‡ä»¶åå¼•ç”¨ä¸Šé¢å®šä¹‰çš„file.err.filename --&gt;        &lt;RollingFile name=&quot;err&quot; bufferedIO=&quot;true&quot; fileName=&quot;${file.err.filename}&quot; filePattern=&quot;${file.err.pattern}&quot;&gt;            &lt;PatternLayout pattern=&quot;${log.pattern}&quot; /&gt;            &lt;Policies&gt;                &lt;!-- æ ¹æ®æ–‡ä»¶å¤§å°è‡ªåŠ¨åˆ‡å‰²æ—¥å¿— --&gt;                &lt;SizeBasedTriggeringPolicy size=&quot;1 MB&quot; /&gt;            &lt;/Policies&gt;            &lt;!-- ä¿ç•™æœ€è¿‘10ä»½ --&gt;            &lt;DefaultRolloverStrategy max=&quot;10&quot; /&gt;        &lt;/RollingFile&gt;    &lt;/Appenders&gt;    &lt;Loggers&gt;        &lt;Root level=&quot;info&quot;&gt;            &lt;!-- å¯¹infoçº§åˆ«çš„æ—¥å¿—ï¼Œè¾“å‡ºåˆ°console --&gt;            &lt;AppenderRef ref=&quot;console&quot; level=&quot;info&quot; /&gt;            &lt;!-- å¯¹errorçº§åˆ«çš„æ—¥å¿—ï¼Œè¾“å‡ºåˆ°errï¼Œå³ä¸Šé¢å®šä¹‰çš„RollingFile --&gt;            &lt;AppenderRef ref=&quot;err&quot; level=&quot;error&quot; /&gt;        &lt;/Root&gt;    &lt;/Loggers&gt;&lt;/Configuration&gt;</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1264739436350112" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/1252599548343744/1264739436350112</a> </li><li><a href="https://blog.csdn.net/Mos_wen/article/details/50598967" target="_blank" rel="noopener">https://blog.csdn.net/Mos_wen/article/details/50598967</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log </tag>
            
            <tag> log4j </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Route53</title>
      <link href="/Route53/"/>
      <url>/Route53/</url>
      
        <content type="html"><![CDATA[<h1 id="Route-53"><a href="#Route-53" class="headerlink" title="Route 53"></a>Route 53</h1><h1 id="1-How-Route53-works"><a href="#1-How-Route53-works" class="headerlink" title="1. How Route53 works?"></a>1. How Route53 works?</h1><ul><li>Intro<ul><li>DNS webservice</li><li>functionalities<ul><li>domain registration</li><li>DNS routing</li><li>health checking</li></ul></li></ul></li><li>Domain Registration<ul><li>You choose a domain name and confirm that itâ€™s available</li><li>You provide names and contact information for the domain owner and other contacts</li><li>Route 53 automatically makes itself the DNS service for the domain by doing:<ul><li>create a hosted zone that has the same name as your domain</li><li>Assigns a set of <strong>four name servers to the hosted zone</strong>. When someone uses a browser to access your website, such as <a href="http://www.example.com/" target="_blank" rel="noopener">www.example.com</a>, these name servers tell the browser where to find your resources, such as a web server or an Amazon S3 bucket.</li><li>Gets the name servers from the hosted zone and adds them to the domain.</li></ul></li></ul></li></ul><h1 id="2-Concepts"><a href="#2-Concepts" class="headerlink" title="2. Concepts"></a>2. Concepts</h1><ul><li>Hosted Zone<ul><li>A container for records<ul><li>include info about how you want to route traffic for a domain and all of its subdomains</li><li>It has the same name as domain</li><li></li></ul></li></ul></li><li>Records<ul><li>Created in your hosted zone</li><li>For routing traffic to your resources</li><li>Each record includes information about how you want to route traffic for your domain<ul><li>Name</li><li>Type</li><li>Value</li></ul></li></ul></li><li>Name server<ul><li>Route53 will assign a set of 4 name servers to the hosted zone</li><li>name server tell the accessor (browser) where to find your resources</li></ul></li><li>Domain Name System Concepts<ul><li>Alias Record<ul><li>Record you create to route traffic to AWS resources</li></ul></li><li>subdomain<ul><li>A domain name that has one or more labels prepended to the registered domain name. For example, if you register the domain name <a href="http://example.com/" target="_blank" rel="noopener">example.com</a>, then <a href="http://www.example.com/" target="_blank" rel="noopener">www.example.com</a> is a subdomain. If you create the hosted zone <a href="http://accounting.example.com/" target="_blank" rel="noopener">accounting.example.com</a> for the <a href="http://example.com/" target="_blank" rel="noopener">example.com</a> domain, then <a href="http://seattle.accounting.example.com/" target="_blank" rel="noopener">seattle.accounting.example.com</a> is a subdomain.</li></ul></li></ul></li></ul><h1 id="3-Working-with-Hosted-Zones"><a href="#3-Working-with-Hosted-Zones" class="headerlink" title="3. Working with Hosted Zones"></a>3. Working with Hosted Zones</h1><p><a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-working-with.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-working-with.html</a> </p><h1 id="4-Routing-Traffic-for-subdomains"><a href="#4-Routing-Traffic-for-subdomains" class="headerlink" title="4. Routing Traffic for subdomains"></a>4. Routing Traffic for subdomains</h1><p><a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-routing-traffic-for-subdomains.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-routing-traffic-for-subdomains.html</a> </p><ul><li>Option 1:<ul><li>Create records in the hosted zone for the doamin</li><li>we could create a record named <a href="http://test.example.com" target="_blank" rel="noopener">test.example.com</a> in the example.com hosted zone</li></ul></li><li>Option 2:<ul><li>Create a hosted zone for the subdomain, and create records in the new hosted zone</li></ul></li></ul><h1 id="5-Routing-Traffic-to-AWS-Resources"><a href="#5-Routing-Traffic-to-AWS-Resources" class="headerlink" title="5. Routing Traffic to AWS Resources"></a>5. Routing Traffic to AWS Resources</h1><p><a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/routing-to-aws-resources.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/routing-to-aws-resources.html</a> </p><ul><li>The logic is to leverage on AWS PrivateLink for cross vpc connection, create the interface endpoint in your service, and build connection between your VPC and Route53</li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elastic Load Balancing </title>
      <link href="/Elastic-Load-Balancing/"/>
      <url>/Elastic-Load-Balancing/</url>
      
        <content type="html"><![CDATA[<h1 id="Elastic-Load-Balancing"><a href="#Elastic-Load-Balancing" class="headerlink" title="Elastic Load Balancing"></a>Elastic Load Balancing</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li><p>What is ELB?</p><ul><li>ELB distributes your incoming traffic across multiple targets, such as EC2 instances, containers, and IP addresses, in one or more AZs</li><li>It monitors the health of its registered targets, and routes traffic to the healthy targets</li><li>Elastic Load Balancing help scale your load balancer as your incoming traffic change over time â€” automatically scale to the vast majority of workloads</li></ul></li><li><p>Benefits</p><ul><li>Increase the availability and fault tolerance</li><li>You could configure health checks, thus ELB monitor the health of the compute resources, LB only send requests to the healthy ones</li></ul></li><li><p>How it works</p><ul><li>Listener<ul><li>configure your LB to accept incoming traffic by specifying one or more listeners</li><li>a process that checks for connection requests<ul><li>with a protocol</li><li>port number</li></ul></li></ul></li><li>cross zone load balancing<ul><li>we should enable it cause it could make sure traffic is well distributed</li><li>when client send request, it will first go through route 53, and route 53 will distribute traffic thus each lb node receives 50% of traffic (2 LB nodes in total )</li></ul></li><li>request routing<ul><li>client â€” amazon dns service â€” return IP address to client side â€” client use the ip address to make call to LB</li><li>dns entry specify the TTL to 60 seconds, this ensure that the IP addresses can be remapped quickly in response to changing traffic</li></ul></li></ul></li></ul><h1 id="2-ELB-Types"><a href="#2-ELB-Types" class="headerlink" title="2. ELB Types"></a>2. ELB Types</h1><p><a href="https://aws.amazon.com/elasticloadbalancing/features/#Product_comparisons" target="_blank" rel="noopener">https://aws.amazon.com/elasticloadbalancing/features/#Product_comparisons</a>  </p><h1 id="3-Network-Load-Balancer"><a href="#3-Network-Load-Balancer" class="headerlink" title="3. Network Load Balancer"></a>3. Network Load Balancer</h1><h2 id="3-1-NLB-Overview"><a href="#3-1-NLB-Overview" class="headerlink" title="3.1 NLB Overview"></a>3.1 NLB Overview</h2><ul><li>Similar to ELB overview, NLB has listener<ul><li>a listener checks for connection requests from clients, using the protocol and port number you configure, and then forwards requests to a target group</li></ul></li><li>you can configure your health checks on a per target group basis</li><li>Health checks are performed on all targets registered to a target group that is specified in a listener rule for your load balancer.</li><li>functions at 4th layer of OSI, capable of handling millions of requests per second<ul><li>when receives a connection request, it <strong>selects a target from the target group</strong> for the default rule</li><li>attempts to <strong>open a TCP connection</strong> to the selected target <strong>on the port specified</strong> in the listener configuration</li></ul></li></ul><h2 id="3-2-How-to-create-one-NLB-via-Console"><a href="#3-2-How-to-create-one-NLB-via-Console" class="headerlink" title="3.2 How to create one NLB via Console?"></a>3.2 How to create one NLB via Console?</h2><ul><li>Create a target group<ul><li>set target type, name, protocol, port number, health check method</li></ul></li><li>Configure load balancer and listener<ul><li>Network mapping<ul><li>select the VPC that you used for your EC2 instances</li><li>select AZ and then select public subnet for the AZ</li></ul></li></ul></li></ul><h2 id="3-3-Concepts"><a href="#3-3-Concepts" class="headerlink" title="3.3 Concepts"></a>3.3 Concepts</h2><ul><li>Listener<ul><li>A listener is a process that checks for connection requests, using the protocol and port that you configure. The rules that you define for a listener determine how the load balancer routes requests to the targets in one or more target groups.</li></ul></li><li>Target Groups<ul><li>Each target group is used to route requests to one or more registered targets. When you create a listener, you specify a target group for its default action. Traffic is forwarded to the target group specified in the listener rule. You can create different target groups for different types of requests</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Load Balancer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VPC General</title>
      <link href="/VPC-General/"/>
      <url>/VPC-General/</url>
      
        <content type="html"><![CDATA[<h1 id="VPC-General"><a href="#VPC-General" class="headerlink" title="VPC General"></a>VPC General</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>Enable you to launch AWS resources into a virtual network that youâ€™ve defined</li><li>VPC helps you to resemble a traditional network that youâ€™d operate in your own data center</li></ul><h2 id="1-1-Concepts"><a href="#1-1-Concepts" class="headerlink" title="1.1 Concepts"></a>1.1 Concepts</h2><ul><li>VPC</li><li>Subnet<ul><li>A range of IP addresses in the VPC</li></ul></li><li>Route Table<ul><li>A set of rules, called routes, used to determine where network traffic is directed</li></ul></li><li>Internet Gateway<ul><li>A gateway that you attach to your VPC to enable communication between resources in your VPC and the internet</li></ul></li><li>VPC endpoint<ul><li>Enable you to privately connect your VPC to supported AWS services and VPC endpoint services powered by PrivateLink without requiring an internet gateway , NAT device, VPN connection, or AWS Direct Connect Connenction</li></ul></li><li>CIDR block<ul><li>classless inter domain routing</li></ul></li></ul><h1 id="2-How-Amazon-VPC-Work"><a href="#2-How-Amazon-VPC-Work" class="headerlink" title="2. How Amazon VPC Work?"></a>2. How Amazon VPC Work?</h1><h2 id="2-1-VPC-and-Subnets"><a href="#2-1-VPC-and-Subnets" class="headerlink" title="2.1 VPC and Subnets"></a>2.1 VPC and Subnets</h2><ul><li>Use public subnet for resources that must be connected to the internet</li><li>Use private subnet for resources that wonâ€™t be connected to the internet</li><li>To protect the AWS resources in each subnet<ul><li>you could use Security groups, network access control lists</li></ul></li></ul><h2 id="2-2-Accessing-the-internet"><a href="#2-2-Accessing-the-internet" class="headerlink" title="2.2 Accessing the internet"></a>2.2 Accessing the internet</h2><ul><li>Both subnets are public, they have both private and public IP address</li><li>They could access internet via Internet gateway</li></ul><p><img src="https://i.loli.net/2021/03/03/zdUi1WXuODGofjK.png" alt="1.png"></p><ul><li>NAT Device vs Internet Gateway<ul><li>When using NAT, itâ€™s another layer of protection, but ultimately, you still need to use Internet Gateway</li><li>NAT  â€” network address translation device<ul><li>Allow instance in your VPC to instantiate outbound connections to the internet but prevent unsolicited inbound connections from the internet</li><li>It maps multiple private IPv4 addresses to a single public IPv4 address</li><li>A NAT device has an Elastic IP address and is connected to the internet through an internet gateway</li><li>You can connect an instance in a private subnet to the internet through the NAT device, which <strong>routes traffic from the instance to the internet gateway</strong>, and routes any responses to the instance.</li></ul></li></ul></li></ul><h2 id="2-3-Accessing-services-through-AWS-PrivateLink"><a href="#2-3-Accessing-services-through-AWS-PrivateLink" class="headerlink" title="2.3 Accessing services through AWS PrivateLink"></a>2.3 Accessing services through AWS PrivateLink</h2><ul><li><p>AWS PrivateLink enables you to privately connect your VPC to supported AWS services, services hosted by other AWS accounts (VPC endpoint services), and supported AWS Marketplace partner services.</p></li><li><p>To use AWS PrivateLink, create a VPC endpoint for a service in your VPC</p><ul><li><p>this creates an elastic network interface in your subnet with a private IP address that serves as an entry point for the traffic destined to the service</p><p>  <img src="https://i.loli.net/2021/03/03/KdQbqJLR2Or1DnB.png" alt="2.png"></p></li></ul></li></ul><h1 id="3-Getting-Started"><a href="#3-Getting-Started" class="headerlink" title="3. Getting Started"></a>3. Getting Started</h1><ul><li>Create a VPC with a /16 CIDR block<ul><li>has 65,536 private IP addresses</li></ul></li><li>attach an internet gateway to the VPC</li><li>for instances in public subnet, you need to assign an Elastic IP address to the instance</li><li>create a size /24 subnet in the VPC</li><li>create a custom route table, associate it with subnet<ul><li>to flow traffic between the subnet and the internet gateway</li></ul></li></ul><h2 id="3-1-EG-VPC-with-a-single-public-subnet"><a href="#3-1-EG-VPC-with-a-single-public-subnet" class="headerlink" title="3.1 EG - VPC with a single public subnet"></a>3.1 EG - VPC with a single public subnet</h2><h3 id="3-1-1-Basic-Setting"><a href="#3-1-1-Basic-Setting" class="headerlink" title="3.1.1 Basic Setting"></a>3.1.1 Basic Setting</h3><ul><li><p>VPC with/16 CIDR</p></li><li><p>subnet with /24 CIDR</p></li><li><p>internet gateway</p><ul><li>help connect the VPC to the internet and to other AWS services</li></ul></li><li><p>custom route table</p><ul><li><p>enable instances in the subnet to use IPV4 to communicate with other instances in the VPC</p><p><img src="https://i.loli.net/2021/03/03/PulS8ZxvFVXQtcJ.png" alt="3.png"></p></li></ul></li></ul><h3 id="3-1-2-Security"><a href="#3-1-2-Security" class="headerlink" title="3.1.2 Security"></a>3.1.2 Security</h3><ul><li>Security Groups<ul><li>control inbound and outbound traffic for your instances</li></ul></li><li>Network ACLs<ul><li>control inbound and outbound traffic for your subnets</li></ul></li></ul><p>See the recommended Security Group Setting and Network ACLs setting <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario1.html" target="_blank" rel="noopener">here</a> </p><h2 id="3-2-EG-VPC-with-Public-and-Private-subnets-NAT"><a href="#3-2-EG-VPC-with-Public-and-Private-subnets-NAT" class="headerlink" title="3.2 EG - VPC with Public and Private subnets (NAT)"></a>3.2 EG - VPC with Public and Private subnets (NAT)</h2><h3 id="3-2-1-Overview"><a href="#3-2-1-Overview" class="headerlink" title="3.2.1 Overview"></a>3.2.1 Overview</h3><ul><li><p>Scenario</p><ul><li>A public facing web application<ul><li>maintain back end servers that are not publicly accessible</li><li>database server in private subnet while the webserver in a public subnet</li></ul></li></ul></li><li><p>Public subnet vs private subnet</p><ul><li><p>instances in the public subnet can send outbound traffic directly to the internet, whereas the instances in the private subnet canâ€™t</p></li><li><p>the instances in the private subnet can access the Internet by using a network address translation (NAT) gateway that resides in the public subnet</p></li><li><p>The database servers can connect to the Internet for software updates using the NAT gateway, but the Internet cannot establish connections to the database servers</p><p><img src="https://i.loli.net/2021/03/03/cb6tYu79jkWyMOH.png" alt="4.png"></p><h3 id="3-2-2-Security-Setting"><a href="#3-2-2-Security-Setting" class="headerlink" title="3.2.2 Security Setting"></a>3.2.2 Security Setting</h3><p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html" target="_blank" rel="noopener">VPC with public and private subnets (NAT)</a></p><h2 id="3-3-Sharing-Public-Subnets-and-Private-Subnets"><a href="#3-3-Sharing-Public-Subnets-and-Private-Subnets" class="headerlink" title="3.3 Sharing Public Subnets and Private Subnets"></a>3.3 Sharing Public Subnets and Private Subnets</h2></li><li><p>still need to leverage on PrivateLinks, VPC Peering, etc.</p><p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/example-vpc-share.html" target="_blank" rel="noopener">Example: Sharing public subnets and private subnets</a></p></li><li><p>Consider this scenario where you want an account to be responsible for the infrastructure, including subnets, route tables, gateways, and CIDR ranges and other accounts that are in the same AWS Organization to use the subnets. A VPC owner (Account A) creates the routing infrastructure, including the VPCs, subnets, route tables, gateways, and network ACLs. Account D wants to create public facing applications. Account B and Account C want to create private applications that do not need to connect to the internet and should reside in private subnets. Account A can use AWS Resource Access Manager to create a Resource Share for the subnets and then share the subnets. Account A shares the public subnet with Account D and the private subnet with Account B, and Account C. Account B, Account C, and Account D can create resources in the subnets. Each account can only see the subnets that are shared with them, for example, Account D can only see the public subnet. Each of the accounts can control their resources, including instances, and security groups.</p><p><a href="https://aws.amazon.com/cn/blogs/networking-and-content-delivery/vpc-sharing-a-new-approach-to-multiple-accounts-and-vpc-management/" target="_blank" rel="noopener">VPC sharing: A new approach to multiple accounts and VPC management | Amazon Web Services</a></p><h2 id="3-4-Service-using-AWS-PrivateLink-and-VPC-Peering"><a href="#3-4-Service-using-AWS-PrivateLink-and-VPC-Peering" class="headerlink" title="3.4 Service using AWS PrivateLink and VPC Peering"></a>3.4 Service using AWS PrivateLink and VPC Peering</h2><p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-peer-region-example.html" target="_blank" rel="noopener">Examples: Services using AWS PrivateLink and VPC peering</a></p><p><a href="https://www.notion.so/PrivateLinks-e8e5f6802544401299fc3be21b10ed06" target="_blank" rel="noopener">PrivateLinks</a></p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥</title>
      <link href="/%E4%BA%92%E8%81%94%E7%BD%91%E5%B9%BF%E5%91%8A%E7%AB%9E%E4%BB%B7%E7%AD%96%E7%95%A5/"/>
      <url>/%E4%BA%92%E8%81%94%E7%BD%91%E5%B9%BF%E5%91%8A%E7%AB%9E%E4%BB%B7%E7%AD%96%E7%95%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥"><a href="#äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥" class="headerlink" title="äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥"></a>äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥</h1><h1 id="1-ä¼ ç»Ÿç«ä»·ç­–ç•¥"><a href="#1-ä¼ ç»Ÿç«ä»·ç­–ç•¥" class="headerlink" title="1. ä¼ ç»Ÿç«ä»·ç­–ç•¥"></a>1. ä¼ ç»Ÿç«ä»·ç­–ç•¥</h1><h2 id="1-1-è‹±å¼æ‹å–-å…¬å¼€å¢ä»·æ‹å–OAB"><a href="#1-1-è‹±å¼æ‹å–-å…¬å¼€å¢ä»·æ‹å–OAB" class="headerlink" title="1.1 è‹±å¼æ‹å–/ å…¬å¼€å¢ä»·æ‹å–OAB"></a>1.1 è‹±å¼æ‹å–/ å…¬å¼€å¢ä»·æ‹å–OAB</h2><ul><li>OAB<ul><li>Open Ascending Bid</li></ul></li><li>å–å®¶æä¾›ç‰©å“ï¼Œåœ¨ç‰©å“æ‹å–è¿‡ç¨‹ä¸­ï¼Œä¹°å®¶æŒ‰ç…§ç«ä»·é˜¶æ¢¯ç”±ä½è‡³é«˜å–Šä»·ï¼Œå‡ºä»·æœ€é«˜è€…æˆä¸ºç«ä¹°çš„èµ¢å®¶</li><li>ä¸€èˆ¬ä¼šä¸ºç«ä»·è®¾å®šä¸€ä¸ªç»ˆæ­¢æ—¶é—´</li></ul><h2 id="1-2-è·å…°å¼æ‹å–-Sealed-Bid-Auction"><a href="#1-2-è·å…°å¼æ‹å–-Sealed-Bid-Auction" class="headerlink" title="1.2 è·å…°å¼æ‹å– Sealed Bid Auction"></a>1.2 è·å…°å¼æ‹å– Sealed Bid Auction</h2><ul><li>ç«ä»·ç”±é«˜åˆ°ä½</li><li>é€’å‡ç›´åˆ°ç¬¬ä¸€ä¸ªä¹°å®¶åº”ä»·æˆäº¤</li></ul><h2 id="1-3-ç¬¬ä¸€ä»·æ ¼å¯†å°æ‹å–-FPSB"><a href="#1-3-ç¬¬ä¸€ä»·æ ¼å¯†å°æ‹å–-FPSB" class="headerlink" title="1.3 ç¬¬ä¸€ä»·æ ¼å¯†å°æ‹å– FPSB"></a>1.3 ç¬¬ä¸€ä»·æ ¼å¯†å°æ‹å– FPSB</h2><ul><li>FPSB<ul><li>The first price sealed auction</li></ul></li><li>ä¹°æ–¹å°†è‡ªå·±çš„å‡ºä»·å†™åœ¨ä¸€ä¸ªä¿¡å°é‡Œé¢ï¼Œä¼—å¤šä¹°æ–¹è¿›è¡ŒæŠ•æ ‡ï¼ŒåŒä¸€æ—¶é—´æ­æ™“ä¿¡å°ä»·æ ¼ï¼Œå‡ºä»·æœ€é«˜è€…ç«ä»·æˆåŠŸ</li></ul><h2 id="1-4-ç¬¬äºŒä»·æ ¼å¯†å°æ‹å–-SPSB"><a href="#1-4-ç¬¬äºŒä»·æ ¼å¯†å°æ‹å–-SPSB" class="headerlink" title="1.4 ç¬¬äºŒä»·æ ¼å¯†å°æ‹å– SPSB"></a>1.4 ç¬¬äºŒä»·æ ¼å¯†å°æ‹å– SPSB</h2><ul><li>SPSB<ul><li>The Second Price Sealed Auction</li></ul></li><li>ä¹°æ–¹å°†è‡ªå·±çš„å‡ºä»·å†™åœ¨ä¸€ä¸ªä¿¡å°é‡Œé¢ï¼Œä¼—å¤šä¹°æ–¹è¿›è¡ŒæŠ•æ ‡ï¼ŒåŒä¸€æ—¶é—´æ­æ™“ä¿¡å°ä»·æ ¼ï¼Œå‘¦å‡ºä»·æœ€é«˜çš„ä¹°å®¶è·å¾—ç‰©å“ï¼Œä½†ä»–åªéœ€è¦æ”¯ä»˜<strong>æ‰€æœ‰æŠ•æ ‡è€…ä¸­çš„ç¬¬äºŒé«˜ä»·</strong></li></ul><h1 id="2-äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥"><a href="#2-äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥" class="headerlink" title="2. äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥"></a>2. äº’è”ç½‘å¹¿å‘Šç«ä»·ç­–ç•¥</h1><h2 id="2-1-å¹¿ä¹‰ç¬¬ä¸€ä»·æ ¼GFP-Generalized-First-Price"><a href="#2-1-å¹¿ä¹‰ç¬¬ä¸€ä»·æ ¼GFP-Generalized-First-Price" class="headerlink" title="2.1 å¹¿ä¹‰ç¬¬ä¸€ä»·æ ¼GFP - Generalized First Price"></a>2.1 å¹¿ä¹‰ç¬¬ä¸€ä»·æ ¼GFP - Generalized First Price</h2><ul><li>å‡ºä»·é«˜è€…å¾—ï¼Œéœ€è¦æ”¯ä»˜è‡ªå·±æå‡ºçš„æŠ¥ä»·</li><li>æœç´¢å¹¿å‘Šç«ä»·å¾€å¾€æŒ‰ç…§è¿™ç§å½¢å¼ï¼Œç¼ºç‚¹æ˜¯<ul><li>å¹³å°æ–¹æ”¶ç›Šä¸ç¨³å®š</li><li>ç«ä»·æ•ˆç‡ä¸é«˜</li></ul></li><li>åªè€ƒè™‘åˆ°å‡ºä»·æ²¡è€ƒè™‘åˆ°ç‚¹å‡»ç‡ï¼Œ</li><li>ä»·æ ¼ä¸Šä¼šå› ä¸ºç›¸äº’å¹¿å‘Šå•†ä¹‹é—´çš„æ¯”è¾ƒï¼Œåœ¨ä¸€å®šèŒƒå›´å†…å½¢æˆæ³¢åŠ¨</li></ul><h2 id="2-2-å¹¿ä¹‰ç¬¬äºŒä»·æ ¼GSP-Generalized-Second-Price"><a href="#2-2-å¹¿ä¹‰ç¬¬äºŒä»·æ ¼GSP-Generalized-Second-Price" class="headerlink" title="2.2 å¹¿ä¹‰ç¬¬äºŒä»·æ ¼GSP - Generalized Second Price"></a>2.2 å¹¿ä¹‰ç¬¬äºŒä»·æ ¼GSP - Generalized Second Price</h2><ul><li>å‡ºä»·é«˜è€…å¾—åˆ°å¹¿å‘Šä½ï¼Œéœ€è¦æ”¯ä»˜çš„æ˜¯ç¬¬äºŒé«˜è€…æå‡ºçš„æŠ¥ä»·åŠ ä¸Šä¸€ä¸ªæœ€å°å€¼</li><li>ä¸è¶³ä¹‹å¤„åœ¨äºä¸æ˜¯ä¸€ç§é¼“åŠ±è®²çœŸè¯çš„æ–¹å¼ï¼Œå¤§å®¶æœ‰å¯èƒ½éƒ½ä¼šå†™ä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œè®¤ä¸ºä¼šç”¨åˆ°å…¶ä»–äººæ ‡è¯†çš„ä»·æ ¼ï¼Œæ‰€ä»¥æ•´ä¸ªè§£ä¸ä¸€å®šæ˜¯å…¨å±€æœ€ä¼˜åŒ–çš„</li><li>è¿™é‡Œçš„æ’åºå¯ä»¥é€šè¿‡å¹¿å‘Šçš„å‡ºä»·æ’åºï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœŸæœ›æ”¶ç›Šæœ€å¤§æ¥æ’åºï¼Œå³CTR x bid</li></ul><h2 id="2-3-VCG-Vickrey-Clarke-Groves"><a href="#2-3-VCG-Vickrey-Clarke-Groves" class="headerlink" title="2.3 VCG - Vickrey Clarke Groves"></a>2.3 VCG - Vickrey Clarke Groves</h2><ul><li>å¹¿å‘Šä¸»ä¸ºç½‘æ°‘çš„ä¸€æ¬¡ç‚¹å‡»æ”¯ä»˜ä»–å¯¹å…¶ä»–å¹¿å‘Šä¸»é€ æˆçš„æ•ˆç”¨æŸå¤±</li><li>ä½†æ˜¯è¿™ç§æ•ˆç”¨æŸå¤±åœ¨å®é™…åœºæ™¯ä¸­ä¼šéå¸¸éš¾ä»¥è®¡ç®—</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.geek-share.com/detail/2606975685.html" target="_blank" rel="noopener">https://www.geek-share.com/detail/2606975685.html</a> </li><li><a href="https://www.wandouip.com/t5i229763/" target="_blank" rel="noopener">https://www.wandouip.com/t5i229763/</a></li><li><a href="https://en.wikipedia.org/wiki/Vickrey%E2%80%93Clarke%E2%80%93Groves_auction" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Vickreyâ€“Clarkeâ€“Groves_auction</a>  </li><li><a href="https://en.wikipedia.org/wiki/Vickrey%E2%80%93Clarke%E2%80%93Groves_auction" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Vickreyâ€“Clarkeâ€“Groves_auction</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis æ•°æ®ç»“æ„ä½¿ç”¨</title>
      <link href="/Redis-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BD%BF%E7%94%A8/"/>
      <url>/Redis-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis-æ•°æ®ç»“æ„ä½¿ç”¨"><a href="#Redis-æ•°æ®ç»“æ„ä½¿ç”¨" class="headerlink" title="Redis æ•°æ®ç»“æ„ä½¿ç”¨"></a>Redis æ•°æ®ç»“æ„ä½¿ç”¨</h1><h1 id="1-Stringçš„å†…å­˜ç©ºé—´æ¶ˆè€—é—®é¢˜"><a href="#1-Stringçš„å†…å­˜ç©ºé—´æ¶ˆè€—é—®é¢˜" class="headerlink" title="1. Stringçš„å†…å­˜ç©ºé—´æ¶ˆè€—é—®é¢˜"></a>1. Stringçš„å†…å­˜ç©ºé—´æ¶ˆè€—é—®é¢˜</h1><h2 id="1-1-Stringåœ¨ä¿å­˜æ•°æ®æ—¶å†…å­˜ç©ºé—´æ¶ˆè€—è¾ƒå¤š"><a href="#1-1-Stringåœ¨ä¿å­˜æ•°æ®æ—¶å†…å­˜ç©ºé—´æ¶ˆè€—è¾ƒå¤š" class="headerlink" title="1.1 Stringåœ¨ä¿å­˜æ•°æ®æ—¶å†…å­˜ç©ºé—´æ¶ˆè€—è¾ƒå¤š"></a>1.1 Stringåœ¨ä¿å­˜æ•°æ®æ—¶å†…å­˜ç©ºé—´æ¶ˆè€—è¾ƒå¤š</h2><ul><li>Stringç±»å‹é™¤äº†å®é™…è®°å½•çš„æ•°æ®ï¼Œè¿˜éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´è®°å½•æ•°æ®é•¿åº¦ï¼Œç©ºé—´ä½¿ç”¨ç­‰ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯è¢«ç§°ä¸ºå…ƒæ•°æ®</li><li>å½“å®é™…ä¿å­˜çš„æ•°æ®æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œå…ƒæ•°æ®çš„ç©ºé—´å¼€é”€å°±ä¼šæ¯”è¾ƒå¤§</li><li>å½“ä¿å­˜64ä½æœ‰ç¬¦å·æ•´æ•°çš„æ—¶å€™<ul><li>Stringç±»å‹ä¼šå°†å…¶ä¿å­˜ä¸ºä¸€ä¸ª8å­—èŠ‚çš„Longç±»å‹æ•´æ•°</li><li>intç¼–ç æ–¹å¼</li></ul></li><li>å½“ä¿å­˜çš„æ•°æ®ä¸­åŒ…å«å­—ç¬¦çš„æ—¶å€™<ul><li>String ç”¨ç®€å•åŠ¨æ€å­—ç¬¦ä¸² Simple Dynamic String ï¼Œ å…±æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ<ul><li>buf<ul><li>å­—èŠ‚æ•°ç»„ï¼Œä¿å­˜å®é™…æ•°æ®</li><li>ä¸ºäº†è¡¨ç¤ºå­—èŠ‚æ•°ç»„çš„ç»“æŸï¼Œä¼šåœ¨æ•°ç»„æœ€ååŠ ä¸€ä¸ª\0. è¿™é‡Œä¼šé¢å¤–å ç”¨ä¸€ä¸ªå­—èŠ‚çš„å¼€é”€</li></ul></li><li>len<ul><li>å å››ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºbufçš„å·²ç”¨é•¿åº¦</li></ul></li><li>alloc<ul><li>å å››ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºbufçš„å®é™…åˆ†é…é•¿åº¦ï¼Œä¸€èˆ¬æ¥è¯´ä¼šå¤§äºlen</li></ul></li></ul></li><li>æ•…è€Œåœ¨ä¸Šè¿°çš„åˆ†æå½“ä¸­ï¼Œlen å’Œallocå°±æ˜¯å…ƒæ•°æ®ï¼Œå¸¦æ¥äº†ä¸€éƒ¨åˆ†çš„é¢å¤–å¼€é”€</li></ul></li></ul><h2 id="1-2-RedisObject-çš„ç»“æ„"><a href="#1-2-RedisObject-çš„ç»“æ„" class="headerlink" title="1.2 RedisObject çš„ç»“æ„"></a>1.2 RedisObject çš„ç»“æ„</h2><ul><li><p>Redisæœ¬èº«æ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼Œè€Œä¸åŒæ•°æ®ç±»å‹éƒ½ä¼šæœ‰ä¸€äº›ç›¸åŒçš„å…ƒæ•°æ®éœ€è¦è®°å½•</p><ul><li>æœ€åä¸€æ¬¡è®¿é—®çš„æ—¶é—´</li><li>è¢«å¼•ç”¨çš„æ¬¡æ•°ç­‰</li></ul></li><li><p>å› æ­¤Redisä¼šç”¨ä¸€ä¸ªRedisObjectç»“æ„ä½“æ¥ç»Ÿä¸€è®°å½•è¿™äº›å…ƒæ•°æ®ï¼ŒåŒæ—¶æŒ‡å‘å®é™…æ•°æ®</p></li><li><p>å¦å¤–å‡ºäºèŠ‚çœå†…å­˜ç©ºé—´çš„è€ƒè™‘</p><ul><li><p>å½“ä¿å­˜çš„æ˜¯Longç±»å‹æ•´æ•°æ—¶ï¼ŒRedisObjectä¸­çš„æŒ‡é’ˆå°±ç›´æ¥èµ‹å€¼ä¸ºæ•´æ•°æ•°æ®äº†ï¼Œè¿™æ ·å°±ä¸ç”¨é¢å¤–çš„æŒ‡é’ˆå†æŒ‡å‘æ•´æ•°ï¼ŒèŠ‚çœäº†æŒ‡é’ˆçš„ç©ºé—´å¼€é”€</p></li><li><p>å½“ä¿å­˜çš„æ˜¯å­—ç¬¦ä¸²æ•°æ®ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²å°äºç­‰äº44ä¸ªå­—èŠ‚ï¼ŒRedisObjectä¸­çš„å…ƒæ•°æ®ï¼ŒæŒ‡é’ˆçš„SDSæ˜¯ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œæ¥é¿å…å†…å­˜ç¢ç‰‡</p></li><li><p>å½“ä¿å­˜çš„æ•°æ®é‡å¤§äº44å­—èŠ‚çš„æ—¶å€™ï¼ŒSDSçš„æ•°æ®é‡å°±ä¼šå˜å¤šï¼ŒRediså°±ä¸å†æŠŠSDSå’ŒRedisObjectå¸ƒå±€åœ¨ä¸€èµ·äº†ï¼Œä¼šç»™SDSåˆ†é…ç‹¬ç«‹çš„ç©ºé—´ï¼Œå¹¶ä¸”ç”¨æŒ‡é’ˆæŒ‡å‘SDSç»“æ„</p><p><img src="https://i.loli.net/2021/02/09/JoY9Hi8NqIElBDW.png" alt="Redis Object"></p></li></ul></li><li><p>åœ¨è®¡ç®—æ€»å…±æ¶ˆè€—çš„å†…å­˜çš„æ—¶å€™ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯é™¤äº†ä½¿ç”¨RedisObjectæœ¬èº«ï¼ŒRedisè¿˜ç»´æŠ¤äº†ä¸€ä¸ªå…¨å±€å“ˆå¸Œè¡¨æ¥ä¿å­˜æ‰€æœ‰é”®å€¼å¯¹ï¼Œè¿™ä¸ªç»“æ„ä½“æœ‰ä¸‰ä¸ª8å­—èŠ‚çš„æŒ‡é’ˆï¼Œå…±24å­—èŠ‚ã€‚Redisä½¿ç”¨çš„æ˜¯jemallocå†…å­˜åˆ†é…åº“ï¼Œä¼šæ ¹æ®ç”³è¯·çš„å­—èŠ‚æ•°Nï¼Œæ‰¾ä¸€ä¸ªæ¯”Nå¤§ï¼Œä½†æ˜¯æœ€æ¥è¿‘Nçš„2çš„å¹‚æ¬¡æ•°ä½œä¸ºåˆ†é…çš„ç©ºé—´ï¼Œæ¥å‡å°‘é¢‘ç¹åˆ†é…çš„æ¬¡æ•°</p></li></ul><p><img src="https://i.loli.net/2021/02/09/xO2vECGYoRdl4jB.png" alt="RedisObject Entity"></p><h1 id="2-å‹ç¼©åˆ—è¡¨"><a href="#2-å‹ç¼©åˆ—è¡¨" class="headerlink" title="2. å‹ç¼©åˆ—è¡¨"></a>2. å‹ç¼©åˆ—è¡¨</h1><ul><li><p>å‹ç¼©åˆ—è¡¨çš„æ„æˆ</p><p>  <img src="https://i.loli.net/2021/02/18/ALm8GYT2r7cRXqW.png" alt="å‹ç¼©åˆ—è¡¨æ„æˆ"></p><ul><li><p>è¡¨å¤´</p><ul><li>zlbytes â€” åˆ—è¡¨é•¿åº¦</li><li>zltail â€” åˆ—è¡¨å°¾</li><li>zllen â€” åˆ—è¡¨entryä¸ªæ•°</li></ul></li><li><p>è¡¨å°¾</p><ul><li>zlend â€” åˆ—è¡¨ç»“æŸ</li></ul></li><li><p>è¡¨entry</p><ul><li>æ˜¯è¿ç»­çš„entry<ul><li>å› ä¸ºæ˜¯æŒ¨ç€æ¥è¿›è¡Œæ”¾ç½®çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å†ä½¿ç”¨é¢å¤–çš„æŒ‡é’ˆè¿›è¡Œè¿æ¥ï¼Œå°±å¯ä»¥èŠ‚çœæŒ‡é’ˆæ‰€å ç”¨çš„ç©ºé—´äº†</li></ul></li><li>åŒ…æ‹¬ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š<ul><li>prev_len â€” å‰ä¸€ä¸ªentryçš„é•¿åº¦</li><li>len â€” è‡ªèº«é•¿åº¦  4å­—èŠ‚</li><li>encoding â€” ç¼–ç æ–¹å¼ 1å­—èŠ‚</li><li>content â€” ä¿å­˜å®é™…æ•°æ®</li></ul></li></ul></li><li><p>Redis Hashç±»å‹åº•å±‚æœ‰ä¸¤ç§å®ç°ç»“æ„</p><ul><li>å‹ç¼©åˆ—è¡¨</li><li>å“ˆå¸Œè¡¨</li></ul></li><li><p>é€šè¿‡é˜ˆå€¼ç¡®å®šåº”è¯¥ä½¿ç”¨å“ªä¸€ç§æ¥ä¿å­˜æ•°æ®</p><ul><li>hash-max-ziplist-entriesï¼šè¡¨ç¤ºç”¨å‹ç¼©åˆ—è¡¨ä¿å­˜æ—¶å“ˆå¸Œé›†åˆä¸­çš„æœ€å¤§å…ƒç´ ä¸ªæ•°ã€‚</li><li>hash-max-ziplist-valueï¼šè¡¨ç¤ºç”¨å‹ç¼©åˆ—è¡¨ä¿å­˜æ—¶å“ˆå¸Œé›†åˆä¸­å•ä¸ªå…ƒç´ çš„æœ€å¤§é•¿åº¦ã€‚</li></ul></li></ul></li></ul><h1 id="3-é›†åˆçš„ä½¿ç”¨"><a href="#3-é›†åˆçš„ä½¿ç”¨" class="headerlink" title="3. é›†åˆçš„ä½¿ç”¨"></a>3. é›†åˆçš„ä½¿ç”¨</h1><ul><li>ä½¿ç”¨åœºæ™¯<ul><li>ä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªæ•°æ®é›†åˆ<ul><li>æ¯”å¦‚æ‰‹æœºappçš„ç”¨æˆ·ç™»å½•ä¿¡æ¯ â€” ä¸€å¤©å¯¹åº”ä¸€ç³»åˆ—ç”¨æˆ·IDæˆ–è€…ç§»åŠ¨è®¾å¤‡ID</li><li>ç”µå•†å•†å“ç”¨æˆ·è¯„ä»·åˆ—è¡¨ â€” ä¸€ä¸ªå•†å“å¯¹åº”ä¸€ç³»åˆ—è¯„è®º</li></ul></li><li>åœ¨è¿™æ ·å­çš„åœºæ™¯å½“ä¸­ï¼Œé™¤äº†è®°å½•ä¿¡æ¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹é›†åˆå½“ä¸­çš„æ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œè€Œæˆ‘ä»¬é€‰ç”¨çš„æ•°æ®ç±»å‹å¿…é¡»èƒ½å¤Ÿé«˜æ•ˆçš„ç»Ÿè®¡è¿™äº›æ•°æ®</li></ul></li></ul><h2 id="3-1-èšåˆç»Ÿè®¡"><a href="#3-1-èšåˆç»Ÿè®¡" class="headerlink" title="3.1 èšåˆç»Ÿè®¡"></a>3.1 èšåˆç»Ÿè®¡</h2><ul><li><p>å®šä¹‰</p><ul><li>æŒ‡ç»Ÿè®¡å¤šä¸ªé›†åˆå…ƒç´ çš„èšåˆç»“æœ</li></ul></li><li><p>ä¾‹å­</p><ul><li>ç»Ÿè®¡å¤šä¸ªé›†åˆçš„å…±æœ‰å…ƒç´ </li><li>å°†ä¸¤ä¸ªé›†åˆç›¸æ¯”ï¼Œç»Ÿè®¡å…¶ä¸­ä¸€ä¸ªé›†åˆç‹¬æœ‰çš„å…ƒç´ </li><li>ç»Ÿè®¡å¤šä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ </li></ul></li><li><p>å½“ä½ éœ€è¦å¯¹å¤šä¸ªé›†åˆè¿›è¡Œèšåˆè®¡ç®—æ—¶ï¼ŒSet ç±»å‹ä¼šæ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©ã€‚</p></li><li><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é£é™©ã€‚Set çš„å·®é›†ã€å¹¶é›†å’Œäº¤é›†çš„è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œåœ¨æ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç›´æ¥æ‰§è¡Œè¿™äº›è®¡ç®—ï¼Œä¼šå¯¼è‡´ Redis å®ä¾‹é˜»å¡ã€‚</p><ul><li>ä½ å¯ä»¥ä»ä¸»ä»é›†ç¾¤ä¸­é€‰æ‹©ä¸€ä¸ªä»åº“ï¼Œè®©å®ƒä¸“é—¨è´Ÿè´£èšåˆè®¡ç®—</li><li>æˆ–è€…æ˜¯æŠŠæ•°æ®è¯»å–åˆ°å®¢æˆ·ç«¯ï¼Œåœ¨å®¢æˆ·ç«¯æ¥å®Œæˆèšåˆç»Ÿè®¡ï¼Œè¿™æ ·å°±å¯ä»¥è§„é¿é˜»å¡ä¸»åº“å®ä¾‹å’Œå…¶ä»–ä»åº“å®ä¾‹çš„é£é™©äº†ã€‚</li></ul></li></ul><h2 id="3-2-æ’åºç»Ÿè®¡"><a href="#3-2-æ’åºç»Ÿè®¡" class="headerlink" title="3.2 æ’åºç»Ÿè®¡"></a>3.2 æ’åºç»Ÿè®¡</h2><ul><li>E.G<ul><li>ç”µå•†ç½‘ç«™æä¾›æœ€æ–°è¯„è®ºåˆ—è¡¨ï¼Œéœ€è¦ä½¿å¾—é›†åˆå½“ä¸­çš„å…ƒç´ å¯ä»¥æŒ‰åºæ’åˆ—<ul><li>Listå’ŒSorted Setå±äºæœ‰åºé›†åˆ</li><li>ListæŒ‰ç…§å…ƒç´ è¿›å…¥Listçš„é¡ºåºè¿›è¡Œæ’åºï¼Œè€ŒSorted Setæ ¹æ®å…ƒç´ çš„æƒé‡æ¥æ’åº</li></ul></li></ul></li><li>ä½¿ç”¨listæ¥åšæ’åºçš„é—®é¢˜åœ¨äºæ˜¯é€šè¿‡å…ƒç´ åœ¨Listå½“ä¸­çš„ä½ç½®æ¥æ’åºï¼Œæ–°å…ƒç´ æ’å…¥ä¼šæ”¹å˜åŸæœ‰çš„é¡ºåºï¼Œéƒ½ä¼šé¡ºæ¬¡åç§»</li><li>Sorted Setç›¸å¯¹åº”çš„æ˜¯æ ¹æ®å…ƒç´ çš„å®é™…æƒé‡æ¥æ’åºå’Œè·å–æ•°æ®<ul><li>Sorted Set çš„ ZRANGEBYSCORE å‘½ä»¤å°±å¯ä»¥æŒ‰æƒé‡æ’åºåè¿”å›å…ƒç´ ã€‚è¿™æ ·çš„è¯ï¼Œå³ä½¿é›†åˆä¸­çš„å…ƒç´ é¢‘ç¹æ›´æ–°ï¼ŒSorted Set ä¹Ÿèƒ½é€šè¿‡ ZRANGEBYSCORE å‘½ä»¤å‡†ç¡®åœ°è·å–åˆ°æŒ‰åºæ’åˆ—çš„æ•°æ®ã€‚</li></ul></li></ul><h2 id="3-3-äºŒå€¼çŠ¶æ€ç»Ÿè®¡"><a href="#3-3-äºŒå€¼çŠ¶æ€ç»Ÿè®¡" class="headerlink" title="3.3 äºŒå€¼çŠ¶æ€ç»Ÿè®¡"></a>3.3 äºŒå€¼çŠ¶æ€ç»Ÿè®¡</h2><ul><li>é›†åˆå…ƒç´ çš„å–å€¼åªæœ‰0å’Œ1ä¸¤ç§<ul><li>å¯ä»¥å¯¹äºæ•°æ®ç»“æ„è¿›è¡Œä¼˜åŒ–ï¼Œä½¿ç”¨Bitmap</li><li>Bitmapæœ¬èº«æ˜¯ä½¿ç”¨Stringç±»å‹ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„æ¥å®ç°çš„ä¸€ç§ç»Ÿè®¡äºŒå€¼çŠ¶æ€çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€ä¸ªbitæ•°ç»„</li></ul></li><li>æŸ¥çœ‹ç­¾åˆ°æƒ…å†µçš„åŸºæœ¬æ“ä½œ</li></ul><pre><code class="jsx">// è®°å½•8.3 ç­¾åˆ°SETBIT uid:sign:3000:202008 2 1// æŸ¥è¯¢8.3æ˜¯å¦ç­¾åˆ°GETBIT uid:sign:3000:202008 2// ç»Ÿè®¡è¯¥ç”¨æˆ·20å¹´8æœˆä»½çš„ç­¾åˆ°æ¬¡æ•°BITCOUNT uid:sign:3000:202008</code></pre><ul><li>ç»Ÿè®¡åº”ç”¨å½“ä¸­10å¤©è¿ç»­ç­¾åˆ°çš„ç”¨æˆ·æ•°é‡<ul><li>Bitmapæ”¯æŒä½¿ç”¨BITOPå‘½ä»¤æ¥å¯¹å¤šä¸ªBitmapæŒ‰ä½åšä¸ï¼Œæˆ–ï¼Œå¼‚æˆ–ï¼Œçš„æ“ä½œï¼Œæ“ä½œç»“æœä¼šä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„bitmapå½“ä¸­</li><li>åœ¨ç»Ÿè®¡ 1 äº¿ä¸ªç”¨æˆ·è¿ç»­ 10 å¤©çš„ç­¾åˆ°æƒ…å†µæ—¶ï¼Œä½ å¯ä»¥æŠŠæ¯å¤©çš„æ—¥æœŸä½œä¸º keyï¼Œæ¯ä¸ª key å¯¹åº”ä¸€ä¸ª 1 äº¿ä½çš„ Bitmapï¼Œæ¯ä¸€ä¸ª bit å¯¹åº”ä¸€ä¸ªç”¨æˆ·å½“å¤©çš„ç­¾åˆ°æƒ…å†µã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹ 10 ä¸ª Bitmap åšâ€œä¸â€æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸€ä¸ª Bitmapã€‚åœ¨è¿™ä¸ª Bitmap ä¸­ï¼Œåªæœ‰ 10 å¤©éƒ½ç­¾åˆ°çš„ç”¨æˆ·å¯¹åº”çš„ bit ä½ä¸Šçš„å€¼æ‰ä¼šæ˜¯ 1ã€‚æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ BITCOUNT ç»Ÿè®¡ä¸‹ Bitmap ä¸­çš„ 1 çš„ä¸ªæ•°ï¼Œè¿™å°±æ˜¯è¿ç»­ç­¾åˆ° 10 å¤©çš„ç”¨æˆ·æ€»æ•°äº†ã€‚</li></ul></li></ul><h2 id="3-4-åŸºæ•°ç»Ÿè®¡"><a href="#3-4-åŸºæ•°ç»Ÿè®¡" class="headerlink" title="3.4 åŸºæ•°ç»Ÿè®¡"></a>3.4 åŸºæ•°ç»Ÿè®¡</h2><ul><li>ç»Ÿè®¡ä¸€ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ ä¸ªæ•° â€” ç»Ÿè®¡ç½‘é¡µçš„UV<ul><li>éœ€è¦å»é‡ â€” ä¸€ä¸ªç”¨æˆ·ä¸€å¤©å†…çš„å¤šæ¬¡è®¿é—®åªèƒ½ç®—ä¸€æ¬¡</li><li>ä½¿ç”¨set æˆ–è€…hashçš„è¯éƒ½ä¼šéœ€è¦å°†ä¸åŒçš„idè®°å½•ä¸‹æ¥ï¼Œæœ€åçœ‹æ•´ä¸ªæ•°æ®ç»“æ„å†…å…ƒç´ çš„æ•°é‡ï¼Œä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå ç”¨å†…å­˜</li></ul></li><li>HyperLogLog<ul><li>ç”¨äºç»Ÿè®¡åŸºæ•°çš„æ•°æ®é›†åˆ<ul><li>å½“é›†åˆå…ƒç´ æ•°é‡éå¸¸å¤šçš„æ—¶å€™ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”æ¯”è¾ƒå°</li><li>æœ‰ä¸€ç‚¹éœ€è¦ä½ æ³¨æ„ä¸€ä¸‹ï¼ŒHyperLogLog çš„ç»Ÿè®¡è§„åˆ™æ˜¯åŸºäºæ¦‚ç‡å®Œæˆçš„ï¼Œæ‰€ä»¥å®ƒç»™å‡ºçš„ç»Ÿè®¡ç»“æœæ˜¯æœ‰ä¸€å®šè¯¯å·®çš„ï¼Œæ ‡å‡†è¯¯ç®—ç‡æ˜¯ 0.81%ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œä½ ä½¿ç”¨ HyperLogLog ç»Ÿè®¡çš„ UV æ˜¯ 100 ä¸‡ï¼Œä½†å®é™…çš„ UV å¯èƒ½æ˜¯ 101 ä¸‡ã€‚è™½ç„¶è¯¯å·®ç‡ä¸ç®—å¤§ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ éœ€è¦ç²¾ç¡®ç»Ÿè®¡ç»“æœçš„è¯ï¼Œæœ€å¥½è¿˜æ˜¯ç»§ç»­ç”¨ Set æˆ– Hash ç±»å‹ã€‚</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>lsof/ ulimit/ ps</title>
      <link href="/lsof-ulimit-ps/"/>
      <url>/lsof-ulimit-ps/</url>
      
        <content type="html"><![CDATA[<h1 id="1-lsof"><a href="#1-lsof" class="headerlink" title="1. lsof"></a>1. lsof</h1><h1 id="1-1-File-Descriptor-in-Linux"><a href="#1-1-File-Descriptor-in-Linux" class="headerlink" title="1.1 File Descriptor in Linux"></a>1.1 File Descriptor in Linux</h1><ul><li>Linux consider everything as a file<ul><li>pipes, sockets, directories, devices, etc</li></ul></li></ul><h1 id="1-2-What-does-lsof-do"><a href="#1-2-What-does-lsof-do" class="headerlink" title="1.2 What does lsof do?"></a>1.2 What does lsof do?</h1><ul><li>lsof means â€” List Open Files</li><li>some columns need to understand<ul><li>FD<ul><li>stands for file descriptor</li><li>possible values<ul><li>cwd â€” current working directory</li><li>rtd â€” root directory</li><li>txt â€” program text</li><li>mem â€” memory mapped file</li><li>(number)(parameter)<ul><li>r for read acccess</li><li>w for write</li><li>u for both read and write</li></ul></li></ul></li></ul></li><li>TYPE<ul><li>DIR â€” directory</li><li>REG â€” Regular file</li><li>CHR â€” Character special file</li><li>FIFO â€” First In First Out</li></ul></li></ul></li></ul><pre><code class="jsx">// show long listing of open files, show cols like Command, PID, USER, FD, TYPE# lsof // display the list of all opened file of uder leilei# lsof -u leilei// find process running on specific port# lsof -i TCP:22// list only IPv4 &amp; IPv6 Open Files # lsof -i 4# lsof -i 6// list open files of TCP port ranges from 11 - 1023# lsof -i TCP:1-1023// exclude user with ^# lsof -i -u^leilei// list all network connections # lsof -i// search by PID # lsof -p PID // kill all activities of particular user # kill -9 `lsof -t -u leilei`</code></pre><h1 id="2-ulimit"><a href="#2-ulimit" class="headerlink" title="2. ulimit"></a>2. ulimit</h1><h1 id="2-1-Overview"><a href="#2-1-Overview" class="headerlink" title="2.1 Overview"></a>2.1 Overview</h1><ul><li>Set or report the resource limit of the current user.</li><li>Use with ulimit requires admin access, it only work on systems that allow control through the shell</li><li>Types of resource limitation<ul><li>hard limit<ul><li>define the physical limit that the user can reach</li></ul></li><li>soft limit<ul><li>manageable by the user, its value can go up to the hard limit</li></ul></li></ul></li><li>system resources are defined in a configuration file located at <code>/etc/security/limits.conf</code></li></ul><h1 id="2-2-Common-Commands"><a href="#2-2-Common-Commands" class="headerlink" title="2.2 Common Commands"></a>2.2 Common Commands</h1><pre><code class="jsx">// print all the resource limits for the current user # ulimit -a// check the value of max core file size # ulimit -c // check the max data seg size# ulimit -d// check the max stack size of current user # ulimit -s// check the max number of user processes # ulimit -u// check the max number of threads # ulimit -T // check the size of virtual memory # ulimit -v // check time each process is allowed to run for # ulimit -t // check how many file descriptors a process can have # ulimit -n </code></pre><h1 id="3-ps"><a href="#3-ps" class="headerlink" title="3. ps"></a>3. ps</h1><h1 id="3-1-Overview"><a href="#3-1-Overview" class="headerlink" title="3.1 Overview"></a>3.1 Overview</h1><ul><li><p>Linux is a multi-tasking and multi-user system</p></li><li><p>so it allows multiple processes to operate simultaneously without interfering with each other</p></li><li><p>A process is an executing instance of a program and carry out different tasks within the operating system</p></li><li><p>PS command help us to review information related with the processes on a system</p><ul><li>used to list the currently running processes and their PIDs along with some other information depends on different options</li></ul></li></ul><h1 id="3-2-Some-common-commands"><a href="#3-2-Some-common-commands" class="headerlink" title="3.2 Some common commands"></a>3.2 Some common commands</h1><ul><li>Some common columns you should know what it means<ul><li>PID - the unique process ID</li><li>TTY - terminal type that the user is logged into</li><li>TIME - amount of CPU in minutes and seconds that the process has been running<ul><li>sometimes you see TIME as 00:00:00, merely means the total accumulated CPU utilization time for any process currently is 0</li></ul></li><li>CMD - name of the command that launched the process</li><li>C - the CPU utilization in percentage</li><li>STIME - the start time of the process</li></ul></li></ul><pre><code class="java"># ps PID TTY          TIME CMD12330 pts/0    00:00:00 bash21621 pts/0    00:00:00 ps// view all the running processes # ps -A # ps -e// view all processes associated with the terminal # ps -T // view all the running processes # ps -r // view all the processes owned by you # ps -x // print all the processes within the system # ps -e// More detailed output by using -f option # ps -e -f // Search for a particular process # ps -C systemd</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.geeksforgeeks.org/lsof-command-in-linux-with-examples/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/lsof-command-in-linux-with-examples/</a>  </p><p><a href="https://www.tecmint.com/10-lsof-command-examples-in-linux/" target="_blank" rel="noopener">https://www.tecmint.com/10-lsof-command-examples-in-linux/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Distributed Locks with the DynamoDB Lock Client </title>
      <link href="/Distributed-Locks-with-the-DynamoDB-Lock-Client/"/>
      <url>/Distributed-Locks-with-the-DynamoDB-Lock-Client/</url>
      
        <content type="html"><![CDATA[<h1 id="Distributed-Locks-with-the-DynamoDB-Lock-Client"><a href="#Distributed-Locks-with-the-DynamoDB-Lock-Client" class="headerlink" title="Distributed Locks with the DynamoDB Lock Client"></a>Distributed Locks with the DynamoDB Lock Client</h1><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li><p>DynamoDB Lock Client</p><ul><li>enable you to solve distributed computing problems like leader election and distributed locking with client only code and a DDB table</li></ul></li><li><p>Why we need it</p><ul><li>Distributed Locking is complicated<ul><li>you need to <strong>atomically ensure</strong> only one actor is modifying a <strong>stateful resource</strong> at any given time</li></ul></li></ul></li></ul><h1 id="2-Practical-Example"><a href="#2-Practical-Example" class="headerlink" title="2. Practical Example"></a>2. Practical Example</h1><ul><li>Background<ul><li>A retail bank that want to ensure at most one customer service representative change customer details at a time</li><li>solution<ul><li>temporarily lock customer records during an update</li><li>suppose there are bunch different tables to contain all customer information, as the tables are independent, so we cannot just wrap the changes we need in a relational transaction</li><li>we need to lock customer id at a high level</li><li>Youâ€™d do so with a locking API action for a certain duration in your application before making any changes.</li></ul></li></ul></li></ul><h2 id="2-1-Locking-Protocol"><a href="#2-1-Locking-Protocol" class="headerlink" title="2.1 Locking Protocol"></a>2.1 Locking Protocol</h2><ul><li>For a new lock, the lock clients store a lock item in the lock table<ul><li>it stores<ul><li>the host name of the owner</li><li>the lease duration in milliseconds</li><li>a UUID unique to the host</li><li>the host system clock time when the lock was initially created</li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2021/01/15/gk6qico4zUw1YXK.png" alt="Whole Workflow"></p><ol><li>Host A acquires a lock on Moe by writing an item to the lock table on the condition that no item keyed at â€œMoeâ€ exists yet. Host A<br>acquires the lock with a revision version number (RVN) of UUID.</li><li>Host B tries to get a lock on Moe with a RVN UUID.</li><li>Host B checks to see if a lock already exists with a GetItem call.</li><li>In this case, host B finds that host A holds a lock on Moe with a record version number (RVN) of UUID. The same application runs on hosts A and B. That being so, host B<br>expects host A to heartbeat and renew the lock on Moe in less than 10 seconds, if host A intends to keep the lock on Moe. Host A heartbeats once, and uses a conditional update on the lock keyed at Moe to update the RVN of the lock to UUID.</li><li>Host B checks 10 seconds after the first AcquireLock call to see if the RVN in Aâ€™s lock on Moe changed with a conditional UpdateItem call and a RVN of UUID.</li><li>Host A successfully updates the lock. Thus, host B finds the new RVN equal to UUID and waited 10 more seconds. Host A died after the first heartbeat, so it never changes the RVN past UUID. When host B calls tries to acquire a lock on Moe for the third time, it finds that the RVN was still UUID, the same RVN retrieved on the second lock attempt.</li><li>In this case, hosts A and B run the same application. Because host B expects host A to heartbeat if host A is healthy and intends to keep the lock, host B considers the lock on Moe expired. Host Bâ€™s conditional update to acquire the lock on Moe succeeds, and your application makes progress!</li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://aws.amazon.com/blogs/database/building-distributed-locks-with-the-dynamodb-lock-client/" target="_blank" rel="noopener">https://aws.amazon.com/blogs/database/building-distributed-locks-with-the-dynamodb-lock-client/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</title>
      <link href="/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h1><h1 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h1><ul><li><p>åºåˆ—åŒ–</p><ul><li>å°†å¯¹è±¡è½¬åŒ–ä¸ºå¯ä¼ è¾“çš„å­—èŠ‚åºåˆ—çš„è¿‡ç¨‹<ul><li>æ˜¯å±äºTCP/ IPåè®®åº”ç”¨å±‚çš„ä¸€éƒ¨åˆ†</li><li>å¸¸ç”¨çš„ä½ å¯èƒ½çœ‹åˆ°çš„åå­—<ul><li>serialization</li><li>marshalling</li><li>flatteing</li></ul></li></ul></li><li>å¸¸è§åºåˆ—åŒ–æ–¹å¼<ul><li>JSON</li><li>XML</li></ul></li></ul></li><li><p>ååºåˆ—åŒ–</p><ul><li>å°†å­—èŠ‚åºåˆ—è¿˜åŸä¸ºå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºååºåˆ—åŒ–</li></ul></li><li><p>äºŒè¿›åˆ¶ä¸²</p><ul><li>äºŒè¿›åˆ¶ä¸²ï¼šåºåˆ—åŒ–æ‰€ç”Ÿæˆçš„äºŒè¿›åˆ¶ä¸²æŒ‡çš„æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ä¸€å—æ•°æ®ã€‚</li><li>C++è¯­è¨€å…·æœ‰å†…å­˜æ“ä½œç¬¦ï¼Œæ‰€ä»¥äºŒè¿›åˆ¶ä¸²çš„æ¦‚å¿µå®¹æ˜“ç†è§£ï¼Œä¾‹å¦‚ï¼ŒC++è¯­è¨€çš„å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥è¢«ä¼ è¾“å±‚ä½¿ç”¨ï¼Œå› ä¸ºå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä»¥â€™\0â€™ç»“å°¾çš„å­˜å‚¨åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä¸²ã€‚</li><li>åœ¨Javaè¯­è¨€é‡Œé¢ï¼ŒäºŒè¿›åˆ¶ä¸²çš„æ¦‚å¿µå®¹æ˜“å’ŒStringæ··æ·†ã€‚å®é™…ä¸ŠString æ˜¯Javaçš„ä¸€ç­‰å…¬æ°‘ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šå¯¹è±¡ï¼ˆObjectï¼‰ã€‚å¯¹äºè·¨è¯­è¨€é—´çš„é€šè®¯ï¼Œåºåˆ—åŒ–åçš„æ•°æ®å½“ç„¶ä¸èƒ½æ˜¯æŸç§è¯­è¨€çš„ç‰¹æ®Šæ•°æ®ç±»å‹ã€‚äºŒè¿›åˆ¶ä¸²åœ¨Javaé‡Œé¢æ‰€æŒ‡çš„æ˜¯<strong>byte[]</strong>ï¼Œbyteæ˜¯Javaçš„8ä¸­åŸç”Ÿæ•°æ®ç±»å‹ä¹‹ä¸€ï¼ˆPrimitive data typesï¼‰</li></ul></li></ul><h1 id="2-ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–"><a href="#2-ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–" class="headerlink" title="2. ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–"></a>2. ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–</h1><ul><li>ä¸ºäº†ä½¿å¾—å¯¹è±¡å¯ä»¥è·¨å¹³å°è¿›è¡Œå­˜å‚¨ï¼Œè¿›è¡Œç½‘ç»œä¼ è¾“</li><li>æœ¬è´¨ä¸Šå­˜å‚¨å’Œç½‘ç»œä¼ è¾“éƒ½éœ€è¦å°†ä¸€ä¸ªå¯¹è±¡çŠ¶æ€ä¿å­˜æˆä¸€ç§è·¨å¹³å°è¯†åˆ«çš„å­—èŠ‚æ ¼å¼ï¼Œç„¶åå…¶ä»–çš„å¹³å°æ‰å¯ä»¥é€šè¿‡å­—èŠ‚ä¿¡æ¯è§£æè¿˜åŸå¯¹è±¡çš„ä¿¡æ¯</li><li>è€Œä¸”åºåˆ—åŒ–åå¯ä»¥å­˜åœ¨æ–‡ä»¶å½“ä¸­ï¼Œæ°¸ä¹…æ€§çš„å­˜åˆ°ç¡¬ç›˜ä¸Š</li></ul><h1 id="3-åºåˆ—åŒ–æŠ€æœ¯é€‰æ‹©çš„metrics"><a href="#3-åºåˆ—åŒ–æŠ€æœ¯é€‰æ‹©çš„metrics" class="headerlink" title="3. åºåˆ—åŒ–æŠ€æœ¯é€‰æ‹©çš„metrics"></a>3. åºåˆ—åŒ–æŠ€æœ¯é€‰æ‹©çš„metrics</h1><h2 id="3-1-è·¨å¹³å°-amp-è·¨è¯­è¨€"><a href="#3-1-è·¨å¹³å°-amp-è·¨è¯­è¨€" class="headerlink" title="3.1 è·¨å¹³å° &amp; è·¨è¯­è¨€"></a>3.1 è·¨å¹³å° &amp; è·¨è¯­è¨€</h2><p>æ˜¯å¦éœ€è¦æ”¯æŒå¤šç§è¯­è¨€ï¼Œåº”è¯¥é€‰æ‹©æ²¡æœ‰è¯­è¨€å±€é™æ€§çš„åºåˆ—åŒ–åè®®</p><ul><li>Jsonä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºJsonè¡¨ç¤ºå‡ºæ¥å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥è¢«æ‰€æœ‰è¯­è¨€è¯»å–ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°å­˜å‚¨åˆ°ç£ç›˜æˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“</li><li>JSONä¸ä»…æ˜¯æ ‡å‡†æ ¼å¼ï¼Œå¹¶ä¸”æ¯”XMLæ›´å¿«ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥åœ¨Webé¡µé¢å½“ä¸­è¯»å–</li></ul><h2 id="3-2-æ€§èƒ½"><a href="#3-2-æ€§èƒ½" class="headerlink" title="3.2 æ€§èƒ½"></a>3.2 æ€§èƒ½</h2><h3 id="3-2-1-é€Ÿåº¦"><a href="#3-2-1-é€Ÿåº¦" class="headerlink" title="3.2.1 é€Ÿåº¦"></a>3.2.1 é€Ÿåº¦</h3><p>å¦‚æœåºåˆ—åŒ–çš„é¢‘ç‡éå¸¸é«˜ï¼Œé‚£ä¹ˆé€‰æ‹©åºåˆ—åŒ–é€Ÿåº¦å¿«çš„åè®®ä¼šä¸ºä½ çš„ç³»ç»Ÿæ€§èƒ½æå‡ä¸å°‘</p><h3 id="3-2-3-åºåˆ—åŒ–åçš„å¤§å°"><a href="#3-2-3-åºåˆ—åŒ–åçš„å¤§å°" class="headerlink" title="3.2.3 åºåˆ—åŒ–åçš„å¤§å°"></a>3.2.3 åºåˆ—åŒ–åçš„å¤§å°</h3><p>æ•°æ®é‡å°å¯¹äºç½‘ç»œçš„å‹åŠ›å°ï¼Œä¼ è¾“ä¹Ÿä¼šå¿«ï¼Œèƒ½å¤Ÿæå‡æ•´ä½“çš„æ€§èƒ½</p><p>åºåˆ—åŒ–éœ€è¦åœ¨åŸæœ‰çš„æ•°æ®ä¸ŠåŠ ä¸Šæè¿°å­—æ®µï¼Œä»¥ä¸ºååºåˆ—åŒ–è§£æä¹‹ç”¨ã€‚å¦‚æœåºåˆ—åŒ–è¿‡ç¨‹å¼•å…¥çš„é¢å¤–å¼€é”€è¿‡é«˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿‡å¤§çš„ç½‘ç»œï¼Œç£ç›˜ç­‰å„æ–¹é¢çš„å‹åŠ›ã€‚å¯¹äºæµ·é‡åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œæ•°æ®é‡å¾€å¾€ä»¥TBä¸ºå•ä½ï¼Œå·¨å¤§çš„çš„é¢å¤–ç©ºé—´å¼€é”€æ„å‘³ç€é«˜æ˜‚çš„æˆæœ¬ã€‚</p><h2 id="3-3-é²æ£’æ€§"><a href="#3-3-é²æ£’æ€§" class="headerlink" title="3.3 é²æ£’æ€§"></a>3.3 é²æ£’æ€§</h2><p>ä»ä¸¤æ–¹é¢æ¥è¿›è¡Œè€ƒè™‘</p><ul><li>æˆç†Ÿåº¦<ul><li>ä¸€ä¸ªåè®®ä»åˆ¶å®šï¼Œå®æ–½åˆ°æˆç†Ÿæ˜¯ä¸€ä¸ªå¾ˆæ¼«é•¿çš„é˜¶æ®µã€‚åè®®çš„å¼ºå¥æ€§ä¾èµ–äºå¤§é‡è€Œå…¨é¢çš„æµ‹è¯•ã€‚å¯¹äºè‡´åŠ›äºæä¾›é«˜è´¨é‡æœåŠ¡çš„ç³»ç»Ÿï¼Œé‡‡ç”¨å¤„äºæµ‹è¯•é˜¶æ®µçš„åºåˆ—åŒ–åè®®ä¼šå¸¦æ¥å¾ˆé«˜çš„é£é™©ã€‚</li></ul></li><li>è¯­è¨€/ å¹³å°çš„å…¬å¹³æ€§<ul><li>å½“æ‰€æ”¯æŒçš„è¯­è¨€æˆ–è€…å¹³å°ä¹‹é—´å­˜åœ¨éš¾ä»¥è°ƒå’Œçš„ç‰¹æ€§çš„æ—¶å€™ï¼Œåè®®åˆ¶å®šè€…éœ€è¦åšæƒè¡¡<ul><li>åšæ”¯æŒæ›´å¤šäººä½¿ç”¨çš„è¯­è¨€/å¹³å°  vs ä¸ºäº†æ”¯æŒæ›´å¤šçš„è¯­è¨€/ å¹³å°è€Œæ”¾å¼ƒæŸä¸ªç‰¹æ€§</li></ul></li></ul></li></ul><h2 id="3-4-å¯è°ƒè¯•æ€§-å¯è¯»æ€§"><a href="#3-4-å¯è°ƒè¯•æ€§-å¯è¯»æ€§" class="headerlink" title="3.4 å¯è°ƒè¯•æ€§/ å¯è¯»æ€§"></a>3.4 å¯è°ƒè¯•æ€§/ å¯è¯»æ€§</h2><ul><li>åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ•°æ®æ­£ç¡®æ€§å’Œä¸šåŠ¡æ­£ç¡®æ€§çš„è°ƒè¯•å¾€å¾€éœ€è¦å¾ˆé•¿çš„æ—¶é—´ï¼Œè‰¯å¥½çš„è°ƒè¯•æœºåˆ¶ä¼šå¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚</li><li>åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶ä¸²å¾€å¾€ä¸å…·å¤‡äººçœ¼å¯è¯»æ€§ï¼Œä¸ºäº†éªŒè¯åºåˆ—åŒ–ç»“æœçš„æ­£ç¡®æ€§ï¼Œå†™å…¥æ–¹ä¸å¾—åŒæ—¶æ’°å†™ååºåˆ—åŒ–ç¨‹åºï¼Œæˆ–æä¾›ä¸€ä¸ªæŸ¥è¯¢å¹³å°â€“è¿™æ¯”è¾ƒè´¹æ—¶ï¼›</li><li>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœè¯»å–æ–¹æœªèƒ½æˆåŠŸå®ç°ååºåˆ—åŒ–ï¼Œè¿™å°†ç»™é—®é¢˜æŸ¥æ‰¾å¸¦æ¥äº†å¾ˆå¤§çš„æŒ‘æˆ˜â€“éš¾ä»¥å®šä½æ˜¯ç”±äºè‡ªèº«çš„ååºåˆ—åŒ–ç¨‹åºçš„bugæ‰€å¯¼è‡´è¿˜æ˜¯ç”±äºå†™å…¥æ–¹åºåˆ—åŒ–åçš„é”™è¯¯æ•°æ®æ‰€å¯¼è‡´</li></ul><h2 id="3-5-å¯æ‰©å±•æ€§-å…¼å®¹æ€§"><a href="#3-5-å¯æ‰©å±•æ€§-å…¼å®¹æ€§" class="headerlink" title="3.5 å¯æ‰©å±•æ€§/ å…¼å®¹æ€§"></a>3.5 å¯æ‰©å±•æ€§/ å…¼å®¹æ€§</h2><p>ç§»åŠ¨äº’è”æ—¶ä»£ï¼Œä¸šåŠ¡ç³»ç»Ÿéœ€æ±‚çš„æ›´æ–°å‘¨æœŸå˜å¾—æ›´å¿«ï¼Œæ–°çš„éœ€æ±‚ä¸æ–­æ¶Œç°ï¼Œè€Œè€çš„ç³»ç»Ÿè¿˜æ˜¯éœ€è¦ç»§ç»­ç»´æŠ¤ã€‚å¦‚æœåºåˆ—åŒ–åè®®å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œæ”¯æŒè‡ªåŠ¨å¢åŠ æ–°çš„ä¸šåŠ¡å­—æ®µï¼Œè€Œä¸å½±å“è€çš„æœåŠ¡ï¼Œè¿™å°†å¤§å¤§æä¾›ç³»ç»Ÿçš„çµæ´»åº¦</p><h2 id="3-6-å®‰å…¨æ€§-è®¿é—®é™åˆ¶"><a href="#3-6-å®‰å…¨æ€§-è®¿é—®é™åˆ¶" class="headerlink" title="3.6 å®‰å…¨æ€§/ è®¿é—®é™åˆ¶"></a>3.6 å®‰å…¨æ€§/ è®¿é—®é™åˆ¶</h2><p>åœ¨åºåˆ—åŒ–é€‰å‹çš„è¿‡ç¨‹ä¸­ï¼Œå®‰å…¨æ€§çš„è€ƒè™‘å¾€å¾€å‘ç”Ÿåœ¨<strong>è·¨å±€åŸŸç½‘è®¿é—®çš„åœºæ™¯</strong>ã€‚å½“é€šè®¯å‘ç”Ÿåœ¨å…¬å¸ä¹‹é—´æˆ–è€…è·¨æœºæˆ¿çš„æ—¶å€™ï¼Œå‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œå¯¹äºè·¨å±€åŸŸç½‘çš„è®¿é—®å¾€å¾€è¢«é™åˆ¶ä¸ºåŸºäºHTTP/HTTPSçš„80å’Œ443ç«¯å£ã€‚å¦‚æœä½¿ç”¨çš„åºåˆ—åŒ–åè®®æ²¡æœ‰å…¼å®¹æˆç†Ÿçš„HTTPä¼ è¾“å±‚æ¡†æ¶æ”¯æŒï¼Œå¯èƒ½ä¼šå¯¼è‡´ä»¥ä¸‹ä¸‰ç§ç»“æœä¹‹ä¸€ï¼š</p><p>ç¬¬ä¸€ã€å› ä¸ºè®¿é—®é™åˆ¶è€Œé™ä½æœåŠ¡å¯ç”¨æ€§ã€‚<br>ç¬¬äºŒã€è¢«è¿«é‡æ–°å®ç°å®‰å…¨åè®®è€Œå¯¼è‡´å®æ–½æˆæœ¬å¤§å¤§æé«˜ã€‚<br>ç¬¬ä¸‰ã€å¼€æ”¾æ›´å¤šçš„é˜²ç«å¢™ç«¯å£å’Œåè®®è®¿é—®ï¼Œè€Œç‰ºç‰²å®‰å…¨æ€§ã€‚</p><h1 id="4-åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç»„ä»¶"><a href="#4-åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç»„ä»¶" class="headerlink" title="4. åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç»„ä»¶"></a>4. åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç»„ä»¶</h1><h2 id="4-1-IDL-â€”-Interface-Description-Language"><a href="#4-1-IDL-â€”-Interface-Description-Language" class="headerlink" title="4.1 IDL â€” Interface Description Language"></a>4.1 IDL â€” Interface Description Language</h2><ul><li>å‚ä¸é€šè®¯çš„å„æ–¹éœ€è¦å¯¹é€šè®¯çš„å†…å®¹åšç›¸å…³çš„çº¦å®š â€” specifications</li><li>è¿™ä¸ªçº¦å®šéœ€è¦å’Œè¯­è¨€ä»¥åŠå¹³å°æ— å…³</li><li>è¢«ç§°ä¸ºæ¥å£æè¿°è¯­è¨€</li></ul><h2 id="4-2-IDL-Compiler"><a href="#4-2-IDL-Compiler" class="headerlink" title="4.2 IDL Compiler"></a>4.2 IDL Compiler</h2><ul><li>IDLæ–‡ä»¶ä¸­çº¦å®šçš„å†…å®¹ä¸ºäº†åœ¨å„ä¸ªè¯­è¨€å’Œå¹³å°å¯è§ï¼Œéœ€è¦æœ‰ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œå°†IDLæ–‡ä»¶è½¬æ¢æˆå„ä¸ªè¯­è¨€å¯¹åº”çš„åŠ¨æ€åº“</li></ul><h2 id="4-3-Stub-Skeleton-Lib"><a href="#4-3-Stub-Skeleton-Lib" class="headerlink" title="4.3 Stub/ Skeleton Lib"></a>4.3 Stub/ Skeleton Lib</h2><ul><li>è´Ÿè´£åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å·¥ä½œä»£ç </li><li>Stubæ˜¯ä¸€æ®µéƒ¨ç½²åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå®¢æˆ·ç«¯çš„ä»£ç ï¼Œä¸€æ–¹é¢æ¥æ”¶åº”ç”¨å±‚çš„å‚æ•°ï¼Œå¹¶å¯¹å…¶åºåˆ—åŒ–åé€šè¿‡åº•å±‚åè®®æ ˆå‘é€åˆ°æœåŠ¡ç«¯ï¼Œå¦ä¸€æ–¹é¢æ¥æ”¶æœåŠ¡ç«¯åºåˆ—åŒ–åçš„ç»“æœæ•°æ®ï¼Œååºåˆ—åŒ–åäº¤ç»™å®¢æˆ·ç«¯åº”ç”¨å±‚ï¼›</li><li>Skeletonéƒ¨ç½²åœ¨æœåŠ¡ç«¯ï¼Œå…¶åŠŸèƒ½ä¸Stubç›¸åï¼Œä»ä¼ è¾“å±‚æ¥æ”¶åºåˆ—åŒ–å‚æ•°ï¼Œååºåˆ—åŒ–åäº¤ç»™æœåŠ¡ç«¯åº”ç”¨å±‚ï¼Œå¹¶å°†åº”ç”¨å±‚çš„æ‰§è¡Œç»“æœåºåˆ—åŒ–åæœ€ç»ˆä¼ é€ç»™å®¢æˆ·ç«¯Stubã€‚</li></ul><p><img src="https://i.loli.net/2021/01/14/l1jSYEnHLxdzD92.png" alt="åºåˆ—åŒ–ååºåˆ—åŒ–è¿‡ç¨‹"></p><h1 id="5-å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®"><a href="#5-å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®" class="headerlink" title="5. å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®"></a>5. å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®</h1><p>ä¸‹é¢ä»¥è¿™ä¸¤ä¸ªç±»çš„åºåˆ—åŒ–ååºåˆ—åŒ–ä¸ºä¾‹</p><pre><code class="java">class Address{    private String city;    private String postcode;    private String street;}public class UserInfo{    private Integer userid;    private String name;    private List&lt;Address&gt; address;}</code></pre><h2 id="5-1-XML-amp-SOAP"><a href="#5-1-XML-amp-SOAP" class="headerlink" title="5.1 XML &amp; SOAP"></a>5.1 XML &amp; SOAP</h2><h3 id="5-1-1-XML"><a href="#5-1-1-XML" class="headerlink" title="5.1.1 XML"></a>5.1.1 XML</h3><ul><li>ç‰¹ç‚¹<ul><li>æè¿°è¯­è¨€ï¼Œself-describing</li><li>XMLè‡ªèº«å¯ä»¥è¢«ç”¨äºXMLåºåˆ—åŒ–çš„IDL</li><li>æ ‡å‡†çš„XMLæè¿°æ ¼å¼æœ‰<ul><li>DTD - Document Type Definition</li><li>XSD - XML Schema Definition</li></ul></li></ul></li><li>ä¼˜ç‚¹<ul><li>è·¨æœºå™¨ï¼Œè·¨è¯­è¨€</li><li>å¯è¯»æ€§<ul><li>å› ä¸ºå…¶æœ€åˆçš„ç›®æ ‡æ˜¯å¯¹äº’è”ç½‘æ–‡æ¡£Documentè¿›è¡Œæ ‡è®°ï¼Œæ‰€ä»¥å…¶è®¾è®¡ç†å¿µå½“ä¸­å°±åŒ…å«äº†å¯¹äºäººå’Œæœºå™¨éƒ½å…·å¤‡å¯è¯»æ€§</li></ul></li></ul></li><li>ç¼ºç‚¹<ul><li>å†—é•¿ï¼Œå¤æ‚</li></ul></li></ul><h3 id="5-1-2-SOAP-Simple-Object-Access-Protocol"><a href="#5-1-2-SOAP-Simple-Object-Access-Protocol" class="headerlink" title="5.1.2 SOAP - Simple Object Access Protocol"></a>5.1.2 SOAP - Simple Object Access Protocol</h3><ul><li><p>æ¦‚å¿µ</p><ul><li>åŸºäºXMLä¸ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–åè®®çš„ç»“æ„åŒ–çš„æ¶ˆæ¯ä¼ é€’åè®®</li><li>SOAPæ”¯æŒå¤šç§ä¼ è¾“å±‚åè®®ï¼Œæœ€å¸¸è§çš„ä½¿ç”¨æ–¹å¼æ˜¯XML + HTTP</li></ul></li><li><p>IDL</p><ul><li>SOAPåè®®çš„ä¸»è¦æ¥å£æè¿°è¯­è¨€IDLæ˜¯WSDL â€” Web Service Description Language</li></ul></li><li><p>SOAPå…·æœ‰å®‰å…¨ã€å¯æ‰©å±•ã€è·¨è¯­è¨€ã€è·¨å¹³å°å¹¶æ”¯æŒå¤šç§ä¼ è¾“å±‚åè®®ã€‚å¦‚æœä¸è€ƒè™‘è·¨å¹³å°å’Œè·¨è¯­è¨€çš„éœ€æ±‚ï¼ŒXMLçš„åœ¨æŸäº›è¯­è¨€é‡Œé¢å…·æœ‰éå¸¸ç®€å•æ˜“ç”¨çš„åºåˆ—åŒ–ä½¿ç”¨æ–¹æ³•ï¼Œæ— éœ€IDLæ–‡ä»¶å’Œç¬¬ä¸‰æ–¹ç¼–è¯‘å™¨ï¼Œ ä¾‹å¦‚Javaï¼‹XStream</p></li><li><p>è‡ªæˆ‘æè¿°å’Œé€’å½’</p><ul><li><p>SOAPæ˜¯ä¸€ç§é‡‡ç”¨XMLè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åè®®ï¼Œå®ƒçš„IDLæ˜¯WSDL. è€ŒWSDLçš„æè¿°æ–‡ä»¶æ˜¯XSDï¼Œè€ŒXSDè‡ªèº«æ˜¯ä¸€ç§XMLæ–‡ä»¶ã€‚ è¿™é‡Œäº§ç”Ÿäº†ä¸€ç§æœ‰è¶£çš„åœ¨æ•°å­¦ä¸Šç§°ä¹‹ä¸ºâ€œé€’å½’â€çš„é—®é¢˜ï¼Œè¿™ç§ç°è±¡å¾€å¾€å‘ç”Ÿåœ¨ä¸€äº›å…·æœ‰è‡ªæˆ‘å±æ€§ï¼ˆSelf-descriptionï¼‰çš„äº‹ç‰©ä¸Š</p><pre><code class="java">&lt;xsd:complexType name=&#39;Address&#39;&gt;   &lt;xsd:attribute name=&#39;city&#39; type=&#39;xsd:string&#39; /&gt;   &lt;xsd:attribute name=&#39;postcode&#39; type=&#39;xsd:string&#39; /&gt;   &lt;xsd:attribute name=&#39;street&#39; type=&#39;xsd:string&#39; /&gt;&lt;/xsd:complexType&gt;&lt;xsd:complexType name=&#39;UserInfo&#39;&gt;   &lt;xsd:sequence&gt;   &lt;xsd:element name=&#39;address&#39; type=&#39;tns:Address&#39;/&gt;   &lt;xsd:element name=&#39;address1&#39; type=&#39;tns:Address&#39;/&gt;    &lt;/xsd:sequence&gt;   &lt;xsd:attribute name=&#39;userid&#39; type=&#39;xsd:int&#39; /&gt;   &lt;xsd:attribute name=&#39;name&#39; type=&#39;xsd:string&#39; /&gt; &lt;/xsd:complexType&gt;</code></pre></li></ul></li><li><p>ä¼˜ç‚¹</p><ul><li>å®‰å…¨æ€§</li><li>XMLè‚‰çœ¼å¯è¯»ï¼Œå¯è°ƒè¯•æ€§å¥½</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>XMLç©ºé—´å¼€é”€ä¼šå¤§å¾ˆå¤šï¼Œåºåˆ—åŒ–åçš„æ•°æ®é‡å‰§å¢ï¼Œè¿™æ„å‘³ç€å·¨å¤§çš„å†…å­˜å’Œç£ç›˜å¼€é”€</li></ul></li><li><p>é€‚ç”¨åœºæ™¯</p><ul><li>å¯¹äºå…¬å¸ä¹‹é—´ä¼ è¾“æ•°æ®é‡å°æˆ–è€…å®æ—¶æ€§è¦æ±‚ç›¸å¯¹ä½çš„æœåŠ¡æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</li></ul></li></ul><h2 id="5-2-JSON-Javascript-Object-Notation"><a href="#5-2-JSON-Javascript-Object-Notation" class="headerlink" title="5.2 JSON - Javascript Object Notation"></a>5.2 JSON - Javascript Object Notation</h2><ul><li><p>æ¦‚å¿µ</p><ul><li>å‡ºè‡ªJavascriptï¼Œäº§ç”Ÿæ¥è‡ªäºAssociative arrayçš„æ¦‚å¿µï¼Œæœ¬è´¨æ˜¯é‡‡ç”¨Attribute-valueçš„æ–¹æ³•æ¥æè¿°å¯¹è±¡</li></ul></li><li><p>ä¼˜ç‚¹</p><ul><li>è¿™ç§Associative arrayæ ¼å¼éå¸¸ç¬¦åˆå·¥ç¨‹å¸ˆå¯¹å¯¹è±¡çš„ç†è§£ã€‚</li><li>å®ƒä¿æŒäº†XMLçš„äººçœ¼å¯è¯»ï¼ˆHuman-readableï¼‰çš„ä¼˜ç‚¹ã€‚</li><li>ç›¸å¯¹äºXMLè€Œè¨€ï¼Œåºåˆ—åŒ–åçš„æ•°æ®æ›´åŠ ç®€æ´ã€‚ æ¥è‡ªäºçš„ä»¥ä¸‹é“¾æ¥çš„ç ”ç©¶è¡¨æ˜ï¼šXMLæ‰€äº§ç”Ÿåºåˆ—åŒ–ä¹‹åæ–‡ä»¶çš„å¤§å°æ¥è¿‘JSONçš„ä¸¤å€ã€‚<a href="http://www.codeproject.com/Articles/604720/JSON-vs-XML-Some-hard-numbers-about-verbosity" target="_blank" rel="noopener">http://www.codeproject.com/Articles/604720/JSON-vs-XML-Some-hard-numbers-about-verbosity</a></li><li>å®ƒå…·å¤‡Javascriptçš„å…ˆå¤©æ€§æ”¯æŒï¼Œæ‰€ä»¥è¢«å¹¿æ³›åº”ç”¨äºWeb browserçš„åº”ç”¨å¸¸æ™¯ä¸­ï¼Œæ˜¯Ajaxçš„äº‹å®æ ‡å‡†åè®®ã€‚</li><li>ä¸XMLç›¸æ¯”ï¼Œå…¶åè®®æ¯”è¾ƒç®€å•ï¼Œè§£æé€Ÿåº¦æ¯”è¾ƒå¿«ã€‚</li><li>æ¾æ•£çš„Associative arrayä½¿å¾—å…¶å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§ã€‚</li></ul></li><li><p>åº”ç”¨åœºæ™¯</p><ul><li>å…¬å¸ä¹‹é—´ä¼ è¾“æ•°æ®é‡<strong>ç›¸å¯¹å°</strong>ï¼Œå®æ—¶æ€§è¦æ±‚ç›¸å¯¹ä½ï¼ˆ<strong>ä¾‹å¦‚ç§’çº§åˆ«ï¼‰</strong>çš„æœåŠ¡ã€‚</li><li>åŸºäºWeb browserçš„Ajaxè¯·æ±‚ã€‚</li><li>ç”±äºJSONå…·æœ‰éå¸¸å¼ºçš„å‰åå…¼å®¹æ€§ï¼Œå¯¹äºæ¥å£ç»å¸¸å‘ç”Ÿå˜åŒ–ï¼Œå¹¶å¯¹å¯è°ƒå¼æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚Mobile appä¸æœåŠ¡ç«¯çš„é€šè®¯ã€‚</li><li>ç”±äºJSONçš„å…¸å‹åº”ç”¨åœºæ™¯æ˜¯JSONï¼‹HTTPï¼Œé€‚åˆè·¨é˜²ç«å¢™è®¿é—®</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>é‡‡ç”¨JSONè¿›è¡Œåºåˆ—åŒ–çš„é¢å¤–ç©ºé—´å¼€é”€æ¯”è¾ƒå¤§ï¼Œå¯¹äºå¤§æ•°æ®é‡æœåŠ¡æˆ–æŒä¹…åŒ–ï¼Œè¿™æ„å‘³ç€å·¨å¤§çš„å†…å­˜å’Œç£ç›˜å¼€é”€ï¼Œè¿™ç§åœºæ™¯ä¸é€‚åˆã€‚</li><li>æ²¡æœ‰ç»Ÿä¸€å¯ç”¨çš„IDLé™ä½äº†å¯¹å‚ä¸æ–¹çš„çº¦æŸï¼Œå®é™…æ“ä½œä¸­å¾€å¾€åªèƒ½<strong>é‡‡ç”¨æ–‡æ¡£æ–¹å¼æ¥è¿›è¡Œçº¦å®š</strong>ï¼Œè¿™å¯èƒ½ä¼šç»™è°ƒè¯•å¸¦æ¥ä¸€äº›ä¸ä¾¿ï¼Œå»¶é•¿å¼€å‘å‘¨æœŸã€‚</li><li>ç”±äºJSONåœ¨ä¸€äº›è¯­è¨€ä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–éœ€è¦é‡‡ç”¨åå°„æœºåˆ¶ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½è¦æ±‚ä¸ºmsçº§åˆ«ï¼Œä¸å»ºè®®ä½¿ç”¨</li></ul></li></ul><pre><code class="java">{&quot;userid&quot;:1,&quot;name&quot;:&quot;messi&quot;,&quot;address&quot;:[{&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;postcode&quot;:&quot;1000000&quot;,&quot;street&quot;:&quot;wangjingdonglu&quot;}]}</code></pre><h2 id="5-3-Thrift"><a href="#5-3-Thrift" class="headerlink" title="5.3 Thrift"></a>5.3 Thrift</h2><ul><li>ç®€ä»‹<ul><li>FBå¼€æºçš„ä¸€ä¸ªé«˜æ€§èƒ½è½»é‡çº§çš„RPCæ¡†æ¶</li><li>ä¸ºäº†æ»¡è¶³å½“å‰å¤§æ•°æ®é‡ã€åˆ†å¸ƒå¼ã€è·¨è¯­è¨€ã€è·¨å¹³å°æ•°æ®é€šè®¯çš„éœ€æ±‚</li><li>ï¼ŒThriftå¹¶ä¸ä»…ä»…æ˜¯åºåˆ—åŒ–åè®®ï¼Œè€Œæ˜¯ä¸€ä¸ªRPCæ¡†æ¶ã€‚ç›¸å¯¹äºJSONå’ŒXMLè€Œè¨€ï¼ŒThriftåœ¨ç©ºé—´å¼€é”€å’Œè§£ææ€§èƒ½ä¸Šæœ‰äº†æ¯”è¾ƒå¤§çš„æå‡ï¼Œå¯¹äºå¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªä¼˜ç§€çš„RPCè§£å†³æ–¹æ¡ˆï¼›ä½†æ˜¯ç”±äºThriftçš„åºåˆ—åŒ–è¢«åµŒå…¥åˆ°Thriftæ¡†æ¶é‡Œé¢ï¼ŒThriftæ¡†æ¶æœ¬èº«å¹¶æ²¡æœ‰é€å‡ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¥å£ï¼Œè¿™å¯¼è‡´å…¶å¾ˆéš¾å’Œå…¶ä»–ä¼ è¾“å±‚åè®®å…±åŒä½¿ç”¨</li></ul></li></ul><pre><code class="java">// IDL wenstruct Address{     1: required string city;    2: optional string postcode;    3: optional string street;} struct UserInfo{     1: required string userid;    2: required i32 name;    3: optional list&lt;Address&gt; address;}</code></pre><h2 id="5-4-Protobuf"><a href="#5-4-Protobuf" class="headerlink" title="5.4 Protobuf"></a>5.4 Protobuf</h2><ul><li>ç‰¹å¾<ul><li>æ ‡å‡†çš„IDLå’ŒIDLç¼–è¯‘å™¨ï¼Œè¿™ä½¿å¾—å…¶å¯¹å·¥ç¨‹å¸ˆéå¸¸å‹å¥½ã€‚</li><li>åºåˆ—åŒ–æ•°æ®éå¸¸ç®€æ´ï¼Œç´§å‡‘ï¼Œä¸XMLç›¸æ¯”ï¼Œå…¶åºåˆ—åŒ–ä¹‹åçš„æ•°æ®é‡çº¦ä¸º1/3åˆ°1/10ã€‚</li><li>è§£æé€Ÿåº¦éå¸¸å¿«ï¼Œæ¯”å¯¹åº”çš„XMLå¿«çº¦20-100å€ã€‚</li><li>æä¾›äº†éå¸¸å‹å¥½çš„åŠ¨æ€åº“ï¼Œä½¿ç”¨éå¸¸ç®€ä»‹ï¼Œååºåˆ—åŒ–åªéœ€è¦ä¸€è¡Œä»£ç ã€‚</li><li>Protobufæ˜¯ä¸€ä¸ªçº¯ç²¹çš„å±•ç¤ºå±‚åè®®ï¼Œå¯ä»¥å’Œå„ç§ä¼ è¾“å±‚åè®®ä¸€èµ·ä½¿ç”¨ï¼›Protobufçš„æ–‡æ¡£ä¹Ÿéå¸¸å®Œå–„ã€‚ ä½†æ˜¯ç”±äºProtobufäº§ç”ŸäºGoogleï¼Œæ‰€ä»¥ç›®å‰å…¶ä»…ä»…æ”¯æŒJavaã€C++ã€Pythonä¸‰ç§è¯­è¨€ã€‚å¦å¤–Protobufæ”¯æŒçš„æ•°æ®ç±»å‹ç›¸å¯¹è¾ƒå°‘ï¼Œä¸æ”¯æŒå¸¸é‡ç±»å‹ã€‚ç”±äºå…¶è®¾è®¡çš„ç†å¿µæ˜¯çº¯ç²¹çš„å±•ç°å±‚åè®®ï¼ˆPresentation Layerï¼‰ï¼Œç›®å‰å¹¶æ²¡æœ‰ä¸€ä¸ªä¸“é—¨æ”¯æŒProtobufçš„RPCæ¡†æ¶</li></ul></li><li>åº”ç”¨åœºæ™¯<ul><li>Protobufå…·æœ‰å¹¿æ³›çš„ç”¨æˆ·åŸºç¡€ï¼Œç©ºé—´å¼€é”€å°ä»¥åŠé«˜è§£ææ€§èƒ½æ˜¯å…¶äº®ç‚¹ï¼Œéå¸¸é€‚åˆäºå…¬å¸å†…éƒ¨çš„å¯¹æ€§èƒ½è¦æ±‚é«˜çš„RPCè°ƒç”¨ã€‚</li><li>ç”±äºProtobufæä¾›äº†æ ‡<strong>å‡†çš„IDLä»¥åŠå¯¹åº”çš„ç¼–è¯‘å™¨ï¼Œå…¶IDLæ–‡ä»¶æ˜¯å‚ä¸å„æ–¹çš„éå¸¸å¼ºçš„ä¸šåŠ¡çº¦æŸ</strong>ï¼Œ</li><li>å¦å¤–ï¼ŒProtobufä¸ä¼ è¾“å±‚æ— å…³ï¼Œé‡‡ç”¨HTTPå…·æœ‰è‰¯å¥½çš„è·¨é˜²ç«å¢™çš„è®¿é—®å±æ€§ï¼Œæ‰€ä»¥Protobufä¹Ÿé€‚ç”¨äºå…¬å¸é—´å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„åœºæ™¯</li><li>ç”±äºå…¶è§£ææ€§èƒ½é«˜ï¼Œåºåˆ—åŒ–åæ•°æ®é‡ç›¸å¯¹å°‘ï¼Œéå¸¸é€‚åˆåº”ç”¨å±‚å¯¹è±¡çš„æŒä¹…åŒ–åœºæ™¯ã€‚</li></ul></li></ul><pre><code class="java">// IDL File E.Gmessage Address{    required string city=1;        optional string postcode=2;        optional string street=3;}message UserInfo{    required string userid=1;    required string name=2;    repeated Address address=3;}</code></pre><h2 id="5-5-Avro"><a href="#5-5-Avro" class="headerlink" title="5.5 Avro"></a>5.5 Avro</h2><ul><li>ä»‹ç»<ul><li>Apache Hadoopçš„å­é¡¹ç›®</li><li>æä¾›ä¸¤ç§åºåˆ—åŒ–æ–¹å¼<ul><li>Json<ul><li>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•çš„è°ƒè¯•è¿‡ç¨‹</li></ul></li><li>Binary<ul><li>ç©ºé—´å¼€é”€å’Œè§£ææ€§èƒ½å¯ä»¥å’ŒProtobufåª²ç¾</li></ul></li></ul></li></ul></li><li>ä¼˜ç‚¹<ul><li>Avroæ”¯æŒJSONæ ¼å¼çš„IDLå’Œç±»ä¼¼äºThriftå’ŒProtobufçš„IDLï¼ˆå®éªŒé˜¶æ®µï¼‰ï¼Œè¿™ä¸¤è€…ä¹‹é—´å¯ä»¥äº’è½¬ã€‚</li><li>Schemaå¯ä»¥åœ¨ä¼ è¾“æ•°æ®çš„åŒæ—¶å‘é€ï¼ŒåŠ ä¸ŠJSONçš„è‡ªæˆ‘æè¿°å±æ€§ï¼Œè¿™ä½¿å¾—Avroéå¸¸é€‚åˆåŠ¨æ€ç±»å‹è¯­è¨€ã€‚</li><li>Avroåœ¨åšæ–‡ä»¶æŒä¹…åŒ–çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå’ŒSchemaä¸€èµ·å­˜å‚¨ï¼Œæ‰€ä»¥Avroåºåˆ—åŒ–æ–‡ä»¶è‡ªèº«å…·æœ‰è‡ªæˆ‘æè¿°å±æ€§ï¼Œæ‰€ä»¥éå¸¸é€‚åˆäºåšHiveã€Pigå’ŒMapReduceçš„æŒä¹…åŒ–æ•°æ®æ ¼å¼ã€‚</li><li>å¯¹äºä¸åŒç‰ˆæœ¬çš„Schemaï¼Œåœ¨è¿›è¡ŒRPCè°ƒç”¨çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯ä»¥åœ¨æ¡æ‰‹é˜¶æ®µå¯¹Schemaè¿›è¡Œäº’ç›¸ç¡®è®¤ï¼Œå¤§å¤§æé«˜äº†æœ€ç»ˆçš„æ•°æ®è§£æé€Ÿåº¦ã€‚</li></ul></li></ul><h1 id="6-Benchmark"><a href="#6-Benchmark" class="headerlink" title="6. Benchmark"></a>6. Benchmark</h1><ul><li>é€šè¿‡ä¸‹é¢é“¾æ¥å¯ä»¥å‘ç°Protobufå’ŒAvroåœ¨ä¸¤ä¸ªæ–¹é¢éƒ½è¡¨ç°å¾ˆä¼˜è¶Š</li></ul><p><a href="https://code.google.com/archive/p/thrift-protobuf-compare/wikis/Benchmarking.wiki" target="_blank" rel="noopener">https://code.google.com/archive/p/thrift-protobuf-compare/wikis/Benchmarking.wiki</a> </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://zhuanlan.zhihu.com/p/40462507" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/40462507</a></li><li><a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017624706151424" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/1016959663602400/1017624706151424</a> </li><li><a href="https://tech.meituan.com/2015/02/26/serialization-vs-deserialization.html" target="_blank" rel="noopener">https://tech.meituan.com/2015/02/26/serialization-vs-deserialization.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redisæ•°æ®åŒæ­¥</title>
      <link href="/Redis%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/"/>
      <url>/Redis%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="Redisæ•°æ®åŒæ­¥"><a href="#Redisæ•°æ®åŒæ­¥" class="headerlink" title="Redisæ•°æ®åŒæ­¥"></a>Redisæ•°æ®åŒæ­¥</h1><h1 id="1-Redisçš„é«˜å¯é æ€§"><a href="#1-Redisçš„é«˜å¯é æ€§" class="headerlink" title="1. Redisçš„é«˜å¯é æ€§"></a>1. Redisçš„é«˜å¯é æ€§</h1><p>Redisçš„é«˜å¯é æ€§ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š </p><ul><li>æ•°æ®å°½é‡å°‘ä¸¢å¤±<ul><li>AOF</li><li>RDB</li></ul></li><li>æœåŠ¡å°½é‡å°‘ä¸­æ–­<ul><li>å¢åŠ å‰¯æœ¬å†—ä½™é‡ â€” å°†ä¸€ä»½æ•°æ®åŒæ—¶ä¿å­˜åœ¨å¤šä¸ªå®ä¾‹ä¸Š</li></ul></li></ul><h1 id="2-æ•°æ®åŒæ­¥-â€”-ä¸»ä»åº“æ¨¡å¼"><a href="#2-æ•°æ®åŒæ­¥-â€”-ä¸»ä»åº“æ¨¡å¼" class="headerlink" title="2. æ•°æ®åŒæ­¥ â€” ä¸»ä»åº“æ¨¡å¼"></a>2. æ•°æ®åŒæ­¥ â€” ä¸»ä»åº“æ¨¡å¼</h1><ul><li><p>ä¸»ä»åº“ä¹‹é—´é‡‡ç”¨çš„æ˜¯è¯»å†™åˆ†ç¦»çš„æ–¹å¼</p><ul><li><p>è¯»æ“ä½œ</p><ul><li>ä¸»åº“ï¼Œä»åº“éƒ½å¯ä»¥æ¥æ”¶</li></ul></li><li><p>å†™æ“ä½œ</p><ul><li><p>é¦–å…ˆåˆ°ä¸»åº“æ‰§è¡Œ</p></li><li><p>ç„¶åä¸»åº“å°†å†™æ“ä½œåŒæ­¥ç»™ä»åº“</p><p>  <img src="https://i.loli.net/2021/01/04/8wE4dPDgFxqRX6r.png" alt="ä¸»ä»è¯»å†™åˆ†ç¦»"></p></li></ul></li></ul></li><li><p>ä¸»ä»åº“çš„å¥½å¤„æ˜¯ä¿®æ”¹æ“ä½œéƒ½åªä¼šåœ¨ä¸€ä¸ªåº“å®ç°</p><ul><li>å¯ä»¥å‡å°‘åŠ é”ï¼Œå®ä¾‹é—´åå•†è¿™ç±»å¼€é”€</li></ul></li></ul><h2 id="2-1-ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ"><a href="#2-1-ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ" class="headerlink" title="2.1 ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ"></a>2.1 ä¸»ä»åº“ä¹‹é—´å¦‚ä½•è¿›è¡Œç¬¬ä¸€ä¸ªåŒæ­¥ï¼Ÿ</h2><ul><li><p>å¤šä¸ªRediså®ä¾‹ä¹‹é—´é€šè¿‡replicaofå‘½ä»¤å½¢æˆä¸»åº“å’Œä»åº“çš„å…³ç³»ï¼Œç„¶åæŒ‰ç…§ä¸‰ä¸ªé˜¶æ®µå®Œæˆæ•°æ®çš„ç¬¬ä¸€æ¬¡åŒæ­¥ï¼š</p><p>  <img src="https://i.loli.net/2021/01/04/KZemoVB6CFjNlJI.png" alt="ä¸»ä»é¦–æ¬¡åŒæ­¥è¿‡ç¨‹"></p></li><li><p>ç¬¬ä¸€é˜¶æ®µ</p><ul><li>ä¸»ä»åº“ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œåå•†åŒæ­¥</li><li>ä¸ºå…¨é‡å¤åˆ¶åšå‡†å¤‡</li><li>ä»åº“å’Œä¸»åº“å»ºç«‹èµ·è¿æ¥ï¼Œå¹¶å‘Šè¯‰ä¸»åº“å³å°†è¿›è¡ŒåŒæ­¥ï¼Œä¸»åº“ç¡®è®¤å›å¤ä»¥åï¼Œä¸»ä»åº“é—´å°±å¯ä»¥å¼€å§‹åŒæ­¥äº†<ul><li>ä»åº“ç»™ä¸»åº“å‘é€psyncå‘½ä»¤ï¼Œè¡¨ç¤ºè¦è¿›è¡Œæ•°æ®åŒæ­¥</li><li>ä¸»åº“æ ¹æ®è¿™ä¸ªå‘½ä»¤çš„å‚æ•°æ¥å¯åŠ¨å¤åˆ¶<ul><li>psyncå‘½ä»¤åŒ…å«ä¸»åº“çš„runIdå’Œå¤åˆ¶è¿›åº¦çš„offsetä¸¤ä¸ªå‚æ•°<ul><li>runID â€” Rediså®ä¾‹å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨éšæœºç”Ÿæˆçš„IDï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†å½“å‰å®ä¾‹</li><li>offset æ­¤æ—¶è®¾ä¸º-1ï¼Œè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶</li></ul></li></ul></li><li>ä¸»åº“æ”¶åˆ°psyncå‘½ä»¤åï¼Œä½¿ç”¨FULLRESYNCå“åº”å‘½ä»¤ï¼ŒåŒ…æ‹¬äº†ä¸»åº“çš„runIDè¿˜æœ‰ä¸»åº“ç›®å‰çš„å¤åˆ¶è¿›åº¦offsetï¼Œè¿”å›ç»™ä»åº“<ul><li>ä»åº“è®°å½•ä¸‹ä¸¤ä¸ªå‚æ•°</li></ul></li><li>FULLRESYNCè¡¨ç¤ºç¬¬ä¸€æ¬¡å¤åˆ¶ä½¿ç”¨çš„æ˜¯å…¨é‡å¤åˆ¶</li></ul></li></ul></li><li><p>ç¬¬äºŒé˜¶æ®µ</p><ul><li>ä¸»åº“å°†æ‰€æœ‰æ•°æ®åŒæ­¥ç»™ä»åº“</li><li>ä»åº“æ”¶åˆ°æ•°æ®åï¼Œåœ¨æœ¬åœ°å®Œæˆæ•°æ®åŠ è½½ â€” ä¾èµ–äºå†…å­˜å¿«ç…§ç”Ÿæˆçš„RDBæ–‡ä»¶<ul><li>ä¸»åº“æ‰§è¡Œ bgsave å‘½ä»¤ï¼Œç”Ÿæˆ RDB æ–‡ä»¶ï¼Œæ¥ç€å°†æ–‡ä»¶å‘ç»™ä»åº“ã€‚</li><li>ä»åº“æ¥æ”¶åˆ° RDB æ–‡ä»¶åï¼Œä¼šå…ˆæ¸…ç©ºå½“å‰æ•°æ®åº“ï¼Œç„¶ååŠ è½½ RDB æ–‡ä»¶ã€‚<ul><li>è¿™æ˜¯å› ä¸ºä»åº“åœ¨é€šè¿‡ replicaof å‘½ä»¤å¼€å§‹å’Œä¸»åº“åŒæ­¥å‰ï¼Œå¯èƒ½ä¿å­˜äº†å…¶ä»–æ•°æ®ã€‚ä¸ºäº†é¿å…ä¹‹å‰æ•°æ®çš„å½±å“ï¼Œä»åº“éœ€è¦å…ˆæŠŠå½“å‰æ•°æ®åº“æ¸…ç©º</li></ul></li></ul></li><li>åœ¨åšæ•°æ®åŒæ­¥çš„è¿‡ç¨‹ä¸­ï¼Œä¸»åº“ä¸ä¼šè¢«é˜»å¡ã€‚å¯¹äºè¿™ä¸ªè¿‡ç¨‹ä¸­æ¥æ”¶åˆ°çš„æ­£å¸¸è¯·æ±‚ï¼Œå†™æ“ä½œä¼šè®°å½•åœ¨ä¸»åº“çš„Replication Bufferå½“ä¸­</li></ul></li><li><p>ç¬¬ä¸‰é˜¶æ®µ</p><ul><li>ä¸»åº“ä¼šå°†ç¬¬äºŒé˜¶æ®µæ–°æ”¶åˆ°çš„ä¿®æ”¹å‘½ä»¤ï¼Œå†å‘ç»™ä»åº“</li><li>å½“ä¸»åº“å®Œæˆ RDB æ–‡ä»¶å‘é€åï¼Œå°±ä¼šæŠŠæ­¤æ—¶ replication buffer ä¸­çš„ä¿®æ”¹æ“ä½œå‘ç»™ä»åº“ï¼Œä»åº“å†é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸»ä»åº“å°±å®ç°åŒæ­¥äº†</li></ul></li></ul><h2 id="2-2-ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›"><a href="#2-2-ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›" class="headerlink" title="2.2 ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›"></a>2.2 ä¸»ä»çº§è”æ–¹å¼åˆ†æ‹…å…¨é‡å¤åˆ¶æ—¶çš„ä¸»åº“å‹åŠ›</h2><ul><li><p>ç°çŠ¶/ é—®é¢˜</p><ul><li>ä¸€æ¬¡å…¨é‡å¤åˆ¶ä¸»åº“éœ€è¦å®Œæˆä¸¤ä¸ªè€—æ—¶æ“ä½œ<ul><li>ç”ŸæˆRDBæ–‡ä»¶å’Œä¼ è¾“RDBæ–‡ä»¶</li></ul></li><li>å¦‚æœä»åº“æ•°é‡å¾ˆå¤šï¼Œè€Œä¸”éƒ½è¦å’Œä¸»åº“è¿›è¡Œå…¨é‡å¤åˆ¶çš„è¯ï¼Œå°±ä¼šå¯¼è‡´ä¸»åº“å¿™äº fork å­è¿›ç¨‹ç”Ÿæˆ RDB æ–‡ä»¶ï¼Œè¿›è¡Œæ•°æ®å…¨é‡åŒæ­¥ã€‚fork è¿™ä¸ªæ“ä½œä¼šé˜»å¡ä¸»çº¿ç¨‹å¤„ç†æ­£å¸¸è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ä¸»åº“å“åº”åº”ç”¨ç¨‹åºçš„è¯·æ±‚é€Ÿåº¦å˜æ…¢ã€‚</li><li>ä¼ è¾“ RDB æ–‡ä»¶ä¹Ÿä¼šå ç”¨ä¸»åº“çš„ç½‘ç»œå¸¦å®½ï¼ŒåŒæ ·ä¼šç»™ä¸»åº“çš„èµ„æºä½¿ç”¨å¸¦æ¥å‹åŠ›</li></ul></li><li><p>è§£å†³æ–¹æ¡ˆ â€” ä¸»ä»ä»æ¨¡å¼</p><ul><li><p>æˆ‘ä»¬åœ¨éƒ¨ç½²ä¸»ä»é›†ç¾¤çš„æ—¶å€™ï¼Œå¯ä»¥æ‰‹åŠ¨é€‰æ‹©ä¸€ä¸ªä»åº“ï¼ˆæ¯”å¦‚é€‰æ‹©å†…å­˜èµ„æºé…ç½®è¾ƒé«˜çš„ä»åº“ï¼‰ï¼Œç”¨äºçº§è”å…¶ä»–çš„ä»åº“ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å†é€‰æ‹©ä¸€äº›ä»åº“ï¼ˆä¾‹å¦‚ä¸‰åˆ†ä¹‹ä¸€çš„ä»åº“ï¼‰ï¼Œåœ¨è¿™äº›ä»åº“ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè®©å®ƒä»¬å’Œåˆšæ‰æ‰€é€‰çš„ä»åº“ï¼Œå»ºç«‹èµ·ä¸»ä»å…³ç³»ã€‚replicaof æ‰€é€‰ä»åº“çš„IP 6379</p><p><img src="https://i.loli.net/2021/01/04/eihQpmN6FJdRxLy.png" alt="çº§è”ä¸»ä»åº“"></p></li></ul></li></ul><h2 id="2-3-çªå‘æƒ…å†µä¸‹çš„å¢é‡å¤åˆ¶"><a href="#2-3-çªå‘æƒ…å†µä¸‹çš„å¢é‡å¤åˆ¶" class="headerlink" title="2.3 çªå‘æƒ…å†µä¸‹çš„å¢é‡å¤åˆ¶"></a>2.3 çªå‘æƒ…å†µä¸‹çš„å¢é‡å¤åˆ¶</h2><ul><li><p>ç½‘ç»œæ–­äº†ä»¥åæˆ‘ä»¬éœ€è¦ä¸€ç§å¼€é”€ç›¸å¯¹åˆç†çš„å¤åˆ¶æ–¹å¼ï¼Œå³å¢é‡å¤åˆ¶</p><ul><li>å°†ä¸»ä»åº“æ–­è”æœŸé—´ä¸»åº“æ”¶åˆ°çš„å‘½ä»¤ï¼ŒåŒæ­¥ç»™ä»åº“</li></ul></li><li><p>å¢é‡å¤åˆ¶çš„æ—¶å€™ï¼Œä¸»ä»åº“ä¹‹é—´ä¾é repl_backlog_bufferè¿™ä¸ªç¼“å†²åŒºæ¥åšåŒæ­¥</p></li><li><p>æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><p>å½“ä¸»ä»åº“æ–­è¿åï¼Œä¸»åº“ä¼šæŠŠæ–­è¿æœŸé—´æ”¶åˆ°çš„å†™æ“ä½œå‘½ä»¤ï¼Œå†™å…¥ replication bufferï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¿™äº›æ“ä½œå‘½ä»¤ä¹Ÿå†™å…¥ repl_backlog_buffer è¿™ä¸ªç¼“å†²åŒºã€‚</p></li><li><p>repl_backlog_buffer æ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œä¸»åº“ä¼šè®°å½•è‡ªå·±å†™åˆ°çš„ä½ç½®ï¼Œä»åº“åˆ™ä¼šè®°å½•è‡ªå·±å·²ç»è¯»åˆ°çš„ä½ç½®ã€‚</p></li><li><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œä¸»åº“å’Œä»åº“çš„å†™è¯»ä½ç½®åœ¨ä¸€èµ·ï¼Œè¿™ç®—æ˜¯å®ƒä»¬çš„èµ·å§‹ä½ç½®ã€‚éšç€ä¸»åº“ä¸æ–­æ¥æ”¶æ–°çš„å†™æ“ä½œï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„å†™ä½ç½®ä¼šé€æ­¥åç¦»èµ·å§‹ä½ç½®ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åç§»é‡æ¥è¡¡é‡è¿™ä¸ªåç§»è·ç¦»çš„å¤§å°ï¼Œå¯¹ä¸»åº“æ¥è¯´ï¼Œå¯¹åº”çš„åç§»é‡å°±æ˜¯ master_repl_offsetã€‚ä¸»åº“æ¥æ”¶çš„æ–°å†™æ“ä½œè¶Šå¤šï¼Œè¿™ä¸ªå€¼å°±ä¼šè¶Šå¤§ã€‚</p></li><li><p>åŒæ ·ï¼Œä»åº“åœ¨å¤åˆ¶å®Œå†™æ“ä½œå‘½ä»¤åï¼Œå®ƒåœ¨ç¼“å†²åŒºä¸­çš„è¯»ä½ç½®ä¹Ÿå¼€å§‹é€æ­¥åç§»åˆšæ‰çš„èµ·å§‹ä½ç½®ï¼Œæ­¤æ—¶ï¼Œä»åº“å·²å¤åˆ¶çš„åç§»é‡ slave_repl_offset ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ªåç§»é‡åŸºæœ¬ç›¸ç­‰ã€‚</p></li><li><p>ä¸»ä»åº“çš„è¿æ¥æ¢å¤ä¹‹åï¼Œä»åº“é¦–å…ˆä¼šç»™ä¸»åº“å‘é€ psync å‘½ä»¤ï¼Œå¹¶æŠŠè‡ªå·±å½“å‰çš„ slave_repl_offset å‘ç»™ä¸»åº“ï¼Œä¸»åº“ä¼šåˆ¤æ–­è‡ªå·±çš„ master_repl_offset å’Œ slave_repl_offset ä¹‹é—´çš„å·®è·</p></li><li><p>åœ¨ç½‘ç»œæ–­è¿é˜¶æ®µï¼Œä¸»åº“å¯èƒ½ä¼šæ”¶åˆ°æ–°çš„å†™æ“ä½œå‘½ä»¤ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œmaster_repl_offset ä¼šå¤§äº slave_repl_offsetã€‚æ­¤æ—¶ï¼Œä¸»åº“åªç”¨æŠŠ master_repl_offset å’Œ slave_repl_offset ä¹‹é—´çš„å‘½ä»¤æ“ä½œåŒæ­¥ç»™ä»åº“å°±è¡Œã€‚å°±åƒåˆšåˆšç¤ºæ„å›¾çš„ä¸­é—´éƒ¨åˆ†ï¼Œä¸»åº“å’Œä»åº“ä¹‹é—´ç›¸å·®äº† put d e å’Œ put d f ä¸¤ä¸ªæ“ä½œï¼Œåœ¨å¢é‡å¤åˆ¶æ—¶ï¼Œä¸»åº“åªéœ€è¦æŠŠå®ƒä»¬åŒæ­¥ç»™ä»åº“ï¼Œå°±è¡Œäº†ã€‚</p><p><img src="https://i.loli.net/2021/01/04/w3TLhzRgOH2A65d.png" alt="å¢é‡å¤åˆ¶è¿‡ç¨‹"></p></li></ul></li></ul><blockquote><p>å› ä¸º repl_backlog_buffer æ˜¯ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼Œæ‰€ä»¥åœ¨ç¼“å†²åŒºå†™æ»¡åï¼Œä¸»åº“ä¼šç»§ç»­å†™å…¥ï¼Œæ­¤æ—¶ï¼Œå°±ä¼šè¦†ç›–æ‰ä¹‹å‰å†™å…¥çš„æ“ä½œã€‚å¦‚æœä»åº“çš„è¯»å–é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´ä»åº“è¿˜æœªè¯»å–çš„æ“ä½œè¢«ä¸»åº“æ–°å†™çš„æ“ä½œè¦†ç›–äº†ï¼Œè¿™ä¼šå¯¼è‡´ä¸»ä»åº“é—´çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p></blockquote><p>æˆ‘ä»¬è¦æƒ³åŠæ³•é¿å…è¿™ä¸€æƒ…å†µï¼Œä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ repl_backlog_size è¿™ä¸ªå‚æ•°ã€‚è¿™ä¸ªå‚æ•°å’Œæ‰€éœ€çš„ç¼“å†²ç©ºé—´å¤§å°æœ‰å…³ã€‚ç¼“å†²ç©ºé—´çš„è®¡ç®—å…¬å¼æ˜¯ï¼š<strong>ç¼“å†²ç©ºé—´å¤§å° = ä¸»åº“å†™å…¥å‘½ä»¤é€Ÿåº¦ * æ“ä½œå¤§å° - ä¸»ä»åº“é—´ç½‘ç»œä¼ è¾“å‘½ä»¤é€Ÿåº¦ * æ“ä½œå¤§å°</strong>ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè€ƒè™‘åˆ°å¯èƒ½å­˜åœ¨ä¸€äº›çªå‘çš„è¯·æ±‚å‹åŠ›ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦æŠŠè¿™ä¸ªç¼“å†²ç©ºé—´æ‰©å¤§ä¸€å€ï¼Œå³ repl_backlog_size = ç¼“å†²ç©ºé—´å¤§å° * 2ï¼Œè¿™ä¹Ÿå°±æ˜¯ repl_backlog_size çš„æœ€ç»ˆå€¼</p><ul><li>repl_backlog_buffer<ul><li>æ˜¯ä¸ºäº†ä»åº“æ–­å¼€ä¹‹åï¼Œå¦‚ä½•æ‰¾åˆ°ä¸»ä»å·®å¼‚æ•°æ®è€Œè®¾è®¡çš„ç¯å½¢ç¼“å†²åŒºï¼Œä»è€Œé¿å…å…¨é‡åŒæ­¥å¸¦æ¥çš„æ€§èƒ½å¼€é”€</li><li>å¦‚æœä»åº“æ–­å¼€æ—¶é—´å¤ªä¹…ï¼Œrepl_backlog_bufferç¯å½¢ç¼“å†²åŒºè¢«ä¸»åº“çš„å†™å‘½ä»¤è¦†ç›–äº†ï¼Œé‚£ä¹ˆä»åº“è¿ä¸Šä¸»åº“ååªèƒ½ä¹–ä¹–åœ°è¿›è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥ï¼Œæ‰€ä»¥repl_backlog_bufferé…ç½®å°½é‡å¤§ä¸€äº›ï¼Œå¯ä»¥é™ä½ä¸»ä»æ–­å¼€åå…¨é‡åŒæ­¥çš„æ¦‚ç‡</li><li>è€Œåœ¨repl_backlog_bufferä¸­æ‰¾ä¸»ä»å·®å¼‚çš„æ•°æ®åï¼Œå¦‚ä½•å‘ç»™ä»åº“å‘¢ï¼Ÿè¿™å°±ç”¨åˆ°äº†replication buffer</li></ul></li><li>replication_buffer<ul><li>Rediså’Œå®¢æˆ·ç«¯é€šä¿¡ä¹Ÿå¥½ï¼Œå’Œä»åº“é€šä¿¡ä¹Ÿå¥½ï¼ŒRediséƒ½éœ€è¦ç»™åˆ†é…ä¸€ä¸ª å†…å­˜bufferè¿›è¡Œæ•°æ®äº¤äº’</li><li>å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªclientï¼Œä»åº“ä¹Ÿæ˜¯ä¸€ä¸ªclientï¼Œæˆ‘ä»¬æ¯ä¸ªclientè¿ä¸ŠRedisåï¼ŒRediséƒ½ä¼šåˆ†é…ä¸€ä¸ªclient bufferï¼Œæ‰€æœ‰æ•°æ®äº¤äº’éƒ½æ˜¯é€šè¿‡è¿™ä¸ªbufferè¿›è¡Œçš„</li><li>Rediså…ˆæŠŠæ•°æ®å†™åˆ°è¿™ä¸ªbufferä¸­ï¼Œç„¶åå†æŠŠbufferä¸­çš„æ•°æ®å‘åˆ°client socketä¸­å†é€šè¿‡ç½‘ç»œå‘é€å‡ºå»ï¼Œè¿™æ ·å°±å®Œæˆäº†æ•°æ®äº¤äº’ã€‚</li><li>æ‰€ä»¥ä¸»ä»åœ¨å¢é‡åŒæ­¥æ—¶ï¼Œä»åº“ä½œä¸ºä¸€ä¸ªclientï¼Œä¹Ÿä¼šåˆ†é…ä¸€ä¸ªbufferï¼Œåªä¸è¿‡è¿™ä¸ªbufferä¸“é—¨ç”¨æ¥ä¼ æ’­ç”¨æˆ·çš„å†™å‘½ä»¤åˆ°ä»åº“ï¼Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠå®ƒå«åšreplication buffer</li><li>è¿™ä¸ªbufferéœ€è¦åšå¤§å°çš„é™åˆ¶<ul><li>å¦‚æœä¸»ä»åœ¨ä¼ æ’­å‘½ä»¤æ—¶ï¼Œå› ä¸ºæŸäº›åŸå› ä»åº“å¤„ç†å¾—éå¸¸æ…¢ï¼Œé‚£ä¹ˆä¸»åº“ä¸Šçš„è¿™ä¸ªbufferå°±ä¼šæŒç»­å¢é•¿ï¼Œæ¶ˆè€—å¤§é‡çš„å†…å­˜èµ„æºï¼Œç”šè‡³OOM</li><li>æ‰€ä»¥Redisæä¾›äº†<strong>client-output-buffer-limit</strong>å‚æ•°é™åˆ¶è¿™ä¸ªbufferçš„å¤§å°ï¼Œå¦‚æœè¶…è¿‡é™åˆ¶ï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€è¿™ä¸ªclientçš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä»åº“å¤„ç†æ…¢å¯¼è‡´ä¸»åº“å†…å­˜bufferçš„ç§¯å‹è¾¾åˆ°é™åˆ¶åï¼Œä¸»åº“ä¼šå¼ºåˆ¶æ–­å¼€ä»åº“çš„è¿æ¥ï¼Œæ­¤æ—¶ä¸»ä»å¤åˆ¶ä¼šä¸­æ–­ï¼Œä¸­æ–­åå¦‚æœä»åº“å†æ¬¡å‘èµ·å¤åˆ¶è¯·æ±‚ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯èƒ½ä¼šå¯¼è‡´æ¶æ€§å¾ªç¯ï¼Œå¼•å‘å¤åˆ¶é£æš´ï¼Œè¿™ç§æƒ…å†µéœ€è¦æ ¼å¤–æ³¨æ„ã€‚</li></ul></li></ul></li></ul><h2 id="2-4-ä¸»ä»å…¨é‡åŒæ­¥-RDB-vs-AOF"><a href="#2-4-ä¸»ä»å…¨é‡åŒæ­¥-RDB-vs-AOF" class="headerlink" title="2.4 ä¸»ä»å…¨é‡åŒæ­¥ RDB vs AOF"></a>2.4 ä¸»ä»å…¨é‡åŒæ­¥ RDB vs AOF</h2><p>1ã€RDBæ–‡ä»¶å†…å®¹æ˜¯<strong>ç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆä¸åŒæ•°æ®ç±»å‹æ•°æ®åšäº†é’ˆå¯¹æ€§ä¼˜åŒ–ï¼‰</strong>ï¼Œæ–‡ä»¶å¾ˆå°ã€‚è€ŒAOFæ–‡ä»¶è®°å½•çš„æ˜¯æ¯ä¸€æ¬¡å†™æ“ä½œçš„å‘½ä»¤ï¼Œå†™æ“ä½œè¶Šå¤šæ–‡ä»¶ä¼šå˜å¾—å¾ˆå¤§ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬å¾ˆå¤šå¯¹åŒä¸€ä¸ªkeyçš„å¤šæ¬¡å†—ä½™æ“ä½œã€‚åœ¨ä¸»ä»å…¨é‡æ•°æ®åŒæ­¥æ—¶ï¼Œä¼ è¾“RDBæ–‡ä»¶å¯ä»¥å°½é‡é™ä½å¯¹ä¸»åº“æœºå™¨ç½‘ç»œå¸¦å®½çš„æ¶ˆè€—ï¼Œä»åº“åœ¨åŠ è½½RDBæ–‡ä»¶æ—¶ï¼Œä¸€æ˜¯æ–‡ä»¶å°ï¼Œè¯»å–æ•´ä¸ªæ–‡ä»¶çš„é€Ÿåº¦ä¼šå¾ˆå¿«ï¼ŒäºŒæ˜¯å› ä¸º<strong>RDBæ–‡ä»¶å­˜å‚¨çš„éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®</strong>ï¼Œä»åº“ç›´æ¥æŒ‰ç…§RDBåè®®è§£æè¿˜åŸæ•°æ®å³å¯ï¼Œé€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œè€ŒAOFéœ€è¦ä¾æ¬¡é‡æ”¾æ¯ä¸ªå†™å‘½ä»¤ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šç»å†å†—é•¿çš„å¤„ç†é€»è¾‘ï¼Œæ¢å¤é€Ÿåº¦ç›¸æ¯”RDBä¼šæ…¢å¾—å¤šï¼Œæ‰€ä»¥ä½¿ç”¨RDBè¿›è¡Œä¸»ä»å…¨é‡åŒæ­¥çš„æˆæœ¬æœ€ä½ã€‚</p><p>2ã€å‡è®¾è¦ä½¿ç”¨AOFåšå…¨é‡åŒæ­¥ï¼Œæ„å‘³ç€å¿…é¡»æ‰“å¼€AOFåŠŸèƒ½ï¼Œæ‰“å¼€AOFå°±è¦é€‰æ‹©æ–‡ä»¶åˆ·ç›˜çš„ç­–ç•¥ï¼Œé€‰æ‹©ä¸å½“ä¼šä¸¥é‡å½±å“Redisæ€§èƒ½ã€‚è€ŒRDBåªæœ‰åœ¨éœ€è¦å®šæ—¶å¤‡ä»½å’Œä¸»ä»å…¨é‡åŒæ­¥æ•°æ®æ—¶æ‰ä¼šè§¦å‘ç”Ÿæˆä¸€æ¬¡å¿«ç…§ã€‚è€Œåœ¨å¾ˆå¤šä¸¢å¤±æ•°æ®ä¸æ•æ„Ÿçš„ä¸šåŠ¡åœºæ™¯ï¼Œå…¶å®æ˜¯ä¸éœ€è¦å¼€å¯AOFçš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®å­˜å‚¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨AWS EC2æ­å»ºHaloåšå®¢</title>
      <link href="/%E4%BD%BF%E7%94%A8AWS-EC2%E6%90%AD%E5%BB%BAHalo%E5%8D%9A%E5%AE%A2/"/>
      <url>/%E4%BD%BF%E7%94%A8AWS-EC2%E6%90%AD%E5%BB%BAHalo%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="1-EC2-è®¾ç½®"><a href="#1-EC2-è®¾ç½®" class="headerlink" title="1. EC2 è®¾ç½®"></a>1. EC2 è®¾ç½®</h1><p>åœ¨å®Œæˆäº†AWSæ³¨å†Œä¹‹åï¼Œç™»å½•åå°ï¼Œåœ¨EC2çš„çœ‹æ¿å·¦ä¾§ç‚¹å‡»Instancesï¼Œé€‰æ‹©Launch Instancesï¼Œè¿™æ—¶å€™ä¼šå¸¦ä½ è¿›å…¥åˆ°é€‰æ‹©AMIçš„ç•Œé¢ï¼ŒæŒ‰ç…§Haloçš„æ¨èæ˜¯é€‰æ‹©CentOSæ¯”è¾ƒåˆé€‚ï¼Œä¸è¿‡äº²æµ‹äº†ä¸‹RHELï¼ŒCentOSéƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼ŒæŒ‰ç…§è‡ªå·±çš„éœ€è¦ (å¦‚æœæ–°è´¦å·çš„è¯ï¼Œä¼šæœ‰eligible free tier)ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨ä¸€å¹´ï¼Œä½¿ç”¨å…¶å³å¯ã€‚</p><p>å¯¹äºè¿è¡Œçš„EC2å®ä¾‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹VPC, Security Group. Elastic IPåšé…ç½®ï¼Œç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨VPCä¹‹å¤–(å…¬ç½‘)èƒ½å¤Ÿè®¿é—®HTTP, HTTPSç«¯å£ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯80,è¿˜æœ‰443. è¿™é‡Œçš„æ•´ä¸ªè¿‡ç¨‹(troubleshooting)å¯ä»¥æ ¹æ®è¿™ç¯‡å®˜æ–¹åšå®¢æ¥åšã€‚</p><p><a href="https://aws.amazon.com/cn/premiumsupport/knowledge-center/ec2-connect-internet-gateway/" target="_blank" rel="noopener">æ’æŸ¥ EC2 å®ä¾‹çš„äº’è”ç½‘ç½‘å…³è¿æ¥é—®é¢˜</a></p><h1 id="2-HaloåŸºæœ¬è®¾ç½®"><a href="#2-HaloåŸºæœ¬è®¾ç½®" class="headerlink" title="2. HaloåŸºæœ¬è®¾ç½®"></a>2. HaloåŸºæœ¬è®¾ç½®</h1><p>åœ¨æ ¹æ®ç¬¬ä¸€éƒ¨åˆ†çš„è¯´æ˜è®¾ç½®å¥½æœåŠ¡å™¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥sshä¸ŠæœåŠ¡å™¨ï¼Œç„¶åå¼€å§‹åšHaloçš„åŸºæœ¬è®¾ç½®</p><p>è¯¦æƒ…å¯ä»¥çœ‹Haloå®‰è£…çš„å®˜æ–¹æ•™ç¨‹ â€” <a href="https://halo.run/archives/install-with-linux.html" target="_blank" rel="noopener">åœ¨LinuxæœåŠ¡å™¨éƒ¨ç½²Hal</a>o</p><ul><li>å‡ ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹<ul><li>JVMå¯åŠ¨å†…å­˜çš„åˆ†é…</li><li>haloç‰ˆæœ¬çš„æ›´æ–°</li><li>ç«¯å£çš„è®¾ç½®</li></ul></li></ul><h1 id="3-åå‘ä»£ç†"><a href="#3-åå‘ä»£ç†" class="headerlink" title="3. åå‘ä»£ç†"></a>3. åå‘ä»£ç†</h1><p>ä½¿ç”¨Cattyæˆ–è€…Nginxæ¥åšåå‘ä»£ç†ï¼Œå®Œæˆhttpsè¯ä¹¦çš„ç”³è¯·ï¼Œåœ¨ä½ è‡ªå·±åŸŸåçš„æœåŠ¡å•†ä¸‹è®¾ç½®dnsï¼Œå¼€å§‹è®¿é—®ä½ è‡ªå·±çš„åšå®¢ã€‚</p><p>HaloåŸŸåçš„é…ç½®ä¸è®¿é—®</p><h1 id="4-Troubleshooting"><a href="#4-Troubleshooting" class="headerlink" title="4. Troubleshooting"></a>4. Troubleshooting</h1><ol><li>æœåŠ¡å™¨ä¸Šå¯åŠ¨äº†æœåŠ¡ï¼Œportå¼€äº†ä½†æ˜¯Public Ipè¿˜æ˜¯æ— æ³•è®¿é—®åˆ°</li></ol><p>è¿™çš„é”™è¯¯å¾ˆå¯èƒ½ä¸åœ¨å¼€å¯çš„æœåŠ¡(halo) æ–¹é¢ï¼Œè€Œåœ¨äºEC2é˜²ç«å¢™ VPCç­‰çš„é…ç½®ï¼Œæ£€æŸ¥ä¸‹ç«¯å£æ˜¯å¦éƒ½æ­£å¸¸å¼€å¯ï¼Œæ ¹æ®ç¬¬ä¸€éƒ¨åˆ†çš„æ’æŸ¥EC2äº’è”ç½‘ç½‘å…³è¿æ¥é—®é¢˜çš„æ–‡ç« ä¸€æ­¥æ­¥æ’æŸ¥ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥è§£å†³ã€‚</p><ol start="2"><li>åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹å¼€å¯çš„ç«¯å£ï¼Œå‘ç°æœåŠ¡åªå¼€åœ¨IPV6ä¸Šè€Œæ²¡æœ‰åœ¨IPV4ä¸Šå¼€å¯</li></ol><p>å‘ç°è¿™ä¸ªé—®é¢˜æ˜¯å‘ç°åœ¨ä½¿ç”¨telnet -tlnp æŒ‡ä»¤çš„æ—¶å€™ï¼Œå‘ç°Haloçš„è¿›ç¨‹ç¡®å®å¼€å¯äº†ï¼Œä½†æ˜¯æ˜¯ç›‘å¬åœ¨tcp6 ä¸‹ï¼Œåœ¨Ipv4ä¸‹æ²¡æœ‰ç«¯å£ç›‘å¬ã€‚æŸ¥è¯¢èµ„æ–™å‘ç°Java ç½‘ç»œæ¨¡å—ç°åœ¨æ˜¯é»˜è®¤å…ˆæ£€å¯Ÿå½“å‰æ“ä½œç³»ç»Ÿæ˜¯å¦æ”¯æŒIPv6ï¼Œ å¦‚æœæ”¯æŒï¼Œå°±ä¼šç›´æ¥ä½¿ç”¨IPv6ï¼Œ å¦åˆ™æ‰ä¼šä½¿ç”¨ipv4. <a href="https://stackoverflow.com/questions/44718174/spring-boot-application-listens-over-ipv6-without-djava-net-preferipv4stack-tru" target="_blank" rel="noopener">StackOverflow ä¸Šçš„é—®ç­”</a> å¦‚æœæƒ³è¦è®¾ç½®å…ˆç›‘å¬ipv4çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŒ‡ä»¤ä¸ŠåŠ ä¸Š</p><pre><code class="jsx">-Djava.net.preferIPv4Stack=true-Djava.net.preferIPv4Addresses// æ•´ä¸ªè¯­å¥å¦‚ä¸‹æ‰€ç¤º (æ˜¯åœ¨/etc/systemd/system/halo.serviceè¿™ä¸ªæ–‡ä»¶é‡Œåšé…ç½®) ExecStart=/usr/bin/java -server -Xms256m -Xmx256m -jar YOUR_JAR_PATH -Djava.net.preferIPv4Stack=true -Djava.net.preferIPv4Addresses</code></pre><p><a href="https://aws.amazon.com/premiumsupport/knowledge-center/connect-http-https-ec2/" target="_blank" rel="noopener">Connect to an Amazon EC2 instance on HTTP or HTTPS ports</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> EC2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API Rate Limiter Design</title>
      <link href="/API-Rate-Limiter-Design/"/>
      <url>/API-Rate-Limiter-Design/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li><p>What is a rate limiter? </p><ul><li>due to limited resources, also get rid of some abusive action, we need some kind of throttling or rate limiting mechanism thus only a certain number of requests will go to our service, and we are able to respond all of them </li><li>a rate limiter limits the number of events an entity can perform in a particular time window, then block requests once the cap is reached </li></ul></li><li><p>why we need to do rate limiting? </p><ul><li><p>Protect services against abusive behaviors targeting the application layer like </p><ul><li>DOS attacks </li><li>Brute Force credit card transactions </li></ul></li><li><p>why we need such protection?</p><ul><li>these attacks are a barrage of HTTP/S requests which may look like they are coming from real users, but are actually generated by machines </li><li>thus such attachs are harder to detect and can more easily bring down a service, application or an API </li></ul></li><li><p>could make a service and APIs more reliable</p><ul><li><p>misbehaving clients/ scripts </p></li><li><p>security </p><ul><li>second factor attempts </li></ul></li><li><p>prevent abusive behavior and bad design practices </p></li><li><p>keep costs and resource usage under control </p></li><li><p>revenue </p><ul><li>revenue model based on rate limiting </li></ul></li><li><p>eliminate spikiness in traffic </p></li></ul></li></ul></li></ul><h1 id="2-Requirement-and-Goal"><a href="#2-Requirement-and-Goal" class="headerlink" title="2. Requirement and Goal"></a>2. Requirement and Goal</h1><ul><li>functional <ul><li>limit the number of requests an entity can send to an API within a time window </li><li>APIs are accessible through a cluster, so the rate limit should be considered across different servers <ul><li>users should get an error message whenever the defined threshold is crossed within a single server or across a combination of servers </li></ul></li></ul></li></ul><h1 id="3-Thoughts"><a href="#3-Thoughts" class="headerlink" title="3. Thoughts"></a>3. Thoughts</h1><ul><li><p>table to store the request information, </p><ul><li><p>every entry will look like </p><ul><li>userId</li><li>api name </li><li>accessTime</li><li>api parameters</li></ul></li><li><p>and then we could query and sort by the accesstime to get related info </p></li></ul></li><li><p>there should have a caching layer to store the related info, most important one is for a specific user and specific api, based on the throttle limit(suppose n), whatâ€™s the time when they made the recent nth request, thus we could take a notes on this info </p></li></ul><h1 id="4-Design"><a href="#4-Design" class="headerlink" title="4. Design"></a>4. Design</h1><h2 id="4-1-High-Level"><a href="#4-1-High-Level" class="headerlink" title="4.1 High Level"></a>4.1 High Level</h2><ul><li>Clients make call to our web server </li><li>when request come, first sync with rate limiter server to decide if it will be served or throttled</li><li>web server then sync with API servers if rate limiter says it should not be blocked </li></ul><h2 id="4-2-Basic-System-Design-and-Algo"><a href="#4-2-Basic-System-Design-and-Algo" class="headerlink" title="4.2 Basic System Design and Algo"></a>4.2 Basic System Design and Algo</h2><ul><li><p>target </p><ul><li>limit the number of requests per user <ul><li>keep a count representing how many requestss the user has made </li><li>a timestamp when we started counting the requests </li></ul></li></ul></li><li><p>use a hashtable to store the info</p><ul><li>key - userId</li><li>value - count + startTime <ul><li>count would be enough if we donâ€™t need detail about the metrics or we say there are some other stuff controlling it </li><li>so based on the count and requirement, we could either increase the count, reset the count, or reset the start time. </li></ul></li><li>one issue for only store the starttime is itâ€™s possible to allow twice the configured number during a period. End of the previous window, with full capacity; and start at the next window, with full capacity. </li></ul></li></ul><ul><li>then we need to store timestamp of each request thus we could keep a sliding window <ul><li>use redis sorted set </li><li>steps when new request comes in<ul><li>remove all timestamps from the sorted set that are older than currentTime - 1 min (suppose thatâ€™s the configured window)</li><li>count the total number of elements in the sorted set </li><li>reject the request if count is greater than throttling limit </li><li>insert the current time in the sorted set and accept the reuqest </li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rate limiter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dropbox Design Scratch</title>
      <link href="/Dropbox-Design-Scratch/"/>
      <url>/Dropbox-Design-Scratch/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro-and-requirement"><a href="#1-Intro-and-requirement" class="headerlink" title="1. Intro and requirement"></a>1. Intro and requirement</h1><ul><li><p>cloud file storage services </p><ul><li>simplify the storage and exchange of digital resources among multiple devices </li><li>benefits <ul><li>availability </li><li>reliability and durability </li><li>scalability </li></ul></li></ul></li><li><p>requirements and goals </p><ul><li>users should be able to upload and download their files/ photos from any device </li><li>users should be able to share files or folders with other users </li><li>service should support automatic synchronization between devices </li><li>support storing large files </li><li>ACID support </li><li>Offline editing, CURD offline, and get synced when online </li><li>snapshotting of the data </li></ul></li></ul><h1 id="2-Thoughts"><a href="#2-Thoughts" class="headerlink" title="2. Thoughts"></a>2. Thoughts</h1><ul><li><p>size, limit , pattern </p><ul><li>read heavy </li><li>write huge file </li></ul></li><li><p>synchronize among different devices</p><ul><li>all devices make call to backend to grab newest status </li></ul></li><li><p>file/ folder share </p><ul><li>permission management </li></ul></li><li><p>Offline editing </p><ul><li>Use queue to store the data locally? </li></ul></li></ul><h1 id="3-Design"><a href="#3-Design" class="headerlink" title="3. Design"></a>3. Design</h1><h2 id="3-1-considerations"><a href="#3-1-considerations" class="headerlink" title="3.1  considerations"></a>3.1  considerations</h2><pre><code>+ huge read and write volumes    + read write almost equal + files can be stored in &lt;u&gt;**small parts or chunks (4MB)**&lt;/u&gt;, when fails, only the failed chunk should be retried + reduce the amount of data exchange by transfering updated chunks only + keep a local copy of metadata (file name, size, etc.) with the client can save us a lot of round trips to the server </code></pre><ul><li>high level design <ul><li>need to store files and metadata information like File name, file size, directory, who this file is shared with </li><li>need some servers that can help the clients to upload/ download files to cloud storage and some servers that can facilitate updating metadata about files and users</li><li>need some mechanism to notify all clients whenever an updates happens so they can synchronize their files </li></ul></li></ul><h2 id="3-2-high-level-design"><a href="#3-2-high-level-design" class="headerlink" title="3.2 high level design"></a>3.2 high level design</h2><pre><code>+ user specify folder as the workspace on the device     + file in the folder will be uploaded to the cloud     + updater/ delete will be reflected in the same way + modification on one device should be freely synced across others + systems we need based on requirements     + a storage server to store all real files     + a metadata service store file metadata, thus we could quickly get info about it     + a synchronizer service, to notify all clients whenever an update happens so they can synchronize files </code></pre><h2 id="3-3-Component-Design"><a href="#3-3-Component-Design" class="headerlink" title="3.3 Component Design"></a>3.3 Component Design</h2><h3 id="3-3-1-Client"><a href="#3-3-1-Client" class="headerlink" title="3.3.1 Client"></a>3.3.1 Client</h3><ul><li><p>responsibility </p><ul><li>need to monitor the workspace folder on userâ€™s machine </li><li>sync files/ folders with remote cloud storage </li><li>interact with the remote synchronization service to handle file metadata updates </li></ul></li><li><p>how to handle file transfer efficiently</p><ul><li><p>break each file into smaller chunks so that we transfer only those chunks that are modified and not the whole file </p></li><li><p>calculate chunk size based on:</p><ul><li>storage devices we use in the cloud </li><li>network bandwidth </li><li>average file size in the storage </li></ul></li><li><p>need to keep a record of each file and the chunks in metadata </p></li></ul></li><li><p>shall we keep a copy of metadata with client? </p><ul><li>yes, it then allows us to do offline updates </li></ul></li><li><p>how can clients efficiently listen to changes happening with other clients? </p><ul><li><p>Solution 1</p><ul><li>clients periodically check with the server if there are any changes </li><li>issues <ul><li>have a delay in reflecting changes locally as clients will be checking for changes periodically compared to server notifying whever there is some change </li></ul></li></ul></li><li><p>Solution 2</p><ul><li>HTTP long polling </li><li>client requests information from the server with the expectation that the server may not respond immediately </li><li>servers hold the request open and waits for response information to become available </li></ul></li></ul></li><li><p>components </p><ul><li><p>inernal metadata db </p><ul><li>keep track of all the files, chunks, versions and location </li></ul></li><li><p>chunker </p><ul><li>split files into smaller pieces </li><li>reconstruct a file from its chunks </li></ul></li><li><p>watcher </p><ul><li>monitor the local workspace folders and notify the indexer of any action performed by the users </li></ul></li><li><p>indexer </p><ul><li>process the events received from the watcher and update the internal metadata database with information about the chunks of the modified files </li><li>once confirm chunks are successfully uploaded to the cloud storage, the indexer will communicate with the remote synchronization service to broadcast changes to other clients and update remote metadata database </li></ul></li></ul></li><li><p>for phone users, probably should sync on demand to save bandwidth and capacity </p></li></ul><h3 id="3-3-2-Metadata-Database"><a href="#3-3-2-Metadata-Database" class="headerlink" title="3.3.2 Metadata Database"></a>3.3.2 Metadata Database</h3><ul><li>responsible for maintaing the versioning and metadata information about files/ chunks, users and workspaces </li><li>store info like <ul><li>chunks </li><li>files </li><li>users</li><li>devices</li><li>workspace </li></ul></li></ul><h3 id="3-3-3-Synchronization-Service"><a href="#3-3-3-Synchronization-Service" class="headerlink" title="3.3.3 Synchronization Service"></a>3.3.3 Synchronization Service</h3><ul><li><p>component that processes file updates made by a client and apply these changes to other subscribed clients </p></li><li><p>also synchronizes clients local databases with the information stored in the remote metadata db </p></li><li><p>Implement a differenciation algo to reduce the amount of the data that needs to be synchronized </p><ul><li>just transmit the difference between two versions instead of the whole file </li></ul></li><li><p>to support a scalable synchronization protocol</p><ul><li>use a communication middleware </li><li>messaging system <ul><li>push or pull strategies </li></ul></li></ul></li></ul><h3 id="3-3-4-Message-Queuing-Service"><a href="#3-3-4-Message-Queuing-Service" class="headerlink" title="3.3.4 Message Queuing Service"></a>3.3.4 Message Queuing Service</h3><ul><li>Message queue service <ul><li>supports asynchronous message based communication between clients and the synchronization service </li></ul></li></ul><h3 id="3-3-5-Cloud-Storage"><a href="#3-3-5-Cloud-Storage" class="headerlink" title="3.3.5 Cloud Storage"></a>3.3.5 Cloud Storage</h3><p>Cloud/Block Storage stores chunks of files uploaded by the users. Clients directly interact with the storage to send and receive objects from it. Separation of the metadata from storage enables us to use any storage either in the cloud or in-house.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.educative.io/courses/grokking-the-system-design-interview/m22Gymjp4mG" target="_blank" rel="noopener">Grokking the system design</a></li><li><a href="https://www.youtube.com/watch?v=U0xTu6E2CT8&t=9s&ab_channel=TechDummiesNarendraL" target="_blank" rel="noopener">Tech Dummies</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>LC-Dynamic Programming</title>
      <link href="/LC-Dynamic-Programming/"/>
      <url>/LC-Dynamic-Programming/</url>
      
        <content type="html"><![CDATA[<h1 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h1><h1 id="1-åŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€äº›æ€è·¯"><a href="#1-åŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€äº›æ€è·¯" class="headerlink" title="1. åŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€äº›æ€è·¯"></a>1. åŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€äº›æ€è·¯</h1><h2 id="1-1-åŸç†"><a href="#1-1-åŸç†" class="headerlink" title="1.1 åŸç†"></a>1.1 åŸç†</h2><ul><li>ä¸€èˆ¬å½¢å¼ â€“&gt; æ±‚æœ€å€¼<ul><li>æ ¸å¿ƒæ€è·¯ï¼š ç©·ä¸¾</li><li>ç‰¹æ®Šæ€§ï¼š å› ä¸ºå…¶å­˜åœ¨é‡å å­é—®é¢˜<ul><li>æš´åŠ›ç©·ä¸¾çš„æ—¶é—´å¤æ‚åº¦å°±ä¼šéå¸¸é«˜</li><li>æˆ‘ä»¬å°±éœ€è¦å¤‡å¿˜å½•/ DP tableæ¥ä¼˜åŒ–ç©·ä¸¾çš„è¿‡ç¨‹ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—</li><li>ä¸€èˆ¬ä¼šå…·å¤‡æœ€ä¼˜å­ç»“æ„ï¼Œæ‰èƒ½é€šè¿‡å­é—®é¢˜çš„æœ€å€¼å¾—åˆ°åŸé—®é¢˜çš„æœ€å€¼</li><li>å…³äºå¦‚ä½•ç©·ä¸¾æ‰€æœ‰çš„å¯èƒ½è§£ï¼Œå°±éœ€è¦åˆ†æå¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä»¥ä¸Šä¹Ÿå°±æ˜¯åŠ¨æ€è§„åˆ’çš„ä¸‰è¦ç´ </li></ul></li></ul></li><li>ä¸‰è¦ç´ <ul><li>é‡å å­é—®é¢˜<ul><li>å­é—®é¢˜ä¹‹é—´éœ€è¦äº’ç›¸ç‹¬ç«‹</li><li>é‡å å­é—®é¢˜ éœ€è¦åšæŸç§è®°å½•ï¼Œä½¿ç”¨dp table æˆ–è€…å¤‡å¿˜å½•<ul><li>å¯ä»¥å°è¯•é€šè¿‡çŠ¶æ€å‹ç¼©ï¼Œæ¥ç¼©å°DP tableçš„å¤§å°ï¼Œåªè®°å½•å¿…è¦çš„æ•°æ®</li></ul></li></ul></li><li>æœ€ä¼˜å­ç»“æ„</li><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹<ul><li>å°±æ˜¯n å’Œ n-1, n-2ä¹‹é—´çš„å…³ç³»</li><li>å¦‚ä½•æ€è€ƒ<ul><li>æ˜ç¡®base case</li><li>æ˜ç¡®çŠ¶æ€</li><li>æ˜ç¡®é€‰æ‹©</li><li>å®šä¹‰dpæ•°ç»„/ å‡½æ•°çš„å«ä¹‰</li></ul></li></ul></li></ul></li><li>å’Œé€’å½’çš„å¯¹æ¯”<ul><li>é€’å½’å¾€å¾€æ˜¯è‡ªä¸Šè€Œä¸‹ï¼Œåˆ†è§£å‡ºå­é—®é¢˜ï¼Œå†åˆ©ç”¨æ ˆçš„é€»è¾‘ï¼Œåå‘æ‹¿åˆ°ç»“æœ</li><li>è€ŒåŠ¨æ€è§„åˆ’æ˜¯è‡ªä¸‹è€Œä¸Šçš„ï¼Œç›´æ¥å®šä¹‰å‡ºäº†å­é—®é¢˜ï¼Œç„¶åæˆ‘ä»¬æ¥å®šä¹‰çŠ¶æ€æ˜¯å¦‚ä½•è½¬ç§»çš„</li></ul></li></ul><h2 id="1-2-åŸºæœ¬æ–¹æ³•è®º"><a href="#1-2-åŸºæœ¬æ–¹æ³•è®º" class="headerlink" title="1.2 åŸºæœ¬æ–¹æ³•è®º"></a>1.2 åŸºæœ¬æ–¹æ³•è®º</h2><ul><li>é€»è¾‘æ˜¯éœ€è¦æ‰¾åˆ°ä¸€äº›è§„å¾‹æ¥æŒ‡å¯¼æˆ‘ä»¬è§£å†³åŠ¨æ€è§„åˆ’é—®é¢˜<ul><li>å¯»æ‰¾å­é—®é¢˜</li><li>é€’å½’æ±‚è§£</li><li>é‡å å­é—®é¢˜</li><li>æ— åæ•ˆæ€§</li><li>çŠ¶æ€å­˜å‚¨</li></ul></li></ul><h2 id="1-3-é€’å½’"><a href="#1-3-é€’å½’" class="headerlink" title="1.3 é€’å½’"></a>1.3 é€’å½’</h2><ul><li>ä½¿ç”¨è´ªå¿ƒç®—æ³•æ˜¯æœ‰å¯èƒ½å¤±æ•ˆå¯¼è‡´æ— æ³•ç”Ÿæˆå…¨å±€æœ€ä¼˜è§£çš„</li><li>æœ€ä¼˜åŒ–é—®é¢˜æœ¬èº«æŒ‡çš„æ˜¯ä¸€ç§æ±‚æå€¼çš„æ–¹æ³•ï¼Œå³åœ¨ä¸€ç»„çº¦æŸä¸ºç­‰å¼æˆ–ä¸ç­‰å¼çš„æ¡ä»¶ä¸‹ï¼Œä½¿ç³»ç»Ÿçš„ç›®æ ‡å‡½æ•°è¾¾åˆ°æå€¼ï¼Œå³æœ€å¤§å€¼æˆ–æœ€å°å€¼çš„è¿‡ç¨‹</li><li>æˆ‘ä»¬éœ€è¦åšåˆ°çš„æ˜¯åœ¨æ»¡è¶³æ¡ä»¶çš„ç»„åˆé‡Œæ‰¾å‡ºæœ€ä¼˜è§£çš„ç»„åˆ<ul><li>æšä¸¾<ul><li>æ±‚å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç»„åˆï¼Œç„¶åçœ‹çœ‹è¿™äº›ç»„åˆèƒ½å¦å¾—åˆ°æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼</li><li>å…³é”®é—®é¢˜ â€“ å¦‚ä½•å¾—åˆ°æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰ç»„åˆ<ul><li>ä½¿ç”¨é€’å½’æ¥è·å¾—æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ‰€æœ‰ç»„åˆ</li><li>â€“ã€‹ é€’å½’æ˜¯ä¸€ç§æšä¸¾çš„æ‰‹æ³•ï¼Œæ»¡è¶³é™å®šæ¡ä»¶ä¸‹ï¼Œåšé€’å½’</li><li>åœ¨é€’å½’çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ­¥éƒ½å¯¹éœ€è¦æ±‚è§£çš„é—®é¢˜æ¥è¿›è¡Œåˆ¤æ–­</li></ul></li><li>ä½¿ç”¨é€’å½’çš„å¥½å¤„<ul><li>æ˜¯åœ¨ä½¿ç”¨å †æ ˆçš„æ—¶å€™å®é™…ä¸Šè‡ªç„¶çš„å°±ä¿å­˜äº†æ¯ä¸€å±‚çš„å±€éƒ¨å˜é‡ä»¬</li><li>é€’å½’çš„å½¢å¼ä¹Ÿç»™äº†å›æº¯çš„èƒ½åŠ›ï¼Œé€šè¿‡å †æ ˆä¿å­˜äº†ä¸Šä¸€æ­¥çš„çŠ¶æ€çš„</li></ul></li></ul></li></ul></li><li>ç›´æ¥ä½¿ç”¨é€’å½’çš„é—®é¢˜<ul><li>å®é™…ä¸Šæ˜¯ç©·ä¸¾äº†æ‰€æœ‰çš„ç»„åˆï¼Œå¯¼è‡´æ•ˆç‡å¾ˆä½</li><li>æ„æˆçš„é€’å½’æ ‘ä¼šéšç€æ•°æ®è§„æ¨¡çš„å¢é•¿è€ŒæŒ‡æ•°çº§åˆ«çš„å¢é•¿</li><li>ç›´æ¥ä½¿ç”¨é€’å½’è°ƒè¯•ç›¸å¯¹æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºéœ€è¦æ€è€ƒæ¯ä¸€å±‚çš„è¡¨ç°</li></ul></li><li>é€’å½’çš„ä¼˜åŒ–<ul><li>å‰ªæ<ul><li>å‡å°‘æœç´¢çš„åˆ†æ”¯æ•°é‡</li><li>é‡å å­é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æå‰å­˜å‚¨ï¼Œæ¥å‡å°‘é‡å¤çš„è¿ç®—</li></ul></li></ul></li></ul><h2 id="1-4-å¤‡å¿˜å½•"><a href="#1-4-å¤‡å¿˜å½•" class="headerlink" title="1.4 å¤‡å¿˜å½•"></a>1.4 å¤‡å¿˜å½•</h2><ul><li>å‰é¢è¯´è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡æšä¸¾æ¥è·å¾—æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰ç»„åˆï¼Œç„¶åå†æ¥æ±‚éœ€è¦çš„æå€¼ï¼Œä½†æ˜¯åœ¨è¿™ä¸­é—´æ˜¯å¾ˆæœ‰å¯èƒ½æœ‰é‡å å­é—®é¢˜çš„</li><li>å¯ç”¨çš„å‰ææ¡ä»¶<ul><li>æ— åæ•ˆæ€§<ul><li>å³åœ¨é€šè¿‡ A é˜¶æ®µçš„å­é—®é¢˜æ¨å¯¼ B é˜¶æ®µçš„å­é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸éœ€è¦å›è¿‡å¤´å»å†æ ¹æ® B é˜¶æ®µçš„å­é—®é¢˜é‡æ–°æ¨å¯¼ A é˜¶æ®µçš„å­é—®é¢˜</li><li>å³å­é—®é¢˜ä¹‹é—´çš„ä¾èµ–æ˜¯å•å‘æ€§çš„</li></ul></li></ul></li><li>ä»¥æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸ºä¾‹<ul><li>æˆ‘ä»¬åœ¨ç–¯ç‹‚çš„é‡å¤è®¡ç®—å­å‡½æ•°ï¼Œå¤§éƒ¨åˆ†çš„é€’å½’æ ‘éƒ½æ˜¯é‡å¤çš„</li><li>ä¸¾ä¸ªä¾‹å­<ul><li>f(9) = f(8) + f(7)</li><li>åœ¨è®¡ç®—f(8)çš„æ—¶å€™ï¼Œåˆéœ€è¦è®¡ç®—ä¸€éf(7)</li><li>å¦‚æ­¤åå¤</li></ul></li></ul></li><li>å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤‡å¿˜å½•æ¥è§£å†³é‡å¤è®¡ç®—çš„é—®é¢˜<ul><li>åœ¨æ¯æ¬¡è®¡ç®—å‡ºä¸€ä¸ªå­é—®é¢˜çš„ç­”æ¡ˆä»¥åï¼Œå°†è¿™ä¸ªä¸´æ—¶çš„ä¸­é—´ç»“æœè®°å½•åˆ°å¤‡å¿˜å½•å½“ä¸­ï¼Œç„¶åå†è¿”å›</li></ul></li><li>å¸¸è§çš„å¯ç”¨æ•°æ®ç»“æ„<ul><li>æ•°ç»„</li><li>å“ˆå¸Œè¡¨</li></ul></li></ul><h2 id="1-5-åŠ¨å½’çš„åº”ç”¨åœºæ™¯"><a href="#1-5-åŠ¨å½’çš„åº”ç”¨åœºæ™¯" class="headerlink" title="1.5 åŠ¨å½’çš„åº”ç”¨åœºæ™¯"></a>1.5 åŠ¨å½’çš„åº”ç”¨åœºæ™¯</h2><h3 id="1-5-1-0-1èƒŒåŒ…é—®é¢˜"><a href="#1-5-1-0-1èƒŒåŒ…é—®é¢˜" class="headerlink" title="1.5.1 0-1èƒŒåŒ…é—®é¢˜"></a>1.5.1 0-1èƒŒåŒ…é—®é¢˜</h3><ul><li><p>é—®é¢˜æè¿°</p><ul><li>æ€»é‡é‡ä¸ºWçš„èƒŒåŒ…å’ŒNä¸ªç‰©å“ï¼Œå¯¹æ¯ä¸ªç‰©å“ï¼Œæœ‰é‡é‡wå’Œä»·å€¼vä¸¤ä¸ªå±æ€§ï¼Œå³ç¬¬iä¸ªç‰©å“é‡é‡ä¸ºw[i],ä»·å€¼ä¸ºv[i]</li></ul></li><li><p>ç®—æ³•é—®é¢˜åˆ†æ</p><ul><li><p>é¦–å…ˆçœ‹æ˜¯ä»€ä¹ˆç±»å‹çš„é—®é¢˜</p><ul><li><p>æ±‚æœ€ä¼˜è§£çš„é—®é¢˜ï¼ˆmax / minï¼‰</p><ul><li>è€ƒè™‘ä¸‹ä½¿ç”¨è´ªå¿ƒç®—æ³•çš„å¯èƒ½æ€§</li><li>æš´åŠ›é€’å½’åšç©·ä¸¾</li><li>åŠ¨æ€è§„åˆ’</li></ul></li><li><p>æ±‚å¯è¡Œæ€§çš„é—®é¢˜</p></li><li><p>æ±‚æ–¹æ¡ˆæ€»æ•°çš„é—®é¢˜</p></li></ul></li><li><p>è¿›ä¸€æ­¥ç¡®è®¤æ˜¯å¦ä¸ºåŠ¨æ€è§„åˆ’é—®é¢˜</p><ul><li>æ•°æ®éœ€è¦ä¸å¯æ’åº</li><li>æ•°æ®ä¸å¯äº¤æ¢</li></ul></li></ul></li><li><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</p><ul><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶<ul><li>èƒŒåŒ…å®¹é‡ä¸º0äº†æˆ–è€…ç‰©å“æ•°é‡ä¸º0è¦ç»ˆæ­¢æ‰§è¡Œ</li><li>èƒŒåŒ…ä¸­çš„ç‰©å“æ•°é‡å’ŒèƒŒåŒ…è¿˜èƒ½è£…ä¸‹çš„é‡é‡æ˜¯è¿™ä¸ªé—®é¢˜çš„çŠ¶æ€å‚æ•°</li></ul></li></ul></li></ul><pre><code class="jsx">int dp(int[] w, int[] v, int N, int W) {    // åˆ›å»ºå¤‡å¿˜å½•    int[][] dp = new int[N+1][W+1];    // åˆå§‹åŒ–çŠ¶æ€    for (int i = 0; i &lt; N + 1; i++) { dp[i][0] = 0; }    for (int j = 0; j &lt; W + 1; j++) { dp[0][j] = 0; }    for (int tn = 1; tn &lt; N + 1; tn++) { // éå†æ¯ä¸€ä»¶ç‰©å“    for (int rw = 1; rw &lt; W + 1; rw++) { // èƒŒåŒ…å®¹é‡æœ‰å¤šå¤§å°±è¿˜è¦è®¡ç®—å¤šå°‘æ¬¡        if (rw &lt; w[tn]) {          // å½“èƒŒåŒ…å®¹é‡å°äºç¬¬tnä»¶ç‰©å“é‡é‡æ—¶ï¼Œåªèƒ½æ”¾å…¥å‰tn-1ä»¶          dp[tn][rw] = dp[tn-1][rw];        } else {                // å½“èƒŒåŒ…å®¹é‡è¿˜å¤§äºç¬¬tnä»¶ç‰©å“é‡é‡æ—¶ï¼Œè¿›ä¸€æ­¥ä½œå‡ºå†³ç­–          dp[tn][rw] = Math.max(dp[tn-1][rw], dp[tn-1][rw-w[tn]] + v[tn]);        }      }    }  return dp[N][W];}int solveDP() {  int N = 3, W = 5; // ç‰©å“çš„æ€»æ•°ï¼ŒèƒŒåŒ…èƒ½å®¹çº³çš„æ€»é‡é‡  int[] w = {0, 3, 2, 1}; // ç‰©å“çš„é‡é‡  int[] v = {0, 5, 2, 3}; // ç‰©å“çš„ä»·å€¼  return dp(w, v, N, W); // è¾“å‡ºç­”æ¡ˆ}</code></pre><h1 id="2-åŠ¨æ€è§„åˆ’çš„å†™æ³•åˆ†æ"><a href="#2-åŠ¨æ€è§„åˆ’çš„å†™æ³•åˆ†æ" class="headerlink" title="2. åŠ¨æ€è§„åˆ’çš„å†™æ³•åˆ†æ"></a>2. åŠ¨æ€è§„åˆ’çš„å†™æ³•åˆ†æ</h1><ul><li>åŠ¨æ€è§„åˆ’é—®é¢˜æè¿°<ul><li>é‡å å­é—®é¢˜<ul><li>ç©·ä¸¾è¿‡ç¨‹ä¸­å­˜åœ¨é‡å¤è®¡ç®—çš„ç°è±¡</li></ul></li><li>æ— åæ•ˆæ€§<ul><li>å­é—®é¢˜ä¹‹é—´çš„ä¾èµ–æ˜¯å•å‘æ€§çš„</li><li>æŸé˜¶æ®µçŠ¶æ€ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å—åç»­å†³ç­–çš„å½±å“</li></ul></li><li>æœ€ä¼˜å­ç»“æ„<ul><li>å­é—®é¢˜ä¹‹é—´å¿…é¡»ç›¸äº’ç‹¬ç«‹ï¼Œæˆ–è€…è¯´åç»­çš„è®¡ç®—å¯ä»¥é€šè¿‡å‰é¢çš„çŠ¶æ€æ¨å¯¼å‡ºæ¥</li></ul></li></ul></li></ul><h1 id="3-æ¡ˆä¾‹åˆ†æ"><a href="#3-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="3. æ¡ˆä¾‹åˆ†æ"></a>3. æ¡ˆä¾‹åˆ†æ</h1><h2 id="3-1-ç¡¬å¸æ‰¾é›¶é—®é¢˜"><a href="#3-1-ç¡¬å¸æ‰¾é›¶é—®é¢˜" class="headerlink" title="3.1 ç¡¬å¸æ‰¾é›¶é—®é¢˜"></a>3.1 ç¡¬å¸æ‰¾é›¶é—®é¢˜</h2><ul><li>é—®é¢˜æè¿°<ul><li>ç»™å®šnç§ä¸åŒé¢å€¼çš„ç¡¬å¸ åˆ†åˆ«è®°ä¸ºc[0], c[1], c[2]â€¦c[n]</li><li>æ€»æ•°é¢k</li><li>ç¼–å†™ä¸€ä¸ªå‡½æ•°è®¡ç®—å‡ºæœ€å°‘éœ€è¦å‡ æšç¡¬å¸å‡‘å‡ºè¿™ä¸ªé‡‘é¢K</li><li>è‹¥æ— å¯èƒ½çš„ç»„åˆï¼Œè¿”å›-1</li></ul></li><li>æ€è·¯<ul><li>è¿™æ˜¯ä¸ªæ±‚æœ€å€¼çš„é—®é¢˜</li><li>æ±‚æœ€å€¼é—®é¢˜çš„æ ¸å¿ƒåŸç†å°±æ˜¯ç©·ä¸¾ï¼Œå°†æ‰€æœ‰å¯èƒ½çš„å‡‘ç¡¬å¸çš„æ–¹æ³•åšç©·ä¸¾ï¼Œçœ‹çœ‹æœ€å°‘éœ€è¦å¤šå°‘æšç¡¬å¸</li></ul></li><li>è´ªå¿ƒç®—æ³•<ul><li>æ¯ä¸€æ­¥è®¡ç®—åšå‡ºçš„éƒ½æ˜¯åœ¨å½“å‰çœ‹èµ·æ¥æœ€å¥½çš„é€‰æ‹©<ul><li>å³å±€éƒ¨æœ€ä¼˜è§£ï¼Œå¹¶ä¸ä»æ•´ä½“æ¥è€ƒè™‘</li></ul></li><li>åŸºæœ¬æ€è·¯<ul><li>å»ºç«‹æ•°å­¦æ¨¡å‹</li><li>å°†å¾…æ±‚è§£çš„é—®é¢˜åˆ’åˆ†ä¸ºè‹¥å¹²å­é—®é¢˜ï¼Œå¯¹æ¯ä¸ªå­é—®é¢˜è¿›è¡Œæ±‚è§£ï¼Œå¾—åˆ°å­é—®é¢˜çš„å±€éƒ¨æœ€ä¼˜è§£</li><li>å°†å­é—®é¢˜çš„å±€éƒ¨æœ€ä¼˜è§£è¿›è¡Œåˆå¹¶ï¼Œæœ€ç»ˆå¾—åˆ°åŸºäºå±€éƒ¨æœ€ä¼˜è§£çš„ä¸€ä¸ªè§£</li></ul></li></ul></li><li>ç”¨è´ªå¿ƒç®—æ³•æ¥è§£å†³ä¸Šè¿°é—®é¢˜çš„æ—¶å€™ï¼Œä¼šé‡åˆ°â€œè¿‡äºè´ªå¿ƒâ€å¯¼è‡´æœ€ç»ˆæ— è§£çš„é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥å›æº¯æ¥è§£å†³è¿‡äºè´ªå¿ƒçš„é—®é¢˜</li><li>è´ªå¿ƒç®—æ³•çš„å®ç°</li></ul><pre><code>int getMinCoinCountHelper(int total, int[] values, int valueCount) {    int rest = total;    int count = 0;    // ä»å¤§åˆ°å°éå†æ‰€æœ‰é¢å€¼    for (int i = 0; i &lt; valueCount; ++ i) {        int currentCount = rest / values[i]; // è®¡ç®—å½“å‰é¢å€¼æœ€å¤šèƒ½ç”¨å¤šå°‘ä¸ª        rest -= currentCount * values[i]; // è®¡ç®—ä½¿ç”¨å®Œå½“å‰é¢å€¼åçš„ä½™é¢        count += currentCount; // å¢åŠ å½“å‰é¢é¢ç”¨é‡        if (rest == 0) {            return count;        }    }    return -1; // å¦‚æœåˆ°è¿™é‡Œè¯´æ˜æ— æ³•å‡‘å‡ºæ€»ä»·ï¼Œè¿”å›-1}int getMinCoinCount() {    int[] values = { 5, 3 }; // ç¡¬å¸é¢å€¼    int total = 11; // æ€»ä»·    return getMinCoinCountHelper(total, values, 2); // è¾“å‡ºç»“æœ}</code></pre><ul><li>è´ªå¿ƒç®—æ³• + å›æº¯çš„å®ç°</li></ul><pre><code>int getMinCoinCountOfValue(int total, int[] values, int valueIndex) {    int valueCount = values.length;    if (valueIndex == valueCount) { return Integer.MAX_VALUE; }    int minResult = Integer.MAX_VALUE;    int currentValue = values[valueIndex];    int maxCount = total / currentValue;    for (int count = maxCount; count &gt;= 0; count --) {        int rest = total - count * currentValue;        // å¦‚æœrestä¸º0ï¼Œè¡¨ç¤ºä½™é¢å·²é™¤å°½ï¼Œç»„åˆå®Œæˆ        if (rest == 0) {            minResult = Math.min(minResult, count);            break;        }        // å¦åˆ™å°è¯•ç”¨å‰©ä½™é¢å€¼æ±‚å½“å‰ä½™é¢çš„ç¡¬å¸æ€»æ•°        int restCount = getMinCoinCountOfValue(rest, values, valueIndex + 1);        // å¦‚æœåç»­æ²¡æœ‰å¯ç”¨ç»„åˆ        if (restCount == Integer.MAX_VALUE) {            // å¦‚æœå½“å‰é¢å€¼å·²ç»ä¸º0ï¼Œè¿”å›-1è¡¨ç¤ºå°è¯•å¤±è´¥            if (count == 0) { break; }            // å¦åˆ™å°è¯•æŠŠå½“å‰é¢å€¼-1            continue;        }        minResult = Math.min(minResult, count + restCount);    }    return minResult;}int getMinCoinCountLoop(int total, int[] values, int k) {    int minCount = Integer.MAX_VALUE;    int valueCount = values.length;    if (k == valueCount) {        return Math.min(minCount, getMinCoinCountOfValue(total, values, 0));    }    for (int i = k; i &lt;= valueCount - 1; i++) {        // kä½ç½®å·²ç»æ’åˆ—å¥½        int t = values[k];        values[k] = values[i];        values[i]=t;        minCount = Math.min(minCount, getMinCoinCountLoop(total, values, k + 1)); // è€ƒè™‘åä¸€ä½        // å›æº¯        t = values[k];        values[k] = values[i];        values[i]=t;    }    return minCount;}int getMinCoinCountOfValue() {    int[] values = { 5, 3 }; // ç¡¬å¸é¢å€¼    int total = 11; // æ€»ä»·    int minCoin = getMinCoinCountLoop(total, values, 0);    return (minCoin == Integer.MAX_VALUE) ? -1 : minCoin;  // è¾“å‡ºç­”æ¡ˆ}</code></pre><ul><li><p>ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£</p><ul><li>åˆå§‹åŒ–çŠ¶æ€<ul><li>ç»ˆæ­¢æ¡ä»¶</li></ul></li><li>çŠ¶æ€å‚æ•°<ul><li>å­é—®é¢˜ä¸åŸé—®é¢˜ä¹‹é—´ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡</li><li>å˜é‡æ˜¯ç›®æ ‡å…‘æ¢é‡‘é¢K</li></ul></li><li>æ•´ä½“æ€è·¯<ul><li>ç¡®å®šåˆå§‹åŒ–çŠ¶æ€</li><li>ç¡®å®šçŠ¶æ€å‚æ•°</li><li>è®¾è®¡å†³ç­–</li></ul></li></ul></li><li><p>é€’å½’ä¸åŠ¨æ€è§„åˆ’çš„å¯¹æ¯”</p><ul><li><p>é€’å½’æ˜¯è‡ªä¸Šè€Œä¸‹çš„ï¼Œä»ç›®æ ‡é—®é¢˜å¼€å§‹ï¼Œä¸æ–­å°†å¤§é—®é¢˜æ‹†è§£æˆå­é—®é¢˜ï¼Œç›´åˆ°å­é—®é¢˜ä¸å¯æ‹†å€Ÿä¸ºæ­¢</p></li><li><p>å¦‚æœè¦è‡ªåº•å‘ä¸Šï¼Œé‚£å°±åº”è¯¥é¦–å…ˆæ±‚å‡ºæ‰€æœ‰çš„å­é—®é¢˜ï¼Œç„¶åé€šè¿‡åº•å±‚çš„å­é—®é¢˜å‘ä¸Šæ±‚è§£æ›´å¤§çš„é—®é¢˜</p><pre><code>// ä¼ªä»£ç DP(values, k) {res = MAXfor c in values// ä½œå‡ºå†³ç­–ï¼Œæ‰¾åˆ°éœ€è¦ç¡¬å¸æœ€å°‘çš„é‚£ä¸ªç»“æœres = min(res, 1 + DP(values, k-c)) // é€’å½’è°ƒç”¨if res == MAXreturn -1return res}</code></pre></li></ul></li></ul><pre><code>int getMinCounts(int k, int[] values) {   int[] memo = new int[k + 1]; // åˆ›å»ºå¤‡å¿˜å½•   memo[0] = 0; // åˆå§‹åŒ–çŠ¶æ€   for (int i = 1; i &lt; k + 1; i++) { memo[i] = k + 1; }   for (int i = 1; i &lt; k + 1; i++) {       for (int coin : values) {           if (i - coin &lt; 0) { continue; }           memo[i] = Math.min(memo[i], memo[i - coin] + 1); // ä½œå‡ºå†³ç­–       }   }   return memo[k] == k + 1 ? -1 : memo[k];}int getMinCountsDPSolAdvance() {   int[] values = { 3, 5 }; // ç¡¬å¸é¢å€¼   int total = 22; // æ€»å€¼   return getMinCounts(total, values); // è¾“å‡ºç­”æ¡ˆ}</code></pre><h1 id="62-Unique-Paths"><a href="#62-Unique-Paths" class="headerlink" title="62. Unique Paths"></a>62. Unique Paths</h1><h2 id="Solution-1-Recursion"><a href="#Solution-1-Recursion" class="headerlink" title="Solution 1: Recursion"></a>Solution 1: Recursion</h2><pre><code>class Solution {    int result = 0;    public int uniquePaths(int m, int n) {        // direction is either right or down         helper(1, 1, m, n);        return result;    }    private void helper(int x, int y, int m, int n) {        if (x &lt; 1 || x &gt; m || y &lt; 1 || y &gt; n) {            return;        }        if (x == m &amp;&amp; y == n) {            result ++;        }        helper(x + 1, y, m, n);        helper(x, y + 1, m, n);    }}</code></pre><h2 id="Solution-2-DP"><a href="#Solution-2-DP" class="headerlink" title="Solution 2: DP"></a>Solution 2: DP</h2><ul><li>æ³¨æ„çš„ç‚¹<ul><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹<ul><li><code>dp[m][n] = dp[m-1][n] + dp[m][n-1];</code></li></ul></li><li>å› ä¸ºåªæœ‰ä¸¤ä¸ªæ–¹å‘ï¼Œå®é™…ä¸Šç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—èƒ½åˆ°è¾¾çš„æ–¹æ³•éƒ½åªæœ‰ä¸€ç§ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åšåˆå§‹åŒ–çš„æ—¶å€™å¯ä»¥éƒ½åˆå§‹åŒ–ä¸º1ï¼Œå…·ä½“çš„è¿­ä»£ä»col = 1, row = 1å¼€å§‹ï¼Œå³ç¬¬äºŒè¡Œå’Œç¬¬äºŒåˆ— è¿™æ ·æ¥åšå°±okayäº†</li></ul></li></ul><pre><code>class Solution {     public int uniquePaths(int m, int n) {        // äºŒç»´DP           // dp[m][n] = dp[m-1][n] + dp[m][n-1];        int[][] dp = new int[m][n];        for (int[] arr: dp) {            Arrays.fill(arr, 1);        }        for (int col = 1; col &lt; n; col ++) {            for(int row = 1; row &lt; m; row ++) {                dp[row][col] = dp[row-1][col] + dp[row][col-1];            }        }        return dp[m-1][n-1];    }}</code></pre><h1 id="70-Climbing-Stairs"><a href="#70-Climbing-Stairs" class="headerlink" title="70. Climbing Stairs"></a>70. Climbing Stairs</h1><h2 id="Solution-1-DP"><a href="#Solution-1-DP" class="headerlink" title="Solution 1: DP"></a>Solution 1: DP</h2><ul><li><code>dp[n] = dp[n-1] + dp[n-2]</code></li></ul><pre><code>class Solution {    public int climbStairs(int n) {        // dp[n] = dp[n-1] + dp[n-2]        if (n &lt;= 0) {            return 0;        }        int[] dp = new int[n + 1];        dp[0] = 1;        dp[1] = 1;        for (int i = 2; i &lt;= n; i++) {            dp[i] = dp[i-1] + dp[i-2];        }        return dp[n];    }}</code></pre><h1 id="91-Decode-Ways"><a href="#91-Decode-Ways" class="headerlink" title="91. Decode Ways"></a>91. Decode Ways</h1><h2 id="Solution-1-DP-1"><a href="#Solution-1-DP-1" class="headerlink" title="Solution 1: DP"></a>Solution 1: DP</h2><ul><li>æ¯æ¬¡å¯ä»¥é€‰æ‹©å¾€å‰èµ°ä¸€æ­¥æˆ–è€…ä¸¤æ­¥</li></ul><pre><code>class Solution {    public int numDecodings(String s) {        if (s == null || s.length() == 0) {            return 0;        }        int[] dp = new int[s.length() + 1];        // could go by 1 step or 2 step         // dp[n] = dp[n-1] + dp[n-2]        //     s.charAt(n) 1 --9        //     s.charAt(n-1) 1 -- 2  if n-1 == 1  n 0 - 9  if n-1 == 2 n 0 - 6         dp[0] = 1;        dp[1] = s.charAt(0) == &#39;0&#39; ? 0 : 1;        for (int i = 2; i &lt;= s.length(); i ++) {            if (s.charAt(i - 1) != &#39;0&#39;) {                dp[i] += dp[i-1];            }            if (s.charAt(i-2) == &#39;1&#39; || (s.charAt(i-2) == &#39;2&#39; &amp;&amp;                                          s.charAt(i - 1) &gt;= &#39;0&#39; &amp;&amp; s.charAt(i-1) &lt;= &#39;6&#39; )){                dp[i] += dp[i-2];            }        }        return dp[s.length()];    }}</code></pre><h2 id="Solution-2-Recursive"><a href="#Solution-2-Recursive" class="headerlink" title="Solution 2: Recursive"></a>Solution 2: Recursive</h2><ul><li>æ¯æ¬¡éƒ½å¯ä»¥å¾€å‰èµ°ä¸¤æ­¥æˆ–è€…ä¸€æ­¥</li></ul><pre><code>class Solution {    HashMap&lt;Integer, Integer&gt; memo = new HashMap&lt;&gt;();    public int numDecodings(String s) {        if (s == null || s.length() == 0) {            return 0;        }        return helper(s, 0);    }    private int helper(String s, int pos) {        if (pos == s.length()) {            return 1;        }         if (s.charAt(pos) == &#39;0&#39;) {            return 0;        }        if (pos == s.length() - 1) {            return 1;        }        if (memo.containsKey(pos)) {            return memo.get(pos);        }        int ans = helper(s, pos + 1);        if (Integer.parseInt(s.substring(pos, pos+2)) &lt;= 26) {             ans += helper(s, pos + 2);        }        memo.put(pos, ans);        return ans;    }}</code></pre><h1 id="121-Best-Time-to-Buy-and-Sell-Stock"><a href="#121-Best-Time-to-Buy-and-Sell-Stock" class="headerlink" title="121. Best Time to Buy and Sell Stock"></a>121. Best Time to Buy and Sell Stock</h1><h2 id="Solution-1-Brute-Force"><a href="#Solution-1-Brute-Force" class="headerlink" title="Solution 1: Brute Force"></a>Solution 1: Brute Force</h2><pre><code>class Solution {    public int maxProfit(int[] prices) {        int result = 0;        for (int i = 0; i &lt; prices.length; i++) {            for (int j = i + 1; j &lt; prices.length; j++) {                result = Math.max(result, prices[j] - prices[i]);            }        }        return result;    }}</code></pre><h2 id="Solution-2-One-Pass"><a href="#Solution-2-One-Pass" class="headerlink" title="Solution 2: One Pass"></a>Solution 2: One Pass</h2><ul><li>è®°å½•å½“å‰çš„æœ€å°å€¼ï¼Œç¢°åˆ°æ¯”æœ€å°å€¼å¤§çš„å€¼ï¼Œå°±æ›´æ–°æœ€å¤§åˆ©æ¶¦</li></ul><pre><code>class Solution {    public int maxProfit(int prices[]) {        int minprice = Integer.MAX_VALUE;        int maxprofit = 0;        for (int i = 0; i &lt; prices.length; i++) {            if (prices[i] &lt; minprice)                minprice = prices[i];            else if (prices[i] - minprice &gt; maxprofit)                maxprofit = prices[i] - minprice;        }        return maxprofit;    }}</code></pre><h1 id="LC-139-Word-Break"><a href="#LC-139-Word-Break" class="headerlink" title="LC 139 Word Break"></a>LC 139 Word Break</h1><ul><li>å­—å…¸é‡Œçš„è¯å¯ä»¥é€‰ç”¨</li><li>å¯ä»¥é‡å¤ä½¿ç”¨</li><li>ç›®çš„æ˜¯éœ€è¦æ‹¼èµ·string</li><li>DFS æ·±åº¦ä¼˜å…ˆéå†</li></ul><h2 id="Solution-1-Brute-Force-1"><a href="#Solution-1-Brute-Force-1" class="headerlink" title="Solution 1 Brute Force"></a>Solution 1 Brute Force</h2><ul><li>Kind of DFS</li><li>Go through one way to the very bottom, and we need to go through all possible result if needed</li></ul><pre><code>class Solution {    public boolean wordBreak(String s, List&lt;String&gt; wordDict) {        if (s == null || s.length() == 0 || wordDict == null || wordDict.size() == 0) {            return false;        }        return subString(s, new HashSet(wordDict), 0);    }    private boolean subString(String testStr, Set&lt;String&gt; wordDict, int position) {        if (position == testStr.length()) {            return true;        }        // æ³¨æ„è¿™é‡Œçš„&lt;=  å› ä¸ºsubstringçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸åŒ…æ‹¬åœ¨ç¬¬äºŒä¸ªå‚æ•°é‡Œé¢çš„        for (int n = position + 1; n &lt;= testStr.length(); n ++) {            if (wordDict.contains(testStr.substring(position, n)) &amp;&amp; subString(testStr, wordDict, n)) {                return true;            }        }        return false;    }}</code></pre><h2 id="Solution-1-1-Brute-Force-with-array-record"><a href="#Solution-1-1-Brute-Force-with-array-record" class="headerlink" title="Solution 1.1 Brute Force with array record"></a>Solution 1.1 Brute Force with array record</h2><ul><li>è§£æ³•1 åŒ…å«å¤ªå¤šçš„é‡å¤ï¼Œé€šè¿‡è®°å½•åœ¨æŸä¸ªä½ç½®ä»¥åèƒ½ä¸èƒ½æˆåŠŸæ¥ä¿è¯ä¸ä¼šé‡å¤è¿è¡Œ</li></ul><pre><code>class Solution {    public boolean wordBreak(String s, List&lt;String&gt; wordDict) {        if (s == null || s.length() == 0 || wordDict == null || wordDict.size() == 0) {            return false;        }        return subString(s, new HashSet(wordDict), 0, new Boolean[s.length()]);    }    private boolean subString(String testStr, Set&lt;String&gt; wordDict, int position, Boolean[] memo) {        if (position == testStr.length()) {            return true;        }        if (memo[position] != null) {            return memo[position];        }        // æ³¨æ„è¿™é‡Œçš„&lt;=  å› ä¸ºsubstringçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸åŒ…æ‹¬åœ¨ç¬¬äºŒä¸ªå‚æ•°é‡Œé¢çš„        for (int n = position + 1; n &lt;= testStr.length(); n ++) {            if (wordDict.contains(testStr.substring(position, n)) &amp;&amp; subString(testStr, wordDict, n, memo)) {                return true;            }        }        memo[position] = false;        return false;    }}</code></pre><h2 id="Solution-2-Dynamic-Programming"><a href="#Solution-2-Dynamic-Programming" class="headerlink" title="Solution 2 Dynamic Programming"></a>Solution 2 Dynamic Programming</h2><pre><code>class Solution {    public boolean wordBreak(String s, List&lt;String&gt; wordDict) {        Set&lt;String&gt; wordDictSet = new HashSet(wordDict);        boolean[] dp = new boolean[s.length() + 1];        dp[0] = true;        for (int i = 1; i &lt;= s.length(); i ++) {            for (int j = 0; j &lt; i; j++) {                if (dp[j] &amp;&amp; wordDictSet.contains(s.substring(j, i))) {                    dp[i] = true;                    break;                }            }        }        return dp[s.length()];    }}</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://labuladong.gitbook.io/algo/dong-tai-gui-hua-xi-lie/1.1-dong-tai-gui-hua-ji-ben-ji-qiao/dong-tai-gui-hua-xiang-jie-jin-jie" target="_blank" rel="noopener">https://labuladong.gitbook.io/algo/dong-tai-gui-hua-xi-lie/1.1-dong-tai-gui-hua-ji-ben-ji-qiao/dong-tai-gui-hua-xiang-jie-jin-jie</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Instagram Design Scratch</title>
      <link href="/Instagram-Design-Scratch/"/>
      <url>/Instagram-Design-Scratch/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro-and-Instagram"><a href="#1-Intro-and-Instagram" class="headerlink" title="1. Intro and Instagram"></a>1. Intro and Instagram</h1><ul><li>social networking service </li><li>upload and share photos and videos </li><li>share info either publicly or privately </li><li>share through other social networking platforms <ul><li>facebook</li><li>twitter</li><li>flickr</li><li>tumblr</li></ul></li></ul><ul><li><p>requirement </p><ul><li><p>functional </p><ul><li>users should be able to upload/ download/ view photos </li><li>search based on photo/ video titles </li><li>users can follow other users </li><li>system will generate and display a userâ€™s News Feed consisting of top photos from all the people the user follows </li></ul></li><li><p>non-functional </p><ul><li>services need to be highly available </li><li>latency come to be 200ms for News Feed Generation </li></ul></li></ul></li></ul><h1 id="2-Design"><a href="#2-Design" class="headerlink" title="2. Design"></a>2. Design</h1><ul><li>patterns<ul><li>read heavy system <ul><li>need to effectively manage storage </li><li>100% reliable of data </li><li>low latency </li></ul></li></ul></li></ul><ul><li><p>system design </p><ul><li><p>we need to support two scenarios</p><ul><li>upload photos </li><li>view/ search photos</li></ul></li><li><p>db </p><ul><li>image storage </li><li>image metadata storage </li></ul></li></ul></li></ul><ul><li><p>Separate read and write servers </p><ul><li>web servers have a connection limit </li><li>assume max is 500 connections, that means server cannot have more than 500 concurrent uploads or reads </li></ul></li><li><p>reliability </p><ul><li>run a redundant secondary copy of the service that is not serving any traffic if only one instance of a service is required to run at any point </li></ul></li><li><p>data sharding </p><ul><li><p>partition based on UserID?</p><ul><li>hot user </li><li>non-uniform storage as some users may upload a lot of images </li><li>what if one shard is full? </li><li>unavailability â€“ all users data come to be unavailable all of sudden </li></ul></li><li><p>use photoId as partition key </p></li></ul></li><li><p>news feeds - e.g 100 feeds </p><ul><li><p>real time generation </p><ul><li>need to go to user follow table to get all of its following people </li><li>then query with user id to get their 100 updates </li><li>combine them, go through our ranking algo </li><li>then generate the output </li></ul></li><li><p>should choose pre-generating way as it will save a lot of times </p><ul><li>have dedicated servers that are continuously generating usersâ€™ News Feeds and storing them in a UserNewsFeed table</li></ul></li></ul></li><li><p>approaches for seanding news feed contents to users </p><ul><li><p>pull</p><ul><li><p>clients can pull the News Feed contents from the server on a regular basis or manually whenever they need it </p><ul><li><p>problems</p><ul><li>new data might not be shown to the users until clients issue a pull request </li><li>most of time, pull requests response could be empty </li></ul></li><li><p>push </p><ul><li>servers can push new data to the users as soon as it is available </li><li>users then need to maintain a long poll request with the server for receiving the updates </li><li>issue <ul><li>user has follow a lot of people </li><li>celebrity user who has meillions of followers </li><li>server then have to push updates quite frequently </li></ul></li></ul></li><li><p>hybrid </p><ul><li>move all the users who have a high number of follows to a pull based model and only push data to those users who have a few hundred follows </li></ul></li></ul></li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Designing Pastebin</title>
      <link href="/Designing-Pastebin/"/>
      <url>/Designing-Pastebin/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro-and-requirements"><a href="#1-Intro-and-requirements" class="headerlink" title="1. Intro and requirements"></a>1. Intro and requirements</h1><ul><li>Pastebin<ul><li>service enable users to store plain text or images over the network and generate unique urls to access the uploaded data </li></ul></li></ul><ul><li><p>requirements</p><ul><li><p>functional </p><ul><li>users could upload/ paste their data and get a unique URL to access it </li><li>users only able to upload text </li><li>data and links will expire after a specific timespan, user should be able to specify expeiration time </li><li>users should optionally be able to pick a custom alias for their paste </li></ul></li><li><p>non functional </p><ul><li>system should be highly reliable, no data loss any time </li><li>system should be highly available</li><li>small latency </li><li>paste links should not be guessable </li></ul></li></ul></li></ul><h1 id="2-thoughts"><a href="#2-thoughts" class="headerlink" title="2. thoughts"></a>2. thoughts</h1><ul><li><p>requirement clarification </p><ul><li>whatâ€™s the accept types of the file? </li><li>whatâ€™s the maximum size of the file? <ul><li>10MB</li></ul></li></ul></li><li><p>hardware requirement </p><ul><li>read write request number </li><li>average request size </li><li>storage size <ul><li>we probably donâ€™t want to use more than 70% of our total storage capacity at any point </li></ul></li><li>cache size </li></ul></li><li><p>how to achieve highly reliable, and highly available </p><ul><li>duplicate host </li></ul></li><li><p>how you want to store those file </p><ul><li>of course key value<ul><li>then question come to be whatâ€™s the overall number of key we need to store </li></ul></li></ul></li><li><p>high level design </p><ul><li>besides normal client, application server, and object storage </li><li>we could have another db to store metadata, like paste id, user </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Designing a URL Shortening service like TinyURL</title>
      <link href="/Designing-a-URL-Shortening-service-like-TinyURL/"/>
      <url>/Designing-a-URL-Shortening-service-like-TinyURL/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Thoughts"><a href="#1-Thoughts" class="headerlink" title="1. Thoughts"></a>1. Thoughts</h1><p>Based on System Design Guide, our thoughts could follow the framework described <a href="https://llchen60.com/System-Design-General-Guides-from-Grokking-SDI/" target="_blank" rel="noopener">here</a></p><p>Based on that: </p><ul><li><p>Requirement Clarification </p><ul><li>what feature we need<ul><li>create new tinyUrl </li><li>read existing tinyUrl, parse it to websites url </li></ul></li></ul></li><li><p>Envelope estimation </p><ul><li>what traffic amount it would be? Read/ Write Ratio? </li><li>Compute storage size we need</li><li>Network bandwidth usage </li></ul></li><li><p>System Interface Design </p><ul><li>generateNewTinyUrl<ul><li>original url </li><li>output parsed url </li></ul></li><li>parseTinyUrl()<ul><li>input tiny url </li><li>output - mapped original url </li></ul></li></ul></li><li><p>Data Model </p><ul><li>how data will flow between different components of the system </li></ul></li><li><p>High level design and detailed design </p></li><li><p>bottle neck resolving </p></li></ul><h1 id="2-Detail"><a href="#2-Detail" class="headerlink" title="2. Detail"></a>2. Detail</h1><h2 id="2-1-Requirements"><a href="#2-1-Requirements" class="headerlink" title="2.1 Requirements"></a>2.1 Requirements</h2><ul><li><p>Functional </p><ul><li>shorten given url </li><li>access a short url, user will be redirected to original link </li><li>users should optionally be able to pick a custom short link for their url </li><li>links will expire after a standard timespan, users should be able to specify the expiration time </li></ul></li><li><p>Non-Functional Requirements </p><ul><li>System should be highly available </li><li>Url redirection should happen in real time with minimal latency </li><li>Shortened links should not be guessable </li></ul></li><li><p>Extended Requirements</p><ul><li>analytics - how many times a redirection happen</li><li>should also be accessible through REST APIs by other services </li></ul></li></ul><h2 id="2-2-Capacity-Estimation-and-Constraints"><a href="#2-2-Capacity-Estimation-and-Constraints" class="headerlink" title="2.2 Capacity Estimation and Constraints"></a>2.2 Capacity Estimation and Constraints</h2><ul><li><p>read heavy system </p><ul><li>estimate read write ratio 100:1 </li></ul></li><li><p>traffic estimates </p><ul><li>suppose 500M new URL shortening request </li><li>then based on ratio, could be 50B read request </li><li>QPS<ul><li>for write <ul><li>500MM/ (30days * 24 hours * 3600 seconds) = ~ 200 URL/s</li></ul></li><li>for read <ul><li>200 * 100 = 20K/s</li></ul></li></ul></li></ul></li><li><p>storage estimate </p><ul><li>how long do we want to store them? <ul><li>whatâ€™s the total number of objects we want to store? <ul><li>suppose 5 years </li><li>500MM * 5 years * 12 months = 30 billion </li><li>suppose every object is about 500 bytes, then in total <ul><li>30B * 500 bytes = 15 TB</li></ul></li></ul></li></ul></li></ul></li><li><p>bandwidth estimate </p><ul><li><p>for write </p><ul><li>200 * 500 bytes/ s = ~100KB/s</li></ul></li><li><p>for read </p><ul><li>20K * 500 bytes = ~ 10MB/s </li></ul></li></ul></li><li><p>memory estimates </p><ul><li>we may want to cache some hot URLs that are frequently accessed, 20/ 80 rule </li><li>cache 20% hot URLs for a day </li><li>memory usage <ul><li>0.2 * 1.7 B * 500 bytes = ~170GB </li></ul></li></ul></li></ul><h2 id="2-3-System-APIs"><a href="#2-3-System-APIs" class="headerlink" title="2.3 System APIs"></a>2.3 System APIs</h2><ul><li><p>createURL (clientId, originalUrl, userName, customAlias, expireDate)</p><ul><li>clientId could be used for throttling based on allocated quota </li><li>return <ul><li>shortened url </li></ul></li></ul></li><li><p>deleteURL (clientId, urlKey)</p></li></ul><h2 id="2-4-DB-design"><a href="#2-4-DB-design" class="headerlink" title="2.4 DB design"></a>2.4 DB design</h2><ul><li>need two table, one store info for the URL mappings; one for the userâ€™s data about who created the short link </li></ul><h2 id="2-5-System-Design-and-Algorithm"><a href="#2-5-System-Design-and-Algorithm" class="headerlink" title="2.5 System Design and Algorithm"></a>2.5 System Design and Algorithm</h2><ul><li><p>How to generate a short and unique key for a given URL </p><ul><li><p>Encoding actual URL </p><ul><li>compute a unique hash of the given URL </li><li>hash could be encoded for display </li><li>If we use MD5 algorithm as our hash function, itâ€™ll produce a 128 bit hash value</li><li>After base64 encoding, weâ€™ll get a string having more than 21 characters<ul><li>take the first 8 letters for the key <ul><li>for duplication, choose some other characters out of the encoding string or swap some characters </li></ul></li></ul></li></ul></li><li><p>generate keys offline </p><ul><li>have a standalon key generation service that generates random six letter strings beforehand and stores them in a database</li><li>whenever we want to shorten a URL, we will take one of the already generated keys and use it </li></ul></li></ul></li></ul><h2 id="2-6-Deta-Partitioning-and-Replication"><a href="#2-6-Deta-Partitioning-and-Replication" class="headerlink" title="2.6 Deta Partitioning and Replication"></a>2.6 Deta Partitioning and Replication</h2><ul><li>Range based partitioning<ul><li>Store URLs in separate partitions based on the hash keyâ€™s first letter</li><li>could lead to unbalanced DB servers  </li></ul></li><li>Hash Based Partitioning <ul><li>use hash, and calculate which partition to use based on that </li></ul></li></ul><h2 id="2-7-Cache"><a href="#2-7-Cache" class="headerlink" title="2.7 Cache"></a>2.7 Cache</h2><ul><li><p>could use memcache or other similar in memory cache solution </p></li><li><p>how muach cache memory should we have?</p><ul><li>20% of daily traffic </li></ul></li><li><p>what cache eviction policy should we use?</p><ul><li>LRU </li></ul></li></ul><h2 id="2-8-Load-Balancer"><a href="#2-8-Load-Balancer" class="headerlink" title="2.8 Load Balancer"></a>2.8 Load Balancer</h2><ul><li>We could choose to add LB at: <ul><li>between clients and application servers</li><li>between application servers and database servers</li><li>between apllication servers and cache servers </li></ul></li></ul><h2 id="2-9-Purging-DB-cleanup"><a href="#2-9-Purging-DB-cleanup" class="headerlink" title="2.9 Purging / DB cleanup"></a>2.9 Purging / DB cleanup</h2><ul><li>We should not actively search for expired links to remove them, as it would put a lot of pressure on our db <ul><li>slowlyremove and do a lazy cleanup</li></ul></li></ul><h2 id="2-10-Metrics-and-Security"><a href="#2-10-Metrics-and-Security" class="headerlink" title="2.10 Metrics and Security"></a>2.10 Metrics and Security</h2><ul><li><p>Record metrics </p><ul><li>country of visitor</li><li>data and time </li><li>web page that referred the click </li><li>browser </li><li>platform</li><li>etc. </li></ul></li><li><p>security and permissions </p><ul><li>store the permission level with each URL in the database </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>LC - Tree</title>
      <link href="/LC-Tree/"/>
      <url>/LC-Tree/</url>
      
        <content type="html"><![CDATA[<h1 id="Lc-98-Validate-Binary-Search-Tree"><a href="#Lc-98-Validate-Binary-Search-Tree" class="headerlink" title="Lc 98. Validate Binary Search Tree"></a>Lc 98. Validate Binary Search Tree</h1><h2 id="Solution-1-Recursion"><a href="#Solution-1-Recursion" class="headerlink" title="Solution 1: Recursion"></a>Solution 1: Recursion</h2><pre><code>class Solution {    public boolean isValidBST(TreeNode root) {        return isValidSubTree(root, null, null);    }    boolean isValidSubTree(TreeNode node, Integer lower, Integer upper) {        if (node == null) {            return true;        }        int val = node.val;        if (lower != null &amp;&amp; val &lt;= lower) return false;        if (upper != null &amp;&amp; val &gt;= upper) return false;        if (!isValidSubTree(node.right, val, upper)) return false;        if (!isValidSubTree(node.left, lower, val)) return false;        return true;    }}</code></pre><h2 id="Solution-2-Inorder-Traversal"><a href="#Solution-2-Inorder-Traversal" class="headerlink" title="Solution 2: Inorder Traversal"></a>Solution 2: Inorder Traversal</h2><ul><li>è¿™æ ·éå†å‰ä¸€ä¸ªæ¯”åä¸€ä¸ªå°æ‰æ˜¯BST</li></ul><pre><code>class Solution {  public boolean isValidBST(TreeNode root) {    Stack&lt;TreeNode&gt; stack = new Stack();    double inorder = - Double.MAX_VALUE;    while (!stack.isEmpty() || root != null) {      while (root != null) {        stack.push(root);        root = root.left;      }      root = stack.pop();      // If next element in inorder traversal      // is smaller than the previous one      // that&#39;s not BST.      if (root.val &lt;= inorder) return false;      inorder = root.val;      root = root.right;    }    return true;  }}</code></pre><h1 id="LC-105-Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal"><a href="#LC-105-Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal" class="headerlink" title="LC 105. Construct Binary Tree from Preorder and Inorder Traversal"></a>LC 105. Construct Binary Tree from Preorder and Inorder Traversal</h1><ul><li>å‰åºéå†  æ ¹èŠ‚ç‚¹ï¼Œå·¦å­èŠ‚ç‚¹ï¼Œå³å­èŠ‚ç‚¹</li><li>ä¸­åºéå†  å·¦å­èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹ï¼Œå³å­èŠ‚ç‚¹</li><li>æ²¡æœ‰é‡å¤æ•°å­—</li><li>å‰åºéå†çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå…¶åœ¨ä¸­åºéå†å½“ä¸­å‡ºç°çš„ä½ç½®ï¼Œå…¶ä¹‹å‰æ˜¯å·¦å­æ ‘ï¼Œå…¶ä¹‹åæ˜¯å³å­æ ‘ï¼Œå¯ä»¥ç”¨è¿™ä¸ªé€»è¾‘æ¥é€’å½’è¿›è¡Œåˆ¤æ–­</li></ul><h1 id="LC-226-Invert-Binary-Tree"><a href="#LC-226-Invert-Binary-Tree" class="headerlink" title="LC 226. Invert Binary Tree"></a>LC 226. Invert Binary Tree</h1><h2 id="Solution-1-Recursion-1"><a href="#Solution-1-Recursion-1" class="headerlink" title="Solution 1: Recursion"></a>Solution 1: Recursion</h2><ul><li>é€»è¾‘æ˜¯æ¯ä¸ªæ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘æ˜¯å…¶å³å­æ ‘çš„ç¿»è½¬ï¼Œå³å±‚å±‚éƒ½ç¿»è½¬è¿‡äº†  ç”¨é€’å½’å®Œæˆè¿™ä¸ªé€»è¾‘å°±å¥½</li></ul><pre><code>class Solution {    public TreeNode invertTree(TreeNode root) {        if (root == null) {            return null;        }        TreeNode right = invertTree(root.right);        TreeNode left = invertTree(root.left);        root.left = right;        root.right = left;        return root;    }}</code></pre><h2 id="Solution-2-Iteration"><a href="#Solution-2-Iteration" class="headerlink" title="Solution 2: Iteration"></a>Solution 2: Iteration</h2><pre><code>class Solution {    public TreeNode invertTree(TreeNode root) {        if (root == null) return null;        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;TreeNode&gt;();        queue.add(root);        while (!queue.isEmpty()) {            TreeNode current = queue.poll();            TreeNode temp = current.left;            current.left = current.right;            current.right = temp;            if (current.left != null) queue.add(current.left);            if (current.right != null) queue.add(current.right);        }        return root;    }}</code></pre><h2 id="Solution-2-Iterative"><a href="#Solution-2-Iterative" class="headerlink" title="Solution 2: Iterative"></a>Solution 2: Iterative</h2><h1 id="LC-543-Diameter-of-Binary-Tree"><a href="#LC-543-Diameter-of-Binary-Tree" class="headerlink" title="LC 543. Diameter of Binary Tree"></a>LC 543. Diameter of Binary Tree</h1><ul><li><p>Diameter â€“ length of the longest path between any two nodes in a tre </p></li><li><p>Binary Tree </p><pre><code>public class Solution {  int max = 0;  public int diameterOfBinaryTree(TreeNode root) {      maxDepth(root);      return max;  }  private int maxDepth(TreeNode root) {      if (root == null) return 0;      int left = maxDepth(root.left);      int right = maxDepth(root.right);      max = Math.max(max, left + right);      return Math.max(left, right) + 1;  }}</code></pre></li></ul><h1 id="LC-938-Range-Sum-of-BST"><a href="#LC-938-Range-Sum-of-BST" class="headerlink" title="LC 938. Range Sum of BST"></a>LC 938. Range Sum of BST</h1><ul><li><p>äºŒå‰æŸ¥æ‰¾æ ‘</p><ul><li>å·¦å­æ ‘çš„å€¼ä¼šå°äºæ ¹èŠ‚ç‚¹çš„å€¼</li><li>å³å­æ ‘çš„å€¼éƒ½å¤§äºæ ¹èŠ‚ç‚¹çš„å€¼</li></ul></li><li><p>äºŒå‰æŸ¥æ‰¾æ ‘å½“ä¸­æ‰¾åŒºé—´ï¼Œä¸€å®šæ˜¯éœ€è¦ç”¨åˆ°äºŒå‰æŸ¥æ‰¾æ ‘æœ¬èº«çš„æ€§è´¨çš„</p></li></ul><h2 id="Solution-1-Brute-Force"><a href="#Solution-1-Brute-Force" class="headerlink" title="Solution 1: Brute Force"></a>Solution 1: Brute Force</h2><ul><li>éå†æ•´ä¸ªæ ‘ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå¯¹å…¶è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥å€¼åœ¨åŒºé—´å†…ï¼Œåˆ™ç´¯åŠ åˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸Š</li></ul><pre><code>class Solution {    int sum = 0;    public int rangeSumBST(TreeNode root, int L, int R) {        addToSum(root, L, R);        return sum;    }    void addToSum(TreeNode node, int L, int R) {        if (node == null) return;        if (node.val &gt;= L &amp;&amp; node.val &lt;= R) {            sum += node.val;        }        addToSum(node.left, L, R);        addToSum(node.right, L, R);    }}</code></pre><h2 id="Solution-2-Leverage-on-BST"><a href="#Solution-2-Leverage-on-BST" class="headerlink" title="Solution 2: Leverage on BST"></a>Solution 2: Leverage on BST</h2><ul><li><p>é€»è¾‘æ˜¯å¦‚æœnode.val &lt; L, é‚£ä¹ˆåªæœ‰å³å­æ ‘æ˜¯æœ‰å¯èƒ½è·å–åœ¨åŒºé—´å†…çš„å€¼çš„</p><pre><code>class Solution {  int ans;  public int rangeSumBST(TreeNode root, int L, int R) {      ans = 0;      dfs(root, L, R);      return ans;  }  public void dfs(TreeNode node, int L, int R) {      if (node != null) {          if (L &lt;= node.val &amp;&amp; node.val &lt;= R)              ans += node.val;          if (L &lt; node.val)              dfs(node.left, L, R);          if (node.val &lt; R)              dfs(node.right, L, R);      }  }}</code></pre></li><li><p>Q: L13 â€“ L16, ä¸ºä»€ä¹ˆä¸èƒ½å†™æˆ</p><ul><li><code>node.val &gt; R</code></li><li><code>node.val &lt; L</code></li></ul></li><li><p>å› ä¸ºå…¶å®ç¬¬10è¡Œçš„ifåˆ¤æ–­åªæ˜¯ä¸ºäº†åŠ è¿›å»ansï¼Œæ²¡æœ‰åšå…¶ä»–çš„é€»è¾‘è¿ç®—çš„</p></li></ul><h1 id="LC-199-Binary-Tree-Right-Side-View"><a href="#LC-199-Binary-Tree-Right-Side-View" class="headerlink" title="LC 199: Binary Tree Right Side View"></a>LC 199: Binary Tree Right Side View</h1><ul><li>å¯¹æ ‘çš„åˆ†å±‚æ“ä½œ<ul><li>ä½¿ç”¨BFSç®—æ³•</li></ul></li></ul><h2 id="Solution-1-ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—"><a href="#Solution-1-ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—" class="headerlink" title="Solution 1: ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—"></a>Solution 1: ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—</h2><ul><li>ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªä¸ºå½“å‰å±‚ï¼Œä¸€ä¸ªä¸ºä¸‹ä¸€å±‚</li></ul><pre><code>class Solution {    public List&lt;Integer&gt; rightSideView(TreeNode root) {        if (root == null) {            return new ArrayList&lt;&gt;();        }        ArrayDeque&lt;TreeNode&gt; currentQueue = new ArrayDeque&lt;&gt;();        ArrayDeque&lt;TreeNode&gt; nextQueue = new ArrayDeque&lt;&gt;();        nextQueue.add(root);        List&lt;Integer&gt; result = new ArrayList&lt;&gt;();        TreeNode node = null;        while(!nextQueue.isEmpty()) {            currentQueue = nextQueue.clone();            nextQueue.clear();            while (!currentQueue.isEmpty()) {                node = currentQueue.poll();                if (node.left != null) {                    nextQueue.add(node.left);                }                if (node.right != null) {                    nextQueue.add(node.right);                }            }            if (currentQueue.isEmpty()) {                result.add(node.val);            }        }        return result;    }}</code></pre><h2 id="Solution-2-ä¸€ä¸ªé˜Ÿåˆ—-Sentinel"><a href="#Solution-2-ä¸€ä¸ªé˜Ÿåˆ—-Sentinel" class="headerlink" title="Solution 2: ä¸€ä¸ªé˜Ÿåˆ— + Sentinel"></a>Solution 2: ä¸€ä¸ªé˜Ÿåˆ— + Sentinel</h2><ul><li>ä½¿ç”¨nullä½œä¸ºå«å…µèŠ‚ç‚¹æ¥åŒºåˆ†ä¸åŒå±‚</li></ul><pre><code>class Solution {    public List&lt;Integer&gt; rightSideView(TreeNode root) {        if (root == null) {            return new ArrayList&lt;&gt;();        }        Queue&lt;TreeNode&gt; queue = new LinkedList() {            {offer(root);            offer(null);}        };        TreeNode prev, cur = root;        List&lt;Integer&gt; result = new ArrayList();        while (!queue.isEmpty()) {            prev = cur;            cur = queue.poll();            while(cur != null) {                if (cur.left != null) {                    queue.offer(cur.left);                }                if (cur.right != null) {                    queue.offer(cur.right);                }                prev = cur;                cur = queue.poll();            }            result.add(prev.val);            if (!queue.isEmpty()) queue.offer(null);        }        return result;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC - Linked List</title>
      <link href="/LC-Linked-List/"/>
      <url>/LC-Linked-List/</url>
      
        <content type="html"><![CDATA[<h1 id="LC-23-Merge-K-Sorted-Lists"><a href="#LC-23-Merge-K-Sorted-Lists" class="headerlink" title="LC-23 Merge K Sorted Lists"></a>LC-23 Merge K Sorted Lists</h1><ul><li>ç»™å®škä¸ªé“¾è¡¨ï¼Œæ¯ä¸ªé“¾è¡¨éƒ½æŒ‰ç…§å‡åºæ’åˆ—ï¼Œåˆå¹¶é“¾è¡¨ä½¿å¾—æœ€ç»ˆçš„é“¾è¡¨ä¹ŸæŒ‰ç…§å‡åºæ’åˆ—</li><li>æœ€ç›´è§‚çš„æƒ³æ³•</li><li>ä»¥ä¸€ä¸ªé“¾è¡¨ä¸ºåŸºå‡†ï¼Œæ‹¿å‡ºä¸€ä¸ªé“¾è¡¨æ¥åšæ¯”è¾ƒï¼Œå„ä¿ç•™ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åæ¥åšåˆå¹¶æ“ä½œ</li></ul><h2 id="Solution1-Brute-Force"><a href="#Solution1-Brute-Force" class="headerlink" title="Solution1: Brute Force"></a>Solution1: Brute Force</h2><ul><li><p>éƒ½æ”¾åˆ°ä¸€ä¸ªarraylistå½“ä¸­</p></li><li><p>ä½¿ç”¨Collectionçš„æ’åºç®—æ³•ï¼Œå¯¹å…¶è¿›è¡Œæ’åº</p></li><li><p>ç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ï¼Œæ¥è¿”å›ç»“æœ</p><pre><code>class Solution {  public ListNode mergeKLists(ListNode[] lists) {      if (lists == null || lists.length == 0) {          return null;      }      List&lt;Integer&gt; list = new ArrayList();      for (ListNode ln : lists) {          while (ln != null) {              list.add(ln.val);              ln = ln.next;          }      }      Collections.sort(list);      ListNode dummy = new ListNode(0);      ListNode result = dummy;      for (int i = 0; i &lt; list.size(); i++) {          result.next = new ListNode(list.get(i));          result = result.next;      }      return dummy.next;  }}</code></pre></li></ul><h2 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution 2"></a>Solution 2</h2><ul><li>æ¯”è¾ƒæ¯ä¸ªé“¾è¡¨å¤´ï¼Œå°†æœ€å°çš„æ”¾åˆ°resultä¸­ï¼Œä¸€ä¸ªä¸€ä¸ªè¿™æ ·æ¯”è¾ƒï¼Œç›¸å½“äºåªéå†äº†ä»¥ä¾¿å°±ç”Ÿæˆäº†ç»“æœ</li><li>æ³¨æ„ç»ˆæ­¢å¾ªç¯çš„åˆ¤æ–­ï¼Œåº”è¯¥æ˜¯å‡ ä¸ªé“¾è¡¨éƒ½åˆ°å¤´äº†æ‰é€€å‡º</li></ul><pre><code>class Solution {    public ListNode mergeKLists(ListNode[] lists) {        if (lists == null || lists.length == 0) {            return null;        }        ListNode result = new ListNode(0);        ListNode head = result;        while (true) {            int min = Integer.MAX_VALUE;            int min_index = -1;            boolean shouldBreak = true;            for (int i = 0; i &lt; lists.length; i++) {                if (lists[i] != null &amp;&amp; lists[i].val &lt; min) {                    min = lists[i].val;                    min_index = i;                    shouldBreak = false;                }            }            if (shouldBreak) break;            // get one value min             head.next = lists[min_index];            head = head.next;            lists[min_index] = lists[min_index].next;        }        return result.next;    }}</code></pre><h2 id="Solution-3-ä½¿ç”¨Priority-Queue"><a href="#Solution-3-ä½¿ç”¨Priority-Queue" class="headerlink" title="Solution 3: ä½¿ç”¨Priority Queue"></a>Solution 3: ä½¿ç”¨Priority Queue</h2><pre><code>public ListNode mergeKLists(ListNode[] lists) {         PriorityQueue q = new PriorityQueue&lt;&gt;((o1, o2) -&gt; o1.val - o2.val);        for(ListNode l : lists){            if(l!=null){                // è¿™é‡ŒåŠ è¿›å»çš„ä¸æ˜¯value è€Œæ˜¯å‡ ä¸ªListNode                q.add(l);            }                }        ListNode head = new ListNode(0);        ListNode point = head;        while(!q.isEmpty()){             point.next = q.poll();            point = point.next;             ListNode next = point.next;            if(next!=null){                // é¡ºæ¬¡ä¸‹ç§»ä»¥åæ¯”è¾ƒä¸‹ä¸€ä¸ªèŠ‚ç‚¹                q.add(next);            }        }        return head.next;    }</code></pre><h1 id="LC-24-Swap-Nodes-in-Pairs"><a href="#LC-24-Swap-Nodes-in-Pairs" class="headerlink" title="LC-24 Swap Nodes in Pairs"></a>LC-24 Swap Nodes in Pairs</h1><ul><li><p>äº¤æ¢ç›¸é‚»èŠ‚ç‚¹</p></li><li><p>ä¸´ç•Œæ¡ä»¶</p><ul><li>å•ä¸ªèŠ‚ç‚¹</li><li>æ²¡æœ‰èŠ‚ç‚¹</li></ul></li><li><p>å› ä¸ºä¼šæ¶‰åŠåˆ°é¦–èŠ‚ç‚¹çš„æ›¿æ¢å˜åŠ¨ï¼Œæ‰€ä»¥ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ª dummy nodeï¼Œä½¿å¾—<code>dummy.next = head</code></p></li><li><p>ç”»ä¸€ä¸ªåŸºæœ¬çš„swapç¤ºæ„å›¾å¯ä»¥å‘ç°æ•´ä¸ªæ›¿æ¢ä¼šæ¶‰åŠå››ä¸ªèŠ‚ç‚¹</p><ul><li>é¦–èŠ‚ç‚¹çš„ä¸Šä¸ªèŠ‚ç‚¹åŸå…ˆæŒ‡å‘é¦–èŠ‚ç‚¹çš„æŒ‡é’ˆ</li><li>é¦–èŠ‚ç‚¹æœ¬èº«</li><li>æ¬¡èŠ‚ç‚¹æœ¬èº«</li><li>æ¬¡èŠ‚ç‚¹åŸå…ˆæŒ‡å‘æ¬¡èŠ‚ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ</li></ul></li><li><p>å› ä¸ºæ˜¯å•å‘é“¾è¡¨ï¼Œæˆ‘ä»¬æ²¡æ³•ç”¨prevæŒ‡é’ˆæ¥æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥éœ€è¦åœ¨è¿‡ç¨‹ä¸­åšå¥½prevçš„è®°å½•ï¼Œè€Œå¯¹äºæ¬¡èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®Œå…¨å¯ä»¥ç”¨nextæŒ‡é’ˆæ¥è¡¨ç¤º</p></li><li><p>å¦å¤–è¦æ³¨æ„åšswapçš„æ—¶å€™çš„é¡ºåºé—®é¢˜</p></li></ul><pre><code>// Iterationçš„ç‰ˆæœ¬class Solution {    public ListNode swapPairs(ListNode head) {        ListNode dummy = new ListNode(0);        dummy.next = head;        ListNode prev = dummy;        while (head != null &amp;&amp; head.next != null) {            ListNode cur = head;            ListNode next = head.next;            // Swapping             prev.next = next;            cur.next = next.next;            next.next = cur;            prev = cur;            head = cur.next;        }        return dummy.next;    }}</code></pre><h1 id="92-Reverse-Linked-List-II"><a href="#92-Reverse-Linked-List-II" class="headerlink" title="92. Reverse Linked List II"></a>92. Reverse Linked List II</h1><ul><li>reverse a linked list from position m to n </li></ul><pre><code>/** * Definition for singly-linked list. * public class ListNode { *     int val; *     ListNode next; *     ListNode() {} *     ListNode(int val) { this.val = val; } *     ListNode(int val, ListNode next) { this.val = val; this.next = next; } * } */class Solution {    public ListNode reverseBetween(ListNode head, int m, int n) {        // how to reverse a         ListNode prev = null;        ListNode cur = head;        while (m &gt; 1) {            prev = cur;            cur = cur.next;            m --;            n --;        }        ListNode next;        // at this point, current prev is the final front we need to keep record        ListNode toConnectStart = prev;        ListNode toConnextEnd = cur;        while (n &gt; 0) {            next = cur.next;            cur.next = prev;            prev = cur;            cur = cur.next;            n --;        }        if (toConnectStart != null) {            toConnectStart.next = prev;        } else {            head = prev;        }        toConnextEnd.next = cur;        return head;    }}</code></pre><h1 id="LC-146-LRU-Cache"><a href="#LC-146-LRU-Cache" class="headerlink" title="LC-146 LRU Cache"></a>LC-146 LRU Cache</h1><ul><li>ä¸ºäº†å®ç°O(1)çš„get putè¯·æ±‚ï¼Œéœ€è¦ä½¿ç”¨åŒå‘é“¾è¡¨ + HashMap</li><li>Hashmapæ¥è·Ÿè¸ªåœ¨åŒå‘é“¾è¡¨å½“ä¸­çš„key å’Œvalue</li></ul><pre><code>class LRUCache {    private Map&lt;Integer, LinkedNode&gt; cache = new HashMap&lt;&gt;();    private LinkedNode head, tail;    private int size;    private int capacity;    class LinkedNode {        int key;        int value;        LinkedNode prev;        LinkedNode next;    }    // addNode right after the head    private void addNode (LinkedNode node) {        node.prev = head;        node.next = head.next;        head.next.prev = node;        head.next = node;    }    private void moveToHead(LinkedNode node) {        removeNode(node);        addNode(node);    }    private void removeNode(LinkedNode node) {        LinkedNode prev = node.prev;        LinkedNode next = node.next;        prev.next = next;        next.prev = prev;    }    public LRUCache(int capacity) {        this.size = 0;        this.capacity = capacity;        head = new LinkedNode();        tail = new LinkedNode();        head.next = tail;        tail.prev = head;    }    private LinkedNode popTail() {        /**         * Pop the current tail.         */        LinkedNode res = tail.prev;        removeNode(res);        return res;    }    public int get(int key) {        LinkedNode node = cache.get(key);        if (node == null) return -1;        moveToHead(node);        return node.value;    }    public void put(int key, int value) {        LinkedNode node = cache.get(key);        if (node == null) {            LinkedNode newNode = new LinkedNode();            newNode.key = key;            newNode.value = value;            cache.put(key, newNode);            addNode(newNode);            ++size;          if(size &gt; capacity) {            // pop the tail            LinkedNode tail = popTail();            cache.remove(tail.key);            --size;          }        }  else {            // update the value.            node.value = value;            moveToHead(node);        }      }}/** * Your LRUCache object will be instantiated and called as such: * LRUCache obj = new LRUCache(capacity); * int param_1 = obj.get(key); * obj.put(key,value); */</code></pre><h1 id="LC-234-Palindrome-Linked-List"><a href="#LC-234-Palindrome-Linked-List" class="headerlink" title="LC-234 Palindrome Linked List"></a>LC-234 Palindrome Linked List</h1><h2 id="Solution-1-é€’å½’"><a href="#Solution-1-é€’å½’" class="headerlink" title="Solution 1: é€’å½’"></a>Solution 1: é€’å½’</h2><ul><li><p>åå‘è¾“å‡ºé“¾è¡¨çš„é€’å½’é€»è¾‘</p><pre><code>function print_values_in_reverse(ListNode head)  if head is NOT null      print_values_in_reverse(head.next)      print head.val</code></pre></li><li><p>é¢˜è§£</p></li></ul><pre><code>class Solution {    private ListNode front;    private boolean recursiveCheck(ListNode cur) {        if (cur != null) {            if (!recursiveCheck(cur.next)) return false;            if (cur.val != front.val) return false;            front = front.next;        }        return true;    }    public boolean isPalindrome(ListNode head) {        front = head;        return recursiveCheck(head);    }}</code></pre><h2 id="Solution-2-åå‘ååŠé“¾è¡¨æ¥åšæ¯”è¾ƒ"><a href="#Solution-2-åå‘ååŠé“¾è¡¨æ¥åšæ¯”è¾ƒ" class="headerlink" title="Solution 2: åå‘ååŠé“¾è¡¨æ¥åšæ¯”è¾ƒ"></a>Solution 2: åå‘ååŠé“¾è¡¨æ¥åšæ¯”è¾ƒ</h2><pre><code>class Solution {    public boolean isPalindrome(ListNode head) {        if (head == null) return true;        // Find the end of first half and reverse second half.        ListNode firstHalfEnd = endOfFirstHalf(head);        ListNode secondHalfStart = reverseList(firstHalfEnd.next);        // Check whether or not there is a palindrome.        ListNode p1 = head;        ListNode p2 = secondHalfStart;        boolean result = true;        while (result &amp;&amp; p2 != null) {            if (p1.val != p2.val) result = false;            p1 = p1.next;            p2 = p2.next;        }                // Restore the list and return the result.        firstHalfEnd.next = reverseList(secondHalfStart);        return result;    }    // Taken from https://leetcode.com/problems/reverse-linked-list/solution/    private ListNode reverseList(ListNode head) {        ListNode prev = null;        ListNode curr = head;        while (curr != null) {            ListNode nextTemp = curr.next;            curr.next = prev;            prev = curr;            curr = nextTemp;        }        return prev;    }    private ListNode endOfFirstHalf(ListNode head) {        ListNode fast = head;        ListNode slow = head;        while (fast.next != null &amp;&amp; fast.next.next != null) {            fast = fast.next.next;            slow = slow.next;        }        return slow;    }}</code></pre><h1 id="LC-1474-Delete-N-nodes-after-M-nodes-of-a-linked-list"><a href="#LC-1474-Delete-N-nodes-after-M-nodes-of-a-linked-list" class="headerlink" title="LC-1474 Delete N nodes after M nodes of a linked list"></a>LC-1474 Delete N nodes after M nodes of a linked list</h1><ul><li><p>é“¾è¡¨çƒ­èº«é¢˜</p></li><li><p>æ³¨æ„è¾¹ç•Œæ¡ä»¶çš„åˆ¤å®šï¼Œé¢˜ä¸­å·²ç»™må’Œnçš„é™å®šèŒƒå›´ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢å¤–åšåˆ¤æ–­äº†</p></li><li><p>å¯¹äºnçš„å‘¨æœŸæ€§å»é™¤çš„nodeï¼Œæ³¨æ„å¯ä»¥ä¸ç”¨é¢å¤–ç©ºé—´ï¼Œé€šè¿‡æ”¹å˜æŒ‡é’ˆçš„æŒ‡å‘å³å¯</p><pre><code>class Solution {  public ListNode deleteNodes(ListNode head, int m, int n) {      ListNode cur = head;      ListNode last = head;      while (cur != null) {          int mCount = m;          int nCount = n;          while (cur != null &amp;&amp; mCount &gt; 0 ) {              last = cur;              cur = cur.next;              mCount --;          }          while (cur != null &amp;&amp; nCount &gt; 0) {              cur = cur.next;              nCount --;          }          last.next = cur;      }      return head;  }}</code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LinkedList </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>System Design Basics</title>
      <link href="/System-Design-Basics/"/>
      <url>/System-Design-Basics/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Key-Characteristics-of-Distributed-Systems"><a href="#1-Key-Characteristics-of-Distributed-Systems" class="headerlink" title="1. Key Characteristics of Distributed Systems"></a>1. Key Characteristics of Distributed Systems</h1><h2 id="1-1-Scalability"><a href="#1-1-Scalability" class="headerlink" title="1.1 Scalability"></a>1.1 Scalability</h2><ul><li><p>Capability of a system, process, or a network to grow and manage increased demand. Achieve the scaling without performance loss </p></li><li><p>Why need to scale?</p><ul><li>Increased data volume </li><li>Increased amount of work <ul><li>number of transactions </li></ul></li></ul></li><li><p>Performance curve </p><ul><li>Usually performance of a system would decline with the system size due to the management or environment cost <ul><li>network speed come to be slower because machines tend to be far apart from one another </li><li>some tasks may not be distributed, either because of their inherent atomic nature or because of some flaw in the system design </li></ul></li></ul></li></ul><ul><li><p>Horizontal vs Vertical Scaling </p><ul><li><p>Horizontal Scaling </p><ul><li>Scale by adding more servers into your pool of resources </li><li>Easier to scale dynamically by adding more machines into the existing pool </li></ul></li><li><p>Vertical scaling </p><ul><li><p>Scale by adding more power to an existing server </p><ul><li>CPU</li><li>RAM</li><li>Storage </li></ul></li><li><p>limited to the capacity of a single server, and scaling beyond that capacity often <strong>involves downtime</strong> and comes with an upper limit </p></li></ul></li></ul></li></ul><h2 id="1-2-Reliability"><a href="#1-2-Reliability" class="headerlink" title="1.2 Reliability"></a>1.2 Reliability</h2><ul><li>Probability a system will fail in a given period</li><li>A distributed system is considered reliable if it keeps delivering its services even when one or more software or hardware components fail </li><li>A reliable distributed system achieves this through redundancy of both the software components and data <ul><li>Eliminate every single point of failure</li></ul></li></ul><h2 id="1-3-Availability"><a href="#1-3-Availability" class="headerlink" title="1.3 Availability"></a>1.3 Availability</h2><ul><li>The time a system remains operational to perform its required function in s specific period </li><li>Percentage of time that a system, service, or a machine remains operational under normal conditions </li><li>Reliability  is availability over time considering the full range of possible real world conditions that can occur</li><li>If a system is reliable, it is available. However, if it is available, it is not necessarily reliable. In other words, high reliability contributes to high availability, but it is possible to achieve a high availability even with an unreliable product by minimizing repair time and ensuring that spares are always available when they are needed</li></ul><h2 id="1-4-Efficiency"><a href="#1-4-Efficiency" class="headerlink" title="1.4 Efficiency"></a>1.4 Efficiency</h2><ul><li><p>Standard measures of its efficiency </p><ul><li><p>Response time/ latency </p><ul><li>denotes the delay to obtain the first item </li></ul></li><li><p>Throughput / bandwidth</p><ul><li>number of items delivered in a given time unit </li></ul></li></ul></li><li><p>two measures above correspond to the following unit costs </p><ul><li>number of messages globally sent by the nodes of the system regardless of the message size </li><li>size of messages representing the volume of data exchanges </li></ul></li></ul><h2 id="1-5-Serviceability-Manageability"><a href="#1-5-Serviceability-Manageability" class="headerlink" title="1.5 Serviceability / Manageability"></a>1.5 Serviceability / Manageability</h2><ul><li>How easy it is to operate and maintain </li><li>Simplicity and speed with which a system can be repared or maintained </li><li>Ease of diagnosing and understanding problems when they occur, ease of making updates or modifications, </li></ul><h1 id="2-Load-Balancing"><a href="#2-Load-Balancing" class="headerlink" title="2. Load Balancing"></a>2. Load Balancing</h1><h2 id="2-1-What-is-Load-Balancer"><a href="#2-1-What-is-Load-Balancer" class="headerlink" title="2.1 What is Load Balancer?"></a>2.1 What is Load Balancer?</h2><ul><li><p>A critical component of any distributed system</p><ul><li><p>help to spread the traffic across a cluster of servers to improve responsiveness and availability of applications/ websites/ databases </p></li><li><p>also keep track of the status of all the resources while distributing requests </p><ul><li>if one server is not available to take new requests, not responding, has elevated error rate </li><li>LB will stop sending traffic to such server </li></ul></li><li><p>sit between client and the server accepting incoming network and application traffic, distribute traffic across multiple backend servers using various algorithm</p></li><li><p>could prevents any one application server from becoming a single point of failure </p></li></ul></li><li><p>where to add LB?</p><ul><li>between the user and the web server </li><li>between web servers and an internal platform layer, like application servers or cache servers </li><li>between internal platform layer and database <h2 id="2-2-Benefits"><a href="#2-2-Benefits" class="headerlink" title="2.2 Benefits"></a>2.2 Benefits</h2></li></ul></li><li><p>from user side </p><ul><li>faster, uninterrupted service; their requests could be immediately passed on to a more readily available resource </li></ul></li><li><p>from service provider side </p><ul><li>experience less downtime and higher throughput </li></ul></li><li><p>long term benefits</p><ul><li>smart load balancers provide benefits like predictive analytics that determine traffic bottlenecks before they happen </li></ul></li></ul><h2 id="2-3-Load-Balancing-Algorithms"><a href="#2-3-Load-Balancing-Algorithms" class="headerlink" title="2.3 Load Balancing Algorithms"></a>2.3 Load Balancing Algorithms</h2><ul><li><p>How does the load balancer choose the backend server?</p><ul><li><ol><li>Make sure servers could respond appropriately to requests <ul><li>routinely do health check <ul><li>regularly attempt to connect to backend servers to ensure that servers are listening </li></ul></li></ul></li></ol></li><li><ol start="2"><li><p>Use pre configured algorithm to select one from the set of healthy servers </p><ul><li><p>Least connection Method </p><ul><li>direct traffic to the server with fewest active connections </li><li>useful when there are a large number of persistent client connections which are unevenly distributed between the servers</li></ul></li><li><p>Least Response Time Method </p><ul><li>direct traffic to the server with the fewest active connections and the lowest average response time </li></ul></li><li><p>Least Bandwidth Method </p><ul><li>selects the server that is currently serving the least amount of traffic measured in megabits per second (Mbps)</li></ul></li><li><p>Round Robin Method </p><ul><li>cycles through a list of servers and sends each new request to the next server </li><li>most useful when the servers are of equal specification and there are not many persistent connections</li></ul></li><li><p>weighted round robin </p><ul><li>desifned to better handle servers with different processing capacities </li><li>each server is assigned a weight which indicates the processing capacity </li></ul></li><li><p>IP Hash </p><ul><li>A hash of the IP address of the client is calculated to redirect the request to a server </li></ul></li></ul></li></ol></li></ul></li></ul><h2 id="2-4-Redundant-Load-Balancers"><a href="#2-4-Redundant-Load-Balancers" class="headerlink" title="2.4 Redundant Load Balancers"></a>2.4 Redundant Load Balancers</h2><ul><li>Load Balancer can be a single point of failure <ul><li>thus we need a second load balancer, to form a cluster </li><li>each LB monitors the health of the other</li><li>passive one could be switched to be active anytime since they keep monitoring same </li></ul></li></ul><h1 id="3-Caching"><a href="#3-Caching" class="headerlink" title="3. Caching"></a>3. Caching</h1><p>Caching enable you to make vastly better use of the resources you already have as well as make otherwise unattainable product requirements feasibleã€‚ </p><p>It takes advantage of the locality of reference principle: recently requested data is likely to be requested again, could be used in almost every layer of computing </p><h2 id="3-1-Application-Server-Cache"><a href="#3-1-Application-Server-Cache" class="headerlink" title="3.1 Application Server Cache"></a>3.1 Application Server Cache</h2><ul><li><p>place a cache directly on a request layer node </p></li><li><p>cache could be located both in memory and on the nodeâ€™s local disk </p></li><li><p>One note here </p><ul><li>if expand this to many nodes, depends on your load balancer behavior, if it randomly distributes requests across the nodes, the same request will go to different nodes, thus increasing cache misses. <ul><li>could use either global caches or distributed caches for it </li></ul></li></ul></li></ul><h2 id="3-2-Content-Distribution-Network"><a href="#3-2-Content-Distribution-Network" class="headerlink" title="3.2 Content Distribution Network"></a>3.2 Content Distribution Network</h2><ul><li><p>For sites serving large amounts of static media </p></li><li><p>A typical workflow </p><ul><li>A request first ask the CDN for a piece of static media </li><li>CDN will serve the content if it has it locally available </li><li>If not, CDN will query the back end servers for the file </li><li>Then cache it locally, and serve it to the requesting user <h2 id="3-3-Cache-Invalidation"><a href="#3-3-Cache-Invalidation" class="headerlink" title="3.3 Cache Invalidation"></a>3.3 Cache Invalidation</h2></li></ul></li><li><p>Cache needs maintenance for keeping cache coherent with the source of truth</p><ul><li>if data is modified in db, should be invalidated in the cache </li></ul></li><li><p>Write Through Cache </p><ul><li>Data is written into the cache and the corresponding database at the same time </li><li>It could minimize the risk of data loss, but since every write operation mush be done twice before returning success to the client, latency would be higher </li></ul></li><li><p>Write Around Cache </p><ul><li>Data is written directly to permanent storage, bypassing the cache </li><li>Could reduce the cache being flooded with write operations that will not subsequently be re-read</li><li>But a read request for recently written data will create a cache miss </li></ul></li><li><p>Write Back Cache </p><ul><li>Data is written to cache alone</li><li>Write to permanent storage is done after specified intervals or under certain conditions </li><li>Low latency and high throughput for write intensive applications </li><li>However this speed up could cause issue of data loss in case of a crash or other adverse event because the only copy of the written data is in the cache </li></ul></li></ul><h2 id="3-4-Cache-Eviction-Policies"><a href="#3-4-Cache-Eviction-Policies" class="headerlink" title="3.4 Cache Eviction Policies"></a>3.4 Cache Eviction Policies</h2><ul><li>First In First Out </li><li>Last In First Out </li><li>Least Recently Used </li><li>Most Recently Used </li><li>Least Frequently Used </li><li>Randowm Replacement </li></ul><h1 id="4-Data-Partitioning"><a href="#4-Data-Partitioning" class="headerlink" title="4. Data Partitioning"></a>4. Data Partitioning</h1><p>It aims to break up a big database into many smaller parts. Itâ€™s a process of splitting up a DB/ table across multiple machines to improve the manageability, performance, availability, and load balancing of an application. </p><p>The justification for data partitioning is after a certain scale point, itâ€™s cheaper and more feasible to scale horizontally by adding more machines that to grow it vertically by adding beefier servers </p><h2 id="4-1-Partitioning-Methods"><a href="#4-1-Partitioning-Methods" class="headerlink" title="4.1 Partitioning Methods"></a>4.1 Partitioning Methods</h2><h3 id="4-1-1-Horizontal-Partitioning-Sharding"><a href="#4-1-1-Horizontal-Partitioning-Sharding" class="headerlink" title="4.1.1 Horizontal Partitioning/ Sharding"></a>4.1.1 Horizontal Partitioning/ Sharding</h3><ul><li><p>Put different rows into different tables </p></li><li><p>range based partitioning as we store different ranges of data in separate tables </p></li><li><p>Probelm here</p><ul><li>is the range value isnâ€™t chosen carefully, the partitioning scheme will lead to unbalanced servers <h3 id="4-1-2-Vertical-Partitioning"><a href="#4-1-2-Vertical-Partitioning" class="headerlink" title="4.1.2 Vertical Partitioning"></a>4.1.2 Vertical Partitioning</h3></li></ul></li><li><p>store data related to a specific feature in their own server </p><ul><li>like photo in one server, video in another, people they follow in another </li></ul></li><li><p>not quite scalable, if our app experience some high traffic, then the single server will not be enough to handle such traffic </p></li></ul><h3 id="4-1-3-Directory-Based-Partitioning"><a href="#4-1-3-Directory-Based-Partitioning" class="headerlink" title="4.1.3 Directory Based Partitioning"></a>4.1.3 Directory Based Partitioning</h3><ul><li>Create a lookup service which knows your current partitioning scheme and abstracts it away from the DB access code </li><li>To find a particular data entity, query the directory server that holds the mapping between each tuple key to its DB server</li></ul><h2 id="4-2-Partitioning-Criteria"><a href="#4-2-Partitioning-Criteria" class="headerlink" title="4.2 Partitioning Criteria"></a>4.2 Partitioning Criteria</h2><ul><li><p>Key or hash based partitioning </p><ul><li>apply a hash function to some key attributes of the entity we are storing </li><li>need to ensure a uniform allocation of data among servers </li><li>it will change the hash function when every time you add / remove some servers, the workaround is to use consistent hashing </li></ul></li><li><p>List Partitioning </p><ul><li>each partition is assigned a list of values </li></ul></li><li><p>Round robind partitioning </p></li><li><p>Composite Partitioning </p><ul><li>combination of criteria above</li></ul></li></ul><h2 id="4-3-Common-Problems-of-Data-Partitioning"><a href="#4-3-Common-Problems-of-Data-Partitioning" class="headerlink" title="4.3 Common Problems of Data Partitioning"></a>4.3 Common Problems of Data Partitioning</h2><ul><li><p>Joins and Denormalization </p><ul><li>Performing joins on a database that runs on several different servers </li><li>will not be performance efficient </li><li>Workaround is to denormalize database so queries perviously requiring joins can be performed from a single table <ul><li>but need to deal with data inconsistency issue </li></ul></li></ul></li><li><p>Referential Integrity </p><ul><li>nforce data integrity constraints such as foreign keys in a partitioned database can be extremely difficult</li></ul></li><li><p>Rebalancing </p><ul><li><p>need to do that due to </p><ul><li>data distribution is not uniform </li><li>could be a lot of load on one partition </li></ul></li><li><p>In such cases, either we have to create more DB partitions or have to rebalance existing partitions, which means the partitioning scheme changed and all existing data moved to new locations. Doing this without incurring downtime is extremely difficult. Using a scheme like directory based partitioning does make rebalancing a more palatable experience at the cost of increasing the complexity of the system and creating a new single point of failure </p></li></ul></li></ul><h1 id="5-Indexes"><a href="#5-Indexes" class="headerlink" title="5. Indexes"></a>5. Indexes</h1><p>Leverage on indexes when current database performance is no longer satisfactory. Indexing could help make search faster, it could be created using one or more columns of a ddb table, providing the basis for both rapid random lookups and efficient access of ordered records. </p><p>Index can dramatically speed up data retrieval but may itself be large due to the additional keys, which will slow down data insertion and update. </p><p>When adding rows or making updates to existing rows for a table with an active index, we not only have to write the data but also have to update the index. This will decrease the write performance. </p><p>This performance degradation applies to all insert, update, and delete operations for the table. For this reason, adding unnecessary indexes on tables should be avoided and indexes that are no longer used should be removed.</p><p>If the goal of ddb is often written to and rarely read from, in that case, decreasing the performance of the more common operation, which is writing, is probably not worth the increase in performance we get from reading.</p><h1 id="6-Proxies"><a href="#6-Proxies" class="headerlink" title="6. Proxies"></a>6. Proxies</h1><h2 id="6-1-What-is-Proxy-Server"><a href="#6-1-What-is-Proxy-Server" class="headerlink" title="6.1 What is Proxy Server?"></a>6.1 What is Proxy Server?</h2><ul><li><p>Intermediate server between the client and the backend server </p></li><li><p>Clients connect to proxy servers to make a request for a service like</p><ul><li>web page</li><li>file connection </li></ul></li><li><p>Proxy server is a piece of software or hardware that acts as an intermediary for requests from clients seeking resources from other servers </p></li><li><p>Proxy are used to </p><ul><li><p>filter requests </p></li><li><p>transform requests </p><ul><li>add/ remove headers </li><li>encrypt and decrypt</li><li>compress a resource </li></ul></li><li><p>caching </p><ul><li>if multiple clients access a particular resource, the proxy server can cache it and serve it to all clients without going to the remote server </li></ul></li></ul></li></ul><h2 id="6-2-Types"><a href="#6-2-Types" class="headerlink" title="6.2 Types"></a>6.2 Types</h2><ul><li><p>Open Proxy </p><ul><li>A proxy server that is accessible by any internet user </li><li>type<ul><li>anonymous proxy <ul><li>reveals its identity as a server but does not disclose the initial IP address </li></ul></li><li>transparent proxy <ul><li>Identify itself and with the suppot of HTTP headers </li><li>IP address could be viewed </li><li>main benefit of using this sort of server is its ability to cache the websites </li></ul></li></ul></li></ul></li><li><p>reverse proxy </p><ul><li>retrieve resources on behalf of a client from one or more servers </li><li>these resources are then returned to the client, appearing as if they originated from the proxy server itself </li></ul></li></ul><h1 id="7-Redundancy-and-Replication"><a href="#7-Redundancy-and-Replication" class="headerlink" title="7. Redundancy and Replication"></a>7. Redundancy and Replication</h1><ul><li>redundancy <ul><li>duplication of critical components or functions of a system with the intention of increasing the reliability of the system <ul><li>backup</li><li>fail saft </li><li>direct improvement on actual system performance </li></ul></li></ul></li></ul><ul><li><p>replication </p><ul><li><p>shareing information to ensure consistency between redundant resources</p><ul><li>to improve reliability</li><li>fault tolerance</li><li>accessibility </li></ul></li><li><p>primary replica relationship </p><ul><li>primary server gets all the updates </li><li>then ripple through to the replica servers </li><li>each replica outputs a message stating that it has received the update successfully <h1 id="8-SQL-vs-NoSQL"><a href="#8-SQL-vs-NoSQL" class="headerlink" title="8. SQL vs NoSQL"></a>8. SQL vs NoSQL</h1></li></ul></li></ul></li></ul><h2 id="8-1-Concepts"><a href="#8-1-Concepts" class="headerlink" title="8.1 Concepts"></a>8.1 Concepts</h2><ul><li><p>Relational databases </p><ul><li>structured </li><li>predefiend schemas </li></ul></li><li><p>Non-relational database </p><ul><li>unstrutured </li><li>distributed</li><li>dynamic schema </li></ul></li></ul><ul><li><p>SQL</p><ul><li><p>store data in rows and columns </p></li><li><p>each row contains:</p><ul><li>all the info about one entity </li></ul></li><li><p>each column contains:</p><ul><li>all separate data points </li></ul></li></ul></li><li><p>NoSQL</p><ul><li><p>Key-Value Stores </p><ul><li>store in an arry of key value pairs</li><li>key is an attribute name which is linked to a vlue <ul><li>redis</li><li>voldemort</li><li>dynamo</li></ul></li></ul></li><li><p>document database</p><ul><li>data is stored in documents (instead of rows and columns in a table)</li><li>documents are grouped together in collections </li><li>each document can have an entirely different structure</li></ul></li><li><p>wide column databases</p><ul><li>have column families, which are containers for rows </li><li>no need to know all the columns up front and each row doesnâ€™t have to have the same number of columns</li><li>best suited for analyzing large datasets </li><li>type <ul><li>HBase</li><li>Cassandra</li></ul></li></ul></li><li><p>Graph Database</p><ul><li>used to store data whose relations are best represented in a graph </li><li>data is saved in graph structures with:<ul><li>nodes <ul><li>entities</li></ul></li><li>properties<ul><li>information about the entities </li></ul></li><li>lines <ul><li>connections between the entities</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id="8-2-Differences-between-SQL-and-NoSQL"><a href="#8-2-Differences-between-SQL-and-NoSQL" class="headerlink" title="8.2 Differences between SQL and NoSQL"></a>8.2 Differences between SQL and NoSQL</h2><ul><li><p>Storage</p><ul><li><p>SQL </p><ul><li>each row represents an entity </li><li>each column represents a data point about the entity </li></ul></li><li><p>NoSQL</p><ul><li>could be key value</li><li>document</li><li>graph </li></ul></li></ul></li><li><p>Schema</p><ul><li><p>SQL</p><ul><li>each record conforms to a fixed schema <ul><li>columns must be decided and chosen before data entry </li><li>each row must have data for each column </li></ul></li><li>schema modification need to involve modifying the whole database and go offline </li></ul></li><li><p>NoSQL</p><ul><li>schemas are dynamic </li><li>columns can be added on the fly, and each row doesnâ€™t have to contain data for each column</li></ul></li></ul></li><li><p>Query </p><ul><li><p>SQL </p><ul><li>Structured query language for defining and manipulating the data </li></ul></li><li><p>NoSQL </p><ul><li>Query focus on a collection of documents </li><li>UnQL - unstructured query language </li></ul></li></ul></li></ul><ul><li><p>Scalability</p><ul><li><p>SQL</p><ul><li>vetically scalable <ul><li>by increase the horsepower (memory, CPU, etc.) of the hardware </li></ul></li></ul></li><li><p>NoSQL</p><ul><li>horizontally scalable <ul><li>we could add more servers easily in database infrastructure to handle more traffic </li><li>any cheap hardware could host NoSQL database</li></ul></li></ul></li></ul></li><li><p>Reliability or ACID comliancy</p><ul><li><p>ACID</p><ul><li>atomocity</li><li>consistency</li><li>isolation</li><li>durability </li></ul></li><li><p>most NoSQL solutions sacrifice ACID compliance for performance and scalability </p></li></ul></li></ul><h2 id="8-3-Choose-which-one"><a href="#8-3-Choose-which-one" class="headerlink" title="8.3 Choose which one?"></a>8.3 Choose which one?</h2><ul><li>Reasons for use SQL<ul><li>Need ACID compliance <ul><li>ACID reduces anomalies and protects the integrity of your db by prescribing exactly how transactions interact with the database </li></ul></li><li>Data is structured and unchanging </li></ul></li></ul><ul><li><p>Reasons for use NoSQL </p><ul><li><p>Store large volumens of data that often have little to no structure </p><ul><li>NoSQL allows use to add new types </li><li>with document based databases, you can store data in one place without having to define what types of data those are in advance </li></ul></li><li><p>Making the most of cloud computing and storage </p><ul><li>cloud based storage requires data to be easily spread across multiple servers to scale up </li></ul></li><li><p>Rapid development </p></li></ul></li></ul><h1 id="9-CAP-Theorem"><a href="#9-CAP-Theorem" class="headerlink" title="9. CAP Theorem"></a>9. CAP Theorem</h1><p>CAP states itâ€™s impossible for a distributed software system to simultaneously provide more than two out of three of the following gurantees:</p><ul><li>consistency </li><li>availability </li><li>partition tolerance </li></ul><p>CAP say when designing a distributed system we could only pick two of them: </p><ul><li><p>consistency </p><ul><li>all nodes see the same data at the same time </li><li>consistency is achieved by updating several nodes before allowing further reads </li></ul></li><li><p>availability </p><ul><li>every requests get a response on success/ failure </li><li>availability is achieved by replicating the data across different servers </li></ul></li><li><p>partition tolerance </p><ul><li>system continues to work despite msg loss or partial failure </li><li>data is sufficiently replicated across combinations of nodes and networks to keep the system up through intermittent outages </li></ul></li></ul><p>We cannot build a general data store that is continually available, sequentially consistent, and tolerant to any partition failures. We can only build a system that has any two of these three properties. Because, to be consistent, all nodes should see the same set of updates in the same order. But if the network loses a partition, updates in one partition might not make it to the other partitions before a client reads from the out-of-date partition after having read from the up-to-date one. The only thing that can be done to cope with this possibility is to stop serving requests from the out-of-date partition, but then the service is no longer 100% available.</p><h1 id="10-Consistent-Hashing"><a href="#10-Consistent-Hashing" class="headerlink" title="10. Consistent Hashing"></a>10. Consistent Hashing</h1><h2 id="10-1-Existing-Hash-Funciton"><a href="#10-1-Existing-Hash-Funciton" class="headerlink" title="10.1 Existing Hash Funciton"></a>10.1 Existing Hash Funciton</h2><p>Distributed Hash Table is super important in distributed scalable systems. Hash Tables need a key, a value, and a hash function where hash function maps the key to a location where the value is stored. </p><p>A common thought of hash function would be key%n, but it has several drawbacks:</p><ol><li><p>Not horizontally scalable </p><ol><li>whenever a new cache host is added to the system, all existing mappings are broken </li></ol></li><li><p>Not load balanced </p><ol><li>expecially for non-uniformly distributed data </li><li>some caches would come to be hot and saturated while the others idel and are almost empty </li></ol></li></ol><h2 id="10-2-Consistent-Hashing"><a href="#10-2-Consistent-Hashing" class="headerlink" title="10.2 Consistent Hashing"></a>10.2 Consistent Hashing</h2><ul><li>want to minimize reorganization when nodes are added or removed </li><li>when the hash table is resized  only k/n keys need to be remapped where k is the total number of keys and n is the total number of servers </li><li>objects are mapped to the same host if possible </li></ul><ul><li>how it works <ul><li>map a key to an integer</li><li>all integers are placed on a ring such that the values are wrapped around </li><li>each object is assigned to the next server that appears o nthe circle in clockwise order  â€“&gt; provide an even distribution of objects to servers </li><li>if a server fails and is removed from the circle, only the objects that were mapped to the failed server need to be reassigned to the next server in clockwise order </li></ul></li></ul><h1 id="11-Long-Polling-WebSockets-Server-Sent-Events"><a href="#11-Long-Polling-WebSockets-Server-Sent-Events" class="headerlink" title="11. Long-Polling, WebSockets, Server-Sent Events"></a>11. Long-Polling, WebSockets, Server-Sent Events</h1><p>Long Polling, WebSockets and Server Sent events are popular communication protocols between a client like web browser and a web server </p><h2 id="11-1-Ajax-Polling"><a href="#11-1-Ajax-Polling" class="headerlink" title="11.1 Ajax Polling"></a>11.1 Ajax Polling</h2><ul><li><p>Client repeatedly polls a server for data</p></li><li><p>Client make a request and wait for the server to respond with data. If no data available, an empty response is returned </p></li><li><p>whole workflow</p><ul><li>client opens a connection and requests data from the server using regular HTTP </li><li>the requested webpage sends requests to the server at regular intervals </li><li>the server calculates the response and sends it back, like regular HTTP traffic </li><li>the client repeats the above three steps periodically to get updates from the server </li></ul></li></ul><ul><li>pitfall<ul><li>Polling let client continue to ask server for any new data, as a result, a lot of responses are empty, creating HTTP overhead </li></ul></li></ul><h2 id="11-2-HTTP-Long-Polling"><a href="#11-2-HTTP-Long-Polling" class="headerlink" title="11.2 HTTP Long-Polling"></a>11.2 HTTP Long-Polling</h2><ul><li>Workflow <ul><li>If the server does not have any data available for the client, instead of sending an empty response, the server holds the request and waits until some data becomes available </li><li>once available, a full response is sent to the client. Client then immediately request information from the server so that the server will almost always have an available waiting request that it can use to deliver data in response to an event </li></ul></li></ul><ul><li>The client makes an initial request using regular HTTP and then waits for a response.</li><li>The server delays its response until an update is available or a timeout has occurred.</li><li>When an update is available, the server sends a full response to the client.</li><li>The client typically sends a new long-poll request, either immediately upon receiving a response or after a pause to allow an acceptable latency period.</li><li>Each Long-Poll request has a timeout. The client has to reconnect periodically after the connection is closed due to timeouts.</li></ul><h2 id="11-3-WebSockets"><a href="#11-3-WebSockets" class="headerlink" title="11.3 WebSockets"></a>11.3 WebSockets</h2><ul><li>Provides Full duplex communication channels over a single TCP connection. </li><li>Provides a persistent connection between a client and a server that both parties can use to start sending data at any time. </li><li>lower overhead, real time data transfer <ul><li>it provides a standardized way for the server to send content to the browser without being asked by the client and allowing for messages to be passed back and forth while keeping the connection open </li></ul></li><li>Workflow <ul><li>Client establish a websocket connection through a process known as the WebSocket handshake</li><li>if the process succeeds server and client can exchange data in both directions at any time </li></ul></li></ul><h2 id="11-4-Server-Sent-Events-SSEs"><a href="#11-4-Server-Sent-Events-SSEs" class="headerlink" title="11.4 Server Sent Events - SSEs"></a>11.4 Server Sent Events - SSEs</h2><ul><li>Client establish a persistent and long term connection with the server </li><li>Server use this connection to send data to a client </li><li>But client would need another tech/ protocol to send data to the server </li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://en.wikipedia.org/wiki/Consistent_hashing#:~:text=In%20computer%20science%2C%20consistent%20hashing,is%20the%20number%20of%20slots" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Consistent_hashing#:~:text=In%20computer%20science%2C%20consistent%20hashing,is%20the%20number%20of%20slots</a>. </li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>System Design General Guides - from Grokking SDI</title>
      <link href="/System-Design-General-Guides-from-Grokking-SDI/"/>
      <url>/System-Design-General-Guides-from-Grokking-SDI/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Requirements-Clarifications"><a href="#1-Requirements-Clarifications" class="headerlink" title="1. Requirements Clarifications"></a>1. Requirements Clarifications</h1><ul><li>Ask about the exact scope of the problem <ul><li>For a twitter like system design <ul><li>will users of our service be able to post tweets and follow others? </li><li>Create and display userâ€™s timeline?</li><li>Tweets contain photos and videos?</li><li>Front end design too?</li><li>Searchable tweets?</li><li>Display hot trending topics?</li><li>Push notification for new tweets? </li></ul></li></ul></li></ul><h1 id="2-Back-of-the-envelope-estimation"><a href="#2-Back-of-the-envelope-estimation" class="headerlink" title="2. Back of the envelope estimation"></a>2. Back of the envelope estimation</h1><ul><li><p>estimate the scale of the system we are going to design </p><ul><li><p>could help later when we will be focusing on scaling, partitioning, load balancing and caching</p><ul><li><p>what scale is expected </p><ul><li>number of new tweets</li><li>number of tweet views</li><li>number of timeline generations per sec </li></ul></li><li><p>how much storage will we need</p><ul><li>videos and photos will play important role on our estimation </li></ul></li><li><p>what network bandwidth usage are we expecting</p><ul><li>crucial in deciding how we will manage traffic and balance load between servers </li></ul></li></ul></li></ul></li></ul><h1 id="3-System-Interface-Definition"><a href="#3-System-Interface-Definition" class="headerlink" title="3. System Interface Definition"></a>3. System Interface Definition</h1><p>Establish exact contract expected from the system </p><pre><code>postTweet(user_id, tweet_data, tweet_location, user_location, timestamp, â€¦)  generateTimeline(user_id, current_time, user_location, â€¦)  markTweetFavorite(user_id, tweet_id, timestamp, â€¦)  </code></pre><h1 id="4-Define-Data-Model"><a href="#4-Define-Data-Model" class="headerlink" title="4. Define Data Model"></a>4. Define Data Model</h1><p>Define the data model, to clarify how data will flow between different components of the system. Later, will guide for data partitioning and management. </p><p>User: UserID, Name, Email, DoB, CreationData, LastLogin, etc.<br>Tweet: TweetID, Content, TweetLocation, NumberOfLikes, TimeStamp, etc.<br>UserFollow: UserID1, UserID2<br>FavoriteTweets: UserID, TweetID, TimeStamp</p><h1 id="5-High-level-design"><a href="#5-High-level-design" class="headerlink" title="5. High level design"></a>5. High level design</h1><ul><li>Draw a block diagram with 5 - 6 boxes representing the core components of our system. We need to identify enough components that are needed to solve the actual problem from end2end. </li><li>For twitter <ul><li>Multiple application servers to serve all the read/ write requests with load balancers in front of them for traffic distributions </li><li>we could have separate servers for handling specific traffic (like much more read than write)</li><li>Efficient database that can store all the tweets and can support a huge number of reads </li><li>Also need a distributed file storage system for storing photos and videos </li></ul></li></ul><h1 id="6-Detailed-Design"><a href="#6-Detailed-Design" class="headerlink" title="6. Detailed Design"></a>6. Detailed Design</h1><ul><li>Dig deeper to 2 or 3 components <ul><li>present different approaches</li><li>pros and cons </li><li>explain why we prefer one on the other </li><li>consider tradeoffs between different options while keeping system contraints in mind </li></ul></li></ul><ul><li>Question Examples<ul><li>Since we will be storing a massive amount of data, how should we partition our data to distribute it to multiple databases? Should we try to store all the data of a user on the same database? What issue could it cause?</li><li>How will we handle hot users who tweet a lot or follow lots of people?</li><li>Since usersâ€™ timeline will contain the most recent (and relevant) tweets, should we try to store our data in such a way that is optimized for scanning the latest tweets?</li><li>How much and at which layer should we introduce cache to speed things up?</li><li>What components need better load balancing?</li></ul></li></ul><h1 id="7-Identifying-and-resolving-bottlenecks"><a href="#7-Identifying-and-resolving-bottlenecks" class="headerlink" title="7 Identifying and resolving bottlenecks"></a>7 Identifying and resolving bottlenecks</h1><ul><li>Discuss as many bottlenecks as possible and different approaches to mitigate them <ul><li>Any single point of failure in our system? </li><li>Do we have enough replicas of the data so that if we lose a few servers, we can still serve our users? </li><li>Do we have enough copies of different services running such that a fewe failures will not cause a total system shutdown?</li><li>How to monitor performance of our service? </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¼“å­˜çš„å¸¸è§é—®é¢˜</title>
      <link href="/%E7%BC%93%E5%AD%98%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"/>
      <url>/%E7%BC%93%E5%AD%98%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ç¼“å­˜é›ªå´©"><a href="#1-ç¼“å­˜é›ªå´©" class="headerlink" title="1. ç¼“å­˜é›ªå´©"></a>1. ç¼“å­˜é›ªå´©</h1><p>ç¼“å­˜ç³»ç»Ÿçš„IOPSæ¯”æ•°æ®åº“é«˜å¾ˆå¤šï¼Œå› æ­¤éœ€è¦æ³¨æ„çŸ­æ—¶é—´å†…çš„å¤§é‡ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¸€æ—¦å‘ç”Ÿï¼Œå¯èƒ½å°±ä¼šåœ¨ç¬é—´æœ‰å¤§é‡çš„æ•°æ®éœ€è¦å›æºåˆ°æ•°æ®åº“æŸ¥è¯¢ï¼Œå¯¹æ•°æ®åº“é€ æˆæå¤§çš„å‹åŠ›ï¼Œæé™æƒ…å†µä¸‹ç”šè‡³å¯¼è‡´åç«¯æ•°æ®åº“ç›´æ¥å´©æºƒã€‚è¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„ç¼“å­˜é›ªå´©ã€‚</p><p>äº§ç”Ÿé›ªå´©çš„åŸå› æœ‰ä¸¤ç§ï¼š</p><ul><li>ç¼“å­˜ç³»ç»Ÿæœ¬èº«ä¸å¯ç”¨ï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚ç›´æ¥å›æºåˆ°æ•°æ®åº“</li><li>åº”ç”¨è®¾è®¡å±‚é¢å¤§é‡çš„Keyåœ¨åŒä¸€æ—¶é—´è¿‡æœŸï¼Œå¯¼è‡´å¤§é‡çš„æ•°æ®å›æº<ul><li>è§£å†³æ–¹æ³•<ul><li>å·®å¼‚åŒ–ç¼“å­˜è¿‡æœŸæ—¶é—´<ul><li>ä¸è®©å¤§é‡çš„Keyåœ¨åŒä¸€æ—¶é—´è¿‡æœŸ</li><li>åˆå§‹åŒ–ç¼“å­˜çš„æ—¶å€™ï¼Œè®¾ç½®ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ä¸º30ç§’ + 10ç§’ä»¥å†…çš„éšæœºå»¶è¿Ÿï¼ˆæ‰°åŠ¨å€¼ï¼‰ã€‚è¿™æ ·keyå°±ä¸ä¼šé›†ä¸­åœ¨30ç§’è¿™ä¸ªæ—¶åˆ»è¿‡æœŸï¼Œè€Œæ˜¯ä¼šåˆ†æ•£åœ¨30 - 40ç§’ä¹‹é—´</li></ul></li><li>è®©ç¼“å­˜ä¸ä¸»åŠ¨è¿‡æœŸ<ul><li>åˆå§‹åŒ–ç¼“å­˜æ•°æ®çš„æ—¶å€™è®¾ç½®ç¼“å­˜æ°¸ä¸è¿‡æœŸï¼Œç„¶åå¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹30ç§’ä¸€æ¬¡å®šæ—¶å°†æ‰€æœ‰æ•°æ®æ›´æ–°åˆ°ç¼“å­˜ï¼Œé€šè¿‡é€‚å½“çš„ä¼‘çœ ï¼Œæ§åˆ¶ä»æ•°æ®åº“æ›´æ–°æ•°æ®çš„é¢‘ç‡ï¼Œé™ä½æ•°æ®åº“çš„å‹åŠ›</li><li>å¦‚æœæ— æ³•å…¨é‡ç¼“å­˜æ‰€æœ‰çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨è¯¥ç§æ–¹æ¡ˆ</li></ul></li></ul></li></ul></li></ul><pre><code>// å·®å¼‚åŒ–ç¼“å­˜è¿‡æœŸæ—¶é—´@PostConstructpublic void rightInit1() {    //è¿™æ¬¡ç¼“å­˜çš„è¿‡æœŸæ—¶é—´æ˜¯30ç§’+10ç§’å†…çš„éšæœºå»¶è¿Ÿ    IntStream.rangeClosed(1, 1000).forEach(i -&gt; stringRedisTemplate.opsForValue().set(&quot;city&quot; + i, getCityFromDb(i), 30 + ThreadLocalRandom.current().nextInt(10), TimeUnit.SECONDS));    log.info(&quot;Cache init finished&quot;);    //åŒæ ·1ç§’ä¸€æ¬¡è¾“å‡ºæ•°æ®åº“QPSï¼š   Executors.newSingleThreadScheduledExecutor().scheduleAtFixedRate(() -&gt; {        log.info(&quot;DB QPS : {}&quot;, atomicInteger.getAndSet(0));    }, 0, 1, TimeUnit.SECONDS);}// è®©ç¼“å­˜ä¸ä¸»åŠ¨è¿‡æœŸ@PostConstructpublic void rightInit2() throws InterruptedException {    CountDownLatch countDownLatch = new CountDownLatch(1);    //æ¯éš”30ç§’å…¨é‡æ›´æ–°ä¸€æ¬¡ç¼“å­˜     Executors.newSingleThreadScheduledExecutor().scheduleAtFixedRate(() -&gt; {        IntStream.rangeClosed(1, 1000).forEach(i -&gt; {            String data = getCityFromDb(i);            //æ¨¡æ‹Ÿæ›´æ–°ç¼“å­˜éœ€è¦ä¸€å®šçš„æ—¶é—´            try {                TimeUnit.MILLISECONDS.sleep(20);            } catch (InterruptedException e) { }            if (!StringUtils.isEmpty(data)) {                //ç¼“å­˜æ°¸ä¸è¿‡æœŸï¼Œè¢«åŠ¨æ›´æ–°                stringRedisTemplate.opsForValue().set(&quot;city&quot; + i, data);            }        });        log.info(&quot;Cache update finished&quot;);        //å¯åŠ¨ç¨‹åºçš„æ—¶å€™éœ€è¦ç­‰å¾…é¦–æ¬¡æ›´æ–°ç¼“å­˜å®Œæˆ        countDownLatch.countDown();    }, 0, 30, TimeUnit.SECONDS);    Executors.newSingleThreadScheduledExecutor().scheduleAtFixedRate(() -&gt; {        log.info(&quot;DB QPS : {}&quot;, atomicInteger.getAndSet(0));    }, 0, 1, TimeUnit.SECONDS);    countDownLatch.await();}</code></pre><h1 id="2-ç¼“å­˜å‡»ç©¿"><a href="#2-ç¼“å­˜å‡»ç©¿" class="headerlink" title="2. ç¼“å­˜å‡»ç©¿"></a>2. ç¼“å­˜å‡»ç©¿</h1><p>åœ¨æŸäº›Keyå±äºæç«¯çƒ­ç‚¹æ•°æ®å¹¶ä¸”å¹¶å‘é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¿™ä¸ªKeyè¿‡æœŸï¼Œå¯èƒ½ä¼šåœ¨æŸä¸ªç¬é—´å‡ºç°å¤§é‡çš„å¹¶å‘è¯·æ±‚åŒæ—¶å›æºï¼Œç›¸å½“äºå¤§é‡çš„å¹¶å‘è¯·æ±‚ç›´æ¥æ‰“åˆ°äº†æ•°æ®åº“ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ç¼“å­˜å‡»ç©¿æˆ–ç¼“å­˜å¹¶å‘é—®é¢˜ã€‚</p><p>å¦‚æœè¯´å›æºæ“ä½œæ¯”è¾ƒæ˜‚è´µçš„è¯ï¼Œé‚£ä¹ˆè¿™ç§å¹¶å‘å°±ä¸èƒ½å¿½ç•¥ä¸è®¡äº†ã€‚å¯ä»¥è€ƒè™‘ä½¿ç”¨é”æœºåˆ¶æ¥é™åˆ¶å›æºçš„å¹¶å‘ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨ç±»ä¼¼Semaphoreçš„å·¥å…·æ¥é™åˆ¶å¹¶å‘æ•°ï¼Œæ¯”å¦‚é™åˆ¶ä¸º10.è¿™æ ·å­æ—¢é™åˆ¶äº†å›æºå¹¶å‘æ•°ä¸è‡³äºå¤ªå¤§ï¼Œåˆèƒ½å¤Ÿä½¿å¾—ä¸€å®šé‡çš„çº¿ç¨‹å¯ä»¥åŒæ—¶å›æºã€‚</p><h1 id="3-ç¼“å­˜ç©¿é€"><a href="#3-ç¼“å­˜ç©¿é€" class="headerlink" title="3. ç¼“å­˜ç©¿é€"></a>3. ç¼“å­˜ç©¿é€</h1><p>ç¼“å­˜ç©¿é€æŒ‡çš„æ˜¯å®é™…ä¸Šç¼“å­˜é‡Œæœ‰key å’Œvalueï¼Œä½†æ˜¯å…¶valueå¯èƒ½ä¸ºç©ºï¼Œå¦‚æœæ²¡åšæ­£ç¡®å¤„ç†ï¼Œé‚£æˆ‘ä»¬çš„é€»è¾‘å¯èƒ½ä¼šè®¤ä¸ºæ²¡æœ‰å¯¹å½“å‰çš„keyåšå¥½ç¼“å­˜ï¼Œä¼šå¯¹æ‰€æœ‰çš„è¯·æ±‚éƒ½å›æºåˆ°æ•°æ®åº“ä¸Šï¼Œè¿™å°±ä¼šç»™æ•°æ®åº“é€ æˆå‹åŠ›äº†ã€‚</p><p>é’ˆå¯¹è¿™ç§é—®é¢˜ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ¡ˆè§£å†³ï¼š</p><ul><li><p>å¯¹äºä¸å­˜åœ¨çš„æ•°æ®ï¼ŒåŒæ ·è®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„Valueåˆ°ç¼“å­˜å½“ä¸­ï¼Œæ¯”å¦‚NODATAï¼Œè¿™æ ·å­å°±ä¸ä¼šæœ‰ç¼“å­˜ç©¿é€çš„é—®é¢˜</p><ul><li>å¯èƒ½ä¼šå°†å¤§é‡æ— æ•ˆçš„æ•°æ®åŠ å…¥åˆ°ç¼“å­˜å½“ä¸­</li></ul></li><li><p>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨</p><ul><li>æ”¾åœ¨ç¼“å­˜æ•°æ®è¯»å–å‰å…ˆè¿›è¡Œè¿‡æ»¤æ“ä½œ</li><li>Google Guava BloomFilter </li></ul></li></ul><pre><code>private BloomFilter&lt;Integer&gt; bloomFilter;@PostConstructpublic void init() {    //åˆ›å»ºå¸ƒéš†è¿‡æ»¤å™¨ï¼Œå…ƒç´ æ•°é‡10000ï¼ŒæœŸæœ›è¯¯åˆ¤ç‡1%    bloomFilter = BloomFilter.create(Funnels.integerFunnel(), 10000, 0.01);    //å¡«å……å¸ƒéš†è¿‡æ»¤å™¨    IntStream.rangeClosed(1, 10000).forEach(bloomFilter::put);}@GetMapping(&quot;right2&quot;)public String right2(@RequestParam(&quot;id&quot;) int id) {    String data = &quot;&quot;;    //é€šè¿‡å¸ƒéš†è¿‡æ»¤å™¨å…ˆåˆ¤æ–­    if (bloomFilter.mightContain(id)) {        String key = &quot;user&quot; + id;        //èµ°ç¼“å­˜æŸ¥è¯¢        data = stringRedisTemplate.opsForValue().get(key);        if (StringUtils.isEmpty(data)) {            //èµ°æ•°æ®åº“æŸ¥è¯¢            data = getCityFromDb(id);            stringRedisTemplate.opsForValue().set(key, data, 30, TimeUnit.SECONDS);        }    }    return data;}</code></pre><h1 id="4-ç¼“å­˜æ•°æ®åŒæ­¥ç­–ç•¥"><a href="#4-ç¼“å­˜æ•°æ®åŒæ­¥ç­–ç•¥" class="headerlink" title="4. ç¼“å­˜æ•°æ®åŒæ­¥ç­–ç•¥"></a>4. ç¼“å­˜æ•°æ®åŒæ­¥ç­–ç•¥</h1><ul><li>å½“åŸå§‹æ•°æ®è¢«ä¿®æ”¹äº†ä»¥åï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½ä¼šé‡‡ç”¨ä¸»åŠ¨æ›´æ–°ç¼“å­˜çš„ç­–ç•¥<ul><li>å¯èƒ½çš„ç­–ç•¥æœ‰<ul><li>å…ˆæ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“<ul><li>ä¸å¯è¡Œ</li><li>æ•°æ®åº“æ“ä½œå¤±è´¥æ˜¯æœ‰å¯èƒ½çš„ï¼Œä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“å½“ä¸­çš„æ•°æ®ä¸ä¸€è‡´</li></ul></li><li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜<ul><li>ä¸å¯è¡Œ</li><li>å¤šçº¿ç¨‹æƒ…å†µä¸‹æ•°æ®åº“ä¸­æ›´æ–°çš„é¡ºåºå’Œç¼“å­˜æ›´æ–°çš„é¡ºåºä¼šä¸åŒï¼Œå¯èƒ½ä¼šå¯¼è‡´æ—§æ•°æ®æœ€ååˆ°ï¼Œå¯¼è‡´é—®é¢˜çš„å‡ºç°</li></ul></li><li>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ï¼Œè®¿é—®çš„æ—¶å€™æŒ‰éœ€åŠ è½½æ•°æ®åˆ°ç¼“å­˜å½“ä¸­<ul><li>å¾ˆå¯èƒ½åˆ é™¤ç¼“å­˜ä»¥åè¿˜æ²¡æ¥å¾—åŠæ›´æ–°æ•°æ®åº“ï¼Œå°±æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹å…ˆè¯»å–äº†æ—§å€¼åˆ°ç¼“å­˜ä¸­</li></ul></li><li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œè®¿é—®çš„æ—¶å€™æŒ‰éœ€åŠ è½½æ•°æ®åˆ°ç¼“å­˜å½“ä¸­<ul><li>å‡ºç°ç¼“å­˜ä¸ä¸€è‡´çš„æ¦‚ç‡å¾ˆä½</li></ul></li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨æ³¨è§£ + åå°„æ¶ˆé™¤é‡å¤ä»£ç </title>
      <link href="/%E5%88%A9%E7%94%A8%E6%B3%A8%E8%A7%A3-%E5%8F%8D%E5%B0%84%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81/"/>
      <url>/%E5%88%A9%E7%94%A8%E6%B3%A8%E8%A7%A3-%E5%8F%8D%E5%B0%84%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ¡ˆä¾‹åˆ†æ"><a href="#1-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="1. æ¡ˆä¾‹åˆ†æ"></a>1. æ¡ˆä¾‹åˆ†æ</h1><h2 id="1-1-æ¡ˆä¾‹åœºæ™¯"><a href="#1-1-æ¡ˆä¾‹åœºæ™¯" class="headerlink" title="1.1 æ¡ˆä¾‹åœºæ™¯"></a>1.1 æ¡ˆä¾‹åœºæ™¯</h2><p>å‡è®¾é“¶è¡Œæä¾›äº†ä¸€äº› API æ¥å£ï¼Œå¯¹å‚æ•°çš„åºåˆ—åŒ–æœ‰ç‚¹ç‰¹æ®Šï¼Œä¸ä½¿ç”¨ JSONï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬æŠŠå‚æ•°ä¾æ¬¡æ‹¼åœ¨ä¸€èµ·æ„æˆä¸€ä¸ªå¤§å­—ç¬¦ä¸²</p><ul><li>æŒ‰ç…§é“¶è¡Œæä¾›çš„APIæ–‡æ¡£é¡ºåºï¼Œå°†æ‰€æœ‰çš„å‚æ•°æ„æˆå®šé•¿çš„æ•°æ®ï¼Œå¹¶ä¸”æ‹¼æ¥åœ¨ä¸€èµ·ä½œä¸ºä¸€æ•´ä¸ªå­—ç¬¦ä¸²</li><li>å› ä¸ºæ¯ä¸€ç§å‚æ•°éƒ½æœ‰å›ºå®šé•¿åº¦ï¼Œæœªè¾¾åˆ°é•¿åº¦éœ€è¦è¿›è¡Œå¡«å……å¤„ç†<ul><li>å­—ç¬¦ä¸²ç±»å‹å‚æ•°ä¸æ»¡é•¿åº¦éƒ¨åˆ†è¦ä»¥ä¸‹åˆ’çº¿å³å¡«å……ï¼Œå³å­—ç¬¦ä¸²å†…å®¹é å·¦</li><li>æ•°å­—ç±»å‹çš„å‚æ•°ä¸æ»¡é•¿åº¦éƒ¨åˆ†ä»¥0å·¦å¡«å……ï¼Œå³å®é™…æ•°å­—é å³</li><li>è´§å¸ç±»å‹çš„è¡¨ç¤ºéœ€è¦æŠŠé‡‘é¢å‘ä¸‹èˆå…¥2ä½åˆ°åˆ†ï¼Œä»¥åˆ†ä¸ºå•ä½ï¼Œä½œä¸ºæ•°å­—ç±»å‹åŒæ ·è¿›è¡Œå·¦å¡«å……</li><li>å‚æ•°åšMD5 æ“ä½œä½œä¸ºç­¾å</li></ul></li></ul><h2 id="1-2-åˆæ­¥ä»£ç å®ç°"><a href="#1-2-åˆæ­¥ä»£ç å®ç°" class="headerlink" title="1.2 åˆæ­¥ä»£ç å®ç°"></a>1.2 åˆæ­¥ä»£ç å®ç°</h2><pre><code>public class BankService {    //åˆ›å»ºç”¨æˆ·æ–¹æ³•    public static String createUser(String name, String identity, String mobile, int age) throws IOException {        StringBuilder stringBuilder = new StringBuilder();        //å­—ç¬¦ä¸²é å·¦ï¼Œå¤šä½™çš„åœ°æ–¹å¡«å……_        stringBuilder.append(String.format(&quot;%-10s&quot;, name).replace(&#39; &#39;, &#39;_&#39;));        //å­—ç¬¦ä¸²é å·¦ï¼Œå¤šä½™çš„åœ°æ–¹å¡«å……_        stringBuilder.append(String.format(&quot;%-18s&quot;, identity).replace(&#39; &#39;, &#39;_&#39;));        //æ•°å­—é å³ï¼Œå¤šä½™çš„åœ°æ–¹ç”¨0å¡«å……        stringBuilder.append(String.format(&quot;%05d&quot;, age));        //å­—ç¬¦ä¸²é å·¦ï¼Œå¤šä½™çš„åœ°æ–¹ç”¨_å¡«å……        stringBuilder.append(String.format(&quot;%-11s&quot;, mobile).replace(&#39; &#39;, &#39;_&#39;));        //æœ€ååŠ ä¸ŠMD5ä½œä¸ºç­¾å        stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));        return Request.Post(&quot;http://localhost:45678/reflection/bank/createUser&quot;)                .bodyString(stringBuilder.toString(), ContentType.APPLICATION_JSON)                .execute().returnContent().asString();    }    //æ”¯ä»˜æ–¹æ³•    public static String pay(long userId, BigDecimal amount) throws IOException {        StringBuilder stringBuilder = new StringBuilder();        //æ•°å­—é å³ï¼Œå¤šä½™çš„åœ°æ–¹ç”¨0å¡«å……        stringBuilder.append(String.format(&quot;%020d&quot;, userId));        //é‡‘é¢å‘ä¸‹èˆå…¥2ä½åˆ°åˆ†ï¼Œä»¥åˆ†ä¸ºå•ä½ï¼Œä½œä¸ºæ•°å­—é å³ï¼Œå¤šä½™çš„åœ°æ–¹ç”¨0å¡«å……        stringBuilder.append(String.format(&quot;%010d&quot;, amount.setScale(2, RoundingMode.DOWN).multiply(new BigDecimal(&quot;100&quot;)).longValue()));        //æœ€ååŠ ä¸ŠMD5ä½œä¸ºç­¾å        stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));        return Request.Post(&quot;http://localhost:45678/reflection/bank/pay&quot;)                .bodyString(stringBuilder.toString(), ContentType.APPLICATION_JSON)                .execute().returnContent().asString();    }}</code></pre><ul><li>è¿™æ ·åšèƒ½å¤ŸåŸºæœ¬æ»¡è¶³éœ€æ±‚ï¼Œä½†æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š<ul><li>å¤„ç†é€»è¾‘äº’ç›¸ä¹‹é—´æœ‰é‡å¤ï¼Œç¨æœ‰ä¸æ…å°±ä¼šå‡ºç°Bug</li><li>å¤„ç†æµç¨‹ä¸­å­—ç¬¦ä¸²æ‹¼æ¥ã€åŠ ç­¾å’Œå‘è¯·æ±‚çš„é€»è¾‘ï¼Œåœ¨æ‰€æœ‰æ–¹æ³•é‡å¤</li><li>å®é™…æ–¹æ³•çš„å…¥å‚çš„å‚æ•°ç±»å‹å’Œé¡ºåºï¼Œä¸ä¸€å®šå’Œæ¥å£è¦æ±‚ä¸€è‡´ï¼Œå®¹æ˜“å‡ºé”™</li><li>ä»£ç å±‚é¢å‚æ•°ç¡¬ç¼–ç ï¼Œæ— æ³•æ¸…æ™°è¿›è¡Œæ ¸å¯¹</li></ul></li></ul><h2 id="1-3-ä½¿ç”¨æ¥å£å’Œåå°„ä¼˜åŒ–ä»£ç "><a href="#1-3-ä½¿ç”¨æ¥å£å’Œåå°„ä¼˜åŒ–ä»£ç " class="headerlink" title="1.3 ä½¿ç”¨æ¥å£å’Œåå°„ä¼˜åŒ–ä»£ç "></a>1.3 ä½¿ç”¨æ¥å£å’Œåå°„ä¼˜åŒ–ä»£ç </h2><h3 id="1-3-1-å®ç°å®šä¹‰äº†æ‰€æœ‰æ¥å£å‚æ•°çš„POJOç±»"><a href="#1-3-1-å®ç°å®šä¹‰äº†æ‰€æœ‰æ¥å£å‚æ•°çš„POJOç±»" class="headerlink" title="1.3.1 å®ç°å®šä¹‰äº†æ‰€æœ‰æ¥å£å‚æ•°çš„POJOç±»"></a>1.3.1 å®ç°å®šä¹‰äº†æ‰€æœ‰æ¥å£å‚æ•°çš„POJOç±»</h3><pre><code>@Datapublic class CreateUserAPI {    private String name;    private String identity;    private String mobile;    private int age;}</code></pre><h3 id="1-3-2-å®šä¹‰æ³¨è§£æœ¬èº«"><a href="#1-3-2-å®šä¹‰æ³¨è§£æœ¬èº«" class="headerlink" title="1.3.2 å®šä¹‰æ³¨è§£æœ¬èº«"></a>1.3.2 å®šä¹‰æ³¨è§£æœ¬èº«</h3><pre><code>@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.TYPE)@Documented@Inheritedpublic @interface BankAPI {    String desc() default &quot;&quot;;    String url() default &quot;&quot;;}@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.FIELD)@Documented@Inheritedpublic @interface BankAPIField {    int order() default -1;    int length() default -1;    String type() default &quot;&quot;;}</code></pre><h3 id="1-3-3-åå°„é…åˆæ³¨è§£å®ç°åŠ¨æ€çš„æ¥å£å‚æ•°ç»„è£…"><a href="#1-3-3-åå°„é…åˆæ³¨è§£å®ç°åŠ¨æ€çš„æ¥å£å‚æ•°ç»„è£…" class="headerlink" title="1.3.3 åå°„é…åˆæ³¨è§£å®ç°åŠ¨æ€çš„æ¥å£å‚æ•°ç»„è£…"></a>1.3.3 åå°„é…åˆæ³¨è§£å®ç°åŠ¨æ€çš„æ¥å£å‚æ•°ç»„è£…</h3><pre><code>private static String remoteCall(AbstractAPI api) throws IOException {    //ä»BankAPIæ³¨è§£è·å–è¯·æ±‚åœ°å€    BankAPI bankAPI = api.getClass().getAnnotation(BankAPI.class);    bankAPI.url();    StringBuilder stringBuilder = new StringBuilder();    Arrays.stream(api.getClass().getDeclaredFields()) //è·å¾—æ‰€æœ‰å­—æ®µ            .filter(field -&gt; field.isAnnotationPresent(BankAPIField.class)) //æŸ¥æ‰¾æ ‡è®°äº†æ³¨è§£çš„å­—æ®µ            .sorted(Comparator.comparingInt(a -&gt; a.getAnnotation(BankAPIField.class).order())) //æ ¹æ®æ³¨è§£ä¸­çš„orderå¯¹å­—æ®µæ’åº            .peek(field -&gt; field.setAccessible(true)) //è®¾ç½®å¯ä»¥è®¿é—®ç§æœ‰å­—æ®µ            .forEach(field -&gt; {                //è·å¾—æ³¨è§£                BankAPIField bankAPIField = field.getAnnotation(BankAPIField.class);                Object value = &quot;&quot;;                try {                    //åå°„è·å–å­—æ®µå€¼                    value = field.get(api);                } catch (IllegalAccessException e) {                    e.printStackTrace();                }                //æ ¹æ®å­—æ®µç±»å‹ä»¥æ­£ç¡®çš„å¡«å……æ–¹å¼æ ¼å¼åŒ–å­—ç¬¦ä¸²                switch (bankAPIField.type()) {                    case &quot;S&quot;: {                        stringBuilder.append(String.format(&quot;%-&quot; + bankAPIField.length() + &quot;s&quot;, value.toString()).replace(&#39; &#39;, &#39;_&#39;));                        break;                    }                    case &quot;N&quot;: {                        stringBuilder.append(String.format(&quot;%&quot; + bankAPIField.length() + &quot;s&quot;, value.toString()).replace(&#39; &#39;, &#39;0&#39;));                        break;                    }                    case &quot;M&quot;: {                        if (!(value instanceof BigDecimal))                            throw new RuntimeException(String.format(&quot;{} çš„ {} å¿…é¡»æ˜¯BigDecimal&quot;, api, field));                        stringBuilder.append(String.format(&quot;%0&quot; + bankAPIField.length() + &quot;d&quot;, ((BigDecimal) value).setScale(2, RoundingMode.DOWN).multiply(new BigDecimal(&quot;100&quot;)).longValue()));                        break;                    }                    default:                        break;                }            });    //ç­¾åé€»è¾‘   stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));    String param = stringBuilder.toString();    long begin = System.currentTimeMillis();    //å‘è¯·æ±‚    String result = Request.Post(&quot;http://localhost:45678/reflection&quot; + bankAPI.url())            .bodyString(param, ContentType.APPLICATION_JSON)            .execute().returnContent().asString();    log.info(&quot;è°ƒç”¨é“¶è¡ŒAPI {} url:{} å‚æ•°:{} è€—æ—¶:{}ms&quot;, bankAPI.desc(), bankAPI.url(), param, System.currentTimeMillis() - begin);    return result;}</code></pre><p>é€šè¿‡åå°„æ¥åŠ¨æ€è·å¾—classçš„ä¿¡æ¯ï¼Œå¹¶åœ¨runtimeçš„æ—¶å€™å®Œæˆç»„è£…è¿‡ç¨‹ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¼€å‘çš„æ—¶å€™ä¼šæ–¹ä¾¿ç›´è§‚å¾ˆå¤šï¼Œç„¶åå°†é€»è¾‘ä¸ç»†èŠ‚éšè—èµ·æ¥ï¼Œå¹¶ä¸”é›†ä¸­æ”¾åˆ°äº†ä¸€ä¸ªæ–¹æ³•å½“ä¸­ï¼Œå‡å°‘äº†é‡å¤ï¼Œä»¥åŠç»´æŠ¤å½“ä¸­bugçš„å‡ºç°ã€‚</p><h3 id="1-3-4-åœ¨ä»£ç ä¸­çš„åº”ç”¨"><a href="#1-3-4-åœ¨ä»£ç ä¸­çš„åº”ç”¨" class="headerlink" title="1.3.4 åœ¨ä»£ç ä¸­çš„åº”ç”¨"></a>1.3.4 åœ¨ä»£ç ä¸­çš„åº”ç”¨</h3><pre><code>@BankAPI(url = &quot;/bank/createUser&quot;, desc = &quot;åˆ›å»ºç”¨æˆ·æ¥å£&quot;)@Datapublic class CreateUserAPI extends AbstractAPI {    @BankAPIField(order = 1, type = &quot;S&quot;, length = 10)    private String name;    @BankAPIField(order = 2, type = &quot;S&quot;, length = 18)    private String identity;    @BankAPIField(order = 4, type = &quot;S&quot;, length = 11) //æ³¨æ„è¿™é‡Œçš„orderéœ€è¦æŒ‰ç…§APIè¡¨æ ¼ä¸­çš„é¡ºåº    private String mobile;    @BankAPIField(order = 3, type = &quot;N&quot;, length = 5)    private int age;}@BankAPI(url = &quot;/bank/pay&quot;, desc = &quot;æ”¯ä»˜æ¥å£&quot;)@Datapublic class PayAPI extends AbstractAPI {    @BankAPIField(order = 1, type = &quot;N&quot;, length = 20)    private long userId;    @BankAPIField(order = 2, type = &quot;M&quot;, length = 10)    private BigDecimal amount;}</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Annotations </tag>
            
            <tag> Reflection </tag>
            
            <tag> æ³¨è§£ </tag>
            
            <tag> åå°„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring IoC, AOPæµ…æ</title>
      <link href="/Spring-IoC-AOP%E6%B5%85%E6%9E%90/"/>
      <url>/Spring-IoC-AOP%E6%B5%85%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="1-IoC"><a href="#1-IoC" class="headerlink" title="1. IoC"></a>1. IoC</h1><h2 id="1-1-Overview"><a href="#1-1-Overview" class="headerlink" title="1.1 Overview"></a>1.1 Overview</h2><ul><li><p>Inversion of control </p><ul><li>æ§åˆ¶åè½¬</li><li>å°†è®¾è®¡å¥½çš„å¯¹è±¡äº¤ç»™Springå®¹å™¨æ¥æ§åˆ¶ï¼Œè€Œä¸æ˜¯åœ¨å¯¹è±¡å†…éƒ¨æ§åˆ¶</li></ul></li><li><p>å¥½å¤„</p><ul><li>å¯ä»¥æ— ä¾µå…¥çš„è°ƒæ•´å¯¹è±¡çš„å…³ç³»</li><li>åŒæ—¶å¯ä»¥æ— ä¾µå…¥çš„è°ƒæ•´å¯¹è±¡çš„å±æ€§ï¼Œç”šè‡³å®ç°å¯¹è±¡çš„æ›¿æ¢</li></ul></li></ul><h2 id="1-2-å•ä¾‹Beanæ³¨å…¥Prototypeçš„Bean"><a href="#1-2-å•ä¾‹Beanæ³¨å…¥Prototypeçš„Bean" class="headerlink" title="1.2 å•ä¾‹Beanæ³¨å…¥Prototypeçš„Bean"></a>1.2 å•ä¾‹Beanæ³¨å…¥Prototypeçš„Bean</h2><p>Springåˆ›å»ºçš„Beané»˜è®¤æ˜¯å•ä¾‹çš„ï¼Œä½†æ˜¯å½“Beané‡åˆ°ç»§æ‰¿çš„æ—¶å€™ï¼Œæ˜¯ä¼šå¿½ç•¥è¿™ä¸€ç‚¹çš„ã€‚</p><pre><code>@Slf4jpublic abstract class SayService {    List&lt;String&gt; data = new ArrayList&lt;&gt;();    public void say() {        data.add(IntStream.rangeClosed(1, 1000000)                .mapToObj(__ -&gt; &quot;a&quot;)                .collect(Collectors.joining(&quot;&quot;)) + UUID.randomUUID().toString());        log.info(&quot;I&#39;m {} size:{}&quot;, this, data.size());    }}@Service@Slf4jpublic class SayHello extends SayService {    @Override    public void say() {        super.say();        log.info(&quot;hello&quot;);    }}@Service@Slf4jpublic class SayBye extends SayService {    @Override    public void say() {        super.say();        log.info(&quot;bye&quot;);    }}</code></pre><p>ä¸Šè¿°ä»£ç ä¸­ï¼ŒåŸºç±»SayServiceæ˜¯æœ‰çŠ¶æ€çš„ï¼ŒdataListä¸€ç›´åœ¨å¢åŠ ã€‚å½“SayHelloç±»ç»§æ‰¿åŸºç±»ï¼Œå¹¶ä¸”å£°æ˜ä¸ºServiceçš„æ—¶å€™ï¼Œå°†å…¶æ³¨å†Œä¸ºBeanã€‚è¿™æ—¶å€™æœ‰çŠ¶æ€çš„åŸºç±»å°±å¾ˆæœ‰å¯èƒ½é€ æˆå†…å­˜æ³„éœ²æˆ–è€…çº¿ç¨‹å®‰å…¨çš„é—®é¢˜äº†ã€‚</p><p>æ­£ç¡®åšæ³•æ˜¯åœ¨å°†ç±»æ ‡è®°ä¸º<code>@Service</code>å¹¶äº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†ä¹‹å‰ï¼Œéœ€è¦é¦–å…ˆè¯„ä¼°ä¸€ä¸‹ç±»æ˜¯å¦æœ‰çŠ¶æ€ï¼Œç„¶åä¸ºBeanè®¾ç½®åˆé€‚çš„Scopeã€‚</p><pre><code>@Scope(value = ConfigurableBeanFactory.SCOPE_PROTOTYPE, proxyMode = ScopedProxyMode.TARGET_CLASS)</code></pre><p>è®©å…¶ä»¥ä»£ç†çš„æ–¹å¼æ³¨å…¥ï¼Œè¿™æ ·è™½ç„¶controllerè¿˜æ˜¯å•ä¾‹çš„ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½ä»ä»£ç†é‚£é‡Œè·å¾—Serviceï¼Œè¿™æ ·prototypeèŒƒå›´çš„é…ç½®æ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p><h1 id="2-AOP"><a href="#2-AOP" class="headerlink" title="2. AOP"></a>2. AOP</h1><ul><li><p>ä½“ç°äº†æ¾è€¦åˆï¼Œé«˜å†…èš</p></li><li><p>åœ¨åˆ‡é¢é›†ä¸­å®ç°æ¨ªåˆ‡å…³æ³¨ç‚¹</p><ul><li>ç¼“å­˜</li><li>æƒé™</li><li>æ—¥å¿—</li></ul></li><li><p>ç„¶åé€šè¿‡åˆ‡ç‚¹é…ç½®å°†ä»£ç æ³¨å…¥åˆ°åˆé€‚çš„åœ°æ–¹</p></li><li><p>å…³é”®ç‚¹</p><ul><li><p>è¿æ¥ç‚¹ Join Point </p><ul><li>å®ç°AOPçš„åœ°æ–¹</li><li>æ–¹æ³•æ‰§è¡Œ</li></ul></li><li><p>åˆ‡ç‚¹ PointCut</p><ul><li>å‘Šè¯‰ç¨‹åºåœ¨å“ªé‡Œåšåˆ‡å…¥</li><li>Springä¸­é»˜è®¤ä½¿ç”¨AspectJæŸ¥è¯¢è¡¨è¾¾å¼ï¼Œé€šè¿‡åœ¨è¿æ¥ç‚¹è¿è¡ŒæŸ¥è¯¢è¡¨è¾¾å¼æ¥åŒ¹é…åˆ‡å…¥ç‚¹</li></ul></li><li><p>å¢å¼º Advice</p><ul><li>å®šä¹‰äº†åˆ‡å…¥åˆ‡ç‚¹åå¢å¼ºçš„æ–¹å¼<ul><li>å‰</li><li>å</li><li>ç¯ç»•</li></ul></li></ul></li><li><p>åˆ‡é¢ Aspect</p><ul><li>åˆ‡é¢ = åˆ‡ç‚¹ + å¢å¼º </li><li>å®ç°æ•´ä¸ªAOPæ“ä½œ</li></ul></li></ul></li></ul><h2 id="2-1-å®ç°æ•´ä¸ªæ—¥å¿—è®°å½•ï¼Œå¼‚å¸¸å¤„ç†ï¼Œæ–¹æ³•è€—æ—¶çš„ç»Ÿä¸€åˆ‡é¢"><a href="#2-1-å®ç°æ•´ä¸ªæ—¥å¿—è®°å½•ï¼Œå¼‚å¸¸å¤„ç†ï¼Œæ–¹æ³•è€—æ—¶çš„ç»Ÿä¸€åˆ‡é¢" class="headerlink" title="2.1 å®ç°æ•´ä¸ªæ—¥å¿—è®°å½•ï¼Œå¼‚å¸¸å¤„ç†ï¼Œæ–¹æ³•è€—æ—¶çš„ç»Ÿä¸€åˆ‡é¢"></a>2.1 å®ç°æ•´ä¸ªæ—¥å¿—è®°å½•ï¼Œå¼‚å¸¸å¤„ç†ï¼Œæ–¹æ³•è€—æ—¶çš„ç»Ÿä¸€åˆ‡é¢</h2><pre><code>// å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£Metrics @Retention(RetentionPolicy.RUNTIME)@Target({ElementType.METHOD, ElementType.TYPE})public @interface Metrics {    /**     * åœ¨æ–¹æ³•æˆåŠŸæ‰§è¡Œåæ‰“ç‚¹ï¼Œè®°å½•æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´å‘é€åˆ°æŒ‡æ ‡ç³»ç»Ÿï¼Œé»˜è®¤å¼€å¯     *     * @return     */    boolean recordSuccessMetrics() default true;    /**     * åœ¨æ–¹æ³•æˆåŠŸå¤±è´¥åæ‰“ç‚¹ï¼Œè®°å½•æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´å‘é€åˆ°æŒ‡æ ‡ç³»ç»Ÿï¼Œé»˜è®¤å¼€å¯     *     * @return     */    boolean recordFailMetrics() default true;    /**     * é€šè¿‡æ—¥å¿—è®°å½•è¯·æ±‚å‚æ•°ï¼Œé»˜è®¤å¼€å¯     *     * @return     */    boolean logParameters() default true;    /**     * é€šè¿‡æ—¥å¿—è®°å½•æ–¹æ³•è¿”å›å€¼ï¼Œé»˜è®¤å¼€å¯     *     * @return     */    boolean logReturn() default true;    /**     * å‡ºç°å¼‚å¸¸åé€šè¿‡æ—¥å¿—è®°å½•å¼‚å¸¸ä¿¡æ¯ï¼Œé»˜è®¤å¼€å¯     *     * @return     */    boolean logException() default true;    /**     * å‡ºç°å¼‚å¸¸åå¿½ç•¥å¼‚å¸¸è¿”å›é»˜è®¤å€¼ï¼Œé»˜è®¤å…³é—­     *     * @return     */    boolean ignoreException() default false;}</code></pre><pre><code>// å®ç°ä¸€ä¸ªåˆ‡é¢å®ŒæˆMetricsæ³¨è§£æä¾›çš„åŠŸèƒ½@Aspect@Component@Slf4jpublic class MetricsAspect {    @Autowired    private ObjectMapper ObjectMapper;    //å®ç°ä¸€ä¸ªè¿”å›JavaåŸºæœ¬ç±»å‹é»˜è®¤å€¼çš„å·¥å…·ã€‚å…¶å®ï¼Œä½ ä¹Ÿå¯ä»¥é€ä¸€å†™å¾ˆå¤šif-elseåˆ¤æ–­ç±»å‹ï¼Œç„¶åæ‰‹åŠ¨è®¾ç½®å…¶é»˜è®¤å€¼ã€‚    //è¿™é‡Œä¸ºäº†å‡å°‘ä»£ç é‡ç”¨äº†ä¸€ä¸ªå°æŠ€å·§ï¼Œå³é€šè¿‡åˆå§‹åŒ–ä¸€ä¸ªå…·æœ‰1ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œç„¶åé€šè¿‡è·å–è¿™ä¸ªæ•°ç»„çš„å€¼æ¥è·å–åŸºæœ¬ç±»å‹é»˜è®¤å€¼     //Array.newInstance(Class&lt;?&gt; componentType, int length) åˆ›å»ºä¸€ä¸ªæœ‰ç‰¹å®šçš„ç±»çš„ç±»å‹å’Œé•¿åº¦çš„å¯¹è±¡    private static final Map&lt;Class&lt;?&gt;, Object&gt; DEFAULT_VALUES =         Stream.of(boolean.class, byte.class, char.class, double.class, float.class, int.class, long.class, short.class)             .collect(toMap(clazz -&gt; (Class) clazz, clazz -&gt; Array.get(Array.newInstance(clazz, 1), 0)));     public static T getDefaultValue(Class clazz) {         return (T) DEFAULT_VALUES.get(clazz);     }    // å®ç°äº†å¯¹æ ‡è®°äº†Metricsæ³¨è§£çš„æ–¹æ³•è¿›è¡ŒåŒ¹é…    @PointCut(&quot;within(@org.cleilei.commonmistakes.springpart1.aopmetrics.Metrics *)&quot;)    public void withMetricsAnnotation() {    }    // å®ç°äº†åŒ¹é…ç±»å‹ä¸Šæ ‡è®°äº†@RestControlleræ³¨è§£çš„æ–¹æ³•    @PointCut(&quot;within(@org.springframework.web.bind.annotation.RestController *)&quot;)    public void controllerBean() {    }    @Around(&quot;controllerBean() || withMetricsAnnotation()&quot;)    public Object metrics(ProceedingJoinPoint pjp) throws Throwable {        // é€šè¿‡è¿æ¥ç‚¹è·å–æ–¹æ³•ç­¾åå’Œæ–¹æ³•ä¸ŠMetricsçš„æ³¨è§£ï¼Œå¹¶æ ¹æ®æ–¹æ³•ç­¾åç”Ÿæˆæ—¥å¿—ä¸­è¦è¾“å‡ºçš„æ–¹æ³•å®šä¹‰æè¿°        MethodSignature signature = (MethodSignature)pjp.getSignature();        Metrics metrics = signature.getMethod().getAnnotation(Metrics.class);        String name = String.format(&quot;%s %s&quot;, signature.getDeclaringType().toString(), signature.toLongString());        if (metrics == null) {            @Metrics            final class c {}             metrics = c.class.getAnnotation(Metrics.class);        }        // å°è¯•ä»ä¸Šä¸‹æ–‡è·å–è¯·æ±‚çš„URLï¼Œæ¥æ–¹ä¾¿å®šä½é—®é¢˜        RequestAttributes RequestAttributes = RequestContextHolder.getRequestAttributes();        if (requestAttributes != null) {            HttpServletRequest request = ((ServletRequestAttributes) requestAttributes).getRequest();            if (request != null) {                name += String.format(&quot; %s &quot;, request.getRequestURL().toString());            }        }        // è®°å½•å‚æ•°        if (metrics.logParameters()) {            log.info(String.format(&quot;Call method %s with parameters %s&quot;, name. objectMapper.writeValueAsString(pjp.getArgs())));        }        // è®°å½•æ–¹æ³•çš„æ‰§è¡Œï¼Œbreak points, å¼‚å¸¸æ—¶è®°å½•        Object returnValue;        Instant start = Instant.now();        try {            returnValue = pjp.proceed();            if (metrics.recordSuccessMetrics())                //åœ¨ç”Ÿäº§çº§ä»£ç ä¸­ï¼Œæˆ‘ä»¬åº”è€ƒè™‘ä½¿ç”¨ç±»ä¼¼Micrometerçš„æŒ‡æ ‡æ¡†æ¶ï¼ŒæŠŠæ‰“ç‚¹ä¿¡æ¯è®°å½•åˆ°æ—¶é—´åºåˆ—æ•°æ®åº“ä¸­ï¼Œå®ç°é€šè¿‡å›¾è¡¨æ¥æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°å’Œæ‰§è¡Œæ—¶é—´                log.info(String.format(&quot;Call method %s succeedï¼Œtime usedï¼š%d ms&quot;, name, Duration.between(start, Instant.now()).toMillis()));        } catch (Exception ex) {            if (metrics.recordFailMetrics())                log.info(String.format(&quot;Call method %s failï¼Œtime usedï¼š%d ms&quot;, name, Duration.between(start, Instant.now()).toMillis()));            if (metrics.logException())                log.error(String.format(&quot;Call method %s with exceptions&quot;, name), ex);            //å¿½ç•¥å¼‚å¸¸çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸€å¼€å§‹å®šä¹‰çš„getDefaultValueæ–¹æ³•ï¼Œæ¥è·å–åŸºæœ¬ç±»å‹çš„é»˜è®¤å€¼            if (metrics.ignoreException())                returnValue = getDefaultValue(signature.getReturnType());            else                throw ex;        }        //å®ç°äº†è¿”å›å€¼çš„æ—¥å¿—è¾“å‡º        if (metrics.logReturn())            log.info(String.format(&quot;Call method %s with result: %s&quot;, name, returnValue));        return returnValue;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java8 æ—¥æœŸæ—¶é—´ç±»</title>
      <link href="/Java8-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%B1%BB/"/>
      <url>/Java8-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<p>åœ¨Java8ä¹‹å‰ï¼Œå¤„ç†æ—¥æœŸæ—¶é—´éœ€æ±‚çš„æ—¶å€™éœ€è¦ä½¿ç”¨Data, Calendar, SimpleDateFormatæ¥å£°æ˜æ—¶é—´æˆ³ï¼Œä½¿ç”¨æ—¥å†å¤„ç†æ—¥æœŸå’Œæ ¼å¼åŒ–è§£ææ—¥æœŸæ—¶é—´ï¼ŒJava8ä¹‹åæœ‰äº†æ–°çš„æ—¥æœŸæ—¶é—´ç±»ï¼Œå®šä¹‰çš„æ¯”åŸæ¥è¦æ¸…æ™°å¾ˆå¤šï¼Œä¸”æ”¯æŒçº¿ç¨‹å®‰å…¨ã€‚</p><p>è¿™ç¯‡æ–‡ç« çœ‹çœ‹æ—¶é—´é”™ä¹±é—®é¢˜èƒŒåçš„åŸå› ï¼Œçœ‹çœ‹ä½¿ç”¨é—ç•™çš„æ—¥æœŸæ—¶é—´ç±»ï¼Œæ¥å¤„ç†æ—¥æœŸæ—¶é—´åˆå§‹åŒ–ï¼Œæ ¼å¼åŒ–ï¼Œè§£æï¼Œè®¡ç®—ç­‰å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æ–°æ—¥æœŸæ—¶é—´ç±»æ¥è§£å†³ã€‚</p><h1 id="åˆå§‹åŒ–æ—¥æœŸæ—¶é—´"><a href="#åˆå§‹åŒ–æ—¥æœŸæ—¶é—´" class="headerlink" title="åˆå§‹åŒ–æ—¥æœŸæ—¶é—´"></a>åˆå§‹åŒ–æ—¥æœŸæ—¶é—´</h1><h2 id="ä½¿ç”¨Dateåˆå§‹åŒ–æ—¥æœŸæ—¶é—´"><a href="#ä½¿ç”¨Dateåˆå§‹åŒ–æ—¥æœŸæ—¶é—´" class="headerlink" title="ä½¿ç”¨Dateåˆå§‹åŒ–æ—¥æœŸæ—¶é—´"></a>ä½¿ç”¨Dateåˆå§‹åŒ–æ—¥æœŸæ—¶é—´</h2><pre><code>Date date = new Date(2019, 12, 31, 11, 12, 13);System.out.println(date);// Output Sat Jan 31 11:12:13 CST 3920</code></pre><p>è¿™æ˜¯å› ä¸ºDateåˆå§‹åŒ–æ—¶é—´çš„æ—¶å€™æ˜¯ç”¨çš„å’Œ1970çš„å·®å€¼ï¼Œæœˆçš„å€¼æ˜¯ä»0- 11 çš„</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Calendaræ¥å®šä¹‰æ—¶åŒºçš„ä¿¡æ¯ </p><h1 id="æ—¶åŒºé—®é¢˜"><a href="#æ—¶åŒºé—®é¢˜" class="headerlink" title="æ—¶åŒºé—®é¢˜"></a>æ—¶åŒºé—®é¢˜</h1><pre><code>Calendar calendar = Calendar.getInstance();calendar.set(2019, 11, 31, 11, 12, 13);System.out.println(calendar.getTime());Calendar calendar2 = Calendar.getInstance(TimeZone.getTimeZone(&quot;America/New_York&quot;));calendar2.set(2019, Calendar.DECEMBER, 31, 11, 12, 13);System.out.println(calendar2.getTime());</code></pre><ul><li>Dateç±»<ul><li>Dateæœ¬èº«æ²¡æœ‰æ—¶åŒºçš„é—®é¢˜ï¼Œéƒ½æ˜¯ä¿å­˜çš„UTCæ—¶é—´</li><li>Dateå½“ä¸­ä¿å­˜çš„æ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œæ˜¯ä»1970-1-1 0ç‚¹åˆ°ç°åœ¨çš„æ¯«ç§’æ•°</li><li>ä¿å­˜æ–¹æ³•<ul><li>ä»¥UTCä¿å­˜</li><li>ä»¥å­—é¢é‡ä¿å­˜<ul><li>å¹´æœˆæ—¥ æ—¶åˆ†ç§’  æ—¶åŒºä¿¡æ¯</li></ul></li></ul></li></ul></li></ul><ul><li><p>ZoneId </p><ul><li><code>ZoneId.of</code>ç”¨æ¥åˆå§‹åŒ–ä¸€ä¸ªæ ‡å‡†çš„æ—¶åŒº</li><li><code>ZoneOffset.ofHours</code> é€šè¿‡offsetæ¥åˆå§‹åŒ–å…·æœ‰æŒ‡å®šçš„æ—¶é—´å·®çš„æ—¶åŒº</li></ul></li><li><p>LocalDateTime</p><ul><li>ä¸å¸¦æœ‰æ—¶åŒºå±æ€§ï¼Œæ˜¯æœ¬åœ°æ—¶åŒºçš„æ—¥æœŸæ—¶é—´</li></ul></li><li><p>ZonedDateTime </p><ul><li>= LocalDateTime + ZoneId </li></ul></li><li><p>DateTimeFormatter</p><ul><li>å¯ä»¥é€šè¿‡withZoneæ–¹æ³•ç›´æ¥è®¾ç½®éœ€è¦ä½¿ç”¨çš„æ—¶åŒº</li></ul></li><li><p>å› æ­¤å¯¹äºå›½é™…åŒ–æ—¶é—´çš„å¤„ç†ï¼Œåº”å½“ä½¿ç”¨Java8çš„æ—¥æœŸæ—¶é—´ç±»ï¼Œé€šè¿‡ZonedDateTimeæ¥ä¿å­˜æ—¶é—´</p></li></ul><h1 id="æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å’Œè§£æ"><a href="#æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å’Œè§£æ" class="headerlink" title="æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å’Œè§£æ"></a>æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å’Œè§£æ</h1><ul><li>SimpleDateFormatçš„é—®é¢˜<ul><li>æ³¨æ„ä½¿ç”¨SimpleDateFormatçš„æ—¶å€™ï¼Œå¤§å†™çš„YYYYè¡¨ç¤ºçš„æ˜¯week yearï¼Œå³æ‰€åœ¨çš„å‘¨å±äºå“ªä¸€å¹´ï¼Œyyyyè¡¨ç¤ºçš„æ˜¯å¹´</li><li>static çš„SimpleDateFormatå¯èƒ½ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œå…¶è§£æå’Œæ ¼å¼åŒ–æ“ä½œæ˜¯éçº¿ç¨‹å®‰å…¨çš„</li><li>SimpleDateFormatå¯¹äºæ ¼å¼ä¸åŒ¹é…è¡¨ç°çš„éå¸¸å®½å®¹ï¼Œå¯èƒ½ä¼šéšè—ä¸€äº›é”™è¯¯ï¼Œè¦æ³¨æ„æ ¼å¼ä¸Šçš„ä¸åŒ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ–‡ä»¶è¯»å†™Tips</title>
      <link href="/Java%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99Tips/"/>
      <url>/Java%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99Tips/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å­—ç¬¦ç¼–ç é—®é¢˜"><a href="#1-å­—ç¬¦ç¼–ç é—®é¢˜" class="headerlink" title="1. å­—ç¬¦ç¼–ç é—®é¢˜"></a>1. å­—ç¬¦ç¼–ç é—®é¢˜</h1><p>FileReaderæ˜¯ä»¥å½“å‰æœºå™¨çš„é»˜è®¤å­—ç¬¦é›†æ¥è¯»å–æ–‡ä»¶çš„ï¼Œå¦‚æœå¸Œæœ›æŒ‡å®šå­—ç¬¦é›†çš„è¯ï¼Œéœ€è¦ç›´æ¥ä½¿ç”¨InputStreamReaderå’ŒFileInputStream </p><p>å› æ­¤å¯¹äºå­—ç¬¦ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬åº”å½“ä½¿ç”¨FileInputStreamæ¥è¯»å–æ–‡ä»¶æµï¼Œç„¶åä½¿ç”¨InputStreamReaderè¯»å–å­—ç¬¦æµï¼Œå¹¶ä¸”åˆ¶å®šå­—ç¬¦é›†</p><h1 id="2-Filesç±»çš„é™æ€æ–¹æ³•"><a href="#2-Filesç±»çš„é™æ€æ–¹æ³•" class="headerlink" title="2. Filesç±»çš„é™æ€æ–¹æ³•"></a>2. Filesç±»çš„é™æ€æ–¹æ³•</h1><ul><li><p><code>Files.readAllLines</code> </p><ul><li>å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸€è¡Œä»£ç å®Œæˆæ–‡ä»¶å†…å®¹çš„è¯»å–</li><li>ä½†æ˜¯è¯»å–è¶…å‡ºå†…å­˜å¤§å°çš„å¤§æ–‡ä»¶çš„æ—¶å€™ä¼šå‡ºç°OOM<ul><li>æ˜¯å› ä¸ºreadAllLinesè¯»å–æ–‡ä»¶æ‰€æœ‰å†…å®¹ä¹‹åä¼šæ”¾åˆ°ä¸€ä¸ªList<String>å½“ä¸­è¿”å›ï¼Œå¦‚æœå†…å­˜æ— æ³•å®¹çº³è¿™ä¸ªListï¼Œå°±ä¼šOOM </li></ul></li></ul></li><li><p><code>Files.lines</code></p><ul><li>è¿”å›çš„æ˜¯Stream<String></li><li>ä½¿å¾—æˆ‘ä»¬åœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥ä¸æ–­è¯»å–ï¼Œä½¿ç”¨æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§çš„æŠŠæ‰€æœ‰å†…å®¹éƒ½è¯»å–åˆ°å†…å­˜å½“ä¸­ï¼Œå› æ­¤é¿å…äº†OOM</li></ul></li><li><p>å¯¹äºè¿”å›æ˜¯Streamçš„æ–¹æ³•è¦æ³¨æ„å…³é—­å¥æŸ„ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨try with resources çš„æ–¹å¼æ¥ç¡®ä¿æµçš„closeæ–¹æ³•å¯ä»¥è°ƒç”¨é‡Šæ”¾èµ„æº</p></li></ul><pre><code>LongAdder longAdder = new LongAdder();IntStream.rangeClosed(1, 1000000).forEach(i -&gt; {    try (Stream&lt;String&gt; lines = Files.lines(Paths.get(&quot;demo.txt&quot;))) {        lines.forEach(line -&gt; longAdder.increment());    } catch (IOException e) {        e.printStackTrace();    }});log.info(&quot;total : {}&quot;, longAdder.longValue());</code></pre><h1 id="3-è¯»å†™æ–‡ä»¶çš„ç¼“å†²åŒºè®¾ç½®"><a href="#3-è¯»å†™æ–‡ä»¶çš„ç¼“å†²åŒºè®¾ç½®" class="headerlink" title="3. è¯»å†™æ–‡ä»¶çš„ç¼“å†²åŒºè®¾ç½®"></a>3. è¯»å†™æ–‡ä»¶çš„ç¼“å†²åŒºè®¾ç½®</h1><h2 id="3-1-ä¸ºä»€ä¹ˆæ‰§è¡Œç¼“æ…¢ï¼Ÿ"><a href="#3-1-ä¸ºä»€ä¹ˆæ‰§è¡Œç¼“æ…¢ï¼Ÿ" class="headerlink" title="3.1 ä¸ºä»€ä¹ˆæ‰§è¡Œç¼“æ…¢ï¼Ÿ"></a>3.1 ä¸ºä»€ä¹ˆæ‰§è¡Œç¼“æ…¢ï¼Ÿ</h2><pre><code>private static void perByteOperation() throws IOException {    try (FileInputStream fileInputStream = new FileInputStream(&quot;src.txt&quot;);         FileOutputStream fileOutputStream = new FileOutputStream(&quot;dest.txt&quot;)) {        int i;        while ((i = fileInputStream.read()) != -1) {            fileOutputStream.write(i);        }    }}</code></pre><ul><li>ä¸Šè¿°ä»£ç è¿è¡Œèµ·æ¥åŠŸèƒ½ä¸Šå®Œå…¨æ²¡æœ‰é—®é¢˜<ul><li>ä½†æ˜¯ä¼šéå¸¸ç¼“æ…¢</li><li>åŸå› æ˜¯æ¯è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œæ¯å†™å…¥ä¸€ä¸ªå­—èŠ‚å°±è¿›è¡Œä¸€æ¬¡IOæ“ä½œï¼Œä»£ä»·å¤ªå¤§äº†</li><li>è§£å†³æ–¹æ¡ˆæ˜¯å¯ä»¥ä½¿ç”¨ç¼“å†²åŒºä½œä¸ºè¿‡æ¸¡ï¼Œä¸€æ¬¡æ€§ä»åŸæ–‡ä»¶å½“ä¸­è¯»å–ä¸€å®šæ•°é‡çš„æ•°æ®åˆ°ç¼“å†²åŒºå½“ä¸­ï¼Œä¸€æ¬¡æ€§å†™å…¥ä¸€å®šæ•°é‡çš„æ•°æ®åˆ°ç›®æ ‡æ–‡ä»¶</li></ul></li></ul><pre><code>private static void bufferOperationWith100Buffer() throws IOException {    try (FileInputStream fileInputStream = new FileInputStream(&quot;src.txt&quot;);         FileOutputStream fileOutputStream = new FileOutputStream(&quot;dest.txt&quot;)) {        byte[] buffer = new byte[100];        int len = 0;        while ((len = fileInputStream.read(buffer)) != -1) {            fileOutputStream.write(buffer, 0, len);        }    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯è¯·æ±‚çš„timeoutè®¾ç½®</title>
      <link href="/%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82%E7%9A%84timeout%E8%AE%BE%E7%BD%AE/"/>
      <url>/%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82%E7%9A%84timeout%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬å‘å‡ºä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯æ²¡æœ‰åšè¶…æ—¶è®¾ç½®ï¼Œä¸€ä¸ªéšå«çš„å‡è®¾æ˜¯æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸€å®šä¼šæˆåŠŸã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ— æ³•åšå‡ºè¯·æ±‚ä¸€å®šä¼šæˆåŠŸçš„ä¿è¯çš„ã€‚</p><ul><li>å½“ä½ å‘å‡ºçš„åŒæ­¥è¯·æ±‚ä»æ²¡æœ‰è¿”å›çš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šä¸€ç›´è¢«å ç”¨çš„</li><li>å¼‚æ­¥è¯·æ±‚æœªè¿”å›çš„çº¿ç¨‹ä¹Ÿæ— æ³•ç»§ç»­å¤ç”¨ï¼Œå› ä¸ºsocketsä¼šæœ‰æ³„éœ²ï¼Œsocketæ± çš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œæœªè¿”å›ç»“æœçš„çº¿ç¨‹ä¼šä¸€ç›´å¼€ç€è¿æ¥ï¼Œæœ€ç»ˆå¯èƒ½ä¼šå¯¼è‡´è¿æ¥çš„çŸ­ç¼º</li></ul><p>å› æ­¤best practiceåº”å½“æ˜¯å¯¹äºajaxè¯·æ±‚ï¼Œåšå¥½timeoutçš„è®¾ç½®ï¼Œå› ä¸ºXMLHttpRequestçš„é»˜è®¤timeoutæ˜¯0ï¼Œå³æ²¡æœ‰è¶…æ—¶è®¾ç½®ã€‚</p><p>Clientç«¯çš„timeoutè®¾ç½®å’Œserverç«¯ä¸€æ ·é‡è¦ï¼Œæµè§ˆå™¨å¯ä»¥å¼€çš„socketçš„æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œæˆ‘ä»¬åº”è¯¥é€šè¿‡è®¾ç½®timeoutæ¥å……åˆ†åˆ©ç”¨socket poolã€‚Fetch APIæ˜¯å½“å‰æ¯”è¾ƒæµè¡Œçš„XMLHttpRequest APIçš„æ›¿ä»£å“ï¼Œç„¶è€Œç°åœ¨è¿˜æ²¡æœ‰ä¸€ä¸ªç›´æ¥çš„è®¾ç½®timeoutçš„æ–¹æ³•ï¼Œæœ€è¿‘åˆšåˆšæ¨å‡ºäº†abort APIï¼Œå¯ä»¥ç”¨æ¥æ”¯æŒtimeoutã€‚</p><p>ç”¨æ³•æ¯”å¦‚ï¼š </p><pre><code>const controller = new AbortController();const signal = controller.signal;const fetchPromise = fetch(url, {signal});  // No timeout by default!setTimeout(() =&gt; controller.abort(), 10000); </code></pre><p>è€Œå¯¹äºJqueryçš„ajax callï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š </p><pre><code>$.ajax({    url: &quot;test.html&quot;,    error: function(){        // will fire when timeout is reached    },    success: function(){        //do something    },    timeout: 3000 // sets timeout to 3 seconds});</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://robertovitillo.com/default-timeouts/" target="_blank" rel="noopener">https://robertovitillo.com/default-timeouts/</a> </p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ—¥å¿—è®°å½•Tips</title>
      <link href="/Java%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95Tips/"/>
      <url>/Java%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95Tips/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨Javaæ¥è®°å½•æ—¥å¿—æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹çš„</p><ul><li>é¦–å…ˆæ—¥å¿—æ¡†æ¶å¾ˆå¤šï¼Œä¸åŒçš„ç±»åº“æœ‰å¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„æ—¥å¿—æ¡†æ¶ï¼Œå¦‚ä½•å…¼å®¹æ˜¯ä¸€ä¸ªé—®é¢˜</li><li>é…ç½®æ–‡ä»¶çš„å¤æ‚æ€§</li></ul><p>Javaä½“ç³»çš„æ—¥å¿—æ¡†æ¶æœ‰ï¼š</p><ul><li>Logback</li><li>Log4j</li><li>Log4j2</li><li>commons-logging </li><li>JDK è‡ªå¸¦çš„Java.util.logging</li></ul><p>å¦‚æœä¸åŒçš„åŒ…ä½¿ç”¨ä¸åŒçš„æ—¥å¿—æ¡†æ¶çš„è¯ï¼Œé‚£ç®¡ç†å°±ä¼šå˜å¾—éå¸¸éº»çƒ¦ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±æœ‰äº†SLF4J â€“ Simple Logging Facade For Java </p><ul><li>æä¾›äº†ç»Ÿä¸€çš„æ—¥å¿—é—¨é¢APIï¼Œå®ç°äº†ä¸­ç«‹çš„æ—¥å¿—è®°å½•API</li><li>æ¡¥æ¥åŠŸèƒ½<ul><li>å¯ä»¥å°†å„ç§æ—¥å¿—æ¡†æ¶çš„APIæ¡¥æ¥åˆ°SLF4J APIä¸Šã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä¾¿ä½ çš„ç¨‹åºè¯•ç”¨äº†å„ç§æ—¥å¿—APIè®°å½•æ—¥å¿—ï¼Œæœ€ç»ˆéƒ½å¯ä»¥æ¡¥æ¥åˆ°Slf4jé—¨é¢APIä¸Š</li></ul></li><li>é€‚é…åŠŸèƒ½<ul><li>å®ç°slf4jå’Œå®é™…æ—¥å¿—æ¡†æ¶çš„ç»‘å®š</li><li>slf4jçŸ¥è¯†æ—¥å¿—æ ‡å‡†ï¼Œè¿˜æ˜¯éœ€è¦ä¸€ä¸ªå®é™…çš„æ—¥å¿—æ¡†æ¶</li></ul></li></ul><p>ä¸‹é¢ä¸€èµ·æ¢³ç†ä¸‹å¸¸è§çš„æ—¥å¿—è®°å½•ä¸­çš„é”™è¯¯</p><h1 id="1-ç†è§£Logbacké…ç½®ï¼Œé¿å…é‡å¤è®°å½•"><a href="#1-ç†è§£Logbacké…ç½®ï¼Œé¿å…é‡å¤è®°å½•" class="headerlink" title="1. ç†è§£Logbacké…ç½®ï¼Œé¿å…é‡å¤è®°å½•"></a>1. ç†è§£Logbacké…ç½®ï¼Œé¿å…é‡å¤è®°å½•</h1><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;configuration&gt;    &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;        &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;            &lt;pattern&gt;[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%thread] [%-5level] [%logger{40}:%line] - %msg%n&lt;/pattern&gt;        &lt;/layout&gt;    &lt;/appender&gt;    &lt;logger name=&quot;org.geekbang.time.commonmistakes.logging&quot; level=&quot;DEBUG&quot;&gt;        &lt;appender-ref ref=&quot;CONSOLE&quot;/&gt;    &lt;/logger&gt;    &lt;root level=&quot;INFO&quot;&gt;        &lt;appender-ref ref=&quot;CONSOLE&quot;/&gt;    &lt;/root&gt;&lt;/configuration&gt;</code></pre><p>è¦æ³¨æ„åœ¨ä½¿ç”¨appenderçš„æ—¶å€™ï¼Œappenderæ˜¯å¦‚ä½•æŒ‚è½½çš„ï¼Œä¸Šè¿°ä»£ç å°†appenderæŒ‚è½½åœ¨äº†ä¸¤ä¸ªä¸åŒçš„åœ°æ–¹ï¼Œè€Œä¸”ä¸¤ä¸ªéƒ½å®šä¹‰åœ¨äº†rootä¸‹ï¼Œæ‰€ä»¥ä¼šé€ æˆé‡å¤ã€‚ </p><p>å¯¹äºéœ€è¦å°†ä¸åŒçš„æ—¥å¿—æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶çš„åº”ç”¨åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®Loggerçš„additivityå±æ€§æ¥å®ç°è¿™ä¸ªæ“ä½œ</p><pre><code> &lt;logger name=&quot;org.geekbang.time.commonmistakes.logging&quot; level=&quot;DEBUG&quot; additivity=&quot;false&quot;&gt;            &lt;appender-ref ref=&quot;FILE&quot;/&gt;     &lt;/logger&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šç½‘æ˜“ä¸€åƒé›¶ä¸€å¤œã€‹è¯»ä¹¦ç¬”è®°</title>
      <link href="/%E3%80%8A%E7%BD%91%E6%98%93%E4%B8%80%E5%8D%83%E9%9B%B6%E4%B8%80%E5%A4%9C%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
      <url>/%E3%80%8A%E7%BD%91%E6%98%93%E4%B8%80%E5%8D%83%E9%9B%B6%E4%B8%80%E5%A4%9C%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="0-ä¸ºä»€ä¹ˆå¼€å§‹çœ‹è¿™æœ¬ä¹¦ï¼Ÿ"><a href="#0-ä¸ºä»€ä¹ˆå¼€å§‹çœ‹è¿™æœ¬ä¹¦ï¼Ÿ" class="headerlink" title="0. ä¸ºä»€ä¹ˆå¼€å§‹çœ‹è¿™æœ¬ä¹¦ï¼Ÿ"></a>0. ä¸ºä»€ä¹ˆå¼€å§‹çœ‹è¿™æœ¬ä¹¦ï¼Ÿ</h1><p>æ¥åˆ°äº†è®©äººå…´å¥‹çš„é¡¹ç›®ï¼Œå°æŒ¯å¥‹ï¼Œç„¶åçªç„¶æ„è¯†åˆ°é¡¹ç›®çš„å¤æ‚ç¨‹åº¦ï¼Œéœ€è¦æ¶‰åŠçš„æ–¹æ–¹é¢é¢å¯èƒ½å·²ç»è¶…è¿‡äº†æˆ‘èƒ½å¤Ÿå¤„ç†çš„èƒ½åŠ›èŒƒç•´ï¼Œæ‰€ä»¥éœ€è¦è¡¥è¯¾äº†â€¦</p><p>çœ‹äº†å¾ˆå¤šçŸ¥ä¹çš„ç­”æ¡ˆå•Šï¼Œçœ‹ç€çœ‹ç€æ„è¯†åˆ°å½“è‡ªå·±åœ¨åŠªåŠ›å¯»æ‰¾æ²‰æ·€ä¸‹æ¥çš„ç»è¿‡æ€è€ƒçš„å•é¢†åŸŸçš„å†…å®¹çš„æ—¶å€™ï¼Œä»çŸ¥ä¹æˆ–è€…å…¶ä»–å¿«èŠ‚å¥çš„å¹³å°æ‰¾å€’æ˜¯çœŸçš„æœ‰ç‚¹èˆæœ¬é€æœ«å“ã€‚é¡¹ç›®ç®¡ç†è¿˜æ˜¯æœ‰å¾ˆå¤šæ ¸å¿ƒç†å¿µæ˜¯å¯ä»¥ä¹Ÿå·²ç»æ²‰æ·€ä¸‹æ¥çš„ï¼Œæ‰€ä»¥å°±å¼€å§‹äº†æ‰¾ä¹¦çœ‹ï¼Œå¯¹ç…§ç€è‡ªå·±ç°åœ¨çš„å¢ƒå†µï¼Œä¸€ç‚¹ç‚¹è§£å†³çš„çŠ¶æ€ã€‚</p><p>å¦å¤–è¸©çš„ä¸€ä¸ªå°å‘æ˜¯å¤ªè¿½æ±‚ä¼˜è´¨çš„å·¥å…·ï¼Œå³ç–¯ç‹‚æ¯”è¾ƒå„ç§ç®¡ç†è®°å½•çš„è½¯ä»¶ï¼Œæ¯”è¾ƒomniplan vs xxx vs blablabla, çå€’è…¾äº†å¥½ä¸€é¡¿æ‰æ„è¯†åˆ°å¯¹äºä¸€ä¸ªä¸æ‡‚é¡¹ç›®ç®¡ç†çš„æˆ‘æ¥è¯´ï¼Œå€’è…¾å“ªä¸ªéƒ½æ˜¯ç™½çã€‚ä¸€å®šä¼šæŒ‰ç…§å®Œå…¨ä¸æ˜¯è½¯ä»¶æœ¬èº«è®¾å®šçš„æ–¹å¼ï¼Œæ¥ä½¿ç”¨å®ƒï¼Œåº”è¯¥è¯´æ˜¯å®Œå…¨è§£å†³ä¸äº†é—®é¢˜ã€‚</p><p>æ‰€ä»¥è¿˜æ˜¯è¸è¸å®å®çš„å¸¦ç€æ•¬ç•æ„Ÿçš„ä»ä¸€æœ¬ä¸å¤ªå­¦æœ¯çš„ä¹¦å¼€å§‹ï¼Œä»äº’è”ç½‘å…¬å¸ â€“ ç½‘æ˜“çš„äº§å“ç»ç†çš„è§†è§’ï¼Œæ¥çœ‹çœ‹æ€ä¹ˆåšé¡¹ç›®ç®¡ç†ï¼Œæ€ä¹ˆè·Ÿè¿›é¡¹ç›®çš„è¿›ç¨‹ï¼Œå¦‚ä½•åº”å¯¹å„ç§è¿‡ç¨‹ä¸­çš„è®¾è®¡å˜åŒ–ï¼Œå¦‚ä½•åšå„ç§å–èˆã€‚</p><h1 id="1-é¡¹ç›®ç®¡ç†Overview"><a href="#1-é¡¹ç›®ç®¡ç†Overview" class="headerlink" title="1. é¡¹ç›®ç®¡ç†Overview"></a>1. é¡¹ç›®ç®¡ç†Overview</h1><h2 id="1-1-High-Levelçš„å»ºè®®"><a href="#1-1-High-Levelçš„å»ºè®®" class="headerlink" title="1.1 High Levelçš„å»ºè®®"></a>1.1 High Levelçš„å»ºè®®</h2><ul><li><p>é¡¹ç›®åˆ°åº•éœ€è¦ä»€ä¹ˆ</p><ul><li>æ¥æ‰‹ä¸€ä¸ªé¡¹ç›®ä¹‹å‰ï¼Œåº”å½“ä¸é¡¹ç›®çš„é‡è¦å¹²ç³»äººåŠ å¼ºæ²Ÿé€šï¼Œç†è§£å‰å› åæœ<ul><li>å¯¹äºæŠ€æœ¯é¡¹ç›®ï¼Œç†è§£æ•´ä¸ªå¤§è‡´æŠ€æœ¯å®ç°çš„æ€è·¯ï¼Œå…¶ä¸­çš„ç—›ç‚¹éš¾ç‚¹ï¼Œæ½œåœ¨çš„ä¸ç¡®å®šå› ç´ <ul><li>æ¯”å¦‚è·¨ç»„çš„åˆä½œ</li></ul></li></ul></li><li>è€Œåï¼Œç†è§£é¡¹ç›®åˆ°åº•éœ€è¦ä»€ä¹ˆ<ul><li>æ—¶é—´æˆæœ¬è´¨é‡è¦ç´ çš„æƒè¡¡ä¸å–èˆ<ul><li>èŒƒå›´</li><li>æ—¶é—´</li><li>æˆæœ¬å’Œè´¨é‡</li></ul></li><li>å„ä¸ªè§’è‰²ç›®å‰çš„ç—›ç‚¹</li></ul></li><li>å¤§å®¶å¯¹é¡¹ç›®ç®¡ç†çš„è®¤çŸ¥å’Œæ¥å—åº¦<ul><li>é€šè¿‡æ€æ ·çš„é€”å¾„ï¼Œæ˜¯å…¨é¢æ¨è¿›ï¼Œè¿˜æ˜¯æ­¥æ­¥æ”¹å–„ï¼Ÿ </li><li>ä»å“ªä¸€ä¸ªè§’åº¦åˆ‡å…¥ï¼Ÿ </li><li>è“å›¾æ˜¯å¦æ¸…æ™°ï¼Ÿ</li><li>æ˜¯å¦ä¸é¡¹ç›®è´Ÿè´£äººæ²Ÿé€šåˆ°ä½å¹¶ä¸”è¾¾æˆä¸€è‡´ï¼Ÿ </li></ul></li></ul></li><li><p>ä¸è¦å‡¡äº‹äº‹å¿…èº¬äº²</p><ul><li>æ›¿åˆ«äººå¾…åŠä»–ä»¬æœ¬è¯¥åšçš„äº‹æƒ…ï¼Œå¯¹äºå›¢é˜Ÿæ¥è¯´åè€Œæ•ˆç‡æœ€ä½</li><li>éœ€è¦åŠªåŠ›è®©åˆ«äººèƒ½å¤Ÿåšå¥½è¿™ä»¶äº‹æƒ…<ul><li>Awareness<ul><li>ä½¿å¾—å›¢é˜Ÿæˆå‘˜çŸ¥é“éœ€è¦åšä»€ä¹ˆ </li></ul></li><li>Desire<ul><li>éœ€è¦ç»™äºˆæŸæ–¹é¢çš„åŠ¨èƒ½<ul><li>æŠ€æœ¯æŒ‘æˆ˜ç¨‹åº¦ï¼Ÿ</li><li>é¡¹ç›®å®Œæˆä»¥åçš„å½±å“åŠ›ï¼Ÿ </li><li>å‡èŒåŠ è–ªï¼Ÿ </li></ul></li></ul></li><li>Ability <ul><li>ç¡®ä¿å…¶æœ‰è¶³å¤Ÿçš„èƒ½åŠ›æ¥åšå¥½è¿™ä»¶äº‹æƒ…<ul><li>åˆæœŸçš„è¾…åŠ©</li><li>å¿…è¦çš„åŸ¹è®­ç­‰</li></ul></li></ul></li></ul></li></ul></li></ul><ul><li><p>ä¸è¦è¿½åœ¨åˆ«äººå±è‚¡åé¢åšç›‘å·¥</p><ul><li>é¡¹ç›®ç»å†ä¸æ˜¯ç›‘ç£äº‹æƒ…åšå¾—æ€ä¹ˆæ ·çš„äºº</li><li>ä»–æ˜¯åº”è¯¥å’Œå¤§å®¶ä¸€èµ·å°†æ•´ä¸ªäº‹æƒ…ç¯èŠ‚æ‹é¡ºçš„äººï¼Œéœ€è¦å»ºè®®<u><strong>ä¸€å¥—å¯¹åº”çš„æµç¨‹è§„åˆ™</strong></u>ï¼Œæ˜ç¡®å„ä¸ªè§’è‰²åœ¨è¿‡ç¨‹ä¸­çš„èŒè´£</li><li>è·å¾—è®¤åŒï¼Œä½¿å¾—è¿™ä¸ªæœºåˆ¶è‡ªè¡Œè¿è½¬èµ·æ¥</li><li>åŠªåŠ›åšåˆ°æ˜¯<strong>è§„åˆ™åœ¨çº¦æŸå¤§å®¶çš„è¡Œä¸º</strong>ï¼Œè€Œä¸æ˜¯é äººçœ‹ç€æ¥åš</li></ul></li><li><p>è¨€å¿…ä¿¡ï¼Œè¡Œå¿…æœ</p><ul><li><p>æ— æƒåŠ›ä¸‹çš„é¢†å¯¼åŠ› â€“ leadership without authority </p><ul><li>åœ¨å¼±çŸ©é˜µç»“æ„ä¸‹é¡¹ç›®ç»å†å¿…ä¿®è¯¾</li></ul></li><li><p>éœ€è¦æ„å»ºèµ·å›¢é˜Ÿå¯¹ä½ çš„ä¿¡ä»»ï¼Œå»ºç«‹è‡ªå·±çš„å¯ä¿¡åº¦ï¼Œæ‰“é€ ä¸ªäººå“ç‰Œ</p></li><li><p>ä¿¡ä»»çš„è·å–éœ€è¦ä¸€ç‚¹ä¸€æ»´çš„ç§¯ç´¯äº†</p></li><li><p>ä¸“ä¸šåº¦ä¸Š</p><ul><li>ç¡®å®šè‡ªå·±è¶³å¤Ÿä¸“ä¸š</li><li>è‡³å°‘ç›¸å¯¹æ›´ä¸“ä¸š</li></ul></li><li><p>è·Ÿè¿›</p><ul><li>ä¼šè®®ï¼Œå‘å¸ƒï¼Œé‚®ä»¶ï¼Œæ‰¿è¯º</li></ul></li></ul></li><li><p>å¤„ç†äº‰ç«¯</p><ul><li>ä¸äººä¸€èµ·è§£å†³é—®é¢˜ï¼Œä¼šå› ä¸ºä¸åŒçš„å¯¹äºäº‹æƒ…çš„çœ‹æ³•äº§ç”Ÿå¾ˆå¤šäº‰è®º</li><li>éœ€è¦æ‰¾å‡ºä¸€è‡´çš„åœ°æ–¹å¹¶ä¸”åŠªåŠ›æ”¾å¤§</li></ul></li></ul><h2 id="1-2-å…³äºæ—¶é—´ä¼°ç®—"><a href="#1-2-å…³äºæ—¶é—´ä¼°ç®—" class="headerlink" title="1.2 å…³äºæ—¶é—´ä¼°ç®—"></a>1.2 å…³äºæ—¶é—´ä¼°ç®—</h2><ul><li><p>æœ‰æ²¡æœ‰å¿…è¦è¿›è¡Œæ—¶é—´ä¼°ç®—ä»¥åŠè¿›è¡Œåˆ°ä»€ä¹ˆç¨‹åº¦çš„æ—¶é—´ä¼°ç®—ï¼Ÿ</p><ul><li><p>ç°çŠ¶</p><ul><li>ç”¨äº†å¾ˆå¤šæ—¶é—´ï¼Œä½†æ˜¯æœ€ç»ˆçš„å®é™…ä½¿ç”¨æ—¶é—´å¾€å¾€å’Œä¼°ç®—çš„æœ‰ä¸å°çš„åå·®</li></ul></li><li><p>æˆ¿å­ä»å‡Œä¹±åˆ°æ•´æ´éœ€è¦20%çš„åŠªåŠ›ï¼Œä»æ•´æ´åˆ°ä¸€å°˜ä¸æŸ“å¯èƒ½éœ€è¦80%</p><ul><li>æœ‰ä¼°ç®—å®é™…ä¸Šæ˜¯å®Œæˆäº†ç›¸å¯¹æ€§ä»·æ¯”æ¯”è¾ƒé«˜çš„ä¸€æ®µ</li></ul></li><li><p>ä¼°ç®—å¯ä»¥ç»™ä¸€ä¸ªç›¸å¯¹åˆç†çš„è®¡åˆ’ï¼Œä½¿å¾—ç”¨æˆ·ï¼Œç®¡ç†å±‚å’Œå›¢é˜Ÿéƒ½æœ‰ä¸€ä¸ªç¨³å®šçš„é¢„æœŸ</p></li></ul></li></ul><ul><li><p>ä¼°ç®—å•ä½</p><ul><li><p>ç†æƒ³äººæ—¥</p><ul><li>æŒ‡æˆå‘˜åœ¨ä¸å—å¹²æ‰°çš„æƒ…å†µä¸‹ï¼Œå…¨éƒ¨æ—¶é—´ç”¨æ¥å¼€å‘éœ€æ±‚æ‰€éœ€çš„å¤©æ•°</li><li>åŠ£åŠ¿<ul><li>äººçš„ä¸åŒä¼šå¯¼è‡´æ•´ä¸ªä¼°ç®—çš„ä¸åŒ</li><li>è¿™æ ·çš„å·®å¼‚ä¼šå¯¼è‡´æˆ‘ä»¬é˜Ÿä»»åŠ¡è§„æ¨¡è®¤è¯†çš„åå·®ï¼Œå¾ˆéš¾è¡¡é‡é¡¹ç›®çš„å®é™…å¤§å°</li></ul></li></ul></li><li><p>ç†æƒ³äººæ—¶</p><ul><li>å¯¹åº”ç†æƒ³äººæ—¥è€Œå­˜åœ¨</li><li>åœ¨å……åˆ†ç†è§£éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œèƒ½å¸®åŠ©å›¢é˜Ÿåšåˆ°æ›´é è¿‘çœŸå®å€¼çš„ä¼°ç®—</li></ul></li><li><p>æ•…äº‹ç‚¹</p><ul><li><p>å¯¹ä»»åŠ¡è§„æ¨¡çš„ä¼°è®¡ï¼Œæ˜¯ä¸€ç§ç›¸å¯¹çš„æ¦‚å¿µ</p></li><li><p>ä¼˜åŠ¿</p><ul><li>åŸºäºæ•…äº‹ç‚¹çš„ä¼°ç®—ä¸ä¼šå› ä¸ºå¼€å‘äººå‘˜çš„å˜æ›´ï¼Œæ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜</li></ul></li><li><p>åŠ£åŠ¿</p><ul><li>éš¾ä»¥æ‰¾åˆ°åˆé€‚çš„ä¼°ç®—å•ä½</li></ul></li></ul></li></ul></li><li><p>ä¼°ç®—çš„æ–¹å¼</p><ul><li><p>è‡ªä¸‹è€Œä¸Šçš„ä¼°ç®—</p><ul><li><p>æ¯ä¸ªå¼€å‘äººå‘˜ä¼°ç®—è‡ªå·±çš„ä»»åŠ¡æ—¶é—´ï¼Œç„¶åå°†æ‰€æœ‰çš„ä»»åŠ¡æ±‡æ€»</p></li><li><p>å›¢é˜Ÿç‰¹å¾</p><ul><li>æˆå‘˜é—´ä¸šåŠ¡ç‹¬ç«‹æ€§å¼º</li><li>ç›¸äº’ä¹‹é—´ä¸šåŠ¡ç†Ÿæ‚‰åº¦ä¸é«˜ï¼Œç†Ÿæ‚‰æˆæœ¬é«˜</li><li>å„æˆå‘˜ç›¸å¯¹ç»éªŒæ¯”è¾ƒä¸°å¯Œ</li></ul></li><li><p>ä¼˜åŠ¿</p><ul><li>ä¼°ç®—æ•ˆç‡é«˜</li><li>å‡†ç¡®åº¦ä¹Ÿä¼šæ¯”è¾ƒé«˜</li></ul></li></ul></li><li><p>ä¸“å®¶åˆ¤æ–­</p><ul><li>ä¸“å®¶æ ¹æ®å“åº”å¼€å‘çš„æƒ…å†µç»™å‡ºä»»åŠ¡çš„ä¼°ç®—å€¼</li></ul></li><li><p>æ‰‘å…‹ä¼°ç®—</p><ul><li><p>æµç¨‹</p><ul><li>æ¯ä¸ªä¼°è®¡è€…éƒ½ä¼šåˆ†åˆ°ä¸€å æ‰‘å…‹ç‰Œï¼Œæ¯å¼ ä¸Šæœ‰ä¸€ä¸ªæ•°å€¼</li><li>ç”±è´Ÿè´£äººå¯¹æŸä¸ªéœ€æ±‚è¿›è¡Œä¼°ç®—çš„éœ€æ±‚æˆ–è€…ä»»åŠ¡è¿›è¡Œè®²è§£</li><li>è®²è§£åï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥å‘è¯¥è´Ÿè´£äººæé—®å…³äºè¯¥æ¡éœ€æ±‚æˆ–è€…ä»»åŠ¡çš„é—®é¢˜ï¼Œç›´è‡³è¶³å¤Ÿäº†è§£</li><li>ç„¶åæ‰€æœ‰æˆå‘˜æŒ‘é€‰ä¸€å¼ æ‰‘å…‹ç‰Œä»£è¡¨è‡ªå·±å¯¹è¯¥æ¡ç›®çš„ä¼°ç®—</li><li>å¦‚æœå·®å€¼æ¯”è¾ƒå¤§ï¼Œå°±éœ€è¦äººå‘˜è¯´æ˜å„è‡ªç»™å‡ºè¿™ä¸ªä¼°å€¼çš„ç†ç”±ï¼Œç„¶åå†è¿›è¡Œä¸‹ä¸€è½®çš„ä¼°ç®—</li><li>æœ€åå–å¹³å‡å€¼</li></ul></li><li><p>ä¼˜åŠ¿</p><ul><li>å¤šæˆå‘˜ä¸€ä»¶ï¼Œæ›´å®¢è§‚</li><li>ä¼°ç®—è¿‡ç¨‹ä¸­ï¼Œå¼ºåŒ–äº†å¤§å®¶å¯¹äºéœ€æ±‚å’Œä»»åŠ¡çš„ç†è§£ï¼Œå°†ä»»åŠ¡è€ƒè™‘å¾—æ›´åŠ ç»†è‡´ï¼Œé™ä½äº†ä¸ç¡®å®šæ€§ç»™è®¡åˆ’å¸¦æ¥çš„å†²å‡»</li><li>ä½¿å¾—ç›¸å¯¹ä¸¥è‚ƒçš„è®¡åˆ’å’Œä¼°ç®—å˜å¾—æ›´åŠ æœ‰è¶£ï¼Œä½†æ˜¯ä¼šèŠ±è´¹æ›´å¤šçš„æ—¶é—´æˆæœ¬</li><li>éœ€æ±‚æ¢ç´¢çš„ä¼šæ›´åŠ æ·±å…¥ï¼Œä¼°ç®—ä¹Ÿä¼šæ›´åŠ å…¨é¢ç»†è‡´</li><li>è®©æ½œåœ¨çš„å†²çªå…¬å¼€åŒ–ï¼Œå°é¢åŒ–ï¼Œè®©å¤§å®¶å»å……åˆ†ç¢°æ’ï¼Œç„¶åç”¨ä¸€ç§è¿‘ä¼¼æ¸¸æˆåŒ–çš„æ–¹å¼å†å»åŒ–è§£æ‰</li></ul></li></ul></li></ul></li><li><p>ä¼°ç®—çš„æ³¨æ„äº‹é¡¹</p><ul><li>ä¼°ç®—ä»…ä»…æ˜¯é¢„æµ‹ï¼Œå½“å¯¹å¤–æ‰¿è¯ºé¡¹ç›®å®Œæˆæ—¶é—´çš„æ—¶å€™ï¼Œæœ€å¥½æä¾›ä¸€ä¸ªæ—¥æœŸèŒƒå›´ï¼Œè®©å¬è€…çŸ¥é“ä½ çš„ä¼°ç®—åªæ˜¯é¢„æµ‹</li><li>å°†ä»»åŠ¡åˆ†æˆæ›´ç»†çš„ç²’åº¦æ˜¯ä¼šæœ‰åˆ©äºä¼°ç®—çš„</li><li>å›¢é˜Ÿéœ€è¦ç»ƒä¹ ä¼°ç®—æ–¹å¼å¹¶ä¸”æ”¶é›†åé¦ˆï¼Œæœ‰è¿­ä»£ï¼Œæœ‰è¿‡å»çš„æ•°æ®ï¼Œå°±å¯ä»¥åšåˆ†æï¼Œæ¥è¿›è¡Œä¼˜åŒ–</li><li>ä¼°ç®—éœ€è¦è¿›è¡Œåå¤è¿›è¡Œï¼Œå½“é¡¹ç›®è¿›è¡Œä¸€åŠï¼Œå‘ç°ä¼°ç®—è¿‡äºä¹è§‚çš„è¯ï¼Œå°±éœ€è¦å¯¹å‰©ä¸‹çš„å·¥ä½œè¿›è¡Œé‡æ–°ä¼°ç®—</li></ul></li><li><p>ä¼°ç®—ä¸Scrum</p><ul><li>åœ¨Scrumé¡¹ç›®å½“ä¸­ï¼Œæˆ‘ä»¬ä¼šä»¥è¿­ä»£Sprintä¸ºå‘¨æœŸæ¥åšå¢é‡äº¤ä»˜</li><li>å’Œä¼ ç»Ÿçš„é¡¹ç›®ä¸ä¸€æ ·çš„æ˜¯åœ¨æ¯ä¸ªè¿­ä»£è®¡åˆ’å½“ä¸­æˆ‘ä»¬ä¸éœ€è¦ç¡®å®šæ—¥æœŸï¼Œåªéœ€è¦ä¼°ç®—ä¸€ä¸ªè¿­ä»£æˆ‘ä»¬èƒ½å®Œæˆå¤šå°‘å·¥ä½œ</li></ul></li></ul><h2 id="1-3-è¿›åº¦è®¡åˆ’"><a href="#1-3-è¿›åº¦è®¡åˆ’" class="headerlink" title="1.3 è¿›åº¦è®¡åˆ’"></a>1.3 è¿›åº¦è®¡åˆ’</h2><ul><li><p>åˆ¶å®šè®¡åˆ’çš„é‡è¦æ€§</p><ul><li>è®¡åˆ’çš„æœ¬è´¨æ˜¯å›¢é˜Ÿå¯¹ä½•æ—¶å®Œæˆä»»åŠ¡çš„æ‰¿è¯º</li><li>æ’æ–¥åšè®¡åˆ’çš„åŸå› ï¼Œåœ¨äºäººä»¬ä¸æ„¿è½»æ˜“åšå‡ºæ‰¿è¯ºã€‚äººä»¬éƒ½ä¼šæœ‰ä¸€ç§è¨€è¡Œä¸€è‡´çš„æ„¿æœ›ï¼Œä¸€æ—¦åšå‡ºæ‰¿è¯ºï¼Œæ¥è‡ªå†…å¿ƒå’Œå¤–éƒ¨çš„å‹åŠ›ä¼šè¿«ä½¿æˆ‘ä»¬æŒ‰ç…§æ‰¿è¯ºå»åšã€‚</li></ul></li><li><p>åˆ¶å®šè®¡åˆ’çš„æ—¶é—´ç‚¹</p><ul><li>åº”è¯¥å°½é‡æ—©çš„åˆ¶å®šå‡ºè®¡åˆ’<ul><li>å› ä¸ºåœ¨æ··æ²Œä¸æ¸…çš„æ—¶å€™ï¼Œéœ€è¦æŸç§æ–¹å¼æ¥åšé”šå®šï¼Œç›¸å½“äºæŒ–ä¸ªå‘ï¼Œæ ¹æ®å°‘é‡çš„ä¿¡æ¯ç»™å‡ºæœŸæœ›å€¼ï¼Œç„¶åè®©äººä»¬ä¸€ç‚¹ç‚¹æ¥å¡«æ»¡å®ƒ</li><li>å½“æœ‰äº†å‘ä»¥åï¼Œå°±è®©å¤§å®¶ä¸€èµ·æ¥å¡«</li></ul></li></ul></li><li><p>è°ƒæ•´è®¡åˆ’çš„æ³¨æ„äº‹é¡¹</p><ul><li>è®¡åˆ’æ˜¯è°ƒæ•´çš„åŸºç¡€å’Œä¾æ®ï¼Œä½†æ˜¯è°ƒæ•´è®¡åˆ’éœ€è¦æ³¨æ„ï¼š<ul><li>ç¡®ä¿é¡¹ç›®çš„æ¯ä¸€ä¸ªäººéƒ½çŸ¥é“å½“å‰çš„è®¡åˆ’æ˜¯ä»€ä¹ˆ</li><li>è°ƒæ•´è®¡åˆ’éœ€è¦æ€æ ·çš„å†³ç­–è¿‡ç¨‹</li><li>éœ€è¦è°å‚ä¸å†³ç­–</li></ul></li></ul></li><li><p>å¦‚ä½•åšå¥½è®¡åˆ’</p><ul><li><p>é¡¹ç›®ç«‹é¡¹å‰</p><ul><li>å°†ç›®æ ‡æŒ‰ç…§åŠŸèƒ½ä½“ç³»åˆ†å‰²æˆå‡ ä¸ªé‡å¤§çš„é‡Œç¨‹ç¢‘</li><li>è¿™ä¸ªæ—¶å€™æ³¨æ„è¦ç»™å‡ºç«‹é¡¹çš„æ—¶é—´è¡¨ â€“ èƒ½å¤Ÿä½¿å¾—å„ä¸ªèµ„æºæ–¹æœ‰æ˜ç¡®çš„é¢„æœŸï¼Œä»¥ä¾¿æå‰åšå¥½èµ„æºçš„è°ƒé…<ul><li>ä»€ä¹ˆæ—¶å€™å®ŒæˆåˆæœŸè°ƒç ”å’Œè¯„ä¼°</li><li>ä½•æ—¶åšå¥½ç«‹é¡¹å‡†å¤‡</li><li>ä½•æ—¶å¯åŠ¨é¡¹ç›®</li></ul></li></ul></li><li><p>é¡¹ç›®ç«‹é¡¹å</p><ul><li>æ ¹æ®å¯åŠ¨è¿‡ç¨‹å½“ä¸­å¯¹äºé‡Œç¨‹ç¢‘çš„å¤§è‡´é¢„æœŸï¼Œè¿›ä¸€æ­¥æ¨å¯¼å‡º<ul><li>éœ€æ±‚ç¡®è®¤</li><li>è®¾è®¡ç¡®è®¤</li><li>åŠŸèƒ½å®Œæˆ</li></ul></li></ul></li><li><p>éœ€æ±‚ç¡®è®¤å</p><ul><li>ç”±è®¾è®¡ï¼Œå¼€å‘ï¼Œæµ‹è¯•ä¸€èµ·åšWBSï¼Œå°†å·¥ä½œç»†åŒ–åˆ†è§£<ul><li>æ³¨æ„çš„å‡ ä¸ªèŠ‚ç‚¹<ul><li>è®¾è®¡ç¡®è®¤</li><li>åŠŸèƒ½å®Œæˆ</li><li>no bug</li><li>å‘å¸ƒå‰çš„ä»£ç å†»ç»“</li></ul></li></ul></li></ul></li><li><p>å®Œæˆæ ‡å‡†</p><ul><li><p>éœ€æ±‚è®¾è®¡ç¡®è®¤</p><ul><li>å›¢é˜Ÿè¦å‡†å¤‡å¥½æ€ä¹ˆç¼–å†™ï¼Œåœ¨å“ªé‡Œç¼–å†™ä»£ç </li></ul></li><li><p>åŠŸèƒ½å®Œæˆ</p><ul><li>æ‰€æœ‰å®šä¹‰çš„åŠŸèƒ½éƒ½å·²ç»å®Œæˆï¼Œå·²ç»é€šè¿‡æµ‹è¯•ï¼Œå…è®¸è´¨é‡å·®è·å’Œå°‘é‡çš„Bugå­˜åœ¨</li></ul></li><li><p>é‡Œç¨‹ç¢‘å®Œæˆ</p><ul><li>è´¨é‡å·²è¾¾åˆ°é€‚å½“æ°´å¹³ï¼Œå¯ä»¥ä¸Šçº¿å‘å¸ƒï¼Œæˆ–è€…å¼€å§‹ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘</li></ul></li></ul></li><li><p>Tips</p><ul><li>è®¡åˆ’æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ‰¿è¯ºï¼Œå› æ­¤åº”è¯¥è®©å›¢é˜Ÿå…±åŒå‚ä¸åˆ¶å®šå‡ºæ¥</li><li>æƒ³è®©æ‰¿è¯ºæœ‰æ•ˆï¼Œå¿…é¡»è¦æ˜¯å½“äº‹äººç§¯æå…¬å¼€ä¸”ç»è¿‡ä¸€ç•ªåŠªåŠ›åè‡ªç”±é€‰æ‹©å¾—æ¥çš„  </li></ul></li></ul></li></ul><h2 id="1-4-æ¯æ—¥ç«™ä¼š"><a href="#1-4-æ¯æ—¥ç«™ä¼š" class="headerlink" title="1.4 æ¯æ—¥ç«™ä¼š"></a>1.4 æ¯æ—¥ç«™ä¼š</h2><ul><li>å®šä½åœ¨æ²Ÿé€šäº¤æµ<ul><li>ä¸æ˜¯æ±‡æŠ¥ä¼š</li><li>æ˜¯ç”¨æ¥åˆ†äº«ä¿¡æ¯ï¼Œåšå‡ºæ‰¿è¯ºä»¥åŠæå‡ºè·¯éšœçš„ï¼Œè§£å†³çš„æ˜¯å›¢é˜ŸååŒçš„é—®é¢˜</li><li>éœ€è¦è®©äººå‚ä¸è¿›æ¥<ul><li>çº¢é»„ç»¿ä¸‰ç‰Œçš„æ–¹å¼<ul><li>é»„ç‰Œ â€“ è¿›è¡Œç›¸å…³æé—®ï¼Œå‘å‘è¨€è€…äº†è§£ååŒå’Œä¾èµ–çš„ä¿¡æ¯</li><li>çº¢ç‰Œ â€“ ç”¨æ¥æ‰“æ–­è°ˆè¯ï¼Œé¿å…è¿‡åº¦çš„è®¨è®ºå’Œæ— ç»“æœçš„æ—¶é—´æµªè´¹ï¼Œæé«˜ç«™ä¼šæ•ˆç‡</li><li>ç»¿ç‰Œ â€“ ä»£è¡¨æ¯ä¸ªäººçš„å‘è¨€æƒï¼Œå°†ç‰Œå½’è¿˜ç»™ä¸»æŒäººåˆ™æ„å‘³ç€ç«™ä¼šç»“æŸ</li></ul></li></ul></li></ul></li></ul><h2 id="1-5-å‘¨ä¼šå‘¨æŠ¥"><a href="#1-5-å‘¨ä¼šå‘¨æŠ¥" class="headerlink" title="1.5 å‘¨ä¼šå‘¨æŠ¥"></a>1.5 å‘¨ä¼šå‘¨æŠ¥</h2><ul><li><p>å‘¨ä¼šçš„ç›®çš„</p><ul><li>ä¸ä»…ä»…æ˜¯åŒæ­¥çŠ¶æ€ï¼Œæ±‡æ€»å›¢é˜Ÿä¿¡æ¯ï¼Œè¿™äº›æ˜¯é‚®ä»¶ï¼Œæ–‡ä»¶å…±äº«å°±å¯ä»¥å®ç°çš„</li><li>ç›®çš„åœ¨äº<ul><li>é¢å¯¹é¢æ„Ÿå—é¡¹ç›®å½“å‰çš„æ•´ä½“çŠ¶æ€ï¼Œé‡è¦é—®é¢˜ï¼Œæ¥ä¸‹å»çš„ç›®æ ‡ï¼Œä»¥åŠæ‰€éœ€çš„è°ƒæ•´</li><li>å€Ÿæ­¤å¯¹é¡¹ç›®å½“å‰é‡è¦çš„é—®é¢˜æœ‰ä¸€è‡´çš„è®¤è¯†ï¼Œè¿›è¡Œå°å¹…åº¦çš„è®¨è®ºï¼Œå¹¶å½¢æˆä¸‹ä¸€æ­¥çš„å·¥ä½œäº‹é¡¹ </li></ul></li></ul></li><li><p>Tips</p><ul><li><p>æ§åˆ¶è§„æ¨¡å’Œæ—¶é—´</p><ul><li>æœ€å¤š10 - 15</li><li>1.5h maximum </li></ul></li><li><p>è¦ä¸è¦è½®æµæ±‡æŠ¥ï¼Ÿ</p><ul><li>å¤§éƒ¨åˆ†é¡¹ç›®æ•´ä½“æƒ…å†µå¯ä»¥é€šè¿‡é¡¹ç›®ç»å†äº‹å…ˆæ”¶é›†æ¥ç›´æ¥åšæ•´ä½“æ¦‚è¿°</li><li>å¯¹äºéƒ¨åˆ†æ–¹å‘æ€§æˆ–è€…å•†åŠ¡æ€§çš„å°ç»„ï¼Œå¯ä»¥ç®€å•æ±‡æŠ¥ä¸»è¦å·¥ä½œå’Œä¸»è¦é—®é¢˜</li></ul></li><li><p>ä»€ä¹ˆé€‚åˆåœ¨å‘¨ä¼šä¸­è®¨è®ºï¼Ÿ</p><ul><li>æ€¥äº‹ä¸é€‚åˆ</li><li>éè·¨å›¢é˜Ÿçš„é—®é¢˜ä¸é€‚åˆå‘¨ä¼šè®¨è®º</li><li>çº¯æ‰§è¡Œç»†èŠ‚é—®é¢˜ä¸é€‚åˆå‘¨ä¼šè®¨è®º</li><li>å¤§æ–¹å‘å†³ç­–é—®é¢˜ä¸é€‚åˆ</li><li>å¯ä»¥è®¨è®ºè·¨å›¢é˜Ÿçš„æ¶‰åŠæ•´ä½“æ€§è®¡åˆ’çš„é—®é¢˜</li><li>ä¸­æœŸæ”¹è¿›å‹é—®é¢˜</li></ul></li><li><p>è¯´è¯æ¯”ä¾‹</p><ul><li>ä¸‰åˆ†<ul><li>ä¼šè®®ä¸»æŒäººï¼Œæ›´æ–°æ•´ä½“çŠ¶æ€ï¼Œä¸»æŒè®¨è®º</li><li>éœ€è¦å›æŠ¥çš„ä¸ä¼šè€…çš„å‘è¨€</li><li>æ‰€æœ‰ä¸ä¼šè€…çš„è®¨è®º</li></ul></li></ul></li></ul></li><li><p>å…¨ä½“ç±»å‘¨ä¼š</p></li><li><p>ç»„é•¿ç±»å‘¨ä¼š</p></li><li><p>ä¸‰æ–¹ç±» â€“ äº§å“ï¼Œè¿è¥ï¼Œå¸‚åœºä¸‰æ–¹å‘¨ä¼š</p></li></ul><h2 id="1-6-å·¥ä½œæ±‡æŠ¥"><a href="#1-6-å·¥ä½œæ±‡æŠ¥" class="headerlink" title="1.6 å·¥ä½œæ±‡æŠ¥"></a>1.6 å·¥ä½œæ±‡æŠ¥</h2><ul><li><p>å·¥ä½œæ±‡æŠ¥çš„ç›®çš„</p><ul><li><p>å°†çŠ¶æ€ï¼Œé—®é¢˜ï¼Œé£é™©çŸ¥ä¼šç›¸å…³å¹²ç³»äºº</p></li><li><p>å¯»æ±‚å¸®åŠ©</p><ul><li>éœ€è¦åœ¨é‡åˆ°é—®é¢˜çš„åˆæœŸå°±ç§¯æä¸»åŠ¨å¯»æ±‚å¸®åŠ©ï¼Œè¿›è€Œè¿…é€Ÿçš„å»è§£å†³</li></ul></li><li><p>è‡ªæˆ‘å®¡è§†</p><ul><li>å‘¨æŠ¥æ˜¯ä¸€ç§è‡ªæˆ‘å®¡è§†çš„è¿‡ç¨‹ï¼Œçœ‹çœ‹è‡ªå·±åˆ¶å®šçš„ç›®æ ‡å’Œé¡¹ç›®çš„å®Œæˆæƒ…å†µ</li></ul></li></ul></li><li><p>ä¸ªäººå‘¨æŠ¥</p><ul><li><p>å†…å®¹</p><ul><li><p>æœ¬å‘¨å·¥ä½œå®Œæˆç¨‹åº¦</p><ul><li>åšäº†ä»€ä¹ˆ</li><li>å®Œæˆç»“æœå¦‚ä½•</li></ul></li><li><p>ä¸‹å‘¨å·¥ä½œè®¡åˆ’</p><ul><li>éœ€è¦åšä»€ä¹ˆ</li><li>æ—¶é—´ç‚¹</li><li>å®Œæˆçš„å®šä¹‰</li></ul></li><li><p>å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å’Œå»ºè®®</p></li><li><p>ä¸ªäººæ„Ÿè¨€å’Œå»ºè®®</p><ul><li>å·¥ä½œä¸­çš„æ€»ç»“å’Œåˆ†äº«ï¼Œè®©ä¸Šå¸çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆ</li></ul></li></ul></li></ul></li></ul><ul><li>å›¢é˜Ÿå·¥ä½œå‘¨æŠ¥<ul><li>å›¢é˜Ÿå‘¨æŠ¥æ›´å¤šèšç„¦åœ¨ç»“æœå’Œè®¡åˆ’ä¸Šï¼Œè€Œéä¸ªäººå¾®è§‚å±‚é¢çš„äº‹ä»¶æ€»ç»“</li><li>è®¡åˆ’çš„æ—¶é—´è·¨åº¦æ ¹æ®å›¢é˜Ÿè§„æ¨¡å¤§å°ä¸åŒå¯ä»¥ä»1ä¸ªæœˆåˆ°3ä¸ªæœˆä¸ç­‰</li><li>å†…å®¹<ul><li>ä¸Šå‘¨è¾¾æˆçš„ç»“æœ<ul><li>é‡åŒ–çš„ç»“æœæŒ‡æ ‡<ul><li>é”€å”®é¢</li><li>ç”¨æˆ·æ•°ç­‰</li></ul></li></ul></li><li>æœªæ¥ä¸€æ®µæ—¶é—´çš„è§„åˆ’<ul><li>é€šè¿‡å›¾å½¢åŒ–çš„æ–¹å¼è¨€ç®€æ„èµ…åœ°åˆ—å‡ºä»»åŠ¡çš„æ—¶é—´ç‚¹å’ŒæœŸæœ›è¾¾åˆ°çš„ç»“æœ</li></ul></li><li>è¾¾æˆå¦‚ä¸Šè§„åˆ’å›¾çš„é£é™©/ éœ€è¦çš„ååŠ©<ul><li>èµ„æºé£é™©</li><li>åˆä½œæ–¹é£é™©</li><li>å»ºè®®çš„åº”å¯¹æ–¹æ¡ˆ</li></ul></li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¡¹ç›®ç®¡ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šä½ æ—©è¯¥è¿™ä¹ˆç©Excelã€‹</title>
      <link href="/%E3%80%8A%E4%BD%A0%E6%97%A9%E8%AF%A5%E8%BF%99%E4%B9%88%E7%8E%A9Excel%E3%80%8B/"/>
      <url>/%E3%80%8A%E4%BD%A0%E6%97%A9%E8%AF%A5%E8%BF%99%E4%B9%88%E7%8E%A9Excel%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<p>ä¸€æ¬¡å¯¹Excelçš„äº†è§£å’Œæ­£è§†ä¹‹æ—…ã€‚ç›¸è¾ƒäºç¼–ç¨‹å®ç°ä¸é€šè¿‡Excelè¿›è¡Œæ•°æ®åˆ†æï¼Œç¼–ç¨‹åœ¨Scalabilityä¸Šèƒœå‡ºçš„ï¼Œä½†æ˜¯å¯¹äºæ“ä½œçš„ä¾¿æ·æ€§ï¼Œä»¥åŠéªŒè¯å‡è®¾çš„é€Ÿåº¦ä¸Šï¼Œç¡®ç¡®å®å®Excelè¦èƒœå‡ºä¸€ç­¹ã€‚å°¤å…¶æ˜¯å­¦åˆ°äº†ä¸‰è¡¨çš„æ“ä½œï¼ŒVLookUpè¿™ç§å‡½æ•°ä¹‹åï¼Œå¼€å§‹ç†è§£Excelåœ¨æ•°æ®åˆ†æä¸Šçš„å·¨å¤§çš„ä½œç”¨ã€‚</p><ul><li><p>Highlights</p><ul><li>ä¸‰è¡¨<ul><li>å‚æ•°è¡¨</li><li>æºæ•°æ®è¡¨</li><li>åˆ†ç±»æ±‡æ€»è¡¨</li></ul></li><li>å·§ç”¨å„ç§å‡½æ•°</li></ul></li><li><p>æºæ•°æ®è¡¨</p><ul><li>åº”å½“åªæœ‰ä¸€å¼ ï¼Œå¯¹äºæ¯ä¸€ä¸ªä½ æƒ³è¦ç ”ç©¶çš„é¢†åŸŸ</li><li>åº”å½“ä¸ºä¸€ç»´æ•°æ®æ ¼å¼</li><li>æ ‡é¢˜å†…å®¹ä¸è¦å†™åœ¨è¡¨æ ¼å½“ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬å¾ˆå¯èƒ½éœ€è¦ç´¢å¼•çš„ï¼Œ<ul><li>å¯ä»¥å¯¹å·¥ä½œç°¿ï¼Œ å·¥ä½œè¡¨è¿›è¡Œå‘½åæ¥åšåŒºåˆ†</li></ul></li><li>æºæ•°æ®é¡ºåº<ul><li>åº”è¯¥æŒ‰ç…§å·¥ä½œå½“ä¸­çš„é€»è¾‘é¡ºåºæ¥å¯¹åˆ—è¿›è¡Œæ’åº</li><li>åˆ—æ•°æ®ä½ç½®è°ƒæ•´ï¼Œshift + æ‹–åŠ¨</li></ul></li><li>å‡¡æ˜¯åŒä¸€ç§å±æ€§çš„æ•°æ®éƒ½åº”è¯¥è®°å½•åœ¨åŒä¸€åˆ—å½“ä¸­çš„</li><li>å¤šä¸ªå•å…ƒæ ¼æ‰¹é‡å½•å…¥<ul><li>é€‰å®šå¤šä¸ªå•å…ƒæ ¼</li><li>åœ¨ä¸€ä¸ªå•å…ƒæ ¼å½“ä¸­è¾“å…¥å†…å®¹</li><li>Ctrl + enter è¾“å…¥ä¸€æ¬¡çš„å†…å®¹ä¼šè¢«åŠ è½½åˆ°ä½ é€‰ä¸­çš„æ‰€æœ‰å•å…ƒæ ¼ä¸Š</li></ul></li><li>æºæ•°æ®è¡¨å½“ä¸­ä¸åº”è¯¥ä½¿ç”¨åˆå¹¶å±…ä¸­è¿™ç§æ“ä½œ<ul><li>æ˜ç»†æ•°æ®åº”å½“æœ‰ä¸€æ¡è®°å½•ä¸€æ¡</li><li>æ‰€æœ‰å•å…ƒæ ¼åº”è¯¥è¢«å¡«æ»¡</li><li>æ¯ä¸€è¡Œæ•°æ®å¿…é¡»å®Œæ•´ä¸”æ•´é½</li><li>åˆå¹¶å•å…ƒæ ¼ä¼šå¯¼è‡´åªæœ‰é¦–ä¸ªå•å…ƒæ ¼æœ‰æ•°æ®ï¼Œå…¶ä»–çš„éƒ½æ˜¯ç©ºç™½å•å…ƒæ ¼</li></ul></li><li>å…ƒæ•°æ®åªä¿ç•™åœ¨ä¸€å¼ è¡¨å½“ä¸­ï¼Œæ”¾åœ¨å¤šå¼ è¡¨å½“ä¸­çš„è¯åˆå¹¶ä¼šéå¸¸éå¸¸éº»çƒ¦</li><li>æºæ•°æ®è¡¨æ˜¯ä¸ºäº†å•†ä¸šä¸Šçš„use caseæœåŠ¡çš„ï¼Œéœ€è¦ç†æ¸…æ¥šéœ€è¦ä»€ä¹ˆæ•°æ®<ul><li>æŒ‰ç…§é€»è¾‘é¡ºåºæ¥åˆ†æ¸…å„ä¸ªcolumn</li><li>åœ¨è¿™ä¹‹åå¯ä»¥æŒ‰ç…§å¯èƒ½çš„æ‰‹åŠ¨è¾“å…¥ï¼Œå¤åˆ¶ç²˜è´´æ¥åšcluster</li></ul></li></ul></li><li><p>ä¸‰å¼ è¡¨çš„å®šä¹‰</p><ul><li>å‚æ•°è¡¨<ul><li>ç³»ç»Ÿçš„é…ç½®å‚æ•°ï¼Œä¾›æºæ•°æ®è¡¨å’Œåˆ†ç±»æ±‡æ€»è¡¨æ¥è°ƒç”¨</li><li>è¡¨ç¤ºæ•°æ®åŒ¹é…å…³ç³»æˆ–è€…æŸå±æ€§æ˜ç»†ä¸ä¼šç»å¸¸å˜æ›´çš„æ•°æ®</li></ul></li><li>æºæ•°æ®è¡¨<ul><li>æ•°æ®çš„å½•å…¥</li><li>ä¸€åˆ‡ä¸æ•°æ®å½•å…¥ç›¸å…³çš„å·¥ä½œéƒ½åº”è¯¥åœ¨æºæ•°æ®è¡¨å½“ä¸­è¿›è¡Œ</li><li>åº”æ»¡è¶³ä¸€ä¸‹æ¡ä»¶<ul><li>ä¸€ç»´æ•°æ®</li><li>ä¸€ä¸ªæ ‡é¢˜è¡Œ</li><li>å­—æ®µåˆ†ç±»æ¸…æ™°</li><li>æ•°æ®å±æ€§å®Œæ•´</li><li>æ•°æ®è¿ç»­</li><li>æ— åˆå¹¶å•å…ƒæ ¼</li><li>æ— åˆè®¡è¡Œ</li><li>æ— åˆ†éš”è¡Œ/ åˆ—</li><li>æ— ç©ºç™½å•å…ƒæ ¼</li><li>å•å…ƒæ ¼å†…å®¹ç¦ç”¨çŸ­è¯­å¥å­</li></ul></li><li>åˆ†ç±»æ±‡æ€»è¡¨<ul><li>å¸Œæœ›æ˜¯é€šè¿‡å‡½æ•°å…³è”ç­‰ä»æ•°æ®è¡¨å½“ä¸­è·å–ä¸€åˆ‡æ‰€éœ€çš„æ•°æ®</li></ul></li><li>Thoughts <ul><li>ä¼ä¸šä¿¡æ¯åŒ–æ˜¯å¿…é¡»çš„ï¼Œéœ€è¦æœ‰ERP, CRM, WMS, OAç­‰ä¼ä¸šç³»ç»Ÿ</li><li>ä½†æ˜¯å¯¹äºä¿¡æ¯çš„ä¸ªæ€§åŒ–å¤„ç†ä¸Šæ¥è¯´ï¼ŒExcelä¼šæ›´å ä¸Šé£ï¼Œå¯ä»¥æ›´å¿«é€Ÿçš„ç»™å‡ºå„ç±»æ•°æ®</li></ul></li></ul></li></ul></li><li><p>æ•°æ®é€è§†è¡¨</p><ul><li>åœ¨æºæ•°æ®è¡¨å½“ä¸­é€‰ä¸­æƒ³è¦åšåˆ†æçš„æ•°æ®ï¼Œç„¶åæ¥ç”ŸæˆPivot table</li><li>æ­¥éª¤<ul><li>ç¡®è®¤æ•°æ®æ¥æºå’Œå¾…åˆ›å»ºçš„æŠ¥è¡¨ç±»å‹</li><li>ç¡®è®¤é€‰å®šçš„æ•°æ®åŒºåŸŸ</li><li>æ ‡é¢˜è¡Œéœ€è¦è¢«åŒ…å«åœ¨å†…</li></ul></li><li>Tips<ul><li>åˆ†ç±»å¤šçš„å­—æ®µå°½é‡ä½œä¸ºèˆªå­—æ®µ</li></ul></li></ul></li><li><p>å½•å…¥å®‰å…¨</p><ul><li>è®¾ç½®æœ‰å…³äºæ•°æ®æœ‰æ•ˆæ€§çš„é™åˆ¶ï¼Œæ¯”å¦‚è§„å®šå¿…é¡»è¾“å…¥æŸç§æ—¥æœŸæ ¼å¼</li><li>å¯¹äºåŒ…å«å…¬å¼çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œé”å®šï¼Œè¿™æ ·å…¶ä»–äººå°±æ— æ³•å¯¹å…¶è¿›è¡Œä¿®æ”¹äº†</li><li>æ‰‹å·¥å½•å…¥ï¼Œå¤åˆ¶ç²˜è´´ï¼Œå…¬å¼é“¾æ¥çš„æ•°æ®åŒºåŸŸè¦ç”¨ä¸åŒçš„å¡«å……è‰²åŒºåˆ†ï¼Œæ¥å‘ŠçŸ¥ä½¿ç”¨è€…ä»€ä¹ˆåœ°æ–¹éœ€è¦å¡«å†™ï¼Œä»€ä¹ˆåœ°æ–¹éœ€è¦å¤åˆ¶ç²˜è´´</li></ul></li><li><p>Vlookup</p><ul><li>æŸ¥æ‰¾å¼•ç”¨å‡½æ•°<ul><li>æŸ¥æ‰¾æŸå•å…ƒæ ¼æ•°æ®åœ¨æºæ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è¿”å›æºæ•°æ®åº“ä¸­åŒè¡ŒæŒ‡å®šåˆ—çš„å•å…ƒæ ¼å†…å®¹</li></ul></li><li>å››ä¸ªå‚æ•°<ul><li>ç”¨ä»€ä¹ˆæ‰¾</li><li>åœ¨å“ªä¸ªè¡¨æ‰¾</li><li>æ‰¾åˆ°äº†è¿”å›ä»€ä¹ˆå€¼</li><li>ç²¾ç¡®æ‰¾è¿˜æ˜¯æ¨¡ç³Šæ‰¾</li></ul></li></ul></li><li><p>å›¾è¡¨</p><ul><li>åšå›¾è¡¨çš„ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿæ›´åŠ å‡†ç¡®ç›´è§‚çš„è¯ é‡Šæ•°æ®</li><li>é¥¼çŠ¶å›¾<ul><li>è¯´æ˜æ¯”ä¾‹å…³ç³»</li></ul></li><li>æŸ±çŠ¶å›¾<ul><li>æ¯”è¾ƒæ•°å€¼</li></ul></li><li>æŠ˜çº¿å›¾<ul><li>å…³æ³¨è¶‹åŠ¿</li></ul></li><li>æ¦‚å¿µå›¾<ul><li>å·¦å³å¯¹æ¯”ï¼Œé€‚åˆç”·å¥³</li><li>ç”Ÿæˆå›¾æ ‡çš„æºæ•°æ®å½“ä¸­åˆ¶é€ è´Ÿæ•°ï¼Œæ¥ç”Ÿæˆè¿™ç§å‘ä¸¤è¾¹å»¶ä¼¸çš„æ•ˆ</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java é›†åˆå¤„ç†/ ç©ºå€¼å¤„ç†/ å¼‚å¸¸å¤„ç†</title>
      <link href="/Java-%E9%9B%86%E5%90%88%E5%A4%84%E7%90%86-%E5%92%8C-%E7%A9%BA%E5%80%BC%E5%A4%84%E7%90%86/"/>
      <url>/Java-%E9%9B%86%E5%90%88%E5%A4%84%E7%90%86-%E5%92%8C-%E7%A9%BA%E5%80%BC%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Arrays-asList"><a href="#1-Arrays-asList" class="headerlink" title="1. Arrays.asList"></a>1. <code>Arrays.asList</code></h1><p>ä¸šåŠ¡å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šå°†åŸå§‹çš„æ•°ç»„è½¬æ¢ä¸ºListç±»æ•°æ®ç»“æ„ï¼Œæ¥ç»§ç»­å±•å¼€å„ç§Streamæ“ä½œ</p><ul><li><p>Arrays.asListæ— æ³•è½¬æ¢åŸºæœ¬ç±»å‹çš„æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨Arrays.streamæ¥è¿›è¡Œè½¬æ¢</p></li><li><p>Arrays.asListè¿”å›çš„listæ˜¯ä¸æ”¯æŒå¢åˆ æ“ä½œçš„ï¼Œå…¶è¿”å›çš„Listæ˜¯Arraysçš„å†…éƒ¨ç±»ArrayListã€‚å†…éƒ¨ç»§æ‰¿è‡ªAbstractListï¼Œæ²¡æœ‰è¦†å†™çˆ¶ç±»çš„addæ–¹æ³•</p></li><li><p>å¯¹åŸå§‹æ•°ç»„çš„ä¿®æ”¹ä¼šå½±å“åˆ°æˆ‘ä»¬è·å¾—çš„é‚£ä¸ªList</p><ul><li>ArrayListå®é™…ä¸Šæ˜¯ä½¿ç”¨äº†åŸå§‹çš„æ•°ç»„ï¼Œå› æ­¤åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ€å¥½å†ä½¿ç”¨New ArrayListæ¥å®ç°è§£è€¦</li></ul></li></ul><h1 id="2-ç©ºå€¼å¤„ç†"><a href="#2-ç©ºå€¼å¤„ç†" class="headerlink" title="2. ç©ºå€¼å¤„ç†"></a>2. ç©ºå€¼å¤„ç†</h1><h2 id="2-1-NullPointerException"><a href="#2-1-NullPointerException" class="headerlink" title="2.1 NullPointerException"></a>2.1 NullPointerException</h2><ul><li>å¯èƒ½å‡ºç°çš„åœºæ™¯<ul><li>å‚æ•°å€¼æ˜¯Integerç­‰åŒ…è£…ç±»å‹ï¼Œä½¿ç”¨æ—¶å› ä¸ºè‡ªåŠ¨æ‹†ç®±å‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸</li><li>å­—ç¬¦ä¸²æ¯”è¾ƒ</li><li>ConcurrentHashMapè¿™ç§å®¹å™¨ä¸æ”¯æŒKeyå’ŒValueä¸ºnullï¼Œå¼ºè¡Œput nullçš„keyæˆ–Valueä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li><li>æ–¹æ³•æˆ–è¿œç¨‹æœåŠ¡è¿”å›çš„listæ˜¯nullï¼Œæ²¡åšåˆ¤ç©ºå°±ç›´æ¥è°ƒç”¨ï¼Œå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li><li>è”çº§è°ƒç”¨çš„null check</li></ul></li></ul><ul><li>best practice<ul><li><code>string.equalsTo(variableName)</code></li><li><code>Optional.ofNullable()</code></li><li><code>orElse()</code></li></ul></li></ul><h1 id="3-å¼‚å¸¸å¤„ç†"><a href="#3-å¼‚å¸¸å¤„ç†" class="headerlink" title="3. å¼‚å¸¸å¤„ç†"></a>3. å¼‚å¸¸å¤„ç†</h1><h2 id="3-1-åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è€ƒè™‘å¼‚å¸¸å¤„ç†"><a href="#3-1-åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è€ƒè™‘å¼‚å¸¸å¤„ç†" class="headerlink" title="3.1 åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è€ƒè™‘å¼‚å¸¸å¤„ç†"></a>3.1 åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è€ƒè™‘å¼‚å¸¸å¤„ç†</h2><ul><li><p>å¤§å¤šæ•°ä¸šåŠ¡åº”ç”¨éƒ½é‡‡ç”¨ä¸‰å±‚æ¶æ„</p><ul><li><p>Controllerå±‚</p><ul><li>è´Ÿè´£ä¿¡æ¯æ”¶é›†ï¼Œå‚æ•°æ ¡éªŒï¼Œè½¬æ¢æœåŠ¡å±‚å¤„ç†çš„æ•°æ®é€‚é…å‰ç«¯ï¼Œè½»ä¸šåŠ¡é€»è¾‘</li><li>Controller æ•è·å¼‚å¸¸ï¼Œç„¶åéœ€è¦ç»™ç”¨æˆ·å‹å¥½ç”¨æˆ·çš„æç¤º</li></ul></li><li><p>Serviceå±‚</p><ul><li>è´Ÿè´£æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬å¤–éƒ¨æœåŠ¡è°ƒç”¨ï¼Œè®¿é—®æ•°æ®åº“ï¼Œç¼“å­˜å¤„ç†ï¼Œæ¶ˆæ¯å¤„ç†ç­‰</li><li>ä¸€èˆ¬ä¼šæ¶‰åŠåˆ°æ•°æ®åº“äº‹åŠ¡ï¼Œå‡ºç°å¼‚å¸¸ä¸é€‚åˆæ•è·ï¼Œå¦åˆ™äº‹åŠ¡æ— æ³•è‡ªåŠ¨å›æ»š</li></ul></li><li><p>Repositoryå±‚</p><ul><li>è´Ÿè´£æ•°æ®è®¿é—®å®ç°ï¼Œä¸€èˆ¬æ²¡æœ‰ä¸šåŠ¡é€»è¾‘</li><li>æ ¹æ®æƒ…å†µæ¥åšå¿½ç•¥ï¼Œé™çº§ï¼Œæˆ–è€…è½¬åŒ–ä¸ºä¸€ä¸ªå‹å¥½çš„å¼‚å¸¸</li></ul></li></ul></li><li><p>æ¡†æ¶å±‚é¢çš„å¼‚å¸¸å¤„ç†</p><ul><li>å°½é‡ä¸è¦åœ¨æ¡†æ¶å±‚é¢åšå¼‚å¸¸çš„è‡ªåŠ¨ï¼Œç»Ÿä¸€çš„å¤„ç†</li><li>æ¡†æ¶åº”å½“æ¥åšå…œåº•å·¥ä½œï¼Œå¦‚æœå¼‚å¸¸ä¸Šå‡åˆ°æœ€ä¸Šå±‚é€»è¾‘è¿˜æ˜¯æ— æ³•å¤„ç†çš„è¯ï¼Œå¯ä»¥ç”¨ç»Ÿä¸€çš„æ–¹å¼è¿›è¡Œå¼‚å¸¸è½¬æ¢<ul><li><code>@RestControllerAdvice</code></li><li><code>@ExceptionHandler</code></li></ul></li></ul></li></ul><h2 id="3-2-ä¸è¦ç›´æ¥ç”Ÿåå¼‚å¸¸"><a href="#3-2-ä¸è¦ç›´æ¥ç”Ÿåå¼‚å¸¸" class="headerlink" title="3.2 ä¸è¦ç›´æ¥ç”Ÿåå¼‚å¸¸"></a>3.2 ä¸è¦ç›´æ¥ç”Ÿåå¼‚å¸¸</h2><p>æ•è·äº†å¼‚å¸¸ä»¥åä¸åº”è¯¥ç”Ÿåï¼Œå› ä¸ºåæ‰çš„å¼‚å¸¸å¦‚æœæ²¡æœ‰æ­£å¸¸å¤„ç†çš„è¯ï¼Œå‡ºç°Bugä¼šå¾ˆéš¾å‘ç°ã€‚</p><p>éœ€è¦æœ‰åˆé€‚çš„è½¬åŒ–æˆç”¨æˆ·å‹å¥½çš„å¼‚å¸¸ï¼Œæˆ–è€…è‡³å°‘åœ¨warnï¼Œ errorçº§åˆ«æ¥åšlog</p><h2 id="3-3-ä¿ç•™åŸå§‹çš„ä¿¡æ¯"><a href="#3-3-ä¿ç•™åŸå§‹çš„ä¿¡æ¯" class="headerlink" title="3.3 ä¿ç•™åŸå§‹çš„ä¿¡æ¯"></a>3.3 ä¿ç•™åŸå§‹çš„ä¿¡æ¯</h2><p>åœ¨æ•æ‰äº†å¼‚å¸¸ä¹‹åï¼Œä¸€å®šè¦è®°å¾—åœ¨log æˆ–è€…åœ¨å‘å¤–æ‰”å‡ºçš„å¼‚å¸¸ä¹‹ä¸­è®°å½•åŸå§‹å¼‚å¸¸ä¿¡æ¯</p><pre><code>catch (IOException e) {    //åªä¿ç•™äº†å¼‚å¸¸æ¶ˆæ¯ï¼Œæ ˆæ²¡æœ‰è®°å½•    log.error(&quot;æ–‡ä»¶è¯»å–é”™è¯¯, {}&quot;, e.getMessage());    throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;);}catch (IOException e) {    throw new RuntimeException(&quot;ç³»ç»Ÿå¿™è¯·ç¨åå†è¯•&quot;, e);}</code></pre><h2 id="3-4-å°å¿ƒfinallyä¸­çš„å¼‚å¸¸-try-with-resources"><a href="#3-4-å°å¿ƒfinallyä¸­çš„å¼‚å¸¸-try-with-resources" class="headerlink" title="3.4 å°å¿ƒfinallyä¸­çš„å¼‚å¸¸ + try with resources"></a>3.4 å°å¿ƒfinallyä¸­çš„å¼‚å¸¸ + try with resources</h2><p>æ³¨æ„åœ¨èµ„æºé‡Šæ”¾å¤„ç†ç­‰æ”¶å°¾æ“ä½œçš„æ—¶å€™ä¹Ÿå¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ï¼Œè¿™ç§æ—¶å€™ï¼Œå¦‚æœtry blocké€»è¾‘å’Œfinnallyé€»è¾‘éƒ½æœ‰å¼‚å¸¸æŠ›å‡ºçš„è¯ï¼Œtryå½“ä¸­çš„å¼‚å¸¸ä¼šè¢«finnallyä¸­çš„å¼‚å¸¸è¦†ç›–æ‰ï¼Œè¿™ä¼šè®©é—®é¢˜å˜å¾—éå¸¸ä¸æ˜æ˜¾</p><pre><code>@GetMapping(&quot;wrong&quot;)public void wrong() {    try {        log.info(&quot;try&quot;);        //å¼‚å¸¸ä¸¢å¤±        throw new RuntimeException(&quot;try&quot;);    } finally {        log.info(&quot;finally&quot;);        throw new RuntimeException(&quot;finally&quot;);    }}</code></pre><p>å¯¹äºå®ç°äº†AutoCloseableæ¥å£çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨try-with-resourcesæ¥é‡Šæ”¾èµ„æºï¼Œå°±æ˜¯åœ¨tryä¸­å¸¦èµ„æºçš„å£°æ˜</p><ul><li>try catch finally vs try with resources </li></ul><pre><code>Scanner scanner = null;try {    scanner = new Scanner(new File(&quot;test.txt&quot;));    while (scanner.hasNext()) {        System.out.println(scanner.nextLine());    }} catch (FileNotFoundException e) {    e.printStackTrace();} finally {    if (scanner != null) {        scanner.close();    }}try (Scanner scanner = new Scanner(new File(&quot;test.txt&quot;))) {    while (scanner.hasNext()) {        System.out.println(scanner.nextLine());    }} catch (FileNotFoundException fnfe) {    fnfe.printStackTrace();}</code></pre><h2 id="3-5-çº¿ç¨‹æ± ä»»åŠ¡çš„å¼‚å¸¸å¤„ç†"><a href="#3-5-çº¿ç¨‹æ± ä»»åŠ¡çš„å¼‚å¸¸å¤„ç†" class="headerlink" title="3.5 çº¿ç¨‹æ± ä»»åŠ¡çš„å¼‚å¸¸å¤„ç†"></a>3.5 çº¿ç¨‹æ± ä»»åŠ¡çš„å¼‚å¸¸å¤„ç†</h2><ul><li>è®¾ç½®è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ç¨‹åºä½œä¸ºä¿åº•ï¼Œæ¯”å¦‚åœ¨å£°æ˜çº¿ç¨‹æ± æ—¶è‡ªå®šä¹‰çº¿ç¨‹æ± çš„æœªæ•è·å¼‚å¸¸å¤„ç†ç¨‹åº</li></ul><pre><code>new ThreadFactoryBuilder()  .setNameFormat(prefix+&quot;%d&quot;)  .setUncaughtExceptionHandler((thread, throwable)-&gt; log.error(&quot;ThreadPool {} got exception&quot;, thread, throwable))  .get()</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.baeldung.com/java-try-with-resources" target="_blank" rel="noopener">https://www.baeldung.com/java-try-with-resources</a> </li><li><a href="https://time.geekbang.org/column/article/220230" target="_blank" rel="noopener">https://time.geekbang.org/column/article/220230</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ•°å€¼è®¡ç®—ç²¾åº¦é—®é¢˜</title>
      <link href="/Java%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/"/>
      <url>/Java%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Double"><a href="#1-Double" class="headerlink" title="1. Double"></a>1. Double</h1><pre><code>System.out.println(0.1+0.2);System.out.println(1.0-0.8);System.out.println(4.015*100);System.out.println(123.3/100);double amount1 = 2.15;double amount2 = 1.10;if (amount1 - amount2 == 1.05)    System.out.println(&quot;OK&quot;);// Output 0.300000000000000040.19999999999999996401.499999999999941.2329999999999999</code></pre><p>ä¸Šè¿°é—®é¢˜å‡ºç°çš„åŸå› æ˜¯å› ä¸ºè®¡ç®—æœºæ˜¯ä»¥äºŒè¿›åˆ¶å­˜å‚¨æ•°å€¼çš„ï¼Œæµ®ç‚¹æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ Javaé‡‡ç”¨çš„æ˜¯IEEE754æ ‡å‡†æ¥å®ç°æµ®ç‚¹æ•°çš„è¡¨è¾¾å’Œè¿ç®—ï¼Œå½“å°†ä¸€ä¸ª10è¿›åˆ¶çš„æ•°å€¼è½¬åŒ–æˆæµ®ç‚¹æ•°çš„æ—¶å€™ï¼Œä¼šå‡ºç°æ— é™å¾ªç¯çš„ç»“æœã€‚å½“ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯æ— é™å¾ªç¯çš„æ—¶å€™ï¼Œè½¬æ¢æˆ10è¿›åˆ¶å°±ä¼šé€ æˆç²¾åº¦çš„ç¼ºå¤±äº†ã€‚</p><h1 id="2-BigDecimal"><a href="#2-BigDecimal" class="headerlink" title="2. BigDecimal"></a>2. BigDecimal</h1><p>BigDecimalå¯ä»¥ç”¨äºæµ®ç‚¹æ•°ç²¾ç¡®è¡¨è¾¾çš„åœºæ™¯ï¼Œä½†æ˜¯ä½¿ç”¨BigDecimalçš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„ä½¿ç”¨å­—ç¬¦ä¸²çš„æ„é€ æ–¹æ³•æ¥åˆå§‹åŒ–</p><pre><code>System.out.println(new BigDecimal(&quot;0.1&quot;).add(new BigDecimal(&quot;0.2&quot;)));System.out.println(new BigDecimal(&quot;1.0&quot;).subtract(new BigDecimal(&quot;0.8&quot;)));System.out.println(new BigDecimal(&quot;4.015&quot;).multiply(new BigDecimal(&quot;100&quot;)));System.out.println(new BigDecimal(&quot;123.3&quot;).divide(new BigDecimal(&quot;100&quot;)));0.30.2401.5001.233</code></pre><ul><li><p>BigDecimal </p><ul><li>æœ‰scale, Precisionçš„æ¦‚å¿µ</li><li>scale è¡¨ç¤ºå°æ•°ç‚¹å³è¾¹çš„ä½æ•°</li><li>precision è¡¨ç¤ºç²¾åº¦ï¼Œå³æœ‰æ•ˆæ•°å­—çš„é•¿åº¦</li></ul></li><li><p>BigDecimalçš„equalsåˆ¤ç­‰</p><ul><li>æ¯”è¾ƒçš„æ˜¯valueå’Œscale ä¸¤ä¸ªå€¼çš„ï¼</li></ul></li></ul><pre><code>System.out.println(new BigDecimal(&quot;1.0&quot;).equals(new BigDecimal(&quot;1&quot;)))false</code></pre><pre><code>/** * Compares this {@code BigDecimal} with the specified * {@code Object} for equality.  Unlike {@link * #compareTo(BigDecimal) compareTo}, this method considers two * {@code BigDecimal} objects equal only if they are equal in * value and scale (thus 2.0 is not equal to 2.00 when compared by * this method). * * @param  x {@code Object} to which this {@code BigDecimal} is *         to be compared. * @return {@code true} if and only if the specified {@code Object} is a *         {@code BigDecimal} whose value and scale are equal to this *         {@code BigDecimal}&#39;s. * @see    #compareTo(java.math.BigDecimal) * @see    #hashCode */@Overridepublic boolean equals(Object x)</code></pre><h1 id="3-æ•°å€¼æº¢å‡ºé—®é¢˜"><a href="#3-æ•°å€¼æº¢å‡ºé—®é¢˜" class="headerlink" title="3. æ•°å€¼æº¢å‡ºé—®é¢˜"></a>3. æ•°å€¼æº¢å‡ºé—®é¢˜</h1><p>æ‰€æœ‰çš„åŸºæœ¬æ•°å€¼ç±»å‹éƒ½æœ‰è¶…å‡ºè¡¨è¾¾èŒƒå›´çš„å¯èƒ½æ€§ï¼Œè€Œä¸”æ˜¯æ²¡æœ‰ä»»ä½•å¼‚å¸¸çš„é»˜é»˜çš„æº¢å‡º</p><ul><li>å¯ä»¥ä½¿ç”¨Mathç±»çš„addExact, substractExactç­‰æ–¹æ³•è¿›è¡Œæ•°å€¼è¿ç®—ï¼Œåœ¨æº¢å‡ºçš„æ—¶å€™ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸</li><li>ä¹Ÿå¯ä»¥ä½¿ç”¨BigIntegerï¼Œä¹Ÿä¼šä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸</li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java åˆ¤ç­‰é—®é¢˜</title>
      <link href="/Java-%E5%88%A4%E7%AD%89%E9%97%AE%E9%A2%98/"/>
      <url>/Java-%E5%88%A4%E7%AD%89%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-equals-vs"><a href="#1-equals-vs" class="headerlink" title="1. equals vs =="></a>1. equals vs <code>==</code></h1><ul><li>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œåº”ä½¿ç”¨==ï¼Œæ¯”è¾ƒçš„æ˜¯å€¼ </li><li>å¯¹äºå¼•ç”¨ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨equalsï¼Œè¿›è¡Œå†…å®¹åˆ¤ç­‰ã€‚ä½¿ç”¨<code>==</code>åˆ¤æ–­çš„æ˜¯æŒ‡é’ˆ â€“&gt; ä»£è¡¨çš„æ˜¯ä¸¤ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€</li></ul><p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯Javaæ˜¯æœ‰å­—ç¬¦ä¸²å¸¸é‡æ± æœºåˆ¶çš„ï¼Œå½“ä»£ç ä¸­å‡ºç°åŒå¼•å·å½¢å¼åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡çš„æ—¶å€™ï¼ŒJVMä¼šå…ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± å­˜åœ¨ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼Œå°±å°†è¿™ä¸ªå¼•ç”¨è¿”å›ï¼›å¦åˆ™å°±åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç„¶åå°†è¿™ä¸ªå¼•ç”¨æ”¾å…¥å­—ç¬¦ä¸²å¸¸é‡æ± å½“ä¸­ï¼Œå¹¶è¿”å›è¯¥å¼•ç”¨</p><p>å¦å¤–ä¸€ä¸ªå°å‘æ˜¯Integeråœ¨[-128,127]ä¹‹é—´çš„æ•°å€¼æ˜¯ä¼šåšç¼“å­˜çš„ï¼Œå³å¯¹äºè¿™ä¸­é—´çš„æ•°å€¼ï¼Œå³ä¾¿ä½ ç›´æ¥ç”¨<code>==</code>è¿›è¡Œåˆ¤æ–­ï¼Œæœ‰å¯èƒ½æ˜¯ç›´æ¥ä¼šè¿‡çš„â€¦</p><pre><code>public static Integer valueOf(int i) {    if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)        return IntegerCache.cache[i + (-IntegerCache.low)];    return new Integer(i);}</code></pre><h2 id="1-1-equalsæ–¹æ³•çš„å®ç°"><a href="#1-1-equalsæ–¹æ³•çš„å®ç°" class="headerlink" title="1.1 equalsæ–¹æ³•çš„å®ç°"></a>1.1 equalsæ–¹æ³•çš„å®ç°</h2><ul><li>equalsåœ¨Objectç±»å½“ä¸­çš„å®šä¹‰æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å¼•ç”¨</li></ul><pre><code>public boolean equals(Object obj) {    return (this == obj);}</code></pre><ul><li>è€ŒIntegerï¼ŒStringç±»éƒ½é‡å†™äº†è¿™ä¸ªæ–¹æ³•</li></ul><pre><code>public boolean equals(Object anObject) {    if (this == anObject) {        return true;    }    if (anObject instanceof String) {        String anotherString = (String)anObject;        int n = value.length;        if (n == anotherString.value.length) {            char v1[] = value;            char v2[] = anotherString.value;            int i = 0;            while (n-- != 0) {                if (v1[i] != v2[i])                    return false;                i++;            }            return true;        }    }    return false;}</code></pre><p>ä¸Šè¿°ä»£ç æ˜¯å…ˆæ¯”è¾ƒäº†å¼•ç”¨ï¼Œå¦‚æœå¼•ç”¨çš„åœ°å€ä¸€è‡´ï¼Œé‚£ä¹ˆä¹…å¯ä»¥ç›´æ¥è¿”å›trueäº†ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œé‚£å°±é¦–å…ˆåˆ¤æ–­ç±»çš„ç±»å‹ï¼Œå¦‚æœæ˜¯Stringç±»ï¼Œå†è¿›è¡Œé•¿åº¦åˆ¤æ–­ï¼Œå¦‚æœé•¿åº¦ä¸€è‡´ï¼Œå°±é€ä¸ªæ¯”è¾ƒå­—ç¬¦</p><ul><li>å®ç°ä¸€ä¸ªequalsæ–¹æ³•ï¼Œéœ€è¦æ³¨æ„<ul><li>é¦–å…ˆè¿›è¡ŒæŒ‡é’ˆåˆ¤æ–­ï¼Œå¦‚æœå¯¹è±¡ç›¸åŒç›´æ¥è¿”å›true</li><li>éœ€è¦å¯¹å¦ä¸€æ–¹è¿›è¡Œåˆ¤ç©ºï¼Œç©ºå¯¹è±¡å’Œè‡ªèº«çš„æ¯”è¾ƒç»“æœä¸€å®šæ˜¯false</li><li>éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œå¦‚æœç±»å‹éƒ½ä¸åŒï¼Œé‚£ä¹ˆç›´æ¥è¿”å›false</li><li>åœ¨ç¡®ä¿ç±»å‹ç›¸åŒçš„æƒ…å†µä¸‹è¿›è¡Œç±»å‹çš„å¼ºåˆ¶è½¬æ¢ï¼Œç„¶åé€ä¸€åˆ¤æ–­æ‰€æœ‰å­—æ®µ<ul><li>éœ€è¦è¿›è¡Œç±»å‹å¼ºåˆ¶è½¬æ¢æ˜¯å› ä¸ºæˆ‘ä»¬overrideçš„equalsæ–¹æ³•é»˜è®¤çš„è¾“å…¥å‚æ•°æ˜¯Object</li></ul></li></ul></li></ul><h2 id="1-2-ä½¿ç”¨Lombokçš„å°å‘"><a href="#1-2-ä½¿ç”¨Lombokçš„å°å‘" class="headerlink" title="1.2 ä½¿ç”¨Lombokçš„å°å‘"></a>1.2 ä½¿ç”¨Lombokçš„å°å‘</h2><p>Lombokçš„@Dataæ³¨è§£ä¼šå¸®åŠ©æˆ‘ä»¬å®ç°equalså’Œhashcodeæ–¹æ³•ï¼Œä½†æ˜¯æœ‰ç»§æ‰¿å…³ç³»çš„æ—¶å€™ï¼ŒLombokè‡ªåŠ¨ç”Ÿæˆçš„æ–¹æ³•æ˜¯ä¸ä¼šè€ƒè™‘åˆ°çˆ¶ç±»çš„</p><ul><li><p>å¯¹äºä¸æƒ³è¿›è¡Œequalså’ŒhashCodeåˆ¤æ–­çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p><ul><li><code>@EqualsAndHashCode.Exclude</code></li></ul></li><li><p>å¯¹äºæƒ³è¦ä½¿ç”¨çˆ¶ç±»å±æ€§çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨</p><ul><li><code>@EqualsAndHashCode(callSuper = true)</code></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring @Transactional äº‹åŠ¡Tips</title>
      <link href="/Spring-Transactional-%E4%BA%8B%E5%8A%A1Tips/"/>
      <url>/Spring-Transactional-%E4%BA%8B%E5%8A%A1Tips/</url>
      
        <content type="html"><![CDATA[<p>Springé’ˆå¯¹Transaction APi, JDBC, Hibernate, Java Persistence APIç­‰äº‹åŠ¡APIï¼Œå®ç°äº†ä¸€è‡´çš„ç¼–ç¨‹æ¨¡å‹ï¼Œè€ŒSpringçš„å£°æ˜å¼äº‹åŠ¡åŠŸèƒ½æä¾›äº†éå¸¸æ–¹ä¾¿çš„äº‹åŠ¡é…ç½®æ–¹å¼ï¼Œä½¿ç”¨<code>@Transactional</code>æ³¨è§£ï¼Œå°±å¯ä»¥ä¸€é”®å¼€å¯æ–¹æ³•çš„äº‹åŠ¡æ€§é…ç½®ã€‚</p><p>ä½†æ˜¯ä¸æ˜¯åŠ ä¸Šæ ‡æ³¨å°±èƒ½å®ç°äº‹åŠ¡çš„ï¼Œè¿˜æ˜¯éœ€è¦å»å…³æ³¨äº‹åŠ¡æ˜¯å¦æœ‰æ•ˆï¼Œå‡ºé”™ä»¥åäº‹åŠ¡æ˜¯å¦ä¼šæ­£ç¡®å›æ»šï¼Œå½“ä¸šåŠ¡ä»£ç è®¾è®¡åˆ°å¤šä¸ªå­ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™ï¼Œæ€ä¹ˆæ­£ç¡®å¤„ç†äº‹åŠ¡ã€‚</p><h1 id="1-äº‹åŠ¡ç”Ÿæ•ˆé—®é¢˜"><a href="#1-äº‹åŠ¡ç”Ÿæ•ˆé—®é¢˜" class="headerlink" title="1. äº‹åŠ¡ç”Ÿæ•ˆé—®é¢˜"></a>1. äº‹åŠ¡ç”Ÿæ•ˆé—®é¢˜</h1><pre><code>@Entity@Datapublic class UserEntity {    @Id    @GeneratedValue(strategy = AUTO)    private Long id;    private String name;    public UserEntity() { }    public UserEntity(String name) {        this.name = name;    }}@Repositorypublic interface UserRepository extends JpaRepository&lt;UserEntity, Long&gt; {    List&lt;UserEntity&gt; findByName(String name);}@Service@Slf4jpublic class UserService {    @Autowired    private UserRepository userRepository;    //ä¸€ä¸ªå…¬å…±æ–¹æ³•ä¾›Controllerè°ƒç”¨ï¼Œå†…éƒ¨è°ƒç”¨äº‹åŠ¡æ€§çš„ç§æœ‰æ–¹æ³•    public int createUserWrong1(String name) {        try {            this.createUserPrivate(new UserEntity(name));        } catch (Exception ex) {            log.error(&quot;create user failed because {}&quot;, ex.getMessage());        }        return userRepository.findByName(name).size();    }    //æ ‡è®°äº†@Transactionalçš„privateæ–¹æ³•    @Transactional    private void createUserPrivate(UserEntity entity) {        userRepository.save(entity);        if (entity.getName().contains(&quot;test&quot;))            throw new RuntimeException(&quot;invalid username!&quot;);    }    //æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·æ•°    public int getUserCount(String name) {        return userRepository.findByName(name).size();    }}</code></pre><p>ä¸Šè¿°ä»£ç ä½¿ç”¨JPAåšæ•°æ®åº“è®¿é—®ï¼ŒEntityå®šä¹‰åœ¨UserEntityå½“ä¸­ï¼Œåœ¨æœåŠ¡å±‚ï¼Œå£°æ˜äº†createUsræ–¹æ³•ï¼Œå½“åå­—åŒ…å«testçš„æ—¶å€™ï¼Œå¸Œæœ›æŠ›å‡ºå¼‚å¸¸ï¼Œç„¶åå®ç°æ•°æ®åº“çš„å›æ»šï¼ˆåªæ˜¯ä¾‹å­ï¼Œå½“ç„¶å®é™…å®ç°ä¸Šå°†åˆ¤æ–­å’Œæ•°æ®åº“å­˜å‚¨æ‰§è¡Œé¡ºåºæ¢è¿‡æ¥å°±èƒ½é¿å¼€è¿™é‡Œçš„é—®é¢˜äº†ï¼‰</p><p>å½“è°ƒç”¨çš„æ—¶å€™ï¼Œå‘ç°å³ä½¿ç”¨æˆ·åä¸åˆæ³•ï¼Œä¹Ÿèƒ½å¤Ÿè°ƒç”¨æˆåŠŸï¼Œè¿™æ˜¯å› ä¸ºä¸Šè¿°ä»£ç å°†æ³¨è§£å®šä¹‰åˆ°äº†privateæ–¹æ³•ï¼Œå› æ­¤ä¸ç”Ÿæ•ˆ</p><blockquote><p>åªæœ‰å®šä¹‰åœ¨publicæ–¹æ³•ä¸Šçš„@Transactionalæ‰èƒ½ç”Ÿæ•ˆï¼Œå› ä¸ºSpringé»˜è®¤é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼å®ç°AOPï¼Œå¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œå¢å¼ºï¼Œprivateæ–¹æ³•æ— æ³•ä»£ç†åˆ°ï¼ŒSpringä¹Ÿå°±æ— æ³•ä½¿ç”¨åŠ¨æ€å¢å¼ºäº‹åŠ¡å¤„ç†çš„é€»è¾‘äº†ã€‚</p></blockquote><p>ç„¶è€Œå°±ç®—æŠŠä¸Šè¿°çš„privateæ–¹æ³•æ”¹ä¸ºpublic transactionalä¾æ—§ä¸ä¼šç”Ÿæ•ˆï¼Œè¿™æ˜¯å› ä¸ºï¼š</p><blockquote><p>Transactionaléœ€è¦é€šè¿‡ä»£ç†è¿‡çš„ç±»ä»å¤–éƒ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•æ‰èƒ½ç”Ÿæ•ˆ</p></blockquote><p>Springé€šè¿‡AOPæŠ€æœ¯å¯¹æ–¹æ³•è¿›è¡Œå¢å¼ºï¼Œè¦è°ƒç”¨å¢å¼ºè¿‡çš„æ–¹æ³•å¿…ç„¶æ˜¯è°ƒç”¨ä»£ç†ä¹‹åçš„å¯¹è±¡</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨controllerå±‚è°ƒç”¨è¿™ä¸ªé€»è¾‘ï¼Œæ¥å®ç°æ•´ä¸ªtransactionalçš„æ”¯æŒã€‚å³ä½ éœ€è¦ä½¿ç”¨Springæ³¨å…¥çš„ç±»ï¼Œé€šè¿‡ä»£ç†è°ƒç”¨æ‰æœ‰æœºä¼šæ¥è¿›è¡ŒåŠ¨æ€çš„å¢å¼ºã€‚</p><h1 id="2-äº‹åŠ¡å›æ»šé—®é¢˜"><a href="#2-äº‹åŠ¡å›æ»šé—®é¢˜" class="headerlink" title="2. äº‹åŠ¡å›æ»šé—®é¢˜"></a>2. äº‹åŠ¡å›æ»šé—®é¢˜</h1><p>é€šè¿‡AOPé”å®ç°çš„äº‹åŠ¡å¤„ç†å¯ä»¥ç†è§£ä¸ºä½¿ç”¨try catchæ¥åŒ…è£¹æ ‡è®°äº†<code>@Transactional</code>æ³¨è§£çš„æ–¹æ³•ï¼Œå½“æ–¹æ³•å‡ºç°äº†å¼‚å¸¸å¹¶ä¸”æ»¡è¶³ä¸€å®šæ¡ä»¶çš„æ—¶å€™ï¼Œåœ¨catché‡Œé¢æˆ‘ä»¬å¯ä»¥è®¾ç½®äº‹åŠ¡å›æ»šï¼Œæ²¡æœ‰å¼‚å¸¸åˆ™ç›´æ¥æäº¤äº‹åŠ¡ã€‚</p><ol><li>åªæœ‰å¼‚å¸¸ä¼ æ’­å‡ºæ ‡è®°äº†æ³¨è§£çš„æ–¹æ³•ï¼Œäº‹åŠ¡æ‰èƒ½å›æ»š</li></ol><pre><code>try {   // This is an around advice: Invoke the next interceptor in the chain.   // This will normally result in a target object being invoked.   retVal = invocation.proceedWithInvocation();}catch (Throwable ex) {   // target invocation exception   completeTransactionAfterThrowing(txInfo, ex);   throw ex;}finally {   cleanupTransactionInfo(txInfo);}</code></pre><ol start="2"><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡ºç°RuntimeExceptionæˆ–è€…Errorçš„æ—¶å€™ï¼ŒSpringæ‰ä¼šå›æ»šäº‹åŠ¡</li></ol><p>åœ¨å¿…è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ‰‹åŠ¨è¿›è¡Œå›æ»šï¼Œä»¥åŠé‡åˆ°æ‰€æœ‰çš„Exceptionéƒ½å›æ»šäº‹åŠ¡</p><pre><code>@Transactionalpublic void createUserRight1(String name) {    try {        userRepository.save(new UserEntity(name));        throw new RuntimeException(&quot;error&quot;);    } catch (Exception ex) {        log.error(&quot;create user failed&quot;, ex);        TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();    }}@Transactional(rollbackFor = Exception.class)public void createUserRight2(String name) throws IOException {    userRepository.save(new UserEntity(name));    otherTask();}</code></pre><ul><li>æœ‰æ—¶æˆ‘ä»¬ä¼šé‡åˆ°åµŒå¥—é€»è¾‘ï¼Œåˆ†åˆ«éœ€è¦å®ç°äº‹åŠ¡çš„é—®é¢˜ï¼Œè€Œå­é€»è¾‘äº‹åŠ¡çš„å›æ»šä¸å¸Œæœ›å½±å“åˆ°çˆ¶é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨<code>@Transactional(propagation = Propagation.REQUIRES_NEW)</code>, ä»¥æ­¤æ¥è®¾ç½®äº‹åŠ¡ä¼ æ’­ç­–ç•¥ï¼Œå³æ‰§è¡Œåˆ°è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™éœ€è¦å¼€å¯æ–°çš„äº‹åŠ¡ï¼Œå¹¶æŒ‚èµ·å½“å‰äº‹åŠ¡ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTPè°ƒç”¨çš„è¶…æ—¶ï¼Œå¹¶å‘</title>
      <link href="/HTTP%E8%B0%83%E7%94%A8%E7%9A%84%E8%B6%85%E6%97%B6%EF%BC%8C%E5%B9%B6%E5%8F%91/"/>
      <url>/HTTP%E8%B0%83%E7%94%A8%E7%9A%84%E8%B6%85%E6%97%B6%EF%BC%8C%E5%B9%B6%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p>HTTPè°ƒç”¨çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡HTTPåè®®è¿›è¡Œä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œç½‘ç»œè¯·æ±‚ä¼šæœ‰è¶…æ—¶çš„å¯èƒ½æ€§ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘åˆ°ï¼š</p><ul><li>ä½¿ç”¨çš„æ¡†æ¶è®¾ç½®çš„é»˜è®¤è¶…æ—¶çš„åˆç†æ€§</li><li>è¶…æ—¶åçš„è¯·æ±‚é‡è¯•éœ€è¦è€ƒè™‘åˆ°æœåŠ¡ç«¯æ¥å£çš„å¹‚ç­‰æ€§ â€“ å³ä»»æ„å¤šæ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å½±å“æ˜¯å¦ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒ</li><li>éœ€è¦è€ƒè™‘æ¡†æ¶æ˜¯å¦ä¼šé™åˆ¶å¹¶å‘è¿æ¥æ•°ï¼Œä»¥å…åœ¨æœåŠ¡å¹¶å‘å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼ŒHTTPè°ƒç”¨çš„å¹¶å‘æ•°é™åˆ¶æˆä¸ºç“¶é¢ˆ </li></ul><p>å¸¸ç”¨æ¡†æ¶ï¼š </p><ul><li>Spring Cloud <ul><li>éœ€è¦ä½¿ç”¨Feignè¿›è¡Œå£°æ˜å¼çš„æœåŠ¡è°ƒç”¨</li></ul></li><li>Spring Boot<ul><li>ä½¿ç”¨Apache HttpClientè¿›è¡ŒæœåŠ¡è°ƒç”¨</li></ul></li></ul><h1 id="1-å¦‚ä½•é…ç½®è¿æ¥è¶…æ—¶"><a href="#1-å¦‚ä½•é…ç½®è¿æ¥è¶…æ—¶" class="headerlink" title="1. å¦‚ä½•é…ç½®è¿æ¥è¶…æ—¶"></a>1. å¦‚ä½•é…ç½®è¿æ¥è¶…æ—¶</h1><ul><li><p>HTTPè°ƒç”¨åº”ç”¨å±‚èµ°çš„æ˜¯HTTPåè®®ï¼Œä½†æ˜¯ç½‘ç»œå±‚è¿˜æ˜¯TCP/IPåè®®çš„</p><ul><li><p>TCP/ IPåè®®æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œåœ¨ä¼ è¾“æ•°æ®ä¹‹å‰éœ€è¦å»ºç«‹è¿æ¥</p></li><li><p>ç½‘ç»œæ¡†æ¶ä¼šæä¾›ä¸¤ä¸ªè¶…æ—¶å‚æ•°</p><ul><li><p>è¿æ¥è¶…æ—¶å‚æ•° ConnectTimeout</p><ul><li>å»ºç«‹è¿æ¥é˜¶æ®µçš„æœ€é•¿ç­‰å¾…æ—¶é—´</li><li>åº”è¯¥é…ç½®åœ¨1 - 5sä¹‹é—´ï¼Œå› ä¸ºTCPçš„ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥éœ€è¦çš„æ—¶é—´å®é™…ä¸Šæ˜¯éå¸¸çŸ­çš„ï¼Œè¶…å‡ºå¾€å¾€æ˜¯ç½‘ç»œæˆ–è€…é˜²ç«å¢™é…ç½®çš„é—®é¢˜</li></ul></li><li><p>è¯»å–è¶…æ—¶å‚æ•° ReadTimeout</p><ul><li><p>ç”¨æ¥æ§åˆ¶ä»Socketä¸Šè¯»å–æ•°æ®çš„æœ€é•¿ç­‰å¾…æ—¶é—´</p></li><li><p>è¯»å–è¶…æ—¶åŒ…æ‹¬</p><ul><li>ç½‘ç»œé—®é¢˜</li><li>æœåŠ¡ç«¯å¤„ç†ä¸šåŠ¡é€»è¾‘çš„æ—¶é—´</li></ul></li><li><p>å‚æ•°é…ç½®ä¸åº”è¿‡å¤§</p><ul><li>HTTPè¯·æ±‚ä¸€èˆ¬æ˜¯åŒæ­¥è°ƒç”¨ï¼Œå¦‚æœè¶…æ—¶å¾ˆé•¿ï¼Œåœ¨ç­‰å¾…æœåŠ¡ç«¯è¿”å›æ•°æ®çš„åŒæ—¶ï¼Œå®¢æˆ·ç«¯çº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾…</li><li>å½“ä¸‹æ¸¸æœåŠ¡å‡ºç°å¤§é‡è¶…æ—¶çš„æ—¶å€™ï¼Œç¨‹åºå¯èƒ½ä¹Ÿä¼šå—åˆ°æ‹–ç´¯åˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œæœ€ç»ˆå´©æºƒ</li></ul></li></ul></li></ul></li></ul></li></ul><ul><li>é¦–å…ˆå¯¹äºè¶…æ—¶æœ¬èº«<ul><li>æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦éƒ½æœ‰è´¡çŒ®çš„</li><li>æœ‰ä¸€è‡´çš„æ—¶é—´ä¼°è®¡</li><li>å¹³è¡¡ååé‡å’Œé”™è¯¯ç‡</li></ul></li></ul><h1 id="2-HTTPè°ƒç”¨å¹¶å‘é—®é¢˜"><a href="#2-HTTPè°ƒç”¨å¹¶å‘é—®é¢˜" class="headerlink" title="2. HTTPè°ƒç”¨å¹¶å‘é—®é¢˜"></a>2. HTTPè°ƒç”¨å¹¶å‘é—®é¢˜</h1><p>å¦‚æœä½¿ç”¨Apache çš„httpClientï¼Œåœ¨PoolingHttpClientConnectionManagerå½“ä¸­ï¼Œå®šä¹‰çš„å‚æ•°ï¼š </p><ul><li>defaultMaxPerRoute = 2<ul><li>åŒä¸€ä¸ªä¸»æœºæœ€å¤§çš„å¹¶å‘è¯·æ±‚ä¹¦ä¸º2</li></ul></li><li>maxTotal = 20<ul><li>ä¸»æœºçš„æœ€å¤§å¹¶å‘ä¸º20</li></ul></li></ul><pre><code>httpClient2 = HttpClients.custom().setMaxConnPerRoute(10).setMaxConnTotal(20).build();</code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ç¨‹æ± åˆ›å»º: Executors  vs ThreadPoolExecutor</title>
      <link href="/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%88%9B%E5%BB%BA-Executors-vs-ThreadPoolExecutor/"/>
      <url>/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%88%9B%E5%BB%BA-Executors-vs-ThreadPoolExecutor/</url>
      
        <content type="html"><![CDATA[<p>å·¥ç¨‹ä¸Šå¯¹äºçº¿ç¨‹æ± çš„ä½¿ç”¨å¿…ä¸å¯å°‘ï¼Œå¾ˆå¤šäººä¼šé€‰æ‹©ä½¿ç”¨Executors classå®šä¹‰çš„<code>newCachedThreadPool</code>ä»¥åŠ<code>newFixedThreadPool</code>ã€‚è¿™ç¯‡åšæ–‡å°±ç¨å¾®åˆ†æä¸€ä¸‹äºŒè€…é€‚ç”¨çš„åœºæ™¯ï¼Œä»¥åŠæˆ‘ä»¬åº”è¯¥ä½¿ç”¨Executorsçš„æ–¹æ³•è¿˜æ˜¯ç›´æ¥è°ƒç”¨ThreadPoolExecutoræ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p><p>é¦–å…ˆè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹äºŒè€…çš„æºç </p><pre><code>   /**     * Creates a thread pool that reuses a fixed number of threads     * operating off a shared unbounded queue.  At any point, at most     * {@code nThreads} threads will be active processing tasks.     * If additional tasks are submitted when all threads are active,     * they will wait in the queue until a thread is available.     * If any thread terminates due to a failure during execution     * prior to shutdown, a new one will take its place if needed to     * execute subsequent tasks.  The threads in the pool will exist     * until it is explicitly {@link ExecutorService#shutdown shutdown}.     *     * @param nThreads the number of threads in the pool     * @return the newly created thread pool     * @throws IllegalArgumentException if {@code nThreads &lt;= 0}     */    public static ExecutorService newFixedThreadPool(int nThreads) {        return new ThreadPoolExecutor(nThreads, nThreads,                                      0L, TimeUnit.MILLISECONDS,                                      new LinkedBlockingQueue&lt;Runnable&gt;());    }    /**     * Creates a thread pool that creates new threads as needed, but     * will reuse previously constructed threads when they are     * available.  These pools will typically improve the performance     * of programs that execute many short-lived asynchronous tasks.     * Calls to {@code execute} will reuse previously constructed     * threads if available. If no existing thread is available, a new     * thread will be created and added to the pool. Threads that have     * not been used for sixty seconds are terminated and removed from     * the cache. Thus, a pool that remains idle for long enough will     * not consume any resources. Note that pools with similar     * properties but different details (for example, timeout parameters)     * may be created using {@link ThreadPoolExecutor} constructors.     *     * @return the newly created thread pool     */    public static ExecutorService newCachedThreadPool() {        return new ThreadPoolExecutor(0, Integer.MAX_VALUE,                                      60L, TimeUnit.SECONDS,                                      new SynchronousQueue&lt;Runnable&gt;());    } </code></pre><p>äºŒè€…å¯¹æ¯”ï¼Œä½ ä¼šå‘ç°å®é™…ä¸Šä»–ä»¬éƒ½æ˜¯è°ƒç”¨çš„ThreadPoolExecutor,åªæ˜¯å‚æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚é‚£è®©æˆ‘ä»¬çœ‹çœ‹ThreadPoolExecutorçš„æºç </p><pre><code>    /**     * Creates a new {@code ThreadPoolExecutor} with the given initial     * parameters and default thread factory and rejected execution handler.     * It may be more convenient to use one of the {@link Executors} factory     * methods instead of this general purpose constructor.     *     * @param corePoolSize the number of threads to keep in the pool, even     *        if they are idle, unless {@code allowCoreThreadTimeOut} is set     * @param maximumPoolSize the maximum number of threads to allow in the     *        pool     * @param keepAliveTime when the number of threads is greater than     *        the core, this is the maximum time that excess idle threads     *        will wait for new tasks before terminating.     * @param unit the time unit for the {@code keepAliveTime} argument     * @param workQueue the queue to use for holding tasks before they are     *        executed.  This queue will hold only the {@code Runnable}     *        tasks submitted by the {@code execute} method.     * @throws IllegalArgumentException if one of the following holds:&lt;br&gt;     *         {@code corePoolSize &lt; 0}&lt;br&gt;     *         {@code keepAliveTime &lt; 0}&lt;br&gt;     *         {@code maximumPoolSize &lt;= 0}&lt;br&gt;     *         {@code maximumPoolSize &lt; corePoolSize}     * @throws NullPointerException if {@code workQueue} is null     */    public ThreadPoolExecutor(int corePoolSize,                              int maximumPoolSize,                              long keepAliveTime,                              TimeUnit unit,                              BlockingQueue&lt;Runnable&gt; workQueue) {        this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,             Executors.defaultThreadFactory(), defaultHandler);    }</code></pre><p>çœ‹ä¸€ä¸‹å…¶ä¸­éœ€è¦çš„å‡ ä¸ªå‚æ•°ï¼š</p><ul><li><p>corePoolSize</p><ul><li>åœ¨çº¿ç¨‹æ± ä¸­æœ€å°‘è¦ä¿æŒçš„çº¿ç¨‹æ•°é‡ï¼Œå“ªæ€•å·²ç»è¶…è¿‡äº†å®šä¹‰çš„keepAliveTime </li></ul></li><li><p>maximumPoolSize</p><ul><li>çº¿ç¨‹æ± å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°é‡</li></ul></li><li><p>keepAliveTime</p><ul><li>å½“å½“å‰çº¿ç¨‹æ•°è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°é‡çš„æ—¶å€™ï¼Œå°±ä¼šæ£€æŸ¥é—²ç½®çš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´æ²¡æœ‰æ–°çš„ä»»åŠ¡ï¼Œå°±æš‚åœå½“å‰çº¿ç¨‹</li></ul></li><li><p>unit</p><ul><li>å®šä¹‰äº‹ä»¶å•ä½</li></ul></li><li><p>workQueue</p><ul><li>åœ¨ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œä¹‹å‰ï¼Œè¢«ç”¨æ¥æŒæœ‰è¿™äº›ä»»åŠ¡çš„</li><li>queueä¹‹åæŒæœ‰executeæ–¹æ³•æäº¤çš„Runnableä»»åŠ¡</li></ul></li></ul><p>å¸¦ç€è¿™äº›ä¿¡æ¯æˆ‘ä»¬å†æ¥çœ‹Executors.newFixedThreadPoolçš„å®šä¹‰ï¼Œæ–¹æ³•ä¼ å…¥äº†çº¿ç¨‹æ•°é‡ï¼Œç„¶åæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°è¢«è®¾ä¸ºä¸€æ ·çš„æ•°å€¼ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ä¸åŒæƒ…å†µä¸‹ä»–çš„è¡¨ç°ï¼š</p><ul><li><p>ä»»åŠ¡æ•°å°äºç­‰äºè®¾å®šçš„çº¿ç¨‹æ•°</p><ul><li>ä¸€åˆ‡è¿è¡Œæ­£å¸¸</li><li>é™åˆ¶çš„çº¿ç¨‹ä¸ä¼šè¢«å…³é—­</li></ul></li><li><p>ä»»åŠ¡æ•°å¤§äºè®¾å®šçš„çº¿ç¨‹æ•°</p><ul><li>ä»»åŠ¡ä¼šåŠ å…¥åˆ°é˜Ÿåˆ—å½“ä¸­ï¼Œè¿›è¡Œç­‰å¾…</li><li>å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨å®ä¾‹åŒ–LinkedBlockingQueueçš„æ—¶å€™ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯<code>this(Integer.MAX_VALUE);</code><ul><li>è¿™æ„å‘³ç€å¦‚æœä»»åŠ¡åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ—¶é—´éå¸¸é•¿ï¼Œä»»åŠ¡å¯ä»¥åœ¨é˜Ÿåˆ—ä¸­å †ç§¯åˆ°æ— é™å¤§ï¼Œæœ€ç»ˆç»“æœä¼šæ˜¯å†…å­˜è¢«å æ»¡..ç¨‹åºå´©æºƒ</li></ul></li></ul></li></ul><p>è€Œå¯¹äºExecutors.newCachedThreadPoolæ¥è¯´ï¼Œå…¶å®šä¹‰çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡ä¸º0ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ˜¯<code>Integer.MAX_VALUE</code>,å³ç†è®ºä¸Šæ˜¯å¯ä»¥æœ‰æ— é™å¤šçš„çº¿ç¨‹ï¼ŒkeepAliveTimeæ˜¯60ç§’ï¼Œä½¿ç”¨çš„æ˜¯SynchrounousQueueã€‚</p><ul><li>å½“ä»»åŠ¡è¿›æ¥çš„æ—¶å€™<ul><li>ä¼šå¢åŠ çº¿ç¨‹</li><li>æœ‰å¤šå°‘ä»»åŠ¡è¿›æ¥ï¼Œå°±ä¼šä½¿ç”¨ThreadFactoryå¼€å¤šå°‘çº¿ç¨‹ï¼Œå› ä¸ºå…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°æ—¶æ— é™å¤§ï¼Œæ‰€ä»¥å¯ä»¥ä¸€ç›´è¿™ä¹ˆå¼€ä¸‹å»</li><li>è€Œå…¶workqueueæ˜¯SynchrounousQueue,å…¶å¤§å°å§‹ç»ˆä¸º0ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»»åŠ¡å½“ä»»åŠ¡è¿›æ¥çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œä¼šç›´æ¥è®©ThreadFactoryæ¥æ„å»ºæ–°çš„çº¿ç¨‹äº†</li><li>é‚£ä¹ˆå½“ä»»åŠ¡æ— é™å¤šçš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºæ— æ•°å¤šçš„çº¿ç¨‹ï¼Œç›´æ¥æ’‘çˆ†å†…å­˜äº†</li></ul></li></ul><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºæ¥ä½¿ç”¨Executorsçš„ä¸¤ä¸ªæ–¹æ³•ç›´æ¥æ„å»ºçº¿ç¨‹æ± å› ä¸ºè®¾å®šçš„å‚æ•°æ˜¯æ— ç•Œçš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´OOMçš„é”™è¯¯ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯è‡ªå·±æ ¹æ®å½“å‰çº¿ç¨‹æ± çš„åº”ç”¨åœºæ™¯ï¼Œæ¥è®¾å®šå‚æ•°ã€‚</p><p>æ ¹æ®åº”ç”¨åœºæ™¯çš„ä¸åŒï¼Œæ ¹æ®docï¼Œæˆ‘ä»¬æœ‰ä¸‰å¤§ç±»çš„queueå¯ä»¥é€‰æ‹©ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li><p><code>Synchronous queue</code></p><ul><li>ç›´æ¥è®²ä»»åŠ¡äº¤ç»™çº¿ç¨‹</li><li>è‡ªå·±æœ¬èº«ä¸æŒæœ‰ä»»ä½•ä»»åŠ¡çš„</li><li>é’ˆå¯¹çš„åº”ç”¨åœºæ™¯å¯ä»¥æ˜¯å„ä¸ªçº¿ç¨‹ä¹‹é—´ä»»åŠ¡çš„æ‰§è¡Œæœ‰æŸäº›å†…åœ¨çš„è”ç³»ï¼Œé˜»ç¢ä¸€ä¸ªçš„æ‰§è¡Œå¯èƒ½ä¼šå½±å“å¦å¤–ä¸€ä¸ª</li><li>ä¸ºäº†ä¸æ‹’ç»æ–°çš„çº¿ç¨‹çš„åˆ›å»ºï¼Œå°±å¿…é¡»è®¾å®šçº¿ç¨‹æ± çš„å¤§å°ä¸ºInteger.MAX_VALUE</li><li>è¿™æ ·å¦‚æœå¤„ç†é€Ÿåº¦ä½äºæ–°ä»»åŠ¡çš„æäº¤é€Ÿåº¦çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´éå¸¸éå¸¸å¤§çš„çº¿ç¨‹æ± </li></ul></li><li><p><code>LinkedBlockingQueue</code></p><ul><li>ä½¿ç”¨æ²¡æœ‰è¾¹ç•Œçš„queue</li><li>è¿™æ ·å½“æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹éƒ½å¿™ç¢Œçš„æ—¶å€™ï¼Œä»»åŠ¡å°±éƒ½ä¼šåœ¨é˜Ÿåˆ—å½“ä¸­æ’é˜Ÿ</li><li>è¿™ç§æ–¹å¼å¯ä»¥ç¯èŠ‚çªå‘æ€§çš„å³°å€¼ï¼Œä½†æ˜¯å¦‚æœå¤„ç†é€Ÿåº¦æ…¢äºä»»åŠ¡å †ç§¯çš„é€Ÿåº¦ï¼Œqueueä¼šå˜å¾—å¾ˆå¤§</li></ul></li><li><p><code>ArrayBlockingQueue</code></p><ul><li>æœ‰é™é•¿çš„queue</li><li>è¿™æ ·å¯ä»¥é˜²æ­¢èµ„æºè€—å°½ï¼Œä½†æ˜¯ä¹Ÿå¾ˆéš¾åšè°ƒæ•´å’Œä¼˜åŒ–</li><li>é˜Ÿåˆ—çš„å¤§å°å’Œæœ€å¤§çº¿ç¨‹æ•°ç›¸äº’å½±å“ï¼Œå¾ˆéš¾åšåˆ°ä¼˜åŒ–</li><li>ä½¿ç”¨å¤§é˜Ÿåˆ—ï¼Œå°çº¿ç¨‹æ± å¯ä»¥å‡å°‘å¯¹äºCPUçš„ä½¿ç”¨ï¼Œçº¿ç¨‹åˆ‡æ¢çš„æŸè€—ï¼Œä½†æ˜¯å•ä½æ—¶é—´å¤„ç†é€Ÿåº¦ä¸ä¼šå¤ªé«˜</li><li>ä½¿ç”¨å°é˜Ÿåˆ—ï¼Œå¤§çº¿ç¨‹æ± å¯ä»¥è®©CPUæ›´å¿™ç¢Œï¼Œä½†æ˜¯åˆ‡æ¢çº¿ç¨‹ä¼šæœ‰ä¸å°çš„æŸè€—</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.ibm.com/developerworks/library/j-jtp0730/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/library/j-jtp0730/index.html</a> </li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Executors </tag>
            
            <tag> ThreadPoolExecutor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS CDK Overview</title>
      <link href="/AWS-CDK-Overview/"/>
      <url>/AWS-CDK-Overview/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li><p>AWS CDK </p><ul><li><p>Open source software development framework </p></li><li><p>Model and provision your cloud application resources</p></li><li><p>To resolve what issue? </p><ul><li>provision cloud applications is challenging cause require<ul><li>manual actions</li><li>custom scripts </li><li>maintain templates </li><li>domain specific languages </li></ul></li></ul></li><li><p>How does CDK resolve the issue?</p><ul><li>Provides with high level component that pre-configure cloud resources with proven defaults</li><li>Provision your resources through AWS CloudFormation </li></ul></li></ul></li></ul><h2 id="1-1-Workflow"><a href="#1-1-Workflow" class="headerlink" title="1.1 Workflow"></a>1.1 Workflow</h2><ul><li>Creating an Amazon ECS service with AWS Fargate launch type </li></ul><pre><code>public class MyEcsConstructStack extends Stack {    public MyEcsConstructStack(final Construct scope, final String id) {        this(scope, id, null);    }    public MyEcsConstructStack(final Construct scope, final String id,            StackProps props) {        super(scope, id, props);        Vpc vpc = Vpc.Builder.create(this, &quot;MyVpc&quot;).maxAzs(3).build();        Cluster cluster = Cluster.Builder.create(this, &quot;MyCluster&quot;)                .vpc(vpc).build();        ApplicationLoadBalancedFargateService.Builder.create(this, &quot;MyFargateService&quot;)                .cluster(cluster)                .cpu(512)                .desiredCount(6)                .taskImageOptions(                       ApplicationLoadBalancedTaskImageOptions.builder()                               .image(ContainerImage                                       .fromRegistry(&quot;amazon/amazon-ecs-sample&quot;))                               .build()).memoryLimitMiB(2048)                .publicLoadBalancer(true).build();    }}</code></pre><ul><li><p>Basic workflow</p><ul><li>create the app from a template provided by the AWS CDK</li><li>add code to the app to create resources within stacks</li><li>build the app </li><li>synthesize one or more stacks in the app to create an AWS CloudFormation template </li><li>deploy one or more stacks to your AWS account </li></ul></li><li><p>Benefits </p><ul><li>Could use logic when defining infrastructure </li><li>Use object-oriented techniques to create a model of system </li><li>Define high level abstractions</li></ul></li><li><p>Tools</p><ul><li><p><a href="https://docs.aws.amazon.com/cdk/latest/guide/cli.html" target="_blank" rel="noopener">CDK Toolkit</a> </p><ul><li>CLI for interacting with CDK apps </li><li>Enable developers to synthesize artifacts such as AWS CloudFormation templates, deploy stacks to development AWS accounts, and diff against a deployed stack to understand the impact of a code change </li></ul></li><li><p><a href="https://docs.aws.amazon.com/cdk/latest/guide/constructs.html" target="_blank" rel="noopener">AWS Construct Library</a></p><ul><li>contains constructs representing AWS resources </li><li>encapsulate the details of how to create resources for an Amazon or AWS service </li></ul></li></ul></li></ul><h2 id="1-1-1-Create-and-build-the-app"><a href="#1-1-1-Create-and-build-the-app" class="headerlink" title="1.1.1 Create and build the app"></a>1.1.1 Create and build the app</h2><pre><code>mkdir hello-cdk &amp;&amp; cd hello-cdkcdk init TEMPLATE --language LANGUAGE cdk init app --language java// In your IDE, import it as maven project mvn compile cdk ls </code></pre><h3 id="1-1-2-Add-an-Amazon-S3-Bucket"><a href="#1-1-2-Add-an-Amazon-S3-Bucket" class="headerlink" title="1.1.2 Add an Amazon S3 Bucket"></a>1.1.2 Add an Amazon S3 Bucket</h3><pre><code>// Add dependencies to pom.xml &lt;dependency&gt;    &lt;groupId&gt;software.amazon.awscdk&lt;/groupId&gt;    &lt;artifactId&gt;s3&lt;/artifactId&gt;    &lt;version&gt;${cdk.version}&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>Define an Amazon S3 bucket in the stack using L2 construct </p><pre><code>package com.myorg;import software.amazon.awscdk.core.*;import software.amazon.awscdk.services.s3.Bucket;public class HelloCdkStack extends Stack {    public HelloCdkStack(final Construct scope, final String id) {        this(scope, id, null);    }    public HelloCdkStack(final Construct scope, final String id, final StackProps props) {        super(scope, id, props);        Bucket.Builder.create(this, &quot;MyFirstBucket&quot;)            .versioned(true).build();    }}</code></pre><h3 id="1-1-3-Systhesize-an-AWS-CloudFormation-Template"><a href="#1-1-3-Systhesize-an-AWS-CloudFormation-Template" class="headerlink" title="1.1.3 Systhesize an AWS CloudFormation Template"></a>1.1.3 Systhesize an AWS CloudFormation Template</h3><pre><code>cdk synth</code></pre><h3 id="1-1-4-Deploying-the-stack"><a href="#1-1-4-Deploying-the-stack" class="headerlink" title="1.1.4 Deploying the stack"></a>1.1.4 Deploying the stack</h3><p><code>cdk deploy</code></p><h3 id="1-1-5-Modifying-the-stack"><a href="#1-1-5-Modifying-the-stack" class="headerlink" title="1.1.5 Modifying the stack"></a>1.1.5 Modifying the stack</h3><pre><code>// after make your change cdk diff cdk deploy // Possibly destroy cdk destroy </code></pre><ul><li>Synthesize before deploying <h1 id="2-Basic-concepts"><a href="#2-Basic-concepts" class="headerlink" title="2. Basic concepts"></a>2. Basic concepts</h1></li></ul><h2 id="2-1-Constructs"><a href="#2-1-Constructs" class="headerlink" title="2.1 Constructs"></a>2.1 Constructs</h2><h3 id="2-1-1-Basics"><a href="#2-1-1-Basics" class="headerlink" title="2.1.1 Basics"></a>2.1.1 Basics</h3><ul><li><p>Constructs </p><ul><li><p>Basic building blocks </p></li><li><p>represents a cloud component, encapsulates everything AWS CloudFormation needs to create the component </p></li><li><p>[AWS Construct Library](<a href="https://docs.aws.amazon.com/cdk/api/latest/docs/aws-construct-library.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/cdk/api/latest/docs/aws-construct-library.html</a></p></li><li><p>defferent level of constructs </p><ul><li><p>CFN Resources/ L1 </p><ul><li>directly represent all of the AWS resources that are available in AWS CloudFormation </li><li>named as CfnXyz, where xyz is name of the resource </li><li><strong>When you use CFN resources, you must explicitly configure all resource properties, which requires a complete understanding of the details of the underlying AWS CloudFormation resource model</strong></li></ul></li><li><p>AWS Reousources/ L2 Constrcuts</p><ul><li>higher level, intent based API </li><li>provide defaults, boilerplate, and glue logic youâ€™d be writing with a CFN resource construct</li><li>Offer convenient defaults thus reduce the need for the detail of AWS resources  </li></ul></li><li><p>Patterns - higher level constructs </p><ul><li>designed to help you complete common tasks in AWS, often involving multiple kinds of resources </li></ul></li></ul></li></ul></li></ul><pre><code>// L1 ConstructCfnBucket bucket = CfnBucket.Builder.create(this, &quot;MyBucket&quot;)                        .bucketName(&quot;MyBucket&quot;)                        .corsConfiguration(new CfnBucket.CorsConfigurationProperty.Builder()                            .corsRules(Arrays.asList(new CfnBucket.CorsRuleProperty.Builder()                                .allowedOrigins(Arrays.asList(&quot;*&quot;))                                .allowedMethods(Arrays.asList(&quot;GET&quot;))                                .build()))                            .build())                        .build();// L2 Constructimport software.amazon.awscdk.services.s3.*;public class HelloCdkStack extends Stack {    public HelloCdkStack(final Construct scope, final String id) {        this(scope, id, null);    }    public HelloCdkStack(final Construct scope, final String id, final StackProps props) {        super(scope, id, props);        Bucket.Builder.create(this, &quot;MyFirstBucket&quot;)                .versioned(true).build();    }}</code></pre><h3 id="2-1-2-Hierarchy-Composition"><a href="#2-1-2-Hierarchy-Composition" class="headerlink" title="2.1.2 Hierarchy - Composition"></a>2.1.2 Hierarchy - Composition</h3><ul><li><p>Composition </p><ul><li>High level construct can be composed from any number of lower level constructs </li><li>In turn, those could be composed from even lower level constructs</li><li>Scoping pattern results in a hierarchy of constructs known as a construct tree </li></ul></li><li><p>Composition means you can define reusable components and share them like any other code </p></li></ul><h3 id="2-1-3-Initialization"><a href="#2-1-3-Initialization" class="headerlink" title="2.1.3 Initialization"></a>2.1.3 Initialization</h3><ul><li><p>Being implemented in classes that extend the Construct base class </p></li><li><p>3 parameters </p><ul><li><p>scope </p><ul><li>the construct within which this construct is defined </li></ul></li><li><p>id </p><ul><li>an identifier that much be unique within this scope </li><li>serves as a namespace for everything thatâ€™s encapsulated within the scopeâ€™s subtree </li><li>used to allocate unique identities such as resource names and AWS CloudFormation logical IDs </li></ul></li><li><p>props </p><ul><li>a set of properties or keyword arguments </li><li>define the constructâ€™s initial configuration </li></ul></li></ul></li></ul><h1 id="3-Java-Related"><a href="#3-Java-Related" class="headerlink" title="3. Java Related"></a>3. Java Related</h1><h2 id="3-1-AWS-CDK-idioms-in-Java"><a href="#3-1-AWS-CDK-idioms-in-Java" class="headerlink" title="3.1 AWS CDK idioms in Java"></a>3.1 AWS CDK idioms in Java</h2><ul><li>Props <ul><li>expressed with Builder pattern </li><li>define a bundle of key/ value pairs that the construct uses to configure the resources it creates </li></ul></li></ul><pre><code>Bucket bucket = new Bucket(this, &quot;MyBucket&quot;, new BucketProps.Builder()                           .versioned(true)                           .encryption(BucketEncryption.KMS_MANAGED)                           .build());</code></pre><ul><li>missing values <ul><li>it will be represented by <code>null</code></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Git æµç¨‹</title>
      <link href="/Git-%E6%B5%81%E7%A8%8B/"/>
      <url>/Git-%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>è§£å†³git conflictæ°¸è¿œéƒ½æ˜¯ä»¶å¾ˆè®©äººå¤´ç–¼çš„äº‹æƒ…ï¼Œä¸ºäº†è®©ç”Ÿæ´»æ›´ç®€å•ï¼Œè¿˜æ˜¯éœ€è¦è®¾å®šæ­£ç¡®çš„gitæµç¨‹çš„ã€‚ç°åœ¨æœ‰å¦‚ä¸‹å‡ ç§git æµç¨‹</p><h1 id="1-åŸºæœ¬çš„Git-æµç¨‹"><a href="#1-åŸºæœ¬çš„Git-æµç¨‹" class="headerlink" title="1. åŸºæœ¬çš„Git æµç¨‹"></a>1. åŸºæœ¬çš„Git æµç¨‹</h1><p>åªæœ‰ä¸€ä¸ªbranch â€“ master. å¼€å‘è€…ç›´æ¥commitè¿›å»ï¼Œç„¶åä¼šè¿›å…¥åˆ°alphaï¼Œbeta, gamma, prodç­‰ä¸åŒçš„ç”Ÿäº§çŠ¶æ€å½“ä¸­ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œé™¤éä½ åœ¨è‡ªå·±å•ç‹¬å®ŒæˆæŸé¡¹å°ä»»åŠ¡ï¼Œæ˜¯å¾ˆä¸æ¨èè¿™æ ·åšçš„ã€‚</p><p>ç¼ºé™·åœ¨äºï¼š</p><ul><li>ä»£ç ä¸Šçš„åˆä½œå˜å¾—å¾ˆå›°éš¾ï¼Œå¯èƒ½ä¼šæœ‰å¤šæ¬¡å†²çªï¼Œéœ€è¦é€æ¬¡è¿›è¡Œè§£å†³</li></ul><h1 id="2-Git-featureåˆ†æ”¯æµç¨‹"><a href="#2-Git-featureåˆ†æ”¯æµç¨‹" class="headerlink" title="2. Git featureåˆ†æ”¯æµç¨‹"></a>2. Git featureåˆ†æ”¯æµç¨‹</h1><p>å½“åœ¨åŒä¸€ä¸ªcodebaseæˆ‘ä»¬æœ‰å¤šä¸ªå·¥ç¨‹å¸ˆå…±åŒå·¥ä½œçš„æ—¶å€™ï¼Œä½¿ç”¨featureåˆ†æ²»å°±å˜æˆäº†å¿…ä¸å¯å°‘çš„äº‹æƒ…äº†ã€‚</p><p>å¦‚æœç°åœ¨æœ‰ä¸¤ä¸ªå·¥ç¨‹å¸ˆåœ¨åŒä¸€ä¸ªbranchä¸Šå·¥ä½œï¼Œæ¥æäº¤è‡ªå·±çš„ä»£ç ï¼Œé‚£æœ€ç»ˆä¸€å®šæ˜¯å†²çªä¸æ–­çš„ï¼Œå¾ˆå®¹æ˜“å‡ºç°å„ç§é—®é¢˜ã€‚</p><p>ä¸ºäº†é¿å…å‡ºç°è¿™ç§æƒ…å†µï¼Œä¸¤ä¸ªå¼€å‘è€…å¯ä»¥åˆ›å»ºä¸¤ä¸ªä¸åŒçš„åˆ†æ”¯ï¼Œåˆ†åˆ«åœ¨è‡ªå·±çš„åˆ†æ²»ä¸Šæ¥å¼€å‘è‡ªå·±çš„é¡¹ç›®ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸ç”¨æ‹…å¿ƒå¤§é‡éœ€è¦è§£å†³çš„å†²çªäº†ã€‚</p><h1 id="3-Git-featureåˆ†æ”¯æµç¨‹ä¸Developåˆ†æ”¯"><a href="#3-Git-featureåˆ†æ”¯æµç¨‹ä¸Developåˆ†æ”¯" class="headerlink" title="3. Git featureåˆ†æ”¯æµç¨‹ä¸Developåˆ†æ”¯"></a>3. Git featureåˆ†æ”¯æµç¨‹ä¸Developåˆ†æ”¯</h1><p>å’Œä¸Šè¿°çš„featureåˆ†æ”¯æµç¨‹å¾ˆç±»ä¼¼ï¼Œåªæ˜¯åˆåŠ äº†ä¸€ä¸ªDevelopåˆ†æ”¯ï¼Œåœ¨è¿™ä¸ªæµç¨‹ä¸‹ï¼Œmaster åˆ†æ”¯æ°¸è¿œåæ˜ ä¸€ä¸ªprod readyçš„çŠ¶æ€ã€‚</p><p>æ— è®ºä½•æ—¶ï¼Œå½“å°ç»„æƒ³è¦å°†ä»£ç éƒ¨ç½²åˆ°prodçš„æ—¶å€™ï¼Œä»–ä»¬ä»masteråˆ†æ”¯æ¥è¿›è¡Œéƒ¨ç½²</p><p>develop branchåæ˜ çš„æ˜¯å¸¦ç€æœ€æ–°çš„ä¸ºäº†ä¸‹æ¬¡å‘å¸ƒå‡†å¤‡çš„æ‰€æœ‰æ”¹åŠ¨ã€‚å¼€å‘è€…fork develop åˆ†æ”¯çš„ä»£ç ï¼Œæ¥åšç‹¬ç«‹å¼€å‘ã€‚ä¸€æ—¦é¡¹ç›®åšå¥½ï¼Œç»è¿‡äº†æµ‹è¯•ï¼Œå°±åˆå¹¶åˆ°developåˆ†æ”¯å½“ä¸­ï¼Œåœ¨developåˆ†æ”¯æ¥åšå……åˆ†çš„æµ‹è¯•ï¼Œç„¶åå†mergeåˆ°masteråˆ†æ”¯å½“ä¸­å»ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯èƒ½å¤Ÿå…è®¸å°ç»„æŒç»­mergeæ–°çš„åŠŸèƒ½ï¼ŒåšæŒç»­é›†æˆã€‚ä¸è¿‡è¿‡ç¨‹ç›¸å¯¹æ¯”è¾ƒéº»çƒ¦ã€‚ä¸ªäººè§‚ç‚¹æ˜¯åœ¨å°è§„æ¨¡çš„å‰æä¸‹ï¼Œä½¿ç”¨ç‰¹å¾åˆ†æ”¯å°±è¶³å¤Ÿäº†ï¼Œå†åŠ ä¸ŠæŒç»­é›†æˆçš„å·¥å…·ï¼Œè­¬å¦‚Jerkinsï¼Œå¾ˆå®‰å…¨ï¼Œæ•ˆç‡ä¹Ÿå¾ˆä¸é”™ã€‚</p><p><a href="https://zepel.io/blog/5-git-workflows-to-improve-development/" target="_blank" rel="noopener">https://zepel.io/blog/5-git-workflows-to-improve-development/</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java Notes</title>
      <link href="/Java-Notes/"/>
      <url>/Java-Notes/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¹¶å‘"><a href="#1-å¹¶å‘" class="headerlink" title="1. å¹¶å‘"></a>1. å¹¶å‘</h1><h2 id="1-1-ThreadLocalå¤ç”¨é—®é¢˜"><a href="#1-1-ThreadLocalå¤ç”¨é—®é¢˜" class="headerlink" title="1.1 ThreadLocalå¤ç”¨é—®é¢˜"></a>1.1 ThreadLocalå¤ç”¨é—®é¢˜</h2><p>ThreadLocalé€‚ç”¨äºå˜é‡åœ¨çº¿ç¨‹é—´éš”ç¦»ï¼Œè€Œåœ¨æ–¹æ³•æˆ–ç±»ä¹‹é—´å…±äº«çš„åœºæ™¯ã€‚å¦‚æœç”¨æˆ·ä¿¡æ¯çš„è·å–æ¯”è¾ƒæ˜‚è´µï¼Œé‚£ä¹ˆåœ¨ThreadLocalä¸­ç¼“å­˜æ•°æ®æ—¶æ¯”è¾ƒåˆé€‚çš„åšæ³•ã€‚</p><pre><code>private static final ThreadLocal&lt;Integer&gt; currentUser = ThreadLocal.withInitial(() -&gt; null);@GetMapping(&quot;wrong&quot;)public Map wrong(@RequestParam(&quot;userId&quot;) Integer userId) {    //è®¾ç½®ç”¨æˆ·ä¿¡æ¯ä¹‹å‰å…ˆæŸ¥è¯¢ä¸€æ¬¡ThreadLocalä¸­çš„ç”¨æˆ·ä¿¡æ¯    String before  = Thread.currentThread().getName() + &quot;:&quot; + currentUser.get();    //è®¾ç½®ç”¨æˆ·ä¿¡æ¯åˆ°ThreadLocal    currentUser.set(userId);    //è®¾ç½®ç”¨æˆ·ä¿¡æ¯ä¹‹åå†æŸ¥è¯¢ä¸€æ¬¡ThreadLocalä¸­çš„ç”¨æˆ·ä¿¡æ¯    String after  = Thread.currentThread().getName() + &quot;:&quot; + currentUser.get();    //æ±‡æ€»è¾“å‡ºä¸¤æ¬¡æŸ¥è¯¢ç»“æœ    Map result = new HashMap();    result.put(&quot;before&quot;, before);    result.put(&quot;after&quot;, after);    return result;}</code></pre><p>ä¸Šè¿°ä¾‹å­å½“ä¸­ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®å‰è®¾ç½®åéƒ½åšäº†è®°å½•ï¼Œæ¥çœ‹threadLocalå½“ä¸­éƒ½è®°å½•äº†ä»€ä¹ˆä¿¡æ¯ï¼Œã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ç¨‹åºæ˜¯è¿è¡Œåœ¨Tomcatå½“ä¸­çš„ï¼Œæ‰§è¡Œç¨‹åºçš„çº¿ç¨‹æ˜¯Tomcatçš„å·¥ä½œçº¿ç¨‹ï¼Œè€ŒTomcatçš„å·¥ä½œçº¿ç¨‹æ˜¯åŸºäºçº¿ç¨‹æ± çš„ã€‚</p><p>å³ä¼šé‡ç”¨å‡ ä¸ªå›ºå®šçš„çº¿ç¨‹ï¼Œä¸€æ—¦çº¿ç¨‹é‡ç”¨ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½é¦–æ¬¡ä»ThreadLocalè·å–çš„å€¼æ˜¯ä¹‹å‰å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚é—ç•™çš„å€¼ã€‚è¿™æ—¶ThreadLocalä¸­çš„ç”¨æˆ·ä¿¡æ¯å°±æ˜¯å…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯äº†ã€‚</p><p>Take Away: </p><ol><li>ä»£ç ä¸­æ²¡ç”¨å¤šçº¿ç¨‹ä¸ä»¥ä¸ºç€ä½ çš„ç¨‹åºæ²¡æœ‰ä½¿ç”¨å¤šçº¿ç¨‹ï¼ŒTomcatçš„WebæœåŠ¡å™¨çš„ä¸šåŠ¡ä»£ç ï¼Œæœ¬èº«å°±è¿è¡Œåœ¨ä¸€ä¸ªå¤šçº¿ç¨‹ç¯å¢ƒå½“ä¸­</li><li>ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†æ•°æ®å°±æ„å‘³ç€çº¿ç¨‹æ˜¯ä¼šè¢«é‡ç”¨çš„ï¼Œä½¿ç”¨ç±»ä¼¼ThreadLocalå·¥å…·æ¥å­˜æ”¾ä¸€äº›æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„åœ¨ä»£ç è¿è¡Œå®Œä¹‹åï¼Œæ˜¾å¼å»æ¸…ç©ºè®¾ç½®çš„æ•°æ®ã€‚</li></ol><p>ä¿®æ­£å¤ç”¨çš„é—®é¢˜çš„bugï¼š </p><pre><code>private static final ThreadLocal&lt;Integer&gt; currentUser = ThreadLocal.withInitial(() -&gt; null);@GetMapping(&quot;right&quot;)public Map right(@RequestParam(&quot;userId&quot;) Integer userId) {    String before  = Thread.currentThread().getName() + &quot;:&quot; + currentUser.get();    currentUser.set(userId);    try {        String after = Thread.currentThread().getName() + &quot;:&quot; + currentUser.get();        Map result = new HashMap();        result.put(&quot;before&quot;, before);        result.put(&quot;after&quot;, after);        return result;    } finally {        //åœ¨finallyä»£ç å—ä¸­åˆ é™¤ThreadLocalä¸­çš„æ•°æ®ï¼Œç¡®ä¿æ•°æ®ä¸ä¸²        currentUser.remove();    }}</code></pre><h2 id="1-2-ConcurrentHashMap"><a href="#1-2-ConcurrentHashMap" class="headerlink" title="1.2 ConcurrentHashMap"></a>1.2 ConcurrentHashMap</h2><ul><li>ConcurrentHashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨å®¹å™¨ï¼Œè¿™é‡Œçš„çº¿ç¨‹å®‰å…¨æ˜¯æŒ‡åŸå­æ€§è¯»å†™æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li><li>ä¾‹å­ â€“ 10ä¸ªçº¿ç¨‹ä¸€èµ·æ¥è¡¥å……æ€»å…±100ä¸ªå…ƒç´ è¿›å»</li></ul><pre><code>    //çº¿ç¨‹ä¸ªæ•°    private static int THREAD_COUNT = 10;    //æ€»å…ƒç´ æ•°é‡    private static int ITEM_COUNT = 1000;    //å¸®åŠ©æ–¹æ³•ï¼Œç”¨æ¥è·å¾—ä¸€ä¸ªæŒ‡å®šå…ƒç´ æ•°é‡æ¨¡æ‹Ÿæ•°æ®çš„ConcurrentHashMap    private ConcurrentHashMap&lt;String, Long&gt; getData(int count) {        return LongStream.rangeClosed(1, count)                .boxed()                .collect(Collectors.toConcurrentMap(i -&gt; UUID.randomUUID().toString(), Function.identity(),                        (o1, o2) -&gt; o1, ConcurrentHashMap::new));    }    @GetMapping(&quot;wrong&quot;)    public String wrong() throws InterruptedException {        ConcurrentHashMap&lt;String, Long&gt; concurrentHashMap = getData(ITEM_COUNT - 100);        //åˆå§‹900ä¸ªå…ƒç´         log.info(&quot;init size:{}&quot;, concurrentHashMap.size());        ForkJoinPool forkJoinPool = new ForkJoinPool(THREAD_COUNT);        //ä½¿ç”¨çº¿ç¨‹æ± å¹¶å‘å¤„ç†é€»è¾‘        forkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, 10).parallel().forEach(i -&gt; {            //æŸ¥è¯¢è¿˜éœ€è¦è¡¥å……å¤šå°‘ä¸ªå…ƒç´             int gap = ITEM_COUNT - concurrentHashMap.size();            log.info(&quot;gap size:{}&quot;, gap);            //è¡¥å……å…ƒç´             concurrentHashMap.putAll(getData(gap));        }));        //ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ        forkJoinPool.shutdown();        forkJoinPool.awaitTermination(1, TimeUnit.HOURS);        //æœ€åå…ƒç´ ä¸ªæ•°ä¼šæ˜¯1000å—ï¼Ÿ        log.info(&quot;finish size:{}&quot;, concurrentHashMap.size());        return &quot;OK&quot;;    }</code></pre><p>è¿™æ ·å­æ‰§è¡Œçš„ç»“æœå°±æ˜¯åŠ å…¥è¿œè¿œè¶…è¿‡é¢„æœŸçš„æ•°é‡ï¼Œå› ä¸ºConcurrentHashMapå¯ä»¥ä¿è¯å¤šä¸ªworkerå·¥ä½œçš„æ—¶å€™ä¸ä¼šäº’ç›¸å¹²æ‰°ï¼Œä½†æ˜¯æ— æ³•ä¿è¯çœ‹åˆ°çš„å½“å‰ConcurrentHashMapæ•°æ®æ•°é‡çš„åŒæ­¥</p><ul><li>Take Aways<ul><li>ä½¿ç”¨ConcurrentHashMapï¼Œä¸ä»£è¡¨å¯¹å…¶å¤šä¸ªæ“ä½œä¹‹é—´çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œæ˜¯æ²¡æœ‰å…¶ä»–çº¿ç¨‹åœ¨æ“ä½œå®ƒçš„ï¼Œå¦‚æœéœ€è¦ç¡®ä¿ï¼Œéœ€è¦æ‰‹åŠ¨åŠ é”</li><li>è¯¸å¦‚size,isEmptyå’ŒcontainsValueç­‰èšåˆæ–¹æ³•ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹å¯èƒ½ä¼šåæ˜ ConcurrentHashMapçš„<strong>ä¸­é—´çŠ¶æ€</strong>ï¼Œå› æ­¤åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œ<strong>*è¿™äº›æ–¹æ³•çš„è¿”å›å€¼åªèƒ½ç”¨ä½œå‚è€ƒï¼Œè€Œä¸èƒ½ç”¨äºæµç¨‹æ§åˆ¶</strong></li></ul></li></ul><p>è§£å†³æ–¹æ¡ˆå°±æ˜¯é€šè¿‡åŠ é”ï¼Œä½¿å¾—åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ“ä½œConcurrentHashMap</p><pre><code>@GetMapping(&quot;right&quot;)public String right() throws InterruptedException {    ConcurrentHashMap&lt;String, Long&gt; concurrentHashMap = getData(ITEM_COUNT - 100);    log.info(&quot;init size:{}&quot;, concurrentHashMap.size());    ForkJoinPool forkJoinPool = new ForkJoinPool(THREAD_COUNT);    forkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, 10).parallel().forEach(i -&gt; {        //ä¸‹é¢çš„è¿™æ®µå¤åˆé€»è¾‘éœ€è¦é”ä¸€ä¸‹è¿™ä¸ªConcurrentHashMap        synchronized (concurrentHashMap) {            int gap = ITEM_COUNT - concurrentHashMap.size();            log.info(&quot;gap size:{}&quot;, gap);            concurrentHashMap.putAll(getData(gap));        }    }));    forkJoinPool.shutdown();    forkJoinPool.awaitTermination(1, TimeUnit.HOURS);    log.info(&quot;finish size:{}&quot;, concurrentHashMap.size());    return &quot;OK&quot;;}</code></pre><ul><li>å……åˆ†ä½¿ç”¨ConcurrentHashMapçš„ç‰¹æ€§<ul><li>ä¾‹å¦‚é¢å¯¹ä¸€ä¸ªä½¿ç”¨Mapæ¥ç»Ÿè®¡Keyå‡ºç°æ¬¡æ•°çš„åœºæ™¯</li><li>keyèŒƒå›´ä¸º10ï¼Œ æœ€å¤šä½¿ç”¨10ä¸ªå¹¶å‘ï¼Œå¾ªç¯æ“ä½œ1000ä¸‡æ¬¡ï¼Œæ¯æ¬¡æ“ä½œç´¯åŠ éšæœºçš„key</li><li>å¦‚æœkeyä¸å­˜åœ¨çš„è¯ï¼Œé¦–æ¬¡è®¾ç½®å€¼ä¸º1 </li></ul></li></ul><pre><code>    //å¾ªç¯æ¬¡æ•°    private static int LOOP_COUNT = 10000000;    //çº¿ç¨‹æ•°é‡    private static int THREAD_COUNT = 10;    //å…ƒç´ æ•°é‡    private static int ITEM_COUNT = 10;    private Map&lt;String, Long&gt; normaluse() throws InterruptedException {        ConcurrentHashMap&lt;String, Long&gt; freqs = new ConcurrentHashMap&lt;&gt;(ITEM_COUNT);        ForkJoinPool forkJoinPool = new ForkJoinPool(THREAD_COUNT);        forkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, LOOP_COUNT).parallel().forEach(i -&gt; {            //è·å¾—ä¸€ä¸ªéšæœºçš„Key            String key = &quot;item&quot; + ThreadLocalRandom.current().nextInt(ITEM_COUNT);                    synchronized (freqs) {                              if (freqs.containsKey(key)) {                            //Keyå­˜åœ¨åˆ™+1                            freqs.put(key, freqs.get(key) + 1);                        } else {                            //Keyä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ä¸º1                            freqs.put(key, 1L);                        }                    }                }        ));        forkJoinPool.shutdown();        forkJoinPool.awaitTermination(1, TimeUnit.HOURS);        return freqs;    }</code></pre><p>ä½†æ˜¯å®é™…ä¸ŠConcurrentHashMapæœ¬èº«æ˜¯ä½¿ç”¨çš„Javaè‡ªå¸¦çš„CASæ“ä½œçš„ï¼Œåœ¨è™šæ‹Ÿæœºå±‚é¢ç¡®ä¿äº†å†™å…¥æ•°æ®çš„åŸå­æ€§ï¼Œæ¯”åŠ é”çš„æ•ˆç‡é«˜å¾ˆå¤šï¼Œå› æ­¤ç›¸è¾ƒäºç›´æ¥åŠ synchronizedé‡é‡é”ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡computeIfAbsent()æ“ä½œï¼Œå’Œçº¿ç¨‹å®‰å…¨ç´¯åŠ å™¨LongAdderæ¥æ›´æœ‰æ•ˆç‡çš„å®ç°æˆ‘ä»¬çš„ç»Ÿè®¡ç›®çš„</p><pre><code>private Map&lt;String, Long&gt; gooduse() throws InterruptedException {    ConcurrentHashMap&lt;String, LongAdder&gt; freqs = new ConcurrentHashMap&lt;&gt;(ITEM_COUNT);    ForkJoinPool forkJoinPool = new ForkJoinPool(THREAD_COUNT);    forkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, LOOP_COUNT).parallel().forEach(i -&gt; {        String key = &quot;item&quot; + ThreadLocalRandom.current().nextInt(ITEM_COUNT);                //åˆ©ç”¨computeIfAbsent()æ–¹æ³•æ¥å®ä¾‹åŒ–LongAdderï¼Œç„¶ååˆ©ç”¨LongAdderæ¥è¿›è¡Œçº¿ç¨‹å®‰å…¨è®¡æ•°                freqs.computeIfAbsent(key, k -&gt; new LongAdder()).increment();            }    ));    forkJoinPool.shutdown();    forkJoinPool.awaitTermination(1, TimeUnit.HOURS);    //å› ä¸ºæˆ‘ä»¬çš„Valueæ˜¯LongAdderè€Œä¸æ˜¯Longï¼Œæ‰€ä»¥éœ€è¦åšä¸€æ¬¡è½¬æ¢æ‰èƒ½è¿”å›    return freqs.entrySet().stream()            .collect(Collectors.toMap(                    e -&gt; e.getKey(),                    e -&gt; e.getValue().longValue())            );}</code></pre><ul><li>ä¸Šè¿°ä»£ç ä¸­ï¼Œç›´æ¥ä½¿ç”¨äº†ConcurrentHashMapçš„åŸå­æ€§æ–¹æ³•computeIfAbsentæ¥åšç¬¦åˆé€»è¾‘æ“ä½œï¼Œåˆ¤æ–­Keyæ˜¯å¦å­˜åœ¨Valueï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æŠŠLambdaè¡¨è¾¾å¼è¿è¡Œåçš„ç»“æœæ”¾å…¥Mapä½œä¸ºValue</li><li>LongAdderæ˜¯çº¿ç¨‹å®‰å…¨çš„ç´¯åŠ å™¨ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è°ƒç”¨å…¶increment()æ–¹æ³•æ¥åšç´¯åŠ ã€‚</li></ul><h2 id="1-3-é”"><a href="#1-3-é”" class="headerlink" title="1.3 é”"></a>1.3 é”</h2><ul><li>åŠ é”å‰éœ€è¦çŸ¥é“é”å’Œè¢«ä¿æŠ¤çš„å¯¹è±¡æ˜¯ä¸æ˜¯ä¸€ä¸ªå±‚é¢ä¸Šçš„<ul><li>é™æ€å­—æ®µå±äºç±»ï¼Œéœ€è¦ç±»çº§åˆ«çš„é”æ¥è¿›è¡Œä¿æŠ¤</li><li>éé™æ€å­—æ®µå±äºç±»å®ä¾‹ï¼Œå®ä¾‹çº§åˆ«çš„é”å°±å¯ä»¥ä¿æŠ¤</li></ul></li></ul><pre><code>// å®šä¹‰ä¸€ä¸ªé™æ€intå­—æ®µcounterå’Œä¸€ä¸ªéé™æ€çš„wrongæ–¹æ³•ï¼Œå®ç°counterå­—æ®µçš„ç´¯åŠ æ“ä½œclass Data {    @Getter    private static int counter = 0;    public static int reset() {        counter = 0;        return counter;    }    public synchronized void wrong() {        counter++;    }}// æµ‹è¯•ä»£ç @GetMapping(&quot;wrong&quot;)public int wrong(@RequestParam(value = &quot;count&quot;, defaultValue = &quot;1000000&quot;) int count) {    Data.reset();    //å¤šçº¿ç¨‹å¾ªç¯ä¸€å®šæ¬¡æ•°è°ƒç”¨Dataç±»ä¸åŒå®ä¾‹çš„wrongæ–¹æ³•    IntStream.rangeClosed(1, count).parallel().forEach(i -&gt; new Data().wrong());    return Data.getCounter();}</code></pre><p>è¾“å‡ºç»“æœï¼Œå› ä¸ºé»˜è®¤è¿è¡Œ100ä¸‡æ¬¡ï¼Œä½†æ˜¯é¡µé¢è¾“å‡ºçš„å¹¶ä¸ä¼šæ˜¯100ä¸‡ã€‚</p><ul><li>åœ¨éé™æ€çš„wrongæ–¹æ³•ä¸ŠåŠ é”ï¼Œåªèƒ½å¤Ÿä¿è¯å¤šä¸ªçº¿ç¨‹æ— æ³•æ‰§è¡ŒåŒä¸€ä¸ªå®ä¾‹çš„wrongæ–¹æ³•ï¼Œä½†æ— æ³•ä¿è¯å…¶ä¸ä¼šæ‰§è¡Œä¸åŒå®ä¾‹çš„wrongæ–¹æ³•ã€‚è€Œé™æ€çš„counteræ˜¯è¢«å…±äº«çš„</li><li>è§£å†³æ–¹æ¡ˆæ—¶ä¿è¯åœ¨ä¸€ä¸ªå®ä¾‹çš„æ–¹æ³•æ“ä½œé™æ€å˜é‡çš„æ—¶å€™ï¼Œå…¶ä»–çš„å®ä¾‹æ— æ³•æ“ä½œè¿™ä¸ªé™æ€å˜é‡</li></ul><pre><code>class Data {    @Getter    private static int counter = 0;    private static Object locker = new Object();    public void right() {        synchronized (locker) {            counter++;        }    }}</code></pre><ul><li>é™¤æ­¤ä»¥å¤–ï¼Œå¯¹é”å¯ä»¥åšçš„ä¼˜åŒ–è¿˜åŒ…æ‹¬<ul><li>ç²¾ç»†åŒ–é”åº”ç”¨çš„èŒƒå›´</li><li>åŒºåˆ†è¯»å†™åœºæ™¯ä»¥åŠèµ„æºçš„è®¿é—®å†²çªï¼Œè€ƒè™‘ä½¿ç”¨æ‚²è§‚é”è¿˜æ˜¯ä¹è§‚é”<ul><li>å¯¹äºè¯»å†™æ¯”ä¾‹å·®å¼‚æ˜æ˜¾çš„åœºæ™¯ï¼Œè€ƒè™‘ä½¿ç”¨ReentrantReadWriteLockç»†åŒ–åŒºåˆ†è¯»å†™é”ï¼Œæ¥æé«˜æ€§èƒ½</li><li>å¦‚æœå…±äº«èµ„æºå†²çªæ¦‚ç‡ä¸å¤§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨StampedLockçš„ä¹è§‚è¯»çš„ç‰¹æ€§ï¼Œè¿›ä¸€æ­¥æé«˜æ€§èƒ½</li></ul></li></ul></li></ul><h2 id="1-4-çº¿ç¨‹æ± "><a href="#1-4-çº¿ç¨‹æ± " class="headerlink" title="1.4 çº¿ç¨‹æ± "></a>1.4 çº¿ç¨‹æ± </h2><p>å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å„ç§æ± åŒ–æŠ€æœ¯æ¥ç¼“å­˜åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡ï¼Œæ¯”å¦‚çº¿ç¨‹æ± ï¼Œè¿æ¥æ± ï¼Œå†…å­˜æ± ã€‚ä¸€èˆ¬æ˜¯é¢„å…ˆåˆ›å»ºä¸€äº›å¯¹è±¡æ”¾å…¥åˆ°æ± å½“ä¸­ï¼Œä½¿ç”¨çš„æ—¶å€™ç›´æ¥å–å‡ºä½¿ç”¨ï¼Œç”¨å®Œå½’è¿˜ä»¥ä¾¿å¤ç”¨ã€‚é€šè¿‡ä¸€å®šçš„ç­–ç•¥è°ƒæ•´æ± ä¸­ç¼“å­˜å¯¹è±¡çš„æ•°é‡ï¼Œå®ç°æ± çš„åŠ¨æ€ä¼¸ç¼©ã€‚</p><ul><li>åº”å½“æ‰‹åŠ¨è¿›è¡Œçº¿ç¨‹æ± çš„å£°æ˜<ul><li>Java Executorså®šä¹‰äº†ä¸€äº›å¿«æ·çš„å·¥å…·åŠæ³•ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± </li><li>åº”å½“ç¦æ­¢ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œåº”å½“æ‰‹åŠ¨new ThreadPoolExecutoræ¥åˆ›å»ºçº¿ç¨‹æ± <ul><li>èµ„æºè€—å°½å¯¼è‡´OOMé—®é¢˜<ul><li>newFixedThreadPool</li><li>newCachedThreadPool</li></ul></li></ul></li></ul></li></ul><h3 id="1-4-1-newFixedThreadPool-OOM-é—®é¢˜"><a href="#1-4-1-newFixedThreadPool-OOM-é—®é¢˜" class="headerlink" title="1.4.1 newFixedThreadPool OOM é—®é¢˜"></a>1.4.1 newFixedThreadPool OOM é—®é¢˜</h3><pre><code>    @GetMapping(&quot;oom1&quot;)    public void oom1() throws InterruptedException {        ThreadPoolExecutor threadPool = (ThreadPoolExecutor) Executors.newFixedThreadPool(1);        //æ‰“å°çº¿ç¨‹æ± çš„ä¿¡æ¯ï¼Œç¨åæˆ‘ä¼šè§£é‡Šè¿™æ®µä»£ç         printStats(threadPool);         for (int i = 0; i &lt; 100000000; i++) {            threadPool.execute(() -&gt; {                String payload = IntStream.rangeClosed(1, 1000000)                        .mapToObj(__ -&gt; &quot;a&quot;)                        .collect(Collectors.joining(&quot;&quot;)) + UUID.randomUUID().toString();                try {                    TimeUnit.HOURS.sleep(1);                } catch (InterruptedException e) {                }                log.info(payload);            });        }        threadPool.shutdown();        threadPool.awaitTermination(1, TimeUnit.HOURS);    }</code></pre><ul><li>æ—¥å¿—æ˜¾ç¤ºå‡ºç°äº†OOM</li><li>newFixedThreadPoolæºç ï¼š</li></ul><pre><code>    public static ExecutorService newFixedThreadPool(int nThreads) {        return new ThreadPoolExecutor(nThreads, nThreads,                                      0L, TimeUnit.MILLISECONDS,                                      new LinkedBlockingQueue&lt;Runnable&gt;());    }    public class LinkedBlockingQueue&lt;E&gt; extends AbstractQueue&lt;E&gt;            implements BlockingQueue&lt;E&gt;, java.io.Serializable {        ...        /**         * Creates a {@code LinkedBlockingQueue} with a capacity of         * {@link Integer#MAX_VALUE}.         */        public LinkedBlockingQueue() {            this(Integer.MAX_VALUE);        }    ...    }</code></pre><ul><li>ç›´æ¥ä½¿ç”¨äº†ä¸€ä¸ªLinkedBlockingQueueï¼Œè€Œé»˜è®¤æ„é€ æ–¹æ³•æ˜¯ä¸€ä¸ªInteger.MAX_VALUEé•¿åº¦çš„é˜Ÿåˆ—ï¼Œæ˜¯æ— ç•Œçš„ã€‚</li><li>å°½ç®¡ä½¿ç”¨newFixedThreadPoolå¯ä»¥æŠŠå·¥ä½œçº¿ç¨‹æ§åˆ¶åœ¨å›ºå®šçš„æ•°é‡ä¸Šï¼Œä½†ä»»åŠ¡é˜Ÿåˆ—æ˜¯æ— ç•Œçš„ã€‚å¦‚æœä»»åŠ¡æ¯”è¾ƒå¤šå¹¶ä¸”æ‰§è¡Œæ¯”è¾ƒæ…¢çš„è¯ï¼Œé˜Ÿåˆ—å¯èƒ½ä¼šè¿…é€Ÿç§¯å‹ï¼Œæ’‘çˆ†å†…å­˜å¯¼è‡´OOM</li></ul><h3 id="1-4-2-newCachedThreadPool-OOMé—®é¢˜"><a href="#1-4-2-newCachedThreadPool-OOMé—®é¢˜" class="headerlink" title="1.4.2 newCachedThreadPool OOMé—®é¢˜"></a>1.4.2 newCachedThreadPool OOMé—®é¢˜</h3><pre><code>public static ExecutorService newCachedThreadPool() {    return new ThreadPoolExecutor(0, Integer.MAX_VALUE,                                  60L, TimeUnit.SECONDS,                                  new SynchronousQueue&lt;Runnable&gt;());</code></pre><ul><li>çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ä¸ºInteger.MAX_VALUEï¼Œæ˜¯æ²¡æœ‰ä¸Šé™çš„ï¼Œå…¶å·¥ä½œé˜Ÿåˆ—SynchronizedQueueæ˜¯ä¸€ä¸ªæ²¡æœ‰å­˜å‚¨ç©ºé—´çš„é˜»å¡é˜Ÿåˆ—ã€‚</li><li>SynchronousQueueæ˜¯æ²¡æœ‰å­˜å‚¨ç©ºé—´çš„é˜»å¡é˜Ÿåˆ—ï¼Œæœ‰è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼Œå¿…é¡»è¦æ‰¾åˆ°ä¸€æ¡å·¥ä½œçº¿ç¨‹æ¥å¤„ç†ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹å°±å†åˆ›å»ºä¸€æ¡æ–°çš„</li></ul><h3 id="1-4-3-çº¿ç¨‹æ± é…ç½®Best-Practice"><a href="#1-4-3-çº¿ç¨‹æ± é…ç½®Best-Practice" class="headerlink" title="1.4.3 çº¿ç¨‹æ± é…ç½®Best Practice"></a>1.4.3 çº¿ç¨‹æ± é…ç½®Best Practice</h3><ul><li><p>æ ¹æ®è‡ªå·±çš„åœºæ™¯ï¼Œå¹¶å‘æƒ…å†µæ¥è¯„ä¼°çº¿ç¨‹æ± çš„å‡ ä¸ªæ ¸å¿ƒå‚æ•°ï¼Œéœ€è¦è®¾ç½®æœ‰ç•Œçš„å·¥ä½œé˜Ÿåˆ—å’Œå¯æ§çš„çº¿ç¨‹æ•°</p><ul><li>æ ¸å¿ƒçº¿ç¨‹æ•°</li><li>æœ€å¤§çº¿ç¨‹æ•°</li><li>çº¿ç¨‹å›æ”¶ç­–ç•¥</li><li>å·¥ä½œé˜Ÿåˆ—çš„ç±»å‹</li><li>æ‹’ç»ç­–ç•¥</li></ul></li><li><p>ä¸ºçº¿ç¨‹æ± æŒ‡å®šæœ‰æ„ä¹‰çš„åç§°ï¼Œæ¥æ–¹ä¾¿é—®é¢˜çš„æ’æŸ¥ï¼Œå½“å‡ºç°çº¿ç¨‹æ•°æš´å¢ï¼Œçº¿ç¨‹æ­»é”ï¼Œçº¿ç¨‹å ç”¨å¤§é‡CPUè¿™ç±»é—®é¢˜çš„æ—¶å€™ï¼Œä¼šæŠ“å–çº¿ç¨‹æ ˆæ¥è¿›è¡Œåˆ†æï¼Œè¿™ä¸ªæ—¶å€™æœ‰æ„ä¹‰çš„çº¿ç¨‹åç§°ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæ–¹ä¾¿æˆ‘ä»¬å¯¹é—®é¢˜çš„å®šä½</p></li><li><p>Metricsï¼Œ alarmæ¥è§‚å¯Ÿçº¿ç¨‹æ± çš„çŠ¶æ€</p></li></ul><ul><li>çº¿ç¨‹æ± ç‰¹æ€§<ul><li>ä¸ä¼šåˆå§‹åŒ–corePoolSizeä¸ªçº¿ç¨‹ï¼Œæœ‰ä»»åŠ¡æ¥äº†æ‰åˆ›å»ºå·¥ä½œçº¿ç¨‹</li><li>å½“æ ¸å¿ƒçº¿ç¨‹æ»¡äº†ä¹‹åä¸ä¼šç«‹å³æ‰©å®¹çº¿ç¨‹æ± ï¼Œè€Œæ˜¯æŠŠä»»åŠ¡å †ç§¯åˆ°å·¥ä½œé˜Ÿåˆ—å½“ä¸­</li><li>å½“å·¥ä½œé˜Ÿåˆ—æ»¡äº†ä¹‹åæ‰©å®¹çº¿ç¨‹æ± ï¼Œä¸€ç›´åˆ°çº¿ç¨‹ä¸ªæ•°è¾¾åˆ°maximumPoolSizeä¸ºæ­¢</li><li>å¦‚æœé˜Ÿåˆ—å·²æ»¡å…¶è¾¾åˆ°äº†æœ€å¤§çº¿ç¨‹åè¿˜æœ‰ä»»åŠ¡æ¥ï¼Œå°±æŒ‰ç…§æ‹’ç»ç­–ç•¥æ¥å¤„ç†</li><li>å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œçº¿ç¨‹ç­‰å¾…KeepAliveTimeåè¿˜æ²¡æœ‰ä»»åŠ¡éœ€è¦å¤„ç†çš„è¯ï¼Œæ”¶ç¼©çº¿ç¨‹åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°</li></ul></li></ul><pre><code>@GetMapping(&quot;right&quot;)public int right() throws InterruptedException {    //ä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨è·Ÿè¸ªå®Œæˆçš„ä»»åŠ¡æ•°    AtomicInteger atomicInteger = new AtomicInteger();    //åˆ›å»ºä¸€ä¸ªå…·æœ‰2ä¸ªæ ¸å¿ƒçº¿ç¨‹ã€5ä¸ªæœ€å¤§çº¿ç¨‹ï¼Œä½¿ç”¨å®¹é‡ä¸º10çš„ArrayBlockingQueueé˜»å¡é˜Ÿåˆ—ä½œä¸ºå·¥ä½œé˜Ÿåˆ—çš„çº¿ç¨‹æ± ï¼Œä½¿ç”¨é»˜è®¤çš„AbortPolicyæ‹’ç»ç­–ç•¥    ThreadPoolExecutor threadPool = new ThreadPoolExecutor(            2, 5,            5, TimeUnit.SECONDS,            new ArrayBlockingQueue&lt;&gt;(10),            new ThreadFactoryBuilder().setNameFormat(&quot;demo-threadpool-%d&quot;).get(),            new ThreadPoolExecutor.AbortPolicy());    printStats(threadPool);    //æ¯éš”1ç§’æäº¤ä¸€æ¬¡ï¼Œä¸€å…±æäº¤20æ¬¡ä»»åŠ¡    IntStream.rangeClosed(1, 20).forEach(i -&gt; {        try {            TimeUnit.SECONDS.sleep(1);        } catch (InterruptedException e) {            e.printStackTrace();        }        int id = atomicInteger.incrementAndGet();        try {            threadPool.submit(() -&gt; {                log.info(&quot;{} started&quot;, id);                //æ¯ä¸ªä»»åŠ¡è€—æ—¶10ç§’                try {                    TimeUnit.SECONDS.sleep(10);                } catch (InterruptedException e) {                }                log.info(&quot;{} finished&quot;, id);            });        } catch (Exception ex) {            //æäº¤å‡ºç°å¼‚å¸¸çš„è¯ï¼Œæ‰“å°å‡ºé”™ä¿¡æ¯å¹¶ä¸ºè®¡æ•°å™¨å‡ä¸€            log.error(&quot;error submitting task {}&quot;, id, ex);            atomicInteger.decrementAndGet();        }    });    TimeUnit.SECONDS.sleep(60);    return atomicInteger.intValue();}</code></pre><h3 id="1-4-4-çº¿ç¨‹æ± æœ¬èº«ä¸å¤ç”¨"><a href="#1-4-4-çº¿ç¨‹æ± æœ¬èº«ä¸å¤ç”¨" class="headerlink" title="1.4.4 çº¿ç¨‹æ± æœ¬èº«ä¸å¤ç”¨"></a>1.4.4 çº¿ç¨‹æ± æœ¬èº«ä¸å¤ç”¨</h3><pre><code>@GetMapping(&quot;wrong&quot;)public String wrong() throws InterruptedException {    ThreadPoolExecutor threadPool = ThreadPoolHelper.getThreadPool();    IntStream.rangeClosed(1, 10).forEach(i -&gt; {        threadPool.execute(() -&gt; {            ...            try {                TimeUnit.SECONDS.sleep(1);            } catch (InterruptedException e) {            }        });    });    return &quot;OK&quot;;}class ThreadPoolHelper {    public static ThreadPoolExecutor getThreadPool() {        //çº¿ç¨‹æ± æ²¡æœ‰å¤ç”¨        return (ThreadPoolExecutor) Executors.newCachedThreadPool();    }}</code></pre><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¼šä¸åœäº§ç”Ÿæ–°çš„çº¿ç¨‹ï¼Œæ•´ä¸ªä¸šåŠ¡ç¨‹åºä¼šä¸åœäº§ç”Ÿæ–°çš„threadPoolï¼Œå› ä¸ºnewCachedThreadPoolçš„æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯0ï¼Œ keepAliveTimeæ˜¯60ç§’ï¼Œè¿‡äº†60sä»¥åçº¿ç¨‹å°±ä¼šè¢«å›æ”¶äº†ã€‚</p><h3 id="1-4-5-çº¿ç¨‹æ± çš„ä½¿ç”¨ç­–ç•¥"><a href="#1-4-5-çº¿ç¨‹æ± çš„ä½¿ç”¨ç­–ç•¥" class="headerlink" title="1.4.5 çº¿ç¨‹æ± çš„ä½¿ç”¨ç­–ç•¥"></a>1.4.5 çº¿ç¨‹æ± çš„ä½¿ç”¨ç­–ç•¥</h3><ul><li>å¯¹äºçº¿ç¨‹æ± å¦‚ä½•ä½¿ç”¨ï¼Œæ”¾ä»€ä¹ˆæ ·çš„ä»»åŠ¡è¿›å»ï¼Œæ˜¯éœ€è¦æ ¹æ®ä»»åŠ¡çš„è½»é‡ç¼“æ€¥æ¥æŒ‡å®šçº¿ç¨‹æ± çš„æ ¸å¿ƒå‚æ•°ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ•°ï¼Œå›æ”¶ç­–ç•¥å’Œä»»åŠ¡é˜Ÿåˆ—<ul><li>å¯¹äºæ‰§è¡Œæ¯”è¾ƒæ…¢ï¼Œæ•°é‡ä¸å¤§çš„IOä»»åŠ¡ï¼Œå¯ä»¥è€ƒè™‘æ›´å¤šçš„çº¿ç¨‹æ•°ï¼Œè€Œä¸éœ€è¦å¤ªå¤§çš„é˜Ÿåˆ—</li><li>å¯¹äºååé‡æ¯”è¾ƒå¤§çš„è®¡ç®—å‹ä»»åŠ¡ï¼Œçº¿ç¨‹æ•°é‡ä¸åº”è¯¥è¿‡å¤šï¼Œå¯ä»¥æ˜¯CPUæ ¸å¿ƒæ•°ï¼Œæˆ–è€…æ ¸å¿ƒæ•° x 2ã€‚<ul><li>å› ä¸ºçº¿ç¨‹æ˜¯éœ€è¦è°ƒåº¦åˆ°æŸä¸ªCPUå½“ä¸­è¿›è¡Œçš„ï¼Œå¦‚æœä»»åŠ¡æœ¬èº«æ˜¯CPUç»‘å®šçš„ä»»åŠ¡ï¼Œé‚£ä¹ˆè¿‡å¤šçš„çº¿ç¨‹åªä¼šå¢åŠ çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œå¹¶ä¸èƒ½æå‡ååé‡</li><li>éœ€è¦æ¯”è¾ƒé•¿çš„é˜Ÿåˆ—æ¥åšç¼“å†²</li></ul></li></ul></li></ul><h1 id="2-è¿æ¥æ± "><a href="#2-è¿æ¥æ± " class="headerlink" title="2. è¿æ¥æ± "></a>2. è¿æ¥æ± </h1><h2 id="2-1-è¿æ¥æ± å®šä¹‰"><a href="#2-1-è¿æ¥æ± å®šä¹‰" class="headerlink" title="2.1 è¿æ¥æ± å®šä¹‰"></a>2.1 è¿æ¥æ± å®šä¹‰</h2><ul><li>å¯¹å¤–æä¾›è·å¾—è¿æ¥</li><li>å½’è¿˜è¿æ¥çš„æ¥å£ç»™å®¢æˆ·ç«¯ä½¿ç”¨</li><li>æš´éœ²æœ€å°ç©ºé—²è¿æ¥æ•°ï¼Œæœ€å¤§è¿æ¥æ•°ç­‰å¯é…ç½®å‚æ•°</li><li>å†…éƒ¨å®ç°è¿æ¥å»ºç«‹ï¼Œè¿æ¥å¿ƒè·³ä¿æŒï¼Œè¿æ¥ç®¡ç†ï¼Œç©ºé—²è¿æ¥å›æ”¶ï¼Œè¿æ¥å¯ç”¨æ€§æ£€æµ‹ç­‰åŠŸèƒ½</li></ul><p><img src="https://i.loli.net/2020/08/21/8qialtrxJoB2MNF.png" alt="è¿æ¥æ± .png"></p><ul><li>åº”ç”¨åœºæ™¯<ul><li>æ•°æ®åº“è¿æ¥æ± </li><li>Redisè¿æ¥æ± </li><li>HTTPè¿æ¥æ± </li></ul></li></ul><h2 id="2-2-åº”ç”¨åœºæ™¯"><a href="#2-2-åº”ç”¨åœºæ™¯" class="headerlink" title="2.2 åº”ç”¨åœºæ™¯"></a>2.2 åº”ç”¨åœºæ™¯</h2><h3 id="2-2-1-åˆ¤æ–­å®¢æˆ·ç«¯SDKæ˜¯å¦åŸºäºè¿æ¥æ± "><a href="#2-2-1-åˆ¤æ–­å®¢æˆ·ç«¯SDKæ˜¯å¦åŸºäºè¿æ¥æ± " class="headerlink" title="2.2.1 åˆ¤æ–­å®¢æˆ·ç«¯SDKæ˜¯å¦åŸºäºè¿æ¥æ± "></a>2.2.1 åˆ¤æ–­å®¢æˆ·ç«¯SDKæ˜¯å¦åŸºäºè¿æ¥æ± </h3><ul><li><p>ä½¿ç”¨ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯è¿›è¡Œç½‘ç»œé€šä¿¡çš„æ—¶å€™ï¼Œéœ€è¦ç¡®å®šå®¢æˆ·ç«¯SDKæ˜¯å¦æ˜¯åŸºäºè¿æ¥æ± æŠ€æœ¯å®ç°çš„</p><ul><li><p>TCPæ˜¯é¢å‘è¿æ¥çš„åŸºäºå­—èŠ‚æµçš„åè®®</p><ul><li><p>é¢å‘è¿æ¥</p><ul><li>è¿æ¥éœ€è¦å…ˆåˆ›å»ºï¼Œéœ€è¦å…ˆåšä¸‰æ¬¡æ¡æ‰‹ï¼Œæ˜¯æœ‰å¼€é”€çš„</li></ul></li><li><p>åŸºäºå­—èŠ‚æµ</p><ul><li>å­—èŠ‚æ˜¯å‘é€æ•°æ®çš„æœ€å°å•å…ƒ</li><li>TCPæ˜¯æ•°æ®è¯»å†™çš„é€šé“ï¼Œæœ¬èº«ä¸çŸ¥é“å“ªäº›æ˜¯å®Œæ•´çš„æ¶ˆæ¯ä½“ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯å¦æœ‰å¤šä¸ªå®¢æˆ·ç«¯åœ¨ä½¿ç”¨åŒä¸€ä¸ªTCPè¿æ¥</li></ul></li></ul></li></ul></li><li><p>å®¢æˆ·ç«¯SDKå¯¹å¤–æä¾›APIçš„æ–¹å¼</p><ul><li>è¿æ¥æ± å’Œè¿æ¥åˆ†ç¦»çš„ APIï¼šæœ‰ä¸€ä¸ª XXXPool ç±»è´Ÿè´£è¿æ¥æ± å®ç°ï¼Œå…ˆä»å…¶è·å¾—è¿æ¥ XXXConnectionï¼Œç„¶åç”¨è·å¾—çš„è¿æ¥è¿›è¡ŒæœåŠ¡ç«¯è¯·æ±‚ï¼Œå®Œæˆåä½¿ç”¨è€…éœ€è¦å½’è¿˜è¿æ¥ã€‚é€šå¸¸ï¼ŒXXXPool æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥å¹¶å‘è·å–å’Œå½’è¿˜è¿æ¥ï¼Œè€Œ XXXConnection æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚å¯¹åº”åˆ°è¿æ¥æ± çš„ç»“æ„ç¤ºæ„å›¾ä¸­ï¼ŒXXXPool å°±æ˜¯å³è¾¹è¿æ¥æ± é‚£ä¸ªæ¡†ï¼Œå·¦è¾¹çš„å®¢æˆ·ç«¯æ˜¯æˆ‘ä»¬è‡ªå·±çš„ä»£ç </li><li>å†…éƒ¨å¸¦æœ‰è¿æ¥æ± çš„ APIï¼šå¯¹å¤–æä¾›ä¸€ä¸ª XXXClient ç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»å¯ä»¥ç›´æ¥è¿›è¡ŒæœåŠ¡ç«¯è¯·æ±‚ï¼›è¿™ä¸ªç±»å†…éƒ¨ç»´æŠ¤äº†è¿æ¥æ± ï¼ŒSDK ä½¿ç”¨è€…æ— éœ€è€ƒè™‘è¿æ¥çš„è·å–å’Œå½’è¿˜é—®é¢˜ã€‚ä¸€èˆ¬è€Œè¨€ï¼ŒXXXClient æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¯¹åº”åˆ°è¿æ¥æ± çš„ç»“æ„ç¤ºæ„å›¾ä¸­ï¼Œæ•´ä¸ª API å°±æ˜¯è“è‰²æ¡†åŒ…è£¹çš„éƒ¨åˆ†</li><li>éè¿æ¥æ± çš„ APIï¼šä¸€èˆ¬å‘½åä¸º XXXConnectionï¼Œä»¥åŒºåˆ†å…¶æ˜¯åŸºäºè¿æ¥æ± è¿˜æ˜¯å•è¿æ¥çš„ï¼Œè€Œä¸å»ºè®®å‘½åä¸º XXXClient æˆ–ç›´æ¥æ˜¯ XXXã€‚ç›´æ¥è¿æ¥æ–¹å¼çš„ API åŸºäºå•ä¸€è¿æ¥ï¼Œæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦åˆ›å»ºå’Œæ–­å¼€è¿æ¥ï¼Œæ€§èƒ½ä¸€èˆ¬ï¼Œä¸”é€šå¸¸ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¯¹åº”åˆ°è¿æ¥æ± çš„ç»“æ„ç¤ºæ„å›¾ä¸­ï¼Œè¿™ç§å½¢å¼ç›¸å½“äºæ²¡æœ‰å³è¾¹è¿æ¥æ± é‚£ä¸ªæ¡†ï¼Œå®¢æˆ·ç«¯ç›´æ¥è¿æ¥æœåŠ¡ç«¯åˆ›å»ºè¿æ¥</li></ul></li></ul><h3 id="2-2-2-å¤ç”¨è¿æ¥æ± "><a href="#2-2-2-å¤ç”¨è¿æ¥æ± " class="headerlink" title="2.2.2 å¤ç”¨è¿æ¥æ± "></a>2.2.2 å¤ç”¨è¿æ¥æ± </h3><ul><li>åˆ›å»ºè¿æ¥æ± çš„æ—¶å€™å¾ˆå¯èƒ½ä¸€æ¬¡æ€§åˆ›å»ºäº†å¤šä¸ªè¿æ¥ï¼Œå¤§å¤šæ•°è¿æ¥æ± è€ƒè™‘åˆ°æ€§èƒ½ï¼Œä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™ç»´æŠ¤ä¸€å®šæ•°é‡çš„æœ€å°è¿æ¥ï¼ˆæ¯•ç«Ÿåˆå§‹åŒ–è¿æ¥æ± çš„è¿‡ç¨‹ä¸€èˆ¬æ˜¯ä¸€æ¬¡æ€§çš„ï¼‰ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å¦‚æœæ¯æ¬¡ä½¿ç”¨è¿æ¥æ± éƒ½æŒ‰éœ€åˆ›å»ºè¿æ¥æ± ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä½ åªç”¨åˆ°ä¸€ä¸ªè¿æ¥ï¼Œä½†æ˜¯åˆ›å»ºäº† N ä¸ªè¿æ¥</li><li>è¿æ¥æ± æœ‰ç®¡ç†æ¨¡å—ï¼Œä¼šæœ‰é—²ç½®è¶…æ—¶ï¼Œå®šæ—¶æ¥å›æ”¶é—²ç½®çš„è¿æ¥ï¼Œå°†æ´»è·ƒè¿æ¥æ•°é™åˆ°æœ€ä½è¿æ¥çš„é…ç½®å€¼ï¼Œä»¥æ­¤å‡è½»æœåŠ¡ç«¯çš„å‹åŠ›</li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-å¤‡å¿˜å½•æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¤‡å¿˜å½•æ¨¡å¼çš„åŸç†ä¸å®ç°"><a href="#1-å¤‡å¿˜å½•æ¨¡å¼çš„åŸç†ä¸å®ç°" class="headerlink" title="1. å¤‡å¿˜å½•æ¨¡å¼çš„åŸç†ä¸å®ç°"></a>1. å¤‡å¿˜å½•æ¨¡å¼çš„åŸç†ä¸å®ç°</h1><ul><li>snapshotæ¨¡å¼ <ul><li>Memento Design Pattern </li><li>Captures and externalizes an objectâ€™s internal state so that it can be restored later, all without violating encapsulation </li><li>åœ¨ä¸è¿èƒŒå°è£…åŸåˆ™çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿ä¹‹åæ¢å¤å¯¹è±¡å…ˆå‰çš„çŠ¶æ€ã€‚<ul><li>å­˜å‚¨å‰¯æœ¬ä»¥ä¾¿åæœŸæ¢å¤</li><li>åœ¨ä¸è¿èƒŒå°è£…åŸåˆ™çš„å‰æä¸‹ï¼Œè¿›è¡Œå¯¹è±¡çš„å¤‡ä»½å’Œæ¢å¤</li></ul></li></ul></li></ul><pre><code>    public class InputText {      private StringBuilder text = new StringBuilder();      public String getText() {        return text.toString();      }      public void append(String input) {        text.append(input);      }      public Snapshot createSnapshot() {        return new Snapshot(text.toString());      }      public void restoreSnapshot(Snapshot snapshot) {        this.text.replace(0, this.text.length(), snapshot.getText());      }    }    public class Snapshot {      private String text;      public Snapshot(String text) {        this.text = text;      }      public String getText() {        return this.text;      }    }    public class SnapshotHolder {      private Stack&lt;Snapshot&gt; snapshots = new Stack&lt;&gt;();      public Snapshot popSnapshot() {        return snapshots.pop();      }      public void pushSnapshot(Snapshot snapshot) {        snapshots.push(snapshot);      }    }    public class ApplicationMain {      public static void main(String[] args) {        InputText inputText = new InputText();        SnapshotHolder snapshotsHolder = new SnapshotHolder();        Scanner scanner = new Scanner(System.in);        while (scanner.hasNext()) {          String input = scanner.next();          if (input.equals(&quot;:list&quot;)) {            System.out.println(inputText.toString());          } else if (input.equals(&quot;:undo&quot;)) {            Snapshot snapshot = snapshotsHolder.popSnapshot();            inputText.restoreSnapshot(snapshot);          } else {            snapshotsHolder.pushSnapshot(inputText.createSnapshot());            inputText.append(input);          }        }      }    }</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤‡å¿˜å½•æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šç›®æ ‡ï¼šç®€å•è€Œæœ‰æ•ˆçš„å¸¸è¯†ç®¡ç†ã€‹</title>
      <link href="/%E3%80%8A%E7%9B%AE%E6%A0%87%EF%BC%9A%E7%AE%80%E5%8D%95%E8%80%8C%E6%9C%89%E6%95%88%E7%9A%84%E5%B8%B8%E8%AF%86%E7%AE%A1%E7%90%86%E3%80%8B/"/>
      <url>/%E3%80%8A%E7%9B%AE%E6%A0%87%EF%BC%9A%E7%AE%80%E5%8D%95%E8%80%8C%E6%9C%89%E6%95%88%E7%9A%84%E5%B8%B8%E8%AF%86%E7%AE%A1%E7%90%86%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¼ä¸šé—®é¢˜çš„ç€æ‰‹ç‚¹"><a href="#1-ä¼ä¸šé—®é¢˜çš„ç€æ‰‹ç‚¹" class="headerlink" title="1. ä¼ä¸šé—®é¢˜çš„ç€æ‰‹ç‚¹"></a>1. ä¼ä¸šé—®é¢˜çš„ç€æ‰‹ç‚¹</h1><ul><li><p>ç€çœ¼äºæ¯ä¸ªç¯èŠ‚çš„æ”¹å–„ vs ä»ç³»ç»Ÿè§†è§’ç€æ‰‹</p></li><li><p>ç³»ç»Ÿ</p><ul><li>é¦–å…ˆè¦æŒæ¡å’Œå¦¥å–„å¤„ç†è¿™ä¸ªç³»ç»Ÿå†…å„ä¸ªç¯èŠ‚é—´çš„äº’åŠ¨å…³ç³»</li><li>TOC â€“ å¸Œæœ›èƒ½å¤ŸæŒ‡å¯¼ä¼ä¸šå¦‚ä½•é›†ä¸­åˆ©ç”¨æœ‰é™èµ„æºï¼Œå°†å…¶ç”¨åœ¨æ•´ä¸ªç³»ç»Ÿä¸­æœ€é‡è¦çš„åœ°æ–¹ï¼Œæ¥è¾¾åˆ°æœ€å¤§çš„æ•ˆç›Šã€‚</li></ul></li><li><p>ç°çŠ¶</p><ul><li>ä¼ä¸šåŠ¿å¿…ä¼šé‡åˆ°æ— æ•°é—®é¢˜<ul><li>è€Œè¿™äº›é—®é¢˜å¾€å¾€ä¼šä½¿å¾—ç®¡ç†äººå‘˜åºŸå¯å¿˜é£Ÿï¼Œç–²äºå¥”å‘½</li><li>éœ€è¦å»å¯»æ‰¾åœ¨è¿™äº›é—®é¢˜èƒŒåï¼Œæ˜¯å—åˆ°ä»€ä¹ˆä¸œè¥¿æ”¯é…ç€çš„ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆè§„å¾‹æ³•åˆ™å’Œç§©åºå¯ä»¥éµå¾ª</li></ul></li></ul></li></ul><h1 id="2-TOC"><a href="#2-TOC" class="headerlink" title="2. TOC"></a>2. TOC</h1><h2 id="2-1-ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-1-ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.1 ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2.1 ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li><p>èµšé’± ç›®æ ‡</p><ul><li><p>æœ¬è´¨å°±æ˜¯èµšé’± â€“ ä¸‹è¿°çš„æ˜¯å…·ä½“çš„æ–¹æ³•</p><ul><li>é‡‡è´­å‘æŒ¥æˆæœ¬æ•ˆç›Š</li><li>é›‡ä½£å¥½çš„äººæ‰</li><li>é«˜ç§‘æŠ€ï¼Œç”Ÿäº§æœ‰å“è´¨çš„äº§å“</li><li>é”€å”®æœ‰å“è´¨çš„äº§å“</li><li>äº‰å–å¸‚åœºå æœ‰ç‡</li><li>è‰¯å¥½çš„æ²Ÿé€šï¼Œé¡¾å®¢æ»¡æ„åº¦</li></ul></li><li><p>å…³æ³¨æŒ‡æ ‡</p><ul><li>åˆ©æ¶¦</li><li>æŠ•èµ„å›æŠ¥ç‡</li><li>ç°é‡‘æµé‡</li></ul></li><li><p>å°†å®é™…è¿ä½œçŠ¶å†µå’Œå…³æ³¨çš„å„ä¸ªæŒ‡æ ‡å†è¿æ¥èµ·æ¥ï¼Œå¦‚ä½•åšè¿æ¥å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ  â€“ ç”¨ä½ å»ºç«‹çš„æŒ‡æ ‡æ¥è¡¨è¾¾ä½ çš„ç›®æ ‡</p><ul><li>æœ‰æ•ˆäº§å‡º throughput<ul><li>ç³»ç»Ÿé€šè¿‡é”€å”®è·å–é‡‘é’±çš„é€Ÿåº¦</li></ul></li><li>å­˜è´§ inventory<ul><li>æ•´ä¸ªç³»ç»ŸæŠ•èµ„åœ¨é‡‡è´­ä¸Šçš„é’±</li><li>é‡‡è´­çš„æ˜¯æ‰“ç®—å–å‡ºå»çš„ä¸œè¥¿</li><li>å¯ä»¥å€Ÿé”€å”®å›æ”¶çš„æŠ•èµ„éƒ½ç®—æ˜¯å­˜è´§</li></ul></li><li>è¥è¿è´¹ç”¨  operationalExpense<ul><li>ç³»ç»Ÿä¸ºäº†æŠŠå­˜è´§è½¬ä¸ºæœ‰æ•ˆäº§å‡ºè€ŒèŠ±çš„é’± </li></ul></li></ul></li></ul></li></ul><h2 id="2-2-å¦‚ä½•è¾¾æˆç›®æ ‡"><a href="#2-2-å¦‚ä½•è¾¾æˆç›®æ ‡" class="headerlink" title="2.2 å¦‚ä½•è¾¾æˆç›®æ ‡"></a>2.2 å¦‚ä½•è¾¾æˆç›®æ ‡</h2><ul><li><p>ä¸€äº›åˆ—è¯¦å°½çš„æŒ‡æ ‡</p><ul><li>åœ¨æ”¹å–„ä¸€ä¸ªæŒ‡æ ‡çš„æ—¶å€™ï¼Œè¦æ€è€ƒå¯¹å…¶ä»–æŒ‡æ ‡çš„å½±å“</li><li>å•çº¯é¢å‘ä¸€ä¸ªæŒ‡æ ‡çš„æ”¹å–„å¯èƒ½å¯¹æ•´ä¸ªä¼ä¸šçš„æ”¹å–„å¹¶ä¸æ˜¯æœ€æœ‰åˆ©çš„</li></ul></li><li><p>ä¾å­˜å…³ç³»</p><ul><li>åœ¨ä¸€æ¡é“¾ä¸Šï¼Œè¶Šåˆ°ä¸‹æ¸¸å—å½±å“è¶Šå¤§ï¼Œç‰›é­æ•ˆåº”ï¼Œå› ä¸ºä¸Šæ¸¸ä¸ç¡®å®šå¤ªå¤§ï¼Œå¹³å‡æ—¶é—´æ— æ³•è¯´æ˜æ¯å¤©çš„å®é™…çŠ¶å†µ</li><li>ä¸‹æ¸¸åªèƒ½è¿½ä¸Šä¸Šæ¸¸çš„é€Ÿåº¦ï¼Œè€Œä¸èƒ½è¶…è¿‡ä¸Šæ¸¸çš„é€Ÿåº¦ï¼Œå› æ­¤ä¸ä¼šæ˜¯å„ç§ä¸åŒé€Ÿåº¦çš„ç›¸äº’æŠµæ¶ˆå¹³å‡ï¼Œè€Œä¼šæ˜¯ç»Ÿè®¡æ³¢åŠ¨çš„ç´¯ç§¯</li><li>æœ‰æ•ˆäº§å‡ºè¦çœ‹çš„æ˜¯æœ€ç»ˆç«¯çš„äº§å‡ºï¼Œå³è¦çœ‹çš„æ˜¯æ•´ä½“ç”Ÿäº§ç¯èŠ‚è¿™ä¸ªè§’åº¦ä¸Šçš„ç”Ÿäº§æ•ˆç‡</li><li>ä¼˜å…ˆè§£å†³ç“¶é¢ˆï¼ </li></ul></li><li><p>ç»Ÿè®¡æ³¢åŠ¨</p><ul><li>ç”Ÿäº§ç‡çš„æ³¢åŠ¨</li><li>ç”Ÿäº§çº¿æœ€åéƒ¨åˆ†çš„äº§èƒ½åº”è¯¥æ¯”å¼€å§‹çš„æ—¶å€™é«˜ï¼Œéœ€è¦èƒ½å¤Ÿå¤„ç†æ›´å¤§çš„æ³¢åŠ¨</li></ul></li><li><p>åŒºåˆ†èµ„æº</p><ul><li><p>ç“¶é¢ˆèµ„æº</p><ul><li>äº§èƒ½ç­‰äºæˆ–å°‘äºå…¶éœ€æ±‚</li><li>å½“å‡ºç°ç“¶é¢ˆçš„æ—¶å€™ï¼Œå…¶æˆæœ¬å·²ä¸èƒ½æŒ‰ç…§å•ç¯èŠ‚çš„æˆæœ¬æ¥è®¡ç®—äº†ï¼Œç›¸åçš„ï¼Œä»–ç›´æ¥å½±å“äº†äº§å“çš„äº§å‡ºï¼Œæ‰€ä»¥è¦ä»å…¨å±€æˆæœ¬çš„è§’åº¦æ¥è¿›è¡Œè€ƒè™‘ã€‚</li><li>åˆ¶å®šä¼˜å…ˆçº§ï¼Œä¸¥æ ¼æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºæ¥æ‰§è¡Œ</li></ul></li><li><p>éç“¶é¢ˆèµ„æº</p><ul><li>äº§èƒ½å¤§äºéœ€æ±‚</li></ul></li><li><p>éœ€è¦åœ¨äº§å“åœ¨å·¥å‚å½“ä¸­çš„æµé‡å’Œå¸‚åœºéœ€æ±‚ä¹‹é—´è·å–å¹³è¡¡</p></li></ul></li></ul><h2 id="2-3-Under-the-hood"><a href="#2-3-Under-the-hood" class="headerlink" title="2.3 Under the hood"></a>2.3 Under the hood</h2><p>ä¸€ç¾¤äººå¦‚ä½•è¯•å›¾äº†è§£ä¸–ç•Œè¿è½¬çš„çªé—¨ï¼Œå¹¶ä¸”å› æ­¤æ”¹å–„å‘¨é­çš„ä¸€åˆ‡ã€‚</p><p>ç§‘å­¦ä»£è¡¨ç€çš„æ˜¯æˆ‘ä»¬å¯¹äºè¿™ä¸ªä¸–ç•Œå¦‚ä½•è¿ä½œï¼Œä»¥åŠä¸ºä½•å¦‚æ­¤è¿ä½œçš„ç†è§£ã€‚ä½†æ˜¯ä»–ä¹Ÿåªä»£è¡¨ç€æˆ‘ä»¬ç°åœ¨æ‰€çŸ¥çš„ã€‚</p><p>æ²¡æœ‰ç»å¯¹çš„çœŸç†ï¼Œç»å¯¹çš„çœŸç†åè€Œä¼šé˜»ç¢æˆ‘ä»¬è¿½æ±‚æ›´æ·±å…¥çš„ç†è§£ã€‚</p><h2 id="2-4-åˆ¶çº¦ç†è®º"><a href="#2-4-åˆ¶çº¦ç†è®º" class="headerlink" title="2.4 åˆ¶çº¦ç†è®º"></a>2.4 åˆ¶çº¦ç†è®º</h2><ul><li><p>ä»»ä½•ç³»ç»Ÿéƒ½è‡³å°‘å­˜åœ¨ç€ä¸€ä¸ªåˆ¶çº¦å› ç´  â€“ ç“¶é¢ˆï¼Œå¦åˆ™å®ƒå°±å¯èƒ½æœ‰æ— é™çš„äº§å‡ºã€‚</p></li><li><p>æ ¸å¿ƒæ­¥éª¤</p><ul><li><p>å¯»æ‰¾çº¦æŸ</p><ul><li>ç¡®å®šç”Ÿäº§é€Ÿåº¦å’Œéœ€æ±‚é€Ÿåº¦</li></ul></li><li><p>åˆ©ç”¨çº¦æŸ</p><ul><li>æœ€å¤§é™åº¦å¼€å‘åˆ©ç”¨ç“¶é¢ˆå·¥åºï¼Œä½¿å¾—ç“¶é¢ˆå·¥åºäº§å‡ºé‡æœ€å¤§åŒ–</li></ul></li><li><p>æœä»çº¦æŸ</p><ul><li>ä½¿å¾—ä¼ä¸šçš„æ‰€æœ‰å…¶ä»–æ´»åŠ¨æœä»å…³äºçº¦æŸçš„å„ç§æªæ–½ï¼Œç¡®ä¿ä¼ä¸šçš„æ‰€æœ‰æ´»åŠ¨ï¼Œéƒ½æ˜¯åŸºäºæœ€å¤§åŒ–åˆ©ç”¨ç“¶é¢ˆå·¥åºè€Œå±•å¼€çš„</li></ul></li><li><p>æ‰“ç ´çº¦æŸ</p><ul><li>å¦‚æœæ— æ³•æœ‰æ•ˆæé«˜ç“¶é¢ˆå·¥åºçš„åˆ©ç”¨ç‡ï¼Œå°±éœ€è¦é‡‡å–å…¶ä»–æ–¹æ³•æ¥æ‰“ç ´çº¦æŸ</li></ul></li><li><p>å¯»æ‰¾æ–°çš„çº¦æŸ</p><ul><li>é‡æ–°å¯»æ‰¾æ–°çš„çº¦æŸï¼Œé‡æ–°è§£å†³é—®é¢˜</li></ul></li></ul></li></ul><h1 id="3-æ¡ˆä¾‹åˆ†æ"><a href="#3-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="3. æ¡ˆä¾‹åˆ†æ"></a>3. æ¡ˆä¾‹åˆ†æ</h1><h2 id="3-1-ç°çŠ¶åˆ†æ"><a href="#3-1-ç°çŠ¶åˆ†æ" class="headerlink" title="3.1 ç°çŠ¶åˆ†æ"></a>3.1 ç°çŠ¶åˆ†æ</h2><ul><li><p>å·¥å‚</p><ul><li><p>æŠ€æœ¯ï¼Œæœºå™¨é½å¤‡</p></li><li><p>å‘˜å·¥</p><ul><li>ä¼˜è´¨</li><li>æŠ€æœ¯å®åŠ›è¿‡ç¡¬</li></ul></li><li><p>è‰¯å¥½çš„å·¥ä¼šå…³ç³»</p></li><li><p>é—®é¢˜</p><ul><li>æ— æ³•æŒ‰æ—¶äº¤ä»˜</li></ul></li></ul></li><li><p>å½“ä½ å‡çº§æœºå™¨äº†ä»¥åï¼ŒçœŸçš„èƒ½å¤Ÿæå‡æ•ˆç‡ä¹ˆï¼Ÿ </p><ul><li><p>å®£ä¼ å½“ä¸­ï¼Œå‡çº§äº†æœºå™¨ï¼Œæ•ˆç‡ä¼šæé«˜ï¼Œå³å•ä½æ—¶é—´ç”Ÿäº§é€Ÿåº¦ä¼šå¾—åˆ°æå‡</p></li><li><p>é—®é¢˜åœ¨äº</p><ul><li>ä¼šè§£é›‡äººä¹ˆï¼Ÿ å³ç”Ÿäº§æˆæœ¬å¾—åˆ°é™ä½äº†ä¹ˆï¼Ÿ</li><li>å‡ºè´§æ•°é‡æœ‰æå‡ä¹ˆï¼Ÿ </li><li>ä¸­é—´ç”Ÿäº§ç‰©çš„å †ç§¯é‡ä»¥åŠå¹³å‡å­˜å‚¨æ—¶é—´æ€ä¹ˆæ ·å‘¢ï¼Ÿ </li></ul></li><li><p>å›åˆ°ä¸Šè¿°é—®é¢˜ï¼Œé¦–å…ˆè¦åšçš„æ˜¯å¯¹ç”Ÿäº§åŠ›ç»™ä¸€ä¸ªæ›´åˆç†çš„å®šä¹‰</p><ul><li>æ€ä¹ˆæ ·æ‰ç®—æœ‰ç”Ÿäº§åŠ›ï¼Ÿ <ul><li>å·¥ä½œä¸Šçš„è¾“å‡º</li><li>é€šè¿‡ç›®æ ‡æ¥é‡åŒ–è‡ªå·±çš„ç”Ÿäº§åŠ›</li><li>èƒ½æ›´æ¥è¿‘ç›®æ ‡çš„è¡ŒåŠ¨æ‰æ˜¯æœ‰ç”Ÿäº§åŠ›çš„è¡ŒåŠ¨</li><li>æ‰€ä»¥è¦é—®çš„æ˜¯ä½ çš„ç›®æ ‡åˆ°åº•æ˜¯ä»€ä¹ˆ</li></ul></li></ul></li></ul></li><li><p>çª˜å¢ƒ</p><ul><li>å°†äººåœ¨åšäº‹å’Œèƒ½å¸¦æ¥æ•ˆç›Šç­‰ä»·</li><li>é€šè¿‡è°ƒåŠ¨äººå‘˜æ¥ä¿è¯æœ‰äº‹å¯åšï¼Ÿ </li><li>çœ‹åˆ°çš„å„ç§æ•°æ®æŠ¥è¡¨å½“ä¸­çš„æ•°æ®çœŸçš„èƒ½å¤Ÿåæ˜ å‡ºèµšé’±èƒ½åŠ›ä¹ˆï¼Ÿ <ul><li>åšæ»¡å·¥ä½œæ—¶æ•°ï¼Ÿ </li><li>äº§å“æˆæœ¬ï¼Ÿ</li><li>ç›´æ¥äººå·¥å·®å¼‚ï¼Ÿ </li></ul></li></ul></li></ul><h2 id="3-2-ç­–ç•¥"><a href="#3-2-ç­–ç•¥" class="headerlink" title="3.2 ç­–ç•¥"></a>3.2 ç­–ç•¥</h2><ul><li><p>thought 1: é€šè¿‡æ”¹å˜å„ä¸ªç¯èŠ‚çš„åœ¨ä¾›åº”é“¾å½“ä¸­çš„é¡ºåºï¼Œå°è¯•ç¼“è§£ä¾å­˜å…³ç³»ï¼› å°è¯•é€šè¿‡å¢åŠ æœºå™¨ï¼Œç¼“è§£æŸä¸ªç¼“è§£çš„ç“¶é¢ˆ</p><ul><li>æŠ•å…¥æˆæœ¬é«˜</li><li>æ—¶é—´é•¿</li><li>æ—¢å®šå·¥åºéš¾ä»¥æ”¹å˜</li></ul></li><li><p>thought 2ï¼šè¯†åˆ«å‡ºç“¶é¢ˆä¹‹åï¼Œåˆ†æç“¶é¢ˆå¤„æœºå™¨çš„æ—¶é—´åˆ©ç”¨</p><ul><li>äººéœ€è¦æŒ‰ç…§å·¥ä¼šè¦æ±‚æ¯4å°æ—¶ä¼‘æ¯30minï¼Œä½†æ˜¯æœºå™¨éœ€è¦å°½å¯èƒ½è¿è½¬</li><li>è´¨æ£€ä¸åº”è¯¥åªæ”¾åœ¨æˆå“å‰ï¼Œåœ¨ç“¶é¢ˆå‰å°±è¿›è¡Œæ£€æŸ¥ï¼Œç¡®ä¿ç“¶é¢ˆå¤„åŠ å·¥çš„äº§å“åœ¨é‚£ä¸ªæ—¶åˆ»æ˜¯åˆæ ¼çš„ï¼Œç›¸å½“äºçœäº†åŠ å·¥åæŸå“çš„æ—¶é—´ </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://zhuanlan.zhihu.com/p/51536566" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/51536566</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-è¿­ä»£å™¨æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°"><a href="#1-è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°" class="headerlink" title="1. è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°"></a>1. è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°</h1><ul><li>è¿­ä»£å™¨æ¨¡å¼<ul><li>Iterator Design Pattern / Cursor Design Patten </li><li>ç”¨æ¥éå†é›†åˆå¯¹è±¡</li><li>ç¼–ç¨‹è¯­è¨€åŸºæœ¬ä¸Šéƒ½å°†è¿­ä»£å™¨ä½œä¸ºä¸€ä¸ªåŸºç¡€ç±»åº“æ¥æä¾›äº†</li><li>é›†åˆå¯¹è±¡æŒ‡çš„æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè€Œè¿­ä»£å™¨éœ€è¦è¿­ä»£çš„å¯¹è±¡å®é™…ä¸Šæ˜¯ä¸€ç»„å¯¹è±¡çš„å¯¹è±¡</li><li>è¿­ä»£å™¨æ¨¡å¼å°†é›†åˆå¯¹è±¡çš„éå†æ“ä½œä»é›†åˆç±»å½“ä¸­æ‹†åˆ†å‡ºæ¥ï¼Œæ”¾åˆ°è¿­ä»£å™¨ç±»å½“ä¸­ï¼Œä½¿å¾—äºŒè€…çš„èŒè´£æ›´åŠ å•ä¸€</li></ul></li></ul><ul><li>æ¶‰åŠéƒ¨åˆ†<ul><li>å®¹å™¨<ul><li>æ¥å£</li><li>å®ç°ç±»</li></ul></li><li>å®¹å™¨è¿­ä»£å™¨<ul><li>æ¥å£</li><li>å®ç°ç±»</li></ul></li></ul></li></ul><h2 id="1-1-å®ç°ä¸€ä¸ªçº¿æ€§ç»“æ„å®¹å™¨çš„è¿­ä»£å™¨"><a href="#1-1-å®ç°ä¸€ä¸ªçº¿æ€§ç»“æ„å®¹å™¨çš„è¿­ä»£å™¨" class="headerlink" title="1.1 å®ç°ä¸€ä¸ªçº¿æ€§ç»“æ„å®¹å™¨çš„è¿­ä»£å™¨"></a>1.1 å®ç°ä¸€ä¸ªçº¿æ€§ç»“æ„å®¹å™¨çš„è¿­ä»£å™¨</h2><pre><code>// æ¥å£å®šä¹‰æ–¹å¼ä¸€public interface Iterator&lt;E&gt; {  boolean hasNext();  void next();  E currentItem();}// æ¥å£å®šä¹‰æ–¹å¼äºŒpublic interface Iterator&lt;E&gt; {  boolean hasNext();  E next();}</code></pre><ul><li>å®šä¹‰æ–¹å¼ä¸€çš„å¥½å¤„åœ¨å¯ä»¥å¤šæ¬¡è·å¾—å½“å‰çš„å¯¹è±¡ï¼Œä¼šæ›´åŠ çµæ´»</li></ul><pre><code>public class ArrayIterator&lt;E&gt; implements Iterator&lt;E&gt; {  private int cursor;  private ArrayList&lt;E&gt; arrayList;  public ArrayIterator(ArrayList&lt;E&gt; arrayList) {    this.cursor = 0;    this.arrayList = arrayList;  }  @Override  public boolean hasNext() {    return cursor != arrayList.size(); //æ³¨æ„è¿™é‡Œï¼Œcursoråœ¨æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼ŒhasNext()ä»æ—§è¿”å›trueã€‚  }  @Override  public void next() {    cursor++;  }  @Override  public E currentItem() {    if (cursor &gt;= arrayList.size()) {      throw new NoSuchElementException();    }    return arrayList.get(cursor);  }}public class Demo {  public static void main(String[] args) {    ArrayList&lt;String&gt; names = new ArrayList&lt;&gt;();    names.add(&quot;xzg&quot;);    names.add(&quot;wang&quot;);    names.add(&quot;zheng&quot;);    Iterator&lt;String&gt; iterator = new ArrayIterator(names);    while (iterator.hasNext()) {      System.out.println(iterator.currentItem());      iterator.next();    }  }}</code></pre><ul><li>è¿™é‡Œä¸€ä¸ªé—®é¢˜æ˜¯è¿˜éœ€è¦<code>new ArrayIterator()</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨Listçš„æ¥å£å½“ä¸­å®šä¹‰è¿­ä»£å™¨ï¼Œç„¶åå†ArrayListçš„ç±»å½“ä¸­å®šä¹‰ä¸€ä¸ªiterator()æ–¹æ³•ã€‚ç„¶ååœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®ä¾‹åŒ–ä»¥åçš„å®¹å™¨ï¼Œæ¯”å¦‚ArrayListï¼Œç›´æ¥æ¥è°ƒç”¨iterator()æ–¹æ³•äº†</li></ul><pre><code>public interface List&lt;E&gt; {  Iterator iterator();  //...çœç•¥å…¶ä»–æ¥å£å‡½æ•°...}public class ArrayList&lt;E&gt; implements List&lt;E&gt; {  //...  public Iterator iterator() {    return new ArrayIterator(this);  }  //...çœç•¥å…¶ä»–ä»£ç }public class Demo {  public static void main(String[] args) {    List&lt;String&gt; names = new ArrayList&lt;&gt;();    names.add(&quot;xzg&quot;);    names.add(&quot;wang&quot;);    names.add(&quot;zheng&quot;);    Iterator&lt;String&gt; iterator = names.iterator();    while (iterator.hasNext()) {      System.out.println(iterator.currentItem());      iterator.next();    }  }}</code></pre><ul><li><p>å®ç°æ–¹å¼/ è®¾è®¡æ€è·¯</p><ul><li><p>è¿­ä»£å™¨å½“ä¸­å®ç°</p><ul><li>hasNext()</li><li>currentItem()</li><li>next()</li></ul></li><li><p>å¾…éå†çš„å®¹å™¨</p><ul><li>é€šè¿‡ä¾èµ–æ³¨å…¥ä¼ é€’åˆ°è¿­ä»£å™¨å½“ä¸­</li><li>å®¹å™¨é€šè¿‡iterator()æ–¹æ³•æ¥åˆ›å»ºè¿­ä»£å™¨</li></ul></li></ul></li></ul><h2 id="1-2-ä¸ºä»€ä¹ˆéœ€è¦è¿­ä»£å™¨æ¨¡å¼æ¥éå†é›†åˆï¼Ÿ"><a href="#1-2-ä¸ºä»€ä¹ˆéœ€è¦è¿­ä»£å™¨æ¨¡å¼æ¥éå†é›†åˆï¼Ÿ" class="headerlink" title="1.2 ä¸ºä»€ä¹ˆéœ€è¦è¿­ä»£å™¨æ¨¡å¼æ¥éå†é›†åˆï¼Ÿ"></a>1.2 ä¸ºä»€ä¹ˆéœ€è¦è¿­ä»£å™¨æ¨¡å¼æ¥éå†é›†åˆï¼Ÿ</h2><ol><li>å¤æ‚æ•°æ®ç»“æ„éå†æ–¹å¼ä¹Ÿä¼šéå¸¸å¤æ‚ï¼Œæ¯”å¦‚å¯¹äºæ ‘ï¼Œå¯¹äºå›¾æ¥è¯´ã€‚æˆ‘ä»¬å°†éå†çš„æ–¹å¼å®šä¹‰åˆ°è¿­ä»£å™¨å½“ä¸­ï¼Œè¿™æ ·å°±é¿å…äº†è¦è‡ªå·±å®ç°è¿™æ ·å¤æ‚çš„æ“ä½œäº†ã€‚</li><li>é€šè¿‡è¿­ä»£å™¨æ¨¡å¼ï¼Œå¯ä»¥åŒæ—¶åˆ›å»ºå¤šä¸ªä¸åŒçš„è¿­ä»£å™¨ï¼Œå¯¹åŒä¸€ä¸ªå®¹å™¨è¿›è¡Œéå†è€Œä¸äº’ç›¸å½±å“</li><li>å®¹å™¨å’Œè¿­ä»£å™¨éƒ½æä¾›äº†æŠ½è±¡çš„æ¥å£ï¼Œå½“æˆ‘ä»¬éœ€è¦æ”¹å˜éå†ç®—æ³•çš„æ—¶å€™ï¼Œå¯¹ä»£ç çš„å½±å“ä¼šå¾ˆå°ï¼Œåªåœ¨ä¾èµ–æ³¨å…¥å¤„ä½¿ç”¨æ–°çš„è¿­ä»£å™¨ç±»æ‰€æä¾›çš„ç®—æ³•å³å¯</li></ol><h2 id="1-3-éå†æ—¶çš„å¢åˆ "><a href="#1-3-éå†æ—¶çš„å¢åˆ " class="headerlink" title="1.3 éå†æ—¶çš„å¢åˆ "></a>1.3 éå†æ—¶çš„å¢åˆ </h2><p>éå†æ—¶è¿›è¡Œå¢åˆ å¾ˆå¤§çš„ä¸€ä¸ªé—®é¢˜æ˜¯æ•°ç»„åœ¨åšäº†å¢åˆ ä»¥åï¼Œå…¶ä»–å…ƒç´ çš„ä½ç½®ä¼šéšä¹‹æ”¹å˜çš„ã€‚è¿™æ ·å°±ä¼šå‡ºç°åœ¨è¿­ä»£å™¨å½“ä¸­æœ‰äº›å…ƒç´ æ— æ³•è¿­ä»£åˆ°çš„é—®é¢˜äº†</p><p>éå†æ—¶å¢åˆ æ˜¯ä¼šäº§ç”Ÿä¸å¯é¢„æœŸçš„éå†é”™è¯¯çš„ï¼Œå¯ä»¥é€šè¿‡å¯¹éå†æ—¶å€™å¢åˆ å…ƒç´ çš„é™åˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><ul><li>éå†çš„æ—¶å€™ä¸å…è®¸å¢åˆ å…ƒç´ <ul><li>æ¯”è¾ƒéš¾ä»¥å®ç°</li></ul></li><li>å¢åˆ å…ƒç´ ä¹‹åè®©éå†æŠ¥é”™<ul><li>åœ¨ArrayListå½“ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡modCount<ul><li>è®°å½•é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°</li><li>é›†åˆæ¯è°ƒç”¨ä¸€æ¬¡å¢åŠ æˆ–åˆ é™¤å…ƒç´ çš„å‡½æ•°ï¼Œå°±ä¼šåŠ 1 </li><li>å½“è°ƒç”¨é›†åˆä¸Šçš„iterator()å‡½æ•°åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œå°†modCountå€¼ä¼ é€’ç»™è¿­ä»£å™¨çš„expectedModCountæˆå‘˜å˜é‡</li><li>ç„¶ååœ¨æ¯æ¬¡è°ƒç”¨è¿­ä»£å™¨ä¸Šçš„å‡½æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šæ£€æŸ¥ä¸€ä¸‹modCountæ˜¯å¦æ”¹å˜è¿‡</li></ul></li></ul></li></ul><pre><code>public class ArrayIterator implements Iterator {  private int cursor;  private ArrayList arrayList;  private int expectedModCount;  public ArrayIterator(ArrayList arrayList) {    this.cursor = 0;    this.arrayList = arrayList;    this.expectedModCount = arrayList.modCount;  }  @Override  public boolean hasNext() {    checkForComodification();    return cursor &lt; arrayList.size();  }  @Override  public void next() {    checkForComodification();    cursor++;  }  @Override  public Object currentItem() {    checkForComodification();    return arrayList.get(cursor);  }  private void checkForComodification() {    if (arrayList.modCount != expectedModCount)        throw new ConcurrentModificationException();  }}//ä»£ç ç¤ºä¾‹public class Demo {  public static void main(String[] args) {    List&lt;String&gt; names = new ArrayList&lt;&gt;();    names.add(&quot;a&quot;);    names.add(&quot;b&quot;);    names.add(&quot;c&quot;);    names.add(&quot;d&quot;);    Iterator&lt;String&gt; iterator = names.iterator();    iterator.next();    names.remove(&quot;a&quot;);    iterator.next();//æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸  }}</code></pre><h1 id="2-å®ç°æ”¯æŒå¿«ç…§åŠŸèƒ½çš„iterator"><a href="#2-å®ç°æ”¯æŒå¿«ç…§åŠŸèƒ½çš„iterator" class="headerlink" title="2. å®ç°æ”¯æŒå¿«ç…§åŠŸèƒ½çš„iterator"></a>2. å®ç°æ”¯æŒå¿«ç…§åŠŸèƒ½çš„iterator</h1><ul><li>å¿«ç…§<ul><li>ä¸ºå®¹å™¨åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œç»™å®¹å™¨æ‹çš„å¿«ç…§</li><li>ä½¿å¾—å³ä¾¿æˆ‘ä»¬ä¹‹åå¢åˆ å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå¿«ç…§ä¸­çš„å…ƒç´ å¹¶ä¸ä¼šåšç›¸åº”çš„å˜åŠ¨</li><li>è¿™æ ·è¿­ä»£å™¨ä½¿ç”¨çš„å¯¹è±¡æ˜¯å¿«ç…§ï¼Œè€Œä¸æ˜¯å®¹å™¨ï¼Œè¿™æ ·å°±é¿å…äº†åœ¨ä½¿ç”¨è¿­ä»£å™¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºå¢åˆ å®¹å™¨ä¸­çš„å…ƒç´ è€Œå¯¼è‡´çš„ä¸å¯é¢„æœŸçš„ç»“æœæˆ–æŠ¥é”™ã€‚</li></ul></li></ul><ul><li>å¯ä»¥åœ¨è¿­ä»£å™¨ç±»å½“ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡snapshotæ¥å­˜å‚¨å¿«ç…§<ul><li>æ¯å½“è¿­ä»£å™¨éœ€è¦è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œéƒ½æ‹·è´ä¸€ä»½å®¹å™¨ä¸­çš„å…ƒç´ åˆ°å¿«ç…§å½“ä¸­ï¼Œåç»­çš„éå†æ“ä½œéƒ½åŸºäºè¿™ä¸ªè¿­ä»£å™¨è‡ªå·±æŒæœ‰çš„å¿«ç…§æ¥è¿›è¡Œ</li><li>é—®é¢˜<ul><li>ä»£ä»·é«˜ï¼Œæ¯æ¬¡åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œéƒ½è¦æ‹·è´ä¸€ä»½æ•°æ®åˆ°å¿«ç…§å½“ä¸­ï¼Œä¼šå¢åŠ å†…å­˜çš„æ¶ˆè€—</li></ul></li></ul></li></ul><pre><code>public class SnapshotArrayIterator&lt;E&gt; implements Iterator&lt;E&gt; {  private int cursor;  private ArrayList&lt;E&gt; snapshot;  public SnapshotArrayIterator(ArrayList&lt;E&gt; arrayList) {    this.cursor = 0;    this.snapshot = new ArrayList&lt;&gt;();    this.snapshot.addAll(arrayList);  }  @Override  public boolean hasNext() {    return cursor &lt; snapshot.size();  }  @Override  public E next() {    E currentItem = snapshot.get(cursor);    cursor++;    return currentItem;  }}</code></pre><ul><li>å¯ä»¥åœ¨å®¹å™¨å½“ä¸­ä¸ºæ¯ä¸ªå…ƒç´ ä¿å­˜ä¸¤ä¸ªæ—¶é—´æˆ³<ul><li>addTimestamp</li><li>delTimestamp</li><li>å½“å…ƒç´ è¢«åŠ å…¥åˆ°é›†åˆå½“ä¸­çš„æ—¶å€™ï¼ŒaddTimestampè®¾ç½®ä¸ºå½“å‰æ—¶é—´ï¼Œå°†delTimestampè®¾ç½®æˆæœ€å¤§é•¿æ•´å½¢å€¼ã€‚å½“å…ƒç´ è¢«åˆ é™¤æ—¶ï¼Œå°†delTimestampæ›´æ–°ä¸ºå½“å‰æ—¶é—´ï¼Œè¡¨ç¤ºå·²ç»è¢«åˆ é™¤</li><li>æ¯ä¸ªè¿­ä»£å™¨ä¹Ÿä¿å­˜ä¸€ä¸ªè¿­ä»£å™¨åˆ›å»ºæ—¶é—´æˆ³ snapshotTimestamp<ul><li>åªæœ‰æ»¡è¶³addTimestamp &lt; snapshotTimestamp &lt; delTimestampï¼Œæ‰æ˜¯å±äºè¿™ä¸ªè¿­ä»£å™¨çš„å¿«ç…§</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¿­ä»£å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-çŠ¶æ€æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><p>çŠ¶æ€æ¨¡å¼ä¸€èˆ¬ç”¨æ¥å®ç°çŠ¶æ€æœºï¼Œå¸¸å¸¸ç”¨åœ¨æ¸¸æˆï¼Œå·¥ä½œæµå¼•æ“ç­‰ç³»ç»Ÿå¼€å‘å½“ä¸­ã€‚</p><p>åšæ³•æ˜¯å°†çŠ¶æ€ï¼Œäº‹ä»¶ï¼Œä»¥åŠåŠ¨ä½œéƒ½æ”¾ç½®åˆ°ä¸åŒçš„ç±»å½“ä¸­ï¼Œé€šè¿‡æ¥å£ä¸ç»§æ‰¿ï¼Œæ¥å®ç°å„ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­å…±äº«å˜é‡å¯ä»¥ä½œä¸ºè¾“å…¥ä¼ å…¥ã€‚ </p><h1 id="2-ä»¥æœ‰é™çŠ¶æ€æœºçš„å®ç°ä¸ºä¾‹"><a href="#2-ä»¥æœ‰é™çŠ¶æ€æœºçš„å®ç°ä¸ºä¾‹" class="headerlink" title="2. ä»¥æœ‰é™çŠ¶æ€æœºçš„å®ç°ä¸ºä¾‹"></a>2. ä»¥æœ‰é™çŠ¶æ€æœºçš„å®ç°ä¸ºä¾‹</h1><ul><li>æœ‰é™çŠ¶æ€æœº<ul><li>Finite State Machine</li><li>ç»„æˆéƒ¨åˆ†<ul><li>çŠ¶æ€</li><li>äº‹ä»¶/ è½¬ç§»æ¡ä»¶<ul><li>è§¦å‘çŠ¶æ€çš„è½¬ç§»</li><li>åŠ¨ä½œçš„æ‰§è¡Œ</li></ul></li><li>åŠ¨ä½œ</li></ul></li></ul></li></ul><p>ä»¥ä¸‹é¢çš„çŠ¶æ€è½¬ç§»å›¾ä¸ºä¾‹ï¼š </p><p><img src="https://i.loli.net/2020/07/21/jzSQHTRxkybDBYE.png" alt="çŠ¶æ€è½¬ç§»å›¾"></p><h2 id="2-1-åˆ†æ”¯é€»è¾‘æ³•å®ç°"><a href="#2-1-åˆ†æ”¯é€»è¾‘æ³•å®ç°" class="headerlink" title="2.1 åˆ†æ”¯é€»è¾‘æ³•å®ç°"></a>2.1 åˆ†æ”¯é€»è¾‘æ³•å®ç°</h2><p>ä¼šåŒ…å«å¤§é‡çš„if-elseè¯­å¥</p><pre><code>public class MarioStateMachine {  private int score;  private State currentState;  public MarioStateMachine() {    this.score = 0;    this.currentState = State.SMALL;  }  public void obtainMushRoom() {    if (currentState.equals(State.SMALL)) {      this.currentState = State.SUPER;      this.score += 100;    }  }  public void obtainCape() {    if (currentState.equals(State.SMALL) || currentState.equals(State.SUPER) ) {      this.currentState = State.CAPE;      this.score += 200;    }  }  public void obtainFireFlower() {    if (currentState.equals(State.SMALL) || currentState.equals(State.SUPER) ) {      this.currentState = State.FIRE;      this.score += 300;    }  }  public void meetMonster() {    if (currentState.equals(State.SUPER)) {      this.currentState = State.SMALL;      this.score -= 100;      return;    }    if (currentState.equals(State.CAPE)) {      this.currentState = State.SMALL;      this.score -= 200;      return;    }    if (currentState.equals(State.FIRE)) {      this.currentState = State.SMALL;      this.score -= 300;      return;    }  }  public int getScore() {    return this.score;  }  public State getCurrentState() {    return this.currentState;  }}</code></pre><h2 id="2-2-æŸ¥è¡¨æ³•"><a href="#2-2-æŸ¥è¡¨æ³•" class="headerlink" title="2.2 æŸ¥è¡¨æ³•"></a>2.2 æŸ¥è¡¨æ³•</h2><p><img src="https://i.loli.net/2020/07/21/127jeqv5CwsIWKP.png" alt="æŸ¥è¡¨æ³•.png"></p><p>ä½¿ç”¨ä¸€å¼ äºŒç»´è¡¨æ¥è¡¨ç¤ºçŠ¶æ€æœºï¼Œçºµå‘è¡¨ç¤ºå½“å‰çŠ¶æ€ï¼Œæ¨ªå‘è¡¨ç¤ºäº‹ä»¶ï¼Œå€¼è¡¨ç¤ºå½“å‰çŠ¶æ€ç»è¿‡äº‹ä»¶ä»¥åï¼Œè½¬ç§»åˆ°çš„æ–°çŠ¶æ€å’Œå…¶æ‰§è¡Œçš„åŠ¨ä½œ</p><pre><code>public enum Event {  GOT_MUSHROOM(0),  GOT_CAPE(1),  GOT_FIRE(2),  MET_MONSTER(3);  private int value;  private Event(int value) {    this.value = value;  }  public int getValue() {    return this.value;  }}public class MarioStateMachine {  private int score;  private State currentState;  private static final State[][] transitionTable = {          {SUPER, CAPE, FIRE, SMALL},          {SUPER, CAPE, FIRE, SMALL},          {CAPE, CAPE, CAPE, SMALL},          {FIRE, FIRE, FIRE, SMALL}  };  private static final int[][] actionTable = {          {+100, +200, +300, +0},          {+0, +200, +300, -100},          {+0, +0, +0, -200},          {+0, +0, +0, -300}  };  public MarioStateMachine() {    this.score = 0;    this.currentState = State.SMALL;  }  public void obtainMushRoom() {    executeEvent(Event.GOT_MUSHROOM);  }  public void obtainCape() {    executeEvent(Event.GOT_CAPE);  }  public void obtainFireFlower() {    executeEvent(Event.GOT_FIRE);  }  public void meetMonster() {    executeEvent(Event.MET_MONSTER);  }  private void executeEvent(Event event) {    int stateValue = currentState.getValue();    int eventValue = event.getValue();    this.currentState = transitionTable[stateValue][eventValue];    this.score = actionTable[stateValue][eventValue];  }  public int getScore() {    return this.score;  }  public State getCurrentState() {    return this.currentState;  }}</code></pre><h2 id="2-3-çŠ¶æ€æ¨¡å¼"><a href="#2-3-çŠ¶æ€æ¨¡å¼" class="headerlink" title="2.3 çŠ¶æ€æ¨¡å¼"></a>2.3 çŠ¶æ€æ¨¡å¼</h2><p>å½“è¦æ‰§è¡Œçš„åŠ¨ä½œæ˜¯æ¯”è¾ƒå¤æ‚çš„ä¸€ç³»åˆ—é€»è¾‘æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨äºŒç»´æ•°ç»„æ¥è¡¨ç¤ºäº†ã€‚çŠ¶æ€æ¨¡å¼æ˜¯å°†äº‹ä»¶è§¦å‘çš„çŠ¶æ€è½¬ç§»å’ŒåŠ¨ä½œæ‰§è¡Œæ¥æ‹†åˆ†åˆ°ä¸åŒçš„çŠ¶æ€ç±»å½“ä¸­ï¼Œæ¥é¿å…åˆ†æ”¯åˆ¤æ–­é€»è¾‘ã€‚</p><pre><code>public interface IMario {  State getName();  void obtainMushRoom(MarioStateMachine stateMachine);  void obtainCape(MarioStateMachine stateMachine);  void obtainFireFlower(MarioStateMachine stateMachine);  void meetMonster(MarioStateMachine stateMachine);}public class SmallMario implements IMario {  private static final SmallMario instance = new SmallMario();  private SmallMario() {}  public static SmallMario getInstance() {    return instance;  }  @Override  public State getName() {    return State.SMALL;  }  @Override  public void obtainMushRoom(MarioStateMachine stateMachine) {    stateMachine.setCurrentState(SuperMario.getInstance());    stateMachine.setScore(stateMachine.getScore() + 100);  }  @Override  public void obtainCape(MarioStateMachine stateMachine) {    stateMachine.setCurrentState(CapeMario.getInstance());    stateMachine.setScore(stateMachine.getScore() + 200);  }  @Override  public void obtainFireFlower(MarioStateMachine stateMachine) {    stateMachine.setCurrentState(FireMario.getInstance());    stateMachine.setScore(stateMachine.getScore() + 300);  }  @Override  public void meetMonster(MarioStateMachine stateMachine) {    // do nothing...  }}// çœç•¥SuperMarioã€CapeMarioã€FireMarioç±»...public class MarioStateMachine {  private int score;  private IMario currentState;  public MarioStateMachine() {    this.score = 0;    this.currentState = SmallMario.getInstance();  }  public void obtainMushRoom() {    this.currentState.obtainMushRoom(this);  }  public void obtainCape() {    this.currentState.obtainCape(this);  }  public void obtainFireFlower() {    this.currentState.obtainFireFlower(this);  }  public void meetMonster() {    this.currentState.meetMonster(this);  }  public int getScore() {    return this.score;  }  public State getCurrentState() {    return this.currentState.getName();  }  public void setScore(int score) {    this.score = score;  }  public void setCurrentState(IMario currentState) {    this.currentState = currentState;  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çŠ¶æ€æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-èŒè´£é“¾æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><ul><li>èŒè´£é“¾æ¨¡å¼<ul><li>Chian of Responsibility Design Pattern </li><li>Avoid coupling the sender of a request to its receiver by giving more than one object a chance to hadle the request. Chain the receiving objects and pass the request along the chain until an object handles it. </li><li>å°†è¯·æ±‚çš„å‘é€å’Œæ¥æ”¶è§£è€¦ï¼Œè®©å¤šä¸ªæ¥æ”¶å¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚å°†è¿™äº›æ¥æ”¶å¯¹è±¡ä¸²æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¿™ä¸ªè¯·æ±‚ï¼Œç›´åˆ°é“¾ä¸Šçš„æŸä¸ªæ¥æ”¶å¯¹è±¡èƒ½å¤Ÿå¤„ç†å®ƒä¸ºæ­¢</li><li>åœ¨èŒè´£é“¾æ¨¡å¼å½“ä¸­ï¼Œå¤šä¸ªå¤„ç†å™¨ä¾æ¬¡å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚å…ˆç»è¿‡Aå¤„ç†å™¨å¤„ç†ï¼Œå†æŠŠè¯·æ±‚ä¼ é€’ç»™Bå¤„ç†å™¨ï¼ŒBå¤„ç†å™¨å¤„ç†å®Œä»¥åå†ä¼ é€’ç»™Cå¤„ç†å™¨ã€‚å„ä¸ªå¤„ç†å™¨ä¹‹é—´å½¢æˆäº†ä¸€ä¸ªé“¾æ¡ï¼Œé“¾æ¡ä¸Šçš„æ¯ä¸ªå¤„ç†å™¨å„è‡ªæ‰¿æ‹…å„è‡ªçš„å¤„ç†èŒè´£ï¼Œæ‰€ä»¥å«åšèŒè´£é“¾æ¨¡å¼ã€‚</li></ul></li></ul><h2 id="1-1-ä½¿ç”¨é“¾è¡¨å®ç°HandlerChain"><a href="#1-1-ä½¿ç”¨é“¾è¡¨å®ç°HandlerChain" class="headerlink" title="1.1 ä½¿ç”¨é“¾è¡¨å®ç°HandlerChain"></a>1.1 ä½¿ç”¨é“¾è¡¨å®ç°HandlerChain</h2><ul><li>Handleræ˜¯æ‰€æœ‰å¤„ç†å™¨çš„æŠ½è±¡çˆ¶ç±»</li><li>handle()æ˜¯æŠ½è±¡æ–¹æ³•</li><li>æ¯ä¸ªå…·ä½“çš„å¤„ç†å™¨ç±»çš„handle()å‡½æ•°ç»“æ„ä¼šæ¯”è¾ƒç±»ä¼¼ï¼Œå¦‚æœèƒ½å¤„ç†è¯·æ±‚ï¼Œåˆ™è¿›è¡Œå¤„ç†ï¼›å¦‚æœä¸èƒ½ï¼Œåˆ™äº¤ç”±åé¢çš„å¤„ç†å™¨æ¥è¿›è¡Œå¤„ç†</li><li>HandlerChainæ˜¯å¤„ç†å™¨é“¾ï¼Œä»æ•°æ®ç»“æ„æ¥çœ‹ï¼Œæ˜¯ä¸€ä¸ªè®°å½•äº†é“¾å¤´ã€é“¾å°¾çš„é“¾è¡¨ã€‚</li></ul><p>public abstract class Handler {<br>  protected Handler successor = null;</p><p>  public void setSuccessor(Handler successor) {<br>    this.successor = successor;<br>  }</p><p>  public final void handle() {<br>    boolean handled = doHandle();</p><pre><code>if (successor != null &amp;&amp; !handled) {    successor.handle();}</code></pre><p>  }<br>  public abstract boolean doHandle();<br>}</p><p>public class HandlerA extends Handler {<br>  @Override<br>  public void doHandle() {<br>    boolean handled = false;<br>    //â€¦<br>    return handled;<br>  }<br>}</p><p>public class HandlerB extends Handler {<br>  @Override<br>  public void doHandle() {<br>    boolean handled = false;<br>    //â€¦<br>    return handled;<br>  }<br>}</p><p>public class HandlerChain {<br>  private Handler head = null;<br>  private Handler tail = null;</p><p>  public void addHandler(Handler handler) {<br>    handler.setSuccessor(null);</p><pre><code>if (head == null) {  head = handler;  tail = handler;  return;}tail.setSuccessor(handler);tail = handler;</code></pre><p>  }</p><p>  public void handle() {<br>    if (head != null) {<br>      head.handle();<br>    }<br>  }<br>}</p><p>// ä½¿ç”¨ä¸¾ä¾‹<br>public class Application {<br>  public static void main(String[] args) {<br>    HandlerChain chain = new HandlerChain();<br>    chain.addHandler(new HandlerA());<br>    chain.addHandler(new HandlerB());<br>    chain.handle();<br>  }<br>}</p><h2 id="1-2-ä½¿ç”¨æ•°ç»„å®ç°HandlerChain"><a href="#1-2-ä½¿ç”¨æ•°ç»„å®ç°HandlerChain" class="headerlink" title="1.2 ä½¿ç”¨æ•°ç»„å®ç°HandlerChain"></a>1.2 ä½¿ç”¨æ•°ç»„å®ç°HandlerChain</h2><pre><code>public interface IHandler {  boolean handle();}public class HandlerA implements IHandler {  @Override  public boolean handle() {    boolean handled = false;    //...    return handled;  }}public class HandlerB implements IHandler {  @Override  public boolean handle() {    boolean handled = false;    //...    return handled;  }}public class HandlerChain {  private List&lt;IHandler&gt; handlers = new ArrayList&lt;&gt;();  public void addHandler(IHandler handler) {    this.handlers.add(handler);  }  public void handle() {    for (IHandler handler : handlers) {      boolean handled = handler.handle();      if (handled) {        break;      }    }  }}// ä½¿ç”¨ä¸¾ä¾‹public class Application {  public static void main(String[] args) {    HandlerChain chain = new HandlerChain();    chain.addHandler(new HandlerA());    chain.addHandler(new HandlerB());    chain.handle();  }}</code></pre><h1 id="2-è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨çš„å®ç°"><a href="#2-è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨çš„å®ç°" class="headerlink" title="2. è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨çš„å®ç°"></a>2. è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨çš„å®ç°</h1><p>èŒè´£é“¾æ¨¡å¼æœ€é•¿å»ºçš„ä½¿ç”¨ä½ç½®æ˜¯åœ¨æ¡†æ¶çš„å¼€å‘å½“ä¸­ï¼Œæ¯”å¦‚è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨ã€‚</p><h2 id="2-1-Servlet-Filter"><a href="#2-1-Servlet-Filter" class="headerlink" title="2.1 Servlet Filter"></a>2.1 Servlet Filter</h2><ul><li><p>å®ç°å †HTTPè¯·æ±‚çš„è¿‡æ»¤åŠŸèƒ½</p><ul><li>é‰´æƒ</li><li>é™æµ</li><li>è®°å½•æ—¥å¿—</li><li>éªŒè¯å‚æ•°ç­‰</li></ul></li><li><p>åœ¨å®é™…ä½¿ç”¨å½“ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªå®ç°<code>javax.servlet.Filter</code>æ¥å£çš„è¿‡æ»¤å™¨ç±»ï¼Œå¹¶ä¸”å°†å…¶é…ç½®åœ¨web.xmlé…ç½®æ–‡ä»¶å½“ä¸­ã€‚Webå®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè¯»å–web.xmlä¸­çš„é…ç½®ï¼Œåˆ›å»ºè¿‡æ»¤å™¨å¯¹è±¡ã€‚</p></li><li><p>å½“æœ‰è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼Œå°±ä¼šå…ˆç»è¿‡è¿‡æ»¤å™¨ï¼Œç„¶åç»ç”±Servletæ¥è¿›è¡Œå¤„ç†</p></li></ul><pre><code>public class LogFilter implements Filter {  @Override  public void init(FilterConfig filterConfig) throws ServletException {    // åœ¨åˆ›å»ºFilteræ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œ    // å…¶ä¸­filterConfigåŒ…å«è¿™ä¸ªFilterçš„é…ç½®å‚æ•°ï¼Œæ¯”å¦‚nameä¹‹ç±»çš„ï¼ˆä»é…ç½®æ–‡ä»¶ä¸­è¯»å–çš„ï¼‰  }  @Override  public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {    System.out.println(&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;);    chain.doFilter(request, response);    System.out.println(&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;);  }  @Override  public void destroy() {    // åœ¨é”€æ¯Filteræ—¶è‡ªåŠ¨è°ƒç”¨  }}// åœ¨web.xmlé…ç½®æ–‡ä»¶ä¸­å¦‚ä¸‹é…ç½®ï¼š&lt;filter&gt;  &lt;filter-name&gt;logFilter&lt;/filter-name&gt;  &lt;filter-class&gt;com.xzg.cd.LogFilter&lt;/filter-class&gt;&lt;/filter&gt;&lt;filter-mapping&gt;    &lt;filter-name&gt;logFilter&lt;/filter-name&gt;    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt;</code></pre><ul><li>FilterChainçš„å®ç°</li></ul><pre><code>public final class ApplicationFilterChain implements FilterChain {  private int pos = 0; //å½“å‰æ‰§è¡Œåˆ°äº†å“ªä¸ªfilter  private int n; //filterçš„ä¸ªæ•°  private ApplicationFilterConfig[] filters;  private Servlet servlet;  @Override  public void doFilter(ServletRequest request, ServletResponse response) {    if (pos &lt; n) {      ApplicationFilterConfig filterConfig = filters[pos++];      Filter filter = filterConfig.getFilter();      filter.doFilter(request, response, this);    } else {      // filteréƒ½å¤„ç†å®Œæ¯•åï¼Œæ‰§è¡Œservlet      servlet.service(request, response);    }  }  public void addFilter(ApplicationFilterConfig filterConfig) {    for (ApplicationFilterConfig filter:filters)      if (filter==filterConfig)         return;    if (n == filters.length) {//æ‰©å®¹      ApplicationFilterConfig[] newFilters = new ApplicationFilterConfig[n + INCREMENT];      System.arraycopy(filters, 0, newFilters, 0, n);      filters = newFilters;    }    filters[n++] = filterConfig;  }}</code></pre><h2 id="2-2-Spring-Interceptor"><a href="#2-2-Spring-Interceptor" class="headerlink" title="2.2 Spring Interceptor"></a>2.2 Spring Interceptor</h2><p>æœ‰Spring MVCæ¡†æ¶æ¥æä¾›å®ç°ï¼Œå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ï¼Œä¼šå…ˆç»è¿‡Servlet Filterï¼Œç„¶ååœ¨ç»è¿‡Spring Interceptorï¼Œæœ€åå†åˆ°è¾¾å…·ä½“çš„ä¸šåŠ¡ä»£ç å½“ä¸­ã€‚ </p><pre><code>// ä»£ç å®ç°public class LogInterceptor implements HandlerInterceptor {  @Override  public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {    System.out.println(&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;);    return true; // ç»§ç»­åç»­çš„å¤„ç†  }  @Override  public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {    System.out.println(&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;);  }  @Override  public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {    System.out.println(&quot;è¿™é‡Œæ€»æ˜¯è¢«æ‰§è¡Œ.&quot;);  }}//åœ¨Spring MVCé…ç½®æ–‡ä»¶ä¸­é…ç½®interceptors&lt;mvc:interceptors&gt;   &lt;mvc:interceptor&gt;       &lt;mvc:mapping path=&quot;/*&quot;/&gt;       &lt;bean class=&quot;com.xzg.cd.LogInterceptor&quot; /&gt;   &lt;/mvc:interceptor&gt;&lt;/mvc:interceptors&gt;</code></pre><ul><li>Spring Interceptoråº•å±‚å®ç°<ul><li>åŸºäºèŒè´£é“¾æ¨¡å¼</li><li>ä½¿ç”¨HandlerExecutionChainæ¥å¤„ç†</li></ul></li></ul><pre><code>public class HandlerExecutionChain { private final Object handler; private HandlerInterceptor[] interceptors; public void addInterceptor(HandlerInterceptor interceptor) {  initInterceptorList().add(interceptor); } boolean applyPreHandle(HttpServletRequest request, HttpServletResponse response) throws Exception {  HandlerInterceptor[] interceptors = getInterceptors();  if (!ObjectUtils.isEmpty(interceptors)) {   for (int i = 0; i &lt; interceptors.length; i++) {    HandlerInterceptor interceptor = interceptors[i];    if (!interceptor.preHandle(request, response, this.handler)) {     triggerAfterCompletion(request, response, null);     return false;    }   }  }  return true; } void applyPostHandle(HttpServletRequest request, HttpServletResponse response, ModelAndView mv) throws Exception {  HandlerInterceptor[] interceptors = getInterceptors();  if (!ObjectUtils.isEmpty(interceptors)) {   for (int i = interceptors.length - 1; i &gt;= 0; i--) {    HandlerInterceptor interceptor = interceptors[i];    interceptor.postHandle(request, response, this.handler, mv);   }  } } void triggerAfterCompletion(HttpServletRequest request, HttpServletResponse response, Exception ex)   throws Exception {  HandlerInterceptor[] interceptors = getInterceptors();  if (!ObjectUtils.isEmpty(interceptors)) {   for (int i = this.interceptorIndex; i &gt;= 0; i--) {    HandlerInterceptor interceptor = interceptors[i];    try {     interceptor.afterCompletion(request, response, this.handler, ex);    } catch (Throwable ex2) {     logger.error(&quot;HandlerInterceptor.afterCompletion threw exception&quot;, ex2);    }   }  } }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èŒè´£é“¾æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-ç­–ç•¥æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>ç­–ç•¥æ¨¡å¼ï¼Œç”¨äºé¿å…å†—é•¿çš„if elseæˆ–è€…switchåˆ†æ”¯åˆ¤æ–­ï¼Œå¹¶ä¸”å¯ä»¥åƒæ¨¡æ¿æ¨¡å¼é‚£æ ·æä¾›æ¡†æ¶çš„æ‰©å±•ç‚¹ã€‚</p><h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><ul><li>ç­–ç•¥æ¨¡å¼<ul><li>Strategy Design Pattern </li><li>Define a family of algorithms, encapsulate each one, and make them interchangeable. Strategy lets the algorithm vary independently from clients that use it. </li><li>å¯¹ç­–ç•¥çš„å®šä¹‰ï¼Œåˆ›å»ºå’Œä½¿ç”¨è¿›è¡Œè§£è€¦</li></ul></li></ul><h2 id="1-1-ç­–ç•¥çš„å®šä¹‰"><a href="#1-1-ç­–ç•¥çš„å®šä¹‰" class="headerlink" title="1.1 ç­–ç•¥çš„å®šä¹‰"></a>1.1 ç­–ç•¥çš„å®šä¹‰</h2><ul><li>ç­–ç•¥æ¥å£</li><li>ä¸€ç»„å®ç°äº†è¿™ä¸ªæ¥å£çš„ç­–ç•¥ç±»</li></ul><pre><code>public interface Strategy {  void algorithmInterface();}public class ConcreteStrategyA implements Strategy {  @Override  public void  algorithmInterface() {    //å…·ä½“çš„ç®—æ³•...  }}public class ConcreteStrategyB implements Strategy {  @Override  public void  algorithmInterface() {    //å…·ä½“çš„ç®—æ³•...  }}</code></pre><h2 id="1-2-ç­–ç•¥çš„åˆ›å»º"><a href="#1-2-ç­–ç•¥çš„åˆ›å»º" class="headerlink" title="1.2 ç­–ç•¥çš„åˆ›å»º"></a>1.2 ç­–ç•¥çš„åˆ›å»º</h2><ul><li><p>ç­–ç•¥åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ ¹æ®ç±»å‹æ¥åˆ¤æ–­åˆ›å»ºå“ªä¸ªç­–ç•¥æ¥ä½¿ç”¨</p></li><li><p>å› æ­¤ï¼Œä¸ºäº†å°è£…åˆ›å»ºé€»è¾‘ï¼Œéœ€è¦å¯¹å®¢æˆ·ç«¯ä»£ç å±è”½åˆ›å»ºç»†èŠ‚</p><p>  public class StrategyFactory {</p><pre><code>private static final Map&lt;String, Strategy&gt; strategies = new HashMap&lt;&gt;();static {  strategies.put(&quot;A&quot;, new ConcreteStrategyA());  strategies.put(&quot;B&quot;, new ConcreteStrategyB());}public static Strategy getStrategy(String type) {  if (type == null || type.isEmpty()) {    throw new IllegalArgumentException(&quot;type should not be empty.&quot;);  }  return strategies.get(type);}</code></pre><p>  }</p></li></ul><p>è¿™é‡Œæ˜¯éœ€è¦æ ¹æ®ç­–ç•¥æ˜¯å¦æ˜¯æœ‰çŠ¶æ€çš„ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯çš„éœ€è¦ï¼Œæ¥çœ‹æ˜¯å¦éœ€è¦è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œæˆ–è€…æ¥å¤ç”¨å·²ç»åˆ›å»ºå¥½çš„å¯¹è±¡ã€‚</p><pre><code>// è¿”å›æ–°åˆ›å»ºå¥½çš„å¯¹è±¡çš„èŒƒä¾‹public class StrategyFactory {  public static Strategy getStrategy(String type) {    if (type == null || type.isEmpty()) {      throw new IllegalArgumentException(&quot;type should not be empty.&quot;);    }    if (type.equals(&quot;A&quot;)) {      return new ConcreteStrategyA();    } else if (type.equals(&quot;B&quot;)) {      return new ConcreteStrategyB();    }    return null;  }}</code></pre><h2 id="1-3-ç­–ç•¥çš„ä½¿ç”¨"><a href="#1-3-ç­–ç•¥çš„ä½¿ç”¨" class="headerlink" title="1.3 ç­–ç•¥çš„ä½¿ç”¨"></a>1.3 ç­–ç•¥çš„ä½¿ç”¨</h2><p>ä½¿ç”¨çš„æ—¶å€™ä¸€èˆ¬æ˜¯è¿è¡Œæ—¶åŠ¨æ€æ¥å†³å®šä½¿ç”¨å“ªä¸€ç§ç­–ç•¥ã€‚å³æ ¹æ®é…ç½®ï¼Œç”¨æˆ·çš„è¾“å…¥ï¼Œè®¡ç®—ç»“æœç­‰å› ç´ ï¼Œæ¥å†³å®š </p><pre><code>// ç­–ç•¥æ¥å£ï¼šEvictionStrategy// ç­–ç•¥ç±»ï¼šLruEvictionStrategyã€FifoEvictionStrategyã€LfuEvictionStrategy...// ç­–ç•¥å·¥å‚ï¼šEvictionStrategyFactorypublic class UserCache {  private Map&lt;String, User&gt; cacheData = new HashMap&lt;&gt;();  private EvictionStrategy eviction;  public UserCache(EvictionStrategy eviction) {    this.eviction = eviction;  }  //...}// è¿è¡Œæ—¶åŠ¨æ€ç¡®å®šï¼Œæ ¹æ®é…ç½®æ–‡ä»¶çš„é…ç½®å†³å®šä½¿ç”¨å“ªç§ç­–ç•¥public class Application {  public static void main(String[] args) throws Exception {    EvictionStrategy evictionStrategy = null;    Properties props = new Properties();    props.load(new FileInputStream(&quot;./config.properties&quot;));    String type = props.getProperty(&quot;eviction_type&quot;);    evictionStrategy = EvictionStrategyFactory.getEvictionStrategy(type);    UserCache userCache = new UserCache(evictionStrategy);    //...  }}// éè¿è¡Œæ—¶åŠ¨æ€ç¡®å®šï¼Œåœ¨ä»£ç ä¸­æŒ‡å®šä½¿ç”¨å“ªç§ç­–ç•¥public class Application {  public static void main(String[] args) {    //...    EvictionStrategy evictionStrategy = new LruEvictionStrategy();    UserCache userCache = new UserCache(evictionStrategy);    //...  }}</code></pre><h1 id="2-å®ä¾‹"><a href="#2-å®ä¾‹" class="headerlink" title="2. å®ä¾‹"></a>2. å®ä¾‹</h1><h2 id="2-1-ç­–ç•¥æ¨¡å¼é¿å…åˆ†æ”¯åˆ¤æ–­"><a href="#2-1-ç­–ç•¥æ¨¡å¼é¿å…åˆ†æ”¯åˆ¤æ–­" class="headerlink" title="2.1 ç­–ç•¥æ¨¡å¼é¿å…åˆ†æ”¯åˆ¤æ–­"></a>2.1 ç­–ç•¥æ¨¡å¼é¿å…åˆ†æ”¯åˆ¤æ–­</h2><pre><code>public class OrderService {  public double discount(Order order) {    double discount = 0.0;    OrderType type = order.getType();    if (type.equals(OrderType.NORMAL)) { // æ™®é€šè®¢å•      //...çœç•¥æŠ˜æ‰£è®¡ç®—ç®—æ³•ä»£ç     } else if (type.equals(OrderType.GROUPON)) { // å›¢è´­è®¢å•      //...çœç•¥æŠ˜æ‰£è®¡ç®—ç®—æ³•ä»£ç     } else if (type.equals(OrderType.PROMOTION)) { // ä¿ƒé”€è®¢å•      //...çœç•¥æŠ˜æ‰£è®¡ç®—ç®—æ³•ä»£ç     }    return discount;  }}// ç­–ç•¥çš„å®šä¹‰public interface DiscountStrategy {  double calDiscount(Order order);}// çœç•¥NormalDiscountStrategyã€GrouponDiscountStrategyã€PromotionDiscountStrategyç±»ä»£ç ...// ç­–ç•¥çš„åˆ›å»ºpublic class DiscountStrategyFactory {  private static final Map&lt;OrderType, DiscountStrategy&gt; strategies = new HashMap&lt;&gt;();  static {    strategies.put(OrderType.NORMAL, new NormalDiscountStrategy());    strategies.put(OrderType.GROUPON, new GrouponDiscountStrategy());    strategies.put(OrderType.PROMOTION, new PromotionDiscountStrategy());  }  public static DiscountStrategy getDiscountStrategy(OrderType type) {    return strategies.get(type);  }}// ç­–ç•¥çš„ä½¿ç”¨public class OrderService {  public double discount(Order order) {    OrderType type = order.getType();    DiscountStrategy discountStrategy = DiscountStrategyFactory.getDiscountStrategy(type);    return discountStrategy.calDiscount(order);  }}</code></pre><h2 id="2-2-æ ¹æ®å¤§å°å¯¹æ–‡ä»¶æ’åº"><a href="#2-2-æ ¹æ®å¤§å°å¯¹æ–‡ä»¶æ’åº" class="headerlink" title="2.2 æ ¹æ®å¤§å°å¯¹æ–‡ä»¶æ’åº"></a>2.2 æ ¹æ®å¤§å°å¯¹æ–‡ä»¶æ’åº</h2><ul><li><p>å¯¹æ–‡ä»¶è¿›è¡Œæ’åº</p><ul><li>æ•´å‹æ•°</li><li>é€—å·é—´éš”</li></ul></li><li><p>100GBå¤§å°çš„è¯</p><ul><li>åˆ©ç”¨å¤–éƒ¨æ’åºç®—æ³•  â€“ MapReduceæ¡†æ¶</li></ul></li></ul><pre><code>public class SortAlgFactory {  private static final Map&lt;String, ISortAlg&gt; algs = new HashMap&lt;&gt;();  static {    algs.put(&quot;QuickSort&quot;, new QuickSort());    algs.put(&quot;ExternalSort&quot;, new ExternalSort());    algs.put(&quot;ConcurrentExternalSort&quot;, new ConcurrentExternalSort());    algs.put(&quot;MapReduceSort&quot;, new MapReduceSort());  }  public static ISortAlg getSortAlg(String type) {    if (type == null || type.isEmpty()) {      throw new IllegalArgumentException(&quot;type should not be empty.&quot;);    }    return algs.get(type);  }}public class Sorter {  private static final long GB = 1000 * 1000 * 1000;  public void sortFile(String filePath) {    // çœç•¥æ ¡éªŒé€»è¾‘    File file = new File(filePath);    long fileSize = file.length();    ISortAlg sortAlg;    if (fileSize &lt; 6 * GB) { // [0, 6GB)      sortAlg = SortAlgFactory.getSortAlg(&quot;QuickSort&quot;);    } else if (fileSize &lt; 10 * GB) { // [6GB, 10GB)      sortAlg = SortAlgFactory.getSortAlg(&quot;ExternalSort&quot;);    } else if (fileSize &lt; 100 * GB) { // [10GB, 100GB)      sortAlg = SortAlgFactory.getSortAlg(&quot;ConcurrentExternalSort&quot;);    } else { // [100GB, ~)      sortAlg = SortAlgFactory.getSortAlg(&quot;MapReduceSort&quot;);    }    sortAlg.sort(filePath);  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç­–ç•¥æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Intellij IDEA tips and tricks</title>
      <link href="/Intellij-IDEA-tips-and-tricks/"/>
      <url>/Intellij-IDEA-tips-and-tricks/</url>
      
        <content type="html"><![CDATA[<ol><li><p>Magic shortcut for almost everything<br>Alt + Enter </p></li><li><p>Jump to next error  </p></li></ol><p>F2 </p><ol start="3"><li><p>Project window<br>cmd + 1 </p></li><li><p>focus on editor  </p></li></ol><p>esc </p><ol start="5"><li>The recent file box  </li></ol><p>cmd E </p><ol start="6"><li>Go to declaration </li></ol><p>cmd + B </p><ol start="7"><li>Find usage </li></ol><p>Alt + F7 </p><ol start="8"><li>Run Anything </li></ol><p>double ctrl </p><p>*<em>9. Extend/ shrink selection *</em></p><p>option + up arrow </p><p>option + down arrow </p><ol start="10"><li>Add/ Remove comments</li></ol><p>cmd + / </p><ol start="11"><li>Complete current statement </li></ol><p>shift + cmd + enter </p><ol start="12"><li>Reformat file </li></ol><p>alt + cmd + l</p><ol start="13"><li>Refactor </li></ol><p>ctrl + t </p><p>Show all the refactor option </p><ol start="14"><li>Find action </li></ol><p>shift + cmd + A </p><ol start="15"><li>Search everywhere </li></ol><p>shift + shift </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.youtube.com/watch?v=QYO5_riePOQ" target="_blank" rel="noopener">https://www.youtube.com/watch?v=QYO5_riePOQ</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-æ¨¡æ¿æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><ul><li>æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼<ul><li>Template Method Design Pattern </li><li>Define the skeleton of an algorithm in an operation, deferring some steps to subclasses. Template method lets subclasses redefine certain steps of an algorithm without changing the algorithmâ€™s structure </li><li>åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•è‚¡ä»·ï¼Œå¹¶å°†æŸäº›æ­¥éª¤æ¨è¿Ÿåˆ°å­ç±»å½“ä¸­è¿›è¡Œå®ç°ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼å¯ä»¥è®©å­ç±»åœ¨ä¸æ”¹å˜ç®—æ³•æ•´ä½“ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•ä¸­çš„æŸäº›ä¸å¥½èµ°ã€‚</li></ul></li></ul><p>å®ç°çš„åŸºæœ¬æ–¹å¼å°±æ˜¯è®¾ç½®ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¯¹äºä¸æƒ³è¢«å­ç±»é‡å†™çš„æ–¹æ³•å¯ä»¥åŠ ä¸Šfinalå…³é”®å­—ï¼Œå…¶ä½™çš„å¯ä»¥è®¾ç½®ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œè®©å­ç±»æ¥å®ç°ã€‚</p><pre><code>public abstract class AbstractClass {  public final void templateMethod() {    //...    method1();    //...    method2();    //...  }  protected abstract void method1();  protected abstract void method2();}public class ConcreteClass1 extends AbstractClass {  @Override  protected void method1() {    //...  }  @Override  protected void method2() {    //...  }}public class ConcreteClass2 extends AbstractClass {  @Override  protected void method1() {    //...  }  @Override  protected void method2() {    //...  }}AbstractClass demo = ConcreteClass1();demo.templateMethod();</code></pre><h1 id="2-åŠŸèƒ½å®ç°çš„ä¾‹å­"><a href="#2-åŠŸèƒ½å®ç°çš„ä¾‹å­" class="headerlink" title="2. åŠŸèƒ½å®ç°çš„ä¾‹å­"></a>2. åŠŸèƒ½å®ç°çš„ä¾‹å­</h1><h2 id="2-1-ä»¥å¤ç”¨ä¸ºç›®çš„"><a href="#2-1-ä»¥å¤ç”¨ä¸ºç›®çš„" class="headerlink" title="2.1 ä»¥å¤ç”¨ä¸ºç›®çš„"></a>2.1 ä»¥å¤ç”¨ä¸ºç›®çš„</h2><ol><li><p>InputStream ç±»çš„å®ç°</p><p> public abstract class InputStream implements Closeable {<br>   //â€¦çœç•¥å…¶ä»–ä»£ç â€¦</p><p>   public int read(byte b[], int off, int len) throws IOException {</p><pre><code> if (b == null) {   throw new NullPointerException(); } else if (off &lt; 0 || len &lt; 0 || len &gt; b.length - off) {   throw new IndexOutOfBoundsException(); } else if (len == 0) {   return 0; } int c = read(); if (c == -1) {   return -1; } b[off] = (byte)c; int i = 1; try {   for (; i &lt; len ; i++) {     c = read();     if (c == -1) {       break;     }     b[off + i] = (byte)c;   } } catch (IOException ee) { } return i;</code></pre><p>   }</p><p>   // åœ¨è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå¯ä»¥ä¾›å­ç±»å®ç°çš„æŠ½è±¡æ–¹æ³•<br>   public abstract int read() throws IOException;<br> }</p><p> public class ByteArrayInputStream extends InputStream {<br>   //â€¦çœç•¥å…¶ä»–ä»£ç â€¦</p><p>   @Override<br>   public synchronized int read() {</p><pre><code> return (pos &lt; count) ? (buf[pos++] &amp; 0xff) : -1;</code></pre><p>   }<br> }</p></li></ol><ol start="2"><li>AbstractListçš„å®ç°</li></ol><pre><code>public boolean addAll(int index, Collection&lt;? extends E&gt; c) {    rangeCheckForAdd(index);    boolean modified = false;    for (E e : c) {        add(index++, e);        modified = true;    }    return modified;}public void add(int index, E element) {    throw new UnsupportedOperationException();}</code></pre><h2 id="2-2-ä»¥æ‰©å±•ä¸ºç›®çš„"><a href="#2-2-ä»¥æ‰©å±•ä¸ºç›®çš„" class="headerlink" title="2.2 ä»¥æ‰©å±•ä¸ºç›®çš„"></a>2.2 ä»¥æ‰©å±•ä¸ºç›®çš„</h2><ol><li>Java Servlet</li></ol><p>æŠ›å¼€æ¡†æ¶ç›´æ¥ä½¿ç”¨Servletåšå¼€å‘çš„è¯ï¼ŒServletåœ¨æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šæ ¹æ®URLå’ŒServletçš„æ˜ å°„å…³ç³»ï¼Œæ‰¾åˆ°å¯¹åº”çš„Servletï¼Œç„¶åæ¥æ‰§è¡Œå®ƒçš„service()æ–¹æ³•ã€‚serviceæ–¹æ³•å®šä¹‰åœ¨çˆ¶ç±»HttpServeletå½“ä¸­ï¼Œä¼šè°ƒç”¨doGet()è¿˜æœ‰doPost()æ–¹æ³•ã€‚</p><p>ä¸ºäº†å®ç°ä¸Šè¿°çš„æ•´ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦ç»§æ‰¿HttpServletï¼Œé‡æ–°å®ç°æˆ‘ä»¬è‡ªå·±çš„doGet()ä»¥åŠdoPost()æ–¹æ³•ã€‚</p><pre><code>public class HelloServlet extends HttpServlet {  @Override  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {    this.doPost(req, resp);  }  @Override  protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {    resp.getWriter().write(&quot;Hello World.&quot;);  }}// å­˜å‚¨æ˜ å°„å…³ç³»çš„xmlï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨annotationæ¥å®ç°æ˜ å°„&lt;servlet&gt;    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;    &lt;servlet-class&gt;com.xzg.cd.HelloServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt;    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;    &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;public void service(ServletRequest req, ServletResponse res)    throws ServletException, IOException{    HttpServletRequest  request;    HttpServletResponse response;    if (!(req instanceof HttpServletRequest &amp;&amp;            res instanceof HttpServletResponse)) {        throw new ServletException(&quot;non-HTTP request or response&quot;);    }    request = (HttpServletRequest) req;    response = (HttpServletResponse) res;    service(request, response);}protected void service(HttpServletRequest req, HttpServletResponse resp)    throws ServletException, IOException{    String method = req.getMethod();    if (method.equals(METHOD_GET)) {        long lastModified = getLastModified(req);        if (lastModified == -1) {            // servlet doesn&#39;t support if-modified-since, no reason            // to go through further expensive logic            doGet(req, resp);        } else {            long ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE);            if (ifModifiedSince &lt; lastModified) {                // If the servlet mod time is later, call doGet()                // Round down to the nearest second for a proper compare                // A ifModifiedSince of -1 will always be less                maybeSetLastModified(resp, lastModified);                doGet(req, resp);            } else {                resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);            }        }    } else if (method.equals(METHOD_HEAD)) {        long lastModified = getLastModified(req);        maybeSetLastModified(resp, lastModified);        doHead(req, resp);    } else if (method.equals(METHOD_POST)) {        doPost(req, resp);    } else if (method.equals(METHOD_PUT)) {        doPut(req, resp);    } else if (method.equals(METHOD_DELETE)) {        doDelete(req, resp);    } else if (method.equals(METHOD_OPTIONS)) {        doOptions(req,resp);    } else if (method.equals(METHOD_TRACE)) {        doTrace(req,resp);    } else {        String errMsg = lStrings.getString(&quot;http.method_not_implemented&quot;);        Object[] errArgs = new Object[1];        errArgs[0] = method;        errMsg = MessageFormat.format(errMsg, errArgs);        resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);    }}</code></pre><ol start="2"><li>JUnit TestCase</li></ol><p>Junitå®šä¹‰çš„åŠŸèƒ½æ‰©å±•ç‚¹ä¸ºï¼š</p><ul><li>setUp() </li><li>tearDown()</li><li>etc.</li></ul><p>å†™çš„æµ‹è¯•ç±»éƒ½æ˜¯ç»§æ‰¿æ¡†æ¶æä¾›çš„testCaseç±»ï¼Œåœ¨è¿™ä¸ªç±»å½“ä¸­ï¼ŒrunBare()å‡½æ•°æ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œå®šä¹‰äº†æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹çš„æ•´ä½“æµç¨‹:å…ˆæ‰§è¡ŒsetUp()åšå‡†å¤‡å·¥ä½œï¼Œç„¶åæ‰§è¡ŒrunTest()è¿è¡ŒçœŸæ­£çš„æµ‹è¯•ä»£ç ï¼Œæœ€åæ‰§è¡ŒtearDown()åšæ‰«å°¾å·¥ä½œã€‚</p><pre><code>public abstract class TestCase extends Assert implements Test {  public void runBare() throws Throwable {    Throwable exception = null;    setUp();    try {      runTest();    } catch (Throwable running) {      exception = running;    } finally {      try {        tearDown();      } catch (Throwable tearingDown) {        if (exception == null) exception = tearingDown;      }    }    if (exception != null) throw exception;  }  /**  * Sets up the fixture, for example, open a network connection.  * This method is called before a test is executed.  */  protected void setUp() throws Exception {  }  /**  * Tears down the fixture, for example, close a network connection.  * This method is called after a test is executed.  */  protected void tearDown() throws Exception {  }}</code></pre><h2 id="2-3-æ¨¡æ¿æ¨¡å¼å¯¹æ¯”Callbackå‡½æ•°"><a href="#2-3-æ¨¡æ¿æ¨¡å¼å¯¹æ¯”Callbackå‡½æ•°" class="headerlink" title="2.3 æ¨¡æ¿æ¨¡å¼å¯¹æ¯”Callbackå‡½æ•°"></a>2.3 æ¨¡æ¿æ¨¡å¼å¯¹æ¯”Callbackå‡½æ•°</h2><p>å›è°ƒå‡½æ•°å¯ä»¥èµ·åˆ°å’Œæ¨¡æ¿æ¨¡å¼ç›¸åŒçš„ä½œç”¨ï¼Œå›è°ƒæ˜¯ä¸€ç§åŒå‘è°ƒç”¨å…³ç³»</p><p>A ç±»äº‹å…ˆæ³¨å†ŒæŸä¸ªå‡½æ•° F åˆ° B ç±»ï¼ŒA ç±»åœ¨è°ƒç”¨ B ç±»çš„ P å‡½æ•°çš„æ—¶å€™ï¼ŒB ç±»åè¿‡æ¥è°ƒç”¨ A ç±»æ³¨å†Œç»™å®ƒçš„ F å‡½æ•°ã€‚è¿™é‡Œçš„ F å‡½æ•°å°±æ˜¯â€œå›è°ƒå‡½æ•°â€ã€‚A è°ƒç”¨ Bï¼ŒB åè¿‡æ¥åˆè°ƒç”¨ Aï¼Œè¿™ç§è°ƒç”¨æœºåˆ¶å°±å«ä½œâ€œå›è°ƒâ€ã€‚</p><p>å›è°ƒåˆ†ä¸ºåŒæ­¥å›è°ƒå’Œå¼‚æ­¥å›è°ƒï¼ŒåŒæ­¥å›è°ƒæŒ‡å‡½æ•°è¿”å›ä¹‹å‰æ‰§è¡Œå›è°ƒå‡½æ•°ï¼›å¼‚æ­¥å›è°ƒæŒ‡å‡½æ•°è¿”å›ä¹‹åæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><pre><code>public interface ICallback {  void methodToCallback();}public class BClass {  public void process(ICallback callback) {    //...    callback.methodToCallback();    //...  }}public class AClass {  public static void main(String[] args) {    BClass b = new BClass();    b.process(new ICallback() { //å›è°ƒå¯¹è±¡      @Override      public void methodToCallback() {        System.out.println(&quot;Call back me.&quot;);      }    });  }}</code></pre><ul><li>ä½¿ç”¨Callbackå‡½æ•°å®ç°çš„JDBCTemplate</li></ul><pre><code>@Overridepublic &lt;T&gt; List&lt;T&gt; query(String sql, RowMapper&lt;T&gt; rowMapper) throws DataAccessException { return query(sql, new RowMapperResultSetExtractor&lt;T&gt;(rowMapper));}@Overridepublic &lt;T&gt; T query(final String sql, final ResultSetExtractor&lt;T&gt; rse) throws DataAccessException { Assert.notNull(sql, &quot;SQL must not be null&quot;); Assert.notNull(rse, &quot;ResultSetExtractor must not be null&quot;); if (logger.isDebugEnabled()) {  logger.debug(&quot;Executing SQL query [&quot; + sql + &quot;]&quot;); } class QueryStatementCallback implements StatementCallback&lt;T&gt;, SqlProvider {  @Override  public T doInStatement(Statement stmt) throws SQLException {   ResultSet rs = null;   try {    rs = stmt.executeQuery(sql);    ResultSet rsToUse = rs;    if (nativeJdbcExtractor != null) {     rsToUse = nativeJdbcExtractor.getNativeResultSet(rs);    }    return rse.extractData(rsToUse);   }   finally {    JdbcUtils.closeResultSet(rs);   }  }  @Override  public String getSql() {   return sql;  } } return execute(new QueryStatementCallback());}@Overridepublic &lt;T&gt; T execute(StatementCallback&lt;T&gt; action) throws DataAccessException { Assert.notNull(action, &quot;Callback object must not be null&quot;); Connection con = DataSourceUtils.getConnection(getDataSource()); Statement stmt = null; try {  Connection conToUse = con;  if (this.nativeJdbcExtractor != null &amp;&amp;    this.nativeJdbcExtractor.isNativeConnectionNecessaryForNativeStatements()) {   conToUse = this.nativeJdbcExtractor.getNativeConnection(con);  }  stmt = conToUse.createStatement();  applyStatementSettings(stmt);  Statement stmtToUse = stmt;  if (this.nativeJdbcExtractor != null) {   stmtToUse = this.nativeJdbcExtractor.getNativeStatement(stmt);  }  T result = action.doInStatement(stmtToUse);  handleWarnings(stmt);  return result; } catch (SQLException ex) {  // Release Connection early, to avoid potential connection pool deadlock  // in the case when the exception translator hasn&#39;t been initialized yet.  JdbcUtils.closeStatement(stmt);  stmt = null;  DataSourceUtils.releaseConnection(con, getDataSource());  con = null;  throw getExceptionTranslator().translate(&quot;StatementCallback&quot;, getSql(action), ex); } finally {  JdbcUtils.closeStatement(stmt);  DataSourceUtils.releaseConnection(con, getDataSource()); }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ¿æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹-è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<ul><li>åˆ›å»ºå‹è®¾è®¡æ¨¡å¼<ul><li>è§£å†³å¯¹è±¡åˆ›å»ºçš„é—®é¢˜</li></ul></li></ul><ul><li><p>ç»“æ„å‹è®¾è®¡æ¨¡å¼</p><ul><li>è§£å†³ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆæˆ–ç»„è£…é—®é¢˜</li></ul></li><li><p>è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼</p><ul><li>è§£å†³ç±»æˆ–å¯¹è±¡ä¹‹é—´çš„äº¤äº’é—®é¢˜</li></ul></li></ul><h1 id="1-è§‚å¯Ÿè€…æ¨¡å¼åŸç†"><a href="#1-è§‚å¯Ÿè€…æ¨¡å¼åŸç†" class="headerlink" title="1. è§‚å¯Ÿè€…æ¨¡å¼åŸç†"></a>1. è§‚å¯Ÿè€…æ¨¡å¼åŸç†</h1><p>æ ¹æ®åº”ç”¨åœºæ™¯çš„ä¸åŒï¼Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¼šæœ‰ä¸åŒçš„ä»£ç å®ç°çš„<br>    + åŒæ­¥é˜»å¡<br>    + å¼‚æ­¥éé˜»å¡<br>    + è¿›ç¨‹å†…çš„å®ç°æ–¹å¼<br>    + è·¨è¿›ç¨‹çš„å®ç°æ–¹å¼</p><ul><li>è§‚å¯Ÿè€…æ¨¡å¼  Observer Design Pattern<ul><li>å‘å¸ƒè®¢é˜…æ¨¡å¼ Publish - Subscribe Design Pattern </li><li>Define a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically. </li><li>è§’è‰²åˆ’åˆ†<ul><li>observable and observer </li><li>publisher and subscriber </li><li>producer and consumer </li><li>subject and observer </li><li>dispatcher and listener </li><li>eventEmitter and EventListener </li></ul></li></ul></li></ul><pre><code>// Example public interface RegObserver {  void handleRegSuccess(long userId);}public class RegPromotionObserver implements RegObserver {  private PromotionService promotionService; // ä¾èµ–æ³¨å…¥  @Override  public void handleRegSuccess(long userId) {    promotionService.issueNewUserExperienceCash(userId);  }}public class RegNotificationObserver implements RegObserver {  private NotificationService notificationService;  @Override  public void handleRegSuccess(long userId) {    notificationService.sendInboxMessage(userId, &quot;Welcome...&quot;);  }}public class UserController {  private UserService userService; // ä¾èµ–æ³¨å…¥  private List&lt;RegObserver&gt; regObservers = new ArrayList&lt;&gt;();  // ä¸€æ¬¡æ€§è®¾ç½®å¥½ï¼Œä¹‹åä¹Ÿä¸å¯èƒ½åŠ¨æ€çš„ä¿®æ”¹  public void setRegObservers(List&lt;RegObserver&gt; observers) {    regObservers.addAll(observers);  }  public Long register(String telephone, String password) {    //çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç     //çœç•¥userService.register()å¼‚å¸¸çš„try-catchä»£ç     long userId = userService.register(telephone, password);    for (RegObserver observer : regObservers) {      observer.handleRegSuccess(userId);    }    return userId;  }}</code></pre><h1 id="2-æ¢ç©¶å¼‚æ­¥éé˜»å¡çš„EventBusæ¡†æ¶"><a href="#2-æ¢ç©¶å¼‚æ­¥éé˜»å¡çš„EventBusæ¡†æ¶" class="headerlink" title="2. æ¢ç©¶å¼‚æ­¥éé˜»å¡çš„EventBusæ¡†æ¶"></a>2. æ¢ç©¶å¼‚æ­¥éé˜»å¡çš„EventBusæ¡†æ¶</h1><h2 id="2-1-åŸºæœ¬çš„å¼‚æ­¥éé˜»å¡æ¨¡å¼"><a href="#2-1-åŸºæœ¬çš„å¼‚æ­¥éé˜»å¡æ¨¡å¼" class="headerlink" title="2.1 åŸºæœ¬çš„å¼‚æ­¥éé˜»å¡æ¨¡å¼"></a>2.1 åŸºæœ¬çš„å¼‚æ­¥éé˜»å¡æ¨¡å¼</h2><pre><code>// ç¬¬ä¸€ç§å®ç°æ–¹å¼ï¼Œå…¶ä»–ç±»ä»£ç ä¸å˜ï¼Œå°±æ²¡æœ‰å†é‡å¤ç½—åˆ—public class RegPromotionObserver implements RegObserver {  private PromotionService promotionService; // ä¾èµ–æ³¨å…¥  @Override  public void handleRegSuccess(long userId) {    Thread thread = new Thread(new Runnable() {      @Override      public void run() {        promotionService.issueNewUserExperienceCash(userId);      }    });    thread.start();  }}// ç¬¬äºŒç§å®ç°æ–¹å¼ï¼Œå…¶ä»–ç±»ä»£ç ä¸å˜ï¼Œå°±æ²¡æœ‰å†é‡å¤ç½—åˆ—public class UserController {  private UserService userService; // ä¾èµ–æ³¨å…¥  private List&lt;RegObserver&gt; regObservers = new ArrayList&lt;&gt;();  private Executor executor;  public UserController(Executor executor) {    this.executor = executor;  }  public void setRegObservers(List&lt;RegObserver&gt; observers) {    regObservers.addAll(observers);  }  public Long register(String telephone, String password) {    //çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç     //çœç•¥userService.register()å¼‚å¸¸çš„try-catchä»£ç     long userId = userService.register(telephone, password);    for (RegObserver observer : regObservers) {      executor.execute(new Runnable() {        @Override        public void run() {          observer.handleRegSuccess(userId);        }      });    }    return userId;  }}</code></pre><ul><li><p>æ–¹æ³•1 </p><ul><li>é¢‘ç¹åˆ›å»ºé”€æ¯çº¿ç¨‹æ¯”è¾ƒè€—æ—¶</li><li>å¹¶ä¸”åˆ›å»ºè¿‡å¤šçº¿ç¨‹ä¼šå¯¼è‡´å †æ ˆæº¢å‡º</li></ul></li><li><p>æ–¹æ³•2 </p><ul><li>çº¿ç¨‹æ± ï¼Œå¼‚æ­¥æ‰§è¡Œçš„é€»è¾‘è€¦åˆåœ¨äº†register()å‡½æ•°å½“ä¸­ï¼Œç»´æŠ¤æˆæœ¬ä¼šæé«˜</li></ul></li></ul><h2 id="2-2-EventBusåŠŸèƒ½éœ€æ±‚"><a href="#2-2-EventBusåŠŸèƒ½éœ€æ±‚" class="headerlink" title="2.2 EventBusåŠŸèƒ½éœ€æ±‚"></a>2.2 EventBusåŠŸèƒ½éœ€æ±‚</h2><p>ä»¥google guava eventBusä¸ºä¾‹</p><pre><code>public class UserController {  private UserService userService; // ä¾èµ–æ³¨å…¥  private EventBus eventBus;  private static final int DEFAULT_EVENTBUS_THREAD_POOL_SIZE = 20;  public UserController() {    //eventBus = new EventBus(); // åŒæ­¥é˜»å¡æ¨¡å¼    eventBus = new AsyncEventBus(Executors.newFixedThreadPool(DEFAULT_EVENTBUS_THREAD_POOL_SIZE)); // å¼‚æ­¥éé˜»å¡æ¨¡å¼  }  public void setRegObservers(List&lt;Object&gt; observers) {    for (Object observer : observers) {      eventBus.register(observer);    }  }  public Long register(String telephone, String password) {    //çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç     //çœç•¥userService.register()å¼‚å¸¸çš„try-catchä»£ç     long userId = userService.register(telephone, password);    eventBus.post(userId);    return userId;  }}public class RegPromotionObserver {  private PromotionService promotionService; // ä¾èµ–æ³¨å…¥  @Subscribe  public void handleRegSuccess(long userId) {    promotionService.issueNewUserExperienceCash(userId);  }}public class RegNotificationObserver {  private NotificationService notificationService;  @Subscribe  public void handleRegSuccess(long userId) {    notificationService.sendInboxMessage(userId, &quot;...&quot;);  }}</code></pre><ul><li>ä½¿ç”¨EventBusæ¡†æ¶å®ç°çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¤§æµç¨‹ä¸Šç›¸åŒï¼Œä½†æ˜¯åŒºåˆ«åœ¨äº<ul><li>ä¸ç”¨å®šä¹‰Observeræ¥å£äº†</li><li>ä»»æ„ç±»å‹çš„å¯¹è±¡éƒ½å¯ä»¥æ³¨å†Œåˆ°EventBuså½“ä¸­ï¼Œé€šè¿‡<code>@Subscribe</code>æ³¨è§£æ¥æ ‡æ˜ç±»å½“ä¸­å“ªä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶è¢«è§‚å¯Ÿè€…å‘é€çš„æ¶ˆæ¯</li></ul></li></ul><ul><li>EventBus, AsyncEventBus <ul><li>Guava EventBus çš„æ‰€æœ‰å¯è°ƒç”¨æ¥å£</li></ul></li></ul><pre><code>EventBus eventBus = new EventBus(); // åŒæ­¥é˜»å¡æ¨¡å¼EventBus eventBus = new AsyncEventBus(Executors.newFixedThreadPool(8))ï¼›// å¼‚æ­¥é˜»å¡æ¨¡å¼</code></pre><ul><li><p><code>register()</code>å‡½æ•°</p><ul><li>ç”¨æ¥æ³¨å†Œè§‚å¯Ÿè€…</li><li>å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„è§‚å¯Ÿè€…</li></ul></li><li><p><code>unregister()</code>å‡½æ•°</p><ul><li>åˆ é™¤æŸä¸ªè§‚å¯Ÿè€…</li></ul></li><li><p><code>post()</code>å‡½æ•°</p><ul><li>ç”¨äºç»™è§‚å¯Ÿè€…å‘é€æ¶ˆæ¯</li></ul></li><li><p><code>@Subscribe</code>æ³¨è§£</p><ul><li>é€šè¿‡æ³¨è§£è¯´æ˜æŸä¸ªå‡½æ•°èƒ½å¤Ÿæ¥æ”¶å“ªç§ç±»å‹çš„æ¶ˆæ¯</li></ul></li></ul><p>æœ€å…³é”®çš„ä¸€ä¸ªæ•°æ®ç»“æ„æ˜¯ Observer æ³¨å†Œè¡¨ï¼Œè®°å½•äº†æ¶ˆæ¯ç±»å‹å’Œå¯æ¥æ”¶æ¶ˆæ¯å‡½æ•°çš„å¯¹åº”å…³ç³»ã€‚å½“è°ƒç”¨ register() å‡½æ•°æ³¨å†Œè§‚å¯Ÿè€…çš„æ—¶å€™ï¼ŒEventBus é€šè¿‡è§£æ @Subscribe æ³¨è§£ï¼Œç”Ÿæˆ Observer æ³¨å†Œè¡¨ã€‚å½“è°ƒç”¨ post() å‡½æ•°å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼ŒEventBus é€šè¿‡æ³¨å†Œè¡¨æ‰¾åˆ°ç›¸åº”çš„å¯æ¥æ”¶æ¶ˆæ¯çš„å‡½æ•°ï¼Œç„¶åé€šè¿‡ Java çš„åå°„è¯­æ³•æ¥åŠ¨æ€åœ°åˆ›å»ºå¯¹è±¡ã€æ‰§è¡Œå‡½æ•°ã€‚å¯¹äºåŒæ­¥é˜»å¡æ¨¡å¼ï¼ŒEventBus åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ä¾æ¬¡æ‰§è¡Œç›¸åº”çš„å‡½æ•°ã€‚å¯¹äºå¼‚æ­¥éé˜»å¡æ¨¡å¼ï¼ŒEventBus é€šè¿‡ä¸€ä¸ªçº¿ç¨‹æ± æ¥æ‰§è¡Œç›¸åº”çš„å‡½æ•°ã€‚</p><h2 id="2-3-EventBusçš„å®ç°"><a href="#2-3-EventBusçš„å®ç°" class="headerlink" title="2.3 EventBusçš„å®ç°"></a>2.3 EventBusçš„å®ç°</h2><ol><li>Subscirbe æ³¨è§£</li></ol><p>ç”¨äºæ ‡æ˜è§‚å¯Ÿè€…ä¸­çš„å“ªä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶ä¿¡æ¯</p><pre><code>@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.METHOD)@Betapublic @interface Subscribe {}</code></pre><ol start="2"><li>ObserverAction</li></ol><p>ObserverActionç±»ç”¨æ¥è¡¨ç¤ºSubscribeæ³¨è§£çš„æ–¹æ³•ï¼Œå…¶ä¸­targetè¡¨ç¤ºè§‚å¯Ÿè€…ç±»ï¼Œmethodè¡¨ç¤ºæ–¹æ³•ï¼Œä¸»è¦ç”¨åœ¨ObserverRegistryè§‚å¯Ÿè€…æ³¨å†Œè¡¨å½“ä¸­ã€‚</p><pre><code>public class ObserverAction {  private Object target;  private Method method;  public ObserverAction(Object target, Method method) {    this.target = Preconditions.checkNotNull(target);    this.method = method;    this.method.setAccessible(true);  }  public void execute(Object event) { // eventæ˜¯methodæ–¹æ³•çš„å‚æ•°    try {      method.invoke(target, event);    } catch (InvocationTargetException | IllegalAccessException e) {      e.printStackTrace();    }  }}</code></pre><ol start="3"><li>ObserverRegistry</li></ol><p>Observeræ³¨å†Œè¡¨ç±»ï¼Œå¤§é‡ä½¿ç”¨Javaçš„åå°„è¯­æ³•</p><pre><code>public class ObserverRegistry {  private ConcurrentMap&lt;Class&lt;?&gt;, CopyOnWriteArraySet&lt;ObserverAction&gt;&gt; registry = new ConcurrentHashMap&lt;&gt;();  public void register(Object observer) {    Map&lt;Class&lt;?&gt;, Collection&lt;ObserverAction&gt;&gt; observerActions = findAllObserverActions(observer);    for (Map.Entry&lt;Class&lt;?&gt;, Collection&lt;ObserverAction&gt;&gt; entry : observerActions.entrySet()) {      Class&lt;?&gt; eventType = entry.getKey();      Collection&lt;ObserverAction&gt; eventActions = entry.getValue();      CopyOnWriteArraySet&lt;ObserverAction&gt; registeredEventActions = registry.get(eventType);      if (registeredEventActions == null) {        registry.putIfAbsent(eventType, new CopyOnWriteArraySet&lt;&gt;());        registeredEventActions = registry.get(eventType);      }      registeredEventActions.addAll(eventActions);    }  }  public List&lt;ObserverAction&gt; getMatchedObserverActions(Object event) {    List&lt;ObserverAction&gt; matchedObservers = new ArrayList&lt;&gt;();    Class&lt;?&gt; postedEventType = event.getClass();    for (Map.Entry&lt;Class&lt;?&gt;, CopyOnWriteArraySet&lt;ObserverAction&gt;&gt; entry : registry.entrySet()) {      Class&lt;?&gt; eventType = entry.getKey();      Collection&lt;ObserverAction&gt; eventActions = entry.getValue();      if (postedEventType.isAssignableFrom(eventType)) {        matchedObservers.addAll(eventActions);      }    }    return matchedObservers;  }  private Map&lt;Class&lt;?&gt;, Collection&lt;ObserverAction&gt;&gt; findAllObserverActions(Object observer) {    Map&lt;Class&lt;?&gt;, Collection&lt;ObserverAction&gt;&gt; observerActions = new HashMap&lt;&gt;();    Class&lt;?&gt; clazz = observer.getClass();    for (Method method : getAnnotatedMethods(clazz)) {      Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();      Class&lt;?&gt; eventType = parameterTypes[0];      if (!observerActions.containsKey(eventType)) {        observerActions.put(eventType, new ArrayList&lt;&gt;());      }      observerActions.get(eventType).add(new ObserverAction(observer, method));    }    return observerActions;  }  private List&lt;Method&gt; getAnnotatedMethods(Class&lt;?&gt; clazz) {    List&lt;Method&gt; annotatedMethods = new ArrayList&lt;&gt;();    for (Method method : clazz.getDeclaredMethods()) {      if (method.isAnnotationPresent(Subscribe.class)) {        Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();        Preconditions.checkArgument(parameterTypes.length == 1,                &quot;Method %s has @Subscribe annotation but has %s parameters.&quot;                        + &quot;Subscriber methods must have exactly 1 parameter.&quot;,                method, parameterTypes.length);        annotatedMethods.add(method);      }    }    return annotatedMethods;  }}</code></pre><ol start="4"><li>EventBus</li></ol><pre><code>public class EventBus {  private Executor executor;  private ObserverRegistry registry = new ObserverRegistry();  public EventBus() {    this(MoreExecutors.directExecutor());  }  protected EventBus(Executor executor) {    this.executor = executor;  }  public void register(Object object) {    registry.register(object);  }  public void post(Object event) {    List&lt;ObserverAction&gt; observerActions = registry.getMatchedObserverActions(event);    for (ObserverAction observerAction : observerActions) {      executor.execute(new Runnable() {        @Override        public void run() {          observerAction.execute(event);        }      });    }  }}</code></pre><ol start="5"><li>AsyncEventBus</li></ol><pre><code>public class AsyncEventBus extends EventBus {  public AsyncEventBus(Executor executor) {    super(executor);  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è§‚å¯Ÿè€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®è§‚ç»æµå­¦ è¯¾ç¨‹å­¦ä¹ </title>
      <link href="/%E5%BE%AE%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6-%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0/"/>
      <url>/%E5%BE%AE%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6-%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¯¼è®º"><a href="#1-å¯¼è®º" class="headerlink" title="1. å¯¼è®º"></a>1. å¯¼è®º</h1><h2 id="1-1-ç»æµå­¦å‘å±•å²"><a href="#1-1-ç»æµå­¦å‘å±•å²" class="headerlink" title="1.1 ç»æµå­¦å‘å±•å²"></a>1.1 ç»æµå­¦å‘å±•å²</h2><ul><li><p>å›½å¯Œè®º</p><ul><li>å·¥ä¸šé©å‘½å¼€å§‹</li><li>å¸‚åœºçš„è¿ä½œæ–¹å¼</li><li>è‡ªç”±å¸‚åœºç»æµæ˜¯è‡ªæˆ‘å¹³è¡¡çš„ï¼Œäººäººçš†ä¼šå—ç›Š</li></ul></li><li><p>å¾®è§‚ç»æµå­¦</p><ul><li>å•ä¸ªç”Ÿäº§è€…ï¼Œç®¡ç†è€…çš„ç ”ç©¶</li></ul></li><li><p>èµ„æœ¬è®º</p><ul><li>æœ‰è¾©è¯æ–¹æ³• æ‰¹åˆ¤ å¾—å‡ºç»“è®º</li><li>èµ„æœ¬ä¸»ä¹‰åˆ¶åº¦æ˜¯æš‚æ—¶çš„ï¼Œæ½œåœ¨çš„æœ¬è´¨æ€§çš„çŸ›ç›¾</li></ul></li><li><p>å°±ä¸šã€åˆ©æ¯å’Œè´§å¸é€šè®º</p></li></ul><ul><li>ç»æµå­¦åˆ†ç±»<ul><li>å¾®è§‚ç»æµå­¦<ul><li>å¯¹äºå¤§çš„ç»æµä½“ç³»çš„æŸä¸ªç»æµå•ä½</li></ul></li><li>å®è§‚ç»æµå­¦<ul><li>æ•´ä¸ªç»æµç³»ç»Ÿçš„æ€»ä½“åˆ†æ</li></ul></li></ul></li></ul><h2 id="1-2-ç»æµå­¦ç ”ç©¶ä»€ä¹ˆ"><a href="#1-2-ç»æµå­¦ç ”ç©¶ä»€ä¹ˆ" class="headerlink" title="1.2 ç»æµå­¦ç ”ç©¶ä»€ä¹ˆ"></a>1.2 ç»æµå­¦ç ”ç©¶ä»€ä¹ˆ</h2><p>æ ¹æºæ˜¯ç¨€ç¼ºæ€§ï¼Œå› ä¸ºç¨€ç¼ºï¼Œæ‰€ä»¥è¦é€‰æ‹©ï¼Œæœºä¼šæˆæœ¬æ˜¯æˆ‘ä»¬åšå‡ºé€‰æ‹©çš„æ–¹æ³•è®ºã€‚</p><ul><li>ç»æµå­¦ â€“ ç¨€ç¼ºèµ„æºé…ç½®çš„å­¦ç§‘<ul><li>ç¨€ç¼º<ul><li>ç”Ÿäº§çš„äº§å“èµ„æºæ— æ³•æ»¡è¶³äººä»¬çš„éœ€è¦çš„æƒ…å†µ </li><li>ç¨€ç¼ºæ˜¯ç»æµå­¦æœ€é‡è¦çš„å‡å®š</li><li>ç¨€ç¼ºæ˜¯æ™®éå­˜åœ¨çš„</li><li>é€‰æ‹©Aè¿˜æ˜¯é€‰æ‹©B</li></ul></li><li>é€‰æ‹©</li><li>æœºä¼šæˆæœ¬<ul><li>å› ä¸ºç¨€ç¼ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ˜¯çš„æœ‰é™çš„ç‰©å“ï¼ŒåŠ³åŠ¡åœ¨æœ‰é™çš„æ—¶é—´å†…æ»¡è¶³äººä»¬æœ€æ€¥éœ€çš„æ¬²æœ›</li><li>å› æ­¤äººä»¬éœ€è¦å»é€‰æ‹©</li><li>é€‰æ‹©A B é€‰æ‹©Açš„æœºä¼šæˆæœ¬æ˜¯Bçš„æ”¶ç›Š</li></ul></li></ul></li></ul><h2 id="1-3-åå¤§ç»æµå­¦åŸç†"><a href="#1-3-åå¤§ç»æµå­¦åŸç†" class="headerlink" title="1.3 åå¤§ç»æµå­¦åŸç†"></a>1.3 åå¤§ç»æµå­¦åŸç†</h2><p>çœ‹æ•´ä¸ªçš„å­¦ä¹ æ¡†æ¶</p><h3 id="1-3-1-å…³äºä¸ªäººçš„"><a href="#1-3-1-å…³äºä¸ªäººçš„" class="headerlink" title="1.3.1 å…³äºä¸ªäººçš„"></a>1.3.1 å…³äºä¸ªäººçš„</h3><ul><li>åŸºæœ¬æ€æƒ³ï¼šäººä¼šé€šè¿‡æƒè¡¡å–èˆæ¥å¯¹æ¿€åŠ±åšå‡ºååº”</li><li>åŸºæœ¬æ¦‚å¿µï¼š <ul><li>æ”¶ç›Š</li><li>(æœºä¼š)æˆæœ¬</li><li>æ¿€åŠ±</li></ul></li><li>åˆ†ææ–¹æ³•<ul><li>è¾¹é™…åˆ†æ</li></ul></li></ul><ol><li>People face tradeoffs. </li></ol><p>é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—</p><ul><li>å›½é˜² vs æ¶ˆè´¹</li><li>é£Ÿå“ vs è¡£æœ</li><li>å·¥ä½œ vs ä¼‘æ¯</li><li>æ•ˆç‡ vs å…¬å¹³</li></ul><ol start="2"><li>The cost of something is what you give up to get it </li></ol><ul><li>æœºä¼šæˆæœ¬<ul><li>ä¸ºäº†å¾—åˆ°æŸç§ä¸œè¥¿æ‰€å¿…é¡»æ”¾å¼ƒçš„ä¸œè¥¿</li></ul></li></ul><ol start="3"><li>Rational people think at the margin </li></ol><ul><li>ç†æ€§äºº<ul><li>ç†æ€§äºº ä¼šä½¿ç”¨æ‰€æœ‰å¯è·å¾—çš„ä¿¡æ¯æ¥è¿›è¡Œåˆ¤æ–­ </li><li>å¯¹æŸä¸ªå†³ç­–çš„æ”¶ç›Šå’Œæˆæœ¬è¿›è¡Œæ¯”è¾ƒ</li></ul></li><li>è¾¹é™…<ul><li>å¾®åˆ†çš„ç†å¿µ</li><li>å¯¹å½“å‰è¡ŒåŠ¨è¿›è¡Œçš„å¾®å°çš„è°ƒæ•´</li><li>è¾¹é™…æˆæœ¬â€“å¢é‡æˆæœ¬ï¼ŒæŒ‡çš„æ˜¯æ¯å¢äº§ä»¥å•ä½çš„äº§å“æ‰€é€ æˆçš„æ€»æˆæœ¬çš„å¢é‡</li><li>è¾¹é™…æˆæœ¬å’Œå•ä½å¹³å‡æˆæœ¬ä¸åŒï¼Œå•ä½å¹³å‡æˆæœ¬è€ƒè™‘äº†å…¨éƒ¨çš„äº§å“ï¼Œè€Œè¾¹é™…æˆæœ¬å¿½ç•¥äº†æœ€åä¸€ä¸ªäº§å“ä¹‹å‰çš„ã€‚ä¾‹å¦‚æ¯è¾†æ±½è½¦çš„å¹³å‡æˆæœ¬åŒ…æ‹¬ç”Ÿäº§ç¬¬ä¸€è¾†è½¦çš„å¾ˆå¤§çš„å›ºå®šæˆæœ¬ï¼Œè€Œè¾¹é™…æˆæœ¬æ ¹æœ¬ä¸è€ƒè™‘å›ºå®šæˆæœ¬<ul><li>å› ä¸ºå›ºå®šæˆæœ¬å‡ ä¹æ²‰æ²¡äº†ï¼Œç†è®ºä¸Šè¾¹é™…æˆæœ¬æ˜¯å¯ä»¥è®©ä¼ä¸šæ— æŸå¤±çš„ç»§ç»­è¿è½¬ä¸‹å»çš„ </li></ul></li><li>ä¸€ä¸ªå†³ç­–çš„é¢å¤–æˆ–è€…è¿½åŠ çš„æˆæœ¬</li><li>E.G<ul><li>ä¸Šä¸¤èŠ‚è¯¾ï¼Œå¾ˆç´¯ï¼Œæ˜¯å¦è¦ä¸Šç¬¬ä¸‰èŠ‚è¯¾</li><li>ç¬¬ä¸‰èŠ‚è¯¾çš„æ”¶ç›Š  è¾¹é™…æ”¶ç›Š</li><li>æˆæœ¬ ä¼‘æ¯ä¸€ä¸‹ è¿™ä¸ªå¸¦æ¥çš„æ”¶ç›Šå°±æ˜¯ä½ ç¬¬ä¸‰èŠ‚è¯¾ç¿˜è¯¾çš„è¾¹é™…æˆæœ¬äº†</li></ul></li></ul></li></ul><ol start="4"><li>People respond to incentives äººä»¬å¯¹æ¿€åŠ±åšå‡ºååº”</li></ol><ul><li><p>äººä»¬ä¼šå¯¹æ¿€åŠ±äº§ç”Ÿååº”</p></li><li><p>å¯¹äºä»·æ ¼çš„ååº”</p></li><li><p>å¯¹äºç«äº‰çš„ååº”</p></li><li><p>å¯¹äº§æƒ å¥‘çº¦åˆ¶åº¦åšå‡ºçš„ååº”</p></li><li><p><strong>æœ€å¤§å€¼ è¾¹é™…æ”¶ç›Š == è¾¹é™…æˆæœ¬</strong></p></li></ul><h3 id="1-3-2-å…³äºäººå’Œäººä¹‹é—´çš„"><a href="#1-3-2-å…³äºäººå’Œäººä¹‹é—´çš„" class="headerlink" title="1.3.2 å…³äºäººå’Œäººä¹‹é—´çš„"></a>1.3.2 å…³äºäººå’Œäººä¹‹é—´çš„</h3><ol start="5"><li>Trade can make everyone better off </li></ol><ul><li>ç«äº‰ ä¿ƒè¿›äº†äº¤æ˜“çš„ç›ˆåˆ©</li><li>è´¸æ˜“é€ æˆçš„åˆ†å·¥</li></ul><ol start="6"><li>Markets are usually a good way to organize economic activity </li></ol><ul><li>å¸‚åœºç»æµ<ul><li>èµ„æºé…ç½®çš„åŠæ³•</li><li>é€šè¿‡å–å®¶ä¹°å®¶å•ç‹¬åˆ†åˆ«çš„å†³ç­–æ¥åšå‡ºæœ€å¥½çš„é€‰æ‹©</li><li>å…¬å¸  ä»¥åŠ å®¶åº­ä¼šåˆ†åˆ«å†³å®šæ€ä¹ˆç”Ÿäº§ï¼Œç”Ÿäº§å¤šå°‘</li></ul></li></ul><p>As if guided by an invisible hand. </p><p>é€šè¿‡ä»·æ ¼æ¥å†³å®šè‡ªå·±çš„ä¹°å–è¡Œä¸º</p><ul><li>å¸‚åœºæ˜¯å¦çœŸçš„æœ‰æ•ˆï¼Ÿ<ul><li>æ³•æ²»ä½“ç³»ä¸èƒ½ç”±å•†äºº åˆ©ç›Šé›†å›¢æ¥å·¦å³  äºšå½“æ–¯å¯†</li><li>é©¬å…‹æ€ è‡ªç”±æ”¾ä»»çš„å¸‚åœºä¼šçˆ†å‘å‘¨æœŸæ€§ç»æµå±æœº  å› ä¸ºäººéç†æ€§</li><li>å‡¯æ©æ–¯ éç†æ€§  åŠ¨ç‰©ç²¾ç¥  å¸‚åœºæ³¢åŠ¨ä¸å®è§‚æ³¢åŠ¨</li></ul></li></ul><ol start="7"><li>Governments can sometimes improve market outcomes </li></ol><ul><li>å› ä¸ºå¸‚åœºæœ¬èº«å¼Šç—…ï¼Œå³éç†æ€§äººçš„éç†æ€§å†³ç­–</li><li>å¸‚åœºæœ‰å¯èƒ½åœ¨ä¸€äº›æ—¶å€™æ— æ³•è‡ªèº«å»æœ‰æ•ˆçš„é…ç½®èµ„æºï¼Œé‚£å°±éœ€è¦æ”¿åºœçš„å¸®åŠ©äº†</li><li>è­¬å¦‚æ•ˆç‡å’Œå…¬å¹³çš„é—®é¢˜</li><li>å¸‚åœºå¤±çµï¼Œæ— æ³•è°ƒæ§çš„ç°è±¡<ul><li>æ”¶å…¥ä¸è´¢å¯Œåˆ†é…ä¸å…¬</li><li>å¤–éƒ¨è´Ÿæ•ˆåº”é—®é¢˜<ul><li>æ±¡æŸ“</li></ul></li><li>ç«äº‰å¤±è´¥å’Œå¸‚åœºå„æ–­çš„å½¢æˆ</li><li>å¤±ä¸šé—®é¢˜</li><li>åŒºåŸŸç»æµçš„ä¸åè°ƒé—®é¢˜</li><li>å…¬å…±äº§å“ä¾›ç»™ä¸è¶³</li><li>å…¬å…±èµ„æºçš„è¿‡åº¦ä½¿ç”¨</li></ul></li></ul><h3 id="1-3-3-æ ¹æ®å®è§‚ç»æµç°è±¡æå‡ºçš„åŸç†"><a href="#1-3-3-æ ¹æ®å®è§‚ç»æµç°è±¡æå‡ºçš„åŸç†" class="headerlink" title="1.3.3 æ ¹æ®å®è§‚ç»æµç°è±¡æå‡ºçš„åŸç†"></a>1.3.3 æ ¹æ®å®è§‚ç»æµç°è±¡æå‡ºçš„åŸç†</h3><ol start="8"><li>ä¸€å›½çš„ç”Ÿæ´»æ°´å¹³å–å†³äºå®ƒç”Ÿäº§ç‰©å“ä¸åŠ³åŠ¡çš„èƒ½åŠ›</li><li>å½“æ”¿åºœå‘è¡Œäº†è¿‡å¤šè´§å¸çš„æ—¶å€™ï¼Œç‰©ä»·ä¸Šå‡</li><li>ç¤¾ä¼šé¢ä¸´é€šè´§è†¨èƒ€ä¸å¤±ä¸šä¹‹é—´çš„çŸ­æœŸæƒè¡¡å–èˆ</li></ol><h1 id="2-åƒç»æµå­¦å®¶ä¸€æ ·æ€è€ƒ"><a href="#2-åƒç»æµå­¦å®¶ä¸€æ ·æ€è€ƒ" class="headerlink" title="2.  åƒç»æµå­¦å®¶ä¸€æ ·æ€è€ƒ"></a>2.  åƒç»æµå­¦å®¶ä¸€æ ·æ€è€ƒ</h1><h2 id="2-1-ç»æµå­¦çš„ç¤¾ä¼šç§‘å­¦å±æ€§"><a href="#2-1-ç»æµå­¦çš„ç¤¾ä¼šç§‘å­¦å±æ€§" class="headerlink" title="2.1 ç»æµå­¦çš„ç¤¾ä¼šç§‘å­¦å±æ€§"></a>2.1 ç»æµå­¦çš„ç¤¾ä¼šç§‘å­¦å±æ€§</h2><ul><li>ç»æµå­¦å®¶<ul><li>ä¸€æ–¹é¢ï¼Œå¦ä¸€æ–¹é¢ï¼Œlol  </li><li>è€ƒè™‘é—®é¢˜å¸¸å¸¸ä¸¤ä¸ªæ–¹é¢<ul><li>ä½œä¸ºç§‘å­¦å®¶<ul><li>ç»æµåˆ†æ</li></ul></li><li>ä½œä¸ºæ”¿ç­–é¡¾é—®<ul><li>æ—¶æ”¿åˆ†æ</li></ul></li></ul></li></ul></li></ul><ul><li><p>ä»€ä¹ˆæ˜¯ç§‘å­¦ï¼Ÿ</p><ul><li><p>é€šå¸¸å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¦‚å¿µçš„æ—¶å€™ï¼Œéœ€è¦ä¸€ä¸ªå¤–å»¶æ›´å®½æ³›çš„æ¦‚å¿µ</p></li><li><p>ç”¨ç§‘å­¦å®šä¹‰ç»æµå­¦</p></li><li><p>ç”¨è®¤è¯†å®šä¹‰ç§‘å­¦</p><ul><li>è®¤è¯†ï¼š äººä»¬é€šè¿‡å®è·µå’Œæ€ç»´ï¼Œå¯¹å•ä¸ªäº‹ç‰©çš„å±æ€§å’Œäº‹ç‰©ä¹‹é—´è”ç³»çš„ç†è§£å’Œåˆ¤æ–­</li></ul></li><li><p>ç§‘å­¦çš„æœ¬è´¨</p><ul><li>ç”¨å®è¯çš„æ–¹æ³•ï¼Œå®è¯æ€§</li><li>è§£é‡Šå¯¹è±¡æ˜¯æ€ä¹ˆæ ·çš„é—®é¢˜ï¼Œä»¥åŠåº”è¯¥æ€ä¹ˆæ ·çš„è§„èŒƒæ€§é—®é¢˜</li></ul></li><li><p>ç§‘å­¦çš„æ€§è´¨</p><ul><li>å¯è¯ä¼ªæ€§</li><li>å‡è®¾ä¸ç®€åŒ–</li><li>å†…éƒ¨ä¸€è‡´æ€§<ul><li>ç»Ÿä¸€çš„å‡è®¾ç³»ç»Ÿï¼Œèƒ½å¤Ÿè§£é‡Šå¤šç§ç°è±¡</li></ul></li><li>ç»éªŒä¸€è‡´æ€§<ul><li>è§‚å¯Ÿäº‹å®ç­‰ç»éªŒè¯æ®ä¸ç†è®ºç›¸å¯¹ç…§</li><li>é€šè¿‡å¯æ§åˆ¶çš„è¯•éªŒæ¥è¿›è¡Œæ£€éªŒ<ul><li>ç»æµå­¦</li><li>ç¬¦åˆç§‘å­¦çš„å¯è¯ä¼ªåŸåˆ™</li><li>é‡‡ç”¨å‡è®¾æ‰‹æ®µæ„é€ ç†è®ºï¼Œå¹¶ä½¿ç”¨ç®€åŒ–çš„æ¨¡å‹è¡¨è¾¾ç†è®º</li><li>åšæŒå†…éƒ¨é€»è¾‘çš„ä¸€è‡´æ€§</li><li>ä¸æ–­å°†å¢çº¶å‡è®¾å’Œç»éªŒäº‹å®ç›¸å¯¹ç…§ï¼Œæ¥æ£€éªŒç†è®ºçš„çœŸä¼ª </li><li>ä¸»é¢˜</li><li>äººä»¬çš„é€‰æ‹©å¦‚ä½•å¼•å¯¼ä»–ä»¬çš„ç”Ÿæ´»ï¼Œä»¥åŠä»–ä»¬æ˜¯å¦‚ä½•ç›¸äº’å½±å“çš„</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id="2-2-ç»æµå­¦çš„ç ”ç©¶æ­¥éª¤"><a href="#2-2-ç»æµå­¦çš„ç ”ç©¶æ­¥éª¤" class="headerlink" title="2.2 ç»æµå­¦çš„ç ”ç©¶æ­¥éª¤"></a>2.2 ç»æµå­¦çš„ç ”ç©¶æ­¥éª¤</h2><ol><li>ç¡®å®šç ”ç©¶é—®é¢˜</li><li>å½¢æˆå‡è®¾</li><li>å»ºç«‹æ¨¡å‹</li><li>ç»éªŒæ£€éªŒï¼Œä¹Ÿæµ‹è´§è§£é‡Šç°å®</li><li>é€šè¿‡æ£€éªŒç»“æœå†³å®šæ”¾å¼ƒï¼Œä¿®æ”¹æ¨¡å‹</li></ol><ul><li>ç ”ç©¶æ–¹æ³•<ul><li>æè¿°æ€§çš„æ–¹æ³•</li><li>åˆ†ææ€§çš„åŠæ³• â€“ æŠ½è±¡æ¨ç†</li></ul></li></ul><p>ä¸‹é¢æè¿°ä¸€äº›ç»å¸¸ä½¿ç”¨çš„ç»æµæ¨¡å‹ï¼š</p><h3 id="2-2-1-å¾ªç¯æµé‡å›¾"><a href="#2-2-1-å¾ªç¯æµé‡å›¾" class="headerlink" title="2.2.1 å¾ªç¯æµé‡å›¾"></a>2.2.1 å¾ªç¯æµé‡å›¾</h3><ul><li><p>è¯´æ˜è´§å¸å¦‚ä½•é€šè¿‡å¸‚åœºåœ¨å®¶åº­å’Œä¼ä¸šä¹‹é—´æµåŠ¨</p></li><li><p>ä¸»ä½“</p><ul><li>å®¶åº­<ul><li>æ‹¥æœ‰å¹¶å‡ºå”®æˆ–å‡ºç§Ÿç”Ÿäº§è¦ç´ ç»™ä¼ä¸šæ¥è·å¾—æ”¶å…¥</li><li>è´­ä¹°å¹¶æ¶ˆè´¹ç‰©å“ä¸åŠ³åŠ¡</li></ul></li><li>ä¼ä¸š<ul><li>è´­ä¹°æˆ–é›‡ä½£ç”Ÿäº§è¦ç´ å¹¶ç”¨ä»¥ç”Ÿäº§ç‰©å“ä¸åŠ³åŠ¡</li><li>å‡ºå”®ç‰©å“ä¸åŠ³åŠ¡</li></ul></li></ul></li><li><p>ä¸¤ä¸ªå¸‚åœº</p><ul><li>ç‰©å“ä¸åŠ³åŠ¡å¸‚åœº</li><li>ç”Ÿäº§è¦ç´ å¸‚åœº<ul><li>ç”Ÿäº§è¦ç´ æŒ‡ç»æµä½“ç”¨æ¥ç”Ÿäº§ç‰©å“ä¸åŠ³åŠ¡çš„èµ„æº<ul><li>åŠ³åŠ¨</li><li>åœŸåœ°</li><li>èµ„æœ¬<ul><li>å»ºç­‘ç‰©</li><li>ç”¨æ¥ç”Ÿäº§çš„æœºå™¨<h3 id="2-2-2-ç”Ÿäº§å¯èƒ½æ€§è¾¹ç•Œ"><a href="#2-2-2-ç”Ÿäº§å¯èƒ½æ€§è¾¹ç•Œ" class="headerlink" title="2.2.2 ç”Ÿäº§å¯èƒ½æ€§è¾¹ç•Œ"></a>2.2.2 ç”Ÿäº§å¯èƒ½æ€§è¾¹ç•Œ</h3></li></ul></li></ul></li></ul></li></ul></li><li><p>è¡¨æ˜çš„æ˜¯åœ¨ç”Ÿäº§è¦ç´ å’Œç”Ÿäº§æŠ€æœ¯æ—¢å®šçš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç»æµæ‰€èƒ½ç”Ÿäº§çš„äº§å“çš„å„ç§æ•°é‡çš„ç»„åˆ</p><ul><li>ä¸€æ¡å‡¹ä¸‹å»çš„æ›²çº¿</li><li>åœ¨å†…éƒ¨ï¼Œå¤±ä¸šï¼Œçªå·¥</li><li>å¤–éƒ¨ï¼Œæ— æ³•å®ç°</li><li>ç”Ÿäº§åŠ›æå‡ï¼Œè¾¹ç•Œï¼Œyï¼Œxè½´ç‚¹çš„æå‡</li></ul></li><li><p>ä¸ºä»€ä¹ˆä¸æ˜¯ç›´çº¿å‘¢ï¼Ÿ </p><ul><li>è¾¹é™…è½¬åŒ–ç‡<ul><li>ä¸€ä¸ªäº§å“çš„å¢åŠ å¯¼è‡´å¦å¤–ä¸€ä¸ªäº§å“çš„å‡å°‘</li><li>è½¬åŒ–ç‡ä¼šæœ‰å¾ˆå¤§çš„å˜åŒ–<ul><li>æ¯”å¦‚è¾¹é™…çŠ¶æ€ï¼Œä¸€ä¸ªäº§å“åˆ¶é€ çš„è½¬ç§»ï¼Œä¼šä½¿å¾—åšè¿™ä¸ªäº§å“æœ€ç†Ÿç»ƒçš„å·¥äººè½¬ç§»ï¼Œç”Ÿäº§åŠ›å¤§å¤§å‡å°ï¼Œè€Œå¯¹äºå¦å¤–ä¸€ä¸ªäº§å“çš„ç”Ÿäº§åŠ›çš„æå‡å¹¶ä¸ä¼šæœ‰åŒç­‰ç¨‹åº¦çš„å¢åŠ </li></ul></li></ul></li></ul></li></ul><h2 id="2-3-ä½œä¸ºæ”¿ç­–é¡¾é—®çš„ç»æµå­¦å®¶"><a href="#2-3-ä½œä¸ºæ”¿ç­–é¡¾é—®çš„ç»æµå­¦å®¶" class="headerlink" title="2.3 ä½œä¸ºæ”¿ç­–é¡¾é—®çš„ç»æµå­¦å®¶"></a>2.3 ä½œä¸ºæ”¿ç­–é¡¾é—®çš„ç»æµå­¦å®¶</h2><ul><li>ä½œä¸ºæ”¿ç­–é¡¾é—®ï¼Œè¯•å›¾åšå‡ºå…³äºä¸–ç•Œåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„è§„èŒƒè¡¨è¿°<ul><li>ä¸æ˜¯å·²ç»å‘ç”Ÿçš„ï¼Œæˆ–è€…æ˜¯èƒ½å¤Ÿè§„èŒƒåˆ°</li><li>æ˜¯ä¸èƒ½è¯ä¼ªçš„</li></ul></li></ul><h1 id="3-ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“çš„å¥½å¤„"><a href="#3-ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“çš„å¥½å¤„" class="headerlink" title="3. ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“çš„å¥½å¤„"></a>3. ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“çš„å¥½å¤„</h1><h2 id="3-1-ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“å¥½å¤„"><a href="#3-1-ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“å¥½å¤„" class="headerlink" title="3.1 ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“å¥½å¤„"></a>3.1 ç›¸äº’ä¾å­˜æ€§ä¸è´¸æ˜“å¥½å¤„</h2><ul><li><p>æˆ‘ä»¬æ­£åœ¨äº«ç”¨ä¸–ç•Œä¸Šçš„äººç»™æˆ‘ä»¬æä¾›çš„æœåŠ¡</p><ul><li>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç›¸äº’ä¾èµ–ï¼Ÿ <ul><li>è´¸æ˜“ä½¿å¾—æ¯ä¸ªäººçš„çŠ¶å†µä¼šæ›´å¥½ã€‚</li><li>ä¸ºä»€ä¹ˆå›½å®¶ä¹‹é—´ä¼šç›¸äº’ä¾å­˜ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆè¿˜ä¼šå­˜åœ¨è´¸æ˜“ä¿æŠ¤å‘¢ï¼Ÿ </li></ul></li></ul></li><li><p>è´¸æ˜“çš„å¿…è¦æ€§</p><ul><li><p>è´¸æ˜“æœ‰å¯èƒ½ä½¿å¾—ç”Ÿäº§å¯èƒ½æ€§æ›²çº¿æ›´å‡¹ </p><ul><li>å¯¹åŒæ–¹éƒ½ä¼šæœ‰åˆ©</li></ul></li><li><p>ç»å¯¹ä¼˜åŠ¿</p><ul><li>ç”¨æ¯”å¦ä¸€ä¸ªç”Ÿäº§è€…æ›´å°‘çš„æŠ•å…¥æ¥ç”Ÿäº§æŸç§ç‰©å“çš„èƒ½åŠ›</li></ul></li><li><p>æ¯”è¾ƒä¼˜åŠ¿åŸç†</p><ul><li>ç”¨æ¯”å¦ä¸€ä¸ªç”Ÿäº§è€…æ›´å°‘çš„æœºä¼šæˆæœ¬æ¥ç”Ÿäº§æŸç§ç‰©å“çš„èƒ½åŠ›</li></ul></li><li><p>è´¸æ˜“è·å¾—çš„åˆ©ç›Šæ¥æºäºæ¯”è¾ƒä¼˜åŠ¿ã€‚å½“æ¯ä¸ªå›½å®¶ä¸“é—¨ç”Ÿäº§å®ƒå…·æœ‰æ¯”è¾ƒä¼˜åŠ¿çš„ç‰©å“çš„æ—¶å€™ï¼Œæ‰€æœ‰å›½å®¶çš„æ€»äº§é‡ä¼šæ›´é«˜ï¼Œä¸–ç•Œçš„ç»æµè›‹ç³•ä¹Ÿä¼šæ›´å¤§ã€‚</p></li></ul></li></ul><h2 id="3-2-å®é™…åº”ç”¨"><a href="#3-2-å®é™…åº”ç”¨" class="headerlink" title="3.2 å®é™…åº”ç”¨"></a>3.2 å®é™…åº”ç”¨</h2><ul><li><p>å°å›½æ›´å®¹æ˜“åœ¨è´¸æ˜“å½“ä¸­è·åˆ© </p><ul><li>äºšæ´²å››å°é¾™  â€“ å‡ºå£å¯¼å‘<ul><li>ç»æµè…¾é£</li><li>åŠ³åŠ¨å¯†é›†å‹</li><li>è´¸æ˜“è·åˆ©ï¼Œç»æµåŒè´¨æ€§å¼º</li></ul></li></ul></li><li><p>ä¸­ç¾è´¸æ˜“</p><ul><li>äº§å“æ‘©æ“¦å˜å¤§</li><li>ä¸­å›½å¯¹ç¾å›½è¿›å‡ºå£ä¾èµ–åº¦é™ä½ï¼Œç„¶è€Œç¾å›½å¯¹ä¸­å›½çš„æ˜¯å‘ˆä¸Šå‡è¶‹åŠ¿çš„</li></ul></li><li><p>æˆ‘å›½å¼ºè°ƒäº§ä¸šå‡çº§ï¼Œå¼€å§‹å‡ºç°é‡å äº†</p></li></ul><h1 id="4-ä¾›ç»™ä¸éœ€æ±‚çš„å¸‚åœºåŠ›é‡"><a href="#4-ä¾›ç»™ä¸éœ€æ±‚çš„å¸‚åœºåŠ›é‡" class="headerlink" title="4. ä¾›ç»™ä¸éœ€æ±‚çš„å¸‚åœºåŠ›é‡"></a>4. ä¾›ç»™ä¸éœ€æ±‚çš„å¸‚åœºåŠ›é‡</h1><ul><li><p>ä¾›ç»™ä¸ä¾›ç»™é‡</p></li><li><p>éœ€æ±‚ä¸éœ€æ±‚é‡</p></li><li><p>ä¾›éœ€æ›²çº¿çš„ç ”ç©¶ï¼Œå¯¹å®é™…åœºæ™¯çš„åˆ†æ</p><h2 id="4-1-ç‰©å“éœ€æ±‚"><a href="#4-1-ç‰©å“éœ€æ±‚" class="headerlink" title="4.1 ç‰©å“éœ€æ±‚"></a>4.1 ç‰©å“éœ€æ±‚</h2></li><li><p>å¸‚åœº</p><ul><li>ä¹°æ–¹å–æ–¹åœ¨ä¸€èµ·</li></ul></li><li><p>å¸‚åœºåŠ¿åŠ›</p><ul><li>å–æ–¹ä¹°æ–¹ä¸é€‚å½“çš„å½±å“å•†å“ä»·æ ¼çš„èƒ½åŠ›</li></ul></li><li><p>å®Œå…¨ç«äº‰å¸‚åœº</p><ul><li>å¯ä¾›é”€å”®ç‰©å“å®Œå…¨ç›¸åŒ</li><li>ä¹°æ–¹å–æ–¹äººæ•°ä¼—å¤šï¼Œä»¥è‡³äºæ²¡æœ‰ä»»ä½•ä¸€ä¸ªä¹°æ–¹æˆ–å–æ–¹å¯ä»¥å½±å“å¸‚åœºä»·æ ¼ï¼Œæ¯ä¸ªäººéƒ½æ˜¯ä»·æ ¼æ¥å—è€…(price taker)</li><li>æ¯”å¦‚å†œè´¸å¸‚åœºï¼Œåœ°æ‘Š</li></ul></li><li><p>å„æ–­</p><ul><li>ç”µç½‘</li><li>é“è·¯</li><li>çƒŸè‰</li></ul></li><li><p>å¯¡å¤´å¸‚åœº</p><ul><li>æ±½è½¦</li><li>é’¢é“</li><li>é€ èˆ¹</li><li>çŸ³æ²¹åŒ–å·¥</li><li>æœ‰è‰²å†¶é‡‘</li><li>é£æœºåˆ¶é€ </li><li>èˆªç©ºè¿è¾“</li></ul></li><li><p>å„æ–­ç«äº‰</p><ul><li>æ´—å‘æ°´</li><li>æœè£…</li><li>è¯å“</li></ul></li><li><p>éœ€æ±‚</p><ul><li>ç‰©å“éœ€æ±‚é‡</li><li>ä¹°è€…æ„¿æ„å¹¶ä¸”èƒ½å¤Ÿè´­ä¹°çš„ä¸€ç§ç‰©å“çš„æ•°é‡</li></ul></li><li><p>éœ€æ±‚å®šç†</p><ul><li>è®¤ä¸ºåœ¨å…¶ä»–æ¡ä»¶ä¸å˜çš„æ—¶å€™ï¼Œä¸€ç§ç‰©å“çš„ä»·æ ¼ä¸Šå‡ï¼Œå¯¹è¯¥ç‰©å“çš„éœ€æ±‚é‡ä¼šå‡å°‘</li></ul></li><li><p>éœ€æ±‚æ›²çº¿</p><ul><li><p>è¡¨ç¤ºåœ¨å…¶ä»–æ¡ä»¶ä¸å˜çš„æƒ…å†µä¸‹ï¼Œä»·æ ¼å’Œéœ€æ±‚é‡ä¹‹é—´çš„å…³ç³»çš„å›¾å½¢</p></li><li><p>çºµè½´ä¸ºä»·æ ¼ï¼Œæ¨ªè½´ä¸ºéœ€æ±‚é‡ï¼Œæ–œç‡ä¸ºè´Ÿï¼Œå› ä¸ºäºŒè€…çš„å¢é•¿æ€åŠ¿æ˜¯ç›¸åçš„</p></li><li><p>ä»·æ ¼ä¸ºè‡ªå˜é‡ï¼Œéœ€æ±‚ä¸ºå› å˜é‡</p></li><li><p>å¸¸è§çš„å…¶ä»–æ¡ä»¶ â€“ å½±å“éœ€æ±‚æ›²çº¿å˜åŠ¨çš„å› ç´ </p><ul><li><p>ä¹°è€…æ•°é‡</p><ul><li>ä¹°è€…æ•°é‡çš„å¢åŠ ä¼šå¢åŠ æ¯ä¸€ç§ä»·æ ¼æ°´å¹³ä¸‹çš„éœ€æ±‚é‡ï¼Œä»è€Œä½¿éœ€æ±‚æ›²çº¿å‘å³ç§»åŠ¨</li></ul></li><li><p>æ”¶å…¥</p><ul><li>æ­£å¸¸å•†å“<ul><li>æ”¶å…¥ä¸Šå‡ï¼Œéœ€æ±‚ä¸Šå‡</li></ul></li><li>ä½æ¡£å•†å“<ul><li>æ”¶å…¥ä¸Šå‡ï¼Œéœ€æ±‚ä¸‹é™</li></ul></li></ul></li><li><p>ç›¸å…³ç‰©å“çš„ä»·æ ¼</p><ul><li>æ›¿ä»£å“<ul><li>æŠ«è¨å’Œæ±‰å ¡</li><li>å¯å£å¯ä¹å’Œç™¾äº‹å¯ä¹</li></ul></li><li>äº’è¡¥å“<ul><li>ç”µè„‘å’Œè½¯ä»¶</li><li>æ±½è½¦å’ŒçŸ³æ²¹</li></ul></li></ul></li><li><p>å—œå¥½</p></li><li><p>é¢„æœŸ</p><ul><li>å¯¹æœªæ¥çš„ä»·æ ¼çš„é¢„æœŸ</li><li>é¢„æœŸæœªæ¥æ”¶å…¥å¢åŠ ï¼Œé‚£ä¹ˆå¯¹ä¸€äº›é«˜æ¡£å“çš„éœ€æ±‚ç°åœ¨å°±æœ‰å¯èƒ½å¢åŠ </li></ul></li></ul></li></ul></li><li><p>å¸‚åœºéœ€æ±‚é‡</p><ul><li>æ‰€æœ‰ä¹°è€…åœ¨æ¯ä¸€ä¸ªä»·æ ¼æ°´å¹³ä¸‹çš„éœ€æ±‚é‡çš„æ€»å’Œ</li></ul></li><li><p>éœ€æ±‚ vs éœ€æ±‚é‡</p><ul><li>éœ€æ±‚çš„å˜åŠ¨æŒ‡é™¤äº†å•†å“ä»·æ ¼ä»¥å¤–çš„å…¶ä»–å› ç´ å¼•èµ·çš„å˜åŠ¨ï¼Œå›¾ä¸Šè¡¨ç°ä¸ºéœ€æ±‚æ›²çº¿çš„å¹³è¡Œç§»åŠ¨</li><li>ä¾›ç»™é‡çš„å˜åŠ¨æŒ‡ç”±ä»·æ ¼å˜åŠ¨å¼•èµ·çš„å˜åŠ¨<h2 id="4-2-ç‰©å“ä¾›ç»™"><a href="#4-2-ç‰©å“ä¾›ç»™" class="headerlink" title="4.2 ç‰©å“ä¾›ç»™"></a>4.2 ç‰©å“ä¾›ç»™</h2></li></ul></li><li><p>ä»å–æ–¹è§’åº¦æ¥çœ‹</p></li><li><p>ä¾›ç»™é‡</p><ul><li>å–è€…æ„¿æ„å¹¶ä¸”èƒ½å¤Ÿå‡ºå”®çš„ä¸€ç§ç‰©å“çš„æ•°é‡</li></ul></li><li><p>ä¾›ç»™å®šç†</p><ul><li>è®¤ä¸ºåœ¨å…¶ä»–æ¡ä»¶ä¸å˜çš„æ—¶å€™ï¼Œä¸€ç§ç‰©å“ä»·æ ¼çš„ä¸Šå‡ï¼Œä¼šä½¿å¾—è¯¥ç‰©å“çš„ä¾›ç»™é‡å¢åŠ </li></ul></li><li><p>å¸‚åœºä¾›ç»™</p><ul><li>åœ¨æ¯ç§ä»·æ ¼æ°´å¹³ä¸‹æ‰€æœ‰å–è€…çš„ä¾›ç»™é‡ä¹‹å’Œ</li></ul></li><li><p>å¸‚åœºä¾›ç»™æ›²çº¿</p><ul><li>ä»·æ ¼ä¸ºçºµè½´ï¼Œæ¨ªè½´ä¸ºä¾›ç»™é‡ï¼Œä»·æ ¼ä¸ºè‡ªå˜é‡</li><li>å½±å“æ›²çº¿ç§»åŠ¨çš„å› ç´ <ul><li>æŠ•å…¥å“çš„ä»·æ ¼<ul><li>ä»·æ ¼ä¸‹é™ï¼Œä¾›ç»™é‡æé«˜</li></ul></li><li>æŠ€æœ¯æ°´å¹³</li><li>å–è€…çš„æ•°é‡</li><li>é¢„æœŸ</li></ul></li></ul></li></ul><h2 id="4-3-éœ€æ±‚ä¸ä¾›ç»™çš„ç»“åˆ"><a href="#4-3-éœ€æ±‚ä¸ä¾›ç»™çš„ç»“åˆ" class="headerlink" title="4.3 éœ€æ±‚ä¸ä¾›ç»™çš„ç»“åˆ"></a>4.3 éœ€æ±‚ä¸ä¾›ç»™çš„ç»“åˆ</h2><ul><li><p>ä¾›ç»™éœ€æ±‚æ›²çº¿ â€“ å¤§å‰ªåˆ€å›¾ lol </p><ul><li>äº¤ç‚¹<ul><li>å‡è¡¡<ul><li>ä¾›ç»™é‡å’Œéœ€æ±‚é‡çš„ç›¸ç­‰</li></ul></li></ul></li><li>è¿‡å‰©  <ul><li>ä¾›ç»™å¤§äºéœ€æ±‚</li><li>å‚å•†éœ€è¦é™ä»·</li><li>éœ€æ±‚é‡ä¼šç›¸å¯¹ä¸Šå‡</li></ul></li><li>çŸ­ç¼º<ul><li>å‚å•†æ„¿æ„ä¾›ç»™é‡å°‘</li><li>æƒ³ä¹°ï¼Œä¹°ä¸åˆ°ï¼Œä¹°è€…æé«˜ä»·æ ¼ä¹°</li><li>å‚å•†æ¥æ›´å¤šç”Ÿäº§</li></ul></li></ul></li><li><p>åˆ†æå¸‚åœºä»·æ ¼çš„å˜åŠ¨</p><ul><li><ol><li>ä½¿ä¾›ç»™æ›²çº¿ç§»åŠ¨è¿˜æ˜¯éœ€æ±‚æ›²çº¿ç§»åŠ¨è¿˜æ˜¯éƒ½ç§»åŠ¨</li></ol></li><li><ol start="2"><li>ç¡®å®šæ›²çº¿çš„ç§»åŠ¨æ–¹å‘</li></ol></li><li><ol start="3"><li>ç”¨ä¾›æ±‚å›¾æ¥è¯´æ˜è¿™ç§ç§»åŠ¨å¦‚ä½•æ”¹å˜å‡è¡¡ä»·æ ¼å’Œå‡è¡¡æ•°é‡çš„</li></ol></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>å­¦å ‚åœ¨çº¿ ç»æµå­¦åŸç†(å¾®è§‚éƒ¨åˆ†) <a href="https://next.xuetangx.com/learn/THU02011001169" target="_blank" rel="noopener">https://next.xuetangx.com/learn/THU02011001169</a> </li><li>æ›¼æ˜† ç»æµå­¦åŸç† ç¬¬6ç‰ˆ</li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-äº«å…ƒæ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><ul><li><p>äº«å…ƒæ¨¡å¼ Flyweight Design Pattern </p><ul><li><p>ç”¨æ¥å¤ç”¨å¯¹è±¡ï¼ŒèŠ‚çœå†…å­˜ï¼Œ</p></li><li><p>å‰ææ¡ä»¶ï¼Œäº«å…ƒå¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡</p><ul><li>ä¸å¯ä»¥æš´éœ²ä»»ä½•setï¼ˆï¼‰ç­‰ä¿®æ”¹å†…éƒ¨çŠ¶æ€çš„æ–¹æ³•</li></ul></li><li><p>å½“ä¸€ä¸ªç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡é‡å¤å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœé‡å¤å¯¹è±¡éƒ½æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨äº«å…ƒæ¨¡å¼å°†å¯¹è±¡è®¾è®¡æˆäº«å…ƒï¼Œåœ¨å†…å­˜ä¸­åªä¿ç•™ä¸€ä»½å®ä¾‹ï¼Œä¾›å¤šå¤„ä»£ç æ¥å¼•ç”¨ã€‚</p></li></ul></li></ul><ul><li>æ˜¯é€šè¿‡å·¥å‚æ¨¡å¼ï¼Œåœ¨å·¥å‚ç±»å½“ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªMapæ¥ç¼“å­˜å·²ç»åˆ›å»ºè¿‡çš„äº«å…ƒå¯¹è±¡ï¼Œæ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„</li></ul><ul><li>æ–‡æœ¬æ–‡ä»¶å¯¹äºå­—ä½“æ ¼å¼è¿›è¡Œäº«å…ƒæ“ä½œ</li></ul><pre><code>public class CharacterStyle {  private Font font;  private int size;  private int colorRGB;  public CharacterStyle(Font font, int size, int colorRGB) {    this.font = font;    this.size = size;    this.colorRGB = colorRGB;  }  @Override  public boolean equals(Object o) {    CharacterStyle otherStyle = (CharacterStyle) o;    return font.equals(otherStyle.font)            &amp;&amp; size == otherStyle.size            &amp;&amp; colorRGB == otherStyle.colorRGB;  }}public class CharacterStyleFactory {  private static final List&lt;CharacterStyle&gt; styles = new ArrayList&lt;&gt;();  public static CharacterStyle getStyle(Font font, int size, int colorRGB) {    CharacterStyle newStyle = new CharacterStyle(font, size, colorRGB);    for (CharacterStyle style : styles) {      if (style.equals(newStyle)) {        return style;      }    }    styles.add(newStyle);    return newStyle;  }}public class Character {  private char c;  private CharacterStyle style;  public Character(char c, CharacterStyle style) {    this.c = c;    this.style = style;  }}public class Editor {  private List&lt;Character&gt; chars = new ArrayList&lt;&gt;();  public void appendCharacter(char c, Font font, int size, int colorRGB) {    Character character = new Character(c, CharacterStyleFactory.getStyle(font, size, colorRGB));    chars.add(character);  }}</code></pre><h1 id="2-äº«å…ƒæ¨¡å¼åœ¨Java-Integerä»¥åŠStringå½“ä¸­çš„åº”ç”¨"><a href="#2-äº«å…ƒæ¨¡å¼åœ¨Java-Integerä»¥åŠStringå½“ä¸­çš„åº”ç”¨" class="headerlink" title="2. äº«å…ƒæ¨¡å¼åœ¨Java Integerä»¥åŠStringå½“ä¸­çš„åº”ç”¨"></a>2. äº«å…ƒæ¨¡å¼åœ¨Java Integerä»¥åŠStringå½“ä¸­çš„åº”ç”¨</h1><pre><code>/** * Cache to support the object identity semantics of autoboxing for values between * -128 and 127 (inclusive) as required by JLS. * * The cache is initialized on first usage.  The size of the cache * may be controlled by the {@code -XX:AutoBoxCacheMax=&lt;size&gt;} option. * During VM initialization, java.lang.Integer.IntegerCache.high property * may be set and saved in the private system properties in the * sun.misc.VM class. */private static class IntegerCache {    static final int low = -128;    static final int high;    static final Integer cache[];    static {        // high value may be configured by property        int h = 127;        String integerCacheHighPropValue =            sun.misc.VM.getSavedProperty(&quot;java.lang.Integer.IntegerCache.high&quot;);        if (integerCacheHighPropValue != null) {            try {                int i = parseInt(integerCacheHighPropValue);                i = Math.max(i, 127);                // Maximum array size is Integer.MAX_VALUE                h = Math.min(i, Integer.MAX_VALUE - (-low) -1);            } catch( NumberFormatException nfe) {                // If the property cannot be parsed into an int, ignore it.            }        }        high = h;        cache = new Integer[(high - low) + 1];        int j = low;        for(int k = 0; k &lt; cache.length; k++)            cache[k] = new Integer(j++);        // range [-128, 127] must be interned (JLS7 5.1.7)        assert IntegerCache.high &gt;= 127;    }    private IntegerCache() {}}</code></pre><p>IntegerCache ç¼“å­˜åœ¨-128åˆ°127ä¹‹é—´çš„å†…å®¹ï¼Œå³æŒ‡å‘çš„æ˜¯åŒæ ·çš„å†…å­˜åœ°å€çš„</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº«å…ƒæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-ç»„åˆæ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†å’Œå®ç°"><a href="#1-åŸç†å’Œå®ç°" class="headerlink" title="1. åŸç†å’Œå®ç°"></a>1. åŸç†å’Œå®ç°</h1><p>ç»„åˆæ¨¡å¼ï¼Œæ˜¯ç”¨æ¥å¤„ç†æ ‘å½¢ç»“æ„çš„æ•°æ®çš„ã€‚</p><ul><li>Compose objects into tree structure to represent part-whole hierarchies. Composite lets client treat individual objects and compositions of objects uniformly. </li><li>å°†ä¸€ç»„å¯¹è±¡ç»„ç»‡æˆæ ‘å½¢ç»“æ„ï¼Œæ¥è¡¨ç¤ºä¸€ç§ éƒ¨åˆ†-æ•´ä½“çš„å±‚æ¬¡ç»“æ„ï¼Œç»„åˆè®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„å¤„ç†é€»è¾‘ã€‚</li></ul><h1 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2. åº”ç”¨åœºæ™¯"></a>2. åº”ç”¨åœºæ™¯</h1><ul><li>ç°åœ¨è®¾è®¡ä¸€ä¸ªç±»æ¥è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•ï¼Œæ¥æ–¹ä¾¿åœ°å®ç°ä¸‹é¢çš„åŠŸèƒ½ï¼š<ul><li>åŠ¨æ€æ·»åŠ ã€åˆ é™¤æŸä¸ªç›®å½•ä¸‹çš„å­ç›®å½•æˆ–æ–‡ä»¶</li><li>ç»Ÿè®¡æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°</li><li>ç»Ÿè®¡æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶æ€»å¤§å°</li></ul></li></ul><pre><code>public class FileSystemNode {  private String path;  private boolean isFile;  private List&lt;FileSystemNode&gt; subNodes = new ArrayList&lt;&gt;();  public FileSystemNode(String path, boolean isFile) {    this.path = path;    this.isFile = isFile;  }  public int countNumOfFiles() {    if (isFile) { return 1; }     int numOfFiles = 0;     for (FileSystemNode fileOrDir : subNodes) {         numOfFiles += fileOrDir.countNumOfFiles();     }     return numOfFiles;  }  public long countSizeOfFiles() {    if (isFile) {              File file = new File(path);              if (!file.exists()) return 0;              return file.length();        }        long sizeofFiles = 0;        for (FileSystemNode fileOrDir : subNodes) {              sizeofFiles += fileOrDir.countSizeOfFiles();        }        return sizeofFiles;  }  public String getPath() {    return path;  }  public void addSubNode(FileSystemNode fileOrDir) {    subNodes.add(fileOrDir);  }  public void removeSubNode(FileSystemNode fileOrDir) {    int size = subNodes.size();    int i = 0;    for (; i &lt; size; ++i) {      if (subNodes.get(i).getPath().equalsIgnoreCase(fileOrDir.getPath())) {        break;      }    }    if (i &lt; size) {      subNodes.remove(i);    }  }}</code></pre><ul><li>è€Œåå¯¹æ–‡ä»¶å’Œç›®å½•è¿›è¡ŒåŒºåˆ†è®¾è®¡</li></ul><pre><code>public abstract class FileSystemNode {  protected String path;  public FileSystemNode(String path) {    this.path = path;  }  public abstract int countNumOfFiles();  public abstract long countSizeOfFiles();  public String getPath() {    return path;  }}public class File extends FileSystemNode {  public File(String path) {    super(path);  }  @Override  public int countNumOfFiles() {    return 1;  }  @Override  public long countSizeOfFiles() {    java.io.File file = new java.io.File(path);    if (!file.exists()) return 0;    return file.length();  }}public class Directory extends FileSystemNode {  private List&lt;FileSystemNode&gt; subNodes = new ArrayList&lt;&gt;();  public Directory(String path) {    super(path);  }  @Override  public int countNumOfFiles() {    int numOfFiles = 0;    for (FileSystemNode fileOrDir : subNodes) {      numOfFiles += fileOrDir.countNumOfFiles();    }    return numOfFiles;  }  @Override  public long countSizeOfFiles() {    long sizeofFiles = 0;    for (FileSystemNode fileOrDir : subNodes) {      sizeofFiles += fileOrDir.countSizeOfFiles();    }    return sizeofFiles;  }  public void addSubNode(FileSystemNode fileOrDir) {    subNodes.add(fileOrDir);  }  public void removeSubNode(FileSystemNode fileOrDir) {    int size = subNodes.size();    int i = 0;    for (; i &lt; size; ++i) {      if (subNodes.get(i).getPath().equalsIgnoreCase(fileOrDir.getPath())) {        break;      }    }    if (i &lt; size) {      subNodes.remove(i);    }  }}public class Demo {  public static void main(String[] args) {    /**     * /     * /wz/     * /wz/a.txt     * /wz/b.txt     * /wz/movies/     * /wz/movies/c.avi     * /xzg/     * /xzg/docs/     * /xzg/docs/d.txt     */    Directory fileSystemTree = new Directory(&quot;/&quot;);    Directory node_wz = new Directory(&quot;/wz/&quot;);    Directory node_xzg = new Directory(&quot;/xzg/&quot;);    fileSystemTree.addSubNode(node_wz);    fileSystemTree.addSubNode(node_xzg);    File node_wz_a = new File(&quot;/wz/a.txt&quot;);    File node_wz_b = new File(&quot;/wz/b.txt&quot;);    Directory node_wz_movies = new Directory(&quot;/wz/movies/&quot;);    node_wz.addSubNode(node_wz_a);    node_wz.addSubNode(node_wz_b);    node_wz.addSubNode(node_wz_movies);    File node_wz_movies_c = new File(&quot;/wz/movies/c.avi&quot;);    node_wz_movies.addSubNode(node_wz_movies_c);    Directory node_xzg_docs = new Directory(&quot;/xzg/docs/&quot;);    node_xzg.addSubNode(node_xzg_docs);    File node_xzg_docs_d = new File(&quot;/xzg/docs/d.txt&quot;);    node_xzg_docs.addSubNode(node_xzg_docs_d);    System.out.println(&quot;/ files num:&quot; + fileSystemTree.countNumOfFiles());    System.out.println(&quot;/wz/ files num:&quot; + node_wz.countNumOfFiles());  }}</code></pre><blockquote><p>å°†ä¸€ç»„å¯¹è±¡ï¼ˆæ–‡ä»¶å’Œç›®å½•ï¼‰ç»„ç»‡æˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºä¸€ç§â€˜éƒ¨åˆ† - æ•´ä½“â€™çš„å±‚æ¬¡ç»“æ„ï¼ˆç›®å½•ä¸å­ç›®å½•çš„åµŒå¥—ç»“æ„ï¼‰ã€‚ç»„åˆæ¨¡å¼è®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å•ä¸ªå¯¹è±¡ï¼ˆæ–‡ä»¶ï¼‰å’Œç»„åˆå¯¹è±¡ï¼ˆç›®å½•ï¼‰çš„å¤„ç†é€»è¾‘ï¼ˆé€’å½’éå†ï¼‰</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»„åˆæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-é—¨é¢æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†ä¸å®ç°"><a href="#1-åŸç†ä¸å®ç°" class="headerlink" title="1. åŸç†ä¸å®ç°"></a>1. åŸç†ä¸å®ç°</h1><p>é—¨é¢æ¨¡å¼åº”ç”¨åœºæ™¯ä¸»è¦åœ¨äºæ¥å£è®¾è®¡æ–¹é¢ï¼Œæ˜¯ä¸ºäº†å¤„ç†å’Œè§£å†³æ¥å£ç²’åº¦çš„ç›¸å…³é—®é¢˜ã€‚</p><p>ä¸ºäº†ä¿è¯æ¥å£çš„å¯å¤ç”¨æ€§(é€šç”¨æ€§)ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¥å£è®¾è®¡çš„ç²’åº¦ç»†ä¸€äº›ï¼ŒèŒè´£å•ä¸€ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ¥å£çš„ç²’åº¦è¿‡å°ï¼Œåœ¨æ¥å£ä½¿ç”¨è€…å¼€å‘ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½çš„æ—¶å€™ï¼Œå°±éœ€è¦å¼€å‘ä¸åŒçš„æ¥å£æ¥æ»¡è¶³ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç³»ç»Ÿçš„æ¥å£æ— é™è†¨èƒ€ã€‚</p><ul><li>é—¨é¢æ¨¡å¼  Facade Design Pattern <ul><li>provide a unified interface to a set of interfaces in a subsystem</li><li>facade pattern defines a higher level interface that makes the subsystem easier to use </li></ul></li></ul><ul><li>åœºæ™¯ä¸¾ä¾‹<ul><li>æ¯”å¦‚ç³»ç»ŸAæä¾›a,b,c,då››ä¸ªæ¥å£ï¼Œç³»ç»ŸBå®ŒæˆæŸä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨Aç³»ç»Ÿçš„a,b,dæ¥å£ã€‚åˆ©ç”¨é—¨é¢æ¨¡å¼ï¼Œæä¾›ä¸€ä¸ªåŒ…è£¹a,b,dæ¥å£è°ƒç”¨çš„é—¨é¢æ¥å£xï¼Œç»™ç³»ç»ŸBç›´æ¥ä½¿ç”¨</li><li>å¦‚æœä¸Šè¿°ABä¸€ä¸ªæ˜¯åç«¯ï¼Œä¸€ä¸ªæ˜¯APPç«¯çš„è¯ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´ç½‘ç»œé€šä¿¡è€—æ—¶ä¼šæ¯”è¾ƒå¤š</li></ul></li></ul><h1 id="2-é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#2-é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="2. é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>2. é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h1><h2 id="2-1-è§£å†³æ˜“ç”¨æ€§é—®é¢˜"><a href="#2-1-è§£å†³æ˜“ç”¨æ€§é—®é¢˜" class="headerlink" title="2.1 è§£å†³æ˜“ç”¨æ€§é—®é¢˜"></a>2.1 è§£å†³æ˜“ç”¨æ€§é—®é¢˜</h2><ul><li>å°è£…ç³»ç»Ÿçš„åº•å±‚å®ç°ï¼Œéšè—ç³»ç»Ÿçš„å¤æ‚æ€§</li><li>æä¾›ä¸€ç»„æ›´åŠ ç®€å•æ˜“ç”¨ï¼Œæ›´é«˜å±‚çš„æ¥å£</li><li>ä¾‹å­<ul><li>Linuxç³»ç»Ÿè°ƒç”¨å‡½æ•°<ul><li>å°è£…äº†åº•å±‚Linuxå†…æ ¸çš„è°ƒç”¨</li></ul></li><li>ShellæŒ‡ä»¤<ul><li>å°è£…ç³»ç»Ÿè°ƒç”¨</li><li>æä¾›æ›´åŠ å‹å¥½çš„æŒ‡ä»¤</li></ul></li></ul></li></ul><h2 id="2-2-è§£å†³æ€§èƒ½é—®é¢˜"><a href="#2-2-è§£å†³æ€§èƒ½é—®é¢˜" class="headerlink" title="2.2 è§£å†³æ€§èƒ½é—®é¢˜"></a>2.2 è§£å†³æ€§èƒ½é—®é¢˜</h2><ul><li>å½“ä½¿ç”¨ä¸€ä¸ªé—¨é¢æ¥å£æ›¿æ¢å¤šä¸ªæ¥å£çš„è°ƒç”¨çš„æ—¶å€™ï¼Œå‡å°‘äº†ç½‘ç»œé€šä¿¡æˆæœ¬</li><li>å¦‚æœé—¨é¢æ¥å£æ¯”è¾ƒå¤š<ul><li>å¯ä»¥æŠ½è±¡å‡ºä¸€å±‚ï¼Œä¸“é—¨æ”¾ç½®é—¨é¢æ¥å£</li><li>å¦‚æœè·¨å¤šä¸ªå­ç³»ç»Ÿï¼Œå¯ä»¥å°†é—¨é¢æ¥å£æ”¾åˆ°ä¸€ä¸ªæ–°çš„å­ç³»ç»Ÿå½“ä¸­</li></ul></li></ul><h2 id="2-3-è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"><a href="#2-3-è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜" class="headerlink" title="2.3 è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"></a>2.3 è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</h2><p>åœ¨ä¸€ä¸ªé‡‘èç³»ç»Ÿä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸šåŠ¡é¢†åŸŸæ¨¡å‹ï¼Œç”¨æˆ·å’Œé’±åŒ…ã€‚è¿™ä¸¤ä¸ªä¸šåŠ¡é¢†åŸŸæ¨¡å‹éƒ½å¯¹å¤–æš´éœ²äº†ä¸€ç³»åˆ—æ¥å£ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥æ¥å£ã€é’±åŒ…çš„å¢åˆ æ”¹æŸ¥æ¥å£ã€‚å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼šåœ¨ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä»…ä¼šåˆ›å»ºç”¨æˆ·ï¼ˆåœ¨æ•°æ®åº“ User è¡¨ä¸­ï¼‰ï¼Œè¿˜ä¼šç»™ç”¨æˆ·åˆ›å»ºä¸€ä¸ªé’±åŒ…ï¼ˆåœ¨æ•°æ®åº“çš„ Wallet è¡¨ä¸­ï¼‰ã€‚</p><p>å¯¹äºè¿™æ ·ä¸€ä¸ªç®€å•çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¾æ¬¡è°ƒç”¨ç”¨æˆ·çš„åˆ›å»ºæ¥å£å’Œé’±åŒ…çš„åˆ›å»ºæ¥å£æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œç”¨æˆ·æ³¨å†Œéœ€è¦æ”¯æŒäº‹åŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›å»ºç”¨æˆ·å’Œé’±åŒ…çš„ä¸¤ä¸ªæ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œä¸èƒ½ä¸€ä¸ªæˆåŠŸã€ä¸€ä¸ªå¤±è´¥ã€‚</p><p>è¦æ”¯æŒä¸¤ä¸ªæ¥å£è°ƒç”¨åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œï¼Œæ˜¯æ¯”è¾ƒéš¾å®ç°çš„ï¼Œè¿™æ¶‰åŠåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æˆ–è€…äº‹åè¡¥å¿çš„æœºåˆ¶æ¥è§£å†³ï¼Œä½†ä»£ç å®ç°éƒ½æ¯”è¾ƒå¤æ‚ã€‚è€Œæœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåˆ©ç”¨æ•°æ®åº“äº‹åŠ¡æˆ–è€… Spring æ¡†æ¶æä¾›çš„äº‹åŠ¡ï¼ˆå¦‚æœæ˜¯ Java è¯­è¨€çš„è¯ï¼‰ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰§è¡Œåˆ›å»ºç”¨æˆ·å’Œåˆ›å»ºé’±åŒ…è¿™ä¸¤ä¸ª SQL æ“ä½œã€‚è¿™å°±è¦æ±‚ä¸¤ä¸ª SQL æ“ä½œè¦åœ¨ä¸€ä¸ªæ¥å£ä¸­å®Œæˆï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿé‰´é—¨é¢æ¨¡å¼çš„æ€æƒ³ï¼Œå†è®¾è®¡ä¸€ä¸ªåŒ…è£¹è¿™ä¸¤ä¸ªæ“ä½œçš„æ–°æ¥å£ï¼Œè®©æ–°æ¥å£åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œä¸¤ä¸ª SQL æ“ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é—¨é¢æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-é€‚é…å™¨æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-é€‚é…å™¨æ¨¡å¼åŸç†å’Œå®ç°"><a href="#1-é€‚é…å™¨æ¨¡å¼åŸç†å’Œå®ç°" class="headerlink" title="1. é€‚é…å™¨æ¨¡å¼åŸç†å’Œå®ç°"></a>1. é€‚é…å™¨æ¨¡å¼åŸç†å’Œå®ç°</h1><ul><li><p>Adapter Design Pattern </p><ul><li>åšé€‚é…çš„ï¼Œå°†ä¸å…¼å®¹çš„æ¥å£è½¬æ¢ä¸ºå¯å…¼å®¹çš„æ¥å£</li><li>å°†åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„ç±»ä¸€èµ·å·¥ä½œ</li></ul></li><li><p>å®ç°æ–¹å¼</p><ul><li>ç±»é€‚é…å™¨<ul><li>ä½¿ç”¨ç»§æ‰¿å…³ç³»å®ç°</li></ul></li><li>å¯¹è±¡é€‚é…å™¨<ul><li>ä½¿ç”¨ç»„åˆå…³ç³»å®ç°</li></ul></li></ul></li></ul><pre><code>// ç±»é€‚é…å™¨: åŸºäºç»§æ‰¿public interface ITarget {  void f1();  void f2();  void fc();}public class Adaptee {  public void fa() { //... }  public void fb() { //... }  public void fc() { //... }}public class Adaptor extends Adaptee implements ITarget {  public void f1() {    super.fa();  }  public void f2() {    //...é‡æ–°å®ç°f2()...  }  // è¿™é‡Œfc()ä¸éœ€è¦å®ç°ï¼Œç›´æ¥ç»§æ‰¿è‡ªAdapteeï¼Œè¿™æ˜¯è·Ÿå¯¹è±¡é€‚é…å™¨æœ€å¤§çš„ä¸åŒç‚¹}// å¯¹è±¡é€‚é…å™¨ï¼šåŸºäºç»„åˆpublic interface ITarget {  void f1();  void f2();  void fc();}public class Adaptee {  public void fa() { //... }  public void fb() { //... }  public void fc() { //... }}public class Adaptor implements ITarget {  private Adaptee adaptee;  public Adaptor(Adaptee adaptee) {    this.adaptee = adaptee;  }  public void f1() {    adaptee.fa(); //å§”æ‰˜ç»™Adaptee  }  public void f2() {    //...é‡æ–°å®ç°f2()...  }  public void fc() {    adaptee.fc();  }}</code></pre><ul><li><p>ç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨çš„é€‰æ‹©å–å†³äº</p><ul><li>Adapteeæ¥å£çš„ä¸ªæ•°</li><li>Adaptee å’ŒItargetçš„å¥‘åˆç¨‹åº¦</li></ul></li><li><p>å¦‚æœ Adaptee æ¥å£å¹¶ä¸å¤šï¼Œé‚£ä¸¤ç§å®ç°æ–¹å¼éƒ½å¯ä»¥ã€‚</p></li><li><p>å¦‚æœ Adaptee æ¥å£å¾ˆå¤šï¼Œè€Œä¸” Adaptee å’Œ ITarget æ¥å£å®šä¹‰å¤§éƒ¨åˆ†éƒ½ç›¸åŒï¼Œé‚£æˆ‘ä»¬æ¨èä½¿ç”¨ç±»é€‚é…å™¨ï¼Œå› ä¸º Adaptor å¤ç”¨çˆ¶ç±» Adaptee çš„æ¥å£ï¼Œæ¯”èµ·å¯¹è±¡é€‚é…å™¨çš„å®ç°æ–¹å¼ï¼ŒAdaptor çš„ä»£ç é‡è¦å°‘ä¸€äº›ã€‚</p></li><li><p>å¦‚æœ Adaptee æ¥å£å¾ˆå¤šï¼Œè€Œä¸” Adaptee å’Œ ITarget æ¥å£å®šä¹‰å¤§éƒ¨åˆ†éƒ½ä¸ç›¸åŒï¼Œé‚£æˆ‘ä»¬æ¨èä½¿ç”¨å¯¹è±¡é€‚é…å™¨ï¼Œå› ä¸ºç»„åˆç»“æ„ç›¸å¯¹äºç»§æ‰¿æ›´åŠ çµæ´»ã€‚</p></li></ul><h1 id="2-åº”ç”¨åœºæ™¯æ€»ç»“"><a href="#2-åº”ç”¨åœºæ™¯æ€»ç»“" class="headerlink" title="2. åº”ç”¨åœºæ™¯æ€»ç»“"></a>2. åº”ç”¨åœºæ™¯æ€»ç»“</h1><ul><li>é€‚é…å™¨æ¨¡å¼ â€“ ä¸€ç§è¡¥å¿æ¨¡å¼<ul><li>ä¸»è¦ç”¨æ¥å¼¥è¡¥ä¸€äº›è®¾è®¡ä¸Šçš„ç¼ºé™·</li><li>ä¸»è¦ç”¨æ¥è§£å†³æ¥å£ä¸å…¼å®¹çš„é—®é¢˜</li></ul></li></ul><h2 id="2-1-å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡"><a href="#2-1-å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡" class="headerlink" title="2.1 å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡"></a>2.1 å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡</h2><p>è­¬å¦‚æˆ‘ä»¬ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿåœ¨æ¥å£è®¾è®¡ä¸Šæœ‰ç¼ºé™·ï¼ˆåŒ…å«å¤§é‡çš„é™æ€æ–¹æ³•ï¼‰ï¼Œå¼•å…¥åä¼šå½±å“åˆ°æˆ‘ä»¬è‡ªèº«ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚ä¸ºäº†éš”ç¦»è®¾è®¡ä¸Šçš„ç¼ºé™·ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹å¤–éƒ¨ç³»ç»Ÿæä¾›çš„æ¥å£è¿›è¡ŒäºŒæ¬¡å°è£…ï¼ŒæŠ½è±¡å‡ºæ›´å¥½çš„æ¥å£è®¾è®¡ã€‚</p><pre><code>public class CD { //è¿™ä¸ªç±»æ¥è‡ªå¤–éƒ¨sdkï¼Œæˆ‘ä»¬æ— æƒä¿®æ”¹å®ƒçš„ä»£ç   //...  public static void staticFunction1() { //... }  public void uglyNamingFunction2() { //... }  public void tooManyParamsFunction3(int paramA, int paramB, ...) { //... }   public void lowPerformanceFunction4() { //... }}// ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œé‡æ„public class ITarget {  void function1();  void function2();  void fucntion3(ParamsWrapperDefinition paramsWrapper);  void function4();  //...}// æ³¨æ„ï¼šé€‚é…å™¨ç±»çš„å‘½åä¸ä¸€å®šéå¾—æœ«å°¾å¸¦Adaptorpublic class CDAdaptor extends CD implements ITarget {  //...  public void function1() {     super.staticFunction1();  }  public void function2() {    super.uglyNamingFucntion2();  }  public void function3(ParamsWrapperDefinition paramsWrapper) {     super.tooManyParamsFunction3(paramsWrapper.getParamA(), ...);  }  public void function4() {    //...reimplement it...  }}</code></pre><h2 id="2-2-ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡"><a href="#2-2-ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡" class="headerlink" title="2.2 ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡"></a>2.2 ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡</h2><p>æŸä¸ªåŠŸèƒ½çš„å®ç°ä¾èµ–å¤šä¸ªå¤–éƒ¨ç³»ç»Ÿï¼Œé€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œå°†å…¶æ¥å£é€‚é…ä¸ºç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œç„¶åä½¿ç”¨å¤šæ€çš„ç‰¹æ€§æ¥å¤ç”¨ä»£ç é€»è¾‘ã€‚</p><p>ä¸‹è¿°ä»£ç ä½¿ç”¨é€‚é…å™¨æ¨¡å¼æ¥å¤„ç†æœ‰ä¸åŒçš„æ¥å£è®¾è®¡çš„å‡ ä¸ªæ¥è‡ªç¬¬ä¸‰æ–¹åšè¯æ±‡è¿‡æ»¤çš„API</p><pre><code>public class ASensitiveWordsFilter { // Aæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£  //textæ˜¯åŸå§‹æ–‡æœ¬ï¼Œå‡½æ•°è¾“å‡ºç”¨***æ›¿æ¢æ•æ„Ÿè¯ä¹‹åçš„æ–‡æœ¬  public String filterSexyWords(String text) {    // ...  }  public String filterPoliticalWords(String text) {    // ...  } }public class BSensitiveWordsFilter  { // Bæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£  public String filter(String text) {    //...  }}public class CSensitiveWordsFilter { // Cæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£  public String filter(String text, String mask) {    //...  }}// æœªä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹å‰çš„ä»£ç ï¼šä»£ç çš„å¯æµ‹è¯•æ€§ã€æ‰©å±•æ€§ä¸å¥½public class RiskManagement {  private ASensitiveWordsFilter aFilter = new ASensitiveWordsFilter();  private BSensitiveWordsFilter bFilter = new BSensitiveWordsFilter();  private CSensitiveWordsFilter cFilter = new CSensitiveWordsFilter();  public String filterSensitiveWords(String text) {    String maskedText = aFilter.filterSexyWords(text);    maskedText = aFilter.filterPoliticalWords(maskedText);    maskedText = bFilter.filter(maskedText);    maskedText = cFilter.filter(maskedText, &quot;***&quot;);    return maskedText;  }}// ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œæ”¹é€ public interface ISensitiveWordsFilter { // ç»Ÿä¸€æ¥å£å®šä¹‰  String filter(String text);}public class ASensitiveWordsFilterAdaptor implements ISensitiveWordsFilter {  private ASensitiveWordsFilter aFilter;  public String filter(String text) {    String maskedText = aFilter.filterSexyWords(text);    maskedText = aFilter.filterPoliticalWords(maskedText);    return maskedText;  }}//...çœç•¥BSensitiveWordsFilterAdaptorã€CSensitiveWordsFilterAdaptor...// æ‰©å±•æ€§æ›´å¥½ï¼Œæ›´åŠ ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœæ·»åŠ ä¸€ä¸ªæ–°çš„æ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿï¼Œ// è¿™ä¸ªç±»å®Œå…¨ä¸éœ€è¦æ”¹åŠ¨ï¼›è€Œä¸”åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹ï¼Œä»£ç çš„å¯æµ‹è¯•æ€§æ›´å¥½ã€‚public class RiskManagement {   private List&lt;ISensitiveWordsFilter&gt; filters = new ArrayList&lt;&gt;();  public void addSensitiveWordsFilter(ISensitiveWordsFilter filter) {    filters.add(filter);  }  public String filterSensitiveWords(String text) {    String maskedText = text;    for (ISensitiveWordsFilter filter : filters) {      maskedText = filter.filter(maskedText);    }    return maskedText;  }}</code></pre><h2 id="2-3-æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ"><a href="#2-3-æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ" class="headerlink" title="2.3 æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ"></a>2.3 æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ</h2><pre><code>// å¤–éƒ¨ç³»ç»ŸApublic interface IA {  //...  void fa();}public class A implements IA {  //...  public void fa() { //... }}// åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¤–éƒ¨ç³»ç»ŸAçš„ä½¿ç”¨ç¤ºä¾‹public class Demo {  private IA a;  public Demo(IA a) {    this.a = a;  }  //...}Demo d = new Demo(new A());// å°†å¤–éƒ¨ç³»ç»ŸAæ›¿æ¢æˆå¤–éƒ¨ç³»ç»ŸBpublic class BAdaptor implemnts IA {  private B b;  public BAdaptor(B b) {    this.b= b;  }  public void fa() {    //...    b.fb();  }}// å€ŸåŠ©BAdaptorï¼ŒDemoçš„ä»£ç ä¸­ï¼Œè°ƒç”¨IAæ¥å£çš„åœ°æ–¹éƒ½æ— éœ€æ”¹åŠ¨ï¼Œ// åªéœ€è¦å°†BAdaptorå¦‚ä¸‹æ³¨å…¥åˆ°Demoå³å¯ã€‚Demo d = new Demo(new BAdaptor(new B()));</code></pre><h2 id="2-4-å…¼å®¹è€ç‰ˆæœ¬çš„æ¥å£"><a href="#2-4-å…¼å®¹è€ç‰ˆæœ¬çš„æ¥å£" class="headerlink" title="2.4 å…¼å®¹è€ç‰ˆæœ¬çš„æ¥å£"></a>2.4 å…¼å®¹è€ç‰ˆæœ¬çš„æ¥å£</h2><p>åšç‰ˆæœ¬å‡çº§çš„æ—¶å€™ï¼Œå¯¹äºä¸€äº›è¦åºŸå¼ƒçš„æ¥å£ï¼Œä¸èƒ½ç›´æ¥å°†å…¶åˆ é™¤ï¼Œè€Œæ˜¯æš‚æ—¶ä¿ç•™ï¼Œå¹¶ä¸”æ ‡æ³¨ä¸ºdeprecatedï¼Œå¹¶å°†å†…éƒ¨å®ç°é€»è¾‘å§”æ‰˜ä¸ºæ–°çš„æ¥å£å®ç°ã€‚è¿™æ ·å°±å¯ä»¥æ˜¯çš„é¡¹ç›®æœ‰ä¸ªè¿‡æ¸¡æœŸã€‚</p><p>Enumeration â€“&gt; Iteratorçš„å‡çº§</p><pre><code>public class Collections {  public static Emueration emumeration(final Collection c) {    return new Enumeration() {      Iterator i = c.iterator();      public boolean hasMoreElments() {        return i.hashNext();      }      public Object nextElement() {        return i.next():      }    }  }}</code></pre><h1 id="3-ä»£ç†-vs-æ¡¥æ¥-vs-è£…é¥°å™¨-vs-é€‚é…å™¨"><a href="#3-ä»£ç†-vs-æ¡¥æ¥-vs-è£…é¥°å™¨-vs-é€‚é…å™¨" class="headerlink" title="3. ä»£ç† vs æ¡¥æ¥ vs è£…é¥°å™¨ vs é€‚é…å™¨"></a>3. ä»£ç† vs æ¡¥æ¥ vs è£…é¥°å™¨ vs é€‚é…å™¨</h1><ul><li><p>ä»£ç†æ¨¡å¼</p><ul><li>åœ¨ä¸æ”¹å˜åŸå§‹ç±»æ¥å£çš„æ¡ä»¶ä¸‹ï¼Œä¸ºåŸå§‹ç±»å®šä¹‰ä¸€ä¸ªä»£ç†ç±»ï¼Œä¸»è¦ç›®çš„æ˜¯è®¿é—®æ§åˆ¶ï¼Œè€ŒéåŠ å¼ºåŠŸèƒ½</li></ul></li><li><p>æ¡¥æ¥æ¨¡å¼</p><ul><li>å°†æ¥å£éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å¾—å…¶èƒ½å¤Ÿç›¸å¯¹ç‹¬ç«‹çš„è¿›è¡Œæ”¹å˜</li></ul></li><li><p>è£…é¥°å™¨æ¨¡å¼</p><ul><li>åœ¨ä¸æ”¹å˜åŸå§‹ç±»æ¥å£çš„æƒ…å†µä¸‹ï¼Œå¯¹åŸå§‹ç±»åŠŸèƒ½è¿›è¡Œå¢å¼ºï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªè£…é¥°å™¨çš„åµŒå¥—ä½¿ç”¨</li></ul></li><li><p>é€‚é…å™¨æ¨¡å¼</p><ul><li>äº‹åè¡¥æ•‘ç­–ç•¥ï¼Œé€‚é…å™¨æä¾›è·ŸåŸå§‹ç±»ä¸åŒçš„æ¥å£</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€‚é…å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-è£…é¥°å™¨æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-Java-IOç±»çš„ä½¿ç”¨"><a href="#1-1-Java-IOç±»çš„ä½¿ç”¨" class="headerlink" title="1.1 Java IOç±»çš„ä½¿ç”¨"></a>1.1 Java IOç±»çš„ä½¿ç”¨</h2><table><thead><tr><th></th><th>å­—èŠ‚æµ</th><th>å­—ç¬¦æµ</th></tr></thead><tbody><tr><td>è¾“å…¥æµ</td><td>InputStream</td><td>Reader</td></tr><tr><td>è¾“å‡ºæµ</td><td>OutputStream</td><td>Writer</td></tr></tbody></table><p>JavaIOåº“éå¸¸åºå¤§ï¼Œå‡ åä¸ªç±»ä¸€åŒæ¥è´Ÿè´£IOæ•°æ®çš„è¯»å–å’Œå†™å…¥ã€‚</p><pre><code>InputStream in = new FileInputStream(&quot;/user/wangzheng/test.txt&quot;);InputStream bin = new BufferedInputStream(in);byte[] data = new byte[128];while (bin.read(data) != -1) {  //...}</code></pre><p>ä¸Šè¿°ä»£ç å…ˆä½¿ç”¨äº†FileInputStreamæ¥è¯»å–æ–‡ä»¶æµï¼Œç„¶ååˆä½¿ç”¨äº†BufferedInputStreamï¼Œæ¥æ”¯æŒç¼“å­˜ã€‚</p><p>é—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½è®¾ç½®ä¸€ä¸ªç»§æ‰¿äº†FileInputStreamå¹¶ä¸”æ”¯æŒç¼“å­˜çš„BufferedFileInputStreamç±»å‘¢ï¼Ÿ </p><p>é—®é¢˜åœ¨äºå„ç§use caseå¤ªå¤šï¼Œå¦‚æœä¸ºäº†å„ç§åŠŸèƒ½çš„ç»„åˆéƒ½è®¾ç½®ä¸€ä¸ªç±»çš„è¯ï¼Œé‚£ä¹ˆç±»çš„ç»§æ‰¿ç»“æ„ä¼šå˜å¾—éå¸¸è´Ÿè´£ï¼Œä»£ç ä¼šå˜å¾—å¾ˆéš¾æ‰©å±•å’Œç»´æŠ¤ã€‚</p><p>Java IOçš„è®¾è®¡æ€è·¯ï¼Œå°±æ˜¯ä½¿ç”¨ç»„åˆæ¥æ›¿ä»£ç»§æ‰¿</p><pre><code>public abstract class InputStream {  //...  public int read(byte b[]) throws IOException {    return read(b, 0, b.length);  }  public int read(byte b[], int off, int len) throws IOException {    //...  }  public long skip(long n) throws IOException {    //...  }  public int available() throws IOException {    return 0;  }  public void close() throws IOException {}  public synchronized void mark(int readlimit) {}  public synchronized void reset() throws IOException {    throw new IOException(&quot;mark/reset not supported&quot;);  }  public boolean markSupported() {    return false;  }}public class BufferedInputStream extends InputStream {  protected volatile InputStream in;  protected BufferedInputStream(InputStream in) {    this.in = in;  }  //...å®ç°åŸºäºç¼“å­˜çš„è¯»æ•°æ®æ¥å£...  }public class DataInputStream extends InputStream {  protected volatile InputStream in;  protected DataInputStream(InputStream in) {    this.in = in;  }  //...å®ç°è¯»å–åŸºæœ¬ç±»å‹æ•°æ®çš„æ¥å£}</code></pre><h2 id="1-2-è£…é¥°å™¨æ¨¡å¼"><a href="#1-2-è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="1.2 è£…é¥°å™¨æ¨¡å¼"></a>1.2 è£…é¥°å™¨æ¨¡å¼</h2><ul><li>ä½¿ç”¨ç»„åˆæ¥æ›¿ä»£ç»§æ‰¿å…³ç³»</li><li>è£…é¥°å™¨ç±»å’ŒåŸå§‹ç±»ç»§æ‰¿åŒæ ·çš„çˆ¶ç±»ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹åŸå§‹ç±»åµŒå¥—å¤šä¸ªè£…é¥°å™¨ç±»</li><li>æ˜¯å¯¹åŠŸèƒ½çš„å¢å¼ºï¼Œæ˜¯å’ŒåŸå§‹åŠŸèƒ½ç›¸å…³çš„</li><li>ä¸ºäº†è§£å†³ç»§æ‰¿å…³ç³»è¿‡äºå¤æ‚çš„é—®é¢˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è£…é¥°å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-æ¡¥æ¥æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸç†è§£æ"><a href="#1-åŸç†è§£æ" class="headerlink" title="1. åŸç†è§£æ"></a>1. åŸç†è§£æ</h1><ul><li>æ¡¥æ¥æ¨¡å¼ Bridge Design Pattern<ul><li>å°†æŠ½è±¡å’Œå®ç°è§£è€¦ï¼Œä½¿ä¹‹å¯ä»¥ç‹¬ç«‹å˜åŒ–</li><li>ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªæˆ–è€…å¤šä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œé€šè¿‡ç»„åˆçš„æ–¹å¼ï¼Œè®©è¿™å‡ ä¸ªç»´åº¦éƒ½å¯ä»¥ç‹¬ç«‹è¿›è¡Œæ‰©å±•<ul><li>é€šè¿‡ç»„åˆå…³ç³»æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ï¼Œé¿å…ç»§æ‰¿å±‚æ¬¡çš„æŒ‡æ•°çº§çˆ†ç‚¸</li></ul></li></ul></li></ul><h2 id="1-1-JDBCé©±åŠ¨çš„å®ç°"><a href="#1-1-JDBCé©±åŠ¨çš„å®ç°" class="headerlink" title="1.1 JDBCé©±åŠ¨çš„å®ç°"></a>1.1 JDBCé©±åŠ¨çš„å®ç°</h2><pre><code>    Class.forName(&quot;com.mysql.jdbc.Driver&quot;);//åŠ è½½åŠæ³¨å†ŒJDBCé©±åŠ¨ç¨‹åº    String url = &quot;jdbc:mysql://localhost:3306/sample_db?user=root&amp;password=your_password&quot;;    Connection con = DriverManager.getConnection(url);    Statement stmt = con.createStatement()ï¼›    String query = &quot;select * from test&quot;;    ResultSet rs=stmt.executeQuery(query);    while(rs.next()) {      rs.getString(1);      rs.getInt(2);    }</code></pre><ul><li>ä¸Šè¿°ä»£ç ä¸­åªè¦æ”¹å˜forNameä¸­çš„è·¯å¾„ï¼Œå°±å¯ä»¥æ”¹å˜æ•°æ®åº“äº†</li><li>æˆ–è€…æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†åŠ è½½çš„Driverç±»å†™åˆ°é…ç½®æ–‡ä»¶å½“ä¸­ï¼Œæ¥å®ç°æ•°æ®åº“çš„åˆ‡æ¢ï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥å®Œæˆæ•°æ®åº“çš„åˆ‡æ¢äº†</li></ul><pre><code>package com.mysql.jdbc;import java.sql.SQLException;public class Driver extends NonRegisteringDriver implements java.sql.Driver {  static {    try {      java.sql.DriverManager.registerDriver(new Driver());    } catch (SQLException E) {      throw new RuntimeException(&quot;Can&#39;t register driver!&quot;);    }  }  /**   * Construct a new driver and register it with DriverManager   * @throws SQLException if a database error occurs.   */  public Driver() throws SQLException {    // Required for Class.forName().newInstance()  }}</code></pre><ul><li>åœ¨æ‰§è¡Œ<code>Class.forName</code>çš„æ—¶å€™ï¼Œé¦–å…ˆæ˜¯ä½¿å¾—JVMæŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„Driverç±»ï¼Œ</li><li>å…¶æ¬¡æ˜¯æ‰§è¡Œè¯¥ç±»çš„é™æ€ä»£ç <ul><li>å®ä¾‹å˜é‡éœ€è¦åœ¨ç±»å®ä¾‹åŒ–ä»¥åæ‰èƒ½å­˜åœ¨</li><li>é™æ€å˜é‡æ˜¯è¯¥ç±»ç´ æœ‰å¯¹è±¡å…¬æœ‰çš„ï¼Œä¸éœ€è¦å®ä¾‹åŒ–å°±å·²ç»å­˜åœ¨äº†</li><li>é™æ€ä»£ç ä¼šåœ¨ç±»è¢«åŠ è½½çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</li></ul></li></ul><pre><code>public class DriverManager {  private final static CopyOnWriteArrayList&lt;DriverInfo&gt; registeredDrivers = new CopyOnWriteArrayList&lt;DriverInfo&gt;();  //...  static {    loadInitialDrivers();    println(&quot;JDBC DriverManager initialized&quot;);  }  //...  public static synchronized void registerDriver(java.sql.Driver driver) throws SQLException {    if (driver != null) {      registeredDrivers.addIfAbsent(new DriverInfo(driver));    } else {      throw new NullPointerException();    }  }  public static Connection getConnection(String url, String user, String password) throws SQLException {    java.util.Properties info = new java.util.Properties();    if (user != null) {      info.put(&quot;user&quot;, user);    }    if (password != null) {      info.put(&quot;password&quot;, password);    }    return (getConnection(url, info, Reflection.getCallerClass()));  }  //...}</code></pre><ul><li>JDBCæœ¬èº«ç›¸å½“äºæŠ½è±¡ï¼Œå³å’Œå…·ä½“çš„æ•°æ®åº“æ— å…³çš„è¢«æŠ½è±¡å‡ºæ¥çš„ä¸€å¥—ç±»åº“</li><li>å…·ä½“çš„Driverç›¸å½“äºå®ç°</li></ul><h2 id="1-2-å®ä¾‹"><a href="#1-2-å®ä¾‹" class="headerlink" title="1.2 å®ä¾‹"></a>1.2 å®ä¾‹</h2><p>è®¾è®¡ä¸€ä¸ªæ ¹æ®ä¸åŒçš„å‘Šè­¦è§„åˆ™ï¼Œè§¦å‘ä¸åŒçš„ç±»å‹çš„å‘Šè­¦ã€‚</p><ul><li><p>ç´§æ€¥ç¨‹åº¦</p><ul><li>SEVERE</li><li>URGENCY</li><li>NORMAL</li><li>TRIVIAL</li></ul></li><li><p>é€šçŸ¥æ¸ é“</p><ul><li>é‚®ä»¶</li><li>çŸ­ä¿¡</li><li>å¾®ä¿¡</li><li>è‡ªåŠ¨è¯­éŸ³é€šè¯</li></ul></li><li><p>ä¸‹è¿°ä»£ç å®è´¨ä¸Šå°±æ˜¯åœ¨å®ç°ä¸€ä¸ªè§£è€¦ï¼Œå¸Œæœ›é¿å…å¤æ‚çš„if elseé€»è¾‘ï¼Œè®©ä»£ç æ›´æ˜“æ‡‚ï¼Œä¿®æ”¹æ›´æ–¹ä¾¿ã€‚</p></li></ul><pre><code>public interface MsgSender {  void send(String message);}public class TelephoneMsgSender implements MsgSender {  private List&lt;String&gt; telephones;  public TelephoneMsgSender(List&lt;String&gt; telephones) {    this.telephones = telephones;  }  @Override  public void send(String message) {    //...  }}public class EmailMsgSender implements MsgSender {  // ä¸TelephoneMsgSenderä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...}public class WechatMsgSender implements MsgSender {  // ä¸TelephoneMsgSenderä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...}public abstract class Notification {  protected MsgSender msgSender;  public Notification(MsgSender msgSender) {    this.msgSender = msgSender;  }  public abstract void notify(String message);}public class SevereNotification extends Notification {  public SevereNotification(MsgSender msgSender) {    super(msgSender);  }  @Override  public void notify(String message) {    msgSender.send(message);  }}public class UrgencyNotification extends Notification {  // ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...}public class NormalNotification extends Notification {  // ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...}public class TrivialNotification extends Notification {  // ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¡¥æ¥æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹-ä»£ç†æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>ç»“æ„å‹æ¨¡å¼ä¸»è¦æ€»ç»“äº†ä¸€äº›ç±»å’Œå¯¹è±¡ç»„åˆåœ¨ä¸€èµ·çš„ç»å…¸ç»“æ„ï¼Œè¿™äº›ç»å…¸çš„ç»“æ„å¯ä»¥è§£å†³ç‰¹å®šåº”ç”¨åœºæ™¯çš„é—®é¢˜ã€‚ç»“æ„å‹æ¨¡å¼åŒ…æ‹¬ï¼š</p><ul><li>ä»£ç†æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>è£…é¥°å™¨æ¨¡å¼</li><li>é€‚é…å™¨æ¨¡å¼</li><li>é—¨é¢æ¨¡å¼</li><li>ç»„åˆæ¨¡å¼</li><li>äº«å…ƒæ¨¡å¼</li></ul><h1 id="1-ä»£ç†æ¨¡å¼åŸç†è§£æ"><a href="#1-ä»£ç†æ¨¡å¼åŸç†è§£æ" class="headerlink" title="1. ä»£ç†æ¨¡å¼åŸç†è§£æ"></a>1. ä»£ç†æ¨¡å¼åŸç†è§£æ</h1><ul><li>ä»£ç†æ¨¡å¼ Proxy Design Pattern <ul><li>åœ¨ä¸æ”¹å˜åŸå§‹ç±»ï¼ˆè¢«ä»£ç†ç±»ï¼‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¼•å…¥ä»£ç†ç±»æ¥ç»™åŸå§‹ç±»é™„åŠ åŠŸèƒ½</li></ul></li></ul><ul><li><p>ä¸‹è¿°æ˜¯å®ç°MetricsCollectorçš„åˆå§‹æƒ³æ³•</p><ul><li><p>æ¡†æ¶ä»£ç å’Œä¸šåŠ¡ä»£ç è€¦åˆåº¦å¤ªé«˜ï¼ŒåæœŸç»´æŠ¤æˆ–è€…æ¡†æ¶çš„æ›´æ¢ä»£ä»·éƒ½ä¼šå¾ˆå¤§</p></li><li><p>ä¸šåŠ¡ç±»èŒè´£æœ€å¥½å•ä¸€ï¼Œåªèšç„¦ä¸šåŠ¡å¤„ç†</p><p>// Original idea for metricsCollector<br>public class UserController {<br>//â€¦çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•â€¦<br>private MetricsCollector metricsCollector; // ä¾èµ–æ³¨å…¥</p><p>public UserVo login(String telephone, String password) {<br>  long startTimestamp = System.currentTimeMillis();</p><p>  // â€¦ çœç•¥loginé€»è¾‘â€¦</p><p>  long endTimeStamp = System.currentTimeMillis();<br>  long responseTime = endTimeStamp - startTimestamp;<br>  RequestInfo requestInfo = new RequestInfo(â€œloginâ€, responseTime, startTimestamp);<br>  metricsCollector.recordRequest(requestInfo);</p><p>  //â€¦è¿”å›UserVoæ•°æ®â€¦<br>}</p><p>public UserVo register(String telephone, String password) {<br>  long startTimestamp = System.currentTimeMillis();</p><p>  // â€¦ çœç•¥registeré€»è¾‘â€¦</p><p>  long endTimeStamp = System.currentTimeMillis();<br>  long responseTime = endTimeStamp - startTimestamp;<br>  RequestInfo requestInfo = new RequestInfo(â€œregisterâ€, responseTime, startTimestamp);<br>  metricsCollector.recordRequest(requestInfo);</p><p>  //â€¦è¿”å›UserVoæ•°æ®â€¦<br>}<br>}</p></li></ul></li></ul><ul><li>æ„å»ºä»£ç†ç±»UserControllerProxy<ul><li>ä»£ç†ç±»UserCOntrollerProxyå’ŒåŸå§‹ç±»UserControllerå®ç°ç›¸åŒçš„æ¥å£IUserControllerã€‚UserControlleråªè´Ÿè´£ä¸šåŠ¡åŠŸèƒ½ï¼Œä»£ç†ç±»UserControllerProxyè´Ÿè´£åœ¨ä¸šåŠ¡ä»£ç æ‰§è¡Œå‰åé™„åŠ å…¶ä»–é€»è¾‘ä»£ç ï¼Œå¹¶é€šè¿‡å§”æ‰˜çš„æ–¹å¼æ¥è°ƒç”¨åŸå§‹ç±»æ‰§è¡Œä¸šåŠ¡ä»£ç ã€‚</li></ul></li></ul><pre><code>    public interface IUserController {      UserVo login(String telephone, String password);      UserVo register(String telephone, String password);    }    public class UserController implements IUserController {      //...çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...      @Override      public UserVo login(String telephone, String password) {        //...çœç•¥loginé€»è¾‘...        //...è¿”å›UserVoæ•°æ®...      }      @Override      public UserVo register(String telephone, String password) {        //...çœç•¥registeré€»è¾‘...        //...è¿”å›UserVoæ•°æ®...      }    }    public class UserControllerProxy implements IUserController {      private MetricsCollector metricsCollector;      private UserController userController;      public UserControllerProxy(UserController userController) {        this.userController = userController;        this.metricsCollector = new MetricsCollector();      }      @Override      public UserVo login(String telephone, String password) {        long startTimestamp = System.currentTimeMillis();        // å§”æ‰˜        UserVo userVo = userController.login(telephone, password);        long endTimeStamp = System.currentTimeMillis();        long responseTime = endTimeStamp - startTimestamp;        RequestInfo requestInfo = new RequestInfo(&quot;login&quot;, responseTime, startTimestamp);        metricsCollector.recordRequest(requestInfo);        return userVo;      }      @Override      public UserVo register(String telephone, String password) {        long startTimestamp = System.currentTimeMillis();        UserVo userVo = userController.register(telephone, password);        long endTimeStamp = System.currentTimeMillis();        long responseTime = endTimeStamp - startTimestamp;        RequestInfo requestInfo = new RequestInfo(&quot;register&quot;, responseTime, startTimestamp);        metricsCollector.recordRequest(requestInfo);        return userVo;      }    }    //UserControllerProxyä½¿ç”¨ä¸¾ä¾‹    //å› ä¸ºåŸå§‹ç±»å’Œä»£ç†ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼Œæ˜¯åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹    //å°†UserControllerç±»å¯¹è±¡æ›¿æ¢ä¸ºUserControllerProxyç±»å¯¹è±¡ï¼Œä¸éœ€è¦æ”¹åŠ¨å¤ªå¤šä»£ç     IUserController userController = new UserControllerProxy(new UserController());</code></pre><ul><li>é¢å¯¹åŸå§‹ç±»æ— æ¥å£ï¼Œæˆ–è€…å±äºå…¶ä»–serviceæ— æ³•åšæ”¹åŠ¨çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç»§æ‰¿ï¼Œæ¥å¯¹å…¶è¿›è¡Œæ‰©å±•</li></ul><pre><code>public class UserControllerProxy extends UserController {  private MetricsCollector metricsCollector;  public UserControllerProxy() {    this.metricsCollector = new MetricsCollector();  }  public UserVo login(String telephone, String password) {    long startTimestamp = System.currentTimeMillis();    UserVo userVo = super.login(telephone, password);    long endTimeStamp = System.currentTimeMillis();    long responseTime = endTimeStamp - startTimestamp;    RequestInfo requestInfo = new RequestInfo(&quot;login&quot;, responseTime, startTimestamp);    metricsCollector.recordRequest(requestInfo);    return userVo;  }  public UserVo register(String telephone, String password) {    long startTimestamp = System.currentTimeMillis();    UserVo userVo = super.register(telephone, password);    long endTimeStamp = System.currentTimeMillis();    long responseTime = endTimeStamp - startTimestamp;    RequestInfo requestInfo = new RequestInfo(&quot;register&quot;, responseTime, startTimestamp);    metricsCollector.recordRequest(requestInfo);    return userVo;  }}//UserControllerProxyä½¿ç”¨ä¸¾ä¾‹UserController userController = new UserControllerProxy();</code></pre><h1 id="2-åŠ¨æ€ä»£ç†åŸç†è§£æ"><a href="#2-åŠ¨æ€ä»£ç†åŸç†è§£æ" class="headerlink" title="2. åŠ¨æ€ä»£ç†åŸç†è§£æ"></a>2. åŠ¨æ€ä»£ç†åŸç†è§£æ</h1><p>ä»£ç†ç±»çš„å®ç°éœ€è¦å°†åŸå§‹ç±»å½“ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½å®ç°ä¸€éï¼Œå¹¶åŠ ä¸Šä½ éœ€è¦çš„ä»£ç é€»è¾‘ï¼Œè¿™æ ·åšä¼šåˆ›å»ºå¤§é‡çš„ä»£ç†ç±»ï¼Œå¾ˆéº»çƒ¦ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŠ¨æ€ä»£ç†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå³æˆ‘ä»¬ä¸äº‹å…ˆä¸ºæ¯ä¸ªåŸå§‹ç±»ç¼–å†™ä»£ç†ç±»ï¼Œè€Œæ˜¯åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ¨æ€çš„åˆ›å»ºåŸå§‹ç±»å¯¹åº”çš„ä»£ç†ç±»ï¼Œç„¶ååœ¨ç³»ç»Ÿå½“ä¸­ç”¨ä»£ç†ç±»æ›¿æ¢æ‰åŸå§‹ç±»ã€‚</p><p>Javaæœ¬èº«ç”¨åå°„è¯­æ³•æ¥å®ç°åŠ¨æ€ä»£ç†ã€‚</p><pre><code>public class MetricsCollectorProxy {  private MetricsCollector metricsCollector;  public MetricsCollectorProxy() {    this.metricsCollector = new MetricsCollector();  }  public Object createProxy(Object proxiedObject) {    Class&lt;?&gt;[] interfaces = proxiedObject.getClass().getInterfaces();    DynamicProxyHandler handler = new DynamicProxyHandler(proxiedObject);    return Proxy.newProxyInstance(proxiedObject.getClass().getClassLoader(), interfaces, handler);  }  private class DynamicProxyHandler implements InvocationHandler {    private Object proxiedObject;    public DynamicProxyHandler(Object proxiedObject) {      this.proxiedObject = proxiedObject;    }    @Override    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {      long startTimestamp = System.currentTimeMillis();      Object result = method.invoke(proxiedObject, args);      long endTimeStamp = System.currentTimeMillis();      long responseTime = endTimeStamp - startTimestamp;      String apiName = proxiedObject.getClass().getName() + &quot;:&quot; + method.getName();      RequestInfo requestInfo = new RequestInfo(apiName, responseTime, startTimestamp);      metricsCollector.recordRequest(requestInfo);      return result;    }  }}//MetricsCollectorProxyä½¿ç”¨ä¸¾ä¾‹MetricsCollectorProxy proxy = new MetricsCollectorProxy();IUserController userController = (IUserController) proxy.createProxy(new UserController());</code></pre><ul><li><p>InvocationHandler </p><ul><li>javaçš„æ ‡å‡†æ¥å£</li></ul></li><li><p>åˆ›å»ºProxy å®ä¾‹</p><ul><li>Proxy.newProxyInstance(classLoader, class, handlerClass)</li></ul></li><li><p>Springçš„AOPçš„å®ç°åŸç†å°±æ˜¯åŸºäºåŠ¨æ€ä»£ç†ã€‚ç”¨æˆ·é…ç½®å¥½éœ€è¦ç»™å“ªäº›ç±»åˆ›å»ºä»£ç†ï¼Œå¹¶å®šä¹‰å¥½åœ¨æ‰§è¡ŒåŸå§‹ç±»çš„ä¸šåŠ¡ä»£ç å‰åæ‰§è¡Œå“ªäº›é™„åŠ åŠŸèƒ½ã€Springä¸ºè¿™äº›ç±»åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨JVMä¸­æ›¿ä»£åŸå§‹ç±»å¯¹è±¡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ç°äº†ç»™åŸå§‹ç±»æ·»åŠ é™„åŠ åŠŸèƒ½çš„ç›®çš„ã€‚</p><h1 id="3-ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#3-ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="3. ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>3. ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h1></li><li><p>ä¸šåŠ¡ç³»ç»Ÿä¸­çš„éåŠŸèƒ½æ€§éœ€æ±‚çš„å¼€å‘</p><ul><li>ç›‘æ§</li><li>ç»Ÿè®¡</li><li>é‰´æƒ</li><li>é™æµ</li><li>äº‹åŠ¡</li><li>å¹‚ç­‰</li><li>æ—¥å¿—</li></ul></li><li><p>åœ¨RPCï¼Œç¼“å­˜ä¸­çš„åº”ç”¨</p><ul><li>RPCå°†ç½‘ç»œé€šä¿¡ï¼Œæ•°æ®ç¼–è§£ç çš„ç»†èŠ‚éšè—èµ·æ¥</li><li>AOPåˆ‡é¢å®Œæˆæ¥å£ç¼“å­˜çš„åŠŸèƒ½</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.baeldung.com/java-dynamic-proxies" target="_blank" rel="noopener">https://www.baeldung.com/java-dynamic-proxies</a></li><li><a href="https://time.geekbang.org/column/article/201823" target="_blank" rel="noopener">https://time.geekbang.org/column/article/201823</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç†æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹-åŸå‹æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼"><a href="#1-ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼" class="headerlink" title="1. ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼"></a>1. ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼</h1><p>å¦‚æœè¯´å¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§ï¼Œå¹¶ä¸”åŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¹‹é—´çš„å·®åˆ«ä¸å¤§ï¼ˆå¤§éƒ¨åˆ†å­—æ®µéƒ½ç›¸åŒï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¯¹å·²æœ‰å¯¹è±¡(åŸå‹)è¿›è¡Œå¤åˆ¶/æ‹·è´çš„æ–¹å¼æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œæ¥è¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚</p><ul><li>å¦‚ä½•ç†è§£å¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§<ul><li>æ¯”å¦‚å¯¹è±¡å½“ä¸­çš„æ•°æ®éœ€è¦ç»è¿‡å¤æ‚çš„è®¡ç®—æ‰èƒ½å¾—åˆ°ï¼ˆæ’åºï¼Œå“ˆå¸Œï¼‰</li><li>éœ€è¦IOè¯»å–</li></ul></li></ul><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ï¼Œä»å…¶ä»–å·²æœ‰å¯¹è±¡å½“ä¸­ç›´æ¥æ‹·è´ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œé‡å¤æ‰§è¡Œè¿™ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œã€‚</p><h1 id="2-å¦‚ä½•ä½¿ç”¨åŸå‹æ¨¡å¼"><a href="#2-å¦‚ä½•ä½¿ç”¨åŸå‹æ¨¡å¼" class="headerlink" title="2.å¦‚ä½•ä½¿ç”¨åŸå‹æ¨¡å¼"></a>2.å¦‚ä½•ä½¿ç”¨åŸå‹æ¨¡å¼</h1><h2 id="2-1-å®é™…åœºæ™¯æ¡ˆä¾‹"><a href="#2-1-å®é™…åœºæ™¯æ¡ˆä¾‹" class="headerlink" title="2.1 å®é™…åœºæ™¯æ¡ˆä¾‹"></a>2.1 å®é™…åœºæ™¯æ¡ˆä¾‹</h2><ul><li><p>æ•°æ®åº“ å­˜å‚¨10ä¸‡æ¡æœç´¢å…³é”®è¯ä¿¡æ¯</p><ul><li><p>åŒ…å«å…³é”®è¯ï¼Œå…³é”®è¯è¢«æœç´¢æ¬¡æ•°ï¼Œä¿¡æ¯æœ€è¿‘è¢«æ›´æ–°çš„æ—¶é—´</p></li><li><p>ç³»ç»ŸAå¯åŠ¨çš„æ—¶å€™ä¼šåŠ è½½è¿™ä»½æ•°æ®åˆ°å†…å­˜å½“ä¸­ï¼Œç”¨äºå¤„ç†æŸäº›å…¶ä»–çš„ä¸šåŠ¡éœ€æ±‚</p></li><li><p>æ„å»ºæ•£åˆ—è¡¨ç´¢å¼• â€“ hashmap</p><ul><li>keyä¸ºæœç´¢å…³é”®è¯</li><li>valueä¸ºå…³é”®è¯çš„è¯¦ç»†ä¿¡æ¯</li></ul></li><li><p>ç³»ç»ŸBåˆ†ææœç´¢æ—¥å¿—ï¼Œæ¯éš”10åˆ†é’Ÿå°±æ‰¹é‡æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºæ–°çš„æ•°æ®ç‰ˆæœ¬</p></li><li><p>ç³»ç»ŸAéœ€è¦å®šæœŸæ ¹æ®æ•°æ®åº“çš„æ•°æ®æ›´æ–°å†…å­˜ä¸­çš„ç´¢å¼•å’Œæ•°æ®</p></li></ul></li></ul><h2 id="2-2-æ ¹æ®éœ€æ±‚çš„è¿­ä»£"><a href="#2-2-æ ¹æ®éœ€æ±‚çš„è¿­ä»£" class="headerlink" title="2.2 æ ¹æ®éœ€æ±‚çš„è¿­ä»£"></a>2.2 æ ¹æ®éœ€æ±‚çš„è¿­ä»£</h2><ul><li>åœ¨ç³»ç»ŸAä¸­è®°å½•æ›´æ–°æ—¶é—´ï¼Œåœ¨æ•°æ®åº“ä¸­æ‹¿å‡ºæ›´æ–°æ—¶é—´å¤§äºç³»ç»ŸAå½“ä¸­çš„æœç´¢å…³é”®è¯ï¼Œç„¶åé’ˆå¯¹å·®é›†ä¸­çš„æ¯ä¸ªå…³é”®è¯è¿›è¡Œå¤„ç†</li><li>å¦‚æœåœ¨æ•£åˆ—è¡¨ä¸­äº†ï¼Œæ›´æ–°ç›¸åº”çš„æœç´¢æ¬¡æ•°ï¼Œæ›´æ–°æ—¶é—´ç­‰</li><li>å¦‚æœä¸åœ¨ï¼Œæ’å…¥æ•£åˆ—è¡¨å½“ä¸­</li></ul><pre><code>public class Demo {  private ConcurrentHashMap&lt;String, SearchWord&gt; currentKeywords = new ConcurrentHashMap&lt;&gt;();  private long lastUpdateTime = -1;  public void refresh() {    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°currentKeywordsä¸­    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);    long maxNewUpdatedTime = lastUpdateTime;    for (SearchWord searchWord : toBeUpdatedSearchWords) {      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {        maxNewUpdatedTime = searchWord.getLastUpdateTime();      }      if (currentKeywords.containsKey(searchWord.getKeyword())) {        currentKeywords.replace(searchWord.getKeyword(), searchWord);      } else {        currentKeywords.put(searchWord.getKeyword(), searchWord);      }    }    lastUpdateTime = maxNewUpdatedTime;  }  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®    return null;  }}</code></pre><ul><li>å¦‚æœéœ€è¦ä»»ä½•æ—¶åˆ»ç³»ç»ŸAä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„</li><li>æ›´æ–°å†…å­˜æ•°æ®çš„æ—¶å€™ï¼Œç³»ç»ŸAä¸èƒ½å¤„äºä¸å¯ç”¨çš„çŠ¶æ€ï¼Œä¸èƒ½åœæœºæ›´æ–°æ•°æ®<ul><li>é’ˆå¯¹éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å‡ºäº†æ­£åœ¨ä½¿ç”¨çš„æœåŠ¡ç‰ˆæœ¬ä¹‹å¤–ï¼Œåˆ›å»ºå¦å¤–ä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚å½“æ–°çš„ç‰ˆæœ¬æ•°æ®å»ºå¥½ä¹‹åï¼Œå†ä¸€æ¬¡æ€§åœ°å°†æœåŠ¡ç‰ˆæœ¬è¿›è¡Œåˆ‡æ¢</li><li>å¯ä»¥ä¿è¯æ•°æ®ä¸€ç›´å¯ç”¨ï¼Œå¹¶ä¸”é¿å…ä¸­é—´çŠ¶æ€çš„å­˜åœ¨</li></ul></li></ul><pre><code>public class Demo {  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();  public void refresh() {    HashMap&lt;String, SearchWord&gt; newKeywords = new LinkedHashMap&lt;&gt;();    // ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords();    for (SearchWord searchWord : toBeUpdatedSearchWords) {      newKeywords.put(searchWord.getKeyword(), searchWord);    }    currentKeywords = newKeywords;  }  private List&lt;SearchWord&gt; getSearchWords() {    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®    return null;  }}</code></pre><ul><li>æ–°æ•°æ®ç»“æ„çš„æ„å»ºæˆæœ¬éå¸¸é«˜ï¼Œéœ€è¦IOè¯»å‡ºæ•°æ®åº“ï¼Œè®¡ç®—å“ˆå¸Œå€¼ï¼Œæ„å»ºnewKeywords</li><li>æˆ‘ä»¬å¯ä»¥æ‹·è´å½“å‰çš„ç‰ˆæœ¬åˆ°æ–°çš„å¾…å¤„ç†çš„æ•£åˆ—è¡¨å½“ä¸­ï¼Œç„¶åä»æ•°æ®åº“å½“ä¸­æ‹¿å‡ºæ–°å¢æˆ–è€…æœ‰æ›´æ–°çš„å…³é”®è¯ï¼Œæ¥åšæ›´æ–°</li></ul><pre><code>public class Demo {  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();  private long lastUpdateTime = -1;  public void refresh() {    // åŸå‹æ¨¡å¼å°±è¿™ä¹ˆç®€å•ï¼Œæ‹·è´å·²æœ‰å¯¹è±¡çš„æ•°æ®ï¼Œæ›´æ–°å°‘é‡å·®å€¼    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);    long maxNewUpdatedTime = lastUpdateTime;    for (SearchWord searchWord : toBeUpdatedSearchWords) {      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {        maxNewUpdatedTime = searchWord.getLastUpdateTime();      }      if (newKeywords.containsKey(searchWord.getKeyword())) {        SearchWord oldSearchWord = newKeywords.get(searchWord.getKeyword());        oldSearchWord.setCount(searchWord.getCount());        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());      } else {        newKeywords.put(searchWord.getKeyword(), searchWord);      }    }    lastUpdateTime = maxNewUpdatedTime;    currentKeywords = newKeywords;  }  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®    return null;  }}</code></pre><ul><li>ä¸Šè¿°ä»£ç åšçš„æ˜¯æµ…æ‹·è´ï¼Œå› ä¸ºåœ¨æ•£åˆ—è¡¨å½“ä¸­ï¼Œkeyå­˜çš„æ˜¯æœç´¢å…³é”®è¯ï¼Œè€Œvalueå®é™…ä¸Šå­˜å‚¨çš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€</li><li>å½“æˆ‘ä»¬åšæµ…æ‹·è´çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯æŠŠå†…å­˜åœ°å€ç»™æ‹·è´äº†è¿‡æ¥ï¼›è¿™æ ·çš„è¯å½“æˆ‘ä»¬åšä¿®æ”¹çš„è¯ï¼Œå®é™…ä¸Šä¸¤ä¸ªç‰ˆæœ¬çš„æ•°æ®éƒ½åšäº†å˜åŠ¨ï¼Œå¹¶æ²¡æœ‰å°†å…¶å½»åº•çš„åˆ†å‰²å¼€</li><li>æˆ‘ä»¬å®é™…éœ€è¦çš„æ˜¯æ·±æ‹·è´ï¼Œå³ä¸ä»…ä»…å¤åˆ¶ç´¢å¼•ï¼Œå¹¶ä¸”å¤åˆ¶æ•°æ®æœ¬èº«<ul><li>é€’å½’æ‹·è´å¯¹è±¡ï¼Œå¯¹è±¡çš„å¼•ç”¨å¯¹è±¡ä»¥åŠå¼•ç”¨å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡</li><li>å…ˆå°†å¯¹è±¡åºåˆ—åŒ–ï¼Œå†ååºåˆ—åŒ–æˆæ–°å¯¹è±¡</li></ul></li></ul><pre><code>// å®ç°é€’å½’æ·±æ‹·è´public class Demo {  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();  private long lastUpdateTime = -1;  public void refresh() {    // Deep copy    HashMap&lt;String, SearchWord&gt; newKeywords = new HashMap&lt;&gt;();    for (HashMap.Entry&lt;String, SearchWord&gt; e : currentKeywords.entrySet()) {      SearchWord searchWord = e.getValue();      SearchWord newSearchWord = new SearchWord(              searchWord.getKeyword(), searchWord.getCount(), searchWord.getLastUpdateTime());      newKeywords.put(e.getKey(), newSearchWord);    }    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);    long maxNewUpdatedTime = lastUpdateTime;    for (SearchWord searchWord : toBeUpdatedSearchWords) {      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {        maxNewUpdatedTime = searchWord.getLastUpdateTime();      }      if (newKeywords.containsKey(searchWord.getKeyword())) {        SearchWord oldSearchWord = newKeywords.get(searchWord.getKeyword());        oldSearchWord.setCount(searchWord.getCount());        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());      } else {        newKeywords.put(searchWord.getKeyword(), searchWord);      }    }    lastUpdateTime = maxNewUpdatedTime;    currentKeywords = newKeywords;  }  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®    return null;  }}// å®ç°é€’å½’æ·±æ‹·è´public Object deepCopy(Object object) {  ByteArrayOutputStream bo = new ByteArrayOutputStream();  ObjectOutputStream oo = new ObjectOutputStream(bo);  oo.writeObject(object);  ByteArrayInputStream bi = new ByteArrayInputStream(bo.toByteArray());  ObjectInputStream oi = new ObjectInputStream(bi);  return oi.readObject();}</code></pre><ul><li>æœ€å¿«çš„æ–¹å¼ï¼Œæ˜¯å¯ä»¥å…ˆç”¨æµ…æ‹·è´æ¥åˆ›å»ºï¼Œå¯¹äºéœ€è¦æ›´æ–°çš„å¯¹è±¡ï¼Œå†ç”¨æ·±æ‹·è´çš„æ–¹å¼åˆ›å»ºä¸€ä»½æ–°çš„å¯¹è±¡ï¼Œæ¥åšæ›¿æ¢</li></ul><pre><code>public class Demo {  private HashMap&lt;String, SearchWord&gt; currentKeywords=new HashMap&lt;&gt;();  private long lastUpdateTime = -1;  public void refresh() {    // Shallow copy    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();    // ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);    long maxNewUpdatedTime = lastUpdateTime;    for (SearchWord searchWord : toBeUpdatedSearchWords) {      if (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) {        maxNewUpdatedTime = searchWord.getLastUpdateTime();      }      if (newKeywords.containsKey(searchWord.getKeyword())) {        newKeywords.remove(searchWord.getKeyword());      }      newKeywords.put(searchWord.getKeyword(), searchWord);    }    lastUpdateTime = maxNewUpdatedTime;    currentKeywords = newKeywords;  }  private List&lt;SearchWord&gt; getSearchWords(long lastUpdateTime) {    // TODO: ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®    return null;  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸå‹æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹-å»ºé€ è€…æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼"></a>1. ä¸ºä»€ä¹ˆéœ€è¦å»ºé€ è€…æ¨¡å¼</h1><p>ä¸€ä¸ªå…³äºå¦‚ä½•ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„é—®é¢˜æ˜¯ï¼šå½“æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ„é€ å‡½æ•°æˆ–è€…ä½¿ç”¨setæ–¹æ³•å°±èƒ½å¤Ÿåˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šéœ€è¦å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå‘¢ï¼Ÿ </p><p>ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œå…¶å¤§éƒ¨åˆ†çš„å±æ€§éƒ½æ˜¯å¯ä»¥é€‰æ‹©çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ¥åšå¦‚ä¸‹çš„å£°æ˜ï¼š </p><pre><code>public class ResourcePoolConfig {  private static final int DEFAULT_MAX_TOTAL = 8;  private static final int DEFAULT_MAX_IDLE = 8;  private static final int DEFAULT_MIN_IDLE = 0;  private String name;  private int maxTotal = DEFAULT_MAX_TOTAL;  private int maxIdle = DEFAULT_MAX_IDLE;  private int minIdle = DEFAULT_MIN_IDLE;  public ResourcePoolConfig(String name, Integer maxTotal, Integer maxIdle, Integer minIdle) {    if (StringUtils.isBlank(name)) {      throw new IllegalArgumentException(&quot;name should not be empty.&quot;);    }    this.name = name;    if (maxTotal != null) {      if (maxTotal &lt;= 0) {        throw new IllegalArgumentException(&quot;maxTotal should be positive.&quot;);      }      this.maxTotal = maxTotal;    }    if (maxIdle != null) {      if (maxIdle &lt; 0) {        throw new IllegalArgumentException(&quot;maxIdle should not be negative.&quot;);      }      this.maxIdle = maxIdle;    }    if (minIdle != null) {      if (minIdle &lt; 0) {        throw new IllegalArgumentException(&quot;minIdle should not be negative.&quot;);      }      this.minIdle = minIdle;    }  }  //...çœç•¥getteræ–¹æ³•...}</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­å½“ä¸­ï¼Œé™¤äº†nameä»¥å¤–çš„æ‰€æœ‰é€‰é¡¹éƒ½æ˜¯å¯é€‰çš„ï¼Œå› æ­¤ä¼šçœ‹åˆ°åœ¨æ„é€ å‡½æ•°å½“ä¸­ï¼Œæˆ‘ä»¬åšäº†å¾ˆå¤šçš„null checkã€‚è¿™æ ·åšå½“å‚æ•°å¾ˆå¤šçš„æ—¶å€™ï¼Œæ˜¯å¾ˆéš¾çœ‹æ‡‚çš„ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶æ”¹è‰¯ä¸ºä¸€ç³»åˆ—çš„set()å‡½æ•°ï¼Œæ„é€ å‡½æ•°åªå®ä¾‹åŒ–NonNullçš„å‚æ•°ï¼Œå¯¹äºNullableçš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨setæ–¹æ³•æ¥å®ç°å£°æ˜ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š </p><pre><code>public class ResourcePoolConfig {  private static final int DEFAULT_MAX_TOTAL = 8;  private static final int DEFAULT_MAX_IDLE = 8;  private static final int DEFAULT_MIN_IDLE = 0;  private String name;  private int maxTotal = DEFAULT_MAX_TOTAL;  private int maxIdle = DEFAULT_MAX_IDLE;  private int minIdle = DEFAULT_MIN_IDLE;  public ResourcePoolConfig(String name) {    if (StringUtils.isBlank(name)) {      throw new IllegalArgumentException(&quot;name should not be empty.&quot;);    }    this.name = name;  }  public void setMaxTotal(int maxTotal) {    if (maxTotal &lt;= 0) {      throw new IllegalArgumentException(&quot;maxTotal should be positive.&quot;);    }    this.maxTotal = maxTotal;  }  public void setMaxIdle(int maxIdle) {    if (maxIdle &lt; 0) {      throw new IllegalArgumentException(&quot;maxIdle should not be negative.&quot;);    }    this.maxIdle = maxIdle;  }  public void setMinIdle(int minIdle) {    if (minIdle &lt; 0) {      throw new IllegalArgumentException(&quot;minIdle should not be negative.&quot;);    }    this.minIdle = minIdle;  }  //...çœç•¥getteræ–¹æ³•...}</code></pre><p>ä¸Šè¿°çš„setæ–¹æ³•è¿˜æ˜¯æœ‰ä¸€äº›ç¼ºé™·çš„ï¼Œå³ï¼š</p><ul><li>é¦–å…ˆå¦‚æœå¿…å¡«çš„é…ç½®é¡¹æœ‰å¾ˆå¤šï¼Œä¸”éƒ½éœ€è¦æ”¾ç½®åˆ°æ„é€ å‡½æ•°å½“ä¸­ï¼Œé‚£æ„é€ å‡½æ•°å°±ä¼šå‡ºç°å‚æ•°åˆ—è¡¨å¾ˆé•¿çš„é—®é¢˜äº†ã€‚</li><li>å‡è®¾é…ç½®é¡¹ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬éœ€è¦å°†é…ç½®é¡¹ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œæ ¡éªŒé€»è¾‘æ‰¾åœ°æ–¹æ”¾</li><li>å¦‚æœæˆ‘ä»¬å¸Œæœ›ç±»å¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œå³å¯¹è±¡åœ¨åˆ›å»ºå¥½ä¹‹åå°±ä¸èƒ½å†ä¿®æ”¹å†…éƒ¨çš„å±æ€§å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½å†ResourcePoolConfigç±»å½“ä¸­æš´éœ²set()æ–¹æ³•</li></ul><p>Builderæ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³ä¸Šè¿°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ¡éªŒé€»è¾‘æ”¾åœ¨è°ƒç”¨build()æ–¹æ³•ä¹‹å‰ï¼Œä¹Ÿå¯ä»¥å°†æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡å»ºé€ è€…æ¥åˆ›å»ºResourcePoolConfigç±»å¯¹è±¡</p><h1 id="2-å¦‚ä½•ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ„å»ºå¯¹è±¡"><a href="#2-å¦‚ä½•ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ„å»ºå¯¹è±¡" class="headerlink" title="2. å¦‚ä½•ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ„å»ºå¯¹è±¡"></a>2. å¦‚ä½•ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ„å»ºå¯¹è±¡</h1><pre><code>public class ResourcePoolConfig {  private String name;  private int maxTotal;  private int maxIdle;  private int minIdle;  private ResourcePoolConfig(Builder builder) {    this.name = builder.name;    this.maxTotal = builder.maxTotal;    this.maxIdle = builder.maxIdle;    this.minIdle = builder.minIdle;  }  //...çœç•¥getteræ–¹æ³•...  //æˆ‘ä»¬å°†Builderç±»è®¾è®¡æˆäº†ResourcePoolConfigçš„å†…éƒ¨ç±»ã€‚  //æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Builderç±»è®¾è®¡æˆç‹¬ç«‹çš„éå†…éƒ¨ç±»ResourcePoolConfigBuilderã€‚  public static class Builder {    private static final int DEFAULT_MAX_TOTAL = 8;    private static final int DEFAULT_MAX_IDLE = 8;    private static final int DEFAULT_MIN_IDLE = 0;    private String name;    private int maxTotal = DEFAULT_MAX_TOTAL;    private int maxIdle = DEFAULT_MAX_IDLE;    private int minIdle = DEFAULT_MIN_IDLE;    public ResourcePoolConfig build() {      // æ ¡éªŒé€»è¾‘æ”¾åˆ°è¿™é‡Œæ¥åšï¼ŒåŒ…æ‹¬å¿…å¡«é¡¹æ ¡éªŒã€ä¾èµ–å…³ç³»æ ¡éªŒã€çº¦æŸæ¡ä»¶æ ¡éªŒç­‰      if (StringUtils.isBlank(name)) {        throw new IllegalArgumentException(&quot;...&quot;);      }      if (maxIdle &gt; maxTotal) {        throw new IllegalArgumentException(&quot;...&quot;);      }      if (minIdle &gt; maxTotal || minIdle &gt; maxIdle) {        throw new IllegalArgumentException(&quot;...&quot;);      }      return new ResourcePoolConfig(this);    }    public Builder setName(String name) {      if (StringUtils.isBlank(name)) {        throw new IllegalArgumentException(&quot;...&quot;);      }      this.name = name;      return this;    }    public Builder setMaxTotal(int maxTotal) {      if (maxTotal &lt;= 0) {        throw new IllegalArgumentException(&quot;...&quot;);      }      this.maxTotal = maxTotal;      return this;    }    public Builder setMaxIdle(int maxIdle) {      if (maxIdle &lt; 0) {        throw new IllegalArgumentException(&quot;...&quot;);      }      this.maxIdle = maxIdle;      return this;    }    public Builder setMinIdle(int minIdle) {      if (minIdle &lt; 0) {        throw new IllegalArgumentException(&quot;...&quot;);      }      this.minIdle = minIdle;      return this;    }  }}// è¿™æ®µä»£ç ä¼šæŠ›å‡ºIllegalArgumentExceptionï¼Œå› ä¸ºminIdle&gt;maxIdleResourcePoolConfig config = new ResourcePoolConfig.Builder()        .setName(&quot;dbconnectionpool&quot;)        .setMaxTotal(16)        .setMaxIdle(10)        .setMinIdle(12)        .build();</code></pre><h1 id="3-ä½•æ—¶ä½¿ç”¨"><a href="#3-ä½•æ—¶ä½¿ç”¨" class="headerlink" title="3. ä½•æ—¶ä½¿ç”¨"></a>3. ä½•æ—¶ä½¿ç”¨</h1><p>å»ºé€ è€…æ¨¡å¼ç”¨æ¥åˆ›å»ºä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œå®šåˆ¶åŒ–åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«å¯ä»¥ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼Œé¡¾å®¢èµ°è¿›ä¸€å®¶é¤é¦†ç‚¹é¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å‚æ¨¡å¼ï¼Œæ ¹æ®ç”¨æˆ·ä¸åŒçš„é€‰æ‹©ï¼Œæ¥åˆ¶ä½œä¸åŒçš„é£Ÿç‰©ï¼Œæ¯”å¦‚æŠ«è¨ã€æ±‰å ¡ã€æ²™æ‹‰ã€‚å¯¹äºæŠ«è¨æ¥è¯´ï¼Œç”¨æˆ·åˆæœ‰å„ç§é…æ–™å¯ä»¥å®šåˆ¶ï¼Œæ¯”å¦‚å¥¶é…ªã€è¥¿çº¢æŸ¿ã€èµ·å¸ï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ä¸åŒé…æ–™æ¥åˆ¶ä½œæŠ«è¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å»ºé€ è€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹-å·¥å‚æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ç®€å•å·¥å‚-Simple-Factory"><a href="#1-ç®€å•å·¥å‚-Simple-Factory" class="headerlink" title="1. ç®€å•å·¥å‚ Simple Factory"></a>1. ç®€å•å·¥å‚ Simple Factory</h1><p>å‡è®¾è¦åšä¸€ä¸ªparserç±»ï¼Œæ ¹æ®åç¼€æ¥å®ä¾‹åŒ–Parser</p><pre><code>public class RuleConfigSource {  public RuleConfig load(String ruleConfigFilePath) {    String ruleConfigFileExtension = getFileExtension(ruleConfigFilePath);    IRuleConfigParser parser = RuleConfigParserFactory.createParser(ruleConfigFileExtension);    if (parser == null) {      throw new InvalidRuleConfigException(              &quot;Rule config file format is not supported: &quot; + ruleConfigFilePath);    }    String configText = &quot;&quot;;    //ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­    RuleConfig ruleConfig = parser.parse(configText);    return ruleConfig;  }  private String getFileExtension(String filePath) {    //...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json    return &quot;json&quot;;  }}public class RuleConfigParserFactory {  public static IRuleConfigParser createParser(String configFormat) {    IRuleConfigParser parser = null;    if (&quot;json&quot;.equalsIgnoreCase(configFormat)) {      parser = new JsonRuleConfigParser();    } else if (&quot;xml&quot;.equalsIgnoreCase(configFormat)) {      parser = new XmlRuleConfigParser();    } else if (&quot;yaml&quot;.equalsIgnoreCase(configFormat)) {      parser = new YamlRuleConfigParser();    } else if (&quot;properties&quot;.equalsIgnoreCase(configFormat)) {      parser = new PropertiesRuleConfigParser();    }    return parser;  }}</code></pre><p>ä¸Šè¿°ä»£ç æ˜¯åˆ›å»ºäº†å·¥å‚ç±»ï¼Œå¹¶ä¸”åœ¨å·¥å‚ç±»å½“ä¸­åˆ¶å®šäº†é™æ€æ–¹æ³•ï¼Œæ ¹æ®è¾“å…¥å‚æ•°çš„ä¸åŒæ¥åˆ†åˆ«å®ä¾‹åŒ–ä¸åŒçš„parserã€‚ä¸€èˆ¬æ¥è¯´å·¥å‚å½“ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•éƒ½æ˜¯createå¼€å¤´ï¼Œæˆ–è€…è¯´æ˜å¯¹äºinstanceçš„æ“ä½œï¼Œå¸¸è§çš„æ–¹æ³•åæ¯”å¦‚ï¼š</p><ul><li>createXXX()</li><li>getInstance()</li><li>createInstance()</li><li>newInstance() </li></ul><p>åŒæ ·ï¼Œå¦‚æœè¦å£°æ˜çš„ç±»æ—¶å¾ˆå¯èƒ½å¯ä»¥å¤ç”¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨è°ƒç”¨å‰å°±åˆ›å»ºå¥½ï¼Œæ¥èŠ‚çœå¯¹è±¡åˆ›å»ºçš„æ—¶é—´</p><pre><code>public class RuleConfigParserFactory {  private static final Map&lt;String, RuleConfigParser&gt; cachedParsers = new HashMap&lt;&gt;();  static {    cachedParsers.put(&quot;json&quot;, new JsonRuleConfigParser());    cachedParsers.put(&quot;xml&quot;, new XmlRuleConfigParser());    cachedParsers.put(&quot;yaml&quot;, new YamlRuleConfigParser());    cachedParsers.put(&quot;properties&quot;, new PropertiesRuleConfigParser());  }  public static IRuleConfigParser createParser(String configFormat) {    if (configFormat == null || configFormat.isEmpty()) {      return null;//è¿”å›nullè¿˜æ˜¯IllegalArgumentExceptionå…¨å‡­ä½ è‡ªå·±è¯´äº†ç®—    }    IRuleConfigParser parser = cachedParsers.get(configFormat.toLowerCase());    return parser;  }}</code></pre><h1 id="2-å·¥å‚æ–¹æ³•"><a href="#2-å·¥å‚æ–¹æ³•" class="headerlink" title="2. å·¥å‚æ–¹æ³•"></a>2. å·¥å‚æ–¹æ³•</h1><p>åˆ©ç”¨å¤šæ€å°†ifåˆ†æ”¯é€»è¾‘ç»™å»æ‰ï¼š </p><pre><code>public interface IRuleConfigParserFactory {  IRuleConfigParser createParser();}public class JsonRuleConfigParserFactory implements IRuleConfigParserFactory {  @Override  public IRuleConfigParser createParser() {    return new JsonRuleConfigParser();  }}public class XmlRuleConfigParserFactory implements IRuleConfigParserFactory {  @Override  public IRuleConfigParser createParser() {    return new XmlRuleConfigParser();  }}public class YamlRuleConfigParserFactory implements IRuleConfigParserFactory {  @Override  public IRuleConfigParser createParser() {    return new YamlRuleConfigParser();  }}public class PropertiesRuleConfigParserFactory implements IRuleConfigParserFactory {  @Override  public IRuleConfigParser createParser() {    return new PropertiesRuleConfigParser();  }}// å…³äºå¦‚ä½•é€‰å–éœ€è¦importçš„factoryï¼Œä½¿ç”¨hashmapï¼Œç›¸å½“äºä¸ºå·¥å‚ç±»åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„å·¥å‚ï¼›ä¸€ç§å§”æ‰˜ç»™åˆ«äººè¿›è¡Œç”Ÿäº§çš„æ¨¡å¼æ€è·¯public class RuleConfigSource {  public RuleConfig load(String ruleConfigFilePath) {    String ruleConfigFileExtension = getFileExtension(ruleConfigFilePath);    IRuleConfigParserFactory parserFactory = RuleConfigParserFactoryMap.getParserFactory(ruleConfigFileExtension);    if (parserFactory == null) {      throw new InvalidRuleConfigException(&quot;Rule config file format is not supported: &quot; + ruleConfigFilePath);    }    IRuleConfigParser parser = parserFactory.createParser();    String configText = &quot;&quot;;    //ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­    RuleConfig ruleConfig = parser.parse(configText);    return ruleConfig;  }  private String getFileExtension(String filePath) {    //...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json    return &quot;json&quot;;  }}//å› ä¸ºå·¥å‚ç±»åªåŒ…å«æ–¹æ³•ï¼Œä¸åŒ…å«æˆå‘˜å˜é‡ï¼Œå®Œå…¨å¯ä»¥å¤ç”¨ï¼Œ//ä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„å·¥å‚ç±»å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œç®€å•å·¥å‚æ¨¡å¼çš„ç¬¬äºŒç§å®ç°æ€è·¯æ›´åŠ åˆé€‚ã€‚public class RuleConfigParserFactoryMap { //å·¥å‚çš„å·¥å‚  private static final Map&lt;String, IRuleConfigParserFactory&gt; cachedFactories = new HashMap&lt;&gt;();  static {    cachedFactories.put(&quot;json&quot;, new JsonRuleConfigParserFactory());    cachedFactories.put(&quot;xml&quot;, new XmlRuleConfigParserFactory());    cachedFactories.put(&quot;yaml&quot;, new YamlRuleConfigParserFactory());    cachedFactories.put(&quot;properties&quot;, new PropertiesRuleConfigParserFactory());  }  public static IRuleConfigParserFactory getParserFactory(String type) {    if (type == null || type.isEmpty()) {      return null;    }    IRuleConfigParserFactory parserFactory = cachedFactories.get(type.toLowerCase());    return parserFactory;  }}</code></pre><h2 id="2-1-å·¥å‚æ¨¡å¼çš„å¥½å¤„"><a href="#2-1-å·¥å‚æ¨¡å¼çš„å¥½å¤„" class="headerlink" title="2.1 å·¥å‚æ¨¡å¼çš„å¥½å¤„"></a>2.1 å·¥å‚æ¨¡å¼çš„å¥½å¤„</h2><ul><li>å·¥ç¨‹ä¸Šä¸€èˆ¬æ¥è¯´ä½¿ç”¨å·¥å‚æ¨¡å¼å¯ä»¥å‡å°‘if elseçš„ä½¿ç”¨ï¼Œå‡å°‘å¯¹äºä»£ç çš„ä¾µå…¥ï¼Œå¯ä»¥é€šè¿‡åå°„æ¥åŠ¨æ€è·å–Bean </li><li><code>AbstractCart cart = (AbstractCart) applicationContext.getBean(userCategory + &quot;UserCart&quot;); return cart.process(userId, items);}</code></li></ul><h1 id="3-Dependency-Injection-æ¡†æ¶"><a href="#3-Dependency-Injection-æ¡†æ¶" class="headerlink" title="3. Dependency Injection æ¡†æ¶"></a>3. Dependency Injection æ¡†æ¶</h1><p>ä¾èµ–æ³¨å…¥æ¡†æ¶æƒ³è¦è§£å†³çš„æ˜¯åœ¨åŸºäºInversion of controlçš„ç†å¿µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•åšï¼Œå¦‚ä½•ç®€åŒ–æ•´ä¸ªåˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p>DIå®¹å™¨åº•å±‚æœ€åŸºæœ¬çš„è®¾è®¡æ€è·¯æ˜¯åŸºäºå·¥å‚æ¨¡å¼æ¥è¿›è¡Œçš„ï¼ŒDIå®¹å™¨å°±ç›¸å½“äºä¸€ä¸ªå¤§çš„å·¥å‚ç±»ï¼Œå¤æ‚åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œæ ¹æ®é…ç½®ï¼ˆéœ€è¦åˆ›å»ºå“ªäº›ç±»å¯¹è±¡ï¼Œæ¯ä¸ªç±»å¯¹è±¡çš„åˆ›å»ºéœ€è¦ä¾èµ–å“ªäº›å…¶ä»–ç±»çš„å¯¹è±¡ï¼‰äº‹å…ˆåˆ›å»ºå¥½å¯¹è±¡ã€‚å½“åº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨æŸä¸ªç±»å¯¹è±¡çš„æ—¶å€™ï¼Œç›´æ¥ä»å®¹å™¨å½“ä¸­è·å–å³å¯ã€‚</p><p>DIå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½ä¸»è¦æœ‰ï¼š</p><ul><li>é…ç½®è§£æ</li><li>å¯¹è±¡åˆ›å»º</li><li>å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†</li></ul><h2 id="3-1-é…ç½®è§£æ"><a href="#3-1-é…ç½®è§£æ" class="headerlink" title="3.1 é…ç½®è§£æ"></a>3.1 é…ç½®è§£æ</h2><p>åº”ç”¨éœ€è¦å‘ŠçŸ¥DIå®¹å™¨éœ€è¦åˆ›å»ºå“ªäº›å¯¹è±¡ï¼Œéœ€è¦å°†ç”±DIå®¹å™¨æ¥åˆ›å»ºçš„ç±»å¯¹è±¡å’Œåˆ›å»ºç±»å¯¹è±¡çš„å¿…è¦ä¿¡æ¯ï¼Œæ”¾åˆ°é…ç½®æ–‡ä»¶å½“ä¸­ã€‚å®¹å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æä¾›çš„ä¿¡æ¯æ¥åˆ›å»ºå¯¹è±¡ã€‚åƒåœ¨springå½“ä¸­ï¼Œå°±æ˜¯ä¾é xmlæ–‡ä»¶æˆ–è€…æ³¨è§£ï¼Œæ¥å‘Šè¯‰spring ç”¨ä½•ç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><h2 id="3-2-å¯¹è±¡åˆ›å»º"><a href="#3-2-å¯¹è±¡åˆ›å»º" class="headerlink" title="3.2 å¯¹è±¡åˆ›å»º"></a>3.2 å¯¹è±¡åˆ›å»º</h2><p>Springå½“ä¸­å°†æ‰€æœ‰ç±»å¯¹è±¡çš„åˆ›å»ºéƒ½æ”¾åˆ°äº†ä¸€ä¸ªå·¥å‚ç±»å½“ä¸­å®ç°</p><h2 id="3-3-å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†"><a href="#3-3-å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†" class="headerlink" title="3.3 å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†"></a>3.3 å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†</h2><ul><li><p>é€šè¿‡é…ç½®scopeå±æ€§ï¼Œå†³å®šæ˜¯æ¯æ¬¡éƒ½è¿”å›ä¸€ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡è¿˜æ˜¯æ¯æ¬¡éƒ½è¿”å›ä¸€ä¸ªäº‹å…ˆåˆ›å»ºå¥½çš„å¯¹è±¡ â€“ å•ä¾‹å¯¹è±¡</p></li><li><p>é…ç½®æ˜¯å¦æ‡’åŠ è½½ï¼›lazy-init</p><ul><li>çœŸæ­£è¢«ä½¿ç”¨çš„æ—¶å€™è¢«åˆ›å»º</li><li>åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™å°±äº‹å…ˆåˆ›å»ºå¥½</li></ul></li><li><p>é…ç½®å¯¹è±¡çš„init-method, destroy-method </p><ul><li>DIå®¹å™¨åœ¨åˆ›å»ºå¥½å¯¹è±¡ä¹‹åï¼Œä¼šä¸»åŠ¨è°ƒç”¨init-methodå±æ€§æŒ‡å®šçš„æ–¹æ³•æ¥åˆå§‹åŒ–å¯¹è±¡</li><li>åœ¨å¯¹è±¡è¢«æœ€ç»ˆé”€æ¯ä¹‹å‰ï¼ŒDIå®¹å™¨ä¼šä¸»åŠ¨è°ƒç”¨destroy-methodå±æ€§æŒ‡å®šçš„æ–¹æ³•æ¥åšä¸€äº›æ¸…ç†å·¥ä½œ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å‚æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€ç»´æ¨¡å‹çš„æœé›†/æ•´ç†</title>
      <link href="/%E6%80%9D%E7%BB%B4%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%90%9C%E9%9B%86-%E6%95%B4%E7%90%86/"/>
      <url>/%E6%80%9D%E7%BB%B4%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%90%9C%E9%9B%86-%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>çœ‹åˆ°äº†Adam Amrançš„<a href="https://untools.co/ï¼Œæ„Ÿè§‰æ˜¯æœ‰ä¸€äº›å…ƒçŸ¥è¯†æ˜¯è¡ç”Ÿçš„æ ¹æœ¬ï¼Œå¸Œæœ›èƒ½å¤Ÿç”¨è¿™ç¯‡blogä½œä¸ºæ€»ç»“åˆ†äº«çš„é›†æ•£åœ°ï¼ŒæŠŠè‡ªå·±çœ‹åˆ°çš„è®¤ä¸ºåœ¨æŸäº›æ–¹é¢æœ‰å®é™…æ•ˆç”¨çš„æ€ç»´æ¨¡å‹åˆ†äº«ç»™å¤§å®¶ã€‚" target="_blank" rel="noopener">https://untools.co/ï¼Œæ„Ÿè§‰æ˜¯æœ‰ä¸€äº›å…ƒçŸ¥è¯†æ˜¯è¡ç”Ÿçš„æ ¹æœ¬ï¼Œå¸Œæœ›èƒ½å¤Ÿç”¨è¿™ç¯‡blogä½œä¸ºæ€»ç»“åˆ†äº«çš„é›†æ•£åœ°ï¼ŒæŠŠè‡ªå·±çœ‹åˆ°çš„è®¤ä¸ºåœ¨æŸäº›æ–¹é¢æœ‰å®é™…æ•ˆç”¨çš„æ€ç»´æ¨¡å‹åˆ†äº«ç»™å¤§å®¶ã€‚</a></p><h1 id="1-é—®é¢˜æ ‘-Issue-Tree"><a href="#1-é—®é¢˜æ ‘-Issue-Tree" class="headerlink" title="1. é—®é¢˜æ ‘ - Issue Tree"></a>1. é—®é¢˜æ ‘ - <a href="https://untools.co/issue-trees" target="_blank" rel="noopener">Issue Tree</a></h1><h2 id="1-1-æ˜¯ä»€ä¹ˆ"><a href="#1-1-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1.1 æ˜¯ä»€ä¹ˆ"></a>1.1 æ˜¯ä»€ä¹ˆ</h2><ul><li>ä¸€ä¸ªé—®é¢˜åœ°å›¾</li><li>æ—¨åœ¨ç»™ä½ éœ€è¦è§£å†³çš„é—®é¢˜ä¸€ä¸ªæ¸…æ™°è€Œç³»ç»Ÿçš„æ€è€ƒæ–¹å¼</li><li>å¸®åŠ©ä½ å¯¹é—®é¢˜è¿›è¡Œæ‹†åˆ†ï¼Œå…¶å®å¾ˆç¬¦åˆdivide and conquer å³åˆ†æ²»çš„æ€æƒ³</li></ul><p>å¯¹è‡ªå·±è€Œè¨€ï¼Œç¡®å®æœ‰åœ¨åšï¼Œåœ¨æ€è€ƒã€‚å€¼å¾—æ³¨æ„ä¸”éœ€è¦åŠ å¼ºçš„ä¸€ç‚¹æ˜¯MECEåŸåˆ™ â€“ mutually exclusive, collectively exhaustiveã€‚ å¯¹æé«˜æ€ç»´çš„å®Œå¤‡æ€§å¾ˆæœ‰ä½œç”¨</p><h2 id="1-2-æ€ä¹ˆåš"><a href="#1-2-æ€ä¹ˆåš" class="headerlink" title="1.2 æ€ä¹ˆåš"></a>1.2 æ€ä¹ˆåš</h2><ul><li><p>é—®é¢˜æ ‘åº”è¯¥èƒ½å¤Ÿè¦†ç›–æ‰€æœ‰çš„é—®é¢˜ï¼Œéœ€è¦éå¸¸ç»†è‡´</p></li><li><p>ä¸€äº›éœ€è¦éµå¾ªçš„åŸåˆ™</p><ul><li><p><strong>MECE - mutually exclusive, collectively exhaustive</strong> </p><ul><li><strong>éœ€è¦åšåˆ°ç›¸äº’ä¹‹é—´æ²¡æœ‰äº¤é›†ï¼Œå¹¶é›†å³ä¸ºå…¨é›†</strong></li></ul></li><li><p>ä¸è¦è¿‡åº¦çº ç»“äºå¤ªå°çš„ç»†èŠ‚ï¼Œéœ€è¦å…ˆåšå¤§ç±»ç›®çš„åˆ’åˆ†ï¼Œæ¥å®šä¹‰é—®é¢˜</p></li><li><p>äºŒå…«æ³•åˆ™ï¼Œä¸“æ³¨äºèµ·äºæ•°æ®çš„æœ‰ä»·å€¼çš„é—®é¢˜</p></li></ul></li></ul><h1 id="2-Second-order-thinking"><a href="#2-Second-order-thinking" class="headerlink" title="2. Second-order thinking"></a>2. <a href="https://untools.co/second-order-thinking" target="_blank" rel="noopener">Second-order thinking</a></h1><h2 id="2-1-Overview"><a href="#2-1-Overview" class="headerlink" title="2.1 Overview"></a>2.1 Overview</h2><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬ä¸‹çš„å†³å®šçœ‹èµ·æ¥ç›´è§‚ä¸Šä¼šç»™æˆ‘ä»¬å¸¦æ¥å¥½å¤„ï¼Œä½†æ˜¯é•¿è¿œçœ‹æ¥æ˜¯å¯¹æˆ‘ä»¬ä¸åˆ©çš„ã€‚æˆ‘ä»¬é€šå¸¸çš„æ€è€ƒé“¾æ¡æ˜¯ éœ€æ±‚ - è®¾å®šæ–¹æ¡ˆ - è¯„ä¼°æ–¹æ¡ˆ - æ‰§è¡Œã€‚å…¶å®å¤§åˆ°å…¬å¸çš„é¡¹ç›®ï¼Œå°åˆ°æ™šä¸Šåƒä»€ä¹ˆï¼Œæˆ‘ä»¬çš„è„‘æµ·é‡Œéƒ½ä¼šå…ˆç»™å‡ºéœ€æ±‚ï¼Œé¥¿äº†ï¼Œéœ€è¦åƒé¥­ã€‚åˆ°è®¾å®šæ–¹æ¡ˆï¼Œåœ¨å®¶åƒvså‡ºå»åƒï¼Œç„¶åæ˜¯åƒä»€ä¹ˆï¼Œç„¶ååšå‡ºå†³å®šï¼Œå¹¶ä¸”æŒ‰ç…§å†³å®šæ¥æ‰§è¡Œã€‚</p><p>è¿™ç§æ€è€ƒæ–¹å¼å¸Œæœ›ä½ åšçš„æ˜¯åœ¨è¦åšå‡ºå†³å®šçš„æ—¶å€™ï¼Œåœ¨æƒ³äº†å†³å®šçš„ç›´æ¥å½±å“ä¹‹åã€‚å†å¤šé—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼Œå³ â€“ ç„¶åå‘¢ï¼Ÿ è¿™ä¸ªå†³å®šåç»­è¿˜ä¼šå¸¦æ¥ä»€ä¹ˆç»“æœå‘¢ï¼Ÿ </p><p><strong>ä»äº‹æƒ…å‘å±•çš„é˜¶æ®µæ¥çœ‹ï¼Œæ€è€ƒäºŒåº¦çš„å‘å±•ï¼›ä¹Ÿå¯ä»¥ä»æ—¶é—´ç»´åº¦ï¼Œå»æ€è€ƒåšå‡ºçš„å†³å®šåœ¨æ¥ä¸‹æ¥å‡ å¤©ï¼Œå‡ ä¸ªæœˆï¼Œç”šè‡³ç›¸å¯¹æ›´é•¿çš„æ—¶é—´é‡Œå¯èƒ½å¯¹ä½ å¸¦æ¥çš„å½±å“ã€‚</strong></p><h1 id="3-ç¬¬ä¸€æ€§åŸç†"><a href="#3-ç¬¬ä¸€æ€§åŸç†" class="headerlink" title="3. ç¬¬ä¸€æ€§åŸç†"></a>3. ç¬¬ä¸€æ€§åŸç†</h1><p>åœ¨æ¯ä¸€ç§ç³»ç»Ÿçš„æ¢ç´¢å½“ä¸­ï¼Œå­˜åœ¨ç¬¬ä¸€æ€§åŸç†ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„å‘½é¢˜æˆ–å‡è®¾ï¼Œä¸èƒ½è¢«å¿½ç•¥æˆ–åˆ é™¤ï¼Œä¹Ÿä¸èƒ½è¢«è¿åã€‚</p><p>é¦–å…ˆæ˜¯å½’çº³æ³•ä¸æ¼”ç»æ³•çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬ç”Ÿæ´»ä¸­æœ€ç»å¸¸ä½¿ç”¨çš„æ˜¯å½’çº³æ³•ï¼Œå³æ ¹æ®ç»éªŒï¼Œç°è±¡åˆ°ç»“æœçš„é“¾æ¡æ¥æ€»ç»“äº‹æƒ…æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼›è€Œæ¼”ç»æ³•æ˜¯åŸºäºä¸€äº›å…ƒçŸ¥è¯†ï¼Œåšå‡ºè‡ªå·±çš„æ¨è®ºã€‚</p><p>ç¬¬ä¸€æ€§åŸç† â€“ First Principleï¼Œè¯´çš„å°±æ˜¯ä¸èƒ½è¢«çœç•¥ï¼Œä¸èƒ½è¢«åˆ é™¤ï¼Œä¸èƒ½è¿åçš„æœ€åŸºæœ¬çš„å‘½é¢˜æˆ–å‡è®¾ã€‚æ˜¯æ¼”ç»æ³•çš„ä¸€ç§ï¼Œå³ä»æ ¹æœ¬åŸç†ä¸Šï¼Œå‰”é™¤å¹²æ‰°å› ç´ å’Œå¸¸è¯†æ€§çŸ¥è¯†çš„æ€è€ƒæ–¹æ³•ã€‚ç›®çš„æ˜¯å¸Œæœ›èƒ½å¤Ÿå°†äººä»é”™ç»¼å¤æ‚çš„ç°å®é—®é¢˜ä¸­æ¢ä¸€ä¸ªè§†è§’ï¼Œå°†å¤æ‚çš„äº‹æƒ…åŠªåŠ›è½¬åŒ–ä¸ºç®€å•çš„ç»“æ„ï¼Œæ¥ä»æºå¤´ä¸Šç†è§£ã€‚</p><p>â€œæˆ‘ä»¬è¿ç”¨ç¬¬ä¸€æ€§åŸç†ï¼Œè€Œä¸æ˜¯æ¯”è¾ƒæ€ç»´å»æ€è€ƒé—®é¢˜æ˜¯éå¸¸é‡è¦çš„ã€‚æˆ‘ä»¬åœ¨ç”Ÿæ´»ä¸­æ€»æ˜¯å€¾å‘äºæ¯”è¾ƒï¼Œå¯¹åˆ«äººå·²ç»åšè¿‡æˆ–è€…æ­£åœ¨åšçš„äº‹æƒ…æˆ‘ä»¬ä¹Ÿéƒ½å»åšï¼Œè¿™æ ·å‘å±•çš„ç»“æœåªèƒ½äº§ç”Ÿç»†å°çš„è¿­ä»£å‘å±•ã€‚</p><p>ç¬¬ä¸€æ€§åŸç†çš„æ€æƒ³æ–¹å¼æ˜¯ç”¨ç‰©ç†å­¦çš„è§’åº¦çœ‹å¾…ä¸–ç•Œï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å±‚å±‚æ‹¨å¼€äº‹ç‰©è¡¨è±¡ï¼Œçœ‹åˆ°é‡Œé¢çš„æœ¬è´¨ï¼Œå†ä»æœ¬è´¨ä¸€å±‚å±‚å¾€ä¸Šèµ°ã€‚â€</p><h2 id="3-1-å¦‚ä½•ä½¿ç”¨ç¬¬ä¸€æ€§åŸç†"><a href="#3-1-å¦‚ä½•ä½¿ç”¨ç¬¬ä¸€æ€§åŸç†" class="headerlink" title="3.1 å¦‚ä½•ä½¿ç”¨ç¬¬ä¸€æ€§åŸç†"></a>3.1 å¦‚ä½•ä½¿ç”¨ç¬¬ä¸€æ€§åŸç†</h2><ul><li><p>è‹æ ¼æ‹‰åº•å¼çš„æé—®</p><ul><li>é—®é¢˜æºå¤´ï¼Œæºèµ·ï¼Œå…·ä½“è¡¨ç°å½¢å¼ï¼Ÿ</li><li>è¿™ä¸ªæƒ…å†µæ€»æ˜¯å‘ç”Ÿä¹ˆï¼Ÿä»€ä¹ˆå› ç´ ä¼šå¯¼è‡´é—®é¢˜å‡ºç°ï¼Ÿ</li><li>å‡è®¾çš„è¯æ®åœ¨å“ªé‡Œï¼Ÿæ˜¯å¦å¯é ï¼Ÿ</li><li>æ›¿ä»£è§‚ç‚¹å’Œè§’åº¦</li><li>å½±å“å’Œåæœ</li><li>å¯¹é—®é¢˜æœ¬èº«çš„è´¨ç–‘</li></ul></li><li><p>å®è·µè¿‡ç¨‹</p><ul><li>æº¯æº</li><li>æ‹†è§£</li><li>é‡æ„</li><li>è¿­ä»£</li></ul></li><li><p>æ¯”è¾ƒæ€ç»´ vs ç¬¬ä¸€æ€§åŸç†</p><ul><li>çœ‹èµ„è®¯</li><li>è‡ªå·±æ€»ç»“åˆ†ææƒ³æ³•</li></ul></li></ul><h1 id="4-æŠ½è±¡æ¢¯å­"><a href="#4-æŠ½è±¡æ¢¯å­" class="headerlink" title="4. æŠ½è±¡æ¢¯å­"></a>4. æŠ½è±¡æ¢¯å­</h1><p>é€šè¿‡åœ¨ä¸åŒçš„æŠ½è±¡å±‚çš„ç§»åŠ¨æ¥æ›´å¥½çš„æ„å»ºä½ çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å‘ä¸Šç§»åŠ¨ï¼Œä»æ›´å¤§çš„è§†è§’çœ‹é—®é¢˜ï¼Œçœ‹åˆ°æ ‘æœ¨èƒŒåçš„æ£®æ—ï¼›ä¹Ÿå¯ä»¥å‘ä¸‹ç§»åŠ¨ï¼Œæ¥æ¼”åŒ–å‡ºä¸€ä¸ªæ›´åŠ ç²¾ç»†çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="4-1-å¦‚ä½•ä½¿ç”¨"><a href="#4-1-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="4.1 å¦‚ä½•ä½¿ç”¨"></a>4.1 å¦‚ä½•ä½¿ç”¨</h2><ul><li>ä»ä¸€ä¸ªæ™®é€šçš„é—®é¢˜å¼€å§‹</li><li>é€šè¿‡é—®ä¸ºä»€ä¹ˆæ¥è·å¾—æ›´å¤§æ›´è¿œçš„è§†è§’</li><li>é€šè¿‡é—®å¦‚ä½•åšæ¥é€æ­¥è·å¾—ä¸€ä¸ªæ›´å…·ä½“çš„è§£å†³æ–¹æ¡ˆ</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://untools.co/issue-trees" target="_blank" rel="noopener">https://untools.co/issue-trees</a></li><li><a href="https://medium.com/@idtimw/%E6%80%9D%E7%BB%B4%E6%A8%A1%E5%9E%8B03-first-principles-%E7%AC%AC%E4%B8%80%E6%80%A7%E5%8E%9F%E7%90%86-7571fc664faf" target="_blank" rel="noopener">https://medium.com/@idtimw/%E6%80%9D%E7%BB%B4%E6%A8%A1%E5%9E%8B03-first-principles-%E7%AC%AC%E4%B8%80%E6%80%A7%E5%8E%9F%E7%90%86-7571fc664faf</a></li><li><a href="http://fund.jrj.com.cn/2018/06/04151524634381.shtml" target="_blank" rel="noopener">http://fund.jrj.com.cn/2018/06/04151524634381.shtml</a></li><li><a href="https://36kr.com/p/5068808" target="_blank" rel="noopener">https://36kr.com/p/5068808</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€ç»´æ¨¡å‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹æ¨¡å¼"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹æ¨¡å¼" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹æ¨¡å¼"></a>1. ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹æ¨¡å¼</h1><p>windowsç³»ç»Ÿçš„ä»»åŠ¡ç®¡ç†å™¨ï¼Œåªèƒ½æœ‰ä¸€ä¸ª,å”¯ä¸€æ€§çš„åŸå› ï¼š</p><ol><li>å¦‚æœèƒ½å¼¹å‡ºå¤šä¸ªçª—å£ï¼Œä¸”è¿™äº›çª—å£çš„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œå…¨éƒ½æ˜¯é‡å¤å¯¹è±¡ï¼Œé‚£åŠ¿å¿…ä¼šæµªè´¹èµ„æºï¼Œå°¤å…¶æ˜¯ä»»åŠ¡ç®¡ç†å™¨ä¼šéœ€è¦è¿›å…¥å†…æ ¸æ€è°ƒå–å„ç§çŠ¶æ€ä¿¡æ¯ï¼Œä¼šå¯¹æ€§èƒ½é€ æˆä¸€å®šçš„å½±å“ã€‚</li><li>è€Œä¸”å¤šä¸ªçª—å£ä¹‹é—´éœ€è¦ä¿æŒä¸€è‡´æ€§ï¼Œç»å¯¹çš„åŒæ­¥ï¼Œç›¸äº’ä¹‹é—´çš„åŒæ­¥ä¹Ÿæ˜¯èµ„æºçš„æµªè´¹ã€‚</li></ol><p>ç°å®ä¸­çš„ä¾‹å­ï¼Œå°±æ˜¯ä¸ºäº†èŠ‚çº¦ç³»ç»Ÿèµ„æºï¼Œæœ‰æ—¶éœ€è¦ç¡®ä¿ç³»ç»Ÿä¸­æŸä¸ªç±»åªæœ‰å”¯ä¸€ä¸€ä¸ªå®ä¾‹ï¼Œå½“è¿™ä¸ªå®ä¾‹åˆ›å»ºæˆåŠŸä»¥åï¼Œæˆ‘ä»¬æ— æ³•å†åˆ›å»ºä¸€ä¸ªåŒç±»å‹çš„å…¶ä»–å¯¹è±¡ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½åªèƒ½åŸºäºè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ã€‚</p><h2 id="1-1-å¤„ç†èµ„æºçš„è®¿é—®å†²çª"><a href="#1-1-å¤„ç†èµ„æºçš„è®¿é—®å†²çª" class="headerlink" title="1.1 å¤„ç†èµ„æºçš„è®¿é—®å†²çª"></a>1.1 å¤„ç†èµ„æºçš„è®¿é—®å†²çª</h2><p>ä¸‹è¿°ä»£ç è‡ªå®šä¹‰äº†ä¸€ä¸ªå¾€æ–‡ä»¶å½“ä¸­æ‰“å°æ—¥å¿—çš„loggerç±»ï¼š </p><pre><code>public class Logger {  private FileWriter writer;  public Logger() {    File file = new File(&quot;/Users/leilei/log.txt&quot;);    writer = new FileWriter(file, true); //trueè¡¨ç¤ºè¿½åŠ å†™å…¥  }  public void log(String message) {    writer.write(mesasge);  }}// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼špublic class UserController {  private Logger logger = new Logger();  public void login(String username, String password) {    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...    logger.log(username + &quot; logined!&quot;);  }}public class OrderController {  private Logger logger = new Logger();  public void create(OrderVo order) {    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...    logger.log(&quot;Created an order: &quot; + order.toString());  }}</code></pre><p>è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºæ¯ä¸ªç±»åœ¨å®ç°çš„è¿‡ç¨‹ä¸­éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Loggerå¯¹è±¡ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªcontrollerï¼Œç„¶åæ‰§è¡Œçš„è¯ï¼Œä¼šåŒæ—¶å†™å…¥åŒä¸€ä¸ªæ–‡ä»¶å½“ä¸­ï¼Œè¿™ä¼šæœ‰å¯èƒ½å¯¼è‡´æ—¥å¿—ä¿¡æ¯äº’ç›¸è¦†ç›–çš„æƒ…å†µã€‚</p><p>æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸Šç±»çº§åˆ«çš„é”ï¼Œè®©æ‰€æœ‰çš„å¯¹è±¡éƒ½èƒ½å¤Ÿå…±äº«ä¸€æŠŠé”ï¼š</p><pre><code>public class Logger {  private FileWriter writer;  public Logger() {    File file = new File(&quot;/Users/wangzheng/log.txt&quot;);    writer = new FileWriter(file, true); //trueè¡¨ç¤ºè¿½åŠ å†™å…¥  }  public void log(String message) {    synchronized(Logger.class) { // ç±»çº§åˆ«çš„é”      writer.write(mesasge);    }  }}</code></pre><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œä½¿å¾—ç¨‹åºå½“ä¸­åªå…è®¸åˆ›å»ºä¸€ä¸ªLoggerå¯¹è±¡ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å…±äº«è¿™ä¸€ä¸ªLoggerå¯¹è±¡ï¼Œå…±äº«ä¸€ä¸ªFileWriterå¯¹è±¡ï¼ˆæœ¬èº«æœ‰å¯¹è±¡çº§åˆ«çš„çº¿ç¨‹å®‰å…¨çš„ä¿éšœï¼‰</p><pre><code>public class Logger {  private FileWriter writer;  private static final Logger instance = new Logger();  private Logger() {    File file = new File(&quot;/Users/leilei/log.txt&quot;);    writer = new FileWriter(file, true); //trueè¡¨ç¤ºè¿½åŠ å†™å…¥  }  public static Logger getInstance() {    return instance;  }  public void log(String message) {    writer.write(mesasge);  }}// Loggerç±»çš„åº”ç”¨ç¤ºä¾‹ï¼špublic class UserController {  public void login(String username, String password) {    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...    Logger.getInstance().log(username + &quot; logined!&quot;);  }}public class OrderController {    public void create(OrderVo order) {    // ...çœç•¥ä¸šåŠ¡é€»è¾‘ä»£ç ...    Logger.getInstance().log(&quot;Created a order: &quot; + order.toString());  }}</code></pre><h2 id="1-2-è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»"><a href="#1-2-è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»" class="headerlink" title="1.2 è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»"></a>1.2 è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»</h2><p>å¯¹äºåªåº”è¯¥åœ¨ç³»ç»Ÿå½“ä¸­ä¿å­˜ä¸€ä»½çš„æ•°æ®ï¼Œæ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚</p><pre><code>import java.util.concurrent.atomic.AtomicLong;public class IdGenerator {  // AtomicLongæ˜¯ä¸€ä¸ªJavaå¹¶å‘åº“ä¸­æä¾›çš„ä¸€ä¸ªåŸå­å˜é‡ç±»å‹,  // å®ƒå°†ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨éœ€è¦åŠ é”çš„å¤åˆæ“ä½œå°è£…ä¸ºäº†çº¿ç¨‹å®‰å…¨çš„åŸå­æ“ä½œï¼Œ  // æ¯”å¦‚ä¸‹é¢ä¼šç”¨åˆ°çš„incrementAndGet().  private AtomicLong id = new AtomicLong(0);  private static final IdGenerator instance = new IdGenerator();  private IdGenerator() {}  public static IdGenerator getInstance() {    return instance;  }  public long getId() {     return id.incrementAndGet();  }}// IdGeneratorä½¿ç”¨ä¸¾ä¾‹long id = IdGenerator.getInstance().getId();</code></pre><h1 id="2-å•ä¾‹æ¨¡å¼æ¦‚è¿°"><a href="#2-å•ä¾‹æ¨¡å¼æ¦‚è¿°" class="headerlink" title="2. å•ä¾‹æ¨¡å¼æ¦‚è¿°"></a>2. å•ä¾‹æ¨¡å¼æ¦‚è¿°</h1><ul><li><p>å•ä¾‹çš„å®šä¹‰</p><ul><li>ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºå”¯ä¸€ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»</li></ul></li><li><p>å¯¹è±¡çš„å”¯ä¸€æ€§æŒ‡</p><ul><li>è¿›ç¨‹å†…åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡</li><li>è¿›ç¨‹ä¹‹é—´æ˜¯ä¸å”¯ä¸€çš„</li></ul></li></ul><h2 id="2-1-æ¨¡æ‹Ÿä»»åŠ¡ç®¡ç†ç±»"><a href="#2-1-æ¨¡æ‹Ÿä»»åŠ¡ç®¡ç†ç±»" class="headerlink" title="2.1 æ¨¡æ‹Ÿä»»åŠ¡ç®¡ç†ç±»"></a>2.1 æ¨¡æ‹Ÿä»»åŠ¡ç®¡ç†ç±»</h2><pre><code>class TaskManager{     public TaskManager() {...} //åˆå§‹åŒ–çª—å£     public void displayProcesses()  {â€¦â€¦} //æ˜¾ç¤ºè¿›ç¨‹     public void  displayServices() {â€¦â€¦} //æ˜¾ç¤ºæœåŠ¡}</code></pre><p>å¯¹å…¶è¿›è¡Œé‡æ„ï¼Œä¸ºäº†ä½¿å…¶æ˜¯å•ä¸€å®ä¾‹çš„ï¼Œé‚£æˆ‘ä»¬éœ€è¦ç¦æ­¢ç±»çš„å¤–éƒ¨ç›´æ¥ä½¿ç”¨newæ¥åˆ›å»ºå¯¹è±¡  â€”â€“&gt;  å°†å…¶æ„é€ å‡½æ•°çš„å¯è§æ€§å˜ä¸ºprivate</p><pre><code>public TaskManager() {...}</code></pre><p>åœ¨ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡ï¼Œä¿å­˜è¿™ä¸ªå”¯ä¸€å®ä¾‹</p><pre><code>private static TaskManager tm = null;public static TaskManager getInstance() {    if (tm == null) {        tm = new TaskManager();    }    return tm;}</code></pre><p><code>getInstance()</code>å®šä¹‰æˆä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥ä½¿ç”¨</p><h2 id="2-2-å®šä¹‰"><a href="#2-2-å®šä¹‰" class="headerlink" title="2.2 å®šä¹‰"></a>2.2 å®šä¹‰</h2><blockquote><p>å•ä¾‹æ¨¡å¼(Singleton Pattern)ï¼šç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªç±»ç§°ä¸ºå•ä¾‹ç±»ï¼Œå®ƒæä¾›å…¨å±€è®¿é—®çš„æ–¹æ³•ã€‚å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><ol><li>åªæœ‰ä¸€ä¸ªå®ä¾‹</li><li>å¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹</li><li>å¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹</li></ol><p><img src="https://i.loli.net/2020/02/03/vKPVAeCrImYXq1U.gif" alt="s1.gif"></p><h2 id="2-3-è´Ÿè½½å‡è¡¡å™¨çš„è®¾è®¡ä¸å®ç°"><a href="#2-3-è´Ÿè½½å‡è¡¡å™¨çš„è®¾è®¡ä¸å®ç°" class="headerlink" title="2.3 è´Ÿè½½å‡è¡¡å™¨çš„è®¾è®¡ä¸å®ç°"></a>2.3 è´Ÿè½½å‡è¡¡å™¨çš„è®¾è®¡ä¸å®ç°</h2><p> Sunnyè½¯ä»¶å…¬å¸æ‰¿æ¥äº†ä¸€ä¸ªæœåŠ¡å™¨è´Ÿè½½å‡è¡¡(Load Balance)è½¯ä»¶çš„å¼€å‘å·¥ä½œï¼Œè¯¥è½¯ä»¶è¿è¡Œåœ¨ä¸€å°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥å°†å¹¶å‘è®¿é—®å’Œæ•°æ®æµé‡åˆ†å‘åˆ°æœåŠ¡å™¨é›†ç¾¤ä¸­çš„å¤šå°è®¾å¤‡ä¸Šè¿›è¡Œå¹¶å‘å¤„ç†ï¼Œæé«˜ç³»ç»Ÿçš„æ•´ä½“å¤„ç†èƒ½åŠ›ï¼Œç¼©çŸ­å“åº”æ—¶é—´ã€‚ç”±äºé›†ç¾¤ä¸­çš„æœåŠ¡å™¨éœ€è¦åŠ¨æ€åˆ å‡ï¼Œä¸”å®¢æˆ·ç«¯è¯·æ±‚éœ€è¦ç»Ÿä¸€åˆ†å‘ï¼Œå› æ­¤éœ€è¦ç¡®ä¿è´Ÿè½½å‡è¡¡å™¨çš„å”¯ä¸€æ€§ï¼Œåªèƒ½æœ‰ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨æ¥è´Ÿè´£æœåŠ¡å™¨çš„ç®¡ç†å’Œè¯·æ±‚çš„åˆ†å‘ï¼Œå¦åˆ™å°†ä¼šå¸¦æ¥æœåŠ¡å™¨çŠ¶æ€çš„ä¸ä¸€è‡´ä»¥åŠè¯·æ±‚åˆ†é…å†²çªç­‰é—®é¢˜ã€‚å¦‚ä½•ç¡®ä¿è´Ÿè½½å‡è¡¡å™¨çš„å”¯ä¸€æ€§æ˜¯è¯¥è½¯ä»¶æˆåŠŸçš„å…³é”®ã€‚</p><p>ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥è®¾è®¡è¯¥è´Ÿè½½å‡è¡¡å™¨ï¼š </p><p><img src="https://i.loli.net/2020/02/03/4vJzXqlRCITLUge.gif" alt="s2.gif"></p><pre><code>import java.util.*;//è´Ÿè½½å‡è¡¡å™¨LoadBalancerï¼šå•ä¾‹ç±»ï¼ŒçœŸå®ç¯å¢ƒä¸‹è¯¥ç±»å°†éå¸¸å¤æ‚ï¼ŒåŒ…æ‹¬å¤§é‡åˆå§‹åŒ–çš„å·¥ä½œå’Œä¸šåŠ¡æ–¹æ³•ï¼Œè€ƒè™‘åˆ°ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç†è§£æ€§ï¼Œåªåˆ—å‡ºéƒ¨åˆ†ä¸æ¨¡å¼ç›¸å…³çš„æ ¸å¿ƒä»£ç class LoadBalancer {    //ç§æœ‰é™æ€æˆå‘˜å˜é‡ï¼Œå­˜å‚¨å”¯ä¸€å®ä¾‹    private static LoadBalancer instance = null;    //æœåŠ¡å™¨é›†åˆ    private List serverList = null;    //ç§æœ‰æ„é€ å‡½æ•°    private LoadBalancer() {        serverList = new ArrayList();    }    //å…¬æœ‰é™æ€æˆå‘˜æ–¹æ³•ï¼Œè¿”å›å”¯ä¸€å®ä¾‹    public static LoadBalancer getLoadBalancer() {        if (instance == null) {            instance = new LoadBalancer();        }        return instance;    }    //å¢åŠ æœåŠ¡å™¨    public void addServer(String server) {        serverList.add(server);    }    //åˆ é™¤æœåŠ¡å™¨    public void removeServer(String server) {        serverList.remove(server);    }    //ä½¿ç”¨Randomç±»éšæœºè·å–æœåŠ¡å™¨    public String getServer() {        Random random = new Random();        int i = random.nextInt(serverList.size());        return (String)serverList.get(i);    }}</code></pre><h1 id="3-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼å’Œæ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#3-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼å’Œæ‡’æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="3. é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼å’Œæ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"></a>3. é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼å’Œæ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</h1><h2 id="3-1-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#3-1-é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="3.1 é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"></a>3.1 é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</h2><p><img src="https://i.loli.net/2020/02/03/UAk8topvxWQTwfd.gif" alt="s3.gif"></p><pre><code>class EagerSingleton {     private static final EagerSingleton instance = new EagerSingleton();     private EagerSingleton() { }     public static EagerSingleton getInstance() {        return instance;     }   }</code></pre><p>åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œé™æ€å˜é‡instanceå°±ä¼šè¢«åˆå§‹åŒ–ï¼Œæ­¤æ—¶ç±»çš„ç§æœ‰æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œç„¶åå•ä¾‹ç±»çš„å”¯ä¸€å®ä¾‹ä¼šåœ¨è¿™ä¸ªæ—¶å€™è¢«åˆ›å»ºå‡ºæ¥ã€‚</p><p>æ¶æ±‰æ¨¡å¼çš„å¥½å¤„æ˜¯æ²¡æœ‰å»¶è¿ŸåŠ è½½ï¼Œè¿™æ ·å­æ˜¯åœ¨éœ€è¦ç”¨åˆ°å®ƒçš„æ—¶å€™æ‰æ¥æ‰§è¡Œè¿™ä¸ªè€—æ—¶é•¿çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå¯ä»¥é¿å…åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™æ‰åˆå§‹åŒ–å¯¼è‡´çš„æ–°è·Ÿé‚£ä¸ªé—®é¢˜ã€‚</p><h2 id="3-2-æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#3-2-æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="3.2 æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"></a>3.2 æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</h2><p><img src="https://i.loli.net/2020/02/03/bDLQtESdzF8Ugmq.gif" alt="s4.gif"></p><p>åœ¨ç¬¬ä¸€ä¸ªè°ƒç”¨getInstance()æ–¹æ³•çš„æ—¶å€™è¿›è¡Œå®ä¾‹åŒ–ã€‚åˆå«åšå»¶è¿ŸåŠ è½½æŠ€æœ¯â€”â€”åœ¨éœ€è¦çš„æ—¶å€™å†åŠ è½½å®ä¾‹ï¼Œä¸ºäº†é¿å…å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨getInstance()æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<strong><em>synchronizedå…³é”®å­—</em></strong>ï¼š</p><pre><code>class LazySingleton {     private static LazySingleton instance = null;     private LazySingleton() { }     synchronized public static LazySingleton getInstance() {         if (instance == null) {            instance = new LazySingleton();         }        return instance;     }}</code></pre><p>getInstance()æ–¹æ³•å¸¦é”ï¼Œå¹¶å‘åº¦å¾ˆä½ï¼Œå¦‚æœé¢‘ç¹è°ƒç”¨ï¼Œéœ€è¦é¢‘ç¹å¼€å…³é”çš„è¯ï¼Œæ•ˆç‡æ˜¯å¾ˆä½çš„ã€‚</p><h2 id="3-3-å…¼é¡¾æ•ˆç‡å’Œå®‰å…¨æ€§çš„æ–¹å¼-é¥±æ±‰-é¥¿æ±‰"><a href="#3-3-å…¼é¡¾æ•ˆç‡å’Œå®‰å…¨æ€§çš„æ–¹å¼-é¥±æ±‰-é¥¿æ±‰" class="headerlink" title="3.3 å…¼é¡¾æ•ˆç‡å’Œå®‰å…¨æ€§çš„æ–¹å¼(é¥±æ±‰+é¥¿æ±‰)"></a>3.3 å…¼é¡¾æ•ˆç‡å’Œå®‰å…¨æ€§çš„æ–¹å¼(é¥±æ±‰+é¥¿æ±‰)</h2><pre><code>class LazySingleton {     private static LazySingleton instanceï¼›     private LazySingleton() { }     public static LazySingleton getInstance() {         if (instance == null) {            synchronized(LazySingleton.class) {                instance = new LazySingleton();             }        }        return instance;     }}</code></pre><h2 id="3-4-ä½¿ç”¨é™æ€å†…éƒ¨ç±»"><a href="#3-4-ä½¿ç”¨é™æ€å†…éƒ¨ç±»" class="headerlink" title="3.4 ä½¿ç”¨é™æ€å†…éƒ¨ç±»"></a>3.4 ä½¿ç”¨é™æ€å†…éƒ¨ç±»</h2><p>åˆ©ç”¨Javaçš„é™æ€å†…éƒ¨ç±»ï¼Œå› ä¸ºé™æ€å†…éƒ¨ç±»åªæœ‰åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šè¢«åŠ è½½ã€‚è€Œé™æ€å†…éƒ¨ç±»çš„å”¯ä¸€æ€§ï¼Œçº¿ç¨‹å®‰å…¨å‹éƒ½ç”±JVMæ¥ä¿è¯ã€‚</p><p>public class LazySingleton {<br>    private static class LazySingletonHolder{<br>        private static final LazySingleton instance = new LazySingleton();<br>    }</p><pre><code>public static LazySingleton getInstance() {    return LazySingletonHolder.instance;}</code></pre><p>}</p><h1 id="4-å•ä¾‹çš„é—®é¢˜"><a href="#4-å•ä¾‹çš„é—®é¢˜" class="headerlink" title="4. å•ä¾‹çš„é—®é¢˜"></a>4. å•ä¾‹çš„é—®é¢˜</h1><ul><li>è¿èƒŒäº†åŸºäºæ¥å£è€Œéå®ç°çš„è®¾è®¡åŸåˆ™ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´æ”¹çš„è¯ï¼Œæ˜¯éœ€è¦åˆ°æ¯ä¸ªç±»çš„ä½ç½®å»åšæ›´æ”¹çš„</li><li>å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»<ul><li>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬é€šè¿‡æ„é€ å‡½æ•°ï¼Œå‚æ•°ä¼ é€’æ¥å£°æ˜ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</li><li>å•ä¾‹ä¸éœ€è¦æ˜¾ç¤ºåˆ›å»ºï¼Œä¸éœ€è¦ä¾èµ–å‚æ•°ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­ç›´æ¥è°ƒç”¨</li><li>å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½<h1 id="5-ä¼˜ç¼ºç‚¹åˆ†æ"><a href="#5-ä¼˜ç¼ºç‚¹åˆ†æ" class="headerlink" title="5. ä¼˜ç¼ºç‚¹åˆ†æ"></a>5. ä¼˜ç¼ºç‚¹åˆ†æ</h1></li></ul></li></ul><h2 id="5-1-ä¼˜ç‚¹"><a href="#5-1-ä¼˜ç‚¹" class="headerlink" title="5.1 ä¼˜ç‚¹"></a>5.1 ä¼˜ç‚¹</h2><ol><li>æä¾›äº†å¯¹å”¯ä¸€å®ä¾‹çš„è®¿é—®æ§åˆ¶</li><li>å› ä¸ºå†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥èŠ‚çº¦ç³»ç»Ÿèµ„æºã€‚å°¤å…¶æ˜¯å¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼Œå•ä¾‹æ¨¡å¼å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç³»ç»Ÿæ€§èƒ½</li></ol><h2 id="5-2-ç¼ºç‚¹"><a href="#5-2-ç¼ºç‚¹" class="headerlink" title="5.2 ç¼ºç‚¹"></a>5.2 ç¼ºç‚¹</h2><ol><li>æ‰©å±•å›°éš¾</li><li>èŒè´£ç›¸å¯¹æ¯”è¾ƒé‡ã€‚å› ä¸ºå•ä¾‹ç±»æ—¢å……å½“äº†å·¥å‚è§’è‰²ï¼Œæä¾›äº†å·¥å‚æ–¹æ³•ï¼ŒåŒæ—¶åˆå……å½“äº†äº§å“è§’è‰²ï¼ŒåŒ…å«ä¸€äº›ä¸šåŠ¡æ–¹æ³•ï¼Œå°†äº§å“çš„åˆ›å»ºå’Œäº§å“çš„æœ¬èº«çš„åŠŸèƒ½èåˆåˆ°ä¸€èµ·ã€‚</li><li>ä¸€äº›è¯­è¨€çš„åƒåœ¾è‡ªåŠ¨å›æ”¶æŠ€æœ¯ï¼Œå¦‚æœå®ä¾‹åŒ–çš„å¯¹è±¡åœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œç³»ç»Ÿä¼šè®¤ä¸ºå®ƒæ˜¯åƒåœ¾ï¼Œä¼šè‡ªåŠ¨é”€æ¯å¹¶å›æ”¶èµ„æºã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡åŸåˆ™ï¼Œç¼–ç¨‹è§„èŒƒçš„æ€»ç»“</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83%E7%9A%84%E6%80%BB%E7%BB%93/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83%E7%9A%84%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä½œä¸ºä¸€ä¸ªå¯¹äºæ•´ç†è¿‡çš„è®¾è®¡åŸåˆ™å’Œæ€æƒ³çš„æ€»ç»“ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>é¢å‘å¯¹è±¡<ul><li>å°è£…ã€ç»§æ‰¿ã€æŠ½è±¡ã€å¤šæ€</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹ vs é¢å‘è¿‡ç¨‹ç¼–ç¨‹</li><li>é¢å‘å¯¹è±¡åˆ†æã€è®¾è®¡ã€ç¼–ç¨‹</li><li>æ¥å£ vs æŠ½è±¡ç±»</li><li>åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹</li><li>å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿</li><li>è´«è¡€æ¨¡å¼ vs å……è¡€æ¨¡å¼ </li></ul></li><li>è®¾è®¡åŸåˆ™<ul><li>å•ä¸€èŒè´£åŸåˆ™</li><li>å¼€é—­åŸåˆ™</li><li>é‡Œæ°æ›¿æ¢åŸåˆ™</li><li>æ¥å£éš”ç¦»åŸåˆ™</li><li>ä¾èµ–å€’ç½®åŸåˆ™</li><li>DRY</li><li>KISS</li><li>YAGNI</li><li>LOD</li></ul></li><li>è§„èŒƒä¸é‡æ„<ul><li>ç›®çš„ï¼Œå¯¹è±¡ï¼Œæ—¶æœºï¼Œæ–¹æ³•</li><li>å•å…ƒæµ‹è¯•å’Œä»£ç çš„å¯æµ‹è¯•æ€§</li><li>å¤§é‡æ„</li><li>å°é‡æ„</li></ul></li></ul><h1 id="1-ä»£ç è´¨é‡çš„è¯„åˆ¤æ ‡å‡†"><a href="#1-ä»£ç è´¨é‡çš„è¯„åˆ¤æ ‡å‡†" class="headerlink" title="1. ä»£ç è´¨é‡çš„è¯„åˆ¤æ ‡å‡†"></a>1. ä»£ç è´¨é‡çš„è¯„åˆ¤æ ‡å‡†</h1><ul><li>å¸¸ç”¨è¯„ä»·æ ‡å‡†<ul><li>æœ€å¸¸ç”¨<ul><li>å¯ç»´æŠ¤æ€§</li><li>å¯è¯»æ€§</li><li>å¯æ‰©å±•æ€§</li></ul></li><li>å…¶ä»–<ul><li>çµæ´»æ€§</li><li>ç®€æ´æ€§</li><li>å¯å¤ç”¨æ€§</li><li>å¯æµ‹è¯•æ€§</li></ul></li></ul></li><li>å¦‚ä½•å†™å‡ºé«˜è´¨é‡ä»£ç ï¼Ÿ<ul><li>è®¾è®¡æ€æƒ³</li><li>è®¾è®¡åŸåˆ™</li><li>è®¾è®¡æ¨¡å¼</li><li>ç¼–ç è§„èŒƒ</li><li>é‡æ„æŠ€å·§</li></ul></li></ul><h1 id="2-é¢å‘å¯¹è±¡"><a href="#2-é¢å‘å¯¹è±¡" class="headerlink" title="2. é¢å‘å¯¹è±¡"></a>2. é¢å‘å¯¹è±¡</h1><ul><li><p>ç‰¹æ€§</p><ul><li>å°è£…<ul><li>éšè—ä¿¡æ¯ï¼Œæ•°æ®è®¿é—®ä¿æŠ¤</li></ul></li><li>ç»§æ‰¿<ul><li>is a</li></ul></li><li>å¤šæ€<ul><li>å­ç±»å¯ä»¥æ›¿ä»£çˆ¶ç±»çš„æ¨¡å¼</li><li>åœ¨å®é™…ä»£ç è¿è¡Œå½“ä¸­ï¼Œé€šè¿‡è°ƒç”¨å­ç±»çš„æ–¹æ³•æ¥å®ç°</li></ul></li><li>æŠ½è±¡<ul><li>éšè—ç±»çš„å…·ä½“å®ç°æ–¹æ³•</li><li>ä½¿å¾—ä¿®æ”¹å®ç°ä¸éœ€è¦æ”¹å˜å®šä¹‰</li></ul></li></ul></li><li><p>é¢å‘å¯¹è±¡è®¾è®¡ â€“ å¦‚ä½•è®¾è®¡å‡ºå…·ä½“çš„ç±»</p><ul><li>åˆ’åˆ†èŒè´£</li><li>å®šä¹‰ç±»åŠå…¶å±æ€§å’Œæ–¹æ³•</li><li>å®šä¹‰ç±»å’Œç±»ä¹‹é—´çš„äº¤äº’å…³ç³»</li><li>å°†ç±»ç»„è£…èµ·æ¥å¹¶æä¾›æ‰§è¡Œå…¥å£</li></ul></li><li><p>æ¥å£ vs æŠ½è±¡ç±»</p><ul><li><p>æ¥å£</p><ul><li>å¯¹æ–¹æ³•çš„æŠ½è±¡</li><li>æ˜¯ä¸€ç§has açš„å…³ç³»</li><li>è¡¨ç¤ºå…·æœ‰æŸä¸€ç»„è¡Œä¸ºç‰¹æ€§</li><li>ä¸ºäº†è§£å†³è§£è€¦é—®é¢˜ï¼Œéš”ç¦»æ¥å£å’Œå…·ä½“å®ç°ï¼Œæé«˜ä»£ç æ‰©å±•æ€§</li></ul></li><li><p>æŠ½è±¡ç±»</p><ul><li>å¯¹æˆå‘˜å˜é‡å’Œæ–¹æ³•çš„æŠ½è±¡</li><li>æ˜¯ä¸€ç§is açš„å…³ç³»</li><li>ä¸ºäº†è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜</li></ul></li></ul></li><li><p>è´«è¡€æ¨¡å‹ vs å……è¡€æ¨¡å‹</p><ul><li>MVC  è´«è¡€æ¨¡å‹</li><li>å……è¡€æ¨¡å‹çš„è®¾è®¡<ul><li>ä¸è´«è¡€æ¨¡å‹çš„åŒºåˆ«åœ¨äºServiceå±‚</li><li>åœ¨åŸºäºå……è¡€æ¨¡å‹çš„å¼€å‘æ¨¡å¼ä¸‹ï¼Œå°†serviceç±»ä¸­çš„ä¸šåŠ¡é€»è¾‘ç§»åŠ¨åˆ°ä¸€ä¸ªå……è¡€çš„domainé¢†åŸŸæ¨¡å‹å½“ä¸­</li><li>è®©Serviceç±»çš„å®ç°ä¾èµ–è¿™ä¸ªdomainç±»</li></ul></li></ul></li></ul><h1 id="3-è®¾è®¡åŸåˆ™"><a href="#3-è®¾è®¡åŸåˆ™" class="headerlink" title="3. è®¾è®¡åŸåˆ™"></a>3. è®¾è®¡åŸåˆ™</h1><ul><li><p>å•ä¸€èŒè´£åŸåˆ™</p><ul><li>ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªèŒè´£æˆ–è€…åŠŸèƒ½</li></ul></li><li><p>å¼€é—­åŸåˆ™</p><ul><li>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­<ul><li>æ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼Œåº”è¯¥æ˜¯é€šè¿‡åœ¨å·²æœ‰çš„ä»£ç åŸºç¡€ä¸Šæ‰©å±•ä»£ç (æ–°å¢æ¨¡å—ï¼Œç±»ï¼Œæ–¹æ³•ï¼Œå±æ€§)ï¼Œè€Œéä¿®æ”¹å·²æœ‰çš„ä»£ç çš„æ–¹å¼æ¥å®Œæˆçš„</li><li>æŒ‡çš„æ˜¯ä»¥æœ€å°çš„ä¿®æ”¹ä»£ç çš„ä»£ä»·æ¥å®Œæˆæ–°åŠŸèƒ½çš„å¼€å‘</li></ul></li></ul></li><li><p>é‡Œæ°æ›¿ä»£åŸåˆ™</p><ul><li>å­ç±»å¯¹è±¡èƒ½å¤Ÿæ›¿ä»£ç¨‹åºå½“ä¸­çˆ¶ç±»å¯¹è±¡å‡ºç°çš„ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸”ä¿è¯åŸæ¥ç¨‹åºçš„é€»è¾‘è¡Œä¸ºä¸å˜åŠæ­£ç¡®æ€§ä¸è¢«ç ´åã€‚</li><li>ç†è§£ Design by contract æŒ‰ç…§åè®®æ¥è®¾è®¡</li><li>çˆ¶ç±»å®šä¹‰å‡½æ•°çš„çº¦å®š/åè®®</li><li>å­ç±»å¯ä»¥æ”¹å˜å‡½æ•°çš„å†…éƒ¨å®ç°é€»è¾‘ï¼Œä½†ä¸èƒ½æ”¹å˜å‡½æ•°çš„åŸæœ‰çº¦å®š<ul><li>çº¦å®šåŒ…æ‹¬<ul><li>å‡½æ•°å£°æ˜è¦å®ç°çš„åŠŸèƒ½</li><li>å¯¹è¾“å…¥ è¾“å‡º å¼‚å¸¸çš„çº¦å®š</li><li>æ³¨é‡Šä¸­ç½—åˆ—çš„ç‰¹æ®Šè¯´æ˜</li></ul></li></ul></li></ul></li><li><p>æ¥å£éš”ç¦»åŸåˆ™</p><ul><li>å®¢æˆ·ç«¯ä¸åº”è¯¥å¼ºè¿«ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£<ul><li>å°†æ¥å£ç†è§£ä¸ºä¸€ç»„æ¥å£é›†åˆ<ul><li>å¦‚æœéƒ¨åˆ†æ¥å£åªè¢«éƒ¨åˆ†è°ƒç”¨è€…ä½¿ç”¨ï¼Œåº”è¯¥å°†è¿™éƒ¨åˆ†æ¥å£éš”ç¦»èµ·æ¥ï¼Œå•ç‹¬ç»™ä»–ä»¬ä½¿ç”¨</li></ul></li><li>ç†è§£ä¸ºå•ä¸ªAPIæ¥å£æˆ–å‡½æ•°<ul><li>éƒ¨åˆ†è°ƒç”¨è€…åªéœ€è¦å‡½æ•°çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œé‚£æˆ‘ä»¬å°±åº”è¯¥å°†å‡½æ•°æ‹†åˆ†ä¸ºç²’åº¦æ›´ç»†çš„å¤šä¸ªå‡½æ•°ï¼Œè®©è°ƒç”¨è€…åªä¾èµ–å®ƒéœ€è¦çš„é‚£ä¸ªç»†ç²’åº¦çš„å‡½æ•°</li></ul></li><li>ç†è§£ä¸ºOOPä¸­çš„æ¥å£<ul><li>æ¥å£çš„è®¾è®¡éœ€è¦å°½é‡å•ä¸€ï¼Œä¸è¦è®©æ¥å£çš„å®ç°ç±»å’Œè°ƒç”¨è€…ï¼Œä¾èµ–ä¸éœ€è¦çš„æ¥å£å‡½æ•°</li></ul></li></ul></li></ul></li><li><p>YAGNI - you ainâ€™t gonna need it </p></li><li><p>LOD - é«˜å†…èšï¼Œä½è€¦åˆ</p></li><li><p>è¿ªç±³ç‰¹æ³•åˆ™</p><ul><li>ä¸è¯¥æœ‰ç›´æ¥ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œä¸è¦æœ‰ä¾èµ–ï¼›æœ‰ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œå°½é‡åªä¾èµ–å¿…è¦çš„æ¥å£</li></ul></li></ul><h1 id="4-ç›¸å…³çš„æ–‡ç« "><a href="#4-ç›¸å…³çš„æ–‡ç« " class="headerlink" title="4. ç›¸å…³çš„æ–‡ç« "></a>4. ç›¸å…³çš„æ–‡ç« </h1><ol><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-general/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -general</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -åŸåˆ™</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8F%AF%E6%89%A9%E5%B1%95%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -å¯æ‰©å±•æ¶æ„æ¨¡å¼</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -å¤æ‚åº¦æ¥æº</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E6%88%98/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹  - å®æˆ˜</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E6%A8%A1%E6%9D%BF/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹  - æ¶æ„è®¾è®¡æ–‡æ¡£æ¨¡æ¿</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -æ¶æ„è®¾è®¡æµç¨‹</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -é«˜å¯ç”¨æ¶æ„æ¨¡å¼</a></li><li><a href="https://llchen60.com/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E6%80%A7%E8%83%BD%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/" target="_blank" rel="noopener">æ¶æ„å­¦ä¹ -é«˜æ€§èƒ½æ¶æ„æ¨¡å¼</a></li><li><a href="https://llchen60.com/%E5%9F%BA%E4%BA%8E%E5%85%85%E8%A1%80%E6%A8%A1%E5%9E%8B%E7%9A%84DDD%E5%BC%80%E5%8F%91%E6%A8%A1%E5%9E%8B/" target="_blank" rel="noopener">åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å‹</a></li><li><a href="https://llchen60.com/SOLID-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">SOLID-å•ä¸€èŒè´£åŸåˆ™</a></li><li><a href="https://llchen60.com/SOLID-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">SOLID - å¼€é—­åŸåˆ™</a></li><li><a href="https://llchen60.com/SOLID-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">SOLID - é‡Œæ°æ›¿æ¢åŸåˆ™</a></li><li><a href="https://llchen60.com/SOLID-%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">SOLID - æ¥å£éš”ç¦»åŸåˆ™</a></li><li><a href="https://llchen60.com/SOLID-%E4%BE%9D%E8%B5%96%E5%8F%8D%E8%BD%AC%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">SOLID - ä¾èµ–åè½¬åŸåˆ™</a></li><li><a href="https://llchen60.com/KISS-and-YAGNI%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">KISS and YAGNIåŸåˆ™</a></li><li><a href="https://llchen60.com/DRY-%E5%8E%9F%E5%88%99/" target="_blank" rel="noopener">DRY åŸåˆ™</a></li><li><a href="https://llchen60.com/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99-LOD-%E2%80%94-%E9%AB%98%E5%86%85%E8%81%9A%EF%BC%8C%E4%BD%8E%E8%80%A6%E5%90%88/" target="_blank" rel="noopener">è¿ªç±³ç‰¹æ³•åˆ™ (LOD) â€” é«˜å†…èšï¼Œä½è€¦åˆ</a></li><li><a href="https://llchen60.com/%E5%BA%94%E7%94%A8%E8%AE%BE%E8%AE%A1-Practice/" target="_blank" rel="noopener">åº”ç”¨è®¾è®¡ Practice</a></li><li><a href="https://llchen60.com/%E5%85%B3%E4%BA%8E%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E7%9A%84Tips/" target="_blank" rel="noopener">æé«˜ä»£ç è´¨é‡çš„Tips</a></li></ol><h1 id="5-å®æˆ˜ï¼šIDç”Ÿæˆå™¨"><a href="#5-å®æˆ˜ï¼šIDç”Ÿæˆå™¨" class="headerlink" title="5. å®æˆ˜ï¼šIDç”Ÿæˆå™¨"></a>5. å®æˆ˜ï¼šIDç”Ÿæˆå™¨</h1><p>ä½¿ç”¨IDæ¥åšæœåŠ¡å†…éƒ¨çš„è¯·æ±‚è¿½è¸ªï¼Œå› ä¸ºåœ¨æ—¥å¿—æ–‡ä»¶å½“ä¸­ï¼Œä¸åŒè¯·æ±‚çš„æ—¥å¿—æ˜¯ä¼šäº¤ç»‡åˆ°ä¸€èµ·çš„ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨IDæ¥æ ‡è¯†å“ªäº›æ—¥å¿—å±äºåŒä¸€ä¸ªè¯·æ±‚ã€‚</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…å°±æ˜¯ç»™æ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„IDï¼Œå¹¶ä¸”ä¿å­˜åœ¨è¯·æ±‚çš„ä¸Šä¸‹æ–‡å½“ä¸­ã€‚Javaå½“ä¸­å¯ä»¥å°†IDå­˜å‚¨åœ¨ThreadLocalå½“ä¸­ï¼Œæˆ–è€…ä½¿ç”¨Slf4jçš„MDC(Mapped Diagnostic Contexts)æ¥å®ç°ã€‚æ¯æ¬¡æ‰“å°æ—¥å¿—çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»è¯·æ±‚ä¸Šä¸‹æ–‡å½“ä¸­å–å‡ºè¯·æ±‚IDï¼Œè·Ÿæ—¥å¿—ä¸€å—è¾“å‡ºã€‚</p><h2 id="5-1-åŸå§‹çš„ç”ŸæˆIDçš„ä»£ç "><a href="#5-1-åŸå§‹çš„ç”ŸæˆIDçš„ä»£ç " class="headerlink" title="5.1 åŸå§‹çš„ç”ŸæˆIDçš„ä»£ç "></a>5.1 åŸå§‹çš„ç”ŸæˆIDçš„ä»£ç </h2><pre><code>public class IdGenerator {  private static final Logger logger = LoggerFactory.getLogger(IdGenerator.class);  public static String generate() {    String id = &quot;&quot;;    try {      String hostName = InetAddress.getLocalHost().getHostName();      String[] tokens = hostName.split(&quot;\\.&quot;);      if (tokens.length &gt; 0) {        hostName = tokens[tokens.length - 1];      }      char[] randomChars = new char[8];      int count = 0;      Random random = new Random();      while (count &lt; 8) {        int randomAscii = random.nextInt(122);        if (randomAscii &gt;= 48 &amp;&amp; randomAscii &lt;= 57) {          randomChars[count] = (char)(&#39;0&#39; + (randomAscii - 48));          count++;        } else if (randomAscii &gt;= 65 &amp;&amp; randomAscii &lt;= 90) {          randomChars[count] = (char)(&#39;A&#39; + (randomAscii - 65));          count++;        } else if (randomAscii &gt;= 97 &amp;&amp; randomAscii &lt;= 122) {          randomChars[count] = (char)(&#39;a&#39; + (randomAscii - 97));          count++;        }      }      id = String.format(&quot;%s-%d-%s&quot;, hostName,              System.currentTimeMillis(), new String(randomChars));    } catch (UnknownHostException e) {      logger.warn(&quot;Failed to get the host name.&quot;, e);    }    return id;  }}</code></pre><ul><li>ä¸Šè¿°ä»£ç å­˜åœ¨çš„é—®é¢˜<ul><li>static æ–¹æ³•å¯æµ‹è¯•æ€§å¤ªä½</li><li>generateå‡½æ•°çš„ä»£ç å®ç°ä¾èµ–è¿è¡Œç¯å¢ƒï¼Œæ—¶é—´å‡½æ•°ä»¥åŠéšæœºå‡½æ•°ï¼Œæœ¬èº«çš„å¯æµ‹è¯•æ€§ä¹Ÿä¸å¼º</li><li>éšæœºå­—ç¬¦ä¸²ç”Ÿæˆä»£ç éš¾ä»¥çœ‹æ‡‚</li><li>æœ‰å¤ªå¤šçš„é­”æ³•æ•°ï¼Œéœ€è¦å‘Šè¯‰è¯»ä»£ç çš„äººè¿™äº›éƒ½æ˜¯ä»€ä¹ˆæ„æ€æ‰å¯ä»¥çš„</li></ul></li></ul><h2 id="5-2-å®Œå–„åçš„ä»£ç "><a href="#5-2-å®Œå–„åçš„ä»£ç " class="headerlink" title="5.2 å®Œå–„åçš„ä»£ç "></a>5.2 å®Œå–„åçš„ä»£ç </h2><pre><code>public interface IdGenerator {  String generate();}public interface LogTraceIdGenerator extends IdGenerator {}public class RandomIdGenerator implements IdGenerator {  private static final Logger logger = LoggerFactory.getLogger(RandomIdGenerator.class);  @Override  public String generate() {    String substrOfHostName = getLastfieldOfHostName();    long currentTimeMillis = System.currentTimeMillis();    String randomString = generateRandomAlphameric(8);    String id = String.format(&quot;%s-%d-%s&quot;,            substrOfHostName, currentTimeMillis, randomString);    return id;  }  private String getLastfieldOfHostName() {    String substrOfHostName = null;    try {      String hostName = InetAddress.getLocalHost().getHostName();      String[] tokens = hostName.split(&quot;\\.&quot;);      substrOfHostName = tokens[tokens.length - 1];      return substrOfHostName;    } catch (UnknownHostException e) {      logger.warn(&quot;Failed to get the host name.&quot;, e);    }    return substrOfHostName;  }  private String generateRandomAlphameric(int length) {    char[] randomChars = new char[length];    int count = 0;    Random random = new Random();    while (count &lt; length) {      int maxAscii = &#39;z&#39;;      int randomAscii = random.nextInt(maxAscii);      boolean isDigit= randomAscii &gt;= &#39;0&#39; &amp;&amp; randomAscii &lt;= &#39;9&#39;;      boolean isUppercase= randomAscii &gt;= &#39;A&#39; &amp;&amp; randomAscii &lt;= &#39;Z&#39;;      boolean isLowercase= randomAscii &gt;= &#39;a&#39; &amp;&amp; randomAscii &lt;= &#39;z&#39;;      if (isDigit|| isUppercase || isLowercase) {        randomChars[count] = (char) (randomAscii);        ++count;      }    }    return new String(randomChars);  }}//ä»£ç ä½¿ç”¨ä¸¾ä¾‹LogTraceIdGenerator logTraceIdGenerator = new RandomIdGenerator();</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡åŸåˆ™ </tag>
            
            <tag> ç¼–ç¨‹è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»·æ ¼å¿ƒç†å­¦</title>
      <link href="/%E4%BB%B7%E6%A0%BC%E5%BF%83%E7%90%86%E5%AD%A6/"/>
      <url>/%E4%BB%B7%E6%A0%BC%E5%BF%83%E7%90%86%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<p>ä¸€äº›å®šä»·ï¼Œçœ‹ä»·çš„æŠ€å·§ã€‚æ— è®ºä½ æ˜¯é”€å”®è€…è¿˜æ˜¯è´­ä¹°è€…ï¼Œåº”è¯¥éƒ½èƒ½ä»ä¸­å¾—åˆ°ä¸€äº›å¯¹ä½ æ›´æœ‰åˆ©çš„å®šä»·ç­–ç•¥ã€‚</p><h1 id="1-ä½¿è‡ªå·±çš„ä»·æ ¼çœ‹èµ·æ¥æ›´ä½"><a href="#1-ä½¿è‡ªå·±çš„ä»·æ ¼çœ‹èµ·æ¥æ›´ä½" class="headerlink" title="1. ä½¿è‡ªå·±çš„ä»·æ ¼çœ‹èµ·æ¥æ›´ä½"></a>1. ä½¿è‡ªå·±çš„ä»·æ ¼çœ‹èµ·æ¥æ›´ä½</h1><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼æ¥å½±å“åœ¨äººä»¬å°è±¡å½“ä¸­çš„äº§å“çš„ä»·æ ¼ã€‚å½“äººä»¬å°†ä½ çš„äº§å“ä»·æ ¼å’Œå‚è€ƒäº§å“æ¯”è¾ƒçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç”¨æŸäº›æ–¹å¼æ–½åŠ å½±å“ï¼Œæ¥ä½¿å¾—ä»–ä»¬æ‹¿æ›´ä½çš„ä»·æ ¼æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è¿™æ ·åšæœ‰æ•ˆçš„åŸå› æ˜¯æˆ‘ä»¬çš„å¤§è„‘æ˜¯å¾ˆæ‡’çš„ï¼Œæˆ‘ä»¬åœ¨å¤§è„‘ä¸­ä¸ä¼šè®°ä¸€ä¸ªç‰©å“çš„æ•°å­—ä¸Šçš„ä»·æ ¼ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯è®°å½•ç›¸å¯¹çš„é«˜æˆ–è€…ä½</p><h4 id="1-å¯¹æœ€å·¦ä¾§çš„æ•°å­—å‡1"><a href="#1-å¯¹æœ€å·¦ä¾§çš„æ•°å­—å‡1" class="headerlink" title="1. å¯¹æœ€å·¦ä¾§çš„æ•°å­—å‡1"></a>1. å¯¹æœ€å·¦ä¾§çš„æ•°å­—å‡1</h4><p>é€šè¿‡æ¯”è¾ƒè½¬åŒ–ç‡ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡å°‘ä¸€åˆ†é’±ï¼Œå³ä¾‹å¦‚ä»$1 åˆ°$0.99ï¼Œè½¬åŒ–ç‡å°±æé«˜äº†1ä¸ªç™¾åˆ†ç‚¹ã€‚</p><p><img src="https://i.loli.net/2020/05/31/Xr2xVAUkP7SsKM5.jpg" alt="conversion rate in Gumroad.jpg"></p><p>å¾ˆå¤šäººéƒ½çŸ¥é“.99çš„é­”åŠ›ï¼Œä½†æ˜¯è½¬åŒ–ç‡æ›´å¤§çš„è½¬å˜å‡ºç°åœ¨å½“æœ€å·¦ä¾§çš„æ•°å­—å‘ç”Ÿäº†æ”¹å˜çš„æ—¶å€™ã€‚å¤§è„‘æ„è¯†æ˜¯æœ‰é”šå®šæ•ˆåº”çš„ï¼Œå³æˆ‘ä»¬ä¼šè®¤ä¸º$2.99æ˜¯å±äº2çš„èŒƒç•´ï¼Œè€Œ$3æ˜¯å±äº3çš„èŒƒç•´ï¼Œä»–ä»¬ä¹‹é—´ç›¸å·®å¾ˆå¤§ã€‚åŒç†å‡ºç°åœ¨199å’Œ200ä¹‹é—´ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</p><h4 id="2-é€‰æ‹©æ›´å°‘éŸ³èŠ‚çš„ä»·æ ¼"><a href="#2-é€‰æ‹©æ›´å°‘éŸ³èŠ‚çš„ä»·æ ¼" class="headerlink" title="2. é€‰æ‹©æ›´å°‘éŸ³èŠ‚çš„ä»·æ ¼"></a><strong>2. é€‰æ‹©æ›´å°‘éŸ³èŠ‚çš„ä»·æ ¼</strong></h4><p>ä»·æ ¼çš„æ•´ä¸ªè¯»éŸ³ï¼ˆéŸ³èŠ‚æ•°é‡ï¼‰ä¹Ÿä¼šå½±å“æœ€ç»ˆå¯¹äºä»·æ ¼çš„è®¤çŸ¥[3]ã€‚å½“æˆ‘ä»¬éœ€è¦å¤„ç†æ›´å¤šéŸ³èŠ‚çš„åˆºæ¿€çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šéœ€è¦æ›´å¤šçš„æ„è¯†æ¥å¤„ç†è¿™ç§åˆºæ¿€ï¼Œè¿™åŒæ ·é€‚ç”¨äºæ•°å­—ï¼Œå½“æˆ‘ä»¬éœ€è¦èŠ±æ›´å¤šçš„æ—¶é—´å¤„ç†è¿™ä¸ªæ•°å­—çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ½œæ„è¯†ä¼šè®¤ä¸ºè¿™ä¸ªæ•°å­—éå¸¸å¤§ã€‚</p><p>å½“åŒ…å«æ›´å°‘çš„è¯»éŸ³çš„æ—¶å€™ï¼Œäººä»¬ä¼šè®¤ä¸ºä»·æ ¼æ¯”å®é™…ä¸Šä½ã€‚</p><p>è¿™ä¸ä»…ä»…å‘ç”Ÿåœ¨è¯»å‡ºä»·æ ¼çš„æ—¶å€™ï¼Œç ”ç©¶è¡¨æ˜å“ªæ€•æˆ‘ä»¬çœ‹åˆ°çš„æ˜¯å†™å‡ºæ¥çš„ä»·æ ¼ï¼Œæˆ‘ä»¬çš„å¤§è„‘ä¹Ÿä¼šæ½œæ„è¯†å½“ä¸­å°†å…¶ç¼–ç æˆå¬è§‰ç‰ˆæœ¬ã€‚[4]</p><h4 id="3-ç”¨æ›´å°çš„å­—å·æ¥å±•ç¤ºä»·æ ¼"><a href="#3-ç”¨æ›´å°çš„å­—å·æ¥å±•ç¤ºä»·æ ¼" class="headerlink" title="3. ç”¨æ›´å°çš„å­—å·æ¥å±•ç¤ºä»·æ ¼"></a><strong>3. ç”¨æ›´å°çš„å­—å·æ¥å±•ç¤ºä»·æ ¼</strong></h4><p>æˆ‘ä»¬çš„å¤§è„‘å¯¹äºå¤§å°æ˜¯æœ‰æ¦‚å¿µä¸Šçš„è®¤çŸ¥çš„ã€‚è§†è§‰å¤§å°ä¸æ•°å­—å¤§å°çš„äº¤æ±‡æ˜¯å¾ˆæ¨¡ç³Šçš„ï¼Œå³æˆ‘ä»¬æ½œæ„è¯†å¯èƒ½ä¼šè®¤ä¸ºè§†è§‰ä¸Šç”¨æ›´å°çš„å­—ä½“ä¹Ÿæ„å‘³ç€æ•°å­—æœ¬èº«æ˜¯æ›´å°çš„ã€‚</p><p>åŒæ ·ï¼Œå¯¹äºæŠ˜æ‰£æ¥è¯´ï¼Œæˆ‘ä»¬å°±åº”è¯¥ä½¿ç”¨å°½å¯èƒ½å¤§çš„å­—ä½“æ¥å±•ç¤ºäº†ã€‚</p><p><img src="https://i.loli.net/2020/05/31/kMWAyd1LVaNsPEF.png" alt="pricing-tactic-3"></p><h4 id="4-ç§»é™¤ä»·æ ¼å½“ä¸­çš„é€—å·"><a href="#4-ç§»é™¤ä»·æ ¼å½“ä¸­çš„é€—å·" class="headerlink" title="4. ç§»é™¤ä»·æ ¼å½“ä¸­çš„é€—å·"></a><strong>4. ç§»é™¤ä»·æ ¼å½“ä¸­çš„é€—å·</strong></h4><p>ç§»é™¤é€—å·å¯ä»¥ä½¿å¾—ä½ çš„ä»·æ ¼çœ‹èµ·æ¥æ›´ä½ï¼[5]</p><p>é¦–å…ˆæ˜¯è§†è§‰ä¸Šï¼Œé€—å·ä½¿å¾—æ•´ä¸ªæ•°å­—æ˜¾å¾—æ›´å¤§ï¼›<br>å…¶æ¬¡æ˜¯å¦‚æœä¸åŠ é€—å·ï¼Œæ¯”å¦‚å¯¹äº1499è¿™ä¸ªæ•°å­—ï¼Œä¼šè¯»æˆfourteen niety-nine; ä½†æ˜¯å¦‚æœåŠ äº†é€—å·ï¼Œé‚£ä¹ˆå°±ä¼šè¯»æˆone thousand four hundred and ninty nine. éŸ³èŠ‚ä»5ä¸ªå‡åˆ°äº†10ä¸ªã€‚</p><h4 id="5-é€‰æ‹©ç»´åº¦æ›´å°çš„è¯"><a href="#5-é€‰æ‹©ç»´åº¦æ›´å°çš„è¯" class="headerlink" title="5. é€‰æ‹©ç»´åº¦æ›´å°çš„è¯"></a><strong>5. é€‰æ‹©ç»´åº¦æ›´å°çš„è¯</strong></h4><p>å¯¹äºåœ¨æ˜¾ç¤ºçš„ä»·æ ¼æ—è¾¹çš„è¯ï¼Œé€‰æ‹©è¦è°¨æ…ã€‚æœ‰äº›è¯æ˜¯å¯ä»¥å·¦å³äººä»¬çš„è®¾æƒ³çš„ã€‚ä¸¾ä¸ªä¾‹å­, low friction vs high performance. é€šè¿‡æµ‹è¯•å‘ç°åœ¨å‚ä¸è€…è®¤ä¸ºä¸¤ä¸ªè¯è¯­éƒ½åŒç­‰é‡è¦çš„å‰æä¸‹ï¼Œæ›´å¤šçš„äººé€‰æ‹©äº†å¸¦æœ‰Low Frictionçš„ã€‚å¦‚æœå¯ä»¥ï¼Œåœ¨ä»·æ ¼æ—è¾¹é€‰æ‹©ç»´åº¦æ›´å°çš„ä¸€äº›è¯ã€‚</p><h4 id="6-å°†ç‰©æµå’Œè®¢å•å¤„ç†çš„è´¹ç”¨åˆ†å¼€"><a href="#6-å°†ç‰©æµå’Œè®¢å•å¤„ç†çš„è´¹ç”¨åˆ†å¼€" class="headerlink" title="6. å°†ç‰©æµå’Œè®¢å•å¤„ç†çš„è´¹ç”¨åˆ†å¼€"></a><strong>6. å°†ç‰©æµå’Œè®¢å•å¤„ç†çš„è´¹ç”¨åˆ†å¼€</strong></h4><p>å½“ä½ è¦åœ¨çº¿é”€å”®äº§å“çš„æ—¶å€™ï¼Œå¾€å¾€éœ€è¦æ”¯ä»˜ç‰©æµå’Œè®¢å•å¤„ç†çš„è´¹ç”¨ã€‚å½“å°†ä»·æ ¼éƒ½åˆ†å‰²å¼€çš„æ—¶å€™ï¼Œä½¿å¾—äººä»¬èƒ½å¤Ÿé”šå®šåœ¨åŸºç¡€ä»·æ ¼ä¸Šï¼Œè€Œä¸æ˜¯æ•´ä¸ªä»·æ ¼ã€‚[6]</p><h4 id="7-æä¾›é¦–ä»˜é‡‘ç›¸å…³çš„é€‰æ‹©"><a href="#7-æä¾›é¦–ä»˜é‡‘ç›¸å…³çš„é€‰æ‹©" class="headerlink" title="7. æä¾›é¦–ä»˜é‡‘ç›¸å…³çš„é€‰æ‹©"></a><strong>7. æä¾›é¦–ä»˜é‡‘ç›¸å…³çš„é€‰æ‹©</strong></h4><p>ä¸€ä¸‹å­ä»˜1000åˆ€å’Œåˆ†10ä¸ªæœˆæ¯æ¬¡ä»˜100åˆ€ç»™äººçš„æ„Ÿè§‰æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚å¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨æœˆä»˜å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæå‡äººä»¬è´­ä¹°çš„æ¬²æœ›ã€‚ä»–ä»¬ä¼šè®¤ä¸ºè¿™ä¸ªä»·æ ¼å¾ˆä½ã€‚</p><h4 id="8-æåŠæ¯å¤©çš„ç­‰å€¼ä»·æ ¼"><a href="#8-æåŠæ¯å¤©çš„ç­‰å€¼ä»·æ ¼" class="headerlink" title="8. æåŠæ¯å¤©çš„ç­‰å€¼ä»·æ ¼"></a><strong>8. æåŠæ¯å¤©çš„ç­‰å€¼ä»·æ ¼</strong></h4><p>å‡è®¾æˆ‘ä»¬åœ¨åšä¸€ä¸ªæœˆä»˜çš„ä¸œè¥¿ï¼Œ30åˆ€æ¯æœˆï¼Œè¿™ä¼šæ˜¾å¾—å¾ˆå¤šã€‚å¦‚æœè¯´æ¯å¤©ä¸€ç¾å…ƒï¼Œç»™äººæ„Ÿè§‰å°±ä¼šå°‘ä¸€äº›äº†ã€‚</p><h4 id="9-å…³äºå¤§é¢çš„æ•°å­—ï¼Œè¦ç²¾å‡†"><a href="#9-å…³äºå¤§é¢çš„æ•°å­—ï¼Œè¦ç²¾å‡†" class="headerlink" title="9. å…³äºå¤§é¢çš„æ•°å­—ï¼Œè¦ç²¾å‡†"></a><strong>9. å…³äºå¤§é¢çš„æ•°å­—ï¼Œè¦ç²¾å‡†</strong></h4><p>æ¯”å¦‚è´­æˆ¿çš„æ—¶å€™ï¼Œ$359,289å’Œ$359,000ç»™äººçš„æ„Ÿè§‰ä¼šå¾ˆä¸ä¸€æ ·ï¼Œå‰è€…è§¦å‘çš„æ˜¯äººä»¬å¯¹äºä½ä»·äº§å“çš„è®¤çŸ¥ï¼›å³è¶³å¤Ÿç²¾å‡†ï¼Œè€Œåè€…ä¼šè¢«é»˜è®¤ä¸ºæ˜¯ä»·æ ¼å¾ˆé«˜çš„äº§å“ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¸€ä¸ªå¾ˆç²¾ç¡®çš„æ•°å­—ä¹Ÿä¼šè®©äººæ„Ÿè§‰è°ˆä»·çš„ä½™åœ°ç›¸å¯¹æœ‰é™ï¼›å¯¹æ–¹åœ¨å¾ˆè®¤çœŸä»”ç»†çš„å‡†å¤‡ã€‚ </p><h4 id="10-å°é¢çš„ä»·æ ¼æ”¾åˆ°å·¦ä¾§"><a href="#10-å°é¢çš„ä»·æ ¼æ”¾åˆ°å·¦ä¾§" class="headerlink" title="10. å°é¢çš„ä»·æ ¼æ”¾åˆ°å·¦ä¾§"></a><strong>10. å°é¢çš„ä»·æ ¼æ”¾åˆ°å·¦ä¾§</strong></h4><p>å½“æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå¸ƒå±€çš„æ—¶å€™ï¼Œä»·æ ¼åº”è¯¥å¾€å·¦ä¾§æ”¾ã€‚è¿™æ˜¯å› ä¸ºåœ¨è‹±æ–‡å½“ä¸­ï¼Œæˆ‘ä»¬å°†ä¸Šå’Œé«˜è´¨è”ç³»åˆ°äº†ä¸€èµ·ï¼Œä½å’Œä¸å¥½çš„ä¸œè¥¿è”ç³»èµ·æ¥ã€‚è­¬å¦‚ï¼š</p><ul><li>go up to heaven </li><li>down to hell </li><li>thumbs up </li><li>thumbs down </li><li>get high</li><li>come down</li><li>etc.</li></ul><p>ç ”ç©¶ä¹Ÿè¯å®äº†å½“å¥½è¯åœ¨å±å¹•ä¸Šæ–¹ï¼Œåè¯åœ¨å±å¹•ä¸‹æ–¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬èƒ½æ›´å¿«çš„è¯†åˆ«å‡ºä»–ä»¬æ¥ã€‚ç±»ä¼¼çš„æ¦‚å¿µä¹Ÿå‡ºç°åœ¨æ•°å­—ä¸Šï¼Œæ ¹æ®ç ”ç©¶[7]å‘ç°äººä»¬ä¼šå°†æ•°å­—ç½®äºè‡ªå·±æƒ³è±¡çš„ä¸€æ¡æ°´å¹³æ–¹å‘çš„çº¿ä¸Šï¼Œä»å·¦åˆ°å³æ•°å­—ä¾æ¬¡å¢å¤§ã€‚</p><p>å› æ­¤å°ä»·æ ¼æ”¾åˆ°å·¦ä¾§ï¼Œå¯¹äºå¤§å®¶æ¦‚å¿µä¸­çš„å¤§ä»·æ ¼ï¼Œæ”¾åˆ°å³ä¾§ã€‚</p><h4 id="11-è®©ç”¨æˆ·çœ‹åˆ°ä»·æ ¼çš„ä¹˜ç§¯-ä¾‹å­"><a href="#11-è®©ç”¨æˆ·çœ‹åˆ°ä»·æ ¼çš„ä¹˜ç§¯-ä¾‹å­" class="headerlink" title="11. è®©ç”¨æˆ·çœ‹åˆ°ä»·æ ¼çš„ä¹˜ç§¯(ä¾‹å­)"></a><strong>11. è®©ç”¨æˆ·çœ‹åˆ°ä»·æ ¼çš„ä¹˜ç§¯(ä¾‹å­)</strong></h4><p><img src="https://i.loli.net/2020/06/03/OgXICK9tdBZHEyp.png" alt="price-multiples.png"></p><p>å‰ä¸¤ä¸ªæ˜¯ç»™äº†ä½ æ— é™æ·»åŠ toppingçš„é€‰æ‹©ï¼Œä»ç»æµä¸Šæ¥è¯´æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯ç»è¿‡è¯•éªŒå‘ç°äººä»¬æ™®éæ›´åŠ å–œæ¬¢åé¢çš„ä¸¤ä¸ªã€‚</p><p>è¿™æ˜¯å› ä¸ºåé¢æ˜¯å¯ä»¥è®¡ç®—çš„ï¼Œå³pizzaçš„å¤šå°‘å’Œtoppingsçš„æ•°é‡çš„ä¹˜ç§¯ç­‰äºä»·æ ¼ã€‚è¿™ç§ä¼˜åŠ¿çœ‹èµ·æ¥æœ‰ç‚¹è’å”ï¼Œä½†æ˜¯å¿ƒç†å­¦èƒ½å¤Ÿç»™äºˆè§£é‡Šã€‚æˆ‘ä»¬ä»å°å¼€å§‹å°±åœ¨è¢«è®­ç»ƒä¸€ä¸‹åŸºæœ¬çš„æ•°å­¦è¿æ¥ï¼Œæ¯”å¦‚ç†ŸçŸ¥çš„ä¹ä¹ä¹˜æ³•è¡¨ï¼Œç„¶åè¿™ç§è¿æ¥ä¼šç»ˆèº«å½±å“æˆ‘ä»¬ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿå¯¹å…¶è¿…é€Ÿååº”ã€‚</p><p>ä¹Ÿæ­£å› ä¸ºè¿™ç§è¿æ¥ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ å¿«é€Ÿçš„å¤„ç†å‡ ä¸ªä¸åŒéƒ¨åˆ†çš„ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡æ•°å­—è¿æ¥å»ºç«‹èµ·å†…å®¹ä¸Šçš„è¿æ¥ã€‚</p><h4 id="12-æ­£ç¡®ä½¿ç”¨å–æ•´æ“ä½œ"><a href="#12-æ­£ç¡®ä½¿ç”¨å–æ•´æ“ä½œ" class="headerlink" title="12. æ­£ç¡®ä½¿ç”¨å–æ•´æ“ä½œ"></a><strong>12. æ­£ç¡®ä½¿ç”¨å–æ•´æ“ä½œ</strong></h4><p>å–æ•´çš„æ•°å­—ä¼šç›¸å¯¹å®¹æ˜“å¤„ç†å¾ˆå¤šï¼Œè­¬å¦‚100 vs 98.65ã€‚æ ¹æ®ç ”ç©¶å‘ç°ï¼Œå½“ç”¨æˆ·èƒ½å¤Ÿæ›´å¿«çš„å¤„ç†åˆ†æä»·æ ¼çš„æ—¶å€™ï¼Œä»–ä»¬ä¼šæ„Ÿè§‰è¿™ä¸ªä»·æ ¼æ„Ÿè§‰ä¸Šæ›´å¯¹ã€‚</p><p>ä¸ä¹‹ç›¸å¯¹çš„ï¼Œæ¶ˆè´¹è€…ä¼šéœ€è¦æ›´å¤šçš„ç²¾ç¥æ¥å¤„ç†éå–æ•´çš„ä»·æ ¼ï¼Œå› æ­¤è¿™ç§éå–æ•´çš„ä»·æ ¼æ›´é€‚åˆç†æ€§æ¶ˆè´¹çš„åœºæ™¯ã€‚</p><p>è€Œå¯¹äºåŸºäºæƒ…æ„Ÿè¿›è¡Œçš„æ¶ˆè´¹ï¼Œä½¿ç”¨æ•´æ•°ä»·æ ¼ä¼šæ›´å®¹æ˜“ä¿ƒè¿›é”€é‡çš„æå‡ã€‚</p><p>åŒæ ·ï¼Œä¸è¦ä½¿ç”¨åƒ100ï¼Œ5000è¿™æ ·çš„æ•°å­—ï¼Œä¼šå¾ˆå®¹æ˜“è®©æ¶ˆè´¹è€…æ„Ÿè§‰è¿™ä¸ªä»·æ ¼è™šé«˜ã€‚</p><p>åŸºäºæƒ…æ„Ÿï¼Œä½¿ç”¨æ•´æ•°ï¼›åŸºäºç†æ€§ï¼Œå¯ä»¥ä½¿ç”¨å¸¦å°æ•°çš„ä»·æ ¼ã€‚</p><h4 id="13-æ ¹æ®åå­—å’Œç”Ÿæ—¥è°ƒæ•´ä»·æ ¼"><a href="#13-æ ¹æ®åå­—å’Œç”Ÿæ—¥è°ƒæ•´ä»·æ ¼" class="headerlink" title="13. æ ¹æ®åå­—å’Œç”Ÿæ—¥è°ƒæ•´ä»·æ ¼"></a><strong>13. æ ¹æ®åå­—å’Œç”Ÿæ—¥è°ƒæ•´ä»·æ ¼</strong></h4><p>å°½ç®¡ç•¥æ˜¾å¤æ€ªï¼Œä½†æ˜¯ç¡®å®å¾ˆå¤šç ”ç©¶éƒ½æ”¯æŒè¿™ä¸ªç»“è®ºï¼Œå³ç”¨æˆ·æ›´å–œæ¬¢æœ‰ä»–ä»¬çš„åå­—åŒæ ·å­—æ¯çš„ä»·æ ¼ï¼Œäº¦æˆ–è€…æ˜¯åŒ…å«ä»–ä»¬çš„ç”Ÿæ—¥çš„ä»·æ ¼ã€‚[8]</p><p>å¿ƒç†å­¦ä¸Šçš„ç†è®ºæ”¯æŒä¸ºimplicit egotism â€“ ä»¥è‡ªæˆ‘ä¸ºä¸­å¿ƒçš„å€¾å‘ã€‚æˆ‘ä»¬æ½œæ„è¯†é‡Œä¼šæ›´åŠ å€¾å‘äºé‚£äº›å’Œæˆ‘ä»¬ç›¸å…³çš„/ æ„ç­‘æˆ‘ä»¬è‡ªæˆ‘çš„äº‹ç‰©ã€‚</p><h4 id="14-åœ¨æœ€ä¼˜æ—¶é—´å±•ç¤ºä»·æ ¼"><a href="#14-åœ¨æœ€ä¼˜æ—¶é—´å±•ç¤ºä»·æ ¼" class="headerlink" title="14. åœ¨æœ€ä¼˜æ—¶é—´å±•ç¤ºä»·æ ¼"></a><strong>14. åœ¨æœ€ä¼˜æ—¶é—´å±•ç¤ºä»·æ ¼</strong></h4><p>æˆ‘ä»¬åº”è¯¥é¦–å…ˆå±•ç¤ºä»€ä¹ˆï¼Ÿ ä½ çš„äº§å“æˆ–è€…ä»·æ ¼ï¼Ÿ </p><p>æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°çš„æ˜¯äº§å“æˆ–è€…ä»·æ ¼å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†æˆ‘ä»¬å†³å®šæ˜¯å¦è¦å»ä¹°è¿™ä»¶äº§å“çš„æ ‡å‡†[9].</p><p>å½“äº§å“è¢«é¦–å…ˆå±•ç¤ºå‡ºæ¥çš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šæ ¹æ®äº§å“è´¨é‡ï¼Œè‡ªå·±çš„å–œçˆ±ç¨‹åº¦æ¥å†³å®šæ˜¯å¦è¦è´­ä¹°</p><p>å½“ä»·æ ¼é¦–å…ˆè¢«å±•ç¤ºå‡ºæ¥çš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šæ ¹æ®è¿™ä¸ªäº§å“æ˜¯å¦å€¼è¿™ä¸ªä»·æ ¼æ¥å†³å®šæ˜¯å¦è¦ä¹°ã€‚</p><p>å½“é”€å”®å¥¢ä¾ˆå“çš„æ—¶å€™ï¼Œå°±åº”è¯¥å…ˆå±•ç¤ºäº§å“ï¼Œå†é˜æ˜ä»·æ ¼ï¼›è€Œå¯¹äºæ—¥å¸¸ä½¿ç”¨çš„äº§å“æ¥è¯´ï¼Œç”¨æˆ·æ›´å€¾å‘äºå…ˆçœ‹åˆ°ä»·æ ¼ï¼Œå†å†³å®šæ˜¯å¦è´­ä¹°è¿™ä»¶äº§å“ã€‚</p><h4 id="15-å‘ç”·å£«å±•ç¤ºçº¢é¢œè‰²æ ‡æ³¨çš„ä»·æ ¼"><a href="#15-å‘ç”·å£«å±•ç¤ºçº¢é¢œè‰²æ ‡æ³¨çš„ä»·æ ¼" class="headerlink" title="15. å‘ç”·å£«å±•ç¤ºçº¢é¢œè‰²æ ‡æ³¨çš„ä»·æ ¼"></a>15. å‘ç”·å£«å±•ç¤ºçº¢é¢œè‰²æ ‡æ³¨çš„ä»·æ ¼</h4><p>ç ”ç©¶[10]è¡¨æ˜å½“ä»·æ ¼æ ‡ç­¾é¢œè‰²ä¸ºçº¢è‰²çš„æ—¶å€™ï¼Œç”·å£«æ›´æœ‰å¯èƒ½ä¹°è¿™ä»¶äº§å“ã€‚</p><p>çº¢è‰²ä»·æ ¼ä¼šæˆä¸ºå…³æ³¨çš„ä¸­å¿ƒï¼Œå¾ˆæœ‰å¯èƒ½å˜ä¸ºåšå‡ºè¯„ä¼°çš„å”¯ä¸€ä¿¡æ¯ã€‚è€Œä¸”å¸¸å¸¸å°†çº¢è‰²ä»·æ ¼å’Œçœé’±è”ç³»èµ·æ¥ã€‚</p><h1 id="2-æœ€å¤§åŒ–å‚è€ƒä»·æ ¼"><a href="#2-æœ€å¤§åŒ–å‚è€ƒä»·æ ¼" class="headerlink" title="2. æœ€å¤§åŒ–å‚è€ƒä»·æ ¼"></a>2. æœ€å¤§åŒ–å‚è€ƒä»·æ ¼</h1><h4 id="16-ä½¿ç”¨ä¸€ä¸ªé«˜ä¸”ç²¾å‡†çš„ä»·æ ¼å¼€å§‹è°ˆä»·-ï¼ˆä»å•†å®¶è§’åº¦æ¥çœ‹ï¼‰"><a href="#16-ä½¿ç”¨ä¸€ä¸ªé«˜ä¸”ç²¾å‡†çš„ä»·æ ¼å¼€å§‹è°ˆä»·-ï¼ˆä»å•†å®¶è§’åº¦æ¥çœ‹ï¼‰" class="headerlink" title="16. ä½¿ç”¨ä¸€ä¸ªé«˜ä¸”ç²¾å‡†çš„ä»·æ ¼å¼€å§‹è°ˆä»· ï¼ˆä»å•†å®¶è§’åº¦æ¥çœ‹ï¼‰"></a>16. ä½¿ç”¨ä¸€ä¸ªé«˜ä¸”ç²¾å‡†çš„ä»·æ ¼å¼€å§‹è°ˆä»· ï¼ˆä»å•†å®¶è§’åº¦æ¥çœ‹ï¼‰</h4><p>åŸºäºé”šå®šæ•ˆåº”ï¼Œä½¿ç”¨ä¸€ä¸ªæ›´é«˜çš„ä»·æ ¼ï¼Œå¾€å¾€èƒ½å¤Ÿä½¿å¾—æœ€åå•†å®šçš„ä»·æ ¼æ›´é«˜ã€‚æˆ‘ä»¬ä¸ä»…ä»…åº”è¯¥ä½¿ç”¨ä¸€ä¸ªæ›´é«˜çš„ä»·æ ¼ï¼Œæ›´åº”è¯¥ä½¿ç”¨ä¸€ä¸ªæ›´åŠ ç²¾ç¡®çš„ä»·æ ¼ã€‚</p><blockquote><p>If adjustment is viewed as movement along a subjective representational scale, then the resolution of this scale might also influence the amount of adjustment. X units of adjustment along a fine-resolution scale will cover less objective distance than the same number of units of adjustment along a coarse-resolution scale.</p></blockquote><h4 id="17-ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„å…¶ä»–ä»·æ ¼"><a href="#17-ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„å…¶ä»–ä»·æ ¼" class="headerlink" title="17. ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„å…¶ä»–ä»·æ ¼"></a>17. ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„å…¶ä»–ä»·æ ¼</h4><p>åŒæ ·æ˜¯é€šè¿‡é”šå®šæ•ˆåº”å®Œæˆæ“ä½œçš„ï¼Œå³ ä½¿äººä»¬èƒ½å¤Ÿçœ‹åˆ°æ›´é«˜çš„ä»·æ ¼ï¼Œé‚£ä¼šæ½œæ„è¯†å½“ä¸­ä¹Ÿæé«˜å¯¹ä½ çš„äº§å“çš„ä¼°ä»·ã€‚</p><h4 id="18-ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„æ•°å­—"><a href="#18-ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„æ•°å­—" class="headerlink" title="18. ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„æ•°å­—"></a>18. ä½¿ç”¨æˆ·çœ‹åˆ°æ›´é«˜çš„æ•°å­—</h4><p>ä¾æ—§æ˜¯æ½œæ„è¯†ï¼Œåœ¨å±•ç¤ºä»·æ ¼ä¹‹å‰ï¼Œå…ˆä½¿ç”¨æˆ·çœ‹åˆ°ä¸€äº›å¾ˆå¤§çš„æ•°å­—ï¼Œè¿™å·²ç»è¶³å¤Ÿæ¥å½±å“ç”¨æˆ·æ¥ä¸‹æ¥å¯¹äºæ•°å­—ç›¸å¯¹å¤§å°çš„è®¤çŸ¥äº†ã€‚</p><p><img src="https://i.loli.net/2020/06/03/qKZ352bCYk9zPVE.png" alt="pricing-tactic-18.png"></p><h4 id="19-æé«˜è¿‡å»äº§å“çš„å”®ä»·"><a href="#19-æé«˜è¿‡å»äº§å“çš„å”®ä»·" class="headerlink" title="19. æé«˜è¿‡å»äº§å“çš„å”®ä»·"></a>19. æé«˜è¿‡å»äº§å“çš„å”®ä»·</h4><p>å¦‚æœä½ æ­£åœ¨æ¨å‡ºä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬çš„äº§å“ï¼Œé’ˆå¯¹è¡Œä¸šï¼Œæ˜¯å¯ä»¥å°è¯•æé«˜å‰ä¸€ä»£çš„äº§å“çš„å”®ä»·çš„ã€‚æ–°äº§å“çš„å‚è€ƒä»·æ ¼ä¼šä¾æ‰˜äºä¸Šä¸€ä»£çš„äº§å“ï¼Œå¦‚æœæˆ‘ä»¬é™ä»·äº†çš„è¯ï¼Œé‚£æ–°ä¸€ä»£äº§å“é”šå®šçš„æ˜¯ä¸Šä¸€ä»£äº§å“ï¼Œä¼šè®©ç”¨æˆ·æœ‰è¿™ä¸€ä»£äº§å“ç›¸å¯¹æ¯”è¾ƒè´µçš„æ„Ÿè§‰ã€‚</p><h4 id="20-ä»·æ ¼æ’åºåº”è¯¥ä»é«˜åˆ°ä½"><a href="#20-ä»·æ ¼æ’åºåº”è¯¥ä»é«˜åˆ°ä½" class="headerlink" title="20. ä»·æ ¼æ’åºåº”è¯¥ä»é«˜åˆ°ä½"></a>20. ä»·æ ¼æ’åºåº”è¯¥ä»é«˜åˆ°ä½</h4><p>é€šè¿‡é™åºçš„æ’åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¾—ç”¨æˆ·æ›´æœ‰å¯èƒ½å»ä¹°ç›¸å¯¹æ¯”è¾ƒè´µçš„é€‰æ‹©ã€‚</p><p>é¦–å…ˆï¼Œå…ˆçœ‹åˆ°çš„ä»·æ ¼ä¼šæˆä¸ºæˆ‘ä»¬çš„å‚è€ƒä»·æ ¼ï¼Œå¦‚æœåˆå§‹ä»·æ ¼æ¯”è¾ƒé«˜ï¼Œç”¨æˆ·å°±ä¼šç”Ÿæˆä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒé«˜çš„å‚è€ƒä»·æ ¼ã€‚è¿™æ ·å­çš„è¯ï¼Œå½“æˆ‘ä»¬é™åºæ’åˆ—ï¼Œçœ‹åˆ°çš„æ–°çš„äº§å“å¾€å¾€æ„Ÿè§‰éƒ½ä¼šç›¸å¯¹æ›´æœ‰æ€§ä»·æ¯”å¥½ä¸€äº›ï¼Œå°±æ›´å®¹æ˜“è¾¾æˆäº¤æ˜“ï¼Œä¸”å¹³å‡å€¼ä¹Ÿä¼šç›¸å¯¹å¤§ä¸€äº›ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯äººä»¬å¯¹äºå¤±å»çš„åŒæ¶ï¼Œä»·æ ¼ä»ä½åˆ°é«˜æ’åˆ—ï¼Œå¤±å»çš„æ˜¯ä»·æ ¼çš„ä¼˜åŠ¿æ„Ÿè§‰ï¼Œç›´è§‰ååº”æ˜¯åº”è¯¥é€‰ä½ä»·çš„æ¥å‡å°‘æŸå¤±ã€‚ä»·æ ¼ä»é«˜åˆ°ä½ï¼Œæ„Ÿè§‰å¤±å»çš„æ˜¯å“è´¨ï¼Œç›´è§‰åº”è¯¥æ˜¯é€‰é«˜å“è´¨çš„ç‰©å“ï¼Œå“ªæ€•ä»·æ ¼é«˜ä¸€äº›ã€‚ä¸­é—´å½“ç„¶æœ‰æƒè¡¡ã€‚</p><h4 id="21-å°†ä»·æ ¼æ”¾åœ¨å¤§æ•°é‡çš„å³é¢-11"><a href="#21-å°†ä»·æ ¼æ”¾åœ¨å¤§æ•°é‡çš„å³é¢-11" class="headerlink" title="21. å°†ä»·æ ¼æ”¾åœ¨å¤§æ•°é‡çš„å³é¢[11]"></a>21. å°†ä»·æ ¼æ”¾åœ¨å¤§æ•°é‡çš„å³é¢[11]</h4><ul><li><p>å‰ææ¡ä»¶</p><ul><li><p>å•ä»·è®¡ç®—åº”è¯¥æ˜¯ç›¸å¯¹æ¯”è¾ƒå›°éš¾çš„</p><ul><li>å½“å›°éš¾çš„æ—¶å€™ï¼Œä¼šæ›´ä¾èµ–äºç›´è§‰å»è¿›è¡Œåˆ¤æ–­<ul><li>ä»·æ ¼å¼€å§‹ï¼Œæ³¨æ„åŠ›é›†ä¸­åœ¨èŠ±è´¹</li><li>æ•°é‡å¼€å§‹ï¼Œæ³¨æ„åŠ›é›†ä¸­åœ¨æ½œåœ¨çš„å¥½å¤„</li></ul></li></ul></li><li><p>ç‰©å“æ•°é‡æœ€å¥½å¤§äºä»·æ ¼çš„æ•°å­—</p><ul><li>é”šå®šäºæ•°é‡ï¼Œå¿½ç•¥ä»·æ ¼</li><li>ä»è€Œè®¤ä¸ºè¿™æ˜¯ä¸ªå¾ˆå€¼å¾—ä¹°çš„ä¸œè¥¿</li></ul></li></ul></li></ul><h1 id="3-å¼ºè°ƒå‚è€ƒä»·æ ¼ä¹‹é—´çš„ä¸åŒ-é¸¿æ²Ÿ"><a href="#3-å¼ºè°ƒå‚è€ƒä»·æ ¼ä¹‹é—´çš„ä¸åŒ-é¸¿æ²Ÿ" class="headerlink" title="3. å¼ºè°ƒå‚è€ƒä»·æ ¼ä¹‹é—´çš„ä¸åŒ/é¸¿æ²Ÿ"></a>3. å¼ºè°ƒå‚è€ƒä»·æ ¼ä¹‹é—´çš„ä¸åŒ/é¸¿æ²Ÿ</h1><h4 id="22-åŠ å…¥è§†è§‰ä¸Šçš„å”®ä»·å¯¹æ¯”"><a href="#22-åŠ å…¥è§†è§‰ä¸Šçš„å”®ä»·å¯¹æ¯”" class="headerlink" title="22. åŠ å…¥è§†è§‰ä¸Šçš„å”®ä»·å¯¹æ¯”"></a>22. åŠ å…¥è§†è§‰ä¸Šçš„å”®ä»·å¯¹æ¯”</h4><p>å¦‚æœä½ å°†è‡ªå·±çš„ä»·æ ¼å’Œæ›´é«˜çš„å…¶ä»–äº§å“ä»·æ ¼å¯¹æ¯”ï¼Œé‚£ä¹ˆäººä»¬å°±æ›´å¯èƒ½å»ä¹°ä½ çš„äº§å“ï¼Œå› ä¸ºæœ‰äº†å¯¹æ¯”ä»¥åä¼šç›¸å¯¹å°‘ä¸€äº›è‡ªè¡Œå»æ¯”ä»·çš„åŠ¨åŠ›äº†ã€‚</p><p>ä¸€äº›å°æŠ€å·§ï¼š</p><ul><li>å¦‚æœè§†è§‰ä¸Šä½¿ç”¨ä¸åŒå¤§å°ï¼Œæˆ–è€…é¢œè‰²ï¼Œæˆ‘ä»¬ä¼šç»™æ¶ˆè´¹è€…ä¸€ç§å¾ˆæµç¨‹çš„ä½“éªŒï¼Œæ¶ˆè´¹è€…ä¼šæœ‰å°†é¢œè‰²çš„ä¸åŒå’Œä»·æ ¼ä¸Šä¸åŒç¨‹åº¦åšé€šæ„Ÿçš„è¶‹å‘ã€‚[12]</li><li>å‡ºäº†é¢œè‰²å’Œå¤§å°ï¼Œè§†è§‰ä¸Šçš„è·ç¦»ä¹Ÿä¼šå¯¹æ¶ˆè´¹è€…äº§ç”Ÿçš„å¯¹ä»·æ ¼é«˜ä½çš„æ¦‚å¿µäº§ç”Ÿå½±å“ï¼Œè·ç¦»è¿œä¼šè®¤ä¸ºæ•°å­—å·®çš„ä¼šæ›´å¤§[13]</li></ul><h4 id="23-æä¾›ä¸€ä¸ªâ€œè¯±é¥µâ€çš„è´­ä¹°é€‰æ‹©"><a href="#23-æä¾›ä¸€ä¸ªâ€œè¯±é¥µâ€çš„è´­ä¹°é€‰æ‹©" class="headerlink" title="23. æä¾›ä¸€ä¸ªâ€œè¯±é¥µâ€çš„è´­ä¹°é€‰æ‹©"></a>23. æä¾›ä¸€ä¸ªâ€œè¯±é¥µâ€çš„è´­ä¹°é€‰æ‹©</h4><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><ul><li>æä¾›ä¸‰ä¸ªè´­ä¹°é€‰æ‹©<ul><li>web only $59</li><li>print only $125 </li><li>web and print $125 </li></ul></li></ul><p>å¾ˆå¤šäººè‚¯å®šå’Œæˆ‘ä¸€æ ·ï¼Œåˆšå¼€å§‹çœ‹åˆ°çš„æ—¶å€™ä¼šè®¤ä¸ºç¬¬äºŒä¸ªé€‰æ‹©æ˜¯é”™è¯¯çš„ï¼Œç”¨åŒç­‰ä»·æ ¼ï¼Œå¯ä»¥è´­ä¹°ç½‘é¡µç‰ˆå’Œçº¸è´¨ç‰ˆï¼Œé‚£ä¹ˆè°ä¼šåªé€‰æ‹©çº¸è´¨ç‰ˆå‘¢ï¼Ÿ å½“æ—¶ç»è¿‡è¯•éªŒå‘ç°å°±æ˜¯è¿™ä¸ªprint onlyçš„çœ‹ä¼¼æ— ç”¨çš„é€‰æ‹©ï¼Œäº§ç”Ÿäº†é”šå®šæ•ˆåº”ï¼Œå³ç”¨æˆ·å¯¹äºå¦‚ä½•ç•Œå®šå…³äºweb å’Œ print onlyè‡ªå·±åº”è¯¥ä»˜å¤šå°‘é’±çš„è®¤çŸ¥ï¼Œé€šè¿‡æ”¾ç½®print onlyçš„é€‰æ‹©ï¼Œæœ€ç»ˆé€‰å–web and printçš„äººè¦å¤šå¾ˆå¤šï¼Œæ•´ä½“GMSä¹Ÿæœ‰äº†å¾ˆå¤§æé«˜ã€‚ </p><p><img src="https://i.loli.net/2020/06/05/C964yTjH2awuzqP.png" alt="psychological-pricing-table-3.png"></p><p><img src="https://i.loli.net/2020/06/05/KqY14GgLlTMkbWy.png" alt="psychological-pricing-table-4.png"></p><h1 id="4-å‡å°‘ä»˜æ¬¾çš„â€œå¿ƒç–¼æ„Ÿâ€"><a href="#4-å‡å°‘ä»˜æ¬¾çš„â€œå¿ƒç–¼æ„Ÿâ€" class="headerlink" title="4. å‡å°‘ä»˜æ¬¾çš„â€œå¿ƒç–¼æ„Ÿâ€"></a>4. å‡å°‘ä»˜æ¬¾çš„â€œå¿ƒç–¼æ„Ÿâ€</h1><h4 id="24-ç§»é™¤è´§å¸ç¬¦å·"><a href="#24-ç§»é™¤è´§å¸ç¬¦å·" class="headerlink" title="24. ç§»é™¤è´§å¸ç¬¦å·"></a>24. ç§»é™¤è´§å¸ç¬¦å·</h4><p>ä»˜æ¬¾çš„å¿ƒç–¼æ„Ÿæ˜¯å¾ˆå®¹æ˜“è¢«è§¦å‘çš„ï¼Œäº‹å®ä¸Šè´§å¸ç¬¦å·æœ¬èº«å°±å¾ˆå®¹æ˜“è§¦å‘è¿™ç§æƒ…ç»ªï¼Œè®©äººä»¬æƒ³èŠ±çš„æ›´å°‘ã€‚[14]</p><p>åŒæ ·ï¼Œéœ€è¦å–èˆï¼Œå³ä½ æ”¾åœ¨è¿™é‡Œçš„æ•°å­—å¦‚æœæ²¡æœ‰è´§å¸ç¬¦å·ï¼Œæ˜¯å¦ä¼šå˜å¾—éš¾ä»¥è®¤æ¸…ï¼Œéš¾ä»¥æ˜ç™½è¿™ä¸²æ•°å­—ä»£è¡¨ä»·æ ¼ï¼Œæ˜¯éœ€è¦åštrade-offçš„ã€‚</p><h4 id="25-åœ¨ç”¨æˆ·ä½¿ç”¨å‰ä»¤ä»–ä»¬ä»˜è´¹"><a href="#25-åœ¨ç”¨æˆ·ä½¿ç”¨å‰ä»¤ä»–ä»¬ä»˜è´¹" class="headerlink" title="25. åœ¨ç”¨æˆ·ä½¿ç”¨å‰ä»¤ä»–ä»¬ä»˜è´¹"></a>25. åœ¨ç”¨æˆ·ä½¿ç”¨å‰ä»¤ä»–ä»¬ä»˜è´¹</h4><p>é¢„ä»˜å¯¹é“¾æ¡ä¸­çš„æ‰€æœ‰è§’è‰²éƒ½æœ‰ä¾‹ã€‚å¯¹äºç”Ÿäº§æ–¹ï¼Œé¦–å…ˆå¯ä»¥å‡å°‘èµ„é‡‘çš„å‹åŠ›ï¼›å¯¹äºæ¶ˆè´¹è€…ï¼Œé¢„ä»˜å¾€å¾€ä¼šä½¿å¾—ä»–ä»¬å¯¹äº§å“æ›´åŠ æ»¡æ„ï¼Œå› ä¸ºå½“å…ˆä»˜æ¬¾çš„æ—¶å€™ï¼Œä»–ä»¬ä¼šæ›´åŠ ä¸“æ³¨äºè´­ä¹°äº†ç‰©å“ä»¥åä»–ä»¬è·å¾—çš„å¥½å¤„ï¼Œè€Œä¸æ˜¯èŠ±äº†é’±çš„ç—›æ„Ÿå½“ä¸­ã€‚å¦‚æœä»–ä»¬å·²ç»ä½¿ç”¨äº†ä½ çš„äº§å“å†ä»˜è´¹ï¼Œå¾€å¾€ä¼šæ›´ä¸æƒ…æ„¿ä»˜æ¬¾çš„ã€‚[15]</p><p>è¿™å¯¹äºé‚£ç§æ”¶æœˆåº¦ä¼šå‘˜è´¹çš„æ¨¡å¼å¾ˆæœ‰æ„ä¹‰ï¼Œå¦‚æœæ˜¯è¿™ç§æ¨¡å¼ï¼Œé‚£å°±åº”è¯¥åœ¨æœˆåˆè¿˜æ²¡å¼€å§‹ä½¿ç”¨çš„æ—¶å€™å…ˆæ”¶è´¹ã€‚å½“ç„¶ç»éªŒä¹Ÿå‘Šè¯‰æˆ‘ä»¬ç¡®ç¡®å®å®ç°åœ¨å¤§éƒ¨åˆ†çš„å•†å®¶éƒ½æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><p>åŒæ—¶ä¸è¦åœ¨æœˆåº•æ¥æ¨é€ä½ è¿™ä¸ªæœˆæ€»å…±èŠ±äº†å¤šå°‘é’±ä¹‹ç±»çš„è´¦å•æ˜ç»†ï¼Œè¿™åªä¼šé™ä½æ¶ˆè´¹è€…çš„è´­ä¹°æ¬²æœ›ã€‚</p><h4 id="26-å¯¹éå·¥å…·ç±»çš„äº§å“ç»™å¤šä»¶æŠ˜æ‰£"><a href="#26-å¯¹éå·¥å…·ç±»çš„äº§å“ç»™å¤šä»¶æŠ˜æ‰£" class="headerlink" title="26. å¯¹éå·¥å…·ç±»çš„äº§å“ç»™å¤šä»¶æŠ˜æ‰£"></a>26. å¯¹éå·¥å…·ç±»çš„äº§å“ç»™å¤šä»¶æŠ˜æ‰£</h4><p>ä¸ºäº†å‡å°‘ä»˜è´¹æ—¶å€™çš„ç—›æ„Ÿï¼Œå¯ä»¥è€ƒè™‘æˆå¥—é”€å”®ã€‚æˆå¥—æ¥è´­ä¹°çš„æ—¶å€™ï¼Œç”¨æˆ·å°±å¾ˆéš¾ç»™å•ä»¶äº§å“ä¸€ä¸ªå¾ˆæ¸…æ™°çš„å®šä»·äº†ã€‚è€Œæ·»åŠ çš„äº§å“æœ€å¥½æ˜¯éå·¥å…·ç±»çš„ï¼Œå³ä½¿ç”¨çš„æ—¶å€™ä¼šç»™äººå¸¦æ¥ä¸€äº›æ„‰æ‚¦çš„æ„Ÿè§‰çš„ç‰©å“ã€‚åœ¨åšæè¿°çš„æ—¶å€™ï¼Œä¹Ÿè¦æ³¨æ„ç€é‡å»æè¿°ä¸€äº›å¥½ç©çš„åœºæ™¯ï¼Œè€…éƒ½ä¼šç»™ç”¨æˆ·å¸¦æ¥æ„‰æ‚¦çš„åˆºæ¿€ï¼Œæé«˜æœ€ç»ˆçš„ä»˜è´¹æ¯”ç‡ã€‚</p><h4 id="27-ä¸è¦å°†ä»·æ ¼æ˜‚è´µå’Œä¾¿å®œçš„ç‰©å“ä¸€èµ·æˆå¥—é”€å”®"><a href="#27-ä¸è¦å°†ä»·æ ¼æ˜‚è´µå’Œä¾¿å®œçš„ç‰©å“ä¸€èµ·æˆå¥—é”€å”®" class="headerlink" title="27. ä¸è¦å°†ä»·æ ¼æ˜‚è´µå’Œä¾¿å®œçš„ç‰©å“ä¸€èµ·æˆå¥—é”€å”®"></a>27. ä¸è¦å°†ä»·æ ¼æ˜‚è´µå’Œä¾¿å®œçš„ç‰©å“ä¸€èµ·æˆå¥—é”€å”®</h4><p>è¿™æ ·å»ºè®®çš„åŸå› æ˜¯ä¾¿å®œçš„ç‰©å“ä¼šæ”¹å˜æ¶ˆè´¹è€…å¯¹äºæ˜‚è´µäº§å“çš„è®¤çŸ¥ï¼Œä¼šè®¤ä¸ºå…¶æ›´è´µï¼Œæ›´ä¸å€¼é’±ã€‚ </p><h4 id="28-å°†å…³æ³¨ç‚¹è½¬ç§»åˆ°æ—¶é—´ç›¸å…³çš„æ–¹é¢"><a href="#28-å°†å…³æ³¨ç‚¹è½¬ç§»åˆ°æ—¶é—´ç›¸å…³çš„æ–¹é¢" class="headerlink" title="28. å°†å…³æ³¨ç‚¹è½¬ç§»åˆ°æ—¶é—´ç›¸å…³çš„æ–¹é¢"></a>28. å°†å…³æ³¨ç‚¹è½¬ç§»åˆ°æ—¶é—´ç›¸å…³çš„æ–¹é¢</h4><p>å½“æè¿°æˆ‘ä»¬çš„äº§å“çš„æ—¶å€™ï¼Œå°½é‡é¿å…ç”¨é‡‘é’±ä½œä¸ºå‚è€ƒçš„æè¿°ã€‚ç›¸åï¼Œä½¿ç”¨æ—¶é—´æ¦‚å¿µæ¥æè¿°ã€‚</p><p>è­¬å¦‚ï¼ŒMogilnerï¼ŒAaker[16]åšè¿‡çš„ä¸€ä¸ªå…³äºæŸ æª¬é¥®å“çš„è¯•éªŒï¼Œä»–ä»¬åšäº†ä¸‰ä¸ªå¼ºè°ƒä¸åŒå±æ€§çš„å¹¿å‘Šï¼š</p><ul><li>Time: Spend a little time and enjoy C &amp; Dâ€™s lemonade</li><li>Money: Spend a little money and enjoy C &amp; Dâ€™s lemonade</li><li>Neutral: Enjoy C &amp; Dâ€™s lemonade</li></ul><p>å®éªŒç»“æœå‘ç°æ—¶é—´ç›¸å…³çš„å¹¿å‘Šç©è™å…¶ä»–ä¸¤ä¸ªï¼Œç›¸è¾ƒè€Œè¨€ï¼Œäººä»¬æ„¿æ„ä»˜åŒå€çš„ä»·æ ¼æ¥è´­ä¹°æŸ æª¬æ±ã€‚</p><h4 id="29-å»ºç«‹ä»˜è´¹ä¸­è½¬å•†"><a href="#29-å»ºç«‹ä»˜è´¹ä¸­è½¬å•†" class="headerlink" title="29. å»ºç«‹ä»˜è´¹ä¸­è½¬å•†"></a>29. å»ºç«‹ä»˜è´¹ä¸­è½¬å•†</h4><p>èµŒåœºä½¿ç”¨ä»£å¸è€Œä¸æ˜¯ç°é‡‘ï¼Œç¤¼å“å¡å°†é’±æå‰å­˜è¿›å»ï¼Œè¿™æ ·åšçš„å¥½å¤„å®é™…ä¸Šå°±æ˜¯å°†æˆ‘ä»¬æŠŠé’±æ‹¿å‡ºå£è¢‹çš„åŠ¨ä½œå‘ç”Ÿçš„æ—¶é—´å‰ç§»ï¼Œå’Œæˆ‘ä»¬äº«ç”¨çš„æ—¶é—´åˆ†å‰²å¼€ã€‚è¿™æ ·å°±èƒ½å¤Ÿæ‰­æ›²ä»˜è´¹æ—¶å€™çš„ç«‹åœºï¼Œä½¿å¾—ä¸ä¼šè§‰å¾—é‚£ä¹ˆçš„ç—›è‹¦ã€‚</p><p>è¿™æ ·åšè¡Œä¹‹æœ‰æ•ˆçš„åŸå› æ˜¯å› ä¸ºäººéƒ½æ˜¯æ‡’çš„ï¼Œä¼šä¸æ„¿æ„å»ç®—å„ç§æ–¹å¼çš„è½¬åŒ–ç‡çš„é—®é¢˜.</p><h4 id="30-é¿å…ç›´æ¥è”ç³»åˆ°é‡‘é’±çš„è¯­è¨€"><a href="#30-é¿å…ç›´æ¥è”ç³»åˆ°é‡‘é’±çš„è¯­è¨€" class="headerlink" title="30. é¿å…ç›´æ¥è”ç³»åˆ°é‡‘é’±çš„è¯­è¨€"></a>30. é¿å…ç›´æ¥è”ç³»åˆ°é‡‘é’±çš„è¯­è¨€</h4><p>the money in your account vs your credits </p><p>é€šè¿‡å°½é‡é¿å…å°†appå†…çš„ç‚¹æ•°å’Œå®é™…é‡‘é’±æŒ‚é’©ï¼Œå°±ä¼šä½¿å¾—ç”¨æˆ·å¤±å»å¯¹äºé’±çš„æŸäº›æ¦‚å¿µã€‚</p><p>åŒæ—¶ï¼Œå¯ä»¥çš„è¯ä¸è¦åš1æ¯”1 çš„è½¬åŒ–ï¼Œå¤ªå®¹æ˜“åšè¿™ä¸ªè®¡ç®—äº†ã€‚å¯ä»¥ææ¯”å¦‚è¯´å­˜100é€10å—ä¹‹ç±»çš„ï¼Œè¿™æ ·çš„è½¬åŒ–å°±ä¼šåœ¨1 - 1.1ä¹‹é—´ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè®¡ç®—çš„éš¾åº¦ä¸Šæ¥ï¼Œè¿™æ ·è®¡ç®—çš„äººå°±ä¼šå°‘å¾ˆå¤šäº†ã€‚</p><h4 id="31-å¼ºè°ƒä½ çš„äº§å“çš„å›ºå®šæˆæœ¬"><a href="#31-å¼ºè°ƒä½ çš„äº§å“çš„å›ºå®šæˆæœ¬" class="headerlink" title="31. å¼ºè°ƒä½ çš„äº§å“çš„å›ºå®šæˆæœ¬"></a>31. å¼ºè°ƒä½ çš„äº§å“çš„å›ºå®šæˆæœ¬</h4><p>æ¶ˆè´¹è€…ä¼šåœ¨çœ‹åˆ°äº§å“ä»¥ååšå‡ºä¸€ä¸ªä»·æ ¼é«˜ä½çš„åˆ¤æ–­ï¼Œä½†æ˜¯ä»–ä»¬ä¹ŸåŒæ ·åœ¨æ„ä»·æ ¼çš„åˆç†ç¨‹åº¦ã€‚å³ä¾¿ä½ çš„ä»·æ ¼æ˜¯ä½çš„ï¼Œç”¨æˆ·ä»ç„¶å¯èƒ½è®¤ä¸ºè¿™ä¸ªä»·æ ¼ä¸åˆç†ï¼›åŒæ ·ï¼Œå¯¹äºç›¸å¯¹é«˜çš„ä»·æ ¼ï¼Œç”¨æˆ·ä¹Ÿæœ‰å¯èƒ½è®¤ä¸ºéå¸¸åˆé€‚ã€‚è¿™å–å†³äºä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š</p><ul><li>ä½ å¦‚ä½•å®šä»·çš„ï¼Ÿ<ul><li>åŸºäºæˆæœ¬çš„å®šä»·</li><li>åŸºäºä¾›æ±‚çš„å®šä»·</li></ul></li></ul><p>ç”¨æˆ·ä¼šè®¤ä¸ºåŸºäºæˆæœ¬çš„å®šä»·æ›´åŠ å…¬å¹³ï¼Œè¿™ä¹Ÿæ˜¯ä½ å¯ä»¥é€šè¿‡å¼ºè°ƒäº§å“æœ¬èº«çš„æˆæœ¬ä»è€Œç»™å‡ºä»·æ ¼å¾ˆåˆé€‚çš„è®¤çŸ¥çš„åŸå› ã€‚å¼ºè°ƒä½ çš„äº§å“çš„åŸææ–™éå¸¸å¥½ï¼Œæˆ–è€…å…¶ä»–å¾ˆè´¹é’±çš„æ–¹é¢ï¼Œè¿™äº›ä¿¡æ¯ä¼šä½¿å¾—ç”¨æˆ·å¯¹ä½ çš„äº§å“ä»·æ ¼æœ‰ä¸ªæ›´çœŸåˆ‡çš„è®¤çŸ¥ã€‚</p><h4 id="32-å¯¹äºç›¸ä¼¼çš„äº§å“ï¼Œä»·æ ¼éœ€è¦æœ‰ä¸€ç‚¹ä¸åŒ"><a href="#32-å¯¹äºç›¸ä¼¼çš„äº§å“ï¼Œä»·æ ¼éœ€è¦æœ‰ä¸€ç‚¹ä¸åŒ" class="headerlink" title="32. å¯¹äºç›¸ä¼¼çš„äº§å“ï¼Œä»·æ ¼éœ€è¦æœ‰ä¸€ç‚¹ä¸åŒ"></a>32. å¯¹äºç›¸ä¼¼çš„äº§å“ï¼Œä»·æ ¼éœ€è¦æœ‰ä¸€ç‚¹ä¸åŒ</h4><p>ä½ ä¹Ÿè®¸ç»å†è¿‡é€‰æ‹©å›°éš¾ç—‡ï¼Œå¾€å¾€æ˜¯é€‰æ‹©è¶Šå¤šï¼Œäººä»¬å°±è¶Šéš¾ä»¥åšå‡ºé€‰æ‹©ã€‚ä¸€æ—¦äººä»¬åšå‡ºä¸€ä¸ªé€‰æ‹©ï¼Œä»–ä»¬å°±ä¼šå¤±å»å…¶ä»–é€‰æ‹©å¯èƒ½å¸¦æ¥çš„åˆ©ç›Šã€‚å› ä¸ºå¯¹äºå¤±å»çš„åŒæ¶ï¼Œä»–ä»¬å°±ä¼šæ¨è¿Ÿè‡ªå·±çš„å†³å®šï¼Œå°¤å…¶æ˜¯å½“æ›´å¤šçš„é€‰æ‹©åœ¨çš„æ—¶å€™ã€‚</p><p>åŒæ ·æœ‰ç ”ç©¶è€…åšè¿‡è¿™æ ·çš„å®éªŒï¼Œå®éªŒè€…è¯¢é—®ä¸¤ç»„å‚ä¸è€…æ˜¯å¦æƒ³è¦ä¹°ä¸€ç›’å£é¦™ç³–ï¼Œæ¯ç»„éƒ½æœ‰ä»¥ä¸‹ä¸¤ç§é€‰æ‹©</p><ul><li>ç»„1ï¼š åŒæ ·ä»·æ ¼</li><li>ç»„2ï¼š ç¨ç¨ä¸åŒçš„ä»·æ ¼ (62ç¾åˆ† vs 64ç¾åˆ†)</li></ul><p><img src="https://i.loli.net/2020/06/05/2RWLMOteuDTbxpC.png" alt="price-differences.png"></p><p>å®éªŒç»“æœå‘ç°å½“ä»·æ ¼ç¨ç¨æœ‰äº›ä¸åŒçš„æ—¶å€™ï¼Œäººä»¬æ›´æœ‰å¯èƒ½å»ä¹°ä¸€ç›’å£é¦™ç³–ã€‚</p><p>å½“ä¸¤ä¸ªäº§å“æœ‰åŒæ ·çš„ä»·æ ¼çš„æ—¶å€™ï¼Œäººä»¬æ— æ³•ç«‹åˆ»åŒºåˆ†äºŒè€…çš„ä¸åŒï¼Œé‚£ä¹ˆä»–ä»¬åªèƒ½è‡ªå·±ä¸»åŠ¨å»å¯»æ‰¾ç‰¹å¾ä¸Šçš„ä¸åŒã€‚å› ä¸ºä¸»åŠ¨å¯»æ‰¾ï¼Œæ‰€ä»¥äº§å“çš„ä¸åŒä¼šçœ‹ç€æ›´åŠ æ˜æ˜¾ã€‚</p><p>ç„¶è€Œï¼Œå½“ä½ ç»™ä»·æ ¼åŠ ä¸Šä¸€ç‚¹ç‚¹ä¸åŒçš„æ—¶å€™ï¼Œä½ å‡å°‘äº†æœç´¢ä¸åŒçš„éœ€æ±‚ã€‚æ¶ˆè´¹è€…å¯ä»¥å¾ˆç›´æ¥çš„é€šè¿‡ä»·æ ¼æ¥åŒºåˆ†ä¸åŒçš„äº§å“ã€‚å› ä¸ºç”¨æˆ·å¯¹äºäº§å“çš„ä¸åŒå…³æ³¨çš„æ›´å°‘ï¼Œä¸¤ä¸ªäº§å“ç›´è§‚ä¸Šå°±ä¼šçœ‹èµ·æ¥æ›´åŠ é›·æ–¯äº†ã€‚è¿™ç§ç›¸ä¼¼æ€§æ˜¯çš„äººä»¬æ›´å¯èƒ½å»é€‰æ‹©ä¸€ä¸ªäº§å“ã€‚</p><p><img src="https://i.loli.net/2020/06/05/6JD8M4dX2Rlfor5.png" alt="pricing-tactic-32.png"></p><h4 id="33-ä½¿ç”¨æ›´åŠ é¢‘ç¹å°é¢çš„æä»·"><a href="#33-ä½¿ç”¨æ›´åŠ é¢‘ç¹å°é¢çš„æä»·" class="headerlink" title="33. ä½¿ç”¨æ›´åŠ é¢‘ç¹å°é¢çš„æä»·"></a>33. ä½¿ç”¨æ›´åŠ é¢‘ç¹å°é¢çš„æä»·</h4><p>æœ€ç®€å•çš„æ§åˆ¶å¯¹äºä»·æ ¼ç›¸å¯¹é«˜ä½çš„æ¦‚å¿µçš„æ–¹æ³•æ˜¯æ ¹äºåˆšåˆšèƒ½æ³¨æ„åˆ°çš„ä¸åŒã€‚æ¯”å¦‚ä½ çš„ä»·æ ¼æ˜¯11.99ï¼Œé‚£ä¹ˆåŠ åˆ°12.99ç®—æ¯”è¾ƒåˆç†çš„ï¼ŒåŠ åˆ°19.99å°±ä¼šå¾ˆå¤¸å¼ äº†</p><h4 id="34-å‡å°æŸç‰¹å¾-vs-æä»·"><a href="#34-å‡å°æŸç‰¹å¾-vs-æä»·" class="headerlink" title="34. å‡å°æŸç‰¹å¾ vs æä»·"></a>34. å‡å°æŸç‰¹å¾ vs æä»·</h4><p>é™¤äº†æä»·ï¼Œå¦å¤–å¯ä»¥é€‰æ‹©çš„æ˜¯åœ¨åˆ†é‡ä¸Šï¼ŒæŸä¸ªç‰¹å¾ä¸Šçš„ä¸€å®šç¨‹åº¦çš„å‡å°‘ã€‚åŒæ ·è¦éµå¾ªç€å°é¢å¤šæ¬¡çš„å®—æ—¨ï¼Œä¸€ç‚¹ç‚¹æ¥ã€‚ </p><h1 id="5-é€‚é‡ä½¿ç”¨æŠ˜æ‰£"><a href="#5-é€‚é‡ä½¿ç”¨æŠ˜æ‰£" class="headerlink" title="5. é€‚é‡ä½¿ç”¨æŠ˜æ‰£"></a>5. é€‚é‡ä½¿ç”¨æŠ˜æ‰£</h1><p>å¦‚æœæ²¡æœ‰åˆç†ä½¿ç”¨ï¼ŒæŠ˜æ‰£æ˜¯æœ‰å¯èƒ½ä¼¤å®³ä½ çš„äº‹ä¸šçš„ã€‚ä¹Ÿæœ‰äººå°æç«¯ï¼Œè®¤ä¸ºæˆ‘ä»¬æ°¸è¿œä¸åº”è¯¥ä½¿ç”¨æŠ˜æ‰£ [17]. å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æŠ˜æ‰£ååˆ†é¢‘ç¹ï¼Œæˆ–è€…æŠ˜æ‰£åŠ›åº¦å¤ªå¤§ï¼Œæ˜¯ä¼šä½¿å¾—æ¶ˆè´¹è€…å¯¹äºäº§å“ï¼Œå“ç‰Œçš„è®¤çŸ¥æ”¹å˜çš„ã€‚æ¶ˆè´¹è€…å¯èƒ½ä¼šç­‰å¾…ä¸‹ä¸€ä¸ªæŠ˜æ‰£æœŸæ‰ä¼šè´­ä¹°äº§å“äº†ã€‚</p><p>åŒæ ·ï¼ŒæŠ˜æ‰£ä¹Ÿä¼šé™ä½ä½ çš„äº§å“çš„å‚è€ƒä»·æ ¼ï¼Œä½¿å¾—äººä»¬æœªæ¥æ›´å°‘ä¹°ï¼ˆå› ä¸ºè§‰å¾—ä½ çš„å½“å‰ä»·æ ¼é«˜ï¼‰</p><h4 id="35-éµå¾ª100åŸåˆ™"><a href="#35-éµå¾ª100åŸåˆ™" class="headerlink" title="35. éµå¾ª100åŸåˆ™"></a>35. éµå¾ª100åŸåˆ™</h4><p>å½“ä½ çš„ä»·æ ¼ä½äº100çš„æ—¶å€™ï¼Œä½¿ç”¨ç™¾åˆ†æ¯”æŠ˜æ‰£ï¼Œåä¹‹ç›´æ¥ä½¿ç”¨æ•°å­—ï¼›ç›®çš„æ˜¯ä½¿å¾—æŠ˜æ‰£çš„ç¨‹åº¦çœ‹èµ·æ¥æ›´å¤§ã€‚</p><h4 id="36-ç»™æŠ˜æ‰£ä¸€ä¸ªåŸå› "><a href="#36-ç»™æŠ˜æ‰£ä¸€ä¸ªåŸå› " class="headerlink" title="36. ç»™æŠ˜æ‰£ä¸€ä¸ªåŸå› "></a>36. ç»™æŠ˜æ‰£ä¸€ä¸ªåŸå› </h4><p>ä¸ºäº†æœ€å¤§åŒ–æŠ˜æ‰£çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬éœ€è¦è§£é‡Šä¸ºä»€ä¹ˆæä¾›è¿™æ ·çš„æŠ˜æ‰£ã€‚</p><p>æ¯”å¦‚every day low pricing store æŒ‡å‘çš„æ˜¯ä¾›åº”å•†ç»™çš„æŠ˜æ‰£ï¼Œå½“ä½ æä¾›æŠ˜æ‰£çš„ç†ç”±çš„æ—¶å€™ï¼Œä½ åœ¨è¯´æ˜ä»–çš„ä¸´æ—¶æ€§ã€‚å› æ­¤äººä»¬ä¸å¤ªä¼šå°†ä½ çš„æŠ˜æ‰£ä»·å’Œä»–å†…åœ¨éšå«çš„å®é™…ä»·å€¼åšå‡ºå¼ºå…³è”ã€‚</p><p><img src="https://i.loli.net/2020/06/05/3TSGCNQscynW6gi.png" alt="pricing-tactic-36.png"></p><h4 id="37-æä¾›æ›´å¥½è®¡ç®—çš„æŠ˜æ‰£"><a href="#37-æä¾›æ›´å¥½è®¡ç®—çš„æŠ˜æ‰£" class="headerlink" title="37. æä¾›æ›´å¥½è®¡ç®—çš„æŠ˜æ‰£"></a>37. æä¾›æ›´å¥½è®¡ç®—çš„æŠ˜æ‰£</h4><p>æä¾›æ›´å¥½è®¡ç®—çš„æŠ˜æ‰£å¯ä»¥æ˜¾å¾—æŠ˜æ‰£æ›´å¤§çš„</p><h4 id="38-åœ¨æœˆæœ«æ‰“æŠ˜"><a href="#38-åœ¨æœˆæœ«æ‰“æŠ˜" class="headerlink" title="38. åœ¨æœˆæœ«æ‰“æŠ˜"></a>38. åœ¨æœˆæœ«æ‰“æŠ˜</h4><p>å½“æˆ‘ä»¬æ€»é’±æ•°å°‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæ›´ä¸æ„¿æ„ä»˜é’±å‡ºå»ã€‚åˆ°äº†æœˆæœ«ï¼Œå¾ˆå¤šäººçš„é’±åŒ…éƒ½ä¼šç©ºä¸‹æ¥ï¼Œå°±ç®—è´­ä¹°ï¼Œä¹Ÿå¾ˆå¯èƒ½åªèƒ½ä¹°æŠ˜æ‰£çš„ä¸œè¥¿äº†ã€‚</p><h4 id="39-å°†ä½ çš„ä¿ƒé”€ä»·æ”¾åœ¨åŸä»·çš„å³ä¾§"><a href="#39-å°†ä½ çš„ä¿ƒé”€ä»·æ”¾åœ¨åŸä»·çš„å³ä¾§" class="headerlink" title="39. å°†ä½ çš„ä¿ƒé”€ä»·æ”¾åœ¨åŸä»·çš„å³ä¾§"></a>39. å°†ä½ çš„ä¿ƒé”€ä»·æ”¾åœ¨åŸä»·çš„å³ä¾§</h4><p>ç ”ç©¶[18]è¡¨æ˜å½“ä¿ƒé”€ä»·æ”¾åœ¨åŸä»·çš„å³è¾¹çš„æ—¶å€™ï¼Œæ¶ˆè´¹è€…ä¼šè§‰å¾—æŠ˜æ‰£æ›´å¤§ä¸€äº›ã€‚</p><h4 id="40-åªç»™ä½ä»·å•†å“æŠ˜æ‰£"><a href="#40-åªç»™ä½ä»·å•†å“æŠ˜æ‰£" class="headerlink" title="40. åªç»™ä½ä»·å•†å“æŠ˜æ‰£"></a>40. åªç»™ä½ä»·å•†å“æŠ˜æ‰£</h4><p>æŠ˜æ‰£æœ‰å¯èƒ½æœ‰å®³çš„ï¼Œå°¤å…¶æ˜¯å½“ä½ ç»“æŸä¸€ä¸ªæŠ˜æ‰£çš„æ—¶å€™ï¼Œäººä»¬å¯èƒ½ä¼šé€‰æ‹©ç«å“ï¼Œæˆ–è€…ç­‰å¾…ä¸‹ä¸€ä¸ªæŠ˜æ‰£æœŸã€‚</p><p>é‚£ä¹ˆè¿™ç§å‰¯ä½œç”¨ä¼šåœ¨ä»€ä¹ˆæ—¶å€™å› ä¸ºä»€ä¹ˆè€Œç”Ÿæ•ˆå‘¢ï¼Ÿ ç­”æ¡ˆåœ¨äºä½ çš„å“ç‰Œçš„å®šä½ï¼Œæ˜¯é«˜è´¨é‡çš„è¿˜æ˜¯ä½è´¨é‡çš„äº§å“ï¼Œé«˜è´¨é‡å•†å“å°±åº”è¯¥é›†ä¸­æ³¨æ„åŠ›äºè´¨é‡</p><h4 id="41-é€æ¸å‡å°æŠ˜æ‰£çš„ç™¾åˆ†æ¯”"><a href="#41-é€æ¸å‡å°æŠ˜æ‰£çš„ç™¾åˆ†æ¯”" class="headerlink" title="41. é€æ¸å‡å°æŠ˜æ‰£çš„ç™¾åˆ†æ¯”"></a>41. é€æ¸å‡å°æŠ˜æ‰£çš„ç™¾åˆ†æ¯”</h4><p>è¿™ç§æ–¹å¼èƒ½å¤Ÿå¸å¼•æµé‡ï¼Œä¹Ÿèƒ½å¤Ÿä¿è¯è‡ªå·±çš„åˆ©æ¶¦ä¸å—åˆ°å¤ªå¤§çš„æŸå®³ã€‚</p><h4 id="42-æŠ˜æ‰£å®Œä»·æ ¼çš„å³ä¾§æ•°å­—éœ€è¦å°ä¸€äº›"><a href="#42-æŠ˜æ‰£å®Œä»·æ ¼çš„å³ä¾§æ•°å­—éœ€è¦å°ä¸€äº›" class="headerlink" title="42. æŠ˜æ‰£å®Œä»·æ ¼çš„å³ä¾§æ•°å­—éœ€è¦å°ä¸€äº›"></a>42. æŠ˜æ‰£å®Œä»·æ ¼çš„å³ä¾§æ•°å­—éœ€è¦å°ä¸€äº›</h4><p>å½“å³ä¾§çš„æ•°å­—å°ï¼Œä¼šæ˜¾å¾—æ•´ä¸ªæŠ˜æ‰£ç›¸å¯¹æ¯”è¾ƒå¤§ã€‚</p><p><img src="https://i.loli.net/2020/06/05/qU7mokILNzFGJ5M.png" alt="right-digit-effect-2.png"></p><p><img src="https://i.loli.net/2020/06/05/KNczCvMyIa2hOrf.png" alt="pricing-tactic-42.png"></p><p><img src="https://i.loli.net/2020/06/05/pfBYcn2QTrbtyJ7.png" alt="psychological-pricing-table5.png"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.nickkolenda.com/psychological-pricing-strategies/" target="_blank" rel="noopener">https://www.nickkolenda.com/psychological-pricing-strategies/</a> </li><li><a href="https://blog.gumroad.com/post/64417917582/a-penny-saved-psychological-pricing" target="_blank" rel="noopener">https://blog.gumroad.com/post/64417917582/a-penny-saved-psychological-pricing</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1057740811001082" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/abs/pii/S1057740811001082</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/001002779290049N" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/abs/pii/001002779290049N</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1057740811001082" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/abs/pii/S1057740811001082</a></li><li><a href="https://www8.gsb.columbia.edu/sites/decisionsciences/files/files/Divide_and_Prosper.pdf" target="_blank" rel="noopener">https://www8.gsb.columbia.edu/sites/decisionsciences/files/files/Divide_and_Prosper.pdf</a></li><li><a href="http://www.dc.uba.ar/materias/incc/practicas/p1/Dehaene-ParitySNARCeffect-JEPGeneral1993.pdf" target="_blank" rel="noopener">www.dc.uba.ar/materias/incc/practicas/p1/Dehaene-ParitySNARCeffect-JEPGeneral1993.pdf</a></li><li><a href="https://journals.ama.org/doi/abs/10.1509/jm.13.0059" target="_blank" rel="noopener">https://journals.ama.org/doi/abs/10.1509/jm.13.0059</a></li><li><a href="https://journals.ama.org/doi/abs/10.1509/jmr.13.0488" target="_blank" rel="noopener">https://journals.ama.org/doi/abs/10.1509/jmr.13.0488</a></li><li><a href="http://www.dhruvgrewal.com/wp-content/uploads/2014/09/2013-JR-Color.pdf" target="_blank" rel="noopener">http://www.dhruvgrewal.com/wp-content/uploads/2014/09/2013-JR-Color.pdf</a></li><li><a href="https://vtechworks.lib.vt.edu/bitstream/handle/10919/49138/661893.pdf?sequence=1&amp;isAllowed=y" target="_blank" rel="noopener">https://vtechworks.lib.vt.edu/bitstream/handle/10919/49138/661893.pdf?sequence=1&amp;isAllowed=y</a></li><li><a href="https://production.wordpress.uconn.edu/businessmarketing/wp-content/uploads/sites/724/2014/08/size-does-matter.pdf" target="_blank" rel="noopener">https://production.wordpress.uconn.edu/businessmarketing/wp-content/uploads/sites/724/2014/08/size-does-matter.pdf</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1057740809000266" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/abs/pii/S1057740809000266</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1057740809000266" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/abs/pii/S1057740809000266</a></li><li><a href="https://www.andrew.cmu.edu/user/gl20/GeorgeLoewenstein/Papers_files/pdf/redblack.pdf" target="_blank" rel="noopener">https://www.andrew.cmu.edu/user/gl20/GeorgeLoewenstein/Papers_files/pdf/redblack.pdf</a></li><li><a href="https://www.jstor.org/stable/10.1086/597161?seq=1" target="_blank" rel="noopener">https://www.jstor.org/stable/10.1086/597161?seq=1</a></li><li><a href="https://socialtriggers.com/why-you-should-never-discount/" target="_blank" rel="noopener">https://socialtriggers.com/why-you-should-never-discount/</a></li><li><a href="https://journals.ama.org/doi/pdf/10.1509/jm.12.0052" target="_blank" rel="noopener">https://journals.ama.org/doi/pdf/10.1509/jm.12.0052</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿ƒç†å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æé«˜ä»£ç è´¨é‡çš„Tips</title>
      <link href="/%E5%85%B3%E4%BA%8E%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E7%9A%84Tips/"/>
      <url>/%E5%85%B3%E4%BA%8E%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E7%9A%84Tips/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¦‚ä½•é‡æ„"><a href="#1-å¦‚ä½•é‡æ„" class="headerlink" title="1. å¦‚ä½•é‡æ„"></a>1. å¦‚ä½•é‡æ„</h1><h2 id="1-1-ä¸ºä»€ä¹ˆè¦é‡æ„ä»£ç ï¼Ÿ"><a href="#1-1-ä¸ºä»€ä¹ˆè¦é‡æ„ä»£ç ï¼Ÿ" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆè¦é‡æ„ä»£ç ï¼Ÿ"></a>1.1 ä¸ºä»€ä¹ˆè¦é‡æ„ä»£ç ï¼Ÿ</h2><p>é‡æ„æ˜¯ä¸€ç§å¯¹è½¯ä»¶å†…éƒ¨ç»“æ„çš„æ”¹å–„ï¼Œç›®çš„æ˜¯åœ¨ä¸æ”¹å˜è½¯ä»¶çš„å¯è§è¡Œä¸ºçš„æƒ…å†µä¸‹ï¼Œä½¿å…¶æ›´æ˜“ç†è§£ï¼Œä¿®æ”¹æˆæœ¬æ›´ä½ã€‚</p><p>å³ é‡æ„æ˜¯æŒ‡ä¿æŒåŠŸèƒ½ä¸å˜çš„å‰æä¸‹ï¼Œåˆ©ç”¨è®¾è®¡æ€æƒ³ã€åŸåˆ™ã€æ¨¡å¼å’Œç¼–ç¨‹è§„èŒƒç­‰ç†è®ºæ¥ä¼˜åŒ–ä»£ç ï¼Œä¿®æ”¹è®¾è®¡ä¸Šçš„ä¸è¶³ï¼Œæé«˜ä»£ç çš„è´¨é‡ã€‚</p><p>å¦‚æœæ²¡æœ‰ç»´æŠ¤ï¼Œç‰©ä½“åŠ¿å¿…ä¼šå¾€ç†µå¢åŠ çš„æ–¹å‘å»æ¼”å˜çš„ã€‚å¦‚æœä¸åšä»£ç çš„ç»´æŠ¤ï¼Œä»£ç æ€»å½’ä¼šå¾€è¶Šæ¥è¶Šæ··ä¹±çš„æ–¹å‘æ¼”è¿›ï¼Œå½“æ··ä¹±åˆ°ä¸€å®šç¨‹åº¦ï¼Œé‡å˜å¼•èµ·è´¨å˜ï¼Œé¡¹ç›®çš„ç»´æŠ¤æˆæœ¬å·²ç»é«˜è¿‡äº†é‡æ–°å¼€å‘ä¸€å¥—æ–°ä»£ç çš„æˆæœ¬ï¼Œå†å»é‡æ„å°±ä¼šå˜å¾—ååˆ†å›°éš¾äº†ã€‚</p><h2 id="1-2-é‡æ„çš„å¯¹è±¡"><a href="#1-2-é‡æ„çš„å¯¹è±¡" class="headerlink" title="1.2 é‡æ„çš„å¯¹è±¡"></a>1.2 é‡æ„çš„å¯¹è±¡</h2><ul><li>å¤§å‹é‡æ„<ul><li>å¯¹é¡¶å±‚ä»£ç è®¾è®¡çš„é‡æ„<ul><li>åŒ…æ‹¬ <ul><li>ç³»ç»Ÿ</li><li>æ¨¡å—</li><li>ä»£ç ç»“æ„</li><li>ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»</li></ul></li><li>é‡æ„çš„æ‰‹æ®µ<ul><li>åˆ†å±‚</li><li>æ¨¡å—åŒ–</li><li>è§£è€¦</li><li>æŠ½è±¡å¯å¤ç”¨çš„ç»„ä»¶</li></ul></li></ul></li></ul></li></ul><ul><li>å°å‹é‡æ„<ul><li>å¯¹äºä»£ç ç»†èŠ‚çš„é‡æ„</li><li>é’ˆå¯¹ç±»ï¼Œå‡½æ•°ï¼Œå˜é‡ç­‰ä»£ç çº§åˆ«çš„é‡æ„</li></ul></li></ul><h2 id="1-3-ä»€ä¹ˆæ—¶å€™é‡æ„ï¼Ÿ"><a href="#1-3-ä»€ä¹ˆæ—¶å€™é‡æ„ï¼Ÿ" class="headerlink" title="1.3 ä»€ä¹ˆæ—¶å€™é‡æ„ï¼Ÿ"></a>1.3 ä»€ä¹ˆæ—¶å€™é‡æ„ï¼Ÿ</h2><p>æŒç»­é‡æ„çš„æ¦‚å¿µï¼Œå³æ²¡äº‹æƒ…çš„æ—¶å€™ï¼Œçœ‹çœ‹é¡¹ç›®ä¸­æœ‰å“ªäº›å†™å¾—ä¸å¤Ÿå¥½ï¼Œå¯ä»¥ä¼˜åŒ–çš„ä»£ç ï¼Œä¸»åŠ¨å»é‡æ„ä¸€ä¸‹ã€‚æˆ–è€…åœ¨ä¿®æ”¹æ·»åŠ æŸä¸ªåŠŸèƒ½ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥é¡ºæ‰‹æŠŠä¸ç¬¦åˆç¼–ç è§„èŒƒï¼Œä¸å¥½çš„è®¾è®¡é‡æ„ä¸€ä¸‹ã€‚</p><h2 id="1-4-å¦‚ä½•è§£è€¦ä»£ç ï¼Ÿ"><a href="#1-4-å¦‚ä½•è§£è€¦ä»£ç ï¼Ÿ" class="headerlink" title="1.4 å¦‚ä½•è§£è€¦ä»£ç ï¼Ÿ"></a>1.4 å¦‚ä½•è§£è€¦ä»£ç ï¼Ÿ</h2><ul><li><p>è§£è€¦çš„ç›®çš„</p><ul><li>é«˜å†…èš</li><li>æ¾è€¦åˆ</li></ul></li><li><p>ä¸ºä»€ä¹ˆéœ€è¦è§£è€¦</p><ul><li>æ§åˆ¶ä»£ç çš„å¤æ‚æ€§</li><li>ä½¿å¾—æˆ‘ä»¬å¯ä»¥èšç„¦åœ¨æŸä¸€æ¨¡å—æˆ–ç±»å½“ä¸­ï¼Œä¸éœ€è¦äº†è§£å¤ªå¤šå…¶ä»–æ¨¡å—æˆ–ç±»çš„ä»£ç </li><li>ä½¿å¾—ä»£ç æ”¹åŠ¨ç›¸å¯¹é›†ä¸­ï¼Œå¼•å…¥bugçš„é£é™©å°±å‡å°‘äº†å¾ˆå¤š</li></ul></li><li><p>å¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦è§£è€¦</p><ul><li>åœ¨åšä¿®æ”¹çš„æ—¶å€™æ˜¯å¦éœ€è¦è·¨å¾ˆå¤šä¸ªåŒ…æ¥è¿›è¡Œæ”¹åŠ¨</li><li>éœ€è¦é€šè¿‡è§£è€¦çš„æ–¹å¼è®©ä¾èµ–å…³ç³»å˜å¾—æ¸…æ™°ï¼Œç®€å•ä¸€äº›</li></ul></li><li><p>å¦‚ä½•è¿›è¡Œè§£è€¦</p><ul><li><p>å°è£…ä¸æŠ½è±¡</p><ul><li>æœ‰æ•ˆéšè—å®ç°çš„å¤æ‚</li><li>éš”ç¦»å®ç°çš„æ˜“å˜æ€§</li><li>ç»™ä¾èµ–çš„æ¨¡å—æä¾›ç¨³å®šæ˜“ç”¨çš„æŠ½è±¡æ¥å£</li></ul></li><li><p>å¼•å…¥ä¸­é—´å±‚</p><ul><li>å¼•å…¥ä¸­é—´å±‚èƒ½å¤Ÿç®€åŒ–æ¨¡å—æˆ–ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</li><li>å³æˆ‘ä»¬å¯ä»¥è®©å¼€å‘å’Œé‡æ„åŒæ­¥è¿›è¡Œ</li><li>ä¾‹å¦‚éœ€è¦è¿›è¡Œæ¥å£çš„ä¿®æ”¹<ul><li>å…ˆå¼•å…¥ä¸€ä¸ªä¸­é—´å±‚ï¼ŒåŒ…è£¹è€çš„æ¥å£ï¼Œæä¾›æ–°çš„æ¥å£å®šä¹‰</li><li>æ–°å¼€å‘çš„ä»£ç ä¾èµ–ä¸­é—´å±‚æä¾›çš„æ–°æ¥å£</li><li>å°†ä¾èµ–è€è¡—å£çš„ä»£ç æ”¹ä¸ºè°ƒç”¨æ–°æ¥å£</li><li>ç¡®ä¿æ‰€æœ‰çš„ä»£ç éƒ½è°ƒç”¨æ–°æ¥å£ä¹‹åï¼Œåˆ æ‰è€æ¥å£</li></ul></li></ul></li><li><p>æ¨¡å—åŒ–</p><ul><li>å¯¹äºä¸€ä¸ªå¤§å‹å¤æ‚ç³»ç»Ÿæ¥è¯´ï¼Œæ²¡æœ‰äººèƒ½å¤ŸæŒæ§æ‰€æœ‰ç»†èŠ‚</li><li>é€šè¿‡åˆ’åˆ†æˆä¸åŒçš„ç‹¬ç«‹æ¨¡å—ï¼Œè®©ä¸åŒçš„äººè´Ÿè´£ä¸åŒçš„æ¨¡å—</li><li>è¿™æ ·å³ä¾¿åœ¨ä¸äº†è§£å…¨éƒ¨ç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œç®¡ç†è€…ä¹Ÿèƒ½å¤Ÿåè°ƒå„ä¸ªæ¨¡å—ï¼Œè®©æ•´ä¸ªç³»ç»Ÿæœ‰æ•ˆè¿è½¬èµ·æ¥</li><li>å°†æ¯ä¸ªæ¨¡å—éƒ½å½“åšä¸€ä¸ªç‹¬ç«‹çš„libraryæ¥è¿›è¡Œå¼€å‘ï¼Œåªæä¾›å°è£…äº†å†…éƒ¨å®ç°ç»†èŠ‚çš„æ¥å£ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼Œä»¥æ­¤æ¥å‡å°‘ä¸åŒæ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦</li></ul></li><li><p>éµå¾ªè®¾è®¡æ€æƒ³å’ŒåŸåˆ™</p><ul><li>å•ä¸€èŒè´£åŸåˆ™</li><li>åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹</li><li>ä¾èµ–æ³¨å…¥</li><li>å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿</li><li>è¿ªç±³ç‰¹æ³•åˆ™<ul><li>ä¸åº”è¯¥æœ‰ç›´æ¥ä¾èµ–å…³ç³»çš„ç±»</li></ul></li></ul></li></ul></li></ul><h1 id="2-ä»£ç çš„å¯æµ‹è¯•æ€§"><a href="#2-ä»£ç çš„å¯æµ‹è¯•æ€§" class="headerlink" title="2. ä»£ç çš„å¯æµ‹è¯•æ€§"></a>2. ä»£ç çš„å¯æµ‹è¯•æ€§</h1><p>åšé‡æ„ï¼Œå¦‚ä½•ä¿è¯ä½ åšçš„æ”¹åŠ¨èƒ½å¤ŸæŒ‰ç…§æ—¢å®šçš„æƒ³æ³•è¿è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ¥å†™å•å…ƒæµ‹è¯•ï¼Œæ¥ä¿è¯æ–°çš„ä»£ç ä»ç„¶èƒ½å¤Ÿé€šè¿‡ï¼Œå³åŸæœ‰çš„é€»è¾‘çš„æ­£ç¡®æ€§æ²¡æœ‰è¢«ç ´åã€‚</p><p>å¦å¤–ï¼Œå•å…ƒæµ‹è¯•çš„é˜…è¯»å®é™…ä¸Šæ˜¯å¿«é€Ÿç†Ÿæ‚‰ä»£ç çš„ä¸€ç§æ–¹å¼</p><p>ä¸€äº›å¸¸è§çš„Anti-patterns:</p><ul><li>æœªå†³è¡Œä¸º<ul><li>ä»£ç çš„è¾“å‡ºæ˜¯éšæœºçš„ï¼Œæˆ–è€…ä¸ç¡®å®šçš„</li></ul></li><li>å…¨å±€å˜é‡</li><li>é™æ€æ–¹æ³•</li><li>å¤æ‚ç»§æ‰¿</li><li>é«˜è€¦åˆä»£ç </li></ul><h1 id="3-ç¼–ç¨‹è§„èŒƒ"><a href="#3-ç¼–ç¨‹è§„èŒƒ" class="headerlink" title="3. ç¼–ç¨‹è§„èŒƒ"></a>3. ç¼–ç¨‹è§„èŒƒ</h1><h2 id="3-1-å‘½åä¸æ³¨é‡Š"><a href="#3-1-å‘½åä¸æ³¨é‡Š" class="headerlink" title="3.1 å‘½åä¸æ³¨é‡Š"></a>3.1 å‘½åä¸æ³¨é‡Š</h2><ol><li>åœ¨è¶³å¤Ÿè¡¨è¾¾å«ä¹‰çš„æƒ…å†µä¸‹ï¼Œå‘½åå°½é‡çŸ­</li></ol><p>å‘½åæ—¶å€™çš„ç¼©å†™ï¼Œåªå¯¹å¤§å®¶æ¯”è¾ƒç†ŸçŸ¥çš„ä½¿ç”¨ï¼Œå‡å°‘é˜…è¯»æ—¶å€™çš„éšœç¢çš„æ„Ÿè§‰ã€‚</p><ol start="2"><li>åˆ©ç”¨ä¸Šä¸‹æ–‡ç®€åŒ–å‘½å</li></ol><p>æ¯”å¦‚POJOå½“ä¸­ï¼Œç±»åå¾€å¾€å¯¹è¿™æ˜¯ä¸ªä»€ä¹ˆç±»åšäº†å®šä¹‰äº†ï¼Œæˆå‘˜å˜é‡å°±ä¸ç”¨å†æ·»åŠ ç±»å‰ç¼€äº†</p><ol start="3"><li>å‘½åéœ€è¦å¯è¯»ï¼Œå¯æœç´¢</li></ol><p>è‹±æ–‡ä¸Šå¯è¯»ï¼Œæ–¹ä¾¿å‘éŸ³ï¼Œå“ªæ€•æ˜¯ç¬¬ä¸€æ¬¡è§åˆ°ï¼Œä¹Ÿéœ€è¦å°½å¯èƒ½ç®€å•çš„èƒ½å¤Ÿç›´æ¥è¯»å‡ºæ¥</p><p>å¦å¤–éœ€è¦éµä»ä¸€äº›å¤§å®¶çº¦å®šä¿—æˆçš„è§„èŒƒï¼Œå³æ¯”å¦‚ä½¿ç”¨selectXXX è¿˜æ˜¯queryXXX æ¥è¡¨ç¤ºé€‰æ‹©ï¼Œä»æ•°æ®åº“é‡Œé¢æ‹¿ä¸œè¥¿ï¼Œä¸€æ—¦é€‰å®šï¼Œå°±éœ€è¦ä¸€èµ·éµä»è§„å®šäº†ã€‚</p><ol start="4"><li>å¯¹äºæ¥å£ï¼ŒæŠ½è±¡ç±»çš„å‘½å</li></ol><ul><li><p>å¯¹äºæ¥å£çš„å‘½å</p><ul><li>åŠ å‰ç¼€Iï¼Œæ¯”å¦‚IUserService</li><li>æˆ–è€…åŠ åç¼€Impl, UserServiceImpl</li></ul></li><li><p>æŠ½è±¡ç±»çš„å‘½å</p><ul><li>åŠ ä¸Šå‰ç¼€Abstract</li><li>æˆ–è€…ä¸å¸¦</li></ul></li></ul><p>çš†å¯ï¼Œä½†æ˜¯éœ€è¦å½¢å¼ä¸Šçš„ç»Ÿä¸€ã€‚</p><ol start="5"><li>æ³¨é‡Š</li></ol><ul><li><p>ç›®çš„</p><ul><li>è®©ä»£ç æ›´å®¹æ˜“çœ‹æ‡‚</li></ul></li><li><p>å†™ä»€ä¹ˆ</p><ul><li>æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Œæ€ä¹ˆåŠ ä¸‰å¤§é—®é¢˜</li><li>èƒ½å¤Ÿèµ·åˆ°æ€»ç»“æ€§å’Œæ–‡æ¡£çš„ä½œç”¨</li><li>æ€»ç»“æ€§æ³¨é‡Šä¹Ÿèƒ½å¤Ÿè®©æ•´ä¸ªä»£ç æ›´åŠ æ¸…æ™°</li></ul></li><li><p>åœ¨å“ªé‡Œå†™</p><ul><li>ä¸€èˆ¬æ¥è¯´æ˜¯åœ¨ç±»å’Œå‡½æ•°ä¸Šå†™æ³¨é‡Š</li><li>å‡½æ•°å†…éƒ¨å°½é‡é€šè¿‡å¥½çš„å‘½åï¼Œæç‚¼å‡½æ•°ï¼Œè§£é‡Šæ€§çš„å˜é‡æ¥æé«˜ä»£ç çš„å¯è¯»æ€§</li></ul></li></ul><h2 id="3-2-ä»£ç é£æ ¼"><a href="#3-2-ä»£ç é£æ ¼" class="headerlink" title="3.2 ä»£ç é£æ ¼"></a>3.2 ä»£ç é£æ ¼</h2><ol><li>ç±»å’Œå‡½æ•°çš„å¤§å°</li></ol><p>è½¯æ ‡å‡†ï¼Œåªæ˜¯è¦å°½é‡æ³¨æ„ï¼Œå¯¹äºå¾ˆå¤§çš„ç±»ï¼Œæœ€å¥½å°†å…¶åˆ†å‰²å¼€</p><ol start="2"><li>ä¸€è¡Œä»£ç çš„é•¿åº¦çš„é™åˆ¶ï¼Œè­¬å¦‚100å­—ç¬¦æˆ–è€…150å­—ç¬¦</li><li>ä½¿ç”¨ç©ºè¡Œåˆ†å‰²å•å…ƒå—</li></ol><ul><li>å¯¹äºæ¯”è¾ƒé•¿çš„å‡½æ•°ï¼Œå¦‚æœé€»è¾‘ä¸Šå¯ä»¥åˆ†ä¸ºå‡ ä¸ªç‹¬ç«‹çš„ä»£ç å—ï¼Œå¯ä»¥ä½¿ç”¨ç©ºè¡Œæ¥åˆ†å‰²å„ä¸ªä»£ç å—</li><li>åœ¨ç±»çš„æˆå‘˜å˜é‡å’Œå‡½æ•°ä¹‹é—´</li><li>é™æ€æˆå‘˜å˜é‡å’Œæ™®é€šæˆå‘˜å˜é‡ä¹‹é—´</li><li>å„ä¸ªå‡½æ•°ä¹‹é—´</li><li>å„ä¸ªæˆå‘˜å˜é‡ä¹‹é—´</li></ul><ol start="4"><li>ç¼©è¿›é£æ ¼çš„ç»Ÿä¸€</li><li>ç±»å½“ä¸­æˆå‘˜çš„æ’åˆ—é¡ºåº</li></ol><ul><li>é¦–å…ˆæ˜¯ç±»çš„æ‰€å±åŒ…å</li><li>ç„¶åç½—åˆ—importå¼•å…¥çš„ä¾èµ–ç±»</li><li>ç±»å½“ä¸­<ul><li>å¤§åŸåˆ™<ul><li>å…ˆé™æ€ï¼Œåæ™®é€š</li><li>ä½œç”¨åŸŸä»å¤§åˆ°å°æ¥æ’åº</li></ul></li><li>æˆå‘˜å˜é‡</li><li>å„ç§æ–¹æ³•</li></ul></li></ul><h2 id="3-3-ç¼–ç¨‹æŠ€å·§"><a href="#3-3-ç¼–ç¨‹æŠ€å·§" class="headerlink" title="3.3 ç¼–ç¨‹æŠ€å·§"></a>3.3 ç¼–ç¨‹æŠ€å·§</h2><ol><li>å°†ä»£ç åˆ†å‰²ä¸ºæ›´å°çš„å•å…ƒå—</li></ol><p>å¤§éƒ¨åˆ†äººé˜…è¯»ä»£ç çš„ä¹ æƒ¯éƒ½æ˜¯å…ˆçœ‹æ•´ä½“å†çœ‹ç»†èŠ‚ï¼Œå› ä¸ºæˆ‘ä»¬è¦æœ‰æ¨¡å—åŒ–å’ŒæŠ½è±¡æ€ç»´ï¼Œå–„äºå°†å¤§å—çš„è´Ÿè´£é€»è¾‘æç‚¼æˆç±»æˆ–è€…å‡½æ•°ï¼Œå±è”½æ‰ç»†èŠ‚</p><p>é€šè¿‡æç‚¼å‡½æ•°ï¼Œé€šè¿‡å‡½æ•°åå­—ï¼Œç›´æ¥è¯»æ‡‚è¿™æ®µä»£ç æ˜¯åšä»€ä¹ˆç”¨çš„</p><ol start="2"><li>é¿å…å‡½æ•°å‚æ•°è¿‡å¤š</li></ol><ul><li>è€ƒè™‘å‡½æ•°æ˜¯å¦èŒè´£å•ä¸€ï¼Œèƒ½å¦é€šè¿‡æ‹†åˆ†å¤šä¸ªå‡½æ•°çš„æ–¹å¼æ¥å‡å°‘å‚æ•°</li><li>å°†å‡½æ•°çš„å‚æ•°å°è£…æˆå¯¹è±¡</li><li>ä¸è¦ä½¿ç”¨å‡½æ•°çš„å‚æ•°(true/ false) æ¥æ§åˆ¶é€»è¾‘ï¼Œç›´æ¥åˆ†æˆå‡ ä¸ªä¸åŒçš„å‡½æ•°ä¼šæ›´å¥½</li></ul><ol start="3"><li>å‡½æ•°çš„è®¾è®¡ï¼ŒèŒè´£å•ä¸€</li><li>ç§»é™¤è¿‡æ·±çš„åµŒå¥—å±‚æ¬¡</li></ol><ul><li>å»æ‰å¤šä½™çš„if elseè¯­å¥</li><li>ä½¿ç”¨continue break returnç­‰å…³é”®å­—ï¼Œæ¥æå‰é€€å‡ºåµŒå¥—</li><li>è°ƒæ•´æ‰§è¡Œé¡ºåºæ¥å‡å°‘åµŒå¥—</li><li>å°†éƒ¨åˆ†åµŒå¥—é€»è¾‘å°è£…æˆå‡½æ•°è°ƒç”¨ï¼Œä»¥æ­¤æ¥å‡å°‘åµŒå¥—</li></ul><ol start="5"><li>ä½¿ç”¨è§£é‡Šæ€§å˜é‡</li></ol><ul><li>å¸¸é‡æ›¿ä»£magic number</li><li>ä½¿ç”¨è§£é‡Šæ€§å˜é‡æ¥è§£é‡Šå¤æ‚è¡¨è¾¾å¼</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Enzyme + Jest Practice</title>
      <link href="/Enzyme-Jest-Practice/"/>
      <url>/Enzyme-Jest-Practice/</url>
      
        <content type="html"><![CDATA[<h1 id="1-How-to-use-enzyme-with-jest"><a href="#1-How-to-use-enzyme-with-jest" class="headerlink" title="1. How to use enzyme with jest"></a>1. How to use enzyme with jest</h1><h2 id="1-1-children"><a href="#1-1-children" class="headerlink" title="1.1 children()"></a>1.1 children()</h2><p>This blog mainly describe some practice on how to write tests in jest with enzyme. </p><pre><code>// This test make sure the component only have one h1 element describe(&#39;&lt;Add /&gt; rendering&#39;, () =&gt; {    it(&#39;should render one &lt;h1&gt;&#39;, () =&gt; {        let wrapper = shallow(&lt;Add /&gt;);        expect(wrapper.children(&#39;h1&#39;)).toHaveLength(1);    });});</code></pre><h2 id="1-2-snapshot"><a href="#1-2-snapshot" class="headerlink" title="1.2 snapshot"></a>1.2 snapshot</h2><pre><code>// For snapshot test, jest will help you create a directory named __snapshots__ with the autogenerated file inside with the extension `.snap`. Push snapshot into the repository and store it along with the test // it means same as test it(&#39;render correctly text component&#39;, () =&gt; {      const TextInputComponent = renderer.create(&lt;TextInput /&gt;).toJSON();    expect(TextInputComponent).toMatchSnapshot();});</code></pre><h2 id="1-3-Test-with-props-in-your-component"><a href="#1-3-Test-with-props-in-your-component" class="headerlink" title="1.3 Test with props in your component"></a>1.3 Test with props in your component</h2><pre><code>it(&#39;check month and years dropdowns displayed&#39;, () =&gt; {      const props = {            showMonthYearsDropdowns: true        },        DateInputComponent = mount(&lt;DateInput {...props} /&gt;).find(&#39;.datepicker&#39;);    expect(DateInputComponent.hasClass(&#39;react-datepicker-hide-month&#39;)).toEqual(true);});it(&#39;render date input correctly with null value&#39;, () =&gt; {      const props = {            value: null        },        DateInputComponent = mount(&lt;DateInput {...props} /&gt;);    expect((DateInputComponent).prop(&#39;value&#39;)).toEqual(null);});it(&#39;check the type of value&#39;, () =&gt; {      const props = {            value: &#39;10.03.2018&#39;        },        DateInputComponent = mount(&lt;DateInput {...props} /&gt;);    expect(DateInputComponent.prop(&#39;value&#39;)).toBeString();});</code></pre><h2 id="1-4-Test-events"><a href="#1-4-Test-events" class="headerlink" title="1.4 Test events"></a>1.4 Test events</h2><pre><code>it(&#39;check the onChange callback&#39;, () =&gt; {      const onChange = jest.fn(),        props = {            value: &#39;20.01.2018&#39;,            onChange        },        DateInputComponent = mount(&lt;DateInput {...props} /&gt;).find(&#39;input&#39;);    DateInputComponent.simulate(&#39;change&#39;, { target: {value: moment(&#39;2018-01-22&#39;)} });    expect(onChange).toHaveBeenCalledWith(&#39;22.01.2018&#39;);});it(&#39;check DatePicker popup open&#39;, () =&gt; {      const DateComponent = mount(&lt;DateInput /&gt;),        dateInput = DateComponent.find(&quot;input[type=&#39;text&#39;]&quot;);    dateInput.simulate(&#39;click&#39;);    expect(DateComponent.find(&#39;.react-datepicker&#39;)).toHaveLength(1);});</code></pre><h1 id="2-Some-tips"><a href="#2-Some-tips" class="headerlink" title="2. Some tips"></a>2. Some tips</h1><ol><li><p>One component should have only one snapshot. </p><ol><li>mainly because if one fails, most likely the others will fail too </li></ol></li><li><p>Test props. </p><ol><li>check the render od default prop values </li><li>check the custom value of the prop, set your own value and do tests </li></ol></li><li><p>Testing data types </p><ol><li>you could use <code>jest-extended</code> to test the type of data </li></ol></li><li><p>Event testing </p><ol><li>mock event -&gt; simulate it -&gt; expect event was called </li><li>mock event -&gt; simulate event with params -&gt; expect event was called with passed params </li><li>pass necessary props -&gt; render component -&gt; simulate event -&gt; expect a certain behavior on called event </li></ol></li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.bitsrc.io/how-to-test-react-components-with-jest-and-enzyme-in-depth-145fcd06b90" target="_blank" rel="noopener">https://blog.bitsrc.io/how-to-test-react-components-with-jest-and-enzyme-in-depth-145fcd06b90</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•é«˜æ•ˆå¼€Design Meetings</title>
      <link href="/%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E5%BC%80Design-Meetings/"/>
      <url>/%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E5%BC%80Design-Meetings/</url>
      
        <content type="html"><![CDATA[<p>èƒ½é è§„èŒƒåšçš„äº‹æƒ…å°±å°½é‡ä¸è¦é ç›´è§‰ï¼ŒæŠŠç›´è§‰ç”¨åœ¨æ›´éœ€è¦ç›´è§‰çš„åœ°æ–¹å§ã€‚</p><p>å·¥ä½œçš„æ—¥å¸¸ä¸€å®šå°‘ä¸äº†å¼€ä¼šçš„ï¼Œä½†æ˜¯ä½ ä¼šæœ‰æ„Ÿè§‰åˆ°æœ‰ä¸€äº›ä¼šè®®æ•ˆç‡éå¸¸é«˜ï¼Œä½ å¸¦ç€é—®é¢˜æ¥å¼€ä¼šï¼Œé—®é¢˜è¿…é€Ÿè¢«è§£å†³ï¼Œæ¯ä¸ªäººéƒ½å¯¹ä¸‹ä¸€æ­¥å¾ˆæ¸…æ™°ï¼Œç„¶åä¼šè®®ç»“æŸã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿæ—¶å¸¸ç»å†å®Œå…¨ç›¸åçš„è¿‡ç¨‹ï¼Œä½ å¸¦ç€é—®é¢˜è¿›å…¥ï¼Œä½†æ˜¯é—®é¢˜æ²¡æœ‰è¢«è§£ç­”ï¼Œæ¯ä¸ªäººå˜å¾—æ›´åŠ å›°æƒ‘çš„ç»“æŸä¼šè®®ã€‚</p><p>é—®é¢˜åœ¨äºï¼Œå¦‚ä½•èƒ½å¤Ÿç¡®ä¿æˆ‘ä»¬çš„ä¼šè®®æ˜¯æœ‰æ•ˆç‡çš„ï¼Œèƒ½å¤Ÿè§£å†³é—®é¢˜çš„ï¼Œè¿™éœ€è¦ä¸€äº›è§„åˆ™å’Œæ—¥ç¨‹ä¸Šçš„å®‰æ’ï¼Œæ¥ç¡®ä¿å…¶æ•ˆç‡ã€‚</p><h1 id="1-æ¸…æ™°è®¤çŸ¥ä¼šè®®çš„ç±»å‹"><a href="#1-æ¸…æ™°è®¤çŸ¥ä¼šè®®çš„ç±»å‹" class="headerlink" title="1. æ¸…æ™°è®¤çŸ¥ä¼šè®®çš„ç±»å‹"></a>1. æ¸…æ™°è®¤çŸ¥ä¼šè®®çš„ç±»å‹</h1><p>åœ¨é¡¹ç›®çš„è®¾è®¡è¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¾“å…¥å’Œè¾“å‡ºå°†ä¼šè®®åˆ†ä¸ºä¸‰ä¸ªä¸»è¦çš„ç±»å‹ï¼šå®šä¹‰ï¼Œè®¾è®¡ä¸å¼€å‘</p><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>å®šä¹‰ç±»å‹çš„ä¼šè®®æŒ‡çš„æ˜¯å¼€å±•ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä»¥åŠè®¾å®šéœ€æ±‚çš„è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªä¼šè®®å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ï¼š</p><ul><li>é—®é¢˜æ˜¯ä»€ä¹ˆ</li><li>ç”¨æˆ·æ˜¯è°</li><li>æœ‰å“ªäº›é™åˆ¶</li><li>æ—¶é—´è½´</li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œéœ€æ±‚å®šä¹‰çš„ä¼šè®®å‚åŠ çš„äººæ•°å°‘æ•ˆæœä¼šæ›´åŠ ç†æƒ³ä¸€äº›ï¼Œæ¯”å¦‚åªå¸¦äº§å“ç»ç†ä»¥åŠè®¾è®¡å¸ˆã€‚</p><h2 id="1-2-è®¾è®¡"><a href="#1-2-è®¾è®¡" class="headerlink" title="1.2 è®¾è®¡"></a>1.2 è®¾è®¡</h2><p>è®¾è®¡æ˜¯ä¸ªäº¤äº’çš„è¿‡ç¨‹ï¼Œä¼šéœ€è¦å¤§é‡çš„å’Œäº§å“ï¼Œè®¾è®¡ï¼ŒæŠ€æœ¯æ¥è¿›è¡Œäº¤æµã€‚å¯ä»¥å°†æ•´ä¸ªè®¾è®¡è¿‡ç¨‹åˆ’åˆ†ä¸ºä»¥ä¸‹çš„æ­¥éª¤ï¼š</p><ul><li><p>è°ƒç ” (Research)</p><ul><li>çœ‹çœ‹é—®é¢˜å’Œç”¨æˆ·æ˜¯å¦å·²ç»è¢«å®šä¹‰äº†ï¼ŒèŠ±ç‚¹æ—¶é—´å»çœ‹çœ‹å…¶ä»–äººæ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼ˆä¸ä»…é™äºä½ çš„å…¬å¸ï¼ŒåŒ…æ‹¬å·¥ä¸šç•Œï¼‰</li></ul></li><li><p>è‰æ‹Ÿ (Sketch)</p><ul><li>æ¢ç´¢ä¸åŒçš„é€‰æ‹©ï¼Œç„¶ååˆ¤æ–­å“ªä¸€ä¸ªèƒ½å¤Ÿæ»¡è¶³éœ€æ±‚</li></ul></li><li><p>åé¦ˆ (Feedback)</p><ul><li>æ³¨æ„æƒ³è¦å¾—åˆ°å“ªæ–¹é¢çš„åé¦ˆ </li><li>æœ€å¥½ä¸“æ³¨åœ¨æŸä¸€ä¸ªæ–¹å‘ä¸Š</li></ul></li><li><p>è¿­ä»£ (Refine)</p><ul><li>æ ¹æ®æ—¶é—´è½´ä¸æ–­è·å–åé¦ˆï¼Œå®Œæˆè¿­ä»£</li></ul></li></ul><p>è®¾è®¡ä¼šè®®çš„å…³é”®åœ¨äºéœ€æ±‚è§£å†³å“ªæ–¹é¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦èšç„¦äºè¿™ä¸ªé—®é¢˜ã€‚å¯¹äºä¸åŒçš„è®¾è®¡çš„é€‰æ‹©ï¼Œæˆ‘ä»¬éœ€è¦ä»å¼€å‘è€…é‚£é‡Œæ‹¿åˆ°åé¦ˆã€‚</p><h2 id="1-3-å¼€å‘"><a href="#1-3-å¼€å‘" class="headerlink" title="1.3 å¼€å‘"></a>1.3 å¼€å‘</h2><p>å½“æˆ‘ä»¬è¿›å…¥è¿™éƒ¨åˆ†çš„ä¼šè®®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†å¤§è‡´ä¸Šçš„è®¾è®¡çš„æ€è·¯ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ›´å¤šçš„è€ƒè™‘ä¸€äº›edge caseï¼Œè¿˜æœ‰æŠ€æœ¯ä¸Šçš„é™åˆ¶ã€‚è¿™é‡Œä¼šæœ‰ä¸€äº›æŠ€æœ¯å’Œè®¾è®¡æ–¹é¢çš„æƒè¡¡ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦è°ƒæ•´æˆ‘ä»¬çš„è®¾è®¡ï¼Œæ¥æ»¡è¶³ä»æŠ€æœ¯è§’åº¦çš„è€ƒé‡ã€‚è®¾è®¡å’Œäº§å“éœ€è¦ä¸€ç›´å‚ä¸åœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œä»¥ä¿è¯å“ªæ€•ç»†èŠ‚ä¸Šæœ‰è°ƒæ•´ï¼Œä½†æ˜¯è®¾è®¡çš„åˆè¡·/ç†å¿µä¸ä¼šè¢«æ”¹å˜ã€‚</p><h1 id="2-é‚€è¯·æ­£ç¡®çš„äºº"><a href="#2-é‚€è¯·æ­£ç¡®çš„äºº" class="headerlink" title="2. é‚€è¯·æ­£ç¡®çš„äºº"></a>2. é‚€è¯·æ­£ç¡®çš„äºº</h1><p>æˆ‘ä»¬éœ€è¦å¾ˆæ¸…æ¥šè¿™ä¸ªä¼šè®®æ˜¯å…³äºä»€ä¹ˆçš„ï¼Œä»¥åŠè°åº”è¯¥å‡ºç°åœ¨è¿™é‡Œã€‚ä¸€ä¸ªç»„å¾€å¾€å¯èƒ½ä¼šæœ‰3 - 10äººå·¦å³ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè®©10ä¸ªäººå…¨éƒ½å‡ºç°åœ¨ä¼šè®®å½“ä¸­ä¸æ˜¯å¾ˆæœ‰æ•ˆç‡çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å‹æ¥å†³å®šè°åº”è¯¥å‡ºç°åœ¨ä¼šè®®å½“ä¸­ã€‚ </p><p>Decide, Console, Informæ¨¡å‹</p><h2 id="2-1-å†³ç­–"><a href="#2-1-å†³ç­–" class="headerlink" title="2.1 å†³ç­–"></a>2.1 å†³ç­–</h2><p>å†³ç­–è€…æ˜¯å¯ä»¥å¯¹é¡¹ç›®ä»˜å‡ºæ—¶é—´ç²¾åŠ›ä»¥åŠé‡‘é’±çš„äººã€‚ä»–ä»¬ä¼šæœ€ç»ˆå†³å®šè¦åšä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆè¦è¿™æ ·åšã€‚æˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰çš„å†³ç­–è€…å¸¦å…¥åˆ°ä¼šè®®å®¤å½“ä¸­ï¼Œè¿™æ ·å¦‚æœç›¸äº’ä¹‹é—´æœ‰ä¸åŒæ„è§ï¼Œå¯ä»¥å¾ˆåŠæ—¶çš„è§£å†³ã€‚å¹¶ä¸”æä¾›ä¸‹ä¸€æ­¥ã€‚</p><p>è¿™ç§æ—¶å€™ï¼Œå¾€å¾€ç›¸å¯¹æ¯”è¾ƒå°çš„ä¼šè®®æ›´å®¹æ˜“è¾¾æˆå¥½çš„ç»“æœï¼Œå³åªå¸¦å…¥å¿…è¦çš„äººï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯äº§å“çš„å¸¦å¤´äººï¼Œè®¾è®¡çš„å¸¦å¤´äººï¼Œä»¥åŠæŠ€æœ¯æ–¹é¢çš„å¸¦å¤´äººã€‚</p><h2 id="2-2-å’¨è¯¢"><a href="#2-2-å’¨è¯¢" class="headerlink" title="2.2 å’¨è¯¢"></a>2.2 å’¨è¯¢</h2><p>è¿™é‡ŒæŒ‡çš„æ˜¯å¯¹è¿™ä¸ªé¢†åŸŸå¾ˆäº†è§£çš„äººï¼Œä»–ä»¬ä¼šæå‡ºå¾ˆæœ‰ä»·å€¼çš„å»ºè®®ï¼Œä¸è¿‡å†³å®šæƒè¿˜åœ¨å†³ç­–è€…æ‰‹ä¸­ã€‚æ¯”å¦‚å‡ ç§æŠ€æœ¯æ–¹æ¡ˆçš„æœ€ç»ˆé€‰æ‹©ï¼Œå°±éœ€è¦å¼•å…¥å¯¹æ¡†æ¶ï¼Œå„ç§æ–¹æ³•å¾ˆç†Ÿæ‚‰çš„å·¥ç¨‹å¸ˆæ¥ç»™å‡ºå»ºè®®äº†ã€‚</p><h2 id="2-3-é€šçŸ¥"><a href="#2-3-é€šçŸ¥" class="headerlink" title="2.3 é€šçŸ¥"></a>2.3 é€šçŸ¥</h2><p>ç»„é‡Œçš„ä¸€å‘˜ï¼Œè¢«é‚€è¯· == è¢«é€šçŸ¥ï¼Œlol </p><h1 id="3-æŒ‰ç…§æ—¶é—´å®‰æ’å±•å¼€ä¼šè®®"><a href="#3-æŒ‰ç…§æ—¶é—´å®‰æ’å±•å¼€ä¼šè®®" class="headerlink" title="3. æŒ‰ç…§æ—¶é—´å®‰æ’å±•å¼€ä¼šè®®"></a>3. æŒ‰ç…§æ—¶é—´å®‰æ’å±•å¼€ä¼šè®®</h1><p>æˆ‘ä»¬éœ€è¦ååˆ†æ¸…æ¥šè¿™ä¸ªä¼šè®®çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æœ€ç»ˆæƒ³è¾¾åˆ°ä»€ä¹ˆæ ·çš„æˆæœ</p><ul><li>æˆ‘ä»¬è§£å†³äº†ä»€ä¹ˆæ ·çš„é—®é¢˜</li><li>æˆ‘ä»¬å¯ä»¥åšå‡ºä»€ä¹ˆæ ·çš„å†³å®š</li><li>ä¸‹ä¸€æ­¥æªæ–½æ˜¯ä»€ä¹ˆ</li></ul><p>ä¸€äº›æ¯”è¾ƒå¥½çš„è¡Œä¸ºï¼Œå¼ºçƒˆæ¨èï¼š</p><ul><li><p>ä¼šè®®å‰</p><ul><li>å‘é€é‚®ä»¶ï¼Œç»™å‡ºå®‰æ’</li><li>ç»™å‡ºç›¸å…³çš„é“¾æ¥ï¼Œä½¿å¾—å‚ä¼šäººå¯ä»¥åœ¨å‚ä¼šå‰å¯ä»¥åšä¸€äº›å‡†å¤‡</li></ul></li><li><p>ä¼šè®®å¼€å§‹</p><ul><li>è¯´æ•´ä¸ªä¼šè®®çš„å®‰æ’<ul><li>æ¯”å¦‚æƒ³çœ‹çœ‹å‡ ç§è®¾è®¡</li><li>éœ€è¦åŸºäºä»€ä¹ˆä»€ä¹ˆå¾—åˆ°åé¦ˆ</li><li>ä¸‹ä¸€æ­¥</li></ul></li></ul></li><li><p>ä¼šè®®ç»“æŸ</p><ul><li>æ€»ç»“åé¦ˆ ä»¥åŠä¸‹ä¸€æ­¥<ul><li>åœ¨ä¼šè®®è¿˜å‰©ä¸‹5minå·¦å³çš„æ—¶å€™æ¥åšæ€»ç»“å’Œä¸‹ä¸€æ­¥è®¡åˆ’</li><li>æ€»ç»“è·å¾—çš„åé¦ˆï¼Œå’Œå†³å®š  è¿™æ ·å­å¦‚æœæˆ‘ä»¬å¿˜è®°äº†ä¸€äº›ä¸œè¥¿ï¼Œå…¶ä»–äººå¯ä»¥ç»™æˆ‘ä»¬åšè¡¥å……</li><li>é—®ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Œä»¥åŠæ¯ä¸€æ­¥çš„è´Ÿè´£äºº</li></ul></li></ul></li><li><p>ä¼šè®®å</p><ul><li>å‘é€é‚®ä»¶æ€»ç»“ä¼šè®®<ul><li>è®¨è®ºäº†ä»€ä¹ˆ</li><li>ä¸‹äº†ä»€ä¹ˆå†³å®š</li><li>ä¸‹ä¸€æ­¥å·¥ä½œï¼Œæ˜¯ä»€ä¹ˆï¼Œè°æ¥åš</li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://blog.prototypr.io/3-tips-to-run-effective-design-meetings-dec2ec238b56" target="_blank" rel="noopener">https://blog.prototypr.io/3-tips-to-run-effective-design-meetings-dec2ec238b56</a> </p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> meeting </tag>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Enzyme -- Reactæµ‹è¯•åº“</title>
      <link href="/Enzyme-React%E6%B5%8B%E8%AF%95%E5%BA%93/"/>
      <url>/Enzyme-React%E6%B5%8B%E8%AF%95%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯å‰ç«¯ç”¨äºå¯¹Reactçš„ç»„ä»¶è¿›è¡Œæµ‹è¯•çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥éå†ï¼Œæ§åˆ¶ï¼Œä»¥åŠä¸€å®šç¨‹åº¦ä¸Šçš„æ¨¡æ‹Ÿè¿è¡Œæ—¶è¾“å‡ºã€‚æˆ‘ä»¬ä¸»è¦æ˜¯å°†è¯¥å·¥å…·ç±»å’ŒJestä¸€èµ·ä½¿ç”¨ï¼Œå†™æˆ‘ä»¬çš„reactç»„ä»¶çš„å•å…ƒæµ‹è¯•ä»¬ã€‚</p><h1 id="1-Shalow-Rendering"><a href="#1-Shalow-Rendering" class="headerlink" title="1. Shalow Rendering"></a>1. Shalow Rendering</h1><p>ç”¨äºä»¥å•ä¸ªç»„ä»¶ä¸ºå•å…ƒæ¥è¿›è¡Œæµ‹è¯•ï¼Œç„¶åç¡®ä¿ä½ çš„æµ‹è¯•ä¸ä¼šä¾èµ–äºå­ç»„ä»¶çš„çŠ¶æ€ã€‚ä»Enzyme v3å¼€å§‹ï¼Œshallow APIä¼šcall Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•äº†ï¼Œè­¬å¦‚<code>componentDidUpdate</code>å’Œ<code>componentDidMount</code></p><pre><code>import { shallow } from &#39;enzyme&#39;;import sinon from &#39;sinon&#39;;import Foo from &#39;./Foo&#39;;describe(&#39;&lt;MyComponent /&gt;&#39;, () =&gt; {  it(&#39;renders three &lt;Foo /&gt; components&#39;, () =&gt; {    const wrapper = shallow(&lt;MyComponent /&gt;);    expect(wrapper.find(Foo)).to.have.lengthOf(3);  });  it(&#39;renders an `.icon-star`&#39;, () =&gt; {    const wrapper = shallow(&lt;MyComponent /&gt;);    expect(wrapper.find(&#39;.icon-star&#39;)).to.have.lengthOf(1);  });  it(&#39;renders children when passed in&#39;, () =&gt; {    const wrapper = shallow((      &lt;MyComponent&gt;        &lt;div className=&quot;unique&quot; /&gt;      &lt;/MyComponent&gt;    ));    expect(wrapper.contains(&lt;div className=&quot;unique&quot; /&gt;)).to.equal(true);  });  it(&#39;simulates click events&#39;, () =&gt; {    const onButtonClick = sinon.spy();    const wrapper = shallow(&lt;Foo onButtonClick={onButtonClick} /&gt;);    wrapper.find(&#39;button&#39;).simulate(&#39;click&#39;);    expect(onButtonClick).to.have.property(&#39;callCount&#39;, 1);  });});</code></pre><p><a href="https://enzymejs.github.io/enzyme/docs/api/shallow.html" target="_blank" rel="noopener">API Reference</a></p><h1 id="2-Full-Dom-Rendering"><a href="#2-Full-Dom-Rendering" class="headerlink" title="2. Full Dom Rendering"></a>2. Full Dom Rendering</h1><p>è¿™ç§æµ‹è¯•æ–¹å¼åœ¨ä½ éœ€è¦å’ŒDOM APIè¿›è¡Œäº¤äº’ï¼Œæˆ–è€…éœ€è¦æµ‹è¯•åœ¨æ›´é«˜æ¬¡ä½çš„ç»„ä»¶çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚</p><p>éœ€è¦è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒå½“ä¸­ï¼Œå¦‚æœæ— æ³•è¿è¡Œåœ¨çœŸå®çš„æµè§ˆå™¨å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦ä¾èµ–äº<code>mount</code>æŒ‡ä»¤ï¼Œåœ¨æŒ‡ä»¤ä¹‹ä¸‹ï¼Œæ˜¯è°ƒç”¨äº†ä¸€ä¸ªå«åšjsdomçš„åŒ…ï¼Œå®Œå…¨ä½¿ç”¨JavaScriptå®ç°äº†ä¸€ä¸ªæµè§ˆå™¨ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œfull dom renderingæ˜¯çœŸå®çš„å°†å½“å‰ç»„ä»¶æ¸²æŸ“åˆ°DOMæ ‘å½“ä¸­ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¦‚æœç”¨çš„æ˜¯åŒä¸€æ£µDOMæ ‘ï¼Œé‚£ä¹ˆä½ åšçš„æ”¹åŠ¨å¾ˆå¯èƒ½ä¼šå½±å“å…¶ä»–çš„æµ‹è¯•ï¼Œè¿™ç‚¹æ˜¯å€¼å¾—æˆ‘ä»¬æ³¨æ„çš„ã€‚</p><pre><code>import { mount } from &#39;enzyme&#39;;import sinon from &#39;sinon&#39;;import Foo from &#39;./Foo&#39;;describe(&#39;&lt;Foo /&gt;&#39;, () =&gt; {  it(&#39;calls componentDidMount&#39;, () =&gt; {    sinon.spy(Foo.prototype, &#39;componentDidMount&#39;);    const wrapper = mount(&lt;Foo /&gt;);    expect(Foo.prototype.componentDidMount).to.have.property(&#39;callCount&#39;, 1);  });  it(&#39;allows us to set props&#39;, () =&gt; {    const wrapper = mount(&lt;Foo bar=&quot;baz&quot; /&gt;);    expect(wrapper.props().bar).to.equal(&#39;baz&#39;);    wrapper.setProps({ bar: &#39;foo&#39; });    expect(wrapper.props().bar).to.equal(&#39;foo&#39;);  });  it(&#39;simulates click events&#39;, () =&gt; {    const onButtonClick = sinon.spy();    const wrapper = mount((      &lt;Foo onButtonClick={onButtonClick} /&gt;    ));    wrapper.find(&#39;button&#39;).simulate(&#39;click&#39;);    expect(onButtonClick).to.have.property(&#39;callCount&#39;, 1);  });});</code></pre><p><a href="https://enzymejs.github.io/enzyme/docs/api/mount.html" target="_blank" rel="noopener">API Reference</a></p><h1 id="3-Static-Rendering"><a href="#3-Static-Rendering" class="headerlink" title="3. Static Rendering"></a>3. Static Rendering</h1><p>Render ä½¿ç”¨çš„æ˜¯Cheerioè¿™ä¸ªHTMLè½¬åŒ–åº“ï¼Œç”¨äºä»æˆ‘ä»¬çš„Reactæ ‘æ¥ç”ŸæˆHTMLï¼Œç„¶ååˆ†æHTMLçš„æ•´ä¸ªæ¶æ„ã€‚</p><pre><code>import React from &#39;react&#39;;import { render } from &#39;enzyme&#39;;import PropTypes from &#39;prop-types&#39;;describe(&#39;&lt;Foo /&gt;&#39;, () =&gt; {  it(&#39;renders three `.foo-bar`s&#39;, () =&gt; {    const wrapper = render(&lt;Foo /&gt;);    expect(wrapper.find(&#39;.foo-bar&#39;)).to.have.lengthOf(3);  });  it(&#39;rendered the title&#39;, () =&gt; {    const wrapper = render(&lt;Foo title=&quot;unique&quot; /&gt;);    expect(wrapper.text()).to.contain(&#39;unique&#39;);  });  it(&#39;renders a div&#39;, () =&gt; {    const wrapper = render(&lt;div className=&quot;myClass&quot; /&gt;);    expect(wrapper.html()).to.contain(&#39;div&#39;);  });  it(&#39;can pass in context&#39;, () =&gt; {    function SimpleComponent(props, context) {      const { name } = context;      return &lt;div&gt;{name}&lt;/div&gt;;    }    SimpleComponent.contextTypes = {      name: PropTypes.string,    };    const context = { name: &#39;foo&#39; };    const wrapper = render(&lt;SimpleComponent /&gt;, { context });    expect(wrapper.text()).to.equal(&#39;foo&#39;);  });});</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://enzymejs.github.io/enzyme/" target="_blank" rel="noopener">https://enzymejs.github.io/enzyme/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Enzyme </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åº”ç”¨è®¾è®¡ Practice</title>
      <link href="/%E5%BA%94%E7%94%A8%E8%AE%BE%E8%AE%A1-Practice/"/>
      <url>/%E5%BA%94%E7%94%A8%E8%AE%BE%E8%AE%A1-Practice/</url>
      
        <content type="html"><![CDATA[<h1 id="1-thought"><a href="#1-thought" class="headerlink" title="1. thought"></a>1. thought</h1><p>å®é™…åº”ç”¨è®¾è®¡ï¼Œé¦–å…ˆè¿˜æ˜¯éœ€è¦å°†å·¥ä½œè¿›è¡Œåˆç†åˆ†å‰²ï¼š</p><ul><li>å‰æœŸéœ€æ±‚æ²Ÿé€šåˆ†æ<ul><li>å·¥ç¨‹å¸ˆåº”è¯¥å°½é‡å‚ä¸åˆ°äº§å“è®¾è®¡å½“ä¸­</li><li>å¯»æ‰¾ç±»ä¼¼çš„äº§å“ï¼Œè¿›è¡Œå€Ÿé‰´</li><li>å°†å€Ÿé‰´æ¥çš„ä¸œè¥¿åŠªåŠ›èåˆåˆ°æˆ‘ä»¬è‡ªå·±çš„äº§å“å½“ä¸­</li></ul></li><li>ä¸­æœŸä»£ç è®¾è®¡å®ç°</li><li>åæœŸç³»ç»Ÿä¸Šçº¿ç»´æŠ¤ <h1 id="2-ä¸šåŠ¡ç³»ç»Ÿè®¾è®¡-â€“-ç§¯åˆ†ç³»ç»Ÿ"><a href="#2-ä¸šåŠ¡ç³»ç»Ÿè®¾è®¡-â€“-ç§¯åˆ†ç³»ç»Ÿ" class="headerlink" title="2. ä¸šåŠ¡ç³»ç»Ÿè®¾è®¡ â€“ ç§¯åˆ†ç³»ç»Ÿ"></a>2. ä¸šåŠ¡ç³»ç»Ÿè®¾è®¡ â€“ ç§¯åˆ†ç³»ç»Ÿ</h1></li></ul><h2 id="2-1-ä¸šåŠ¡éœ€æ±‚"><a href="#2-1-ä¸šåŠ¡éœ€æ±‚" class="headerlink" title="2.1 ä¸šåŠ¡éœ€æ±‚"></a>2.1 ä¸šåŠ¡éœ€æ±‚</h2><ul><li><p>åŠŸèƒ½ç‚¹</p><ul><li>èµšå–ç§¯åˆ†<ul><li>ç§¯åˆ†èµšå–æ¸ é“<ul><li>è®¢å•</li><li>ç­¾åˆ°</li><li>è¯„è®º</li></ul></li><li>ç§¯åˆ†å…‘æ¢è§„åˆ™<ul><li>è®¢å•é‡‘é¢ä¸ç§¯åˆ†çš„å…‘æ¢æ¯”ä¾‹</li><li>ç­¾åˆ°èµ é€ç§¯åˆ†æ•°é‡ç­‰</li></ul></li></ul></li><li>æ¶ˆè´¹ç§¯åˆ†<ul><li>ç§¯åˆ†æ¶ˆè´¹æ¸ é“<ul><li>æŠµæ‰£è®¢å•é‡‘é¢</li><li>å…‘æ¢ä¼˜æƒ åˆ¸</li><li>ç§¯åˆ†æ¢è´­</li><li>å‚ä¸æ´»åŠ¨</li></ul></li></ul></li></ul></li><li><p>æ–¹å¼æ–¹æ³•</p><ul><li>å€Ÿé‰´å·²ç»ç›¸å¯¹æˆç†Ÿçš„äº§å“<ul><li>çœ‹å…¶å®ç°çš„æ–¹å¼æ–¹æ³•</li></ul></li><li>é€šè¿‡äº§å“çº¿æ¡†å›¾</li><li>user case<ul><li>æ¨¡æ‹Ÿç”¨æˆ·æ˜¯å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬çš„äº§å“çš„</li><li>æè¿°ç”¨æˆ·åœ¨ç‰¹å®šçš„åº”ç”¨åœºæ™¯å½“ä¸­çš„ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æ“ä½œæµç¨‹</li></ul></li></ul></li></ul><h2 id="2-2-ç³»ç»Ÿè®¾è®¡"><a href="#2-2-ç³»ç»Ÿè®¾è®¡" class="headerlink" title="2.2 ç³»ç»Ÿè®¾è®¡"></a>2.2 ç³»ç»Ÿè®¾è®¡</h2><h3 id="2-2-1-åŠŸèƒ½æ¨¡å—åˆ’åˆ†"><a href="#2-2-1-åŠŸèƒ½æ¨¡å—åˆ’åˆ†" class="headerlink" title="2.2.1 åŠŸèƒ½æ¨¡å—åˆ’åˆ†"></a>2.2.1 åŠŸèƒ½æ¨¡å—åˆ’åˆ†</h3><ul><li>å°†åŠŸèƒ½åˆ’åˆ†åˆ°ä¸åŒçš„æ¨¡å—å½“ä¸­ <ul><li>åšåˆ°æ¨¡å—å±‚é¢çš„é«˜å†…èšï¼Œä½è€¦åˆ</li></ul></li></ul><ul><li>é’ˆå¯¹ä¸Šè¿°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨<ul><li><ol><li>å°†å…³äºç§¯åˆ†çš„èµšå–æ¶ˆè´¹çš„è§„åˆ™çš„ç®¡ç†ç»´æŠ¤æ”¾åˆ°æ›´ä¸Šå±‚çš„è¥é”€ç³»ç»Ÿå½“ä¸­ï¼Œè¿™æ ·ç§¯åˆ†ç³»ç»Ÿå°±åªè´Ÿè´£å¢åˆ æ”¹æŸ¥çš„æ•°æ®åº“æ“ä½œäº†</li></ol></li><li><ol start="2"><li>å°†è§„åˆ™åˆ†æ•£åˆ°å„ä¸ªå­ç³»ç»Ÿå½“ä¸­ï¼Œè­¬å¦‚è®¢å•ç³»ç»Ÿï¼Œè¯„è®ºç³»ç»Ÿï¼Œç­¾åˆ°ç³»ç»Ÿï¼Œè¯¸å¦‚æ­¤ç±»</li></ol></li><li><ol start="3"><li>æ‰€æœ‰åŠŸèƒ½åˆ’åˆ†åˆ°ç§¯åˆ†ç³»ç»Ÿå½“ä¸­</li></ol></li></ul></li></ul><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†é¿å…ä¸šåŠ¡çŸ¥è¯†çš„è€¦åˆï¼Œè®©ä¸‹å±‚ç³»ç»Ÿæ›´åŠ é€šç”¨ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä¸‹å±‚ç³»ç»Ÿï¼ˆè¢«è°ƒç”¨ç³»ç»Ÿï¼‰åŒ…å«å¤ªå¤šä¸Šå±‚ç³»ç»Ÿï¼ˆè°ƒç”¨ç³»ç»Ÿï¼‰çš„ä¸šåŠ¡ä¿¡æ¯ã€‚ä½†ä¸Šå±‚ç³»ç»Ÿæ˜¯å¯ä»¥åŒ…å«ä¸‹å±‚ç³»ç»Ÿçš„ä¸šåŠ¡ä¿¡æ¯çš„ï¼Œæ¯”å¦‚ï¼Œè®¢å•ç³»ç»Ÿã€ä¼˜æƒ åˆ¸ç³»ç»Ÿã€æ¢è´­å•†åŸç­‰ä½œä¸ºè°ƒç”¨ç§¯åˆ†ç³»ç»Ÿçš„ä¸Šå±‚ç³»ç»Ÿï¼Œå¯ä»¥åŒ…å«ä¸€äº›ç§¯åˆ†ç›¸å…³çš„ä¸šåŠ¡ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œåè¿‡æ¥ï¼Œç§¯åˆ†ç³»ç»Ÿä¸­æœ€å¥½ä¸è¦åŒ…å«å¤ªå¤šè·Ÿè®¢å•ã€ä¼˜æƒ åˆ¸ã€æ¢è´­ç­‰ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>å› æ­¤ï¼Œ1ï¼Œ2éƒ½æ˜¯ç›¸å¯¹ä¸é”™çš„é€‰æ‹©ï¼Œæˆ‘ä»¬å¸Œæœ›åšçš„æ˜¯è®©ç§¯åˆ†ç³»ç»Ÿæ¨¡å—åªåŒ…å«ç§¯åˆ†çš„å¢åˆ æ”¹æŸ¥çš„æ“ä½œï¼Œè€Œä¸åŒ…å«å¤ªå¤šçš„ä¸šåŠ¡å±‚é¢çš„é€»è¾‘ã€‚</p><h3 id="2-2-2-æ¨¡å—é—´äº¤äº’"><a href="#2-2-2-æ¨¡å—é—´äº¤äº’" class="headerlink" title="2.2.2 æ¨¡å—é—´äº¤äº’"></a>2.2.2 æ¨¡å—é—´äº¤äº’</h3><p>å®šä½éœ€è¦å’Œç§¯åˆ†ç³»ç»Ÿä¹‹é—´è¿›è¡Œäº¤äº’çš„ç³»ç»Ÿï¼Œä»¥åŠäº¤äº’æ–¹å¼ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ–¹å¼æœ‰ä¸¤å¤§ç±»ï¼š</p><ul><li>åŒæ­¥æ¥å£è°ƒç”¨</li><li>åˆ©ç”¨ä¿¡æ¯ä¸­é—´ä»¶å¼‚æ­¥è°ƒç”¨</li></ul><h3 id="2-2-3-è®¾è®¡æ¨¡å—çš„æ¥å£ã€æ•°æ®åº“ã€ä¸šåŠ¡æ¨¡å‹"><a href="#2-2-3-è®¾è®¡æ¨¡å—çš„æ¥å£ã€æ•°æ®åº“ã€ä¸šåŠ¡æ¨¡å‹" class="headerlink" title="2.2.3 è®¾è®¡æ¨¡å—çš„æ¥å£ã€æ•°æ®åº“ã€ä¸šåŠ¡æ¨¡å‹"></a>2.2.3 è®¾è®¡æ¨¡å—çš„æ¥å£ã€æ•°æ®åº“ã€ä¸šåŠ¡æ¨¡å‹</h3><p>æ•°æ®åº“å’Œæ¥å£çš„è®¾è®¡ç›¸å¯¹æ¥è¯´éƒ½æ¯”è¾ƒé‡è¦ï¼Œä¸€æ—¦è®¾è®¡å¥½ï¼Œéƒ½ä¸èƒ½è½»æ˜“æ”¹åŠ¨ã€‚å°¤å…¶æ˜¯å½“æœ‰ä¸åŒçš„ç»„æ¥è°ƒç”¨ä½ çš„APIçš„æ—¶å€™ï¼Œè®©æ‰€æœ‰çš„ç»„éƒ½å¿«é€Ÿè¿ç§»åˆ°æ–°çš„APIä¸Šæ˜¯ä¸€ä»¶ç›¸å¯¹æ¯”è¾ƒå›°éš¾çš„äº‹æƒ…äº†ã€‚  æ”¹åŠ¨æ•°æ®åº“è¡¨çš„ç»“æ„ï¼Œéœ€è¦æ¶‰åŠæ•°æ®çš„è¿ç§»å’Œé€‚é…ã€‚</p><p>è€Œä¸šåŠ¡æ¨¡å‹ï¼Œå³ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œå› ä¸ºéƒ½æ˜¯å†…éƒ¨ä½¿ç”¨ï¼Œæ”¹åŠ¨çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ï¼Œå¯¹å¤–æ˜¯ä¸å¯è§çš„ã€‚</p><ul><li><p>æ•°æ®åº“è®¾è®¡ï¼š</p><ul><li>id - æ˜ç»†ID</li><li>user_id - ç”¨æˆ·ID</li><li>channel_id - èµšå–æˆ–æ¶ˆè´¹æ¸ é“ID</li><li>event_id - ç›¸å…³äº‹ä»¶IDï¼Œä¾‹å¦‚è®¢å•IDï¼Œè¯„è®ºIDï¼Œä¼˜æƒ åˆ¸æ¢è´­IDç­‰</li><li>credit - ç§¯åˆ† </li><li>create_time - ç§¯åˆ†èµšå–æˆ–æ¶ˆè´¹æ—¶é—´</li><li>expired_time - ç§¯åˆ†è¿‡æœŸæ—¶é—´</li></ul></li><li><p>æ¥å£è®¾è®¡</p><ul><li>å•ä¸€èŒè´£åŸåˆ™ <ul><li>ä½†æ˜¯ç²’åº¦å¤ªå°ä¹Ÿä¸å¥½ï¼Œæ¯”å¦‚ä¸€ä¸ªåŠŸèƒ½çš„å®ç°éœ€è¦å¤šä¸ªæ¥å£ï¼Œä½†æ˜¯æ¯ä¸ªæ¥å£å¦‚æœéƒ½æ˜¯RPCçš„ä¸€æ¬¡è¿œç¨‹è°ƒç”¨çš„è¯ï¼Œé‚£ç½‘ç»œä¸Šçš„æŸè€—å°±å¾ˆå¤šï¼Œå¤šæ¬¡è¿œç¨‹è°ƒç”¨ä¼šå½±å“æ€§èƒ½çš„</li><li>å¦å¤–è¿˜æœ‰æ•°æ®ä¸€è‡´æ€§ - å³æ“ä½œçš„åŸå­æ€§æ–¹é¢çš„è€ƒé‡</li><li>å¯ä»¥å€Ÿé‰´facadeå¤–è§‚è®¾è®¡æ¨¡å¼ï¼Œåœ¨èŒè´£å•ä¸€çš„ç»†ç²’åº¦æ¥å£ä¹‹ä¸Šï¼Œå°è£…ä¸€å±‚ç²—ç²’åº¦çš„æ¥å£ç»™å¤–éƒ¨ä½¿ç”¨</li></ul></li></ul></li><li><p>MVC </p><ul><li>controllerè´Ÿè´£æ¥å£æš´éœ²</li><li>service è´Ÿè´£æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</li><li>repositoryè´Ÿè´£æ•°æ®è¯»å†™</li><li>ä¸ºä»€ä¹ˆè¦åˆ†æˆMVCä¸‰å±‚ï¼Ÿ<ul><li>ä»£ç å¤ç”¨</li><li>éš”ç¦»å˜åŒ–</li><li>éš”ç¦»å…³æ³¨ç‚¹</li><li>æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§</li><li>èƒ½å¤Ÿåº”å¯¹ç³»ç»Ÿçš„å¤æ‚æ€§</li></ul></li></ul></li></ul><h1 id="3-éä¸šåŠ¡é€šç”¨æ¡†æ¶è®¾è®¡"><a href="#3-éä¸šåŠ¡é€šç”¨æ¡†æ¶è®¾è®¡" class="headerlink" title="3. éä¸šåŠ¡é€šç”¨æ¡†æ¶è®¾è®¡"></a>3. éä¸šåŠ¡é€šç”¨æ¡†æ¶è®¾è®¡</h1><p>å‡è®¾æˆ‘ä»¬è¦è®¾è®¡å¼€å‘ä¸€ä¸ªå°æ¡†æ¶ï¼Œæ¥è·å–æ¥å£è°ƒç”¨çš„å„ç§ç»Ÿè®¡ä¿¡æ¯ã€‚</p><ul><li>å“åº”æ—¶é—´<ul><li>max/ min/ avg/ percentile/ count/ tps </li></ul></li></ul><h2 id="3-1-éœ€æ±‚åˆ†æ"><a href="#3-1-éœ€æ±‚åˆ†æ" class="headerlink" title="3.1 éœ€æ±‚åˆ†æ"></a>3.1 éœ€æ±‚åˆ†æ</h2><p>æ˜¯ä¸€ä¸ªå’Œä¸šåŠ¡æ— å…³çš„ç‹¬ç«‹åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¼€å‘æˆä¸€ä¸ªç‹¬ç«‹çš„æ¡†æ¶æˆ–è€…åº“ï¼Œé›†æˆåˆ°å¾ˆå¤šçš„ä¸šåŠ¡ç³»ç»Ÿå½“ä¸­ã€‚ä½œä¸ºä¸€ä¸ªéœ€è¦å¤ç”¨æ€§çš„æ¡†æ¶ï¼Œé™¤äº†åŠŸèƒ½ä¸Šçš„éœ€æ±‚ä»¥å¤–ï¼ŒéåŠŸèƒ½æ€§çš„éœ€æ±‚ä¹Ÿéå¸¸é‡è¦ã€‚</p><ul><li><p>åŠŸèƒ½æ€§éœ€æ±‚åˆ†æ</p><ul><li><p>æ¥å£ç»Ÿè®¡ä¿¡æ¯</p><ul><li>å“åº”æ—¶é—´</li><li>æ¥å£è°ƒç”¨æ¬¡æ•°</li></ul></li><li><p>ç»Ÿè®¡ä¿¡æ¯çš„ç±»å‹</p><ul><li>max min ave percentile tps count </li></ul></li><li><p>ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤ºæ ¼å¼</p><ul><li>json</li><li>html</li><li>è‡ªå®šä¹‰</li></ul></li><li><p>ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤ºç»ˆç«¯</p><ul><li>console</li><li>email</li><li>http é¡µé¢</li><li>æ—¥å¿—</li><li>è‡ªå®šä¹‰</li></ul></li><li><p>ç»Ÿè®¡è§¦å‘æ–¹å¼</p></li><li><p>ç»Ÿè®¡æ—¶é—´åŒºé—´</p></li><li><p>ç»Ÿè®¡æ—¶é—´é—´éš”</p></li></ul></li></ul><ul><li><p>éåŠŸèƒ½æ€§éœ€æ±‚åˆ†æ</p><ul><li><p>æ˜“ç”¨æ€§</p><ul><li>æ¡†æ¶æ˜¯å¦æ˜“é›†æˆï¼Œæ˜“æ‹”æ’</li><li>è·Ÿä¸šåŠ¡ä»£ç æ˜¯å¦ä¸ºæ¾è€¦åˆ</li><li>æä¾›çš„æ¥å£æ˜¯å¦è¶³å¤Ÿçµæ´»</li></ul></li><li><p>æ€§èƒ½</p><ul><li>ä¸å¸Œæœ›æ¡†æ¶æœ¬èº«çš„ä»£ç æ‰§è¡Œæ•ˆç‡ä¼šå¯¹ä¸šåŠ¡ç³»ç»Ÿæœ‰å¤ªå¤šæ€§èƒ½ä¸Šçš„å½±å“</li><li>å¸Œæœ›æ¡†æ¶ä½å»¶è¿Ÿï¼Œå¹¶ä¸”å¯¹å†…å­˜çš„æ¶ˆè€—ä¸èƒ½å¤ªå¤§</li></ul></li><li><p>æ‰©å±•æ€§</p><ul><li>åœ¨ä¸ä¿®æ”¹æˆ–è€…å°½é‡å°‘ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹æ·»åŠ æ–°åŠŸèƒ½çš„èƒ½åŠ›</li></ul></li><li><p>å®¹é”™æ€§</p></li><li><p>é€šç”¨æ€§</p><ul><li>é™¤äº†æ¥å£æ•°æ®ç»Ÿè®¡ï¼Œèƒ½å¦å°†å…¶æ”¾åˆ°å…¶ä»–äº‹ä»¶ä¸Šæ¥åšç»Ÿè®¡å‘¢ï¼Ÿ </li></ul></li></ul></li></ul><h2 id="3-2-æ¡†æ¶è®¾è®¡"><a href="#3-2-æ¡†æ¶è®¾è®¡" class="headerlink" title="3.2 æ¡†æ¶è®¾è®¡"></a>3.2 æ¡†æ¶è®¾è®¡</h2><p>å¯ä»¥å€Ÿé‰´TDD (æµ‹è¯•é©±åŠ¨å¼€å‘)å’ŒPrototype(æœ€å°åŸå‹)çš„æ€æƒ³ï¼Œå…ˆèšç„¦äºä¸€ä¸ªç®€å•çš„åº”ç”¨åœºæ™¯ï¼ŒåŸºäºæ­¤æ¥è®¾è®¡ä¸€ä¸ªç®€å•çš„åŸå‹ï¼Œç„¶åä¸æ–­è¿›è¡Œè¿­ä»£ã€‚</p><p>è€Œåæ˜¯å°†æ•´ä¸ªæ¡†æ¶åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œåˆ†æ¨¡å—è¿›è¡Œæ€è€ƒï¼š</p><ul><li>æ•°æ®é‡‡é›†<ul><li>æ‰“ç‚¹é‡‡é›†åŸå§‹æ•°æ®</li><li>è®°å½•æ¯æ¬¡æ¥å£è¯·æ±‚çš„å“åº”æ—¶é—´å’Œè¯·æ±‚æ—¶é—´</li><li>æ•°æ®é‡‡é›†è¿‡ç¨‹è¦é«˜åº¦å®¹é”™ï¼Œä¸èƒ½å½±å“åˆ°æ¥å£æœ¬èº«çš„å¯ç”¨æ€§</li></ul></li><li>å­˜å‚¨<ul><li>è´Ÿè´£å°†é‡‡é›†çš„åŸå§‹æ•°æ®ä¿å­˜ä¸‹æ¥ï¼Œä»¥ä¾¿åé¢åšèšåˆç»Ÿè®¡</li><li>æ•°æ®å¯ä»¥å­˜å‚¨åœ¨<ul><li>redis</li><li>mysql</li><li>hbase</li><li>æ—¥å¿—</li><li>æ–‡ä»¶</li><li>å†…å­˜</li></ul></li></ul></li><li>èšåˆç»Ÿè®¡<ul><li>å°†åŸå§‹æ•°æ®èšåˆä¸ºç»Ÿè®¡æ•°æ®</li></ul></li><li>æ˜¾ç¤º<ul><li>å°†ç»Ÿè®¡æ•°æ®ä»¥æŸç§æ ¼å¼æ˜¾ç¤ºåˆ°ç»ˆç«¯å½“ä¸­</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> System Design </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å°(äºŒ) - ç•¥æ·±å…¥äº›çš„æ¢ç©¶</title>
      <link href="/%E4%B8%AD%E5%8F%B0-%E4%BA%8C-%E7%95%A5%E6%B7%B1%E5%85%A5%E4%BA%9B%E7%9A%84%E6%8E%A2%E7%A9%B6/"/>
      <url>/%E4%B8%AD%E5%8F%B0-%E4%BA%8C-%E7%95%A5%E6%B7%B1%E5%85%A5%E4%BA%9B%E7%9A%84%E6%8E%A2%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>ä¸­å°æ˜¯ä¼ä¸šçº§èƒ½åŠ›å¤ç”¨å¹³å°ï¼Œæ•´ä¸ªä¸­å°çš„æ„å»ºï¼Œå®é™…ä¸Šæ˜¯å°†ä¸šåŠ¡æ•°æ®åŒ–ï¼Œå°†æ•°æ®ä¸šåŠ¡åŒ–ã€‚æ˜¯éœ€è¦å»ºç«‹ä¸šåŠ¡ä¸­å°å’Œæ•°æ®ä¸­å°çš„ã€‚ä¸šåŠ¡ä¸­å°é€šè¿‡æŠ½è±¡ï¼Œå°è£…å¯å¤ç”¨çš„é€»è¾‘ï¼Œæå‡ä¼ä¸šçš„å“åº”åŠ›ï¼›æ•°æ®ä¸­å°é€šè¿‡æ‰“é€šä¼ä¸šçš„æ•°æ®ï¼Œæ„å»ºè‡ªå­¦ä¹ æœåŠ¡çš„æ•°æ®èƒ½åŠ›ï¼Œè®©ä¼ä¸šæ›´åŠ æ™ºæ…§ã€‚</p><h1 id="1-é€šç”¨åŒ–é€šç”¨èƒ½åŠ›"><a href="#1-é€šç”¨åŒ–é€šç”¨èƒ½åŠ›" class="headerlink" title="1. é€šç”¨åŒ–é€šç”¨èƒ½åŠ›"></a>1. é€šç”¨åŒ–é€šç”¨èƒ½åŠ›</h1><p>ç›®å‰å¤§éƒ¨åˆ†ä¼ä¸šå®ç°çš„ä¸­å°ï¼Œä¸»è¦æ˜¯å°†é—ç•™ä¸‹çš„åå°ç³»ç»Ÿï¼Œæ¯”å¦‚ERP MES CRMçš„å…¬å…±éƒ¨åˆ†è¿›è¡Œæ‹†è§£å¤ç”¨ï¼Œå½¢æˆç±»ä¼¼äº¤æ˜“ä¸­å¿ƒï¼Œç”¨æˆ·ä¸­å¿ƒï¼Œè®¢å•ä¸­å¿ƒè¿™æ ·çš„å¾®æœåŠ¡é›†åˆä¾›å‰å°è°ƒç”¨ï¼Œä»è€Œä¿è¯<strong>é€»è¾‘çš„ä¸€è‡´æ€§</strong>åŒæ—¶æ›´å¿«å“åº”å‰å°çš„å˜åŒ–</p><p>Reference <a href="https://www.infoq.cn/article/wCZV6X5uujxDXFP0Eub9?utm_source=rss&utm_medium=article" target="_blank" rel="noopener">1</a> å½“ä¸­ä¸¾äº†è®¢å•æœåŠ¡çš„æ¼”è¿›è¿‡ç¨‹çš„ä¾‹å­ï¼Œå¾ˆå€¼å¾—ä¸€çœ‹ã€‚å½“å¹³å°éœ€è¦å¼€æ”¾å¤šæ¸ é“æ¥å®Œæˆè®¢å•çš„æ—¶å€™ï¼Œä¿è¯ç”¨æˆ·æœ‰ç€ç±»ä¼¼çš„ä½“éªŒæ˜¯å¾ˆé‡è¦çš„ä¸€é¡¹ï¼ŒåŒ…æ‹¬æ•´ä¸ªç³»ç»Ÿçš„çš„scalabilityã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ•°æ®ä¸­å°èƒ½å¤Ÿä½¿å¾—ç”¨æˆ·å¯ä»¥çœ‹åˆ°åœ¨å„ä¸ªå¹³å°å„ä¸ªæ¸ é“è‡ªå·±ä¸‹çš„è®¢å•ã€‚ä»å¹³å°è§’åº¦æ¥è¯´ï¼Œæœ‰äº†æ•°æ®ä¸­å°ï¼Œç»´æŠ¤æˆæœ¬ï¼Œå‘ç”Ÿé”™è¯¯ä»¥åçš„ä¿®æ”¹æˆæœ¬éƒ½ä¼šå‡è½»å¾ˆå¤šã€‚</p><p>ç•¥å¾®è§£é‡Šä¸‹ï¼Œå¦‚æœæ˜¯åˆ†å¼€çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆæ¯ä¸ªç³»ç»Ÿéƒ½ä¼šæœ‰è‡ªå·±çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬éœ€è¦åšæ•°æ®çš„joinæ“ä½œï¼Œç„¶åè¿”å›ç»™å‰ç«¯ç”¨æˆ·éœ€è¦çš„æ­£ç¡®çš„ä¿¡æ¯ã€‚å½“å‘ç”Ÿäº†é€»è¾‘ä¸Šçš„é”™è¯¯ä»¥åï¼Œæˆ‘ä»¬å¾ˆæœ‰å¯èƒ½éœ€è¦åœ¨åˆ†å¼€çš„å‡ ä¸ªå­ç³»ç»Ÿå½“ä¸­æ¥åšä¿®æ”¹ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ï¼Œä¿®æ”¹çš„æ•´ä¸ªæ—¶é—´æ¶ˆè€—ä¹Ÿä¼šå¾ˆé•¿ã€‚è€Œä¸”æ•°æ®ä»“åº“åœ¨å¤šä¸ªç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼ŒæŠ½å–æ•°æ®ï¼Œå†è¿›è¡Œåˆ†ææ˜¯æœ‰æ¯”è¾ƒå¤§çš„æ—¶å»¶çš„ï¼Œä¸€èˆ¬éƒ½æ˜¯åŠ ä¸€å¤©çš„æ ·å­ï¼Œæ— æ³•çœ‹åˆ°å®æ—¶çš„æ•°æ®ã€‚</p><h1 id="2-ä½¿ç”¨ä¸­å°å»ERPåŒ–"><a href="#2-ä½¿ç”¨ä¸­å°å»ERPåŒ–" class="headerlink" title="2. ä½¿ç”¨ä¸­å°å»ERPåŒ–"></a>2. ä½¿ç”¨ä¸­å°å»ERPåŒ–</h1><p>ERPï¼Œ å³ä¼ä¸šèµ„æºç®¡ç†ç³»ç»Ÿã€‚æœ€æœ€å¼€å§‹çš„æ—¶å€™ï¼Œä¼ä¸šçš„éœ€æ±‚æ˜¯å°†ä¼ä¸šçš„æµç¨‹æ¢³ç†æ¸…æ™°ï¼Œåšåˆ°èµ„æºçš„é›†çº¦åŒ–ç®¡ç†ï¼Œæœ¬è´¨ä¸Šæ¥è®²æ˜¯ä¸ºäº†è§£å†³æµç¨‹å¤ç”¨ï¼Œä¸šåŠ¡èƒ½åŠ›åŒ–çš„é—®é¢˜ã€‚</p><p>ä½†æ˜¯å½“å‰ERPè½¯ä»¶å­˜åœ¨ç€å¦‚ä¸‹çš„ä¸€äº›é—®é¢˜ï¼š</p><ol><li>å•†ä¸šè½¯ä»¶ï¼Œå“åº”æ…¢<br>ä¼ä¸šåªæœ‰ä½¿ç”¨æƒï¼Œè¿™å°±å¯¼è‡´ä¼ä¸šçš„ä¸šåŠ¡å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œéœ€è¦æ‰¾åˆ°åŸå‚é‡æ–°é…ç½®æˆ–è€…é‡æ–°å¼€å‘ï¼Œå“åº”æ¯”è¾ƒæ…¢</li><li>å°é—­æ¶æ„ï¼Œä¸å¼€æ”¾<br>å¥—è£…ERPè½¯ä»¶æ˜¯å°é—­æ¶æ„ï¼ŒæŠ€æœ¯ä¸å¼€æ”¾ï¼Œå¯¼è‡´ä¼ä¸šæ— æ³•å¯¹å…¶è¿›è¡Œå¤§çš„åŠŸèƒ½ä¸Šçš„æ‰©å±•ï¼Œåªèƒ½åƒæ‰“è¡¥ä¸ä¸€æ ·ï¼Œæ„å»ºä¸€äº›å¤–æŒ‚ï¼Œè€Œä¸”æ•ˆæœå¾€å¾€ä¸ä¼šå¾ˆå¥½</li><li>å•ä½“æ¶æ„ï¼Œå¼¹æ€§ä¸å¤Ÿ<br>å•ä½“æ¶æ„ï¼Œå¾ˆéš¾æ”¯æŒæŒç»­å¢é•¿çš„å„ç§éœ€æ±‚</li><li>å‡çº§ ç»´æŠ¤æˆæœ¬<br>å¥—è£…è½¯ä»¶å‡çº§å’Œç»´æŠ¤æˆæœ¬éå¸¸é«˜</li></ol><p>è¿‡å»äººä»¬éœ€è¦ERPæ›´å¤šçš„æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦æµç¨‹ï¼Œéœ€è¦çŸ¥é“å…·ä½“åº”è¯¥å¦‚ä½•å»ç»„ç»‡ã€‚ä½†æ˜¯åœ¨äº’è”ç½‘åŒ–çš„ä»Šå¤©ï¼ŒåŸæ¥é™æ€åŒ–ï¼Œæ ‡å‡†åŒ–çš„ä¸šåŠ¡æµç¨‹å·²ç»ä¸è¶³ä»¥æ”¯æ’‘ä¼ä¸šçš„å¿«é€Ÿå“åº”äº†ã€‚å› æ­¤ï¼Œè¯‰æ±‚<strong>ä»åŸæ¥çš„æµç¨‹åŒ–å˜æˆäº†éœ€è¦èƒ½å¤Ÿå¿«é€Ÿå“åº”å‰å°å¸‚åœºçš„å˜åŒ–</strong>ã€‚</p><p>ä¼ä¸šç»„ç»‡ç»“æ„ä»æµç¨‹å¼åä½œèµ°å‘äº†å¹³å°å¼åä½œã€‚</p><p>ERPæ›´åƒæ˜¯ä¸€ç§è®¡åˆ’å¼çš„ç»æµï¼Œå¸Œæœ›æ¯ä¸ªè§’è‰²éƒ½æŒ‰ç…§åˆ†é…çš„ä»»åŠ¡æ¥èµ°ï¼Œå…±åŒå®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯è¿™ç§å…±åŒå®Œæˆä¼šå¯¼è‡´ä¸åŒè§’è‰²ä¹‹é—´çš„åˆ©ç›Šç›¸äº’å†²çªã€‚å±€éƒ¨åˆ©ç›Šå¤§äºæ•´ä½“åˆ©ç›Šã€‚</p><p>éœ€è¦çš„è½¬å˜æ˜¯ â€”- è¦å¼€å§‹å­¦ä¹ ä»¥å®¢æˆ·ä¸ºä¸­å¿ƒå»åŠ¨æ€ç»„ç»‡èµ„æºæ¥æä¾›æœåŠ¡ï¼Œå°†åŸæœ¬<strong><em>ä»¥æµç¨‹ä¸ºç‹¬ç«‹å•å…ƒçš„æ¨¡å—æ‹†è§£ä¸ºä»¥å®¢æˆ·ä»·å€¼ä¸ºç‹¬ç«‹å•å…ƒçš„æ¨¡å—</em></strong>ã€‚</p><p>ä»¥å®¢æˆ·ä»·å€¼ä¸ºç‹¬ç«‹å•å…ƒï¼Œå¦‚ä½•è¯„å®šç»©æ•ˆå°±æ˜¯ä¸ªå¾ˆå…³é”®ä¹Ÿå¾ˆå›°éš¾çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¯¹äºé‚£äº›ä¸ºåç«¯èµ‹èƒ½çš„ä¸šåŠ¡å•å…ƒï¼Œå¦‚ä½•å°†å…¶å…³è”åˆ°ç›´æ¥çš„å®¢æˆ·ä»·å€¼å½“ä¸­ã€‚è¿™éœ€è¦æ•°æ®ä¸­å°æä¾›è¿™æ–¹é¢çš„èƒ½åŠ›ï¼Œæ¥åˆ©ç”¨å…¨åŸŸçš„æ•°æ®åˆ†æï¼Œå»ºæ¨¡ï¼Œé€šè¿‡æ•æ„Ÿæ€§åˆ†æç­‰ç®—æ³•æŠ€æœ¯æ¥å®æ—¶è®¡ç®—ã€‚</p><h1 id="3-æ•°æ®ä¸­å°æˆç†Ÿåº¦çš„è¯„ä¼°ç»´åº¦"><a href="#3-æ•°æ®ä¸­å°æˆç†Ÿåº¦çš„è¯„ä¼°ç»´åº¦" class="headerlink" title="3. æ•°æ®ä¸­å°æˆç†Ÿåº¦çš„è¯„ä¼°ç»´åº¦"></a>3. æ•°æ®ä¸­å°æˆç†Ÿåº¦çš„è¯„ä¼°ç»´åº¦</h1><ul><li><p>æ•°æ®æˆ˜ç•¥</p><ul><li><p>ç†å¿µ</p><ul><li>ç©¶ç«Ÿåšæ•°æ®ä¸­å°æ˜¯ä¸ºäº†ä»€ä¹ˆ</li><li>ä¸€ä¸ªç»„ç»‡çš„æ„¿æ™¯å’Œç›®æ ‡ï¼Œæ¥æŒ‡å¯¼æˆ‘ä»¬æ¥ä¸‹æ¥çš„è¡ŒåŠ¨</li><li>ç¡®å®šç»„ç»‡ï¼Œå›¢é˜Ÿå¯¹äºæˆ˜ç•¥çš„ç†è§£æ˜¯ä¸€è‡´çš„</li></ul></li><li><p>è¡ŒåŠ¨</p><ul><li>ä¸€ä¸ªç®¡ç†ç»„ç»‡<ul><li>ç¡®ä¿æˆ˜ç•¥ç›®æ ‡èƒ½å¤Ÿè¢«æœ‰æ•ˆåˆ†è§£</li><li>èƒ½å¤Ÿåœ¨éƒ¨é—¨å›¢é˜Ÿä¹‹é—´è½åœ°</li></ul></li><li>åˆ¶åº¦å»ºè®¾<ul><li>å¦‚ä½•ä¿è¯æˆ˜ç•¥è½åœ°</li><li>å¦‚ä½•å¤„ç†å†²çªï¼Œä¸ä¸€è‡´</li><li>å¦‚æœæ„å»ºå†³ç­–æµç¨‹</li><li>æˆ˜ç•¥/è¡ŒåŠ¨çš„ä¼˜åŒ–å’Œè°ƒæ•´æœºåˆ¶</li></ul></li></ul></li></ul></li><li><p>æ•°æ®æ²»ç†</p><ul><li><p>å…ƒæ•°æ®ç›¸å…³</p><ul><li>å¦‚ä½•åšå…ƒæ•°æ®åˆ†ç±»</li><li>æŠ€æœ¯å’Œä¸šåŠ¡å…ƒæ•°æ®çš„ç®¡ç†</li><li>ç»´æŠ¤æœºåˆ¶</li></ul></li><li><p>æ•°æ®å­—å…¸ç›¸å…³</p></li><li><p>æ•°æ®æ¨¡å‹ç›¸å…³</p></li><li><p>æ•°æ®è´¨é‡ç›¸å…³</p></li><li><p>æ•°æ®æ ‡å‡†ç›¸å…³</p></li><li><p>æ•°æ®å®‰å…¨ç›¸å…³</p></li><li><p>æ•°æ®ç”Ÿå‘½å‘¨æœŸç›¸å…³</p></li></ul></li><li><p>æ•°æ®èµ„äº§ç®¡ç†</p><ul><li><p>æ•°æ®èµ„äº§å®¡æ ¸èƒ½åŠ›</p><ul><li>æ³¨å†Œç”³è¯·</li></ul></li><li><p>æ•°æ®èµ„äº§å‘å¸ƒèƒ½åŠ›</p><ul><li>å°†æ•°æ®æä¾›ç»™æ¶ˆè´¹è€…æŸ¥è¯¢ä½¿ç”¨çš„èƒ½åŠ›</li></ul></li><li><p>æ•°æ®èµ„äº§æ ‡ç­¾</p><ul><li>å®¢æˆ·ç‰¹å¾æ ‡ç­¾</li><li>å…³é”®ä¸šåŠ¡çš„æŒ‡æ ‡æ ‡ç­¾</li></ul></li><li><p>æ•°æ®èµ„äº§åœ°å›¾</p><ul><li>é€šè¿‡åœ°å›¾æˆ–è€…ç›®å½•çš„å½¢å¼ï¼Œæä¾›æ•°æ®èµ„äº§çš„æŸ¥è¯¢åŠŸèƒ½</li><li>å®ç°æ•°æ®èµ„äº§çš„å¯è§†åŒ–</li></ul></li><li><p>æ•°æ®èµ„äº§å¼€æ”¾èƒ½åŠ›</p><ul><li>é€šè¿‡æ¥å£æä¾›ç»™å†…å¤–éƒ¨ç”¨æˆ·ä½¿ç”¨</li></ul></li><li><p>æ•°æ®èµ„äº§ç›˜ç‚¹èƒ½åŠ›</p></li><li><p>æ•°æ®èµ„äº§å®šä»·</p></li><li><p>æ•ˆç›Šè¯„ä¼°</p></li></ul></li><li><p>æ•°æ®å¹³å°å’Œæ¶æ„</p><ul><li>åŸºå‡†<ul><li>æ˜“ç”¨</li><li>ç¨³å®š</li><li>å¯æ‰©å±•</li><li>æ”¯æŒå¤šåº”ç”¨çš„å¹³å°æ¶æ„</li></ul></li><li>æ¶æ„æ ‡å‡†<ul><li>æ¶æ„é€‰æ‹©çš„æµç¨‹<ul><li>åŒä¸šè°ƒç ”</li><li>é€‰å‹</li><li>POC</li><li>å†³ç­–éƒ¨é—¨</li></ul></li><li>æ¶æ„æ–¹æ³•<ul><li>æ¶æ„è§„åˆ’</li><li>åŸºç¡€æ¶æ„</li><li>è¯„ä¼°æœºåˆ¶</li></ul></li></ul></li></ul></li><li><p>æ•°æ®æœåŠ¡åŒ–</p><ul><li><p>æ•°æ®ä¸­å¿ƒä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼å‘å¤–ç•Œæä¾›æœåŠ¡å‘¢ï¼Ÿ</p><ul><li><p>APIè°ƒç”¨</p></li><li><p>æœåŠ¡æ ‡å‡†çš„ç¡®ç«‹</p><ul><li>æœåŠ¡ç›®æ ‡</li><li>æä¾›æ–¹å¼</li><li>æµç¨‹</li><li>ä¼˜å…ˆçº§</li></ul></li><li><p>æœåŠ¡ç›‘æ§å’Œç»´æŠ¤</p><ul><li>é‡åŒ–çš„è¯„ä¼°æ ‡å‡†</li></ul></li><li><p>æ•°æ®æœåŠ¡çš„è¯„ä¼°å’Œä¼˜åŒ–</p></li></ul></li></ul></li><li><p>æ•°æ®äº§å“åŒ–</p><ul><li>äº§å“<ul><li>æŠ¥è¡¨åˆ†æç­‰</li></ul></li><li>ä¸šåŠ¡æ”¯æ’‘èƒ½åŠ›<ul><li>æ‰€èƒ½æ”¯æ’‘çš„ä¸šåŠ¡æ˜¯å¦èƒ½åæ˜ æˆ˜ç•¥çš„æ–¹å‘æˆ–æˆ˜ç•¥çš„æ‰§è¡Œæƒ…å†µï¼ŒåŠŸèƒ½æ”¯æ’‘èƒ½åŠ›æ˜¯ä¸æ˜¯èƒ½è¢«å‘¨æœŸæ€§è¯„ä¼°å’Œä¼˜åŒ–</li></ul></li><li>ä¸šåŠ¡åˆ†æå“åº”èƒ½åŠ›<ul><li>å“åº”æœºåˆ¶</li></ul></li><li>æ•°æ®å¯è§†åŒ–èƒ½åŠ›<ul><li>æ˜¯å¦æ”¯æŒä¸šåŠ¡å‹å¥½çš„ä½¿ç”¨æ–¹å¼</li></ul></li><li>ç»Ÿä¸€æœåŠ¡çš„èƒ½åŠ›<ul><li>æ˜¯å¦èƒ½å¤Ÿå°†ä¸šåŠ¡éœ€æ±‚æ²‰æ·€æˆç»Ÿä¸€çš„æœåŠ¡çš„èƒ½åŠ›ï¼Œä»è€ŒæœåŠ¡æ›´å¤šä¸šåŠ¡å›¢é˜Ÿ</li></ul></li></ul></li><li><p>ä¸­å°è¿è¥</p><ul><li>å°†æ•´ä¸ªå¹³å°ä½œä¸ºä¸€ä¸ªäº§å“æ¥çœ‹ï¼Œæ˜¯å¦æœ‰è¿è¥çš„æŒ‡æ ‡å’Œæ§åˆ¶æœºåˆ¶</li><li>ä¸­å°ç®¡ç†å¹³å°<ul><li>æ–‡æ¡£</li><li>è§„èŒƒ</li><li>æµç¨‹ç­‰</li></ul></li><li>æˆæœ¬åˆ†æ<ul><li>å­˜å‚¨</li><li>è®¡ç®—</li><li>ç ”å‘ <h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1></li></ul></li></ul></li></ul><ol><li><a href="https://www.infoq.cn/article/wCZV6X5uujxDXFP0Eub9?utm_source=rss&amp;utm_medium=article" target="_blank" rel="noopener">https://www.infoq.cn/article/wCZV6X5uujxDXFP0Eub9?utm_source=rss&amp;utm_medium=article</a></li><li><a href="https://insights.thoughtworks.cn/data-zhongtai-maturity-model/" target="_blank" rel="noopener">https://insights.thoughtworks.cn/data-zhongtai-maturity-model/</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jest - JSæµ‹è¯•æ¡†æ¶</title>
      <link href="/Jest-JS%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/"/>
      <url>/Jest-JS%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<p>JJestæ˜¯ä¸€ä¸ªç®€æ´çš„JavaScriptæµ‹è¯•æ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸Babel, TS, Node, React, Angular, Vueç­‰æ¥å…±åŒä½¿ç”¨</p><h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>é¦–å…ˆjestæ˜¯å¸Œæœ›èƒ½å¤Ÿç”¨å¾ˆè½»é‡çš„æ–¹å¼æ¥è¿›è¡Œå‰ç«¯æµ‹è¯•ï¼Œè‡ªå·±æœ€è¿‘åœ¨åšä¸€ä¸ªåå‘å‰ç«¯çš„é¡¹ç›®ï¼Œå¸Œæœ›æŠŠç»„é‡Œçš„å¯¹å¤–é¡µé¢ä»å…¶ä»–å¹³å°è½¬ç§»å‡ºæ¥ï¼Œé€šè¿‡routerå®Œæˆè·¯å¾„çš„è½¬æ¥ï¼Œç„¶ååœ¨è‡ªå·±çš„å¹³å°ä¸Šï¼Œå°±å¯ä»¥æ›´è‡ªç”±ï¼Œæ›´å¿«æ·çš„è¿›è¡Œè¿­ä»£äº†ã€‚</p><p>æ•´ä¸ªæ¶æ„è¿˜æ˜¯RPC æš´éœ²RESTFulæ¥å£ï¼Œç”¨ç±»ä¼¼äºAPI Gatewayçš„ç³»ç»Ÿå®ŒæˆAuthorization Authenticationçš„å·¥ä½œï¼Œå‰ç«¯ç›´æ¥è°ƒç”¨åç«¯çš„ä¿¡æ¯è¿™æ ·å­ã€‚æƒ³è¦è¾¾åˆ°çš„æœ€ç»ˆçš„ç›®æ ‡å°±æ˜¯æ˜“äºç»´æŠ¤ä¸”æ˜“äºæ‰©å±•çš„ä¸€ä¸ªå‰ç«¯å°å¹³å°ï¼Œå‡ ä¸ªåŸºæœ¬éœ€æ±‚ï¼Œä¹Ÿæ˜¯è¦åšè½¬ç§»çš„åŸå› ï¼š</p><ul><li><p>å‰ç«¯çš„åŸ‹ç‚¹ï¼Œå¸Œæœ›æœ‰æ›´å¤šçš„metricsä»¥çŸ¥é“ç”¨æˆ·çš„è¡Œä¸º</p><ul><li>å„ä¸ªé¡µé¢çš„æµè§ˆæ—¶é•¿</li><li>è·³å‡ºç‡</li><li>å“ªä¸ªæ­¥éª¤è¿‡æ»¤èµ°äº†æœ€å¤šçš„ç”¨æˆ·è¯·æ±‚ï¼Œè¯¸å¦‚æ­¤ç±»</li></ul></li><li><p>CI/ CD</p><ul><li>æ‰‹åŠ¨QAå¤ªå®¹æ˜“çŠ¯é”™äº†ï¼Œå¦‚æœèƒ½å†™ä¸€éƒ¨åˆ†unit tests &amp; integration tests,å®ç°æ•´ä¸ªå‰ç«¯é¡µé¢çš„å¯æµ‹è¯•ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°æŒç»­ç»§æ‰¿æŒç»­éƒ¨ç½²ï¼Œä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜å¯äº¤ä»˜èƒ½åŠ›</li></ul></li><li><p>è®¿é—®é€Ÿåº¦</p><ul><li>åˆ©ç”¨S3 hosté¡µé¢ï¼Œä½¿ç”¨CDNå®Œæˆåˆ†å¸ƒï¼Œä¼šæé«˜æ•´ä½“çš„å“åº”é€Ÿåº¦</li></ul></li></ul><p>Jestæ˜¯å®ç°CI/CDçš„å¾ˆä¸é”™çš„ä¸€ä¸ªå·¥å…·ï¼Œon my way learning it ;) </p><h2 id="1-1-åŒ¹é…å™¨"><a href="#1-1-åŒ¹é…å™¨" class="headerlink" title="1.1 åŒ¹é…å™¨"></a>1.1 åŒ¹é…å™¨</h2><p>ä¸Junitç±»ä¼¼ï¼Œä½¿ç”¨expectåšå…³é”®è¯ï¼ŒE.G</p><pre><code>test(&#39;two plus two is four&#39;, () =&gt; {  expect(2 + 2).toBe(4);});</code></pre><ul><li><p>toBe </p><ul><li>åŒ¹é…å™¨ï¼Œå†…éƒ¨ä½¿ç”¨çš„æ˜¯<code>Object.is</code>æ¥åšç²¾ç¡®ç›¸ç­‰</li></ul></li><li><p>toEqual</p><ul><li>æ¥æ£€æŸ¥å¯¹è±¡çš„å€¼</li></ul></li><li><p>æ¯”è¾ƒçœŸå®æ€§</p><ul><li>toBeNull</li><li>toBeUndefined</li><li>toBeTruthy<ul><li>åŒ¹é…ä»»ä½•ifè¯­å¥ä¸ºçœŸ</li></ul></li><li>toBeFalsy <ul><li>åŒ¹é…ä»»ä½•ifè¯­å¥ä¸ºå‡ </li></ul></li></ul></li><li><p>æ¯”è¾ƒæ•°å­—</p><ul><li>toBeGreaterThan()</li><li>toBeGreaterThanOrEqual()</li><li>toBeLessThan()</li><li>toBeLessThanOrEqual()</li><li>toBe()</li><li>toEqual()</li></ul></li><li><p>å­—ç¬¦ä¸²</p><ul><li>toMatch()  matchä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</li></ul></li><li><p>æ•°ç»„ </p><ul><li>toContain() æ£€æŸ¥ä¸€ä¸ªæ•°ç»„æˆ–å¯è¿­ä»£çš„å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªç‰¹å®šé¡¹</li></ul></li></ul><pre><code>const shoppingList = [  &#39;diapers&#39;,  &#39;kleenex&#39;,  &#39;trash bags&#39;,  &#39;paper towels&#39;,  &#39;beer&#39;,];test(&#39;the shopping list has beer on it&#39;, () =&gt; {  expect(shoppingList).toContain(&#39;beer&#39;);  expect(new Set(shoppingList)).toContain(&#39;beer&#39;);});</code></pre><h2 id="1-2-æµ‹è¯•å¼‚æ­¥ä»£ç "><a href="#1-2-æµ‹è¯•å¼‚æ­¥ä»£ç " class="headerlink" title="1.2 æµ‹è¯•å¼‚æ­¥ä»£ç "></a>1.2 æµ‹è¯•å¼‚æ­¥ä»£ç </h2><pre><code>// å¯¹äºå›è°ƒå‡½æ•°çš„æµ‹è¯•test(&#39;the data is peanut butter&#39;, done =&gt; {  function callback(data) {    try {      expect(data).toBe(&#39;peanut butter&#39;);      done();    } catch (error) {      done(error);    }  }  fetchData(callback);});// Promisestest(&#39;the data is peanut butter&#39;, () =&gt; {  return fetchData().then(data =&gt; {    expect(data).toBe(&#39;peanut butter&#39;);  });});// Resolve/ rejecttest(&#39;the data is peanut butter&#39;, () =&gt; {  return expect(fetchData()).resolves.toBe(&#39;peanut butter&#39;);});// async/ awaittest(&#39;the data is peanut butter&#39;, async () =&gt; {  const data = await fetchData();  expect(data).toBe(&#39;peanut butter&#39;);});test(&#39;the fetch fails with an error&#39;, async () =&gt; {  expect.assertions(1);  try {    await fetchData();  } catch (e) {    expect(e).toMatch(&#39;error&#39;);  }});</code></pre><h2 id="1-3-æµ‹è¯•å‰åçš„utilityæ–¹æ³•"><a href="#1-3-æµ‹è¯•å‰åçš„utilityæ–¹æ³•" class="headerlink" title="1.3 æµ‹è¯•å‰åçš„utilityæ–¹æ³•"></a>1.3 æµ‹è¯•å‰åçš„utilityæ–¹æ³•</h2><ul><li>é‡å¤è®¾ç½®å€¼ </li></ul><pre><code>beforeEach(() =&gt; {});afterEach(() =&gt; {});</code></pre><ul><li><p>ä¸€æ¬¡æ€§è®¾ç½® â€“ å•ä¸ªæµ‹è¯•ä¸ä¼šæ”¹å˜å…¶å€¼</p><p>  beforeAll(() =&gt; {</p><p>  });</p><p>  afterAll(() =&gt; {</p><p>  });</p></li><li><p>ä½œç”¨åŸŸ </p><ul><li>é€šè¿‡describeæ¥å°†æµ‹è¯•è¿›è¡Œåˆ†ç»„æ“ä½œ </li><li>æ³¨æ„describeçš„æ‰§è¡Œé¡ºåº <ul><li>åœ¨çœŸæ­£çš„æµ‹è¯•å¼€å§‹ä¹‹å‰æ‰§è¡Œæµ‹è¯•æ–‡ä»¶å½“ä¸­çš„æ‰€æœ‰çš„describeå¤„ç†ç¨‹åº</li><li>å½“describeå—è¿è¡Œå®Œåï¼ŒJestä¼šæŒ‰ç…§testå‡ºç°çš„é¡ºåºä¾æ¬¡è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œç­‰å¾…æ¯ä¸€ä¸ªæµ‹è¯•å®Œæˆå¹¶æ•´ç†å¥½ï¼Œç„¶åç»§ç»­å¾€ä¸‹èµ°</li></ul></li><li>é€šç”¨å»ºè®®<ul><li>å½“æµ‹è¯•å¤±è´¥çš„æ—¶å€™ï¼Œé¦–å…ˆè¦æ£€æŸ¥çš„æ˜¯å¦‚æœä»…è¿è¡Œè¿™æ¡æµ‹è¯•ï¼Œæ˜¯å¦ä»ç„¶å¤±è´¥</li><li>é€šè¿‡å°†testæŒ‡ä»¤æ”¹ä¸ºtest.onlyæŒ‡ä»¤æ¥å®ç°</li></ul></li></ul></li></ul><h2 id="1-4-Mock-æ–¹æ³•"><a href="#1-4-Mock-æ–¹æ³•" class="headerlink" title="1.4 Mock æ–¹æ³•"></a>1.4 Mock æ–¹æ³•</h2><p>Mockå‡½æ•°å…è®¸æˆ‘ä»¬æ¥æµ‹è¯•ä»£ç ä¹‹é—´çš„è¿æ¥ï¼Œå’ŒMockitoï¼Œ EasyMockå…¶å®æ˜¯ä¸€ä¸ªç†å¿µçš„ï¼Œæ“¦é™¤å‡½æ•°çš„å®é™…å®ç°ï¼Œä¸“æ³¨äºå½“å‰çš„æ–‡ä»¶çš„æ–¹æ³•æœ¬èº«ï¼Œæ•è·å¯¹å‡½æ•°çš„è°ƒç”¨ï¼Œå®ä¾‹ç­‰</p><pre><code>function forEach(items, callback) {  for (let index = 0; index &lt; items.length; index++) {    callback(items[index]);  }}const mockCallback = jest.fn(x =&gt; 42 + x);forEach([0, 1], mockCallback);// æ­¤ mock å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡expect(mockCallback.mock.calls.length).toBe(2);// ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 0expect(mockCallback.mock.calls[0][0]).toBe(0);// ç¬¬äºŒæ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 1expect(mockCallback.mock.calls[1][0]).toBe(1);// ç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼æ˜¯ 42expect(mockCallback.mock.results[0].value).toBe(42);</code></pre><h1 id="2-æµ‹è¯•æ–¹æ³•"><a href="#2-æµ‹è¯•æ–¹æ³•" class="headerlink" title="2. æµ‹è¯•æ–¹æ³•"></a>2. æµ‹è¯•æ–¹æ³•</h1><h2 id="2-1-Snapshot-æµ‹è¯•"><a href="#2-1-Snapshot-æµ‹è¯•" class="headerlink" title="2.1 Snapshot æµ‹è¯•"></a>2.1 Snapshot æµ‹è¯•</h2><p>ç»™å½“å‰çš„UIåšå¿«ç…§ï¼Œç„¶åå’Œè¿‡å»åšè¿‡çš„å¿«ç…§è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦æœ‰ä¸åŒã€‚</p><pre><code>import React from &#39;react&#39;;import Link from &#39;../Link.react&#39;;import renderer from &#39;react-test-renderer&#39;;it(&#39;renders correctly&#39;, () =&gt; {  const tree = renderer    .create(&lt;Link page=&quot;http://www.facebook.com&quot;&gt;Facebook&lt;/Link&gt;)    .toJSON();  expect(tree).toMatchSnapshot();});</code></pre><p>å®é™…ä¸Šæ˜¯ç”Ÿæˆä¸€ä¸ªDOMæ ‘ï¼Œç„¶åæ¥æ¯”è¾ƒä¸¤é¢—DOMæ ‘çš„èŠ‚ç‚¹ï¼Œçœ‹è®¾ç½®æ˜¯å¦ç›¸åŒã€‚</p><p>åœ¨æ¯æ¬¡æäº¤çš„æ—¶å€™ï¼Œä¼šè®°å½•ä¸‹å½“å‰çš„å¿«ç…§ï¼Œä¸‹æ¬¡æäº¤çš„æ—¶å€™ä¼šå’Œè¿™æ¬¡çš„æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p><p>ç„¶åå½“æˆ‘ä»¬æœ‰ç›®çš„çš„å¼•å…¥äº†å˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰jest éœ€è¦æ›´æ–°ç°åœ¨ä¿å­˜çš„snapshotäº†ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦è¿è¡ŒæŒ‡ä»¤<code>jest --updateSnapshot</code>.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener">https://jestjs.io/docs/en/getting-started</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¥½ç©çš„ç½‘ç«™åˆ—è¡¨</title>
      <link href="/%E5%A5%BD%E7%8E%A9%E7%9A%84%E7%BD%91%E7%AB%99%E5%88%97%E8%A1%A8/"/>
      <url>/%E5%A5%BD%E7%8E%A9%E7%9A%84%E7%BD%91%E7%AB%99%E5%88%97%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p>å¥½ç©çš„ä¸œè¥¿ï¼ŒæŒç»­æ›´æ–°~ </p><ul><li><p>IPCC Climate Change Report 2021 </p><ul><li><a href="https://www.ipcc.ch/report/ar6/wg1/#FullReport">https://www.ipcc.ch/report/ar6/wg1/#FullReport</a> </li><li>ç¯ä¿ï¼Œå‡å°‘ç¢³æ’æ”¾ä¼šåœ¨æ¥ä¸‹æ¥å¾ˆé•¿ä¸€æ®µæ—¶é—´æˆä¸ºä¸€ä¸ªæ‰€æœ‰äººå…³æ³¨çš„é—®é¢˜</li></ul></li><li><p>digital nomad</p><ul><li>ä»¥æ•°å­—æŠ€æœ¯ä¸ºç”Ÿï¼Œæ¬åˆ°é£æ™¯ä¼˜ç¾ï¼Œæ°”å€™æ¸©å’Œï¼Œç‰©ä»·ä¾¿å®œçš„åœ°æ–¹ï¼Œåšè‡ªå·±æƒ³åšçš„äº‹æƒ…ï¼Œè¿™æ¦‚å¿µæœ‰æ„æ€çš„</li><li><a href="https://nomadlist.com/">https://nomadlist.com/</a> </li></ul></li><li><p>Regex 101 </p><ul><li>ç¥ä¸€æ ·çš„æ­£åˆ™ç½‘ç«™ï¼Œå¯ä»¥åšåœ¨çº¿debug</li><li><a href="https://regex101.com/">https://regex101.com/</a> </li></ul></li><li><p>ä¸­å›½äº’è”ç½‘ä¸­è®¨è®ºçš„æ¶ˆäº¡</p><ul><li><a href="https://mp.weixin.qq.com/s/a-32UpINmb_vSj17epysiA">https://mp.weixin.qq.com/s/a-32UpINmb_vSj17epysiA</a></li></ul></li><li><p>ç»æµæœºå™¨æ˜¯æ€æ ·è¿è¡Œçš„ by Ray Dalio </p><ul><li>åœ¨2020å¹´å¯¹ç€ç°åœ¨çš„ç»æµå½¢åŠ¿çœ‹ï¼Œåˆ«æœ‰ä¸€ç•ªæ»‹å‘³ lol</li><li>tips<ul><li>ä¸è¦è®©å€ºåŠ¡çš„å¢é•¿é€Ÿåº¦è¶…è¿‡æ”¶å…¥</li><li>ä¸è¦è®©æ”¶å…¥çš„å¢é•¿é€Ÿåº¦è¶…è¿‡ç”Ÿäº§ç‡</li><li>å°½ä¸€åˆ‡åŠªåŠ›æé«˜ç”Ÿäº§ç‡</li></ul></li><li><a href="https://www.bilibili.com/video/av6496369/">https://www.bilibili.com/video/av6496369/</a></li></ul></li><li><p>å¤§å›½å‘¨æœŸåŠå‚¨å¤‡è´§å¸å˜è¿ by Ray Dalio</p><ul><li><a href="https://www.chainnews.com/articles/678538813470.htm">link</a></li></ul></li><li><p>æ€è€ƒå·¥å…·çš„ğŸ“±</p><ul><li><a href="https://untools.co/">link</a></li></ul></li><li><p>è®¾è®¡æ¨¡å¼çš„è®²è§£</p><ul><li><a href="https://refactoringguru.cn/design-patterns">link</a></li></ul></li><li><p>è®¡æ—¶æ”»å‡» Timing Attack</p><ul><li><a href="https://coolshell.cn/articles/21003.html">link</a></li></ul></li><li><p>2100å¹´çš„ä¸–ç•Œäººå£</p><ul><li><a href="https://www.thelancet.com/article/S0140-6736%2820%2930677-2/fulltext#seccestitle80">link</a></li><li>é¢„æµ‹ä¸­å›½2035å¹´æˆä¸ºä¸–ç•Œæœ€å¤§ç»æµä½“ï¼Œæ­¤åäººå£ä¼šæ€¥å‰§ä¸‹é™ï¼Œåˆ°2100å¹´åˆ°7äº¿å·¦å³</li><li>ç¾å›½å› ä¸ºæ˜¯ç§»æ°‘å›½å®¶ï¼Œç§»æ°‘ä½¿å¾—äººå£åŸºæœ¬ä¿æŒç¨³å®šï¼Œåœ¨2098å¹´é‡æ–°æˆä¸ºä¸–ç•Œæœ€å¤§ç»æµä½“</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å°(ä¸‰) - çœ‹ç™½è¯ä¸­å°ç³»åˆ—çš„ä¸€äº›æ€»ç»“</title>
      <link href="/%E4%B8%AD%E5%8F%B0-%E4%B8%89-%E7%9C%8B%E7%99%BD%E8%AF%9D%E4%B8%AD%E5%8F%B0%E7%B3%BB%E5%88%97%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/"/>
      <url>/%E4%B8%AD%E5%8F%B0-%E4%B8%89-%E7%9C%8B%E7%99%BD%E8%AF%9D%E4%B8%AD%E5%8F%B0%E7%B3%BB%E5%88%97%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>å‰é¢ä¸¤ç¯‡æ–‡ç« è®²äº†ä¸€äº›å…³äºä¸­å°çš„ä¿¡æ¯, <a href="https://llchen60.com/%E4%B8%AD%E5%8F%B0/" target="_blank" rel="noopener">ä¸­å°1</a>,<a href="https://llchen60.com/%E4%B8%AD%E5%8F%B0-%E4%BA%8C-%E7%95%A5%E6%B7%B1%E5%85%A5%E4%BA%9B%E7%9A%84%E6%8E%A2%E7%A9%B6/" target="_blank" rel="noopener">ä¸­å°2</a>ã€‚</p><ul><li><p>ä¸ºä»€ä¹ˆéœ€è¦å¹³å°åŒ–</p><ul><li>èµ‹äºˆä¼ä¸šç”¨æˆ·å“åº”åŠ›</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ä¸­å°</p><ul><li><strong>ä¼ä¸šçº§èƒ½åŠ›å¤ç”¨å¹³å°</strong></li><li>åŸºç¡€çš„ç†å¿µå’Œæ¶æ„</li><li>å¯ä»¥è”é€šï¼Œæ”¯æŒä¸Šç«¯çš„ä¸šåŠ¡</li><li>éœ€è¦èƒ½å¤Ÿå°†åå°å„å¼å„æ ·çš„èµ„æºè½¬åŒ–ä¸ºå‰å°æ˜“äºä½¿ç”¨çš„èƒ½åŠ› â€“&gt; ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æŒç»­è§„æ¨¡åŒ–åˆ›æ–°</li><li>Platform as a product </li><li>äºšé©¬é€Šå¤§é‡ä½¿ç”¨å¾®æœåŠ¡ï¼Œå…³äºå¾®æœåŠ¡ä¸ä¸­å°ï¼Œå¯ä»¥æƒ³è±¡æˆä¸­å°æ˜¯å¤šä¸ªæœ‰å¹³å°åŒ–èƒ½åŠ›çš„å¾®æœåŠ¡çš„é›†åˆï¼Œé€šè¿‡éšè—å†…éƒ¨çš„ä¿¡æ¯å’Œä¸å¿…è¦çš„æ¥å£ï¼Œå¯¹å¤–å‘ˆç°ä¸ºå•ç‹¬ä¸€ä¸ªå…·æœ‰å¹³å°æœåŠ¡èƒ½åŠ›çš„å¾®æœåŠ¡ã€‚</li></ul></li><li><p>ä¸­å°åˆ†ç±»/ ä¸ºä»€ä¹ˆè¦å»ºå¹³å°</p><ul><li>å†…éƒ¨ç ”å‘æ•ˆèƒ½æå‡</li><li>èµ„æºæ•´åˆ</li><li>æ–°é›¶å”®</li><li>å…¨å‘¨æœŸ</li><li>å…¨æ¸ é“</li><li>å¼€æ”¾é“¶è¡Œ</li><li>å¤šå“ç‰Œæˆ˜ç•¥</li><li>å…¨çƒåŒ–æˆ˜ç•¥</li><li>äº§ä¸šäº’è”</li><li>æ„å»ºå•†ä¸šç”Ÿæ€</li></ul></li><li><p>é˜¿é‡Œçš„æ•°æ®ä¸šåŠ¡åŒä¸­å°</p><ul><li>ä¸šåŠ¡ä¸­å°å°†åå°èµ„æºè¿›è¡ŒæŠ½è±¡åŒ…è£…æ•´åˆï¼Œè½¬åŒ–ä¸ºå‰å°å‹å¥½çš„å¯é‡ç”¨å¯å…±äº«çš„æ ¸å¿ƒèƒ½åŠ›ï¼Œå®ç°åç«¯ä¸šåŠ¡èµ„æºåˆ°å‰å°æ˜“ç”¨èƒ½åŠ›çš„è½¬åŒ–</li><li>æ•°æ®ä¸­å°ä»åå°åŠä¸šåŠ¡ä¸­å°å°†æ•°æ®æµå…¥ï¼Œå®Œæˆæµ·é‡æ•°æ®çš„å­˜å‚¨ï¼Œè®¡ç®—ï¼Œäº§å“åŒ–åŒ…è£…çš„è¿‡ç¨‹ï¼Œæ„æˆä¼ä¸šçš„æ ¸å¿ƒæ•°æ®èƒ½åŠ›</li></ul></li><li><p>é˜¿é‡ŒæŠ€æœ¯ä¸­å°</p><ul><li>å°†ä½¿ç”¨äº‘æˆ–è€…å…¶ä»–åŸºç¡€è®¾æ–½çš„èƒ½åŠ›ä»¥åŠåº”ç”¨å„ç§æŠ€æœ¯ä¸­é—´ä»¶çš„èƒ½åŠ›è¿›è¡Œæ•´åˆåŒ…è£…ï¼Œè¿‡æ»¤æ‰æŠ€æœ¯ç»†èŠ‚ï¼Œæä¾›ç®€å•ä¸€è‡´ï¼Œæ˜“äºä½¿ç”¨çš„åº”ç”¨æŠ€æœ¯åŸºç¡€è®¾æ–½çš„èƒ½åŠ›æ¥å£ï¼ŒåŠ©åŠ›å‰å°å’Œä¸šåŠ¡ä¸­å°æ•°æ®ä¸­å°çš„å¿«é€Ÿå»ºè®¾</li></ul></li><li><p>ç»„ç»‡ä¸­å°</p><ul><li>ä¸­å°å»ºè®¾çœŸæ­£å›°éš¾çš„åœ°æ–¹åœ¨äºç»„ç»‡ä¸Šçš„é‡æ„ï¼ŒæŠ€æœ¯æ¶æ„ä¸ç»„ç»‡æ¶æ„çš„åŒ¹é…ï¼ï¼</li><li>ç»„ç»‡ä¸­å°å¾ˆåƒä¼ä¸šä¸­çš„å†…éƒ¨é£æŠ•å’Œåˆ›æ–°å­µåŒ–æœºæ„ï¼Œä¸ºå‰å°ç»„ç»‡å’Œå›¢é˜Ÿæ„å»ºåˆ›æ–°å‹å‰å°åº”ç”¨æä¾›ç±»ä¼¼äºæŠ•èµ„è¯„ä¼°ï¼ˆé¡¹ç›®ç”„åˆ«ï¼‰ã€æŠ•èµ„ç®¡ç†ã€æŠ•åç®¡ç†ï¼ˆå­µåŒ–ä¸é£æ§ï¼‰ï¼ŒçœŸæ­£ä»ç»„ç»‡å’Œåˆ¶åº¦ä¸Šæ”¯æ’‘å‰å°ç»„ç»‡å’Œåº”ç”¨çš„å¿«é€Ÿè¿­ä»£è§„æ¨¡åŒ–åˆ›æ–°</li></ul></li><li><p>ä¸­å°å»ºè®¾çš„éš¾ç‚¹ â€“ éœ€è¦å…³æ³¨ç»„ç»‡æ¶æ„çš„è°ƒæ•´</p><ul><li>ç»„ç»‡æ¶æ„çš„è°ƒæ•´å’Œæ¼”è¿›ä»¥åŠåˆ©ç›Šçš„é‡æ–°åˆ†é… </li><li>æˆ˜ç•¥çš„è½åœ°æ˜¯éœ€è¦é ç»„ç»‡æ¶æ„çš„è°ƒæ•´æ¥å®ç°çš„ï¼Œä¼ä¸šçš„å‘å±•å–å†³äºä¼ä¸šæ­£ç¡®çš„æˆ˜ç•¥ä»¥åŠä¼ä¸šçš„ç»„ç»‡ç»“æ„ã€‚å‰è€…å†³å®šäº†åè€…ï¼Œåè€…èƒ½å¤Ÿä¿è¯å‰è€…çš„è½åœ°å®ç°</li><li>å¦‚æœå°†ä¸­å°å’Œå‰å°ä¹‹é—´çš„å…³ç³»å®šä¹‰æˆæœåŠ¡å’Œè¢«æœåŠ¡çš„å…³ç³»ï¼Œå¾ˆå®¹æ˜“ä¼šå› ä¸ºå¤§é‡éœ€æ±‚å æ®å¤§é‡æ—¶é—´ï¼ŒçŸ­æœŸåˆ©ç›Šå’Œé•¿æœŸåˆ©ç›Šçš„åšå¼ˆï¼Œé€ æˆå¾ˆå¤šé—®é¢˜</li><li>äº§å“åŒ–æ€ç»´ï¼Œå°†ä¸­å°å½“åšä¸€ä¸ªäº§å“ï¼Œå’Œå…¶ä»–ç»„æ˜¯äº§å“ä¹‹é—´äº’é€šçš„å…³ç³»</li></ul></li><li><p>å…³äºä¸­å° - äº§å“åŒ–æ€è€ƒä»¥åçš„é—®é¢˜</p><ul><li>æ„¿æ™¯æ˜¯ä»€ä¹ˆï¼Ÿ<ul><li>ä¸­å°ä½œä¸ºäº§å“éœ€è¦æœ‰è‡ªå·±çš„æ„¿æ™¯å®šä½ï¼Œä¸ä¸€å®šéœ€è¦æ»¡è¶³æ‰€æœ‰å‰å°å®¢æˆ·çš„éœ€æ±‚ï¼Œè¿™åŒæ ·ä¹Ÿæ„å‘³ç€å‰å°å¯ä»¥é€‰æ‹©ä¸ä½¿ç”¨ä¸­å°çš„æŸäº›èƒ½åŠ›è€Œé€‰æ‹©è‡ªå»ºã€‚</li></ul></li><li>ç”¨æˆ·æ˜¯è°ï¼Ÿ å¦‚ä½•åˆ’åˆ†ï¼Ÿ<ul><li>ä¸­å°ä½œä¸ºäº§å“éœ€è¦æœ‰è‡ªå·±æ¸…æ™°çš„ç”¨æˆ·å®šä½å’Œç”¨æˆ·åˆ’åˆ†ï¼Œå‰å°ä½œä¸ºä¸­å°çš„ç”¨æˆ·ä¸å†æ˜¯å¹³ç­‰çš„ï¼ŒVIP å‰å°ç”¨æˆ·çš„éœ€æ±‚è¦ä¼˜äºå…è´¹å‰å°ç”¨æˆ·çš„è¯‰æ±‚ï¼Œé€šè¿‡äº§å“ä¸Šå¸¸è§çš„ç”¨æˆ·åˆ’åˆ†æ¥è§£å†³éœ€æ±‚è†¨èƒ€ã€æ’æœŸã€ä¼˜å…ˆçº§å’Œå†²çªé—®é¢˜</li></ul></li><li>è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ<ul><li>ä¸­å°ä½œä¸ºä¸€ä¸ªäº§å“ï¼Œéœ€è¦æƒ³æ–¹è®¾æ³•ä½“ç°è‡ªèº«çš„ä»·å€¼ï¼ŒçœŸæ­£ä¸ºå‰å°å®¢æˆ·è§£å†³å®é™…é—®é¢˜ï¼Œå¹¶å…³æ³¨å‰å°ç”¨æˆ·ä½“éªŒï¼Œé€šè¿‡è¥é”€å’Œå”®å‰ç­‰æ‰‹æ®µè·å–å‰å°å®¢æˆ·ï¼Œé€šè¿‡æ¸…æ™°çš„ç”¨æˆ·å®šä½å’Œäº§å“åŠ›å¸å¼•å‰å°å®¢æˆ·ï¼Œè®©å…¶ä¸»åŠ¨é€‰æ‹©é‡‡è´­ä¸­å°äº§å“</li></ul></li><li>ç«äº‰ç¯å¢ƒï¼Ÿ å›¢é˜Ÿæ„æˆï¼Ÿ<ul><li>äº§å“çš„å»ºè®¾åˆæœŸï¼Œä¸ä¸€å®šå¯åŠ¨èµ„é‡‘ç›´æ¥ä»ä¸šåŠ¡ä¸Šåˆ‡åˆ†ï¼Œå¯èƒ½éœ€è¦ç±»ä¼¼äºå¤©ä½¿æŠ•èµ„çš„ä¼ä¸šæˆ˜ç•¥æŠ•èµ„è¿›è¡Œåˆå§‹å­µåŒ–ï¼Œå‡å°‘ä¸­å°å‰æœŸå»ºè®¾çš„ä¸šåŠ¡äº¤ä»˜å‹åŠ›ï¼Œç”šè‡³ä½œä¸ºä¼ä¸šçš„æˆ˜ç•¥çº§äº§å“ï¼Œéœ€è¦ä¸€äº›å†…éƒ¨ä¿æŠ¤å’Œå­µåŒ–ï¼Œä½†ä»éœ€è¦å¿«é€ŸéªŒè¯å…¶ä»·å€¼ï¼Œè·å–å®¢æˆ·ï¼Œå®ç°è‡ªè´Ÿç›ˆäº</li></ul></li><li>å¦‚ä½•è·å–ç”¨æˆ·ï¼Ÿè¥é”€ï¼Ÿå”®å‰ï¼Ÿ</li><li>å¦‚ä½•å‘ç”¨æˆ·æä¾›æœåŠ¡ï¼Ÿ<ul><li>äº§å“çš„å»ºè®¾è¿‡ç¨‹å¯ä»¥å€Ÿé‰´ç²¾ç›Šåˆ›ä¸šæ€è·¯ï¼Œéœ€è¦å°½å¿«ä½“ç°å…¶å•†ä¸šä»·å€¼ï¼Œå¦‚æœä¸€å®šæ—¶æœŸå†…æ— æ³•è·å–ç›¸åº”çš„å‰å°ç”¨æˆ·ï¼ˆå‰å°ä¸ç”¨ï¼‰ï¼Œæˆ–æ˜¯å…¶ä»–è€ƒæ ¸æŒ‡æ ‡ä¸è¾¾æ ‡ï¼Œåˆ™éœ€è¦è¿›è¡Œä¸­å°å»ºè®¾æ­¢æŸï¼Œç±»ä¼¼äºåˆ›ä¸šå¤±è´¥</li><li>ç”šè‡³åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå…è®¸åŒä¸€ç±»å‹çš„ä¸­å°äº§å“å­˜åœ¨åˆç†çš„å†…éƒ¨ç«äº‰ï¼ŒåŒæ—¶å¯¹ä¸¤ä¸ªç›¸ä¼¼çš„ä¸­å°äº§å“è¿›è¡Œå­µåŒ–ï¼Œä½¿ç”¨ç±»ä¼¼äºå†…éƒ¨èµ›é©¬çš„æœºåˆ¶è§£å†³å†…éƒ¨æœåŠ¡å·®å¼‚æ€§å¸¦æ¥çš„å†…éƒ¨äº§å“å„æ–­å’Œå®šä»·å›°éš¾é—®é¢˜</li><li>ä¸­å°äº§å“ä¸ºäº†ç”¨æˆ·ç•™å­˜ï¼Œéœ€è¦å¯¹äºå‰å°å®¢æˆ·æä¾›äº§å“çº§ SLAï¼Œæä¾›å®¢æˆ·è¿è¥ï¼Œå®¢æˆ·å”®åæœåŠ¡ï¼Œä¿æŒäº§å“å¹³æ»‘æ›´æ–°ï¼Œå…³æ³¨ç”¨æˆ·æ»¡æ„åº¦ï¼Œå®ç°å®¢æˆ·ç•™å­˜ä¸è½¬åŒ–</li></ul></li><li>å¦‚ä½•éªŒè¯ä»·å€¼ï¼Ÿæˆæœ¬æ ¸ç®—ï¼Ÿ å®šä»·æœºåˆ¶ï¼Ÿ</li><li>å¦‚ä½•ä¿è¯æœåŠ¡è´¨é‡ï¼Ÿ </li><li>å¦‚ä½•å‡çº§æ¼”è¿›ï¼Ÿäº§å“è¿è¥ï¼Ÿ<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1></li></ul></li></ul><ol><li><a href="https://www.infoq.cn/profile/1084916/publish" target="_blank" rel="noopener">https://www.infoq.cn/profile/1084916/publish</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bash è„šæœ¬</title>
      <link href="/Bash-%E8%84%9A%E6%9C%AC/"/>
      <url>/Bash-%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>Bashæ˜¯å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆçš„é»˜è®¤Shellï¼ˆå‘½ä»¤è¡Œç¯å¢ƒï¼‰ï¼Œå€¼å¾—å»ç ”ç©¶ä¸€æ³¢~</p><p>æœ€è¿‘ä¹Ÿæœ‰å¾ˆå¤šäººè½¬è€Œä½¿ç”¨zshï¼Œçœ‹åˆ°ä¸€ä¸ªä¸é”™çš„<a href="https://apple.stackexchange.com/questions/361870/what-are-the-practical-differences-between-bash-and-zsh" target="_blank" rel="noopener">post</a>,è®²äº†äºŒè€…çš„ä¸»è¦åŒºåˆ«</p><h1 id="1-åŸºæœ¬è¯­æ³•"><a href="#1-åŸºæœ¬è¯­æ³•" class="headerlink" title="1. åŸºæœ¬è¯­æ³•"></a>1. åŸºæœ¬è¯­æ³•</h1><ul><li><p>echo åœ¨å±å¹•è¾“å‡ºä¸€è¡Œæ–‡æœ¬ï¼Œå¯ä»¥å°†è¯¥å‘½ä»¤çš„å‚æ•°åŸæ ·è¾“å‡º</p><ul><li><code>-n</code> å–æ¶ˆæœ«å°¾çš„å›è½¦ç¬¦</li><li><code>-e</code> è§£é‡Šå¼•å·å½“ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œè¿›è¡Œè½¬ä¹‰ </li></ul></li><li><p>å‘½ä»¤æ ¼å¼</p><ul><li><code>command [arg1 ... argN]</code></li><li><code>ls -l</code> ç­‰äº <code>ls --list</code><ul><li>å…¶å®ä¸»è¦æ˜¯å†™scriptçš„æ—¶å€™ä¸ºäº†è®©è¯­å¥è‡ªå·±èƒ½å¤Ÿè§£é‡Šè‡ªå·±ï¼Œä¼šé€‰ç”¨é•¿å½¢å¼ï¼Œå…¶ä½™æ—¶å€™ä¸€èˆ¬éƒ½é€‰ç”¨çŸ­å½¢å¼çš„è¯­å¥</li></ul></li></ul></li><li><p>åˆ†å·</p><ul><li>å‘½ä»¤çš„ç»“æŸç¬¦ï¼Œä½¿å¾—ä¸€è¡Œå¯ä»¥æ”¾ç½®å¤šä¸ªå‘½ä»¤</li><li>ä¸Šä¸ªå‘½ä»¤æ‰§è¡Œå®Œä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤</li><li>åä¸€ä¸ªæŒ‡ä»¤æ€»ä¼šæ¥ç€ç¬¬ä¸€ä¸ªæ¥æ‰§è¡Œï¼Œä¸ç®¡ç¬¬ä¸€ä¸ªæˆåŠŸæˆ–è€…å¤±è´¥</li></ul></li><li><p>å‘½ä»¤ç»„åˆç¬¦</p><ul><li><code>command1 &amp;&amp; command2</code> <ul><li>å¦‚æœcommand1æˆåŠŸï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œcommand2</li></ul></li><li><code>command1 || command2</code><ul><li>å¦‚æœcommand1æˆåŠŸï¼Œå°±ä¸æ‰§è¡Œcommand2äº†</li></ul></li></ul></li><li><p>typeå‘½ä»¤  â€“ ç”¨äºåˆ¤æ–­å‘½ä»¤çš„æ¥æºï¼Œæ˜¯å†…ç½®çš„å‘½ä»¤æˆ–è€…å¤–éƒ¨ç¨‹åº</p><ul><li><code>-a</code> å»æŸ¥çœ‹ä¸€ä¸ªå‘½ä»¤çš„æ‰€æœ‰å®šä¹‰</li><li><code>-t</code> å¯ä»¥è¿”å›ä¸€ä¸ªå‘½ä»¤çš„ç±»å‹<ul><li>alias</li><li>keyword</li><li>function</li><li>builtin</li><li>file</li></ul></li></ul></li><li><p>å¿«æ·é”®</p><ul><li><code>Ctrl + L</code>ï¼šæ¸…é™¤å±å¹•å¹¶å°†å½“å‰è¡Œç§»åˆ°é¡µé¢é¡¶éƒ¨ã€‚</li><li><code>Ctrl + C</code>ï¼šä¸­æ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤ã€‚</li><li><code>Shift + PageUp</code>ï¼šå‘ä¸Šæ»šåŠ¨ã€‚</li><li><code>Shift + PageDown</code>ï¼šå‘ä¸‹æ»šåŠ¨ã€‚</li><li><code>Ctrl + U</code>ï¼šä»å…‰æ ‡ä½ç½®åˆ é™¤åˆ°è¡Œé¦–ã€‚</li><li><code>Ctrl + K</code>ï¼šä»å…‰æ ‡ä½ç½®åˆ é™¤åˆ°è¡Œå°¾ã€‚</li><li><code>Ctrl + D</code>ï¼šå…³é—­ Shell ä¼šè¯ã€‚</li></ul></li></ul><h1 id="2-æ¨¡å¼æ‰©å±•"><a href="#2-æ¨¡å¼æ‰©å±•" class="headerlink" title="2. æ¨¡å¼æ‰©å±•"></a>2. æ¨¡å¼æ‰©å±•</h1><p>Shellæ¥åˆ°ç”¨æˆ·è¾“å…¥å‘½ä»¤ï¼Œé€šè¿‡ç©ºæ ¼è¿›è¡Œå¯¹è¾“å…¥çš„åˆ†å‰²ï¼Œæ‹†æˆè¯å…ƒï¼Œç„¶åæ‰©å±•è¯å…ƒé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦ï¼Œæ¥è°ƒç”¨ç›¸åº”çš„å‘½ä»¤ã€‚</p><ul><li><p>æ³¢æµªçº¿æ‰©å±•</p><ul><li>è‡ªåŠ¨æ‰©å±•ä¸ºå½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•</li></ul></li><li><p><code>ï¼Ÿ</code>æ‰©å±•</p><ul><li>ï¼Ÿä»£è¡¨æ–‡ä»¶è·¯å¾„é‡Œé¢çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œä¸åŒ…æ‹¬ç©ºå­—ç¬¦</li><li><code>file???</code>å°±è¡¨ç¤ºfileåé¢è·Ÿç€ä¸‰ä¸ªå­—ç¬¦çš„æ–‡ä»¶å</li></ul></li><li><p><code>*</code>æ‰©å±•</p><ul><li>ä»£è¡¨æ–‡ä»¶è·¯å¾„é‡Œé¢çš„ä»»æ„æ•°é‡çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬é›¶ä¸ªå­—ç¬¦</li><li>æ³¨æ„ä¸ä¼šåŒ¹é…éšè—æ–‡ä»¶</li></ul></li><li><p><code>[]</code>æ‰©å±•</p><ul><li>åŒ¹é…å†…éƒ¨åŒ…å«çš„ä»»æ„ä¸€ä¸ª</li><li><code>[abcde]</code>å°±ä¼šåŒ¹é…abcdeé‡Œé¢çš„ä»»æ„ä¸€ä¸ª</li><li><code>[!abc]</code> or <code>[^abc]</code> è¡¨ç¤ºåŒ¹é…é™¤äº†abcä»¥å¤–çš„å…¶ä»–å­—ç¬¦</li></ul></li><li><p><code>[start-end]</code>æ‰©å±•</p><ul><li>è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªè¿ç»­çš„èŒƒå›´</li><li><code>[a-c]</code>ç­‰åŒäº[abc]</li></ul></li><li><p><code>{...}</code>æ‰©å±•</p><ul><li>æŒ‡åˆ†åˆ«æ‰©å±•ä¸ºå¤§æ‹¬å·å½“ä¸­å®šä¹‰çš„æ‰€æœ‰å€¼</li><li>å¤§æ‹¬å·é¢éƒ¨é€—å·å‰åä¸èƒ½æœ‰ç©ºæ ¼</li><li><code>echo d{a,e,i,u,o}g</code><ul><li>output:  dag deg dig dug dog</li></ul></li></ul></li><li><p><code>{start..end}</code>æ‰©å±•</p><ul><li><code>echo {1..4}</code><ul><li>output: 1 2 3 4</li></ul></li></ul></li><li><p>å­—ç¬¦ç±»</p><ul><li><code>[[:class:]]</code> è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ç±»ï¼Œæ‰©å±•æˆæŸä¸€ç±»ç‰¹å®šå­—ç¬¦ä¹‹ä¸­çš„ä¸€ä¸ª</li><li><code>[[:alnum:]]</code>ï¼šåŒ¹é…ä»»æ„è‹±æ–‡å­—æ¯ä¸æ•°å­—</li><li><code>[[:alpha:]]</code>ï¼šåŒ¹é…ä»»æ„è‹±æ–‡å­—æ¯</li><li><code>[[:blank:]]</code>ï¼šç©ºæ ¼å’Œ Tab é”®ã€‚</li><li><code>[[:cntrl:]]</code>ï¼šASCII ç  0-31 çš„ä¸å¯æ‰“å°å­—ç¬¦ã€‚</li><li><code>[[:digit:]]</code>ï¼šåŒ¹é…ä»»æ„æ•°å­— 0-9ã€‚</li><li><code>[[:graph:]]</code>ï¼šA-Zã€a-zã€0-9 å’Œæ ‡ç‚¹ç¬¦å·ã€‚</li><li><code>[[:lower:]]</code>ï¼šåŒ¹é…ä»»æ„å°å†™å­—æ¯ a-zã€‚</li><li><code>[[:print:]]</code>ï¼šASCII ç  32-127 çš„å¯æ‰“å°å­—ç¬¦ã€‚</li><li><code>[[:punct:]]</code>ï¼šæ ‡ç‚¹ç¬¦å·ï¼ˆé™¤äº† A-Zã€a-zã€0-9 çš„å¯æ‰“å°å­—ç¬¦ï¼‰ã€‚</li><li><code>[[:space:]]</code>ï¼šç©ºæ ¼ã€Tabã€LFï¼ˆ10ï¼‰ã€VTï¼ˆ11ï¼‰ã€FFï¼ˆ12ï¼‰ã€CRï¼ˆ13ï¼‰ã€‚</li><li><code>[[:upper:]]</code>ï¼šåŒ¹é…ä»»æ„å¤§å†™å­—æ¯ A-Zã€‚</li><li><code>[[:xdigit:]]</code>ï¼š16è¿›åˆ¶å­—ç¬¦ï¼ˆA-Fã€a-fã€0-9ï¼‰</li></ul></li><li><p>é‡è¯è¯­æ³•</p><ul><li><code>?(pattern-list)</code>ï¼šåŒ¹é…é›¶ä¸ªæˆ–ä¸€ä¸ªæ¨¡å¼ã€‚</li><li><code>*(pattern-list)</code>ï¼šåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªæ¨¡å¼ã€‚</li><li><code>+(pattern-list)</code>ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å¼ã€‚</li><li><code>@(pattern-list)</code>ï¼šåªåŒ¹é…ä¸€ä¸ªæ¨¡å¼ã€‚</li><li><code>!(pattern-list)</code>ï¼šåŒ¹é…é›¶ä¸ªæˆ–ä¸€ä¸ªä»¥ä¸Šçš„æ¨¡å¼ï¼Œä½†ä¸åŒ¹é…å•ç‹¬ä¸€ä¸ªçš„æ¨¡å¼</li></ul></li><li><p>shopt å‘½ä»¤ â€“ ç”¨æ¥è°ƒæ•´bachçš„è¡Œä¸º</p><ul><li>-s æ‰“å¼€æŸä¸ªå‚æ•°</li><li>-u å…³é—­æŸä¸ªå‚æ•°</li><li>ç›´æ¥åŠ  optionName  å¯ä»¥æ¥æŸ¥è¯¢æŸä¸ªå‚æ•°æ˜¯å…³é—­çš„è¿˜æ˜¯æ‰“å¼€çš„</li><li>å‚æ•°<ul><li>dotglob  è®©æ‰©å±•ç»“æœåŒ…æ‹¬éšè—æ–‡ä»¶</li><li>nullglob è®©é€šé…ç¬¦ä¸åŒ¹é…ä»»ä½•æ–‡ä»¶åï¼Œè¿”å›ç©ºå­—ç¬¦</li><li>failglob ä½¿å¾—é€šé…ç¬¦ä¸åŒ¹é…ä»»ä½•æ–‡ä»¶åæ—¶ï¼ŒBash ä¼šç›´æ¥æŠ¥é”™ï¼Œè€Œä¸æ˜¯è®©å„ä¸ªå‘½ä»¤å»å¤„ç†</li><li>extglob æ”¯æŒkshçš„ä¸€äº›æ‰©å±•è¯­æ³•</li><li>nocaseglob è®©é€šé…ç¬¦æ‰©å±•ä¸åŒºåˆ†å¤§å°å†™</li><li>globstar  æ˜¯çš„<code>**</code>å¯ä»¥åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­ç›®å½•</li></ul></li></ul></li><li><p>tips</p><ul><li>é€šé…ç¬¦æ˜¯å…ˆè§£é‡Šï¼Œå†æ‰§è¡Œ</li><li>æ–‡ä»¶åæ‰©å±•ä¸åŒ¹é…çš„æ—¶å€™ï¼Œä¼šåŸæ ·è¾“å‡º</li><li>åªé€‚ç”¨äºå•å±‚è·¯å¾„ </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://wangdoc.com/bash/grammar.html" target="_blank" rel="noopener">https://wangdoc.com/bash/grammar.html</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºæ—¶é—´ç®¡ç†</title>
      <link href="/%E5%85%B3%E4%BA%8E%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/"/>
      <url>/%E5%85%B3%E4%BA%8E%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ç»™è‡ªå·±æ·»äº†äº›ä¸ªäººçš„é¡¹ç›®ï¼Œç„¶åï¼Œç¬é—´æ„Ÿè§‰åˆ°æ—¶é—´ä¸å¤Ÿç”¨ã€‚ä¼šæœ‰å¿™äº†ä¸€å¤©ä¸çŸ¥é“è‡ªå·±å¿™ä»€ä¹ˆäº†çš„æ„Ÿè§‰ï¼Œä¼šæœ‰ä¸€å¤©è¢«æ— ç©·çš„çäº‹ï¼Œè¢«å„ç§é—®é¢˜ï¼Œæ²Ÿé€šå æ»¡ï¼Œç„¶åæœ¬æ¥è®¡åˆ’åšçš„äº‹æƒ…ä»€ä¹ˆéƒ½æ²¡åšçš„æ—¶å€™ã€‚hmmï¼Œçœ‹äº†ä¸€äº›åšå®¢å’Œä¹¦ï¼Œè¯•ç€å°†å­¦åˆ°çš„ä¸€äº›æ–¹æ³•ç”¨åœ¨æ¯å¤©çš„å®‰æ’ä¸Šï¼Œå‘ç°æ•ˆæœè¿˜ä¸é”™. </p><p>æ•´ç†äº†æ€ç»´å¯¼å›¾ï¼Œå’Œå¤§å®¶åˆ†äº«ä¸‹ã€‚å…¶ä¸­å¯¹æˆ‘å¸®åŠ©æœ€å¤§çš„ä¸€æ¡ï¼Œæ˜¯å…³äºå¦‚ä½•çœŸæ­£çš„åˆ†æ¸…æ¥šä¸€ä»¶äº‹æƒ…çš„é‡è¦ç¨‹åº¦å’Œç´§æ€¥ç¨‹åº¦ï¼Œä¸æ˜¯è€æ¿è·Ÿä½ è¯´å¾ˆé‡è¦ï¼ŒPMåœ¨å±è‚¡åé¢è¿½ç€ä½ è¿™ä»¶äº‹æƒ…å°±æ˜¯å¾ˆé‡è¦çš„ã€‚å¼„æ¸…æ¥šä»–ä»¬ä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªéœ€æ±‚ï¼Œæœ‰æ²¡æœ‰æ›´åŠ å¿«æ·çš„è§£å†³æ–¹å¼æ›´é‡è¦ã€‚å¦‚æœæ›´è¿‘è·ç¦»çš„çœ‹ï¼Œä¸€ç§ç†è§£å°±æ˜¯â€“ä¸æ˜¯åˆ«äººç”¨é€šä¿¡è½¯ä»¶æ‰¾ä½ ï¼Œä½ å°±å¿…é¡»å½“ä¸‹çœ‹å½“ä¸‹å›ï¼ŒæŒ‰ç…§è‡ªå·±çš„å·¥ä½œèŠ‚å¥ï¼Œä¿è¯è‡ªå·±åœ¨åšçš„äº‹æƒ…æ²¡æœ‰è¢«æ‰“æ–­ï¼Œè¿™å¾€å¾€æ˜¯æ›´æœ‰æ•ˆç‡çš„æ–¹å¼ã€‚</p><p>å–œæ¬¢ä¹¦ä¸­æ‰€è¯´çš„â€åšäº‹æƒ…é ç³»ç»Ÿï¼Œè€Œä¸æ˜¯é ç›´è§‰â€œã€‚å¸Œæœ›å¤§å®¶éƒ½èƒ½å»ºç«‹è‡ªå·±çš„ç³»ç»Ÿï¼ </p><p><img src="https://i.loli.net/2020/05/06/rqCPTkEKiV5pYM3.png" alt="æ—¶é—´ç®¡ç†æ€ç»´å¯¼å›¾"></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¶é—´ç®¡ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java å¤šçº¿ç¨‹ åŸºç¡€çŸ¥è¯†(äºŒ)</title>
      <link href="/Java-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E4%BA%8C/"/>
      <url>/Java-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¹¶å‘å®¹å™¨"><a href="#1-å¹¶å‘å®¹å™¨" class="headerlink" title="1. å¹¶å‘å®¹å™¨"></a>1. å¹¶å‘å®¹å™¨</h1><h2 id="1-1-ConcurrentHashMap"><a href="#1-1-ConcurrentHashMap" class="headerlink" title="1.1 ConcurrentHashMap"></a>1.1 ConcurrentHashMap</h2><ul><li><p>HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</p></li><li><p>å¹¶å‘æƒ…å†µä¸‹ä¸€ä¸ªå¯è¡Œçš„æ–¹å¼æ˜¯ä½¿ç”¨Collections.synchronizedMap()æ¥åŒ…è£…HashMapã€‚</p><ul><li>ä½†é—®é¢˜åœ¨äºä¸€ä¸ªå…¨å±€çš„é”åŒæ­¥ä¸åŒçº¿ç¨‹ä¹‹é—´çš„å¹¶å‘è®¿é—®ï¼Œä¼šå¸¦æ¥ä¸å¯å¿½è§†çš„æ€§èƒ½é—®é¢˜</li></ul></li><li><p>æ•…è€Œä½¿ç”¨ConcurrentHashMap</p><ul><li>è¯»å†™éƒ½èƒ½ä¿è¯è¾ƒé«˜çš„æ€§èƒ½</li><li>è¯»æ“ä½œæ—¶å‡ ä¹ä¸éœ€è¦åŠ é”</li><li>å†™æ“ä½œçš„æ—¶å€™é€šè¿‡é”åˆ†æ®µæŠ€æœ¯åªå¯¹æ‰€æ“ä½œçš„æ®µåŠ é”è€Œä¸å½±å“å®¢æˆ·ç«¯å¯¹å…¶ä»–æ®µçš„è®¿é—®</li></ul></li></ul><ul><li><p>ConcurrentHashMapå’ŒHashTableçš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒ</p><ul><li>åº•å±‚æ•°æ®ç»“æ„<ul><li>ConcurrentHashMapä½¿ç”¨åˆ†æ®µçš„æ•°ç»„å’Œé“¾è¡¨</li><li>Hashtableç”¨æ•°ç»„å’Œé“¾è¡¨ï¼Œæ•°ç»„ä¸ºä¸»ä½“ï¼Œé“¾è¡¨æ˜¯ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªçš„</li></ul></li><li>çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹å¼<ul><li>ä½¿ç”¨nodeæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨synchronizedå’ŒCASæ“ä½œ</li><li>Hashtableæ˜¯ä½¿ç”¨synchronizedæ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡ç›¸å¯¹è¾ƒä½<h2 id="1-2-CopyOnWriteArrayList"><a href="#1-2-CopyOnWriteArrayList" class="headerlink" title="1.2 CopyOnWriteArrayList"></a>1.2 CopyOnWriteArrayList</h2></li></ul></li></ul></li><li><p>é’ˆå¯¹ç°å®åº”ç”¨åœºæ™¯å½“ä¸­ï¼Œè¯»æ“ä½œè¿œè¿œå¤šäºå†™æ“ä½œï¼Œå› ä¸ºè¯»æ“ä½œä¸ä¼šä¿®æ”¹åŸæœ‰æ•°æ®ï¼Œæ‰€ä»¥å°±ä¸å¯¹è¯»è¿›è¡ŒåŠ é”æ“ä½œäº†ã€‚å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®listçš„å†…éƒ¨æ•°æ®ã€‚</p></li><li><p>ReentranReadWriteLock è¯»å†™é”æ˜¯è¯»è¯»å…±äº«ã€å†™å†™äº’æ–¥ã€è¯»å†™äº’æ–¥ã€å†™è¯»äº’æ–¥</p></li><li><p>è€ŒCopyOnWriteArrayList æ˜¯è¯»å–å®Œå…¨ä¸åŠ é”ï¼Œå†™å…¥ä¹Ÿä¸ä¼šé˜»å¡è¯»å–æ“ä½œï¼Œåªæœ‰å†™å…¥å’Œå†™å…¥ä¹‹é—´éœ€è¦è¿›è¡ŒåŒæ­¥ç­‰å¾…ã€‚</p></li></ul><ul><li>å¦‚ä½•å®ç°çš„<ul><li>æ‰€æœ‰å¯å˜æ“ä½œï¼ˆaddï¼Œset ç­‰ç­‰ï¼‰éƒ½æ˜¯é€šè¿‡åˆ›å»ºåº•å±‚æ•°ç»„çš„æ–°å‰¯æœ¬æ¥å®ç°çš„ã€‚å½“ List éœ€è¦è¢«ä¿®æ”¹çš„æ—¶å€™ï¼Œæˆ‘å¹¶ä¸ä¿®æ”¹åŸæœ‰å†…å®¹ï¼Œè€Œæ˜¯å¯¹åŸæœ‰æ•°æ®è¿›è¡Œä¸€æ¬¡å¤åˆ¶ï¼Œå°†ä¿®æ”¹çš„å†…å®¹å†™å…¥å‰¯æœ¬ã€‚å†™å®Œä¹‹åï¼Œå†å°†ä¿®æ”¹å®Œçš„å‰¯æœ¬æ›¿æ¢åŸæ¥çš„æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯å†™æ“ä½œä¸ä¼šå½±å“è¯»æ“ä½œäº†ã€‚</li><li>ä»è®¡ç®—æœºç³»ç»Ÿçš„è§’åº¦æ¥è¯´ï¼Œå®é™…ä¸Šæ˜¯æ‹·è´å†…å­˜ï¼Œåœ¨æ–°å†…å­˜å®Œæˆå†™æ“ä½œï¼Œå¹¶å°†åŸå…ˆçš„å†…å­˜æŒ‡é’ˆæŒ‡å‘æ–°çš„å†…å­˜ï¼ŒåŸæœ‰çš„å†…å­˜å°±å¯ä»¥è¢«å›æ”¶æ‰äº†</li></ul></li></ul><pre><code>    /** The array, accessed only via getArray/setArray. */    private transient volatile Object[] array;    public E get(int index) {        return get(getArray(), index);    }    @SuppressWarnings(&quot;unchecked&quot;)    private E get(Object[] a, int index) {        return (E) a[index];    }    final Object[] getArray() {        return array;    }        /**     * Appends the specified element to the end of this list.     *     * @param e element to be appended to this list     * @return {@code true} (as specified by {@link Collection#add})     */    public boolean add(E e) {        final ReentrantLock lock = this.lock;        lock.lock();//åŠ é”        try {            Object[] elements = getArray();            int len = elements.length;            Object[] newElements = Arrays.copyOf(elements, len + 1);//æ‹·è´æ–°æ•°ç»„            newElements[len] = e;            setArray(newElements);            return true;        } finally {            lock.unlock();//é‡Šæ”¾é”        }    }</code></pre><h2 id="1-3-ConcurrentLinkedQueue"><a href="#1-3-ConcurrentLinkedQueue" class="headerlink" title="1.3 ConcurrentLinkedQueue"></a>1.3 ConcurrentLinkedQueue</h2><p>Java æä¾›çš„çº¿ç¨‹å®‰å…¨çš„ Queue å¯ä»¥åˆ†ä¸ºé˜»å¡é˜Ÿåˆ—å’Œéé˜»å¡é˜Ÿåˆ—ï¼Œå…¶ä¸­é˜»å¡é˜Ÿåˆ—çš„å…¸å‹ä¾‹å­æ˜¯ BlockingQueueï¼Œéé˜»å¡é˜Ÿåˆ—çš„å…¸å‹ä¾‹å­æ˜¯ ConcurrentLinkedQueueï¼Œåœ¨å®é™…åº”ç”¨ä¸­è¦æ ¹æ®å®é™…éœ€è¦é€‰ç”¨é˜»å¡é˜Ÿåˆ—æˆ–è€…éé˜»å¡é˜Ÿåˆ—ã€‚ é˜»å¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡åŠ é”æ¥å®ç°ï¼Œéé˜»å¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡ CAS æ“ä½œå®ç°ã€‚</p><p>ä»åå­—å¯ä»¥çœ‹å‡ºï¼ŒConcurrentLinkedQueueè¿™ä¸ªé˜Ÿåˆ—ä½¿ç”¨é“¾è¡¨ä½œä¸ºå…¶æ•°æ®ç»“æ„ï¼ConcurrentLinkedQueue åº”è¯¥ç®—æ˜¯åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸­æ€§èƒ½æœ€å¥½çš„é˜Ÿåˆ—äº†ã€‚å®ƒä¹‹æ‰€æœ‰èƒ½æœ‰å¾ˆå¥½çš„æ€§èƒ½ï¼Œæ˜¯å› ä¸ºå…¶å†…éƒ¨å¤æ‚çš„å®ç°ã€‚</p><p>å…¶ä¸­ä¸»è¦ä½¿ç”¨CASéé˜»å¡ç®—æ³•æ¥å®ç°</p><h1 id="2-ä¹è§‚é”æ‚²è§‚é”"><a href="#2-ä¹è§‚é”æ‚²è§‚é”" class="headerlink" title="2. ä¹è§‚é”æ‚²è§‚é”"></a>2. ä¹è§‚é”æ‚²è§‚é”</h1><p>ä¹è§‚é”é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µï¼Œå³å†²çªæœ¬èº«å‘ç”Ÿçš„å¯èƒ½æ€§å°±æ¯”è¾ƒä½ï¼Œè¿™æ ·å°±èƒ½çœå»é”çš„å¼€é”€ï¼ŒåŠ å¤§æ•´ä¸ªç³»ç»Ÿçš„ååé‡ï¼›ä½†æ˜¯å¤šå†™çš„æƒ…å†µä¸‹ï¼Œä¼šæ¯”è¾ƒå®¹æ˜“äº§ç”Ÿå†²çªï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ä¸Šå±‚ä¸æ–­è¿›è¡Œretryï¼Œåå€’ä¼šé™ä½æ€§èƒ½ï¼Œæ‰€ä»¥ä¸€èˆ¬å¤šå†™çš„åœºæ™¯ä¸‹ç”¨æ‚²è§‚é”æ¯”è¾ƒåˆé€‚ã€‚</p><h2 id="2-1-ä¹è§‚é”"><a href="#2-1-ä¹è§‚é”" class="headerlink" title="2.1 ä¹è§‚é”"></a>2.1 ä¹è§‚é”</h2><p>æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨<strong>ç‰ˆæœ¬å·æœºåˆ¶</strong>å’Œ<strong>CASç®—æ³•</strong>å®ç°ã€‚ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ï¼Œåƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äºwrite_conditionæœºåˆ¶ï¼Œå…¶å®éƒ½æ˜¯æä¾›çš„ä¹è§‚é”ã€‚åœ¨Javaä¸­java.util.concurrent.atomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±»å°±æ˜¯ä½¿ç”¨äº†ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼CASå®ç°çš„ã€‚</p><p>å…³äºCASç®—æ³•ï¼Œå®è´¨ä¸Šå°±å…ˆæ‹¿åˆ°æŒ‡å®šå†…å­˜ä¸Šçš„æ•°æ®ï¼Œï¼ˆè¯»å–æ“ä½œï¼‰ï¼Œçº¿ç¨‹æ“ä½œå¤„ç†æ•°æ®ï¼Œåœ¨è¦å†™å…¥ä¹‹å‰ï¼Œå†æ¬¡æŸ¥è¯¢è¯¥å†…å­˜ä½ç½®ä¸Šçš„æ•°æ®ï¼Œå¦‚æœæ•°æ®ä¸€è‡´ï¼Œé‚£å°±å¯ä»¥å†™å…¥ï¼Œå¦‚æœæ•°æ®ä¸ä¸€è‡´ï¼Œå°±throw exceptionï¼Œå‘ŠçŸ¥ç³»ç»Ÿå‡ºç°äº†é—®é¢˜ã€‚</p><h3 id="2-1-1-ä¹è§‚é”å®ç°æ–¹å¼"><a href="#2-1-1-ä¹è§‚é”å®ç°æ–¹å¼" class="headerlink" title="2.1.1 ä¹è§‚é”å®ç°æ–¹å¼"></a>2.1.1 ä¹è§‚é”å®ç°æ–¹å¼</h3><p>ä¹è§‚é”å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶æˆ–è€…CASç®—æ³•æ¥è¿›è¡Œå®ç°</p><ul><li><p>ç‰ˆæœ¬å·æœºåˆ¶</p><ul><li>åœ¨æ•°æ®è¡¨ä¸­åŠ ä¸Šæ•°æ®ç‰ˆæœ¬å·versionå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°</li><li>è¢«ä¿®æ”¹ï¼Œversionå€¼ä¼š+1</li><li>å½“çº¿ç¨‹Aè¦æ›´æ–°æ•°æ®æ—¶ï¼Œè¯»æ•°æ®çš„åŒæ—¶ä¹Ÿä¼šè¯»å–versionå€¼ï¼Œæäº¤æ›´æ–°çš„æ—¶å€™ï¼Œè‹¥åˆšæ‰è¯»å–åˆ°çš„versionå€¼å’Œå½“å‰æ•°æ®åº“çš„versionå€¼ç›¸ç­‰æ‰æ›´æ–°ï¼Œå¦åœ¨é‡è¯•</li></ul></li><li><p>CASç®—æ³•</p><ul><li>compare and swapç®—æ³•ï¼Œæ— é”ç¼–ç¨‹</li><li>ä¸ä½¿ç”¨é”çš„æƒ…å†µä¸‹å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„å˜é‡åŒæ­¥ï¼Œå³åœ¨æ²¡æœ‰çº¿ç¨‹è¢«é˜»å¡çš„æƒ…å†µä¸‹å®ç°å˜é‡çš„åŒæ­¥ â€“ éé˜»å¡åŒæ­¥ Non=blocking synchronization </li></ul></li></ul><h3 id="2-1-2-ç¼ºç‚¹"><a href="#2-1-2-ç¼ºç‚¹" class="headerlink" title="2.1.2 ç¼ºç‚¹"></a>2.1.2 ç¼ºç‚¹</h3><ul><li><p>ABA é—®é¢˜</p><ul><li>ä¸€ä¸ªå˜é‡åˆå§‹å€¼ä¸ºAï¼Œåœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™ä»ä¸ºAï¼Œä½†æ˜¯åœ¨è¿™æ®µæ—¶é—´å½“ä¸­å®ƒæœ‰å¯èƒ½å·²ç»è¢«æ”¹ä¸ºäº†å…¶ä»–çš„å€¼äº†ï¼ŒCASæ“ä½œä¼šè®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«ä¿®æ”¹è¿‡</li><li>å¯ä»¥ä½¿ç”¨AtomicStampedReferenceç±»ï¼ŒcompareAndSetæ–¹æ³•é¦–å…ˆæ£€æŸ¥å½“å‰å¼•ç”¨æ˜¯å¦ç­‰äºé¢„æœŸå¼•ç”¨ï¼Œä»¥åŠå½“å‰æ ‡å¿—æ˜¯å¦ç­‰äºé¢„æœŸæ ‡å¿—ã€‚å¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œå°±ä»¥åŸå­æ–¹å¼å°†è¯¥å¼•ç”¨å’Œè¯¥æ ‡å¿—çš„å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚</li></ul></li><li><p>å¾ªç¯æ—¶é—´å¼€é”€å¤§</p><ul><li>è‡ªæ—‹CASå¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥å¾ˆå¤§çš„æ‰§è¡Œå¼€é”€</li></ul></li><li><p>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</p><ul><li>CASåªå¯¹å•ä¸ªå…±äº«å˜é‡æœ‰æ•ˆï¼Œå½“æ“ä½œæ¶‰åŠå¤šä¸ªå…±äº«å˜é‡çš„æ—¶å€™CASæ— æ•ˆ</li><li>AtomicReferenceè¿™ä¸€ç±»èƒ½å¤Ÿä¿è¯å¼•ç”¨å¯¹è±¡ä¹‹é—´çš„åŸå­æ€§ï¼Œå¯ä»¥å°†å¤šä¸ªå˜é‡æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œè¿›è¡ŒCASæ“ä½œ</li></ul></li></ul><h2 id="2-2-æ‚²è§‚é”"><a href="#2-2-æ‚²è§‚é”" class="headerlink" title="2.2 æ‚²è§‚é”"></a>2.2 æ‚²è§‚é”</h2><p>æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ï¼ˆå…±äº«èµ„æºæ¯æ¬¡åªç»™ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œå…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œç”¨å®Œåå†æŠŠèµ„æºè½¬è®©ç»™å…¶å®ƒçº¿ç¨‹ï¼‰ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚Javaä¸­synchronizedå’ŒReentrantLockç­‰ç‹¬å é”å°±æ˜¯æ‚²è§‚é”æ€æƒ³çš„å®ç°ã€‚</p><h1 id="3-çº¿ç¨‹æ± "><a href="#3-çº¿ç¨‹æ± " class="headerlink" title="3. çº¿ç¨‹æ± "></a>3. çº¿ç¨‹æ± </h1><ul><li>çº¿ç¨‹æ± ç”¨æ¥é™åˆ¶å’Œç®¡ç†èµ„æºï¼Œæ¯ä¸ªçº¿ç¨‹æ± è¿˜å¯ä»¥ç»´æŠ¤ä¸€äº›åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯</li><li>å¥½å¤„<ul><li>é™ä½èµ„æºæ¶ˆè€—<ul><li>é‡å¤åˆ©ç”¨å·²ç»åˆ›å»ºçš„çº¿ç¨‹ï¼Œæ¥é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—</li></ul></li><li>æé«˜å“åº”é€Ÿåº¦<ul><li>å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œ</li></ul></li><li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§<ul><li>çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œæ— é™åˆ¶åˆ›å»ºä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå¹¶ä¸”é™ä½ç³»ç»Ÿç¨³å®šæ€§ï¼›ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§</li></ul></li></ul></li></ul><h2 id="3-1-ThreadPoolExecutorè¯¦è§£"><a href="#3-1-ThreadPoolExecutorè¯¦è§£" class="headerlink" title="3.1 ThreadPoolExecutorè¯¦è§£"></a>3.1 ThreadPoolExecutorè¯¦è§£</h2><pre><code>/** * ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚ */public ThreadPoolExecutor(int corePoolSize,                          int maximumPoolSize,                          long keepAliveTime,                          TimeUnit unit,                          BlockingQueue&lt;Runnable&gt; workQueue,                          ThreadFactory threadFactory,                          RejectedExecutionHandler handler) {    if (corePoolSize &lt; 0 ||        maximumPoolSize &lt;= 0 ||        maximumPoolSize &lt; corePoolSize ||        keepAliveTime &lt; 0)        throw new IllegalArgumentException();    if (workQueue == null || threadFactory == null || handler == null)        throw new NullPointerException();    this.corePoolSize = corePoolSize;    this.maximumPoolSize = maximumPoolSize;    this.workQueue = workQueue;    this.keepAliveTime = unit.toNanos(keepAliveTime);    this.threadFactory = threadFactory;    this.handler = handler;}</code></pre><ul><li>corePoolSize <ul><li>å®šä¹‰äº†ä¸ä¼štimeoutçš„æœ€å°çš„åŒæ—¶å·¥ä½œçš„çº¿ç¨‹æ•°é‡</li></ul></li><li>maxPoolSize<ul><li>å®šä¹‰äº†å¯ä»¥è¢«åˆ›å»ºçš„çº¿ç¨‹çš„æœ€å¤§æ•°é‡</li><li>å’ŒCorePoolSizeçš„åŒºåˆ«åœ¨äºå½“æäº¤ä¸€ä¸ªæ–°çš„ä»»åŠ¡ï¼Œå½“å‰çº¿ç¨‹æ•°é‡å°äºcorePoolSizeçš„æ—¶å€™ï¼Œå“ªæ€•ç°åœ¨å­˜åœ¨çš„çº¿ç¨‹æ˜¯ç©ºé—²çš„ï¼Œè¿˜æ˜¯ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ¥è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼›maxPoolSizeè¯´çš„æ˜¯æœ€å¤šèƒ½å¤Ÿåˆ›å»ºçš„çº¿ç¨‹æ•°é‡ï¼Œæ˜¯ä¸Šé™</li></ul></li><li>workQueue<ul><li>å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­</li></ul></li><li>handler é¥±å’Œç­–ç•¥ - å½“å½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡ï¼Œå¹¶ä¸”é˜Ÿåˆ—å·²ç»è¢«æ”¾æ»¡äº†çš„æ—¶å€™çš„ç­–ç•¥<ul><li>AbortPolicy<ul><li>æŠ›å‡ºRejectedExecutionExceptionæ¥æ‹’ç»æ–°çš„ä»»åŠ¡çš„å¤„ç†</li></ul></li><li>CallerRunsPolicy <ul><li>è°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ï¼Œä¼šæœ‰å»¶è¿Ÿ</li></ul></li><li>DiscardPolicy  <ul><li>ä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰</li></ul></li><li>DiscardOldestPolicy <ul><li>ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚</li></ul></li></ul></li></ul><ul><li><p>Executor.executeä»£ç çš„æºç å¦‚ä¸‹ï¼š </p><pre><code>  // å­˜æ”¾çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (runState) å’Œçº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (workerCount)  private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));  private static int workerCountOf(int c) {      return c &amp; CAPACITY;  }  private final BlockingQueue&lt;Runnable&gt; workQueue;  public void execute(Runnable command) {      // å¦‚æœä»»åŠ¡ä¸ºnullï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚      if (command == null)          throw new NullPointerException();      // ctl ä¸­ä¿å­˜çš„çº¿ç¨‹æ± å½“å‰çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯      int c = ctl.get();      //  ä¸‹é¢ä¼šæ¶‰åŠåˆ° 3 æ­¥ æ“ä½œ      // 1.é¦–å…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ± ä¸­ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡æ˜¯å¦å°äº corePoolSize      // å¦‚æœå°äºçš„è¯ï¼Œé€šè¿‡addWorker(command, true)æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†ä»»åŠ¡(command)æ·»åŠ åˆ°è¯¥çº¿ç¨‹ä¸­ï¼›ç„¶åï¼Œå¯åŠ¨è¯¥çº¿ç¨‹ä»è€Œæ‰§è¡Œä»»åŠ¡ã€‚      if (workerCountOf(c) &lt; corePoolSize) {          if (addWorker(command, true))              return;          c = ctl.get();      }      // 2.å¦‚æœå½“å‰ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡å¤§äºç­‰äº corePoolSize çš„æ—¶å€™å°±ä¼šèµ°åˆ°è¿™é‡Œ      // é€šè¿‡ isRunning æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ± çŠ¶æ€ï¼Œçº¿ç¨‹æ± å¤„äº RUNNING çŠ¶æ€æ‰ä¼šè¢«å¹¶ä¸”é˜Ÿåˆ—å¯ä»¥åŠ å…¥ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¢«åŠ å…¥è¿›å»      if (isRunning(c) &amp;&amp; workQueue.offer(command)) {          int recheck = ctl.get();          // å†æ¬¡è·å–çº¿ç¨‹æ± çŠ¶æ€ï¼Œå¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯ RUNNING çŠ¶æ€å°±éœ€è¦ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡ï¼Œå¹¶å°è¯•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚åŒæ—¶æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚          if (!isRunning(recheck) &amp;&amp; remove(command))              reject(command);              // å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸ºç©ºå°±æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶æ‰§è¡Œã€‚          else if (workerCountOf(recheck) == 0)              addWorker(null, false);      }      //3. é€šè¿‡addWorker(command, false)æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†ä»»åŠ¡(command)æ·»åŠ åˆ°è¯¥çº¿ç¨‹ä¸­ï¼›ç„¶åï¼Œå¯åŠ¨è¯¥çº¿ç¨‹ä»è€Œæ‰§è¡Œä»»åŠ¡ã€‚      //å¦‚æœaddWorker(command, false)æ‰§è¡Œå¤±è´¥ï¼Œåˆ™é€šè¿‡reject()æ‰§è¡Œç›¸åº”çš„æ‹’ç»ç­–ç•¥çš„å†…å®¹ã€‚      else if (!addWorker(command, false))          reject(command);  }</code></pre></li></ul><p><img src="https://i.loli.net/2020/05/02/t7yVTDjNZdnEahw.png" alt="execute process"></p><h2 id="3-2-Executoræ¡†æ¶"><a href="#3-2-Executoræ¡†æ¶" class="headerlink" title="3.2 Executoræ¡†æ¶"></a>3.2 Executoræ¡†æ¶</h2><p>Java5ä»¥åå¼•å…¥çš„Executorï¼Œç”¨å…¶å¯åŠ¨çº¿ç¨‹æ¯”ä½¿ç”¨Threadçš„startæ–¹æ³•æ›´å¥½ï¼Œæ˜“ç®¡ç†ï¼Œæ•ˆç‡é«˜ï¼Œè¿˜å¯ä»¥å¸®åŠ©é¿å…thisé€ƒé€¸çš„é—®é¢˜ã€‚Executoræ¡†æ¶æä¾›äº†ï¼š</p><ul><li>çº¿ç¨‹æ± ç®¡ç†</li><li>çº¿ç¨‹å·¥å‚</li><li>é˜Ÿåˆ—</li><li>æ‹’ç»ç­–ç•¥</li></ul><h3 id="3-2-1-æ¡†æ¶ç»“æ„"><a href="#3-2-1-æ¡†æ¶ç»“æ„" class="headerlink" title="3.2.1 æ¡†æ¶ç»“æ„"></a>3.2.1 æ¡†æ¶ç»“æ„</h3><ul><li>ä»»åŠ¡<ul><li>æ‰§è¡Œä»»åŠ¡å®ç°Runnableæˆ–è€…Callableæ¥å£ï¼Œç„¶åè¢«ThreadPoolExecutoræˆ–è€…ScheduledThreadPoolExecutoræ¥æ‰§è¡Œ</li></ul></li><li>ä»»åŠ¡æ‰§è¡Œ<ul><li>Executor</li></ul></li><li>å¼‚æ­¥è®¡ç®—çš„ç»“æœ<ul><li>Futureæ¥å£ä»¥åŠFutureæ¥å£å®ç°ç±»FutureTaskéƒ½å¯ä»¥æ¥ä»£è¡¨å¼‚æ­¥è®¡ç®—çš„ç»“æœ</li></ul></li></ul><p><img src="https://i.loli.net/2020/05/04/pxtNFGULRe3IT6a.png" alt="Exectuor æµç¨‹å›¾"></p><p>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»çº¿ç¨‹é¦–å…ˆåˆ›å»ºå¹¶å®ç°äº†Runnableæˆ–è€…Callableçš„ä»»åŠ¡å¯¹è±¡ï¼Œè€Œåå°†å¯¹è±¡äº¤ç»™ExecutorServiceæ¥æ‰§è¡Œï¼Œç„¶åæ‹¿åˆ°è¿”å›çš„Futureæ¥å£ï¼Œæ‰§è¡ŒFutureTask.getï¼ˆï¼‰ç­‰æ–¹æ³•æ¥ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆ</p><h2 id="3-3-å¸¸ç”¨çº¿ç¨‹æ± "><a href="#3-3-å¸¸ç”¨çº¿ç¨‹æ± " class="headerlink" title="3.3 å¸¸ç”¨çº¿ç¨‹æ± "></a>3.3 å¸¸ç”¨çº¿ç¨‹æ± </h2><h3 id="3-3-1-FixedThreadPool"><a href="#3-3-1-FixedThreadPool" class="headerlink" title="3.3.1 FixedThreadPool"></a>3.3.1 FixedThreadPool</h3><ul><li><p>FixedThreadPool</p><ul><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äº corePoolSizeï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œå°±åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›</li><li>å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äº corePoolSize åï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œä¼šå°†ä»»åŠ¡åŠ å…¥ LinkedBlockingQueueï¼›</li><li>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œå®Œ æ‰‹å¤´çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä» LinkedBlockingQueue ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</li></ul></li><li><p>ä¸æ¨èä½¿ç”¨</p><ul><li><p>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ° corePoolSize åï¼Œæ–°ä»»åŠ¡å°†åœ¨æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œå› æ­¤çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ corePoolSize</p></li><li><p>ç”±äºä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ maximumPoolSize å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œé€šè¿‡åˆ›å»º FixedThreadPoolçš„æºç å¯ä»¥çœ‹å‡ºåˆ›å»ºçš„ FixedThreadPool çš„ corePoolSize å’Œ maximumPoolSize è¢«è®¾ç½®ä¸ºåŒä¸€ä¸ªå€¼</p></li><li><p>ç”±äºä¸Šè¿°ä¸¤ç‚¹ï¼ŒkeepAliveTimeå°±ä¼šæ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°äº†</p></li><li><p>å› ä¸ºæ— æ³•æ‰§è¡Œshutdown() shutdownNow()ï¼Œä¸ä¼šæ‹’ç»ä»»åŠ¡ï¼Œåœ¨ä»»åŠ¡æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šå¯¼è‡´OOM(å†…å­˜æº¢å‡ºçš„é—®é¢˜)</p><p>public static ExecutorService newFixedThreadPool(int nThreads) {<br>  return new ThreadPoolExecutor(nThreads, nThreads,</p><pre><code>                            0L, TimeUnit.MILLISECONDS,                            new LinkedBlockingQueue&lt;Runnable&gt;());</code></pre><p>}</p></li></ul></li></ul><h3 id="3-3-2-CachedThreadPool"><a href="#3-3-2-CachedThreadPool" class="headerlink" title="3.3.2 CachedThreadPool"></a>3.3.2 CachedThreadPool</h3><p>å¯ä»¥æ ¹æ®éœ€è¦æ¥åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± </p><pre><code>    /**     * åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹ï¼Œä½†ä¼šåœ¨å…ˆå‰æ„å»ºçš„çº¿ç¨‹å¯ç”¨æ—¶é‡ç”¨å®ƒã€‚     */    public static ExecutorService newCachedThreadPool(ThreadFactory threadFactory) {        return new ThreadPoolExecutor(0, Integer.MAX_VALUE,                                      60L, TimeUnit.SECONDS,                                      new SynchronousQueue&lt;Runnable&gt;(),                                      threadFactory);    }</code></pre><p>æ³¨æ„çœ‹æºç ä¸­ï¼ŒcorePoolSizeè®¾ç½®ä¸ºç©ºï¼ŒmaximumPoolSizeè®¾ç½®ä¸ºæ— ç•Œçš„äº†ï¼Œå¦‚æœä¸»çº¿ç¨‹æäº¤ä»»åŠ¡çš„é€Ÿåº¦é«˜äºmaximumPoolä¸­çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦ï¼ŒCachedThreadPoolä¼šä¸æ–­åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œä¼šè€—å°½CPUå’Œå†…å­˜èµ„æºçš„ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://github.com/Snailclimb/JavaGuide/" target="_blank" rel="noopener">https://github.com/Snailclimb/JavaGuide/</a> </li><li><a href="https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/" target="_blank" rel="noopener">https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Multi-threading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´§å¸,ä¿¡è´·,å€ºåŠ¡æ˜¯å¦‚ä½•è¿ä½œçš„ from Ray Dalio</title>
      <link href="/%E8%B4%A7%E5%B8%81-%E4%BF%A1%E8%B4%B7-%E5%80%BA%E5%8A%A1%E6%98%AF%E5%A6%82%E4%BD%95%E8%BF%90%E4%BD%9C%E7%9A%84-from-Ray-Dalio/"/>
      <url>/%E8%B4%A7%E5%B8%81-%E4%BF%A1%E8%B4%B7-%E5%80%BA%E5%8A%A1%E6%98%AF%E5%A6%82%E4%BD%95%E8%BF%90%E4%BD%9C%E7%9A%84-from-Ray-Dalio/</url>
      
        <content type="html"><![CDATA[<p>Ray Dalioåœ¨LinkedInä¸Šçš„é•¿æ–‡ï¼Œä¸»è¦åˆ†æäº†åœ¨é•¿æœŸå€ºåŠ¡å‘¨æœŸå½“ä¸­ï¼Œè´§å¸ã€ä¿¡è´·ã€å€ºåŠ¡ä¹‹é—´çš„ç›¸äº’è¿ä½œå…³ç³»ï¼Œä»¥åŠå®ƒä»¬é©±åŠ¨å…¨çƒç»æµå’Œæ”¿æ²»å˜åŒ–çš„æ–¹å¼ã€‚</p><h1 id="1-è´§å¸å’Œä¿¡è´·"><a href="#1-è´§å¸å’Œä¿¡è´·" class="headerlink" title="1. è´§å¸å’Œä¿¡è´·"></a>1. è´§å¸å’Œä¿¡è´·</h1><p>æ‰€æœ‰å®ä½“ï¼ˆå›½å®¶ã€å…¬å¸ã€éè¥åˆ©ç»„ç»‡å’Œä¸ªäººï¼‰éƒ½éœ€å¤„ç†åŸºæœ¬è´¢åŠ¡ï¼Œä»–ä»¬çš„æ”¶å…¥å’Œæ”¯å‡ºæ„æˆäº†å‡€æ”¶å…¥ï¼Œè€Œè¿™äº›æµåŠ¨æ˜¯å¯ä»¥ç”¨èµ„äº§è´Ÿå€ºè¡¨ä¸­çš„æ•°å­—æ¥è¡¡é‡çš„ã€‚å¦‚æœä¸€ä¸ªäººèµšçš„æ¯”èŠ±çš„å¤šï¼Œä»–å°±ä¼šæœ‰åˆ©æ¶¦ï¼Œä»è€Œä½¿ä»–çš„å‚¨è“„å¢åŠ ã€‚è€Œå¦‚æœä¸€ä¸ªäººçš„æ”¯å‡ºå¤§äºæ”¶å…¥ï¼Œé‚£ä¹ˆä»–çš„å‚¨è“„å°±ä¼šå‡å°‘ï¼Œæˆ–è€…ä»–ä¸å¾—ä¸é€šè¿‡å€Ÿé’±æˆ–æ¥å¼¥è¡¥å·®é¢ã€‚<br>å¦‚æœä¸€ä¸ªå®ä½“æ‹¥æœ‰å·¨é¢å‡€èµ„äº§ï¼Œå®ƒçš„æ”¯å‡ºå°†å¯ä»¥é«˜äºæ”¶å…¥ï¼Œç›´åˆ°èµ„é‡‘è€—å°½ï¼Œè¿™æ—¶å®ƒå¿…é¡»å‰Šå‡å¼€æ”¯ã€‚å¦‚æœä¸å‰Šå‡å¼€æ”¯ï¼Œå®ƒå°†ä¼šæœ‰å¤§é‡è´Ÿå€º/å€ºåŠ¡ï¼Œå¦‚æœå®ƒæ²¡æœ‰è¶³å¤Ÿçš„æ”¶å…¥æ¥å¿è¿˜ï¼Œå®ƒå°±ä¼šè¿çº¦ã€‚<br><strong>ç”±äºä¸€ä¸ªäººçš„å€ºåŠ¡æ˜¯å¦ä¸€ä¸ªäººçš„èµ„äº§ï¼Œå€ºåŠ¡è¿çº¦ä¼šå‡å°‘å…¶ä»–å®ä½“çš„èµ„äº§ï¼Œè¿›è€Œè¦æ±‚å®ƒä»¬å‰Šå‡å¼€æ”¯ï¼Œä»è€Œå¯¼è‡´å€ºåŠ¡ä¸‹é™å’Œç»æµæ”¶ç¼©ã€‚</strong></p><p>è¿™ç§è´§å¸å’Œä¿¡ç”¨ä½“ç³»é€‚ç”¨äºæ‰€æœ‰äººã€å…¬å¸ã€éè¥åˆ©ç»„ç»‡å’Œæ”¿åºœï¼Œä½†æœ‰ä¸€ä¸ªé‡è¦çš„ä¾‹å¤–ã€‚æ‰€æœ‰å›½å®¶éƒ½å¯ä»¥å°é’ç»™äººä»¬æ¶ˆè´¹æˆ–æ”¾è´·ã€‚ç„¶è€Œï¼Œ<strong>å¹¶ä¸æ˜¯æ‰€æœ‰æ”¿åºœå‘è¡Œçš„è´§å¸éƒ½å…·æœ‰ç›¸åŒçš„ä»·å€¼</strong>ã€‚</p><p>åœ¨ä¸–ç•ŒèŒƒå›´å†…è¢«å¹¿æ³›æ¥å—çš„è¢«ç§°ä¸ºå‚¨å¤‡è´§å¸ã€‚è€Œåœ¨å½“ä»Šä¸–ç•Œä¸Šï¼Œå ä¸»å¯¼åœ°ä½çš„å‚¨å¤‡è´§å¸æ˜¯ç¾å…ƒï¼Œç”±ç¾è”å‚¨å‘è¡Œï¼Œå æ‰€æœ‰å›½é™…äº¤æ˜“çš„55%ã€‚å¦ä¸€ç§åˆ™æ˜¯æ¬§å…ƒï¼Œç”±æ¬§æ´²å¤®è¡Œå‘è¡Œï¼Œå æ‰€æœ‰å›½é™…äº¤æ˜“çš„25%ã€‚ç›®å‰ï¼Œæ—¥å…ƒã€äººæ°‘å¸å’Œè‹±é•‘éƒ½æ˜¯ç›¸å¯¹è¾ƒå°çš„å‚¨å¤‡è´§å¸ï¼Œå°½ç®¡äººæ°‘å¸çš„é‡è¦æ€§æ­£è¿…é€Ÿä¸Šå‡ã€‚</p><p>æ‹¥æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶æ›´å®¹æ˜“é€šè¿‡å¤§é‡å€Ÿè´·æ‘†è„±å›°å¢ƒã€‚åŸå› åœ¨äºï¼Œä¸–ç•Œä¸Šå…¶ä»–å›½å®¶å€¾å‘äºæŒæœ‰è¿™äº›å€ºåŠ¡å’Œè´§å¸ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥ç”¨æ¥åœ¨ä¸–ç•Œå„åœ°æ¶ˆè´¹ã€‚å› æ­¤ï¼Œæ‹¥æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶å¯ä»¥å‘è¡Œå¤§é‡ä»¥å‚¨å¤‡è´§å¸è®¡ä»·çš„ä¿¡è´·/å€ºåŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨ç›®å‰è¿™ç§å‚¨å¤‡è´§å¸çŸ­ç¼ºçš„æƒ…å†µä¸‹ã€‚</p><p>è€Œç›¸æ¯”ä¹‹ä¸‹ï¼Œæ²¡æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶åˆ™æ²¡æœ‰è¿™ç§é€‰æ‹©ã€‚å®ƒä»¬åœ¨ä»¥ä¸‹æƒ…å†µä¸­ï¼Œç‰¹åˆ«éœ€è¦è¿™äº›å‚¨å¤‡è´§å¸ï¼ˆå¦‚ç¾å…ƒï¼‰ï¼šï¼ˆ1ï¼‰ä»–ä»¬æœ‰å¾ˆå¤šä»¥ä»–ä»¬ä¸èƒ½å°åˆ·çš„å‚¨å¤‡è´§å¸è®¡ä»·çš„å€ºåŠ¡ï¼ˆå¦‚ç¾å…ƒï¼‰ï¼›ï¼ˆ2ï¼‰ä»–ä»¬åœ¨è¿™äº›å‚¨å¤‡è´§å¸ä¸Šæ²¡æœ‰å¤šå°‘å‚¨è“„ï¼›ï¼ˆ3ï¼‰ä»–ä»¬è·å¾—æ‰€éœ€è´§å¸çš„èƒ½åŠ›ä¸‹é™ã€‚å½“æ²¡æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶æ€¥éœ€å‚¨å¤‡è´§å¸æ¥å¿è¿˜ä»–ä»¬çš„å€ºåŠ¡ï¼Œä»¥å‚¨å¤‡è´§å¸è®¡ä»·å’Œäº¤æ˜“çš„å–å®¶å¸Œæœ›å®ƒä»¬ç”¨å‚¨å¤‡è´§å¸æ¥æ”¯ä»˜æ—¶ï¼Œå®ƒä»¬å°±åªèƒ½ç ´äº§ã€‚è¿™å°±æ˜¯ç°åœ¨è®¸å¤šå›½å®¶çš„æƒ…å†µã€‚</p><p>è¿™ä¹Ÿæ˜¯è®¸å¤šå·ã€åœ°æ–¹æ”¿åºœã€å…¬å¸ã€éè¥åˆ©ç»„ç»‡å’Œä¸ªäººä¼šé¢ä¸´çš„æƒ…å†µã€‚å½“å®ƒä»¬é­å—äº†æ”¶å…¥æŸå¤±ï¼Œæœ‰æ²¡æœ‰å¤šå°‘å­˜æ¬¾æ¥å¼¥è¡¥æŸå¤±æ—¶ï¼Œå®ƒä»¬å°†ä¸å¾—ä¸å‰Šå‡å¼€æ”¯æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å¾—èµ„é‡‘å’Œä¿¡è´·ã€‚</p><p>è¿™å°±æ˜¯ç°åœ¨çš„ä¸–ç•Œä¸Šæ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼š<strong><em>é£é™©å‚¨è“„å³å°†è€—å°½ï¼Œä»¥åŠå€ºåŠ¡è¿çº¦çš„é£é™©ã€‚æœ‰èƒ½åŠ›è¿™æ ·åšçš„æ”¿åºœæ­£åœ¨å°é’ï¼Œä»¥å¸®åŠ©å‡è½»å€ºåŠ¡è´Ÿæ‹…ï¼Œå¹¶å¸®åŠ©ä¸ºä»¥æœ¬å›½è´§å¸è®¡ä»·çš„å¼€æ”¯æä¾›èµ„é‡‘ã€‚ä½†è¿™å°†å‰Šå¼±æœ¬å›½è´§å¸ï¼Œæé«˜æœ¬å¸çš„é€šèƒ€æ°´å¹³ï¼Œä»¥æŠµæ¶ˆéœ€æ±‚å‡å°‘å’Œè¢«è¿«å‡ºå”®èµ„äº§æ‰€é€ æˆçš„é€šè´§ç´§ç¼©ï¼Œè€Œé‚£äº›èµ„é‡‘ç´§å¼ çš„å›½å®¶å°±ä¸å¾—ä¸ç­¹é›†ç°é‡‘</em></strong>ã€‚</p><ul><li>Essense<ul><li>ä¸€ä¸ªäººçš„å€ºåŠ¡æ˜¯å¦å¤–ä¸€ä¸ªäººçš„èµ„äº§ï¼Œå€ºåŠ¡è¿çº¦ä¼šå‡å°‘å…¶ä»–å®ä½“çš„èµ„äº§ï¼Œè¿›è€Œè¦æ±‚å…¶æ¶ˆå‡å¼€æ”¯ï¼Œä»è€Œå¯¼è‡´å€ºåŠ¡ä¸‹é™å’Œç»æµæ”¶ç¼©çš„è‡ªæˆ‘å¼ºåŒ–ã€‚ </li><li>ç¾å›½æœ€è¿‘çš„å¤§æ’’é’±è®¡åˆ’ï¼Œè‡´ä½¿ç¾å…ƒæŒ‡æ•°å¼ºåŠ¿å¢é•¿ï¼Œè¿™æ˜¯å¸‚åœºçš„é¿é™©æƒ…ç»ªçš„ä½“ç°ã€‚ç¾å…ƒæ˜¯å…¨å…‘æ¢ï¼Œå…¨æµé€šçš„ã€‚å¸‚åœºçš„æ‹…å¿§ï¼Œé™æ¯ï¼Œä½¿å¾—ç›´æ¥æŒæœ‰ç¾å…ƒçš„æˆæœ¬é™ä½äº†ã€‚æœºæ„ä¼ä¸šé‡‡å–å¢åŠ ç°é‡‘æµçš„æ–¹å¼æ¥é˜²æ­¢å‡ºç°æµåŠ¨æ€§å±æœº</li><li>ç¾å›½æ”¿åºœé€šè¿‡å°é’æ¥å‡è½»å€ºåŠ¡è´Ÿæ‹…ï¼Œæä¾›å•†ä¸šè¿ä½œæ‰€éœ€çš„èµ„é‡‘ã€‚</li></ul></li></ul><h1 id="2-ä»€ä¹ˆæ˜¯è´§å¸"><a href="#2-ä»€ä¹ˆæ˜¯è´§å¸" class="headerlink" title="2. ä»€ä¹ˆæ˜¯è´§å¸"></a>2. ä»€ä¹ˆæ˜¯è´§å¸</h1><p>è´§å¸æœ¬è´¨ä¸Šæ˜¯ä¸€ç§äº¤æ¢åª’ä»‹ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å‚¨å­˜è´¢å¯Œã€‚</p><p>ä¸è¨€è€Œå–»ï¼Œâ€œäº¤æ¢åª’ä»‹â€æŒ‡çš„æ˜¯å¯ä»¥ç”¨æ¥ä¹°ä¸œè¥¿çš„å·¥å…·ã€‚è€Œæ‰€è°“è´¢å¯Œå‚¨å¤‡ï¼ŒæŒ‡çš„æ˜¯åœ¨è·å–å’Œæ¶ˆè´¹ä¹‹é—´å‚¨å­˜è´­ä¹°åŠ›çš„å·¥å…·ã€‚æœ€åˆç†çš„æ–¹å¼æ˜¾ç„¶å°±æ˜¯æŠŠé’±å­˜èµ·æ¥ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ï¼Œä½†äººä»¬å¾€å¾€ä¸æ„¿æ„æŒæœ‰è´§å¸ï¼Œè€Œæ€»æƒ³æŠŠè´§å¸å…‘æ¢æˆä»–ä»¬æƒ³ä¹°çš„ä¸œè¥¿ã€‚è¿™å°±æ˜¯ä¿¡è´·å’Œå€ºåŠ¡å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p><p>å½“å‡ºå€Ÿäººæ”¾è´·æ—¶ï¼Œä»–ä»¬è®¤ä¸ºæ”¶å›çš„é’±ä¼šæ¯”æœ¬èº«æŒæœ‰çš„é’±è´­ä¹°æ›´å¤šçš„å•†å“å’ŒæœåŠ¡ã€‚å¦‚æœåšå¾—å¥½ï¼Œå€Ÿè´·è€…å°±èƒ½æœ‰æ•ˆåœ°ä½¿ç”¨è¿™äº›é’±å¹¶è·å¾—åˆ©æ¶¦ï¼Œè¿›è€Œå¿è¿˜è´·æ¬¾å¹¶ä¿ç•™ä¸€äº›é¢å¤–çš„é’±ã€‚å½“è´·æ¬¾å°šæœªå¿è¿˜æ—¶ï¼Œå®ƒæ˜¯è´·æ¬¾äººçš„èµ„äº§ï¼Œä¹Ÿæ˜¯å€Ÿæ¬¾äººçš„è´Ÿå€ºã€‚å½“é’±è¢«å¿è¿˜æ—¶ï¼Œèµ„äº§å’Œè´Ÿå€ºå°±æ¶ˆå¤±äº†ï¼Œè¿™ç§äº¤æ¢å¯¹å€Ÿæ–¹å’Œè´·æ–¹éƒ½æœ‰å¥½å¤„ã€‚ä»–ä»¬ä»æœ¬è´¨ä¸Šåˆ†äº«äº†è¿™ç§ç”Ÿäº§æ€§è´·æ¬¾çš„åˆ©æ¶¦ã€‚æ•´ä¸ªç¤¾ä¼šä¹Ÿå¾—ç›Šäºè¿™ç§æœºåˆ¶æ‰€å¸¦æ¥çš„çš„ç”Ÿäº§åŠ›æé«˜ã€‚</p><p>å› æ­¤ï¼Œé‡è¦çš„æ˜¯è¦æ„è¯†åˆ°ï¼š<br>1.å¤§å¤šæ•°è´§å¸å’Œä¿¡è´·ï¼ˆå°¤å…¶æ˜¯ç°å­˜çš„æ³•å®šè´§å¸ï¼‰<strong>æ²¡æœ‰å†…åœ¨ä»·å€¼</strong>ï¼›<br>2.å®ƒä»¬åªæ˜¯ä¼šè®¡ç³»ç»Ÿä¸­çš„è´¦ç›®ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¹å˜ï¼›<br>3.ç³»ç»Ÿçš„ç›®çš„æ˜¯<strong>å¸®åŠ©æœ‰æ•ˆåœ°åˆ†é…èµ„æºä»¥ä¾¿ç”Ÿäº§åŠ›å¢é•¿</strong>ï¼›<br>4.è¯¥ç³»ç»Ÿä¼šå‘¨æœŸæ€§å´©æºƒã€‚æ‰€æœ‰çš„è´§å¸ä¸æ˜¯è¢«æ‘§æ¯å°±æ˜¯è´¬å€¼ï¼Œè´¢å¯Œéšä¹‹å‘ç”Ÿå¤§è§„æ¨¡è½¬ç§»ï¼Œå¯¹ç»æµå’Œå¸‚åœºäº§ç”Ÿå·¨å¤§å½±å“ã€‚</p><p>æ›´å…·ä½“åœ°è¯´ï¼Œè´§å¸å’Œä¿¡è´·ç³»ç»Ÿå¹¶æ²¡æœ‰å®Œç¾åœ°è¿è½¬ï¼Œè€Œæ˜¯<strong>åœ¨å¾ªç¯ä¸­æ”¹å˜è´§å¸çš„ä¾›åº”ã€éœ€æ±‚å’Œä»·å€¼ï¼Œåœ¨ä¸Šå‡æ—¶äº§ç”Ÿå¯Œè£•ï¼Œåœ¨ä¸‹é™æ—¶äº§ç”Ÿé‡ç»„</strong>ã€‚</p><h2 id="2-1-ä»åŸºæœ¬é¢å‡ºå‘ç ”ç©¶è´§å¸å’Œä¿¡è´·ç³»ç»Ÿçš„å‘¨æœŸ"><a href="#2-1-ä»åŸºæœ¬é¢å‡ºå‘ç ”ç©¶è´§å¸å’Œä¿¡è´·ç³»ç»Ÿçš„å‘¨æœŸ" class="headerlink" title="2.1 ä»åŸºæœ¬é¢å‡ºå‘ç ”ç©¶è´§å¸å’Œä¿¡è´·ç³»ç»Ÿçš„å‘¨æœŸ"></a>2.1 ä»åŸºæœ¬é¢å‡ºå‘ç ”ç©¶è´§å¸å’Œä¿¡è´·ç³»ç»Ÿçš„å‘¨æœŸ</h2><p><strong>è™½ç„¶é‡‘é’±å’Œä¿¡è´·ä¸è´¢å¯Œæœ‰å…³ï¼Œä½†å®ƒä»¬ä¸æ˜¯è´¢å¯Œ</strong>ã€‚å› ä¸ºé’±å’Œä¿¡è´·å¯ä»¥ä¹°åˆ°è´¢å¯Œï¼ˆå³å•†å“å’ŒæœåŠ¡ï¼‰ï¼Œæ‰€ä»¥ä¸€ä¸ªäººæ‹¥æœ‰çš„é‡‘é’±å’Œä¿¡è´·çš„æ•°é‡å’Œè´¢å¯Œçš„æ•°é‡çœ‹èµ·æ¥å·®ä¸å¤šã€‚</p><p>ä½†æ˜¯ï¼Œä¸€ä¸ªäººä¸èƒ½ä»…ä»…é€šè¿‡åˆ›é€ æ›´å¤šçš„é‡‘é’±å’Œä¿¡è´·æ¥åˆ›é€ æ›´å¤šçš„è´¢å¯Œã€‚è¦åˆ›é€ æ›´å¤šçš„è´¢å¯Œï¼Œå°±å¿…é¡»è¦æœ‰æ›´é«˜çš„ç”Ÿäº§åŠ›ã€‚é‡‘é’±å’Œä¿¡è´·çš„åˆ›é€ ä¸è´¢å¯Œï¼ˆå®é™…å•†å“å’ŒæœåŠ¡ï¼‰çš„åˆ›é€ ä¹‹é—´çš„å…³ç³»ç»å¸¸è¢«æ··æ·†ï¼Œä½†å®ƒæ˜¯ç»æµå‘¨æœŸçš„æœ€å¤§é©±åŠ¨åŠ›ï¼Œå› æ­¤ï¼Œè®©æˆ‘ä»¬æ›´ä»”ç»†åœ°ç ”ç©¶ä¸€ä¸‹è¿™ç§å…³ç³»ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè´§å¸å’Œä¿¡è´·çš„åˆ›é€ ä¸å•†å“ã€æœåŠ¡å’ŒæŠ•èµ„èµ„äº§çš„æ•°é‡ä¹‹é—´å­˜åœ¨æ­£ç›¸å…³å…³ç³»ï¼Œå› æ­¤å¾ˆå®¹æ˜“æ··æ·†ã€‚å½“äººä»¬æœ‰æ›´å¤šçš„é’±å’Œä¿¡è´·æ—¶ï¼Œä»–ä»¬å°±ä¼šæƒ³æ¶ˆè´¹æ›´å¤šã€‚ä»æŸç§ç¨‹åº¦ä¸Šè¯´ï¼Œæ¶ˆè´¹å¢åŠ äº†ç»æµç”Ÿäº§ï¼Œæé«˜äº†å•†å“ã€æœåŠ¡å’Œé‡‘èèµ„äº§çš„ä»·æ ¼ï¼Œè¿™å¯ä»¥è¯´æ˜¯å¢åŠ äº†è´¢å¯Œï¼Œå› ä¸ºæ‹¥æœ‰è¿™äº›èµ„äº§çš„äººåœ¨æˆ‘ä»¬è¡¡é‡è´¢å¯Œçš„æ–¹å¼ä¸‹å˜å¾—â€œæ›´å¯Œæœ‰â€ã€‚</p><p>ç„¶è€Œï¼Œè¿™ç§å½¢å¼çš„è´¢å¯Œå¢åŠ æ›´åƒæ˜¯ä¸€ç§å¹»è§‰ã€‚åŸå› æœ‰äºŒï¼š<strong>æ¨åŠ¨ä»·æ ¼å’Œç”Ÿäº§ä¸Šå‡çš„ä¿¡è´·å¿…é¡»å¿è¿˜ï¼›äº‹ç‰©çš„å†…åœ¨ä»·å€¼å¹¶ä¸ä¼šå¢åŠ </strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æœ‰ä¸€å¥—æˆ¿å­ï¼Œæ”¿åºœåˆ›é€ äº†å¤§é‡çš„è´§å¸å’Œä¿¡è´·ï¼Œä½ çš„æˆ¿å­çš„ä»·æ ¼ä¼šä¸Šå‡ï¼Œä½†å®ƒä»ç„¶æ˜¯åŸæ¥çš„æ ·å­ã€‚ä½ çš„å®é™…è´¢å¯Œæ²¡æœ‰å¢åŠ ï¼Œåªæ˜¯ä½ è®¡ç®—å‡ºæ¥çš„è´¢å¯Œå¢åŠ äº†ã€‚åŒæ ·åœ°ï¼Œå¦‚æœæ”¿åºœåˆ›é€ äº†å¤§é‡çš„è´§å¸å’Œä¿¡è´·ï¼Œç”¨äºè´­ä¹°å•†å“ã€æœåŠ¡å’Œé‡‘èèµ„äº§ï¼ˆå¦‚è‚¡ç¥¨ã€å€ºåˆ¸å’Œæˆ¿åœ°äº§ï¼‰ï¼Œé‚£ä¹ˆä½ è®¡ç®—æ‰€å¾—çš„è´¢å¯Œæ•°é‡å°±ä¼šå¢åŠ ï¼Œä½†å®é™…è´¢å¯Œä»å°†ä¿æŒä¸å˜ã€‚æ¢å¥è¯è¯´ï¼Œç”¨ä¸€ä¸ªäººæ‰€æ‹¥æœ‰çš„å¸‚åœºä»·å€¼æ¥è¡¡é‡ä»–çš„è´¢å¯Œï¼Œä¼šç»™äººä¸€ç§è´¢å¯Œå˜åŒ–çš„é”™è§‰ï¼Œè€Œè¿™ç§å˜åŒ–å®é™…ä¸Šå¹¶ä¸å­˜åœ¨ã€‚</p><p>é‡è¦çš„æ˜¯ï¼Œ<strong>è´§å¸å’Œä¿¡è´·åœ¨å‘æ”¾æ—¶å…·æœ‰åˆºæ¿€ä½œç”¨ï¼Œè€Œåœ¨å¿…é¡»å¿è¿˜æ—¶å´æœ‰æŠ‘åˆ¶ä½œç”¨ã€‚</strong>è¿™å°±æ˜¯è´§å¸ã€ä¿¡è´·å’Œç»æµå¢é•¿å¦‚æ­¤å…·æœ‰å‘¨æœŸæ€§çš„åŸå› ã€‚</p><p>ä¸ºäº†æ§åˆ¶å¸‚åœºå’Œæ•´ä½“ç»æµï¼Œè´§å¸å’Œä¿¡è´·çš„æˆæœ¬å’Œå¯è·å¾—æ€§å„ä¸ç›¸åŒã€‚å½“ç»æµå¢é•¿è¿‡å¿«ï¼Œä»–ä»¬æƒ³è¦æ”¾ç¼“å¢é•¿é€Ÿåº¦æ—¶ï¼Œå°±ä¼šå‡å°‘è´§å¸å’Œä¿¡è´·æŠ•æ”¾ï¼Œå¯¼è‡´ä¸¤è€…éƒ½å˜å¾—æ›´åŠ æ˜‚è´µã€‚è¿™é¼“åŠ±äº†äººä»¬å……å½“è´·æ–¹è€Œä¸æ˜¯å€Ÿé’±å’Œæ¶ˆè´¹ã€‚å½“ç»æµå¢é•¿å¤ªæ…¢ï¼Œå¤®è¡Œæƒ³è¦åˆºæ¿€ç»æµæ—¶ï¼Œä»–ä»¬å°±ä¼šè®©è´§å¸å’Œä¿¡è´·å»‰ä»·è€Œå……è¶³ï¼Œä»è€Œé¼“åŠ±äººä»¬å€Ÿè´·ã€æŠ•èµ„å’Œ/æˆ–æ¶ˆè´¹ã€‚è´§å¸å’Œä¿¡è´·çš„æˆæœ¬å’Œå¯ç”¨æ€§çš„è¿™äº›å˜åŒ–ä¹Ÿä¼šå¯¼è‡´å•†å“ã€æœåŠ¡å’Œé‡‘èèµ„äº§çš„ä»·æ ¼å’Œæ•°é‡çš„æ¶¨è·Œã€‚ä½†æ˜¯ï¼Œé“¶è¡Œåªèƒ½åœ¨å…¶äº§ç”Ÿè´§å¸å’Œä¿¡è´·å¢é•¿çš„èƒ½åŠ›èŒƒå›´å†…æ§åˆ¶ç»æµï¼Œè€Œå®ƒä»¬è¿™æ ·åšçš„èƒ½åŠ›æ˜¯æœ‰é™çš„ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä¸­å¤®é“¶è¡Œæœ‰ä¸€ç“¶å…´å¥‹å‰‚ï¼Œä»–ä»¬å¯ä»¥æ ¹æ®éœ€è¦æ³¨å…¥ç»æµï¼Œè€Œç“¶ä¸­çš„å…´å¥‹å‰‚æ•°é‡æ˜¯æœ‰é™çš„ã€‚å½“å¸‚åœºå’Œç»æµè¡°é€€æ—¶ï¼Œä»–ä»¬ä¼šæä¾›è´§å¸å’Œä¿¡è´·åˆºæ¿€æ¥ææŒ¯ç»æµï¼Œå½“å¸‚åœºè¿‡çƒ­æ—¶ï¼Œä»–ä»¬ä¼šå‡å°‘åˆºæ¿€ã€‚è¿™äº›å˜åŠ¨å¯¼è‡´è´§å¸ã€ä¿¡è´·ã€å•†å“ã€æœåŠ¡å’Œé‡‘èèµ„äº§çš„æ•°é‡å’Œä»·æ ¼çš„å‘¨æœŸæ€§æ¶¨è·Œã€‚è€Œè¿™äº›ä¸¾æªé€šå¸¸ä»¥çŸ­æœŸå€ºåŠ¡å‘¨æœŸå’Œé•¿æœŸå€ºåŠ¡å‘¨æœŸçš„å½¢å¼å‡ºç°ã€‚</p><p>çŸ­æœŸå€ºåŠ¡å‘¨æœŸï¼ˆå³é€šå¸¸æ‰€è¯´çš„â€œå•†ä¸šå‘¨æœŸâ€ï¼‰é€šå¸¸æŒç»­8å¹´å·¦å³ã€‚æ—¶æœºå–å†³äºåˆºæ¿€æªæ–½å°†éœ€æ±‚æå‡è‡³å®ä½“ç»æµç”Ÿäº§èƒ½åŠ›æé™æ‰€éœ€çš„æ—¶é—´ã€‚è€Œé•¿æœŸå€ºåŠ¡å‘¨æœŸå°±æ˜¯å°†è¿™äº›çŸ­æœŸå€ºåŠ¡å‘¨æœŸåŠ èµ·æ¥ï¼Œé€šå¸¸æŒç»­50-75å¹´ã€‚å› ä¸ºå¯èƒ½å¾ˆå¤šäººçš„ä¸€ç”Ÿåªä¼šå‡ºç°ä¸€æ¬¡é•¿æœŸå€ºåŠ¡å‘¨æœŸï¼Œæ‰€ä»¥å¤§å¤šæ•°äººéƒ½æ²¡æœ‰æ„è¯†åˆ°ã€‚</p><p>é•¿æœŸå€ºåŠ¡å‘¨æœŸé€šå¸¸å¼€å§‹äºé‡ç»„åçš„ä½æ°´å¹³å€ºåŠ¡æ—¶æœŸï¼Œå¤®è¡Œçš„ç“¶å­é‡Œæœ‰å¾ˆå¤šåˆºæ¿€ï¼Œè€Œç»“æŸäºé«˜æ°´å¹³å€ºåŠ¡æ—¶æœŸï¼Œå¤®è¡Œçš„ç“¶å­é‡Œå°±æ²¡æœ‰å¤šå°‘åˆºæ¿€äº†ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå½“å¤®è¡Œå¤±å»é€šè¿‡ç»æµä½“ç³»äº§ç”Ÿè´§å¸å’Œä¿¡è´·å¢é•¿ã€è¿›è€Œæ¨åŠ¨å®ä½“ç»æµå¢é•¿çš„èƒ½åŠ›æ—¶ï¼Œå¤®è¡Œçš„åˆºæ¿€èƒ½åŠ›å°±ä¼šç»ˆæ­¢ã€‚å½“å€ºåŠ¡æ°´å¹³é«˜ä¼ã€åˆ©ç‡æ— æ³•å……åˆ†é™ä½ã€è´§å¸å’Œä¿¡è´·çš„åˆ›é€ å¯¹é‡‘èèµ„äº§ä»·æ ¼çš„å½±å“å¤§äºå¯¹å®é™…ç»æµæ´»åŠ¨çš„å½±å“æ—¶ï¼Œå¤®è¡Œå°±ä¼šä¸§å¤±è¿™ç§èƒ½åŠ›ã€‚åœ¨è¿™ç§æ—¶å€™ï¼Œé‚£äº›æŒæœ‰å€ºåŠ¡çš„äººé€šå¸¸æƒ³è¦æŠŠä»–ä»¬æŒæœ‰çš„è´§å¸å€ºåŠ¡æ¢æˆå…¶ä»–çš„è´¢å¯Œã€‚å½“äººä»¬æ™®éè®¤ä¸ºï¼Œå°†è·å¾—èµ„é‡‘çš„è´§å¸å’Œå€ºåŠ¡èµ„äº§å¹¶ä¸æ˜¯è‰¯å¥½çš„è´¢å¯Œå‚¨å¤‡æ—¶ï¼Œé•¿æœŸå€ºåŠ¡å‘¨æœŸå°±ç»“æŸäº†ï¼Œå¿…é¡»å¯¹è´§å¸ä½“ç³»è¿›è¡Œé‡ç»„ã€‚</p><ul><li>Essense <ul><li>è´§å¸å’Œä¿¡è´·ç³»ç»Ÿåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸‹é™å‘¨æœŸé‡Œä¼šå¸¦æ¥é‡ç»„ï¼Œä¼šé€ æˆè´¢å¯Œçš„å·¨å¤§è½¬ç§»ã€‚</li><li>é‡‘é’±å’Œä¿¡è´·ä¸æ˜¯è´¢å¯Œï¼Œä½†å¯ä»¥ä¹°åˆ°è´¢å¯Œã€‚åˆ›é€ æ›´å¤šçš„é‡‘é’±å’Œä¿¡è´·ä¸æ„å‘³ç€æ›´å¤šçš„è´¢å¯Œï¼Œæ›´å¤šçš„ç”Ÿäº§åŠ›æ‰æ˜¯ã€‚</li></ul></li></ul><h1 id="3-é•¿æœŸå€ºåŠ¡å‘¨æœŸ"><a href="#3-é•¿æœŸå€ºåŠ¡å‘¨æœŸ" class="headerlink" title="3. é•¿æœŸå€ºåŠ¡å‘¨æœŸ"></a>3. é•¿æœŸå€ºåŠ¡å‘¨æœŸ</h1><ol><li>å§‹äºæ— æˆ–ä½å€ºåŠ¡å’Œâ€œç¡¬é€šè´§â€</li></ol><p>é‡‘é“¶ï¼ˆæœ‰æ—¶è¿˜æœ‰é“œå’Œé•ç­‰å…¶ä»–é‡‘å±ï¼‰æ˜¯é¦–é€‰çš„è´§å¸å½¢å¼ï¼Œå› ä¸ºå®ƒä»¬å…·æœ‰å†…åœ¨ä»·å€¼ï¼Œè€Œä¸”å¯ä»¥å¾ˆå®¹æ˜“åœ°å¡‘å½¢ï¼Œä¾¿äºæºå¸¦å’Œå…‘æ¢ã€‚å…·æœ‰å†…åœ¨ä»·å€¼å¾ˆé‡è¦ï¼Œå› ä¸ºä¸ä»–ä»¬è¿›è¡Œäº¤æ˜“ä¸éœ€è¦ä»»ä½•çš„ä¿¡ä»»æˆ–ä¿¡ç”¨ã€‚ä»»ä½•äº¤æ˜“éƒ½å¯ä»¥å½“åœºæˆäº¤ï¼Œå³ä½¿ä¹°å–åŒæ–¹æ˜¯é™Œç”Ÿäººæˆ–æ•Œäººã€‚</p><ol start="2"><li>â€œçº¸å¸â€çš„è¯ç”Ÿ</li></ol><p>å› ä¸ºé‡‘å±è´§å¸æºå¸¦ä¸ä¾¿çš„åŸå› ï¼Œäººä»¬å¾ˆå¿«å°±æŠŠçº¸ä¸Šçš„â€œè´§å¸å€ºæƒâ€å½“æˆäº†è´§å¸æœ¬èº«ã€‚è¿™ç§ç±»å‹çš„è´§å¸ç³»ç»Ÿè¢«ç§°ä¸ºæŒ‚é’©è´§å¸ç³»ç»Ÿï¼Œå› ä¸ºè´§å¸çš„ä»·å€¼ä¸æŸç§ä¸œè¥¿çš„ä»·å€¼æŒ‚é’©ï¼Œé€šå¸¸æ˜¯â€œç¡¬é€šè´§â€ï¼Œå¦‚é»„é‡‘ã€‚</p><p>3.å€ºåŠ¡å¢åŠ </p><p>èµ·åˆï¼Œâ€œç¡¬é€šè´§â€çš„å€ºæƒæ•°é‡ä¸é“¶è¡Œé‡Œçš„ç¡¬é€šè´§æ•°é‡ç›¸åŒã€‚ç„¶è€Œï¼ŒæŒæœ‰äººå’Œé“¶è¡Œå‘ç°äº†ä¿¡è´·å’Œå€ºåŠ¡çš„å¥¥å¦™ä¹‹å¤„ï¼šäººä»¬å¯ä»¥æŠŠâ€œçº¸å¸â€å€Ÿç»™é“¶è¡Œï¼Œä»¥æ¢å–åˆ©æ¯ï¼›è€Œå‘ä»–ä»¬å€Ÿé’±çš„é“¶è¡Œåˆå¯ä»¥æŠŠé’±å€Ÿç»™å…¶ä»–äººï¼Œæ¢å–æ›´é«˜çš„åˆ©æ¯ï¼›è€Œé‚£äº›ä»é“¶è¡Œå€Ÿé’±çš„äººè·å¾—äº†å‰æ‰€æœªæœ‰çš„è´­ä¹°åŠ›ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¼è‡´äº†<strong>èµ„äº§ä»·æ ¼å’Œç”Ÿäº§çš„ä¸Šå‡</strong>ã€‚</p><p>ç„¶è€Œï¼Œå½“ä¸€ä¸ªäººæ²¡æœ‰è¶³å¤Ÿçš„æ”¶å…¥/é’±æ¥å¿è¿˜å€ºåŠ¡æ—¶ï¼Œéº»çƒ¦å°±æ¥äº†ã€‚äººä»¬æœŸæœ›é€šè¿‡å‡ºå”®è¿™äº›å€ºæƒæ¥è·å¾—è´­ä¹°å•†å“å’ŒæœåŠ¡çš„èµ„é‡‘ï¼Œå…¶å¢é•¿é€Ÿåº¦è¶…è¿‡äº†å•†å“å’ŒæœåŠ¡çš„æ•°é‡ï¼Œè¿™ä½¿å¾—ä»è¿™äº›å€ºåŠ¡èµ„äº§ï¼ˆä¾‹å¦‚å€ºåˆ¸ï¼‰çš„è½¬æ¢å˜å¾—ä¸å¯èƒ½ã€‚è¿™ä¸¤ä¸ªé—®é¢˜å¾€å¾€åŒæ—¶å‡ºç°ã€‚<br>å…³äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥æŠŠå€ºåŠ¡çœ‹ä½œæ˜¯è´Ÿæ”¶ç›Šå’Œè´Ÿèµ„äº§ï¼Œè´Ÿèµ„äº§åå™¬æ”¶ç›Šï¼ˆå› ä¸ºæ”¶ç›Šå¿…é¡»ç”¨æ¥å¿è¿˜å€ºåŠ¡ï¼‰ï¼Œåå™¬å…¶ä»–èµ„äº§ï¼ˆå› ä¸ºå¿…é¡»å‡ºå”®å…¶ä»–èµ„äº§æ¥è·å¾—å¿è¿˜å€ºåŠ¡çš„èµ„é‡‘ï¼‰ã€‚å®ƒå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œæ„æ€æ˜¯å®ƒå¿…é¡»åœ¨ä»»ä½•å…¶ä»–ç±»å‹çš„èµ„äº§ä¹‹å‰å¾—åˆ°æ”¯ä»˜ï¼Œæ‰€ä»¥å½“æ”¶å…¥å’Œä¸€ä¸ªäººçš„èµ„äº§ä»·å€¼ä¸‹é™æ—¶ï¼Œæœ‰å¿…è¦å‰Šå‡å¼€æ”¯å’Œå‡ºå”®èµ„äº§æ¥ç­¹é›†æ‰€éœ€çš„ç°é‡‘ã€‚å½“è¿™è¿˜ä¸å¤Ÿæ—¶ï¼Œå°±éœ€è¦ï¼š</p><p>ï¼ˆ1ï¼‰å€ºåŠ¡é‡ç»„ï¼Œå‡å°‘å€ºåŠ¡å’Œå€ºåŠ¡è´Ÿæ‹…ã€‚è¿™å¯¹å€ºåŠ¡äººå’Œå€ºæƒäººéƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºä¸€ä¸ªäººçš„å€ºåŠ¡å°±æ˜¯å¦ä¸€ä¸ªäººçš„èµ„äº§ã€‚</p><p>ï¼ˆ2ï¼‰å¤®è¡Œå°é’±ã€ä¸­å¤®æ”¿åºœ<strong>å‘æ”¾è´§å¸å’Œä¿¡è´·ï¼Œä»¥å¡«è¡¥æ”¶å…¥å’Œèµ„äº§è´Ÿå€ºè¡¨çš„æ¼æ´</strong>ï¼ˆè¿™ä¹Ÿæ˜¯ç°åœ¨æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼‰ã€‚</p><p>å½“å€ºåŠ¡æŒæœ‰è€…ä¸ç›¸ä¿¡ä»–ä»¬å°†ä»å€ºåŠ¡ä¸­è·å¾—è¶³å¤Ÿçš„å›æŠ¥æ—¶ï¼Œå°±ä¼šå‡ºç°ç¬¬äºŒä¸ªé—®é¢˜ã€‚å€ºåŠ¡èµ„äº§ï¼ˆå¦‚å€ºåˆ¸ï¼‰æ˜¯ç”±æŠ•èµ„è€…æŒæœ‰çš„ï¼Œä»–ä»¬è®¤ä¸ºè¿™äº›èµ„äº§æ˜¯å¯ä»¥å‡ºå”®æ¥è·å¾—è´¢å¯Œï¼ˆé’±ï¼‰çš„ï¼Œè€Œè¿™äº›é’±å¯ä»¥ç”¨æ¥ä¹°ä¸œè¥¿ã€‚å½“å€ºåŠ¡èµ„äº§çš„æŒæœ‰è€…è¯•å›¾å°†å…¶è½¬æ¢æˆçœŸå®çš„è´§å¸ã€çœŸå®çš„å•†å“å’ŒæœåŠ¡ï¼Œå´å‘ç°ä»–ä»¬åšä¸åˆ°çš„æ—¶å€™ï¼Œè¿™ä¸ªé—®é¢˜å°±å‡ºç°äº†ã€‚ç„¶åå°±ä¼šå‘ç”Ÿæ‰€è°“çš„â€œæŒ¤å…‘â€ã€‚</p><p>æ— è®ºæ˜¯å•†ä¸šé“¶è¡Œè¿˜æ˜¯å¤®è¡Œï¼Œéƒ½ä¼šé¢ä¸´ç€è¿™æ ·çš„é€‰æ‹©ï¼šå…è®¸èµ„é‡‘ä»å€ºåŠ¡èµ„äº§ä¸­æµå‡ºï¼Œä»è€Œæé«˜åˆ©ç‡ï¼Œå¹¶å¯¼è‡´å€ºåŠ¡å’Œç»æµé—®é¢˜æ¶åŒ–ï¼›æˆ–è€…â€œå°é’â€ï¼Œè´­ä¹°è¶³å¤Ÿçš„å€ºåˆ¸ï¼Œä»¥é˜²æ­¢åˆ©ç‡ä¸Šå‡ï¼Œå¹¶é€†è½¬èµ„é‡‘è€—å°½çš„è¶‹åŠ¿ã€‚</p><p>ä½†å¦‚æœè´§å¸å€ºæƒå’Œä¸è´§å¸æ•°é‡å’Œæ‰€è¦è´­ä¹°çš„å•†å“å’ŒæœåŠ¡æ•°é‡ä¹‹æ¯”è¿‡é«˜ï¼Œé“¶è¡Œå°±ä¼šé™·å…¥æ— æ³•æ‘†è„±çš„å›°å¢ƒï¼Œå› ä¸ºå®ƒæ ¹æœ¬æ²¡æœ‰è¶³å¤Ÿçš„é’±æ¥æ»¡è¶³è¿™äº›å€ºæƒï¼Œå› æ­¤å®ƒå°†ä¸å¾—ä¸è¿çº¦ã€‚</p><p>å½“è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨å¤®è¡Œèº«ä¸Šæ—¶ï¼Œå®ƒå¯ä»¥é€‰æ‹©è¦ä¹ˆè¿çº¦ï¼Œè¦ä¹ˆå°é’å¹¶ä½¿å…¶è´¬å€¼ã€‚è´¬å€¼æ˜¯æ— æ³•é¿å…çš„ã€‚å½“è¿™äº›å€ºåŠ¡é‡ç»„å’Œè´§å¸è´¬å€¼è§„æ¨¡å¾ˆå¤§æ—¶ï¼Œå®ƒä»¬ä¼šå¯¼è‡´è´§å¸ä½“ç³»å´©æºƒã€‚æ— è®ºé“¶è¡Œæˆ–ä¸­å¤®é“¶è¡Œåšä»€ä¹ˆï¼Œå€ºåŠ¡è¶Šå¤šï¼Œè´§å¸è´¬å€¼çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚è®°ä½ï¼Œå•†å“å’ŒæœåŠ¡çš„æ•°é‡æ€»æ˜¯æœ‰é™çš„ï¼Œå› ä¸ºæ•°é‡å—åˆ°ç”Ÿäº§èƒ½åŠ›çš„é™åˆ¶ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæ˜ç™½é‡‘é’±å’Œå€ºåŠ¡çš„åŒºåˆ«æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>é‡‘é’±æ˜¯ç”¨æ¥åº”å¯¹å€ºæƒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªäººä¸ºä»–çš„è´¦å•ä»˜äº†é’±å°±å®Œäº†ã€‚å€ºåŠ¡æ˜¯æœªæ¥äº¤ä»˜é‡‘é’±çš„æ‰¿è¯ºã€‚</p><p>åœ¨è§‚å¯Ÿç»æµæœºå™¨æ˜¯å¦‚ä½•è¿ä½œçš„è¿‡ç¨‹ä¸­ï¼Œé‡è¦çš„æ˜¯è§‚å¯Ÿa)å€ºåŠ¡å’Œè´§å¸çš„æ•°é‡ç›¸å¯¹äºé“¶è¡Œä¸­çš„ç¡¬é€šè´§ï¼ˆå¦‚é»„é‡‘ï¼‰çš„æ•°é‡ï¼Œä»¥åŠb)å•†å“å’ŒæœåŠ¡çš„æ•°é‡ã€‚</p><p>è¿™ä¸¤è€…çš„æ•°é‡å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯è¦è®°ä½ï¼Œå€ºåŠ¡å‘¨æœŸä¹‹æ‰€ä»¥å‘ç”Ÿï¼Œæ˜¯å› ä¸ºç»å¤§å¤šæ•°äººå–œæ¬¢æ‰©å¤§è´­ä¹°åŠ›ï¼ˆä¸€èˆ¬æ˜¯é€šè¿‡å€ºåŠ¡ï¼‰ï¼Œè€Œä¸­å¤®é“¶è¡Œå€¾å‘äºæ‰©å¤§è´§å¸çš„æ•°é‡ï¼Œå› ä¸ºè¿™æ ·åšçš„æ—¶å€™äººä»¬ä¼šæ›´é«˜å…´ã€‚</p><p>ä½†è¿™ç§æƒ…å†µä¸å¯èƒ½ä¸€ç›´æŒç»­ä¸‹å»ã€‚é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œå½“é“¶è¡Œâ€”â€”æ— è®ºæ˜¯ç§æœ‰é“¶è¡Œè¿˜æ˜¯ä¸­å¤®é“¶è¡Œâ€”â€”åˆ›é€ äº†æ¯”é“¶è¡Œé‡Œçš„ç¡¬é€šè´§å¤šå¾—å¤šçš„å‡­è¯ï¼ˆçº¸å¸å’Œå€ºåŠ¡ï¼‰æ—¶ï¼Œç»ˆæœ‰ä¸€å¤©æ‹¿æ¥å…‘æ¢çš„çº¸è´¨å‡­è¯çš„æ•°é‡ä¼šè¶…è¿‡é“¶è¡Œçš„å¿ä»˜èƒ½åŠ›ã€‚</p><ol start="4"><li>éšä¹‹è€Œæ¥çš„æ˜¯å€ºåŠ¡å±æœºã€è¿çº¦å’Œè´§å¸è´¬å€¼</li></ol><p>å†å²è¡¨æ˜ï¼Œå½“é“¶è¡Œå¯¹è´§å¸çš„ç´¢å–æƒçš„å¢é•¿é€Ÿåº¦è¶…è¿‡é“¶è¡Œçš„è´§å¸æ€»é‡æ—¶ï¼Œâ€œé“¶è¡ŒæŒ¤å…‘â€å°±å‘ç”Ÿäº†ã€‚äººä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿé“¶è¡Œçš„èµ„é‡‘æ•°é‡ä¸‹é™ï¼Œä»¥åŠç”±äºææ¬¾è€Œæ¥è¿‘æ¯ç«­çš„ç¨‹åº¦ï¼Œå‡†ç¡®åœ°åˆ¤æ–­å‡ºä»€ä¹ˆæ—¶å€™å‘ç”Ÿäº†é“¶è¡ŒæŒ¤å…‘ï¼Œä»€ä¹ˆæ—¶å€™é“¶è¡Œä¸šå±æœºå³å°†æ¥ä¸´ã€‚</p><p>å¦‚æœä¸€å®¶é“¶è¡Œæ— æ³•æä¾›è¶³å¤Ÿçš„ç¡¬é€šè´§æ¥æ»¡è¶³äººä»¬å¯¹å®ƒçš„è¦æ±‚ï¼Œé‚£ä¹ˆæ— è®ºå®ƒæ˜¯ä¸€å®¶å•†ä¸šé“¶è¡Œè¿˜æ˜¯ä¸€å®¶å¤®è¡Œï¼Œéƒ½ä¼šé™·å…¥å›°å¢ƒï¼Œå°½ç®¡ä¸€èˆ¬è€Œè¨€ï¼Œå¤®è¡Œæ¯”å•†ä¸šé“¶è¡Œçš„é€‰æ‹©æ›´å¤šä¸€äº›ã€‚è¿™æ˜¯å› ä¸ºå•†ä¸šé“¶è¡Œä¸èƒ½ç®€å•åœ°å°é’æˆ–ä¿®æ”¹æ³•å¾‹ä»¥ä½¿å…¶æ›´å®¹æ˜“åœ°å¿è¿˜å€ºåŠ¡ï¼Œè€Œä¸­å¤®é“¶è¡Œå¯ä»¥ã€‚å½“ç§äººé“¶è¡Œå®¶é™·å…¥å›°å¢ƒæ—¶ï¼Œä»–ä»¬è¦ä¹ˆè¿çº¦ï¼Œè¦ä¹ˆæ¥å—æ”¿åºœçš„æ•‘åŠ©ã€‚å¦‚æœä»–ä»¬çš„å€ºåŠ¡æ˜¯ä»¥æœ¬å›½è´§å¸è®¡ä»·çš„ï¼Œä¸­å¤®é“¶è¡Œå¯ä»¥è´¬å€¼ä»–ä»¬çš„å€ºæƒï¼ˆä¾‹å¦‚ï¼Œå¿è¿˜50-70%ï¼‰ã€‚ä½†å¦‚æœå€ºåŠ¡æ˜¯ä»¥ä»–å›½è´§å¸è®¡ä»·çš„ï¼Œé‚£ä¹ˆä»–ä»¬æœ€ç»ˆä¹ŸåŠ¿å¿…è¿çº¦ã€‚</p><ol start="5"><li>æ³•å®šè´§å¸</li></ol><p>å¤®è¡Œå¸Œæœ›æ‹‰é•¿è´§å¸å’Œä¿¡è´·å‘¨æœŸï¼Œä½¿å…¶æŒç»­å°½å¯èƒ½é•¿çš„æ—¶é—´ï¼Œå› ä¸ºè¿™æ¯”å…¶ä»–åŠæ³•è¦å¥½å¾—å¤šã€‚æ‰€ä»¥ï¼Œå½“ â€œç¡¬é€šè´§â€å’Œâ€å¯¹ç¡¬é€šè´§çš„è¿½ç´¢æƒâ€æˆä¸ºä»–ä»¬çš„ä¸¥é‡æŸç¼šæ—¶ï¼Œæ”¿åºœé€šå¸¸ä¼šæ”¾å¼ƒå®ƒä»¬ï¼Œè½¬è€Œé‡‡ç”¨æ‰€è°“çš„ â€œæ³•å®šâ€è´§å¸ã€‚</p><p>åœ¨æ³•å¸ä½“ç³»ä¸­ä¸éœ€è¦ç¡¬é€šè´§ï¼Œæœ‰çš„åªæ˜¯ä¸­å¤®é“¶è¡Œå¯ä»¥æ— é™åˆ¶â€å°åˆ¶â€çš„â€çº¸å¸â€ã€‚å› æ­¤ï¼Œå¤®è¡Œä¸ä¼šé¢ä¸´ â€œç¡¬é€šè´§â€è¢«æŠ½å¹²ä»è€Œè¿çº¦çš„é£é™©ã€‚</p><p>æ­¤æ—¶çš„é£é™©åœ¨äºï¼Œæ‘†è„±äº†å¯¹æŒæœ‰æœ‰å½¢é»„é‡‘æˆ–å…¶ä»– â€œç¡¬â€èµ„äº§çš„é™åˆ¶ï¼Œæ§åˆ¶å°åˆ·å‚çš„äººï¼ˆå³ä¸å•†ä¸šé“¶è¡Œå®¶ä¸€èµ·å·¥ä½œçš„ä¸­å¤®é“¶è¡Œå®¶ï¼‰å°†ä¸æ–­åˆ›é€ å‡ºæ›´å¤šçš„è´§å¸ã€å€ºåŠ¡èµ„äº§å’Œè´Ÿå€ºï¼Œç›´åˆ°æœ‰ä¸€å¤©ï¼Œä¸å•†å“å’ŒæœåŠ¡çš„æ•°é‡ç›¸æ¯”ï¼Œé‚£äº›æŒæœ‰å¤§é‡å€ºåŠ¡çš„äººå°†è¯•å›¾æŠŠå®ƒä»¬æ¢æˆå•†å“å’ŒæœåŠ¡æ—¶ï¼Œä¼šäº§ç”Ÿä¸é“¶è¡ŒæŒ¤å…‘ä¸€æ ·çš„æ•ˆæœï¼Œå¯¼è‡´å€ºåŠ¡è¿çº¦æˆ–è´§å¸è´¬å€¼ã€‚</p><p>è¿™ç§è½¬å˜ï¼šä»a)å€ºåŠ¡è¿½ç´¢æƒå¯æŒ‰å›ºå®šæ¯”ä¾‹å…‘æ¢æˆæœ‰å½¢èµ„äº§(å¦‚é»„é‡‘)çš„ä½“ç³»è½¬å˜ä¸ºb)ä¸åœ¨å­˜åœ¨è¿™ç§å…‘æ¢çš„æ³•å¸ä½“ç³»ï¼Œæœ€è¿‘ä¸€æ¬¡å‘ç”Ÿæ˜¯åœ¨1971å¹´ã€‚</p><p>å½“å¹´8æœˆ15æ—¥æ™šä¸Šï¼Œå°¼å…‹æ¾å‘Šè¯‰å…¨ä¸–ç•Œï¼Œç¾å…ƒå°†ä¸å†ä¸é»„é‡‘æŒ‚é’©ï¼Œæˆ‘åœ¨ç”µè§†ä¸Šçœ‹åˆ°è¿™äº›ï¼Œå¿ƒæƒ³ï¼Œâ€æˆ‘çš„å¤©ï¼Œæˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„è´§å¸ä½“ç³»å°±è¦ç»“æŸäº†ï¼Œâ€äº‹å®çš„ç¡®å¦‚æ­¤ã€‚</p><p>æˆ‘å½“æ—¶åœ¨çº½çº¦è¯åˆ¸äº¤æ˜“æ‰€åšèŒå‘˜ï¼Œé‚£ä¸ªå‘¨ä¸€æ—©ä¸Šï¼Œæˆ‘æœ¬æ¥ä»¥ä¸ºè‚¡ç¥¨ä¼šä¸‹è·Œï¼Œä»è€Œå‡ºç°å¤§ä¹±ï¼Œç»“æœå‘ç°è‚¡ç¥¨ä¸Šæ¶¨è€Œå¯¼è‡´å¤§ä¹±ã€‚</p><p>å› ä¸ºæˆ‘ä»æ¥æ²¡æœ‰è§è¿‡è´¬å€¼ï¼Œä¸æ˜ç™½å®ƒä»¬æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚ç„¶åæˆ‘æŸ¥äº†ä¸€ä¸‹å†å²ï¼Œå‘ç°åœ¨ç½—æ–¯ç¦å‘è¡¨ç±»ä¼¼è®²è¯çš„é‚£ä¸ª3æœˆ5æ—¥æ˜ŸæœŸå¤©æ™šä¸Šï¼Œä»–ä¹Ÿåšäº†åŸºæœ¬ç›¸åŒçš„äº‹æƒ…ï¼Œåœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆé‡Œï¼Œç»“æœåŸºæœ¬ç›¸åŒï¼ˆè´§å¸è´¬å€¼ï¼Œè‚¡å¸‚å¤§æ¶¨ï¼Œé‡‘ä»·å¤§æ¶¨ï¼‰ã€‚è¿™ç§æƒ…å†µåæ¥æˆ‘çœ‹åˆ°å¾ˆå¤šå›½å®¶å‘ç”Ÿè¿‡å¤šæ¬¡ï¼ŒåŒ…æ‹¬å›½å®¶å…ƒé¦–ä»¬å‘è¡¨çš„åŸºæœ¬ç›¸åŒçš„å®£è¨€ã€‚</p><p>åœ¨1971å¹´ä¹‹å‰çš„å‡ å¹´é‡Œï¼Œç¾å›½æ”¿åºœèŠ±äº†å¾ˆå¤šé’±åœ¨å†›äº‹å’Œç¤¾ä¼šé¡¹ç›®ä¸Šï¼Œå½“æ—¶è¿™è¢«ç§°ä¸º â€œæªæ”¯å’Œé»„æ²¹â€æ”¿ç­–ï¼Œå®ƒé€šè¿‡å€Ÿé’±æ¥å®Œæˆæ”¯ä»˜ï¼Œè€Œè¿™äº›é’±å°±äº§ç”Ÿäº†å€ºåŠ¡ã€‚</p><p>è¿™äº›å€ºåŠ¡å°±æ˜¯ä»–äººå¯¹è´§å¸çš„è¿½ç´¢æƒï¼Œè€Œè¿™äº›è¿½ç´¢æƒå°±å¯ä»¥ç”¨æ¥æ¢å–é»„é‡‘ã€‚æŠ•èµ„è€…è´­ä¹°è¿™äº›å€ºåŠ¡ä½œä¸ºèµ„äº§ï¼Œå› ä¸ºä»–ä»¬å¾—åˆ°äº†è¿™ç¬”æ”¿åºœå€ºåŠ¡çš„åˆ©æ¯ï¼Œè€Œä¸”ç¾å›½æ”¿åºœæ‰¿è¯ºå…è®¸è¿™äº›ç¥¨æ®çš„æŒæœ‰è€…ç”¨è¿™äº›ç¥¨æ®æ¢å–ç¾å›½é‡‘åº“ä¸­çš„é»„é‡‘ã€‚</p><p>éšç€ç¾å›½çš„æ”¯å‡ºå’Œé¢„ç®—èµ¤å­—çš„å¢é•¿ï¼Œç¾å›½ä¸å¾—ä¸å‘è¡Œæ›´å¤šçš„å€ºåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›é€ äº†æ›´å¤šçš„é»„é‡‘å€ºæƒï¼Œä½†é“¶è¡Œé‡Œçš„é»„é‡‘æ•°é‡å´æ²¡æœ‰å¢åŠ ã€‚</p><p>è‡ªç„¶è€Œç„¶ï¼Œç”¨è¿™ç§è¿½ç´¢æƒæ¢å–é»„é‡‘çš„æŠ•èµ„è€…è¶Šæ¥è¶Šå¤šã€‚æ˜çœ¼äººéƒ½èƒ½çœ‹å‡ºç¾å›½çš„é»„é‡‘å·²ç»å¿«ç”¨å®Œäº†ï¼Œè€Œæœªå¿ä»˜çš„é»„é‡‘å€ºæƒæ•°é‡è¿œè¿œå¤§äºé“¶è¡Œé‡Œçš„é»„é‡‘æ•°é‡ï¼Œæ‰€ä»¥ä»–ä»¬æ„è¯†åˆ°å¦‚æœè¿™æ ·ä¸‹å»ï¼Œç¾å›½å°±ä¼šè¿çº¦ã€‚</p><p>å½“ç„¶ï¼Œåœ¨é‚£ä¸ªæ—¶å€™ï¼Œå¾ˆå¤šäººçœ‹åˆ°äº†ç¾å›½æ”¿åºœè¡¨é¢ä¸Šçš„å¯Œæœ‰ï¼Œè®¤ä¸ºå®ƒæ˜¯ä¸å¯èƒ½åœ¨å¿ä»˜é»„é‡‘å€ºæƒä¸Šè¿çº¦çš„ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°äººå¯¹è¿™ä¸€å®£å¸ƒä»¥åŠå¯¹å¸‚åœºçš„å½±å“æ„Ÿåˆ°æƒŠè®¶ï¼Œä¸è¿‡é‚£äº›äº†è§£è´§å¸å’Œä¿¡è´·è¿ä½œæœºåˆ¶çš„äººå´ä¸ä»¥ä¸ºç„¶ã€‚</p><p>å½“ä¿¡è´·å‘¨æœŸè¾¾åˆ°æé™æ—¶ï¼Œä¸­å¤®æ”¿åºœåŠå…¶å¤®è¡Œçš„ç»å…¸ååº”æ˜¯åˆ›é€ å¤§é‡çš„å€ºåŠ¡ï¼Œå¹¶å°é’ï¼ŒæŠŠé’±èŠ±åœ¨å•†å“ã€æœåŠ¡å’ŒæŠ•èµ„èµ„äº§ä¸Šï¼Œä»¥ç»´æŒç»æµçš„å‘å±•ã€‚</p><p>è¿™å°±æ˜¯2008å¹´å€ºåŠ¡å±æœºæœŸé—´çš„åšæ³•ï¼Œå½“æ—¶åˆ©ç‡å·²ç»è¾¾åˆ°0%ï¼Œæ— æ³•å†é™ä½ã€‚æ­£å¦‚å‰æ–‡æ‰€è§£é‡Šçš„é‚£æ ·ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºäº†åº”å¯¹1929-32å¹´çš„å€ºåŠ¡å±æœºè€Œåšçš„ï¼Œå½“æ—¶åˆ©ç‡å·²ç»è·Œåˆ°0%ã€‚è¿™ç§å€ºåŠ¡å’Œè´§å¸çš„åˆ›é€ ï¼Œç°åœ¨å‡ºç°çš„æ•°é¢æ¯”äºŒæˆ˜ä»¥æ¥çš„ä»»ä½•æ—¶å€™éƒ½è¦å¤§ã€‚</p><p>è¯´ç™½äº†ï¼Œå¤®è¡Œ â€œå°é’± â€œå¹¶å°†å…¶ç”¨äºæ”¯å‡ºï¼Œè€Œä¸æ˜¯ç”¨å€ºåŠ¡å¢é•¿æ¥æ”¯æŒæ”¯å‡ºï¼Œè¿™å¹¶éæ²¡æœ‰å¥½å¤„ã€‚ä¾‹å¦‚ï¼Œé’±å¯ä»¥åƒä¿¡è´·ä¸€æ ·ç”¨äºæ¶ˆè´¹ï¼Œä½†å®é™…ä¸Šï¼ˆè€Œä¸æ˜¯ç†è®ºä¸Šï¼‰ä¸éœ€è¦å¿è¿˜ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦è´§å¸å¢é•¿è€Œä¸æ˜¯ä¿¡è´·/å€ºåŠ¡å¢é•¿ï¼Œåªè¦æŠŠé’±ç”¨åœ¨ç”Ÿäº§æ€§çš„ç”¨é€”ä¸Šï¼Œå°±æ²¡æœ‰é”™ã€‚</p><p>ä¸è¿‡é‡‡å–å°é’±æ‰‹æ®µè€Œä¸æ˜¯ä¿ƒè¿›ä¿¡è´·å¢é•¿çš„ä¸»è¦é£é™©åœ¨äºï¼ša)å¸‚åœºå‚ä¸è€…ä¸ä¼šä»”ç»†åˆ†æè¿™äº›é’±æ˜¯å¦ç”¨äºç”Ÿäº§æ€§ç”¨é€”ï¼›b)å®ƒçœå»äº†è®©è¿˜é’±çš„å¿…è¦æ€§ã€‚</p><p>è¿™ä¸¤ç‚¹éƒ½ä¼šå¢åŠ æ¿€è¿›å°é’±çš„æ¦‚ç‡ï¼Œè€Œä¸”è¿™äº›é’±ä¹Ÿä¸ä¸€å®šç”¨äºç”Ÿäº§ï¼Œæ‰€ä»¥äººä»¬å°±ä¼šåœæ­¢æŠŠé’±ä½œä¸ºè´¢å¯Œå‚¨è—æ‰‹æ®µï¼Œå¹¶å°†è´¢å¯Œè½¬ç§»åˆ°å…¶ä»–ä¸œè¥¿ä¸Šã€‚</p><p>çºµè§‚å†å²ï¼Œå½“ç¡¬é€šè´§ï¼ˆå€ºåŠ¡å’Œè´§å¸å‡­è¯ï¼‰çš„æœªå¿è¿˜å€ºæƒè¿œè¿œå¤§äºç¡¬é€šè´§å’Œå•†å“å’ŒæœåŠ¡çš„æ•°é‡æ—¶ï¼Œæ€»ä¼šå‘ç”Ÿå¤§é‡è¿çº¦æˆ–å¤§é‡å°é’å’Œè´¬å€¼ã€‚</p><p>å†å²å·²ç»å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ä¾èµ–æ”¿åºœåœ¨ç»æµä¸Šä¿æŠ¤æˆ‘ä»¬ã€‚ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ï¼Œå¤§å¤šæ•°æ”¿åºœä¼šæ»¥ç”¨ä»–ä»¬ä½œä¸ºè´§å¸å’Œä¿¡è´·çš„åˆ›é€ è€…å’Œä½¿ç”¨è€…çš„ç‰¹æƒåœ°ä½ã€‚å‡è®¾ä½ ç«™åœ¨ä»–ä»¬çš„ç«‹åœºä¸Šï¼Œä½ å¯èƒ½ä¼šåšå‡ºä¸€æ ·çš„ä¸¾åŠ¨ã€‚</p><p>è¿™æ˜¯å› ä¸ºæ²¡æœ‰ä¸€ä¸ªæ”¿ç­–åˆ¶å®šè€…èƒ½å¤Ÿé©¾é©­æ•´ä¸ªå‘¨æœŸã€‚æ¯ä¸€ä¸ªäººéƒ½æ˜¯å‘¨æœŸçš„æŸä¸ªé˜¶æ®µå‚ä¸è¿›æ¥ï¼Œä»–ä»¬åªèƒ½æ ¹æ®å½“æ—¶çš„æƒ…å†µï¼Œåšç€å¯¹ä»–ä»¬æœ‰åˆ©çš„äº‹æƒ…ã€‚</p><p>å› ä¸ºåœ¨å€ºåŠ¡å‘¨æœŸçš„æ—©æœŸï¼Œæ”¿åºœæ˜¯å€¼å¾—ä¿¡èµ–çš„ï¼Œä»–ä»¬å’Œå…¶ä»–äººä¸€æ ·éœ€è¦é’±ï¼Œç”šè‡³æ¯”å…¶ä»–äººæ›´éœ€è¦é’±ï¼Œæ‰€ä»¥ä»–ä»¬é€šå¸¸æ˜¯æœ€å¤§çš„å€Ÿæ¬¾äººã€‚</p><p>è€Œåœ¨å‘¨æœŸçš„åæœŸï¼Œå½“åç»­é¢†å¯¼äººä¸Šå°æ‰§æŒæ”¿åºœæ—¶ï¼Œä¼šé¢ä¸´æ›´å¤šå€ºåŠ¡ã€‚è¿™æ—¶æ–°çš„æ”¿åºœé¢†å¯¼äººå’Œæ–°çš„å¤®è¡Œå†³ç­–è€…ä»¬å°±è¦é¢å¯¹æ›´å¤§çš„æŒ‘æˆ˜ï¼Œæ­¤æ—¶ä¸€æ–¹é¢ä»–ä»¬çš„åˆºæ¿€æ‰‹æ®µè¾ƒå°‘ï¼ŒåŒæ—¶è¿˜è¦å¿…é¡»å¿è¿˜å€ºåŠ¡ã€‚</p><p>æ›´ä¸ºç³Ÿç³•çš„æ˜¯ï¼Œæ”¿åºœè¿˜å¿…é¡»æ•‘åŠ©å€ºåŠ¡äººï¼Œå› ä¸ºä»–ä»¬çš„å€’ä¸‹åˆä¼šä¼¤å®³åˆ°æ•´ä¸ªç³»ç»Ÿã€‚å› æ­¤ï¼Œä»–ä»¬å¾€å¾€ä¼šé™·å…¥æ¯”ä¸ªäººã€å…¬å¸å’Œå¤§å¤šæ•°å…¶ä»–å®ä½“æ›´å¤§çš„ç°é‡‘æµå›°å¢ƒã€‚</p><p>æ¢å¥è¯è¯´ï¼Œåœ¨å‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹ï¼Œæ”¿åºœåœ¨è¡ŒåŠ¨ä¸ŠåŠ©é•¿äº†å€ºåŠ¡çš„ç§¯ç´¯ï¼Œæˆä¸ºå¤§çš„å€ºåŠ¡äººï¼Œå½“å€ºåŠ¡æ³¡æ²«ç ´ç­æ—¶ï¼Œæ”¿åºœé€šè¿‡å°é’å’Œè´¬å€¼æ¥æ‹¯æ•‘è‡ªå·±å’Œä»–äººã€‚å€ºåŠ¡å±æœºè¶Šå¤§ï¼Œå°±è¶Šæ˜¯å¦‚æ­¤ã€‚</p><p>è™½ç„¶ä¸å¯å–ï¼Œä½†å‡ºç°è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¯ä»¥ç†è§£çš„ã€‚å½“ä½ å¯ä»¥åˆ¶é€ è´§å¸å’Œä¿¡è´·ï¼Œå¹¶æŠŠå®ƒä¼ ç»™æ¯ä¸ªäººï¼Œè®©ä»–ä»¬é«˜å…´çš„æ—¶å€™ï¼Œä½ å¾ˆéš¾æŠµæŒ¡ä½è¯±æƒ‘ã€‚â€è¿™æ˜¯å…¸å‹çš„é‡‘èä¸¾åŠ¨ã€‚çºµè§‚å†å²ä¸Šçš„ç»Ÿæ²»è€…ï¼Œä»–ä»¬éƒ½ä¼šç´¯ç§¯èµ·å¤§é‡åœ¨å…¶ç»Ÿæ²»æœŸç»“æŸåå¾ˆä¹…æ‰ä¼šåˆ°æœŸçš„å€ºåŠ¡ï¼Œè®©ä»–ä»¬çš„ç»§ä»»è€…æ¥æ”¶æ‹¾æ®‹å±€ã€‚</p><p>å½“æ”¿åºœå‡ºç°å€ºåŠ¡é—®é¢˜æ—¶ï¼Œä»–ä»¬ä¼šå¦‚ä½•åº”å¯¹ï¼Ÿ</p><p>ä»–ä»¬ä¼šå’Œä»»ä½•ä¸€ä¸ªå®é™…å€ºåŠ¡è´Ÿæ‹…æ²‰é‡çš„å®ä½“ä¸€æ ·ï¼Œç”¨å°é’æ¥è§£å†³ã€‚æ— ä¸€ä¾‹å¤–ï¼Œå¦‚æœå€ºåŠ¡æ˜¯ä»¥è‡ªå·±çš„è´§å¸è®¡ä»·ï¼Œä»–ä»¬å°±ä¼šå°é’±è®©è´§å¸è´¬å€¼ã€‚</p><p>å½“å¤®è¡Œå°é’±ä¹°å…¥å€ºåŠ¡ï¼Œè¿™å°±æŠŠé’±æ”¾è¿›äº†é‡‘èç³»ç»Ÿï¼Œå¹¶ä½¿é‡‘èèµ„äº§çš„ä»·æ ¼ç«ç›¸ä¸Šæ¶¨ï¼ˆè¿™ä¹Ÿæ‰©å¤§äº†è´«å¯Œå·®è·ï¼Œå› ä¸ºå®ƒè®©é‚£äº›æ‹¥æœ‰é‡‘èèµ„äº§çš„äººç›¸å¯¹äºæ²¡æœ‰é‡‘èèµ„äº§çš„äººå—ç›Šæ›´å¤šï¼‰ã€‚</p><p>åŒæ—¶ï¼Œå®ƒè¿˜æŠŠå¤§é‡çš„å€ºåŠ¡æŒæ¡åœ¨å¤®è¡Œæ‰‹ä¸­ï¼Œè®©å¤®è¡Œå¯ä»¥éšå¿ƒæ‰€æ¬²åœ°å¤„ç†è¿™äº›å€ºåŠ¡ã€‚è€Œä¸”ä»–ä»¬å°é’±å’Œä¹°å…¥é‡‘èèµ„äº§ï¼ˆä¸»è¦æ˜¯å€ºåˆ¸ï¼‰ï¼Œä¹Ÿå°±æŠŠåˆ©ç‡å‹ä½äº†ï¼Œè¿™å°±åˆºæ¿€äº†å€Ÿé’±å’Œä¹°å…¥ï¼Œå¹¶é¼“åŠ±é‚£äº›æŒæœ‰è¿™äº›å€ºåˆ¸çš„äººå–å‡ºå€ºåˆ¸ï¼Œé¼“åŠ±ä»–ä»¬ä»¥ä½åˆ©ç‡å€Ÿé’±ï¼ŒæŠŠé’±æŠ•èµ„äºå›æŠ¥ç‡è¾ƒé«˜çš„èµ„äº§ï¼Œè¿™å°±å¯¼è‡´å¤®è¡Œå°æ›´å¤šçš„é’±ï¼Œä¹°å…¥æ›´å¤šçš„å€ºåˆ¸ï¼Œæœ‰æ—¶ä¹Ÿä¹°å…¥å…¶ä»–é‡‘èèµ„äº§ã€‚</p><p>è¿™é€šå¸¸èƒ½å¾ˆå¥½åœ°æ¨é«˜é‡‘èèµ„äº§ä»·æ ¼ï¼Œä½†åœ¨æŠŠé’±å’Œä¿¡è´·ä»¥åŠè´­ä¹°åŠ›é€åˆ°æœ€éœ€è¦çš„äººæ‰‹ä¸­æ—¶ï¼Œæ•ˆç‡å°±å¾ˆä½äº†ã€‚è¿™å°±æ˜¯2008å¹´å‘ç”Ÿçš„æƒ…å†µï¼Œåœ¨é‚£ä¹‹åçš„å¤§éƒ¨åˆ†æ—¶é—´é‡Œï¼Œç›´åˆ°æœ€è¿‘ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>ç„¶åï¼Œå½“å°é’å’Œå¤®è¡Œä¹°å…¥é‡‘èèµ„äº§æ— æ³•æŠŠé’±å’Œä¿¡è´·é€åˆ°éœ€è¦çš„åœ°æ–¹æ—¶ï¼Œä¸­å¤®æ”¿åºœâ€”â€”å®ƒå¯ä»¥å†³å®šæŠŠé’±èŠ±åœ¨ä»€ä¹ˆåœ°æ–¹â€”â€”ä»å¤®è¡Œï¼ˆå°é’ç¥¨çš„å¤®è¡Œï¼‰é‚£é‡Œå€Ÿé’±ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥æŠŠé’±èŠ±åœ¨éœ€è¦èŠ±çš„åœ°æ–¹ã€‚åœ¨ç¾å›½ï¼Œç¾è”å‚¨åœ¨2020å¹´4æœˆ9æ—¥å®£å¸ƒäº†è¿™ä¸€è®¡åˆ’ã€‚</p><p>è¿™ç§é€šè¿‡å°é’±ä¹°å€ºï¼ˆç§°ä¸ºå€ºåŠ¡è´§å¸åŒ–ï¼‰çš„æ–¹å¼ï¼Œä½œä¸ºä¸€ç§è·å–é‡‘é’±å’Œå°†è´¢å¯Œä»æ‹¥æœ‰é‡‘é’±çš„äººæ‰‹ä¸­è½¬ç§»åˆ°éœ€è¦é‡‘é’±çš„äººæ‰‹ä¸­çš„æ–¹å¼ï¼Œæ¯”èµ·å¾ç¨å¯¼è‡´çº³ç¨äººä¸æ»¡ï¼Œåœ¨æ”¿æ²»ä¸Šè¦å¥½å¾—å¤šã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤®è¡Œæ€»æ˜¯å°é’ç¥¨ã€è®©è´§å¸è´¬å€¼çš„åŸå› ã€‚</p><p>å½“æ”¿åºœå°äº†å¾ˆå¤šé’±ï¼Œä¹°äº†å¾ˆå¤šå€ºï¼Œè¿™æ ·é’±å’Œå€ºçš„æ•°é‡éƒ½å¢åŠ äº†ï¼Œé’±å’Œå€ºçš„ä»·æ ¼å°±ä¼šä¾¿å®œï¼Œè¿™å®è´¨ä¸Šæ˜¯å‘æ‹¥æœ‰è¿™äº›é’±å’Œå€ºçš„äººå¾ç¨ã€‚</p><p>å½“è¿™ç§æƒ…å†µå‘ç”Ÿå¾—è¶³å¤Ÿå¤šï¼Œè®©è¿™äº›é’±å’Œå€ºåŠ¡èµ„äº§çš„æŒæœ‰è€…æ„è¯†åˆ°å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä»–ä»¬å°±ä¼šå¯»æ±‚å‡ºå”®ä»–ä»¬çš„å€ºåŠ¡èµ„äº§å’Œå€Ÿé’±ï¼Œä»¥è·å¾—ä»–ä»¬å¯ä»¥ç”¨ä½å»‰èµ„é‡‘æ¥å¿è¿˜çš„å€ºåŠ¡ã€‚</p><p>ä»–ä»¬è¿˜ç»å¸¸å°†è´¢å¯Œè½¬ç§»åˆ°å…¶ä»–çš„è´¢å¯Œå­˜å‚¨å·¥å…·ä¸­ï¼Œå¦‚é»„é‡‘ã€æŸäº›ç±»å‹çš„è‚¡ç¥¨å’Œå…¶ä»–åœ°æ–¹ï¼ˆå¦‚å¦ä¸€ä¸ªæ²¡æœ‰è¿™äº›é—®é¢˜çš„å›½å®¶ï¼‰ã€‚åœ¨è¿™ç§æ—¶å€™ï¼Œå¤®è¡Œé€šå¸¸ä¼šç»§ç»­å°é’±ï¼Œç›´æ¥æˆ–é—´æ¥åœ°è´­ä¹°å€ºåŠ¡ï¼ˆä¾‹å¦‚ï¼Œè®©é“¶è¡Œä»£ä¸ºè´­ä¹°ï¼‰ï¼Œå¹¶ç¦æ­¢è´§å¸æµå‘å¯ä»¥å¯¹å†²é€šèƒ€çš„èµ„äº§å’Œå…¶ä»–è´§å¸åŠåœºæ‰€ã€‚</p><p>è¿™æ ·çš„é€šèƒ€æœŸè¦ä¹ˆåˆºæ¿€è´§å¸å’Œä¿¡è´·æ‰©å¼ ï¼Œä¸ºå¦ä¸€æ¬¡ç»æµæ‰©å¼ æä¾›èµ„é‡‘ï¼ˆè¿™å¯¹è‚¡ç¥¨æœ‰å¥½å¤„ï¼‰ï¼Œè¦ä¹ˆä½¿è´§å¸è´¬å€¼ï¼Œä»è€Œäº§ç”Ÿè´§å¸é€šèƒ€ï¼ˆè¿™å¯¹é»„é‡‘ç­‰é€šèƒ€å¯¹å†²èµ„äº§æœ‰å¥½å¤„ï¼‰ã€‚</p><p>åœ¨é•¿æœŸå€ºåŠ¡å‘¨æœŸè¾ƒæ—©çš„æ—¶å€™ï¼Œå½“æœªå¿å€ºåŠ¡æ•°é¢ä¸å¤§ï¼Œæœ‰å¾ˆå¤§çš„ç©ºé—´é€šè¿‡é™æ¯æ¥åˆºæ¿€ï¼ˆå¦‚æœä¸é™æ¯ï¼Œå°±å°é’±å’Œä¹°å…¥é‡‘èèµ„äº§ï¼‰ï¼Œé‚£ä¹ˆä¿¡è´·å¢é•¿å’Œç»æµå¢é•¿çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚</p><p>è€Œåœ¨é•¿æœŸå€ºåŠ¡å‘¨æœŸè¾ƒæ™šçš„æ—¶å€™ï¼Œå½“å€ºåŠ¡æ•°é¢è¾ƒå¤§ï¼Œæ²¡æœ‰å¤ªå¤šç©ºé—´é€šè¿‡é™æ¯ï¼ˆæˆ–å°é’±å’Œä¹°å…¥é‡‘èèµ„äº§ï¼‰æ¥åˆºæ¿€ï¼Œé‚£ä¹ˆä¼´éšç€ç»æµç–²è½¯è€Œå‡ºç°è´§å¸é€šèƒ€çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚</p><ol start="6"><li>é‡å›ç¡¬é€šè´§</li></ol><p>è¿‡åº¦å°åˆ¶æ³•å¸ä¼šå¯¼è‡´å€ºåŠ¡èµ„äº§çš„æŠ›å”®ï¼Œä»¥åŠä¹‹å‰æè¿°çš„ç±»ä¼¼é“¶è¡Œâ€æŒ¤å…‘â€çš„æƒ…å†µï¼Œæœ€ç»ˆä¼šé™ä½è´§å¸å’Œä¿¡è´·çš„ä»·å€¼ï¼Œä¿ƒä½¿äººä»¬é€ƒç¦»è´§å¸å’Œå€ºåŠ¡ï¼ˆå¦‚å€ºåˆ¸ï¼‰ã€‚ä»–ä»¬ä¹Ÿå°±éœ€è¦å†³å®šå°†ä½¿ç”¨ä½•ç§æ›¿ä»£æ€§çš„è´¢å¯Œå­˜å‚¨æ–¹å¼ã€‚</p><p>å†å²ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œä»–ä»¬é€šå¸¸ä¼šè½¬å‘é»„é‡‘ã€å…¶ä»–è´§å¸ã€å…¶ä»–å›½å®¶æ²¡æœ‰è¿™äº›é—®é¢˜çš„èµ„äº§ï¼Œä»¥åŠèƒ½å¤Ÿä¿ç•™å…¶å®é™…ä»·å€¼çš„è‚¡ç¥¨ã€‚</p><p>æœ‰äº›äººè®¤ä¸ºï¼Œä¸–ç•Œéœ€è¦å¦ä¸€ç§å¯ä¾›é€‰æ‹©çš„å‚¨å¤‡è´§å¸ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ï¼Œå› ä¸ºåœ¨æ²¡æœ‰å¯ä¾›é€‰æ‹©çš„è´§å¸çš„æƒ…å†µä¸‹ï¼Œä»å†å²ä¸Šçœ‹ï¼Œè´§å¸ä½“ç³»å´©æºƒå’Œè´¢å¯Œæ¶Œå‘å…¶ä»–èµ„äº§ï¼Œä¹ŸåŒæ ·ä¼šå‘ç”Ÿã€‚</p><p>è´§å¸è‡ªèº«ä»·å€¼çš„å‡å¼±ï¼Œä¼šå¯¼è‡´è´§å¸è´¬å€¼ï¼Œäººä»¬ä¹Ÿä¼šæŠ›å¼ƒè¿™ç§è´§å¸ï¼Œå¹¶å°†èµ„äº§æŠ•å…¥å…¶ä»–åœ°æ–¹ã€‚å†å²ä¸Šï¼Œå½“è´§å¸è´¬å€¼çš„æ—¶å€™ï¼Œäººä»¬ä¼šå¥”å‘å¤§é‡å…¶ä»–ä¸œè¥¿ï¼Œç”šè‡³åŒ…æ‹¬å¾·å›½é­ç›å…±å’Œå›½çš„çŸ³å¤´ï¼ˆç”¨äºå»ºç­‘ï¼‰ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µçš„å€ºåŠ¡å‘¨æœŸä¸­ï¼Œä¹Ÿä¼šå‡ºç°è´«å¯Œå·®è·è¿‡å¤§é€ æˆçš„ç»æµå‹åŠ›ï¼Œè¿™å°±å¯¼è‡´äº†æ›´é«˜çš„ç¨æ”¶å’Œè´«å¯Œä¹‹é—´çš„äº‰æ–—ï¼Œä¹Ÿä½¿å¾—é‚£äº›æ‹¥æœ‰è´¢å¯Œçš„äººæƒ³è¦è½¬ç§»åˆ°ç¡¬èµ„äº§å’Œå…¶ä»–è´§å¸å’Œå…¶ä»–å›½å®¶ã€‚</p><p>å¾ˆè‡ªç„¶çš„ï¼Œå›½å®¶ä¼šé˜»æ­¢è¿™ç§å¤–é€ƒã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æ—¶å€™ï¼Œæ”¿åºœå°±ä¼šåŠ å¤§å¯¹é»„é‡‘ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å–ç¼”é»„é‡‘çš„äº¤æ˜“å’Œæ‰€æœ‰æƒï¼‰ã€å¤–å›½è´§å¸ï¼ˆé€šè¿‡å–æ¶ˆå…¶äº¤æ˜“èƒ½åŠ›ï¼‰ã€å¤–å›½èµ„äº§ï¼ˆé€šè¿‡å»ºç«‹å¤–æ±‡ç®¡åˆ¶æ¥é˜²æ­¢èµ„é‡‘æµå‡ºå›½å¢ƒï¼‰çš„æŠ•èµ„éš¾åº¦ã€‚</p><p>æœ€ç»ˆï¼Œå€ºåŠ¡åŸºæœ¬ä¸Šè¢«æ¶ˆç­ï¼Œé€šå¸¸æ˜¯é€šè¿‡è®©è¿˜å€ºçš„é’±æ—¢å¤šåˆä¾¿å®œï¼Œä½¿è´§å¸å’Œå€ºåŠ¡éƒ½è´¬å€¼ã€‚</p><p>å½“è¿™ç§æƒ…å†µå˜å¾—æç«¯ï¼Œä»¥è‡³äºè´§å¸å’Œä¿¡è´·ä½“ç³»å´©æºƒï¼Œå€ºåŠ¡è´¬å€¼å’Œ/æˆ–è¿çº¦å‡ºç°æ—¶ï¼Œæ”¿åºœé€šå¸¸ä¸å¾—ä¸å›åˆ°æŸç§å½¢å¼çš„ç¡¬é€šè´§ï¼Œä»¥é‡å»ºäººä»¬å¯¹è´§å¸ä½œä¸ºè´¢å¯Œå­˜å‚¨çš„ä»·å€¼çš„ä¿¡å¿ƒï¼Œä»è€Œæ¢å¤ä¿¡è´·å¢é•¿ã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œå°½ç®¡å¹¶éæ€»æ˜¯å¦‚æ­¤ï¼Œä½†æ”¿åºœå¾€å¾€ä¼šå°†å…¶è´§å¸ä¸æŸç§ç¡¬é€šè´§ï¼ˆå¦‚é»„é‡‘æˆ–ç¡¬å‚¨å¤‡è´§å¸ï¼‰æŒ‚é’©ï¼Œå¹¶æ‰¿è¯ºå…è®¸æ–°è´§å¸çš„æŒæœ‰è€…å°†å…¶å…‘æ¢æˆç¡¬é€šè´§ã€‚</p><p>æœ‰æ—¶ï¼Œè¿™äº›ç¡¬é€šè´§å¯èƒ½æ˜¯å¦ä¸€ä¸ªå›½å®¶çš„ç¡¬é€šè´§ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿‡å»å‡ åå¹´é‡Œï¼Œè®¸å¤šå¼±è´§å¸å›½å®¶å°†å…¶è´§å¸ä¸ç¾å…ƒæŒ‚é’©ï¼Œæˆ–è€…å¹²è„†å°†å…¶ç»æµç¾å…ƒåŒ–ï¼ˆå³ï¼Œå°†ç¾å…ƒä½œä¸ºè‡ªå·±çš„äº¤æ˜“åª’ä»‹å’Œè´¢å¯Œå‚¨å­˜æ‰‹æ®µï¼‰ã€‚</p><p>å›é¡¾ä¸€ä¸‹ï¼Œåœ¨é•¿æœŸçš„å€ºåŠ¡å‘¨æœŸä¸­ï¼Œå°†å€ºåŠ¡ä½œä¸ºä¸€ç§æä¾›åˆ©æ¯çš„èµ„äº§æŒæœ‰ï¼Œåœ¨å‘¨æœŸåˆæœŸæ²¡æœ‰å¤§é‡å€ºåŠ¡æœªè¿˜çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæœ‰å›æŠ¥ã€‚ä½†è¿™åœ¨å‘¨æœŸåæœŸæœ‰å¤§é‡å€ºåŠ¡æœªè¿˜ï¼Œä¸”æ›´æ¥è¿‘äºè¿çº¦æˆ–è´¬å€¼çš„æ—¶å€™ï¼Œç›¸å¯¹äºç»™å‡ºçš„åˆ©æ¯è€Œè¨€ï¼ŒæŒæœ‰å€ºåŠ¡æ˜¯æœ‰é£é™©çš„ã€‚</p><p>æ‰€ä»¥ï¼ŒæŒæœ‰å€ºåŠ¡ï¼ˆå¦‚å€ºåˆ¸ï¼‰æœ‰ç‚¹åƒæŒæœ‰ä¸€ä¸ªå®šæ—¶ç‚¸å¼¹ï¼Œåœ¨å®ƒè¿˜åœ¨æ»´ç­”çš„æ—¶å€™ç»™ä½ å¥–åŠ±ï¼Œä½†ä¸€æ—¦çˆ†ç‚¸ä¹Ÿä¼šå°†ä½ ç‚¸é£ã€‚è€Œæ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œå¤§çˆ†ç‚¸ï¼ˆå³å¤§è¿çº¦æˆ–å¤§è´¬å€¼ï¼‰å¤§æ¦‚æ¯50-75å¹´å°±ä¼šå‘ç”Ÿä¸€æ¬¡ã€‚</p><p>è¿™äº›å€ºåŠ¡å‘¨æœŸå’Œæ³¨é”€å€ºåŠ¡çš„å‘¨æœŸå·²ç»å­˜åœ¨äº†å‡ åƒå¹´ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å·²ç»åˆ¶åº¦åŒ–äº†ã€‚çŸ¥é“å€ºåŠ¡å‘¨æœŸä¼šåœ¨è¿™ä¸ªæ—¶é—´è¡¨ä¸Šå‘ç”Ÿï¼Œä¼šè®©æ¯ä¸ªäººéƒ½èƒ½ä»¥ç†æ€§çš„æ–¹å¼è¡Œäº‹ï¼Œä¸ºä¹‹åšå‡†å¤‡ã€‚å¸®åŠ©ä½ äº†è§£è¿™ä¸ªæƒ…å†µï¼Œè®©ä½ åšå¥½å‡†å¤‡ï¼Œè€Œä¸æ˜¯è¢«å®ƒå“åˆ°ï¼Œè¿™æ˜¯æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„ä¸»è¦ç›®çš„ã€‚</p><p>å› ä¸ºå¤§å¤šæ•°äººå¯¹è¿™ä¸ªå‘¨æœŸä¸ä»–ä»¬æ‰€ç»å†çš„äº‹æƒ…å¹¶ä¸å¤ªæ³¨æ„ï¼Œè®½åˆºçš„æ˜¯ï¼Œè¶Šæ˜¯æ¥è¿‘è¢«ç‚¸çš„äººå¾€å¾€è¶Šæ˜¯è§‰å¾—å®‰å…¨ã€‚</p><p>é‚£æ˜¯å› ä¸ºä»–ä»¬ä¸€ç›´æŒæœ‰å€ºåŠ¡ï¼Œå¹¶äº«å—ç€è¿™æ ·åšçš„å›æŠ¥ï¼Œè€Œä¸”ä»ä¸Šä¸€æ¬¡çˆ†ä»“çš„æ—¶é—´è¶Šé•¿ï¼Œéšç€ä¸Šä¸€æ¬¡çˆ†ä»“çš„è®°å¿†æ¶ˆé€€ï¼Œä»–ä»¬å°±è¶Šæ˜¯èˆ’æœâ€”â€”å³ä½¿æŒæœ‰è¿™ç¬”å€ºåŠ¡çš„é£é™©ä¸Šå‡ï¼Œè€Œå›æŠ¥ä¸‹é™ã€‚</p><p>ç›¯ä½éœ€è¦å¿è¿˜çš„å€ºåŠ¡ç›¸å¯¹äºç¡¬é€šè´§çš„æ•°é‡ï¼Œéœ€è¦å¿è¿˜çš„å€ºåŠ¡æ€»é‡ç›¸å¯¹äºå€ºåŠ¡äººçš„ç°é‡‘æµï¼Œä»¥åŠå€Ÿå‡ºèµ„é‡‘çš„åˆ©æ¯å›æŠ¥ï¼Œå°±å¯ä»¥è¯„ä¼°æŒæœ‰è¿™é¢—å®šæ—¶ç‚¸å¼¹çš„é£é™©/å›æŠ¥ã€‚</p><h1 id="4-é•¿æœŸå€ºåŠ¡å‘¨æœŸæ€»ç»“"><a href="#4-é•¿æœŸå€ºåŠ¡å‘¨æœŸæ€»ç»“" class="headerlink" title="4. é•¿æœŸå€ºåŠ¡å‘¨æœŸæ€»ç»“"></a>4. é•¿æœŸå€ºåŠ¡å‘¨æœŸæ€»ç»“</h1><p>å‡ åƒå¹´æ¥ï¼Œè´§å¸åˆ¶åº¦ä¸€ç›´æœ‰ä¸‰ç§ç±»å‹ï¼š</p><ul><li>ç¡¬é€šè´§ï¼ˆå¦‚é‡‘å±ç¡¬å¸ï¼‰</li><li>ä»¥â€œçº¸å¸â€å½¢å¼å­˜åœ¨çš„å¯¹ç¡¬é€šè´§çš„çš„è¿½ç´¢æƒ</li><li>æ³•å®šè´§å¸ï¼ˆå¦‚ä»Šå¤©çš„ç¾å…ƒï¼‰</li></ul><p>ç¡¬é€šè´§æ˜¯æœ€å…·é™åˆ¶æ€§çš„è´§å¸ä½“ç³»ï¼Œå› ä¸ºé™¤éå¢åŠ é‡‘å±æˆ–å…¶ä»–å…·æœ‰å†…åœ¨ä»·å€¼çš„å•†å“ï¼ˆå³è´§å¸ï¼‰çš„ä¾›åº”é‡ï¼Œå¦åˆ™å°±æ— æ³•åˆ›é€ è´§å¸ã€‚ç¬¬äºŒç§ç±»å‹æ›´å®¹æ˜“åˆ›é€ è´§å¸å’Œä¿¡è´·ï¼Œå› æ­¤ç¡¬é€šè´§å€ºæƒä¸å®é™…æŒæœ‰çš„ç¡¬é€šè´§ä¹‹é—´çš„æ¯”ç‡ä¸Šå‡ï¼Œæœ€ç»ˆå¯¼è‡´é“¶è¡ŒæŒ¤å…‘ã€‚</p><p>ç»“æœæœ‰äºŒï¼šä¸€æ˜¯è¿çº¦ï¼Œé“¶è¡Œå…³é—¨ä¸”å‚¨æˆ·å¤±å»ç¡¬èµ„äº§ï¼›äºŒæ˜¯æœ‰å¯èƒ½è·Ÿå‰è€…ä¸€èµ·å‘ç”Ÿçš„å€ºæƒè´§å¸è´¬å€¼ï¼Œè¿™æ„å‘³ç€å‚¨æˆ·æ‹¿å›æ¥çš„é’±å˜å°‘äº†ã€‚è€Œåœ¨ç¬¬ä¸‰ç§ç±»å‹ä¸­ï¼Œæ”¿åºœå¯ä»¥è‡ªç”±åœ°åˆ›é€ è´§å¸å’Œä¿¡è´·ã€‚åªè¦äººä»¬å¯¹è´§å¸æœ‰ä¿¡å¿ƒï¼Œè¿™ç§åšæ³•å°±æŒç»­æœ‰æ•ˆï¼Œåä¹‹åˆ™æ— æ•ˆã€‚</p><p>çºµè§‚å†å²ï¼Œå„å›½åœ¨è¿™äº›ä¸åŒç±»å‹çš„åˆ¶åº¦ä¹‹é—´è¿‡æ¸¡ï¼Œéƒ½æœ‰åˆä¹é€»è¾‘çš„åŸå› ã€‚å½“ä¸€ä¸ªå›½å®¶éœ€è¦çš„è´§å¸å’Œä¿¡è´·æ¯”ç°æœ‰æ•°é‡æ›´å¤šæ—¶ï¼Œæ— è®ºæ˜¯å‡ºäºåº”å¯¹å€ºåŠ¡ã€æˆ˜äº‰è¿˜æ˜¯å…¶ä»–åŸå› ï¼Œå®ƒè‡ªç„¶ä¼šä»ç¬¬ä¸€ç§ç±»å‹è¿‡æ¸¡åˆ°ç¬¬äºŒç§ç±»å‹ï¼Œæˆ–ä»ç¬¬äºŒç§ç±»å‹è¿‡æ¸¡åˆ°ç¬¬ä¸‰ç§ç±»å‹ï¼Œè¿™æ ·å®ƒå°±æœ‰äº†æ›´å¤šçš„å°é’çµæ´»æ€§ã€‚</p><p>æ­¤åï¼Œè¿‡å¤šçš„è´§å¸ä¾›åº”å’Œå€ºåŠ¡å¸¦æ¥äº†è´§å¸è´¬å€¼ï¼Œè‡´ä½¿äººä»¬ä¸å†æŒæœ‰å€ºåŠ¡å’Œè´§å¸ä½œä¸ºè´¢å¯Œå‚¨å¤‡ï¼Œè½¬è€Œå›æµåˆ°ç¡¬èµ„äº§ï¼ˆå¦‚é»„é‡‘ï¼‰å’Œå…¶ä»–è´§å¸ä¸­ã€‚é‰´äºè¿™ç§æƒ…å†µä¸€èˆ¬å‘ç”Ÿåœ¨äº§ç”Ÿè´¢å¯Œå†²çªæˆ–æˆ˜äº‰æ—¶æœŸï¼Œäººä»¬é€šå¸¸ä¹Ÿä¼šæƒ³é€ƒç¦»æ­¤åœ°ã€‚è¿™ç±»å›½å®¶éœ€è¦é‡æ–°å»ºç«‹èµ·ä»¥è´§å¸ä½œä¸ºè´¢å¯Œå‚¨å¤‡çš„ä¿¡å¿ƒï¼Œæ‰èƒ½æ¢å¤ä¿¡è´·å¸‚åœºã€‚</p><p>ä¸‹å›¾è¡¨è¾¾äº†ä¸Šè¿°ä¸åŒçš„è¿‡æ¸¡å†ç¨‹ã€‚ä»å®‹æœåˆ°é­ç›å¾·å›½ï¼Œå†å²ä¸Šæœ‰å¾ˆå¤šè¿™æ ·çš„ä¾‹å­ã€‚æœ‰å¾ˆå¤šå›½å®¶ä»çº¦æŸå‹è´§å¸ï¼ˆç¬¬ä¸€ç±»å’Œç¬¬äºŒç±»ï¼‰å…¨é¢è¿‡æ¸¡åˆ°æ³•å¸ï¼Œç„¶åéšç€æ—§çš„æ³•å¸è¶…å‘ï¼Œåˆå›åˆ°çº¦æŸå‹è´§å¸ã€‚</p><p><img src="https://i.loli.net/2020/05/03/sQkeWX7tDlzEGFn.png" alt="è¿‡æ¸¡å†ç¨‹"></p><p>å¦‚å‰æ‰€è¿°ï¼Œè¿™ä¸ªå·¨å¤§çš„å€ºåŠ¡å‘¨æœŸå°†ä¼šæŒç»­å¾ˆé•¿ä¸€æ®µæ—¶é—´â€”â€”å¤§çº¦50åˆ°75å¹´ã€‚åœ¨å‘¨æœŸç»“æŸæ—¶ï¼Œå…¶ç‰¹å¾æ˜¯å€ºåŠ¡å’Œè´§å¸ä½“ç³»çš„é‡ç»„ã€‚é‡ç»„çš„çªç„¶ä¹‹å¤„åœ¨äºï¼Œæ¯”å¦‚åœ¨å€ºåŠ¡å’Œè´§å¸å±æœºæ—¶æœŸï¼Œé‡ç»„é€šå¸¸å‘ç”Ÿå¾—å¾ˆå¿«ï¼Œä¸”ä»…æŒç»­æ•°æœˆè‡³ä¸‰å¹´ï¼Œå…·ä½“æ—¶é—´å–å†³äºæ”¿åºœé‡‡å–è¿™äº›æªæ–½æ‰€éœ€çš„æ—¶é—´ã€‚ç„¶è€Œï¼Œæ­¤åæ¶Ÿæ¼ªæ•ˆåº”å¯èƒ½æ˜¯é•¿æœŸçš„ã€‚</p><p>ä¾‹å¦‚ï¼Œè¿™æ ·çš„æƒ…å†µä¼šå¯¼è‡´å‚¨å¤‡è´§å¸ä¸å†æ˜¯å‚¨å¤‡è´§å¸ã€‚åœ¨è¿™äº›è´§å¸åˆ¶åº¦ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸¤åˆ°å››æ¬¡å¤§çš„å€ºåŠ¡å±æœºï¼Œå¤§åˆ°è¶³ä»¥å¯¼è‡´é“¶è¡Œä¸šå±æœºå’Œå€ºåŠ¡å‡è®°æˆ–è´¬å€¼30%ä»¥ä¸Šçš„é‚£ç§ï¼Œä½†è¿™è¿˜ä¸è¶³ä»¥æ‰“ç ´è´§å¸ä½“ç³»ã€‚</p><p>æˆ‘åœ¨è®¸å¤šå›½å®¶æŠ•èµ„äº†å¤§çº¦50å¹´ï¼Œç»å†äº†å‡ åæ¬¡å€ºåŠ¡å±æœºã€‚å®ƒä»¬çš„è¿è¡Œæ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘åœ¨ã€ŠPrinciples for Navigating Big Debt Crisesã€‹ä¸€ä¹¦ä¸­æ›¾å¯¹æ­¤è¿›è¡Œäº†æ›´æ·±å…¥çš„è§£é‡Šã€‚</p><h1 id="5-æ‹¥æœ‰å‚¨å¤‡è´§å¸ç»™ä¸€ä¸ªå›½å®¶å¸¦æ¥çš„ä¸å¯æ€è®®çš„åŠ›é‡"><a href="#5-æ‹¥æœ‰å‚¨å¤‡è´§å¸ç»™ä¸€ä¸ªå›½å®¶å¸¦æ¥çš„ä¸å¯æ€è®®çš„åŠ›é‡" class="headerlink" title="5. æ‹¥æœ‰å‚¨å¤‡è´§å¸ç»™ä¸€ä¸ªå›½å®¶å¸¦æ¥çš„ä¸å¯æ€è®®çš„åŠ›é‡"></a>5. æ‹¥æœ‰å‚¨å¤‡è´§å¸ç»™ä¸€ä¸ªå›½å®¶å¸¦æ¥çš„ä¸å¯æ€è®®çš„åŠ›é‡</h1><p>å‚¨å¤‡è´§å¸æ˜¯ä¸€ç§åœ¨ä¸–ç•ŒèŒƒå›´å†…è¢«å¹¿æ³›ç”¨ä½œäº¤æ¢åª’ä»‹å’Œè´¢å¯Œå‚¨å¤‡çš„è´§å¸ã€‚ä½¿ç”¨è¶Šå¹¿æ³›ã€å¯¹å…¶çš„ä¾èµ–ç¨‹åº¦è¶Šæ·±ï¼Œå‚¨å¤‡è´§å¸å’Œæ‹¥æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶çš„å®åŠ›ä¹Ÿå°±è¶Šå¼ºã€‚åœ¨æ­¤ï¼Œæˆ‘å†’ç€é‡å¤ä¸€äº›ä¹‹å‰è®²è¿‡çš„ä¸œè¥¿å¹¶è®©ä½ ä»¬è§‰å¾—æ— èŠçš„é£é™©æ¥å›é¡¾ä¸€ä¸‹ç¾å›½çš„æƒ…å†µï¼Œä»¥åŠè‡´ä½¿ç¾å›½å’Œç¾å…ƒè®©ä¸–ç•Œå˜æˆç°åœ¨è¿™æ ·çš„ç¯å¢ƒæƒ…å†µã€‚</p><p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œä¸–ç•Œæ–°ç§©åºå§‹äº1945å¹´ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ç»“æŸä¹‹åï¼Œè€Œå¸ƒé›·é¡¿æ£®æ—åå®šåœ¨1944å¹´ç¡®ç«‹äº†ç¾å…ƒä½œä¸ºä¸–ç•Œä¸»è¦å‚¨å¤‡è´§å¸çš„åœ°ä½ã€‚</p><p>ç¾å›½å’Œç¾å…ƒè‡ªç„¶è€Œç„¶åœ°ç¬¦åˆè¿™ä¸€è§’è‰²ï¼Œå› ä¸ºæˆ˜äº‰ç»“æŸæ—¶ï¼Œç¾å›½æ”¿åºœæŒæœ‰å…¨çƒçº¦ä¸‰åˆ†ä¹‹äºŒçš„é»„é‡‘ï¼ˆå½“æ—¶æ˜¯ä¸–ç•Œè´§å¸ï¼‰ï¼Œç¾å›½å ä¸–ç•Œç»æµäº§å‡ºçš„50%ï¼Œè¿˜åœ¨å†›äº‹ä¸Šå ä¸»å¯¼åœ°ä½ã€‚æ–°çš„è´§å¸åˆ¶åº¦å±äºç¬¬äºŒç±»ï¼ˆå³ç¡¬é€šè´§çš„å€ºæƒï¼‰ï¼Œå…¶ä»–å›½å®¶çš„å¤®è¡Œå¯ä»¥35ç¾å…ƒ/ç›å¸çš„ä»·æ ¼å°†â€œçº¸è´¨ç¾å…ƒâ€å…‘æ¢æˆé»„é‡‘ã€‚</p><p>å½“æ—¶ï¼Œä¸ªäººæŒæœ‰é»„é‡‘å±äºéæ³•ï¼Œå…¶åŸå› åœ¨äºæ”¿åºœé¢†å¯¼äººä¸æƒ³è®©é»„é‡‘ä½œä¸ºè´¢å¯Œå‚¨å¤‡æ¥ä¸è´§å¸å’Œä¿¡è´·ç«äº‰ã€‚æ‰€ä»¥ï¼Œåœ¨é‚£ä¸ªæ—¶å€™ï¼Œé»„é‡‘å°±æ˜¯é“¶è¡Œé‡Œçš„é’±ï¼Œè€Œçº¸å¸å°±åƒæ”¯ç¥¨ç°¿é‡Œçš„æ”¯ç¥¨ä¸€æ ·ï¼Œå¯ä»¥å…‘æ¢æˆçœŸé‡‘ç™½é“¶ã€‚</p><p>åœ¨è¿™ä¸ªå…¨æ–°è´§å¸ä½“ç³»å»ºç«‹çš„æ—¶å€™ï¼Œç¾å›½æ”¿åºœæ¯æŒæœ‰ä¸€ç›å¸é»„é‡‘å°±æ‹¥æœ‰50ç¾å…ƒçš„çº¸å¸ï¼Œæ‰€ä»¥å‡ ä¹100%æœ‰é»„é‡‘åšåç›¾ã€‚å…¶ä»–ä¸»è¦çš„ç¾å›½ç›Ÿå›½ï¼ˆå¦‚è‹±å›½ã€æ³•å›½å’Œè‹±è”é‚¦å›½å®¶ï¼‰æˆ–å—ç¾å›½æ§åˆ¶çš„å›½å®¶ï¼ˆå¾·å›½ã€æ—¥æœ¬å’Œæ„å¤§åˆ©ï¼‰éƒ½æœ‰å—ç¾å›½æ§åˆ¶çš„è´§å¸ä¸ç¾å…ƒæŒ‚é’©ã€‚</p><p>åœ¨æ­¤åçš„å‡ å¹´é‡Œï¼Œä¸ºäº†ç»™è‡ªå·±çš„æ´»åŠ¨æä¾›èµ„é‡‘ï¼Œç¾å›½æ”¿åºœçš„æ”¯å‡ºè¶…è¿‡äº†ç¨æ”¶æ”¶å…¥ï¼Œå› æ­¤ä¸å¾—ä¸å€Ÿé’±ï¼Œä»è€Œäº§ç”Ÿäº†æ›´å¤šä»¥ç¾å…ƒè®¡ä»·çš„å€ºåŠ¡ã€‚ç¾è”å‚¨æ‰€å…è®¸å»ºç«‹çš„é»„é‡‘å€ºæƒæ•°é‡ï¼ˆå¦‚ç¾å…ƒè®¡ä»·çš„è´§å¸å’Œä¿¡è´·ï¼‰ï¼Œè¿œè¿œè¶…è¿‡äº†èƒ½ä»¥35ç¾å…ƒä»·æ ¼å…‘æ¢æˆçš„é»„é‡‘å®é™…æ•°é‡ã€‚åœ¨çº¸å¸è¢«å…‘æ¢æˆç¡¬é€šè´§ï¼ˆé»„é‡‘ï¼‰ä¹‹åï¼Œç¾å›½é“¶è¡Œä¹‹ä¸­çš„é»„é‡‘æ•°é‡éšä¹‹ä¸‹é™ï¼Œé»„é‡‘å€ºæƒåˆ™ç»§ç»­ä¸Šå‡ã€‚å…¶ç»“æœå°±æ˜¯ï¼Œåœ¨1971å¹´8æœˆ15æ—¥ï¼Œå¸ƒé›·é¡¿æ£®æ—è´§å¸ä½“ç³»å´©æºƒäº†ã€‚</p><p>å½“æ—¶ï¼Œæ—¶ä»»ç¾å›½æ€»ç»Ÿå°¼å…‹æ¾å’Œ1933å¹´3æœˆ5æ—¥çš„ç½—æ–¯ç¦ä¸€æ ·ï¼Œæœªèƒ½å±¥è¡Œå½“å±€æ‰¿è¯ºï¼Œå³å…è®¸ç¾å…ƒæŒæœ‰è€…å°†å…¶å…‘æ¢æˆé»„é‡‘ã€‚äºæ˜¯ï¼Œç¾å…ƒå¯¹é»„é‡‘å’Œå’Œå…¶ä»–è´§å¸è´¬å€¼ã€‚è¿™æ—¶ï¼Œç¾å›½å’Œæ‰€æœ‰å›½å®¶éƒ½è¿›å…¥äº†ç¬¬ä¸‰ç§ç±»å‹ï¼Œæ³•å¸ä½“ç³»ã€‚å¦‚æœä½ æƒ³è¯»ä¸€è¯»æœ‰å…³å¦‚ä½•ä»æ—§è´§å¸ä½“ç³»åˆ°æ–°è´§å¸ä½“ç³»çš„ç²¾å½©è¿‡ç¨‹ï¼Œæˆ‘æ¨èä¿ç½—Â·æ²ƒå°”å…‹çš„ã€ŠChanging Fortunesã€‹ï¼Œåœ¨è°ˆåˆ¤ç¾å›½æ–°è´§å¸ä½“ç³»åº”è¯¥è¿ä½œæ—¶ï¼Œä»–æ˜¯é¦–å¸­è°ˆåˆ¤ä»£è¡¨ã€‚</p><p>è¿™ç§å‘æ³•å¸ä½“ç³»çš„è½¬å˜ä½¿ç¾è”å‚¨å’Œå…¶ä»–ä¸­å¤®é“¶è¡Œå¾—ä»¥åˆ›é€ å¤§é‡ä»¥ç¾å…ƒè®¡ä»·çš„è´§å¸å’Œä¿¡è´·ï¼Œä»è€Œå¯¼è‡´äº†1970å¹´ä»£çš„é€šè´§è†¨èƒ€ï¼Œå…¶ç‰¹ç‚¹æ˜¯ä»ç¾å…ƒå’Œç¾å…ƒå€ºé€ƒå‘å•†å“ã€æœåŠ¡ä»¥åŠé»„é‡‘ç­‰å¯ä»¥å¯¹å†²é€šèƒ€çš„èµ„äº§ã€‚è¿™ç§å¯¹ç¾å…ƒå€ºçš„ææ…Œæƒ…ç»ªè¿˜å¯¼è‡´äº†åˆ©ç‡èµ°é«˜ï¼Œå¹¶å°†é‡‘ä»·ä»1944å¹´è‡³1971å¹´æœŸé—´å›ºå®šçš„35ç¾å…ƒæ¨è‡³å½“æ—¶çš„å†å²é«˜ä½â€”â€”1980å¹´çš„670ç¾å…ƒã€‚</p><p>20ä¸–çºª70å¹´ä»£ï¼Œè´§å¸å’Œä¿¡è´·ä¸»è¦é€šè¿‡ä¸Šè¿°æ–¹å¼ç®¡ç†ã€‚è¿™æ—¶ï¼Œå€Ÿå…¥ç¾å…ƒå¹¶å°†å…¶è½¬æ¢ä¸ºå•†å“å’ŒæœåŠ¡æ˜¯æœ‰åˆ©å¯å›¾çš„ï¼Œæ‰€ä»¥è®¸å¤šå›½å®¶çš„è®¸å¤šå®ä½“éƒ½å¤§é‡é€šè¿‡ç¾å›½é“¶è¡Œå€Ÿå…¥ç¾å…ƒã€‚ç»“æœï¼Œä»¥ç¾å…ƒè®¡ä»·çš„å€ºåŠ¡åœ¨å…¨çƒèŒƒå›´å†…è¿…é€Ÿå¢é•¿ï¼Œè€Œç¾å›½é“¶è¡Œé€šè¿‡æŠŠç¾å…ƒæ”¾ç»™å€Ÿæ¬¾äººæ¥èµšäº†å¾ˆå¤šé’±ã€‚</p><p>è¿™ç§è´·æ¬¾å¯¼è‡´äº†å€ºåŠ¡å‘¨æœŸä¸­ç»å…¸çš„å€ºåŠ¡æ³¡æ²«ã€‚ææ…Œæƒ…ç»ªè®©äººé€ƒç¦»ç¾å…ƒå’Œç¾å…ƒå€ºèµ„äº§å¹¶è½¬å‘é€šèƒ€å¯¹å†²èµ„äº§ï¼Œå¿«é€Ÿå€Ÿå…¥ç¾å…ƒå’ŒèƒŒè´Ÿå€ºåŠ¡çš„é€Ÿåº¦ä¹Ÿåœ¨åŠ å¿«ã€‚è¿™å°±é€ æˆäº†1979-1982å¹´æœŸé—´çš„è´§å¸å’Œä¿¡è´·å±æœºã€‚</p><p>åœ¨é‚£æœŸé—´ï¼Œç¾å…ƒå’Œç¾å…ƒå€ºé¢ä¸´ç€ä¸å†æ‹…ä»»å…¬è®¤è´¢å¯Œå‚¨å¤‡çš„é£é™©ã€‚å½“ç„¶ï¼Œæ™®é€šè€ç™¾å§“å¹¶ä¸äº†è§£è¿™ç§è´§å¸å’Œä¿¡è´·çš„åŠ¨æ€æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œä½†ä»–ä»¬ä»¥é«˜é€šèƒ€å’Œé«˜åˆ©ç‡çš„å½¢å¼æ„Ÿå—åˆ°äº†å®ƒï¼Œè¿™å°±æˆäº†ä¸€ä¸ªå·¨å¤§çš„æ”¿æ²»é—®é¢˜ã€‚æ—¶ä»»æ€»ç»Ÿå¡ç‰¹å’Œå¤§å¤šæ•°æ”¿æ²»é¢†å¯¼äººä¸€æ ·å¹¶ä¸å¤ªäº†è§£è´§å¸æœºåˆ¶ï¼Œä½†ä»–çŸ¥é“å¿…é¡»åšç‚¹ä»€ä¹ˆæ¥é˜»æ­¢å±æœºï¼Œäºæ˜¯ä»»å‘½äº†ä¸€ä½å¼ºæœ‰åŠ›çš„è´§å¸æ”¿ç­–åˆ¶å®šè€…â€”â€”ä¿ç½—Â·æ²ƒå°”å…‹ã€‚</p><p>å‡ ä¹æ‰€æœ‰å…³æ³¨å±æœºçš„äººï¼ŒåŒ…æ‹¬æˆ‘åœ¨å†…ï¼Œéƒ½ä¼šæ³¨æ„å¬ä»–è¯´çš„æ¯ä¸€å¥è¯ã€‚ä»–è¶³å¤Ÿå¼ºå¤§ï¼Œèƒ½å¤Ÿåšä¸€äº›ä»¤äººç—›è‹¦ä½†æ­£ç¡®çš„äº‹æƒ…æ¥æ‰“ç ´é€šè´§è†¨èƒ€ã€‚ä»–æˆä¸ºäº†æˆ‘çš„è‹±é›„ï¼Œæœ€ç»ˆè¿˜å› å…¶å¾ˆæ£’çš„æ€§æ ¼å’Œå‡ºè‰²çš„èƒ½åŠ›ï¼Œæˆä¸ºäº†æˆ‘çš„å¥½æœ‹å‹ï¼Œæˆ‘ä¹Ÿå–œæ¬¢ä»–å†·å˜²å¼çš„å¹½é»˜ã€‚ </p><p>å¾·å›½å‰æ€»ç†èµ«å°”ç©†ç‰¹Â·æ–½å¯†ç‰¹è®¤ä¸ºï¼Œä¸ºäº†åº”å¯¹è¿™åœºè´§å¸é€šèƒ€å±æœºå¹¶æ‰“ç ´é€šè´§è†¨èƒ€ï¼Œæ²ƒå°”å…‹æ”¶ç´§äº†è´§å¸ä¾›åº”ï¼Œå°†åˆ©ç‡æ¨åˆ°äº†â€è‡ªè€¶ç¨£åŸºç£è¯ç”Ÿä»¥æ¥â€çš„æœ€é«˜æ°´å¹³ã€‚</p><p>å€ºåŠ¡äººå°±ä¸å¾—ä¸åœ¨æ”¶å…¥å’Œèµ„äº§è´¬å€¼çš„åŒæ—¶ï¼Œæ”¯ä»˜æ›´å¤šçš„å¿å€ºæ¬¾ã€‚ç”±æ­¤ï¼Œå€ºåŠ¡äººå—åˆ°å‹æ¦¨ï¼Œè¢«é€¼å‡ºå”®èµ„äº§ã€‚ç”±äºç¾å…ƒéœ€æ±‚å·¨å¤§ï¼Œç¾å…ƒèµ°å¼ºã€‚åŸºäºè¿™äº›åŸå› ï¼Œé€šè´§è†¨èƒ€ä¸‹é™ï¼Œç¾è”å‚¨éšä¹‹é™ä½åˆ©ç‡ï¼Œæ”¾æ¾äº†ç¾å›½äººçš„è´§å¸å’Œä¿¡è´·ã€‚</p><p>å½“ç„¶ï¼Œè®¸å¤šå€ºåŠ¡äººå’Œè´¬å€¼èµ„äº§æŒæœ‰äººéƒ½ç ´äº§äº†ã€‚å› æ­¤ï¼Œåœ¨80å¹´ä»£ï¼Œè¿™äº›å€ºåŠ¡äººï¼Œå°¤å…¶æ˜¯å¤–å›½å€ºåŠ¡äººï¼Œæ›´å°¤å…¶æ˜¯æ–°å…´å›½å®¶çš„å€ºåŠ¡äººï¼Œç»å†äº†é•¿è¾¾åå¹´çš„ç»æµè§æ¡å’Œå€ºåŠ¡é‡ç»„æ—¶æœŸã€‚ç¾è”å‚¨é€šè¿‡å‘ç¾å›½é“¶è¡Œæä¾›æ‰€éœ€çš„èµ„é‡‘æ¥ä¿æŠ¤ä»–ä»¬ï¼Œè€Œç¾å›½çš„ä¼šè®¡åˆ¶åº¦åˆ™ä¸è¦æ±‚é“¶è¡Œå°†è¿™äº›åè´¦ä½œä¸ºæŸå¤±æ¥æ ¸ç®—ï¼Œæˆ–æ— éœ€æŒ‰ç…§å®é™…ä»·æ ¼æ¥å¯¹è¿™äº›å€ºåŠ¡èµ„äº§è¿›è¡Œä¼°å€¼ï¼Œä»è€Œä¿æŠ¤ç¾å›½é“¶è¡Œå…äºç ´äº§ã€‚</p><p>è¿™ä¸€å€ºåŠ¡ç®¡ç†å’Œé‡ç»„è¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°1991å¹´ï¼Œæœ€åä»¥è¿æ¥ç”¨æ—¶ä»»ç¾å›½è´¢æ”¿éƒ¨é•¿å°¼å¤æ‹‰æ–¯Â·å¸ƒé›·è¿ªåå­—å‘½åçš„â€å¸ƒé›·è¿ªå€ºåˆ¸åè®®â€è€Œå‘Šç»ˆã€‚1971-1991å¹´æ•´ä¸ªå‘¨æœŸå‡ ä¹å½±å“äº†ä¸–ç•Œä¸Šæ‰€æœ‰çš„äººï¼Œè¿™æ˜¯ç¾å›½è„±ç¦»é‡‘æœ¬ä½çš„ç»“æœã€‚</p><p>å®ƒå¯¼è‡´äº†70å¹´ä»£çš„é€šèƒ€å’Œé€šèƒ€å¯¹å†²èµ„äº§çš„é£™å‡ï¼Œéšååˆå¸¦æ¥1979-1981å¹´çš„ç´§ç¼©ã€éç¾å€ºåŠ¡äººå¤§é‡çš„é€šç¼©å€ºåŠ¡é‡ç»„ã€é€šèƒ€ç‡ä¸‹é™ï¼Œä»¥åŠ1980å¹´ä»£å€ºåˆ¸å’Œå…¶ä»–é€šç¼©èµ„äº§çš„å‡ºè‰²è¡¨ç°ã€‚è¿™æ•´ä¸ªæ—¶æœŸéƒ½æœ‰åŠ›åœ°è¯æ˜äº†æ‹¥æœ‰ä¸–ç•Œå‚¨å¤‡è´§å¸çš„ç¾å›½å…·æœ‰æ€æ ·çš„åŠ›é‡ï¼Œä»¥åŠå‚¨å¤‡è´§å¸ç®¡ç†æ–¹å¼å¯¹ä¸–ç•Œå„å›½çš„å½±å“ã€‚</p><p>ä»1979-1981å¹´æœŸé—´ä»¥ç¾å…ƒè®¡ä»·çš„é€šè´§è†¨èƒ€ç‡å’Œåˆ©ç‡åŒåŒè¾¾åˆ°å³°å€¼åˆ°ç°åœ¨ï¼Œé€šèƒ€å’Œåˆ©ç‡éƒ½é™åˆ°äº†æ¥è¿‘0%ã€‚ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè‡ªæ–°çš„ç¾å…ƒè®¡ä»·è´§å¸ä½“ç³»å»ºç«‹ä»¥æ¥ï¼Œåˆ©ç‡å’Œé€šèƒ€æ•´ä¸ªå¤§å‹å‘¨æœŸçš„èµ·èµ·ä¼ä¼ã€‚</p><p><img src="https://i.loli.net/2020/05/03/QOHUyPVpERgM2AD.jpg" alt="é€šèƒ€åŠåˆ©ç‡çš„èµ·ä¼"></p><p>åœ¨æ•´ä¸ªè¿™æ®µæ—¶é—´é‡Œï¼Œä¸–ç•Œä¸Šä»¥ç¾å…ƒè®¡ä»·çš„è´§å¸ã€ä¿¡è´·å’Œå€ºåŠ¡ä»¥åŠå…¶ä»–éå€ºåŠ¡æ€§è´Ÿå€ºï¼ˆå¦‚å…»è€é‡‘å’ŒåŒ»ä¿ç­‰ï¼‰ç›¸å¯¹äºæ”¶å…¥è€Œè¨€æŒç»­ä¸Šå‡ã€‚å› ä¸ºç¾è”å‚¨æœ‰ç‹¬ç‰¹çš„èƒ½åŠ›æ¥æ”¯æ’‘è¿™ç§å€ºåŠ¡å¢é•¿ï¼Œä¸Šè¿°æƒ…å†µåœ¨ç¾å›½å°¤ä¸ºæ˜æ˜¾ã€‚</p><p>20ä¸–çºª80å¹´ä»£å€ºåŠ¡é‡ç»„å®Œæˆåï¼Œå…¨çƒè´§å¸ã€ä¿¡è´·å’Œå€ºåŠ¡çš„å…¨æ–°å¢é•¿åˆåœ¨90å¹´ä»£å¼€å§‹äº†ã€‚è¿™å†æ¬¡å¸¦æ¥äº†ç»æµç¹è£ï¼Œå¹¶ä¸”å¯¼è‡´æŠ•èµ„è€…ä¸¾å€ºè¿›è¡ŒæŠ•æœºæ€§æŠ•èµ„ï¼Œæœ€ç»ˆå½¢æˆåœ¨2000å¹´ç ´è£‚çš„ç§‘ç½‘æ³¡æ²«ã€‚</p><p>æ³¡æ²«çš„ç ´è£‚å¼•å‡ºäº†2000-2001å¹´çš„ç»æµè¡°é€€ï¼Œå¹¶åˆºæ¿€ç¾è”å‚¨æ”¾å®½è´§å¸å’Œä¿¡è´·ï¼Œå°†å€ºåŠ¡æ°´å¹³æ¨åˆ°äº†æ–°çš„é«˜ç‚¹ã€‚æ¥ä¸‹æ¥ï¼Œåˆä¸€æ¬¡çš„ç»æµç¹è£åˆ°æ¥ï¼Œå¦ä¸€ä¸ªæ›´å¤§çš„å€ºåŠ¡æ³¡æ²«åœ¨2007å¹´è¯ç”Ÿï¼Œäº2008å¹´ç ´è£‚ã€‚</p><p>äºæ˜¯ç¾è”å‚¨å’Œå…¶ä»–å‚¨å¤‡è´§å¸å›½å®¶çš„å¤®è¡Œå†æ¬¡å®½æ¾ï¼Œåˆå¸¦æ¥äº†è¿‘æœŸåˆšåˆšç ´è£‚çš„ä¸‹ä¸€ä¸ªæ³¡æ²«ã€‚ç„¶è€Œï¼Œè¿™ä¸€æ¬¡åˆ›é€ åº”å¯¹ç»æµè¡°é€€æ‰€éœ€è´§å¸å’Œä¿¡è´·çš„æ–¹å¼å´è¢«è®¾è®¡å¾—ååˆ†ä¸åŒã€‚</p><p>çŸ­æœŸåˆ©ç‡åœ¨2008å¹´è¾¾åˆ°0%ï¼Œè€Œè¿™ä¸ªé™æ¯çš„å¹…åº¦å°šæ— æ³•æ»¡è¶³è´§å¸å’Œä¿¡è´·æ‰©å¼ çš„éœ€è¦ã€‚é€šè¿‡é™æ¯åˆºæ¿€è´§å¸å’Œä¿¡è´·å¢é•¿æ˜¯å¤®è¡Œçš„é¦–é€‰è´§å¸æ”¿ç­–ã€‚æˆ‘ç§°å…¶ä¸ºâ€è´§å¸æ”¿ç­–1â€ã€‚éšç€è¿™ç§æ–¹æ³•ä¸å†é€‚ç”¨äºä¸­å¤®é“¶è¡Œï¼Œä»–ä»¬å°±è½¬å‘äº†ç¬¬äºŒé€‰æ‹©ï¼ˆæˆ‘ç§°ä¹‹ä¸ºâ€è´§å¸æ”¿ç­–2â€ï¼‰ï¼Œå³å°é’å’Œè´­ä¹°ä»¥å›½å€ºã€ä¼˜è´¨å€ºåŠ¡ä¸ºä¸»çš„é‡‘èèµ„äº§ã€‚</p><p>å¤®è¡Œä¸Šä¸€æ¬¡éœ€è¦è¿™æ ·åšï¼Œæ˜¯å› ä¸ºåˆ©ç‡ä»1933å¹´å¼€å§‹è§¦åŠ0%ï¼Œä¸”åœ¨æˆ˜äº‰å¹´ä»£ä¹Ÿä¸€ç›´ä¿æŒé›¶åˆ©ç‡ã€‚è¿™ç§åšæ³•è¢«ç§°ä¸ºâ€é‡åŒ–å®½æ¾â€è€Œä¸æ˜¯â€å€ºåŠ¡è´§å¸åŒ–â€ï¼Œæ˜¯å› ä¸ºQEå¬èµ·æ¥æ²¡æœ‰é‚£ä¹ˆå¤§çš„å¨èƒæ€§ã€‚ä¸–ç•Œä¸Šæ‰€æœ‰çš„ä¸»è¦å‚¨å¤‡è´§å¸å¤®è¡Œéƒ½å·²ç»è¿™ä¹ˆåšäº†ã€‚</p><p>è¿™å°±å¸¦æ¥äº†ä¸‹ä¸€ä¸ªè´§å¸/ä¿¡è´·/ç»æµèŒƒå¼ï¼Œç›´åˆ°æˆ‘ä»¬ç°åœ¨ç»å†çš„ç»æµè¡°é€€ä¹‹å‰ï¼Œè¿™ä¸€èŒƒå¼ä¸€ç›´åœ¨æŒç»­ã€‚</p><p>è‡ª2008å¹´å¼€å§‹çš„è¿™ä¸€èŒƒå¼æ˜¯è¿™æ ·çš„ã€‚</p><p>æ­£å¦‚ä»1933å¹´å¼€å§‹æ‰€åšçš„é‚£æ ·ï¼Œå¤®è¡Œé€šè¿‡å°é’å’Œè´­ä¹°å€ºåˆ¸ç»´æŒäº†è´§å¸å’Œå€ºåŠ¡æ‰©å¼ å‘¨æœŸã€‚</p><p>é€šè¿‡è´­ä¹°å€ºåˆ¸ï¼Œå¤®è¡Œæ¨é«˜äº†å€ºåˆ¸ä»·æ ¼ï¼Œå¹¶ä¸ºè¿™äº›å€ºåˆ¸çš„å–å®¶æä¾›ç°é‡‘ï¼Œè‡´ä½¿ä»–ä»¬å»è´­ä¹°å…¶ä»–èµ„äº§ã€‚è¿™å°±æ¨é«˜äº†å…¶ä»–èµ„äº§çš„ä»·æ ¼ï¼Œè€Œéšç€è¿™äº›èµ„äº§ä»·æ ¼ä¸Šæ¶¨ï¼Œæœªæ¥çš„é¢„æœŸå›æŠ¥ç‡éšä¹‹ä¸‹é™ã€‚</p><p>ç”±äºåˆ©ç‡ä½äºå…¶ä»–æŠ•èµ„çš„é¢„æœŸå›æŠ¥ç‡ï¼Œè€Œç›¸å¯¹äºæŠ•èµ„è€…ä¸ºå…¶å„ç§æ”¯å‡ºä¹‰åŠ¡æä¾›èµ„é‡‘æ‰€éœ€çš„å›æŠ¥ç‡è€Œè¨€ï¼Œå€ºåˆ¸æ”¶ç›Šç‡å’Œå…¶ä»–æœªæ¥é¢„æœŸå›æŠ¥ç‡çš„æ°´å¹³éƒ½å¾ˆä½ï¼Œå› æ­¤ï¼ŒæŠ•èµ„è€…è¶Šæ¥è¶Šé¢‘ç¹åœ°å€Ÿé’±è´­ä¹°ä»–ä»¬è®¤ä¸ºæ”¶ç›Šå°†é«˜äºå€Ÿè´·æˆæœ¬çš„èµ„äº§ã€‚</p><p>è¿™æ—¢æ¨é«˜äº†ä¸Šè¿°èµ„äº§çš„ä»·æ ¼ï¼Œåˆé€ æˆäº†æ–°çš„å€ºåŠ¡æ³¡æ²«è„†å¼±æ€§â€”â€”å¦‚æœä»–ä»¬æ‰€è´­èµ„äº§æ”¶ç›Šä½äºå…¶å€Ÿè´·æˆæœ¬ï¼Œå°±ä¼šäº§ç”Ÿæ–°çš„å€ºåŠ¡æ³¡æ²«ã€‚ç”±äºé•¿æœŸå’ŒçŸ­æœŸåˆ©ç‡éƒ½åœ¨0%å·¦å³ï¼Œè€Œä¸”å¤®è¡Œè´­ä¹°å€ºåˆ¸çš„èµ„é‡‘æ— æ³•åˆºæ¿€ç»æµå¢é•¿å’Œå¸®åŠ©é‚£äº›æœ€éœ€è¦å¸®åŠ©çš„äººï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ç¬¬äºŒç§è´§å¸æ”¿ç­–æ˜¾ç„¶ä¸èƒ½å¾ˆå¥½åœ°å‘æŒ¥ä½œç”¨ï¼Œè¿™å°±éœ€è¦ç¬¬ä¸‰ç§è´§å¸æ”¿ç­–â€”â€”â€œè´§å¸æ”¿ç­–3â€ã€‚</p><p>â€œè´§å¸æ”¿ç­–3â€çš„å·¥ä½œåŸç†æ˜¯ï¼Œå‚¨å¤‡è´§å¸ä¸­å¤®æ”¿åºœå¢åŠ å€Ÿè´·ï¼Œå¹¶å°†å…¶æ”¯å‡ºå’Œè´·æ¬¾çš„ç›®æ ‡å®šåœ¨ä»–ä»¬æƒ³è¦çš„åœ°æ–¹ï¼Œè€Œå‚¨å¤‡è´§å¸ä¸­å¤®é“¶è¡Œåˆ™åˆ›é€ è´§å¸å’Œä¿¡è´·ï¼Œå¹¶è´­ä¹°å€ºåŠ¡ï¼ˆå¯èƒ½è¿˜æœ‰å…¶ä»–èµ„äº§ï¼Œå¦‚è‚¡ç¥¨ï¼‰æ¥æä¾›èµ„é‡‘ã€‚è™½ç„¶æˆ‘ä¸ä¼šåœ¨è¿™é‡Œè§£é‡Šå„ç§æ–¹æ³•ï¼Œä½†åœ¨æˆ‘çš„ä¹¦ã€ŠPrinciples for Navigating Big Debt Crisesã€‹å½“ä¸­å·²ç»è§£é‡Šè¿‡äº†ã€‚</p><p>å› æ­¤ï¼Œåœ¨ç–«æƒ…å¼•å‘ç»æµè¡°é€€ä¹‹å‰ï¼Œæˆ‘ä»¬å°±å·²ç»åšå¥½äº†å‡†å¤‡ï¼šä¸€æ—¦ç»æµæ»‘å…¥è¡°é€€ï¼Œå°±å¿…é¡»èµ°è¿™æ¡è·¯ã€‚å¦‚æœä½ æƒ³è¦çœ‹æˆ‘æ›´ä¸ºæ·±å…¥åœ°ç ”ç©¶ç›¸å…³è¯é¢˜çš„æ–‡ç« ï¼Œå¯ä»¥ç‚¹å‡»economicprinciples.orgã€‚</p><p>æ— è®ºå¦‚ä½•ï¼Œåœ¨è¿™æ®µæ—¶æœŸå†…ï¼Œå€ºåŠ¡å’Œéå€ºåŠ¡æ€§è´Ÿå€ºï¼ˆå¦‚å…»è€é‡‘å’ŒåŒ»ä¿ï¼‰ç›¸å¯¹äºæ”¶å…¥è€Œè¨€ç»§ç»­ä¸Šå‡ï¼Œè€Œä¸­å¤®é“¶è¡Œè®¾æ³•å‹ä½äº†å¿å€ºæˆæœ¬ï¼ˆè¯¦è§æˆ‘çš„æŠ¥å‘Šâ€The Big Pictureâ€ï¼Œé‡Œé¢å¯¹æ­¤ä¸¾æ‰€å¯¼è‡´çš„ã€å³å°†åˆ°æ¥çš„â€œæŒ¤å…‘â€è§£é‡Šå¾—æ›´å®Œæ•´ï¼‰ã€‚</p><p>è¿™å°±æŠŠåˆ©ç‡æ¨å‘äº†é›¶ï¼Œå¹¶ä½¿å€ºåŠ¡é•¿æœŸåŒ–ï¼Œä»è€Œä½¿æœ¬é‡‘å¿ä»˜æ°´å¹³é™ä½ã€‚è¯¸å¦‚ä¸­å¤®é“¶è¡Œæ‹¥æœ‰å¤§é‡çš„å€ºåŠ¡ã€åˆ©ç‡åœ¨0%å·¦å³å› æ­¤ä¸éœ€è¦æ”¯ä»˜åˆ©æ¯ã€æ„å»ºå¯ä»¥é•¿æœŸå¿è¿˜çš„å€ºåŠ¡å¹¶ä½¿æœ¬é‡‘å¯ä»¥åˆ†æ•£å¿è¿˜ç”šè‡³ä¸ç”¨å¿è¿˜ä¹‹ç±»çš„æ¡ä»¶ï¼Œæ„å‘³ç€ä¸­å¤®é“¶è¡Œåˆ›é€ è´§å¸å’Œä¿¡è´·çš„èƒ½åŠ›å‡ ä¹æ²¡æœ‰é™åˆ¶ã€‚è¿™ä¸€ç³»åˆ—çš„æ¡ä»¶ä¸ºæ¥ä¸‹æ¥çš„äº‹æƒ…å¥ å®šäº†åŸºç¡€ã€‚</p><p>æ–°å† ç–«æƒ…å¼•å‘äº†ä¸–ç•Œå„åœ°çš„ç»æµå’Œå¸‚åœºè¡°é€€ï¼Œé€ æˆäº†æ”¶å…¥å’Œèµ„äº§è´Ÿå€ºè¡¨æ–¹é¢çš„çªŸçª¿ï¼Œç‰¹åˆ«æ˜¯å¯¹é‚£äº›æ”¶å…¥å—åˆ°è¡°é€€å½±å“çš„è´Ÿå€ºå®ä½“æ¥è¯´ï¼Œæ›´æ˜¯å¦‚æ­¤ã€‚</p><p>ä¼ ç»Ÿä¸Šï¼Œä¸­å¤®æ”¿åºœå’Œå¤®è¡Œå¿…é¡»åˆ›é€ è´§å¸å’Œä¿¡è´·ï¼Œæ‰èƒ½æŠŠé’±å’Œä¿¡è´·é€åˆ°ä»–ä»¬æƒ³æ•‘çš„å®ä½“æ‰‹ä¸­ã€‚å¦‚æœæ²¡æœ‰è¿™äº›é’±å’Œä¿¡è´·ï¼Œè¿™äº›å®ä½“åœ¨è´¢åŠ¡ä¸Šæ˜¯æ— æ³•ç”Ÿå­˜çš„ã€‚</p><p>ç”±æ­¤ï¼Œ2020å¹´4æœˆ9æ—¥ï¼Œç¾å›½ä¸­å¤®æ”¿åºœï¼ˆæ€»ç»Ÿå’Œå›½ä¼šï¼‰å’Œç¾å›½å¤®è¡Œï¼ˆç¾è”å‚¨ï¼‰å®£å¸ƒäº†ä¸€é¡¹å¤§è§„æ¨¡çš„è´§å¸å’Œä¿¡ç”¨åˆ›é€ è®¡åˆ’ï¼Œé‡‡ç”¨äº†â€œè´§å¸æ”¿ç­–3â€ä¹‹ä¸­æ‰€æœ‰ç»å…¸çš„æ‰‹æ³•ï¼ŒåŒ…æ‹¬ç›´å‡æœºæ’’é’±ï¼ˆæ”¿åºœç›´æ¥ç»™å…¬æ°‘å‘é’±ï¼‰ã€‚</p><p>è¿™åŸºæœ¬ä¸Šä¸ç½—æ–¯ç¦åœ¨1933å¹´3æœˆ5æ—¥å®£å¸ƒçš„è®¡åˆ’æ˜¯ä¸€æ ·çš„ã€‚è™½ç„¶æ˜¯ç–«æƒ…å¼•å‘äº†è¿™æ¬¡ç‰¹æ®Šçš„é‡‘èå’Œç»æµè¡°é€€ï¼Œä½†å°±ç®—æ²¡æœ‰ç–«æƒ…ï¼Œå…¶ä»–ä¸œè¥¿æœ€ç»ˆä¹Ÿä¼šè§¦å‘è¡°é€€ã€‚</p><p>æ— è®ºè¡°é€€çš„èµ·å› æ˜¯ä»€ä¹ˆï¼Œä½†åŠ¨åŠ›åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºåªæœ‰â€œè´§å¸æ”¿ç­–3â€æ‰ä¼šèµ·åˆ°æ‰­è½¬ç»æµè¡°é€€çš„ä½œç”¨ã€‚æ¬§æ´²å¤®è¡Œã€æ—¥æœ¬å¤®è¡Œä»¥åŠä¸­å›½äººæ°‘é“¶è¡Œä¹Ÿéƒ½é‡‡å–äº†ç±»ä¼¼æªæ–½ï¼Œä¸è¿‡æœ€é‡è¦çš„ä»æ˜¯ç¾è”å‚¨çš„ä¸¾åŠ¨ï¼Œå› ä¸ºå®ƒæ˜¯ç¾å…ƒçš„åˆ›é€ è€…ï¼Œè€Œç¾å…ƒä»ç„¶æ˜¯ä¸–ç•Œä¸Šå ä¸»å¯¼åœ°ä½çš„è´§å¸å’Œä¿¡è´·ã€‚</p><p>ç›®å‰ï¼Œç¾å…ƒåœ¨å…¨çƒçš„å›½é™…äº¤æ˜“ã€å‚¨è“„ã€å€Ÿè´·ä¸­çº¦å 55%ã€‚æ¬§å…ƒåŒºçš„æ¬§å…ƒçº¦å 25%ã€‚æ—¥å…ƒå æ¯”ä¸åˆ°10%ã€‚ä¸­å›½çš„äººæ°‘å¸å 2%å·¦å³ã€‚å…¶ä»–å¤§å¤šæ•°è´§å¸éƒ½æ²¡æœ‰åœ¨å›½é™…ä¸Šç”¨ä½œäº¤æ¢åª’ä»‹å’Œè´¢å¯Œå‚¨å­˜æ‰‹æ®µï¼Œä»…åœ¨å„å›½å›½å†…ä½¿ç”¨ã€‚</p><p>æ— è®ºæ˜¯ä¸Šè¿°å„å›½å›½å†…çš„èªæ˜äººï¼Œè¿˜æ˜¯è¿™äº›å›½å®¶ä»¥å¤–çš„å‡ ä¹æ‰€æœ‰äººï¼Œéƒ½ä¸ä¼šæŒæœ‰è¿™éƒ¨åˆ†è´§å¸å¹¶å°†å…¶ä½œä¸ºè´¢å¯Œå‚¨å¤‡ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘æåˆ°çš„å‚¨å¤‡è´§å¸ï¼Œå°±æ˜¯å…¨ä¸–ç•Œå¤§å¤šæ•°äººå–œæ¬¢å‚¨è“„ã€å€Ÿè´·ã€äº¤æ˜“çš„è´§å¸ï¼Œå¤§è‡´æ¯”ä¾‹å’Œæˆ‘ä¸Šæ–‡æ‰€è¯´çš„ç›¸åŒã€‚</p><p>æ‹¥æœ‰ä¸–ç•Œå‚¨å¤‡è´§å¸çš„å›½å®¶æ‹¥æœ‰æƒŠäººçš„åŠ›é‡â€”â€”å‚¨å¤‡è´§å¸å¯èƒ½æ˜¯æœ€é‡è¦çš„åŠ›é‡ï¼Œé‡è¦ç¨‹åº¦ç”šè‡³è¶…è¿‡å†›äº‹åŠ›é‡ã€‚</p><p>è¿™æ˜¯å› ä¸ºå½“ä¸€ä¸ªå›½å®¶æ‹¥æœ‰å‚¨å¤‡è´§å¸æ—¶ï¼Œå®ƒå¯ä»¥åœ¨åˆé€‚çš„æ—¶å€™åƒç¾å›½ç°åœ¨è¿™æ ·å°é’±ã€å€Ÿé’±æ¥æ¶ˆè´¹ï¼Œè€Œé‚£äº›æ²¡æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶åˆ™å¿…é¡»å…ˆè·å¾—ä»–ä»¬æ‰€éœ€è¦çš„é’±å’Œä¿¡è´·ï¼ˆä»¥ä¸–ç•Œå‚¨å¤‡è´§å¸è®¡ä»·ï¼‰æ‰èƒ½è¿›è¡Œäº¤æ˜“å’Œå‚¨è“„ã€‚</p><p>æ¯”å¦‚è¯´ç°åœ¨ï¼Œæˆªæ­¢å‘ç¨¿ï¼Œé‚£äº›æœ‰å¾ˆå¤šå€ºåŠ¡éœ€è¦å¿è¿˜çš„äººå¯¹ç¾å…ƒçš„éœ€æ±‚å¾ˆå¼ºï¼Œå› å…¶éœ€è¦æ›´å¤šçš„ç¾å…ƒæ¥è´­ä¹°å•†å“å’ŒæœåŠ¡ï¼Œä½†ä»–ä»¬çš„ç¾å…ƒæ”¶å…¥å·²ç»ä¸‹é™ã€‚</p><p>æ­£å¦‚ç« èŠ‚ä¸€ä¸­è¡¨æ˜è¡¡é‡ä¸€å›½å›½åŠ›ä¸Šå‡å’Œä¸‹é™çš„å…«é¡¹æŒ‡æ ‡çš„å›¾è¡¨æ‰€ç¤ºï¼Œå‚¨å¤‡è´§å¸å®åŠ›ï¼ˆä»¥è¯¥è´§å¸çš„äº¤æ˜“å’Œå‚¨è“„ä»½é¢æ¥è¡¡é‡ï¼‰æ˜æ˜¾è½åäºè¡¡é‡å›½å®¶å®åŠ›çš„å…¶ä»–æŒ‡æ ‡ã€‚ç¾å›½å’Œç¾å…ƒçš„æƒ…å†µä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨1944å¹´ï¼Œå½“ç¾å…ƒè¢«é€‰å®šä¸ºå…¨çƒä¸»è¦å‚¨å¤‡è´§å¸æ—¶ï¼Œç¾å›½æ”¿åºœæŒæœ‰çš„é»„é‡‘å å…¨çƒé»„é‡‘æ€»é‡çš„çº¦ä¸‰åˆ†ä¹‹äºŒï¼ˆé»„é‡‘å½“æ—¶è¢«è§†ä¸ºè´§å¸ï¼‰ï¼Œç¾å›½ç»æµåˆ™çº¦å å…¨çƒGDPçš„ä¸€åŠã€‚</p><p>å¦‚ä»Šï¼Œç¾å›½GDPåªå å…¨çƒçš„20%å·¦å³ï¼Œä½†ç¾å…ƒä»å å…¨çƒå¤–æ±‡å‚¨å¤‡çš„60%å·¦å³ï¼Œè¿˜å æœ‰å›½é™…äº¤æ˜“é‡çš„åŠå£æ±Ÿå±±ã€‚æ‰€ä»¥ï¼Œç¾å…ƒå’Œä»¥ç¾å…ƒä¸ºåŸºç¡€çš„è´§å¸å’Œæ”¯ä»˜ä½“ç³»ä»ç„¶å æ®ç€è‡³é«˜æ— ä¸Šçš„åœ°ä½ï¼Œç›¸å¯¹äºç¾å›½ç»æµçš„è§„æ¨¡è€Œè¨€ï¼Œå®ƒçš„è§„æ¨¡è¿˜æ˜¯ç‰¹å¤§å·ã€‚</p><p>å’Œæ‰€æœ‰å°åˆ¶å‚¨å¤‡è´§å¸çš„é“¶è¡Œä¸€æ ·ï¼Œç¾è”å‚¨ç°åœ¨å¤„äºå¼ºåŠ¿ä½†å°´å°¬çš„åœ°ä½ã€‚å…¶è´§å¸æ”¿ç­–çš„è¿è¡Œæ–¹å¼å¯¹ç¾å›½äººæœ‰åˆ©ï¼Œä½†å¯¹ä¸–ç•Œä¸Šå…¶ä»–ä¾èµ–ç¾å…ƒçš„å›½å®¶æ¥è¯´ï¼Œå¯èƒ½å¹¶ä¸æ˜¯å¥½äº‹ã€‚</p><p>æ¯”å¦‚ç¾å›½ä¸­å¤®æ”¿åºœæœ€è¿‘åˆšåˆšå†³å®šï¼Œå°†å€Ÿè´·ç»™ç¾å›½äººå‘æ”¾ç¾å…ƒå’Œç¾å…ƒä¿¡è´·ï¼Œç¾è”å‚¨åˆ™å†³å®šè´­ä¹°ç¾å›½æ”¿åºœçš„é‚£ç¬”å›½å€ºå’Œç¾å›½äººå…¶ä»–çš„å€ºåŠ¡ï¼Œå¸®åŠ©ä»–ä»¬åº¦è¿‡è¿™æ¬¡é‡‘èå±æœºã€‚å¯ä»¥ç†è§£çš„æ˜¯ï¼Œè¿™äº›é’±å‡ ä¹æ²¡æœ‰å¤šå°‘ä¼šæµå‘å¤–å›½äººã€‚</p><p>æ¬§æ´²å¤®è¡Œä¹Ÿå°†å¯¹æ¬§å…ƒåŒºå›½å®¶é‡‡å–ç±»ä¼¼æªæ–½ã€‚ä¸–ç•Œå½±å“åŠ›ä»æ—§è¾ƒå°çš„æ—¥æœ¬å¤®è¡Œä¹Ÿä¼šä¸ºæ—¥æœ¬äººåšåŒæ ·çš„äº‹æƒ…ï¼Œä¸­å›½äººæ°‘é“¶è¡ŒåŒæ ·ä¼šä¸ºä¸­å›½äººåšç±»ä¼¼çš„äº‹æƒ…ã€‚</p><p>å…¶ä»–å‡ ä¸ªç›¸å¯¹è¾ƒå°çš„å›½å®¶ï¼ˆå¦‚ç‘å£«ï¼‰ä¹Ÿè®¸å¯ä»¥ä¸ºæœ¬å›½äººæ°‘åšç±»ä¼¼çš„äº‹æƒ…ï¼Œä½†ä¸–ç•Œä¸Šå¤§å¤šæ•°äººæ— æ³•åƒç¾å›½äººé‚£æ ·ï¼Œå¾—åˆ°ä»–ä»¬æ‰€éœ€è¦çš„é’±å’Œä¿¡è´·æ¥å¡«è¡¥æ”¶å…¥å’Œèµ„äº§è´Ÿå€ºè¡¨çš„çªŸçª¿ã€‚</p><p>è¿™ä¸€åŠ¨æ€ï¼Œå³å›½å®¶æ— æ³•è·å¾—ä»–ä»¬æ‰€éœ€è¦çš„ç¡¬é€šè´§å°±åƒ1982-1991å¹´æœŸé—´å‘ç”Ÿçš„äº‹æƒ…ä¸€æ ·ï¼Œåªæ˜¯è¿™æ¬¡æ— æ³•å†é å¤§å¹…å‰Šå‡åˆ©ç‡è§£å†³é—®é¢˜ï¼Œè€Œé‚£ä¸ªæ—¶å€™å¯ä»¥ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼Œéç¾å›½äººï¼ˆå³æ–°å…´å¸‚åœºã€æ¬§æ´²å›½å®¶å’Œä¸­å›½ï¼‰æŒæœ‰çš„ç¾å…ƒå€ºæ€»é¢çº¦ä¸º20ä¸‡äº¿ç¾å…ƒï¼ˆæ¯”2008å¹´æ—¶é«˜50%å·¦å³ï¼‰ï¼Œå…¶ä¸­çŸ­æœŸå€ºåŠ¡ä¸åˆ°ä¸€åŠã€‚è¿™äº›ç¾å…ƒå€ºåŠ¡äººå°†ä¸å¾—ä¸æ‹¿å‡ºç¾å…ƒæ¥å¿è¿˜è¿™äº›å€ºåŠ¡ï¼Œè¿˜è¦æ‹¿å‡ºæ›´å¤šçš„ç¾å…ƒæ¥åœ¨ä¸–ç•Œå¸‚åœºä¸Šè´­ä¹°å•†å“å’ŒæœåŠ¡ã€‚</p><p>æ‰€ä»¥ï¼Œé€šè¿‡æ‹¥æœ‰ç¾å…ƒä½œä¸ºä¸–ç•Œå‚¨å¤‡è´§å¸å¹¶æ‹¥æœ‰ç”Ÿäº§è¿™ç§è´§å¸çš„é“¶è¡Œï¼Œä¸”æ‹¥æœ‰æŠŠè¿™äº›æ€¥éœ€çš„ç¾å…ƒæ”¾å…¥ç¾å›½äººæ‰‹ä¸­çš„å®åŠ›ï¼Œç¾å›½å°±å¯ä»¥æ¯”å…¶ä»–å›½å®¶çš„æ”¿åºœæ›´æœ‰æ•ˆåœ°å¸®åŠ©æœ¬å›½å…¬æ°‘ã€‚</p><p>åŒæ—¶ï¼Œç¾å›½ä¹Ÿæœ‰å¯èƒ½ä¼šå› ä¸ºåˆ¶é€ äº†å¤ªå¤šçš„è´§å¸å’Œå€ºåŠ¡è€Œå¤±å»è¿™ç§ç‰¹æƒåœ°ä½ã€‚åœ¨æœ¬ç« çš„é™„å½•ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°ç ”ç©¶æ›¾ç»æ‹¥æœ‰å‚¨å¤‡è´§å¸çš„å›½å®¶æ˜¯å¦‚ä½•å¤±å»å‚¨å¤‡è´§å¸çš„ï¼Œä»¥åŠè´§å¸è´¬å€¼æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚</p><h1 id="6-Summary"><a href="#6-Summary" class="headerlink" title="6. Summary"></a>6. Summary</h1><p>å›è¿‡å¤´æ¥ä»å¤§æ ¼å±€çš„è§’åº¦çœ‹è¿™ä¸€åˆ‡ï¼Œæˆ‘æƒ³è°ˆè®ºçš„å…³ç³»åŒ…æ‹¬1ï¼‰ç»æµä¹‹é—´ï¼ˆå³è´§å¸ã€ä¿¡è´·ã€å€ºåŠ¡ã€ç»æµæ´»åŠ¨å’Œè´¢å¯Œï¼‰å’Œ2ï¼‰æ”¿æ²»ä¹‹é—´ï¼ˆå›½å®¶å†…éƒ¨å’Œå„å›½ä¹‹é—´ï¼‰ï¼Œå…·ä½“èµ·èµ·è½è½å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://i.loli.net/2020/05/03/YEnmcZpRXAota3T.png" alt="å€ºåŠ¡å‘¨æœŸ"></p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤§çš„å‘¨æœŸå§‹äºä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œç§©åºï¼Œå³ä¸€ç§å›Šæ‹¬å…¨æ–°è´§å¸ä½“ç³»å’Œæ”¿æ²»åˆ¶åº¦ã€åŒ…å«å›½å†…å’Œå›½é™…è¿ä½œçš„ä¸€ç§å…¨æ–°æ–¹å¼ã€‚æœ€è¿‘çš„ä¸€æ¬¡å¤§å‘¨æœŸå§‹äº1945å¹´ã€‚</p><p>å› ä¸ºåœ¨é‚£æ ·çš„æ—¶æœŸï¼Œå†²çªä¹‹åå‡ºç°äº†å…·æœ‰ä¸»å¯¼åŠ›é‡çš„å¤§å›½ï¼Œå¤§å®¶éƒ½ä¸æ„¿æ„æ‰“ä»—ï¼Œäººä»¬ä¹ŸåŒå€¦äº†æˆ˜æ–—ï¼Œäºæ˜¯å°±æœ‰äº†å’Œå¹³é‡å»ºå’Œæ—¥ç›Šç¹è£çš„å±€é¢ï¼Œè€Œè¿™ç§ç¹è£æ˜¯ç”±å¯æŒç»­çš„ä¿¡è´·æ‰©å¼ æ¥æ”¯æ’‘çš„ã€‚</p><p>ä¹‹æ‰€ä»¥è¯´æ˜¯å¯æŒç»­çš„ï¼Œæ˜¯å› ä¸ºæ”¶å…¥çš„å¢é•¿è¶…è¿‡æˆ–è·Ÿä¸Šäº†å¿è¿˜ä¸æ–­å¢é•¿çš„å€ºåŠ¡æ‰€éœ€çš„å¿å€ºæ”¯å‡ºï¼Œä¹Ÿæ˜¯å› ä¸ºå¤®è¡Œæœ‰èƒ½åŠ›åˆºæ¿€ä¿¡è´·ï¼Œç»æµå¢é€Ÿä¹Ÿå¾ˆå¼ºåŠ²ã€‚ä¸€è·¯èµ°æ¥ï¼Œè¿‡ç¨‹ä¸­ä¼šå‡ºç°çŸ­æœŸçš„å€ºåŠ¡å’Œç»æµå‘¨æœŸï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè¡°é€€å’Œæ‰©å¼ ã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒæŠ•èµ„è€…ä»¥è¿‡å»çš„æ”¶ç›Šæ¨æ–­æœªæ¥ï¼Œå¹¶å€Ÿé’±æ¥æŠ¼æ³¨æ”¶ç›Šå¯ä»¥å®ç°ã€‚è¿™å°±åœ¨è´«å¯Œå·®è·æ‰©å¤§ï¼ˆæœ‰äº›äººçš„æ”¶ç›Šæ¯”å…¶ä»–äººæ›´å¤šï¼‰çš„åŒæ—¶äº§ç”Ÿäº†å€ºåŠ¡æ³¡æ²«ã€‚è¿™ç§æƒ…å†µå°†ä¸€ç›´æŒç»­ä¸‹å»ï¼Œç›´åˆ°å„å›½å¤®è¡Œè€—å°½ä¸€åˆ‡æœ‰æ•ˆåˆºæ¿€ä¿¡è´·å’Œç»æµå¢é•¿çš„èƒ½åŠ›ã€‚</p><p>éšç€è´§å¸ç´§ç¼©ï¼Œå€ºåŠ¡æ³¡æ²«ç ´è£‚ï¼Œä¿¡è´·æ”¶ç¼©ï¼Œç»æµä¹Ÿéšä¹‹èç¼©ã€‚åŒæ—¶ï¼Œå½“å‡ºç°å·¨å¤§çš„è´«å¯Œå·®è·ã€ä¸¥é‡çš„å€ºåŠ¡é—®é¢˜ä¸”ç»æµèç¼©æ—¶ï¼Œå›½å®¶å†…éƒ¨å’Œå›½å®¶ä¹‹é—´å¾€å¾€ä¼šå‘ç”Ÿäº‰å¤ºè´¢å¯Œå’ŒæƒåŠ›çš„æ–—äº‰ã€‚</p><p>åœ¨å€ºåŠ¡å’Œç»æµå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œä¸­å¤®æ”¿åºœå’Œä¸­å¤®é“¶è¡Œé€šå¸¸ä¼šå‘è¡Œè´§å¸å’Œä¿¡è´·ï¼Œå¹¶æœ‰å¯èƒ½ä½¿æœ¬å¸è´¬å€¼ã€‚è¿™äº›äº‹æ€å‘å±•å¯¼è‡´äº†å€ºåŠ¡ã€è´§å¸ä½“ç³»ã€å›½å†…ç§©åºå’Œä¸–ç•Œç§©åºçš„é‡ç»„ã€‚ç„¶åï¼Œäº‹æƒ…åˆå¼€å§‹äº†ã€‚</p><p>è™½ç„¶æ²¡æœ‰ä¸€ä¸ªå‘¨æœŸå®Œå…¨ç¬¦åˆæè¿°ï¼Œä½†å‡ ä¹æ‰€æœ‰å‘¨æœŸéƒ½ä¸ä¹‹ç›¸å·®æ— å‡ ã€‚æ¯”å¦‚è¯´ï¼Œè™½ç„¶å€ºåŠ¡æ³¡æ²«ç ´è£‚ä¸€èˆ¬ä¼šå¯¼è‡´ç»æµèç¼©ï¼Œç»æµèç¼©å åŠ å·¨å¤§çš„è´«å¯Œå·®è·é€šå¸¸ä¼šå¯¼è‡´å†…æ–—å’Œå¤–æ–—ï¼Œä½†æœ‰æ—¶é¡ºåºæœ‰äº›ä¸åŒã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.thepaper.cn/newsDetail_forward_7147656" target="_blank" rel="noopener">https://www.thepaper.cn/newsDetail_forward_7147656</a></li><li><a href="https://www.linkedin.com/in/raydalio/detail/recent-activity/" target="_blank" rel="noopener">https://www.linkedin.com/in/raydalio/detail/recent-activity/</a></li><li><a href="https://m.chinanews.com/wap/detail/zw/cj/2020/03-19/9131125.shtml" target="_blank" rel="noopener">https://m.chinanews.com/wap/detail/zw/cj/2020/03-19/9131125.shtml</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Economy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java å¤šçº¿ç¨‹ åŸºç¡€çŸ¥è¯†(ä¸€)</title>
      <link href="/Java-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/Java-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¤šçº¿ç¨‹çŸ¥è¯†åŸºç¡€"><a href="#1-å¤šçº¿ç¨‹çŸ¥è¯†åŸºç¡€" class="headerlink" title="1. å¤šçº¿ç¨‹çŸ¥è¯†åŸºç¡€"></a>1. å¤šçº¿ç¨‹çŸ¥è¯†åŸºç¡€</h1><h2 id="1-1-çº¿ç¨‹-vs-è¿›ç¨‹"><a href="#1-1-çº¿ç¨‹-vs-è¿›ç¨‹" class="headerlink" title="1.1 çº¿ç¨‹ vs è¿›ç¨‹"></a>1.1 çº¿ç¨‹ vs è¿›ç¨‹</h2><p>è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œjavaå½“ä¸­ï¼Œå¯åŠ¨mainå‡½æ•°å°±æ˜¯å¯åŠ¨äº†ä¸€ä¸ªJVMè¿›ç¨‹ï¼Œmainå‡½æ•°æ‰€åœ¨çš„çº¿ç¨‹æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä¹Ÿç§°ä¸ºä¸»çº¿ç¨‹ã€‚</p><p>çº¿ç¨‹æ˜¯æ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹å½“ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚åŒç±»çš„å¤šä¸ªçº¿ç¨‹äº’ç›¸ä¹‹é—´å…±äº«è¿›ç¨‹çš„å †å’Œæ–¹æ³•åŒºçš„èµ„æºã€‚æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œè™šæ‹Ÿæœºæ ˆï¼Œå’Œæœ¬åœ°æ–¹æ³•æ ˆ</p><p>çº¿ç¨‹ä¸è¿›ç¨‹ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://i.loli.net/2020/04/30/3AwhmaPDLkcXKMb.png" alt="çº¿ç¨‹è¿›ç¨‹å…³ç³».png"> </p><p>è¿è¡Œæ—¶å †å’Œæ–¹æ³•åŒºï¼Œè¿˜æœ‰å¸¸é‡æ˜¯å…±äº«çš„ã€‚</p><p><strong>çº¿ç¨‹ç§æœ‰çš„</strong></p><ul><li>ç¨‹åºè®¡æ•°å™¨<ul><li>å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨</li><li>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆ</li><li>ä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜</li><li>ç¨‹åºè®¡æ•°å™¨æ˜¯å”¯ä¸€ä¸ä¼šå‡ºç°OutOfMemoryErrorçš„å†…å­˜åŒºåŸŸï¼Œå£°æ˜å‘¨æœŸæ˜¯å®Œå…¨è·Ÿç€çº¿ç¨‹çš„ï¼Œçº¿ç¨‹åˆ›å»ºå³åˆ›å»ºï¼Œçº¿ç¨‹ç»“æŸå³ç»“æŸ</li><li>ç¨‹åºè®¡æ•°å™¨çš„ç§æœ‰ä¸»è¦æ˜¯ä¸ºäº†çº¿ç¨‹åˆ‡æ¢ä»¥åèƒ½å¤Ÿæ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ä¸Š</li></ul></li><li>è™šæ‹Ÿæœºæ ˆ<ul><li>æè¿°javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹</li><li>Javaè™šæ‹Ÿæœºæ ˆç”±ä¸€ä¸ªä¸ªæ ˆå¸§ç»„æˆï¼Œæ¯ä¸ªæ ˆå¸§éƒ½æ‹¥æœ‰<ul><li>å±€éƒ¨å˜é‡è¡¨<ul><li>å­˜æ”¾äº†ç¼–è¯‘å™¨å·²çŸ¥çš„å„ç§æ•°æ®ç±»å‹</li><li>å¯¹è±¡å¼•ç”¨</li></ul></li><li>æ“ä½œæ•°æ ˆ</li><li>åŠ¨æ€é“¾æ¥</li><li>æ–¹æ³•å‡ºå£ä¿¡æ¯</li></ul></li></ul></li><li>æœ¬åœ°æ–¹æ³•æ ˆ<ul><li>è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡</li><li>æœ¬åœ°æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œåœ¨æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜æ”¾è¯¥æœ¬åœ°æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€å‡ºå£ä¿¡æ¯ã€‚</li></ul></li></ul><p><strong>çº¿ç¨‹å…±äº«èµ„æº</strong></p><ul><li><p>å † </p><ul><li>å­˜æ”¾å¯¹è±¡å®ä¾‹</li><li>å‡ ä¹æ‰€æœ‰å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜</li><li>å †æ˜¯Javaåƒåœ¾æ”¶é›†å™¨çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä½œGCå † Garbage Collected Heap </li><li>å †ä¼šæ ¹æ®æ—¶é—´çš„é•¿åº¦åˆ†ä¸ºå¤šç§ç©ºé—´ï¼Œæ¥æ–¹ä¾¿åƒåœ¾æ”¶é›†å™¨æ¥æ›´å¥½çš„å›æ”¶å†…å­˜</li><li>è¿˜åŒ…æ‹¬è¿è¡Œæ—¶å¸¸é‡æ± </li></ul></li><li><p>æ–¹æ³•åŒº</p><ul><li>ç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»çš„ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ï¼Œå³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®</li></ul></li><li><p>ç›´æ¥å†…å­˜</p></li></ul><h2 id="1-2-å¹¶å‘-vs-å¹¶è¡Œ"><a href="#1-2-å¹¶å‘-vs-å¹¶è¡Œ" class="headerlink" title="1.2 å¹¶å‘ vs å¹¶è¡Œ"></a>1.2 å¹¶å‘ vs å¹¶è¡Œ</h2><p>å¹¶å‘ - åŒä¸€æ—¶é—´æ®µçš„å¤šä¸ªä»»åŠ¡éƒ½åœ¨æ‰§è¡Œ<br>å¹¶è¡Œ - å•ä½æ—¶é—´å†…ï¼Œå¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œ</p><h2 id="1-3-å¤šçº¿ç¨‹å¸¦æ¥çš„æ”¹å˜"><a href="#1-3-å¤šçº¿ç¨‹å¸¦æ¥çš„æ”¹å˜" class="headerlink" title="1.3 å¤šçº¿ç¨‹å¸¦æ¥çš„æ”¹å˜"></a>1.3 å¤šçº¿ç¨‹å¸¦æ¥çš„æ”¹å˜</h2><h3 id="1-3-1-ä¼˜åŠ¿"><a href="#1-3-1-ä¼˜åŠ¿" class="headerlink" title="1.3.1 ä¼˜åŠ¿"></a>1.3.1 ä¼˜åŠ¿</h3><ul><li>çº¿ç¨‹ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œçº¿ç¨‹é—´çš„åˆ‡æ¢å’Œè°ƒåº¦æˆæœ¬è¿œè¿œå°äºè¿›ç¨‹ã€‚è€Œä¸”å¤šæ ¸CPUæ—¶ä»£æ„å‘³ç€å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œï¼Œè¿™å‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€</li><li>å¤šçº¿ç¨‹å¹¶å‘å˜æˆæ˜¯å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿçš„åŸºç¡€</li><li>å•æ ¸æ—¶ä»£å¤šçº¿ç¨‹åšçš„ä¼˜åŒ–æ›´å¤šæ˜¯æé«˜CPUå’ŒIOçš„ç»¼åˆåˆ©ç”¨ç‡ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹åšIOçš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ°å†…æ ¸å½“ä¸­åšåˆ©ç”¨CPUçš„å¤§é‡è®¡ç®—</li><li>å¤šæ ¸æ—¶ä»£æƒ³åšçš„äº‹æƒ…å°±æ˜¯åŒæ—¶ä½¿ç”¨å¤šä¸ªå†…æ ¸ä¸€èµ·æ¥åšè¿™ä»¶äº‹ï¼Œæé«˜æ•´ä¸ªè¿è¡Œçš„æ•ˆç‡</li></ul><h3 id="1-3-2-å¯èƒ½çš„é—®é¢˜"><a href="#1-3-2-å¯èƒ½çš„é—®é¢˜" class="headerlink" title="1.3.2 å¯èƒ½çš„é—®é¢˜"></a>1.3.2 å¯èƒ½çš„é—®é¢˜</h3><p>éœ€è¦è§£å†³å†…å­˜æ³„æ¼ï¼Œæ­»é”ï¼Œçº¿ç¨‹ä¸å®‰å…¨ç›¸å…³çš„é—®é¢˜</p><ul><li>æ­»é”<ul><li>å¤šä¸ªçº¿ç¨‹è¢«åŒæ—¶é˜»å¡ï¼Œåœ¨ç­‰å¾…æŸä¸ªèµ„æºçš„é‡Šæ”¾</li><li>äº§ç”Ÿæ­»é”çš„æ¡ä»¶<ul><li>äº’æ–¥æ¡ä»¶ â€“ è¯¥èµ„æºä»»æ„æ—¶åˆ»åªç”±ä¸€ä¸ªçº¿ç¨‹å ç”¨</li><li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ â€“ ä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ </li><li>ä¸å‰¥å¤ºæ¡ä»¶ â€“ çº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æº</li><li>å¾ªç¯ç­‰å¾…æ¡ä»¶ â€“ è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»</li></ul></li></ul></li></ul><pre><code>public class DeadLockDemo {    private static Object resource1 = new Object();//èµ„æº 1    private static Object resource2 = new Object();//èµ„æº 2    public static void main(String[] args) {        new Thread(() -&gt; {            synchronized (resource1) {                System.out.println(Thread.currentThread() + &quot;get resource1&quot;);                try {                    Thread.sleep(1000);                } catch (InterruptedException e) {                    e.printStackTrace();                }                System.out.println(Thread.currentThread() + &quot;waiting get resource2&quot;);                synchronized (resource2) {                    System.out.println(Thread.currentThread() + &quot;get resource2&quot;);                }            }        }, &quot;çº¿ç¨‹ 1&quot;).start();        new Thread(() -&gt; {            synchronized (resource2) {                System.out.println(Thread.currentThread() + &quot;get resource2&quot;);                try {                    Thread.sleep(1000);                } catch (InterruptedException e) {                    e.printStackTrace();                }                System.out.println(Thread.currentThread() + &quot;waiting get resource1&quot;);                synchronized (resource1) {                    System.out.println(Thread.currentThread() + &quot;get resource1&quot;);                }            }        }, &quot;çº¿ç¨‹ 2&quot;).start();    }}</code></pre><h2 id="1-4-sleepï¼ˆï¼‰vs-waitï¼ˆï¼‰"><a href="#1-4-sleepï¼ˆï¼‰vs-waitï¼ˆï¼‰" class="headerlink" title="1.4 sleepï¼ˆï¼‰vs waitï¼ˆï¼‰"></a>1.4 sleepï¼ˆï¼‰vs waitï¼ˆï¼‰</h2><ul><li>æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºsleepå¹¶æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œwaitæ–¹æ³•ä¼šé‡Šæ”¾é”</li><li>äºŒè€…éƒ½æš‚åœäº†å½“å‰çº¿ç¨‹çš„æ‰§è¡Œ</li><li>waitç”¨äºçº¿ç¨‹ä¹‹é—´çš„äº¤äº’å’Œé€šä¿¡ï¼Œsleepç”¨äºæš‚åœæ‰§è¡Œ</li><li>wait()æ–¹æ³•è¢«è°ƒç”¨ä»¥åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„notify()æˆ–è€…notifyAll()æ–¹æ³•</li></ul><h2 id="1-5-å¹¶å‘ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§"><a href="#1-5-å¹¶å‘ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§" class="headerlink" title="1.5 å¹¶å‘ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§"></a>1.5 å¹¶å‘ç¼–ç¨‹çš„é‡è¦ç‰¹æ€§</h2><ul><li>åŸå­æ€§<ul><li>è¢«ä¿®é¥°çš„ä»£ç å—è¦ä¸å…¨éƒ½æ‰§è¡Œï¼Œè¦ä¸éƒ½ä¸æ‰§è¡Œï¼Œsynchronizedå¯ä»¥ä¿è¯ä»£ç ç‰‡æ®µçš„åŸå­æ€§</li></ul></li><li>å¯è§æ€§<ul><li>å½“ä¸€ä¸ªå˜é‡å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹éƒ½æ˜¯ç«‹å³å¯ä»¥çœ‹åˆ°ä¿®æ”¹ä»¥åçš„æ–°å€¼çš„ã€‚volatileå…³é”®å­—å¯ä»¥ä¿è¯å…±äº«å˜é‡çš„å¯è§æ€§</li></ul></li><li>æœ‰åºæ€§<ul><li>Java åœ¨ç¼–è¯‘å™¨ä»¥åŠè¿è¡ŒæœŸé—´çš„ä¼˜åŒ–ï¼Œä»£ç çš„æ‰§è¡Œé¡ºåºæœªå¿…å°±æ˜¯ç¼–å†™ä»£ç æ—¶å€™çš„é¡ºåºã€‚volatile å…³é”®å­—å¯ä»¥ç¦æ­¢æŒ‡ä»¤è¿›è¡Œé‡æ’åºä¼˜åŒ–   </li></ul></li></ul><h2 id="1-6-volatileå…³é”®å­—"><a href="#1-6-volatileå…³é”®å­—" class="headerlink" title="1.6 volatileå…³é”®å­—"></a>1.6 volatileå…³é”®å­—</h2><h3 id="1-6-1-General"><a href="#1-6-1-General" class="headerlink" title="1.6.1 General"></a>1.6.1 General</h3><p>åœ¨å½“å‰çš„ Java å†…å­˜æ¨¡å‹ä¸‹ï¼Œçº¿ç¨‹å¯ä»¥æŠŠå˜é‡ä¿å­˜æœ¬åœ°å†…å­˜ï¼ˆæ¯”å¦‚æœºå™¨çš„å¯„å­˜å™¨ï¼‰ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ä¸»å­˜ä¸­è¿›è¡Œè¯»å†™ã€‚è¿™å°±å¯èƒ½é€ æˆä¸€ä¸ªçº¿ç¨‹åœ¨ä¸»å­˜ä¸­ä¿®æ”¹äº†ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œè€Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¿˜ç»§ç»­ä½¿ç”¨å®ƒåœ¨å¯„å­˜å™¨ä¸­çš„å˜é‡å€¼çš„æ‹·è´ï¼Œé€ æˆæ•°æ®çš„ä¸ä¸€è‡´ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†å˜é‡å£°æ˜ä¸ºvolatileï¼Œè¿™å°±æŒ‡ç¤ºJVMï¼Œè¿™ä¸ªå˜é‡æ—¶ä¸ç¨³å®šçš„ï¼Œæ¯æ¬¡ä½¿ç”¨å®ƒéƒ½åˆ°ä¸»å­˜å½“ä¸­è¿›è¡Œè¯»å–ã€‚<br>å³volatileå…³é”®å­—å¯ä»¥èµ·åˆ°ï¼š</p><ul><li>ä¿è¯å˜é‡çš„å¯è§æ€§ï¼Œä»ä¸»å†…å­˜å½“ä¸­æ‹¿æ•°æ®</li><li>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</li></ul><h2 id="1-7-synchronizedå…³é”®å­—"><a href="#1-7-synchronizedå…³é”®å­—" class="headerlink" title="1.7 synchronizedå…³é”®å­—"></a>1.7 synchronizedå…³é”®å­—</h2><h3 id="1-7-1-General"><a href="#1-7-1-General" class="headerlink" title="1.7.1 General"></a>1.7.1 General</h3><ul><li>è§£å†³å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥æ€§é—®é¢˜</li><li>å¯ä»¥ä¿è¯è¢«å®ƒä¿®é¥°çš„æ–¹æ³•æˆ–è€…ä»£ç å—åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</li><li>æœ€å¼€å§‹æ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„mutex lockæ¥å®ç°ï¼Œå› ä¸ºæœ‰ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢ï¼Œéœ€è¦ç›¸å¯¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œæ€§èƒ½ä¸å¥½ï¼›JDK 1.6ä¹‹ååšäº†å¤§é‡ä¼˜åŒ–ï¼Œæ€§èƒ½æœ‰äº†ä¸å°çš„æå‡<ul><li>è‡ªæ—‹é”</li><li>é€‚åº”æ€§è‡ªæ—‹é”</li><li>é”æ¶ˆé™¤</li><li>é”ç²—åŒ–</li><li>åå‘é”</li><li>è½»é‡çº§é”</li></ul></li></ul><h3 id="1-7-2-ä½¿ç”¨æ–¹å¼"><a href="#1-7-2-ä½¿ç”¨æ–¹å¼" class="headerlink" title="1.7.2 ä½¿ç”¨æ–¹å¼"></a>1.7.2 ä½¿ç”¨æ–¹å¼</h3><ul><li>ä¿®é¥°å®ä¾‹æ–¹æ³•<ul><li>ä½œç”¨äºå½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å¯¹è±¡å®ä¾‹çš„é” </li></ul></li><li>ä¿®é¥°é™æ€æ–¹æ³•<ul><li>ç»™å½“å‰ç±»åŠ é”ï¼Œä¼šä½œç”¨äºç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹</li></ul></li><li>ä¿®é¥°ä»£ç å—<ul><li>æŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”  </li></ul></li></ul><pre><code>// çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼çš„å®ç°public class Singleton {    private volatile static Singleton uniqueInstance;    private Singleton() {    }    public static Singleton getUniqueInstance() {       //å…ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å®ä¾‹è¿‡ï¼Œæ²¡æœ‰å®ä¾‹åŒ–è¿‡æ‰è¿›å…¥åŠ é”ä»£ç         if (uniqueInstance == null) {            //ç±»å¯¹è±¡åŠ é”            synchronized (Singleton.class) {                if (uniqueInstance == null) {                    uniqueInstance = new Singleton();                }            }        }        return uniqueInstance;    }}</code></pre><h3 id="1-7-3-åº•å±‚å®ç°æ–¹å¼"><a href="#1-7-3-åº•å±‚å®ç°æ–¹å¼" class="headerlink" title="1.7.3 åº•å±‚å®ç°æ–¹å¼"></a>1.7.3 åº•å±‚å®ç°æ–¹å¼</h3><ul><li>åŒæ­¥è¯­å¥å—çš„æ—¶å€™<ul><li>ä½¿ç”¨çš„æ˜¯monitorenterå’ŒmonitorexitæŒ‡ä»¤</li><li>monitorenteræŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®</li><li>monitorexitæŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®</li><li>é”è®¡æ•°å™¨ä¸º0æ—¶å¯ä»¥è·å–ï¼Œé‡Šæ”¾é”çš„æ—¶å€™å†ç½®ä¸º0</li></ul></li><li>åŒæ­¥æ–¹æ³•çš„æ—¶å€™<ul><li>ä½¿ç”¨çš„æ˜¯ACC_SYNCHRONIZEDæ ‡è¯†ï¼ŒæŒ‡æ˜è¯¥æ–¹æ³•ä¸ºä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä»è€Œæ‰§è¡Œç›¸åº”çš„åŒæ­¥è°ƒç”¨</li></ul></li></ul><h3 id="1-7-4-synchronized-å…³é”®å­—çš„åº•å±‚ä¼˜åŒ–"><a href="#1-7-4-synchronized-å…³é”®å­—çš„åº•å±‚ä¼˜åŒ–" class="headerlink" title="1.7.4 synchronized å…³é”®å­—çš„åº•å±‚ä¼˜åŒ–"></a>1.7.4 synchronized å…³é”®å­—çš„åº•å±‚ä¼˜åŒ–</h3><p>é”ä¸»è¦å­˜åœ¨å››ä¸­çŠ¶æ€ï¼Œä¾æ¬¡æ˜¯ï¼šæ— é”çŠ¶æ€ã€åå‘é”çŠ¶æ€ã€è½»é‡çº§é”çŠ¶æ€ã€é‡é‡çº§é”çŠ¶æ€ï¼Œä»–ä»¬ä¼šéšç€ç«äº‰çš„æ¿€çƒˆè€Œé€æ¸å‡çº§ã€‚æ³¨æ„é”å¯ä»¥å‡çº§ä¸å¯é™çº§ï¼Œè¿™ç§ç­–ç•¥æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡</p><ul><li><p>åå‘é”</p><ul><li>ä¸ºäº†åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—</li><li>åå‘é”åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹ä¼šæŠŠæ•´ä¸ªåŒæ­¥éƒ½æ¶ˆé™¤æ‰</li><li>ä½†æ˜¯å¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œåå‘é”å°±å¤±æ•ˆäº†ï¼Œå› ä¸ºè¿™æ ·åœºåˆææœ‰å¯èƒ½æ¯æ¬¡ç”³è¯·é”çš„çº¿ç¨‹éƒ½æ˜¯ä¸ç›¸åŒçš„ï¼Œå› æ­¤è¿™ç§åœºåˆä¸‹ä¸åº”è¯¥ä½¿ç”¨åå‘é”ï¼Œå¦åˆ™ä¼šå¾—ä¸å¿å¤±ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåå‘é”å¤±è´¥åï¼Œå¹¶ä¸ä¼šç«‹å³è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œè€Œæ˜¯å…ˆå‡çº§ä¸ºè½»é‡çº§é” </li></ul></li><li><p>è½»é‡çº§é”</p><ul><li>åå‘é”å¤±è´¥çš„æƒ…å†µä¸‹ä¼šé¦–å…ˆå‡çº§ä¸ºè½»é‡çº§é”</li><li>åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿé‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—</li><li>ä½¿ç”¨è½»é‡çº§é”ï¼Œä¸éœ€è¦ç”³è¯·äº’æ–¥é‡ã€‚å¦å¤–ï¼Œè½»é‡çº§é”çš„åŠ é”å’Œè§£é”éƒ½ç”¨åˆ°äº†CASæ“ä½œ </li><li>è½»é‡çº§é”èƒ½å¤Ÿæå‡ç¨‹åºåŒæ­¥æ€§èƒ½çš„ä¾æ®æ˜¯â€œå¯¹äºç»å¤§éƒ¨åˆ†é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„â€ï¼Œè¿™æ˜¯ä¸€ä¸ªç»éªŒæ•°æ®ã€‚å¦‚æœæ²¡æœ‰ç«äº‰ï¼Œè½»é‡çº§é”ä½¿ç”¨ CAS æ“ä½œé¿å…äº†ä½¿ç”¨äº’æ–¥æ“ä½œçš„å¼€é”€ã€‚ä½†å¦‚æœå­˜åœ¨é”ç«äº‰ï¼Œé™¤äº†äº’æ–¥é‡å¼€é”€å¤–ï¼Œè¿˜ä¼šé¢å¤–å‘ç”ŸCASæ“ä½œï¼Œå› æ­¤åœ¨æœ‰é”ç«äº‰çš„æƒ…å†µä¸‹ï¼Œè½»é‡çº§é”æ¯”ä¼ ç»Ÿçš„é‡é‡çº§é”æ›´æ…¢ï¼å¦‚æœé”ç«äº‰æ¿€çƒˆï¼Œé‚£ä¹ˆè½»é‡çº§å°†å¾ˆå¿«è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼</li></ul></li><li><p>è‡ªæ—‹é”å’Œè‡ªé€‚åº”è‡ªæ—‹</p><ul><li>äº’æ–¥åŒæ­¥å¯¹æ€§èƒ½æœ€å¤§çš„å½±å“å°±æ˜¯é˜»å¡çš„å®ç°ï¼Œå› ä¸ºæŒ‚èµ·çº¿ç¨‹/æ¢å¤çº¿ç¨‹çš„æ“ä½œéƒ½éœ€è¦è½¬å…¥å†…æ ¸æ€ä¸­å®Œæˆ</li><li>èˆ¬çº¿ç¨‹æŒæœ‰é”çš„æ—¶é—´éƒ½ä¸æ˜¯å¤ªé•¿ï¼Œæ‰€ä»¥ä»…ä»…ä¸ºäº†è¿™ä¸€ç‚¹æ—¶é—´å»æŒ‚èµ·çº¿ç¨‹/æ¢å¤çº¿ç¨‹æ˜¯å¾—ä¸å¿å¤±çš„</li><li>è‡ªæ—‹é”å°±æ˜¯è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯ï¼Œè‡ªæ—‹é”å’Œäº’æ–¥é”ä¸åŒä¹‹å¤„åœ¨äºä¸ä¼šä¼‘çœ ï¼Œè°ƒç”¨è€…ä¸€ç›´åœ¨é‚£é‡Œå¾ªç¯çœ‹é”çš„ä¿æŒè€…æ˜¯å¦é‡Šæ”¾äº†é”</li></ul></li><li><p>é”æ¶ˆé™¤</p><ul><li>ç¼–è¯‘å™¨åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå¦‚æœæ£€æµ‹åˆ°å…±äº«æ•°æ®ä¸å¯èƒ½å­˜åœ¨ç«äº‰ï¼Œå°±æ‰§è¡Œé”æ¶ˆé™¤ï¼Œä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”çš„æ—¶é—´</li></ul></li></ul><h3 id="1-7-5-synchronizedå…³é”®å­—å’Œvolatileå…³é”®å­—çš„åŒºåˆ«"><a href="#1-7-5-synchronizedå…³é”®å­—å’Œvolatileå…³é”®å­—çš„åŒºåˆ«" class="headerlink" title="1.7.5 synchronizedå…³é”®å­—å’Œvolatileå…³é”®å­—çš„åŒºåˆ«"></a>1.7.5 synchronizedå…³é”®å­—å’Œvolatileå…³é”®å­—çš„åŒºåˆ«</h3><ul><li>volatileæ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œå› æ­¤volatileæ€§èƒ½ä¼šæ¯”synchronizedå…³é”®å­—å¥½ã€‚</li><li>å¤šçº¿ç¨‹è®¿é—®volatileå…³é”®å­—ä¸ä¼šå‘ç”Ÿé˜»å¡ï¼Œè€Œsynchronizedå…³é”®å­—å¯èƒ½ä¼š</li><li>volatileå…³é”®å­—èƒ½ä¿è¯æ•°æ®çš„å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„åŸå­æ€§ã€‚synchronizedéƒ½å¯ä»¥ä¿è¯</li><li>volatileå…³é”®å­—ä¸»è¦ç”¨äºè§£å†³å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼Œè€Œ synchronizedå…³é”®å­—è§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥æ€§</li></ul><h1 id="2-ThreadLocal"><a href="#2-ThreadLocal" class="headerlink" title="2. ThreadLocal"></a>2. ThreadLocal</h1><h2 id="2-1-ThreadLocal"><a href="#2-1-ThreadLocal" class="headerlink" title="2.1 ThreadLocal"></a>2.1 ThreadLocal</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºçš„å˜é‡æ—¶å¯ä»¥è¢«ä»»ä½•ä¸€ä¸ªçº¿ç¨‹è®¿é—®å¹¶ä¿®æ”¹çš„ï¼Œå¦‚æœæƒ³å®ç°æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ä¸“å±çš„æœ¬åœ°å˜é‡çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨JDKæä¾›çš„ThreadLocalç±»ã€‚ThreadLocalç±»è§£å†³çš„é—®é¢˜å°±æ˜¯æƒ³è®©æ¯ä¸ªçº¿ç¨‹éƒ½ç»‘å®šè‡ªå·±çš„å€¼ã€‚</p><p>å½“æˆ‘ä»¬åˆ›å»ºäº†ThreadLocalå˜é‡ï¼Œè®¿é—®è¿™ä¸ªå˜é‡çš„æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è¿™ä¸ªå˜é‡çš„æœ¬åœ°å‰¯æœ¬ï¼Œä½¿ç”¨get()ä»¥åŠset()æ–¹æ³•è·å–é»˜è®¤å€¼æˆ–è€…å°†æŒ‡æ”¹ä¸ºå½“å‰çº¿ç¨‹æ‰€å­˜çš„å‰¯æœ¬çš„å€¼ï¼Œä»è€Œé¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><pre><code>import java.text.SimpleDateFormat;import java.util.Random;public class ThreadLocalExample implements Runnable{     // SimpleDateFormat ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹éƒ½è¦æœ‰è‡ªå·±ç‹¬ç«‹çš„å‰¯æœ¬    private static final ThreadLocal&lt;SimpleDateFormat&gt; formatter = ThreadLocal.withInitial(() -&gt; new SimpleDateFormat(&quot;yyyyMMdd HHmm&quot;));    public static void main(String[] args) throws InterruptedException {        ThreadLocalExample obj = new ThreadLocalExample();        for(int i=0 ; i&lt;10; i++){            Thread t = new Thread(obj, &quot;&quot;+i);            Thread.sleep(new Random().nextInt(1000));            t.start();        }    }    @Override    public void run() {        System.out.println(&quot;Thread Name= &quot;+Thread.currentThread().getName()+&quot; default Formatter = &quot;+formatter.get().toPattern());        try {            Thread.sleep(new Random().nextInt(1000));        } catch (InterruptedException e) {            e.printStackTrace();        }        //formatter pattern is changed here by thread, but it won&#39;t reflect to other threads        formatter.set(new SimpleDateFormat());        System.out.println(&quot;Thread Name= &quot;+Thread.currentThread().getName()+&quot; formatter = &quot;+formatter.get().toPattern());    }}</code></pre><p>ä»ThreadLocalåŸç†ä¸Šæ¥è®²</p><pre><code>public class Thread implements Runnable {     ......    //ä¸æ­¤çº¿ç¨‹æœ‰å…³çš„ThreadLocalå€¼ã€‚ç”±ThreadLocalç±»ç»´æŠ¤    ThreadLocal.ThreadLocalMap threadLocals = null;    //ä¸æ­¤çº¿ç¨‹æœ‰å…³çš„InheritableThreadLocalå€¼ã€‚ç”±InheritableThreadLocalç±»ç»´æŠ¤    ThreadLocal.ThreadLocalMap inheritableThreadLocals = null;     ......}</code></pre><ul><li><p>Threadç±»ä¸­æœ‰ä¸€ä¸ªthreadLocalså’Œä¸€ä¸ªinheritableThreadLocalså˜é‡ï¼Œéƒ½æ˜¯ç”±ThreadLocalMapæ¥å®ç°çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸¤ä¸ªå˜é‡çš„å€¼å‡ä¸ºnullï¼Œåªæœ‰å½“å‰çº¿ç¨‹è°ƒç”¨ThreadLocalç±»çš„set/ getæ–¹æ³•æ—¶æ‰åˆ›å»ºä»–ä»¬</p></li><li><p>ThreadLocalç±»çš„set()æ–¹æ³•</p></li></ul><pre><code>    public void set(T value) {        Thread t = Thread.currentThread();        ThreadLocalMap map = getMap(t);        if (map != null)            map.set(this, value);        else            createMap(t, value);    }    ThreadLocalMap getMap(Thread t) {        return t.threadLocals;    }</code></pre><ul><li>ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹å‡ºæœ€ç»ˆçš„å˜é‡æ˜¯æ”¾åœ¨äº†å½“å‰çº¿ç¨‹çš„ThreadLocalMapå½“ä¸­ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å­˜åœ¨ThreadLocalä¸Šï¼ŒThreadLocalå¯ä»¥ç†è§£ä¸ºåªæ˜¯ThreadLocalMapçš„å°è£…ï¼Œä¼ é€’äº†å˜é‡å€¼ã€‚</li><li>ThreadLocalç±»å¯ä»¥é€šè¿‡Thread.currentThread()è·å–å½“å‰çº¿ç¨‹å¯¹è±¡ä¹‹åï¼Œç›´æ¥é€šè¿‡getMap(Thread t) è®¿é—®åˆ°è¯¥çº¿ç¨‹çš„ThreadLocalMapå¯¹è±¡</li></ul><h1 id="3-AQS"><a href="#3-AQS" class="headerlink" title="3. AQS"></a>3. AQS</h1><p>AQSå…¨ç§°ä¸ºAbstractQueuedSynchronizerï¼Œæ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ã€‚</p><h2 id="3-1-åŸç†åˆ†æ"><a href="#3-1-åŸç†åˆ†æ" class="headerlink" title="3.1 åŸç†åˆ†æ"></a>3.1 åŸç†åˆ†æ</h2><p>æ ¸å¿ƒæ€æƒ³ä¸ºå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºæ˜¯ç©ºé—²çš„ï¼Œå°±å°†ç°åœ¨è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„èµ„æºè¢«å ç”¨äº†ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€æ•´å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼ŒAQSä½¿ç”¨CLHé˜Ÿåˆ—é”å®ç°ï¼Œå°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—å½“ä¸­ã€‚</p><p>CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQSæ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ªCLHé”é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…</p><ul><li>AQSä½¿ç”¨intå˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€</li><li>é€šè¿‡å†…ç½®çš„FIFOé˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œ</li><li>AQSä½¿ç”¨CASå¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹</li></ul><pre><code>private volatile int state;//å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§//è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼protected final int getState() {          return state;} // è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼protected final void setState(int newState) {         state = newState;}//åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰protected final boolean compareAndSetState(int expect, int update) {        return unsafe.compareAndSwapInt(this, stateOffset, expect, update);}</code></pre><h2 id="3-2-AQSèµ„æºå…±äº«æ–¹å¼"><a href="#3-2-AQSèµ„æºå…±äº«æ–¹å¼" class="headerlink" title="3.2 AQSèµ„æºå…±äº«æ–¹å¼"></a>3.2 AQSèµ„æºå…±äº«æ–¹å¼</h2><ul><li>å…±æœ‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼<ul><li>Exclusive ç‹¬å  <ul><li>åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œåˆåˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”</li><li>å…¬å¹³é”<ul><li>æŒ‰ç…§çº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­çš„æ’é˜Ÿé¡ºåºï¼Œå…ˆåˆ°è€…å…ˆæ‹¿åˆ°é” </li></ul></li><li>éå…¬å¹³é”  <ul><li>å½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œæ— è§†é˜Ÿåˆ—é¡ºåºç›´æ¥å»æŠ¢é”ï¼Œè°æŠ¢åˆ°å°±æ˜¯è°çš„</li></ul></li></ul></li><li>Share å…±äº«<ul><li>å¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œ<ul><li>semaphore</li><li>coutDownLatch</li></ul></li></ul></li></ul></li></ul><h2 id="3-3-å¸¸ç”¨ç»„ä»¶"><a href="#3-3-å¸¸ç”¨ç»„ä»¶" class="headerlink" title="3.3 å¸¸ç”¨ç»„ä»¶"></a>3.3 å¸¸ç”¨ç»„ä»¶</h2><ul><li><p>Semaphore ä¿¡å·é‡ â€“ å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®</p><ul><li>synchronized å’Œ ReentrantLock éƒ½æ˜¯ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphore(ä¿¡å·é‡)å¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚</li></ul></li><li><p>CountDownLatch å€’è®¡æ—¶å™¨</p><ul><li>CountDownLatchæ˜¯ä¸€ä¸ªåŒæ­¥å·¥å…·ç±»ï¼Œç”¨æ¥åè°ƒå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥ã€‚è¿™ä¸ªå·¥å…·é€šå¸¸ç”¨æ¥æ§åˆ¶çº¿ç¨‹ç­‰å¾…ï¼Œå®ƒå¯ä»¥è®©æŸä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ç›´åˆ°å€’è®¡æ—¶ç»“æŸï¼Œå†å¼€å§‹æ‰§è¡Œ</li></ul></li><li><p>CyclicBarrier å¾ªç¯æ …æ </p><ul><li>CyclicBarrier å’Œ CountDownLatch éå¸¸ç±»ä¼¼ï¼Œå®ƒä¹Ÿå¯ä»¥å®ç°çº¿ç¨‹é—´çš„æŠ€æœ¯ç­‰å¾…ï¼Œä½†æ˜¯å®ƒçš„åŠŸèƒ½æ¯” CountDownLatch æ›´åŠ å¤æ‚å’Œå¼ºå¤§ã€‚ä¸»è¦åº”ç”¨åœºæ™¯å’Œ CountDownLatch ç±»ä¼¼ã€‚CyclicBarrier çš„å­—é¢æ„æ€æ˜¯å¯å¾ªç¯ä½¿ç”¨ï¼ˆCyclicï¼‰çš„å±éšœï¼ˆBarrierï¼‰</li><li>å®ƒè¦åšçš„äº‹æƒ…æ˜¯ï¼Œè®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å«åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡ï¼Œç›´åˆ°æœ€åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­å¹²æ´»ã€‚CyclicBarrieré»˜è®¤çš„æ„é€ æ–¹æ³•æ˜¯ CyclicBarrier(int parties)ï¼Œå…¶å‚æ•°è¡¨ç¤ºå±éšœæ‹¦æˆªçš„çº¿ç¨‹æ•°é‡ï¼Œæ¯ä¸ªçº¿ç¨‹è°ƒç”¨await()æ–¹æ³•å‘Šè¯‰ CyclicBarrier æˆ‘å·²ç»åˆ°è¾¾äº†å±éšœï¼Œç„¶åå½“å‰çº¿ç¨‹è¢«é˜»å¡<h1 id="4-AtomicåŸå­ç±»"><a href="#4-AtomicåŸå­ç±»" class="headerlink" title="4. AtomicåŸå­ç±»"></a>4. AtomicåŸå­ç±»</h1></li></ul></li></ul><p>åœ¨è¿™é‡ŒæŒ‡çš„æ˜¯ä¸å¯ä¸­æ–­çš„æ“ä½œï¼Œå³ä¾¿æ˜¯å¤šä¸ªçº¿ç¨‹ä¸€èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹å¹²æ‰°ã€‚åŸå­ç±»ä½“ç³»å°±æ˜¯å°±æœ‰åŸå­/åŸå­æ“ä½œç‰¹å¾çš„ç±»ã€‚</p><h2 id="4-1-General"><a href="#4-1-General" class="headerlink" title="4.1 General"></a>4.1 General</h2><ul><li><p>åŸºæœ¬ç±»å‹ - ä½¿ç”¨åŸå­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹</p><ul><li>AtomicInteger æ•´å½¢åŸå­ç±»</li><li>AtomicLong é•¿æ•´å½¢åŸå­ç±»</li><li>AtomicBoolean å¸ƒå°”å‹åŸå­ç±»</li></ul></li><li><p>æ•°ç»„ç±»å‹</p><ul><li>AtomicIntegerArray æ•´å½¢æ•°ç»„åŸå­ç±»</li><li>AtomicLongArray é•¿æ•´å½¢æ•°ç»„åŸå­ç±»</li><li>AtomicReferenceArray å¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»</li></ul></li><li><p>å¼•ç”¨ç±»å‹</p><ul><li>AtomicReference å¼•ç”¨ç±»å‹åŸå­ç±»</li><li>AtomicStampedReference åŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µåŸå­ç±»</li><li>AtomicMarkableReference åŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹</li></ul></li><li><p>å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹</p><ul><li>AtomicIntegerFieldUpdater </li><li>AtomicLongFielfUpdater</li><li>AtomicStampedReference </li></ul></li></ul><h2 id="4-2-ä½¿ç”¨ä¸åŸç†"><a href="#4-2-ä½¿ç”¨ä¸åŸç†" class="headerlink" title="4.2 ä½¿ç”¨ä¸åŸç†"></a>4.2 ä½¿ç”¨ä¸åŸç†</h2><ul><li>ä»¥AtomicIntegerä¸ºä¾‹ï¼Œå…¶æ–¹æ³•å¦‚ä¸‹ï¼š</li></ul><pre><code>    public final int get() //è·å–å½“å‰çš„å€¼    public final int getAndSet(int newValue)//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼    public final int getAndIncrement()//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå¢    public final int getAndDecrement() //è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå‡    public final int getAndAdd(int delta) //è·å–å½“å‰çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„å€¼    boolean compareAndSet(int expect, int update) //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰    public final void lazySet(int newValue)//æœ€ç»ˆè®¾ç½®ä¸ºnewValue,ä½¿ç”¨ lazySet è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚</code></pre><ul><li>AtomicIntegerå®ç°åŸç†<ul><li>ä½¿ç”¨CASä»¥åŠvolativeæ¥ä¿è¯åŸå­æ“ä½œï¼Œä»è€Œé¿å…synchronizedçš„é«˜å¼€é”€ï¼Œæ‰§è¡Œæ•ˆç‡å¤§ä¸ºæå‡</li><li>CASçš„åŸç†æ˜¯æ‹¿æœŸæœ›çš„å€¼å’ŒåŸæœ¬çš„ä¸€ä¸ªå€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™æ›´æ–°æˆæ–°çš„å€¼</li><li>UnSafe ç±»çš„ objectFieldOffset() æ–¹æ³•æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥æ‹¿åˆ°â€œåŸæ¥çš„å€¼â€çš„å†…å­˜åœ°å€ï¼Œè¿”å›å€¼æ˜¯ valueOffset</li><li>å¦å¤– value æ˜¯ä¸€ä¸ªvolatileå˜é‡ï¼Œåœ¨å†…å­˜ä¸­å¯è§ï¼Œå› æ­¤ JVM å¯ä»¥ä¿è¯ä»»ä½•æ—¶åˆ»ä»»ä½•çº¿ç¨‹æ€»èƒ½æ‹¿åˆ°è¯¥å˜é‡çš„æœ€æ–°å€¼ã€‚</li></ul></li></ul><pre><code>    // setup to use Unsafe.compareAndSwapInt for updatesï¼ˆæ›´æ–°æ“ä½œæ—¶æä¾›â€œæ¯”è¾ƒå¹¶æ›¿æ¢â€çš„ä½œç”¨ï¼‰    private static final Unsafe unsafe = Unsafe.getUnsafe();    private static final long valueOffset;    static {        try {            valueOffset = unsafe.objectFieldOffset                (AtomicInteger.class.getDeclaredField(&quot;value&quot;));        } catch (Exception ex) { throw new Error(ex); }    }    private volatile int value;</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/Multithread/synchronized.md" target="_blank" rel="noopener">https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/Multithread/synchronized.md</a></li><li><a href="https://blog.csdn.net/zqz_zqz/article/details/70233767" target="_blank" rel="noopener">https://blog.csdn.net/zqz_zqz/article/details/70233767</a></li><li><a href="https://www.baeldung.com/java-threadpooltaskexecutor-core-vs-max-poolsize" target="_blank" rel="noopener">https://www.baeldung.com/java-threadpooltaskexecutor-core-vs-max-poolsize</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Multi-threading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ç¨‹ä¸Šå…³äºSQLæ•°æ®åº“ - ä½ éœ€è¦çŸ¥é“çš„äº‹</title>
      <link href="/%E5%B7%A5%E7%A8%8B%E4%B8%8A%E5%85%B3%E4%BA%8ESQL%E6%95%B0%E6%8D%AE%E5%BA%93-%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B/"/>
      <url>/%E5%B7%A5%E7%A8%8B%E4%B8%8A%E5%85%B3%E4%BA%8ESQL%E6%95%B0%E6%8D%AE%E5%BA%93-%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<p>å¤§éƒ¨åˆ†çš„è®¡ç®—æœºç³»ç»Ÿéƒ½ä¼šæœ‰éœ€è¦ç»´æŠ¤çš„çŠ¶æ€ï¼Œå¤§æ¦‚ç‡å°±è¦ä¾èµ–äºä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿã€‚åœ¨é‡æ•°æ®çš„ç³»ç»Ÿå½“ä¸­ï¼Œæ•°æ®åº“å°±ä¼šæˆä¸ºæ•´ä¸ªç³»ç»Ÿè®¾è®¡çš„æ ¸å¿ƒï¼Œå…¶ä¸­ä¼šæœ‰å¾ˆå¤šéœ€è¦è€ƒè™‘åˆ°çš„æƒè¡¡ã€‚æˆ‘ä»¬å¿…é¡»è¦å­¦ä¹ å¹¶ä¸”äº†è§£æ•°æ®åº“æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼Œè¿™ç¯‡æ–‡ç« ä¼šåˆ†äº«ä¸€äº›å¯¹äºå¼€å‘è€…æœ‰ç”¨çš„è§†è§’å’Œè§‚ç‚¹ã€‚</p><h1 id="1-ç½‘ç»œè¿æ¥é—®é¢˜-â€“-éš¾ä»¥è¾¾åˆ°çš„5ä¸ª9"><a href="#1-ç½‘ç»œè¿æ¥é—®é¢˜-â€“-éš¾ä»¥è¾¾åˆ°çš„5ä¸ª9" class="headerlink" title="1. ç½‘ç»œè¿æ¥é—®é¢˜ â€“ éš¾ä»¥è¾¾åˆ°çš„5ä¸ª9"></a>1. ç½‘ç»œè¿æ¥é—®é¢˜ â€“ éš¾ä»¥è¾¾åˆ°çš„5ä¸ª9</h1><p>æ€»æœ‰å…³äºå½“å‰çš„ç½‘ç»œæœ‰å¤šä¹ˆå€¼å¾—ä¿¡èµ–çš„è€ƒé‡ï¼Œè°·æ­Œäº‘çš„æ•°æ®ï¼Œåœ¨æœåŠ¡å±‚é¢è¾¾åˆ°99.999%çš„å¯è®¿é—®çš„ç¨‹åº¦çš„æ—¶å€™ï¼Œå¤§çº¦æœ‰7.6%çš„é—®é¢˜æ˜¯ç”±äºç½‘ç»œé€ æˆçš„ã€‚è¿™ä¹ŸåŒæ ·æœ‰ç›¸å…³æ•°æ®åœ¨AWSï¼Œç”šè‡³é˜¿é‡Œäº‘å½“ä¸­ã€‚å› ä¸ºæŒ–æ–­å…‰çº¤ï¼Œæˆ–è€…ç½‘ç»œé…ç½®çš„é—®é¢˜ï¼Œé€ æˆä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼Œç”šè‡³ä¸€ä¸ªavaliability zone ä¸å¯è®¿é—®ã€‚</p><p>æ ¹æ®è¿‡å¾€çš„ç»éªŒï¼Œäº‘æœåŠ¡æä¾›å•†å‡ºç°çš„ç½‘ç»œé—®é¢˜ï¼Œå¾ˆæœ‰å¯èƒ½ç›´æ¥é€ æˆä½¿ç”¨çš„å…¬å¸æœåŠ¡downæ‰æ•°å°æ—¶çš„æ—¶é—´ã€‚ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œä»–ä»¬å»å®šä½é—®é¢˜æ‰€åœ¨æ˜¯å¾ˆæœ‰éš¾åº¦çš„ã€‚é¦–å…ˆè¦å°½å¿«åˆ¤æ–­æ˜¯IaaS è¿˜æ˜¯PaaSå‡ºç°çš„é—®é¢˜ï¼Œå½“åˆ¤æ–­å‡ºæ˜¯äº‘æœåŠ¡ä¾›åº”å•†è¿™è¾¹å‡ºç°çš„é—®é¢˜ä¹‹åï¼Œé™¤äº†å°½å¿«è”ç³»ï¼Œææ€•ä¹Ÿåˆ«æ— ä»–æ³•ã€‚</p><p>å‡ºç°ç½‘ç»œé—®é¢˜çš„åŸå› å¾ˆå¤šï¼Œåƒæ˜¯ç¡¬ä»¶ç‚¸äº†ï¼Œæƒé™æ›´æ”¹ï¼Œåœç”µï¼Œå…‰çº¤è¢«æŒ–æ–­ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚å„å¤§äº‘æœåŠ¡å‚å•†éƒ½ä¼šåœ¨ä¸€ä¸ªåœ°åŒºæœ‰å¤šä¸ªAZ,æ¯ä¸ªAZæœ‰å¤šä¸ªdata centerï¼Œç›¸äº’ä¹‹é—´å†ç”¨å…‰çº¤è¿æ¥ã€‚ä¼šéœ€è¦çœ‹å“ªæ¡å…‰çº¤æ— æ³•ä½¿ç”¨ï¼Œä¼šå¯¹æ•´ä¸ªç³»ç»Ÿé€ æˆä¸åŒç¨‹åº¦çš„å½±å“ã€‚</p><h1 id="2-ACID-æœ‰å¤šä¸ªæ¶µä¹‰"><a href="#2-ACID-æœ‰å¤šä¸ªæ¶µä¹‰" class="headerlink" title="2. ACID æœ‰å¤šä¸ªæ¶µä¹‰"></a>2. ACID æœ‰å¤šä¸ªæ¶µä¹‰</h1><p>ACIDæŒ‡çš„æ˜¯Atomicity, Consistency, Isolation, Durabilityã€‚è¿™äº›éƒ½æ˜¯æ•°æ®åº“çš„transactionéœ€è¦çš„ç›¸å…³å±æ€§ï¼Œä»¥ç¡®ä¿ç”¨æˆ·çš„æ•°æ®å±æ€§åœ¨ç¨‹åºå´©æºƒï¼Œç¡¬ä»¶å‡ºç°é”™è¯¯ç­‰å„ç§æƒ…å†µä¸‹ä¾æ—§æŒ‰ç…§æœŸå¾…æ¥è¿è¡Œã€‚æ²¡æœ‰ACIDçš„è¯ï¼Œå¼€å‘è€…æ— æ³•çŸ¥é“è‡ªå·±çš„ä»£ç çš„è´£ä»»ï¼Œä»¥åŠæ•°æ®åº“çš„è´£ä»»ï¼Œä¼šé€ æˆå¾ˆå¤šé—®é¢˜ã€‚å½“ç„¶ä¸Šè¿°è¯´çš„è¿˜æ˜¯ä¸»è¦å¯¹äºSQLæ•°æ®åº“è€Œè¨€çš„ï¼Œå¯¹äºNoSQLæ¥è¯´ï¼Œå¤§éƒ¨åˆ†éƒ½æ²¡æœ‰å®ç°ACIDï¼Œæˆ–è€…ä¸æ˜¯é»˜è®¤å®ç°çš„(è­¬å¦‚AWS DynamoDBï¼Œå¯ä»¥é€‰æ‹©å®ç°transactionçš„åŠŸèƒ½)ï¼Œå› ä¸ºä»–ä»¬å®ç°èµ·æ¥å¾ˆæ˜‚è´µã€‚</p><p>å…³äºä¸ºä»€ä¹ˆNoSQLå®ç°ACIDå¾ˆæ˜‚è´µï¼Œé¦–å…ˆéœ€è¦è¯´çš„æ˜¯SQLå¯¹äºå¤§æ•°æ®é‡æ˜¯æœ‰ç“¶é¢ˆçš„ï¼Œåœ¨ä¸Šåƒä¸‡çš„æ•°æ®è§„æ¨¡ä»¥ä¸Šï¼Œä¼šéš¾ä»¥ç»§ç»­æ‰©å®¹ã€‚NoSQLå®è´¨ä¸Šæ˜¯å°†ä¼ ç»Ÿçš„çºµå‘æ‰©å®¹æ”¹ä¸ºæ¨ªå‘æ‰©å®¹ï¼Œç‰ºç‰²äº†ä¸€è‡´æ€§ï¼Œ(ä¿è¯æœ€ç»ˆä¸€è‡´æ€§)ï¼Œæ¥è¾¾åˆ°å¯¹æ›´å¤šæ•°æ®çš„æ”¯æŒã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯å·¥ä¸šç•Œå¯¹äºACIDæ˜¯æ²¡æœ‰ä¸€ä¸ªéå¸¸éå¸¸ä¹‹æ˜ç¡®çš„å®šä¹‰çš„ï¼Œé¦–å…ˆä¸æ˜¯æ¯ä¸ªæ•°æ®åº“éƒ½æ˜¯æ»¡è¶³ACIDçš„ï¼Œç„¶ååœ¨é‚£äº›æ»¡è¶³ACIDçš„æ•°æ®åº“å½“ä¸­ï¼ŒACIDä¹Ÿå¯ä»¥è¢«ä¸åŒçš„æ–¹å¼æ¥åšè§£é‡Šã€‚ACIDè¢«ä¸åŒçš„æ–¹å¼æ¥è§£é‡Šçš„åŸå› ä¹‹ä¸€æ˜¯åœ¨å®ç°çš„æ—¶å€™å››ä¸ªç‰¹å¾ä¹‹é—´çš„åˆ¶è¡¡ã€‚ä»–ä»¬åœ¨å¤„ç†ä¸€ä¸ªedge caseè¿˜æœ‰â€œä¸å¯èƒ½â€æƒ…å†µçš„æ—¶å€™ï¼Œè¡¨ç°è¿˜æ˜¯ä¼šæœ‰è›®å¤šä¸ä¸€æ ·çš„åœ°æ–¹çš„ã€‚</p><h1 id="3-æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸åŒçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§èƒ½åŠ›"><a href="#3-æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸åŒçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§èƒ½åŠ›" class="headerlink" title="3. æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸åŒçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§èƒ½åŠ›"></a>3. æ¯ä¸ªæ•°æ®åº“éƒ½æœ‰ä¸åŒçš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§èƒ½åŠ›</h1><p>åœ¨ACIDå±æ€§å½“ä¸­ï¼Œä¸€è‡´æ€§å’Œéš”ç¦»æ€§æ˜¯åœ¨å®ç°çš„æ—¶å€™æœ€éœ€è¦æƒè¡¡çš„ä¸¤ä¸ªå±æ€§ï¼Œå› ä¸ºå®ç°çš„ä»£ä»·éƒ½å¾ˆé«˜ã€‚ä»–ä»¬éœ€è¦ååŒï¼Œåœ¨ä¿è¯æ•°æ®ä¸€è‡´çš„è¿‡ç¨‹ä¸­å®è´¨ä¸Šæ˜¯åŠ å‰§äº†ç«äº‰çš„ï¼Œç«äº‰å…±åŒçš„èµ„æºã€‚</p><p>åœ¨äº‘æœåŠ¡çš„å±‚é¢ï¼Œä¸€è‡´æ€§å˜å¾—å°¤ä¸ºå›°éš¾ï¼Œå°¤å…¶æ˜¯å½“æˆ‘ä»¬éœ€è¦æ¨ªå‘çš„å»æ‰©å±•åˆ°ä¸åŒçš„æ•°æ®ä¸­å¿ƒå½“ä¸­å»çš„æ—¶å€™ã€‚æ ¹æ®CAPç†è®ºï¼Œä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§ä¸å¯èƒ½åŒæ—¶æ»¡è¶³ï¼Œå½“æˆ‘ä»¬è¦å®ç°ä¸€è‡´æ€§çš„æ—¶å€™ï¼ŒåŠ¿å¿…ä¼šä¸¢å¤±æ‰ä¸€éƒ¨åˆ†å¯ç”¨æ€§ï¼Œæˆ–è€…åˆ†åŒºå®¹é”™æ€§ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå·¥ç¨‹å¸ˆæ˜¯å¯ä»¥åœ¨ç¨‹åºçš„å±‚é¢å»è§£å†³ä¸€å®šçš„ä¸€è‡´æ€§çš„é—®é¢˜çš„ï¼Œä¸ä¸€å®šè¦å®Œå…¨ä¾èµ–äºæ•°æ®åº“å±‚é¢çš„ä¸€è‡´æ€§æ£€æµ‹ã€‚</p><p>æ•°æ®åº“ä¸€èˆ¬ä¼šæä¾›ä¸€ç³»åˆ—çš„éš”ç¦»çš„å±‚æ¬¡ï¼Œå› æ­¤åº”ç”¨å¼€å‘è€…å°±å¯ä»¥æ ¹æ®ä»–ä»¬æ‰€éœ€æ¥é€‰æ‹©æœ€é«˜æ•ˆçš„isolationæ–¹å¼ã€‚å¼±éš”ç¦»ä¼šæ›´å¿«ï¼Œä½†ä¹Ÿè®¸ä¼šå¸¦æ¥æ•°æ®ç«äº‰ã€‚æ›´å¼ºçš„éš”ç¦»æ¶ˆå‡äº†ä¸€äº›æ½œåœ¨çš„æ•°æ®éš”ç¦»ï¼Œä½†æ˜¯ä¼šæ›´æ…¢ï¼Œè€Œä¸”åœ¨æ…¢åˆ°ä¸€å®šç¨‹åº¦ï¼ŒTPSåˆç›¸å¯¹æ¯”è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œæ•°æ®åº“å¯èƒ½ä¼šè¢«é«˜TPSæ‹–å®ï¼Œå˜å¾—ä¸å¯è®¿é—®ã€‚</p><p><img src="https://i.loli.net/2020/04/26/wU6biJox59ZanGN.png" alt="Existing concurrency model.png"></p><p>åœ¨SQLæ ‡å‡†å½“ä¸­ï¼Œéš”ç¦»æ€§çš„å±‚çº§æœ‰ï¼š</p><ul><li>Serializable - æœ€ä¸¥æ ¼ï¼Œæœ€æ˜‚è´µçš„<ul><li>åºåˆ—åŒ–çš„æ‰§è¡Œä¼šè¦æ±‚å‰ä¸€ä¸ªtransactionå®Œå…¨æ‰§è¡Œå®Œï¼Œæ‰èƒ½å»æ‰§è¡Œä¸‹ä¸€ä¸ªtransaction  </li><li>å¸¸å¸¸è¢«ç§°ä¸ºsnapshot isolation </li></ul></li><li>Repeatable reads <ul><li>åœ¨å½“å‰transactionå½“ä¸­è¿˜æ²¡æäº¤çš„è¯»è¯·æ±‚å¯¹å½“å‰transactionæ˜¯å¯è§çš„ï¼Œä½†æ˜¯å…¶ä»–transactionåšå‡ºçš„æ”¹å˜å¯¹å½“å‰transactionä¾æ—§ä¸å¯è§</li></ul></li><li>Read Committed <ul><li>æœªæäº¤çš„è¯»å¯¹transactionä¸å¯è§</li><li>å¦‚æœå¦å¤–ä¸€ä¸ªtransactionæ’å…¥å¹¶æäº¤äº†æ–°çš„è¡Œï¼Œå½“å‰çš„transactionåœ¨queryçš„æ—¶å€™æ˜¯å¯ä»¥çœ‹åˆ°çš„</li></ul></li><li>Read uncommitted <ul><li>è„è¯»æ˜¯è¢«å…è®¸çš„</li><li>transactionså¯ä»¥çœ‹åˆ°å…¶ä»–transactionè¿˜æ²¡æœ‰æäº¤çš„commitã€‚å¾ˆå®ç”¨ä¸countè¿™ç§è¯·æ±‚</li></ul></li></ul><p>å…³äºå…·ä½“çš„ä¸€ä¸ªæ•°æ®åº“ï¼Œæ˜¯æ€ä¹ˆæ ·å¯¹å„çº§åˆ«çš„éš”ç¦»è¿›è¡Œå¤„ç†çš„ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/ept/hermitage" target="_blank" rel="noopener">Github - hermitage</a></p><h1 id="4-å½“ä½ æ— æ³•å®Œå…¨é”ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ä¹è§‚é”"><a href="#4-å½“ä½ æ— æ³•å®Œå…¨é”ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ä¹è§‚é”" class="headerlink" title="4. å½“ä½ æ— æ³•å®Œå…¨é”ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ä¹è§‚é”"></a>4. å½“ä½ æ— æ³•å®Œå…¨é”ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ä¹è§‚é”</h1><p>é”æ˜¯æåº¦æ˜‚è´µçš„ï¼Œè¿™ä¸ä»…ä»…æ˜¯å› ä¸ºåœ¨æ•°æ®åº“å½“ä¸­é€ æˆäº†å¼ºç«äº‰ï¼Œå¹¶ä¸”å› ä¸ºä»–ä»¬å¯¹äºé•¿è¿æ¥çš„è¦æ±‚ï¼Œè¿™ç§ä»ä½ çš„åº”ç”¨æœåŠ¡å™¨åˆ°æ•°æ®åº“çš„è¿æ¥éœ€è¦ä¸€ç›´ä¿æŒï¼Œæ˜¯éå¸¸è€—èµ„æºçš„ã€‚æ’å®ƒé”æ”¶åˆ°ç½‘ç»œåˆ†åŒºçš„å½±å“æ›´å¤§ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´éå¸¸éš¾debugçš„æ­»é”çš„é—®é¢˜ã€‚åœ¨æ’å®ƒé”ä¸æ˜“å®ç°çš„æƒ…å¢ƒä¸‹ï¼Œä¹è§‚é”æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰æ‹©ã€‚</p><p>ä¹è§‚é”ä»å®ç°ä¸Šæ˜¯æŒ‡å½“ä½ å»è¯»ä¸€è¡Œçš„æ—¶å€™ï¼Œè®°å½•ä¸‹æ¥ç‰ˆæœ¬å·ï¼Œæœ€åä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´æˆ–è€…æ˜¯checksumï¼Œæƒ³è¦è¾¾æˆçš„ç›®çš„å°±æ˜¯çŸ¥é“å½“å‰çš„å®ƒè¿˜æ˜¯å®ƒã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¿®æ”¹äº†æ•°æ®ä¹‹åå»æ£€æµ‹è¿™ä¸ªæ•°æ®æ˜¯å¦æœ‰è¢«æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±è¯å®å…¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„å†™æ“ä½œäº†ã€‚</p><pre><code>UPDATE productsSET name = &#39;Telegraph receiver&#39;, version = 2 WHERE id = 1 AND version = 1</code></pre><p>æ³¨æ„ä¹è§‚é”ä¸æ˜¯åœ¨æ•°æ®åº“å±‚é¢çš„é™åˆ¶äº†ï¼Œè€Œæ˜¯åœ¨åº”ç”¨ä»£ç çš„å±‚é¢ï¼ŒåŠ ä»¥é™åˆ¶ã€‚ </p><h1 id="5-é™¤äº†dirty-reads-å’Œdata-loss-ä½ å¯èƒ½é‡åˆ°å…¶ä»–çš„ä¸€äº›é—®é¢˜"><a href="#5-é™¤äº†dirty-reads-å’Œdata-loss-ä½ å¯èƒ½é‡åˆ°å…¶ä»–çš„ä¸€äº›é—®é¢˜" class="headerlink" title="5. é™¤äº†dirty reads å’Œdata loss ä½ å¯èƒ½é‡åˆ°å…¶ä»–çš„ä¸€äº›é—®é¢˜"></a>5. é™¤äº†dirty reads å’Œdata loss ä½ å¯èƒ½é‡åˆ°å…¶ä»–çš„ä¸€äº›é—®é¢˜</h1><p>å½“æˆ‘ä»¬è°ˆè®ºæ•°æ®ä¸€è‡´æ€§çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä¸»è¦å°†æ³¨æ„åŠ›æ”¾åœ¨å¯èƒ½çš„race conditionå½“ä¸­ï¼Œå…¶ä¼šå¯¼è‡´è„è¯»ï¼Œä»¥åŠæ•°æ®çš„ä¸¢å¤±ã€‚ä½†æ˜¯å¯èƒ½å‡ºç°çš„é—®é¢˜ä¸ä»…ä»…ä¼šå‡ºç°åœ¨è¿™ä¸ªæ–¹é¢çš„ã€‚</p><p>æ¯”å¦‚è¯´write skewé—®é¢˜ - å†™ååºï¼Œæ˜¯æŒ‡ä¸€è‡´æ€§çº¦æŸä¸‹çš„å¼‚å¸¸ç°è±¡ï¼Œå³ä¸¤ä¸ªå¹¶è¡Œäº‹åŠ¡éƒ½åŸºäºè‡ªå·±è¯»åˆ°çš„æ•°æ®å»è¦†ç›–å¦ä¸€éƒ¨åˆ†æ•°æ®é›†ï¼Œåœ¨ä¸²è¡ŒåŒ–çš„æƒ…å†µä¸‹ä¸¤ä¸ªäº‹åŠ¡æ— è®ºä½•ç§å…ˆåé¡ºåºï¼Œæœ€ç»ˆéƒ½å°†è¾¾åˆ°ä¸€è‡´çŠ¶æ€ï¼Œä½†æ˜¯åœ¨Snapshot Isolationçš„éš”ç¦»çº§åˆ«ä¸‹æ˜¯æ— æ³•å®ç°çš„ã€‚</p><pre><code>BEGIN tx1;                      BEGIN tx2;SELECT COUNT(*) FROM operatorsWHERE oncall = true;0                               SELECT COUNT(*)                                FROM operators                                WHERE oncall = TRUE;                                0UPDATE operators           UPDATE operatorsSET oncall = TRUE               SET oncall = TRUEWHERE userId = 4;               WHERE userId = 2;COMMIT tx1;                     COMMIT tx2;</code></pre><p>ä¸ºäº†è§£å†³write skewé—®é¢˜ï¼Œéœ€è¦åœ¨äº‹åŠ¡çš„è¿è¡Œé˜¶æ®µå¢åŠ å†²çªæ£€æµ‹ï¼Œè€Œä¸æ˜¯åœ¨æäº¤é˜¶æ®µã€‚é€šè¿‡åŠ å…¥äº‹åŠ¡å¼€å§‹æ—¶é—´æˆ³ä»¥åŠäº‹åŠ¡ç»“æŸæ—¶é—´æˆ³ï¼Œä¿è¯ä¸€ä¸ªäº‹åŠ¡è¯»çš„æ•°æ®çš„æœ€è¿‘ä¸€ä¸ªç‰ˆæœ¬çš„æäº¤æ—¶é—´è¦æ—©äºäº‹åŠ¡çš„å¼€å§‹æ—¶é—´ã€‚</p><h1 id="6-å…³äºäº‹åŠ¡æäº¤é¡ºåº"><a href="#6-å…³äºäº‹åŠ¡æäº¤é¡ºåº" class="headerlink" title="6. å…³äºäº‹åŠ¡æäº¤é¡ºåº"></a>6. å…³äºäº‹åŠ¡æäº¤é¡ºåº</h1><p>æ•°æ®åº“é¦–å…ˆæ˜¯æä¾›é¡ºåºä¿è¯çš„ï¼Œä½†æ˜¯è¿™ä¸ªé¡ºåºå’Œæˆ‘ä»¬æƒ³çš„å¯èƒ½ä¼šåˆä¸ç”¨ã€‚å³ä»æ•°æ®åº“çš„è§†è§’æ¥çœ‹ï¼Œå…³æ³¨çš„æ˜¯æ¥æ”¶åˆ°äº‹åŠ¡(transaction)çš„é¡ºåºï¼Œè€Œä¸æ˜¯å¼€å‘è€…ç¼–ç¨‹çœ‹åˆ°çš„é¡ºåºã€‚äº‹åŠ¡æ‰§è¡Œçš„é¡ºåºæ˜¯å¾ˆéš¾é¢„æµ‹çš„ï¼Œå°¤å…¶æ˜¯åœ¨é«˜å¹¶å‘çš„ç³»ç»Ÿå½“ä¸­ã€‚</p><p>å¦‚æœè¯´æ‰§è¡Œé¡ºåºéå¸¸å…³é”®çš„è¯ï¼Œæˆ‘ä»¬åº”å½“å°†å¤šæ¡å‘½ä»¤æ”¾åˆ°åŒä¸€ä¸ªæ•°æ®åº“transactionå½“ä¸­ã€‚è€é¿å¼€æäº¤æ—¶é—´ä¸ç¡®å®šçš„é—®é¢˜ã€‚</p><h1 id="7-åº”ç”¨å±‚é¢çš„æ•°æ®åº“åˆ†åŒºå¯ä»¥å¸ƒå±€åœ¨åº”ç”¨ä¹‹å¤–"><a href="#7-åº”ç”¨å±‚é¢çš„æ•°æ®åº“åˆ†åŒºå¯ä»¥å¸ƒå±€åœ¨åº”ç”¨ä¹‹å¤–" class="headerlink" title="7. åº”ç”¨å±‚é¢çš„æ•°æ®åº“åˆ†åŒºå¯ä»¥å¸ƒå±€åœ¨åº”ç”¨ä¹‹å¤–"></a>7. åº”ç”¨å±‚é¢çš„æ•°æ®åº“åˆ†åŒºå¯ä»¥å¸ƒå±€åœ¨åº”ç”¨ä¹‹å¤–</h1><p>æœ‰ç‚¹æ‹—å£ï¼Œæƒ³è¦è¯´æ˜çš„æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®åº“æ•°æ®é‡æŒç»­å¢å¤§çš„æ—¶å€™ï¼Œæ¨ªå‘çš„åˆ†åŒºå°±å˜å¾—å¿…ä¸å¯å°‘äº†ã€‚ä½†æ˜¯å¾ˆå¤šæ•°æ®åº“å¯èƒ½æ— æ³•åšå¥½æ¨ªå‘åˆ†åŒºï¼Œå³trafficä¼šéå¸¸ä¸å‡åŒ€ç­‰ç­‰ã€‚</p><p>æ ‡é¢˜æƒ³è¦é˜è¿°çš„ï¼Œè¿™ä¸ªåˆ†åŒºçš„é€»è¾‘ä¸éœ€è¦å¿…é¡»åœ¨ä½ çš„åº”ç”¨é‡Œè¾¹ï¼Œæˆ‘ä»¬å¯ä»¥å•ç‹¬æŠ½å–å‡ºä¸€ä¸ªå±‚çº§ï¼ŒåŒ…å«åˆ†åŒºé€»è¾‘ã€‚å³application server â€“&gt; shard servers â€“&gt; database nodesã€‚è¿™æ ·åˆ†ç¦»çš„å¥½å¤„æ˜¯éšç€æ•°æ®é‡çš„å¢å¤§ä»¥åŠè®¿é—®çš„æ•°æ®ç‰¹å¾çš„å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦çš„åˆ†åŒºé€»è¾‘ä¹Ÿä¼šä¸æ–­å‘ç”Ÿå˜åŒ–ã€‚åˆ†éš”å¼€å˜åŒ–ï¼Œä½¿å¾—åˆ†åŒºé€»è¾‘çš„æ”¹å˜ä¸éœ€è¦é‡æ–°deployåº”ç”¨æœåŠ¡å™¨ï¼ŒåŠ é€Ÿäº†æ•´ä¸ªå¼€å‘çš„è¿›ç¨‹ã€‚</p><h1 id="8-AUTOINCCREMENT-å¯èƒ½æœ‰å®³"><a href="#8-AUTOINCCREMENT-å¯èƒ½æœ‰å®³" class="headerlink" title="8. AUTOINCCREMENT å¯èƒ½æœ‰å®³"></a>8. AUTOINCCREMENT å¯èƒ½æœ‰å®³</h1><p>AUTOINCREMENTæ˜¯ä¸ªå¾ˆå¸¸è§çš„ç”Ÿæˆä¸»é”®çš„æ–¹å¼ï¼Œå¸¸å¸¸çœ‹åˆ°æ•°æ®åº“è¢«ç”¨æ¥ä½œä¸ºIDç”Ÿæˆå™¨ï¼Œæˆ–è€…æœ‰ä¸“é—¨çš„ä¸€ä¸ªæ•°æ®åº“ç”¨æ¥è´Ÿè´£åšIDçš„ç”Ÿæˆã€‚è¿™æ ·åšæœ‰å¯èƒ½ä¼šæ— ç›Šï¼Œä»¥ä¸‹æ˜¯ä¸€äº›åŸå› ï¼š</p><ul><li>åœ¨åˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿå½“ä¸­ï¼Œè‡ªåŠ¨å¢é•¿æ˜¯ä¸€ä¸ªå¾ˆå›°éš¾çš„äº‹æƒ…ã€‚æ˜¯éœ€è¦ä¸€ä¸ªglobal lockæ¥ç”ŸæˆIDçš„ã€‚å¦‚æœä½ å¯ä»¥ç”¨UUIDæ¥å–è€Œä»£ä¹‹çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å„ä¸ªæ•°æ®åº“èŠ‚ç‚¹ä¹‹é—´çš„åˆä½œäº†ã€‚å¸¦é”çš„è‡ªå¢æ“ä½œå¯èƒ½ä¼šå¼•å…¥å†²çªï¼Œæå¤§çš„é™ä½æ’å…¥æ“ä½œåœ¨åˆ†å¸ƒå¼æ•°æ®åº“å½“ä¸­çš„è¡¨ç°ã€‚</li><li>ä¸€äº›æ•°æ®åº“æ ¹æ®ä¸»é”®æ¥åšåˆ†åŒºç®—æ³•ï¼Œè¿ç»­çš„IDå¾ˆå¯èƒ½ä¼šå¯¼è‡´ä¸å¯æµ‹çš„çƒ­ç‚¹ï¼Œä¹Ÿè®¸ä¼šè®©ä¸€äº›åˆ†åŒºç‚¸æ‰çš„åŒæ—¶å…¶ä»–åˆ†åŒºå¾ˆç©ºé—²ã€‚</li><li>æœ€å¿«è®¿é—®æ•°æ®åº“å½“ä¸­ä¸€è¡Œçš„æ–¹å¼å°±æ˜¯é€šè¿‡å…¶ä¸»é”®ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæœ‰æ›´å¥½çš„å®šä¹‰ä¸€æ¡æ•°æ®çš„æ–¹å¼ï¼Œé‚£ä¹ˆä½¿ç”¨å…¶ä»–å¯Œå«æ„ä¹‰çš„å±æ€§æ¥ä½œä¸ºä¸»é”®ä¼šæ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</li></ul><h1 id="9-ä»»ä½•æ—¶é—´æºä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸åŒ"><a href="#9-ä»»ä½•æ—¶é—´æºä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸åŒ" class="headerlink" title="9. ä»»ä½•æ—¶é—´æºä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸åŒ"></a>9. ä»»ä½•æ—¶é—´æºä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸åŒ</h1><p>æ‰€æœ‰çš„æ—¶é—´ç›¸å…³çš„APIæ˜¯ä¸å‡†ç¡®çš„ï¼Œæˆ‘ä»¬çš„æœºå™¨å¹¶ä¸æ˜¯æ¸…æ¥šçš„çŸ¥é“å½“å‰å…·ä½“æ˜¯ä»€ä¹ˆæ—¶é—´çš„ã€‚æˆ‘ä»¬çš„ç”µè„‘éƒ½åŒ…å«ä¸€ä¸ªçŸ³è‹±æ™¶ç‰‡ï¼Œå¯ä»¥ç”¨æ¥äº§ç”Ÿä¿¡å·ï¼Œè®©æ—¶é—´å¼€å§‹èµ°ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¸‹ï¼Œä¸ä¼šéå¸¸ç²¾å‡†ï¼Œæ€»ä¼šæ¯”å®é™…çš„æ—¶é—´ç¨å¾®å¿«ä¸€äº›æˆ–è€…æ…¢ä¸€äº›ã€‚ä¸ºäº†ç²¾ç¡®æ€§ï¼Œæˆ‘ä»¬çš„ç”µè„‘ä¸Šçš„æ—¶é—´å°±éœ€è¦æ ¹æ®å®é™…æ—¶é—´æ¥è¿›è¡ŒåŒæ­¥ã€‚</p><p>NTPæœåŠ¡å™¨å¯ä»¥è¢«ç”¨æ¥å¯¹æ—¶é—´è¿›è¡ŒåŒæ­¥ï¼Œä½†æ˜¯å¥½ç©çš„æ˜¯åŒæ­¥æœ¬èº«åˆä¼šå› ä¸ºç½‘ç»œå»¶æ—¶ä¸å¤Ÿå‡†ç¡®ã€‚è°·æ­Œæ˜¯ä½¿ç”¨TrueTimeæœåŠ¡æ¥åšçš„</p><ul><li>å…¶ä½¿ç”¨ä¸¤ç§ä¸åŒçš„èµ„æºï¼š GPSå’ŒåŸå­é’Ÿã€‚ä»–ä»¬æœ‰ä¸åŒçš„å¤±è´¥æ¨¡å¼ï¼Œå› æ­¤äºŒè€…å¹¶ç”¨èƒ½å¤Ÿå¢åŠ å¯ä¿¡èµ–åº¦ã€‚</li><li>TrueTimeç”¨æ—¶é—´é—´éš”æ¥è¡¨ç¤ºè¿”å›çš„æ—¶é—´ï¼Œå³å½“å‰æ—¶é—´ä¸€å®šåœ¨ä¸€ä¸ªåŒºé—´ä¹‹å†…ï¼Œæ‰€åšçš„äº‹æƒ…å°±æ˜¯ä¿è¯åœ¨è¿™ä¸ªåŒºé—´çš„å¯ä¿¡åº¦è¶³å¤Ÿé«˜äº†</li></ul><h1 id="10-è¯„ä¼°æ•°æ®åº“åœ¨å•ä¸ªäº‹åŠ¡ä¸­çš„è¡¨ç°"><a href="#10-è¯„ä¼°æ•°æ®åº“åœ¨å•ä¸ªäº‹åŠ¡ä¸­çš„è¡¨ç°" class="headerlink" title="10. è¯„ä¼°æ•°æ®åº“åœ¨å•ä¸ªäº‹åŠ¡ä¸­çš„è¡¨ç°"></a>10. è¯„ä¼°æ•°æ®åº“åœ¨å•ä¸ªäº‹åŠ¡ä¸­çš„è¡¨ç°</h1><p>æœ‰äº›æ—¶å€™æ•°æ®åº“ä¼šå®£ä¼ è‡ªå·±çš„è¡¨ç°ä»¥åŠç‰¹å¾ï¼Œç„¶åè¯´è‡ªå·±çš„latencyï¼Œè¯»å†™ååé‡æœ‰å¤šä¹ˆå¤šä¹ˆçš„å¤§ã€‚ä½†æ˜¯â€¦ ç¦»å¼€å…·ä½“åœºæ™¯çš„æ•°æ®éƒ½æ˜¯è€æµæ°“ï¼Œæˆ‘ä»¬éœ€è¦æ›´åŠ ç»†è‡´çš„è¡¡é‡æ–¹å¼æ¥è¯„ä¼°æ•°æ®åº“åœ¨ä¸€äº›éå¸¸å…³é”®çš„æ“ä½œæˆ–è€…äº‹åŠ¡ä¸‹çš„è¡¨ç°ã€‚</p><p>æ¯”å¦‚ï¼š</p><ul><li>å½“åœ¨ä¸€ä¸ªæœ‰5000ä¸‡è¡Œçš„æ•°æ®åº“å½“ä¸­æ’å…¥æ–°çš„ä¸€è¡Œçš„ååé‡å’Œå»¶æ—¶</li><li>å½“æŸ¥è¯¢ç”¨æˆ·çš„æœ‹å‹çš„æœ‹å‹ï¼ˆæœ‹å‹çš„å¹³å‡æ•°é‡å¤§è‡´ä¸º500ï¼‰çš„å»¶æ—¶</li><li>è·å–ç”¨æˆ·æ—¶é—´çº¿ä¸Šå‰100æ¡æ•°æ®çš„å»¶æ—¶ï¼Œå‡å®šç”¨æˆ·è®¢é˜…äº†500ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·æ¯å°æ—¶ä¼šå‘é€næ¡ä¿¡æ¯</li></ul><p>æˆ‘ä»¬éœ€è¦æ ¹æ®ä½¿ç”¨æ•°æ®åº“çš„å®é™…åœºæ™¯æ¥åšé’ˆå¯¹æ€§çš„æµ‹è¯•ï¼Œæ¥æ›´åŠ æ·±å…¥çš„ç†è§£è¿™ä¸ªæ•°æ®åº“çš„ç‰¹å¾</p><h1 id="11-äº‹åŠ¡å½“ä¸­ä¸åº”è¯¥ä¿å­˜åº”ç”¨çš„çŠ¶æ€"><a href="#11-äº‹åŠ¡å½“ä¸­ä¸åº”è¯¥ä¿å­˜åº”ç”¨çš„çŠ¶æ€" class="headerlink" title="11. äº‹åŠ¡å½“ä¸­ä¸åº”è¯¥ä¿å­˜åº”ç”¨çš„çŠ¶æ€"></a>11. äº‹åŠ¡å½“ä¸­ä¸åº”è¯¥ä¿å­˜åº”ç”¨çš„çŠ¶æ€</h1><p>è¿˜æ˜¯è¦æ³¨é‡ç›¸äº’ä¹‹é—´çš„éš”ç¦»çš„ï¼Œclientç«¯åœ¨ç½‘ç»œå‡ºç°é—®é¢˜çš„æ—¶å€™å¸¸å¸¸ä¼šä¸åœé‡è¯•è¯·æ±‚ã€‚å¦‚æœäº‹åŠ¡ä¾èµ–äºä¸€äº›èƒ½å¤Ÿåœ¨å…¶ä»–åœ°æ–¹è¢«æ”¹å˜çš„çŠ¶æ€ï¼Œé‚£ä¹ˆäº‹åŠ¡å½“ä¸­å¯èƒ½å°±ä¼šæ‹¿åˆ°é”™è¯¯çš„æ•°æ®ï¼Œå¯¼è‡´éšå«é”™è¯¯çš„å‡ºç°ï¼Œå¼€å‘è€…æ˜¯å¾ˆéš¾æ‰¾åˆ°è¿™ç§ç±»å‹çš„é”™è¯¯çš„ã€‚</p><pre><code>var seq int64with newTransaction():     newSeq := atomic.Increment(&amp;seq)     Entries.query(newSeq)     // Other operations...</code></pre><p>è­¬å¦‚è¿™ç§é”™è¯¯ï¼Œäº‹åŠ¡å½“ä¸­ä¼šå¯¹sequence numberåšç´¯åŠ æ“ä½œï¼Œå½“ç½‘ç»œå‡ºç°é—®é¢˜ï¼Œä¼šå›æ»šï¼Œä½†æ˜¯seqæ•°å­—å·²ç»å¢åŠ äº†ï¼Œè¿™å°±å¯¼è‡´äº†ä¸‹æ¬¡æ‰§è¡Œçš„ç»“æœå’Œä¸Šæ¬¡æœ¬åº”è¯¥è·å¾—çš„ç»“æœä¼šå‡ºç°ä¸åŒã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://medium.com/@rakyll/things-i-wished-more-developers-knew-about-databases-2d0178464f78" target="_blank" rel="noopener">https://medium.com/@rakyll/things-i-wished-more-developers-knew-about-databases-2d0178464f78</a> </li><li><a href="https://www.quora.com/Why-doesnt-NoSQL-support-an-ACID-property" target="_blank" rel="noopener">https://www.quora.com/Why-doesnt-NoSQL-support-an-ACID-property</a></li><li><a href="https://en.wikipedia.org/wiki/CAP_theorem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/CAP_theorem</a></li><li><a href="https://jepsen.io/consistency" target="_blank" rel="noopener">https://jepsen.io/consistency</a> </li><li><a href="https://blog.csdn.net/oaa608868/article/details/54866899" target="_blank" rel="noopener">https://blog.csdn.net/oaa608868/article/details/54866899</a></li><li><a href="http://www.nosqlnotes.com/technotes/mvcc-snapshot-isolation/" target="_blank" rel="noopener">http://www.nosqlnotes.com/technotes/mvcc-snapshot-isolation/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CAP </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript Dependency Hell - å¯¹äºJSä¾èµ–æ ‘çš„åˆ†æ</title>
      <link href="/JavaScript-Dependency-Hell-%E5%AF%B9%E4%BA%8EJS%E4%BE%9D%E8%B5%96%E6%A0%91%E7%9A%84%E5%88%86%E6%9E%90/"/>
      <url>/JavaScript-Dependency-Hell-%E5%AF%B9%E4%BA%8EJS%E4%BE%9D%E8%B5%96%E6%A0%91%E7%9A%84%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>åšå‰ç«¯å¼€å‘çš„åŒå­¦è‚¯å®šéƒ½å¯¹npmå¾ˆç†Ÿæ‚‰ï¼Œnode package managerï¼Œä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„åŒ…ç®¡ç†å™¨ã€‚npmé€šè¿‡<code>package.json</code>æ¥å¯¹é¡¹ç›®å½“ä¸­çš„åŒ…è¿›è¡Œç®¡ç†ï¼Œåœ¨è¿™ä¸ªjsonæ–‡ä»¶å½“ä¸­çš„åŒ…ç›¸å½“äºå°±è¢«npmæ³¨å†Œäº†ã€‚</p><h1 id="1-ä»€ä¹ˆæ˜¯package-json"><a href="#1-ä»€ä¹ˆæ˜¯package-json" class="headerlink" title="1. ä»€ä¹ˆæ˜¯package.json?"></a>1. ä»€ä¹ˆæ˜¯package.json?</h1><ul><li><p>å…¶å®šä¹‰äº†ä½ çš„é¡¹ç›®æ‰€ä¾èµ–çš„æ‰€æœ‰åŒ…</p></li><li><p>å¹¶æŒ‡å®šä½ çš„é¡¹ç›®æ‰€ç”¨çš„åŒ…çš„ç‰ˆæœ¬å·</p></li><li><p>è®©ä½ çš„buildæ˜¯å¯ä»¥å¤åˆ¶çš„ï¼Œæ–¹ä¾¿å…¶ä»–å¼€å‘è€…æ¥ä½¿ç”¨</p><h1 id="2-Package-json-ä¸­çš„ä¾èµ–ç§ç±»"><a href="#2-Package-json-ä¸­çš„ä¾èµ–ç§ç±»" class="headerlink" title="2. Package.json ä¸­çš„ä¾èµ–ç§ç±»"></a>2. Package.json ä¸­çš„ä¾èµ–ç§ç±»</h1></li><li><p>dependencies </p><ul><li>è¿™é‡Œå®šä¹‰äº†ä½ çš„ä»£ç æ‰€éœ€è¦çš„å…³é”®ä¾èµ–</li></ul></li><li><p>devDependencies </p><ul><li>è¿™é‡Œå®šä¹‰äº†ä½ çš„å¼€å‘æ‰€ä½¿ç”¨çš„çš„ä¾èµ–ï¼Œæ¯”å¦‚ç»™ä»£ç æ ·å¼çš„perttier åº“</li></ul></li><li><p>peerDependencies </p><ul><li>è¿™é‡Œæ˜¯å‘Šè¯‰å…¶ä»–å¼€å‘è€…ï¼Œå½“ä½¿ç”¨äº†ä½ çš„è¿™ä¸ªåŒ…ä»¥åï¼Œä»–ä»¬éœ€è¦å®šä¹‰åœ¨è¿™é‡Œçš„åŒ…çš„ç‰¹å®šç‰ˆæœ¬</li></ul></li><li><p>optionalDependencies </p><ul><li>å¯é€‰çš„ä¾èµ–ï¼Œä¸å®‰è£…ä»–ä»¬ä¸ä¼šæ¯åå®‰è£…çš„è¿‡ç¨‹</li></ul></li><li><p>bundledDependencies </p><ul><li>è¿™é‡ŒåŒ…å«çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨çš„åŒ…ï¼Œä»–ä»¬ä¼šè¢«æ‰“åŒ…åˆ°ä¸€èµ·æ¥å¼•å…¥åˆ°ä½ çš„é¡¹ç›®å½“ä¸­ã€‚è¿™ä¸ªåœ¨ä½ çš„ä¾èµ–åŒ…ä¸åœ¨npmå½“ä¸­çš„æƒ…å†µä¸‹æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚    <h1 id="3-ä½¿ç”¨package-lock-jsonçš„ç›®çš„"><a href="#3-ä½¿ç”¨package-lock-jsonçš„ç›®çš„" class="headerlink" title="3. ä½¿ç”¨package-lock.jsonçš„ç›®çš„"></a>3. ä½¿ç”¨package-lock.jsonçš„ç›®çš„</h1>package-lockçš„ä½¿ç”¨ç›®çš„ï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„åšæ–‡å½“ä¸­æœ‰è¯¦ç»†çš„æè¿°è¿‡ â€“ <a href="https://llchen60.com/%E5%85%B3%E4%BA%8Epackage-lock-json/" target="_blank" rel="noopener">ç›¸å…³åšæ–‡</a>ã€‚æ€»çš„æ¥è¯´ï¼Œæœ‰packge-lock.json èƒ½å¤Ÿç»™æˆ‘ä»¬æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå°†commitçš„å›é€€å’Œä¾èµ–çš„å›é€€åˆ†éš”å¼€ï¼Œå³æˆ‘å¯ä»¥ä½¿ç”¨è¿‡å»çš„ä¾èµ–æ ‘è¿è¡Œå½“å‰çš„ä»£ç ï¼Œè¿™åœ¨æ²¡æœ‰lock jsonçš„æ—¶å€™æ˜¯å¾ˆéš¾å®ç°çš„ã€‚</li></ul></li></ul><h1 id="4-ä¾èµ–æ ‘çš„ä¾‹å­ä¸ç®€åŒ–"><a href="#4-ä¾èµ–æ ‘çš„ä¾‹å­ä¸ç®€åŒ–" class="headerlink" title="4. ä¾èµ–æ ‘çš„ä¾‹å­ä¸ç®€åŒ–"></a>4. ä¾èµ–æ ‘çš„ä¾‹å­ä¸ç®€åŒ–</h1><pre><code>// ä»¥gatsbyä¸ºä¾‹, know the size of your node_modules overall du -sh node_modules// list the size decending $ du -sh ./node_modules/* | sort -nr | grep &#39;\dM.*&#39; 17M    ./node_modules/rxjs8.4M    ./node_modules/@types7.4M    ./node_modules/core-js6.8M    ./node_modules/@babel5.4M    ./node_modules/gatsby5.2M    ./node_modules/eslint4.8M    ./node_modules/lodash3.6M    ./node_modules/graphql-compose3.6M    ./node_modules/@typescript-eslint3.5M    ./node_modules/webpack3.4M    ./node_modules/moment3.3M    ./node_modules/webpack-dev-server3.2M    ./node_modules/caniuse-lite3.1M    ./node_modules/graphql</code></pre><p>â€¦</p><pre><code>// !!! moved unused modules and dependenciesnpm dedup </code></pre><p>è§£è€¦æ“ä½œçš„è¿è¡Œæœºç†ï¼Œå°±æ˜¯å¯»æ‰¾ä¸åŒä¾èµ–ä¹‹é—´çš„å…¬æœ‰çš„åŒ…ï¼Œç„¶åå¤ç”¨è¿™äº›å…±æœ‰çš„åŒ…ã€‚</p><p>å¯¹äºå¯è§†åŒ–ï¼Œç”¨ä¸€äº›ç°æˆçš„å·¥å…·å¯ä»¥è¢«ç”¨æ¥è§‚å¯Ÿæ•´ä¸ªåŒ…çš„ä¾èµ–çŠ¶æ€ï¼Œè­¬å¦‚ï¼š</p><ul><li><a href="https://npm.anvaka.com/#/" target="_blank" rel="noopener">https://npm.anvaka.com/#/</a></li><li><a href="http://npm.broofa.com/" target="_blank" rel="noopener">http://npm.broofa.com/</a></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.appsignal.com/2020/04/09/ride-down-the-javascript-dependency-hell.html" target="_blank" rel="noopener">https://blog.appsignal.com/2020/04/09/ride-down-the-javascript-dependency-hell.html</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JaveScript </tag>
            
            <tag> JS Dependency </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typescriptå­¦ä¹ ç¬”è®°(äºŒ)</title>
      <link href="/Typescript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C/"/>
      <url>/Typescript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<ul><li><p>ç±»å‹åˆ«å</p><ul><li>ç”¨æ¥ä¸ºä¸€ä¸ªç±»å‹èµ·ä¸€ä¸ªæ–°åå­—</li></ul></li></ul><pre><code>type Name = string; </code></pre><ul><li>å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹</li></ul><pre><code>type EventNames = &#39;click&#39; | &#39;scroll&#39; | &#39;mousemove&#39;;function handleEvent(ele: Element, event: EventNames) {    // do something}handleEvent(document.getElementById(&#39;hello&#39;), &#39;scroll&#39;);  // æ²¡é—®é¢˜handleEvent(document.getElementById(&#39;world&#39;), &#39;dbclick&#39;); // æŠ¥é”™ï¼Œevent ä¸èƒ½ä¸º &#39;dbclick&#39;// index.ts(7,47): error TS2345: Argument of type &#39;&quot;dbclick&quot;&#39; is not assignable to parameter of type &#39;EventNames&#39;.</code></pre><ul><li>å…ƒç»„  - Tuple<ul><li>Tupleå¯ä»¥ç”¨äºåˆå¹¶ä¸åŒç±»å‹çš„å¯¹è±¡</li></ul></li></ul><pre><code>let tom: [string, number] = [&#39;Tom&#39;, 25];</code></pre><ul><li>æšä¸¾<ul><li>ç”¨äºå–å€¼è¢«é™å®šåœ¨ä¸€å®šèŒƒå›´å†…çš„åœºæ™¯</li><li>ä½¿ç”¨enumè¿›è¡Œå®šä¹‰çš„</li><li>æšä¸¾æˆå‘˜ä¼šè¢«èµ‹å€¼ä¸ºä»0å¼€å§‹é€’å¢çš„æ•°å­—ï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¹æšä¸¾å€¼åˆ°æšä¸¾åè¿›è¡Œåå‘æ˜ å°„</li></ul></li></ul><pre><code>enum Days {Sun, Mon, Tue, Wed, Thu, Fri, Sat};console.log(Days[&quot;Sun&quot;] === 0); // trueconsole.log(Days[&quot;Mon&quot;] === 1); // trueconsole.log(Days[&quot;Tue&quot;] === 2); // trueconsole.log(Days[&quot;Sat&quot;] === 6); // trueconsole.log(Days[0] === &quot;Sun&quot;); // trueconsole.log(Days[1] === &quot;Mon&quot;); // trueconsole.log(Days[2] === &quot;Tue&quot;); // trueconsole.log(Days[6] === &quot;Sat&quot;); // true</code></pre><ul><li>ç±»ï¼Œç±»ä¸æ¥å£<ul><li>ä½¿ç”¨classå®šä¹‰ç±»ï¼Œä½¿ç”¨constructorå®šä¹‰æ„é€ å‡½æ•°ï¼Œé€šè¿‡newç”Ÿæˆæ–°å®ä¾‹çš„æ—¶å€™ï¼Œæ˜¯ä¼šè‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°çš„</li></ul></li></ul><pre><code>class Animal {    constructor(name) {        this.name = name;    }    sayHi() {        return `My name is ${this.name}`;    }}let a = new Animal(&#39;Jack&#39;);console.log(a.sayHi()); // My name is Jack</code></pre><ul><li><p>ç±»é€šè¿‡extendsç»§æ‰¿</p><ul><li><p>ç„¶åé€šè¿‡superå…³é”®è¯æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°å’Œæ–¹æ³•</p><p>class Cat extends Animal {<br>  constructor(name) {</p><pre><code>  super(name); // è°ƒç”¨çˆ¶ç±»çš„ constructor(name)  console.log(this.name);</code></pre><p>  }<br>  sayHi() {</p><pre><code>  return &#39;Meow, &#39; + super.sayHi(); // è°ƒç”¨çˆ¶ç±»çš„ sayHi()</code></pre><p>  }<br>}</p><p>let c = new Cat(â€˜Tomâ€™); // Tom<br>console.log(c.sayHi()); // Meow, My name is Tom</p></li></ul></li><li><p>æ³›å‹</p><p>  function createArray<T>(length: number, value: T): Array<T> {</p><pre><code>  let result: T[] = [];  for (let i = 0; i &lt; length; i++) {      result[i] = value;  }  return result;</code></pre><p>  }</p><p>  createArray(3, â€˜xâ€™); // [â€˜xâ€™, â€˜xâ€™, â€˜xâ€™]</p></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://ts.xcatliu.com/advanced/type-aliases" target="_blank" rel="noopener">https://ts.xcatliu.com/advanced/type-aliases</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScriptç¬”è®°(ä¸€)</title>
      <link href="/TypeScript%E7%AC%94%E8%AE%B0-0/"/>
      <url>/TypeScript%E7%AC%94%E8%AE%B0-0/</url>
      
        <content type="html"><![CDATA[<p>Tl;dr </p><p>è¿™ä¼šæ˜¯ä¸€ç¯‡å¾ˆé•¿çš„åšæ–‡ï¼Œå¤§éƒ¨åˆ†å†…å®¹éƒ½ç›´æ¥æ¥è‡ªReferenceå½“ä¸­çš„TypeScriptæ•™ç¨‹å’ŒES6æ•™ç¨‹ï¼Œåªæ˜¯ä¸ºäº†æ€»ç»“ä¸€äº›è‡ªå·±è®¤ä¸ºé‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œä»¥åŠä¸€äº›è®¤ä¸ºéœ€è¦æ·±å…¥ç†è§£çš„åœ°æ–¹åŠå…¶å»¶ä¼¸çš„é“¾æ¥ï¼Œå¸Œæœ›æœ‰å¸®åŠ©ã€‚</p><h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><ul><li>JavaScriptè¶…é›†ï¼Œæä¾›äº†ç±»å‹ç³»ç»Ÿå’Œå¯¹ES6çš„æ”¯æŒï¼Œç”±Microsoftå¼€å‘</li></ul><h2 id="1-2-ä¼˜åŠ¿"><a href="#1-2-ä¼˜åŠ¿" class="headerlink" title="1.2 ä¼˜åŠ¿"></a>1.2 ä¼˜åŠ¿</h2><ul><li>å¢åŠ ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§<ul><li>ç±»å‹ç³»ç»Ÿæ˜¯å¾ˆå¥½çš„æ–‡æ¡£ï¼Œçœ‹ç±»å‹çš„å®šä¹‰æˆ‘ä»¬å°±èƒ½å¤ŸçŸ¥é“å¦‚ä½•ä½¿ç”¨äº†</li><li>å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå‘ç°å¤§éƒ¨åˆ†é”™è¯¯ï¼Œæ¯”è¿è¡Œæ—¶å‡ºé”™å¥½å¾ˆå¤š</li><li>å¢å¼ºç¼–è¾‘å™¨çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»£ç è¡¥å…¨ï¼Œæ¥å£æç¤ºï¼Œè·³è½¬åˆ°å®šä¹‰ï¼Œé‡æ„ç­‰</li></ul></li><li>å…¼å®¹æ€§å¥½<ul><li>jsæ–‡ä»¶å®é™…ä¸Šæ˜¯å¯ä»¥ç›´æ¥é‡å‘½åä¸ºtsæ–‡ä»¶çš„</li><li>åŠæ—¶ä¸æ˜¾å¼å®šä¹‰ç±»å‹ï¼Œä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨åšå‡ºç±»å‹æ¨è®º  </li></ul></li></ul><h2 id="1-3-ç›¸å¯¹åŠ£åŠ¿"><a href="#1-3-ç›¸å¯¹åŠ£åŠ¿" class="headerlink" title="1.3 ç›¸å¯¹åŠ£åŠ¿"></a>1.3 ç›¸å¯¹åŠ£åŠ¿</h2><ul><li>å­¦ä¹ æˆæœ¬ <ul><li>æ¥å£ </li><li>æ³›å‹</li><li>ç±»</li></ul></li><li>çŸ­æœŸå¢åŠ å¼€å‘æˆæœ¬ï¼Œè¦å¤šå†™ä¸€äº›ç±»å‹çš„å®šä¹‰ï¼Œä½†æ˜¯å¯¹äºéœ€è¦é•¿æœŸç»´æŠ¤çš„é¡¹ç›®ï¼ŒTypeScriptèƒ½å¤Ÿå‡å°‘å…¶ç»´æŠ¤æˆæœ¬</li><li>é›†æˆåˆ°æ„å»ºæµç¨‹å½“ä¸­éœ€è¦ä¸€äº›å·¥ä½œé‡çš„ </li></ul><h1 id="2-åŸºç¡€çŸ¥è¯†"><a href="#2-åŸºç¡€çŸ¥è¯†" class="headerlink" title="2. åŸºç¡€çŸ¥è¯†"></a>2. åŸºç¡€çŸ¥è¯†</h1><h2 id="2-1-åŸå§‹æ•°æ®ç±»å‹"><a href="#2-1-åŸå§‹æ•°æ®ç±»å‹" class="headerlink" title="2.1 åŸå§‹æ•°æ®ç±»å‹"></a>2.1 åŸå§‹æ•°æ®ç±»å‹</h2><ul><li><p>å¸ƒå°”å€¼ - boolean</p><pre><code>  let isSuccessful: boolean = true;  let createdByNewBoolean: boolean = new Boolean(1);  // Type &#39;Boolean&#39; is not assignable to type &#39;boolean&#39;.  // &#39;boolean&#39; is a primitive, but &#39;Boolean&#39; is a wrapper object. Prefer using &#39;boolean&#39; when possible.  let createdByNewBoolean: Boolean = new Boolean(1);  // when you new Boolean, it will create a Boolean - a wrapper object  let createdByBoolean: boolean = Boolean(1);   // create a boolean </code></pre></li></ul><ul><li><p>æ•°å€¼ - number</p><pre><code>  let decLiteral: number = 6;</code></pre></li><li><p>å­—ç¬¦ä¸² - string</p></li></ul><pre><code>    let myName: string = &#39;Tom&#39;;    let myAge: number = 25;    // æ¨¡æ¿å­—ç¬¦ä¸²  `ç”¨æ¥å®šä¹‰æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œ${}ç”¨æ¥åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥è¡¨è¾¾å¼    let sentence: string = `Hello, my name is ${myName}.    I&#39;ll be ${myAge + 1} years old next month.`;</code></pre><ul><li>null &amp; undefined<ul><li>null å’Œ undefinedæ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹</li><li>voidç±»å‹çš„å˜é‡ä¸èƒ½èµ‹å€¼ç»™numberç±»å‹çš„å˜é‡</li></ul></li><li>symbol</li></ul><h2 id="2-2-ä»»æ„å€¼-Any"><a href="#2-2-ä»»æ„å€¼-Any" class="headerlink" title="2.2 ä»»æ„å€¼ - Any"></a>2.2 ä»»æ„å€¼ - Any</h2><p>ä»»æ„å€¼ç”¨æ¥è¡¨ç¤ºå…è®¸èµ‹å€¼ä¸ºä»»æ„ç±»å‹ã€‚åœ¨Typescriptå½“ä¸­ï¼Œæ™®é€šç±»å‹åœ¨å¤åˆ¶è¿‡ç¨‹ä¸­æ”¹å˜ç±»å‹æ˜¯ä¸è¢«å…è®¸çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯anyç±»å‹ï¼Œåˆ™å…è®¸è¢«èµ‹å€¼ä¸ºä»»æ„ç±»å‹ã€‚</p><pre><code>    let myFavoriteNumber: any = &#39;seven&#39;;    myFavoriteNumber = 7;</code></pre><ul><li>ä»»æ„å€¼ä¸Šè®¿é—®ä»»ä½•å±æ€§éƒ½æ˜¯å…è®¸çš„ï¼Œä¹Ÿå…è®¸è°ƒç”¨ä»»ä½•æ–¹æ³•</li><li>è¿”å›çš„ç±»å‹éƒ½æ˜¯ä»»æ„å€¼</li><li>å¯¹äºæœªå£°æ˜ç±»å‹çš„å˜é‡<ul><li>æœªæŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆä¼šè¢«è¯†åˆ«ä¸ºä»»æ„å€¼ç±»å‹</li></ul></li></ul><h2 id="2-3-ç±»å‹æ¨è®º"><a href="#2-3-ç±»å‹æ¨è®º" class="headerlink" title="2.3 ç±»å‹æ¨è®º"></a>2.3 ç±»å‹æ¨è®º</h2><p>å¦‚æœæ²¡æœ‰æ˜ç¡®çš„æŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆTypeScriptä¼šæŒ‰ç…§ç±»å‹æ¨è®º - Type Inferenceçš„è§„åˆ™æ¨æ–­å‡ºä¸€ä¸ªç±»å‹ã€‚</p><pre><code>let myFavoriteNumber = &#39;seven&#39;;myFavoriteNumber = 7;// index.ts(2,1): error TS2322: Type &#39;number&#39; is not assignable to type &#39;string&#39;.  ç¼–è¯‘çš„æ—¶å€™å‡ºé”™ï¼Œå› ä¸ºTSè‡ªåŠ¨åšäº†ç±»å‹æ¨è®ºï¼Œå¹¶ä¸”è®¤å®šå…¶ä¸ºä¸€ä¸ªstringç±»å‹</code></pre><p>ä½†æ˜¯å¦‚æœå®šä¹‰çš„æ—¶å€™æ²¡æœ‰èµ‹å€¼ï¼Œé‚£ä¹ˆä¸ç®¡æ¥ä¸‹æ¥æ˜¯å¦ä¼šèµ‹å€¼ï¼Œéƒ½ä¼šè¢«æ¨æ–­æˆanyç±»å‹è€Œå®Œå…¨ä¸è¢«ç±»å‹æ£€æŸ¥</p><pre><code>let myFavoriteNumber;myFavoriteNumber = &#39;seven&#39;;myFavoriteNumber = 7;</code></pre><h2 id="2-4-è”åˆç±»å‹-Union-Types"><a href="#2-4-è”åˆç±»å‹-Union-Types" class="headerlink" title="2.4 è”åˆç±»å‹ - Union Types"></a>2.4 è”åˆç±»å‹ - Union Types</h2><pre><code>let myFavoriteNumber: string | number;myFavoriteNumber = &#39;seven&#39;;myFavoriteNumber = 7;</code></pre><p>è”åˆç±»å‹å½“ä¸­ä½¿ç”¨ <code>|</code>æ¥åˆ†å‰²æ¯ä¸ªç±»å‹</p><h2 id="2-5-æ¥å£"><a href="#2-5-æ¥å£" class="headerlink" title="2.5 æ¥å£"></a>2.5 æ¥å£</h2><ul><li><p>åœ¨TypeScriptå½“ä¸­ï¼Œä½¿ç”¨æ¥å£å®šä¹‰å¯¹è±¡çš„ç±»å‹ï¼Œé™¤äº†å¯ä»¥å¯¹ç±»çš„ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡ŒæŠ½è±¡ä»¥å¤–ï¼Œä¹Ÿchangâ€™yoä¸ªä¸å¯¹ å¯¹è±¡çš„å½¢çŠ¶è¿›è¡Œæè¿°ã€‚</p><p>  interface Person {</p><pre><code>  name: string;  age: number;</code></pre><p>  }</p><p>  let tom: Person = {</p><pre><code>  name: &#39;Tom&#39;,  age: 25</code></pre><p>  };</p></li></ul><p>åœ¨åšèµ‹å€¼çš„æ—¶å€™ï¼Œå®šä¹‰çš„å˜é‡éœ€è¦å’Œæ¥å£æœ‰ä¸€æ ·çš„å±æ€§ã€‚</p><ul><li><p>å¯¹äºæˆ‘ä»¬æƒ³è¦å¯é€‰æ‹©çš„åŒ¹é…çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¯é€‰å±æ€§çš„æ–¹å¼ï¼š</p><p>  interface Person {</p><pre><code>  name: string;  age?: number;</code></pre><p>  }</p><p>  let tom: Person = {</p><pre><code>  name: &#39;Tom&#39;</code></pre><p>  };</p></li><li><p>ä¹Ÿå¯ä»¥é…ç½®ï¼Œæ˜¯çš„æ¥å£èƒ½å¤Ÿæ¥ä»»æ„çš„å±æ€§ï¼š â€“ <code>[propName: string] : any</code></p><ul><li><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸€æ—¦å®šä¹‰äº†ä»»æ„å±æ€§ï¼Œé‚£ä¹ˆç¡®å®šå±æ€§å’Œå¯é€‰å±æ€§çš„ç±»å‹éƒ½å¿…é¡»æ˜¯å®ƒçš„ç±»å‹çš„å­é›† </p><p>interface Person {<br>  name: string;<br>  age?: number;<br>  [propName: string]: any;<br>}</p><p>let tom: Person = {<br>  name: â€˜Tomâ€™,<br>  gender: â€˜maleâ€™<br>};</p></li></ul></li><li><p>åªè¯»å±æ€§</p><ul><li>æœ‰use caseæˆ‘ä»¬å¸Œæœ›å¯¹è±¡å½“ä¸­çš„ä¸€äº›å­—æ®µåªèƒ½åœ¨åˆ›å»ºçš„æ—¶å€™è¢«èµ‹å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ä½¿ç”¨readonlyå®šä¹‰åªè¯»å±æ€§</li></ul></li></ul><h2 id="2-6-æ•°ç»„ç±»å‹"><a href="#2-6-æ•°ç»„ç±»å‹" class="headerlink" title="2.6 æ•°ç»„ç±»å‹"></a>2.6 æ•°ç»„ç±»å‹</h2><ul><li>ä½¿ç”¨ç±»å‹+æ–¹æ‹¬å·æ¥å®šä¹‰</li></ul><pre><code>let fibonacci: number[] = [1, 1, 2, 3, 5];</code></pre><ul><li>ä½¿ç”¨æ•°ç»„æ³›å‹æ¥è¡¨ç¤ºæ•°ç»„ â€“ <code>Array&lt;elemType&gt;</code></li></ul><pre><code>let fibonacci: Array&lt;number&gt; = [1, 1, 2, 3, 5];</code></pre><ul><li>ä½¿ç”¨æ¥å£è¡¨ç¤ºæ•°ç»„</li></ul><pre><code>interface NumberArray {    [index: number]: number;}let fibonacci: NumberArray = [1, 1, 2, 3, 5];</code></pre><h2 id="2-7-å‡½æ•°ç±»å‹"><a href="#2-7-å‡½æ•°ç±»å‹" class="headerlink" title="2.7 å‡½æ•°ç±»å‹"></a>2.7 å‡½æ•°ç±»å‹</h2><h3 id="2-7-1-å‡½æ•°å£°æ˜"><a href="#2-7-1-å‡½æ•°å£°æ˜" class="headerlink" title="2.7.1 å‡½æ•°å£°æ˜"></a>2.7.1 å‡½æ•°å£°æ˜</h3><pre><code>// å‡½æ•°å£°æ˜ï¼ˆFunction Declarationï¼‰function sum(x, y) {    return x + y;}// å‡½æ•°è¡¨è¾¾å¼ï¼ˆFunction Expressionï¼‰let mySum = function (x, y) {    return x + y;};// TypeScriptä¸‹çš„å‡½æ•°å£°æ˜function sum(x: number, y:number):number {    return x + y;}</code></pre><h3 id="2-7-2-å‡½æ•°è¡¨è¾¾å¼"><a href="#2-7-2-å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="2.7.2 å‡½æ•°è¡¨è¾¾å¼"></a>2.7.2 å‡½æ•°è¡¨è¾¾å¼</h3><pre><code>let mySum: (x: number, y: number) =&gt; number = function (x: number, y: number): number {    return x + y;};</code></pre><p>æ³¨æ„åœ¨ä¸Šè¿°ä»£ç å½“ä¸­ï¼Œè·Ÿåœ¨mySumåé¢çš„æ˜¯å¯¹äºè¾“å…¥å‚æ•°å’Œè¾“å‡ºå‚æ•°çš„è§„å®šï¼Œä¸­é—´ç”¨ç®­å¤´æ¥è¿›è¡Œè¿æ¥ï¼Œè¿™æ˜¯TypeScriptçš„è§„èŒƒã€‚</p><p>å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨æ¥å£æ¥å®šä¹‰å‡½æ•°çš„å½¢çŠ¶ï¼š</p><pre><code>interface SearchFunc {    (source: string, subString: string): boolean;}let mySearch: SearchFunc;mySearch = function(source: string, subString: string) {    return source.search(subString) !== -1;}</code></pre><h3 id="2-7-3-å¯é€‰å‚æ•°"><a href="#2-7-3-å¯é€‰å‚æ•°" class="headerlink" title="2.7.3 å¯é€‰å‚æ•°"></a>2.7.3 å¯é€‰å‚æ•°</h3><ul><li>ä½¿ç”¨é—®å·è·Ÿåœ¨å‚æ•°åå­—ä¹‹åè¡¨ç¤ºæ˜¯å¯é€‰çš„ï¼Œæ³¨æ„å¯é€‰å‚æ•°éœ€è¦åœ¨å‚æ•°åˆ—è¡¨çš„æœ«å°¾ï¼Œå…¶ä¹‹åä¸èƒ½æœ‰å¿…éœ€å‚æ•°äº†</li></ul><pre><code>function buildName(firstName: string, lastName?: string) {    if (lastName) {        return firstName + &#39; &#39; + lastName;    } else {        return firstName;    }}</code></pre><h3 id="2-7-4-å‚æ•°é»˜è®¤ä¸å‰©ä½™å‚æ•°"><a href="#2-7-4-å‚æ•°é»˜è®¤ä¸å‰©ä½™å‚æ•°" class="headerlink" title="2.7.4 å‚æ•°é»˜è®¤ä¸å‰©ä½™å‚æ•°"></a>2.7.4 å‚æ•°é»˜è®¤ä¸å‰©ä½™å‚æ•°</h3><pre><code>// é»˜è®¤å‚æ•°function buildName(firstName: string, lastName: string = &#39;Cat&#39;) {    return firstName + &#39; &#39; + lastName;}let tomcat = buildName(&#39;Tom&#39;, &#39;Cat&#39;);let tom = buildName(&#39;Tom&#39;);// ä½¿ç”¨ ...æ¥è·å–å‡½æ•°å½“ä¸­çš„å‰©ä½™å‚æ•°function push(array, ...items) {    items.forEach(function(item) {        array.push(item);    });}let a: any[] = [];push(a, 1, 2, 3);</code></pre><h2 id="2-8-å£°æ˜æ–‡ä»¶"><a href="#2-8-å£°æ˜æ–‡ä»¶" class="headerlink" title="2.8 å£°æ˜æ–‡ä»¶"></a>2.8 å£°æ˜æ–‡ä»¶</h2><p>å½“ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¼•ç”¨å®ƒçš„å£°æ˜æ–‡ä»¶ï¼Œä»¥è·å¾—å¯¹åº”çš„ä»£ç è¡¥å…¨ï¼Œæ¥å£æç¤ºçš„åŠŸèƒ½</p><h3 id="2-8-1-å£°æ˜è¯­å¥"><a href="#2-8-1-å£°æ˜è¯­å¥" class="headerlink" title="2.8.1 å£°æ˜è¯­å¥"></a>2.8.1 å£°æ˜è¯­å¥</h3><p>æ¯”å¦‚æˆ‘ä»¬æƒ³ä½¿ç”¨jqueryï¼Œä¸€èˆ¬æ¥è¯´æ˜¯åŠ scriptæ ‡ç­¾ï¼Œä½†æ˜¯tså½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨declare varæ¥å®šä¹‰å…¶ç±»å‹</p><pre><code>declare var jQuery: (selector: string) =&gt; any;jQuery(&#39;#foo&#39;);</code></pre><p>æˆ‘ä»¬ä¼šå°†å£°æ˜è¯­å¥æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å½“ä¸­ï¼Œè­¬å¦‚å¯¹äºä¸Šè¿°çš„ä¾‹å­ï¼Œå°±æ˜¯æ”¾åˆ°jQuery.d.ts å½“ä¸­<br>å£°æ˜æ–‡ä»¶å¿…é¡»ä»¥<code>.d.ts</code>æ¥ç»“å°¾</p><p>tsä¼šè§£æé¡¹ç›®å½“ä¸­æ‰€æœ‰çš„*.tsæ–‡ä»¶ï¼Œä¹ŸåŒ…å«äº†.d.tsç»“å°¾çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å®šä¹‰.d.tsæ–‡ä»¶ä»¥åï¼Œé‡Œé¢çš„å†…å®¹æ˜¯ä¼šè¢«æ•´ä¸ªé¡¹ç›®å…±äº«çš„ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡@types æ¥ç»Ÿä¸€ç®¡ç†ç¬¬ä¸‰æ–¹åº“çš„å£°æ˜æ–‡ä»¶</p><h3 id="2-8-2-ä¹¦å†™å£°æ˜æ–‡ä»¶"><a href="#2-8-2-ä¹¦å†™å£°æ˜æ–‡ä»¶" class="headerlink" title="2.8.2 ä¹¦å†™å£°æ˜æ–‡ä»¶"></a>2.8.2 ä¹¦å†™å£°æ˜æ–‡ä»¶</h3><p>å½“ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰æä¾›å£°æ˜æ–‡ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦è‡ªå·±ä¹¦å†™å£°æ˜æ–‡ä»¶äº†ã€‚</p><p>åº“çš„ä½¿ç”¨åœºæ™¯ä¸»è¦æœ‰ï¼š</p><ul><li>å…¨å±€å˜é‡ </li><li>npmåŒ…</li><li>UMDåº“</li><li>ç›´æ¥æ‰©å±•å…¨å±€å˜é‡</li></ul><p>è¯¦æƒ…çœ‹ <a href="https://ts.xcatliu.com/basics/declaration-files#xin-yu-fa-suo-yin" target="_blank" rel="noopener">link</a></p><h1 id="2-9-å†…ç½®å¯¹è±¡"><a href="#2-9-å†…ç½®å¯¹è±¡" class="headerlink" title="2.9 å†…ç½®å¯¹è±¡"></a>2.9 å†…ç½®å¯¹è±¡</h1><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects" target="_blank" rel="noopener">ECMAScript å†…ç½®å¯¹è±¡</a></p><p><a href="https://github.com/Microsoft/TypeScript/tree/master/src/lib" target="_blank" rel="noopener">DOM DOM å†…ç½®å¯¹è±¡</a></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://ts.xcatliu.com/" target="_blank" rel="noopener">https://ts.xcatliu.com/</a></li><li><a href="https://es6.ruanyifeng.com/" target="_blank" rel="noopener">https://es6.ruanyifeng.com/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºpackage-lock.json</title>
      <link href="/%E5%85%B3%E4%BA%8Epackage-lock-json/"/>
      <url>/%E5%85%B3%E4%BA%8Epackage-lock-json/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬å°†node package manager (npm) å‡çº§åˆ°5.0ä»¥ä¸Šçš„ç‰ˆæœ¬çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°npmè¿è¡Œçš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ â€“ package-lock.jsonã€‚</p><p>é‡Œé¢åŒ…å«çš„æ˜¯æˆ‘ä»¬çš„ä¾èµ–å…³ç³»ï¼Œå„ç§ä¾èµ–çš„åŒ…å’Œç‰ˆæœ¬å·ã€‚package-lock.jsonä¼šåœ¨npmä¿®æ”¹äº†node_modules æ ‘æˆ–è€…ä¿®æ”¹äº†package.jsonä¹‹åè‡ªåŠ¨ç”Ÿæˆã€‚å®ƒç²¾ç¡®çš„æè¿°äº†æ•´ä¸ªç”Ÿæˆçš„æ ‘ï¼Œä½¿å¾—æ¥ä¸‹æ¥ä»»ä½•ä¸€æ¬¡çš„è£…é…éƒ½å¯ä»¥ç”Ÿæˆå®Œå…¨ä¸€è‡´çš„ä¾èµ–æ ‘.è¿™ä¸ªç”Ÿæˆçš„æ–‡ä»¶æ˜¯éœ€è¦commit åˆ°remote branchä¸Šçš„ï¼Œå…¶ç›®çš„åœ¨äºï¼š</p><ul><li>æè¿°å•ä¸ªä¾èµ–æ ‘ï¼Œä½¿å¾—å…¶ä»–äººåœ¨åšdeployçš„æ—¶å€™ä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸€è‡´çš„ä¾èµ–</li><li>ä½¿å¾—ä½¿ç”¨äººå‘˜æœ‰èƒ½åŠ›ç›´æ¥è·³è½¬å›åŸå…ˆçš„ä¾èµ–çŠ¶æ€ï¼Œè€Œä¸éœ€è¦å°†ä»£ç ä¹Ÿå›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬</li><li>åŠ å¼ºäº†ä¾èµ–æ”¹å˜çš„é˜…è¯»æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç›¸å¯¹ç›´è§‚çš„çœ‹åˆ°æ¯æ¬¡çš„commitéƒ½æœ‰ä»€ä¹ˆä¾èµ–è¢«æ”¹å˜äº†</li><li>ä¹Ÿå¯ä»¥é€šè¿‡æ˜¯çš„npmè·³è¿‡å¯¹äºåŸå…ˆå®‰è£…è¿‡çš„åŒ…çš„é‡å¤çš„å…ƒæ•°æ®åˆ†ææ¥ä¼˜åŒ–æ•´ä¸ªå®‰è£…çš„è¿›ç¨‹</li></ul><p>é’ˆå¯¹å…¶ç‰¹å¾ï¼Œæˆ‘ä»¬æ˜¯åº”è¯¥å°†package-lock.jsonä¹Ÿæäº¤ä¸Šå»çš„ï¼Œè¿™ä¼šç»™å¼€å‘ï¼ŒåŒæ­¥å¸¦æ¥ä¸å°çš„å¸®åŠ©ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8" target="_blank" rel="noopener">https://medium.com/coinmonks/everything-you-wanted-to-know-about-package-lock-json-b81911aa8ab8</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨æˆ·ç”»åƒæ„å»ºæ€è·¯</title>
      <link href="/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%9E%84%E5%BB%BA%E6%80%9D%E8%B7%AF/"/>
      <url>/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%9E%84%E5%BB%BA%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>ç”¨æˆ·ç”»åƒæŒ‡çš„æ˜¯ç³»ç»Ÿé€šè¿‡ç”¨æˆ·è‡ªå·±ä¸Šä¼ çš„ä¿¡æ¯ä»¥åŠè‡ªå·±çš„åˆ†æï¼Œè®°å½•äº†ç”¨æˆ·çš„å¤§é‡çš„ä¿¡æ¯ï¼Œè€Œåä¸ºäº†ä¾¿äºå»ç»™å„ä¸ªç³»ç»Ÿæ¥ä½¿ç”¨ï¼Œå°†è¿™äº›ä¿¡æ¯è¿›è¡Œæ²‰æ·€åŠ å·¥ï¼Œå½¢æˆä¸€ä¸ªæ ‡ç­¾æ ‘çš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p>ç”»åƒæ˜¯ç”±æ ‡ç­¾æ ‘åŠæœ«çº§æ ‡ç­¾çš„æ ‡ç­¾å€¼æ„æˆçš„ï¼Œå…¨é¢å®šé‡åˆ»ç”»ç”¨æˆ·çš„ç»“æ„åŒ–ä¿¡æ¯äº§å“ã€‚ç”»åƒæ˜¯æ ‡ç­¾çš„æ€»æˆï¼Œç”¨æˆ·æ ‡ç­¾æ˜¯å…·ä½“åˆ»ç”»ç”¨æˆ·çš„ç»“æ„åŒ–ä¿¡æ¯ï¼Œä»¥ä¸‹ç®€ç§°æ ‡ç­¾ã€‚</p><p>ç”¨æˆ·ç”»åƒå¯¹äºå…¬å¸çš„è¿è¥ï¼Œç›ˆåˆ©éƒ½æœ‰å¾ˆå¤§çš„å¥½å¤„ï¼š</p><ol><li>å¯ä»¥ç”¨äºç»Ÿè®¡ï¼Œä½¿å¾—å¯¹äº§å“ï¼Œå¯¹ç”¨æˆ·æœ‰åŸºæœ¬è®¤çŸ¥</li><li>ç”¨äºå®šå‘è¥é”€å’Œç²¾ç»†åŒ–è¿è¥</li><li>è¿˜å¯ä»¥ç”¨äºç®—æ³•å½“ä¸­ï¼Œåœ¨æœç´¢æ¨èï¼Œé£æ§å¹¿å‘Šç­‰ç­–ç•¥é˜²çº¿ï¼Œæ ‡ç­¾è¢«ä½œä¸ºç”¨æˆ·ç‰¹å¾å¾—ä»¥æå–å’Œä½¿ç”¨</li></ol><h1 id="2-æ„å»ºæ ‡ç­¾æ ‘"><a href="#2-æ„å»ºæ ‡ç­¾æ ‘" class="headerlink" title="2. æ„å»ºæ ‡ç­¾æ ‘"></a>2. æ„å»ºæ ‡ç­¾æ ‘</h1><p>ä¸€ä¸ªå¥½çš„æ ‡ç­¾æ ‘éœ€è¦å…·æœ‰é«˜æ¦‚æ‹¬æ€§å’Œå¼ºå»¶å±•æ€§ï¼Œé«˜æ¦‚æ‹¬æ€§æ„å‘³ç€ç»“æ„ä½“ç³»èƒ½å¤Ÿå¾ˆå¥½çš„åŒ…å«ä¸€ä¸ªç”¨æˆ·çš„<strong>åŸºæœ¬å±æ€§</strong>å’Œ<strong>äº§å“äº¤äº’çš„ç›¸å…³è¡Œä¸º</strong>ï¼ŒåŒæ—¶å¯¹äºä¸šåŠ¡é‡ç‚¹å•ç‹¬å¼ºè°ƒï¼Œæ²¡æœ‰é—æ¼ï¼›â€œå¼ºå»¶å±•æ€§â€æ„å‘³ç€ç»“æ„å…¨é¢çš„åŒæ—¶ä¹Ÿæœ‰ä¸€å®šçš„æŠ½è±¡æ¦‚æ‹¬èƒ½åŠ›ï¼Œä¿è¯æ–°å¢çš„æ ‡ç­¾å¯ä»¥å¾ˆå¥½çš„æ‰¾åˆ°å¯¹åº”çš„åˆ†ç±»ï¼Œæ•´ä¸ªä½“ç³»ä¸ä¼šè¿‡äºæ”¶æ•›å±€é™ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªåŸåˆ™ï¼Œç”»åƒå¯ä»¥ä»ä»¥ä¸‹ç»´åº¦è¿›è¡Œç»„ç»‡ï¼š </p><ul><li><p>åŸºæœ¬å±æ€§</p><ul><li>æŒ‡ä¸€ä¸ªç”¨æˆ·çš„åŸºæœ¬ç¤¾ä¼šå±æ€§å’Œå˜æ›´é¢‘ç‡æ¯”è¾ƒä½çš„ç‰¹å¾<ul><li>çœŸå®ç¤¾ä¼šå¹´é¾„</li><li>æ€§åˆ«</li><li>å©šå§»çŠ¶å†µ</li><li>æ˜µç§°</li><li>å·ç </li><li>è´¦å·</li><li>lbs </li></ul></li></ul></li><li><p>å¹³å°å±æ€§</p><ul><li>å¹³å°å±æ€§æ˜¯ç”¨æˆ·åœ¨å¹³å°ä¸Šè¡¨ç°å‡ºçš„åŸºæœ¬å±æ€§ç‰¹å¾ï¼Œæ˜¯åˆ©ç”¨ç”¨æˆ·è¡Œä¸ºè¿›è¡Œç®—æ³•æŒ–æ˜ï¼Œæ ‡è¯†ç”¨æˆ·çœŸå®å±æ€§çš„æ ‡ç­¾</li><li>è­¬å¦‚å¹³å°å¹´é¾„æ ‡ç­¾  é¢å‘ä¾‹å¦‚å¹´é¾„ä¸º20å²ï¼Œä½†æ˜¯å¿ƒç†å¹´é¾„50å²ï¼Œç©¿è¡£é£æ ¼50å²çš„äººï¼›åä¹‹äº¦ç„¶</li><li>å¹³å°å±æ€§å’ŒåŸºæœ¬å±æ€§çš„åŒºåˆ«å¦‚ä¸‹ï¼š<ul><li>æ•°æ®æºä¸è®¡ç®—é€»è¾‘<ul><li>åŸºç¡€å±æ€§æ˜¯åˆ©ç”¨ç”¨æˆ·è‡ªè¡Œä¸Šä¼ çš„å­˜å‚¨åœ¨ç”¨æˆ·åŸºç¡€ä¿¡æ¯è¡¨é‡Œçš„æ•°æ®ï¼Œå¹³å°å±æ€§åˆ™åˆ©ç”¨å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯åŸ‹ç‚¹ä¸ŠæŠ¥é‡‡é›†çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®è¿›è¡ŒæŒ–æ˜è®¡ç®—ç”Ÿæˆçš„ã€‚</li><li>åŸºæœ¬å±æ€§æ˜¯å…¸å‹çš„ç›´é‡‡å‹æ ‡ç­¾ï¼Œå¹³å°å±æ€§æ˜¯å…¸å‹çš„ç®—æ³•æŒ–æ˜å‹æ ‡ç­¾</li></ul></li><li>æœ«çº§æ ‡ç­¾å’Œè¾“å‡ºæ ‡ç­¾å€¼<ul><li>å¹³å°å±æ€§ä»£è¡¨ç”¨æˆ·åœ¨æ€§åˆ«ç»´åº¦ä¸Šçš„åå¥½æ¦‚ç‡ï¼Œå¯ä»¥ç”Ÿæˆç±»ä¼¼<code>æ€§åˆ«_å¥³_0.80</code>è¿™æ ·çš„æ ‡ç­¾ï¼Œ0.8ä»£è¡¨äº†ç”¨æˆ·çš„å€¾å‘ç¨‹åº¦</li></ul></li><li>åº”ç”¨åœºæ™¯<ul><li>å¹³å°å±æ€§é€šè¿‡ç”¨æˆ·è¡Œä¸ºè¿›è¡ŒæŒ–æ˜ï¼Œæ›´èƒ½ä»£è¡¨ç”¨æˆ·çš„çœŸå®å€¾å‘ï¼Œè¾“å‡ºç»“æœæ¯”åŸºæœ¬å±æ€§å‡†ç¡®ç‡æ›´é«˜</li></ul></li></ul></li></ul></li><li><p>è¡Œä¸ºå±æ€§</p><ul><li>è¡Œä¸ºå±æ€§è®°å½•ç”¨æˆ·çš„æ‰€æœ‰å•ä¸ªç‚¹çš„è¡Œä¸º</li><li>åŒ…æ‹¬<ul><li>å¯åŠ¨</li><li>ç™»å½•</li><li>æµè§ˆ</li><li>ç‚¹å‡»</li><li>åŠ è½¦</li><li>ä¸‹å•</li></ul></li><li>æ˜¯å¯ä»¥å’Œä¸åŒçš„äº§å“ï¼Œä¸åŒçš„æ¨¡å—è¿›è¡Œäº¤äº’çš„ï¼Œè€Œä¸”å¯ä»¥åœ¨ä¸åŒçš„æ—¶é—´çª—å£è¿›è¡Œé€‰å–ï¼Œè¡Œä¸ºä¼šç›¸å¯¹å¤æ‚</li><li>æŒ‰ç…§ äº§å“ x åŠŸèƒ½æ¨¡å— x ç”¨æˆ·å•ç‚¹è¡Œä¸º x æ—¶é—´  è¿™å››ä¸ªè¦ç´ æ¥è¿›è¡Œç»„ç»‡  </li></ul></li><li><p>äº§å“åå¥½</p><ul><li>å¯¹ç”¨æˆ·ä½¿ç”¨æŸäº›äº§å“ï¼Œäº§å“æ ¸å¿ƒåŠŸèƒ½æˆ–è€…å…¶ä»–æ¸ é“çš„åå¥½ç¨‹åº¦çš„åˆ»ç”»ï¼Œå±äºæŒ–æ˜æ€§çš„æ ‡ç­¾</li><li>äº§å“å¯ä»¥åŒ…æ‹¬è‡ªå·±å…¬å¸çš„ï¼Œç«å“çš„</li><li>åŠŸèƒ½æ¸ é“åŒ…æ‹¬ç«™å†…äº§å“åŠŸèƒ½ï¼ŒåŒ…æ‹¬pushã€çŸ­ä¿¡ã€å¼€å±ã€å¼¹çª—ç­‰å‡ å¤§è¿è¥å’Œäº§å“æ–¹å¼ </li></ul></li><li><p>å…´è¶£åå¥½</p><ul><li>å“ç‰Œåå¥½  nike</li><li>ç±»ç›®åå¥½  è¿åŠ¨</li><li>æ ‡ç­¾åå¥½  è·‘æ­¥_0.7</li></ul></li><li><p>æ•æ„Ÿåº¦</p><ul><li>è¥é”€æ´»åŠ¨ä¸­ï¼Œä¼šæ³¨æ„åˆ°æœ‰äº›ç”¨æˆ·ä¸éœ€è¦ä¼˜æƒ ä¹Ÿä¼šä¸‹å•ï¼Œè€Œæœ‰äº›ç”¨æˆ·ä¸€å®šè¦é€šè¿‡ä¼˜æƒ åˆ¸åˆºæ¿€æ‰èƒ½å®ç°è½¬åŒ–ï¼Œä¼˜æƒ åˆ¸çš„é¢åº¦ä¹Ÿä¼šå½±å“ç”¨æˆ·ä¸‹å•çš„é‡‘é¢</li><li>éœ€è¦è¯†åˆ«å¯¹ä¼˜æƒ æ•æ„Ÿçš„ç”¨æˆ·ï¼Œå‘æ”¾åˆç†çš„åˆ¸é¢ï¼Œä¿è¯ä¼˜æƒ åˆ¸ä¸æµªè´¹ï¼Œä½¿å¾—æ•´ä¸ªä¿ƒé”€æ´»åŠ¨çš„ROIæœ€å¤§</li><li>æ„å»ºç”¨æˆ·çš„æ•æ„Ÿåº¦æ ‡ç­¾<ul><li>ä¼˜æƒ ä¿ƒé”€æ•æ„Ÿåº¦</li><li>æ´»åŠ¨æ•æ„Ÿåº¦</li><li>æ–°å“æ•æ„Ÿåº¦</li><li>çˆ†æ¬¾æ•æ„Ÿåº¦ </li></ul></li></ul></li><li><p>æ¶ˆè´¹å±æ€§</p><ul><li>æ¶ˆè´¹é¢‘æ¬¡</li><li>æ¶ˆè´¹é‡‘é¢</li><li>æœ€è¿‘æ¶ˆè´¹æ—¶é—´</li><li>æ¶ˆè´¹èƒ½åŠ›</li><li>æ¶ˆè´¹æ„æ„¿ </li></ul></li><li><p>ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸ</p><ul><li>æ–°æ‰‹</li><li>æˆé•¿</li><li>æˆç†Ÿ</li><li>è¡°é€€</li><li>æµå¤± </li></ul></li><li><p>ç”¨æˆ·ä»·å€¼</p><ul><li>æ´»è·ƒåº¦</li><li>è£‚å˜æ‹‰æ–°ç­‰ </li></ul></li></ul><h1 id="3-ç”¨æˆ·ç”»åƒçš„èŒƒä¾‹"><a href="#3-ç”¨æˆ·ç”»åƒçš„èŒƒä¾‹" class="headerlink" title="3. ç”¨æˆ·ç”»åƒçš„èŒƒä¾‹"></a>3. ç”¨æˆ·ç”»åƒçš„èŒƒä¾‹</h1><p><img src="https://i.loli.net/2020/04/14/XnJYc3ejRrMwdul.png" alt="ç”¨æˆ·ç”»åƒå¯¼å›¾.png"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.infoq.cn/article/oUqJDlfstrYAmTBYzier?utm_source=rss&amp;utm_medium=article" target="_blank" rel="noopener">https://www.infoq.cn/article/oUqJDlfstrYAmTBYzier?utm_source=rss&amp;utm_medium=article</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”¨æˆ·ç”»åƒ </tag>
            
            <tag> è¿è¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å°</title>
      <link href="/%E4%B8%AD%E5%8F%B0/"/>
      <url>/%E4%B8%AD%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯ä¸­å°ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯ä¸­å°ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ä¸­å°ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯ä¸­å°ï¼Ÿ</h1><p>çœ‹åˆ°å‡ ç¯‡å…³äºä¸­å°çš„åšå®¢ï¼Œæ˜¯å›½å†…æå‡ºçš„ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼Œç¨å¾®ç ”ç©¶äº†ä¸‹ï¼Œå¾ˆæœ‰æ„æ€çš„æ¦‚å¿µã€‚</p><p>ä¸­å°ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œä»ä¸šåŠ¡ä¸Šæ¥è®²ï¼Œå¯ä»¥è¯´æ˜¯ä¸ºäº†è§£å†³ç³»ç»Ÿçš„å¤ç”¨æ€§çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œé˜¿é‡Œåˆšåˆšå¼€å§‹çš„æ—¶å€™åªæœ‰æ·˜å®ï¼Œä½†æ˜¯åæ¥å‡ºç°äº†å¤©çŒ«ï¼ŒäºŒè€…å°½ç®¡é¡¶å±‚ä¸šåŠ¡é€»è¾‘æœ‰ä¸åŒï¼Œä½†æ˜¯ä»–ä»¬éƒ½æ˜¯éœ€è¦ä¸€å¥—è®¢å•ï¼Œå•†å“ï¼Œåº“å­˜ï¼Œä»“å‚¨ï¼Œç‰©æµçš„å„ç§ç³»ç»Ÿçš„ã€‚å¦‚æœæ¯æ¬¡æˆ‘ä»¬æƒ³åšä¸€ä¸ªæ–°çš„ä¸šåŠ¡æ¨¡å—çš„æ—¶å€™ï¼Œéƒ½è¦æ¥å®ç°è¿™æ ·ä¸€å¥—ç³»ç»Ÿï¼Œè¿­ä»£é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œè€Œä¸”å¾ˆå®¹æ˜“åœ¨åšæ”¹åŠ¨çš„æ—¶å€™å› ä¸ºå„ä¸ªç±»ä¼¼åŠŸèƒ½çš„ç³»ç»Ÿçš„æ”¹åŠ¨ä¸ä¸€è‡´äº§ç”Ÿé”™è¯¯ã€‚</p><p>å› æ­¤ï¼Œå°†è¿™äº›å…¬ç”¨çš„ç³»ç»Ÿæå‡ï¼Œåšæˆâ€“ä¸­å°ï¼Œç»Ÿä¸€æ¥ä½¿å¾—å„ä¸ªä¸šåŠ¡éƒ¨é—¨é‡å¤ä½¿ç”¨ï¼Œå°†éœ€è¦åå¤å»ºè®¾çš„åŠŸèƒ½å’Œç³»ç»Ÿè¿›è¡Œç»Ÿä¸€çš„è§„åˆ’å’Œç®¡ç†ã€‚</p><p>ä¸»è¦è§£å†³çš„é—®é¢˜å®è´¨ä¸Šæœ‰ä¸¤ç±»ï¼š </p><ol><li>éœ€è¦ä¸šåŠ¡éœ€æ±‚æˆ–è€…åŠŸèƒ½éœ€æ±‚æ˜¯é«˜åº¦ç±»ä¼¼çš„ï¼Œé€šç”¨åŒ–ç¨‹åº¦å¾ˆé«˜ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰ä¸“é—¨çš„å›¢é˜Ÿè´Ÿè´£è§„åˆ’å’Œå¼€å‘ï¼Œå¤§é‡çš„ç³»ç»Ÿé‡å¤å¼€å‘ã€é‡å¤å»ºè®¾ã€å¯¼è‡´å¤ç”¨æ€§å¾ˆä½ï¼Œæ•ˆç‡ä½ï¼Œç ”å‘èµ„æºè¢«æµªè´¹ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿä¸å¤Ÿç»Ÿä¸€</li><li>æ—©èµ·ä¸šåŠ¡å‘å±•è¿‡ç¨‹å½“ä¸­ï¼Œä¸ºäº†è§£å†³å½“ä¸‹çš„ä¸€äº›ä¸šåŠ¡é—®é¢˜ï¼Œå‚ç›´çš„ä¸ªæ€§åŒ–çš„ä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€ç³»ç»Ÿè€¦åˆå¤ªæ·±ï¼Œç”±äºæ²¡æœ‰å¹³å°æ€§è´¨çš„è§„åˆ’ï¼Œæ¨ªå‘ç³»ç»Ÿä¹‹é—´ã€ä¸Šä¸‹æ¸¸ç³»ç»Ÿä¹‹é—´çš„äº¤å‰é€»è¾‘éå¸¸å¤šï¼Œå¯¼è‡´äº†åœ¨æ–°ä¸šåŠ¡æ–°å¸‚åœºçš„æ‹“å±•è¿‡ç¨‹å½“ä¸­ï¼Œå¸‚åœºæ²¡æœ‰åŠæ³•ç›´æ¥å¤ç”¨ï¼Œç”šè‡³æ²¡æœ‰åŠæ³•å¿«é€Ÿè¿­ä»£ã€‚</li></ol><h1 id="2-ä¸ºä»€ä¹ˆè¦ä¸­å°ï¼Œä¸ºä»€ä¹ˆè¦å¹³å°åŒ–ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆè¦ä¸­å°ï¼Œä¸ºä»€ä¹ˆè¦å¹³å°åŒ–ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆè¦ä¸­å°ï¼Œä¸ºä»€ä¹ˆè¦å¹³å°åŒ–ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆè¦ä¸­å°ï¼Œä¸ºä»€ä¹ˆè¦å¹³å°åŒ–ï¼Ÿ</h1><p>å¼•è¿°ã€Šç™½è¯ä¸­å°æˆ˜ç•¥ã€‹å½“ä¸­çš„å†…å®¹ï¼Œâ€œå› ä¸ºåœ¨å½“ä»Šäº’è”ç½‘æ—¶ä»£ï¼Œâ½¤æˆ·æ‰æ˜¯å•†ä¸šæˆ˜åœºçš„ä¸­å¿ƒï¼Œä¸ºäº†å¿«é€Ÿå“åº”ç”¨æˆ·çš„éœ€æ±‚ï¼Œå€ŸåŠ©å¹³å°åŒ–çš„åŠ›é‡å¯ä»¥äº‹åŠåŠŸå€â€</p><blockquote><p>ä¸æ–­å¿«é€Ÿå“åº”ã€æ¢ç´¢ã€æŒ–æ˜ã€å¼•é¢†â½¤æˆ·çš„éœ€æ±‚ï¼Œæ‰æ˜¯ä¼ä¸šå¾—ä»¥â½£å­˜å’ŒæŒç»­å‘å±•çš„å…³é”®å› ç´ ã€‚</p></blockquote><blockquote><p>é‚£äº›çœŸæ­£å°Šé‡ç”¨æˆ·ï¼Œç”šâ¾„ä¸æƒœè°ƒæ•´â¾ƒå·±é¢ è¦†â¾ƒå·±æ¥å“åº”â½¤æˆ·çš„ä¼ä¸šå°†åœ¨è¿™åœºä»¥â½¤æˆ·ä¸ºä¸­å¿ƒçš„å•†ä¸šæˆ˜äº‰ä¸­å¾—ä»¥â½£å­˜å’Œå‘å±•ï¼›â½½åä¹‹ï¼Œé‚£äº›åœ¨è¿‡å»çš„æˆå°±ä¸Šæ•…æ­¥â¾ƒå°ï¼Œå­˜åœ¨ä¾¥å¹¸â¼¼ç†å¸Œæœ›â½¤æˆ·ä¼šåƒä¹‹å‰ä¸€æ ·ç»§ç»­è¿½éšâ¾ƒå·±çš„ä¼ä¸šåˆ™ä¼šè¢«ç”¨æˆ·æ·˜æ±°ã€‚å¾ˆæ®‹é…·ï¼Œä½†è¿™å°±æ˜¯è¿™ä¸ªæ—¶ä»£æœ€åŸºæœ¬çš„ä¼ä¸šâ½£å­˜æ³•åˆ™ã€‚</p></blockquote><p>å¹³å°åŒ–èƒ½å¤Ÿèµ‹äºˆæˆ–åŠ å¼ºä¼ä¸šåœ¨ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„ç°ä»£å•†ä¸šæˆ˜äº‰å½“ä¸­æœ€ä¸ºæ ¸å¿ƒçš„èƒ½åŠ› â€“&gt; ç”¨æˆ·å“åº”åŠ›ã€‚ </p><p>ä¸­å°ï¼Œå¯ä»¥è¯´æ˜¯ä¸å‰å°ï¼Œåå°ç›¸å¯¹åº”çš„ã€‚</p><ul><li>å‰å°<ul><li>ç”±å„ç±»å‰å°ç³»ç»Ÿç»„æˆçš„å‰ç«¯å¹³å°ã€‚æ¯ä¸ªå‰å°ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªç”¨æˆ·è§¦ç‚¹ï¼Œå³ä¼ä¸šçš„æœ€ç»ˆç”¨æˆ·ç›´æ¥ä½¿ç”¨æˆ–è€…äº¤äº’çš„ç³»ç»Ÿï¼Œæ˜¯ä¼ä¸šä¸æœ€ç»ˆç”¨æˆ·çš„äº¤ç‚¹ã€‚</li></ul></li><li>åå°<ul><li>åå°ç³»ç»Ÿç»„æˆçš„åç«¯å¹³å°ï¼Œå®å…·å“¦ä¼ä¸šçš„æ ¸å¿ƒèµ„æº â€“ æ•°æ® + è®¡ç®— <ul><li>è´¢åŠ¡ç³»ç»Ÿ</li><li>äº§å“ç³»ç»Ÿ</li><li>å®¢æˆ·ç®¡ç†ç³»ç»Ÿ</li><li>ä»“åº“ç‰©æµç®¡ç†ç³»ç»Ÿ</li></ul></li></ul></li><li>ä¸­å°<ul><li>å› ä¸ºä¼ä¸šåå°å¾€å¾€ä¸èƒ½å¾ˆå¥½çš„æ”¯æ’‘å‰å°å¿«é€Ÿåˆ›æ–°ï¼Œå“åº”ç”¨æˆ·çš„éœ€æ±‚</li><li>å‰å°ç›´æ¥ä½¿ç”¨åå°ï¼Œä¼šé‡åˆ°å¤„ç†å¤æ‚ï¼Œè¿­ä»£é€Ÿåº¦ç¼“æ…¢çš„é—®é¢˜</li><li>å‰å°è¦å¤„ç†çš„æ˜¯å¿«é€Ÿå“åº”ç”¨æˆ·çš„éœ€æ±‚ï¼Œä½†æ˜¯åå°æ‹¿ç€æ•´ä¸ªå…¬å¸çš„æ•°æ®ï¼Œæ˜¯éœ€è¦è¶Šç¨³å®šè¶Šå¥½çš„ï¼Œéšç€å…¬å¸çš„å‘å±•ï¼ŒæŒ‰ç…§å¯¹é€Ÿåº¦å’Œç¨³å®šçš„è¿½æ±‚çš„å†²çªä¼šè¶Šæ¥è¶Šå¤š</li><li>æœ‰äº†ä¸­å°ä»¥åå°±å¯ä»¥å°†å‰å°ç³»ç»Ÿå½“ä¸­çš„ç¨³å®šé€šç”¨ä¸šåŠ¡èƒ½åŠ›æ²‰é™åˆ°ä¸­å°å±‚ï¼Œæ¢å¤å‰å°çš„å“åº”åŠ›</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.infoq.cn/article/3tbJZ8aS5pYdWYX5bBfg?utm_source=rss&amp;utm_medium=article" target="_blank" rel="noopener">https://www.infoq.cn/article/3tbJZ8aS5pYdWYX5bBfg?utm_source=rss&amp;utm_medium=article</a></li><li><a href="https://mp.weixin.qq.com/s/yfhaEkO1DG_ihJMhwtkWjA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/yfhaEkO1DG_ihJMhwtkWjA</a></li><li><a href="https://www.infoq.cn/article/hfONAlDdhK3fD9JjduGR" target="_blank" rel="noopener">https://www.infoq.cn/article/hfONAlDdhK3fD9JjduGR</a></li><li><a href="https://www.zhihu.com/question/57717433" target="_blank" rel="noopener">https://www.zhihu.com/question/57717433</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºæŠ–éŸ³çš„ä¸€äº›åˆ†æ</title>
      <link href="/%E5%85%B3%E4%BA%8E%E6%8A%96%E9%9F%B3%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%86%E6%9E%90/"/>
      <url>/%E5%85%B3%E4%BA%8E%E6%8A%96%E9%9F%B3%E7%9A%84%E4%B8%80%E4%BA%9B%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-å¤–éƒ¨ç¯å¢ƒèƒŒæ™¯"><a href="#1-1-å¤–éƒ¨ç¯å¢ƒèƒŒæ™¯" class="headerlink" title="1.1 å¤–éƒ¨ç¯å¢ƒèƒŒæ™¯"></a>1.1 å¤–éƒ¨ç¯å¢ƒèƒŒæ™¯</h2><p>çŸ­è§†é¢‘æ˜¯å½“å‰è¶…é«˜é€Ÿå‘å±•çš„èµ›é“ï¼Œæµé‡æŒç»­è¿…çŒ›å¢é•¿ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸è¿›å…¥è¿™ä¸ªèµ›é“ï¼Œå¤´éƒ¨çš„å›½å†…æœ‰æŠ–éŸ³å¿«æ‰‹ï¼Œä¸»è¦ç€çœ¼äº1minä»¥å†…çš„çŸ­è§†é¢‘ï¼Œä¸»è¦ä¸ºUGC(User Generated Content)ï¼Œå°‘é‡PGC(Professional Generated Content)äº§å‡ºå†…å®¹ï¼›ç¾å›½æœ‰åˆšåˆšæˆç«‹çš„quibiï¼Œç€çœ¼äºåˆ¶ä½œ10minå·¦å³çš„ä¼˜è´¨å†…å®¹ï¼Œå®Œå…¨èµ°PGCçš„è·¯çº¿ã€‚</p><p>çŸ­è§†é¢‘çš„å…´èµ·æ˜¯æœ‰ä¸€äº›éœ€è¦çš„ç¤¾ä¼šä»¥åŠç§‘æŠ€çš„åŸºç¡€èƒŒæ™¯çš„ã€‚ </p><ul><li>ä»ç»æµå‘å±•è§’åº¦<ul><li>ç»æµçš„æŒç»­å‘å±•ï¼Œåˆºæ¿€äº†äººä»¬çš„ä¼‘é—²å¨±ä¹çš„éœ€æ±‚çš„å¢é•¿</li></ul></li><li>ä»ç”¨æˆ·éœ€æ±‚è§’åº¦<ul><li>éœ€è¦å¡«è¡¥è‡ªå·±çš„ç¢ç‰‡æ—¶é—´</li><li>éœ€è¦æ›´å¤šçš„å¨±ä¹ä¼‘é—²</li><li>è‡ªæˆ‘è¡¨è¾¾ï¼Œè‡ªæˆ‘å®ç°ï¼Œç¤¾ä¼šè”ç»“çš„éœ€æ±‚</li><li>å‘æ³„æƒ…ç»ª</li></ul></li><li>ä»ç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯è§’åº¦<ul><li>æˆªæ­¢2019å¹´6æœˆ<ul><li>å…¨å›½æ‰‹æœºç½‘æ°‘æ•°é‡è¾¾åˆ°8.47äº¿(æ ¹æ®ç¬¬44æ¬¡ä¸­å›½äº’è”ç½‘å‘å±•çŠ¶å†µç»Ÿè®¡æŠ¥å‘Š)ï¼Œäº’è”ç½‘æ™®åŠç‡è¾¾åˆ°61.2%</li><li>ç½‘ç»œè´­ç‰©ç”¨æˆ·è§„æ¨¡6.39äº¿ </li><li>æ‰‹æœºç½‘ç»œè´­ç‰©ç”¨æˆ·è§„æ¨¡6.22äº¿</li><li>ç½‘ç»œè§†é¢‘ç”¨æˆ·7.59äº¿</li><li>ç§»åŠ¨äº’è”ç½‘æ¥å…¥æµé‡æ¶ˆè´¹553.9äº¿GB åŒæ¯”å¢é•¿107.3% </li><li>ç½‘æ°‘å¹³å‡æ¯å‘¨ä¸Šç½‘æ—¶é•¿ 27.9å°æ—¶</li><li>çŸ­è§†é¢‘æ—¶é•¿å æ¯” 11.5%ï¼Œä½¿ç”¨é«˜å³°ä¸º12ç‚¹ä»¥åŠ21ç‚¹å·¦å³  </li></ul></li></ul></li><li>ä»æŠ€æœ¯è§’åº¦<ul><li>4G 5Gå…´èµ·ï¼Œé«˜é€Ÿç½‘ç»œå»ºè®¾</li><li>æ‰‹æœºçš„å¹¿æ³›æ™®åŠ</li><li>äº‘å¹³å°æ™®åŠï¼Œä¼ä¸šæ¶æ„çš„ç›¸å¯¹ç®€åŒ–ï¼Œæˆæœ¬çš„é™ä½ </li></ul></li><li>æ”¿ç­–å½±å“<ul><li>æ¨å‡ºã€Šç½‘ç»œçŸ­è§†é¢‘å¹³å°ç®¡ç†è§„èŒƒã€‹</li><li>æ¨å‡ºã€Šç½‘ç»œçŸ­è§†é¢‘å†…å®¹å®¡æ ¸æ ‡å‡†ç»†åˆ™ã€‹ </li></ul></li></ul><h2 id="1-2-æ—¶é—´çº¿"><a href="#1-2-æ—¶é—´çº¿" class="headerlink" title="1.2 æ—¶é—´çº¿"></a>1.2 æ—¶é—´çº¿</h2><ul><li>2016å¹´9æœˆä¸Šçº¿ <ul><li>A.me å®šä½ä¸ºéŸ³ä¹çŸ­è§†é¢‘ç¤¾åŒº </li><li>å¹´è½»äººçš„15ç§’éŸ³ä¹çŸ­è§†é¢‘ç¤¾åŒº </li></ul></li><li>2016å¹´11æœˆ<ul><li>æŸ¥æ‰¾é€šè®¯å½•ï¼Œé‚€è¯·QQ å¾®åšå¥½å‹</li></ul></li><li>2016å¹´11æœˆ10æ—¥<ul><li>å¾®åšè¯é¢˜æŒ‘æˆ˜</li><li>é›‡ä½£ å¬é›†å¤§å­¦ç”Ÿï¼Œèˆè¹ˆéŸ³ä¹è¾¾äººï¼Œæ‹æ‘„è§†é¢‘å¼•æµ</li></ul></li><li>2016å¹´12æœˆ10æ—¥<ul><li>æŠ–éŸ³ â€“ éŸ³ä¹è§†é¢‘åº”ç”¨</li></ul></li><li>2016å¹´12æœˆ22æ—¥<ul><li>æ¨èçƒ­é—¨è§†é¢‘</li><li>æ§çº¢ä¸€éƒ¨åˆ†äººï¼Œå†å¸¦åŠ¨æ™®é€šç”¨æˆ·çš„ç†å¿µ â€“ åå‘äºä¸­å¿ƒåŒ–çš„è¿è¥æ–¹å¼å‡ºç°ç«¯å€ª    </li></ul></li><li>2017å¹´3æœˆ<ul><li>é‚€è¯·å²³äº‘é¹ç­‰è¯¸å¤šæ˜æ˜ŸåŠ å…¥æŠ–éŸ³</li><li>å¼€å§‹æœ‰å¤§æ‰¹ç”¨æˆ·ä»æ˜æ˜Ÿå¾®åšå½“ä¸­çœ‹åˆ°æŠ–éŸ³æ°´å°ï¼Œè¿›å…¥æŠ–éŸ³å¹³å°</li></ul></li><li>2017å¹´6æœˆå¼€å§‹<ul><li>ç»™è§†é¢‘åˆ›ä½œè€…æ›´å¤šæƒé™<ul><li>å¯¹è¯„è®ºçš„æ§åˆ¶ï¼Œåˆ å‡</li></ul></li><li>é™„è¿‘ tabï¼Œå¢å¼ºç¤¾äº¤å±æ€§</li><li>æŠ–éŸ³æ•…äº‹<ul><li>å¯ä»¥è®¾ç½®åªå¼€æ”¾24å°æ—¶ï¼Œå¸Œæœ›æ™®é€šäººå¯ä»¥åœ¨ä¸Šé¢è®°å½•è‡ªå·±çš„ç”Ÿæ´»</li></ul></li><li>å¯ä»¥ç»‘å®šå¾®åšä¸»é¡µ</li></ul></li><li>2017å¹´8æœˆ<ul><li>Tik Tokå‡ºæµ·</li><li>å´äº¦å‡¡çš„æŠ–éŸ³æŒ‘æˆ˜</li><li>ä¸­å›½æœ‰å˜»å“ˆ å®˜æ–¹æ¨è</li><li>æŠ–éŸ³å¼€å§‹ç ¸é’±åˆ°å„ä¸ªèŠ‚ç›®ï¼Œå¢åŠ æ›å…‰åº¦äº†</li></ul></li><li>2017å¹´9æœˆ<ul><li>é¦–æ¬¡çº¿ä¸‹partyï¼Œç‹‚æ¬¢èŠ‚</li><li>å’Œæ±‰å ¡ç‹ï¼Œæ‘©æ‹œå•è½¦ç­‰ç­‰å…¬å¸å±•å¼€åˆä½œï¼Œè”åç­‰</li><li>ARç›¸æœº</li><li>å¼€å¯ä¿¡æ¯æµå¹¿å‘Šï¼Œå¼€å±å¹¿å‘Šçš„å°è¯• </li></ul></li><li>2017å¹´10æœˆ<ul><li>ä¸Šçº¿ç›´æ’­åŠŸèƒ½</li></ul></li><li>2017å¹´11æœˆ<ul><li>å…¨æ–°æ»¤é•œ</li><li>å€’è®¡æ—¶è‡ªåŠ¨æš‚åœ</li><li>ç›´æ’­é—´ä¼˜åŒ–ï¼Œå¢åŠ å¼¹å¹•åŠŸèƒ½</li></ul></li><li>2017å¹´12æœˆ<ul><li>å…¨æ–°å°¬èˆæœºåŠŸèƒ½    </li></ul></li><li>2018å¹´1æœˆ<ul><li>ç™¾ä¸‡è‹±é›„</li><li>ç§ä¿¡åŠŸèƒ½</li><li>ä¼˜åŒ–ä¸¾æŠ¥ è¯„è®ºåŠŸèƒ½</li></ul></li><li>2018å¹´3æœˆ<ul><li>å¤§è§„æ¨¡çš„å¹¿å‘Šæ¥å…¥å’ŒæŠ•æ”¾å¼€å§‹</li></ul></li><li>2018å¹´8æœˆ  <ul><li>ç›´è¾¾æ·˜å®åŠŸèƒ½ä¸Šçº¿</li><li>åæ²‰è¿·ç³»ç»Ÿä¸Šçº¿        </li><li>å¢åŠ æ¸¸æˆè´´çº¸</li></ul></li><li>2018å¹´10æœˆ<ul><li>ä¸ªäººé¡µèƒŒæ™¯è®¾ç½®ï¼Œä¸ªæ€§åŒ–ä¸»é¡µ</li></ul></li><li>2018å¹´12æœˆ<ul><li>ç›´æ’­ç²‰ä¸å›¢ä»»åŠ¡ä½“ç³»</li></ul></li><li>2019å¹´1æœˆ<ul><li>åœ°ç‚¹è¯¦æƒ…é¡µä¸Šä¼ è§†é¢‘å›¾ç‰‡ï¼Œç”¨æŠ–éŸ³æ¥è®°å½•ç”Ÿæ´»</li><li>ç›´æ’­ ç¤¼ç‰©ä¸€é”®è¿é€</li><li>éšæ‹åŠŸèƒ½</li><li>æ˜¥æ™šç‹¬å®¶ç¤¾äº¤åª’ä½“ä¼ æ’­å¹³å°ï¼Œäº”äº¿ç°é‡‘åˆ†äº«</li></ul></li><li>2019å¹´2æœˆ<ul><li>ARç”»ç¬”åŠŸèƒ½</li></ul></li><li>2019å¹´3æœˆ<ul><li>éšæ‹æ”¯æŒå‘å¸ƒçº¯æ–‡å­—å†…å®¹</li><li>æ–°å¢èšç„¦æ‹æ‘„æ¨¡å¼</li><li>ç§ä¿¡å¯ç½®é¡¶</li><li>çƒ­è¡€é¼“æ‰‹é“å…·ç©æ³•</li><li>æ–°å¢ä½ç½®è´´çº¸</li></ul></li><li>2019å¹´4æœˆ   <ul><li>é“å…·ç©æ³• â€“ æ©™å­è„¸ </li><li>é“å…·ç©æ³• â€“ æ¼«ç”»æ“¦æ‹­</li></ul></li><li>2019å¹´5æœˆ<ul><li>é“å…·ç©æ³• - change face   </li><li>æŒ¡è„¸å˜ç”·ç”Ÿ</li><li>é“å…·ç©æ³• - LineDancer</li></ul></li><li>2019å¹´6æœˆ<ul><li>åˆæ‹ æµ‹ç›¸ä¼¼åº¦</li><li>é“å…·ç©æ³• â€“ ç‚«å…‰è¡£æœ </li><li>é“å…·ç©æ³• â€“ ç…§ç‰‡è¿æ‹</li></ul></li><li>2019å¹´7æœˆ<ul><li>é“å…·ç©æ³• â€“ åŠ¨æ„Ÿè½®å»“</li><li>é“å…·ç©æ³• â€“ æ“¦æ‹­éšèº«</li><li>å¢åŠ æ–‡å­—åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è§†é¢‘ä¸Šæ·»åŠ æ–‡å­—äº†</li></ul></li><li>2019å¹´9æœˆ<ul><li>é’å°‘å¹´æ¨¡å¼</li><li>é“å…·ç©æ³• â€“ ç™¾å˜æŠ–æŠ–ç§€</li></ul></li><li>2019å¹´10æœˆ<ul><li>æ–°å¢è´´çº¸</li><li>é’å°‘å¹´æ¨¡å¼ä¼˜åŒ–</li><li>æ–°å¢å˜å£°åŠŸèƒ½</li></ul></li><li>2020å¹´1æœˆ - è‡³ä»Š<ul><li>æ˜¥èŠ‚20äº¿ç°é‡‘ç­‰ä½ æ‹¿  </li><li>æ–°å¢è´´çº¸</li><li>æ–°å¢ç‰¹æ•ˆ  <h1 id="2-å¹³å°åˆ†æ"><a href="#2-å¹³å°åˆ†æ" class="headerlink" title="2. å¹³å°åˆ†æ"></a>2. å¹³å°åˆ†æ</h1><h2 id="2-1-å¸‚åœºå®šä½"><a href="#2-1-å¸‚åœºå®šä½" class="headerlink" title="2.1 å¸‚åœºå®šä½"></a>2.1 å¸‚åœºå®šä½</h2>ä»1.1çš„æ•´ä¸ªæ—¶é—´è½´ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ•´ä¸ªæŠ–éŸ³çš„å‘å±•å¾ˆå°æ­¥å¿«è·‘ï¼Œè¿…é€Ÿè¿­ä»£ã€‚åˆšå¼€å§‹å‡ºäº†äº§å“åŸå‹ï¼Œç”¨åˆå§‹ç”¨æˆ·ç¾¤ä½“å¼€å§‹è¿…é€Ÿåšè¿­ä»£ï¼Œåœ¨é”šå®šè‡ªå·±çš„å®šä½ï¼Œç›®æ ‡äººç¾¤ä¹‹åï¼Œé€šè¿‡å¬é›†KOLï¼Œæ˜æ˜Ÿï¼Œé€šè¿‡å¾®åšï¼ŒQQå¾®ä¿¡å¼•æµï¼Œå®ç°å…¶è¿…é€Ÿçš„å¢é•¿ã€‚</li></ul></li></ul><p>æŠ–éŸ³çš„sloganæ˜¯<strong>è®°å½•ç¾å¥½ç”Ÿæ´»</strong>ï¼Œ<strong>ä»¥ä¸€äºŒçº¿åŸå¸‚å¹´è½»æ½®äººä¸ºç›®æ ‡ç”¨æˆ·ï¼Œå¸‚åœºå®šä½çªå‡ºéŸ³ä¹ä¸åˆ›æ„</strong>ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ä¸­å¿ƒåŒ–çš„é«˜çƒ­åº¦é«˜æµé‡çš„èšé›†å¹´è½»äººçš„éŸ³ä¹çŸ­è§†é¢‘å¹³å°ã€‚æ•´ä½“æ˜¯ä»¥éŸ³ä¹ä¸ºæ ¸å¿ƒå¸ƒå±€çš„ï¼Œç”¨æˆ·åœ¨æ‹æ‘„è§†é¢‘å‰é¦–å…ˆé€‰æ‹©ä¸€é¦–èƒŒæ™¯éŸ³ä¹ï¼Œæ ¹æ®éŸ³ä¹å†…å®¹è¿›è¡ŒåŠ¨ä½œç¼–æ’å’ŒåŠ å·¥ç‰¹æ•ˆã€‚</p><h2 id="2-2-äº§å“è®¾è®¡"><a href="#2-2-äº§å“è®¾è®¡" class="headerlink" title="2.2 äº§å“è®¾è®¡"></a>2.2 äº§å“è®¾è®¡</h2><h3 id="2-2-1-æµè§ˆä½“éªŒ"><a href="#2-2-1-æµè§ˆä½“éªŒ" class="headerlink" title="2.2.1 æµè§ˆä½“éªŒ"></a>2.2.1 æµè§ˆä½“éªŒ</h3><ul><li>æ•´ä½“ä»¥é»‘ç™½ç°ä¸‰è‰²ä¸ºä¸»ï¼Œé£æ ¼ç®€æ´ï¼Œæœ‰æ½®æµæ„Ÿ</li><li>å…¨å±æ²‰æµ¸å¼ä½“éªŒ<ul><li>æ— é™å‘ä¸‹æ»‘åŠ¨</li></ul></li><li>ç«–å±æ’­æ”¾ â€“ é€‚ç”¨æ›´å¤šçš„åœºæ™¯(ä¸Šç­ï¼Œé€šå‹¤ï¼Œåƒé¥­ï¼Œç­‰ç­‰) â€“ ä¹Ÿå¾ˆç¬¦åˆäºçŸ­è§†é¢‘ç¢ç‰‡æ—¶é—´ä½¿ç”¨çš„å®šä½</li><li>ç‚¹å‡»èƒŒæ™¯éŸ³ä¹ä¼šè·³è½¬åˆ°åŒæ¬¾éŸ³ä¹å…¶ä»–çš„çŸ­è§†é¢‘é›†åˆ</li><li>äº¤äº’ ä»»æ„ä½ç½®åŒå‡»ç‚¹èµï¼Œä¸Šä¸‹æ»‘æµè§ˆå…¶ä»–è§†é¢‘</li><li>é•¿æŒ‰ å¯ä»¥çœ‹åˆ°æ›´å¤šçš„ä¸€äº›é€‰æ‹©<ul><li>ä¸æ„Ÿå…´è¶£</li><li>åŠ åˆ°å–œæ¬¢ </li></ul></li></ul><h3 id="2-2-2-æ‹æ‘„"><a href="#2-2-2-æ‹æ‘„" class="headerlink" title="2.2.2 æ‹æ‘„"></a>2.2.2 æ‹æ‘„</h3><p>æŠ–éŸ³åœ¨æ‹æ‘„æ–¹é¢ä¸‹äº†å¾ˆå¤§åŠŸå¤«ï¼Œä»æ›´æ–°æ—¥å¿—ä¸Šä¹Ÿèƒ½å¾ˆæ˜æ˜¾çœ‹å‡ºä»–åœ¨å°è¯•ç€ä¸æ–­é™ä½æ‹æ‘„å‡ºé«˜è´¨é‡è§†é¢‘çš„é—¨æ§›ï¼Œé€šè¿‡å¤§é‡çš„ç‰¹æ•ˆï¼Œå„ç§é“å…·ï¼Œè®©çŸ­è§†é¢‘ä¸è‡³äºå•è°ƒï¼Œå¯ä»¥ç”¨æ¯”è¾ƒç®€å•çš„ç´ æï¼ŒåŠ ä¸Šç‰¹æ•ˆï¼ŒéŸ³ä¹ï¼Œæ’‘èµ·æ¥ã€‚</p><ul><li>å¤šç§ç±»å‹éŸ³ä¹<ul><li>å›½é£</li><li>æµè¡Œ</li><li>åŸåˆ› </li><li>etc.</li></ul></li><li>è§†é¢‘åˆ¶ä½œçš„åŠŸèƒ½<ul><li>é€Ÿåº¦åˆ‡æ¢</li><li>å¤šæ®µæ··å‰ª</li><li>è´´çº¸é“å…·</li><li>ç¾åŒ–æ»¤é•œ</li><li>ç‰¹æ•ˆæ»¤é•œ<h3 id="2-2-3-ç‰¹è‰²åŠŸèƒ½"><a href="#2-2-3-ç‰¹è‰²åŠŸèƒ½" class="headerlink" title="2.2.3 ç‰¹è‰²åŠŸèƒ½"></a>2.2.3 ç‰¹è‰²åŠŸèƒ½</h3></li></ul></li><li>çƒ­æœæ¦œ</li><li>å°¬èˆæœº</li><li>æ—¶é—´é”</li></ul><h2 id="2-3-å†…å®¹ç”Ÿäº§ä¸åˆ†å‘"><a href="#2-3-å†…å®¹ç”Ÿäº§ä¸åˆ†å‘" class="headerlink" title="2.3 å†…å®¹ç”Ÿäº§ä¸åˆ†å‘"></a>2.3 å†…å®¹ç”Ÿäº§ä¸åˆ†å‘</h2><h3 id="2-3-1-å†…å®¹ç”Ÿäº§æ¨¡å¼"><a href="#2-3-1-å†…å®¹ç”Ÿäº§æ¨¡å¼" class="headerlink" title="2.3.1 å†…å®¹ç”Ÿäº§æ¨¡å¼"></a>2.3.1 å†…å®¹ç”Ÿäº§æ¨¡å¼</h3><p>UGC + PGCæ¨¡å¼</p><ul><li>UGC<ul><li>æ™®é€šç”¨æˆ·</li></ul></li><li>PGC<ul><li>æ˜æ˜Ÿ</li><li>ç½‘çº¢</li><li>ä¸“ä¸šå‚ç›´é¢†åŸŸKOL</li></ul></li></ul><h3 id="2-3-2-å†…å®¹åˆ†å‘æ¨¡å¼"><a href="#2-3-2-å†…å®¹åˆ†å‘æ¨¡å¼" class="headerlink" title="2.3.2 å†…å®¹åˆ†å‘æ¨¡å¼"></a>2.3.2 å†…å®¹åˆ†å‘æ¨¡å¼</h3><ul><li>ç®—æ³•æ¨è+äººå·¥ç²¾é€‰æ¨è<ul><li>æ ¹æ®ç”¨æˆ·çš„è§‚çœ‹æ•°æ®ï¼Œè®¡ç®—ç”¨æˆ·å†…å®¹æ ‡ç­¾ï¼ŒæŒ‰ç…§ä¸€å®šé¢‘ç‡æ¨é€ç›¸ä¼¼çš„è§†é¢‘å†…å®¹ </li><li>æ¨èçˆ†æ¬¾å†…å®¹ï¼Œè¶Šä¼˜è´¨çš„å†…å®¹ä¼šå¾—åˆ°è¶Šå¤šçš„æ›å…‰æœºä¼š</li><li>æ¨èæœºåˆ¶ä¸å¤ªåœ¨æ„å†…å®¹çš„å‘å¸ƒæ—¶é—´ï¼Œåªè¦è¶³å¤Ÿç²¾å½©ï¼Œå¯èƒ½<strong><em>å·²ç»å‘å¸ƒäº†å‡ ä¸ªæœˆçš„è§†é¢‘</em></strong>è¿˜ä¼šä¸æ–­æ¨ç»™ç”¨æˆ·</li></ul></li></ul><h2 id="2-4-è¥é”€æ¨å¹¿"><a href="#2-4-è¥é”€æ¨å¹¿" class="headerlink" title="2.4 è¥é”€æ¨å¹¿"></a>2.4 è¥é”€æ¨å¹¿</h2><ul><li>å¼€å±å¹¿å‘Š</li><li>ä¿¡æ¯æµå¹¿å‘Š</li><li>å®šåˆ¶æŒ‘æˆ˜èµ›<ul><li>ä¸ºå“ç‰Œç‹¬å®¶å®šåˆ¶</li><li>ä¿æŒå‰§æƒ…ï¼Œè‡ªä¸»æ‹æ‘„æƒäº¤ç»™è§†é¢‘åˆ¶ä½œè€…</li></ul></li><li>èšåˆç”µå•†<ul><li>åŒæ·˜å®çš„ç›´æ¥é“¾æ¥</li></ul></li></ul><h2 id="2-5-æŠ€æœ¯èƒ½åŠ›"><a href="#2-5-æŠ€æœ¯èƒ½åŠ›" class="headerlink" title="2.5 æŠ€æœ¯èƒ½åŠ›"></a>2.5 æŠ€æœ¯èƒ½åŠ›</h2><ul><li>ç›‘ç®¡<ul><li>äººå·¥ä¸ºä¸»ï¼Œæœºå™¨å­¦ä¹ ä¸ºè¾… <ul><li>é€šè¿‡å»ºç«‹å®Œå–„æ•°æ®åº“ï¼Œå°†ç”¨æˆ·ä¸Šä¼ çš„å†…å®¹ä¸æ•°æ®åº“è¿›è¡ŒåŒ¹é…ï¼Œè¢«è¯†åˆ«ä¸ºä¸è‰¯å†…å®¹å°±äºˆä»¥ç›´æ¥åˆ é™¤</li></ul></li><li>ç”¨æˆ·ä¸¾æŠ¥  <ul><li><h1 id="3-Thoughts"><a href="#3-Thoughts" class="headerlink" title="3. Thoughts"></a>3. Thoughts</h1></li></ul></li></ul></li></ul><h2 id="3-1-ç”¨æˆ·çš„éœ€æ±‚"><a href="#3-1-ç”¨æˆ·çš„éœ€æ±‚" class="headerlink" title="3.1 ç”¨æˆ·çš„éœ€æ±‚"></a>3.1 ç”¨æˆ·çš„éœ€æ±‚</h2><p>ç”¨æˆ·å‚ä¸åˆ°è™šæ‹Ÿç¤¾åŒºçš„åŠ¨æœºï¼Œå¯ä»¥æ˜¯åŸºäºï¼š</p><ul><li>è‡ªæˆ‘è®¤çŸ¥å’Œéœ€æ±‚çš„æ»¡è¶³ </li><li>ç¤¾ä¼šäº¤å¾€éœ€æ±‚  â€“ æŠ–éŸ³ä¸å¤ªèƒ½æ»¡è¶³</li><li>è·å–åˆ©ç›Šçš„éœ€æ±‚ â€“ å¹³å°ç›˜å­çš„æ‰©å¤§ä¼šå¢å¤§æ¯ä¸ªäººçš„ç›˜å­</li><li>æƒ…æ„Ÿå½’å± â€“ æŒ‡è·Ÿéšè‡ªå·±çš„å¶åƒï¼Œæ˜æ˜Ÿï¼Œå¸Œæœ›è·å–æ›´å¤šç›¸å…³çš„ä¿¡æ¯</li></ul><p>é¦–å…ˆï¼Œæ„Ÿåˆ°å¤§éƒ¨åˆ†äººä¸ä¹ æƒ¯è‡ªå·±å»ä¸»åŠ¨å¯»æ±‚ä¿¡æ¯çš„ï¼Œæˆ–è€…è¯´ï¼Œæ˜¯ä¸å¤ªæ¸…æ¥šè‡ªå·±åº”è¯¥ä¸»åŠ¨è·å–ä»€ä¹ˆæ ·çš„ä¿¡æ¯ï¼Œå› æ­¤appçš„ä¸»åŠ¨æ¨é€ï¼Œäººè¢«é€‰æ‹©é€‚æ—¶è€Œç”Ÿã€‚ï¼ˆIOC å®¹å™¨äº†è§£ä¸€ä¸‹,hhhï¼‰</p><p>æ¯ä¸ªAppéƒ½æœ‰è‡ªå·±çš„å‘³é“ï¼ŒæŠ–éŸ³çš„å‘³é“èƒ½å¤Ÿå¸å¼•æ¥è¿½é€æ½®æµçš„å¹´è½»äººã€‚å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°<strong>å’Œè‡ªå·±ç±»ä¼¼çš„äºº</strong>æ‹çš„è§†é¢‘ï¼Œçœ‹åˆ°çš„<strong>ç¾å¥½çš„ä¸–ç•Œ</strong>ã€‚</p><p>æŠ–éŸ³ä¸€å®šç¨‹åº¦ä¸Šæ»¡è¶³äº†ç”¨æˆ·çš„è‡ªæˆ‘è®¤çŸ¥çš„éœ€æ±‚ï¼Œä¼šè§‰å¾—æŠ–éŸ³å’Œè‡ªå·±å¾ˆæ­(ç”¨æˆ·ç”»åƒå’Œè‡ªæˆ‘è®¤çŸ¥çš„éƒ¨åˆ†é‡åˆ)ã€‚</p><p>ä½†åœ¨ç¤¾äº¤æ–¹é¢ï¼Œæœ‰ç‚¹ä¸å°½å¦‚äººæ„ï¼Œè¿™ä¹Ÿå’ŒæŠ–éŸ³çš„æ•´ä½“ â€“ åä¸­å¿ƒåŒ–çš„éŸ³ä¹çŸ­è§†é¢‘å¹³å°çš„åˆå§‹å®šä½æœ‰å…³äº†ã€‚å½“å¤§éƒ¨åˆ†çš„é«˜è´¨å†…å®¹äº§å‡ºå‡ºè‡ªPGC, MCNçš„æ—¶å€™ï¼Œæ½œåœ¨çš„å†…å®¹åˆ›ä½œè€…å¾ˆå¯èƒ½ä¼šå› ä¸ºæˆä¸ºçƒ­é—¨çš„é«˜é—¨æ§›è€Œæ”¾å¼ƒã€‚å¤§å®¶çœ‹è‡ªå·±å‘å¾€çš„ç”Ÿæ´»ï¼Œè€Œä¸æ˜¯è‡ªå·±çš„ç”Ÿæ´»ã€‚</p><p>çƒ­é—¨è§†é¢‘å¤§éƒ¨åˆ†æ˜¯æœ‰è¶£çš„æ®µå­ï¼Œä»¥åŠåŒæ ·çš„ç´ æéŸ³ä¹ä¸‹çš„å°å“¥å“¥å°å§å§çš„è¡¨ç°ï¼ŒåŒè´¨åŒ–æœ‰ç‚¹ä¸¥é‡ï¼ŒåŒæ—¶ç¦»æ—¥å¸¸ç”Ÿæ´»çš„è·ç¦»ç€å®æœ‰ç‚¹è¿œï¼Œè¿™ä¹Ÿè‡´ä½¿äº†ç”¨æˆ·ä¹‹é—´çš„å…³è”æ„Ÿæ¯”è¾ƒå·®ã€‚  </p><p>ä¸€ä¸ªè¶…æ¼‚äº®çš„å°å§å§åœ¨è·³èˆï¼Œä½ ä¼šâ€œå“‡ï¼Œå¤ªå¥½çœ‹äº†â€ï¼Œä½†ä½ ä¸çŸ¥é“è¯¥å›ä»€ä¹ˆï¼Œæ‰èƒ½å¤Ÿä¸å¤ªå°¬çš„è®¤è¯†ã€‚å› ä¸ºè¿™äº›å°å§å§å¯èƒ½ç¦»ä½ çš„ç‰©ç†è·ç¦»è¿˜å¾ˆè¿œæ˜¯å§~ å¯çœ‹æ²¡æ³•çº¦ </p><p>æŠ–éŸ³å…¶å®ç°åœ¨æœ‰åŸºäºåœ°ç†ä½ç½®çš„æ¨¡å—ï¼Œæœ‰ç§æƒ³ä¸¤æ‰‹æŠ“çš„æ„Ÿè§‰ï¼Œä¸çŸ¥é“åå°æµé‡å¦‚ä½•ï¼Œåªæ˜¯å½“ç”¨æˆ·å¯¹äºä¸€ä¸ªå¹³å°çš„å®šä½æ˜¯ â€“ å»çœ‹å¥½ç©çš„æç¬‘çš„ï¼Œå»çœ‹å°å“¥å“¥å°å§å§çš„æ—¶å€™ï¼Œæƒ³æ”¹å˜æ—¢å®šçš„è®¤çŸ¥ï¼Œéš¾åº¦ä¸å°ã€‚æƒ³åœ¨ä¿æŒå½“å‰å®šä½çš„åŒæ—¶ï¼ŒåŠ ä¸Šä¸€ä¸ªç¤¾äº¤å±æ€§ï¼Œå¥½åƒæœ‰äº›éƒ¨åˆ†æ˜¯ç›¸äº’æœ‰å†²çªçš„ã€‚</p><p>çœ‹åˆ°æ–°é—»åœ¨ç°åº¦æµ‹è¯•ï¼Œé™Œç”Ÿäººè§†é¢‘èŠå¤©ï¼Œå¢å¼ºç¤¾äº¤å±æ€§ï¼Œçœ‹æ¥æ˜¯å¤ªä¸æ´»è·ƒï¼Œå¹¶æ²¡æœ‰ç°åº¦ä¸Šã€‚ä¸çŸ¥é“å…·ä½“æ˜¯æ€ä¹ˆæ ·çš„è¿‡ç¨‹ï¼Œæœ‰æ²¡æœ‰è¶³å¤Ÿå¤šçš„å¯¹è¯é¢˜çš„å¼•å¯¼ï¼Œè¿™ç§å¸¦ç‚¹â€œé˜…åå³ç„šâ€æ€§è´¨çš„å°è¯•ï¼Œä¼šä¸ä¼šä¸€ä¸å°å¿ƒè·¨è¿‡ç›‘ç®¡å…è®¸çš„é™åˆ¶ï¼Œlol  æ‹­ç›®ä»¥å¾…</p><h2 id="3-2-others"><a href="#3-2-others" class="headerlink" title="3.2 others"></a>3.2 others</h2><ul><li>ç”¨æˆ·é›†ä¸­äºä¸€äºŒçº¿åŸå¸‚<ul><li>å¦‚ä½•å‘ä¸‰å››çº¿åŸå¸‚æ‰©å¼ ï¼Ÿ<ul><li>å›§å¦ˆ å¾ˆé…·</li><li>å¤§é‡çš„å¹¿å‘Šï¼Œä»£è¨€<ul><li>è¿™ç§æ‰“æ³•åœ¨ä¸€äºŒçº¿åŸå¸‚å¾ˆå¥½ç”¨ï¼Œä¸‰å››çº¿åŸå¸‚å‘¢ï¼Œè”æƒ³è¶£å¤´æ¡ â€“ æˆ‘ä»¬è¦æœ€å®åœ¨çš„ï¼è¯·ç»™æˆ‘é’±ï¼Œlol</li></ul></li><li>å†…å®¹ä¸Šçš„å€¾æ–œ<ul><li>å¦‚ä½•ç”Ÿäº§æ›´å¤šçš„å°é•‡é’å¹´æ„Ÿå…´è¶£çš„å†…å®¹ï¼Ÿ  </li></ul></li></ul></li></ul></li><li>è§†é¢‘åˆ›ä½œçš„é—¨æ§›ä¸å‚ä¸çƒ­æƒ…<ul><li>åˆºæ¿€è®¡åˆ’</li><li>åŸ¹è®­å¹³å° <ul><li>2019å¹´11æœˆ26æ—¥ä¸Šçº¿åˆ›ä½œè€…å­¦é™¢ </li></ul></li></ul></li><li>å†…å®¹åŒè´¨åŒ–ï¼Œä½ä¿—åŒ–<ul><li>å½“åœ¨å¨±ä¹åŒ–åšåˆ°å¾ˆæè‡´çš„æ—¶å€™(è¯·çœ‹æŠ–éŸ³appçš„æå¿«çš„è¿­ä»£é¢‘ç‡ï¼Œä»¥åŠå±‚å‡ºä¸ç©·çš„æ–°é“å…·ï¼Œæ–°ç©æ³•)ï¼Œéœ€è¦åšæ›´åŠ æ·±åº¦çš„å†…å®¹ä¹ˆï¼Ÿ </li><li>å½“çŸ¥è¯†ä»˜è´¹æˆä¸ºæ–°é£å£ï¼Œå·«å¸ˆè´¢ç»ï¼ŒåŠä½›ä»™äººæˆåŠŸå‡ºåœˆä»¥åï¼Œæœ‰æœºä¼šå°†å†…å®¹æµ“ç¼©åˆ°1-5minçš„è§†é¢‘å½“ä¸­ï¼Œæ¥ç‚¹å…ˆå¯¼çŸ¥è¯†ï¼Œç„¶åå†æˆåŠŸå¼•æµåˆ°é•¿è§†é¢‘ç½‘ç«™ä¸Šï¼Ÿ </li></ul></li><li>å¼±ç¤¾äº¤å¹³å°<ul><li>ç¤¾äº¤æ˜¯ä¿è¯ä¸€ä¸ªå¹³å°ç”¨æˆ·ç²˜æ€§çš„æŠ¤åŸæ²³ï¼Œå½“æŠ–éŸ³é€‰æ‹©äº†æ²‰æµ¸å¼çš„æ— é™ä¸‹æ»‘çš„äº¤äº’æ–¹å¼çš„æ—¶å€™ï¼Œä¸€å®šç¨‹åº¦ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¯´æ˜¯èˆå¼ƒäº†ç¤¾äº¤çš„ ï¼ˆå¯¹æ¯”å¿«æ‰‹çš„ä¸‹æ»‘ç•™è¯„ï¼Œå·¦æ»‘å›é€€çš„æ“ä½œï¼‰ã€‚</li><li>å¼±ç¤¾äº¤ä¹Ÿå¯ä»¥ä»ç•™è¯„æ•°æ®å½“ä¸­å¯ä»¥çœ‹å‡ºï¼Œå°½ç®¡æŠ–éŸ³çš„æ—¥æ´»æœˆæ´»é¥é¥é¢†å…ˆï¼Œä½†ç•™è¯„ï¼Œç‚¹èµæ˜¯å¿«æ‰‹å æ®ä¼˜åŠ¿çš„ï¼Œäº’åŠ¨ç‡è¦é«˜å‡ºå¾ˆå¤š</li><li>åšä¸åšç¤¾äº¤ï¼Ÿ<ul><li>ä¸€ç›´æ— é™æƒ³åšï¼Œå…ˆå‡ºè‡ªå·±çš„ä¸“å±appï¼Œæ²¡åšèµ·æ¥ï¼Œç°åœ¨ç›´æ¥æ”¾åˆ°æŠ–éŸ³è¿™ä¸ªå›½æ°‘appé‡Œåšäº†</li></ul></li><li>ä¸ºä»€ä¹ˆæƒ³åšï¼Ÿ<ul><li>ç¤¾äº¤ï¼Œç²˜æ€§ï¼Œå¸¦è´§ï¼Œçœ‹çœ‹å¿«æ‰‹çš„å¸¦è´§æ•°æ®ï¼Œè´¼é…·ç‚«</li><li>ç¤¾äº¤ - é™„è¿‘çš„äºº - ä¸€å¼ ç¾ä¸½çš„ç±»ä¼¼ç¾å›¢çš„å¤–å–å¸¦åŠ¨åŸºäºåœ°ç†ä½ç½®çš„å…¶ä»–ä¸šåŠ¡çš„ç¾å¦™æ„æƒ³</li></ul></li><li>concern<ul><li>ç¤¾äº¤æ³¨å®šæ˜¯éœ€è¦å¸¦ç‚¹â€œå¹³å‡äººâ€ çš„ç†å¿µçš„ï¼Œè¿™ä¸ä»…ä»…éœ€è¦æ¥å£ï¼Œè·¯å¾„ï¼Œäº¤äº’æ–¹å¼çš„æ”¹å˜ï¼Œæ›´æ˜¯å†…å®¹åˆ†å‘é€»è¾‘ï¼Œè§†é¢‘åˆ›ä½œæ–¹å¼ä¸Šçš„æ”¹å˜ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œç¤¾äº¤æœ‰å¤šé‡è¦ï¼Œé‡è¦åˆ°æ”¹å˜æ•´ä¸ªå¹³å°çš„ç°æœ‰å®šä½ï¼Œé‡è¦åˆ°å¯èƒ½ä¼šé™ä½ä¸€äº›æ ¼è°ƒï¼Œå°‘ä¸€äº›fancyï¼Œå¤šç‚¹ç”Ÿæ´»æ°”æ¯ä¹ˆï¼Ÿ </li></ul></li></ul></li><li>ç®—æ³• ä¿¡æ¯èŒ§æˆ¿<ul><li>ç”¨æˆ·å–œæ¬¢çš„ä¿¡æ¯å’Œä¿¡æ¯å¹¿åº¦çš„tradeoffï¼Œç®—æ³•çš„å•ä¸ªæ–¹å‘ä¸Šçš„ç›¸å¯¹æè‡´ä¼˜åŒ–ï¼Œä¼šç¼©å‡ç”¨æˆ·èƒ½å¤Ÿæ¥å—åˆ°çš„ä¿¡æ¯èŒƒå›´çš„</li><li>ä¾æ—§æ˜¯å¹³å°ç®—æ³•ä¼˜åŒ–çš„é—®é¢˜äº†ï¼Œåˆ°åº•ç»™ç”¨æˆ·ç•™å‡ºå¤šå°‘è‡ªå·±çš„ç©ºé—´å‘¢ï¼Ÿ </li></ul></li><li>æ”¿ç­–çš„é™åˆ¶/è¦æ±‚ - å¨±ä¹å±æ€§ï¼Œç¤¾ä¼šå±æ€§ï¼Œæ·±å…¥çš„æ€è€ƒæ€§çš„ä¸œè¥¿å¾ˆå°‘<ul><li>å—¯ï¼Œæ˜¯è¿™æ ·çš„~  </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="http://www.woshipm.com/evaluating/994454.html" target="_blank" rel="noopener">http://www.woshipm.com/evaluating/994454.html</a> </li><li><a href="https://tools.lancely.tech/apple/app-version/cn/1142110895" target="_blank" rel="noopener">https://tools.lancely.tech/apple/app-version/cn/1142110895</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thought </tag>
            
            <tag> æŠ–éŸ³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ„å»ºReactçš„æƒ³æ³• - from sebmarkbage</title>
      <link href="/%E6%9E%84%E5%BB%BAReact%E7%9A%84%E6%83%B3%E6%B3%95-from-sebmarkbage/"/>
      <url>/%E6%9E%84%E5%BB%BAReact%E7%9A%84%E6%83%B3%E6%B3%95-from-sebmarkbage/</url>
      
        <content type="html"><![CDATA[<p>ä»githubç¿»åˆ°çš„è®ºè¿°ï¼Œæ˜¯Reactè®¾è®¡è€…è¯•å›¾è¯´æ˜å…¶æ„å»ºReactçš„æ•´ä¸ªé€»è¾‘ã€‚</p><h1 id="1-è½¬æ¢-Transformation"><a href="#1-è½¬æ¢-Transformation" class="headerlink" title="1. è½¬æ¢ - Transformation"></a>1. è½¬æ¢ - Transformation</h1><p>Reactçš„æ ¸å¿ƒå‡å®šæ˜¯UIå±‚å®é™…ä¸Šæ˜¯å¯¹æ•°æ®çš„å±•ç°å½¢å¼çš„ä¸€ç§è½¬æ¢ã€‚åŒæ ·çš„è¾“å…¥ä¼šç»™å‡ºåŒæ ·çš„è¾“å‡ºç»“æœï¼Œåªæ˜¯è¡¨ç°å½¢å¼å¯èƒ½ä¼šæœ‰æ‰€åŒºåˆ«ã€‚</p><pre><code>function NameBox(name) {  return { fontWeight: &#39;bold&#39;, labelContent: name };}&#39;Sebastian MarkbÃ¥ge&#39; -&gt;{ fontWeight: &#39;bold&#39;, labelContent: &#39;Sebastian MarkbÃ¥ge&#39; };</code></pre><h1 id="2-æŠ½è±¡-Abstraction"><a href="#2-æŠ½è±¡-Abstraction" class="headerlink" title="2. æŠ½è±¡ - Abstraction"></a>2. æŠ½è±¡ - Abstraction</h1><p>æˆ‘ä»¬æ— æ³•å°†ä¸€ä¸ªå¤æ‚çš„UIæ”¾åˆ°ä¸€ä¸ªæ–¹æ³•å½“ä¸­çš„ã€‚å°†UIæŠ½è±¡åˆ°å„ä¸ªå¯ä»¥å¤ç”¨çš„ç»„ä»¶å½“ä¸­å°±å˜å¾—å°¤ä¸ºé‡è¦ã€‚æŠ½è±¡æˆå¯å¤ç”¨çš„ç»„ä»¶ï¼Œå¹¶ä¸”éšè—å®ç°çš„ç»†èŠ‚ï¼Œæ˜¯æˆ‘ä»¬æƒ³è¦åšçš„ã€‚</p><pre><code>function FancyUserBox(user) {  return {    borderStyle: &#39;1px solid blue&#39;,    childContent: [      &#39;Name: &#39;,      NameBox(user.firstName + &#39; &#39; + user.lastName)    ]  };}{ firstName: &#39;Sebastian&#39;, lastName: &#39;MarkbÃ¥ge&#39; } -&gt;{  borderStyle: &#39;1px solid blue&#39;,  childContent: [    &#39;Name: &#39;,    { fontWeight: &#39;bold&#39;, labelContent: &#39;Sebastian MarkbÃ¥ge&#39; }  ]};</code></pre><h1 id="3-ç»„åˆ-Composition"><a href="#3-ç»„åˆ-Composition" class="headerlink" title="3. ç»„åˆ - Composition"></a>3. ç»„åˆ - Composition</h1><p>ä¸ºäº†å®ç°çœŸæ­£å¯ä»¥å¤ç”¨çš„ç‰¹æ€§ï¼Œä»…ä»…ä½¿ç”¨ç»†åˆ†çš„å­åŠŸèƒ½ï¼Œå¹¶ä¸”æ¯æ¬¡ç»™ä»–ä»¬æ„å»ºå®¹å™¨æ˜¯ä¸å¤ªå¤Ÿçš„ã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿå»ºç«‹ä¸­é—´å±‚çš„æŠ½è±¡ï¼Œå³å°†å‡ ä¸ªå­åŠŸèƒ½ç»„ä»¶ç»„åˆèµ·æ¥ï¼Œå½¢æˆå¦ä¸€å±‚æ¬¡çš„ç»„ä»¶ã€‚è¿™é‡Œçš„ç»„åˆå°±æ˜¯æŒ‡å°†å¤šä¸ªæŠ½è±¡èåˆæˆä¸€ä¸ªæŠ½è±¡çš„èƒ½åŠ›ã€‚</p><pre><code>function FancyBox(children) {  return {    borderStyle: &#39;1px solid blue&#39;,    children: children  };}function UserBox(user) {  return FancyBox([    &#39;Name: &#39;,    NameBox(user.firstName + &#39; &#39; + user.lastName)  ]);}</code></pre><h1 id="4-çŠ¶æ€-State"><a href="#4-çŠ¶æ€-State" class="headerlink" title="4. çŠ¶æ€ - State"></a>4. çŠ¶æ€ - State</h1><p>UIä¸ä»…ä»…æ˜¯æœåŠ¡å™¨ä»¥åŠå•†ä¸šé€»è¾‘çš„å¤åˆ¶ï¼Œå®é™…ä¸Šæ˜¯æœ‰å¾ˆå¤šçŠ¶æ€ï¼Œæ˜¯æœåŠ¡äºç‰¹å®šçš„è¿è¡Œè¿‡ç¨‹çš„ã€‚æ¯”å¦‚ä½ åœ¨ä¸€ä¸ªæ–‡æœ¬æ¡†è¾“å…¥å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€äº›æ–¹å¼èƒ½å¤Ÿè®°å½•ä¸‹è¿™ä¸ªæ–‡æœ¬æ¡†å½“å‰çš„çŠ¶æ€ï¼Œå¹¶ä¸”ç”¨è¿™ä¸ªçŠ¶æ€å»å’Œåç«¯è¿›æˆ–è€…å…¶ä»–çš„æ–¹æ³•è¿›è¡Œäº¤äº’ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ•°æ®æ˜¯immutableçš„</p><pre><code>function FancyNameBox(user, likes, onClick) {  return FancyBox([    &#39;Name: &#39;, NameBox(user.firstName + &#39; &#39; + user.lastName),    &#39;Likes: &#39;, LikeBox(likes),    LikeButton(onClick)  ]);}// Implementation Detailsvar likes = 0;function addOneMoreLike() {  likes++;  rerender();}// InitFancyNameBox(  { firstName: &#39;Sebastian&#39;, lastName: &#39;MarkbÃ¥ge&#39; },  likes,  addOneMoreLike);</code></pre><h1 id="5-è®°å¿†æ–¹æ³•"><a href="#5-è®°å¿†æ–¹æ³•" class="headerlink" title="5. è®°å¿†æ–¹æ³•"></a>5. è®°å¿†æ–¹æ³•</h1><p>å¦‚æœæˆ‘ä»¬çŸ¥é“è¿™æ˜¯ä¸ªçº¯æ–¹æ³•ï¼Œå¹¶ä¸”è¿˜ä¼šé‡å¤çš„callå®ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªè®°å¿†ç‰ˆæœ¬çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨åœ¨æœ‰ç›¸åŒçš„æ•°æ®(è¾“å…¥)çš„æ—¶å€™è¿˜è¦é‡å¤æ‰§è¡Œäº†</p><pre><code>function memoize(fn) {  var cachedArg;  var cachedResult;  return function(arg) {    if (cachedArg === arg) {      return cachedResult;    }    cachedArg = arg;    cachedResult = fn(arg);    return cachedResult;  };}var MemoizedNameBox = memoize(NameBox);function NameAndAgeBox(user, currentTime) {  return FancyBox([    &#39;Name: &#39;,    MemoizedNameBox(user.firstName + &#39; &#39; + user.lastName),    &#39;Age in milliseconds: &#39;,    currentTime - user.dateOfBirth  ]);}// æˆ‘ä»¬åŒæ ·å¯ä»¥ä¸ä»…ä»…è®°ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥è®°ä¸€ä¸ªmapfunction memoize(fn) {  return function(arg, memoizationCache) {    if (memoizationCache.arg === arg) {      return memoizationCache.result;    }    const result = fn(arg);    memoizationCache.arg = arg;    memoizationCache.result = result;    return result;  };}function FancyBoxWithState(  children,  stateMap,  updateState,  memoizationCache) {  return FancyBox(    children.map(child =&gt; child.continuation(      stateMap.get(child.key),      updateState,      memoizationCache.get(child.key)    ))  );}const MemoizedFancyNameBox = memoize(FancyNameBox);</code></pre><h1 id="6-åˆ—è¡¨"><a href="#6-åˆ—è¡¨" class="headerlink" title="6. åˆ—è¡¨"></a>6. åˆ—è¡¨</h1><p>å¤§éƒ¨åˆ†çš„UIéƒ½æ˜¯ä¸€äº›å½¢å¼çš„åˆ—è¡¨ï¼Œç„¶åä¸ºåœ¨åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ äº§å‡ºä¸åŒçš„ä¸€ç³»åˆ—çš„å€¼ã€‚è¿™å°±è‡ªç„¶çš„äº§ç”Ÿäº†ä¸€ä¸ªæœ‰å±‚çº§çš„ç»“æ„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨Mapæ–¹æ³•æ¥ç®¡ç†æ¯ä¸ªåˆ—è¡¨å½“ä¸­çš„å…ƒç´ çš„çŠ¶æ€ã€‚</p><pre><code>function UserList(users, likesPerUser, updateUserLikes) {  return users.map(user =&gt; FancyNameBox(    user,    likesPerUser.get(user.id),    () =&gt; updateUserLikes(user.id, likesPerUser.get(user.id) + 1)  ));}var likesPerUser = new Map();function updateUserLikes(id, likeCount) {  likesPerUser.set(id, likeCount);  rerender();}UserList(data.users, likesPerUser, updateUserLikes);</code></pre><h1 id="7-æŒç»­æ€§"><a href="#7-æŒç»­æ€§" class="headerlink" title="7. æŒç»­æ€§"></a>7. æŒç»­æ€§</h1><p>ä¸€äº›æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œæˆ‘ä»¬çš„æ ¸å¿ƒå•†ä¸šé€»è¾‘çš„æ—¶å€™ä¼šå¤§é‡çš„æ“ä½œæ•°æ®ï¼Œè¿™éƒ¨åˆ†å…³äºæ•°æ®çš„æ“ä½œä¼šæ˜¾å¾—æœ‰äº›å†—ä½™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§»å‡ºæ ¸å¿ƒé€»è¾‘çš„ä»£ç å—ï¼Œæ¯”å¦‚ä½¿ç”¨bindï¼Œæ¥ç»‘å®šæ–¹æ³•ï¼Œåœ¨å…¶ä»–åœ°æ–¹å†™å…·ä½“çš„ä»£ç é€»è¾‘ã€‚</p><pre><code>function FancyUserList(users) {  return FancyBox(    UserList.bind(null, users)  );}const box = FancyUserList(data.users);const resolvedChildren = box.children(likesPerUser, updateUserLikes);const resolvedBox = {  ...box,  children: resolvedChildren};</code></pre><h1 id="8-çŠ¶æ€Map"><a href="#8-çŠ¶æ€Map" class="headerlink" title="8. çŠ¶æ€Map"></a>8. çŠ¶æ€Map</h1><p>æˆ‘ä»¬å¯ä»¥ç”¨ç»„åˆæ¥å°†å‡ ä¸ªå­ç»„ä»¶æ”¾åœ¨ä¸€èµ·æ¥ä½¿ç”¨ï¼ŒåŒæ ·çš„ï¼Œå¯¹äºä»–ä»¬éœ€è¦çš„ä¸€äº›è¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡stateï¼Œæ¥ä¼ åˆ°ä¸‹å±‚çš„æ–¹æ³•å¤„ï¼Œä¾›ä»–ä»¬ä½¿ç”¨ã€‚</p><pre><code>function FancyBoxWithState(  children,  stateMap,  updateState) {  return FancyBox(    children.map(child =&gt; child.continuation(      stateMap.get(child.key),      updateState    ))  );}function UserList(users) {  return users.map(user =&gt; {    continuation: FancyNameBox.bind(null, user),    key: user.id  });}function FancyUserList(users) {  return FancyBoxWithState.bind(null,    UserList(users)  );}const continuation = FancyUserList(data.users);continuation(likesPerUser, updateUserLikes);</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://github.com/reactjs/react-basic" target="_blank" rel="noopener">https://github.com/reactjs/react-basic</a></p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•çŸ¥é“ç”¨æˆ·æ˜¯å¦åœ¨ä½¿ç”¨Adblocker</title>
      <link href="/%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BD%BF%E7%94%A8Adblocker/"/>
      <url>/%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BD%BF%E7%94%A8Adblocker/</url>
      
        <content type="html"><![CDATA[<p>å¹¿å‘Šç›‘æµ‹å’Œå±è”½æ˜¯å¾ˆå¥½çš„åŠŸèƒ½ï¼Œè€ŒAd-blockeråŸºæœ¬æ˜¯å¸‚é¢ä¸Šåšå±è”½å¹¿å‘Šæ’ä»¶çš„ç¿˜æ¥šäº†ã€‚æ ¹æ®GlobalWebIndexåœ¨2019å¹´äº”æœˆåšçš„ç»Ÿè®¡ï¼Œç°åœ¨æœ‰47% çš„ç”¨æˆ·æ­£åœ¨ä½¿ç”¨å¹¿å‘Šå±è”½çš„è½¯ä»¶ã€‚</p><p>ä½œä¸ºç½‘ç«™ç®¡ç†è€…ï¼Œä½ å¯ä»¥åšä¸€ä¸ªpop up çš„ä¿¡æ¯æ¡†ï¼Œå¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿåœæ­¢å¯¹äºå¹¿å‘Šçš„å±è”½ï¼Œæˆ–è€…ä½ å¯ä»¥ç›´æ¥ä¸å…è®¸ç”¨æˆ·æ¥è®¿é—®é¡µé¢ï¼ŒçŸ¥é“å»é™¤äº†å¹¿å‘Šå±è”½ä¹‹åã€‚</p><p>é‚£ä¹ˆå¦‚ä½•çŸ¥é“ç”¨æˆ·æ˜¯å¦åœ¨ä½¿ç”¨AbBlockerå‘¢ï¼Œè¿™é‡Œéœ€è¦äº†è§£ä¸‹adblockerçš„è¿è¡Œæœºåˆ¶ï¼Œå¹¿å‘Šå±è”½çš„è¿è¡Œä¾èµ–äºè¿‡æ»¤è§„åˆ™(filter rules)ï¼Œ adblockä¼šå°†ä½ æ­£åœ¨è®¿é—®çš„URLå’Œè¿‡æ»¤åˆ—è¡¨ç›¸æ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚å°±ä¼šè¢«å±è”½æ‰ã€‚</p><p>ä½†æ˜¯è¿˜æœ‰éƒ¨åˆ†çš„å¹¿å‘Šæ˜¯ä¸ä¼šå‘èµ·ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç›¸å¯¹åº”çš„ï¼Œä»–ä»¬ä¼šä½¿ç”¨<code>data:image/png</code>è¿™ç§æ–¹å¼æ¥åŠ è½½å¹¿å‘Šï¼Œå¯¹äºè¿™ç§å¹¿å‘Šï¼ŒAdBlock åœ¨æ¯ä¸ªé¡µé¢éƒ½ä¼šæ’å…¥ä¸€ä¸ªæ ·å¼è¡¨ï¼Œç„¶åè¿™ä¸ªæ ·å¼è¡¨åŒ…æ‹¬é€‰æ‹©å™¨ï¼Œæ¥display:none é€šè¿‡è¿™ç§æ–¹å¼æ¥éšè—é¡µé¢ä¸Šçš„å¹¿å‘Š</p><p>è€Œè¿™äº›å±è”½åˆ—è¡¨æ¥è‡ªäºä¸€äº›è¿‡å»çš„ç§¯ç´¯ï¼Œè­¬å¦‚ï¼š</p><ul><li><a href="https://easylist.to/" target="_blank" rel="noopener">Easylist</a></li><li><a href="https://help.getadblock.com/support/solutions/articles/6000092027-why-am-i-suddenly-seeing-taboola-outbrain-and-google-ads-" target="_blank" rel="noopener">accesptable list</a></li></ul><p>é™¤æ­¤ä»¥å¤–ï¼Œadblockerè¿˜ä¼šæ£€æµ‹å‰ç«¯è°ƒç”¨çš„jsæ–‡ä»¶ï¼Œå¦‚æœè¿˜æœ‰adå…³é”®è¯ï¼Œä¹Ÿä¼šç›´æ¥å±è”½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å‘½åï¼Œæ¥åšä¸€ä¸ªç®€å•çš„åˆ¤æ–­ã€‚</p><pre><code>// åˆ›å»ºåä¸ºads.jsçš„æ–‡ä»¶isAdBlockActive = false;// åˆ›å»ºscript.jsvar AdBlocker = (function () {    function showModal() {        $(&#39;#modal_ad_blocker&#39;).modal(); // show a message to the user when ads are blocked    }    setInterval(function () {        // Get the first AdSense ad unit on the page        var ad = document.querySelector(&quot;ins.adsbygoogle&quot;);        // If the ads.js or the Google ads are not loaded, show modal and track the event        if (typeof isAdBlockActive === &#39;undefined&#39;            || (ad &amp;&amp; ad.innerHTML.replace(/\s/g, &quot;&quot;).length === 0)) {            showModal();            if (typeof ga !== &#39;undefined&#39;) {                // Log an event in Universal Analytics                // but without affecting overall bounce rate                ga(&#39;send&#39;, &#39;event&#39;, &#39;Adblock&#39;, &#39;Yes&#39;, {&#39;nonInteraction&#39;: 1});            } else if (typeof _gaq !== &#39;undefined&#39;) {                // Log a non-interactive event in old Google Analytics                _gaq.push([&#39;_trackEvent&#39;, &#39;Adblock&#39;, &#39;Yes&#39;, undefined, undefined, true]);            }        }    }, 5000); // check every 5 seconds})();</code></pre><p>é€šè¿‡æ£€æµ‹æˆ‘ä»¬åœ¨ads.jså½“ä¸­å®šä¹‰çš„isAdBlockActive æ˜¯å¦èƒ½å¤Ÿè¢«æ£€æµ‹åˆ°(undefined or have some value)ã€‚æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ˜¯å¦æœ‰adBlockeræ­£åœ¨è¿è¡Œï¼Œç„¶åæ ¹æ®æ£€æµ‹ç»“æœæˆ‘ä»¬å¯ä»¥ç»™ç”¨æˆ·æé†’ï¼Œæˆ–è€…ç›´æ¥é˜»æ­¢è®¿é—®ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.rampatra.com/how-to-know-whether-a-user-is-using-an-adblocker" target="_blank" rel="noopener">https://blog.rampatra.com/how-to-know-whether-a-user-is-using-an-adblocker</a> </li><li><a href="https://help.getadblock.com/support/solutions/articles/6000087914-how-does-adblock-work-" target="_blank" rel="noopener">https://help.getadblock.com/support/solutions/articles/6000087914-how-does-adblock-work-</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tricks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Log4j2 Tutorial </title>
      <link href="/Log4j2-Tutorial/"/>
      <url>/Log4j2-Tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Log4j2-overview"><a href="#1-Log4j2-overview" class="headerlink" title="1. Log4j2 overview"></a>1. Log4j2 overview</h1><h2 id="1-1-Why-log"><a href="#1-1-Why-log" class="headerlink" title="1.1 Why log?"></a>1.1 Why log?</h2><p>Logging is an important component of the development cycle. </p><ul><li>provides precise context about a run of the application </li><li>once inserted into code, the generation of logging output requires no human intervention </li><li>moreover, log output can be saved in persistent medium to be studied at a later time </li></ul><h2 id="1-2-Why-Log4j2"><a href="#1-2-Why-Log4j2" class="headerlink" title="1.2 Why Log4j2?"></a>1.2 Why Log4j2?</h2><ul><li>Designed to be usable as an audit logging framework , will not lose events while reconfiguring </li><li>Contains asynchrounous loggers, which is 10 times faster than log4j 1.x and logback </li><li>Garbage free for stand alone applications </li><li>Use a plugin system that makes it easy to extend the framework by adding new appenders, filters, layouts, lookups, and pattern converters</li><li>Support for custom log levels </li></ul><h2 id="1-3-Log4j-Architecture"><a href="#1-3-Log4j-Architecture" class="headerlink" title="1.3 Log4j Architecture"></a>1.3 Log4j Architecture</h2><p><img src="https://i.loli.net/2020/04/02/AsXomqJciUyPVKh.jpg" alt="Log4jClasses.jpg"> </p><p>Applications using the Log4j 2 API will request <strong>a Logger with a specific name from the LogManager</strong>. The LogManager will <strong>locate the appropriate LoggerContext</strong> and then obtain the Logger from it. If the Logger must be created it will <strong>be associated with the LoggerConfig</strong> that contains either a) the same name as the Logger, b) the name of a parent package, or c) the root LoggerConfig. LoggerConfig objects are created from Logger declarations in the configuration. The LoggerConfig is associated with the Appenders that actually deliver the LogEvents.</p><ul><li>Filter <ul><li>apply in different time point <ul><li>before control is passed to any loggerConfig</li><li>after control is passed to a LoggerConfig but before calling any Appenders</li><li>after control is passed to a LoggerConfig but before calling a specific Appender</li><li>on each Appender</li></ul></li></ul></li><li>Appender <ul><li>selectively enable or disable logging requests</li><li>allow logging requests to print to multiple destinations </li></ul></li><li>Layout <ul><li>Used to customize the output format </li><li>Associate a layout with an appender </li></ul></li></ul><h1 id="2-Migration-from-Log4j-to-Log4j2"><a href="#2-Migration-from-Log4j-to-Log4j2" class="headerlink" title="2. Migration from Log4j to Log4j2"></a>2. Migration from Log4j to Log4j2</h1><p>We usually use log4j/ log4j2 with Slf4j, Slf4j is kind of like a connecter, you could use slf4j as logging system, and slf4j could help you connect to logging framework you want to use: like logback, log4j2, commons-logging, etc. </p><p><a href="https://logging.apache.org/log4j/2.x/manual/migration.html" target="_blank" rel="noopener">https://logging.apache.org/log4j/2.x/manual/migration.html</a> </p><p>Look at sample 1 in above link for how to set up basic configuration </p><p>For some tips: </p><ul><li>The main package in version 1 is org.apache.log4j, in version 2 it is org.apache.logging.log4j</li><li>Calls to org.apache.log4j.Logger.getLogger() must be modified to org.apache.logging.log4j.LogManager.getLogger().</li><li>Calls to org.apache.log4j.Logger.getRootLogger() or org.apache.log4j.LogManager.getRootLogger() must be replaced with org.apache.logging.log4j.LogManager.getRootLogger().</li><li>Calls to org.apache.log4j.Logger.getLogger that accept a LoggerFactory must remove the org.apache.log4j.spi.LoggerFactory and use one of Log4j 2â€™s other extension mechanisms.</li><li>Replace calls to org.apache.log4j.Logger.getEffectiveLevel() with org.apache.logging.log4j.Logger.getLevel().</li><li>Remove calls to org.apache.log4j.LogManager.shutdown(), they are not needed in version 2 because the Log4j Core now automatically adds a JVM shutdown hook on start up to perform any Core clean ups.<ul><li>Starting in Log4j 2.1, you can specify a custom ShutdownCallbackRegistry to override the default JVM shutdown hook strategy.</li><li>Starting in Log4j 2.6, you can now use org.apache.logging.log4j.LogManager.shutdown() to initiate shutdown manually.</li></ul></li><li>Calls to org.apache.log4j.Logger.setLevel() or similar methods are not supported in the API. Applications should remove these. Equivalent functionality is provided in the Log4j 2 implementation classes, see org.apache.logging.log4j.core.config.Configurator.setLevel(), but may leave the application susceptible to changes in Log4j 2 internals.</li><li>Where appropriate, applications should convert to use parameterized messages instead of String concatenation.</li><li>org.apache.log4j.MDC and org.apache.log4j.NDC have been replaced by the Thread Context.</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://logging.apache.org/log4j/2.x/manual/migration.html" target="_blank" rel="noopener">https://logging.apache.org/log4j/2.x/manual/migration.html</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Amazon RDS Onboard - MySQL </title>
      <link href="/Amazon-RDS-Onboard-MySQL/"/>
      <url>/Amazon-RDS-Onboard-MySQL/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>Amazon Relational Databazse Service </p><ul><li>provide cost efficient, resizable capacity for relational database and manage common database administration tasks </li><li>CPU, memory, storage, IOPS can be scaled independently </li><li>help you manage backups, software patching, automatic failure detection, and recovery </li><li>Automated backups </li><li>Can get high availability with a primary instance and synchronous secondary instance that you can fail over to when problems occur.</li><li>Integrate with IAM and VPC settings</li></ul><h2 id="1-1-How-does-amazon-help-you-do-the-setup"><a href="#1-1-How-does-amazon-help-you-do-the-setup" class="headerlink" title="1.1 How does amazon help you do the setup?"></a>1.1 How does amazon help you do the setup?</h2><p>Overall, you control your database by using DB instance, you could select different kind of host with different configuration, AWS will help you to deploy it in your selected region, and it will be automatically deployed to different AZ, to increase availability. Letâ€™s go through it in detail. </p><h3 id="1-1-1-DB-Instances"><a href="#1-1-1-DB-Instances" class="headerlink" title="1.1.1 DB Instances"></a>1.1.1 DB Instances</h3><ul><li><p>An isolated database env in the AWS Cloud </p></li><li><p>One instance can contain multiple user-created databases </p></li><li><p>Each DB instance runs one DB engine, for DB engine, we mean MySQL, MariaDB, PostgreSQL, etc. </p></li><li><p>You could change your selected computation and memory capacity by using <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.DBInstanceClass.html" target="_blank" rel="noopener">DB instance class</a>.</p></li><li><p>You could choose to use multiple availability zones, AZ is engineered to be isolated from failures in other AZs, by launching instances in separate AZs, you can protect your applications from the failure of a single location</p><h3 id="1-1-2-Basic-setup"><a href="#1-1-2-Basic-setup" class="headerlink" title="1.1.2 Basic setup"></a>1.1.2 Basic setup</h3></li><li><p>AWS account </p></li><li><p>IAM user </p></li></ul><h1 id="2-MySQL-on-RDS"><a href="#2-MySQL-on-RDS" class="headerlink" title="2. MySQL on RDS"></a>2. MySQL on RDS</h1><h2 id="2-1-Manage-security-for-DB-instance"><a href="#2-1-Manage-security-for-DB-instance" class="headerlink" title="2.1 Manage security for DB instance"></a>2.1 Manage security for DB instance</h2><h3 id="2-1-1-Security-Overview"><a href="#2-1-1-Security-Overview" class="headerlink" title="2.1.1 Security Overview"></a>2.1.1 Security Overview</h3><ul><li>Run DB instance in a vertual private cloud based on the Amazon VPC service </li><li>Use AWS Identity and Access Management policies to assign permissions that determine who is allowed to manage Amazon RDS resrouces </li><li>Use security groups to control what IP addresses or Amazon EC2 instances can connect to your databases on a DB instance</li><li>Use SSL or TLS connections with DB instances <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL.html" target="_blank" rel="noopener">Instructions</a></li><li>Use Amazon RDS encryption to secure DB instances and snapshots at rest. It used AES-256 encryption algorithm to encrypt data on the server that hosts DB instance</li></ul><h3 id="2-1-2-Manage-access-with-Policies-resource-level"><a href="#2-1-2-Manage-access-with-Policies-resource-level" class="headerlink" title="2.1.2 Manage access with Policies - resource level"></a>2.1.2 Manage access with Policies - resource level</h3><ul><li>A poloicy is an object that associated with an identity or resource, defines their permissions. </li><li>An IAM administrator could use policies to specify who has access to AWS resources, and what actions they can perform on the resources </li></ul><h3 id="2-1-3-Access-control-in-DB-instance-level-security-group"><a href="#2-1-3-Access-control-in-DB-instance-level-security-group" class="headerlink" title="2.1.3 Access control in DB instance level - security group"></a>2.1.3 Access control in DB instance level - security group</h3><ul><li>Security groups control the access that traffic has in and out of a DB instance <ul><li>VPC security groups </li><li>DB security groups</li><li>EC2-classic security groups </li></ul></li><li>VPC security group<ul><li>enable a specific source to access a DB instance in a VPC in the security group </li><li>source could be: <ul><li>a range of addresses </li><li>another VPC security group </li></ul></li></ul></li><li>DB security group <ul><li>Used with DB instances that are not in a VPC and on the EC2 classic platform  </li><li>DB security group rules apply to inbound traffic only </li><li>You donâ€™t need to specify port number or protocol when adding rules </li></ul></li></ul><h2 id="2-2-Connect-to-DB-instance"><a href="#2-2-Connect-to-DB-instance" class="headerlink" title="2.2 Connect to DB instance"></a>2.2 Connect to DB instance</h2><ul><li>Create DB instance as prerequisite </li><li>Use MySQL client application or utility to connect to the instance</li><li>Specify DNS address from the DB instance endpoint as the host parameter, specify the port number from DB instance endpoint as the port parameter </li><li>For endpoint, we could find in AWS console, on the â€œconnectivity &amp; securityâ€ tab </li><li>To  connect from MySQL client, using command shown as below<ul><li><code>mysql -h mysqlâ€“instance1.123456789012.us-east-1.rds.amazonaws.com -P 3306 -u mymasteruser -p</code></li></ul></li><li>Amazon RDS creates an SSL certificate for your DB instance when the instance is created     + you could do it with native password or with IAM authentication <ul><li><code>mysql -h mysqlâ€“instance1.123456789012.us-east-1.rds.amazonaws.com --ssl-ca=rds-ca-2015-root.pem -p</code> </li></ul></li><li>we could also connect from MySQL workbench <ul><li>See instructions on <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_ConnectToInstance.html" target="_blank" rel="noopener">Connnecting from MySQL Workbench</a> </li></ul></li></ul><h2 id="2-3-Configure-high-availability-for-a-production-DB-instance"><a href="#2-3-Configure-high-availability-for-a-production-DB-instance" class="headerlink" title="2.3 Configure high availability for a production DB instance"></a>2.3 Configure high availability for a production DB instance</h2><p>Amazon help you do this with Multi-AZ deployments. SQL server DB instances use SQL server Database Mirroring or Always On Availability Groups. </p><p>In a Multi-AZ deployment, Amazon RDS automatically provisions and maintains a synchronous standby replica in a different Availability Zone. The primary DB instance is synchronously replicated across Availability Zones to a standby replica to provide data redundancy, eliminate I/O freezes, and minimize latency spikes during system backups. Running a DB instance with high availability can enhance availability during planned system maintenance, and help protect your databases against DB instance failure and Availability Zone disruption.</p><p>The high availability feature is not scaling solution for read-only scenarios, you cannot use a standby replica to serve read traffic. </p><p>NOTICE â€“ DB instances using Multi-AZ deployments can have increased write and commit latency compared to a Single-AZ depolyment, due to the synchrounous data replication that occurs. </p><p>In the event of a planned or unplanned outage of your DB instance, Amazon RDS automatically switches to a standby replica in another Availability Zone if you have enabled Multi-AZ. The time it takes for the failover to complete depends on the database activity and other conditions at the time the primary DB instance became unavailable. Failover times are typically 60â€“120 seconds. However, large transactions or a lengthy recovery process can increase failover time. When the failover is complete, it can take additional time for the RDS console to reflect the new Availability Zone.</p><h2 id="2-4-Configure-a-DB-instance-in-VPC"><a href="#2-4-Configure-a-DB-instance-in-VPC" class="headerlink" title="2.4 Configure a DB instance in VPC"></a>2.4 Configure a DB instance in VPC</h2><ul><li>VPC is a virtual network that is logically isolated from other virtual networks in the AWS cloud. Amazon VPC lets you launch AWS resources into a VPC. </li><li>VPC must have at least 2 subnets. And those subnets must be in two different AZs </li><li>If you want DB instance in the VPC to be publicly accessible, you must enable the VPC attributes DNS hostnames and DNS resolution </li></ul><h2 id="2-5-Configure-MySQL-database-parameters-and-features"><a href="#2-5-Configure-MySQL-database-parameters-and-features" class="headerlink" title="2.5 Configure MySQL database parameters and features"></a>2.5 Configure MySQL database parameters and features</h2><ul><li>Manage DB engine configuration by associating DB instances with parameter groups. A DB parameter group act as a container for engine configuration values that are applied to one or more DB instances </li><li>For MySQL, AWS has memcached support </li></ul><h2 id="2-6-Modify-a-DB-instance-running-the-MySQL-database-engine"><a href="#2-6-Modify-a-DB-instance-running-the-MySQL-database-engine" class="headerlink" title="2.6 Modify a DB instance running the MySQL database engine"></a>2.6 Modify a DB instance running the MySQL database engine</h2><ul><li>We could change the settings of a DB instance to add additional storage or changing the DB instance class </li><li>Notice: some cahnges will result in an outage because Amazon RDS must reboot DB instance for the change to take effect <ul><li>We could either modify through AWS console</li><li>Or through AWS CLI</li><li>Or through RDS API </li></ul></li><li>we could do settings as follow:<ul><li>Allocate storage </li><li>Auto minor version upgrade </li><li>Backup retention period <ul><li>number of days that automatic backups are retained </li></ul></li><li>Backup window </li><li>Certificate Authority </li><li>Database port </li><li>DB engine version </li><li>DB instance class </li><li>DB parameter group </li><li>Delete protection <ul><li>prevent your DB from being deleted  </li></ul></li><li>Enhanced Monitoring </li><li>IAM DB authentication </li><li>Kerberos authentication </li><li>License Model </li><li>Log Exports <ul><li>We could publish Database logs to Amazon Cloudwatch logs </li></ul></li><li>Maintenance window </li><li>Multi-AZ deployment </li><li>Performance Insight </li><li>Processor features </li><li>Provisioned IOPS </li><li>Storage auto scaling </li><li>Subnet group </li></ul></li></ul><h2 id="2-7-Configure-database-backup-and-restore"><a href="#2-7-Configure-database-backup-and-restore" class="headerlink" title="2.7 Configure database backup and restore"></a>2.7 Configure database backup and restore</h2><ul><li>Amazon RDS creates and saves automated backups of your DB instance</li><li>RDS creates a storage volume snapshot of DB instance, backing up entire DB instance </li><li>The first snapshot of a DB instance contains the data for the full DB instance. Subsequent snapshots of the same DB instance are incremental, which means that only the data that has changed after your most recent snapshot is saved.</li><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_CommonTasks.BackupRestore.html" target="_blank" rel="noopener">Guide for backup and restore an Amazon RDS DB instance</a></li></ul><h2 id="2-8-Monitor-a-MySQL-DB-instance"><a href="#2-8-Monitor-a-MySQL-DB-instance" class="headerlink" title="2.8 Monitor a MySQL DB instance"></a>2.8 Monitor a MySQL DB instance</h2><h3 id="2-8-1-Overview"><a href="#2-8-1-Overview" class="headerlink" title="2.8.1 Overview"></a>2.8.1 Overview</h3><ul><li><p>We should store historical monitoring data, the stored data will gove a baseline to compare against with current performance data</p></li><li><p>With Amazon RDS, you could monitor network throughput, I/O for read and write, metadata operations, client connections</p></li><li><p>Some adviced metrics </p><ul><li>High CPU or RAM consumption </li><li>Disk space consumption </li><li>Network traffic </li><li>Database connections </li><li>IOPS metrics </li></ul></li><li><p>Monitoring Tools </p><ul><li>Amazon RDS Events <ul><li>subscribe to events thus could be notified when changes occur with a DB instance </li></ul></li><li>Database log files</li><li>Amazon RDS Enhanced Monitoring<ul><li>Look at the metrics in real time for the operating system</li></ul></li><li>Amazon CloudWatch Metrics </li><li>Amazon CloudWatch Alarms</li><li>Amazon CloudWatch Logs </li><li>In RDS console, you could see: <ul><li>the number of connections to a DB instance </li><li>the amount of read and write operations to a DB instance </li><li>the amount of storage that a DB instance is currently utilizing </li><li>the amount of memory and CPU being utilized for a DB instance </li><li>the amount of network traffic to and from a DB instance </li></ul></li></ul></li><li><p>Amazon RDS Metrics </p><ul><li>CPUCreditUsage <ul><li>The number of CPU credits spent by the instance for CPU utilization. One CPU credit equals one vCPU running at 100 percent utilization for one minute or an equivalent combination of vCPUs, utilization, and time.</li></ul></li><li>DatabaseConnections</li><li>DiskQueueDepth <ul><li>the number of outstanding IOs waiting to access the disk</li></ul></li><li>FailedSQLServerAgentJobsCount <ul><li>the numebr of failed SQL server agent jobs during the last minute </li></ul></li><li>ReadIOPS <ul><li>the average number of disk read I/O operations per second</li></ul></li><li>ReadLatency <ul><li>the average amount to time taken per disk I/O operation  </li></ul></li></ul></li></ul><h3 id="2-8-2-Enhanced-Monitoring"><a href="#2-8-2-Enhanced-Monitoring" class="headerlink" title="2.8.2 Enhanced Monitoring"></a>2.8.2 Enhanced Monitoring</h3><p>Real time metrics for the operating system</p><p>CloudWatch gathers metrics about CPU utilization from the hypervisor for a DB instance, and Enhanced Monitoring gathers its metrics from an agent on the instance. As a result, you might find differences between the measurements, because the hypervisor layer performs a small amount of work. The differences can be greater if your DB instances use smaller instance classes, because then there are likely more virtual machines (VMs) that are managed by the hypervisor layer on a single physical instance. Enhanced Monitoring metrics are useful when you want to see how different processes or threads on a DB instance use the CPU</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://docs.aws.amazon.com/AmazonRDS" target="_blank" rel="noopener">https://docs.aws.amazon.com/AmazonRDS</a> </li><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_MySQL.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_MySQL.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> RDS </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring @Transactional</title>
      <link href="/Spring-Transactional/"/>
      <url>/Spring-Transactional/</url>
      
        <content type="html"><![CDATA[<p>Springçš„Transactionalæ³¨è§£ç”¨æ¥åšäº‹åŠ¡ç®¡ç†</p><h1 id="1-ä½¿ç”¨æ–¹æ³•"><a href="#1-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="1. ä½¿ç”¨æ–¹æ³•"></a>1. ä½¿ç”¨æ–¹æ³•</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨xmlå½“ä¸­é…ç½®äº‹åŠ¡ä¿¡æ¯ï¼Œå®šä¹‰transactionManagerçš„beanï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ¥å®ç°å¯¹äºbeançš„å®šä¹‰ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><pre><code>&lt;tx:annotation-driven /&gt;&lt;bean id=&quot;transactionManager&quot;class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;&lt;/bean&gt;@EnableTransactionManagement</code></pre><p>è€Œåï¼Œåœ¨å…·ä½“çš„ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å°†@Transactionalæ³¨è§£æ·»åŠ åˆ°åˆé€‚çš„æ–¹æ³•å½“ä¸­ï¼Œå¹¶ä¸”è®¾ç½®åˆé€‚çš„å±æ€§ä¿¡æ¯</p><ul><li>name<ul><li>æŒ‡å®šäº‹åŠ¡ç®¡ç†å™¨</li></ul></li><li>propagation<ul><li>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œé»˜è®¤ä¸ºREQUIRED</li></ul></li><li>isolation <ul><li>äº‹åŠ¡çš„éš”ç¦»åº¦ï¼Œé»˜è®¤ä¸ºDEFAULT</li></ul></li><li>timeout<ul><li>äº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º-1ï¼Œå¦‚æœè¶…è¿‡è¯¥æ—¶é—´é™åˆ¶ä½†äº‹åŠ¡æ²¡æœ‰å®Œæˆï¼Œå°±è‡ªåŠ¨å›æ»š</li></ul></li><li>read-only<ul><li>æŒ‡å®šäº‹åŠ¡æ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡ï¼Œé»˜è®¤å€¼ä¸ºfalse</li><li>å½“è¦å¿½ç•¥é‚£äº›ä¸éœ€è¦äº‹åŠ¡çš„æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®read-onlyä¸ºtrue</li></ul></li><li>rollback-for<ul><li>æŒ‡å®šèƒ½å¤Ÿè§¦å‘äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»å‹ï¼Œå¦‚æœæœ‰å¤šä¸ªå¼‚å¸¸ç±»å‹éœ€è¦æŒ‡å®šï¼Œå¯ä»¥é€šè¿‡é€—å·æ¥åšåˆ†éš”</li></ul></li><li>no-rollback-for<ul><li>å¯¹äºåœ¨è¿™é‡Œå®šä¹‰çš„exceptionï¼Œä¸å›æ»š </li></ul></li></ul><h1 id="2-Spring-æ³¨è§£æ–¹å¼çš„äº‹åŠ¡å®ç°æœºåˆ¶"><a href="#2-Spring-æ³¨è§£æ–¹å¼çš„äº‹åŠ¡å®ç°æœºåˆ¶" class="headerlink" title="2. Spring æ³¨è§£æ–¹å¼çš„äº‹åŠ¡å®ç°æœºåˆ¶"></a>2. Spring æ³¨è§£æ–¹å¼çš„äº‹åŠ¡å®ç°æœºåˆ¶</h1><p>åœ¨è°ƒç”¨@Transactionalçš„ç›®æ ‡æ–¹æ³•ä¹‹åï¼ŒSpring Frameworkä¼šé€šè¿‡AOPä»£ç†ï¼Œåœ¨ä»£ç è¿è¡Œæ—¶ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œæ ¹æ®æ³¨è§£çš„å±æ€§é…ç½®ä¿¡æ¯ï¼Œå†³å®šè¯¥å£°æ˜@Transactionalçš„ç›®æ ‡æ–¹æ³•æ˜¯å¦ç”±æ‹¦æˆªå™¨ - TransactionInterceptoræ¥æ‹¦æˆª.</p><p>å¦‚æœç¡®å®šè¦è¢«æ‹¦æˆªï¼Œé‚£ä¹ˆå°±ä¼šåœ¨ç›®æ ‡æ–¹æ³•å¼€å§‹æ‰§è¡Œä¹‹å‰åˆ›å»ºå¹¶åŠ å…¥äº‹åŠ¡ï¼Œå¹¶æ‰§è¡Œç›®æ ‡æ–¹æ³•çš„é€»è¾‘ï¼Œæœ€åæ ¹æ®æ‰§è¡Œæƒ…å†µæ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œåˆ©ç”¨æŠ½è±¡äº‹åŠ¡ç®¡ç†å™¨æäº¤æˆ–è€…å›æ»šäº‹åŠ¡ã€‚</p><p><img src="https://i.loli.net/2020/03/25/cM5yEjbPAIogk1X.jpg" alt="Springäº‹åŠ¡å®ç°æœºåˆ¶.jpg"></p><h1 id="3-Isolation-Level"><a href="#3-Isolation-Level" class="headerlink" title="3. Isolation Level"></a>3. Isolation Level</h1><p>Isolationæ˜¯æœ‰ä¸åŒçš„é…ç½®çš„ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†é¿å…äº‹åŠ¡çš„ä¸€äº›å‰¯ä½œç”¨ï¼š</p><ul><li>è„è¯»ï¼šè¯»åˆ°åŒæ—¶è¿›è¡Œçš„äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ä¸Šå»çš„æ•°æ®</li><li>ä¸å¯é‡å¤çš„è¯»ï¼šé‡å¤è¯»çš„æ—¶å€™ä¼šè¯»åˆ°ä¸åŒçš„æ•°æ®ï¼Œå› ä¸ºæœ‰åŒæ—¶è¿›è¡Œçš„äº‹åŠ¡å¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œäº†æ›´æ–°</li><li>å¹½çµè¯»å–ï¼šåœ¨åšqueryçš„æ—¶å€™ï¼Œå†åº¦æ‰§è¡Œæ‹¿åˆ°ä¸åŒçš„è¡Œï¼Œå› ä¸ºæœ‰åŒæ—¶è¿›è¡Œçš„äº‹åŠ¡åœ¨åšæ›´æ–°</li></ul><p>é’ˆå¯¹ä¸åŒçº§åˆ«çš„äº‹åŠ¡ï¼ŒSpringæœ‰å¦‚ä¸‹çš„è®¾ç½®</p><ul><li>DEFAULT</li><li>READ_UNCOMMITTED<ul><li>æœ€ä½çš„éš”ç¦»æ°´å¹³ </li><li>å…è®¸å¤§éƒ¨åˆ†çš„åŒæ—¶çš„è®¿é—®</li><li>æœ‰ä¸Šè¿°æ‰€æœ‰çš„å¼Šç«¯</li></ul></li><li>READ_COMMMITED<ul><li>é˜»æ­¢è„è¯» </li></ul></li><li>REPEATABLE_READ<ul><li>é˜»æ­¢è„è¯»</li><li>é˜»æ­¢ä¸å¯é‡å¤è¯»å–</li></ul></li><li>SERAILIZABLE<ul><li>æœ€é«˜ç¨‹åº¦çš„éš”ç¦»</li><li>åŸºæœ¬æ˜¯å•åºåˆ—çš„æ‰§è¡Œ</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html" target="_blank" rel="noopener">https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/annotation/Transactional.html</a></li><li><a href="https://dzone.com/articles/how-does-spring-transactional" target="_blank" rel="noopener">https://dzone.com/articles/how-does-spring-transactional</a></li><li><a href="https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/index.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¢é˜Ÿèƒ½åŠ›æ„å»ºæ‰‹å†Œ-æ–°äººRamp Up</title>
      <link href="/%E5%9B%A2%E9%98%9F%E8%83%BD%E5%8A%9B%E6%9E%84%E5%BB%BA%E6%89%8B%E5%86%8C-%E6%96%B0%E4%BA%BARamp-Up/"/>
      <url>/%E5%9B%A2%E9%98%9F%E8%83%BD%E5%8A%9B%E6%9E%84%E5%BB%BA%E6%89%8B%E5%86%8C-%E6%96%B0%E4%BA%BARamp-Up/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡åšå®¢å¼•è¿°äº†ThoughtWorksçš„<a href="https://insights.thoughtworks.cn/capacity-building-and-quality-assurance/" target="_blank" rel="noopener">capacity-building-and-quality-assurance</a>ï¼Œé‡Œé¢è®²å¾—å¦‚ä½•æ„å»ºå›¢é˜Ÿï¼Œå¦‚ä½•è®©æ–°äººå¿«é€Ÿé€‚åº”çš„æ–¹æ³•æŒ‡å—éå¸¸å®ç”¨ã€‚åˆ†äº«/ æ€è€ƒ/ å½’çº³å¦‚ä¸‹ã€‚</p><p>è‡ªå·±æ‰€åœ¨çš„å›¢é˜Ÿæœ€è¿‘ä¹Ÿç»å†äº†å¿«é€Ÿçš„å¢é•¿ï¼Œåœ¨å¸¦æ–°äººçš„è¿‡ç¨‹å½“ä¸­ï¼Œç¡®å®æ„Ÿè§‰åˆ°æƒ³ä¸€èŒ¬æŠ“ä¸€èŒ¬æ˜¯å®¢è§‚å­˜åœ¨ä¸”ç»å¸¸æ€§å‘ç”Ÿçš„äº‹æƒ…ï¼Œlolã€‚éœ€è¦ä¸€ä¸ªæ›´åŠ æ¸…æ™°ç»†è‡´çš„ä¸Šæ‰‹æŒ‡å—ï¼Œå¹¶æŠŠä¸€äº›éœ€è¦çš„å‰ææ¡ä»¶å…ˆç»™åˆ°ï¼Œç„¶åç»™æ–°äººç•™ä¸‹åœ¨æ­£ç¡®çš„æ–¹å‘ä¸Šè¶³å¤Ÿçš„æ¢ç´¢ç©ºé—´ï¼Œè¿™æ ·å¤§æ¦‚æ‰èƒ½åŠ é€Ÿä»–ä»¬çš„æˆé•¿æŠŠã€‚</p><p>æˆ‘ä»¬å½“ç„¶éœ€è¦æ¯ä¸ªä¸ªä½“çš„æ— ä¸Šæ‰èƒ½ï¼Œä½†æ›´éœ€è¦ä¸€ä¸ªå¥½çš„å¹³å°ï¼Œè®©ä»–ä»¬èƒ½å¤Ÿä¸“æ³¨çš„å°†è‡ªå·±çš„æ‰èƒ½ç”¨åœ¨é‚£ä¸ªåœ°æ–¹ã€‚è€Œå¹³å°ï¼Œæ„å‘³ç€è„šæ‰‹æ¶ï¼Œæ„å‘³ç€è§„åˆ™ï¼Œæ„å‘³ç€æŒ‡å—ã€‚</p><h1 id="1-å¸¸è§„æ–°äººæˆé•¿æ–¹å¼-Mentor-Onboarding-Buddy"><a href="#1-å¸¸è§„æ–°äººæˆé•¿æ–¹å¼-Mentor-Onboarding-Buddy" class="headerlink" title="1. å¸¸è§„æ–°äººæˆé•¿æ–¹å¼ Mentor/ Onboarding Buddy"></a>1. å¸¸è§„æ–°äººæˆé•¿æ–¹å¼ Mentor/ Onboarding Buddy</h1><p>ä¸ºæ–°äººæŒ‡æ´¾ä¸€åæœ‰ç»éªŒçš„å¸ˆå‚…ï¼Œä½œä¸ºä»–çš„onboardingä¼™ä¼´ï¼Œå¹³æ—¶å¯ä»¥åšç»“å¯¹ç¼–ç¨‹ï¼Œåœ¨æ—¥å¸¸å·¥ä½œå½“ä¸­äº¤æ¢çŸ¥è¯†ï¼Œå­¦ä¹ å¹¶æˆé•¿ã€‚æ–°äººonboardingçš„é€Ÿåº¦ï¼Œå–å†³äºå¸ˆå‚…çš„æŠ€èƒ½ã€‚</p><p>è¿™ä¹ˆåšå½“ç„¶æœ‰å¥½å¤„ï¼Œä¸€å®šæ¯”æ–°äººè‡ªå·±æ¢ç´¢onboardè¦å¿«çš„å¤šï¼Œä½†æ˜¯æ­£å¦‚ä¸Šé¢æ‰€è¯´çš„é‚£æ ·ï¼Œè¿™ç§æ–¹å¼å¾ˆä¾èµ–äºå¸ˆå‚…çš„èƒ½åŠ›ï¼Œè¿˜æœ‰æ–°äººçš„æ²Ÿé€šäº¤æµï¼Œæœé›†çŸ¥è¯†çš„èƒ½åŠ›ã€‚æ•ˆæœä¼šå› ä¸ºæ¯ä¸ªæˆå‘˜çš„æ€§æ ¼ä¹ æƒ¯èƒ½åŠ›ç­‰ï¼Œæœ‰å¾ˆå¤§çš„ä¸åŒã€‚</p><h1 id="2-åˆ¶å®šè§„åˆ™åŒ–çš„æˆé•¿æµç¨‹"><a href="#2-åˆ¶å®šè§„åˆ™åŒ–çš„æˆé•¿æµç¨‹" class="headerlink" title="2. åˆ¶å®šè§„åˆ™åŒ–çš„æˆé•¿æµç¨‹"></a>2. åˆ¶å®šè§„åˆ™åŒ–çš„æˆé•¿æµç¨‹</h1><h2 id="2-1-CraftSkill-Map"><a href="#2-1-CraftSkill-Map" class="headerlink" title="2.1 CraftSkill Map"></a>2.1 CraftSkill Map</h2><p>èƒ½åŠ›åœ°å›¾æ˜¯å¸Œæœ›èƒ½å¤Ÿæ¢³ç†å®Œæ•´çš„æŠ€æœ¯å›¾è°±ï¼Œå¯¹æŠ€æœ¯äººå‘˜éœ€è¦æŒæ¡çš„èƒ½åŠ›è¿›è¡Œå¯è§†åŒ–</p><p>æ–°æˆå‘˜åœ¨åŠ å…¥é¡¹ç›®çš„æ—¶å€™ä¸€èˆ¬ä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼š</p><ul><li>è¿™ä¸ªé¡¹ç›®æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ </li><li>è¿™ä¸ªé¡¹ç›®æ˜¯åœ¨è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿ</li><li>è¿™ä¸ªé¡¹ç›®ä½¿ç”¨äº†ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Ÿ</li><li>æ–°æˆå‘˜åº”è¯¥ä»å“ªé‡Œå¼€å§‹ï¼Ÿ</li></ul><p>æ–°äººonboardï¼Œrampupéœ€è¦çš„çŸ¥è¯†æ˜¯å¯ä»¥åˆ†æˆå¯ä»¥è‡ªå·±å­¦ä¹ çš„çŸ¥è¯†(é€šè¿‡å„ç§æ–‡æ¡£ï¼Œwiki, stackoverflow, etc.)ä»¥åŠéœ€è¦è€äººçš„å¸®åŠ©çš„çŸ¥è¯†(éœ€è¦ä¸Šæ‰‹å®æ“çš„å†…å®¹ï¼Œæ¯”å¦‚è®¾è®¡åŸåˆ™ï¼ŒDRY,SOLID, LODç­‰ç­‰å…·ä½“å¦‚ä½•ä½¿ç”¨çš„é—®é¢˜)ã€‚</p><p>æˆ‘ä»¬éœ€è¦æ–°äººè‡ªå·±å»æ¢ç´¢ï¼Œè·å–ä¸€äº›å¿…è¦çš„å‰ææ€§çŸ¥è¯†ï¼Œä¹Ÿéœ€è¦æœ‰äººå¸®åŠ©ï¼Œå¸®ä»–è¿…é€Ÿé€‚åº”æ–°çš„ç¯å¢ƒã€‚</p><p>èƒ½åŠ›åœ°å›¾å°±æ˜¯å¸Œæœ›èƒ½å¤Ÿå¯¹æ‰€éœ€è¦çš„çŸ¥è¯†ï¼Œåšä¸€ä¸ªæ¸…æ™°çš„æ¢³ç†ï¼Œå½¢æˆä¸€ä¸ªè„‰ç»œï¼Œèƒ½å¤Ÿä½¿æ–°äººonboardçš„è¿‡ç¨‹æ›´æœ‰çš„æ”¾çŸ¢ä¸€äº›ã€‚</p><p><img src="https://i.loli.net/2020/03/24/JayeLmisObEpdTS.png" alt="craftskill map E.G.png"></p><h2 id="2-2-æŒ‡å®šOnboardingæµç¨‹"><a href="#2-2-æŒ‡å®šOnboardingæµç¨‹" class="headerlink" title="2.2 æŒ‡å®šOnboardingæµç¨‹"></a>2.2 æŒ‡å®šOnboardingæµç¨‹</h2><p>è¿™é‡Œä¸»è¦æ˜¯è¦ç»™ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„è®¡åˆ’ï¼Œå‘ŠçŸ¥æ–°äººæ¯å‘¨è¦åšçš„äº‹æƒ…ï¼Œæ›´å¤šçš„æ˜¯æ—¶é—´ä¸Šï¼Œä»»åŠ¡ä¸Šçš„å®‰æ’ã€‚</p><p>æ ¹æ®ä»»åŠ¡ï¼Œå¯ä»¥ä¾§é‡å­¦ä¹ å‰ç«¯ï¼Œåç«¯ï¼Œæˆ–è€…QAæ–¹é¢çš„é¢†åŸŸçŸ¥è¯†å’ŒæŠ€èƒ½ï¼Œç„¶å<strong>åšä¸€ä¸ªmeetingï¼Œå°†è‡ªå·±å­¦åˆ°çš„å®Œæ•´çš„å’Œç»„é‡Œçš„åŒäº‹åˆ†äº«ä¸‹ï¼Œç„¶åå¯ä»¥ä¸€èµ·æŸ¥æ¼è¡¥ç¼ºï¼Œå®Œå–„æ–°äººçš„çŸ¥è¯†ä½“ç³»</strong>ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯Onboardingçš„æµç¨‹å½“ä¸­éœ€è¦æœ‰é‡Œç¨‹ç¢‘å’Œæ‰§è¡Œæ—¶é—´ï¼Œç”±èµ„æ·±å‘˜å·¥ååŠ©åˆ¶å®šï¼Œç„¶åå°±å¯ä»¥é¢†å–ä»»åŠ¡ï¼Œä¿è´¨ä¿é‡çš„ç‹¬ç«‹å®Œæˆã€‚</p><p>Onboardæµç¨‹å½“ä¸­ï¼Œå…³äºè‡ªå·±çœ‹çš„çŸ¥è¯†ï¼Œæœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥æ¥åšï¼Œæ¯”å¦‚wikiï¼Œè§†é¢‘ï¼Œç”šè‡³æ˜¯éŸ³é¢‘ï¼Œèµ·åˆ°çš„ä½œç”¨å°±æ˜¯æ›´é«˜é€Ÿåº¦çš„å­¦ä¹ ã€‚è¿™ç§ç›¸å¯¹æ¥è¯´æ¯”è¾ƒè¢«åŠ¨ï¼Œä¸»åŠ¨æ€§çš„å­¦ä¹ å¯ä»¥é€šè¿‡Unit testï¼Œå°†çŸ¥è¯†ç‚¹è½¬åŒ–æˆUnit testï¼Œç„¶åé€šè¿‡å•å…ƒæµ‹è¯•è¿…é€Ÿç†Ÿæ‚‰çŸ¥è¯†ç‚¹ã€‚</p><h2 id="2-3-æ–°æˆå‘˜çŠ¶æ€çœ‹æ¿"><a href="#2-3-æ–°æˆå‘˜çŠ¶æ€çœ‹æ¿" class="headerlink" title="2.3 æ–°æˆå‘˜çŠ¶æ€çœ‹æ¿"></a>2.3 æ–°æˆå‘˜çŠ¶æ€çœ‹æ¿</h2><p>æ¯å‘¨ç”±mentorè´Ÿè´£è·Ÿè¸ªè§‚å¯Ÿæ–°äººçŠ¶æ€ï¼Œä¼šè®®è¿½è¸ªï¼Œç¡®å®šæ–°äººæ˜¯å¦èƒ½åœ¨ä¸€ä¸ªæœˆçš„ramp upä»¥åè‡ªå·±ç‹¬ç«‹è´Ÿè´£ä¸€éƒ¨åˆ†çš„ä»»åŠ¡ã€‚</p><h2 id="2-4-Case-by-case-é’ˆå¯¹æ€§åŸ¹è®­"><a href="#2-4-Case-by-case-é’ˆå¯¹æ€§åŸ¹è®­" class="headerlink" title="2.4 Case by case é’ˆå¯¹æ€§åŸ¹è®­"></a>2.4 Case by case é’ˆå¯¹æ€§åŸ¹è®­</h2><p>æ ¹æ®ä¸ªäººæƒ…å†µæ¥æ¢ç©¶å¦‚ä½•åšæé«˜ï¼Œæ˜¯å¦å¯ä»¥æå‰äº¤ä»˜é¡¹ç›®ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</p><p><a href="https://insights.thoughtworks.cn/capacity-building-and-quality-assurance/" target="_blank" rel="noopener">https://insights.thoughtworks.cn/capacity-building-and-quality-assurance/</a></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mentor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿ªç±³ç‰¹æ³•åˆ™ (LOD) â€” é«˜å†…èšï¼Œä½è€¦åˆ</title>
      <link href="/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99-LOD-%E2%80%94-%E9%AB%98%E5%86%85%E8%81%9A%EF%BC%8C%E4%BD%8E%E8%80%A6%E5%90%88/"/>
      <url>/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99-LOD-%E2%80%94-%E9%AB%98%E5%86%85%E8%81%9A%EF%BC%8C%E4%BD%8E%E8%80%A6%E5%90%88/</url>
      
        <content type="html"><![CDATA[<p>é«˜å†…èš ä½è€¦åˆæ˜¯æ¯”è¾ƒé€šç”¨çš„è®¾è®¡æ€æƒ³ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å¯¼ä¸åŒçš„ç²’åº¦çš„ä»£ç çš„è®¾è®¡å’Œå¼€å‘çš„å·¥ä½œï¼Œæ¯”å¦‚ç³»ç»Ÿï¼Œæ¨¡å—ï¼Œç±»ï¼Œç”šè‡³æ˜¯å‡½æ•°ã€‚ä¹Ÿå¯ä»¥å»ä½¿ç”¨åˆ°ä¸åŒçš„å¼€å‘åœºæ™¯å½“ä¸­ï¼Œæ¯”å¦‚å¾®æœåŠ¡ï¼Œæ¡†æ¶ï¼Œç»„ä»¶ï¼Œç±»åº“ç­‰ç­‰ã€‚</p><p>åœ¨è¿™ä¸ªåŸåˆ™å½“ä¸­ï¼Œé«˜å†…èšæŒ‡çš„æ˜¯ç±»æœ¬èº«çš„è®¾è®¡ï¼Œä½è€¦åˆæŒ‡çš„æ˜¯ç±»å’Œç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»çš„è®¾è®¡ã€‚</p><p>è¿ªç±³ç‰¹æ³•åˆ™ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºThe least knowledge principle.<br>Each unit should have only limited knowledge about other units: only units â€œcloselyâ€ related to the current unit. Or: Each unit should only talk to its friends; Donâ€™t talk to strangers.</p><h1 id="1-ä»€ä¹ˆæ˜¯é«˜å†…èšï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯é«˜å†…èšï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯é«˜å†…èšï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯é«˜å†…èšï¼Ÿ</h1><p>æŒ‡çš„æ˜¯ç›¸è¿‘çš„åŠŸèƒ½åº”è¯¥æ”¾åˆ°åŒä¸€ä¸ªç±»å½“ä¸­ï¼Œä¸ç›¸è¿‘çš„åŠŸèƒ½ä¸è¦æ”¾åœ¨åŒä¸€ç±»ã€‚ä»£ç é›†ä¸­ç›¸å¯¹æ¥è¯´å°±ä¼šæ›´åŠ å®¹æ˜“ç»´æŠ¤äº†ã€‚</p><h1 id="2-ä»€ä¹ˆæ˜¯ä½è€¦åˆï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯ä½è€¦åˆï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯ä½è€¦åˆï¼Ÿ"></a>2. ä»€ä¹ˆæ˜¯ä½è€¦åˆï¼Ÿ</h1><p>ç±»å’Œç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ç®€å•æ¸…æ™°ï¼Œå³å°½ç®¡ä¸¤ä¸ªç±»ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ã€‚ä¸€ä¸ªç±»çš„ä»£ç çš„æ”¹åŠ¨ä¸ä¼šæˆ–è€…å¾ˆå°‘å¯¼è‡´ä¾èµ–ç±»çš„ä»£ç çš„æ”¹åŠ¨ã€‚</p><h1 id="3-å†…èšå’Œè€¦åˆçš„å…³ç³»"><a href="#3-å†…èšå’Œè€¦åˆçš„å…³ç³»" class="headerlink" title="3. å†…èšå’Œè€¦åˆçš„å…³ç³»"></a>3. å†…èšå’Œè€¦åˆçš„å…³ç³»</h1><p><img src="https://i.loli.net/2020/03/23/yZVTqaQSgvbtE4l.png" alt="å†…èšè€¦åˆå…³ç³».png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå·¦ä¾§å°±æ˜¯å¾ˆå¥½çš„é«˜å†…èšä½è€¦åˆçš„èŒƒä¾‹ï¼Œæˆ‘ä»¬å°†ç±»æœ€å°åŒ–ï¼Œå³æ¯ä¸ªç±»åªåšä¸€ä»¶äº‹æƒ…ï¼Œè¿™æ ·å­å…¶ä»–ä¾èµ–å°±ä¼šå°‘å¾ˆå¤šã€‚åœ¨ä¿®æ”¹æˆ–å¢åŠ åŠŸèƒ½çš„æ—¶å€™ï¼Œå°±ä¸ä¼šå¯¹å…¶ä»–çš„ç±»é€ æˆå¾ˆå¤§çš„å½±å“ã€‚</p><h1 id="4-å®æˆ˜"><a href="#4-å®æˆ˜" class="headerlink" title="4. å®æˆ˜"></a>4. å®æˆ˜</h1><pre><code>public class NetworkTransporter {    // å­˜åœ¨é—®é¢˜ï¼ŒNetworkTransporterä½œä¸ºä¸€ä¸ªåº•å±‚ç±»ï¼Œä¸åº”è¯¥ä¾èµ–äºHtmlRequestç±»ï¼›ä¸ä¹‹ç›¸åçš„ï¼Œå› ä¸ºå…¶å®ä»–éœ€è¦çš„æ˜¯string addressï¼Œä»¥åŠbyteçš„æ•°ç»„ï¼Œé‚£æˆ‘ä»¬åº”è¯¥ç›´æ¥æä¾›è¿™äº›primitive typeçš„æ•°æ®    public Byte[] send(HtmlRequest htmlRequest) {      //...    }}public class HtmlDownloader {  private NetworkTransporter transporter;//é€šè¿‡æ„é€ å‡½æ•°æˆ–IOCæ³¨å…¥  public Html downloadHtml(String url) {  // æ ¹æ®ä¸Šé¢NetworkTransporteræˆ‘ä»¬å¸Œæœ›åšçš„æ”¹åŠ¨ï¼Œè¿™é‡Œä¼ å…¥çš„ä¸åº”è¯¥æ˜¯HtmlRequestç±»çš„å®ä¾‹äº†    Byte[] rawHtml = transporter.send(new HtmlRequest(url));    return new Html(rawHtml);  }}public class Document {  private Html html;  private String url;  public Document(String url) {    this.url = url;    // downloader.downloadHtmlé€»è¾‘å¤æ‚ï¼Œä¸åº”è¯¥æ”¾åœ¨æ„é€ å‡½æ•°å½“ä¸­ï¼Œä¹Ÿä¼šå¾ˆä¸å¥½æµ‹è¯•    // æ„é€ å‡½æ•°ä¸­ä½¿ç”¨newæ¥åšå®ä¾‹ï¼Œè¿åäº†åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹çš„åŸåˆ™    HtmlDownloader downloader = new HtmlDownloader();    this.html = downloader.downloadHtml(url);  }  //...}</code></pre><p>ä¿®æ”¹ä»¥åçš„ä»£ç ï¼š </p><pre><code>public class NetworkTransporter {    // çœç•¥å±æ€§å’Œå…¶ä»–æ–¹æ³•...    public Byte[] send(String address, Byte[] data) {      //...    }}public class HtmlDownloader {  private NetworkTransporter transporter;//é€šè¿‡æ„é€ å‡½æ•°æˆ–IOCæ³¨å…¥  // HtmlDownloaderè¿™é‡Œä¹Ÿè¦æœ‰ç›¸åº”çš„ä¿®æ”¹  public Html downloadHtml(String url) {    HtmlRequest htmlRequest = new HtmlRequest(url);    Byte[] rawHtml = transporter.send(      htmlRequest.getAddress(), htmlRequest.getContent().getBytes());    return new Html(rawHtml);  }}public class Document {  private Html html;  private String url;  public Document(String url, Html html) {    this.html = html;    this.url = url;  }  //...}// é€šè¿‡ä¸€ä¸ªå·¥å‚æ–¹æ³•æ¥åˆ›å»ºDocumentpublic class DocumentFactory {  private HtmlDownloader downloader;  public DocumentFactory(HtmlDownloader downloader) {    this.downloader = downloader;  }  public Document createDocument(String url) {    Html html = downloader.downloadHtml(url);    return new Document(url, html);  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é«˜å†…èš </tag>
            
            <tag> ä½è€¦åˆ </tag>
            
            <tag> è¿ªç±³ç‰¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DRY åŸåˆ™</title>
      <link href="/DRY-%E5%8E%9F%E5%88%99/"/>
      <url>/DRY-%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>Donâ€™t repeat yourself </p><h1 id="1-å®ç°é€»è¾‘çš„é‡å¤"><a href="#1-å®ç°é€»è¾‘çš„é‡å¤" class="headerlink" title="1. å®ç°é€»è¾‘çš„é‡å¤"></a>1. å®ç°é€»è¾‘çš„é‡å¤</h1><pre><code>public class UserAuthenticator {  public void authenticate(String username, String password) {    if (!isValidUsername(username)) {      // ...throw InvalidUsernameException...    }    if (!isValidPassword(password)) {      // ...throw InvalidPasswordException...    }    //...çœç•¥å…¶ä»–ä»£ç ...  }  private boolean isValidUsername(String username) {    // check not null, not empty    if (StringUtils.isBlank(username)) {      return false;    }    // check length: 4~64    int length = username.length();    if (length &lt; 4 || length &gt; 64) {      return false;    }    // contains only lowcase characters    if (!StringUtils.isAllLowerCase(username)) {      return false;    }    // contains only a~z,0~9,dot    for (int i = 0; i &lt; length; ++i) {      char c = username.charAt(i);      if (!(c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;) || (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) || c == &#39;.&#39;) {        return false;      }    }    return true;  }  private boolean isValidPassword(String password) {    // check not null, not empty    if (StringUtils.isBlank(password)) {      return false;    }    // check length: 4~64    int length = password.length();    if (length &lt; 4 || length &gt; 64) {      return false;    }    // contains only lowcase characters    if (!StringUtils.isAllLowerCase(password)) {      return false;    }    // contains only a~z,0~9,dot    for (int i = 0; i &lt; length; ++i) {      char c = password.charAt(i);      if (!(c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;) || (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) || c == &#39;.&#39;) {        return false;      }    }    return true;  }}</code></pre><p>è¿™é‡Œæƒ³å¼ºè°ƒçš„æ˜¯ä¸ä¸€å®šå®Œå…¨ä¸€æ ·çš„ä»£ç å°±æ„å‘³ç€ä»–ä»¬æ˜¯éœ€è¦åˆå¹¶çš„ï¼Œæ¯”å¦‚ä¸Šè¿°çš„ä»£ç å½“ä¸­ï¼ŒisValidPasswordè¿˜æœ‰isValidUsernameæœ‰ç€åŸºæœ¬ä¸Šç›¸åŒçš„é€»è¾‘ç»“æ„ï¼Œä½†æ˜¯ä»–ä»¬æœ¬èº«ä»£è¡¨çš„æ˜¯ä¸åŒçš„æ„æ€çš„ï¼Œè™½ç„¶ä¸€æ ·çš„é€»è¾‘ï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ä¿è¯åœ¨æ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´ä»¥å†…ï¼Œä»–ä»¬è¿˜èƒ½è¿™æ ·å­ä¸€è‡´ä¸‹å»ã€‚</p><p>æ‰€ä»¥åˆå¹¶ä¸ºisValidUserOrPasswordæ˜¯ä¸å¯ä»¥çš„ï¼Œé€»è¾‘ä¸Šè®²ä¸é€šï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•è¿›è¡Œåˆ†å‰²çš„æ–¹å¼ï¼Œæ¥å¤ç”¨ä¸€äº›ä»£ç ã€‚</p><p>å…¶å®æœ‰ä¸€äº›ä½¿ç”¨ç»„åˆçš„å‘³é“åœ¨é‡Œé¢äº†ã€‚</p><h1 id="2-åŠŸèƒ½è¯­ä¹‰çš„é‡å¤"><a href="#2-åŠŸèƒ½è¯­ä¹‰çš„é‡å¤" class="headerlink" title="2. åŠŸèƒ½è¯­ä¹‰çš„é‡å¤"></a>2. åŠŸèƒ½è¯­ä¹‰çš„é‡å¤</h1><p>å¯¹äºåŠŸèƒ½è¯­ä¹‰é‡å¤çš„ç†è§£ï¼Œæ˜¯æŒ‡ä¸€ä¸ªä»£ç åŒ…é‡Œåœ¨å¤šä¸ªåœ°æ–¹ä¸ºäº†å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œè®¾å®šäº†ä¸åŒçš„æ–¹æ³•ä½“ã€‚è¿™å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å› ä¸ºæ²Ÿé€šç­‰æ–¹é¢çš„é—®é¢˜ï¼Œä¸ç®¡é‡Œé¢ä½¿ç”¨çš„æ–¹æ³•æœ‰ä»€ä¹ˆä¸åŒï¼Œå¦‚æœä»–ä»¬éƒ½æ˜¯ä¸ºäº†è¾¾æˆä¸€æ ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºå…¶å®è¿åäº†DRYåŸåˆ™çš„ï¼Œæ˜¯éœ€è¦æ¸…é™¤å¤šä½™çš„æ–¹æ³•ä½“çš„ã€‚</p><h1 id="3-ä»£ç æ‰§è¡Œé‡å¤"><a href="#3-ä»£ç æ‰§è¡Œé‡å¤" class="headerlink" title="3. ä»£ç æ‰§è¡Œé‡å¤"></a>3. ä»£ç æ‰§è¡Œé‡å¤</h1><p>çœ‹ä»£ç çš„å†…éƒ¨é€»è¾‘ï¼Œå‡å°‘å¤šæ¬¡é‡å¤è°ƒç”¨çš„ä»£ç ã€‚</p><p>æ³¨æ„IOæ“ä½œï¼Œå› ä¸ºIOéå¸¸è´¹æ—¶â€¦</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>KISS and YAGNIåŸåˆ™</title>
      <link href="/KISS-and-YAGNI%E5%8E%9F%E5%88%99/"/>
      <url>/KISS-and-YAGNI%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="1-KISS"><a href="#1-KISS" class="headerlink" title="1. KISS"></a>1. KISS</h1><p>Keep it simple and stupid. </p><p>è¿™ä¸ªåŸåˆ™ç›¸å¯¹æ¯”è¾ƒèŒƒèŒƒï¼Œå…¶å®ç€é‡åœ¨è¯´çš„è¿˜æ˜¯ä»ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¸¤ä¸ªè§’åº¦æ¥è¡¡é‡ä»£ç çš„è´¨é‡ã€‚</p><pre><code>// ç¬¬ä¸€ç§å®ç°æ–¹å¼: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼public boolean isValidIpAddressV1(String ipAddress) {  if (StringUtils.isBlank(ipAddress)) return false;  String regex = &quot;^(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|[1-9])\\.&quot;          + &quot;(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)\\.&quot;          + &quot;(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)\\.&quot;          + &quot;(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)$&quot;;  return ipAddress.matches(regex);}// ç¬¬äºŒç§å®ç°æ–¹å¼: ä½¿ç”¨ç°æˆçš„å·¥å…·ç±»public boolean isValidIpAddressV2(String ipAddress) {  if (StringUtils.isBlank(ipAddress)) return false;  String[] ipUnits = StringUtils.split(ipAddress, &#39;.&#39;);  if (ipUnits.length != 4) {    return false;  }  for (int i = 0; i &lt; 4; ++i) {    int ipUnitIntValue;    try {      ipUnitIntValue = Integer.parseInt(ipUnits[i]);    } catch (NumberFormatException e) {      return false;    }    if (ipUnitIntValue &lt; 0 || ipUnitIntValue &gt; 255) {      return false;    }    if (i == 0 &amp;&amp; ipUnitIntValue == 0) {      return false;    }  }  return true;}// ç¬¬ä¸‰ç§å®ç°æ–¹å¼: ä¸ä½¿ç”¨ä»»ä½•å·¥å…·ç±»public boolean isValidIpAddressV3(String ipAddress) {  char[] ipChars = ipAddress.toCharArray();  int length = ipChars.length;  int ipUnitIntValue = -1;  boolean isFirstUnit = true;  int unitsCount = 0;  for (int i = 0; i &lt; length; ++i) {    char c = ipChars[i];    if (c == &#39;.&#39;) {      if (ipUnitIntValue &lt; 0 || ipUnitIntValue &gt; 255) return false;      if (isFirstUnit &amp;&amp; ipUnitIntValue == 0) return false;      if (isFirstUnit) isFirstUnit = false;      ipUnitIntValue = -1;      unitsCount++;      continue;    }    if (c &lt; &#39;0&#39; || c &gt; &#39;9&#39;) {      return false;    }    if (ipUnitIntValue == -1) ipUnitIntValue = 0;    ipUnitIntValue = ipUnitIntValue * 10 + (c - &#39;0&#39;);  }  if (ipUnitIntValue &lt; 0 || ipUnitIntValue &gt; 255) return false;  if (unitsCount != 3) return false;  return true;}</code></pre><p>ç›¸å¯¹æ¥è¯´ï¼Œç¬¬äºŒç§å®ç°æ–¹å¼ä¼šæ›´å¥½ä¸€äº›ï¼Œå› ä¸ºç»†èŠ‚è¢«å°è£…åœ¨å·¥å…·ç±»å½“ä¸­ï¼Œå¯è¯»æ€§ç›¸å¯¹å¼ºå¾ˆå¤šï¼›æ–¹æ³•ä¸€ç›´æ¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯è¯»æ€§ä¼šå·®å¾ˆå¤šï¼›ç¬¬ä¸‰ç§è‡ªå·±æ¥å¤„ç†åº•å±‚çš„é€»è¾‘ï¼Œè™½ç„¶æ‰§è¡Œèµ·æ¥ç›¸å¯¹ä¼šå¿«ä¸€äº›ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“å‡ºé”™ã€‚</p><h1 id="2-YAGNI"><a href="#2-YAGNI" class="headerlink" title="2. YAGNI"></a>2. YAGNI</h1><p>You ainâ€™t gonna need it. </p><p>ä½ ä¸ä¼šéœ€è¦å®ƒã€‚æ·±æœ‰æ„Ÿè§¦ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬æƒ³å†™å¾ˆä¼˜é›…çš„ä»£ç ï¼Œä¼šç–¯ç‹‚å‘åè€ƒè™‘ï¼Œæ¯”å¦‚å¯¹äºä¸å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæœ‰çš„æ—¶å€™å“ªæ€•å°±ä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿæƒ³æä¸ªæ¥å£ä¾›åé¢çš„æ‰©å±•æ¥ä½¿ç”¨ã€‚è¿‡åº¦è®¾è®¡ï¼Œåè€Œå¢åŠ äº†ä»£ç çš„é˜…è¯»æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚</p><p>æˆ‘ä»¬ä¸åº”å½“å»è®¾è®¡å½“å‰ç”¨ä¸åˆ°çš„åŠŸèƒ½ï¼Œä¹Ÿä¸åº”è¯¥ç¼–å†™ç°åœ¨ç”¨ä¸åˆ°çš„ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SOLID - ä¾èµ–åè½¬åŸåˆ™</title>
      <link href="/SOLID-%E4%BE%9D%E8%B5%96%E5%8F%8D%E8%BD%AC%E5%8E%9F%E5%88%99/"/>
      <url>/SOLID-%E4%BE%9D%E8%B5%96%E5%8F%8D%E8%BD%AC%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ§åˆ¶åè½¬-IOC-Inversion-of-Control"><a href="#1-æ§åˆ¶åè½¬-IOC-Inversion-of-Control" class="headerlink" title="1. æ§åˆ¶åè½¬ IOC Inversion of Control"></a>1. æ§åˆ¶åè½¬ IOC Inversion of Control</h1><pre><code>public class UserServiceTest {  public static boolean doTest() {    // ...   }  public static void main(String[] args) {//è¿™éƒ¨åˆ†é€»è¾‘å¯ä»¥æ”¾åˆ°æ¡†æ¶ä¸­    if (doTest()) {      System.out.println(&quot;Test succeed.&quot;);    } else {      System.out.println(&quot;Test failed.&quot;);    }  }}</code></pre><p>ä¸Šè¿°ä»£ç ç¨‹åºå‘˜åœ¨è‡ªå·±æ§åˆ¶æ•´ä¸ªä»£ç çš„è¿è¡Œé¡ºåºå’Œæ‰§è¡Œ,å¯ä»¥çœ‹åˆ°å¦‚æœæˆ‘æƒ³å¢åŠ testçš„è¯ï¼Œå°±è¦åœ¨mainå‡½æ•°é‡Œé¢æ·»åŠ ï¼ŒåŒæ—¶åœ¨UserServiceTestå½“ä¸­æ·»åŠ å®ä¾‹ã€‚è€Œä½¿ç”¨æ¡†æ¶çš„è¯ï¼Œä»£ç å°±å¯ä»¥å˜æˆå¦‚ä¸‹ï¼š</p><pre><code>public abstract class TestCase {  public void run() {    if (doTest()) {      System.out.println(&quot;Test succeed.&quot;);    } else {      System.out.println(&quot;Test failed.&quot;);    }  }  public abstract boolean doTest();}public class JunitApplication {  private static final List&lt;TestCase&gt; testCases = new ArrayList&lt;&gt;();  public static void register(TestCase testCase) {    testCases.add(testCase);  }  public static final void main(String[] args) {    for (TestCase case: testCases) {      case.run();    }  }</code></pre><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å°†æµ‹è¯•çš„æ³¨å†Œå’Œè¿è¡Œéƒ½äº¤ç»™äº†JunitApplicationäº†ï¼Œç„¶åæˆ‘ä»¬è¦å†™æ–°testï¼Œå°±è®©æˆ‘ä»¬çš„concrete class extends TestCaseç±»ï¼Œæ¥å¡«å……æˆ‘ä»¬éœ€è¦åšçš„å„ç§æµ‹è¯•ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å®ç°äº†ä½¿ç”¨æ¡†æ¶æ¥æ§åˆ¶æ•´ä¸ªä»£ç çš„è¿è½¬ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¡†æ¶æ¥<strong>ç»„è£…å¯¹è±¡ï¼Œç®¡ç†æ•´ä¸ªæ‰§è¡Œæµç¨‹</strong>ã€‚ç¨‹åºå‘˜åˆ©ç”¨æ¡†æ¶è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œåªéœ€è¦å¾€é¢„ç•™çš„æ‰©å±•ç‚¹ä¸Šï¼Œæ·»åŠ è·Ÿè‡ªå·±ä¸šåŠ¡ç›¸å…³çš„ä»£ç ï¼Œç„¶ååˆ©ç”¨æ¡†æ¶æ¥é©±åŠ¨æ•´ä¸ªç¨‹åºæµç¨‹çš„æ‰§è¡Œã€‚</p><p>æ§åˆ¶åè½¬æ˜¯ä¸€ç§æ€æƒ³ï¼Œæœ‰å¾ˆå¤šçš„å…·ä½“çš„å®ç°æ–¹å¼</p><h1 id="2-æ§åˆ¶åè½¬-â€“-ä¾èµ–æ³¨å…¥"><a href="#2-æ§åˆ¶åè½¬-â€“-ä¾èµ–æ³¨å…¥" class="headerlink" title="2. æ§åˆ¶åè½¬ â€“ ä¾èµ–æ³¨å…¥"></a>2. æ§åˆ¶åè½¬ â€“ ä¾èµ–æ³¨å…¥</h1><p>æ˜¯æ§åˆ¶åè½¬çš„ä¸€ç§å…·ä½“å®ç°çš„æ–¹å¼ï¼Œä»–çš„å®é™…æ“ä½œçš„æŒ‡å—æ˜¯ â€“ ä¸é€šè¿‡newï¼ˆï¼‰çš„æ–¹å¼åœ¨ç±»å†…éƒ¨åˆ›å»ºä¾èµ–ç±»çš„å¯¹è±¡ï¼Œè€Œæ˜¯å°†ä¾èµ–çš„ç±»å¯¹è±¡åœ¨å¤–éƒ¨åˆ›å»ºå¥½ä»¥åï¼Œé€šè¿‡æ„é€ å‡½æ•°ï¼Œå‡½æ•°å‚æ•°çš„æ–¹å¼ä¼ é€’è¿›æ¥ç»™ç±»ä½¿ç”¨ã€‚</p><pre><code>// éä¾èµ–æ³¨å…¥å®ç°æ–¹å¼public class Notification {  private MessageSender messageSender;  public Notification() {    this.messageSender = new MessageSender(); //æ­¤å¤„æœ‰ç‚¹åƒhardcode  }  public void sendMessage(String cellphone, String message) {    //...çœç•¥æ ¡éªŒé€»è¾‘ç­‰...    this.messageSender.send(cellphone, message);  }}public class MessageSender {  public void send(String cellphone, String message) {    //....  }}// ä½¿ç”¨NotificationNotification notification = new Notification();// ä¾èµ–æ³¨å…¥çš„å®ç°æ–¹å¼public class Notification {  private MessageSender messageSender;  // é€šè¿‡æ„é€ å‡½æ•°å°†messageSenderä¼ é€’è¿›æ¥  public Notification(MessageSender messageSender) {    this.messageSender = messageSender;  }  public void sendMessage(String cellphone, String message) {    //...çœç•¥æ ¡éªŒé€»è¾‘ç­‰...    this.messageSender.send(cellphone, message);  }}//ä½¿ç”¨NotificationMessageSender messageSender = new MessageSender();Notification notification = new Notification(messageSender);</code></pre><p>ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨å…·ä½“çš„ç±»å½“ä¸­å®ä¾‹åŒ–å…¶ä»–çš„ç±»ï¼Œè¿™æ ·å°±å®ç°äº†è§£è€¦ï¼Œå³ä»–çš„å…·ä½“å®ç°æˆ‘ä»¬å¯ä»¥åœ¨å¤–éƒ¨åšå…¶ä»–æ–¹å¼çš„å®ä¾‹ï¼Œè¿™ä¸ªæ—¶å€™å¤šæ€ä¹Ÿå¯ä»¥æ´¾ä¸Šç”¨åœºã€‚å¯ä»¥æƒ³æˆæˆ‘åœ¨ç±»çš„å†…éƒ¨å äº†ä¸ªåº§ï¼Œè‡³äºè¿™ä¸ªåº§å…·ä½“è¦ç»™è°åï¼Œæ€ä¹ˆåï¼Œå¾—ç­‰åˆ°èŠ‚ç›®è¦å¼€å§‹ä¹‹å‰å†æ¥å®‰æ’ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ä¸¾åŠä¸åŒçš„æ´»åŠ¨äº†ã€‚</p><pre><code>public class Notification {  private MessageSender messageSender;  public Notification(MessageSender messageSender) {    this.messageSender = messageSender;  }  public void sendMessage(String cellphone, String message) {    this.messageSender.send(cellphone, message);  }}public interface MessageSender {  void send(String cellphone, String message);}// çŸ­ä¿¡å‘é€ç±»public class SmsSender implements MessageSender {  @Override  public void send(String cellphone, String message) {    //....  }}// ç«™å†…ä¿¡å‘é€ç±»public class InboxSender implements MessageSender {  @Override  public void send(String cellphone, String message) {    //....  }}//ä½¿ç”¨NotificationMessageSender messageSender = new SmsSender();Notification notification = new Notification(messageSender);</code></pre><h1 id="3-ä¾èµ–åè½¬åŸåˆ™"><a href="#3-ä¾èµ–åè½¬åŸåˆ™" class="headerlink" title="3. ä¾èµ–åè½¬åŸåˆ™"></a>3. ä¾èµ–åè½¬åŸåˆ™</h1><p>ä¾èµ–åè½¬ â€“ Dependency Inversion Principle </p><blockquote><p>High-level modules shouldnâ€™t depend on low-level modules. Both modules should depend on abstractions. In addition, abstractions shouldnâ€™t depend on details. Details depend on abstractions.</p></blockquote><p>é«˜å±‚æ¨¡å—ï¼ˆhigh-level modulesï¼‰ä¸è¦ä¾èµ–ä½å±‚æ¨¡å—ï¼ˆlow-levelï¼‰ã€‚é«˜å±‚æ¨¡å—å’Œä½å±‚æ¨¡å—åº”è¯¥é€šè¿‡æŠ½è±¡ï¼ˆabstractionsï¼‰æ¥äº’ç›¸ä¾èµ–ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒæŠ½è±¡ï¼ˆabstractionsï¼‰ä¸è¦ä¾èµ–å…·ä½“å®ç°ç»†èŠ‚ï¼ˆdetailsï¼‰ï¼Œå…·ä½“å®ç°ç»†èŠ‚ï¼ˆdetailsï¼‰ä¾èµ–æŠ½è±¡ï¼ˆabstractionsï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SOLID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SOLID - æ¥å£éš”ç¦»åŸåˆ™</title>
      <link href="/SOLID-%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99/"/>
      <url>/SOLID-%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>æ¥å£éš”ç¦»åŸåˆ™ â€“ interface segregation principle </p><p>å®¢æˆ·ç«¯ä¸åº”è¯¥å¼ºè¿«ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ã€‚</p><h1 id="1-å°†æ¥å£è§†ä¸ºä¸€ç»„APIæ¥å£çš„é›†åˆ"><a href="#1-å°†æ¥å£è§†ä¸ºä¸€ç»„APIæ¥å£çš„é›†åˆ" class="headerlink" title="1. å°†æ¥å£è§†ä¸ºä¸€ç»„APIæ¥å£çš„é›†åˆ"></a>1. å°†æ¥å£è§†ä¸ºä¸€ç»„APIæ¥å£çš„é›†åˆ</h1><pre><code>public interface UserService {  boolean register(String cellphone, String password);  boolean login(String cellphone, String password);  UserInfo getUserInfoById(long id);  UserInfo getUserInfoByCellphone(String cellphone);}public class UserServiceImpl implements UserService {  //...}</code></pre><p>å½“æˆ‘ä»¬è¦å®ç°åˆ é™¤æ“ä½œçš„æ—¶å€™ï¼Œæœ€å¥½ä¸è¦ç›´æ¥åœ¨UserServiceé‡Œé¢åŠ ä¸Šè¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºç”¨æˆ·æœåŠ¡å®è´¨ä¸Šä¸åº”è¯¥è¢«é»˜è®¤ç›´æ¥å…·æœ‰åˆ é™¤çš„æƒé™ï¼Œç›¸å¯¹åº”çš„ï¼Œæˆ‘ä»¬åº”è¯¥å»åˆ›å»ºä¸€ä¸ªæ–°çš„æ¥å£ï¼Œé‡Œé¢å®ç°æœ‰åˆ é™¤ç›¸å…³çš„æ–¹æ³•ï¼Œå®ç°æ¥å£çš„éš”ç¦»ã€‚</p><pre><code>public interface UserService {  boolean register(String cellphone, String password);  boolean login(String cellphone, String password);  UserInfo getUserInfoById(long id);  UserInfo getUserInfoByCellphone(String cellphone);}public interface RestrictedUserService {  boolean deleteUserByCellphone(String cellphone);  boolean deleteUserById(long id);}public class UserServiceImpl implements UserService, RestrictedUserService {  // ...çœç•¥å®ç°ä»£ç ...}</code></pre><h1 id="2-å°†æ¥å£ç†è§£ä¸ºå•ä¸ªAPIæ¥å£æˆ–è€…å‡½æ•°"><a href="#2-å°†æ¥å£ç†è§£ä¸ºå•ä¸ªAPIæ¥å£æˆ–è€…å‡½æ•°" class="headerlink" title="2. å°†æ¥å£ç†è§£ä¸ºå•ä¸ªAPIæ¥å£æˆ–è€…å‡½æ•°"></a>2. å°†æ¥å£ç†è§£ä¸ºå•ä¸ªAPIæ¥å£æˆ–è€…å‡½æ•°</h1><p>å‡½æ•°çš„è®¾è®¡éœ€è¦åŠŸèƒ½å•ä¸€ï¼Œä¸è¦å°†å¤šä¸ªä¸åŒçš„åŠŸèƒ½é€»è¾‘æ”¾åœ¨ä¸€ä¸ªå‡½æ•°å½“ä¸­å®ç°ã€‚</p><pre><code>public class Statistics {  private Long max;  private Long min;  private Long average;  private Long sum;  private Long percentile99;  private Long percentile999;  //...çœç•¥constructor/getter/setterç­‰æ–¹æ³•...}public Statistics count(Collection&lt;Long&gt; dataSet) {  Statistics statistics = new Statistics();  //...çœç•¥è®¡ç®—é€»è¾‘...  return statistics;}</code></pre><p>countæ–¹æ³•ç®—äº†å¤ªå¤šä¸åŒçš„æŒ‡æ ‡ï¼Œåº”è¯¥å°†å…¶åˆ†å‰²å¼€çš„ã€‚</p><pre><code>public Long max(Collection&lt;Long&gt; dataSet) { //... }public Long min(Collection&lt;Long&gt; dataSet) { //... } public Long average(Colletion&lt;Long&gt; dataSet) { //... }// ...çœç•¥å…¶ä»–ç»Ÿè®¡å‡½æ•°...</code></pre><h1 id="3-å°†æ¥å£ç†è§£ä¸ºOOPä¸­çš„æ¥å£çš„æ¦‚å¿µ"><a href="#3-å°†æ¥å£ç†è§£ä¸ºOOPä¸­çš„æ¥å£çš„æ¦‚å¿µ" class="headerlink" title="3. å°†æ¥å£ç†è§£ä¸ºOOPä¸­çš„æ¥å£çš„æ¦‚å¿µ"></a>3. å°†æ¥å£ç†è§£ä¸ºOOPä¸­çš„æ¥å£çš„æ¦‚å¿µ</h1><p>å³åœ¨è®¾è®¡æ¥å£çš„æ—¶å€™å°½é‡å‡å°‘å¤§è€Œå…¨çš„æ¥å£çš„è®¾è®¡ï¼Œæ¯ä¸ªæ¥å£éƒ½åªåšä¸€ä»¶äº‹æƒ…ï¼Œè¿™æ ·å­ç±»åœ¨implement interfaceçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡æ¥å£åä¹Ÿå¯ä»¥å¾ˆæ¸…æ™°çš„çŸ¥é“åœ¨åšä»€ä¹ˆï¼Œä¼šæœ‰ä»€ä¹ˆåŠŸèƒ½ï¼Œä¹Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šæå‡äº†ä»£ç çš„å¤ç”¨æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SOLID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SOLID - é‡Œæ°æ›¿æ¢åŸåˆ™</title>
      <link href="/SOLID-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99/"/>
      <url>/SOLID-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>é‡Œæ°æ›¿ä»£åŸåˆ™ - Liskov Substitution Principle </p><p>è®²è¿°çš„æ˜¯å­ç±»å¯¹è±¡éœ€è¦èƒ½å¤Ÿæ›¿æ¢ç¨‹åºå½“ä¸­çˆ¶ç±»å¯¹è±¡å‡ºç°çš„ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸”ä¿è¯åŸæ¥ç¨‹åºçš„é€»è¾‘æ€§ä¸ºä¸å˜ä»¥åŠæ­£ç¡®æ€§ä¸è¢«ç ´åã€‚</p><pre><code>public class Transporter {  private HttpClient httpClient;  public Transporter(HttpClient httpClient) {    this.httpClient = httpClient;  }  public Response sendRequest(Request request) {    // ...use httpClient to send request  }}public class SecurityTransporter extends Transporter {  private String appId;  private String appToken;  public SecurityTransporter(HttpClient httpClient, String appId, String appToken) {    super(httpClient);    this.appId = appId;    this.appToken = appToken;  }  @Override  public Response sendRequest(Request request) {    if (StringUtils.isNotBlank(appId) &amp;&amp; StringUtils.isNotBlank(appToken)) {      request.addPayload(&quot;app-id&quot;, appId);      request.addPayload(&quot;app-token&quot;, appToken);    }    return super.sendRequest(request);  }}public class Demo {      public void demoFunction(Transporter transporter) {        Reuqest request = new Request();    //...çœç•¥è®¾ç½®requestä¸­æ•°æ®å€¼çš„ä»£ç ...    Response response = transporter.sendRequest(request);    //...çœç•¥å…¶ä»–é€»è¾‘...  }}// é‡Œå¼æ›¿æ¢åŸåˆ™Demo demo = new Demo();demo.demofunction(new SecurityTransporter(/*çœç•¥å‚æ•°*/););</code></pre><h1 id="2-é‡Œæ°æ›¿ä»£åŸåˆ™-â€“-æŒ‰ç…§åè®®è¿›è¡Œè®¾è®¡"><a href="#2-é‡Œæ°æ›¿ä»£åŸåˆ™-â€“-æŒ‰ç…§åè®®è¿›è¡Œè®¾è®¡" class="headerlink" title="2. é‡Œæ°æ›¿ä»£åŸåˆ™ â€“ æŒ‰ç…§åè®®è¿›è¡Œè®¾è®¡"></a>2. é‡Œæ°æ›¿ä»£åŸåˆ™ â€“ æŒ‰ç…§åè®®è¿›è¡Œè®¾è®¡</h1><p>å­ç±»åœ¨è®¾è®¡çš„æ—¶å€™ï¼Œåº”å½“éµå®ˆçˆ¶ç±»çš„è¡Œä¸ºçº¦å®šã€‚çˆ¶ç±»å®šä¹‰äº†å‡½æ•°çš„è¡Œä¸ºçº¦å®šï¼Œé‚£ä¹ˆå­ç±»å¯ä»¥æ”¹å˜å‡½æ•°çš„å†…éƒ¨å®ç°é€»è¾‘ï¼Œä½†ä¸èƒ½æ”¹å˜å‡½æ•°åŸæœ‰çš„è¡Œä¸ºçº¦å®šã€‚  </p><p>è¿™é‡Œçš„è¡Œä¸ºçº¦å®šæŒ‡çš„æ˜¯å‡½æ•°å£°æ˜çš„è¦å®ç°çš„åŠŸèƒ½ï¼›å¯¹äºè¾“å…¥è¾“å‡ºä»¥åŠå¼‚å¸¸çš„çº¦å®š</p><p>å®šä¹‰å½“ä¸­çˆ¶ç±»å’Œå­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿæ˜¯å¯ä»¥æ›¿æ¢æˆæ¥å£å’Œå®ç°ç±»ä¹‹é—´çš„å…³ç³»çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SOLID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SOLID - å¼€é—­åŸåˆ™</title>
      <link href="/SOLID-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99/"/>
      <url>/SOLID-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>å¼€é—­åŸåˆ™è¯´çš„æ˜¯å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚æˆ‘ä»¬å¸Œæœ›åšåˆ°çš„æ˜¯ä½¿å¾—ä»£ç æœ‰ç€æ¯”è¾ƒå¥½çš„æ‰©å±•æ€§ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿä¸ä¼šå½±å“åˆ°ä»–çš„å¯è¯»æ€§ã€‚</p><h1 id="1-å¦‚ä½•ç†è§£-å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Ÿ"><a href="#1-å¦‚ä½•ç†è§£-å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Ÿ" class="headerlink" title="1. å¦‚ä½•ç†è§£ å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Ÿ"></a>1. å¦‚ä½•ç†è§£ å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Ÿ</h1><p>Open closed principle, Software entities (modules, classes, functions, etc) should be open for extension, but closed for modification. </p><p>æ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½åº”è¯¥æ˜¯åœ¨å·²æœ‰ä»£ç åŸºç¡€ä¸Šæ‰©å±•ä»£ç ï¼Œè€Œéä¿®æ”¹å·²æœ‰çš„ä»£ç ã€‚</p><h1 id="2-å®ä¾‹è§£é‡Š"><a href="#2-å®ä¾‹è§£é‡Š" class="headerlink" title="2. å®ä¾‹è§£é‡Š"></a>2. å®ä¾‹è§£é‡Š</h1><p>ä»£ç å®ç°çš„åŠŸèƒ½å°±æ˜¯å½“TPSè¶…è¿‡æŸä¸ªé¢„è®¾çš„æœ€å¤§å€¼çš„æ—¶å€™ï¼Œæˆ–è€…æ˜¯é”™è¯¯çš„æ•°é‡è¶…è¿‡å…è®¸çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘è­¦æŠ¥<br>    public class Alert {<br>      private AlertRule rule;<br>      private Notification notification;</p><pre><code>  public Alert(AlertRule rule, Notification notification) {    this.rule = rule;    this.notification = notification;  }  public void check(String api, long requestCount, long errorCount, long durationOfSeconds) {    long tps = requestCount / durationOfSeconds;    if (tps &gt; rule.getMatchedRule(api).getMaxTps()) {      notification.notify(NotificationEmergencyLevel.URGENCY, &quot;...&quot;);    }    if (errorCount &gt; rule.getMatchedRule(api).getMaxErrorCount()) {      notification.notify(NotificationEmergencyLevel.SEVERE, &quot;...&quot;);    }  }}</code></pre><p>ç°åœ¨æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œå½“æ¯ç§’é’Ÿè¯·æ±‚æ•°é‡è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿè¦è§¦å‘è­¦å‘Šï¼Œå‘é€é€šçŸ¥ã€‚</p><p>å¦‚æœç›´æ¥åœ¨ä¸Šè¿°ä»£ç ä¸­è¿›è¡Œä¿®æ”¹çš„è¯ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯éœ€è¦åœ¨checkå‡½æ•°å½“ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„è¾“å…¥å‚æ•°ï¼ŒtimeoutCountï¼Œè¡¨ç¤ºè¶…æ—¶çš„è¯·æ±‚æ•°é‡ï¼Œç„¶åå†checkå‡½æ•°é‡Œé¢åŠ ä¸Šå¯¹åº”çš„é€»è¾‘</p><pre><code>public class Alert {  // ...çœç•¥AlertRule/Notificationå±æ€§å’Œæ„é€ å‡½æ•°...  // æ”¹åŠ¨ä¸€ï¼šæ·»åŠ å‚æ•°timeoutCount  public void check(String api, long requestCount, long errorCount, long timeoutCount, long durationOfSeconds) {    long tps = requestCount / durationOfSeconds;    if (tps &gt; rule.getMatchedRule(api).getMaxTps()) {      notification.notify(NotificationEmergencyLevel.URGENCY, &quot;...&quot;);    }    if (errorCount &gt; rule.getMatchedRule(api).getMaxErrorCount()) {      notification.notify(NotificationEmergencyLevel.SEVERE, &quot;...&quot;);    }    // æ”¹åŠ¨äºŒï¼šæ·»åŠ æ¥å£è¶…æ—¶å¤„ç†é€»è¾‘    long timeoutTps = timeoutCount / durationOfSeconds;    if (timeoutTps &gt; rule.getMatchedRule(api).getMaxTimeoutTps()) {      notification.notify(NotificationEmergencyLevel.URGENCY, &quot;...&quot;);    }  }}</code></pre><p>è¿™æ ·çš„æ”¹åŠ¨æ˜¯æœ‰ä¸å°‘é—®é¢˜çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯¹äºä¼ å…¥å‚æ•°åšäº†æ”¹åŠ¨ï¼Œé‚£æ‰€æœ‰è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„åœ°æ–¹éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œè¿™å°±æ˜¯ä¸ªä¸å°çš„é—®é¢˜äº†ï¼›è€Œä¸”åœ¨ä¿®æ”¹äº†checkå‡½æ•°ä»¥åï¼Œæ‰€æœ‰çš„å•å…ƒæµ‹è¯•éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œä¼šå¾ˆéº»çƒ¦çš„ã€‚</p><p>ä¸ºäº†æé«˜è¿™æ•´ä¸ªç±»çš„æ‹“å±•æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åšä»¥ä¸‹çš„é‡æ„æ“ä½œï¼š</p><ul><li>å°†checkå‡½æ•°çš„å¤šä¸ªå…¥å‚å°è£…æˆApiStatInfoç±»</li><li>å¼•å…¥handlerçš„æ¦‚å¿µï¼Œå°†ifåˆ¤æ–­é€»è¾‘åˆ†æ•£åˆ°å„ä¸ªhandlerå½“ä¸­</li></ul><pre><code>public class Alert {  private List&lt;AlertHandler&gt; alertHandlers = new ArrayList&lt;&gt;();  public void addAlertHandler(AlertHandler alertHandler) {    this.alertHandlers.add(alertHandler);  }  public void check(ApiStatInfo apiStatInfo) {    for (AlertHandler handler : alertHandlers) {      handler.check(apiStatInfo);    }  }}public class ApiStatInfo {//çœç•¥constructor/getter/setteræ–¹æ³•  private String api;  private long requestCount;  private long errorCount;  private long durationOfSeconds;}public abstract class AlertHandler {  protected AlertRule rule;  protected Notification notification;  public AlertHandler(AlertRule rule, Notification notification) {    this.rule = rule;    this.notification = notification;  }  public abstract void check(ApiStatInfo apiStatInfo);}public class TpsAlertHandler extends AlertHandler {  public TpsAlertHandler(AlertRule rule, Notification notification) {    super(rule, notification);  }  @Override  public void check(ApiStatInfo apiStatInfo) {    long tps = apiStatInfo.getRequestCount()/ apiStatInfo.getDurationOfSeconds();    if (tps &gt; rule.getMatchedRule(apiStatInfo.getApi()).getMaxTps()) {      notification.notify(NotificationEmergencyLevel.URGENCY, &quot;...&quot;);    }  }}public class ErrorAlertHandler extends AlertHandler {  public ErrorAlertHandler(AlertRule rule, Notification notification){    super(rule, notification);  }  @Override  public void check(ApiStatInfo apiStatInfo) {    if (apiStatInfo.getErrorCount() &gt; rule.getMatchedRule(apiStatInfo.getApi()).getMaxErrorCount()) {      notification.notify(NotificationEmergencyLevel.SEVERE, &quot;...&quot;);    }  }}</code></pre><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚ä¸‹ï¼š</p><pre><code>public class ApplicationContext {  private AlertRule alertRule;  private Notification notification;  private Alert alert;  public void initializeBeans() {    alertRule = new AlertRule(/*.çœç•¥å‚æ•°.*/); //çœç•¥ä¸€äº›åˆå§‹åŒ–ä»£ç     notification = new Notification(/*.çœç•¥å‚æ•°.*/); //çœç•¥ä¸€äº›åˆå§‹åŒ–ä»£ç     alert = new Alert();    alert.addAlertHandler(new TpsAlertHandler(alertRule, notification));    alert.addAlertHandler(new ErrorAlertHandler(alertRule, notification));  }  public Alert getAlert() { return alert; }  // é¥¿æ±‰å¼å•ä¾‹  private static final ApplicationContext instance = new ApplicationContext();  private ApplicationContext() {    instance.initializeBeans();  }  public static ApplicationContext getInstance() {    return instance;  }}public class Demo {  public static void main(String[] args) {    ApiStatInfo apiStatInfo = new ApiStatInfo();    // ...çœç•¥è®¾ç½®apiStatInfoæ•°æ®å€¼çš„ä»£ç     ApplicationContext.getInstance().getAlert().check(apiStatInfo);  }}</code></pre><p>éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼š</p><pre><code>public class Alert { // ä»£ç æœªæ”¹åŠ¨... }public class ApiStatInfo {//çœç•¥constructor/getter/setteræ–¹æ³•  private String api;  private long requestCount;  private long errorCount;  private long durationOfSeconds;  private long timeoutCount; // æ”¹åŠ¨ä¸€ï¼šæ·»åŠ æ–°å­—æ®µ}public abstract class AlertHandler { //ä»£ç æœªæ”¹åŠ¨... }public class TpsAlertHandler extends AlertHandler {//ä»£ç æœªæ”¹åŠ¨...}public class ErrorAlertHandler extends AlertHandler {//ä»£ç æœªæ”¹åŠ¨...}// æ”¹åŠ¨äºŒï¼šæ·»åŠ æ–°çš„handlerpublic class TimeoutAlertHandler extends AlertHandler {//çœç•¥ä»£ç ...}public class ApplicationContext {  private AlertRule alertRule;  private Notification notification;  private Alert alert;  public void initializeBeans() {    alertRule = new AlertRule(/*.çœç•¥å‚æ•°.*/); //çœç•¥ä¸€äº›åˆå§‹åŒ–ä»£ç     notification = new Notification(/*.çœç•¥å‚æ•°.*/); //çœç•¥ä¸€äº›åˆå§‹åŒ–ä»£ç     alert = new Alert();    alert.addAlertHandler(new TpsAlertHandler(alertRule, notification));    alert.addAlertHandler(new ErrorAlertHandler(alertRule, notification));    // æ”¹åŠ¨ä¸‰ï¼šæ³¨å†Œhandler    alert.addAlertHandler(new TimeoutAlertHandler(alertRule, notification));  }  //...çœç•¥å…¶ä»–æœªæ”¹åŠ¨ä»£ç ...}public class Demo {  public static void main(String[] args) {    ApiStatInfo apiStatInfo = new ApiStatInfo();    // ...çœç•¥apiStatInfoçš„setå­—æ®µä»£ç     apiStatInfo.setTimeoutCount(289); // æ”¹åŠ¨å››ï¼šè®¾ç½®tiemoutCountå€¼    ApplicationContext.getInstance().getAlert().check(apiStatInfo);}</code></pre><h1 id="3-ä¸€äº›æ€è€ƒ"><a href="#3-ä¸€äº›æ€è€ƒ" class="headerlink" title="3. ä¸€äº›æ€è€ƒ"></a>3. ä¸€äº›æ€è€ƒ</h1><ul><li><p>å†™ä»£ç çš„æ—¶å€™å°±éœ€è¦æƒ³æƒ³æœ‰å¯èƒ½ä¼šæœ‰å“ªäº›éœ€æ±‚ä¸Šçš„å˜æ›´ï¼Œå¦‚ä½•è®¾è®¡ä»£ç çš„ç»“æ„ï¼Œç•™å¥½æ‰©å±•ç‚¹ã€‚</p></li><li><p>åœ¨è¯†åˆ«å‡ºå¯å˜éƒ¨åˆ†ä¹‹åï¼Œè¦å°†å¯å˜éƒ¨åˆ†å°è£…èµ·æ¥ï¼Œéš”ç¦»å˜åŒ–ï¼Œæä¾›æŠ½è±¡åŒ–çš„ä¸å¯å˜æ¥å£ï¼Œç»™ä¸Šå±‚ç³»ç»Ÿæ¥ä½¿ç”¨ã€‚å½“å…·ä½“çš„å®ç°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åŸºäºç›¸åŒçš„æŠ½è±¡æ¥å£ï¼Œæ‰©å±•ä¸€ä¸ªæ–°çš„å®ç°ï¼Œè¿™æ ·å­ä¸Šæ¸¸çš„ä»£ç å°±å‡ ä¹ä¸éœ€è¦ä¿®æ”¹äº†</p></li><li><p>åŸºäºæ¥å£è€Œéå®ç°çš„ç¼–ç¨‹ï¼Œ å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</p><p>  // è¿™ä¸€éƒ¨åˆ†ä½“ç°äº†æŠ½è±¡æ„è¯†<br>  public interface MessageQueue { //â€¦ }<br>  public class KafkaMessageQueue implements MessageQueue { //â€¦ }<br>  public class RocketMQMessageQueue implements MessageQueue {//â€¦}</p><p>  public interface MessageFormatter { //â€¦ }<br>  public class JsonMessageFormatter implements MessageFormatter {//â€¦}<br>  public class MessageFormatter implements MessageFormatter {//â€¦}</p><p>  public class Demo {</p><pre><code>private MessageQueue msgQueue; // åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹public Demo(MessageQueue msgQueue) { // ä¾èµ–æ³¨å…¥  this.msgQueue = msgQueue;}// msgFormatterï¼šå¤šæ€ã€ä¾èµ–æ³¨å…¥public void sendNotification(Notification notification, MessageFormatter msgFormatter) {  //...    }</code></pre><p>  }</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SOLID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SOLID - å•ä¸€èŒè´£åŸåˆ™</title>
      <link href="/SOLID-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/"/>
      <url>/SOLID-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><ul><li>Single Responsibility Principle - å•ä¸€èŒè´£åŸåˆ™<ul><li>æˆ‘ä»¬å¸Œæœ›å¯¹äºä¸€ä¸ªç±»æˆ–è€…æ¨¡å—æ¥è¯´ï¼Œä»–ä»¬éƒ½æ˜¯åªæœ‰ä¸€ä¸ªèŒè´£çš„ï¼Œå³åªå®Œæˆä¸€ä¸ªåŠŸèƒ½</li><li>è¿™ä¸ªèŒè´£è¯´çš„å…¶å®å°±æ˜¯ï¼Œä¸è¦è®¾è®¡å¤§è€Œå…¨çš„ç±»ï¼Œåº”å½“è®¾è®¡ç²’åº¦å°ï¼ŒåŠŸèƒ½å•ä¸€çš„ç±»ã€‚</li><li>åœ¨åŒä¸€ä¸ªç±»å½“ä¸­çš„æ–¹æ³•åŠŸèƒ½ï¼Œåº”è¯¥æ˜¯åœ¨åŒä¸€ä¸ªä¸šåŠ¡æ–¹å‘å½“ä¸­çš„</li></ul></li></ul><h1 id="2-å¦‚ä½•åˆ¤æ–­ç±»çš„èŒè´£æ˜¯å¦å•ä¸€"><a href="#2-å¦‚ä½•åˆ¤æ–­ç±»çš„èŒè´£æ˜¯å¦å•ä¸€" class="headerlink" title="2. å¦‚ä½•åˆ¤æ–­ç±»çš„èŒè´£æ˜¯å¦å•ä¸€"></a>2. å¦‚ä½•åˆ¤æ–­ç±»çš„èŒè´£æ˜¯å¦å•ä¸€</h1><ul><li><p>E.G</p><ul><li>å¦‚æœä¸€ä¸ªç±»ï¼Œæ—¢è¦å¤„ç†å’Œå…¶ä»–å¾®æœåŠ¡çš„äº¤äº’ï¼Œåˆè¦åˆ°æ•°æ®åº“queryï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸¤ä¸ªèŒè´£ï¼Œæˆ‘ä»¬å°±åº”è¯¥å°†è¿™ä¸ªç±»åˆ†å‰²å¼€ï¼Œåˆ’åˆ†åˆ°ä¸¤ä¸ªä¸åŒçš„ç±»å½“ä¸­å» </li></ul></li><li><p>E.G2</p></li></ul><pre><code>public class UserInfo {  private long userId;  private String username;  private String email;  private String telephone;  private long createTime;  private long lastLoginTime;  private String avatarUrl;  private String provinceOfAddress; // çœ  private String cityOfAddress; // å¸‚  private String regionOfAddress; // åŒº   private String detailedAddress; // è¯¦ç»†åœ°å€  // ...çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...}</code></pre><p>å¯¹äºä¸Šè¿°UserInfoç±»æ¥è¯´ï¼Œé‡Œé¢å…¨æ˜¯Userçš„ä¸€äº›å±æ€§ï¼Œä½†æ˜¯å…¶ä¸­æœ‰å°†è¿‘åŠæ•°æ˜¯å…³äºåœ°å€çš„ï¼Œæˆ‘ä»¬æœ‰ç†ç”±å°†å…¶ç»†åˆ†ä¸ºUserAddressç±»ä»¥åŠUserInfoç±»ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨åœºæ™¯å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æˆ‘ä»¬åˆ°åº•æ˜¯å‡†å¤‡å¦‚ä½•ä½¿ç”¨è¿™äº›æ•°æ®çš„ã€‚</p><p>å¦‚æœåº”ç”¨åœºæ™¯å°±æ˜¯æ‹¿å‡ºç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯ï¼Œé‚£æ”¾åœ¨ä¸€èµ·æ— ä¼¤å¤§é›…ï¼Œä½†æ˜¯å¦‚æœæ˜¯è¦åšç‰©æµï¼Œç”µå•†çš„åœºæ™¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å•ç‹¬æƒ³æ‹¿å‡ºåœ°å€ç›¸å…³ä¿¡æ¯çš„åœºæ™¯å°±ä¼šæ¯”è¾ƒå¤šäº†ï¼Œè¿™ç§æƒ…å†µæœ€å¥½å°±åˆ†æˆä¸¤ä¸ªä¸åŒçš„ç±»äº†ã€‚</p><p>å®é™…å¼€å‘å½“ä¸­ï¼Œå®é™…ä¸Šä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯å…ˆå†™ä¸€ä¸ªç²—ç²’åº¦çš„ç±»ï¼Œä»¥æ»¡è¶³ä¸šåŠ¡çš„éœ€æ±‚ï¼Œéšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå¦‚æœç²—ç²’åº¦çš„ç±»è¶Šæ¥è¶Šåºå¤§ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªç²—ç²’åº¦çš„ç±»æ‹†åˆ†æˆå‡ ä¸ªæ›´ç»†ç²’åº¦çš„ç±»ï¼Œå³â€“æŒç»­é‡æ„ã€‚</p><h1 id="3-åˆ¤æ–­æ˜¯å¦æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™çš„åˆ¤æ–­å‡†åˆ™"><a href="#3-åˆ¤æ–­æ˜¯å¦æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™çš„åˆ¤æ–­å‡†åˆ™" class="headerlink" title="3. åˆ¤æ–­æ˜¯å¦æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™çš„åˆ¤æ–­å‡†åˆ™"></a>3. åˆ¤æ–­æ˜¯å¦æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™çš„åˆ¤æ–­å‡†åˆ™</h1><ul><li>ç±»ä¸­ä»£ç çš„è¡Œæ•°ï¼Œå‡½æ•°æˆ–è€…å±æ€§è¿‡å¤šï¼Œä¼šå½±å“ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œéœ€è¦è€ƒè™‘å¯¹ç±»è¿›è¡Œæ‹†åˆ†äº†</li><li>ç±»ä¾èµ–çš„å…¶ä»–ç±»è¿‡å¤šï¼Œæˆ–è€…ä¾èµ–ç±»çš„å…¶ä»–ç±»è¿‡å¤šï¼Œä¸ç¬¦åˆé«˜å†…èšï¼Œä½è€¦åˆçš„è®¾è®¡æ€æƒ³ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è€ƒè™‘è¿›è¡Œæ‹†åˆ†</li><li>ç§æœ‰æ–¹æ³•è¿‡å¤šï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ˜¯å¦åº”è¯¥å°†ç§æœ‰æ–¹æ³•ç‹¬ç«‹åˆ°æ–°çš„ç±»å½“ä¸­ï¼Œè®¾ç½®ä¸ºpublicæ–¹æ³•ï¼Œä¾›æ›´å¤šçš„ç±»ä½¿ç”¨ï¼Œä»è€Œæé«˜ä»£ç çš„å¤ç”¨æ€§</li><li>å¦‚æœå¯¹äºä¸€ä¸ªç±»ï¼Œæ¯”è¾ƒéš¾å–åå­—ï¼Œåªèƒ½ç”¨ç›¸å¯¹æ³›æ³›çš„åå­—ï¼Œé‚£å¾ˆå¯èƒ½æ„å‘³ç€è¿™ä¸ªç±»çš„èŒè´£æœ‰ç‚¹è¿‡å¤šäº†</li><li>ç±»ä¸­çš„å¤§é‡æ–¹æ³•éƒ½æ˜¯é›†ä¸­æ“ä½œç±»ä¸­çš„æŸå‡ ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘å°†è¿™å‡ ä¸ªå±æ€§å’Œå¯¹åº”çš„æ–¹æ³•æ‹†åˆ†å‡ºæ¥</li></ul><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š æˆ‘ä»¬ä½¿ç”¨è¿™äº›å‡†åˆ™ï¼Œäº¦æˆ–è€…æ˜¯è®¾è®¡æ¨¡å¼ï¼Œæœ€ç»ˆçš„ç›®çš„è¿˜æ˜¯æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œå¯æ‰©å±•æ€§ï¼Œå¤ç”¨æ€§ï¼Œå¯ç»´æŠ¤æ€§ç­‰ã€‚è¿™æ‰åº”å½“æ˜¯æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦è¦é‡‡ç”¨SOLIDå‡†åˆ™ï¼Œä»¥åŠå…¶ä»–çš„åŸåˆ™çš„æœ€ç»ˆæ ‡å‡†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SOLID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å‹</title>
      <link href="/%E5%9F%BA%E4%BA%8E%E5%85%85%E8%A1%80%E6%A8%A1%E5%9E%8B%E7%9A%84DDD%E5%BC%80%E5%8F%91%E6%A8%A1%E5%9E%8B/"/>
      <url>/%E5%9F%BA%E4%BA%8E%E5%85%85%E8%A1%80%E6%A8%A1%E5%9E%8B%E7%9A%84DDD%E5%BC%80%E5%8F%91%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¼ ç»ŸåŸºäºMVCçš„å¼€å‘æ¨¡å¼"><a href="#1-ä¼ ç»ŸåŸºäºMVCçš„å¼€å‘æ¨¡å¼" class="headerlink" title="1. ä¼ ç»ŸåŸºäºMVCçš„å¼€å‘æ¨¡å¼"></a>1. ä¼ ç»ŸåŸºäºMVCçš„å¼€å‘æ¨¡å¼</h1><p>MVCä¸‰å±‚ç»“æ„ä¸­çš„Mè¡¨ç¤ºModelï¼ŒVè¡¨ç¤ºViewï¼ŒCè¡¨ç¤ºControllerã€‚é€šè¿‡è¿™ä¸‰å±‚å°†æ•´ä¸ªé¡¹ç›®åˆ†ä¸ºäº†ä¸‰å¤§éƒ¨åˆ†ï¼Œå±•ç¤ºå±‚ï¼Œé€»è¾‘å±‚ï¼Œæ•°æ®å±‚</p><p>è€Œè´«è¡€æ¨¡å‹ - Anemic Domain Modelï¼ŒæŒ‡çš„æ˜¯æˆ‘ä»¬å°†æ•°æ®å’Œæ“ä½œåˆ†ç¦»ï¼Œæœ‰ä¸“é—¨çš„POJOç±»ï¼Œå³åªåŒ…å«æ•°æ®çš„ç±»ï¼Œè¿™å®è´¨ä¸Šä¼šç ´åé¢å‘å¯¹è±¡çš„å°è£…ç‰¹æ€§ï¼Œæ˜¯ä¸€ç§é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹é£æ ¼ã€‚</p><h1 id="2-åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼"><a href="#2-åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼" class="headerlink" title="2. åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼"></a>2. åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼</h1><p>å……è¡€æ¨¡å‹ - rich domain modelï¼Œæ—¨åœ¨å°†æ•°æ®å’Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨åŒä¸€ä¸ªç±»å½“ä¸­ã€‚</p><h1 id="3-å®æˆ˜-DDD-å¼€å‘è™šæ‹Ÿé’±åŒ…ç³»ç»Ÿ"><a href="#3-å®æˆ˜-DDD-å¼€å‘è™šæ‹Ÿé’±åŒ…ç³»ç»Ÿ" class="headerlink" title="3. å®æˆ˜  DDD å¼€å‘è™šæ‹Ÿé’±åŒ…ç³»ç»Ÿ"></a>3. å®æˆ˜  DDD å¼€å‘è™šæ‹Ÿé’±åŒ…ç³»ç»Ÿ</h1><h2 id="3-1-é’±åŒ…ä¸šåŠ¡èƒŒæ™¯ä»‹ç»"><a href="#3-1-é’±åŒ…ä¸šåŠ¡èƒŒæ™¯ä»‹ç»" class="headerlink" title="3.1 é’±åŒ…ä¸šåŠ¡èƒŒæ™¯ä»‹ç»"></a>3.1 é’±åŒ…ä¸šåŠ¡èƒŒæ™¯ä»‹ç»</h2><p>éœ€è¦åˆ›å»ºä¸€ä¸ªç³»ç»Ÿå†…çš„è™šæ‹Ÿé’±åŒ…è´¦æˆ·ï¼Œæ¥æ”¯æŒç”¨æˆ·çš„å……å€¼ï¼Œæç°ï¼Œæ”¯ä»˜ï¼Œå†»ç»“ï¼Œé€æ”¯ï¼Œè½¬èµ ï¼ŒæŸ¥è¯¢è´¦æˆ·ä½™é¢ï¼ŒæŸ¥è¯¢äº¤æ˜“æµæ°´ç­‰æ“ä½œã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡å®šè¦å»å®ç°ä¸€ä¸ªå…·å¤‡å……å€¼ï¼Œæç°, æ”¯ä»˜ï¼ŒæŸ¥è¯¢ä½™é¢ï¼Œè¿˜æœ‰æŸ¥è¯¢äº¤æ˜“æµæ°´äº”ä¸ªåŠŸèƒ½çš„é’±åŒ…ã€‚</p><p>å…¶ä¸šåŠ¡æµç¨‹åˆ†åˆ«ä¸ºï¼š</p><ul><li>å……å€¼ <ul><li>ç”¨æˆ·é€šè¿‡ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¸ é“ï¼Œå°†è‡ªå·±é“¶è¡Œå¡é‡Œé¢çš„é’±å……å€¼åˆ°è™šæ‹Ÿé’±åŒ…è´¦å·å½“ä¸­</li><li>æ“ä½œæµç¨‹<ul><li>ä»ç”¨æˆ·é“¶è¡Œå¡åˆ°åº”ç”¨çš„å…¬å…±é“¶è¡Œå¡</li><li>ç”¨æˆ·è™šæ‹Ÿé’±åŒ…å¢åŠ é‡‘é¢</li><li>è®°å½•åˆšåˆšè¿™ç¬”äº¤æ˜“æµæ°´</li></ul></li></ul></li><li>æ”¯ä»˜<ul><li>å®é™…ä¸Šæ˜¯ä¸€ä¸ªè½¬è´¦çš„è¿‡ç¨‹ï¼Œä»ç”¨æˆ·çš„è™šæ‹Ÿé’±åŒ…è´¦æˆ·åˆ’é’±åˆ°å•†å®¶çš„è™šæ‹Ÿé’±åŒ…è´¦æˆ·å½“ä¸­</li><li>è®°å½•æµæ°´ä¿¡æ¯</li></ul></li><li>æç°<ul><li>ç”¨æˆ·è™šæ‹Ÿé’±åŒ…  å‡å»å¯¹åº”çš„é’±æ•°</li><li>åº”ç”¨çš„å…¬å…±é“¶è¡Œå¡ æ‰“é’± åˆ°ç”¨æˆ·çš„é“¶è¡Œå¡</li><li>è®°å½•äº¤æ˜“</li></ul></li><li>æŸ¥è¯¢ä½™é¢<ul><li>çœ‹è™šæ‹Ÿé’±åŒ…çš„ä½™é¢æ•°å­—</li></ul></li><li>æŸ¥è¯¢äº¤æ˜“æµæ°´<ul><li>æŸ¥è¯¢å……å€¼ï¼Œæ”¯ä»˜ï¼Œæç°ä¸‰ç§æ“ä½œ</li></ul></li></ul><h2 id="3-2-è®¾è®¡æ€è·¯"><a href="#3-2-è®¾è®¡æ€è·¯" class="headerlink" title="3.2 è®¾è®¡æ€è·¯"></a>3.2 è®¾è®¡æ€è·¯</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¯¹ç³»ç»Ÿè¿›è¡Œè§£è€¦ï¼Œå³ç”¨ç›¸ä¼¼ç‰¹å¾å’Œç‰¹æ€§çš„åŠŸèƒ½æ”¾åˆ°åŒä¸€ä¸ªå­ç³»ç»Ÿå½“ä¸­ã€‚æ ¹æ®ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºè™šæ‹Ÿé’±åŒ…ç³»ç»Ÿå’Œä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿä¸¤ä¸ªéƒ¨åˆ†ã€‚</p><ul><li>è™šæ‹Ÿé’±åŒ…<ul><li>ç”¨æˆ·è™šæ‹Ÿé’±åŒ…</li><li>å•†å®¶è™šæ‹Ÿé’±åŒ…</li></ul></li><li>ä¸‰æ–¹æ”¯ä»˜<ul><li>ç”¨æˆ·é“¶è¡Œå¡</li><li>å•†å®¶é“¶è¡Œå¡</li><li>åº”ç”¨å…¬å…±é“¶è¡Œå¡</li></ul></li></ul><p>è™šæ‹Ÿé’±åŒ…éœ€è¦æ”¯æŒçš„æ“ä½œåŸºæœ¬ä¸Šå°±æ˜¯å¯¹äºä½™é¢çš„åŠ å‡ï¼Œå……å€¼ï¼Œæç°ï¼ŒæŸ¥è¯¢ä¸‰ç§æ“ä½œéƒ½æ˜¯åªæ¶‰åŠåˆ°ä¸€ä¸ªè´¦æˆ·çš„ä½™é¢çš„åŠ å‡æ“ä½œï¼›è€Œæ”¯ä»˜åŠŸèƒ½æ¶‰åŠåˆ°ä¸¤ä¸ªè´¦æˆ·çš„ä½™é¢çš„åŠ å‡æ“ä½œã€‚</p><p>è€Œå¯¹äºäº¤æ˜“è®°å½•ï¼Œåº”å½“è®°å½•çš„ä¿¡æ¯æœ‰ï¼š</p><ul><li>äº¤æ˜“æµæ°´ID</li><li>äº¤æ˜“æ—¶é—´</li><li>äº¤æ˜“é‡‘é¢</li><li>äº¤æ˜“ç±»å‹<ul><li>å……å€¼</li><li>æç°</li><li>æ”¯ä»˜</li></ul></li><li>å…¥è´¦é’±åŒ…è´¦å·</li><li>å‡ºè´¦é’±åŒ…è´¦å·</li></ul><p>è¿™ä¹ˆè®¾è®¡æ˜¯æœ‰ç‚¹æµªè´¹å­˜å‚¨ç©ºé—´çš„ï¼Œå› ä¸ºå¯¹äºå……å€¼æç°è¿™ç§äº¤æ˜“ç±»å‹æ¥è¯´ï¼Œæˆ‘ä»¬åªè¦è®°å½•ä¸€ä¸ªé’±åŒ…è´¦æˆ·ä¿¡æ¯å°±å¥½äº†ã€‚</p><p>å¦å¤–ä¸€ç§æ–¹å¼å°±æ˜¯åœ¨äº¤æ˜“ç±»å‹å¤„ï¼Œè®¾è®¡æˆæ”¯ä»˜å’Œè¢«æ”¯ä»˜ä¸¤ç§ç±»å‹ï¼Œè¿™æ ·åœ¨å¯¹å¾…è½¬è´¦çš„æƒ…å†µçš„æ—¶å€™ï¼Œæ•°æ®åº“å†™ä¸¤æ¡æ•°æ®ï¼Œæ¥è®°å½•æ•´ä¸ªtransactionã€‚èƒ½å¤Ÿçœç©ºé—´ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼š</p><p>æœ€é‡è¦çš„éš¾ç‚¹è¿˜æ˜¯åœ¨æ•°æ®çš„ä¸€è‡´æ€§æ–¹é¢ï¼Œå½“æˆ‘ä»¬åœ¨åšè½¬è´¦æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯åŠ å‡ä¸¤ä¸ªæ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚å¦‚æœä¸€ä¸ªæˆåŠŸï¼Œä¸€ä¸ªå¤±è´¥ï¼Œé‚£ä¼šå®Œè›‹çš„ã€‚å…³äºé’±çš„äº‹æƒ…ï¼Œå‘ç”Ÿä¸€ç‚¹é”™è¯¯å°±ä¼šå¯¹å…¬å¸é€ æˆéå¸¸å¤§çš„å½±å“ã€‚</p><p>å¯¹äºè½¬è´¦åŠç±»ä¼¼çš„æ“ä½œï¼Œåˆç†çš„åšæ³•æ˜¯åœ¨æ“ä½œä¸¤ä¸ªé’±åŒ…çš„è´¦æˆ·ä½™é¢ä¹‹å‰ï¼Œå…ˆè®°å½•äº¤æ˜“æµæ°´ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºå¾…æ‰§è¡Œï¼Œå½“ä¸¤ä¸ªé’±åŒ…çš„åŠ å‡é‡‘é¢éƒ½å®Œæˆäº†ä¹‹åï¼Œæˆ‘ä»¬å†å›å¤´å°†äº¤æ˜“è®°å½•çš„çŠ¶æ€æ ‡è®°ä¸ºå¤±è´¥ã€‚ç„¶åæˆ‘ä»¬é€šè¿‡åå°çš„è¡¥æ¼jobï¼Œæ‹‰å–çŠ¶æ€ä¸ºå¤±è´¥æˆ–è€…é•¿æ—¶é—´å¤„äºå¾…æ‰§è¡ŒçŠ¶æ€çš„äº¤æ˜“è®°å½•ï¼Œé‡æ–°æ‰§è¡Œæˆ–è€…äººå·¥ä»‹å…¥å¤„ç†ã€‚</p><p>å¦å¤–ä¸€ä¸ªç‚¹åœ¨æˆ‘ä»¬ä¼šæ„å»ºä¸€ä¸ªé’±åŒ…ç³»ç»Ÿï¼Œç„¶ååˆ†å‡ºä¸¤ä¸ªå­ç³»ç»Ÿï¼Œè™šæ‹Ÿé’±åŒ…è¿˜æœ‰ç¬¬ä¸‰æ–¹äº¤æ˜“å¹³å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å•†ä¸šé€»è¾‘éƒ½åº”è¯¥æ”¾åˆ°é’±åŒ…ç³»ç»Ÿè¿™ä¸€ä¸ªå±‚çº§ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„è™šæ‹Ÿé’±åŒ…è¿˜æœ‰äº¤æ˜“å¹³å°å°½é‡å’Œæˆ‘ä»¬çš„å•†ä¸šé€»è¾‘è„±é’©ï¼Œæ›´å¤šçš„æ˜¯äº‹åŠ¡ä¸Šæ–¹æ³•ä¸Šçš„æ›´æ³›åŒ–çš„ä¸œè¥¿ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬çš„å•†ä¸šé€»è¾‘ä¼šç»å¸¸å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›è™šæ‹Ÿé’±åŒ…ï¼Œè¿˜æœ‰ç¬¬ä¸‰æ–¹äº¤æ˜“å¹³å°ä¸¤ä¸ªæ¨¡å—ä¸éœ€è¦ç»å¸¸æ€§çš„å˜åŠ¨ã€‚è¿™ä¹Ÿæ˜¯å»åšä¸¤ä¸ªå­ç³»ç»Ÿçš„åˆè¡·ä¹‹ä¸€ã€‚</p><h2 id="3-3-åŸºäºè´«è¡€æ¨¡å¼çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼"><a href="#3-3-åŸºäºè´«è¡€æ¨¡å¼çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼" class="headerlink" title="3.3 åŸºäºè´«è¡€æ¨¡å¼çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼"></a>3.3 åŸºäºè´«è¡€æ¨¡å¼çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼</h2><pre><code>public class VirtualWalletController {  // é€šè¿‡æ„é€ å‡½æ•°æˆ–è€…IOCæ¡†æ¶æ³¨å…¥  private VirtualWalletService virtualWalletService;  public BigDecimal getBalance(Long walletId) { ... } //æŸ¥è¯¢ä½™é¢  public void debit(Long walletId, BigDecimal amount) { ... } //å‡ºè´¦  public void credit(Long walletId, BigDecimal amount) { ... } //å…¥è´¦  public void transfer(Long fromWalletId, Long toWalletId, BigDecimal amount) { ...} //è½¬è´¦}public class VirtualWalletBo {//çœç•¥getter/setter/constructoræ–¹æ³•  private Long id;  private Long createTime;  private BigDecimal balance;}public class VirtualWalletService {  // é€šè¿‡æ„é€ å‡½æ•°æˆ–è€…IOCæ¡†æ¶æ³¨å…¥  private VirtualWalletRepository walletRepo;  private VirtualWalletTransactionRepository transactionRepo;  public VirtualWalletBo getVirtualWallet(Long walletId) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    VirtualWalletBo walletBo = convert(walletEntity);    return walletBo;  }  public BigDecimal getBalance(Long walletId) {    return walletRepo.getBalance(walletId);  }  public void debit(Long walletId, BigDecimal amount) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    BigDecimal balance = walletEntity.getBalance();    if (balance.compareTo(amount) &lt; 0) {      throw new NoSufficientBalanceException(...);    }    walletRepo.updateBalance(walletId, balance.subtract(amount));  }  public void credit(Long walletId, BigDecimal amount) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    BigDecimal balance = walletEntity.getBalance();    walletRepo.updateBalance(walletId, balance.add(amount));  }  public void transfer(Long fromWalletId, Long toWalletId, BigDecimal amount) {    VirtualWalletTransactionEntity transactionEntity = new VirtualWalletTransactionEntity();    transactionEntity.setAmount(amount);    transactionEntity.setCreateTime(System.currentTimeMillis());    transactionEntity.setFromWalletId(fromWalletId);    transactionEntity.setToWalletId(toWalletId);    transactionEntity.setStatus(Status.TO_BE_EXECUTED);    Long transactionId = transactionRepo.saveTransaction(transactionEntity);    try {      debit(fromWalletId, amount);      credit(toWalletId, amount);    } catch (InsufficientBalanceException e) {      transactionRepo.updateStatus(transactionId, Status.CLOSED);      ...rethrow exception e...    } catch (Exception e) {      transactionRepo.updateStatus(transactionId, Status.FAILED);      ...rethrow exception e...    }    transactionRepo.updateStatus(transactionId, Status.EXECUTED);  }}</code></pre><h2 id="3-4-åŸºäºå……è¡€æ¨¡å¼çš„DDDå¼€å‘æ¨¡å¼"><a href="#3-4-åŸºäºå……è¡€æ¨¡å¼çš„DDDå¼€å‘æ¨¡å¼" class="headerlink" title="3.4 åŸºäºå……è¡€æ¨¡å¼çš„DDDå¼€å‘æ¨¡å¼"></a>3.4 åŸºäºå……è¡€æ¨¡å¼çš„DDDå¼€å‘æ¨¡å¼</h2><pre><code>public class VirtualWallet { // Domainé¢†åŸŸæ¨¡å‹(å……è¡€æ¨¡å‹)  private Long id;  private Long createTime = System.currentTimeMillis();;  private BigDecimal balance = BigDecimal.ZERO;  public VirtualWallet(Long preAllocatedId) {    this.id = preAllocatedId;  }  public BigDecimal balance() {    return this.balance;  }  public void debit(BigDecimal amount) {    if (this.balance.compareTo(amount) &lt; 0) {      throw new InsufficientBalanceException(...);    }    this.balance.subtract(amount);  }  public void credit(BigDecimal amount) {    if (amount.compareTo(BigDecimal.ZERO) &lt; 0) {      throw new InvalidAmountException(...);    }    this.balance.add(amount);  }}public class VirtualWalletService {  // é€šè¿‡æ„é€ å‡½æ•°æˆ–è€…IOCæ¡†æ¶æ³¨å…¥  private VirtualWalletRepository walletRepo;  private VirtualWalletTransactionRepository transactionRepo;  public VirtualWallet getVirtualWallet(Long walletId) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    VirtualWallet wallet = convert(walletEntity);    return wallet;  }  public BigDecimal getBalance(Long walletId) {    return walletRepo.getBalance(walletId);  }  public void debit(Long walletId, BigDecimal amount) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    VirtualWallet wallet = convert(walletEntity);    wallet.debit(amount);    walletRepo.updateBalance(walletId, wallet.balance());  }  public void credit(Long walletId, BigDecimal amount) {    VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId);    VirtualWallet wallet = convert(walletEntity);    wallet.credit(amount);    walletRepo.updateBalance(walletId, wallet.balance());  }  public void transfer(Long fromWalletId, Long toWalletId, BigDecimal amount) {    //...è·ŸåŸºäºè´«è¡€æ¨¡å‹çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼çš„ä»£ç ä¸€æ ·...  }}</code></pre><p>ä¸€äº›æ€è€ƒï¼š </p><ul><li>é¢†åŸŸæ¨¡å‹ å¸Œæœ›å…¶å°½å¯èƒ½çš„ç‹¬ç«‹ï¼Œä¸åŒ…å«ä»»ä½•å…¶å®ƒå±‚çš„ä»£ç ï¼Œå°†æµç¨‹æ€§çš„ä»£ç é€»è¾‘å’Œé¢†åŸŸæ¨¡å‹çš„ä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Œè®©é¢†åŸŸæ¨¡å‹æ›´åŠ å¯ä»¥å¤ç”¨</li><li>Serviceç±»è´Ÿè´£ä¸€äº›éåŠŸèƒ½æ€§çš„å’Œä¸ç¬¬ä¸‰æ–¹äº¤äº’çš„å·¥ä½œ <ul><li>ä¿¡æ¯ä¼ é€</li><li>metrics</li><li>æ—¥å¿—</li></ul></li></ul><h1 id="4-å®æˆ˜-æ¥å£é‰´æƒ"><a href="#4-å®æˆ˜-æ¥å£é‰´æƒ" class="headerlink" title="4. å®æˆ˜ - æ¥å£é‰´æƒ"></a>4. å®æˆ˜ - æ¥å£é‰´æƒ</h1><p>ç›®çš„æ˜¯ç†Ÿæ‚‰åœ¨æ‹¿åˆ°ç›¸å¯¹ç¬¼ç»Ÿçš„å¼€å‘éœ€æ±‚çš„æ—¶å€™ï¼Œéœ€è¦å¦‚ä½•åšéœ€æ±‚åˆ†æï¼Œå¦‚ä½•åšèŒè´£åˆ’åˆ†ï¼Œçœ‹éœ€è¦å®šä¹‰å“ªäº›ç±»ï¼Œæ¯ä¸ªç±»åº”è¯¥å…·æœ‰å“ªäº›å±æ€§ï¼Œæ–¹æ³•ï¼›å®šä¹‰ç±»å’Œç±»çš„äº¤äº’</p><h2 id="4-1-éœ€æ±‚"><a href="#4-1-éœ€æ±‚" class="headerlink" title="4.1 éœ€æ±‚"></a>4.1 éœ€æ±‚</h2><p>å¾®æœåŠ¡ç³»ç»Ÿï¼Œé€šè¿‡HTTPåè®®æš´éœ²æ¥å£ç»™å…¶ä»–ç³»ç»Ÿè°ƒç”¨ã€‚éœ€è¦å®ç°ä¸€ä¸ªæ¥å£é‰´æƒç³»ç»Ÿï¼Œåªæœ‰ç»è¿‡è®¤è¯çš„ç³»ç»Ÿæ‰èƒ½è°ƒç”¨æˆ‘ä»¬çš„æ¥å£</p><ul><li>éœ€æ±‚åˆ†æ<ul><li>åŸºç¡€åˆ†æ<ul><li>é€šè¿‡ç”¨æˆ·ååŠ å¯†ç æ¥åšè®¤è¯</li><li>æ¯ä¸ªå…è®¸è®¿é—®çš„è°ƒç”¨å‘éƒ½æœ‰åº”ç”¨IDè¿˜æœ‰ç§˜é’¥ï¼Œåœ¨åšæ¥å£è¯·æ±‚çš„æ—¶å€™ï¼Œéœ€è¦ä¼ è¿›æ¥åº”ç”¨IDå’Œç§˜é’¥ï¼Œç„¶åæˆ‘ä»¬åœ¨è‡ªå·±çš„æœåŠ¡å™¨æ¥è¿›è¡ŒéªŒè¯æ¯”å¯¹ã€‚å¦‚æœä¸€è‡´ï¼Œè¯´æ˜è®¤è¯æˆåŠŸï¼Œå…è®¸æ¥å£è°ƒç”¨äº†å¦åˆ™ï¼Œå°±æ‹’ç»</li></ul></li><li>äºŒè½®åˆ†æ<ul><li>è¿™ç§æ–¹å¼ï¼Œæ˜æ–‡ä¼ è¾“ï¼Œå®¹æ˜“è¢«æ‹¦æˆªï¼Œå¹¶ä¸å®‰å…¨</li><li>å€ŸåŠ©åŠ å¯†ç®—æ³•ï¼Œå¯¹å¯†ç è¿›è¡ŒåŠ å¯†å†ä¼ é€’åˆ°å¾®æœåŠ¡ç«¯éªŒè¯ï¼ŒåŒæ ·ä¸å®‰å…¨ã€‚å› ä¸ºè¿˜æ˜¯å¯ä»¥è¢«æ‹¦æˆªï¼Œè¢«æ‹¦æˆªä»¥åé»‘å®¢å¯ä»¥ç›´æ¥æ‹¿ç€è¿™ä¸ªåŠ å¯†çš„å¯†ç åŠ IDæ¥å‡è£…æ˜¯è°ƒç”¨è€…å‘æœåŠ¡ç«¯å‘å‡ºè¯·æ±‚</li><li>OAuthæ–¹å¼<ul><li>è°ƒç”¨æ–¹ç”Ÿæˆtoken (id + appId + pwd)</li><li>è°ƒç”¨æ–¹ç”Ÿæˆæ–°çš„URL (id + appId + token)</li><li>Serverè§£æå‡ºURL, appId, token</li><li>Serverä»æ•°æ®åº“æ ¹æ®appIdæ‹¿å‡ºpwd</li><li>Serveråˆ©ç”¨Urlï¼ŒappIdï¼Œ pwdç”Ÿæˆserverç«¯token</li><li>æ¯”è¾ƒæ˜¯å¦ä¸€è‡´</li></ul></li></ul></li><li>ä¸‰è½®åˆ†æ<ul><li>ä¸Šè¿°æ–¹å¼è¿˜æ˜¯å¯èƒ½å­˜åœ¨é‡æ”¾æ”»å‡»ï¼Œè¢«æ‹¦æˆªï¼Œç„¶åæ¥ä¼ªè£…æˆè®¤è¯ç³»ç»Ÿï¼Œè°ƒç”¨è¿™ä¸ªURLå¯¹åº”çš„æ¥å£ã€‚</li><li>tokenç”Ÿæˆè¿‡ç¨‹åŠ å…¥æ—¶é—´æˆ³ï¼Œç„¶åä¼ é€’åˆ°å¾®æœåŠ¡å™¨ç«¯</li><li>å¾®æœåŠ¡å™¨æ”¶åˆ°è¿™äº›æ•°æ®ä¹‹åï¼Œä¼šéªŒè¯å½“å‰æ—¶é—´æˆ³è·Ÿä¼ é€’è¿‡æ¥çš„æ—¶é—´æˆ³ï¼Œæ˜¯å¦åœ¨ä¸€å®šçš„æ—¶é—´çª—å£å†…ã€‚è¶…è¿‡æ—¶é—´çª—å£ï¼Œä¹Ÿä¼šå†³ç»è¯·æ±‚</li></ul></li><li>å››è½®åˆ†æ<ul><li>åŸºæœ¬å°±æ˜¯åˆ°è¿™ä¸ªç¨‹åº¦ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜è¦è€ƒè™‘æ€§èƒ½æ–¹é¢çš„ä¸œè¥¿ã€‚è¿™ç§æ–¹å¼å¯¹äºæ€§èƒ½çš„å½±å“æ¯”è¾ƒå°ï¼Œä¹Ÿè€ƒé‡åˆ°äº†å®‰å…¨æ€§ã€‚</li><li>å¦‚ä½•åœ¨å¾®æœåŠ¡ç«¯å­˜å‚¨æ¯ä¸ªæˆæƒè°ƒç”¨æ–¹çš„appIdå’Œå¯†ç <ul><li>å¼€å‘é‰´æƒè¿™ç§éä¸šåŠ¡åŠŸèƒ½ï¼Œæœ€å¥½ä¸è¦ä¸å…·ä½“çš„ç¬¬ä¸‰æ–¹ç³»ç»Ÿæœ‰è¿‡åº¦çš„è€¦åˆ</li><li>æœ€å¥½èƒ½å¤Ÿæ”¯æŒå¤šç§ä¸åŒçš„å­˜å‚¨æ–¹å¼<ul><li>ZooKeeper</li><li>æœ¬åœ°é…ç½®æ–‡ä»¶</li><li>è‡ªç ”é…ç½®ä¸­å¿ƒ</li><li>MySQL</li><li>Redisç­‰</li></ul></li></ul></li></ul></li><li>æœ€ç»ˆéœ€æ±‚çš„ç¡®å®š<ul><li>è°ƒç”¨æ–¹è¿›è¡Œæ¥å£è¯·æ±‚çš„æ—¶å€™ï¼Œå°† URLã€AppIDã€å¯†ç ã€æ—¶é—´æˆ³æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œé€šè¿‡åŠ å¯†ç®—æ³•ç”Ÿæˆ tokenï¼Œå¹¶ä¸”å°† tokenã€AppIDã€æ—¶é—´æˆ³æ‹¼æ¥åœ¨ URL ä¸­ï¼Œä¸€å¹¶å‘é€åˆ°å¾®æœåŠ¡ç«¯ã€‚</li><li>å¾®æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°è°ƒç”¨æ–¹çš„æ¥å£è¯·æ±‚ä¹‹åï¼Œä»è¯·æ±‚ä¸­æ‹†è§£å‡º tokenã€AppIDã€æ—¶é—´æˆ³ã€‚</li><li>å¾®æœåŠ¡ç«¯é¦–å…ˆæ£€æŸ¥ä¼ é€’è¿‡æ¥çš„æ—¶é—´æˆ³è·Ÿå½“å‰æ—¶é—´ï¼Œæ˜¯å¦åœ¨ token å¤±æ•ˆæ—¶é—´çª—å£å†…ã€‚å¦‚æœå·²ç»è¶…è¿‡å¤±æ•ˆæ—¶é—´ï¼Œé‚£å°±ç®—æ¥å£è°ƒç”¨é‰´æƒå¤±è´¥ï¼Œæ‹’ç»æ¥å£è°ƒç”¨è¯·æ±‚ã€‚</li><li>å¦‚æœ token éªŒè¯æ²¡æœ‰è¿‡æœŸå¤±æ•ˆï¼Œå¾®æœåŠ¡ç«¯å†ä»è‡ªå·±çš„å­˜å‚¨ä¸­ï¼Œå–å‡º AppID å¯¹åº”çš„å¯†ç ï¼Œé€šè¿‡åŒæ ·çš„ token ç”Ÿæˆç®—æ³•ï¼Œç”Ÿæˆå¦å¤–ä¸€ä¸ª tokenï¼Œä¸è°ƒç”¨æ–¹ä¼ é€’è¿‡æ¥çš„ token è¿›è¡ŒåŒ¹é…ï¼›å¦‚æœä¸€è‡´ï¼Œåˆ™é‰´æƒæˆåŠŸï¼Œå…è®¸æ¥å£è°ƒç”¨ï¼Œå¦åˆ™å°±æ‹’ç»æ¥å£è°ƒç”¨ã€‚ </li></ul></li></ul></li></ul><h2 id="4-2-é¢å‘å¯¹è±¡è®¾è®¡"><a href="#4-2-é¢å‘å¯¹è±¡è®¾è®¡" class="headerlink" title="4.2 é¢å‘å¯¹è±¡è®¾è®¡"></a>4.2 é¢å‘å¯¹è±¡è®¾è®¡</h2><ul><li>è¿›è¡ŒèŒè´£åˆ’åˆ†ï¼Œè¿›è€Œè¯†åˆ«å‡ºéƒ½æœ‰å“ªäº›ç±»<ul><li>å°†éœ€æ±‚æè¿°ä¸­çš„åè¯ç½—åˆ—å‡ºæ¥ï¼Œä½œä¸ºå¯èƒ½çš„å€™é€‰ç±»ï¼Œç„¶åè¿›è¡Œç­›é€‰</li><li>æˆ–è€…æ ¹æ®éœ€æ±‚æè¿°ï¼Œå°†å…¶ä¸­æ¶‰åŠçš„åŠŸèƒ½ç‚¹ï¼Œä¸€ä¸ªä¸€ä¸ªç½—åˆ—å‡ºæ¥ï¼Œç„¶åå†çœ‹å“ªäº›åŠŸèƒ½ç‚¹èŒè´£ç›¸è¿‘ï¼Œæ“ä½œåŒæ ·çš„å±æ€§ï¼Œèƒ½å¦å½’åˆ°åŒä¸€ä¸ªç±»å½“ä¸­</li></ul></li><li>å®šä¹‰ç±»ï¼ŒåŠå…¶å±æ€§å’Œæ–¹æ³•</li><li>å®šä¹‰ç±»å’Œç±»ä¹‹é—´çš„äº¤äº’å…³ç³»</li><li>å°†ç±»ç»„è£…èµ·æ¥å¹¶æä¾›æ‰§è¡Œå…¥å£ </li></ul><ul><li>åŠŸèƒ½ç‚¹åˆ—è¡¨<ul><li>æŠŠ URLã€AppIDã€å¯†ç ã€æ—¶é—´æˆ³æ‹¼æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼›</li><li>å¯¹å­—ç¬¦ä¸²é€šè¿‡åŠ å¯†ç®—æ³•åŠ å¯†ç”Ÿæˆ tokenï¼›</li><li>å°† tokenã€AppIDã€æ—¶é—´æˆ³æ‹¼æ¥åˆ° URL ä¸­ï¼Œå½¢æˆæ–°çš„ URLï¼›</li><li>è§£æ URLï¼Œå¾—åˆ° tokenã€AppIDã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯ï¼›</li><li>ä»å­˜å‚¨ä¸­å–å‡º AppID å’Œå¯¹åº”çš„å¯†ç ï¼›</li><li>æ ¹æ®æ—¶é—´æˆ³åˆ¤æ–­ token æ˜¯å¦è¿‡æœŸå¤±æ•ˆï¼›</li><li>éªŒè¯ä¸¤ä¸ª token æ˜¯å¦åŒ¹é…ï¼› </li></ul></li></ul><p>ä»ä¸Šé¢çš„åŠŸèƒ½åˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œ1ã€2ã€6ã€7 éƒ½æ˜¯è·Ÿ token æœ‰å…³ï¼Œè´Ÿè´£ token çš„ç”Ÿæˆã€éªŒè¯ï¼›3ã€4 éƒ½æ˜¯åœ¨å¤„ç† URLï¼Œè´Ÿè´£ URL çš„æ‹¼æ¥ã€è§£æï¼›5 æ˜¯æ“ä½œ AppID å’Œå¯†ç ï¼Œè´Ÿè´£ä»å­˜å‚¨ä¸­è¯»å– AppID å’Œå¯†ç ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç²—ç•¥åœ°å¾—åˆ°ä¸‰ä¸ªæ ¸å¿ƒçš„ç±»ï¼šAuthTokenã€Urlã€CredentialStorageã€‚AuthToken è´Ÿè´£å®ç° 1ã€2ã€6ã€7 è¿™å››ä¸ªæ“ä½œï¼›Url è´Ÿè´£ 3ã€4 ä¸¤ä¸ªæ“ä½œï¼›CredentialStorage è´Ÿè´£ 5 è¿™ä¸ªæ“ä½œã€‚</p><pre><code>// AuthTokenç±»çš„å®ç°private static final long DEFAULT_EXPIRED_TIME_INTERVAL = 1 * 60 * 1000;private String token;private long createTime;private long expiredTimeInterval = DEFAULT_EXPIRED_TIME_INTERVAL;public AuthToken(String token, long createTime);public AuthToken(String token, long createTime, long expredTImeInterval);public static AuthToken create(String baseUrl, long createTime, Map&lt;String, String&gt; params);public String getToken();public boolean isExpired();public boolean match(AuthToken authToken)</code></pre><ul><li>Tips<ul><li>å¹¶ä¸æ˜¯æ‰€æœ‰çš„éœ€è¦çš„åè¯ç±»çš„å±æ€§éƒ½ä¼šä½œä¸ºç±»çš„å±æ€§ï¼Œæœ‰å¯èƒ½ä¼šä½œä¸ºæ–¹æ³•çš„å‚æ•°ã€‚é€‰æ‹©çš„åŸºå‡†è¿˜æ˜¯è¿™ä¸ªå±æ€§åˆ°åº•å±ä¸å±äºè¿™ä¸ªç±»ï¼Œä»è¿™ä¸ªè§’åº¦æ¥çœ‹çš„</li><li>æˆ‘ä»¬æœ‰å¯èƒ½éœ€è¦å»æŒ–æ˜ä¸€ä¸‹åœ¨åŠŸèƒ½éœ€æ±‚é‡Œé¢å¹¶æ²¡æœ‰ä½“ç°çš„ä¸€äº›å±æ€§  è¿˜æ˜¯éœ€è¦ä»ä¸šåŠ¡æ¨¡å‹çš„è§’åº¦ä¸Šæ¥çœ‹ç©¶ç«Ÿéœ€è¦æ€ä¹ˆåšæ‰æ¯”è¾ƒå¥½</li></ul></li></ul><pre><code>public interface ApiAuthenticator {  void auth(String url);  void auth(ApiRequest apiRequest);}public class DefaultApiAuthenticatorImpl implements ApiAuthenticator {  private CredentialStorage credentialStorage;  public DefaultApiAuthenticator() {    this.credentialStorage = new MysqlCredentialStorage();  }  public DefaultApiAuthenticator(CredentialStorage credentialStorage) {    this.credentialStorage = credentialStorage;  }  @Override  public void auth(String url) {    ApiRequest apiRequest = ApiRequest.buildFromUrl(url);    auth(apiRequest);  }  @Override  public void auth(ApiRequest apiRequest) {    String appId = apiRequest.getAppId();    String token = apiRequest.getToken();    long timestamp = apiRequest.getTimestamp();    String originalUrl = apiRequest.getOriginalUrl();    AuthToken clientAuthToken = new AuthToken(token, timestamp);    if (clientAuthToken.isExpired()) {      throw new RuntimeException(&quot;Token is expired.&quot;);    }    String password = credentialStorage.getPasswordByAppId(appId);    AuthToken serverAuthToken = AuthToken.generate(originalUrl, appId, password, timestamp);    if (!serverAuthToken.match(clientAuthToken)) {      throw new RuntimeException(&quot;Token verfication failed.&quot;);    }  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»„åˆ vs ç»§æ‰¿</title>
      <link href="/%E7%BB%84%E5%90%88-vs-%E7%BB%A7%E6%89%BF/"/>
      <url>/%E7%BB%84%E5%90%88-vs-%E7%BB%A7%E6%89%BF/</url>
      
        <content type="html"><![CDATA[<p>ç»„åˆè¿˜æœ‰ç»§æ‰¿éƒ½æ˜¯é¢å‘å¯¹è±¡çš„å¾ˆé‡è¦çš„ç‰¹æ€§ï¼Œä½†æ˜¯æœ‰ä¸€æ¡éå¸¸é‡è¦çš„è®¾è®¡åŸåˆ™è¯´ â€“ ç»„åˆä¼˜äºç»§æ‰¿ï¼Œæƒ³åœ¨è¿™ç¯‡åšæ–‡å½“ä¸­åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆè®¤ä¸ºç»„åˆä¼˜äºç»§æ‰¿ï¼Œä»¥åŠä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬ä»ç„¶åº”è¯¥ä½¿ç”¨ç»§æ‰¿ã€‚</p><p>ç»§æ‰¿å¯ä»¥è¡¨ç¤ºç±»ä¹‹é—´çš„is-açš„å…³ç³»ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šè§£å†³ä»£ç å¤ç”¨æ€§çš„é—®é¢˜ï¼Œä½†æ˜¯ç»§æ‰¿å±‚æ¬¡è¿‡æ·±ï¼Œä¹Ÿä¼šå½±å“åˆ°ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p><h1 id="1-ç»§æ‰¿çš„åŠ£åŠ¿"><a href="#1-ç»§æ‰¿çš„åŠ£åŠ¿" class="headerlink" title="1. ç»§æ‰¿çš„åŠ£åŠ¿"></a>1. ç»§æ‰¿çš„åŠ£åŠ¿</h1><p>è­¬å¦‚ æˆ‘ä»¬ç°åœ¨è¦å®ç°ä¸€ä¸ªå…³äºå“ºä¹³åŠ¨ç‰©çš„ç±»ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°†å“ºä¹³åŠ¨ç‰©å®šä¹‰ä¸ºä¸€ä¸ªæŠ½è±¡çš„ç±»</p><pre><code>public class Mammal {    public void breathWithLung() {    }}</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å®ä¾‹åŒ–Monkeyï¼ŒWhaleç­‰ä¸€ç³»åˆ—å“ºä¹³åŠ¨ç‰©äº†ã€‚ä½†æ˜¯å¯¹äºå“ºä¹³åŠ¨ç‰©æ¥è¯´ï¼Œä»–çš„å±ï¼Œç§‘ï¼Œç›®é—¨ç±»å¾ˆå¤šï¼Œæµ·é™†ç©ºéƒ½æœ‰ï¼Œå‡è®¾æˆ‘ä»¬æŒ‰ç…§ä»–ä»¬çš„è¡Œä¸ºæ¥è¿›è¡Œåˆ†ç±»çš„è¯ã€‚å¯ä»¥åˆ†æˆä¼šé£çš„ï¼Œä¼šæ¸¸çš„ï¼Œè¿˜æœ‰ä¼šè·‘çš„ã€‚æ‰€ä»¥å°±å¯ä»¥å†™å¦‚ä¸‹çš„ä»£ç ï¼š</p><pre><code>public class flyableMammal extends Mammal {    public void fly() {    }}public class underwaterMammal extends Mammal {    public void swim() {    }}public class onLandMammal extends Mammal {    public void run() {    }}</code></pre><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»æœ‰ä¸¤å±‚çš„ç»§æ‰¿äº†ï¼Œè€Œåæˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ–ä¸€äº›å“ºä¹³åŠ¨ç‰©ï¼Œè­¬å¦‚é²¸é±¼ï¼Œæµ·è±šï¼Œç‹®å­ç­‰ç­‰æ¥åˆ›å»ºçœŸçš„å¯¹è±¡ã€‚ç„¶åé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³æ¢ç©¶ä¼šé£çš„åŠ¨ç‰©å½“ä¸­ï¼Œå¤œè¡Œçš„ç±»ç›®ï¼Œé‚£å°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦å†åˆ›å»ºä¸€ä¸ªæ–°çš„å±‚çº§æ¥è¿›è¡Œç ”ç©¶äº†ã€‚</p><p>é•¿æ­¤ä»¥å¾€ï¼Œæ•´ä¸ªå±‚çº§å°±ä¼šå˜å¾—å¾ˆæ·±ã€‚è€Œæ·±åº¦çš„å±‚çº§æ„å‘³ç€æ¯å½“æˆ‘ä»¬æƒ³çœŸçœŸåˆ‡åˆ‡å»ç ”ç©¶åˆ°åº•è¿™ä¸ªç±»åšäº†ä»€ä¹ˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å»ä»–çš„çˆ¶ç±»ï¼Œå»ä»–çš„çˆ¶ç±»çš„çˆ¶ç±»ï¼Œè¿½æœ¬æº¯æºï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹å…¶ä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰èƒ½å®Œå…¨ç†è§£ä»–åšäº†ä»€ä¹ˆã€‚</p><p>è¿™æ ·å­æ¥åšï¼Œé¦–å…ˆé€ æˆäº†ä»£ç çš„å¯è¯»æ€§å˜å¾—éå¸¸å·®ï¼Œè€Œå¯¹äºç±»æœ¬èº«è€Œè¨€ï¼Œç ´åäº†å…¶å°è£…ç‰¹æ€§ï¼Œå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™äº†å­ç±»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€æ—¦çˆ¶ç±»ä»£ç ä¿®æ”¹ï¼Œå°±ä¼šå½±å“æ‰€æœ‰å­ç±»çš„é€»è¾‘ã€‚</p><h1 id="2-ç»„åˆçš„ä¼˜åŠ¿"><a href="#2-ç»„åˆçš„ä¼˜åŠ¿" class="headerlink" title="2. ç»„åˆçš„ä¼˜åŠ¿"></a>2. ç»„åˆçš„ä¼˜åŠ¿</h1><p>å¯¹äºä¸Šè¿°çš„åœºæ™¯ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨ç»„åˆçš„æ–¹å¼æ¥å®ç°ã€‚é€šè¿‡è®¾ç«‹å¤šä¸ªåŠŸèƒ½æ¥å£ï¼Œæ¥è¡¨ç¤ºå½“å‰ç±»çš„å±æ€§ï¼Œè­¬å¦‚flyable, runnable, swimmable, etc. é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬è®©concrete classç›´æ¥implementså¯¹åº”çš„æ¥å£ï¼Œå¹¶overrideå†™å‡ºè‡ªå·±çš„å®ç°ã€‚è¿™æ ·å­å°±èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p>é™¤äº†ä½¿ç”¨æ¥å£ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å§”æ‰˜çš„æ–¹å¼ï¼Œå³ä»ç„¶å®šäºå¯¹åº”çš„æ¥å£ï¼Œä½†æ˜¯è¿˜å®šä¹‰äº†å®ç°äº†æ¥å£æ–¹æ³•çš„å®ç°ç±»ï¼Œåœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œè°ƒç”¨å®ç°ç±»çš„æ–¹æ³•ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å­å¦‚ä¸‹</p><pre><code>public interface Flyable {  void fly()ï¼›}public class FlyAbility implements Flyable {  @Override  public void fly() { //... }}//çœç•¥Tweetable/TweetAbility/EggLayable/EggLayAbilitypublic class Ostrich implements Tweetable, EggLayable {//é¸µé¸Ÿ  private TweetAbility tweetAbility = new TweetAbility(); //ç»„åˆ  private EggLayAbility eggLayAbility = new EggLayAbility(); //ç»„åˆ  //... çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...  @Override  public void tweet() {    tweetAbility.tweet(); // å§”æ‰˜  }  @Override  public void layEgg() {    eggLayAbility.layEgg(); // å§”æ‰˜  }}</code></pre><h1 id="3-å¦‚ä½•åˆ¤æ–­è¯¥ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ç»„åˆï¼Ÿ"><a href="#3-å¦‚ä½•åˆ¤æ–­è¯¥ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ç»„åˆï¼Ÿ" class="headerlink" title="3. å¦‚ä½•åˆ¤æ–­è¯¥ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ç»„åˆï¼Ÿ"></a>3. å¦‚ä½•åˆ¤æ–­è¯¥ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ç»„åˆï¼Ÿ</h1><p>ç»„åˆä¹Ÿå¹¶ä¸å®Œç¾ï¼Œç»„åˆéœ€è¦å¯¹ç±»åšæ›´ç»†åº¦çš„æ‹†åˆ†ï¼Œè¦å®šä¹‰æ›´å¤šçš„ç±»å’Œæ¥å£ï¼Œå› æ­¤åœ¨å®é™…å¼€å‘çš„è¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ ¹æ®å…·ä½“çš„æƒ…å†µï¼Œæ¥å…·ä½“é€‰æ‹©è¯¥ä½¿ç”¨ç»§æ‰¿è¿˜æ˜¯ç»„åˆã€‚</p><p>å¦‚æœç±»ä¹‹é—´çš„ç»§æ‰¿ç»“æ„ç¨³å®š â€“ ä¸ä¼šè½»æ˜“æ”¹å˜ï¼Œç»§æ‰¿å…³ç³»æ¯”è¾ƒæµ… â€“ è­¬å¦‚ä¸¤å±‚åˆ°ä¸‰å±‚çš„ç»§æ‰¿å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç»§æ‰¿ã€‚åä¹‹ï¼Œå¯¹äºç³»ç»Ÿä¸å¤Ÿç¨³å®šï¼Œç»§æ‰¿å±‚æ¬¡ä¼šå¾ˆæ·±ï¼Œä¸”å…³ç³»å¤æ‚çš„ï¼Œæˆ‘ä»¬å°±åº”è¯¥å°½é‡ä½¿ç”¨ç»„åˆæ¥æ›¿ä»£ç»§æ‰¿äº†ã€‚</p><p>æˆ–è€…å½“æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å¤šæ€çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ç»§æ‰¿äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Composition </tag>
            
            <tag> Inheritance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java ç†è§£å¤šæ€</title>
      <link href="/Java-%E7%90%86%E8%A7%A3%E5%A4%9A%E6%80%81/"/>
      <url>/Java-%E7%90%86%E8%A7%A3%E5%A4%9A%E6%80%81/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ</h1><p>å¤šæ€ç›®çš„æ˜¯ä¸ºäº†åˆ†ç¦»åšä»€ä¹ˆå’Œæ€ä¹ˆåšï¼Œä»è€Œå®ç°æ¥å£å’Œå®ç°çš„åˆ†ç¦»ã€‚é€šè¿‡å¤šæ€ï¼Œå¯ä»¥æ”¹å–„ä»£ç çš„ç»„ç»‡ç»“æ„å’Œå¯è¯»æ€§ï¼Œæœ€é‡è¦çš„æ˜¯èƒ½å¤Ÿåˆ›å»ºå¯æ‰©å±•çš„ç¨‹åºã€‚</p><p>æœ‰ç»§æ‰¿å…³ç³»çš„ç±»ï¼Œå­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œç„¶åçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±å¯ä»¥å¯¹äºçˆ¶ç±»çš„å£°æ˜æŒ‡å‘å­ç±»çš„å®é™…å¯¹è±¡ï¼Œ</p><h1 id="2-ä¸ºä»€ä¹ˆéœ€è¦å¤šæ€ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆéœ€è¦å¤šæ€ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆéœ€è¦å¤šæ€ï¼Ÿ"></a>2. ä¸ºä»€ä¹ˆéœ€è¦å¤šæ€ï¼Ÿ</h1><p>å¤šæ€çš„å¥½å¤„å¾ˆå¤šï¼Œä»¤ä»£ç å¯æ‰©å±•ï¼Œè§£è€¦æ¥å£ä¸å®ç°ï¼Œè®©ä»£ç å¯¹äºæ”¹åŠ¨å°é—­ï¼Œå¯¹äºæ‰©å±•å¼€æ”¾, etc. å¦‚æœç›´æ¥ä»ä»£ç çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒç›´è§‚çš„çœ‹åˆ°ä»–çš„ä¼˜åŠ¿</p><pre><code>public class Animal {    public void move() {        System.out.println(&quot;Animal move&quot;);    }}public class Cat extends Animal {    @Override    public void move() {        System.out.println(&quot;cat climb&quot;);    }}public calss Dog entends Animal {    @Override    public void move() {        System.out.println(&quot;dog run&quot;);    }}public static void main(String [] args) {    Animal animal = new Cat();    animal.move();    // output: cat climb}</code></pre><p>é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å®ç°æ¥å£ä¸å®ç°çš„è§£è€¦ã€‚</p><h1 id="3-å¤šæ€å’Œç»§æ‰¿çš„å…³ç³»"><a href="#3-å¤šæ€å’Œç»§æ‰¿çš„å…³ç³»" class="headerlink" title="3. å¤šæ€å’Œç»§æ‰¿çš„å…³ç³»"></a>3. å¤šæ€å’Œç»§æ‰¿çš„å…³ç³»</h1><p>ç»§æ‰¿æŒ‡åœ¨å­ç±»å½“ä¸­ä½¿ç”¨çˆ¶ç±»çš„æ•°æ®å’Œæ–¹æ³•</p><p>å¤šæ€æŒ‡åœ¨å­ç±»å½“ä¸­æ”¹å˜çˆ¶ç±»çš„è¡Œä¸ºã€‚</p><h1 id="4-æ„é€ å™¨å†…éƒ¨çš„å¤šæ€æ–¹æ³•çš„è¡Œä¸º"><a href="#4-æ„é€ å™¨å†…éƒ¨çš„å¤šæ€æ–¹æ³•çš„è¡Œä¸º" class="headerlink" title="4. æ„é€ å™¨å†…éƒ¨çš„å¤šæ€æ–¹æ³•çš„è¡Œä¸º"></a>4. æ„é€ å™¨å†…éƒ¨çš„å¤šæ€æ–¹æ³•çš„è¡Œä¸º</h1><p>å¦‚æœåœ¨ä¸€ä¸ªæ„é€ å™¨çš„å†…éƒ¨è°ƒç”¨æ­£åœ¨æ„é€ çš„å¯¹è±¡çš„æŸä¸ªåŠ¨æ€ç»‘å®šçš„æ–¹æ³•ï¼Œä¼šå‡ºç°ä¸€äº›ä¸å¯çŸ¥çš„é”™è¯¯ã€‚</p><p>å› ä¸ºæ„é€ å™¨å†…éƒ¨çš„åŠ¨æ€ç»‘å®šæ„å‘³ç€è¦ç”¨åˆ°æ–¹æ³•è¢«è¦†ç›–ä»¥åçš„å®šä¹‰ï¼Œè€Œè¿™æ„å‘³ç€è¢«è¦†ç›–çš„æ–¹æ³•åœ¨å¯¹è±¡è¢«å®Œå…¨æ„é€ ä¹‹å‰å°±ä¼šè¢«è°ƒç”¨äº†ï¼Œ</p><pre><code>class Graph {    void draw() {        print(&quot;Graph draw()&quot;);    }    Graph() {        print(&quot;Graph() before draw()&quot;);        draw();        print(&quot;Graph() after draw()&quot;);    }}class RoundGraph extends Graph {    private int radius = 1;    RoundGraph(int r) {        radius = r;        print(&quot;RoundGraph.RoundGraph(), radius = &quot; + radius);    }    void draw() {        print(&quot;RoundGraph.draw(), radius = &quot; + radius);    }}public class PolyConstructors {    public static void main(String[] args) {        new RoundGraph(5);    }}// All output Graph() before draw()RoundGraph.draw(), radius = 0Graph() after draw()ROundGraph,RoundGraph(), radius = 5</code></pre><p>æœ‰è¿™æ ·çš„è¾“å‡ºçš„åŸå› æ˜¯å½“æˆ‘ä»¬å®ä¾‹åŒ–Ræ¬§å°¼çš„Graphçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åŸºç±»çš„æ„é€ å™¨ï¼Œåœ¨Graphç±»çš„æ„é€ å™¨å½“ä¸­è°ƒç”¨äº†draw()æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™åŠ¨æ€ç»‘å®šï¼Œæ˜¯è¦å»è°ƒç”¨RoundGraphç±»çš„drawæ–¹æ³•çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™è¿˜åœ¨æ„å»ºGraph çš„å®ä¾‹ï¼ŒRoundGraphè¿˜æ²¡æœ‰æ„å»ºå¥½ï¼Œæ‰€ä»¥å°±å‡ºç°äº†è¿”å›çš„Radiusåˆšå¼€å§‹å€¼ä¸º0çš„é—®é¢˜äº†</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>Thinking in Java Ch.8 </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Polymorphism </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç†è§£é¢å‘å¯¹è±¡</title>
      <link href="/%E7%90%86%E8%A7%A3%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
      <url>/%E7%90%86%E8%A7%A3%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡åšæ–‡ä¸»è¦æƒ³è¯´é¢å‘å¯¹è±¡çš„å‡ å¤§ç‰¹æ€§ï¼šå°è£…ï¼ŒæŠ½è±¡ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼Œä»¥åŠæˆ‘ä»¬ç©¶ç«Ÿå¦‚ä½•å»ä½¿ç”¨ã€‚</p><h1 id="1-é¢å‘å¯¹è±¡æ¦‚è¿°"><a href="#1-é¢å‘å¯¹è±¡æ¦‚è¿°" class="headerlink" title="1. é¢å‘å¯¹è±¡æ¦‚è¿°"></a>1. é¢å‘å¯¹è±¡æ¦‚è¿°</h1><h2 id="1-1-é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#1-1-é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="1.1 é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>1.1 é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>ä¸€ç§ç¼–ç¨‹èŒƒå¼/é£æ ¼ï¼Œä»¥ç±»æˆ–å¯¹è±¡ä½œä¸ºç»„ç»‡ä»£ç çš„åŸºæœ¬å•å…ƒï¼Œå¹¶å°†å°è£…ï¼ŒæŠ½è±¡ï¼Œç»§æ‰¿ï¼Œå¤šæ€å››ä¸ªç‰¹æ€§ä½œä¸ºä»£ç è®¾è®¡å’Œå®ç°çš„åŸºçŸ³ã€‚</p><p>æ•´ä¸ªç¼–ç¨‹çš„è¿‡ç¨‹ï¼š</p><ul><li>Object Oriented Analysis</li><li>Object Oriented Design</li><li>Object Oriented Programming </li></ul><h2 id="1-2-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å››å¤§ç‰¹å¾"><a href="#1-2-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å››å¤§ç‰¹å¾" class="headerlink" title="1.2 é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å››å¤§ç‰¹å¾"></a>1.2 é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å››å¤§ç‰¹å¾</h2><h3 id="1-2-1-å°è£…-Encapsulation"><a href="#1-2-1-å°è£…-Encapsulation" class="headerlink" title="1.2.1 å°è£… Encapsulation"></a>1.2.1 å°è£… Encapsulation</h3><pre><code>public class Wallet {  private String id;  private long createTime;  private BigDecimal balance;  private long balanceLastModifiedTime;  // ...çœç•¥å…¶ä»–å±æ€§...  public Wallet() {     this.id = IdGenerator.getInstance().generate();     this.createTime = System.currentTimeMillis();     this.balance = BigDecimal.ZERO;     this.balanceLastModifiedTime = System.currentTimeMillis();  }  // æ³¨æ„ï¼šä¸‹é¢å¯¹getæ–¹æ³•åšäº†ä»£ç æŠ˜å ï¼Œæ˜¯ä¸ºäº†å‡å°‘ä»£ç æ‰€å æ–‡ç« çš„ç¯‡å¹…  public String getId() { return this.id; }  public long getCreateTime() { return this.createTime; }  public BigDecimal getBalance() { return this.balance; }  public long getBalanceLastModifiedTime() { return this.balanceLastModifiedTime;  }  public void increaseBalance(BigDecimal increasedAmount) {    if (increasedAmount.compareTo(BigDecimal.ZERO) &lt; 0) {      throw new InvalidAmountException(&quot;...&quot;);    }    this.balance.add(increasedAmount);    this.balanceLastModifiedTime = System.currentTimeMillis();  }  public void decreaseBalance(BigDecimal decreasedAmount) {    if (decreasedAmount.compareTo(BigDecimal.ZERO) &lt; 0) {      throw new InvalidAmountException(&quot;...&quot;);    }    if (decreasedAmount.compareTo(this.balance) &gt; 0) {      throw new InsufficientAmountException(&quot;...&quot;);    }    this.balance.subtract(decreasedAmount);    this.balanceLastModifiedTime = System.currentTimeMillis();  }}</code></pre><p>è™šæ‹Ÿé’±åŒ…ï¼Œå¯¹äºè‡ªèº«å˜é‡ï¼Œç”¨privateæ¥æ ‡æ³¨ï¼Œç„¶åé€šè¿‡å¯¹åº”çš„getterï¼Œsetteræ–¹æ³•å…è®¸å¤–ç•Œæ¥è®¿é—®ä¸€éƒ¨åˆ†å˜é‡ï¼Œå…è®¸è¿›è¡Œä¸€å®šçš„ä¿®æ”¹ã€‚</p><p>æ²¡æœ‰å°è£…åˆ™æ„å‘³ç€ä¸å¯æ§ï¼Œå³ä»»ä½•ä»£ç éƒ½å¯ä»¥è¢«ä»»ä½•äººè®¿é—®ï¼Œä¿®æ”¹çš„ä»£ç å¯ä»¥éå¸ƒåœ¨åŒ…çš„ä»»ä½•è§’è½ï¼Œä¼šå½±å“ä»£ç çš„å¯è¯»æ€§ï¼Œä»¥åŠå¯ç»´æŠ¤æ€§ã€‚åªæš´éœ²å‡ºæœ‰é™å¤šçš„æ¥å£ï¼Œä¾›å¤–ç•Œæ¥ä½¿ç”¨ã€‚</p><p>æ€»ç»“ï¼š å°è£…æ˜¯ä¸ºäº†éšè—ä¿¡æ¯ï¼Œä¿æŠ¤æ•°æ®</p><h3 id="1-2-2-ç»§æ‰¿-Inheritance"><a href="#1-2-2-ç»§æ‰¿-Inheritance" class="headerlink" title="1.2.2 ç»§æ‰¿ Inheritance"></a>1.2.2 ç»§æ‰¿ Inheritance</h3><p>ç”¨æ¥è¡¨è¿°is açš„å…³ç³»ï¼Œjavaæ”¯æŒå•ç»§æ‰¿ã€‚</p><p>ç»§æ‰¿æœ€å¤§çš„å¥½å¤„å°±æ˜¯ä»£ç å¤ç”¨ï¼Œæ¯”å¦‚ä¸¤ä¸ªå­ç±»çš„å…±åŒä»£ç æŠ½å–åˆ°çˆ¶ç±»å½“ä¸­ï¼Œç„¶åçˆ¶ç±»æ¥å…±åŒä½¿ç”¨ã€‚</p><p>ä½†æ˜¯è¿‡åº¦ä½¿ç”¨çš„è¯ä¼šå®¹æ˜“å¯¼è‡´å±‚çº§æ•°é‡å¤ªå¤šï¼Œåè€Œé™ä½ä»£ç çš„å¯è¯»æ€§ã€‚</p><h3 id="1-2-3-å¤šæ€-Polymorphism"><a href="#1-2-3-å¤šæ€-Polymorphism" class="headerlink" title="1.2.3 å¤šæ€ Polymorphism"></a>1.2.3 å¤šæ€ Polymorphism</h3><ul><li>ç»§æ‰¿åŠ æ–¹æ³•é‡å†™å®ç°</li></ul><pre><code>public class DynamicArray {  private static final int DEFAULT_CAPACITY = 10;  protected int size = 0;  protected int capacity = DEFAULT_CAPACITY;  protected Integer[] elements = new Integer[DEFAULT_CAPACITY];  public int size() { return this.size; }  public Integer get(int index) { return elements[index];}  //...çœç•¥nå¤šæ–¹æ³•...  public void add(Integer e) {    ensureCapacity();    elements[size++] = e;  }  protected void ensureCapacity() {    //...å¦‚æœæ•°ç»„æ»¡äº†å°±æ‰©å®¹...ä»£ç çœç•¥...  }}public class SortedDynamicArray extends DynamicArray {  @Override  public void add(Integer e) {    ensureCapacity();    int i;    for (i = size-1; i&gt;=0; --i) { //ä¿è¯æ•°ç»„ä¸­çš„æ•°æ®æœ‰åº      if (elements[i] &gt; e) {        elements[i+1] = elements[i];      } else {        break;      }    }    elements[i+1] = e;    ++size;  }}public class Example {  public static void test(DynamicArray dynamicArray) {    dynamicArray.add(5);    dynamicArray.add(1);    dynamicArray.add(3);    for (int i = 0; i &lt; dynamicArray.size(); ++i) {      System.out.println(dynamicArray.get(i));    }  }  public static void main(String args[]) {    DynamicArray dynamicArray = new SortedDynamicArray();    test(dynamicArray); // æ‰“å°ç»“æœï¼š1ã€3ã€5  }}</code></pre><ul><li>åˆ©ç”¨æ¥å£ç±»å®ç°å¤šæ€ç‰¹æ€§</li></ul><pre><code>public interface Iterator {  String hasNext();  String next();  String remove();}public class Array implements Iterator {  private String[] data;  public String hasNext() { ... }  public String next() { ... }  public String remove() { ... }  //...çœç•¥å…¶ä»–æ–¹æ³•...}public class LinkedList implements Iterator {  private LinkedListNode head;  public String hasNext() { ... }  public String next() { ... }  public String remove() { ... }  //...çœç•¥å…¶ä»–æ–¹æ³•... }public class Demo {  private static void print(Iterator iterator) {    while (iterator.hasNext()) {      System.out.println(iterator.next());    }  }  public static void main(String[] args) {    Iterator arrayIterator = new Array();    print(arrayIterator);    Iterator linkedListIterator = new LinkedList();    print(linkedListIterator);  }}</code></pre><p>å¤šæ€å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ä»£ç çš„å¯æ‰©å±•æ€§å’Œå¤ç”¨æ€§</p><h3 id="1-2-4-æŠ½è±¡-Abstraction"><a href="#1-2-4-æŠ½è±¡-Abstraction" class="headerlink" title="1.2.4 æŠ½è±¡ Abstraction"></a>1.2.4 æŠ½è±¡ Abstraction</h3><p>æŠ½è±¡ï¼Œä¸»è¦æ˜¯ä¸ºäº†éšè—æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œè®©è°ƒç”¨è€…åªéœ€è¦å…³å¿ƒæ–¹æ³•æä¾›äº†å“ªäº›åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦çŸ¥é“è¿™äº›æ–¹æ³•å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><pre><code>public interface IPictureStorage {  void savePicture(Picture picture);  Image getPicture(String pictureId);  void deletePicture(String pictureId);  void modifyMetaInfo(String pictureId, PictureMetaInfo metaInfo);}public class PictureStorage implements IPictureStorage {  // ...çœç•¥å…¶ä»–å±æ€§...  @Override  public void savePicture(Picture picture) { ... }  @Override  public Image getPicture(String pictureId) { ... }  @Override  public void deletePicture(String pictureId) { ... }  @Override  public void modifyMetaInfo(String pictureId, PictureMetaInfo metaInfo) { ... }}</code></pre><p>ä½¿ç”¨æ¥å£æˆ–è€…abstract classï¼Œç„¶åè°ƒç”¨è€…å°±åªéœ€è¦çŸ¥é“éœ€è¦ä¼ å…¥ä»€ä¹ˆå‚æ•°ï¼Œä¼ å‡ºä»€ä¹ˆå‚æ•°ï¼Œå°±å¯ä»¥è¯•ç”¨äº†ã€‚</p><h1 id="2-é¢å‘å¯¹è±¡-vs-é¢å‘è¿‡ç¨‹"><a href="#2-é¢å‘å¯¹è±¡-vs-é¢å‘è¿‡ç¨‹" class="headerlink" title="2. é¢å‘å¯¹è±¡ vs é¢å‘è¿‡ç¨‹"></a>2. é¢å‘å¯¹è±¡ vs é¢å‘è¿‡ç¨‹</h1><p>éœ€è¦å¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µæœ‰æ›´æ·±çš„ç†è§£ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯åœ¨ç”¨é¢å‘å¯¹è±¡çš„è¯­è¨€å†™é¢å‘è¿‡ç¨‹çš„ä»£ç ï¼Œå¯¹äºåˆ°åº•ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ï¼Œå¦‚ä½•å†™çœŸçš„é¢å‘å¯¹è±¡çš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰å¾ˆå¤šæ— æ³•ç¡®å®šçš„åœ°æ–¹ã€‚</p><p>é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä»¥è¿‡ç¨‹(æ–¹æ³•ï¼Œå‡½æ•°ï¼Œæ“ä½œ)ä½œä¸ºç»„ç»‡ä»£ç çš„åŸºæœ¬å•å…ƒï¼Œä»¥æ•°æ®(å¯ä»¥ç†è§£ä¸ºæˆå‘˜å˜é‡ï¼Œå±æ€§)ä¸æ–¹æ³•ç›¸åˆ†ç¦»ä¸ºæœ€ä¸»è¦çš„ç‰¹ç‚¹ã€‚é¢å‘è¿‡ç¨‹é£æ ¼æ˜¯ä¸€ç§æµç¨‹åŒ–çš„ç¼–ç¨‹é£æ ¼ï¼Œé€šè¿‡æ‹¼æ¥ä¸€ç»„é¡ºåºæ‰§è¡Œçš„æ–¹æ³•æ¥æ“ä½œæ•°æ®å®Œæˆä¸€é¡¹åŠŸèƒ½ã€‚</p><h2 id="2-1-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜åŠ¿"><a href="#2-1-é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜åŠ¿" class="headerlink" title="2.1 é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜åŠ¿"></a>2.1 é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜åŠ¿</h2><h3 id="2-1-1-æ›´èƒ½å¤Ÿåº”å¯¹å¤§è§„æ¨¡å¤æ‚ç¨‹åºçš„å¼€å‘"><a href="#2-1-1-æ›´èƒ½å¤Ÿåº”å¯¹å¤§è§„æ¨¡å¤æ‚ç¨‹åºçš„å¼€å‘" class="headerlink" title="2.1.1 æ›´èƒ½å¤Ÿåº”å¯¹å¤§è§„æ¨¡å¤æ‚ç¨‹åºçš„å¼€å‘"></a>2.1.1 æ›´èƒ½å¤Ÿåº”å¯¹å¤§è§„æ¨¡å¤æ‚ç¨‹åºçš„å¼€å‘</h3><p>å› ä¸ºå¯¹äºé¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹é£æ ¼æ¥è¯´ï¼Œæ•´ä¸ªç¨‹åºçš„å¤„ç†æµç¨‹ä¼šåå‘äºçº¿æ€§ï¼Œæµç¨‹åŒ–ï¼Œä½†æ˜¯å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå…³ç³»é”™ç»¼å¤æ‚ï¼Œä¼šå¾ˆéš¾å°†ç¨‹åºæ‹†è§£ä¸ºä¸€ç»„é¡ºåºæ‰§è¡Œçš„æ–¹æ³•ã€‚è€Œé¢å‘å¯¹è±¡çš„æ–¹å¼å°±å¯ä»¥æ¯”è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p><h3 id="2-1-2-æ›´æ˜“å¤ç”¨ï¼Œæ‰©å±•å’Œç»´æŠ¤"><a href="#2-1-2-æ›´æ˜“å¤ç”¨ï¼Œæ‰©å±•å’Œç»´æŠ¤" class="headerlink" title="2.1.2 æ›´æ˜“å¤ç”¨ï¼Œæ‰©å±•å’Œç»´æŠ¤"></a>2.1.2 æ›´æ˜“å¤ç”¨ï¼Œæ‰©å±•å’Œç»´æŠ¤</h3><p>é¢å‘å¯¹è±¡é€šè¿‡ç±»è¿™ç§ç»„ç»‡æ–¹å¼èƒ½å¤Ÿå°†æ•°æ®å’Œæ–¹æ³•ç»‘å®šåœ¨ä¸€èµ·ï¼Œé€šè¿‡è®¿é—®æƒé™æ§åˆ¶ï¼Œåªå…è®¸å¤–éƒ¨è°ƒç”¨è€…é€šè¿‡ç±»æš´éœ²çš„æœ‰é™æ–¹æ³•è®¿é—®æ•°æ®ï¼Œè€Œä¸ä¼šåƒé¢å‘è¿‡ç¨‹ç¼–ç¨‹é‚£æ ·ï¼Œæ•°æ®å¯ä»¥è¢«ä»»æ„æ–¹æ³•çš„éšæ„ä¿®æ”¹</p><p>æˆ‘ä»¬é€šè¿‡ä½¿ç”¨å¤šæ€çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨éœ€è¦ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½å®ç°çš„æ—¶å€™ï¼Œé€šè¿‡å®ç°ä¸€ä¸ªæ–°çš„å­ç±»çš„æ–¹å¼ï¼Œåœ¨å­ç±»å½“ä¸­é‡å†™åŸæ¥çš„åŠŸèƒ½é€»è¾‘ï¼Œç”¨å­ç±»æ›¿ä»£çˆ¶ç±»ã€‚ â€”- å¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ã€‚</p><h2 id="2-2-Warning-Bad-Smell-çœ‹ä¼¼é¢å‘å¯¹è±¡çš„é¢å‘è¿‡ç¨‹çš„ä»£ç "><a href="#2-2-Warning-Bad-Smell-çœ‹ä¼¼é¢å‘å¯¹è±¡çš„é¢å‘è¿‡ç¨‹çš„ä»£ç " class="headerlink" title="2.2 Warning/ Bad Smell - çœ‹ä¼¼é¢å‘å¯¹è±¡çš„é¢å‘è¿‡ç¨‹çš„ä»£ç "></a>2.2 Warning/ Bad Smell - çœ‹ä¼¼é¢å‘å¯¹è±¡çš„é¢å‘è¿‡ç¨‹çš„ä»£ç </h2><p>é¦–å…ˆå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡ŒæåŠçš„éƒ½æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œä½†å¹¶ä¸æ˜¯è¯´æˆ‘ä»¬å®Œå…¨ä¸èƒ½è¿™æ ·å­å†™ã€‚è­¬å¦‚util classï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ˜¯éœ€è¦çš„ï¼Œå› ä¸ºç¡®å®å¯ä»¥ä¸å¸¦æ•°æ®çš„ï¼Œåªåœ¨inputï¼Œoutputä¼ é€’æ‰€æœ‰ä¿¡æ¯å°±å¤Ÿäº†ã€‚</p><h3 id="2-2-1-getter-setteræ–¹æ³•çš„é—®é¢˜"><a href="#2-2-1-getter-setteræ–¹æ³•çš„é—®é¢˜" class="headerlink" title="2.2.1 getter setteræ–¹æ³•çš„é—®é¢˜"></a>2.2.1 getter setteræ–¹æ³•çš„é—®é¢˜</h3><p>å½“æˆ‘ä»¬ä¹ æƒ¯æ€§çš„ç»™æ‰€æœ‰çš„å±æ€§éƒ½åŠ ä¸Šgetterï¼Œ setteræ–¹æ³•çš„æ—¶å€™ï¼Œå…¶å®æ˜¯ç ´åäº†Javaçš„å°è£…çš„ç‰¹æ€§çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨private æ ‡æ³¨å±æ€§ï¼Œå†é€‚å½“çš„è®¾ç½®setterï¼Œgetteræ–¹æ³•æ˜¯å› ä¸ºæˆ‘ä»¬ä¸æƒ³å°†å¯¹äºä»£ç /æ•°æ®çš„æ§åˆ¶æƒäº¤ç»™ä»–äººï¼Œè€Œç–¯ç‹‚çš„getterï¼Œsetteræ–¹æ³•ä¼šè®©Javaçš„å°è£…ä¼˜åŠ¿è¡ç„¶æ— å­˜ï¼Œåªæ˜¯ä»åŸæ¥çš„ç›´æ¥è®¿é—®å±æ€§å˜æˆé€šè¿‡getterï¼Œsetteræ–¹æ³•æ¥è®¿é—®ã€‚æ²¡æœ‰èµ·åˆ°ä»»ä½•ä¿éšœå®‰å…¨çš„ä½œç”¨ã€‚</p><p>æ³¨æ„å¦‚æœæ˜¯é›†åˆå®¹å™¨çš„è¯ï¼Œè¦é˜²èŒƒé›†åˆå†…éƒ¨çš„æ•°æ®è¢«ä¿®æ”¹çš„å±é™©ã€‚å¦å¤–ï¼Œsetteræ–¹æ³•çš„ä½¿ç”¨éœ€è¦è°¨æ…äº›ï¼Œåªæœ‰åœ¨å¿…éœ€çš„æ—¶å€™å†ç”¨ã€‚</p><h3 id="2-2-2-å…¨å±€å˜é‡å’Œå…¨å±€æ–¹æ³•"><a href="#2-2-2-å…¨å±€å˜é‡å’Œå…¨å±€æ–¹æ³•" class="headerlink" title="2.2.2 å…¨å±€å˜é‡å’Œå…¨å±€æ–¹æ³•"></a>2.2.2 å…¨å±€å˜é‡å’Œå…¨å±€æ–¹æ³•</h3><p>å¸¸è§çš„å…¨å±€å˜é‡æœ‰ï¼š</p><ul><li>å•ä¾‹ç±»å¯¹è±¡</li><li>é™æ€æˆå‘˜å˜é‡</li><li>å¸¸é‡</li></ul><p>å¸¸è§çš„å…¨å±€æ–¹æ³•æœ‰ï¼š</p><ul><li>é™æ€æ–¹æ³•</li></ul><p>Constantsç±»å¾€å¾€ä¼šè¶ŠåŠ è¶Šå¤§ï¼Œè€Œä¸”ä¼šå¾ˆéš¾ç»´æŠ¤ã€‚è€Œä¸”å¦‚æœæˆ‘ä»¬å¼€å‘çš„å…¶ä»–é¡¹ç›®éœ€è¦å¤ç”¨è¿™äº›constantsï¼Œå“ªæ€•æˆ‘ä»¬åªä½¿ç”¨ä¸€ä¸ªï¼Œé‚£ä¹ˆæœ€ç»ˆä¹Ÿä¼šä¸å¾—ä¸å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½è¿›å»ï¼Œæ²¡æœ‰å¿…è¦ï¼Œè€Œä¸”ä¼šå˜å¾—éå¸¸çš„æ…¢ã€‚æˆ‘ä»¬å¯ä»¥å°†Constantsç±»æ‹†åˆ†ä¸ºåŠŸèƒ½æ›´åŠ å•ä¸€çš„å¤šä¸ªç±»ï¼Œæˆ–è€…ç›´æ¥å°†è¿™äº›å¸¸é‡å®šä¹‰åˆ°å¯¹åº”çš„classå½“ä¸­ã€‚è¿™ä¹Ÿæ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><h2 id="3-1-ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ-ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Ÿ"><a href="#3-1-ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ-ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Ÿ" class="headerlink" title="3.1 ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Ÿ"></a>3.1 ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Ÿ</h2><h3 id="3-1-1-æŠ½è±¡ç±»å®šä¹‰"><a href="#3-1-1-æŠ½è±¡ç±»å®šä¹‰" class="headerlink" title="3.1.1 æŠ½è±¡ç±»å®šä¹‰"></a>3.1.1 æŠ½è±¡ç±»å®šä¹‰</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ¿è®¾è®¡çš„å®ä¾‹ï¼ŒLoggerè¢«ç”¨æ¥è®°å½•æ—¥å¿—ï¼ŒFileLoggerå’ŒMessageQueueLoggerç»§æ‰¿Loggerï¼Œåˆ†åˆ«å®ç°ä¸¤ç§ä¸åŒçš„æ—¥å¿—è®°å½•æ–¹å¼</p><pre><code>// æŠ½è±¡ç±»public abstract class Logger {  private String name;  private boolean enabled;  private Level minPermittedLevel;  public Logger(String name, boolean enabled, Level minPermittedLevel) {    this.name = name;    this.enabled = enabled;    this.minPermittedLevel = minPermittedLevel;  }  public void log(Level level, String message) {    boolean loggable = enabled &amp;&amp; (minPermittedLevel.intValue() &lt;= level.intValue());    if (!loggable) return;    doLog(level, message);  }  protected abstract void doLog(Level level, String message);}// æŠ½è±¡ç±»çš„å­ç±»ï¼šè¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶public class FileLogger extends Logger {  private Writer fileWriter;  public FileLogger(String name, boolean enabled,    Level minPermittedLevel, String filepath) {    super(name, enabled, minPermittedLevel);    this.fileWriter = new FileWriter(filepath);   }  @Override  public void doLog(Level level, String mesage) {    // æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶    fileWriter.write(...);  }}// æŠ½è±¡ç±»çš„å­ç±»: è¾“å‡ºæ—¥å¿—åˆ°æ¶ˆæ¯ä¸­é—´ä»¶(æ¯”å¦‚kafka)public class MessageQueueLogger extends Logger {  private MessageQueueClient msgQueueClient;  public MessageQueueLogger(String name, boolean enabled,    Level minPermittedLevel, MessageQueueClient msgQueueClient) {    super(name, enabled, minPermittedLevel);    this.msgQueueClient = msgQueueClient;  }  @Override  protected void doLog(Level level, String mesage) {    // æ ¼å¼åŒ–levelå’Œmessage,è¾“å‡ºåˆ°æ¶ˆæ¯ä¸­é—´ä»¶    msgQueueClient.send(...);  }}</code></pre><p>æŠ½è±¡ç±»çš„ç‰¹æ€§ï¼š</p><ul><li>æŠ½è±¡ç±»ä¸å…è®¸è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½è¢«ç»§æ‰¿  </li><li>æŠ½è±¡ç±»å¯ä»¥åŒ…å«å±æ€§ä¸æ–¹æ³•ï¼Œæ–¹æ³•å¯ä»¥åŒ…å«ä»£ç å®ç°ï¼Œä¹Ÿå¯ä»¥ä¸åŒ…å«ï¼Œè®¾è®¡æˆæŠ½è±¡æ–¹æ³•</li><li>å­ç±»ç»§æ‰¿æŠ½è±¡ç±»ï¼Œå¿…é¡»å®ç°æŠ½è±¡ç±»å½“ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•</li></ul><h3 id="3-1-2-æ¥å£å®šä¹‰"><a href="#3-1-2-æ¥å£å®šä¹‰" class="headerlink" title="3.1.2 æ¥å£å®šä¹‰"></a>3.1.2 æ¥å£å®šä¹‰</h3><pre><code>// æ¥å£public interface Filter {  void doFilter(RpcRequest req) throws RpcException;}// æ¥å£å®ç°ç±»ï¼šé‰´æƒè¿‡æ»¤å™¨public class AuthencationFilter implements Filter {  @Override  public void doFilter(RpcRequest req) throws RpcException {    //...é‰´æƒé€»è¾‘..  }}// æ¥å£å®ç°ç±»ï¼šé™æµè¿‡æ»¤å™¨public class RateLimitFilter implements Filter {  @Override  public void doFilter(RpcRequest req) throws RpcException {    //...é™æµé€»è¾‘...  }}// è¿‡æ»¤å™¨ä½¿ç”¨demopublic class Application {  // filters.add(new AuthencationFilter());  // filters.add(new RateLimitFilter());  private List&lt;Filter&gt; filters = new ArrayList&lt;&gt;();  public void handleRpcRequest(RpcRequest req) {    try {      for (Filter filter : fitlers) {        filter.doFilter(req);      }    } catch(RpcException e) {      // ...å¤„ç†è¿‡æ»¤ç»“æœ...    }    // ...çœç•¥å…¶ä»–å¤„ç†é€»è¾‘...  }}</code></pre><p>ä½¿ç”¨interfaceå…³é”®å­—å®ç°ä¸€ä¸ªFilteræ¥å£ï¼ŒAuthencationFilterå’ŒRatelimiterFilteråˆ†åˆ«å®ç°å¯¹äºRPCè¯·æ±‚çš„é‰´æƒå’Œé™æµçš„è¿‡æ»¤åŠŸèƒ½ã€‚</p><ul><li>æ¥å£ä¸èƒ½åŒ…å«å±æ€§</li><li>æ¥å£åªèƒ½å£°æ˜æ–¹æ³•ï¼Œæ–¹æ³•ä¸èƒ½åŒ…å«ä»£ç å®ç°</li><li>ç±»å®ç°æ¥å£çš„æ—¶å€™ï¼Œå¿…é¡»å®ç°æ¥å£å½“ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•</li></ul><p>æŠ½è±¡ç±»å’Œç»§æ‰¿ç±»ä¼¼ï¼Œå…¶å®è¡¨å¾çš„æ˜¯ä¸€ç§is-açš„å…³ç³»ï¼›è€Œæ¥å£è¡¨å¾çš„æ˜¯ä¸€ç§has-açš„å…³ç³»/ åè®®ï¼Œè¡¨ç¤ºå…·æœ‰æŸäº›åŠŸèƒ½ </p><h2 id="3-2-åŒºåˆ«-éƒ½èƒ½è§£å†³ä»€ä¹ˆæ ·çš„ç¼–ç¨‹é—®é¢˜ï¼Ÿ"><a href="#3-2-åŒºåˆ«-éƒ½èƒ½è§£å†³ä»€ä¹ˆæ ·çš„ç¼–ç¨‹é—®é¢˜ï¼Ÿ" class="headerlink" title="3.2 åŒºåˆ«/ éƒ½èƒ½è§£å†³ä»€ä¹ˆæ ·çš„ç¼–ç¨‹é—®é¢˜ï¼Ÿ"></a>3.2 åŒºåˆ«/ éƒ½èƒ½è§£å†³ä»€ä¹ˆæ ·çš„ç¼–ç¨‹é—®é¢˜ï¼Ÿ</h2><h3 id="3-2-1-æŠ½è±¡ç±»-å­˜åœ¨çš„æ„ä¹‰"><a href="#3-2-1-æŠ½è±¡ç±»-å­˜åœ¨çš„æ„ä¹‰" class="headerlink" title="3.2.1 æŠ½è±¡ç±» å­˜åœ¨çš„æ„ä¹‰"></a>3.2.1 æŠ½è±¡ç±» å­˜åœ¨çš„æ„ä¹‰</h3><p>æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–ï¼Œåªèƒ½è¢«ç»§æ‰¿ã€‚ä¸»è¦æ˜¯ç”¨æ¥è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜çš„ã€‚å¤šä¸ªå­ç±»å¯ä»¥ç»§æ‰¿æŠ½è±¡ç±»å½“ä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œé¿å…åœ¨å­ç±»å½“ä¸­ï¼Œé‡å¤ç¼–å†™ç›¸åŒçš„ä»£ç ã€‚</p><p>ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯æŠ½è±¡ç±»æ¥åšä»£ç å¤ç”¨å‘¢ï¼Ÿ </p><ul><li>å› ä¸ºå¯ä»¥åˆ©ç”¨å¤šæ€æ¥åšäº†</li><li>å‡å°‘çˆ¶ç±»ä»£ç è¢«é”™è¯¯çš„ç›´æ¥ä½¿ç”¨çš„é£é™©</li><li>ä¹Ÿå¯ä»¥å¢åŠ ä»£ç çš„å¯è¯»æ€§</li></ul><h3 id="3-2-2-æ¥å£çš„å­˜åœ¨æ„ä¹‰"><a href="#3-2-2-æ¥å£çš„å­˜åœ¨æ„ä¹‰" class="headerlink" title="3.2.2 æ¥å£çš„å­˜åœ¨æ„ä¹‰"></a>3.2.2 æ¥å£çš„å­˜åœ¨æ„ä¹‰</h3><p>æ¥å£æ›´ä¾§é‡äºè§£è€¦ï¼Œæ¥å£æ˜¯å¯¹è¡Œä¸ºçš„ä¸€ç§æŠ½è±¡ï¼Œç›¸å½“äºä¸€ç»„åè®®æˆ–è€…å¥‘çº¦ã€‚è¿™æ ·è°ƒç”¨è€…åªéœ€è¦å…³æ³¨æŠ½è±¡çš„æ¥å£ï¼Œä¸éœ€è¦äº†è§£å…·ä½“çš„å®ç°</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://github.com/gdhucoder/Algorithms4/blob/master/designpattern/pic/umlcheatsheet.jpg" target="_blank" rel="noopener">https://github.com/gdhucoder/Algorithms4/blob/master/designpattern/pic/umlcheatsheet.jpg</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OOP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼æ¦‚è¿°</title>
      <link href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%BF%B0/"/>
      <url>/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-èµ·æº"><a href="#1-èµ·æº" class="headerlink" title="1. èµ·æº"></a>1. èµ·æº</h1><p>æ¯ä¸ªæ¨¡å¼éƒ½æè¿°äº†ä¸€ä¸ªåœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­ä¸æ–­å‡ºç°çš„é—®é¢˜ï¼Œç„¶åæè¿°äº†è¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ— æ•°æ¬¡é‡ç”¨é‚£äº›å·²æœ‰çš„æˆåŠŸçš„è§£å†³æ–¹æ¡ˆï¼Œæ— é¡»å†é‡å¤ç›¸åŒçš„å·¥ä½œã€‚</p><p>è½¯ä»¶æ¨¡å¼(Software Patterns)æ˜¯å°†æ¨¡å¼çš„ä¸€èˆ¬æ¦‚å¿µåº”ç”¨äºè½¯ä»¶å¼€å‘é¢†åŸŸï¼Œå³è½¯ä»¶å¼€å‘çš„æ€»ä½“æŒ‡å¯¼æ€è·¯æˆ–å‚ç…§æ ·æ¿ã€‚è½¯ä»¶æ¨¡å¼å¹¶éä»…é™äºè®¾è®¡æ¨¡å¼ï¼Œè¿˜åŒ…æ‹¬æ¶æ„æ¨¡å¼ã€åˆ†ææ¨¡å¼å’Œè¿‡ç¨‹æ¨¡å¼ç­‰ï¼Œ<strong><em>å®é™…ä¸Šï¼Œåœ¨è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸçš„æ¯ä¸€ä¸ªé˜¶æ®µéƒ½å­˜åœ¨ç€ä¸€äº›è¢«è®¤åŒçš„æ¨¡å¼</em></strong>ã€‚</p><p>æƒ³è¦å­¦ä¹ è®¾è®¡æ¨¡å¼çš„åŸå› ï¼Œæ˜¯å› ä¸ºæ„Ÿåˆ°è‡ªå·±çš„ä»£ç èƒ½åŠ›è¿˜æ˜¯æœ‰ç‚¹æ‰æ€¥ï¼Œå¯ä»¥å†™å‡ºèƒ½ç”¨çš„ä»£ç ï¼Œä½†å¾ˆéš¾å†™å‡ºå¥½çœ‹çš„ä»£ç ï¼Œå¦‚æœæ¯æ¬¡å†™ä»£ç çš„æ—¶å€™éƒ½è¦ä¸€è¡Œä¸€è¡Œçš„æ¥æ„å»ºï¼Œè€Œæ²¡æœ‰ä¸€ä¸ªç»„ä»¶ä¸€ä¸ªç»„ä»¶çš„æ„è¯†çš„è¯ï¼Œé‚£å†™å¥½ä»£ç ææ€•åªèƒ½æ˜¯å¤©æ–¹å¤œè°­äº†ã€‚æˆ‘æƒ³è®¾è®¡æ¨¡å¼å¯¹æˆ‘æ¥è¯´ï¼Œå°±æ˜¯æŠ½è±¡ï¼Œæ„å»ºæ¡†æ¶çš„è¿‡ç¨‹ï¼Œæ˜¯çœŸçœŸåˆ‡åˆ‡èƒ½å¤Ÿåœ¨æ—¥å¸¸å·¥ä½œå½“ä¸­å¸®åŠ©åˆ°è‡ªå·±çš„ã€‚ä¸ä»…ä»…åœ¨äºä»£ç è´¨é‡ï¼Œä¹Ÿåœ¨äºç»„ä»¶åŒ–ä»¥åçš„å¼€å‘é€Ÿåº¦ï¼Œä»¥åŠå¯¹äºæ›´åŠ å¤æ‚çš„å•†ä¸šä¸Šçš„å®é™…åœºæ™¯å¾—ä»¥æä¾›å‡ºæ›´åŠ åŒ¹é…çš„è§£å†³æ–¹å¼çš„èƒ½åŠ›ã€‚</p><p>å¦å¤–ä¸€ä¸ªç‚¹æ˜¯å½“å‰æˆ‘çš„èƒ½åŠ›èŒƒç•´è¿˜æ˜¯ä»…ä»…åœ¨äºæ ¹æ®éœ€æ±‚å†™å‡ºä»£ç ï¼Œå³åœç•™åœ¨å†™ä¸šåŠ¡ä»£ç çš„é˜¶æ®µï¼Œåœ¨è¿™ä¸ªé˜¶æ®µå½“ä¸­ï¼Œè‡ªå·±å¹¶ä¸éœ€è¦å…·æœ‰å¾ˆå¼ºçš„ä»£ç è®¾è®¡èƒ½åŠ›ï¼Œç†è§£ä¸šåŠ¡å°±å¯ä»¥å†™å‡ºä»£ç äº†ã€‚ä½†æ˜¯å¦‚æœæƒ³è¦æˆé•¿ï¼Œè¿˜æ˜¯éœ€è¦å…·å¤‡å†™å‡º<strong>å’Œä¸šåŠ¡å¹¶ä¸ç›´æ¥ç›¸å…³çš„æ›´åŠ é€šç”¨çš„åŠŸèƒ½æ¨¡å—</strong>çš„èƒ½åŠ›çš„ã€‚</p><h1 id="2-è½¯ä»¶æ¨¡å¼çš„åŸºç¡€ç»“æ„"><a href="#2-è½¯ä»¶æ¨¡å¼çš„åŸºç¡€ç»“æ„" class="headerlink" title="2. è½¯ä»¶æ¨¡å¼çš„åŸºç¡€ç»“æ„"></a>2. è½¯ä»¶æ¨¡å¼çš„åŸºç¡€ç»“æ„</h1><ul><li>é—®é¢˜æè¿°</li><li>å‰ææ¡ä»¶</li><li>è§£æ³•</li><li>æ•ˆæœ</li></ul><h2 id="2-1-è¯„ä»·ä»£ç çš„ä¸€äº›ç»´åº¦"><a href="#2-1-è¯„ä»·ä»£ç çš„ä¸€äº›ç»´åº¦" class="headerlink" title="2.1 è¯„ä»·ä»£ç çš„ä¸€äº›ç»´åº¦"></a>2.1 è¯„ä»·ä»£ç çš„ä¸€äº›ç»´åº¦</h2><p>å…³äºå¦‚ä½•åˆ¤æ–­ä¸€æ®µä»£ç å†™çš„å¥½åï¼Œä¼—è¯´çº·çº­ï¼Œæ¯ä¸ªäººå…¶å®éƒ½æœ‰è‡ªå·±ä¸»è§‚ä¸Šçš„æŸäº›çœ‹æ³•ã€‚ä½†æ˜¯åœ¨æ›´é«˜ç»´åº¦ä¸Šæ¥è¯´ï¼Œä¼šæœ‰ä¸€äº›ç›¸å¯¹èƒ½è¾¾æˆå…±è¯†çš„æ ‡å‡†ï¼Œæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å¹³å¸¸å†™ä»£ç çš„æ—¶å€™æ›´å¤šçš„æ³¨æ„ä¸€ä¸‹çš„ã€‚</p><h3 id="2-1-1-å¯ç»´æŠ¤æ€§-maintainability"><a href="#2-1-1-å¯ç»´æŠ¤æ€§-maintainability" class="headerlink" title="2.1.1 å¯ç»´æŠ¤æ€§ maintainability"></a>2.1.1 å¯ç»´æŠ¤æ€§ maintainability</h3><ul><li>åœ¨ä¸ç ´ååŸæœ‰ä»£ç çš„è®¾è®¡ï¼Œä¸å¼•å…¥æ–°çš„bugçš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°ä¿®æ”¹æˆ–è€…æ·»åŠ ä»£ç </li><li>ç»†æ‹†åˆ†å…¶å®å°±æœ‰å¾ˆå¤šå› ç´ çš„ååŒä½œç”¨äº†<ul><li>ä»£ç çš„å¯è¯»æ€§ï¼Œç®€æ´</li><li>ä»£ç åˆ†å±‚æ¸…æ™°ç¨‹åº¦ï¼Œæ¨¡å—åŒ–ï¼Œé«˜å†…èšä½è€¦åˆ</li><li>åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹</li></ul></li></ul><h3 id="2-1-2-å¯è¯»æ€§-readability"><a href="#2-1-2-å¯è¯»æ€§-readability" class="headerlink" title="2.1.2 å¯è¯»æ€§ readability"></a>2.1.2 å¯è¯»æ€§ readability</h3><ul><li>å‘½å</li><li>æ³¨é‡Š</li><li>å‡½æ•°çš„é•¿çŸ­</li><li>æ¨¡å—çš„åˆ’åˆ†</li></ul><h3 id="2-1-3-å¯æ‰©å±•æ€§-extensibility"><a href="#2-1-3-å¯æ‰©å±•æ€§-extensibility" class="headerlink" title="2.1.3 å¯æ‰©å±•æ€§  extensibility"></a>2.1.3 å¯æ‰©å±•æ€§  extensibility</h3><p>è¡¨å¾çš„æ˜¯æˆ‘ä»¬çš„ä»£ç å¯¹æœªæ¥éœ€æ±‚å˜åŒ–è¿›è¡Œåº”å¯¹çš„èƒ½åŠ›ã€‚</p><p>å³ä»£ç é¢„ç•™äº†ä¸€äº›åŠŸèƒ½çš„æ‰©å±•ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ–°åŠŸèƒ½ä»£ç ç›´æ¥æ’å…¥åˆ°æ‰©å±•ç‚¹ä¸Šï¼Œè€Œä¸éœ€è¦å› ä¸ºæ·»åŠ ä¸€ä¸ªåŠŸèƒ½è€Œå¤§åŠ¨å¹²æˆˆï¼Œæ”¹åŠ¨å¤§é‡çš„åŸå§‹ä»£ç ã€‚</p><h3 id="2-1-4-çµæ´»æ€§-flexibility"><a href="#2-1-4-çµæ´»æ€§-flexibility" class="headerlink" title="2.1.4 çµæ´»æ€§  flexibility"></a>2.1.4 çµæ´»æ€§  flexibility</h3><ul><li>æ¯”å¦‚é¢„ç•™å¥½äº†æ‰©å±•ç‚¹ç»™æ–°çš„åŠŸèƒ½ä»£ç æ¥ä½¿ç”¨</li><li>ä»£ç å·²ç»æŠ½è±¡å‡ºäº†å¾ˆå¤šåº•å±‚å¯ä»¥å¤ç”¨çš„æ¨¡å—ï¼Œç±»</li></ul><h3 id="2-1-5-ç®€æ´æ€§-simplicity"><a href="#2-1-5-ç®€æ´æ€§-simplicity" class="headerlink" title="2.1.5 ç®€æ´æ€§   simplicity"></a>2.1.5 ç®€æ´æ€§   simplicity</h3><p>Keep it simple, stupid. </p><h3 id="2-1-6-å¯å¤ç”¨æ€§-reusability"><a href="#2-1-6-å¯å¤ç”¨æ€§-reusability" class="headerlink" title="2.1.6 å¯å¤ç”¨æ€§  reusability"></a>2.1.6 å¯å¤ç”¨æ€§  reusability</h3><p>å°½é‡å‡å°‘é‡å¤ä»£ç çš„ç¼–å†™ï¼Œå¤ç”¨å·²æœ‰çš„ä»£ç </p><h3 id="2-1-7-å¯æµ‹è¯•æ€§-testability"><a href="#2-1-7-å¯æµ‹è¯•æ€§-testability" class="headerlink" title="2.1.7 å¯æµ‹è¯•æ€§  testability"></a>2.1.7 å¯æµ‹è¯•æ€§  testability</h3><p>æ¯”è¾ƒéš¾å†™çš„å•å…ƒæµ‹è¯•å¾€å¾€æ„å‘³ç€ä»£ç çš„è®¾è®¡æ˜¯æœ‰é—®é¢˜çš„ã€‚</p><p>å¦‚æœè¯´ä¸Šé¢çš„ç»†èŠ‚å®åœ¨æ˜¯å¤ªå¤šï¼Œå¹¶ä¸èƒ½ä¸€ä¸‹å­å¾ˆå¿«çš„æŒæ¡ï¼Œä¸ªäººæ„Ÿè§‰ï¼Œå»çœ‹åˆ«äººçš„è®¾è®¡ï¼Œåˆ«äººçš„ä»£ç ï¼Œå’Œè‡ªå·±çš„æ¯”è¾ƒï¼Œä¼šæ˜¯éå¸¸å¿«çš„æˆé•¿æ–¹å¼ã€‚é™¤æ­¤ä»¥å¤–ï¼Œè‚¯å®šè¿˜æ˜¯è¦ç»è¿‡çœ‹å±±æ˜¯å±±ï¼Œä¸æ˜¯å±±ï¼Œè¿˜æ˜¯å±±çš„é˜¶æ®µçš„ã€‚å¸Œæœ›è‡ªå·±çš„ä»£ç æœ€ç»ˆèƒ½åƒä¸€ä¸ªæ•…äº‹ä¸€æ ·ï¼Œå°†ä¸€æ®µé€»è¾‘è®²è¿°å®Œæ•´ã€‚</p><h1 id="3-è®¾è®¡æ¨¡å¼"><a href="#3-è®¾è®¡æ¨¡å¼" class="headerlink" title="3. è®¾è®¡æ¨¡å¼"></a>3. è®¾è®¡æ¨¡å¼</h1><blockquote><p>è®¾è®¡æ¨¡å¼(Design Pattern)æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£å¹¶ä¸”ä¿è¯ä»£ç å¯é æ€§ã€‚</p></blockquote><p>æ•´ä¸ªè®¾è®¡æ¨¡å¼ç³»åˆ—å°†ä¼šåˆ†ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><p>æ¦‚è¿°</p></li><li><p>é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</p><ul><li>å•ä¸€èŒè´£</li><li>å¼€é—­åŸåˆ™</li><li>é‡Œæ°ä»£æ¢</li><li>ä¾èµ–å€’è½¬</li><li>æ¥å£éš”ç¦»</li><li>åˆæˆå¤ç”¨</li><li>è¿ªç±³ç‰¹</li></ul></li><li><p>åˆ›å»ºå‹æ¨¡å¼ï¼ˆæè¿°å¦‚ä½•åˆ›å»ºå¯¹è±¡ï¼‰</p><ul><li>ç®€å•å·¥å‚æ¨¡å¼</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼</li><li>å•ä¾‹æ¨¡å¼</li><li>åŸå‹æ¨¡å¼</li><li>å»ºé€ è€…æ¨¡å¼</li></ul></li><li><p>ç»“æ„å‹æ¨¡å¼ï¼ˆå¦‚ä½•å®ç°ç±»æˆ–å¯¹è±¡çš„ç»„åˆï¼‰</p><ul><li>é€‚é…å™¨æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>ç»„åˆæ¨¡å¼</li><li>è£…é¥°æ¨¡å¼</li><li>å¤–è§‚æ¨¡å¼</li><li>äº«å…ƒæ¨¡å¼</li><li>ä»£ç†æ¨¡å¼</li></ul></li><li><p>è¡Œä¸ºå‹æ¨¡å¼ï¼ˆç±»æˆ–è€…å¯¹è±¡æ€æ ·äº¤äº’ä»¥åŠæ€æ ·åˆ†é…èŒè´£ï¼‰ï¼ˆç±»æ˜¯å¯¹ä¸€ç±»äº‹ç‰©çš„æè¿°ï¼ŒæŠ½è±¡å‡ºæ¥çš„ï¼›è€Œå¯¹è±¡æ˜¯å…·ä½“çš„æè¿°ã€‚ç±»æ˜¯ä¸€ç¾¤å…·æœ‰ç›¸åŒå±æ€§çš„å¯¹è±¡çš„é›†åˆä½“ï¼‰</p><ul><li>èŒè´£é“¾æ¨¡å¼</li><li>å‘½ä»¤æ¨¡å¼</li><li>è§£é‡Šå™¨æ¨¡å¼</li><li>è¿­ä»£å™¨æ¨¡å¼</li><li>ä¸­ä»‹è€…æ¨¡å¼</li><li>å¤‡å¿˜å½•æ¨¡å¼</li><li>è§‚å¯Ÿè€…æ¨¡å¼</li><li>çŠ¶æ€æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li><li>è®¿é—®è€…æ¨¡å¼</li></ul></li></ol><h1 id="4-é¢å‘å¯¹è±¡ï¼Œè®¾è®¡åŸåˆ™ï¼Œè®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹è§„èŒƒï¼Œä»£ç é‡æ„"><a href="#4-é¢å‘å¯¹è±¡ï¼Œè®¾è®¡åŸåˆ™ï¼Œè®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹è§„èŒƒï¼Œä»£ç é‡æ„" class="headerlink" title="4. é¢å‘å¯¹è±¡ï¼Œè®¾è®¡åŸåˆ™ï¼Œè®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹è§„èŒƒï¼Œä»£ç é‡æ„"></a>4. é¢å‘å¯¹è±¡ï¼Œè®¾è®¡åŸåˆ™ï¼Œè®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹è§„èŒƒï¼Œä»£ç é‡æ„</h1><h2 id="4-1-é¢å‘å¯¹è±¡"><a href="#4-1-é¢å‘å¯¹è±¡" class="headerlink" title="4.1 é¢å‘å¯¹è±¡"></a>4.1 é¢å‘å¯¹è±¡</h2><p>ä¸»æµçš„ç¼–ç¨‹èŒƒå¼æœ‰ï¼š</p><ul><li>é¢å‘è¿‡ç¨‹</li><li>é¢å‘å¯¹è±¡</li><li>å‡½æ•°å¼ç¼–ç¨‹</li></ul><p>é¢å‘å¯¹è±¡å› ä¸ºå…¶å…·æœ‰çš„ä¸°å¯Œçš„ç‰¹æ€§ - å°è£…ï¼Œç»§æ‰¿ï¼ŒæŠ½è±¡ï¼Œå¤šæ€ã€‚å¯ä»¥å®ç°å¾ˆå¤šå¤æ‚çš„è®¾è®¡æ€è·¯ï¼Œæ˜¯å¾ˆå¤šè®¾è®¡åŸåˆ™ï¼Œè®¾è®¡æ¨¡å¼çš„å®ç°åŸºç¡€ã€‚</p><ul><li>çŸ¥è¯†ç‚¹<ul><li>å°è£… ç»§æ‰¿ æŠ½è±¡ å¤šæ€</li><li>é¢å‘å¯¹è±¡ä¸é¢å‘è¿‡ç¨‹ç¼–ç¨‹çš„åŒºåˆ«ä¸è”ç³»</li><li>é¢å‘å¯¹è±¡çš„åˆ†æè®¾è®¡å’Œç¼–ç¨‹</li><li>æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«ä»¥åŠå„è‡ªçš„åº”ç”¨åœºæ™¯</li><li>åŸºäºæ¥å£è€Œéå®ç°çš„ç¼–ç¨‹è®¾è®¡æ€æƒ³</li><li>å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿çš„è®¾è®¡æ€æƒ³</li><li>é¢å‘è¿‡ç¨‹çš„è´«è¡€æ¨¡å‹å’Œé¢å‘å¯¹è±¡çš„å……è¡€æ¨¡å‹<h2 id="4-2-è®¾è®¡åŸåˆ™"><a href="#4-2-è®¾è®¡åŸåˆ™" class="headerlink" title="4.2 è®¾è®¡åŸåˆ™"></a>4.2 è®¾è®¡åŸåˆ™</h2></li></ul></li><li>è®¾è®¡åŸåˆ™<ul><li>å•ä¸€èŒè´£åŸåˆ™</li><li>å¼€é—­åŸåˆ™</li><li>é‡Œæ°æ›¿æ¢åŸåˆ™</li><li>æ¥å£éš”ç¦»åŸåˆ™</li><li>ä¾èµ–å¯¼è‡´åŸåˆ™</li><li>DRY</li><li>KISS</li><li>YAGNI</li><li>LOD</li></ul></li></ul><h2 id="4-3-è®¾è®¡æ¨¡å¼"><a href="#4-3-è®¾è®¡æ¨¡å¼" class="headerlink" title="4.3 è®¾è®¡æ¨¡å¼"></a>4.3 è®¾è®¡æ¨¡å¼</h2><ul><li>è®¾è®¡æ¨¡å¼<ul><li>ä¸ºäº†è§£å†³ä»£ç çš„å¯æ‰©å±•æ€§é—®é¢˜</li><li>éœ€è¦æŒæ¡ä»–ä»¬éƒ½è§£å†³äº†å“ªäº›é—®é¢˜ï¼Œå…¸å‹çš„åº”ç”¨åœºæ™¯ï¼Œå¹¶ä¸”ä¸èƒ½ä¹Ÿä¸åº”è¯¥è¿‡åº¦ä½¿ç”¨</li><li>åˆ›å»ºå‹<ul><li>å•ä¾‹æ¨¡å¼</li><li>å·¥å‚æ¨¡å¼</li><li>å»ºé€ è€…æ¨¡å¼</li></ul></li><li>ç»“æ„å‹<ul><li>ä»£ç†æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>è£…é¥°è€…æ¨¡å¼</li><li>é€‚é…å™¨æ¨¡å¼</li></ul></li><li>è¡Œä¸ºå‹<ul><li>è§‚å¯Ÿè€…æ¨¡å¼</li><li>æ¨¡æ¿æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>èŒè´£é“¾æ¨¡å¼</li><li>è¿­ä»£å™¨æ¨¡å¼</li><li>çŠ¶æ€æ¨¡å¼</li></ul></li></ul></li></ul><h2 id="4-4-ç¼–ç¨‹è§„èŒƒ"><a href="#4-4-ç¼–ç¨‹è§„èŒƒ" class="headerlink" title="4.4 ç¼–ç¨‹è§„èŒƒ"></a>4.4 ç¼–ç¨‹è§„èŒƒ</h2><p>ä¸»è¦ä¸ºäº†è§£å†³ä»£ç çš„å¯è¯»æ€§é—®é¢˜ï¼Œè¿™äº›è§„èŒƒä¸»è¦æ˜¯è®°å¿†ï¼Œç†Ÿæ‚‰ï¼Œç„¶åå°½é‡å¤šçš„å»ä½¿ç”¨ã€‚ä¹¦ç±çš„è¯å¯ä»¥å»çœ‹é‡æ„ï¼Œä»£ç å¤§å…¨ï¼Œä»£ç æ•´æ´ä¹‹é“è¿™å‡ æœ¬ä¹¦ã€‚</p><h2 id="4-5-ä»£ç é‡æ„"><a href="#4-5-ä»£ç é‡æ„" class="headerlink" title="4.5 ä»£ç é‡æ„"></a>4.5 ä»£ç é‡æ„</h2><p>ä¸šåŠ¡å‘å±•ï¼Œè§„æ¨¡æ‰©å¤§ï¼ŒåŸå…ˆçš„è®¾è®¡å¾ˆå¯èƒ½æ— æ³•æ”¯æŒç°åœ¨çš„ä½“é‡çš„åº”ç”¨åœºæ™¯ï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æŒç»­é‡æ„äº†ã€‚è€Œæ˜¯ç”¨çš„å·¥å…·å°±æ˜¯æˆ‘ä»¬å‰é¢è¯´çš„è®¾è®¡æ¨¡å¼ï¼Œç¼–ç¨‹è§„èŒƒç­‰ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerMock with EasyMock toturial</title>
      <link href="/Powermock-with-EasyMock-toturial/"/>
      <url>/Powermock-with-EasyMock-toturial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro-with-an-example"><a href="#1-Intro-with-an-example" class="headerlink" title="1. Intro with an example"></a>1. Intro with an example</h1><p>We often find we need to do unit tests for final class, static method, which are not supported by Easymock, Mockito currently. Under such situation, we could use Powermock to help us mock the corresponding classes. </p><p>For detail introduction about powermock, refer to <a href="https://github.com/powermock/powermock" target="_blank" rel="noopener">PowerMock Github</a></p><p>Use example as followed to show how to integrate PowerMock with EasyMock: </p><pre><code>public final class FinalClassExample {    public String static doNothingStatic() {        return &quot;test&quot;;    }}@PowerMockIgnore(&quot;javax.management.*&quot;) // only need when see warning related with jmx or mbeans@RunWith(PowerMockRunner.class)  // necessary for powermock @PrepareForTest(FinalClassExample.class)  // necessary for powermock public class FinalClassExampleTest {    private IMocksControl control;    @Before    public void init() {        // do some initialization here         control = EasyMock.createControl();    }    @Test    public void test_example() {        PowerMock.mockStatic(FinalClassExample.class);        expect(FinalClassExample.doNothingStatic()).andReturn(&quot;test&quot;);        PowerMock.replay(FinalClassExample.class);        runYourTest();        PowerMock.verify(FinalClassExample.class);        // do some assertions here    }}</code></pre><h1 id="2-Other-APIs"><a href="#2-Other-APIs" class="headerlink" title="2. Other APIs"></a>2. Other APIs</h1><ul><li>mock final classes or methods <ul><li><code>@RunWith(PowerMockRunner.class)</code></li><li><code>@PrepareForTest(ClassWithFinal.class)</code></li><li><code>PowerMock.createMock(ClassWithFinal.class);</code></li><li><code>PowerMock.replay(mockObject)</code></li><li><code>PowerMock.verify(mockObject)</code></li></ul></li><li>mock private methods <ul><li><code>@RunWith(PowerMockRunner.class)</code></li><li><code>@PrepareForTest(ClassWithPrivateMethod.class)</code></li><li><code>PowerMock.createPartialMock(ClassWithPrivateMethod.class, &quot;nameOfTheMethodToMock&quot;)</code></li><li>Use <code>PowerMock.expectPrivate(mockObject, &quot;nameOfTheMethodToMock&quot;, argument1, argument2)</code> to expect the method call to <code>nameOfTheMethodToMock</code> with arguments <code>argument1</code> and <code>argument2</code></li><li><code>PowerMock.replay(mockObject)</code></li><li><code>PowerMock.verify(mockObject)</code></li></ul></li><li>mock construction of new objects <ul><li><code>@RunWith(PowerMockRunner.class)</code></li><li><code>@PrepareForTest(ClassThatCreatesTheNewInstance.class)</code> </li><li><code>PowerMock.createMock(NewInstanceClass.class)</code></li><li><code>PowerMock.expectNew(NewInstanceClass.class).andReturn(mockObject)</code></li><li><code>PowerMock.replay(mockObject, NewInstanceClass.class)</code></li><li><code>PowerMock.verify(mockObject, NewInstanceClass.class)</code></li></ul></li><li>mock partial <ul><li><code>@RunWith(PowerMockRunner.class)</code></li><li><code>@PrepareForTest(ClassToPartiallyMock.class)</code></li><li><code>PowerMock.createPartialMock(ClassToPartiallyMock.class, &quot;nameOfTheFirstMethodToMock&quot;, &quot;nameOfTheSecondMethodToMock&quot;)</code></li><li><code>PowerMock.replay(mockObject)</code></li><li><code>PowerMock.verify(mockObject)</code></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://github.com/powermock/powermock" target="_blank" rel="noopener">https://github.com/powermock/powermock</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Unit Test </tag>
            
            <tag> PowerMock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ç¨‹å¸ˆéœ€è¦çŸ¥é“çš„latency æ•°å­— </title>
      <link href="/%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84latency-%E6%95%B0%E5%AD%97/"/>
      <url>/%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84latency-%E6%95%B0%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<p>çœ‹åˆ°ä¸€ç¯‡åšå®¢ï¼Œå™è¿°äº†å½“å‰å†…å­˜å¯¹äºæ•°æ®çš„å¤„ç†é€Ÿåº¦å¯¹äºå¼€å‘çš„å½±å“ï¼Œæ¨è€Œå¹¿ä¹‹ï¼Œæ‰¾åˆ°äº†ä¸€äº›æˆ‘ä»¬åœ¨åšç³»ç»Ÿè®¾è®¡çš„æ—¶å€™éœ€è¦ç†ŸçŸ¥çš„ä¸€äº›æ•°æ®ã€‚</p><p>é¦–å…ˆå¤„ç†å™¨çš„å¤„ç†é€Ÿåº¦å’Œå†…å­˜çš„å¤„ç†é€Ÿåº¦æ˜¯å·®è·å¾ˆå¤§çš„ï¼Œå¤„ç†å™¨çš„å¤„ç†é€Ÿåº¦çš„å¢é•¿é€Ÿåº¦è¦æ¯”å†…å­˜çš„å¿«å¾ˆå¤šã€‚</p><p><img src="https://i.loli.net/2020/02/21/s8h6GTfi1PSYwpe.png" alt="å¤„ç†å™¨ä¸å†…å­˜çš„æ€§èƒ½è¡¨ç°.png"></p><p>æˆ‘ä»¬éœ€è¦æ¢ç©¶çš„æ˜¯CPUä»å†…å­˜ä¸­éšæœºæå–æ•°æ®ä»¥åŠè·å–è¿ç»­æ•°æ®çš„é€Ÿåº¦ï¼Œè¿™æ˜¯å¾ˆç²—ç•¥çš„ä¼°è®¡ï¼Œåªæ˜¯å¸Œæœ›èƒ½å¤Ÿæœ‰ä¸€ä¸ªæ•°é‡çº§ä¸Šçš„æ„ŸçŸ¥ã€‚</p><pre><code>Latency Comparison Numbers (~2012)----------------------------------L1 cache reference                           0.5 nsBranch mispredict                            5   nsL2 cache reference                           7   ns                      14x L1 cacheMutex lock/unlock                           25   nsMain memory reference                      100   ns                      20x L2 cache, 200x L1 cacheCompress 1K bytes with Zippy             3,000   ns        3 usSend 1K bytes over 1 Gbps network       10,000   ns       10 usRead 4K randomly from SSD*             150,000   ns      150 us          ~1GB/sec SSDRead 1 MB sequentially from memory     250,000   ns      250 usRound trip within same datacenter      500,000   ns      500 usRead 1 MB sequentially from SSD*     1,000,000   ns    1,000 us    1 ms  ~1GB/sec SSD, 4X memoryDisk seek                           10,000,000   ns   10,000 us   10 ms  20x datacenter roundtripRead 1 MB sequentially from disk    20,000,000   ns   20,000 us   20 ms  80x memory, 20X SSDSend packet CA-&gt;Netherlands-&gt;CA    150,000,000   ns  150,000 us  150 ms</code></pre><p>æ ¹æ®2020å¹´StackOverflowä¸Šçš„å›ç­”ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Core i7 Xeon 5500 çš„benchmarkæ•°æ®å¦‚ä¸‹</p><pre><code>Core i7 Xeon 5500 Series Data Source Latency (approximate)               [Pg. 22]local  L1 CACHE hit,                              ~4 cycles (   2.1 -  1.2 ns )local  L2 CACHE hit,                             ~10 cycles (   5.3 -  3.0 ns )local  L3 CACHE hit, line unshared               ~40 cycles (  21.4 - 12.0 ns )local  L3 CACHE hit, shared line in another core ~65 cycles (  34.8 - 19.5 ns )local  L3 CACHE hit, modified in another core    ~75 cycles (  40.2 - 22.5 ns )remote L3 CACHE (Ref: Fig.1 [Pg. 5])        ~100-300 cycles ( 160.7 - 30.0 ns )local  DRAM                                                   ~60 nsremote DRAM                                                  ~100 ns</code></pre><p>è€Œç°åœ¨çš„cacheçš„å¤§å°ï¼Œæ ¹æ®wikiChipä¸Šçš„æ•°æ®ï¼Œå¯¹äºCore i7-8700K</p><pre><code>Memory Bandwidth: 39.74 gigabytes per secondL1 cache: 192 kilobytes (32 KB per core)L2 cache: 1.5 megabytes (256 KB per core)L3 cache: 12 megabytes  (shared; 2 MB per core)</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.forrestthewoods.com/blog/memory-bandwidth-napkin-math/" target="_blank" rel="noopener">https://www.forrestthewoods.com/blog/memory-bandwidth-napkin-math/</a>?</li><li><a href="https://stackoverflow.com/questions/4087280/approximate-cost-to-access-various-caches-and-main-memory" target="_blank" rel="noopener">https://stackoverflow.com/questions/4087280/approximate-cost-to-access-various-caches-and-main-memory</a></li><li><a href="https://en.wikichip.org/wiki/intel/core_i7/i7-8700k" target="_blank" rel="noopener">https://en.wikichip.org/wiki/intel/core_i7/i7-8700k</a></li><li><a href="https://gist.github.com/jboner/2841832" target="_blank" rel="noopener">https://gist.github.com/jboner/2841832</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> latency </tag>
            
            <tag> system design </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java8 Date Time API </title>
      <link href="/Java8-Date-Time-API/"/>
      <url>/Java8-Date-Time-API/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦æ–°çš„Date-API"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦æ–°çš„Date-API" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦æ–°çš„Date API"></a>1. ä¸ºä»€ä¹ˆéœ€è¦æ–°çš„Date API</h1><p>Java8 çš„ä¸€å¤§æ›´æ–°åœ¨äºç»ˆäºå°†Date Timeä¸€è‡´åŒ–ï¼Œè¿™è§£å†³äº†åœ¨Java8ä»¥å‰æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„éå¸¸å¤šçš„é—®é¢˜ï¼š</p><p>è­¬å¦‚ï¼š</p><ul><li>Java Date Timeç±»å®šä¹‰åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œæ¯”å¦‚åœ¨java.util &amp; java.sqlé‡Œé¢éƒ½æœ‰ï¼Œè€Œæ ·å¼å’Œæ ¼å¼è½¬åŒ–çš„ç±»éƒ½å®šä¹‰åœ¨java.textçš„åŒ…é‡Œï¼Œæ¯”è¾ƒæ··ä¹±</li><li>java.util.DateåŒ…æ‹¬dateå’Œtimeç±»ï¼Œè€Œjava.sql.DateåªåŒ…å«date</li><li>å¹¶æ²¡æœ‰æ¸…æ™°å®šä¹‰çš„ç±»ç”¨äºå¤„ç†time, timestamp, formatting, parsing </li><li>æ‰€æœ‰çš„Dateç±»éƒ½æ˜¯å¯å˜çš„ï¼Œå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>Dateç±»ä¸æ”¯æŒå…¨çƒåŒ–ï¼Œæ²¡æœ‰æ—¶åŒºçš„æ”¯æŒï¼Œåœ¨java8ä¹‹å‰ï¼Œä¸ºäº†æ˜¾ç¤ºå½“åœ°æ—¶é—´ï¼Œå°±å¾—ä½¿ç”¨java.util.Calendar è¿˜æœ‰ java.util.TimeZone,æ•´ä¸ªå˜å¾—æ¯”è¾ƒéº»çƒ¦</li></ul><h1 id="2-Java8-Date-Time-API-è¯¦è§£"><a href="#2-Java8-Date-Time-API-è¯¦è§£" class="headerlink" title="2. Java8 Date Time API è¯¦è§£"></a>2. Java8 Date Time API è¯¦è§£</h1><h2 id="2-1-Packages"><a href="#2-1-Packages" class="headerlink" title="2.1 Packages"></a>2.1 Packages</h2><ul><li>java.time Package <ul><li>è¿™æ˜¯æ–°çš„Date Time APIçš„åŸºç¡€åŒ…ï¼Œä¸€äº›ä¸»è¦çš„åŸºæœ¬ç±»éƒ½åœ¨è¿™é‡Œé¢ï¼Œè­¬å¦‚LocalDate, LocalTime, LocalDateTime, Instant, Period, Duration  </li></ul></li><li>java.time.chrono <ul><li>å®šä¹‰äº†æŠ½è±¡çš„APIæ¥å£ï¼Œé’ˆå¯¹äºéISOæ ‡å‡†çš„calendar ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡extend AbstractChronologyç±»æ¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„calendarç³»ç»Ÿ</li></ul></li><li>java.time.format <ul><li>åŒ…å«ç”¨æ¥Formattingè¿˜æœ‰parsing date timeå¯¹è±¡çš„ç±»</li></ul></li><li>java.time.temporal <ul><li>åŒ…å«ä¸€äº›æ—¶é—´å¯¹è±¡ï¼Œæ¯”å¦‚æ‰¾åˆ°æœˆä»½çš„ç¬¬ä¸€å¤©ï¼Œ æœ€åä¸€å¤©ä¹‹ç±»çš„</li></ul></li><li>java.time.zone<ul><li>æ”¯æŒä¸åŒçš„æ—¶åŒº </li></ul></li></ul><h2 id="2-2-LocalDate"><a href="#2-2-LocalDate" class="headerlink" title="2.2 LocalDate"></a>2.2 LocalDate</h2><ul><li>Immutable class </li><li>é»˜è®¤æ ·å¼ä¸º yyyy-MM-dd</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>now()</code>æ–¹æ³•æ¥è·å¾—å½“å‰çš„æ—¥æœŸ</li><li>ä¹Ÿå¯ä»¥é€šè¿‡æä¾›å¹´æœˆæ—¥æ¥åˆ›å»ºlocalDateå¯¹è±¡</li><li>æˆ‘ä»¬åŒæ—¶ä¹Ÿå¯ä»¥ä¼ å…¥ZoneIdæ¥å¾—åˆ°åœ¨ç‰¹å®šçš„æ—¶åŒºçš„æ—¥æœŸ</li></ul><pre><code>package com.journaldev.java8.time;import java.time.LocalDate;import java.time.Month;import java.time.ZoneId;/** * LocalDate Examples * @author pankaj * */public class LocalDateExample {    public static void main(String[] args) {        //Current Date        LocalDate today = LocalDate.now();        System.out.println(&quot;Current Date=&quot;+today);        //Creating LocalDate by providing input arguments        LocalDate firstDay_2014 = LocalDate.of(2014, Month.JANUARY, 1);        System.out.println(&quot;Specific Date=&quot;+firstDay_2014);        //Try creating date by providing invalid inputs        //LocalDate feb29_2014 = LocalDate.of(2014, Month.FEBRUARY, 29);        //Exception in thread &quot;main&quot; java.time.DateTimeException:         //Invalid date &#39;February 29&#39; as &#39;2014&#39; is not a leap year        //Current date in &quot;Asia/Kolkata&quot;, you can get it from ZoneId javadoc        LocalDate todayKolkata = LocalDate.now(ZoneId.of(&quot;Asia/Kolkata&quot;));        System.out.println(&quot;Current Date in IST=&quot;+todayKolkata);        //java.time.zone.ZoneRulesException: Unknown time-zone ID: IST        //LocalDate todayIST = LocalDate.now(ZoneId.of(&quot;IST&quot;));        //Getting date from the base date i.e 01/01/1970        LocalDate dateFromBase = LocalDate.ofEpochDay(365);        System.out.println(&quot;365th day from base date= &quot;+dateFromBase);        LocalDate hundredDay2014 = LocalDate.ofYearDay(2014, 100);        System.out.println(&quot;100th day of 2014=&quot;+hundredDay2014);    }}// output Current Date=2014-04-28Specific Date=2014-01-01Current Date in IST=2014-04-29365th day from base date= 1971-01-01100th day of 2014=2014-04-10</code></pre><h2 id="2-3-LocalTime"><a href="#2-3-LocalTime" class="headerlink" title="2.3 LocalTime"></a>2.3 LocalTime</h2><ul><li>Immutable Class </li><li>è¡¨ç¤ºä¸€ä¸ªå¯è¯»çš„æ—¶é—´ (vs Instant åŸºæœ¬ä¸å¯è¯»)</li><li>é»˜è®¤æ ·å¼ä¸º hh:mm:ss:zz</li><li>å’ŒLocalDateåŸºæœ¬ä¸€è‡´çš„ç”¨æ³•ï¼Œå¯ä»¥ä¼ å…¥å‚æ•°ç”Ÿæˆå®ä¾‹ï¼Œæ”¯æŒæ—¶åŒº</li></ul><pre><code>package com.journaldev.java8.time;import java.time.LocalTime;import java.time.ZoneId;/** * LocalTime Examples * @author pankaj * */public class LocalTimeExample {    public static void main(String[] args) {        //Current Time        LocalTime time = LocalTime.now();        System.out.println(&quot;Current Time=&quot;+time);        //Creating LocalTime by providing input arguments        LocalTime specificTime = LocalTime.of(12,20,25,40);        System.out.println(&quot;Specific Time of Day=&quot;+specificTime);        //Try creating time by providing invalid inputs        //LocalTime invalidTime = LocalTime.of(25,20);        //Exception in thread &quot;main&quot; java.time.DateTimeException:         //Invalid value for HourOfDay (valid values 0 - 23): 25        //Current date in &quot;Asia/Kolkata&quot;, you can get it from ZoneId javadoc        LocalTime timeKolkata = LocalTime.now(ZoneId.of(&quot;Asia/Kolkata&quot;));        System.out.println(&quot;Current Time in IST=&quot;+timeKolkata);        //java.time.zone.ZoneRulesException: Unknown time-zone ID: IST        //LocalTime todayIST = LocalTime.now(ZoneId.of(&quot;IST&quot;));        //Getting date from the base date i.e 01/01/1970        LocalTime specificSecondTime = LocalTime.ofSecondOfDay(10000);        System.out.println(&quot;10000th second time= &quot;+specificSecondTime);    }}// Output Current Time=15:51:45.240Specific Time of Day=12:20:25.000000040Current Time in IST=04:21:45.27610000th second time= 02:46:40</code></pre><h2 id="2-4-LocalDateTime"><a href="#2-4-LocalDateTime" class="headerlink" title="2.4 LocalDateTime"></a>2.4 LocalDateTime</h2><ul><li>Immutable date-time object </li><li>represent both date and time </li><li>default format at yyyy-MM-dd-HH-mm-ss.zzz </li><li>ç”¨å·¥å‚æ–¹æ³•æ¥æ‹¿åˆ°LocalDateå’ŒLocalTimeçš„input ç„¶åæ¥åˆ›å»ºLocalDateTimeçš„å®ä¾‹</li></ul><pre><code>package com.journaldev.java8.time;import java.time.LocalDate;import java.time.LocalDateTime;import java.time.LocalTime;import java.time.Month;import java.time.ZoneId;import java.time.ZoneOffset;public class LocalDateTimeExample {    public static void main(String[] args) {        //Current Date        LocalDateTime today = LocalDateTime.now();        System.out.println(&quot;Current DateTime=&quot;+today);        //Current Date using LocalDate and LocalTime        today = LocalDateTime.of(LocalDate.now(), LocalTime.now());        System.out.println(&quot;Current DateTime=&quot;+today);        //Creating LocalDateTime by providing input arguments        LocalDateTime specificDate = LocalDateTime.of(2014, Month.JANUARY, 1, 10, 10, 30);        System.out.println(&quot;Specific Date=&quot;+specificDate);        //Try creating date by providing invalid inputs        //LocalDateTime feb29_2014 = LocalDateTime.of(2014, Month.FEBRUARY, 28, 25,1,1);        //Exception in thread &quot;main&quot; java.time.DateTimeException:         //Invalid value for HourOfDay (valid values 0 - 23): 25        //Current date in &quot;Asia/Kolkata&quot;, you can get it from ZoneId javadoc        LocalDateTime todayKolkata = LocalDateTime.now(ZoneId.of(&quot;Asia/Kolkata&quot;));        System.out.println(&quot;Current Date in IST=&quot;+todayKolkata);        //java.time.zone.ZoneRulesException: Unknown time-zone ID: IST        //LocalDateTime todayIST = LocalDateTime.now(ZoneId.of(&quot;IST&quot;));        //Getting date from the base date i.e 01/01/1970        LocalDateTime dateFromBase = LocalDateTime.ofEpochSecond(10000, 0, ZoneOffset.UTC);        System.out.println(&quot;10000th second time from 01/01/1970= &quot;+dateFromBase);    }}// OutputCurrent DateTime=2014-04-28T16:00:49.455Current DateTime=2014-04-28T16:00:49.493Specific Date=2014-01-01T10:10:30Current Date in IST=2014-04-29T04:30:49.49310000th second time from 01/01/1970= 1970-01-01T02:46:40</code></pre><h2 id="2-5-Instant"><a href="#2-5-Instant" class="headerlink" title="2.5 Instant"></a>2.5 Instant</h2><p>æ˜¯ä¸ºäº†ç”Ÿæˆæœºå™¨é˜…è¯»çš„æ—¶é—´æ ¼å¼ï¼Œå®ƒä¼šä½¿ç”¨unixçš„æ—¶é—´æˆ³æ¥å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´</p><pre><code>package com.journaldev.java8.time;import java.time.Duration;import java.time.Instant;public class InstantExample {    public static void main(String[] args) {        //Current timestamp        Instant timestamp = Instant.now();        System.out.println(&quot;Current Timestamp = &quot;+timestamp);        //Instant from timestamp        Instant specificTime = Instant.ofEpochMilli(timestamp.toEpochMilli());        System.out.println(&quot;Specific Time = &quot;+specificTime);        //Duration example        Duration thirtyDay = Duration.ofDays(30);        System.out.println(thirtyDay);    }}// Output Current Timestamp = 2014-04-28T23:20:08.489ZSpecific Time = 2014-04-28T23:20:08.489ZPT720H</code></pre><h2 id="2-6-å¸¸ç”¨API"><a href="#2-6-å¸¸ç”¨API" class="headerlink" title="2.6 å¸¸ç”¨API"></a>2.6 å¸¸ç”¨API</h2><pre><code>package com.journaldev.java8.time;import java.time.LocalDate;import java.time.LocalTime;import java.time.Period;import java.time.temporal.TemporalAdjusters;public class DateAPIUtilities {    public static void main(String[] args) {        LocalDate today = LocalDate.now();        //å¾—åˆ°å¹´ä»½ï¼Œçœ‹æ˜¯å¦ä¸ºé—°å¹´        System.out.println(&quot;Year &quot;+today.getYear()+&quot; is Leap Year? &quot;+today.isLeapYear());        //æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´çš„å…ˆå        System.out.println(&quot;Today is before 01/01/2015? &quot;+today.isBefore(LocalDate.of(2015,1,1)));        //ä»LocalDateåˆ›å»ºLocalDateTime        System.out.println(&quot;Current Time=&quot;+today.atTime(LocalTime.now()));        //åŠ å‡æ—¶é—´çš„æ“ä½œ        System.out.println(&quot;10 days after today will be &quot;+today.plusDays(10));        System.out.println(&quot;3 weeks after today will be &quot;+today.plusWeeks(3));        System.out.println(&quot;20 months after today will be &quot;+today.plusMonths(20));        System.out.println(&quot;10 days before today will be &quot;+today.minusDays(10));        System.out.println(&quot;3 weeks before today will be &quot;+today.minusWeeks(3));        System.out.println(&quot;20 months before today will be &quot;+today.minusMonths(20));        //æ—¶é—´ä¸Šçš„åŠ å‡        System.out.println(&quot;First date of this month= &quot;+today.with(TemporalAdjusters.firstDayOfMonth()));        LocalDate lastDayOfYear = today.with(TemporalAdjusters.lastDayOfYear());        System.out.println(&quot;Last date of this year= &quot;+lastDayOfYear);        Period period = today.until(lastDayOfYear);        System.out.println(&quot;Period Format= &quot;+period);        System.out.println(&quot;Months remaining in the year= &quot;+period.getMonths());            }}Year 2014 is Leap Year? falseToday is before 01/01/2015? trueCurrent Time=2014-04-28T16:23:53.15410 days after today will be 2014-05-083 weeks after today will be 2014-05-1920 months after today will be 2015-12-2810 days before today will be 2014-04-183 weeks before today will be 2014-04-0720 months before today will be 2012-08-28First date of this month= 2014-04-01Last date of this year= 2014-12-31Period Format= P8M3DMonths remaining in the year= 8</code></pre><h2 id="2-7-æ—¶é—´çš„Parsing-å’Œ-Formatting"><a href="#2-7-æ—¶é—´çš„Parsing-å’Œ-Formatting" class="headerlink" title="2.7 æ—¶é—´çš„Parsing å’Œ Formatting"></a>2.7 æ—¶é—´çš„Parsing å’Œ Formatting</h2><pre><code>package com.journaldev.java8.time;import java.time.Instant;import java.time.LocalDate;import java.time.LocalDateTime;import java.time.format.DateTimeFormatter;public class DateParseFormatExample {    public static void main(String[] args) {        //Format examples        LocalDate date = LocalDate.now();        //default format        System.out.println(&quot;Default format of LocalDate=&quot;+date);        //ä½¿ç”¨ç‰¹å®šçš„Formatter        System.out.println(date.format(DateTimeFormatter.ofPattern(&quot;d::MMM::uuuu&quot;)));        System.out.println(date.format(DateTimeFormatter.BASIC_ISO_DATE));        LocalDateTime dateTime = LocalDateTime.now();        //default format        System.out.println(&quot;Default format of LocalDateTime=&quot;+dateTime);        //specific format        System.out.println(dateTime.format(DateTimeFormatter.ofPattern(&quot;d::MMM::uuuu HH::mm::ss&quot;)));        System.out.println(dateTime.format(DateTimeFormatter.BASIC_ISO_DATE));        Instant timestamp = Instant.now();        //default format        System.out.println(&quot;Default format of Instant=&quot;+timestamp);        //Parse examples        LocalDateTime dt = LocalDateTime.parse(&quot;27::Apr::2014 21::39::48&quot;,                DateTimeFormatter.ofPattern(&quot;d::MMM::uuuu HH::mm::ss&quot;));        System.out.println(&quot;Default format after parsing = &quot;+dt);    }}// OutputDefault format of LocalDate=2014-04-2828::Apr::201420140428Default format of LocalDateTime=2014-04-28T16:25:49.34128::Apr::2014 16::25::4920140428Default format of Instant=2014-04-28T23:25:49.342ZDefault format after parsing = 2014-04-27T21:39:48</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.journaldev.com/2800/java-8-date-localdate-localdatetime-instant" target="_blank" rel="noopener">https://www.journaldev.com/2800/java-8-date-localdate-localdatetime-instant</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(17)-çº¢é»‘æ ‘</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-17-%E7%BA%A2%E9%BB%91%E6%A0%91/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-17-%E7%BA%A2%E9%BB%91%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¢é»‘æ ‘çš„å®ç°"><a href="#çº¢é»‘æ ‘çš„å®ç°" class="headerlink" title="çº¢é»‘æ ‘çš„å®ç°"></a>çº¢é»‘æ ‘çš„å®ç°</h1><p>é¦–å…ˆå¯¹äºæˆ‘ä»¬å‰é¢çœ‹åˆ°çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œåœ¨ç›¸å¯¹ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå®ƒçš„æ—¶é—´è´Ÿè´£åº¦ä¸ºO(logn).ä½†æ˜¯åœ¨é¢‘ç¹çš„åŠ¨æ€æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°æ ‘çš„é«˜åº¦è¿œè¿œå¤§äºlog2(n)çš„æƒ…å†µï¼Œå¯¼è‡´å„é¡¹æ“ä½œçš„æ•ˆç‡ä¸‹é™.</p><p>åœ¨æç«¯æƒ…å†µä¸‹ï¼ŒäºŒå‰æŸ¥æ‰¾æ ‘ä¼šé€€åŒ–ä¸ºä¸€ä¸ªé“¾è¡¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šé€€åŒ–åˆ°O(n).ä¸ºäº†è§£å†³è¿™ä¸ªå¤æ‚åº¦é€€åŒ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ç§å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘</p><h1 id="1-ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Ÿ</h1><blockquote><p>å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘å®šä¹‰ äºŒå‰æ ‘ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦ç›¸å·®ä¸èƒ½å¤§äº1.</p></blockquote><p>å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘çš„åˆè¡·æ˜¯è§£å†³æ™®é€šäºŒå‰æŸ¥æ‰¾æ ‘åœ¨é¢‘ç¹çš„æ’å…¥ï¼Œå‡ºç°æ—¶é—´å¤æ‚åº¦é€€åŒ–çš„é—®é¢˜</p><p>çº¢é»‘æ ‘å¹¶æ²¡æœ‰ä¸¥æ ¼æ»¡è¶³å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘çš„å®šä¹‰ï¼Œå³å…¶å·¦å³å­æ ‘çš„é«˜åº¦æœ‰æ—¶ç›¸å·®æ˜¯ä¼šè¶…è¿‡1 çš„ã€‚ </p><p>å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ä¸­å¹³è¡¡çš„æ„æ€å°±æ˜¯è®©æ•´æ£µæ ‘çœ‹èµ·æ¥æ¯”è¾ƒå¯¹ç§°ï¼Œä¸è¦å‡ºç°å·¦å­æ ‘å¾ˆé«˜ï¼Œå³å­æ ‘å¾ˆçŸ®çš„æƒ…å†µã€‚è¿™æ ·å°±èƒ½è®©æ•´æ£µæ ‘çš„é«˜åº¦ç›¸å¯¹æ¥è¯´ä½ä¸€äº›ã€‚</p><ul><li>æœ€å¼€å§‹è¢«å‘æ˜çš„æ˜¯AVLæ ‘ï¼Œä¸¥æ ¼ç¬¦åˆå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘çš„å®šä¹‰<ul><li>ä»»ä½•èŠ‚ç‚¹çš„å·¦å³å­æ ‘é«˜åº¦ç›¸å·®ä¸è¶…è¿‡1</li><li>æ˜¯ä¸€ç§é«˜åº¦å¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘</li></ul></li></ul><h1 id="2-å¦‚ä½•å®šä¹‰ä¸€æ£µçº¢é»‘æ ‘-Red-Black-Tree"><a href="#2-å¦‚ä½•å®šä¹‰ä¸€æ£µçº¢é»‘æ ‘-Red-Black-Tree" class="headerlink" title="2. å¦‚ä½•å®šä¹‰ä¸€æ£µçº¢é»‘æ ‘ Red Black Tree"></a>2. å¦‚ä½•å®šä¹‰ä¸€æ£µçº¢é»‘æ ‘ Red Black Tree</h1><p>æ˜¯ä¸€ç§ä¸ä¸¥æ ¼çš„å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚çº¢é»‘æ ‘å½“ä¸­çš„èŠ‚ç‚¹ï¼Œä¸€ç±»è¢«æ ‡è®°ä¸ºé»‘è‰²ï¼Œä¸€ç±»è¢«æ ‡è®°ä¸ºçº¢è‰²ã€‚</p><ul><li>æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²çš„</li><li>æ¯ä¸ªå¶å­èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²çš„ç©ºèŠ‚ç‚¹(NIL)ï¼Œå³å¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®</li><li>ä»»ä½•ç›¸é‚»çš„èŠ‚ç‚¹éƒ½ä¸èƒ½åŒæ—¶ä¸ºçº¢è‰²ï¼Œå³çº¢è‰²èŠ‚ç‚¹æ˜¯è¢«é»‘è‰²èŠ‚ç‚¹åˆ†å‰²å¼€çš„</li><li>æ¯ä¸ªèŠ‚ç‚¹ï¼Œä»è¯¥èŠ‚ç‚¹åˆ°è¾¾å…¶å¯è¾¾å¶å­èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„ï¼Œéƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹</li></ul><p>äºŒå‰æŸ¥æ‰¾æ ‘çš„å¾ˆå¤šæ“ä½œçš„æ€§èƒ½éƒ½è·Ÿæ ‘çš„é«˜åº¦æˆæ­£æ¯”ï¼Œå› æ­¤ä¸ºäº†è¯æ˜çº¢é»‘æ ‘è¿‘ä¼¼å¹³è¡¡ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æçš„é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºå…¶é«˜åº¦æ˜¯å¦èƒ½æ¯”è¾ƒç¨³å®šçš„è¶‹è¿‘log2(n)ã€‚çº¢é»‘æ ‘çš„æ’å…¥ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾ç­‰å„ç§æ“ä½œæ€§èƒ½éƒ½æ¯”è¾ƒç¨³å®š</p><p>AVLæ˜¯é«˜åº¦å¹³è¡¡çš„äºŒå‰æ ‘ï¼ŒæŸ¥æ‰¾æ•ˆç‡éå¸¸é«˜ï¼Œä½†æ˜¯æ¯æ¬¡æ’å…¥åˆ é™¤éƒ½è¦å¯¹åº”åšè°ƒæ•´ï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒå¤æ‚è€—æ—¶ã€‚çº¢é»‘æ ‘åªæ˜¯åšåˆ°è¿‘ä¼¼å¹³è¡¡ï¼Œåœ¨ç»´æŠ¤å¹³è¡¡çš„æˆæœ¬ä¸Šï¼Œè¦æ¯”AVLè¦ä½ã€‚</p><h1 id="3-å¦‚ä½•å®ç°ä¸€ä¸ªçº¢é»‘æ ‘"><a href="#3-å¦‚ä½•å®ç°ä¸€ä¸ªçº¢é»‘æ ‘" class="headerlink" title="3. å¦‚ä½•å®ç°ä¸€ä¸ªçº¢é»‘æ ‘"></a>3. å¦‚ä½•å®ç°ä¸€ä¸ªçº¢é»‘æ ‘</h1><p>çº¢é»‘æ ‘çš„å¹³è¡¡è¿‡ç¨‹å°±æ˜¯<strong>æ ¹æ®èŠ‚ç‚¹æ’å¸ƒçš„ç‰¹å¾æ¥ï¼Œé‡åˆ°ä»€ä¹ˆæ ·çš„èŠ‚ç‚¹æ’å¸ƒï¼Œæˆ‘ä»¬å°±å¯¹åº”çš„å»è¿›è¡Œè°ƒæ•´</strong>ã€‚</p><ul><li>é‡è¦æ“ä½œ<ul><li>å·¦æ—‹ rotate left<ul><li>å°†åŸºå‡†ç‚¹çš„å³å­æ ‘ç»•xåšé€†æ—¶é’ˆæ—‹è½¬ï¼Œæ˜¯çš„xçš„å³å­æ ‘æˆä¸ºxçš„çˆ¶äº²ï¼ŒåŒæ—¶ä¿®æ”¹ç›¸å…³èŠ‚ç‚¹çš„å¼•ç”¨ã€‚æ—‹è½¬ä¹‹åï¼ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„ç‰¹æ€§ä»ç„¶èƒ½å¤Ÿå¾—åˆ°æ»¡è¶³</li></ul></li><li>å³æ—‹ rotate right<ul><li>å°†xçš„å·¦å­æ ‘ç»•xé¡ºæ—¶é’ˆæ—‹è½¬ï¼Œä½¿å¾—xçš„å·¦å­æ ‘æˆä¸ºxçš„çˆ¶äº²ï¼ŒåŒæ—¶ä¿®æ”¹ç›¸å…³èŠ‚ç‚¹çš„å¼•ç”¨ã€‚æ—‹è½¬ä¹‹åï¼ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„å±æ€§ä»ç„¶èƒ½å¤Ÿæ»¡è¶³</li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.cnblogs.com/carpenterlee/p/5503882.html">https://www.cnblogs.com/carpenterlee/p/5503882.html</a></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¢é»‘æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(16)-äºŒå‰æ ‘</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-16-%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-16-%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ ‘"><a href="#1-æ ‘" class="headerlink" title="1. æ ‘"></a>1. æ ‘</h1><ul><li>çˆ¶èŠ‚ç‚¹<ul><li>ä¸Šå±‚çš„èŠ‚ç‚¹ </li></ul></li><li>å…„å¼ŸèŠ‚ç‚¹<ul><li>çˆ¶èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ </li></ul></li><li>å¶èŠ‚ç‚¹<ul><li>æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹</li></ul></li><li>é«˜åº¦<ul><li>èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ </li></ul></li><li>æ·±åº¦<ul><li>æ ¹èŠ‚ç‚¹åˆ°è¿™ä¸ªèŠ‚ç‚¹æ‰€ç»å†çš„è¾¹çš„ä¸ªæ•° </li></ul></li><li>å±‚<ul><li>èŠ‚ç‚¹çš„æ·±åº¦ + 1 </li></ul></li></ul><h1 id="2-äºŒå‰æ ‘"><a href="#2-äºŒå‰æ ‘" class="headerlink" title="2. äºŒå‰æ ‘"></a>2. äºŒå‰æ ‘</h1><p>æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªåˆ†å‰çš„æ ‘ï¼Œå³æœ€å¤šæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</p><p><img src="https://i.loli.net/2020/02/10/r72vjaPlpfsHmuE.jpg" alt="fig1.jpg"><br>2 æ˜¾ç¤ºçš„æ˜¯æ»¡äºŒå‰æ ‘ï¼Œç‰¹ç‚¹æ˜¯å¶å­èŠ‚ç‚¹éƒ½åœ¨æœ€åº•å±‚ï¼Œå‡ºäº†å¶å­èŠ‚ç‚¹ä¹‹å¤–ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å·¦å³ä¸¤ä¸ªå­èŠ‚ç‚¹</p><p>3 å¶å­èŠ‚ç‚¹éƒ½åœ¨æœ€åº•ä¸‹ä¸¤å±‚ï¼Œå¹¶ä¸”å‡ºäº†æœ€åä¸€å±‚ï¼Œå…¶ä»–çš„å±‚çš„èŠ‚ç‚¹æ•°é‡éƒ½è¦è¾¾åˆ°æœ€å¤§ï¼Œå¹¶ä¸”æœ€åä¸€å±‚çš„èŠ‚ç‚¹éƒ½æ˜¯é å·¦æ’åˆ—çš„ï¼Œè¿™ç§äºŒå‰æ ‘å«åšå®Œå…¨äºŒå‰æ ‘ã€‚</p><h2 id="2-1-å¦‚ä½•è¡¨ç¤º-å­˜å‚¨ä¸€æ£µäºŒå‰æ ‘ï¼Ÿ"><a href="#2-1-å¦‚ä½•è¡¨ç¤º-å­˜å‚¨ä¸€æ£µäºŒå‰æ ‘ï¼Ÿ" class="headerlink" title="2.1 å¦‚ä½•è¡¨ç¤º/ å­˜å‚¨ä¸€æ£µäºŒå‰æ ‘ï¼Ÿ"></a>2.1 å¦‚ä½•è¡¨ç¤º/ å­˜å‚¨ä¸€æ£µäºŒå‰æ ‘ï¼Ÿ</h2><h3 id="2-1-1-åŸºäºæŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„äºŒå‰é“¾å¼å­˜å‚¨æ³•"><a href="#2-1-1-åŸºäºæŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„äºŒå‰é“¾å¼å­˜å‚¨æ³•" class="headerlink" title="2.1.1 åŸºäºæŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„äºŒå‰é“¾å¼å­˜å‚¨æ³•"></a>2.1.1 åŸºäºæŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„äºŒå‰é“¾å¼å­˜å‚¨æ³•</h3><p><img src="https://i.loli.net/2020/02/10/M1I6FkWJodTq3fX.jpg" alt="fig2.jpg"></p><p>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸‰ä¸ªå­—æ®µï¼Œå…¶ä¸­ä¸€ä¸ªå­˜å‚¨æ•°æ®ï¼Œå¦å¤–ä¸¤ä¸ªæŒ‡å‘å·¦å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚å› æ­¤é€šè¿‡æ ¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å·¦å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆå°†æ•´æ£µæ ‘éƒ½ä¸²èµ·æ¥äº†ã€‚</p><h3 id="2-1-2-åŸºäºæ•°ç»„çš„é¡ºåºå­˜å‚¨æ³•"><a href="#2-1-2-åŸºäºæ•°ç»„çš„é¡ºåºå­˜å‚¨æ³•" class="headerlink" title="2.1.2 åŸºäºæ•°ç»„çš„é¡ºåºå­˜å‚¨æ³•"></a>2.1.2 åŸºäºæ•°ç»„çš„é¡ºåºå­˜å‚¨æ³•</h3><p><img src="https://i.loli.net/2020/02/10/P62NlH8EbY3LBXv.jpg" alt="fig3.jpg"><br>å¦‚æœèŠ‚ç‚¹Xå­˜å‚¨åœ¨æ•°ç»„ä¸­ä¸‹æ ‡ä¸ºiçš„ä½ç½®ï¼Œä¸‹æ ‡ä¸º2<em>içš„ä½ç½®å­˜å‚¨çš„æ˜¯å·¦å­èŠ‚ç‚¹ï¼Œä¸‹æ ‡ä¸º2</em>i + 1çš„ä½ç½®å­˜å‚¨çš„å°±æ˜¯å³å­èŠ‚ç‚¹ã€‚ä¸‹æ ‡ä¸ºi/2çš„ä½ç½®å­˜å‚¨çš„å°±æ˜¯å®ƒçš„çˆ¶èŠ‚ç‚¹äº†ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“æ ¹èŠ‚ç‚¹å­˜å‚¨çš„ä½ç½®ï¼Œå°±å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¡ç®—ï¼ŒæŠŠæ•´æ£µæ ‘éƒ½ä¸²èµ·æ¥ã€‚ ä¸è¿‡å¯¹äºä¸€æ£µéå®Œå…¨äºŒå‰æ ‘è€Œè¨€ï¼Œä¼šæµªè´¹æ¯”è¾ƒå¤šçš„æ•°ç»„å­˜å‚¨ç©ºé—´çš„ã€‚</p><h2 id="2-2-äºŒå‰æ ‘çš„éå†"><a href="#2-2-äºŒå‰æ ‘çš„éå†" class="headerlink" title="2.2 äºŒå‰æ ‘çš„éå†"></a>2.2 äºŒå‰æ ‘çš„éå†</h2><h3 id="2-2-0-é€’å½’å…¬å¼"><a href="#2-2-0-é€’å½’å…¬å¼" class="headerlink" title="2.2.0 é€’å½’å…¬å¼"></a>2.2.0 é€’å½’å…¬å¼</h3><p><img src="https://i.loli.net/2020/02/10/o1TLXDnalmgBzAQ.jpg" alt="fig4.jpg"></p><p>äºŒå‰æ ‘çš„éå†æ•´ä½“å°±æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹</p><p>å†™é€’å½’ä»£ç çš„å…³é”®ï¼Œå°±æ˜¯çœ‹èƒ½ä¸èƒ½å†™å‡ºä¸€ä¸ªé€’æ¨å…¬å¼ã€‚è€Œé€’æ¨å…¬å¼çš„å…³é”®ï¼Œå°±æ˜¯å¦‚æœè¦è§£å†³é—®é¢˜Aï¼Œå°±å‡è®¾å­é—®é¢˜B,Céƒ½å·²ç»è§£å†³ï¼Œç„¶åå†æ¥çœ‹å¦‚ä½•åˆ©ç”¨Bï¼ŒCæ¥è§£å†³A</p><pre><code>å‰åºéå†çš„é€’æ¨å…¬å¼ï¼špreOrder(r) = print r-&gt;preOrder(r-&gt;left)-&gt;preOrder(r-&gt;right)ä¸­åºéå†çš„é€’æ¨å…¬å¼ï¼šinOrder(r) = inOrder(r-&gt;left)-&gt;print r-&gt;inOrder(r-&gt;right)ååºéå†çš„é€’æ¨å…¬å¼ï¼špostOrder(r) = postOrder(r-&gt;left)-&gt;postOrder(r-&gt;right)-&gt;print r// å‰åºéå†void preOrder(Node* root) {  if (root == null) return;  print root // æ­¤å¤„ä¸ºä¼ªä»£ç ï¼Œè¡¨ç¤ºæ‰“å°rootèŠ‚ç‚¹  preOrder(root-&gt;left);  preOrder(root-&gt;right);}// ä¸­åºéå†void inOrder(Node* root) {  if (root == null) return;  inOrder(root-&gt;left);  print root // æ­¤å¤„ä¸ºä¼ªä»£ç ï¼Œè¡¨ç¤ºæ‰“å°rootèŠ‚ç‚¹  inOrder(root-&gt;right);}// ååºéå†void postOrder(Node* root) {  if (root == null) return;  postOrder(root-&gt;left);  postOrder(root-&gt;right);  print root // æ­¤å¤„ä¸ºä¼ªä»£ç ï¼Œè¡¨ç¤ºæ‰“å°rootèŠ‚ç‚¹}</code></pre><h3 id="2-2-1-å‰åºéå†"><a href="#2-2-1-å‰åºéå†" class="headerlink" title="2.2.1 å‰åºéå†"></a>2.2.1 å‰åºéå†</h3><p>å¯¹äºæ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹æ¥è¯´ï¼Œå…ˆæ‰“å°è¿™ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†æ‰“å°å®ƒçš„å·¦å­æ ‘ï¼Œæœ€åæ‰“å°å®ƒçš„å³å­æ ‘ã€‚</p><h3 id="2-2-2-ä¸­åºéå†"><a href="#2-2-2-ä¸­åºéå†" class="headerlink" title="2.2.2 ä¸­åºéå†"></a>2.2.2 ä¸­åºéå†</h3><p>å¯¹äºæ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹æ¥è¯´ï¼Œå…ˆæ‰“å°å®ƒçš„å·¦å­æ ‘ï¼Œç„¶åå†æ‰“å°å®ƒæœ¬èº«ï¼Œæœ€åæ‰“å°å®ƒçš„å³å­æ ‘</p><h3 id="2-2-3-ååºéå†"><a href="#2-2-3-ååºéå†" class="headerlink" title="2.2.3 ååºéå†"></a>2.2.3 ååºéå†</h3><p>å¯¹äºæ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹æ¥è¯´ï¼Œå…ˆæ‰“å°å®ƒçš„å·¦å­æ ‘ï¼Œç„¶åå†æ‰“å°å®ƒçš„å³å­æ ‘ï¼Œæœ€åæ‰“å°è¿™ä¸ªèŠ‚ç‚¹æœ¬èº«</p><h1 id="3-äºŒå‰æŸ¥æ‰¾æ ‘"><a href="#3-äºŒå‰æŸ¥æ‰¾æ ‘" class="headerlink" title="3. äºŒå‰æŸ¥æ‰¾æ ‘"></a>3. äºŒå‰æŸ¥æ‰¾æ ‘</h1><p>æ”¯æŒåŠ¨æ€æ•°æ®é›†åˆçš„å¿«é€Ÿæ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾æ“ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(15)-å“ˆå¸Œç®—æ³•</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-15-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-15-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯å“ˆå¸Œç®—æ³•"><a href="#1-ä»€ä¹ˆæ˜¯å“ˆå¸Œç®—æ³•" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å“ˆå¸Œç®—æ³•"></a>1. ä»€ä¹ˆæ˜¯å“ˆå¸Œç®—æ³•</h1><blockquote><p>å°†ä»»æ„é•¿åº¦çš„äºŒè¿›åˆ¶ä¸²æ˜ å°„ä¸ºå›ºå®šé•¿åº¦çš„äºŒè¿›åˆ¶ä¸²ï¼Œè¿™ä¸ªæ˜ å°„çš„è§„åˆ™å°±æ˜¯å“ˆå¸Œç®—æ³•ï¼Œè€Œé€šè¿‡åŸå§‹æ•°æ®æ˜ å°„ä¹‹åå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å°±æ˜¯å“ˆå¸Œå€¼</p></blockquote><ul><li>å“ˆå¸Œç®—æ³•çš„è¦æ±‚<ul><li>ä»å“ˆå¸Œå€¼æ— æ³•åå‘æ¨å¯¼å‡ºåŸå§‹æ•°æ®</li><li>å¯¹è¾“å…¥æ•°æ®éå¸¸æ•æ„Ÿï¼Œå“ªæ€•åŸå§‹æ•°æ®åªä¿®æ”¹ä¸€ä¸ªbitï¼Œæœ€åå¾—åˆ°çš„å“ˆå¸Œå€¼ä¹Ÿä¼šå¤§ä¸ç›¸åŒ</li><li>æ•£åˆ—å†²çªçš„æ¦‚ç‡å¾ˆå°ï¼Œå¯¹äºä¸åŒçš„åŸå§‹æ•°æ®ï¼Œå“ˆå¸Œå€¼ç›¸åŒçš„æ¦‚ç‡éå¸¸å°</li><li>å“ˆå¸Œç®—æ³•çš„æ•ˆç‡è¦è¶³å¤Ÿé«˜ï¼Œé’ˆå¯¹è¾ƒé•¿æ–‡æœ¬ï¼Œä¹Ÿèƒ½å¿«é€Ÿè®¡ç®—å‡ºå“ˆå¸Œå€¼</li></ul></li></ul><h1 id="2-å“ˆå¸Œç®—æ³•çš„åº”ç”¨"><a href="#2-å“ˆå¸Œç®—æ³•çš„åº”ç”¨" class="headerlink" title="2. å“ˆå¸Œç®—æ³•çš„åº”ç”¨"></a>2. å“ˆå¸Œç®—æ³•çš„åº”ç”¨</h1><h2 id="2-1-å®‰å…¨åŠ å¯†"><a href="#2-1-å®‰å…¨åŠ å¯†" class="headerlink" title="2.1 å®‰å…¨åŠ å¯†"></a>2.1 å®‰å…¨åŠ å¯†</h2><ul><li>å¸¸ç”¨deåŠ å¯†ç®—æ³•<ul><li>MD5<ul><li>MD5 Message-Digest Algorithm </li><li>MD5ä¿¡æ¯æ‘˜è¦ç®—æ³•</li></ul></li><li>SHA <ul><li>Secure Hash Algorithm å®‰å…¨æ•£åˆ—ç®—æ³•</li></ul></li><li>DES <ul><li>Data Encryption Standard æ•°æ®åŠ å¯†æ ‡å‡†</li></ul></li><li>AES <ul><li>Advanced Encryption Standard é«˜çº§åŠ å¯†æ ‡å‡†</li></ul></li></ul></li></ul><h2 id="2-2-å”¯ä¸€æ ‡è¯†"><a href="#2-2-å”¯ä¸€æ ‡è¯†" class="headerlink" title="2.2 å”¯ä¸€æ ‡è¯†"></a>2.2 å”¯ä¸€æ ‡è¯†</h2><p>å›¾ç‰‡çš„æ ‡è¯†ï¼Œä»å›¾ç‰‡çš„äºŒè¿›åˆ¶ä¸²ç çš„å‰ä¸­åå„å–å‡º100å­—èŠ‚ï¼Œé€šè¿‡å“ˆå¸Œç®—æ³•å¾—åˆ°ä¸€ä¸ªå“ˆå¸Œå­—ç¬¦ä¸²ï¼Œç”¨å®ƒä½œä¸ºå›¾ç‰‡çš„å”¯ä¸€æ ‡è¯†ã€‚ç„¶åé€šè¿‡è¿™ä¸ªå”¯ä¸€æ ‡è¯†æ¥åˆ¤å®šå›¾ç‰‡æ˜¯å¦åœ¨å›¾åº“å½“ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥å‡å°‘å·¥ä½œé‡ã€‚</p><h2 id="2-3-æ•°æ®æ ¡éªŒ"><a href="#2-3-æ•°æ®æ ¡éªŒ" class="headerlink" title="2.3 æ•°æ®æ ¡éªŒ"></a>2.3 æ•°æ®æ ¡éªŒ</h2><p>BTåè®®çš„æ•°æ®æ ¡éªŒï¼Œå¯¹æ¯ä¸ªæ–‡ä»¶å—å–å“ˆå¸Œå€¼ï¼Œä¿å­˜åœ¨ç§å­æ–‡ä»¶å½“ä¸­ã€‚å½“æ–‡ä»¶å—ä¸‹è½½å®Œæˆä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡ç›¸åŒçš„å“ˆå¸Œç®—æ³•ï¼Œå¯¹ä¸‹è½½å¥½çš„æ–‡ä»¶å—é€ä¸€æ±‚å“ˆå¸Œå€¼ï¼Œç„¶åè·Ÿç§å­æ–‡ä»¶ä¸­ä¿å­˜çš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”å¯¹ã€‚å¦‚æœä¸åŒï¼Œå°±è¯´æ˜è¿™ä¸ªæ–‡ä»¶å—ä¸å®Œæ•´æˆ–è€…è¢«ç¯¡æ”¹äº†ï¼Œéœ€è¦å†é‡æ–°ä»å…¶ä»–å®¿ä¸»æœºå™¨ä¸Šä¸‹è½½è¿™ä¸ªæ–‡ä»¶å—ã€‚</p><h2 id="2-4-æ•£åˆ—å‡½æ•°"><a href="#2-4-æ•£åˆ—å‡½æ•°" class="headerlink" title="2.4 æ•£åˆ—å‡½æ•°"></a>2.4 æ•£åˆ—å‡½æ•°</h2><p>å“ˆå¸Œè¡¨çš„æ•£åˆ—å‡½æ•°ï¼Œå…³æ³¨çš„æ˜¯åœ¨åšå®Œå“ˆå¸Œä»¥åï¼Œæ˜¯å¦èƒ½å¤Ÿå¹³å‡çš„åˆ†å¸ƒã€‚ä¸€ç»„æ•°æ®èƒ½å¦å‡åŒ€æ•£åˆ—åœ¨å„ä¸ªæ§½ä¸­ã€‚ </p><p>å¦å¤–ä¸€ä¸ªç‚¹æ˜¯å…¶æ‰§è¡Œé€Ÿåº¦ï¼Œæ•£åˆ—å‡½æ•°å¯¹æ‰§è¡Œé€Ÿåº¦çš„è¦æ±‚ä¼šæ¯”è¾ƒé«˜ä¸€äº›ã€‚</p><h2 id="2-5-è´Ÿè½½å‡è¡¡"><a href="#2-5-è´Ÿè½½å‡è¡¡" class="headerlink" title="2.5 è´Ÿè½½å‡è¡¡"></a>2.5 è´Ÿè½½å‡è¡¡</h2><p>åˆ†å¸ƒå¼ç³»ç»Ÿå½“ä¸­éœ€è¦è§£å†³çš„é—®é¢˜</p><ul><li>è´Ÿè½½å‡è¡¡çš„ç®—æ³•<ul><li>è½®è¯¢</li><li>éšæœº</li><li>åŠ æƒè½®è¯¢</li></ul></li></ul><p>ä½†æ˜¯æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªä¼šè¯ç²˜æ»çš„è´Ÿè½½å‡è¡¡ç®—æ³•(session sticky)ã€‚å³æˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªå®¢æˆ·ç«¯ä¸Šï¼Œåœ¨ä¸€æ¬¡ä¼šè¯ä¸Šçš„æ‰€æœ‰è¯·æ±‚éƒ½è·¯ç”±åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šã€‚</p><p>é€šè¿‡å“ˆå¸Œç®—æ³•ï¼Œå¯¹å®¢æˆ·ç«¯IPåœ°å€æˆ–è€…ä¼šè¯çš„IDè®¡ç®—å“ˆå¸Œå€¼ï¼Œå°†å–å¾—çš„å“ˆå¸Œå€¼ä¸æœåŠ¡å™¨åˆ—è¡¨çš„å¤§å°è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œæœ€ç»ˆå¾—åˆ°çš„å€¼å°±æ˜¯åº”è¯¥è¢«è·¯ç”±åˆ°çš„æœåŠ¡å™¨çš„ç¼–å·ã€‚</p><h2 id="2-6-æ•°æ®åˆ†ç‰‡"><a href="#2-6-æ•°æ®åˆ†ç‰‡" class="headerlink" title="2.6 æ•°æ®åˆ†ç‰‡"></a>2.6 æ•°æ®åˆ†ç‰‡</h2><h3 id="2-6-1-å¦‚ä½•ç»Ÿè®¡å…³é”®è¯æœç´¢çš„æ¬¡æ•°"><a href="#2-6-1-å¦‚ä½•ç»Ÿè®¡å…³é”®è¯æœç´¢çš„æ¬¡æ•°" class="headerlink" title="2.6.1 å¦‚ä½•ç»Ÿè®¡å…³é”®è¯æœç´¢çš„æ¬¡æ•°"></a>2.6.1 å¦‚ä½•ç»Ÿè®¡å…³é”®è¯æœç´¢çš„æ¬¡æ•°</h3><p>å‡è®¾æˆ‘ä»¬æœ‰1Tçš„æ—¥å¿—æ–‡ä»¶ï¼Œé‡Œé¢è®°å½•äº†ç”¨æˆ·çš„å…³é”®è¯ï¼Œæˆ‘ä»¬æƒ³å¿«é€Ÿç»Ÿè®¡å‡ºæ¥æ¯ä¸ªå…³é”®è¯è¢«æœç´¢çš„æ¬¡æ•°ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ </p><ol><li>æ•°æ®é‡å¤ªå¤§çš„é—®é¢˜</li><li>å¤„ç†æ—¶é—´å¤ªé•¿çš„é—®é¢˜</li></ol><p>å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œç„¶åå¤šå°æœºå™¨è¿›è¡Œå¤„ç†ã€‚ç”¨å“ˆå¸Œç®—æ³•ï¼Œå°†å“ˆå¸Œå€¼ç›¸åŒçš„æœç´¢å…³é”®è¯æ”¾åˆ°åŒä¸€å°æœºå™¨ä¸Šã€‚ç„¶åæœ€ååšæ±‡æ€»</p><h3 id="2-6-2-å¦‚ä½•å¿«é€Ÿåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åœ¨å›¾åº“å½“ä¸­"><a href="#2-6-2-å¦‚ä½•å¿«é€Ÿåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åœ¨å›¾åº“å½“ä¸­" class="headerlink" title="2.6.2 å¦‚ä½•å¿«é€Ÿåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åœ¨å›¾åº“å½“ä¸­"></a>2.6.2 å¦‚ä½•å¿«é€Ÿåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åœ¨å›¾åº“å½“ä¸­</h3><p>ä¸ºæ¯ä¸ªå›¾ç‰‡å–å”¯ä¸€æ ‡è¯†ï¼Œç„¶åæ„å»ºæ•£åˆ—è¡¨ï¼Œä½†æ˜¯å½“å›¾ç‰‡é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œåœ¨å•å°æœºå™¨ä¸Šæ„å»ºæ•£åˆ—è¡¨æ˜¯è¡Œä¸é€šçš„ã€‚</p><p>å› ä¸ºåœ¨å­˜å‚¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ ¹æ®å“ˆå¸Œç®—æ³•å–æ¨¡æ¥è¿›è¡Œå­˜å‚¨ï¼Œç„¶ååœ¨è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç”¨åŒæ ·çš„å“ˆå¸Œç®—æ³•ï¼Œç„¶åä¸æœºå™¨ä¸ªæ•°næ±‚ä½™å–æ¨¡ã€‚ç„¶åæ ¹æ®å¾—åˆ°çš„å€¼åˆ°å¯¹åº”çš„æœºå™¨ä¸Šå»è¿›è¡ŒæŸ¥æ‰¾ã€‚</p><h2 id="2-7-åˆ†å¸ƒå¼å­˜å‚¨"><a href="#2-7-åˆ†å¸ƒå¼å­˜å‚¨" class="headerlink" title="2.7 åˆ†å¸ƒå¼å­˜å‚¨"></a>2.7 åˆ†å¸ƒå¼å­˜å‚¨</h2><p>åˆ†å¸ƒå¼å­˜å‚¨éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå½“æˆ‘ä»¬å·²ç»åœ¨å„ä¸ªhostä¸ŠæŒ‰ç…§å“ˆå¸Œç®—æ³•ä¿å­˜äº†æ•°æ®ä»¥åï¼Œå†å¢å‡hostçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è¿˜éœ€è¦å¯¹åŸå…ˆçš„hosté‡Œé¢çš„æ•°æ®åšè¿ç§»ã€‚å¦‚æœè¯´ç¼“å­˜å½“ä¸­çš„æ•°æ®ä¼šä¸€ä¸‹å­å…¨éƒ½å¤±æ•ˆçš„è¯ï¼Œé‚£ä¹ˆæ‰€æœ‰æ•°æ®è¯·æ±‚éƒ½è¦ä»æ•°æ®åº“èµ°ï¼Œç›´æ¥å°±å‹å®æ•°æ®åº“äº†ã€‚</p><p>å› æ­¤åœ¨åˆ†å¸ƒå¼å­˜å‚¨å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨<strong><em>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</em></strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ k ä¸ªæœºå™¨ï¼Œæ•°æ®çš„å“ˆå¸Œå€¼çš„èŒƒå›´æ˜¯[0, MAX]ã€‚æˆ‘ä»¬å°†æ•´ä¸ªèŒƒå›´åˆ’åˆ†æˆ m ä¸ªå°åŒºé—´ï¼ˆm è¿œå¤§äº kï¼‰ï¼Œæ¯ä¸ªæœºå™¨è´Ÿè´£ m/k ä¸ªå°åŒºé—´ã€‚å½“æœ‰æ–°æœºå™¨åŠ å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å°†æŸå‡ ä¸ªå°åŒºé—´çš„æ•°æ®ï¼Œä»åŸæ¥çš„æœºå™¨ä¸­æ¬ç§»åˆ°æ–°çš„æœºå™¨ä¸­ã€‚è¿™æ ·ï¼Œæ—¢ä¸ç”¨å…¨éƒ¨é‡æ–°å“ˆå¸Œã€æ¬ç§»æ•°æ®ï¼Œä¹Ÿä¿æŒäº†å„ä¸ªæœºå™¨ä¸Šæ•°æ®æ•°é‡çš„å‡è¡¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å“ˆå¸Œç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(14)-æ•£åˆ—è¡¨</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-14-%E6%95%A3%E5%88%97%E8%A1%A8/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-14-%E6%95%A3%E5%88%97%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>æ•£åˆ—è¡¨ - Hash Table, åˆè¢«ç§°ä¸ºå“ˆå¸Œè¡¨æˆ–è€…Hashè¡¨ã€‚æ•£åˆ—è¡¨ç”¨çš„æ˜¯æ•°ç»„æ”¯æŒæŒ‰ç…§ä¸‹æ ‡æ¥éšæœºè®¿é—®æ•°æ®çš„ç‰¹æ€§ï¼Œå› æ­¤æ•£åˆ—è¡¨å®é™…ä¸Šæ˜¯æ•°ç»„çš„ä¸€ç§æ‰©å±•ï¼Œç”±æ•°ç»„æ¼”åŒ–è€Œæ¥ã€‚</p><p>æ•£åˆ—çš„æ€æƒ³å°±æ˜¯å¯¹äºkeyå€¼ï¼Œé€šè¿‡hash functionï¼Œå¯¹åº”åˆ°tableä¸Šæ¥è¿›è¡Œå­˜å‚¨</p><p><img src="https://i.loli.net/2020/02/10/pnWdbkoVjUE7aTw.jpg" alt="fig1.jpg"></p><h1 id="2-æ•£åˆ—å‡½æ•°"><a href="#2-æ•£åˆ—å‡½æ•°" class="headerlink" title="2. æ•£åˆ—å‡½æ•°"></a>2. æ•£åˆ—å‡½æ•°</h1><p>æ•£åˆ—å‡½æ•°å°±æ˜¯å®ç°è¾“å…¥åˆ°å­˜å‚¨çš„å¯¹åº”çš„å‡½æ•°ï¼Œå› ä¸ºæœ€ç»ˆæ˜¯è¦å­˜å‚¨åˆ°æ•°ç»„å½“ä¸­ï¼Œæ•…è€Œå…¶åŸºæœ¬è¦æ±‚æœ‰ï¼š</p><ol><li>æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°çš„æ•£åˆ—å€¼æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°</li><li>å¦‚æœKey1 = Key2,é‚£ä¹ˆhash(key1) == hash(key2)</li><li>å¦‚æœkey1 != key2, é‚£ä¹ˆhash(key1) != hash(key2)</li></ol><p>æ¡ä»¶3 å³å¦‚ä½•åº”å¯¹æ•£åˆ—å†²çªçš„é—®é¢˜ï¼Œé¦–å…ˆæœ¬èº«æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”å®¢è§‚æ˜¯å­˜åœ¨æ•£åˆ—å†²çªçš„æƒ…å†µçš„ï¼Œé’ˆå¯¹äºæ•£åˆ—å†²çªï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨å¼€æ”¾å¯»å€æ³•å’Œé“¾è¡¨æ³•ã€‚</p><h1 id="3-å¦‚ä½•è§£å†³æ•£åˆ—å†²çª"><a href="#3-å¦‚ä½•è§£å†³æ•£åˆ—å†²çª" class="headerlink" title="3. å¦‚ä½•è§£å†³æ•£åˆ—å†²çª"></a>3. å¦‚ä½•è§£å†³æ•£åˆ—å†²çª</h1><h2 id="3-1-å¼€æ”¾å¯»å€æ³•"><a href="#3-1-å¼€æ”¾å¯»å€æ³•" class="headerlink" title="3.1 å¼€æ”¾å¯»å€æ³•"></a>3.1 å¼€æ”¾å¯»å€æ³•</h2><ul><li>æ ¸å¿ƒæ€æƒ³<ul><li>å‡ºç°äº†æ•£åˆ—å†²çªï¼Œå°±é‡æ–°æ¢æµ‹ä¸€ä¸ªç©ºé—²ä½ç½®ï¼Œå°†å…¶æ’å…¥</li></ul></li><li>æ¢æµ‹æ–¹æ³•<ul><li>çº¿æ€§æ¢æµ‹</li><li>äºŒæ¬¡æ¢æµ‹<ul><li>æ¢æµ‹æ­¥é•¿ä¸ºäºŒæ¬¡æ–¹çš„å¢é•¿ </li></ul></li><li>åŒé‡æ•£åˆ—<ul><li>ä½¿ç”¨ç¬¬ä¸€ä¸ªæ•£åˆ—å‡½æ•°è¿›è¡Œå°è¯•</li><li>å¦‚æœè®¡ç®—å¾—åˆ°çš„å­˜å‚¨ä½ç½®å·²ç»è¢«å ç”¨ï¼Œå†ç”¨ç¬¬äºŒä¸ªæ•£åˆ—å‡½æ•°ï¼Œä¾æ¬¡ç±»æ¨ç›´åˆ°æ‰¾åˆ°ç©ºé—²çš„å­˜å‚¨ä½ç½®</li></ul></li></ul></li><li>è£…è½½å› å­<ul><li>å¼•å…¥è£…åœ¨å¼•èµ„çš„æ¦‚å¿µæ¥è¡¨ç¤ºç©ºä½çš„å¤šå°‘</li><li><code>è£…è½½å› å­ = å¡«å…¥è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°/æ•£åˆ—è¡¨çš„é•¿åº¦</code></li></ul></li></ul><h2 id="3-2-é“¾è¡¨æ³•"><a href="#3-2-é“¾è¡¨æ³•" class="headerlink" title="3.2 é“¾è¡¨æ³•"></a>3.2 é“¾è¡¨æ³•</h2><p><img src="https://i.loli.net/2020/02/10/VAUezcR2phPlYjT.jpg" alt="fig2.jpg"></p><p>é“¾è¡¨æ³•æ˜¯ä¸€ç§æ›´åŠ å¸¸ç”¨çš„æ•£åˆ—å†²çªè§£å†³åŠæ³•ï¼Œç›¸æ¯”å¼€æ”¾å¯»å€æ³•ï¼Œå®ƒè¦ç®€å•å¾ˆå¤šã€‚æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªå›¾ï¼Œåœ¨æ•£åˆ—è¡¨ä¸­ï¼Œæ¯ä¸ªâ€œæ¡¶ï¼ˆbucketï¼‰â€æˆ–è€…â€œæ§½ï¼ˆslotï¼‰â€ä¼šå¯¹åº”ä¸€æ¡é“¾è¡¨ï¼Œæ‰€æœ‰æ•£åˆ—å€¼ç›¸åŒçš„å…ƒç´ æˆ‘ä»¬éƒ½æ”¾åˆ°ç›¸åŒæ§½ä½å¯¹åº”çš„é“¾è¡¨ä¸­ã€‚</p><h1 id="4-å·¥ç¨‹ä¸Šä½¿ç”¨çš„æ•£åˆ—è¡¨"><a href="#4-å·¥ç¨‹ä¸Šä½¿ç”¨çš„æ•£åˆ—è¡¨" class="headerlink" title="4. å·¥ç¨‹ä¸Šä½¿ç”¨çš„æ•£åˆ—è¡¨"></a>4. å·¥ç¨‹ä¸Šä½¿ç”¨çš„æ•£åˆ—è¡¨</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ€è€ƒä¸‹å®é™…åº”ç”¨åœºæ™¯å½“ä¸­çš„æ•£åˆ—è¡¨ï¼Œè™½ç„¶æˆ‘ä»¬è¯´æ•£åˆ—è¡¨çš„æŸ¥è¯¢æ•ˆç‡æ˜¯O(1), å®è´¨ä¸Šä»–çš„çœŸå®æ•°æ®æ—¶å’Œæ•£åˆ—å‡½æ•°ï¼Œè£…è½½å› å­ï¼Œæ•£åˆ—å†²çªéƒ½æœ‰å…³ç³»çš„ã€‚å¦‚æœæ•£åˆ—å‡½æ•°è®¾è®¡çš„ä¸å¥½ï¼Œæˆ–è€…è£…è½½å› å­è¿‡é«˜ï¼Œéƒ½å¯èƒ½å¯¼è‡´æ•£åˆ—å†²çªå‘ç”Ÿçš„æ¦‚ç‡å‡é«˜ï¼Œä»è€Œå¯¼è‡´æŸ¥è¯¢çš„æ•ˆç‡ä¸‹é™ã€‚</p><p>å› æ­¤å¯¹äºåœ¨å·¥ç¨‹ä¸Šä½¿ç”¨çš„æ•£åˆ—è¡¨ï¼Œé¦–å…ˆè¦è€ƒè™‘çš„å°±æ˜¯éœ€è¦èƒ½å¤Ÿåº”å¯¹å„ç§å¼‚å¸¸æƒ…å†µï¼Œæ¥é¿å…æ•£åˆ—å†²çªçš„æƒ…å†µä¸‹æ•£åˆ—è¡¨æ€§èƒ½çš„æ€¥å‰§ä¸‹é™ï¼Œå¹¶ä¸”éœ€è¦èƒ½å¤ŸæŠµæŠ—æ•£åˆ—ç¢°æ’æ”»å‡»ã€‚</p><h2 id="4-1-å¦‚ä½•è®¾è®¡æ•£åˆ—å‡½æ•°"><a href="#4-1-å¦‚ä½•è®¾è®¡æ•£åˆ—å‡½æ•°" class="headerlink" title="4.1 å¦‚ä½•è®¾è®¡æ•£åˆ—å‡½æ•°"></a>4.1 å¦‚ä½•è®¾è®¡æ•£åˆ—å‡½æ•°</h2><ul><li>éœ€æ±‚<ul><li>æ•£åˆ—å‡½æ•°çš„è®¾è®¡ä¸èƒ½å¤ªå¤æ‚ <ul><li>ä¼šæ¶ˆè€—å¾ˆå¤šè®¡ç®—æ—¶é—´</li><li>å³ä¼šå½±å“åˆ°æ•£åˆ—è¡¨çš„æ€§èƒ½</li></ul></li><li>æ•£åˆ—å‡½æ•°ç”Ÿæˆçš„å€¼éœ€è¦å°½å¯èƒ½éšæœºå¹¶ä¸”å‡åŒ€åˆ†å¸ƒ</li></ul></li><li>å¦‚ä½•è§£å†³è£…è½½å› å­è¿‡å¤§çš„é—®é¢˜<ul><li>é’ˆå¯¹æ•£åˆ—è¡¨ï¼Œå½“è£…è½½å› å­è¿‡å¤§çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œé‡æ–°ç”³è¯·ä¸€ä¸ªæ›´å¤§çš„æ•£åˆ—è¡¨ï¼Œå°†æ•°æ®æ¬ç§»åˆ°è¿™ä¸ªæ–°çš„æ•£åˆ—è¡¨å½“ä¸­ã€‚</li><li>åŒæ—¶ä¹Ÿæœ‰è£…è½½å› å­å¤ªå°çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åšåŠ¨æ€ç¼©å®¹çš„å·¥ä½œ</li></ul></li><li>å¦‚ä½•é¿å…ä½æ•ˆæ‰©å®¹<ul><li>æ‰€è°“ä½æ•ˆçš„æ‰©å®¹æŒ‡çš„æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è£…è½½å› å­è¶…è¿‡é˜ˆå€¼çš„æ—¶å€™ä¸€ä¸‹å­è¿›è¡Œæ‰©å®¹ï¼Œå³æ•°æ®çš„æ¬è¿å’Œæœ€ç»ˆçš„æ–°æ•°æ®çš„æ’å…¥ï¼Œé‚£é’ˆå¯¹è¿™ä¸€ä¸ªæ•°æ®ï¼Œå…¶æ—¶é—´å¤æ‚åº¦å˜æˆäº†O(n).</li><li>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨éœ€è¦è¿›è¡Œæ‰©å®¹çš„æ—¶å€™ï¼Œå°†æ‰©å®¹çš„æ“ä½œç©¿æ’åœ¨æ’å…¥æ“ä½œçš„è¿‡ç¨‹å½“ä¸­ï¼Œåˆ†æ‰¹æ¬¡æ¥å®Œæˆã€‚å½“è£…è½½å› å­è§¦è¾¾é˜ˆå€¼çš„æ—¶å€™ï¼Œåªç”³è¯·æ–°ç©ºé—´ï¼Œä½†æ˜¯æ²¡æœ‰å°†è€çš„æ•°æ®æ¬ç§»åˆ°æ–°çš„æ•£åˆ—è¡¨å½“ä¸­ã€‚</li><li>å½“æœ‰æ–°æ•°æ®æ’å…¥çš„æ—¶å€™ï¼Œå°±å°†æ–°æ•°æ®æ”¾åˆ°æ–°çš„æ•£åˆ—è¡¨å½“ä¸­ï¼Œå¹¶ä¸”ä»è€çš„æ•£åˆ—è¡¨å½“ä¸­æ‹¿ä¸€ä¸ªæ•°æ®æ”¾åˆ°æ–°çš„æ•£åˆ—è¡¨å½“ä¸­</li><li>è€ŒæŸ¥è¯¢æ“ä½œï¼Œä¸ºäº†å…¼é¡¾ï¼Œæˆ‘ä»¬ä¼šå…ˆä»æ–°çš„æ•£åˆ—è¡¨å½“ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå†å»è€çš„æ•£åˆ—è¡¨å½“ä¸­æŸ¥æ‰¾</li></ul></li></ul><h2 id="4-2-å¦‚ä½•è§£å†³å†²çªï¼Ÿ"><a href="#4-2-å¦‚ä½•è§£å†³å†²çªï¼Ÿ" class="headerlink" title="4.2 å¦‚ä½•è§£å†³å†²çªï¼Ÿ"></a>4.2 å¦‚ä½•è§£å†³å†²çªï¼Ÿ</h2><h3 id="4-2-1-å¼€æ”¾å¯»å€æ³•"><a href="#4-2-1-å¼€æ”¾å¯»å€æ³•" class="headerlink" title="4.2.1 å¼€æ”¾å¯»å€æ³•"></a>4.2.1 å¼€æ”¾å¯»å€æ³•</h3><ul><li>ä¼˜åŠ¿<ul><li>æ•°æ®éƒ½å­˜å‚¨åœ¨æ•°ç»„å½“ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆåˆ©ç”¨CPUç¼“å­˜åŠ å¿«æŸ¥è¯¢é€Ÿåº¦</li><li>åºåˆ—åŒ–æ¯”è¾ƒç®€å•</li></ul></li><li>ç¼ºé™·<ul><li>åˆ é™¤æ•°æ®æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦ç‰¹æ®Šæ ‡è®°å·²ç»åˆ é™¤çš„æ•°æ®</li><li>å†²çªä»£ä»·é«˜ï¼Œå¯¼è‡´è£…è½½å› å­çš„ä¸Šé™ä¸èƒ½å¤ªå¤§</li></ul></li></ul><blockquote><p>å½“æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè£…è½½å› å­å°çš„æ—¶å€™ï¼Œé€‚åˆä½¿ç”¨å¼€æ”¾å¯»å€æ³•ã€‚</p></blockquote><h3 id="4-2-2-é“¾è¡¨æ³•"><a href="#4-2-2-é“¾è¡¨æ³•" class="headerlink" title="4.2.2 é“¾è¡¨æ³•"></a>4.2.2 é“¾è¡¨æ³•</h3><ul><li>ä¼˜åŠ¿<ul><li>å¯¹å†…å­˜çš„åˆ©ç”¨ç‡ç›¸å¯¹æ¯”è¾ƒé«˜ï¼Œå› ä¸ºé“¾è¡¨ç»“ç‚¹å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å†åˆ›å»ºï¼Œä¸éœ€è¦æå‰ç”³è¯·å¥½</li><li>å¯ä»¥å…è®¸å¾ˆé«˜çš„è£…è½½å› å­</li></ul></li><li>åŠ£åŠ¿<ul><li>å› ä¸ºè¦å­˜å‚¨æŒ‡é’ˆï¼Œå¯¹äºå°çš„å¯¹è±¡çš„å­˜å‚¨ï¼Œæ˜¯æ›´åŠ è€—å†…å­˜çš„</li><li>å› ä¸ºç»“ç‚¹é›¶æ•£åˆ†å¸ƒåœ¨å†…å­˜å½“ä¸­ï¼Œä¸æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥å¯¹CPUç¼“å­˜ä¸å‹å¥½ï¼Œå¯¹æ‰§è¡Œæ•ˆç‡ä¼šé€ æˆä¸€å®šçš„å½±å“</li></ul></li></ul><h2 id="4-3-Java-HashMapä¸¾ä¾‹"><a href="#4-3-Java-HashMapä¸¾ä¾‹" class="headerlink" title="4.3 Java HashMapä¸¾ä¾‹"></a>4.3 Java HashMapä¸¾ä¾‹</h2><ul><li>åˆå§‹å¤§å° - 16<ul><li>å¦‚æœå¤§æ¦‚çŸ¥é“æ•°æ®é‡çš„å¤§å°ï¼Œå¯ä»¥ä¿®æ”¹é»˜è®¤ï¼Œæ¥å‡å°‘åŠ¨æ€æ‰©å®¹çš„æ¬¡æ•°</li></ul></li><li>è£…è½½å› å­å’ŒåŠ¨æ€æ‰©å®¹<ul><li>é»˜è®¤ load factor 0.75 </li><li>æ¯æ¬¡æ‰©å®¹å¤§å°å˜ä¸ºä¸¤å€</li></ul></li><li>æ•£åˆ—å†²çªè§£å†³æ–¹æ³•<ul><li>é‡‡ç”¨é“¾è¡¨æ³•</li><li>1.8ä»¥åå½“é“¾è¡¨é•¿åº¦è¶…è¿‡8ä»¥åï¼Œé“¾è¡¨å°±ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘</li></ul></li><li>æ•£åˆ—å‡½æ•°</li></ul><pre><code>int hash(Object key) {    int h = key.hashCode()ï¼›    return (h ^ (h &gt;&gt;&gt; 16)) &amp; (capicity -1); //capicityè¡¨ç¤ºæ•£åˆ—è¡¨çš„å¤§å°} </code></pre><p><code>&amp;(capacity - 1)</code> means <code>% capacity</code></p><p>å› ä¸ºhashcodeæœ¬èº«æ˜¯ä¸ª32ä½çš„æ•´å‹å€¼ï¼Œè·å¾—å…¶hashå€¼ä»¥åï¼Œå°†é«˜16ä½ç§»åˆ°ä½16ä½ï¼Œå°±ç›¸å½“äºæ‹¿åˆ°äº†é«˜16ä½å’Œä½16ä½çš„featureã€‚ç”¨è‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œä¸ºçš„æ˜¯åŠ å¤§ä½ä½çš„éšæœºæ€§ã€‚è¿™æ ·å­å“ªæ€•æ˜¯é«˜ä½çš„å˜åŒ–ä¹Ÿå¯ä»¥åæ˜ åˆ°ä½ä½å½“ä¸­ï¼Œä¿è¯äº†æœ€ç»ˆè¿›binçš„éšæœºæ€§</p><h1 id="5-æ•£åˆ—è¡¨å®é™…åº”ç”¨"><a href="#5-æ•£åˆ—è¡¨å®é™…åº”ç”¨" class="headerlink" title="5. æ•£åˆ—è¡¨å®é™…åº”ç”¨"></a>5. æ•£åˆ—è¡¨å®é™…åº”ç”¨</h1><p>æ•£åˆ—è¡¨å’Œé“¾è¡¨ç»å¸¸æ˜¯å…±åŒä½¿ç”¨çš„,è¿™ä¸€éƒ¨åˆ†ä¼šwalk throughä¸€äº›å¸¸ç”¨çš„åœºæ™¯ï¼Œçœ‹çœ‹æ˜¯å¦‚ä½•æ¥å…±åŒä½¿ç”¨çš„ã€‚</p><h2 id="5-1-LRUç¼“å­˜æ·˜æ±°ç®—æ³•"><a href="#5-1-LRUç¼“å­˜æ·˜æ±°ç®—æ³•" class="headerlink" title="5.1 LRUç¼“å­˜æ·˜æ±°ç®—æ³•"></a>5.1 LRUç¼“å­˜æ·˜æ±°ç®—æ³•</h2><p>æœ€åŸºç¡€çš„LRUå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é“¾è¡¨æ¥åš.ç»´æŠ¤ä¸€ä¸ªæŒ‰ç…§è®¿é—®æ—¶é—´ä»å¤§åˆ°å°æœ‰åºæ’åˆ—çš„é“¾è¡¨ç»“æ„ï¼Œå› ä¸ºç¼“å­˜å¤§å°æœ‰é™ï¼Œå½“ç¼“å­˜ç©ºé—´ä¸å¤Ÿï¼Œéœ€è¦æ·˜æ±°ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ç›´æ¥å°†é“¾è¡¨å¤´éƒ¨çš„ç»“ç‚¹åˆ é™¤ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨æ•£åˆ—è¡¨å’ŒåŒå‘é“¾è¡¨ä¸€èµ·æ¥å®ç°LRU cacheã€‚è¦å®ç°çš„æ“ä½œæœ‰ï¼š</p><ul><li>å¾€ç¼“å­˜ä¸­åŠ å…¥æ•°æ®</li><li>ä»ç¼“å­˜ä¸­åˆ é™¤æ•°æ®</li><li>åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾æ•°æ®</li></ul><p><img src="https://i.loli.net/2020/02/10/LIB2nkbZYudrq37.jpg" alt="fig3.jpg"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç›¸å½“äºåœ¨ç»´æŠ¤ä¸¤æ¡é“¾è¡¨ï¼Œä¸€æ¡æ˜¯åœ¨å“ˆå¸Œè¡¨çš„æ¯ä¸ªentryä¸Šçš„é“¾ï¼Œåœ¨è¿™ä¸Šé¢çš„é“¾æ˜¯ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªçš„ï¼›å¦å¤–ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ˜¯ç»´æŠ¤LRU cacheçš„é“¾è¡¨ã€‚</p><p>é“¾è¡¨å½“ä¸­çš„æ¯ä¸ªç»“ç‚¹ä¿å­˜äº†ï¼š</p><ul><li>prev</li><li>next</li><li>data</li><li>hnext<ul><li>æ•£åˆ—è¡¨ä¸Šç¢°æ’é—®é¢˜çš„è§£å†³çš„ </li></ul></li></ul><h2 id="5-2-Java-LinkedHashMap"><a href="#5-2-Java-LinkedHashMap" class="headerlink" title="5.2 Java LinkedHashMap"></a>5.2 Java LinkedHashMap</h2><p>LinkedHashMapèƒ½å¤Ÿå®ç°æŒ‰ç…§æ•°æ®çš„æ’å…¥é¡ºåºæ¥è¿›è¡Œæ‰“å°ï¼Œæ˜¯å› ä¸ºä»–ä¹Ÿæ˜¯é€šè¿‡æ•£åˆ—è¡¨å’Œé“¾è¡¨ç»„åˆåœ¨ä¸€èµ·çš„æ–¹å¼å®ç°çš„ã€‚å®ƒæ”¯æŒæŒ‰ç…§æ’å…¥é¡ºåºéå†æ•°æ®ï¼Œè¿˜æ”¯æŒæŒ‰ç…§è®¿é—®é¡ºåºæ¥éå†æ•°æ®</p><pre><code>// 10æ˜¯åˆå§‹å¤§å°ï¼Œ0.75æ˜¯è£…è½½å› å­ï¼Œtrueæ˜¯è¡¨ç¤ºæŒ‰ç…§è®¿é—®æ—¶é—´æ’åºHashMap&lt;Integer, Integer&gt; m = new LinkedHashMap&lt;&gt;(10, 0.75f, true);m.put(3, 11);m.put(1, 12);m.put(5, 23);m.put(2, 22);m.put(3, 26);m.get(5);for (Map.Entry e : m.entrySet()) {  System.out.println(e.getKey());}// print out: 1, 2, 3, 5</code></pre><p><img src="https://i.loli.net/2020/02/10/wxy1tumrZO3DXQz.jpg" alt="fig4.jpg"></p><p><img src="https://i.loli.net/2020/02/10/9phoBuRSI5gsJC4.jpg" alt="fig5.jpg"></p><p><img src="https://i.loli.net/2020/02/10/3KGVI15LDp4PSAZ.jpg" alt="fig6.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•£åˆ—è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(13)-è·³è¡¨</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-13-%E8%B7%B3%E8%A1%A8/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-13-%E8%B7%B3%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h1><ul><li>è·³è¡¨<ul><li>åŠ¨æ€æ•°æ®ç»“æ„</li><li>å¯ä»¥æ”¯æŒå¿«é€Ÿçš„æ’å…¥ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾æ“ä½œ</li><li>å†™èµ·æ¥ä¹Ÿä¸ä¼šå¾ˆå¤æ‚</li></ul></li></ul><p>Rediså½“ä¸­çš„æœ‰åºé›†åˆå°±æ˜¯ç”¨è·³è¡¨æ¥å®ç°çš„ã€‚</p><h1 id="2-å¦‚ä½•ç†è§£è·³è¡¨"><a href="#2-å¦‚ä½•ç†è§£è·³è¡¨" class="headerlink" title="2. å¦‚ä½•ç†è§£è·³è¡¨"></a>2. å¦‚ä½•ç†è§£è·³è¡¨</h1><p>å¯¹äºä¸€ä¸ªå•é“¾è¡¨æ¥è¯´ï¼Œå³ä¾¿é“¾è¡¨å½“ä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä»ä¸­æŸ¥æ‰¾æŸä¸ªæ•°æ®ï¼Œä¹Ÿåªèƒ½ä»å¤´åˆ°å°¾éå†é“¾è¡¨ï¼Œè¿™æ ·æŸ¥æ‰¾æ•ˆç‡å°±ä¼šéå¸¸ä½ï¼Œæ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼ŒO(n)</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹é“¾è¡¨å»ºç«‹ä¸€çº§ç´¢å¼•ï¼Œæ¯å‡ ä¸ªç»“ç‚¹å°±æå–ä¸€ä¸ªç»“ç‚¹åˆ°ä¸Šä¸€çº§å½“ä¸­ï¼ŒæŠ½å‡ºæ¥çš„é‚£ä¸€çº§æˆ‘ä»¬å°±å¯ä»¥å°†å…¶å«åšç´¢å¼•æˆ–è€…ç´¢å¼•å±‚äº†ã€‚</p><p>é€šè¿‡å¢åŠ ç´¢å¼•çš„å±‚çº§ï¼Œæ¥åŠ å¿«å¯»æ‰¾èŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œè¿™å°±æ˜¯è·³è¡¨ â€“ é“¾è¡¨åŠ ä¸Šå¤šçº§ç´¢å¼•çš„ç»“æ„</p><ul><li>æ—¶é—´å¤æ‚åº¦éå¸¸ç†æƒ³ O(logn)</li><li>ä½†æ˜¯ç›¸å¯¹æ¥è¯´ä¼šæ›´éœ€è¦å†…å­˜ä¸€äº›  ç©ºé—´å¤æ‚åº¦ä¸ºO(n)</li></ul><h1 id="3-é«˜æ•ˆçš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤æ“ä½œ"><a href="#3-é«˜æ•ˆçš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤æ“ä½œ" class="headerlink" title="3. é«˜æ•ˆçš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤æ“ä½œ"></a>3. é«˜æ•ˆçš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤æ“ä½œ</h1><p>å…¶åŠ¨æ€çš„æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)</p><p><img src="https://i.loli.net/2020/02/10/f4vdSyzCEs2KWFY.jpg" alt="fig1.jpg"></p><p>åˆ é™¤æ“ä½œï¼Œè¿˜æ˜¯éœ€è¦æ‹¿åˆ°åˆ é™¤èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡æŒ‡é’ˆæ“ä½œå®Œæˆåˆ é™¤ã€‚</p><h2 id="4-è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°"><a href="#4-è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°" class="headerlink" title="4. è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°"></a>4. è·³è¡¨ç´¢å¼•åŠ¨æ€æ›´æ–°</h2><p><img src="https://i.loli.net/2020/02/10/J5QxpXFgAeTCa2j.jpg" alt="fig2.jpg"></p><p>è·³è¡¨æ˜¯éœ€è¦ä¸æ–­æ›´æ–°çš„ï¼Œå› ä¸ºå½“æˆ‘ä»¬ä¸æ–­å‘è·³è¡¨é‡Œé¢æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ›´æ–°ç´¢å¼•ï¼Œå°±æœ‰å¯èƒ½å‡ºç°ä¸¤ä¸ªç´¢å¼•èŠ‚ç‚¹ä¹‹é—´æ•°æ®éå¸¸å¤šçš„æƒ…å†µã€‚æç«¯æƒ…å†µä¸‹ï¼Œè·³è¡¨å°±ä¼šé€€åŒ–æˆå•é“¾è¡¨ã€‚</p><ul><li>æˆ‘ä»¬éœ€è¦æŸç§æ–¹å¼æ¥ç»´æŠ¤ç´¢å¼•ä¸åŸå§‹é“¾è¡¨å¤§å°ä¹‹é—´çš„å¹³è¡¡<ul><li>è·³è¡¨æ˜¯é€šè¿‡éšæœºå‡½æ•°æ¥ç»´æŠ¤å¹³è¡¡æ€§çš„</li><li>å½“æˆ‘ä»¬å¾€è·³è¡¨é‡Œé¢æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©åŒæ—¶å°†è¿™ä¸ªæ•°æ®æ’å…¥åˆ°éƒ¨åˆ†ç´¢å¼•å±‚å½“ä¸­ã€‚</li><li>æ ¹æ®éšæœºå‡½æ•°æ¥å†³å®šè¿™ä¸ªç»“ç‚¹æ’å…¥åˆ°å“ªå‡ çº§ç´¢å¼•å½“ä¸­ã€‚</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/10/64FQnKPZ8uWlTCb.jpg" alt="fig3.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è·³è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(12)-äºŒåˆ†æŸ¥æ‰¾</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-12-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-12-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/</url>
      
        <content type="html"><![CDATA[<p>äºŒåˆ†æŸ¥æ‰¾æ˜¯ä¸€ç§é’ˆå¯¹äºæœ‰åºæ•°æ®é›†åˆçš„æŸ¥æ‰¾ç®—æ³•ï¼Œä¹Ÿå«æŠ˜åŠæŸ¥æ‰¾ç®—æ³•ã€‚ç±»ä¼¼åˆ†æ²»çš„æ€æƒ³ï¼Œæ¯æ¬¡éƒ½é€šè¿‡è·ŸåŒºé—´çš„ä¸­é—´å…ƒç´ å¯¹æ¯”ï¼Œå°†å¾…æŸ¥æ‰¾çš„åŒºé—´ç¼©å°ä¸ºä¹‹å‰çš„ä¸€åŠï¼Œç›´åˆ°æ‰¾åˆ°è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œæˆ–è€…åŒºé—´è¢«ç¼©å°ä¸º0. æŸ¥æ‰¾é€Ÿåº¦ä¸ºO(logn)</p><p>æ€è€ƒé¢˜ï¼š1000ä¸‡ä¸ªæ•´æ•°æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®8å­—èŠ‚ï¼Œ</p><h1 id="1-äºŒåˆ†æŸ¥æ‰¾çš„åŸºæœ¬å®ç°"><a href="#1-äºŒåˆ†æŸ¥æ‰¾çš„åŸºæœ¬å®ç°" class="headerlink" title="1. äºŒåˆ†æŸ¥æ‰¾çš„åŸºæœ¬å®ç°"></a>1. äºŒåˆ†æŸ¥æ‰¾çš„åŸºæœ¬å®ç°</h1><pre><code>public int bsearch(int[] a, int n, int value) {// å®šåŸºå‡†ç‚¹  int low = 0;  int high = n - 1;// åœæ­¢æ¡ä»¶  while (low &lt;= high) {    // å®šäºŒåˆ†ç‚¹    int mid = (low + high) / 2;    if (a[mid] == value) {      return mid;    } else if (a[mid] &lt; value) {     // ä¿è¯æ˜¯æ´»å¾ªç¯..       low = mid + 1;    } else {      high = mid - 1;    }  }  return -1;}// äºŒåˆ†æŸ¥æ‰¾çš„é€’å½’å®ç°public int bsearch(int[] a, int n, int val) {  return bsearchInternally(a, 0, n - 1, val);}private int bsearchInternally(int[] a, int low, int high, int value) {  if (low &gt; high) return -1;  int mid =  low + ((high - low) &gt;&gt; 1);  if (a[mid] == value) {    return mid;  } else if (a[mid] &lt; value) {    return bsearchInternally(a, mid+1, high, value);  } else {    return bsearchInternally(a, low, mid-1, value);  }}</code></pre><ul><li>å¾ªç¯é€€å‡ºæ¡ä»¶<ul><li>low &lt;= high </li></ul></li><li>midå–å€¼<ul><li>mid = low + (high - low)/2</li><li>å› ä¸ºå¦‚æœå€¼å¤ªå¤§çš„è¯ï¼Œä¼šæº¢å‡ºçš„</li></ul></li><li>low highçš„æ›´æ–°<ul><li>low = mid + 1</li><li>high = mid - 1 </li></ul></li></ul><h1 id="2-äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨åœºæ™¯å±€é™æ€§"><a href="#2-äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨åœºæ™¯å±€é™æ€§" class="headerlink" title="2. äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨åœºæ™¯å±€é™æ€§"></a>2. äºŒåˆ†æŸ¥æ‰¾çš„åº”ç”¨åœºæ™¯å±€é™æ€§</h1><ul><li>äºŒåˆ†æŸ¥æ‰¾ä»¥æ¥çš„æ˜¯é¡ºåºè¡¨ç»“æ„  â€“ æ•°ç»„<ul><li>å› ä¸ºäºŒåˆ†æŸ¥æ‰¾éœ€è¦æŒ‰ç…§ä¸‹æ ‡æ¥éšæœºè®¿é—®å…ƒç´ </li></ul></li><li>é’ˆå¯¹çš„æ˜¯æœ‰åºæ•°æ® â€“ é™æ€æ•°æ®é›†<ul><li>æ›´é€‚ç”¨åœ¨æ’å…¥ï¼Œåˆ é™¤ä¸é¢‘ç¹ï¼Œä¸€æ¬¡æ’åºå¤šæ¬¡æŸ¥æ‰¾çš„åœºæ™¯å½“ä¸­</li><li>é’ˆå¯¹åŠ¨æ€å˜åŒ–çš„æ•°æ®é›†åˆï¼ŒäºŒåˆ†æŸ¥æ‰¾å°±ä¸å†é€‚ç”¨äº†</li></ul></li><li>æ•°æ®é‡å¤ªå°ä¸éœ€è¦é€‚ç”¨äºŒåˆ†æŸ¥æ‰¾</li><li>å¦‚æœæ•°æ®ä¹‹é—´çš„æ¯”è¾ƒéå¸¸è€—æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°½åŠ›å‡å°‘æ¯”è¾ƒçš„æ¬¡æ•°ï¼Œé‚£ä¹ˆäºŒåˆ†æŸ¥æ‰¾å°±æ˜¯å¾ˆå¥½çš„æ–¹å¼äº†</li></ul><h1 id="3-äºŒåˆ†æŸ¥æ‰¾çš„å®é™…åº”ç”¨ä¸å˜ä½“"><a href="#3-äºŒåˆ†æŸ¥æ‰¾çš„å®é™…åº”ç”¨ä¸å˜ä½“" class="headerlink" title="3. äºŒåˆ†æŸ¥æ‰¾çš„å®é™…åº”ç”¨ä¸å˜ä½“"></a>3. äºŒåˆ†æŸ¥æ‰¾çš„å®é™…åº”ç”¨ä¸å˜ä½“</h1><h2 id="3-1-æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "><a href="#3-1-æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ " class="headerlink" title="3.1 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "></a>3.1 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ </h2><pre><code>public int bsearch(int[] a, int n, int value) {  int low = 0;  int high = n - 1;  while (low &lt;= high) {    int mid =  low + ((high - low) &gt;&gt; 1);    if (a[mid] &gt; value) {      high = mid - 1;    } else if (a[mid] &lt; value) {      low = mid + 1;    } else {      // æ³¨æ„è¿™é‡Œçš„åˆ¤æ–­ï¼Œä¸­æ­¢æ¡ä»¶æ—¶midä¸º0 æˆ–è€…å·¦ä¸€ä¸ªçš„å€¼å’Œç°åœ¨çš„å€¼ä¸ç›¸ç­‰       if ((mid == 0) || (a[mid - 1] != value)) return mid;      else high = mid - 1;    }  }  return -1;}</code></pre><ul><li>å†™äºŒåˆ†ç›¸å…³çš„ç®—æ³•è¦æ³¨æ„çš„ç‚¹æœ‰<ul><li>ç»ˆæ­¢æ¡ä»¶</li><li>åŒºé—´ä¸Šä¸‹ç•Œçš„æ›´æ–°æ–¹æ³•</li><li>è¿”å›å€¼çš„é€‰æ‹©</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ†æŸ¥æ‰¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(11)-åº”ç”¨åœºæ™¯ä¸‹çš„æ’åºå‡½æ•°</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-11-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%8E%92%E5%BA%8F%E5%87%BD%E6%95%B0/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-11-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%8E%92%E5%BA%8F%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸å¼€å‘å½“ä¸­ï¼Œæ— è®ºæˆ‘ä»¬ä½¿ç”¨çš„è¯­è¨€æ˜¯ä»€ä¹ˆï¼Œä»–ä»¬å‡ ä¹éƒ½ä¼šæä¾›æ’åºç®—æ³•ï¼Œæœ¬ç¯‡åšæ–‡å°†å°è¯•ç€å¯¹å…¶è¿›è¡Œåˆ†æï¼Œçœ‹çœ‹å¦‚ä½•å®ç°ä¸€ä¸ªé€šç”¨çš„ï¼Œé«˜æ€§èƒ½çš„æ’åºç®—æ³•ã€‚</p><p>é¦–å…ˆçœ‹çœ‹æˆ‘ä»¬çš„ç°æœ‰æ’åºç®—æ³•åº“ï¼Œçœ‹çœ‹æˆ‘ä»¬çš„é€‰æ‹©ç©ºé—´åœ¨å“ªé‡Œï¼š </p><p><img src="https://i.loli.net/2020/02/10/2ga9UPTNkOcb8wr.jpg" alt="fig1.jpg"></p><p>å¦‚æœå¯¹äºå°è§„æ¨¡æ•°æ®æ’åºï¼Œå¯ä»¥é€‰æ‹©O(n^2); ä½†æ˜¯å¯¹äºå¤§è§„æ¨¡çš„æ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)çš„ç®—æ³•ä¼šé«˜æ•ˆå¾ˆå¤šã€‚å› æ­¤ä¸ºäº†å…¼é¡¾ä»»æ„è§„æ¨¡æ•°æ®çš„æ’åºï¼Œä¸€èˆ¬éƒ½ä¼šé¦–é€‰æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)çš„æ’åºç®—æ³•æ¥å®ç°æ’åºå‡½æ•°ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ä¼šé€‰ç”¨å †æ’åºæˆ–è€…å¿«é€Ÿæ’åºæ¥åšã€‚</p><p>å› ä¸ºåœ¨å®é™…æƒ…å†µä¸‹å†…å­˜çš„å ç”¨æƒ…å†µæ˜¯éå¸¸å…³é”®çš„å‚æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çœ‹å¾…é€‰ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ï¼Œæœ€å¥½æ˜¯åŸåœ°çš„ï¼Œå³ä¸å ç”¨æ›´å¤šçš„ç©ºé—´ã€‚åƒå½’å¹¶æ’åºï¼Œæ—¶é—´å¤æ‚åº¦å¾ˆåˆé€‚ä½†æ˜¯ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ï¼Œé‚£å°±å®Œå…¨ä¸æ˜¯ä¸€ä¸ªå¥½é€‰æ‹©äº†</p><p>å¿«é€Ÿæ’åºæƒ³è¦ä¼˜åŒ–çš„è¯ï¼Œä¸»è¦çš„ç‚¹åœ¨äºè¦é€‰å‡†åˆ†åŒºç‚¹ï¼Œå¥½çš„åˆ†åŒºç‚¹æ˜¯å¸Œæœ›å…¶ä¸¤ä¸ªåˆ†åŒºæ•°æ®çš„æ•°é‡æ˜¯å·®ä¸å¤šçš„æ‰å¯ä»¥ã€‚æˆ‘ä»¬å¯ä»¥éšæœºå–å€¼ï¼Œä¹Ÿå¯ä»¥å¤šå–å‡ ä¸ªéšæœºç‚¹ï¼Œç„¶åæ±‚å¹³å‡ã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯åœ¨å®é™…æƒ…å†µå½“ä¸­, O(n^2)æœ‰å¯èƒ½ä¼šæ¯”O(nlogn)è¦å¿«çš„ï¼Œå› ä¸ºå°è§„æ¨¡æ•°æ®é›†çš„æ—¶å€™é¦–å…ˆå¸¸é‡å°±ä¸èƒ½å¿½ç•¥æ‰äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½æ’å…¥æ’åºåè€Œä¼šæ›´å¿«ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(10)-æ’åº(æ¡¶æ’åº è®¡æ•°æ’åº åŸºæ•°æ’åº)</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-10-%E6%8E%92%E5%BA%8F-%E6%A1%B6%E6%8E%92%E5%BA%8F-%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F-%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-10-%E6%8E%92%E5%BA%8F-%E6%A1%B6%E6%8E%92%E5%BA%8F-%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F-%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šè¿°ä¸‰ç§æ’åºæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å‡ä¸ºçº¿æ€§ï¼Œå› æ­¤å°†å…¶ç§°ä¸ºçº¿æ€§æ’åº(Linear sort).ä¹‹æ‰€ä»¥èƒ½åšå…ˆçº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ˜¯å› ä¸ºä»–ä»¬éƒ½ä¸æ˜¯åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œå¹¶ä¸æ¶‰åŠåˆ°å…ƒç´ ä¹‹é—´çš„æ¯”è¾ƒæ“ä½œã€‚</p><h1 id="1-æ¡¶æ’åº-Bucket-Sort"><a href="#1-æ¡¶æ’åº-Bucket-Sort" class="headerlink" title="1. æ¡¶æ’åº Bucket Sort"></a>1. æ¡¶æ’åº Bucket Sort</h1><ul><li>æ ¸å¿ƒæ€æƒ³<ul><li>å°†æ’åºçš„æ•°æ®åˆ†åˆ°å‡ ä¸ªæœ‰åºçš„æ¡¶å½“ä¸­ï¼Œæ¯ä¸ªæ¡¶çš„æ•°æ®å†å•ç‹¬è¿›è¡Œæ’åºã€‚æ¡¶å†…æ’å®Œåºä¹‹åï¼Œå†å°†æ¯ä¸ªæ¡¶é‡Œçš„æ•°æ®æŒ‰ç…§é¡ºåºä¾æ¬¡å–å‡ºï¼Œç»„æˆçš„åºåˆ—å°±æ˜¯æœ‰åºçš„äº†ã€‚</li></ul></li><li>åˆ†æ<ul><li>å¦‚æœè¦æ’åºçš„æ•°æ®ä¸º nä¸ªï¼Œå°†å…¶å‡åŒ€åˆ†åˆ°mä¸ªæ¡¶å½“ä¸­ï¼Œæ¯ä¸ªæ¡¶å°±æœ‰ k=n/mä¸ªå…ƒç´ ã€‚æ¯ä¸ªæ¡¶å†…éƒ¨ä½¿ç”¨å¿«æ’ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(k*logk)</li><li>mä¸ªæ¡¶çš„æ—¶é—´å¤æ‚åº¦å°±ä¸ºO(n*log(n/m)) </li><li>å½“mçš„æ•°é‡éå¸¸æ¥è¿‘nçš„æ—¶å€™ï¼Œé‚£ä¹ˆlog(n/m)å°±æ˜¯ä¸€ä¸ªéå¸¸å°çš„å¸¸é‡ï¼Œè¿™æ—¶å€™æ¡¶æ’åºçš„æ—¶é—´å¤æ‚åº¦å°±æ¥è¿‘O(n)äº†</li></ul></li><li>ä¼˜åŠ£åŠ¿<ul><li>å¯¹æ•°æ®æœ¬èº«è¦æ±‚æ¯”è¾ƒè‹›åˆ»</li><li>éœ€è¦è¶³å¤Ÿå‡åŒ€ï¼Œå¦åˆ™æ¡¶å†…æ’åºå°±ä¸æ˜¯å¸¸é‡çº§çš„å¤æ‚åº¦äº†</li></ul></li><li>æ¡¶æ’åº  é€‚åˆåœ¨å¤–éƒ¨æ’åºå½“ä¸­<ul><li>æŒ‡æ•°æ®å­˜å‚¨åœ¨å¤–éƒ¨ç£ç›˜å½“ä¸­ï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå†…å­˜æœ‰é™ï¼Œæ— æ³•å°†æ•°æ®å…¨éƒ¨åŠ è½½åˆ°å†…å­˜å½“ä¸­ </li><li>é¡ºåºè¿›è¡Œåˆ’åˆ†ï¼ŒæŒ¨ä¸ªé¡ºæ¬¡æ”¾åˆ°å†…å­˜å½“ä¸­</li></ul></li></ul><h1 id="2-è®¡æ•°æ’åº-Counting-Sort"><a href="#2-è®¡æ•°æ’åº-Counting-Sort" class="headerlink" title="2. è®¡æ•°æ’åº Counting Sort"></a>2. è®¡æ•°æ’åº Counting Sort</h1><p>ç±»ä¼¼äºæ¡¶æ’åºï¼Œä½†æ˜¯æ¯ä¸ªæ¡¶é‡Œé¢å­˜å‚¨çš„åªæ˜¯ä¸ªæ•°</p><pre><code>// è®¡æ•°æ’åºï¼Œaæ˜¯æ•°ç»„ï¼Œnæ˜¯æ•°ç»„å¤§å°ã€‚å‡è®¾æ•°ç»„ä¸­å­˜å‚¨çš„éƒ½æ˜¯éè´Ÿæ•´æ•°ã€‚public void countingSort(int[] a, int n) {  if (n &lt;= 1) return;  // æŸ¥æ‰¾æ•°ç»„ä¸­æ•°æ®çš„èŒƒå›´  int max = a[0];  for (int i = 1; i &lt; n; ++i) {    if (max &lt; a[i]) {      max = a[i];    }  }  int[] c = new int[max + 1]; // ç”³è¯·ä¸€ä¸ªè®¡æ•°æ•°ç»„cï¼Œä¸‹æ ‡å¤§å°[0,max]  for (int i = 0; i &lt;= max; ++i) {    c[i] = 0;  }  // è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ä¸ªæ•°ï¼Œæ”¾å…¥cä¸­  for (int i = 0; i &lt; n; ++i) {    c[a[i]]++;  }  // ä¾æ¬¡ç´¯åŠ   for (int i = 1; i &lt;= max; ++i) {    c[i] = c[i-1] + c[i];  }  // ä¸´æ—¶æ•°ç»„rï¼Œå­˜å‚¨æ’åºä¹‹åçš„ç»“æœ  int[] r = new int[n];  // è®¡ç®—æ’åºçš„å…³é”®æ­¥éª¤ï¼Œæœ‰ç‚¹éš¾ç†è§£  for (int i = n - 1; i &gt;= 0; --i) {    int index = c[a[i]]-1;    r[index] = a[i];    c[a[i]]--;  }  // å°†ç»“æœæ‹·è´ç»™aæ•°ç»„  for (int i = 0; i &lt; n; ++i) {    a[i] = r[i];  }}</code></pre><h1 id="3-åŸºæ•°æ’åº-Radix-Sort"><a href="#3-åŸºæ•°æ’åº-Radix-Sort" class="headerlink" title="3. åŸºæ•°æ’åº Radix Sort"></a>3. åŸºæ•°æ’åº Radix Sort</h1><p>æ’10ä¸‡ä¸ªæ‰‹æœºå·ç ï¼Œä»å°åˆ°å¤§æ¥æ’åºï¼Ÿ </p><p>æŒ‰ç…§ä½æ¥æ’ï¼Œéœ€è¦é€‰ç”¨ç¨³å®šæ€§çš„ç®—æ³•æ¥åšã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(9)-æ’åº(å½’å¹¶ å¿«æ’)</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-9-%E6%8E%92%E5%BA%8F-%E5%BD%92%E5%B9%B6-%E5%BF%AB%E6%8E%92/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-9-%E6%8E%92%E5%BA%8F-%E5%BD%92%E5%B9%B6-%E5%BF%AB%E6%8E%92/</url>
      
        <content type="html"><![CDATA[<p>è¿™èŠ‚ä¸»è¦è®²å½’å¹¶æ’åºå’Œå¿«é€Ÿæ’åºï¼ŒäºŒè€…å…¶å®éƒ½ç”¨äº†åˆ†æ²»çš„æ€æƒ³ï¼Œå¯ä»¥å€Ÿé‰´è¿™ä¸ªæ€æƒ³ï¼Œæ¥è§£å†³è¯¸å¦‚â€œå¦‚ä½•åœ¨O(n)çš„æ—¶é—´å¤æ‚åº¦å†…æŸ¥æ‰¾ä¸€ä¸ªæ— åºæ•°ç»„ä¸­çš„ç¬¬kå¤§å…ƒç´ â€è¿™æ ·çš„é—®é¢˜ã€‚</p><h1 id="1-å½’å¹¶æ’åº"><a href="#1-å½’å¹¶æ’åº" class="headerlink" title="1. å½’å¹¶æ’åº"></a>1. å½’å¹¶æ’åº</h1><p><img src="https://i.loli.net/2020/02/10/fVpOLyXAhjn2cKW.jpg" alt="fig1.jpg"></p><ul><li><p>å½’å¹¶æ’åº</p><ul><li>åˆ†æ²»æ€æƒ³</li><li>åˆ†æ²»æ˜¯ä¸€ç§è§£å†³é—®é¢˜çš„å¤„ç†æ€æƒ³ï¼Œé€’å½’æ˜¯ä¸€ç§ç¼–ç¨‹æŠ€å·§</li><li>å’Œé€’å½’çš„ä¸‰è¦ç´ å¾ˆç±»ä¼¼ï¼Œå…ˆåˆ†æå¾—å‡ºé€’æ¨å…¬å¼ï¼Œç„¶åæ‰¾åˆ°ç»ˆæ­¢æ¡ä»¶ï¼Œå†å°†é€’æ¨å…¬å¼ç¿»è¯‘æˆé€’å½’ä»£ç ã€‚</li></ul></li><li><p>æ³¨æ„æ˜¯åˆ†æˆäº†åˆ†å¼€å’Œåˆå¹¶ä¸¤ä¸ªè¿‡ç¨‹çš„ï¼Œåœ¨åˆå¹¶çš„è¿‡ç¨‹å½“ä¸­ï¼Œéœ€è¦éå†ä¸¤ä¸ªæœ‰åºå­é›†ï¼Œç›¸äº’æ¯”è¾ƒå¤§å°ï¼Œç„¶åæ”¾ç½®åœ¨å¦å¤–ä¸€ä¸ªç©ºé—´å½“ä¸­</p></li></ul><pre><code>é€’æ¨å…¬å¼ï¼šmerge_sort(pâ€¦r) = merge(merge_sort(pâ€¦q), merge_sort(q+1â€¦r))ç»ˆæ­¢æ¡ä»¶ï¼šp &gt;= r ä¸ç”¨å†ç»§ç»­åˆ†è§£// å½’å¹¶æ’åºç®—æ³•, A æ˜¯æ•°ç»„ï¼Œn è¡¨ç¤ºæ•°ç»„å¤§å°merge_sort(A, n) {  merge_sort_c(A, 0, n-1)}// é€’å½’è°ƒç”¨å‡½æ•°merge_sort_c(A, p, r) {  // é€’å½’ç»ˆæ­¢æ¡ä»¶  if p &gt;= r  then return  // å– p åˆ° r ä¹‹é—´çš„ä¸­é—´ä½ç½® q  q = (p+r) / 2  // åˆ†æ²»é€’å½’  merge_sort_c(A, p, q)  merge_sort_c(A, q+1, r)  // å°† A[p...q] å’Œ A[q+1...r] åˆå¹¶ä¸º A[p...r]  merge(A[p...r], A[p...q], A[q+1...r])}</code></pre><ul><li>ç¨³å®šæ’åº</li><li>æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog(n))</li><li>éœ€è¦å€ŸåŠ©é¢å¤–ç©ºé—´ï¼Œä¸æ˜¯åŸåœ°æ’åºç®—æ³•  ç©ºé—´å¤æ‚åº¦ O(n) æ¯æ¬¡æå®Œå°±ä¼šç›´æ¥é‡Šæ”¾æ‰äº†</li></ul><h1 id="2-å¿«é€Ÿæ’åº"><a href="#2-å¿«é€Ÿæ’åº" class="headerlink" title="2. å¿«é€Ÿæ’åº"></a>2. å¿«é€Ÿæ’åº</h1><p><img src="https://i.loli.net/2020/02/10/J6wH1nKPtv9qIAm.jpg" alt="fig2.jpg"></p><ul><li>å¿«æ’çš„æ€æƒ³<ul><li>å¦‚æœè¦æ’åºæ•°ç»„ä¸­ä¸‹æ ‡ä»påˆ°rä¹‹é—´çš„ä¸€ç»„æ•°æ®ï¼Œæˆ‘ä»¬é€‰æ‹©påˆ°rä¹‹é—´çš„ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸ºpivot(åˆ†åŒºç‚¹) </li><li>æˆ‘ä»¬éå† p åˆ° r ä¹‹é—´çš„æ•°æ®ï¼Œå°†å°äº pivot çš„æ”¾åˆ°å·¦è¾¹ï¼Œå°†å¤§äº pivot çš„æ”¾åˆ°å³è¾¹ï¼Œå°† pivot æ”¾åˆ°ä¸­é—´ã€‚ç»è¿‡è¿™ä¸€æ­¥éª¤ä¹‹åï¼Œæ•°ç»„ p åˆ° r ä¹‹é—´çš„æ•°æ®å°±è¢«åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå‰é¢ p åˆ° q-1 ä¹‹é—´éƒ½æ˜¯å°äº pivot çš„ï¼Œä¸­é—´æ˜¯ pivotï¼Œåé¢çš„ q+1 åˆ° r ä¹‹é—´æ˜¯å¤§äº pivot çš„ã€‚</li><li>å¿«é€Ÿæ’åºæ˜¯ä¸€ç§ä¸ç¨³å®šçš„æ’åºæ–¹æ³•ï¼Œå› ä¸ºè¦å®ç°swap</li></ul></li></ul><pre><code>é€’æ¨å…¬å¼ï¼šquick_sort(pâ€¦r) = quick_sort(pâ€¦q-1) + quick_sort(q+1, r)ç»ˆæ­¢æ¡ä»¶ï¼šp &gt;= r// å¿«é€Ÿæ’åºï¼ŒA æ˜¯æ•°ç»„ï¼Œn è¡¨ç¤ºæ•°ç»„çš„å¤§å°quick_sort(A, n) {  quick_sort_c(A, 0, n-1)}// å¿«é€Ÿæ’åºé€’å½’å‡½æ•°ï¼Œp,r ä¸ºä¸‹æ ‡quick_sort_c(A, p, r) {  if p &gt;= r then return  q = partition(A, p, r) // è·å–åˆ†åŒºç‚¹  quick_sort_c(A, p, q-1)  quick_sort_c(A, q+1, r)}</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(8)-æ’åº(å†’æ³¡ æ’å…¥ é€‰æ‹©)</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-8-%E6%8E%92%E5%BA%8F-%E5%86%92%E6%B3%A1-%E6%8F%92%E5%85%A5-%E9%80%89%E6%8B%A9/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-8-%E6%8E%92%E5%BA%8F-%E5%86%92%E6%B3%A1-%E6%8F%92%E5%85%A5-%E9%80%89%E6%8B%A9/</url>
      
        <content type="html"><![CDATA[<ul><li>è¿™é‡Œä»‹ç»ä¸‰å¤§ç±»å‹çš„æ’åº<ul><li>å†’æ³¡ï¼Œæ’å…¥ï¼Œé€‰æ‹©  O(n^2)</li><li>å¿«æ’ï¼Œå½’å¹¶ O(nlogn)</li><li>æ¡¶ï¼Œè®¡æ•°ï¼ŒåŸºæ•°</li></ul></li></ul><h1 id="1-å¦‚ä½•åˆ†æä¸€ä¸ªæ’åºç®—æ³•ï¼Ÿ"><a href="#1-å¦‚ä½•åˆ†æä¸€ä¸ªæ’åºç®—æ³•ï¼Ÿ" class="headerlink" title="1. å¦‚ä½•åˆ†æä¸€ä¸ªæ’åºç®—æ³•ï¼Ÿ"></a>1. å¦‚ä½•åˆ†æä¸€ä¸ªæ’åºç®—æ³•ï¼Ÿ</h1><h2 id="1-1-æ‰§è¡Œæ•ˆç‡"><a href="#1-1-æ‰§è¡Œæ•ˆç‡" class="headerlink" title="1.1 æ‰§è¡Œæ•ˆç‡"></a>1.1 æ‰§è¡Œæ•ˆç‡</h2><ul><li>æœ€å¥½æƒ…å†µï¼Œæœ€åæƒ…å†µï¼Œå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦<ul><li>è¦çŸ¥é“é’ˆå¯¹äºæ•°æ®é›†çš„ç‰¹å¾ï¼Œéœ€è¦é‡‡å–å“ªä¸€ç§æ’åºç®—æ³• </li></ul></li><li>æ—¶é—´å¤æ‚åº¦çš„ç³»æ•°ï¼Œå¸¸æ•°ï¼Œä½é˜¶<ul><li>å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¢å¯¹è§„æ¨¡æ¯”è¾ƒå°çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†ç³»æ•°ï¼Œå¸¸æ•°ï¼Œä½é˜¶éƒ½è€ƒè™‘è¿›å»æ‰å¯ä»¥çš„ </li></ul></li><li>æ¯”è¾ƒæ¬¡æ•°å’Œäº¤æ¢æ¬¡æ•°<ul><li>å¯¹äºåŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œä¼šæ¶‰åŠåˆ°å…ƒç´ å¤§å°çš„æ¯”è¾ƒä»¥åŠå…ƒç´ çš„äº¤æ¢æˆ–è€…ç§»åŠ¨ï¼Œå› æ­¤å½“æˆ‘ä»¬åœ¨åˆ†ææ’åºç®—æ³•çš„æ‰§è¡Œæ•ˆç‡çš„æ—¶å€™ï¼Œåº”è¯¥æŠŠæ¯”è¾ƒæ¬¡æ•°å’Œäº¤æ¢æ¬¡æ•°ä¹Ÿè€ƒè™‘è¿›å» </li></ul></li></ul><h2 id="1-2-æ’åºç®—æ³•çš„å†…å­˜æ¶ˆè€—"><a href="#1-2-æ’åºç®—æ³•çš„å†…å­˜æ¶ˆè€—" class="headerlink" title="1.2 æ’åºç®—æ³•çš„å†…å­˜æ¶ˆè€—"></a>1.2 æ’åºç®—æ³•çš„å†…å­˜æ¶ˆè€—</h2><p>å†…å­˜æ¶ˆè€—å¯ä»¥ç”¨ç©ºé—´å¤æ‚åº¦æ¥è¡¡é‡ï¼Œæ¥çœ‹ç®—æ³•ç©¶ç«Ÿæ¶ˆè€—äº†å¤šå°‘å†…å­˜ç©ºé—´</p><h2 id="1-3-æ’åºç®—æ³•çš„ç¨³å®šæ€§"><a href="#1-3-æ’åºç®—æ³•çš„ç¨³å®šæ€§" class="headerlink" title="1.3 æ’åºç®—æ³•çš„ç¨³å®šæ€§"></a>1.3 æ’åºç®—æ³•çš„ç¨³å®šæ€§</h2><p>å¦‚æœå¾…æ’åºçš„åºåˆ—ä¸­å­˜åœ¨å€¼ç›¸ç­‰çš„å…ƒç´ ï¼Œç»è¿‡æ’åºä»¥åï¼Œç›¸ç­‰å…ƒç´ ä¹‹é—´åŸæœ‰çš„å…ˆåé¡ºåºä¸å˜</p><p>ç¨³å®šæ€§å¾ˆé‡è¦ï¼Œè¡¨ç°åœ¨è¦å¯¹å‡ ä¸ªå½±å“å› ç´ æ¥æŒ‰ç…§æ­¥éª¤è¿›è¡Œæ’åºçš„æƒ…å†µã€‚</p><h1 id="2-ç®—æ³•åˆ†æ"><a href="#2-ç®—æ³•åˆ†æ" class="headerlink" title="2. ç®—æ³•åˆ†æ"></a>2. ç®—æ³•åˆ†æ</h1><h2 id="2-1-å†’æ³¡æ’åº"><a href="#2-1-å†’æ³¡æ’åº" class="headerlink" title="2.1 å†’æ³¡æ’åº"></a>2.1 å†’æ³¡æ’åº</h2><ul><li>æ“ä½œç›¸é‚»çš„ä¸¤ä¸ªæ•°æ®<ul><li>æ¯æ¬¡å†’æ³¡éƒ½ä¼šå¯¹ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œ</li><li>çœ‹æ˜¯å¦æ»¡è¶³å¤§å°å…³ç³»è¦æ±‚</li><li>å¦‚æœä¸æ»¡è¶³å°±è®©å®ƒå€†äº’æ¢ï¼Œä¸€æ¬¡å†’æ³¡è‡³å°‘ä¼šè®©ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®ï¼Œé‡å¤næ¬¡ï¼Œå°±å®Œæˆäº†nä¸ªæ•°æ®çš„æ’åºå·¥ä½œ</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/10/zUxOmSFQJLiyGMD.jpg" alt="fig1.jpg"></p><p><img src="https://i.loli.net/2020/02/10/o8L1DHgENfb2su7.jpg" alt="fig2.jpg"></p><pre><code>// å†’æ³¡æ’åºï¼Œa è¡¨ç¤ºæ•°ç»„ï¼Œn è¡¨ç¤ºæ•°ç»„å¤§å°public void bubbleSort(int[] a, int n) {  if (n &lt;= 1) return; for (int i = 0; i &lt; n; ++i) {    // æå‰é€€å‡ºå†’æ³¡å¾ªç¯çš„æ ‡å¿—ä½ï¼Œå¦‚æœæ²¡æœ‰å†’æ³¡ï¼Œè¯´æ˜å·²ç»æœ‰åºäº†ï¼Œä¸ç”¨å†è¿›è¡Œä¸‹å»äº†    boolean flag = false;    // -iæ˜¯å› ä¸ºåœ¨è¿›è¡Œç¬¬iè½®æ¬¡çš„æ—¶å€™ï¼Œæœ€æœ«å°¾çš„æ˜¯å·²ç»æ’å¥½äº†çš„iä¸ªæ•°    for (int j = 0; j &lt; n - i - 1; ++j) {      if (a[j] &gt; a[j+1]) { // äº¤æ¢        int tmp = a[j];        a[j] = a[j+1];        a[j+1] = tmp;        flag = true;  // è¡¨ç¤ºæœ‰æ•°æ®äº¤æ¢            }    }    if (!flag) break;  // æ²¡æœ‰æ•°æ®äº¤æ¢ï¼Œæå‰é€€å‡º  }}</code></pre><ul><li>å†’æ³¡æ’åºæ˜¯åŸåœ°æ’åºç®—æ³•ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</li><li>å†’æ³¡æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•</li><li>æ—¶é—´å¤æ‚åº¦<ul><li>æœ€å¥½æƒ…å†µ O(n)</li><li>æœ€åæƒ…å†µ O(n^2)</li></ul></li></ul><h2 id="2-2-æ’å…¥æ’åº"><a href="#2-2-æ’å…¥æ’åº" class="headerlink" title="2.2 æ’å…¥æ’åº"></a>2.2 æ’å…¥æ’åº</h2><p>å¯¹äºä¸€ä¸ªæœ‰åºçš„æ•°ç»„æ¥è¯´ï¼Œæˆ‘ä»¬å¾€é‡Œé¢æ·»åŠ ä¸€ä¸ªæ–°çš„æ•°æ®ï¼Œå°±æ˜¯è¦éå†æ•°ç»„ï¼Œæ‰¾åˆ°æ•°æ®åº”è¯¥æ’å…¥çš„ä½ç½®å¹¶å°†å…¶æ’å…¥å³å¯ã€‚</p><p><img src="https://i.loli.net/2020/02/10/GIRQpFxgunetcr7.jpg" alt="fig3.jpg"></p><ul><li>å°†æ•°ç»„ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤ä¸ªåŒºé—´ï¼Œå·²æ’åºç©ºé—´å’Œæœªæ’åºç©ºé—´</li><li>åˆå§‹å·²æ’åºç©ºé—´æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå³æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>æ’å…¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å–æœªæ’åºåŒºé—´å½“ä¸­çš„å…ƒç´ ï¼Œåœ¨å·²æ’åºç©ºé—´ä¸­æ‰¾åˆ°åˆé€‚çš„æ’å…¥ä½ç½®å°†å…¶æ’å…¥ï¼Œå¹¶ä¿è¯å·²æ’åºç©ºé—´çš„æ•°æ®ä¸€è‡´éƒ½æ˜¯æœ‰åºçš„</li><li>é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æœªæ’åºç©ºé—´ä¸­çš„å…ƒç´ ä¸ºç©º</li></ul><p><img src="https://i.loli.net/2020/02/10/r9yq3FfdKginlQI.jpg" alt="fig4.jpg"></p><pre><code>// æ’å…¥æ’åºï¼Œa è¡¨ç¤ºæ•°ç»„ï¼Œn è¡¨ç¤ºæ•°ç»„å¤§å°public void insertionSort(int[] a, int n) {  if (n &lt;= 1) return;  for (int i = 1; i &lt; n; ++i) {    int value = a[i];    int j = i - 1;    // æŸ¥æ‰¾æ’å…¥çš„ä½ç½®    for (; j &gt;= 0; --j) {      if (a[j] &gt; value) {        a[j+1] = a[j];  // æ•°æ®ç§»åŠ¨      } else {        break;      }    }    // è¿™é‡Œæ³¨æ„å¾ªç¯å½“ä¸­j--äº†ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯a[j+1]    a[j+1] = value; // æ’å…¥æ•°æ®  }}</code></pre><ul><li>åŸåœ°æ’åºç®—æ³•ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</li><li>ç¨³å®šçš„æ’åºç®—æ³•</li><li>æ—¶é—´å¤æ‚åº¦<ul><li>æœ€å¥½æƒ…å†µO(n)</li><li>æœ€åæƒ…å†µO(n^2)</li></ul></li></ul><h2 id="2-3-é€‰æ‹©æ’åº"><a href="#2-3-é€‰æ‹©æ’åº" class="headerlink" title="2.3 é€‰æ‹©æ’åº"></a>2.3 é€‰æ‹©æ’åº</h2><p>åŒæ ·æ˜¯åˆ†æˆå·²æ’åºç©ºé—´å’Œæœªæ’åºç©ºé—´ï¼Œä½†æ˜¯é€‰æ‹©æ’åºæ¯æ¬¡éƒ½ä¼šä»æœªæ’åºç©ºé—´å½“ä¸­æ‰¾åˆ°æœ€å°çš„å…ƒç´ ï¼Œå°†å…¶æ”¾åˆ°å·²æ’åºåŒºé—´çš„æœ«å°¾</p><p><img src="https://i.loli.net/2020/02/10/uZH8xBFPs247nCr.jpg" alt="fig5.jpg"></p><ul><li><p>åŸåœ°æ’åºç®—æ³•</p></li><li><p>ä¸ç¨³å®šçš„ï¼Œå› ä¸ºæ¯æ¬¡éƒ½è¦æ‰¾å‰©ä½™çš„æœªæ’åºçš„å…ƒç´ å½“ä¸­çš„æœ€å°å€¼ï¼Œå¹¶å’Œå‰é¢çš„å…ƒç´ äº¤æ¢ä½ç½®</p><p>  public int[] selectSort(int arr[], int n) {</p><pre><code>for (int i = 0; i &lt; n; i++) {  int index = min(i+1, n);   swap(arr[index], arr[i]);}</code></pre></li></ul><pre><code>  return arr;}</code></pre><h1 id="3-å†’æ³¡-æ’å…¥-é€‰æ‹©æ’åºçš„æ¯”è¾ƒ"><a href="#3-å†’æ³¡-æ’å…¥-é€‰æ‹©æ’åºçš„æ¯”è¾ƒ" class="headerlink" title="3. å†’æ³¡ æ’å…¥ é€‰æ‹©æ’åºçš„æ¯”è¾ƒ"></a>3. å†’æ³¡ æ’å…¥ é€‰æ‹©æ’åºçš„æ¯”è¾ƒ</h1><p>ä¸‰è€…çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å‡ä¸ºO(n^2)ã€‚ä½†æ˜¯å®é™…ä¸Šè¿˜æ˜¯æœ‰ä¸åŒçš„ï¼Œå†’æ³¡ä¸å¦‚æ’å…¥ä¼˜ç§€ï¼Œå› ä¸ºåœ¨å¾ªç¯å½“ä¸­ï¼Œå†’æ³¡æœ‰ä¸‰ä¸ªæ“ä½œï¼Œè€Œæ’å…¥åªæœ‰ä¸€ä¸ªã€‚åœ¨å®é™…æƒ…å†µå½“ä¸­ï¼Œæ’å…¥ä¼šæ¯”å†’æ³¡å¿«ä¸å°‘ã€‚è€Œé€‰æ‹©æ’åºçš„é—®é¢˜æ˜¯å› ä¸ºå®ƒçš„é€»è¾‘æ˜¯åœ¨æœªé€‰æ‹©çš„æ•°åˆ—é‡Œé¢é€‰æ‹©æœ€å°çš„ï¼Œæ”¾åˆ°å·²æ’åºçš„æœ«ç«¯ï¼Œè¿™é‡Œæ˜¯ä¸€å®šä¼šæœ‰ä¸€ä¸ªswapå‘ç”Ÿçš„ï¼Œè¿™å¯¼è‡´æ’åºä¸ç¨³å®šï¼Œå³å¯¹äºæœ‰ç›¸åŒå€¼çš„ï¼Œæ’åˆ—é¡ºåºå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™ä¼šåœ¨å®é™…åº”ç”¨ä¸­é€ æˆé—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(7)-é€’å½’</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-7-%E9%80%92%E5%BD%92/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-7-%E9%80%92%E5%BD%92/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¦‚ä½•ç†è§£é€’å½’"><a href="#1-å¦‚ä½•ç†è§£é€’å½’" class="headerlink" title="1.å¦‚ä½•ç†è§£é€’å½’"></a>1.å¦‚ä½•ç†è§£é€’å½’</h1><ul><li>é€’<ul><li>å»çš„è¿‡ç¨‹ </li></ul></li><li>å½’<ul><li>å›æ¥çš„è¿‡ç¨‹</li></ul></li></ul><p>ç»™æˆ‘çš„æ„Ÿè§‰æ˜¯å…ˆåŠªåŠ›å»æº¯æºï¼Œæ‹¿åˆ°æºæ•°æ®ä»¥åå°±ç›¸å½“äºå¤šäº†ä¸€ä¸ªä¿¡æ¯ï¼Œç„¶åå†ä¾æ‰˜å¤šäº†ä¸€ä¸ªçš„ä¿¡æ¯ï¼Œæ¥è§£å†³é—®é¢˜ã€‚</p><pre><code>f(n) = f(n-1) + 1 </code></pre><h1 id="2-é€’å½’çš„æ¡ä»¶"><a href="#2-é€’å½’çš„æ¡ä»¶" class="headerlink" title="2. é€’å½’çš„æ¡ä»¶"></a>2. é€’å½’çš„æ¡ä»¶</h1><ul><li>ä¸€ä¸ªé—®é¢˜çš„è§£å¯ä»¥åˆ†è§£ä¸ºå‡ ä¸ªå­é—®é¢˜çš„è§£<ul><li>å­é—®é¢˜æŒ‡æ•°æ®è§„æ¨¡æ›´å°çš„è§£</li></ul></li><li>è¿™ä¸ªé—®é¢˜ä¸åˆ†è§£ä¹‹åçš„å­é—®é¢˜ï¼Œé™¤äº†æ•°æ®è§„æ¨¡çš„ä¸åŒï¼Œæ±‚è§£æ€è·¯å®Œå…¨ä¸€æ ·</li><li>å­˜åœ¨é€’å½’ç»ˆæ­¢æ¡ä»¶</li></ul><h1 id="3-å¦‚ä½•å†™é€’å½’ä»£ç "><a href="#3-å¦‚ä½•å†™é€’å½’ä»£ç " class="headerlink" title="3. å¦‚ä½•å†™é€’å½’ä»£ç "></a>3. å¦‚ä½•å†™é€’å½’ä»£ç </h1><ul><li>å†™å‡ºé€’å½’å…¬å¼</li><li>æ‰¾åˆ°ç»ˆæ­¢æ¡ä»¶</li></ul><p>E.G </p><p>nä¸ªå°é˜¶ï¼Œæ¯æ¬¡å¯ä»¥è·¨è¿‡1ä¸ªæˆ–è€…2ä¸ªï¼Œé—®ä¸€å…±å¤šå°‘ç§èµ°æ³•ï¼Ÿ </p><ul><li>å¯ä»¥åˆ’åˆ†ä¸ºå­é—®é¢˜ï¼Œå³ä¸€å…±çš„èµ°æ³•ç­‰äºæˆ‘å…ˆèµ°ä¸€æ­¥ï¼Œå‰©ä¸‹çš„n-1å…±åŒçš„èµ°æ³•å’Œå…ˆèµ°ä¸¤æ­¥ï¼Œå‰©ä¸‹çš„n-1å…±åŒçš„èµ°æ³•çš„å’Œã€‚å°±æœ‰äº†ä¸€ä¸ªé€’å½’å…¬å¼ï¼š</li></ul><pre><code>f(n) = f(n-1) + f(n-2)</code></pre><p>ç»ˆæ­¢æ¡ä»¶ï¼Œçœ‹æœ€åå‡ ä¸ªcorner caseï¼Œåªæœ‰ä¸€ä¸ªå°é˜¶ï¼Œåªæœ‰ä¸¤ä¸ªå°é˜¶ï¼Œç„¶åç”¨3ï¼Œ4æ¥éªŒè¯ä¸€ä¸‹ã€‚</p><blockquote><p>å†™é€’å½’ä»£ç çš„å…³é”®å°±æ˜¯æ‰¾åˆ°å¦‚ä½•å°†å¤§é—®é¢˜åˆ†è§£ä¸ºå°é—®é¢˜çš„è§„å¾‹ï¼Œå¹¶ä¸”åŸºäºæ­¤å†™å‡ºé€’æ¨å…¬å¼ï¼Œç„¶åå†æ¨æ•²å‡ºç»ˆæ­¢æ¡ä»¶ï¼Œæœ€ç»ˆå°†é€’æ¨å…¬å¼å’Œç»ˆæ­¢æ¡ä»¶ç¿»è¯‘æˆä»£ç </p></blockquote><p>ä¸è¦äººä¸ºåŠ å¤§éš¾åº¦ï¼Œé‡åˆ°é€’å½’ï¼ŒæŠ½è±¡æˆä¸€ä¸ªé€’æ¨å…¬å¼ï¼Œä¸å†ä¸€å±‚å±‚çš„æƒ³å…¶è°ƒç”¨å…³ç³»ï¼Œä¸è¦è¯•å›¾ç”¨äººè„‘å»åˆ†è§£é€’å½’çš„æ­¥éª¤</p><p>åˆ†è§£å­é—®é¢˜çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬å°†å…¶åˆ†è§£æˆå‡ ä¸ªå­é—®é¢˜B C Dä»¥åï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯åœ¨å‡è®¾å­é—®é¢˜ BCDéƒ½å·²ç»è§£å†³çš„å‰æä¸‹ï¼Œæ€è€ƒå¦‚ä½•è§£å†³é—®é¢˜Aã€‚è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥æ€è€ƒé—®é¢˜Aå’Œå­é—®é¢˜B,C,Dä¸¤å±‚ä¹‹é—´çš„å…³ç³»å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦å†ä¸€å±‚ä¸€å±‚å¾€ä¸‹æ€è€ƒæ›´æ·±çš„å­é—®é¢˜ä¹‹é—´çš„å…³ç³»äº†ã€‚å±è”½æ‰é€’å½’çš„å®ç°ç»†èŠ‚ï¼Œæˆ‘ä»¬ç†è§£èµ·æ¥å°±ä¼šå®¹æ˜“å¾ˆå¤šäº†</p><h1 id="4-è­¦æƒ•å †æ ˆæº¢å‡º"><a href="#4-è­¦æƒ•å †æ ˆæº¢å‡º" class="headerlink" title="4. è­¦æƒ•å †æ ˆæº¢å‡º"></a>4. è­¦æƒ•å †æ ˆæº¢å‡º</h1><ul><li>é€’å½’å®¹æ˜“å †æ ˆæº¢å‡º</li><li>å‡½æ•°è°ƒç”¨ä¼šä½¿ç”¨æ ˆæ¥ä¿å­˜ä¸´æ—¶å˜é‡ï¼Œæ¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œéƒ½ä¼šå°†ä¸´æ—¶å˜é‡å°è£…ä¸ºæ ˆå¸§å‹å…¥å†…å­˜æ ˆå½“ä¸­ã€‚ç­‰å‡½æ•°æ‰§è¡Œå®Œæˆè¿”å›æ—¶ï¼Œæ‰å‡ºæ ˆã€‚</li><li>ç³»ç»Ÿæ ˆæˆ–è€…è™šæ‹Ÿæœºæ ˆç©ºé—´éƒ½ä¸å¤§ï¼Œå¦‚æœé€’å½’å±‚å¾ˆå¤šçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å †æ ˆæº¢å‡ºçš„é£é™©ã€‚</li><li>å¯ä»¥åœ¨ä»£ç ä¸­é™åˆ¶é€’å½’è°ƒç”¨çš„æœ€å¤§æ·±åº¦æ¥è§£å†³è¿™ä¸ªé—®é¢˜</li></ul><p>é€’å½’å¥½å¤„æ˜¯è¡¨è¾¾èƒ½åŠ›å¼ºï¼Œå¾ˆå®¹æ˜“å»ç†é¡ºå…¶æƒ³è¦è¡¨è¾¾çš„å†…å®¹ï¼›åå¤„æ˜¯ç©ºé—´å¤æ‚åº¦ä¼šæ¯”è¾ƒé«˜ï¼Œå› ä¸ºæ¯æ¬¡é€’å½’çš„æ—¶å€™éƒ½éœ€è¦åœ¨å†…å­˜æ ˆä¸­ä¿å­˜ä¸€æ¬¡ç°åœºæ•°æ®ï¼Œæ‰€ä»¥åœ¨åˆ†æé€’å½’ä»£ç ç©ºé—´å¤æ‚åº¦çš„æ—¶å€™ï¼Œæ˜¯éœ€è¦é¢å¤–è€ƒè™‘è¿™éƒ¨åˆ†çš„å¼€é”€çš„ã€‚</p><h1 id="5-é‡å¤è®¡ç®—é—®é¢˜"><a href="#5-é‡å¤è®¡ç®—é—®é¢˜" class="headerlink" title="5. é‡å¤è®¡ç®—é—®é¢˜"></a>5. é‡å¤è®¡ç®—é—®é¢˜</h1><p>å­æ­¥éª¤ä¼šè¢«è®¡ç®—äº†å¾ˆå¤šå¾ˆå¤šéï¼Œä¸ºäº†é¿å…è¿™ç§é‡å¤è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›æ•°æ®ç»“æ„æ¥ä¿å­˜å·²ç»æ±‚è§£è¿‡å¾—f(k)ã€‚å½“é€’å½’è°ƒç”¨åˆ°f(k)çš„æ—¶å€™ï¼Œå…ˆçœ‹ä¸‹æ˜¯å¦å·²ç»æ±‚è§£è¿‡äº†</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€’å½’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(6)-é˜Ÿåˆ—</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-6-%E9%98%9F%E5%88%97/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-6-%E9%98%9F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<p>CPUèµ„æºæœ‰é™ï¼Œä»»åŠ¡çš„å¤„ç†é€Ÿåº¦å’Œçº¿ç¨‹ä¸ªæ•°å¹¶ä¸æ˜¯çº¿æ€§æ­£ç›¸å…³çš„ã€‚ç›¸åçš„ï¼Œè¿‡å¤šçš„çº¿ç¨‹ä¼šå¯¼è‡´CPUé¢‘ç¹åˆ‡æ¢ï¼Œå¤„ç†æ€§èƒ½ä¸‹é™ã€‚å› æ­¤ï¼Œçº¿ç¨‹æ± çš„å¤§å°ä¸€èˆ¬éƒ½æ˜¯ç»¼åˆè€ƒè™‘è¦å¤„ç†ä»»åŠ¡çš„ç‰¹ç‚¹å’Œç¡¬ä»¶ç¯å¢ƒï¼Œæ¥äº‹å…ˆè®¾ç½®çš„ã€‚</p><p>å½“æˆ‘ä»¬å‘å›ºå®šå¤§å°çš„çº¿ç¨‹æ± ä¸­è¯·æ±‚ä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œå¦‚æœçº¿ç¨‹æ± ä¸­æ²¡æœ‰ç©ºé—²èµ„æºï¼Œå¦‚ä½•å¤„ç†è¿™ä¸ªè¯·æ±‚å‘¢ï¼Ÿ â€”â€“&gt; é˜Ÿåˆ—</p><p>æ“ä½œå—é™çš„çº¿æ€§è¡¨ã€‚</p><h1 id="1-ç†è§£é˜Ÿåˆ—"><a href="#1-ç†è§£é˜Ÿåˆ—" class="headerlink" title="1. ç†è§£é˜Ÿåˆ—"></a>1. ç†è§£é˜Ÿåˆ—</h1><ul><li>åŸºæœ¬æ“ä½œ<ul><li>å…¥é˜Ÿ enqueue()   å…¥æ ˆ push()</li><li>å‡ºé˜Ÿ dequeue()   å‡ºæ ˆ pop()</li></ul></li><li>æ“ä½œå—é™çš„çº¿æ€§è¡¨æ•°æ®ç»“æ„</li><li>å¸¦æœ‰ä¸€äº›ç‰¹æ€§çš„é˜Ÿåˆ—<ul><li>å¾ªç¯é˜Ÿåˆ—</li><li>é˜»å¡é˜Ÿåˆ—</li><li>å¹¶å‘é˜Ÿåˆ—</li><li>é¡ºåºé˜Ÿåˆ— - æ•°ç»„å®ç°</li><li>é“¾å¼é˜Ÿåˆ— - é“¾å¼é˜Ÿåˆ—</li></ul></li></ul><p>åœ¨å¾ˆå¤šååº•å±‚ç³»ç»Ÿï¼Œæ¡†æ¶ï¼Œä¸­é—´ä»¶çš„å¼€å‘å½“ä¸­ï¼Œèµ·åˆ°å…³é”®æ€§ä½œç”¨ã€‚æ¯”å¦‚é«˜æ€§èƒ½disruptor,Linuxç¯å½¢ç¼“å­˜ï¼Œéƒ½ç”¨åˆ°äº†å¾ªç¯å¹¶å‘é˜Ÿåˆ—; Java Concurrentå¹¶å‘åŒ…åˆ©ç”¨ArrayBlockingQueueæ¥å®ç°å…¬å¹³é”ã€‚</p><pre><code>// ç”¨æ•°ç»„å®ç°çš„é˜Ÿåˆ—public class ArrayQueue {  // æ•°ç»„ï¼šitemsï¼Œæ•°ç»„å¤§å°ï¼šn  private String[] items;  private int n = 0;  // head è¡¨ç¤ºé˜Ÿå¤´ä¸‹æ ‡ï¼Œtail è¡¨ç¤ºé˜Ÿå°¾ä¸‹æ ‡  private int head = 0;  private int tail = 0;  // ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º capacity çš„æ•°ç»„  public ArrayQueue(int capacity) {    items = new String[capacity];    n = capacity;  }  // å…¥é˜Ÿ  public boolean enqueue(String item) {    // å¦‚æœ tail == n è¡¨ç¤ºé˜Ÿåˆ—å·²ç»æ»¡äº†    if (tail == n) return false;    items[tail] = item;    ++tail;    return true;  }  // å‡ºé˜Ÿ  public String dequeue() {    // å¦‚æœ head == tail è¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©º    if (head == tail) return null;    // ä¸ºäº†è®©å…¶ä»–è¯­è¨€çš„åŒå­¦çœ‹çš„æ›´åŠ æ˜ç¡®ï¼ŒæŠŠ -- æ“ä½œæ”¾åˆ°å•ç‹¬ä¸€è¡Œæ¥å†™äº†    String ret = items[head];    ++head;    return ret;  }}</code></pre><h1 id="2-åŸºäºé“¾è¡¨çš„é˜Ÿåˆ—å®ç°æ–¹æ³•"><a href="#2-åŸºäºé“¾è¡¨çš„é˜Ÿåˆ—å®ç°æ–¹æ³•" class="headerlink" title="2. åŸºäºé“¾è¡¨çš„é˜Ÿåˆ—å®ç°æ–¹æ³•"></a>2. åŸºäºé“¾è¡¨çš„é˜Ÿåˆ—å®ç°æ–¹æ³•</h1><ul><li>ä¸¤ä¸ªæŒ‡é’ˆ<ul><li>headæŒ‡é’ˆ - æŒ‡å‘ç¬¬ä¸€ä¸ªç»“ç‚¹</li><li>tailæŒ‡é’ˆ - æŒ‡å‘æœ€åä¸€ä¸ªç»“ç‚¹</li></ul></li></ul><h1 id="3-å¾ªç¯é˜Ÿåˆ—"><a href="#3-å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="3. å¾ªç¯é˜Ÿåˆ—"></a>3. å¾ªç¯é˜Ÿåˆ—</h1><p>ç”¨æ•°ç»„å®ç°çš„é˜Ÿåˆ—ï¼Œåœ¨tail = nçš„æ—¶å€™ï¼Œä¼šæœ‰æ•°æ®æ¬ç§»æ“ä½œã€‚è¿™æ ·å…¥é˜Ÿæ€§èƒ½å°±ä¼šå—åˆ°å½±å“ã€‚å¾ªç¯é˜Ÿåˆ—çš„å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><ul><li>å¦‚ä½•ç¡®è®¤é˜Ÿç©ºå’Œé˜Ÿæ»¡<ul><li>é˜Ÿç©º head == tail</li><li>é˜Ÿæ»¡ (tail+1)%n = head</li></ul></li></ul><pre><code>public class CircularQueue {  // æ•°ç»„ï¼šitemsï¼Œæ•°ç»„å¤§å°ï¼šn  private String[] items;  private int n = 0;  // head è¡¨ç¤ºé˜Ÿå¤´ä¸‹æ ‡ï¼Œtail è¡¨ç¤ºé˜Ÿå°¾ä¸‹æ ‡  private int head = 0;  private int tail = 0;  // ç”³è¯·ä¸€ä¸ªå¤§å°ä¸º capacity çš„æ•°ç»„  public CircularQueue(int capacity) {    items = new String[capacity];    n = capacity;  }  // å…¥é˜Ÿ  public boolean enqueue(String item) {    // é˜Ÿåˆ—æ»¡äº†    if ((tail + 1) % n == head) return false;    items[tail] = item;    tail = (tail + 1) % n;    return true;  }  // å‡ºé˜Ÿ  public String dequeue() {    // å¦‚æœ head == tail è¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©º    if (head == tail) return null;    String ret = items[head];    head = (head + 1) % n;    return ret;  }}</code></pre><h1 id="4-é˜»å¡é˜Ÿåˆ—å’Œå¹¶å‘é˜Ÿåˆ—"><a href="#4-é˜»å¡é˜Ÿåˆ—å’Œå¹¶å‘é˜Ÿåˆ—" class="headerlink" title="4. é˜»å¡é˜Ÿåˆ—å’Œå¹¶å‘é˜Ÿåˆ—"></a>4. é˜»å¡é˜Ÿåˆ—å’Œå¹¶å‘é˜Ÿåˆ—</h1><ul><li>é˜»å¡é˜Ÿåˆ—<ul><li>åœ¨é˜Ÿåˆ—åŸºç¡€ä¸Šå¢åŠ äº†é˜»å¡æ“ä½œ</li><li>é˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™ï¼Œä»é˜Ÿå¤´å–æ•°æ®ä¼šè¢«é˜»å¡</li><li>å¦‚æœé˜Ÿåˆ—å·²ç»æ»¡äº†ï¼Œé‚£ä¹ˆæ’å…¥æ•°æ®çš„æ“ä½œä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰ç©ºé—²ä½ç½®åå†æ’å…¥æ•°æ®ï¼Œç„¶åå†è¿”å›</li><li>ç”Ÿäº§è€… æ¶ˆè´¹è€…æ¨¡å‹  ç›¸å½“äº</li><li>åŸºäºé˜»å¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åè°ƒç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„ä¸ªæ•°æ¥æé«˜æ•°æ®çš„å¤„ç†æ•ˆç‡</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å¤šå‡ ä¸ªçš„æ¶ˆè´¹è€…ï¼Œæ¥åº”å¯¹ä¸€ä¸ªç”Ÿäº§è€…</li></ul></li><li>å¹¶å‘é˜Ÿåˆ—<ul><li>å®ç°æ–¹æ³•<ul><li>åœ¨enquue()å’Œdequeue()æ–¹æ³•ä¸ŠåŠ é”</li><li>åŸºäºCASåŸå­æ“ä½œ</li></ul></li></ul></li></ul><h1 id="5-å¯¹æ¯”åŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨å®ç°çš„é˜Ÿåˆ—"><a href="#5-å¯¹æ¯”åŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨å®ç°çš„é˜Ÿåˆ—" class="headerlink" title="5. å¯¹æ¯”åŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨å®ç°çš„é˜Ÿåˆ—"></a>5. å¯¹æ¯”åŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨å®ç°çš„é˜Ÿåˆ—</h1><ul><li>åŸºäºé“¾è¡¨çš„å®ç°æ–¹å¼<ul><li>å¯ä»¥å®ç°ä¸€ä¸ªæ”¯æŒæ— é™æ’é˜Ÿçš„æ— ç•Œé˜Ÿåˆ—</li><li>å¯èƒ½ä¼šå¯¼è‡´è¿‡å¤šçš„è¯·æ±‚æ’é˜Ÿç­‰å¾…</li><li>è¯·æ±‚å¤„ç†çš„å“åº”æ—¶é—´ä¼šé•¿å¾ˆå¤š</li><li>å› æ­¤å¯¹äºå“åº”æ—¶é—´æ¯”è¾ƒæ•æ„Ÿçš„ç³»ç»Ÿæ¥è¯´ï¼ŒåŸºäºé“¾è¡¨å®ç°çš„æ— é™æ’é˜Ÿçš„çº¿ç¨‹æ± å°±ä¸æ˜¯å¾ˆåˆé€‚äº†</li></ul></li><li>åŸºäºæ•°ç»„å®ç°çš„æœ‰ç•Œé˜Ÿåˆ—<ul><li>é˜Ÿåˆ—å¤§å°æ˜¯æœ‰é™çš„</li><li>è¶…è¿‡ä¸€å®šæ•°é‡ä»¥åï¼Œè¯·æ±‚å°±ä¼šè¢«æ‹’ç»</li><li>é˜Ÿåˆ—çš„å¤§å°è®¾ç½®å°±ä¼šæ˜¯ä¸ªtrade offäº†</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(5)-æ ˆ</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-5-%E6%A0%88/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-5-%E6%A0%88/</url>
      
        <content type="html"><![CDATA[<p>å¤§å®¶éƒ½å¸¸ç”¨Chromeæµè§ˆå™¨ï¼Œä½ ä¼šå‘ç°åœ¨ä½ åšåé€€æˆ–è€…å‰è¿›æŒ‰é’®æ—¶ï¼Œæµè§ˆå™¨çš„åŠ è½½é€Ÿåº¦éå¸¸å¿«ï¼Œè¿™é‡Œå®é™…ä¸Šæ˜¯ç”¨çš„æ ˆè¿™ä¸ªæ•°æ®ç»“æ„æ¥è¿›è¡Œå¤„ç†çš„ã€‚</p><h1 id="1-å¯¹æ ˆçš„ç†è§£"><a href="#1-å¯¹æ ˆçš„ç†è§£" class="headerlink" title="1. å¯¹æ ˆçš„ç†è§£"></a>1. å¯¹æ ˆçš„ç†è§£</h1><ul><li>å…ˆè¿›åå‡º</li><li>æ“ä½œå—é™çš„çº¿æ€§è¡¨ï¼Œåªå…è®¸åœ¨ä¸€ç«¯æ’å…¥å’Œåˆ é™¤æ•°æ®</li><li>å®è´¨ä¸Šæ ˆçš„åŠŸèƒ½ä¸€å®šæ˜¯å¯ä»¥è¢«æ•°ç»„ï¼ˆé¡ºåºæ ˆï¼‰æˆ–è€…é“¾è¡¨ï¼ˆé“¾å¼æ ˆï¼‰æ¥æ›¿ä»£çš„ï¼Œå› ä¸ºæœ‰æ‹¿ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªçš„æ¥å£ï¼Œæˆ–è€…è¯´æ–¹å¼</li><li>ç”¨æ ˆçš„å¥½å¤„æ˜¯æ“ä½œä¸Šçš„ç®€å•ï¼Œæ›´ä¸å®¹æ˜“å‡ºé”™ä¸€äº›</li><li>åŠŸèƒ½æ“ä½œå—é™çš„çº¿æ€§è¡¨ï¼Œæ ˆå¯ä»¥é€šè¿‡æ•°ç»„æˆ–è€…é“¾è¡¨æ¥è¿›è¡Œå®ç°</li></ul><h1 id="2-æ”¯æŒåŠ¨æ€æ‰©å®¹çš„é¡ºåºæ ˆ"><a href="#2-æ”¯æŒåŠ¨æ€æ‰©å®¹çš„é¡ºåºæ ˆ" class="headerlink" title="2. æ”¯æŒåŠ¨æ€æ‰©å®¹çš„é¡ºåºæ ˆ"></a>2. æ”¯æŒåŠ¨æ€æ‰©å®¹çš„é¡ºåºæ ˆ</h1><ul><li>åŠ¨æ€æ‰©å®¹ - load factor</li><li>é¡ºåºæ ˆ - æ•°ç»„</li></ul><p><img src="fig1.jpg" alt="fig1.jpg"></p><ul><li>æ³¨æ„åŠ¨æ€æ‰©å®¹çš„é¡ºåºæ ˆï¼Œå‡ºæ ˆè¿‡ç¨‹ä¾ç„¶å¯ä»¥å®ç°O(1)çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½†æ˜¯åœ¨å…¥æ ˆè¿‡ç¨‹å½“ä¸­ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿäº†çš„è¯ï¼Œé‚£å°±éœ€è¦å®ç°æ•´ä½“çš„è¿ç§»ï¼Œæ—¶é—´å¤æ‚åº¦å°±å˜æˆäº†O(n)</li></ul><pre><code>// åŸºäºæ•°ç»„å®ç°çš„é¡ºåºæ ˆpublic class ArrayStack {  private String[] items;  // æ•°ç»„  private int count;       // æ ˆä¸­å…ƒç´ ä¸ªæ•°  private int n;           //æ ˆçš„å¤§å°  // åˆå§‹åŒ–æ•°ç»„ï¼Œç”³è¯·ä¸€ä¸ªå¤§å°ä¸ºnçš„æ•°ç»„ç©ºé—´  public ArrayStack(int n) {    this.items = new String[n];    this.n = n;    this.count = 0;  }  // å…¥æ ˆæ“ä½œ  public boolean push(String item) {    // æ•°ç»„ç©ºé—´ä¸å¤Ÿäº†ï¼Œç›´æ¥è¿”å›falseï¼Œå…¥æ ˆå¤±è´¥ã€‚    if (count == n) return false;    // å°†itemæ”¾åˆ°ä¸‹æ ‡ä¸ºcountçš„ä½ç½®ï¼Œå¹¶ä¸”countåŠ ä¸€    items[count] = item;    ++count;    return true;  }  // å‡ºæ ˆæ“ä½œ  public String pop() {    // æ ˆä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›null    if (count == 0) return null;    // è¿”å›ä¸‹æ ‡ä¸ºcount-1çš„æ•°ç»„å…ƒç´ ï¼Œå¹¶ä¸”æ ˆä¸­å…ƒç´ ä¸ªæ•°countå‡ä¸€    String tmp = items[count-1];    --count;    return tmp;  }}</code></pre><h1 id="3-æ ˆçš„åº”ç”¨"><a href="#3-æ ˆçš„åº”ç”¨" class="headerlink" title="3. æ ˆçš„åº”ç”¨"></a>3. æ ˆçš„åº”ç”¨</h1><ul><li>å‡½æ•°è°ƒç”¨æ ˆ<ul><li>æ“ä½œç³»ç»Ÿç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€å—ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œè¿™å—å†…å­˜è¢«ç»„ç»‡æˆæ ˆè¿™ç§ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨å‡½æ•°è°ƒç”¨æ—¶çš„ä¸´æ—¶å˜é‡</li></ul></li><li>è¡¨è¾¾å¼æ±‚å€¼<ul><li>è®¡ç®—æœºä¼šç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°</li><li>ä¸€ä¸ªç”¨æ¥ä¿å­˜æ“ä½œæ•°</li><li>ä¸€ä¸ªç”¨æ¥ä¿å­˜è¿ç®—ç¬¦<br>å®é™…ä¸Šï¼Œç¼–è¯‘å™¨å°±æ˜¯é€šè¿‡ä¸¤ä¸ªæ ˆæ¥å®ç°çš„ã€‚å…¶ä¸­ä¸€ä¸ªä¿å­˜æ“ä½œæ•°çš„æ ˆï¼Œå¦ä¸€ä¸ªæ˜¯ä¿å­˜è¿ç®—ç¬¦çš„æ ˆã€‚æˆ‘ä»¬ä»å·¦å‘å³éå†è¡¨è¾¾å¼ï¼Œå½“é‡åˆ°æ•°å­—ï¼Œæˆ‘ä»¬å°±ç›´æ¥å‹å…¥æ“ä½œæ•°æ ˆï¼›å½“é‡åˆ°è¿ç®—ç¬¦ï¼Œå°±ä¸è¿ç®—ç¬¦æ ˆçš„æ ˆé¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ¯”è¿ç®—ç¬¦æ ˆé¡¶å…ƒç´ çš„ä¼˜å…ˆçº§é«˜ï¼Œå°±å°†å½“å‰è¿ç®—ç¬¦å‹å…¥æ ˆï¼›å¦‚æœæ¯”è¿ç®—ç¬¦æ ˆé¡¶å…ƒç´ çš„ä¼˜å…ˆçº§ä½æˆ–è€…ç›¸åŒï¼Œä»è¿ç®—ç¬¦æ ˆä¸­å–æ ˆé¡¶è¿ç®—ç¬¦ï¼Œä»æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å– 2 ä¸ªæ“ä½œæ•°ï¼Œç„¶åè¿›è¡Œè®¡ç®—ï¼Œå†æŠŠè®¡ç®—å®Œçš„ç»“æœå‹å…¥æ“ä½œæ•°æ ˆï¼Œç»§ç»­æ¯”è¾ƒã€‚<br><img src="fig2.jpg" alt="fig2.jpg"></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(4)-é“¾è¡¨</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-4-%E9%93%BE%E8%A1%A8/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-4-%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-é“¾è¡¨ç»“æ„"><a href="#1-é“¾è¡¨ç»“æ„" class="headerlink" title="1. é“¾è¡¨ç»“æ„"></a>1. é“¾è¡¨ç»“æ„</h1><ul><li><p>æ•°ç»„éœ€è¦ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´æ¥å­˜å‚¨ï¼Œå¯¹å†…å­˜çš„è¦æ±‚æ¯”è¾ƒé«˜</p></li><li><p>é“¾è¡¨ï¼Œé€šè¿‡æŒ‡é’ˆå°†ä¸€ç»„<strong>é›¶æ•£çš„å†…å­˜å—</strong>ä¸²è”èµ·æ¥ä½¿ç”¨</p></li><li><p>é“¾è¡¨ç»å…¸åº”ç”¨åœºæ™¯ - LRUç¼“å­˜æ·˜æ±°ç®—æ³•</p><ul><li>ç¼“å­˜æ˜¯ä¸€ç§æé«˜æ•°æ®è¯»å–æ€§èƒ½çš„æŠ€æœ¯<ul><li>CPUç¼“å­˜</li><li>æ•°æ®åº“ç¼“å­˜</li><li>æµè§ˆå™¨ç¼“å­˜</li></ul></li></ul></li></ul><h2 id="1-1-å•é“¾è¡¨"><a href="#1-1-å•é“¾è¡¨" class="headerlink" title="1.1 å•é“¾è¡¨"></a>1.1 å•é“¾è¡¨</h2><p><img src="https://i.loli.net/2020/02/09/Q9fFlx6ap5B47Mj.jpg" alt="fig1.jpg"></p><ul><li><p>æ¯ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹ </p><ul><li>å­˜å‚¨çš„æ•°æ®</li><li>è®°å½•é“¾çš„ä¸‹ä¸€ä¸ªç»“ç‚¹çš„åœ°å€(åç»§æŒ‡é’ˆnext)</li></ul></li><li><p>å¤´ç»“ç‚¹ç”¨æ¥è®°å½•é“¾è¡¨çš„<strong>åŸºåœ°å€</strong></p></li><li><p>å°¾ç»“ç‚¹çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ª<strong>ç©ºåœ°å€NULL</strong></p></li><li><p>æ’å…¥å’Œåˆ é™¤ç»“ç‚¹éƒ½éå¸¸å¿« O(1)</p></li><li><p>éšæœºè®¿é—®å…¶ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚æŒ‰ç…§é¡ºåºé€‰ç¬¬nä¸ªå°±æ˜¯O(n)çš„å¤æ‚åº¦</p></li></ul><p><img src="https://i.loli.net/2020/02/09/h6maNKWveQnfgGP.jpg" alt="fig2.jpg"></p><h2 id="1-2-åŒå‘é“¾è¡¨"><a href="#1-2-åŒå‘é“¾è¡¨" class="headerlink" title="1.2 åŒå‘é“¾è¡¨"></a>1.2 åŒå‘é“¾è¡¨</h2><p><img src="https://i.loli.net/2020/02/09/rYhNQ1Zwp5klgVn.jpg" alt="fig4.jpg"></p><ul><li>åŒå‘é“¾è¡¨æ”¯æŒä¸¤ä¸ªæ–¹å‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸æ­¢æœ‰ä¸€ä¸ªåç»§æŒ‡é’ˆnextæŒ‡å‘åé¢çš„ç»“ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ªå‰é©±æŒ‡é’ˆprevæŒ‡å‘å‰é¢çš„ç»“ç‚¹ã€‚</li><li>åŒå‘é“¾è¡¨å¯ä»¥æ”¯æŒO(1) çš„æ—¶é—´å¤æ‚åº¦çš„æƒ…å†µä¸‹æ‰¾åˆ°å‰é©±ç»“ç‚¹ï¼Œè¿™æ ·å°±ä½¿å¾—åŒå‘é“¾è¡¨åœ¨æŸäº›æƒ…å†µä¸‹çš„æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œéƒ½è¦æ¯”å•é“¾è¡¨ç®€å•é«˜æ•ˆã€‚</li><li>å…¶å®å°±æ˜¯æ— è®ºå•é“¾è¡¨è¿˜æ˜¯åŒå‘é“¾è¡¨ï¼Œåœ¨åˆ é™¤çš„æ—¶å€™éƒ½éœ€è¦æ‰¾åˆ°å‰é©±ç»“ç‚¹ï¼Œè€Œå•é“¾è¡¨åœ¨è¿™é‡Œæƒ³è¦æ‰¾åˆ°å‰é©±ç»“ç‚¹çš„è¯å°±å¾—ä»å¤´å¼€å§‹å»æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦è¿˜æ˜¯O(n)ï¼Œè€ŒåŒå‘é“¾è¡¨å°±å¯ä»¥å®ç°å¾ˆå¿«çš„æ‰¾åˆ°å¯¹åº”çš„å‰é©±èŠ‚ç‚¹äº†ã€‚</li><li>å› ä¸ºæœ‰prev nextä¸¤ä¸ªæŒ‡é’ˆï¼Œå®ƒé»„æµ·å†›æ›´å ç”¨å†…å­˜çš„ç©ºé—´</li><li>Javaçš„LinkedHashMapå°±æ˜¯ç”¨åŒå‘é“¾è¡¨æ¥å®ç°çš„</li><li>ç”¨ç©ºé—´æ¢æ—¶é—´çš„è®¾è®¡æ€æƒ³<ul><li>å½“å†…å­˜ç©ºé—´å……è¶³çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æ›´è¿½æ±‚ä»£ç çš„æ‰§è¡Œé€Ÿåº¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©ç©ºé—´å¤æ‚åº¦ç›¸å¯¹è¾ƒé«˜ï¼Œä½†æ—¶é—´å¤æ‚åº¦ç›¸å¯¹å¾ˆä½çš„ç®—æ³•æˆ–è€…æ•°æ®ç»“æ„ã€‚ </li></ul></li><li>å¯¹äºæœ‰åºé“¾è¡¨æ¥è¯´ï¼ŒåŒå‘é“¾è¡¨çš„æŒ‰å€¼æŸ¥è¯¢æ•ˆç‡ä¹Ÿè¦æ¯”å•é“¾è¡¨é«˜ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡è®°å½•ä¸Šæ¬¡æŸ¥æ‰¾çš„ä½ç½®pï¼Œæ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ ¹æ®è¦æŸ¥æ‰¾çš„å€¼å’Œpçš„å¤§å°å…³ç³»å†³å®šæ˜¯å¾€å‰è¿˜æ˜¯å¾€åæ¥æŸ¥æ‰¾ã€‚</li></ul><h2 id="1-3-å¾ªç¯é“¾è¡¨"><a href="#1-3-å¾ªç¯é“¾è¡¨" class="headerlink" title="1.3 å¾ªç¯é“¾è¡¨"></a>1.3 å¾ªç¯é“¾è¡¨</h2><p><img src="https://i.loli.net/2020/02/09/BLOXWHUgpeJoQGh.jpg" alt="fig3.jpg"></p><ul><li>å¾ªç¯é“¾è¡¨çš„å°¾ç»“ç‚¹æŒ‡é’ˆæ˜¯æŒ‡å‘é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåƒä¸€ä¸ªç¯ä¸€æ ·é¦–å°¾ç›¸è¿</li><li>å½“è¦å¤„ç†çš„æ•°æ®å…·æœ‰<strong>ç¯å½¢ç»“æ„ç‰¹ç‚¹</strong>æ—¶ï¼Œå°±ç‰¹åˆ«é€‚åˆé‡‡ç”¨å¾ªç¯é“¾è¡¨ã€‚</li></ul><h1 id="2-é“¾è¡¨æ•°ç»„æ€§èƒ½å¯¹æ¯”"><a href="#2-é“¾è¡¨æ•°ç»„æ€§èƒ½å¯¹æ¯”" class="headerlink" title="2.é“¾è¡¨æ•°ç»„æ€§èƒ½å¯¹æ¯”"></a>2.é“¾è¡¨æ•°ç»„æ€§èƒ½å¯¹æ¯”</h1><table><thead><tr><th>æ—¶é—´å¤æ‚åº¦</th><th>æ•°ç»„</th><th>é“¾è¡¨</th></tr></thead><tbody><tr><td>æ’å…¥åˆ é™¤</td><td>O(n)</td><td>O(1)</td></tr><tr><td>éšæœºè®¿é—®</td><td>O(1)</td><td>O(n)</td></tr></tbody></table><p>ä½†æ˜¯åœ¨å®é™…åº”ç”¨å¼€å‘å½“ä¸­ï¼Œä¸èƒ½ä»…ä»…åˆ©ç”¨å¤æ‚åº¦åˆ†æå°±å†³å®šä½¿ç”¨å“ªä¸ªæ•°æ®ç»“æ„æ¥å­˜å‚¨æ•°æ®ã€‚</p><p>æ•°ç»„ç®€å•æ˜“ç”¨ï¼Œåœ¨å®ç°ä¸Šä½¿ç”¨çš„æ˜¯è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥å€ŸåŠ©CPUçš„ç¼“å­˜æœºåˆ¶ï¼Œé¢„è¯»æ•°ç»„ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥è®¿é—®æ•ˆç‡æ›´é«˜ã€‚è€Œé“¾è¡¨å› ä¸ºä¸æ˜¯è¿ç»­å†…å­˜å­˜å‚¨ï¼Œæ‰€ä»¥æ²¡åŠæ³•æœ‰æ•ˆé¢„è¯»ã€‚</p><p>æ•°ç»„å¤§å°å›ºå®šï¼Œå¢å¤§å¦‚æœè¦åšæ‰©å®¹æ‹·è´æ˜¯éå¸¸è´¹æ—¶é—´çš„ã€‚é“¾è¡¨æœ¬èº«æ²¡æœ‰å¤§å°çš„é™åˆ¶ï¼Œå¤©ç„¶æ”¯æŒ<strong>åŠ¨æ€æ‰©å®¹</strong>ã€‚</p><p>è€Œä¸”ï¼Œå¦‚æœä»£ç å¯¹äºå†…å­˜çš„ä½¿ç”¨å¾ˆè‹›åˆ»ï¼Œé‚£æ•°ç»„ä¼šæ›´åŠ åˆé€‚ã€‚å› ä¸ºé“¾è¡¨ä¸­çš„æ¯ä¸ªç»“ç‚¹éƒ½è¦æ¶ˆè€—é¢å¤–çš„å­˜å‚¨ç©ºé—´å»å­˜å‚¨æŒ‡é’ˆï¼Œæ‰€ä»¥å†…å­˜çš„æ¶ˆè€—ä¼šç¿»å€ã€‚è€Œä¸”ï¼Œå¯¹é“¾è¡¨è¿›è¡Œé¢‘ç¹çš„æ’å…¥ï¼Œåˆ é™¤æ“ä½œè¿˜ä¼šå¯¼è‡´é¢‘ç¹çš„å†…å­˜ç”³è¯·å’Œé‡Šæ”¾ï¼Œå®¹æ˜“é€ æˆå†…å­˜ç¢ç‰‡ã€‚Javaä¸­å°±ä¼šå¯¼è‡´é¢‘ç¹çš„garbage collection. </p><h1 id="3-å†™é“¾è¡¨ä»£ç çš„æŠ€å·§"><a href="#3-å†™é“¾è¡¨ä»£ç çš„æŠ€å·§" class="headerlink" title="3. å†™é“¾è¡¨ä»£ç çš„æŠ€å·§"></a>3. å†™é“¾è¡¨ä»£ç çš„æŠ€å·§</h1><h2 id="3-1-ç†è§£æŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„å«ä¹‰"><a href="#3-1-ç†è§£æŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„å«ä¹‰" class="headerlink" title="3.1 ç†è§£æŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„å«ä¹‰"></a>3.1 ç†è§£æŒ‡é’ˆæˆ–è€…å¼•ç”¨çš„å«ä¹‰</h2><p>æŒ‡é’ˆï¼Œæ˜¯åœ¨åƒCè¯­è¨€è¿™æ ·çš„è¯­è¨€å½“ä¸­æ¥ä½¿ç”¨çš„ï¼›å¯¹äºJavaè¿™ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ˜¯ç”¨å¼•ç”¨æ¥è¾¾æˆå­˜å‚¨æ‰€æŒ‡å¯¹è±¡çš„å†…å­˜åœ°å€çš„ç›®çš„ã€‚</p><p>å°†æŸä¸ªå˜é‡èµ‹å€¼ç»™æŒ‡é’ˆï¼Œå®é™…ä¸Šå°±æ˜¯å°†è¿™ä¸ªå˜é‡çš„åœ°å€èµ‹å€¼ç»™æŒ‡é’ˆï¼Œæˆ–è€…åè¿‡æ¥è¯´ï¼ŒæŒ‡é’ˆä¸­å­˜å‚¨äº†è¿™ä¸ªå˜é‡çš„å†…å­˜åœ°å€ï¼ŒæŒ‡å‘äº†è¿™ä¸ªå˜é‡ï¼Œé€šè¿‡æŒ‡é’ˆå°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå˜é‡äº†ã€‚</p><pre><code>// pç»“ç‚¹çš„nextæŒ‡é’ˆé‡Œé¢å­˜å‚¨äº†qç»“ç‚¹çš„å†…å­˜åœ°å€p-&gt;next = q// p ç»“ç‚¹çš„nextæŒ‡é’ˆå­˜å‚¨äº†pç»“ç‚¹çš„ä¸‹ä¸‹ä¸ªç»“ç‚¹çš„å†…å­˜åœ°å€p-&gt;next = p-&gt;next-&gt;next</code></pre><h2 id="3-2-è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„éœ²"><a href="#3-2-è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„éœ²" class="headerlink" title="3.2 è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„éœ²"></a>3.2 è­¦æƒ•æŒ‡é’ˆä¸¢å¤±å’Œå†…å­˜æ³„éœ²</h2><p><img src="https://i.loli.net/2020/02/09/ASXEJ4ZYzf6lmrH.jpg" alt="fig5.jpg"></p><pre><code>x-&gt;next = p-&gt;next;  // å°† x çš„ç»“ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ b ç»“ç‚¹ï¼›p-&gt;next = x;  // å°† p çš„ next æŒ‡é’ˆæŒ‡å‘ x ç»“ç‚¹ï¼›</code></pre><p>ä¸¤è¡Œä»£ç çš„é¡ºåºå¾ˆé‡è¦ï¼Œä½ éœ€è¦å…ˆå°†pçš„nextçš„åœ°å€èµ‹ç»™xçš„nextçš„åœ°å€ï¼Œç„¶åå†æ¥æ”¹pçš„nextï¼Œæ”¹å˜pçš„nextæŒ‡é’ˆ</p><h2 id="3-3-åˆ©ç”¨å“¨å…µ"><a href="#3-3-åˆ©ç”¨å“¨å…µ" class="headerlink" title="3.3 åˆ©ç”¨å“¨å…µ"></a>3.3 åˆ©ç”¨å“¨å…µ</h2><p>å¯¹äºé“¾è¡¨å½“ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæœ€åä¸€ä¸ªç»“ç‚¹ï¼Œå…¶å®ç°æ’å…¥åˆ é™¤çš„é€»è¾‘å’Œå…¶ä»–ç»“ç‚¹æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>åˆ©ç”¨å“¨å…µç»“ç‚¹å¯ä»¥ç®€åŒ–æ•´ä¸ªå®ç°ï¼Œè®©é’ˆå¯¹äºç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæœ€åä¸€ä¸ªç»“ç‚¹çš„å¤„ç†å’Œå…¶ä»–ç»“ç‚¹çš„å¤„ç†æ–¹å¼ä¸€è‡´ã€‚</p><p><img src="https://i.loli.net/2020/02/09/A43BtwNSuvhMy7n.jpg" alt="fig6.jpg"></p><h2 id="3-4-è¾¹ç•Œæ¡ä»¶çš„æ€è€ƒä¸åˆ¤å®š"><a href="#3-4-è¾¹ç•Œæ¡ä»¶çš„æ€è€ƒä¸åˆ¤å®š" class="headerlink" title="3.4 è¾¹ç•Œæ¡ä»¶çš„æ€è€ƒä¸åˆ¤å®š"></a>3.4 è¾¹ç•Œæ¡ä»¶çš„æ€è€ƒä¸åˆ¤å®š</h2><ul><li>é“¾è¡¨ä¸ºç©º</li><li>é“¾è¡¨åªåŒ…å«ä¸€ä¸ªç»“ç‚¹</li><li>é“¾è¡¨åªåŒ…å«ä¸¤ä¸ªç»“ç‚¹</li><li>ä»£ç é€»è¾‘åœ¨å¤„ç†å¤´ç»“ç‚¹å’Œå°¾ç»“ç‚¹çš„æ—¶å€™</li></ul><h1 id="4-å®æˆ˜"><a href="#4-å®æˆ˜" class="headerlink" title="4. å®æˆ˜"></a>4. å®æˆ˜</h1><h2 id="4-1-LC-206-Reversed-Linked-List"><a href="#4-1-LC-206-Reversed-Linked-List" class="headerlink" title="4.1 LC 206 Reversed Linked List"></a>4.1 LC 206 Reversed Linked List</h2><pre><code>// éå†ï¼Œé‡ç‚¹åœ¨å› ä¸ºæ— æ³•åŒæ—¶ä¿å­˜prevèŠ‚ç‚¹å’ŒnextèŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œåªæœ‰ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥éœ€è¦å»ºä¸€ä¸ªä¸­é—´å˜é‡æ¥è®°å½•class Solution {    public ListNode reverseList(ListNode head) {        ListNode cur = head;        ListNode prev = null;        while (cur != null) {            ListNode temp = cur.next;            cur.next = prev;            prev = cur;            cur = temp;        }        return prev;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LinkedList </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(3)-æ•°ç»„</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-3-%E6%95%B0%E7%BB%84/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-3-%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯æ•°ç»„"><a href="#1-ä»€ä¹ˆæ˜¯æ•°ç»„" class="headerlink" title="1. ä»€ä¹ˆæ˜¯æ•°ç»„"></a>1. ä»€ä¹ˆæ˜¯æ•°ç»„</h1><ul><li>æ˜¯ä¸€ç§<strong>çº¿æ€§è¡¨</strong>æ•°æ®ç»“æ„ï¼Œç”¨ä¸€ç»„<strong>è¿ç»­çš„å†…å­˜ç©ºé—´</strong>ï¼Œæ¥å­˜å‚¨ä¸€ç»„å…·æœ‰<strong>ç›¸åŒç±»å‹</strong>çš„æ•°æ®</li><li>çº¿æ€§è¡¨<ul><li>æ•°æ®æ’æˆäº†çº¿æ€§çš„ç»“æ„</li><li>æ¯ä¸ªçº¿æ€§è¡¨ä¸Šçš„æ•°æ®åªæœ‰å‰åä¸¤ä¸ªæ–¹å‘</li><li>é™¤äº†æ•°ç»„ï¼Œé“¾è¡¨ã€é˜Ÿåˆ—ã€æ ˆç­‰ä¹Ÿæ˜¯çº¿æ€§è¡¨ç»“æ„</li></ul></li><li>éçº¿æ€§è¡¨<ul><li>æ¯”å¦‚è¯´äºŒå‰æ ‘ï¼Œå †ï¼Œå›¾ç­‰  ä»–ä»¬çš„æ•°æ®ä¹‹é—´ä¸æ˜¯ç®€å•çš„å‰åå…³ç³»äº† </li></ul></li><li>è¿ç»­å†…å­˜ç©ºé—´ä¸ç›¸åŒç±»å‹çš„æ•°æ®<ul><li>æ­£å› ä¸ºæœ‰è¿™ä¸ªç‰¹å¾å…¶æ‰å¯ä»¥è¿›è¡Œéšæœºè®¿é—®</li><li>ä½†æ˜¯è¿™ä¹Ÿå¯¼è‡´äº†æƒ³è¦åœ¨æ•°ç»„å½“ä¸­åˆ é™¤ï¼Œæ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œä¸ºäº†ä¿è¯è¿ç»­æ€§ï¼Œå°±éœ€è¦åšå¤§é‡çš„æ•°æ®æ¬ç§»å·¥ä½œ</li><li>æ•°ç»„éå¸¸é€‚åˆæ ¹æ®ä¸‹æ ‡æ¥è¿›è¡Œè®¿é—®</li></ul></li><li>çº¿æ€§è¡¨ - æ•°ç»„<ul><li>è¡¨ä¸­çš„æ•°æ®åªæœ‰å‰åä¸¤ä¸ªæ–¹å‘</li><li>æ•°ç»„ï¼Œé“¾è¡¨ï¼Œé˜Ÿåˆ—ï¼Œæ ˆéƒ½æ˜¯çº¿æ€§è¡¨ç»“æ„</li></ul></li><li>éçº¿æ€§è¡¨<ul><li>äºŒå‰æ ‘ï¼Œå †ï¼Œå›¾</li><li>æ•°æ®ä¹‹é—´å¹¶ä¸æ˜¯ç®€å•çš„å‰åå…³ç³»</li></ul></li></ul><h1 id="2-æ•°ç»„çš„æ’å…¥ï¼Œåˆ é™¤ï¼Œéšæœºè®¿é—®"><a href="#2-æ•°ç»„çš„æ’å…¥ï¼Œåˆ é™¤ï¼Œéšæœºè®¿é—®" class="headerlink" title="2. æ•°ç»„çš„æ’å…¥ï¼Œåˆ é™¤ï¼Œéšæœºè®¿é—®"></a>2. æ•°ç»„çš„æ’å…¥ï¼Œåˆ é™¤ï¼Œéšæœºè®¿é—®</h1><ul><li>æ’å…¥ï¼Œåˆ é™¤<ul><li>åœ¨kä½ç½®åšæ“ä½œï¼Œé‚£ä¹ˆå¯¹äºkä½ç½®ä¹‹åçš„k - néƒ½æ˜¯éœ€è¦åšç§»ä½çš„ </li></ul></li><li>åˆ é™¤çš„ä¼˜åŒ–<ul><li>é¿å…æ¯æ¬¡åˆ é™¤éƒ½ç›´æ¥çš„æ¬ç§»æ•°æ®</li><li>å…ˆè®°å½•ä¸‹å·²ç»åˆ é™¤çš„æ•°æ®</li><li>æ¯æ¬¡åˆ é™¤æ“ä½œå¹¶ä¸æ˜¯çœŸæ­£æ¬ç§»æ•°æ®ï¼Œåªæ˜¯è®°å½•æ•°æ®å·²ç»è¢«åˆ é™¤äº†</li><li>å½“æ•°ç»„æ²¡æœ‰æ›´å¤šç©ºé—´å­˜å‚¨äº†ä»¥åï¼Œå†è§¦å‘æ‰§è¡Œä¸€æ¬¡çœŸæ­£çš„åˆ é™¤æ“ä½œ</li><li>é€šè¿‡è¿™ç§æ–¹å¼å¤§å¤§å‡å°‘äº†åˆ é™¤æ“ä½œå¯¼è‡´çš„æ•°æ®æ¬ç§»</li><li>â€”â€“&gt; JVMæ ‡è®°æ¸…é™¤åƒåœ¾å›æ”¶ç®—æ³•</li></ul></li></ul><h1 id="3-æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜"><a href="#3-æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜" class="headerlink" title="3. æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜"></a>3. æ•°ç»„çš„è®¿é—®è¶Šç•Œé—®é¢˜</h1><pre><code>int main(int argc, char* argv[]){    int i = 0;    int arr[3] = {0};    for(; i&lt;=3; i++){        arr[i] = 0;        printf(&quot;hello world\n&quot;);    }    return 0;}</code></pre><p>å½“i=3çš„æ—¶å€™ï¼Œè®¿é—®è¶Šç•Œã€‚åœ¨Cè¯­è¨€å½“ä¸­ï¼Œåªè¦ä¸æ˜¯è®¿é—®å—é™çš„å†…å­˜ï¼Œå†…å­˜ç©ºé—´éƒ½æ˜¯å¯ä»¥è‡ªç”±è®¿é—®çš„ã€‚a[3]ä¼šè¢«å®šä½åˆ°æŸå—ä¸å±äºæ•°ç»„çš„å†…å­˜åœ°å€ä¸Šï¼Œè€Œè¿™ä¸ªåœ°å€æ­£å¥½æ˜¯å­˜å‚¨å˜é‡içš„å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆarr[3] = 0 å°±ç›¸å½“äº i=0ï¼Œå› æ­¤ä¼šå¯¼è‡´ä»£ç æ— é™å¾ªç¯ã€‚</p><p>å¯¹è¿™é‡Œçš„æ— é™å¾ªç¯çš„è§£é‡Šï¼šå‡½æ•°ä½“å†…çš„å±€éƒ¨å˜é‡å­˜åœ¨æ ˆä¸Šï¼Œä¸”æ˜¯è¿ç»­å‹æ ˆã€‚åœ¨Linuxè¿›ç¨‹çš„å†…å­˜å¸ƒå±€ä¸­ï¼Œæ ˆåŒºåœ¨é«˜åœ°å€ç©ºé—´ï¼Œä»é«˜å‘ä½å¢é•¿ã€‚å˜é‡iå’Œarråœ¨ç›¸é‚»åœ°å€ï¼Œä¸”iæ¯”arrçš„åœ°å€å¤§ï¼Œæ‰€ä»¥arrè¶Šç•Œæ­£å¥½è®¿é—®åˆ°iã€‚å½“ç„¶ï¼Œå‰ææ˜¯iå’Œarrå…ƒç´ åŒç±»å‹ï¼Œå¦åˆ™é‚£æ®µä»£ç ä»æ˜¯æœªå†³è¡Œä¸ºã€‚</p><p>æ•°ç»„è¶Šç•Œæ˜¯ä¸€ç§æœªå†³è¡Œä¸ºï¼Œå¹¶æ²¡æœ‰è§„å®šæ•°ç»„è®¿é—®è¶Šç•Œæ—¶ç¼–è¯‘å™¨åº”è¯¥å¦‚ä½•å¤„ç†ã€‚å› ä¸ºï¼Œè®¿é—®æ•°ç»„çš„æœ¬è´¨å°±æ˜¯è®¿é—®ä¸€æ®µè¿ç»­å†…å­˜ï¼Œåªè¦æ•°ç»„é€šè¿‡åç§»è®¡ç®—å¾—åˆ°çš„å†…å­˜åœ°å€æ˜¯å¯ç”¨çš„ï¼Œé‚£ä¹ˆç¨‹åºå°±å¯èƒ½ä¸ä¼šæŠ¥ä»»ä½•é”™è¯¯ã€‚</p><p>Javaåšäº†å°è£…ï¼Œä¼šåˆ¤æ–­å‡ºæ•°ç»„è¶Šç•Œçš„è¡Œä¸ºï¼Œå¹¶throw exceptionã€‚</p><h1 id="4-å®¹å™¨-vs-æ•°ç»„"><a href="#4-å®¹å™¨-vs-æ•°ç»„" class="headerlink" title="4. å®¹å™¨ vs æ•°ç»„"></a>4. å®¹å™¨ vs æ•°ç»„</h1><p>å®¹å™¨ï¼Œè­¬å¦‚Javaä¸­çš„ArrayListï¼Œæœ€å¤§ä¼˜åŠ¿æ˜¯å¯ä»¥å°†è®¸å¤šæ•°ç»„æ“ä½œç»†èŠ‚å°è£…èµ·æ¥ã€‚å¦å¤–ï¼Œå…¶æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚åŠ¨æ€æ‰©å®¹å¾ˆè€—æ—¶çš„ï¼Œå› ä¸ºç‰µæ‰¯åˆ°å†…å­˜ç”³è¯·ï¼Œè¿˜æœ‰æ•´ä½“çš„æ•°æ®æ¬ç§»ã€‚å› æ­¤å¦‚æœèƒ½ç¡®å®šéœ€è¦æ‘å¡¾çš„æ•°æ®çš„å¤§å°ï¼Œæœ€å¥½<strong>åœ¨åˆ›å»ºArraylistçš„æ—¶å€™äº‹å…ˆæŒ‡å®šå¥½</strong></p><ul><li>ä½¿ç”¨æ•°ç»„çš„æƒ…å†µ<ul><li>ArrayList æ— æ³•å­˜å‚¨åŸºæœ¬ç±»å‹ï¼Œéœ€è¦å°è£…ï¼ŒautoBoxing, unboxingæœ¬èº«æ˜¯æœ‰ä¸€å®šçš„æ€§èƒ½æ¶ˆè€—çš„ï¼Œå¦‚æœç‰¹åˆ«å…³æ³¨æ€§èƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç”¨æ•°ç»„</li><li>å¦‚æœæ•°ç»„å¤§å°å·²çŸ¥ï¼Œå¹¶ä¸”å¯¹æ•°æ®çš„æ“ä½œå¾ˆç®€å•ã€‚ä¸éœ€è¦ä½¿ç”¨ArrayListæ‰€æä¾›çš„å¤§éƒ¨åˆ†çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„</li><li>å¤šç»´æ•°ç»„çš„è¡¨ç¤ºä¼šæ›´ä¸ºç›´è§‚ä¸€äº›</li></ul></li></ul><h1 id="5-ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»0å¼€å§‹ç¼–å·ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»0å¼€å§‹ç¼–å·ï¼Ÿ" class="headerlink" title="5. ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»0å¼€å§‹ç¼–å·ï¼Ÿ"></a>5. ä¸ºä»€ä¹ˆæ•°ç»„è¦ä»0å¼€å§‹ç¼–å·ï¼Ÿ</h1><p>å› ä¸ºä¸‹æ ‡æœ€ç¡®åˆ‡çš„å®šä¹‰æ˜¯åç§»ï¼Œoffsetã€‚è¦ç®—a[k]çš„å†…å­˜åœ°å€çš„å…¬å¼ä¸ºï¼š</p><pre><code>a[k]_address = base_address + k * type_size</code></pre><p>å¦‚æœæˆ‘ä»¬ä»1å¼€å§‹è®¡æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¡ç®—ä½ç½®çš„å…¬å¼å°±ä¼šå˜æˆï¼š</p><pre><code>a[k]_address = base_address + (k-1)*type_size</code></pre><p>è¿™æ ·æ¯æ¬¡è®¿é—®éƒ½ä¼šå¤šä¸€æ¬¡å‡æ³•è¿ç®—ï¼ï¼ï¼å¯¹äºCPUæ¥è¯´ï¼Œå°±æ˜¯å¤šäº†ä¸€æ¬¡å‡æ³•æŒ‡ä»¤ã€‚ä»0å¼€å§‹å°±æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå½“ç„¶è¿™ä¸ªæ•ˆç‡çš„æå‡å…¶å®å¾ˆå°ï¼Œä¹Ÿæœ‰ä¸€å¤§éƒ¨åˆ†æ˜¯å†å²åŸå› äº†ï¼Œå³ä¸åŒè¯­è¨€çš„è¿ç§»ä¹‹é—´çš„å­¦ä¹ æˆæœ¬ã€‚</p><h1 id="6-ç®—æ³•å®æˆ˜"><a href="#6-ç®—æ³•å®æˆ˜" class="headerlink" title="6. ç®—æ³•å®æˆ˜"></a>6. ç®—æ³•å®æˆ˜</h1><h2 id="6-1-3Sum"><a href="#6-1-3Sum" class="headerlink" title="6.1 3Sum"></a>6.1 <a href="https://leetcode.com/problems/3sum/" target="_blank" rel="noopener">3Sum</a></h2><p>é¢˜ç›®çš„è¯¦è¿°è§ä¸Šæ–¹çš„è¿æ¥ï¼Œæ€è·¯çš„è¯é¦–å…ˆæœ€ç›´è§‚çš„æ–¹å¼ä¸€å®šæ˜¯ä¸‰å±‚å¾ªç¯ï¼Œæ¥ç¡®å®šå‡ºæ‰€æœ‰çš„è§£ï¼Œbrute forceçš„æ–¹å¼å¾ˆæ…¢ï¼ŒO(n^3)è°å—å¾—äº†ã€‚</p><p>æŒ‰ç…§åˆ†æ²»çš„è§‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ€è€ƒä¸‹2Sumåº”è¯¥å¦‚ä½•å®ç°ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹ä¾¿çš„åŠæ³•ã€‚2Sumçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…ˆæ’åºï¼Œç„¶åé€‰ä¸¤ä¸ªåˆå§‹ç‚¹ï¼Œå³æœ€å·¦(æœ€å°)å’Œæœ€å³(æœ€å¤§)ï¼Œæ ¹æ®æ¯æ¬¡å¾—å‡ºçš„ç»“æœæ¥æ›´æ–°ä¸¤ä¸ªåæ ‡çš„ä½ç½®ï¼Œæœ€ç»ˆæ‹¿åˆ°ç»“æœï¼Œè¿™æ ·çš„å¤§Oå¤æ‚åº¦ä¸ºO(nlogn).æŒ‰ç…§è¿™ç§æ€è·¯çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><pre><code>class Solution {    public List&lt;List&lt;Integer&gt;&gt; threeSum(int[] nums) {        List&lt;List&lt;Integer&gt;&gt; ans = new ArrayList();        if (nums.length &lt; 3) {            return ans;        }        Arrays.sort(nums);        for (int i = 0; i &lt; nums.length -2; i ++) {            if (i == 0 || i != 0 &amp;&amp; nums[i] != nums[i - 1]) {                int low = i+1;                int high = nums.length - 1;                while (high &gt; low) {                    if (nums[i] + nums[low] + nums[high] &gt; 0) {                        high --;                    } else if (nums[i] + nums[low] + nums[high] &lt; 0) {                        low ++;                    } else {                        ans.add(Arrays.asList(nums[i], nums[low], nums[high]));                        while(low &lt; high &amp;&amp; nums[low] == nums[low+1]) low++;                        while(low &lt; high &amp;&amp; nums[high] == nums[high-1]) high--;                        low ++;                        high --;                    }                }            }        }        return ans;    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Array </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(2)-å¤æ‚åº¦åˆ†æ</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-2-%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-2-%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆéœ€è¦å¤æ‚åº¦åˆ†æï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦å¤æ‚åº¦åˆ†æï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦å¤æ‚åº¦åˆ†æï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆéœ€è¦å¤æ‚åº¦åˆ†æï¼Ÿ</h1><p>é€šè¿‡ç»Ÿè®¡å’Œç›‘æ§å¾—åˆ°çš„ç®—æ³•æ‰§è¡Œæ—¶é—´çš„å ç”¨çš„å†…å­˜çš„å¤§å°çš„æ–¹æ³•ç§°ä¸ºäº‹åç»Ÿè®¡æ³•ï¼Œè¿™ç§æ–¹æ³•æœ‰å…¶å±€é™æ€§ï¼š</p><ul><li>æµ‹è¯•ç»“æœéå¸¸ä¾èµ–äºæµ‹è¯•ç¯å¢ƒ</li><li>æµ‹è¯•ç»“æœå—æ•°æ®è§„æ¨¡çš„å½±å“å¾ˆå¤§, è€Œä¸”ä¼šå’Œæ•°æ®é›†æœ¬èº«çš„æ•°æ®è´¨é‡æœ‰å…³</li><li>â€”-&gt; å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸ç”¨å…·ä½“çš„æµ‹è¯•æ•°æ®æ¥æµ‹è¯•ï¼Œå°±å¯ä»¥ç²—ç•¥ä¼°è®¡ç®—æ³•çš„æ‰§è¡Œæ•ˆç‡çš„æ–¹æ³•</li></ul><h1 id="2-å¤§Oå¤æ‚åº¦è¡¨ç¤ºæ³•"><a href="#2-å¤§Oå¤æ‚åº¦è¡¨ç¤ºæ³•" class="headerlink" title="2. å¤§Oå¤æ‚åº¦è¡¨ç¤ºæ³•"></a>2. å¤§Oå¤æ‚åº¦è¡¨ç¤ºæ³•</h1><ul><li>å‡å®šæ¯è¡Œä»£ç æ‰§è¡Œæ—¶é—´éƒ½ä¸€æ ·</li><li>å¹¶ä¸è¡¨ç¤ºå…·ä½“çš„ä»£ç æ‰§è¡Œæ—¶é—´ï¼Œè€Œæ˜¯è¡¨ç¤ºæ‰§è¡Œæ—¶é—´éšç€æ•°æ®è§„æ¨¡å¢å¤§çš„å˜åŒ–è¶‹åŠ¿ï¼Œå› æ­¤ä¹Ÿå«åšæ¸è¿›æ—¶é—´å¤æ‚åº¦ã€‚</li></ul><h1 id="3-å¦‚ä½•åˆ†æä»£ç çš„æ—¶é—´å¤æ‚åº¦"><a href="#3-å¦‚ä½•åˆ†æä»£ç çš„æ—¶é—´å¤æ‚åº¦" class="headerlink" title="3. å¦‚ä½•åˆ†æä»£ç çš„æ—¶é—´å¤æ‚åº¦"></a>3. å¦‚ä½•åˆ†æä»£ç çš„æ—¶é—´å¤æ‚åº¦</h1><ul><li>åªå…³æ³¨å¾ªç¯æ‰§è¡Œæ¬¡æ•°æœ€å¤šçš„ä¸€æ®µä»£ç </li><li>åŠ æ³•åŸåˆ™ï¼šæ€»å¤æ‚åº¦ç­‰äºé‡çº§æœ€å¤§çš„é‚£æ®µä»£ç çš„å¤æ‚åº¦</li><li>ä¹˜æ³•æ³•åˆ™ï¼š åµŒå¥—ä»£ç çš„å¤æ‚åº¦ç­‰äºç­¾åˆ°å†…å¤–å±‚ä»£ç å¤æ‚åº¦çš„ä¹˜ç§¯</li></ul><h1 id="4-å¤æ‚åº¦é‡çº§"><a href="#4-å¤æ‚åº¦é‡çº§" class="headerlink" title="4. å¤æ‚åº¦é‡çº§"></a>4. å¤æ‚åº¦é‡çº§</h1><ul><li>å¸¸é‡é˜¶ O(1)</li><li>å¯¹æ•°é˜¶ O(logn)</li><li>çº¿æ€§é˜¶ O(n)<ul><li>O (m+n) å½“æˆ‘ä»¬ä¸çŸ¥é“å‡ ä¸ªå˜é‡çš„å¤§å°çš„æ—¶å€™ </li></ul></li><li>çº¿æ€§å¯¹æ•°é˜¶ O(nlogn)</li><li>å¹³æ–¹é˜¶ O(n^2)<ul><li>O (m*n) ä¹˜æ³•å…³ç³»ï¼Œä¸çŸ¥é“å‚é‡ä¹‹é—´çš„ç›¸å¯¹å¤§å° </li></ul></li><li>kæ¬¡æ–¹é˜¶ O(n^k)</li><li>æŒ‡æ•°é˜¶ O(2^n)</li><li>é˜¶ä¹˜é˜¶ O(n!)</li></ul><h1 id="5-ç©ºé—´å¤æ‚åº¦åˆ†æ"><a href="#5-ç©ºé—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="5. ç©ºé—´å¤æ‚åº¦åˆ†æ"></a>5. ç©ºé—´å¤æ‚åº¦åˆ†æ</h1><p>ç©ºé—´å¤æ‚åº¦çš„å…¨ç¨‹æ˜¯æ¸è¿›ç©ºé—´å¤æ‚åº¦ï¼Œè¡¨ç¤ºç®—æ³•çš„å­˜å‚¨ç©ºé—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»ã€‚</p><p>å¤§Oæ—¶é—´å¤æ‚åº¦ï¼Œå¹¶ä¸å…·ä½“è¡¨ç¤ºä»£ç çœŸæ­£çš„æ‰§è¡Œæ—¶é—´ï¼Œè€Œæ˜¯è¡¨ç¤ºä»£ç æ‰§è¡Œæ—¶é—´éšç€æ•°æ®è§„æ¨¡çš„å¢å¤§çš„å˜åŒ–è¶‹åŠ¿ã€‚å› æ­¤ä¹Ÿå«åšæ¸è¿›æ—¶é—´å¤æ‚åº¦ï¼Œ(asymptotic time complexity)</p><pre><code>T(n) = O(f(n))</code></pre><p>T(n) - ä»£ç çš„æ‰§è¡Œæ—¶é—´<br>n - æ•°æ®è§„æ¨¡çš„å¤§å°<br>f(n) - æ¯è¡Œä»£ç æ‰§è¡Œçš„æ¬¡æ•°æ€»å’Œ<br>O - è¡¨ç¤ºå·¦å³æˆæ­£æ¯”</p><h2 id="5-1-Tips"><a href="#5-1-Tips" class="headerlink" title="5.1 Tips"></a>5.1 Tips</h2><ul><li>åªå…³æ³¨å¾ªç¯æ‰§è¡Œæ¬¡æ•°æœ€å¤šçš„ä¸€æ®µä»£ç </li><li>æ€»å¤æ‚åº¦ç­‰äºé‡çº§æœ€å¤§çš„é‚£æ®µä»£ç çš„å¤æ‚åº¦</li><li>åµŒå¥—ä»£ç çš„å¤æ‚åº¦ä¸ºåµŒå¥—å†…å¤–ä»£ç å¤æ‚åº¦çš„ä¹˜ç§¯</li></ul><h1 id="6-å¤æ‚åº¦çš„åˆ†æ"><a href="#6-å¤æ‚åº¦çš„åˆ†æ" class="headerlink" title="6. å¤æ‚åº¦çš„åˆ†æ"></a>6. å¤æ‚åº¦çš„åˆ†æ</h1><h2 id="6-1-æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#6-1-æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="6.1 æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>6.1 æ—¶é—´å¤æ‚åº¦åˆ†æ</h2><h3 id="6-1-1-å¤šé¡¹å¼é‡çº§"><a href="#6-1-1-å¤šé¡¹å¼é‡çº§" class="headerlink" title="6.1.1 å¤šé¡¹å¼é‡çº§"></a>6.1.1 å¤šé¡¹å¼é‡çº§</h3><ul><li>O(1) <ul><li>å¸¸é‡çº§çš„ä»£ç ï¼Œæˆ‘ä»¬å°†å…¶æ—¶é—´å¤æ‚åº¦éƒ½è®°ä½œO(1)</li></ul></li><li>O(logn)</li></ul><pre><code> i=1; while (i &lt;= n)  {   i = i * 2; }</code></pre><ul><li>O(nlogn)</li><li>O(m+n)</li><li>O(m*n)</li></ul><h3 id="6-1-2-éå¤šé¡¹å¼é‡çº§"><a href="#6-1-2-éå¤šé¡¹å¼é‡çº§" class="headerlink" title="6.1.2 éå¤šé¡¹å¼é‡çº§"></a>6.1.2 éå¤šé¡¹å¼é‡çº§</h3><p>éå¸¸ä½æ•ˆï¼Œä¼šéšç€nçš„å¢é•¿æ€¥å‰§å¢é•¿ï¼Œå› æ­¤æˆ‘ä»¬åº”å½“å°½é‡ä¸é€‰æ‹©æœ‰å¦‚ä¸‹æ—¶é—´å¤æ‚åº¦çš„ç®—æ³•</p><ul><li>O(2^n) </li><li>O(n!)</li></ul><h2 id="6-2-ç©ºé—´å¤æ‚åº¦åˆ†æ"><a href="#6-2-ç©ºé—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="6.2 ç©ºé—´å¤æ‚åº¦åˆ†æ"></a>6.2 ç©ºé—´å¤æ‚åº¦åˆ†æ</h2><p>æ¸è¿›ç©ºé—´å¤æ‚åº¦ï¼Œè¡¨ç¤ºç®—æ³•çš„å­˜å‚¨ç©ºé—´å’Œæ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»ã€‚</p><p>ä¸€èˆ¬æ¥è¯´åœ¨O(1), O(n), O(n^2)è¿™å‡ ä¸ªå¯èƒ½æ€§ä¸Šé¢</p><h1 id="7-æµ…ææœ€å¥½ã€æœ€åã€å¹³å‡ã€å‡æ‘Šæ—¶é—´å¤æ‚åº¦"><a href="#7-æµ…ææœ€å¥½ã€æœ€åã€å¹³å‡ã€å‡æ‘Šæ—¶é—´å¤æ‚åº¦" class="headerlink" title="7. æµ…ææœ€å¥½ã€æœ€åã€å¹³å‡ã€å‡æ‘Šæ—¶é—´å¤æ‚åº¦"></a>7. æµ…ææœ€å¥½ã€æœ€åã€å¹³å‡ã€å‡æ‘Šæ—¶é—´å¤æ‚åº¦</h1><pre><code>// n è¡¨ç¤ºæ•°ç»„ array çš„é•¿åº¦int find(int[] array, int n, int x) {  int i = 0;  int pos = -1;  for (; i &lt; n; ++i) {    if (array[i] == x) {       pos = i;       break;    }  }  return pos;}</code></pre><h2 id="7-1-æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦-best-case-time-complexity"><a href="#7-1-æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦-best-case-time-complexity" class="headerlink" title="7.1 æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦(best case time complexity)"></a>7.1 æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦(best case time complexity)</h2><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œæœ€å¥½æƒ…å†µæ˜¯O(1)</p><h2 id="7-2-æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦-worst-case-time-complexity"><a href="#7-2-æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦-worst-case-time-complexity" class="headerlink" title="7.2 æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦(worst case time complexity)"></a>7.2 æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦(worst case time complexity)</h2><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œæœ€åæƒ…å†µæ˜¯O(n)</p><h2 id="7-3-å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦-average-case-time-complexity"><a href="#7-3-å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦-average-case-time-complexity" class="headerlink" title="7.3 å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦(average case time complexity)"></a>7.3 å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦(average case time complexity)</h2><p>éœ€è¦ç®—ä¸Šå‘ç”Ÿçš„æ¦‚ç‡</p><p>ä¸Šè¿°ä¾‹å­å½“ä¸­ï¼Œå› ä¸ºè¦æŸ¥æ‰¾å˜é‡xåœ¨æ•°ç»„å½“ä¸­çš„ä½ç½®ï¼Œä¸€å…±æœ‰n+1ç§æƒ…å†µï¼Œåœ¨æ•°ç»„çš„0 - n-1ä½ç½®ä¸­å’Œä¸åœ¨æ•°ç»„å½“ä¸­ã€‚å°†æ¯ç§æƒ…å†µä¸‹ï¼Œéœ€è¦éå†çš„å…ƒç´ ä¸ªæ•°ç´¯åŠ èµ·æ¥ï¼Œå†é™¤ä»¥n+1,å°±å¯ä»¥å¾—åˆ°éœ€è¦éå†çš„å…ƒç´ ä¸ªæ•°çš„å¹³å‡å€¼äº† </p><p>å³</p><pre><code>(1+2+3+ ... + n + n) / (n+1) = n(n+3)/(2(n+1))</code></pre><p>æ•…å¹³å‡å¤æ‚åº¦è¿˜æ˜¯O(n)</p><p>ç„¶è€Œè¿˜è¦è€ƒè™‘æ¯ç§æƒ…å†µä¸‹ å‘ç”Ÿçš„æ¦‚ç‡å®è´¨ä¸Šæ˜¯ä¸åŒçš„ï¼Œéœ€è¦å°†è¿™ä¸ªç®—ä¸Š</p><h2 id="7-4-å‡æ‘Šæ—¶é—´å¤æ‚åº¦-amortized-time-complexity"><a href="#7-4-å‡æ‘Šæ—¶é—´å¤æ‚åº¦-amortized-time-complexity" class="headerlink" title="7.4 å‡æ‘Šæ—¶é—´å¤æ‚åº¦(amortized time complexity)"></a>7.4 å‡æ‘Šæ—¶é—´å¤æ‚åº¦(amortized time complexity)</h2><p>ä¸æ˜¯éå†caseï¼Œè€Œæ˜¯æœ‰è½®å›çš„ï¼Œå› æ­¤ç®—ä¸€ä¸ªè½®å›é‡Œçš„æ—¶é—´å°±å¯ä»¥å¾—å‡ºå¹³å‡å¤æ‚åº¦äº†</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤æ‚åº¦åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•(1)-æ¦‚è¿°</title>
      <link href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-1-%E6%A6%82%E8%BF%B0/"/>
      <url>/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-1-%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Ÿ</h1><p>å…¥èŒå·²ç»å¿«1å¹´çš„æ—¶é—´äº†ï¼Œè‡ªå·±åœ¨è¿™ä¸€å¹´ä¸­ç¡®å®æœ‰å¾ˆå¤šæ”¶è·ï¼Œæ¶¨äº†å¾ˆå¤šæ¶æ„ä¸Šçš„çŸ¥è¯†ï¼Œå¯¹äºå·¥ç¨‹ä¸Šçš„ä»£ç æµç¨‹æœ‰äº†æ›´æ·±ä¸€æ­¥çš„äº†è§£ã€‚ä¸è¿‡æ„ˆå‘æ„Ÿè§‰åˆ°æ•°æ®ç»“æ„ä¸ç®—æ³•çš„é‡è¦æ€§ï¼Œå› ä¸ºåœ¨æœåŠ¡å‡ºç°bugçš„æ—¶å€™ï¼Œé™¤äº†ä¸šåŠ¡é€»è¾‘ä¸Šçš„é—®é¢˜ï¼Œå‰©ä¸‹çš„å¤§éƒ¨åˆ†éƒ½æ˜¯æ•°æ®ç»“æ„æ“ä½œä¸Šçš„ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚å¸¸è§çš„Index out of boundï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</p><p>æˆ‘æƒ³ä¸å…¶è¯´æ•°æ®ç»“æ„ä¸ç®—æ³•æ˜¯è¿›å…¥å¤§å‚çš„æ•²é—¨ç –ï¼Œä¸å¦‚è¯´äºŒè€…æ˜¯ä¸€ä¸ªä¼˜ç§€å·¥ç¨‹å¸ˆå’Œä¸€ä¸ªCRUD ç”·å­©çš„åˆ†æ°´å²­ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå¯¹äºåŸºç¡€çš„ç†è§£å†³å®šäº†ä½ çš„ä¸Šé™ï¼Œè¦çŸ¥é“åº•å±‚çš„çŸ¥è¯†æ˜¯ç›¸é€šçš„ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„å¾ˆå¤šç°åœ¨çš„æ–°å…´æŠ€æœ¯ï¼Œå®é™…ä¸Šåº•å­ä¸Šè¿˜æ˜¯ç”¨çš„é‚£äº›åå¹´å‰ï¼ŒäºŒåå¹´å‰çš„ç†å¿µã€‚å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Œå¯ä»¥ç®—å¾—ä¸Šæ˜¯æƒ³è¦å»æŒæ¡ä¸€æŠŠå± é¾™åˆ€ã€‚æ— è®ºé‡åˆ°ä»€ä¹ˆï¼Œåº–ä¸è§£ç‰›ä¸€èˆ¬ã€‚</p><p>åœ¨å·¥ä¸šç•Œï¼Œè®²é“ç†å¯¹äºä¸šåŠ¡å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ä½¿ç”¨å°è£…å¥½çš„æ¥å£ï¼Œç±»åº“ï¼Œå¹¶ç¿»è¯‘ä¸šåŠ¡é€»è¾‘ï¼Œå¾ˆå°‘éœ€è¦è‡ªå·±å®ç°æ•°æ®ç»“æ„å’Œç®—æ³•ã€‚ä½†æ˜¯ï¼Œä¸ç”¨è‡ªå·±å®ç°ä¸ä»£è¡¨ä¸éœ€è¦å»äº†è§£ã€‚</p><p>ä¾æ—§éœ€è¦çŸ¥é“è¿™èƒŒåçš„åŸç†ï¼›éœ€è¦æ‡‚å¾—åˆ†ææ—¶é—´ã€ç©ºé—´çš„å¤æ‚åº¦ï¼›éœ€è¦èƒ½å¤Ÿåˆ†è¾¨å‡ºå‡ ä¸ªç›¸ä¼¼çš„æ•°æ®ç»“æ„çš„ä¸åŒï¼›è°ƒç”¨äº†æŸä¸ªå‡½æ•°ä¹‹åï¼Œéœ€è¦çŸ¥é“å¦‚ä½•è¯„ä¼°ä»£ç çš„æ€§èƒ½å’Œèµ„æºçš„æ¶ˆè€—ã€‚</p><p>å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•ï¼Œæ˜¯ä¸ºäº†è®©è‡ªå·±æœ‰èƒ½å¤Ÿæˆé•¿èµ·æ¥çš„æ²¹/ æºã€‚</p><h1 id="2-å¦‚ä½•å­¦ä¹ ï¼Ÿ"><a href="#2-å¦‚ä½•å­¦ä¹ ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•å­¦ä¹ ï¼Ÿ"></a>2. å¦‚ä½•å­¦ä¹ ï¼Ÿ</h1><p>é¦–å…ˆï¼Œæ•°æ®ç»“æ„ä¸ç®—æ³•çš„å…³ç³»æ˜¯ï¼šæ•°æ®ç»“æ„ä¸ºç®—æ³•æœåŠ¡ï¼Œè€Œç®—æ³•è¦ä½œç”¨åœ¨ç‰¹å®šçš„æ•°æ®ç»“æ„ä¹‹ä¸Šã€‚</p><p>æ•°æ®ç»“æ„æ˜¯é™æ€çš„ï¼Œæ˜¯ç»„ç»‡æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚æˆ‘ä»¬éœ€è¦åœ¨å…¶åŸºç¡€ä¸Šæ“ä½œã€æ„å»ºç®—æ³•ï¼Œå­¤ç«‹å­˜åœ¨çš„æ•°æ®ç»“æ„æ˜¯æ²¡ç”¨çš„ã€‚</p><ul><li>å¤æ‚åº¦åˆ†æ<ul><li>æ•°æ®ç»“æ„ä¸ç®—æ³•æ˜¯è§£å†³å¦‚ä½•æ›´çœï¼Œæ›´å¿«çš„å­˜å‚¨å’Œå¤„ç†æ•°æ®çš„é—®é¢˜</li><li>å¤æ‚åº¦åˆ†æå°±æ˜¯å¯¹åº”çš„è€ƒé‡æ•ˆç‡å’Œèµ„æºæ¶ˆè€—çš„æ–¹æ³•</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/09/LTqyj9aMOQsXw8U.jpg" alt="fig1.png"></p><ul><li>æ•°æ®ç»“æ„ç®—æ³•æ ‘çŠ¶å›¾<ul><li>å¤æ‚åº¦åˆ†æ<ul><li>ç©ºé—´å¤æ‚åº¦</li><li>æ—¶é—´å¤æ‚åº¦<ul><li>æœ€å¥½</li><li>æœ€å</li><li>å¹³å‡</li><li>å‡æ‘Š</li></ul></li></ul></li><li>åŸºæœ¬ç®—æ³•æ€æƒ³<ul><li>è´ªå¿ƒ</li><li>åˆ†æ²»</li><li>åŠ¨æ€è§„åˆ’</li><li>å›æº¯</li><li>æšä¸¾</li></ul></li><li>æ’åº<ul><li>O(n^2)<ul><li>å†’æ³¡æ’åº</li><li>æ’å…¥æ’åº</li><li>é€‰æ‹©æ’åº</li><li>å¸Œå°”æ’åº</li></ul></li><li>O(nlogn)<ul><li>å½’å¹¶æ’åº</li><li>å¿«é€Ÿæ’åº</li><li>å †æ’åº</li></ul></li><li>O(n)<ul><li>è®¡æ•°æ’åº</li><li>åŸºæ•°æ’åº</li><li>æ¡¶æ’åº</li></ul></li></ul></li><li>æœç´¢<ul><li>æ·±åº¦ä¼˜å…ˆæœç´¢</li><li>å¹¿åº¦ä¼˜å…ˆæœç´¢</li><li>Aå¯å‘å¼æœç´¢</li></ul></li><li>æŸ¥æ‰¾<ul><li>çº¿æ€§è¡¨æŸ¥æ‰¾</li><li>æ ‘ç»“æ„æŸ¥æ‰¾</li><li>æ•£åˆ—è¡¨æŸ¥æ‰¾</li></ul></li><li>å­—ç¬¦ä¸²åŒ¹é…<ul><li>æœ´ç´ </li><li>KMP</li><li>Robin-Karp</li><li>Boyer-Moore</li><li>ACè‡ªåŠ¨æœº</li><li>Trie</li><li>åç¼€æ•°ç»„</li></ul></li><li>å›¾<ul><li>å­˜å‚¨<ul><li>é‚»æ¥çŸ©é˜µ</li><li>é‚»æ¥è¡¨</li></ul></li><li>æ‹“æ‰‘æ’åº</li><li>æœ€çŸ­è·¯å¾„</li><li>å…³é”®è·¯å¾„</li><li>æœ€å°ç”Ÿæˆæ ‘</li><li>äºŒåˆ†å›¾</li><li>æœ€å¤§æµ</li></ul></li><li>æ ‘<ul><li>äºŒå‰æ ‘<ul><li>å¹³è¡¡äºŒå‰æ ‘</li><li>äºŒå‰æŸ¥æ‰¾æ ‘</li><li>å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘<ul><li>AVLæ ‘</li><li>çº¢é»‘æ ‘</li></ul></li><li>å®Œå…¨äºŒå‰æ ‘</li><li>æ»¡äºŒå‰æ ‘</li></ul></li><li>å¤šè·¯æŸ¥æ‰¾æ ‘<ul><li>B æ ‘</li><li>B+ æ ‘</li><li>2-3 æ ‘</li><li>2-3-4 æ ‘</li></ul></li><li>å †<ul><li>å°é¡¶å †</li><li>å¤§é¡¶å †</li><li>ä¼˜å…ˆçº§é˜Ÿåˆ—</li><li>æ–æ³¢é‚£å¥‘å †</li><li>äºŒé¡¹å †</li></ul></li><li>å…¶ä»–<ul><li>æ¢¨å½¢æ•°ç»„</li><li>çº¿æ®µæ ‘</li></ul></li></ul></li><li>æ•£åˆ—è¡¨<ul><li>æ•£åˆ—å‡½æ•°</li><li>å†²çªè§£å†³<ul><li>é“¾è¡¨æ³•</li><li>å¼€æ”¾å¯»å€</li><li>å…¶ä»–</li></ul></li><li>åŠ¨æ€æ‰©å®¹</li><li>ä½å›¾</li></ul></li><li>çº¿æ€§è¡¨<ul><li>æ•°ç»„</li><li>é“¾è¡¨<ul><li>å•é“¾è¡¨</li><li>åŒå‘é“¾è¡¨</li><li>å¾ªç¯é“¾è¡¨</li><li>åŒå‘å¾ªç¯é“¾è¡¨</li><li>é™æ€é“¾è¡¨</li></ul></li><li>æ ˆ<ul><li>é¡ºåºæ ˆ</li><li>é“¾å¼æ ˆ</li></ul></li><li>é˜Ÿåˆ—<ul><li>æ™®é€šé˜Ÿåˆ—</li><li>åŒç«¯é˜Ÿåˆ—</li><li>é˜»å¡é˜Ÿåˆ—</li><li>å¹¶å‘é˜Ÿåˆ—</li><li>é˜»å¡å¹¶å‘é˜Ÿåˆ—</li></ul></li></ul></li></ul></li></ul><h2 id="2-1-æœ€å¸¸ç”¨çš„åŸºç¡€æ€»ç»“"><a href="#2-1-æœ€å¸¸ç”¨çš„åŸºç¡€æ€»ç»“" class="headerlink" title="2.1 æœ€å¸¸ç”¨çš„åŸºç¡€æ€»ç»“"></a>2.1 æœ€å¸¸ç”¨çš„åŸºç¡€æ€»ç»“</h2><ul><li>æ•°æ®ç»“æ„<ul><li>æ•°ç»„</li><li>é“¾è¡¨</li><li>æ ˆ</li><li>é˜Ÿåˆ—</li><li>æ•£åˆ—è¡¨</li><li>äºŒå‰æ ‘</li><li>å †</li><li>è·³è¡¨</li><li>å›¾</li><li>Trieæ ‘</li></ul></li><li>ç®—æ³•<ul><li>é€’å½’</li><li>æ’åº</li><li>äºŒåˆ†æŸ¥æ‰¾</li><li>æœç´¢</li><li>å“ˆå¸Œç®—æ³•</li><li>è´ªå¿ƒç®—æ³•</li><li>åˆ†æ²»ç®—æ³•</li><li>å›æº¯ç®—æ³•</li><li>åŠ¨æ€è§„åˆ’</li><li>å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</li></ul></li></ul><p>å¯¹äºæ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œè¦å­¦ä¹ çš„æ˜¯ï¼š</p><ul><li>å…¶è‡ªèº«æ¥å†</li><li>ç‰¹ç‚¹</li><li>é€‚åˆè§£å†³çš„é—®é¢˜</li><li>å®é™…çš„åº”ç”¨åœºæ™¯</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åç«¯å¼€å‘å®è·µ-é¡¹ç›®æ¨¡æ¿</title>
      <link href="/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF/"/>
      <url>/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5-%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<p>æ•´ç†å‡ºä¸€å¥—å…¬å…±æ€§çš„é¡¹ç›®æ¨¡æ¿ï¼Œæ—¨åœ¨å°½é‡å¤šåœ°åŒ…å«æ—¥å¸¸å¼€å‘æ‰€éœ€ï¼Œå‡å°‘å¼€å‘è€…çš„é‡å¤æ€§å·¥ä½œä»¥åŠæä¾›ä¸€äº›æœ€ä½³å®è·µã€‚</p><h1 id="1-ä»å†™å¥½READMEå¼€å§‹"><a href="#1-ä»å†™å¥½READMEå¼€å§‹" class="headerlink" title="1. ä»å†™å¥½READMEå¼€å§‹"></a>1. ä»å†™å¥½READMEå¼€å§‹</h1><p>ä¸€ä¸ªå¥½çš„READMEç»™äººä»¥é¡¹ç›®æ¦‚è§ˆï¼Œå¯ä»¥ä½¿æ–°äººå¿«é€Ÿä¸Šæ‰‹é¡¹ç›®ï¼Œå¹¶é™ä½æ²Ÿé€šæˆæœ¬ï¼Œå»ºè®®åŒ…æ‹¬ï¼š</p><ul><li>é¡¹ç›®ç®€ä»‹<ul><li>ä¸€ä¸¤å¥è¯æè¿°è¯¥é¡¹ç›®å®ç°çš„ä¸šåŠ¡åŠŸèƒ½</li></ul></li><li>æŠ€æœ¯é€‰å‹<ul><li>é¡¹ç›®çš„æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬è¯­è¨€ï¼Œæ¡†æ¶ï¼Œä¸­é—´ä»¶ç­‰</li></ul></li><li>æœ¬åœ°æ„å»º<ul><li>åˆ—å‡ºæœ¬åœ°å¼€å‘è¿‡ç¨‹ä¸­æ‰€ç”¨åˆ°çš„å·¥å…·å‘½ä»¤</li></ul></li><li>é¢†åŸŸæ¨¡å‹<ul><li>æ ¸å¿ƒçš„é¢†åŸŸæ¦‚å¿µï¼Œé’ˆå¯¹äºå½“å‰ç³»ç»Ÿæ‰€åœ¨çš„é¢†åŸŸ</li></ul></li><li>æµ‹è¯•ç­–ç•¥<ul><li>è‡ªåŠ¨åŒ–æµ‹è¯•å¦‚ä½•åˆ†ç±»</li></ul></li><li>æŠ€æœ¯æ¶æ„<ul><li>æŠ€æœ¯æ¶æ„å›¾</li></ul></li><li>éƒ¨ç½²æ¶æ„<ul><li>éƒ¨ç½²æ¶æ„å›¾</li></ul></li><li>å¤–éƒ¨ä¾èµ–<ul><li>é¡¹ç›®è¿è¡Œæ—¶æ‰€ä»¥æ¥çš„å¤–éƒ¨é›†æˆæ–¹</li></ul></li><li>ç¯å¢ƒä¿¡æ¯<ul><li>å„ä¸ªç¯å¢ƒçš„è®¿é—®æ–¹å¼ï¼Œæ•°æ®åº“è¿æ¥</li></ul></li><li>ç¼–ç å®è·µ<ul><li>ç»Ÿä¸€çš„ç¼–ç å®è·µï¼Œæ¯”å¦‚å¼‚å¸¸å¤„ç†åŸåˆ™ï¼Œåˆ†é¡µå°è£…ç­‰</li></ul></li><li>FAQ<ul><li>å¼€å‘è¿‡ç¨‹ä¸­å¸¸è§é—®é¢˜çš„è§£ç­”</li></ul></li></ul><p>æ³¨æ„ä¿æŒREADMEçš„æŒç»­æ›´æ–°ï¼Œä¸€äº›é‡è¦çš„æ¶æ„å†³å®šå¯ä»¥é€šè¿‡ç¤ºä¾‹ä»£ç çš„å½¢å¼è®°å½•åœ¨ä»£ç å—å½“ä¸­ï¼Œæ–°å¼€å‘è€…å¯ä»¥é€šè¿‡ç›´æ¥é˜…è¯»è¿™äº›ç¤ºä¾‹ä»£ç å¿«é€Ÿäº†è§£é¡¹ç›®çš„é€šç”¨å®è·µæ–¹å¼ä»¥åŠæ¶æ„é€‰æ‹©</p><h1 id="2-ä¸€é”®å¼æœ¬åœ°æ„å»º"><a href="#2-ä¸€é”®å¼æœ¬åœ°æ„å»º" class="headerlink" title="2. ä¸€é”®å¼æœ¬åœ°æ„å»º"></a>2. ä¸€é”®å¼æœ¬åœ°æ„å»º</h1><p>å†™ä¸€ä¸ªå¿…éœ€çš„scriptï¼Œè‡ªåŠ¨åŒ–å®Œæˆæœ¬åœ°æ„å»ºçš„è¿‡ç¨‹</p><ul><li><code>run.sh</code> è¿›è¡Œæœ¬åœ°è°ƒè¯•æˆ–è€…å¿…è¦çš„æ‰‹åŠ¨æµ‹è¯•</li><li><code>local-build.sh</code>ï¼Œå®Œæˆæœ¬åœ°æ„å»º</li></ul><h1 id="3-æ—¥å¿—å¤„ç†"><a href="#3-æ—¥å¿—å¤„ç†" class="headerlink" title="3. æ—¥å¿—å¤„ç†"></a>3. æ—¥å¿—å¤„ç†</h1><ul><li>åœ¨æ—¥å¿—ä¸­åŠ å…¥è¯·æ±‚æ ‡è¯†ï¼Œä¾¿äºé“¾è·¯è¿½è¸ªã€‚åœ¨å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰æ—¶ä¼šè¾“å‡ºå¤šæ¡æ—¥å¿—ï¼Œå¦‚æœæ¯æ¡æ—¥å¿—éƒ½å…±äº«ç»Ÿä¸€çš„è¯·æ±‚IDï¼Œé‚£ä¹ˆåœ¨æ—¥å¿—è¿½è¸ªæ—¶ä¼šæ›´åŠ æ–¹ä¾¿ã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨LogbackåŸç”Ÿæä¾›çš„MDC(Mapped Diagnostic Context)åŠŸèƒ½ï¼Œåˆ›å»ºä¸€ä¸ªRequestIdMdcFilter</li></ul><pre><code>    protected void doFilterInternal(HttpServletRequest request,                                HttpServletResponse response,                                FilterChain filterChain)        throws ServletException, IOException &#123;    //request id in header may come from Gateway, eg. Nginx    String headerRequestId = request.getHeader(HEADER_X_REQUEST_ID);    MDC.put(REQUEST_ID, isNullOrEmpty(headerRequestId) ? newUuid() : headerRequestId);    try &#123;        filterChain.doFilter(request, response);    &#125; finally &#123;        clearMdc();    &#125;&#125;</code></pre><ul><li>é›†ä¸­å¼æ—¥å¿—ç®¡ç†ï¼Œåœ¨å¤šèŠ‚ç‚¹éƒ¨ç½²çš„åœºæ™¯ä¸‹ï¼Œå„ä¸ªèŠ‚ç‚¹çš„æ—¥å¿—æ˜¯åˆ†æ•£çš„ï¼Œä¸ºæ­¤å¯ä»¥å¼•å…¥è¯¸å¦‚ELKä¹‹ç±»çš„å·¥å…·å°†æ—¥å¿—ç»Ÿä¸€è¾“å‡ºåˆ°ElasticSearchä¸­ã€‚</li></ul><pre><code>&lt;appender name=&quot;REDIS&quot; class=&quot;com.cwbase.logback.RedisAppender&quot;&gt;&lt;tags&gt;ecommerce-order-backend-$&#123;ACTIVE_PROFILE&#125;&lt;/tags&gt;&lt;host&gt;elk.yourdomain.com&lt;/host&gt;&lt;port&gt;6379&lt;/port&gt;&lt;password&gt;whatever&lt;/password&gt;&lt;key&gt;ecommerce-ordder-log&lt;/key&gt;&lt;mdc&gt;true&lt;/mdc&gt;&lt;type&gt;redis&lt;/type&gt;&lt;/appender&gt;</code></pre><h1 id="4-å¼‚å¸¸å¤„ç†"><a href="#4-å¼‚å¸¸å¤„ç†" class="headerlink" title="4. å¼‚å¸¸å¤„ç†"></a>4. å¼‚å¸¸å¤„ç†</h1><p>åœ¨è®¾è®¡å¼‚å¸¸å¤„ç†çš„æ¡†æ¶çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘åˆ°ï¼š </p><ul><li>å‘å®¢æˆ·ç«¯æä¾›æ ¼å¼ç»Ÿä¸€çš„å¼‚å¸¸è¿”å›</li><li>å¼‚å¸¸ä¿¡æ¯ä¸­åº”è¯¥åŒ…å«è¶³å¤Ÿå¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæœ€å¥½æ˜¯ç»“æ„åŒ–çš„æ•°æ®ä»¥ä¾¿äºå®¢æˆ·ç«¯è§£æ</li><li>ä¸åŒç±»å‹çš„å¼‚å¸¸åº”è¯¥åŒ…å«å”¯ä¸€æ ‡è¯†ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯ç²¾ç¡®è¯†åˆ«</li></ul><p>å¼‚å¸¸å¤„ç†æœ‰ä¸¤ç§å¤„ç†å½¢å¼ï¼Œä¸€ç§æ˜¯å±‚çº§å¼ï¼Œå³æ¯ç§å…·ä½“çš„å¼‚å¸¸éƒ½å¯¹åº”äº†ä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œè¿™äº›ç±»æœ€ç»ˆç»§æ‰¿è‡ªæŸä¸ªçˆ¶å¼‚å¸¸ï¼›å¦å¤–ä¸€ç§æ˜¯å•ä¸€å¼ï¼Œå³æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œå†ä»¥ä¸€ä¸ªå­—æ®µæ¥åŒºåˆ†ä¸åŒçš„å¼‚å¸¸åœºæ™¯ã€‚å±‚çº§å¼å¼‚å¸¸çš„å¥½å¤„èƒ½å¤Ÿæ˜¾åŒ–å¼‚å¸¸çš„å«ä¹‰ï¼Œä½†æ˜¯å¦‚æœè®¾è®¡ä¸å¥½å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºä¸­å¤§é‡çš„å¼‚å¸¸ç±»ã€‚</p><p>ä½¿ç”¨å±‚çº§å¼å¼‚å¸¸çš„èŒƒä¾‹ï¼š</p><pre><code>public abstract class AppException extends RuntimeException &#123;    private final ErrorCode code;    private final Map&lt;String, Object&gt; data = newHashMap();&#125;</code></pre><p>è¿™é‡Œï¼ŒErrorCodeæšä¸¾ä¸­åŒ…å«äº†å¼‚å¸¸çš„å”¯ä¸€æ ‡è¯†ã€HTTPçŠ¶æ€ç ä»¥åŠé”™è¯¯ä¿¡æ¯ï¼›è€Œdataå­—æ®µè¡¨ç¤ºå„ä¸ªå¼‚å¸¸çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><pre><code>public class OrderNotFoundException extends AppException &#123;    public OrderNotFoundException(OrderId orderId) &#123;        super(ErrorCode.ORDER_NOT_FOUND, ImmutableMap.of(&quot;orderId&quot;, orderId.toString()));    &#125;&#125;</code></pre><p>åœ¨è¿”å›ç»™å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œé€šè¿‡ä¸€ä¸ªErrorDetailç±»æ¥ç»Ÿä¸€å¼‚å¸¸æ ¼å¼ï¼š</p><pre><code>public final class ErrorDetail &#123;    private final ErrorCode code;    private final int status;    private final String message;    private final String path;    private final Instant timestamp;    private final Map&lt;String, Object&gt; data = newHashMap();&#125;</code></pre><p>æœ€ç»ˆè¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®ä¸ºï¼š</p><pre><code>&#123;  requestId: &quot;d008ef46bb4f4cf19c9081ad50df33bd&quot;,  error: &#123;    code: &quot;ORDER_NOT_FOUND&quot;,    status: 404,    message: &quot;æ²¡æœ‰æ‰¾åˆ°è®¢å•&quot;,    path: &quot;/order&quot;,    timestamp: 1555031270087,    data: &#123;      orderId: &quot;123456789&quot;    &#125;  &#125;&#125;</code></pre><h1 id="5-ç»Ÿä¸€ä»£ç é£æ ¼"><a href="#5-ç»Ÿä¸€ä»£ç é£æ ¼" class="headerlink" title="5. ç»Ÿä¸€ä»£ç é£æ ¼"></a>5. ç»Ÿä¸€ä»£ç é£æ ¼</h1><p>é™¤äº†Checkstyleä»¥å¤–ï¼Œé¡¹ç›®ä¸­æœ‰äº›é€šç”¨çš„å…¬å…±ç¼–ç å®è·µæ–¹å¼ä¹Ÿéœ€è¦è¿›è¡Œç»Ÿä¸€ã€‚</p><ul><li>å®¢æˆ·ç«¯çš„è¯·æ±‚æ•°æ®ç±»ç»Ÿä¸€ä½¿ç”¨ç›¸åŒåç¼€ï¼Œæ¯”å¦‚Command</li><li>è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®ç»Ÿä¸€ä½¿ç”¨ç›¸åŒåç¼€ï¼Œæ¯”å¦‚Represetation</li><li>ç»Ÿä¸€å¯¹è¯·æ±‚å¤„ç†çš„æµç¨‹æ¡†æ¶ï¼Œæ¯”å¦‚é‡‡ç”¨ä¼ ç»Ÿçš„3å±‚æ¶æ„æˆ–è€…DDDæˆ˜æœ¯æ¨¡å¼</li><li>æä¾›ä¸€è‡´çš„å¼‚å¸¸è¿”å›ï¼ˆè¯·å‚è€ƒâ€œå¼‚å¸¸å¤„ç†â€å°èŠ‚ï¼‰</li><li>æä¾›ç»Ÿä¸€çš„åˆ†é¡µç»“æ„ç±»</li><li>æ˜ç¡®æµ‹è¯•åˆ†ç±»ä»¥åŠç»Ÿä¸€çš„æµ‹è¯•åŸºç¡€ç±»ï¼ˆè¯·å‚è€ƒâ€œè‡ªåŠ¨åŒ–æµ‹è¯•åˆ†ç±»â€å°èŠ‚ï¼‰<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1></li></ul><p><a href="https://insights.thoughtworks.cn/backend-development-iteration0/">https://insights.thoughtworks.cn/backend-development-iteration0/</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¡¹ç›®æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XMLä¸JSONçš„æ¯”è¾ƒ</title>
      <link href="/XML%E4%B8%8EJSON%E7%9A%84%E6%AF%94%E8%BE%83/"/>
      <url>/XML%E4%B8%8EJSON%E7%9A%84%E6%AF%94%E8%BE%83/</url>
      
        <content type="html"><![CDATA[<h1 id="1-JSON"><a href="#1-JSON" class="headerlink" title="1. JSON"></a>1. JSON</h1><p>JSON - JavaScript Object Notation, an open standard file format uses human-readable text to transmit data objects consisting of attributeâ€“value pairs and array data types (or any other serializable value). It is a very common data format used for asynchronous browserâ€“server communication, including as a replacement for XML in some AJAX-style systems.</p><p>The official Internet media type for JSON is <strong>application/json</strong>. </p><h1 id="2-XML"><a href="#2-XML" class="headerlink" title="2. XML"></a>2. XML</h1><p>JSON is promoted as a <strong>low-overhead alternative</strong> to XML as both of these formats have widespread support for creation, reading, and decoding in the real-world situations where they are commonly used.</p><p>XML has been used to <strong>describe structured data and to serialize objects</strong>. Various XML-based protocols exist to represent the same kind of data structures as JSON for the same kind of data interchange purposes. Data can be encoded in XML in several ways. The most expansive form <strong>using tag pairs results</strong> in a much larger representation than JSON, but if data is stored in attributes and â€˜short tagâ€™ form where the closing tag is replaced with â€˜/&gt;â€™, the representation is often about the same size as JSON or just a little larger. If the data is compressed <strong>using an algorithm like gzip</strong>, there is little difference because compression is good at saving space when a pattern is repeated.</p><p>XML also has the concept of <strong>++schema++</strong>. <strong>This permits strong typing, user-defined types, predefined tags, and formal structure, allowing for formal validation of an XML stream in a portable way</strong>. Similarly, there is an IETF draft proposal for a schema system for JSON.[44]</p><p>XML supports comments, but JSON does not</p><h1 id="3-Differences"><a href="#3-Differences" class="headerlink" title="3. Differences"></a>3. Differences</h1><h1 id="3-1-XML-is-a-markup-language-whereas-JSON-is-a-way-of-representing-objects"><a href="#3-1-XML-is-a-markup-language-whereas-JSON-is-a-way-of-representing-objects" class="headerlink" title="3.1 XML is a markup language whereas JSON is a way of representing objects"></a>3.1 XML is a markup language whereas JSON is a way of representing objects</h1><p>A markup language is a way of adding extra information to free-flowing plain text </p><pre><code>&lt;Document&gt;    &lt;Paragraph Align=&quot;Center&quot;&gt;        Here &lt;Bold&gt;is&lt;/Bold&gt; some text.    &lt;/Paragraph&gt;&lt;/Document&gt;</code></pre><p>An object notation like JSON is not as flexible. But this is usually a good thing. When youâ€™re representing objects, you simply donâ€™t need the extra flexibility. To represent the above example in JSON, youâ€™d actually have to solve some problems manually that XML solves for you.</p><pre><code>{    &quot;Paragraphs&quot;: [        {            &quot;align&quot;: &quot;center&quot;,            &quot;content&quot;: [                &quot;Here &quot;, {                    &quot;style&quot; : &quot;bold&quot;,                    &quot;content&quot;: [ &quot;is&quot; ]                },                &quot; some text.&quot;            ]        }    ]}</code></pre><p>JSON is better suited if you have typical a hierarchy of objects and you want to represent them in a stream. </p><pre><code>{    &quot;firstName&quot;: &quot;Homer&quot;,    &quot;lastName&quot;: &quot;Simpson&quot;,    &quot;relatives&quot;: [ &quot;Grandpa&quot;, &quot;Marge&quot;, &quot;The Boy&quot;, &quot;Lisa&quot;, &quot;I think that&#39;s all of them&quot; ]} </code></pre><p>Below is same expression in xml</p><pre><code>&lt;Person&gt;    &lt;FirstName&gt;Homer&lt;/FirstName&gt;    &lt;LastName&gt;Simpsons&lt;/LastName&gt;    &lt;Relatives&gt;        &lt;Relative&gt;Grandpa&lt;/Relative&gt;        &lt;Relative&gt;Marge&lt;/Relative&gt;        &lt;Relative&gt;The Boy&lt;/Relative&gt;        &lt;Relative&gt;Lisa&lt;/Relative&gt;        &lt;Relative&gt;I think that&#39;s all of them&lt;/Relative&gt;    &lt;/Relatives&gt;&lt;/Person&gt;</code></pre><h2 id="3-2-JSON-has-defined-ways-of-distinguishing-records"><a href="#3-2-JSON-has-defined-ways-of-distinguishing-records" class="headerlink" title="3.2 JSON has defined ways of distinguishing records"></a>3.2 JSON has defined ways of distinguishing records</h2><p>You can differenciate records directly in JSON. List and normal record have different expression; wheareas in XML, they look all same. </p><p>We need to use an external schema or extra user defined attributes in XML to express different expressions, or some limitations on it. While in JSON, itâ€™s self describing by default. </p><p>-&gt; JSON should be the first choise for object notation, where XML should spot at document markup. </p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BackEnd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>System.gc() and Runtime.gc()</title>
      <link href="/System-gc-and-Runtime-gc/"/>
      <url>/System-gc-and-Runtime-gc/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆåœ¨Javaä¸­åƒåœ¾å›æ”¶ç®—æ³•æ˜¯é¦–å…ˆéå†æ‰€æœ‰åœ¨å †ä¸­çš„éåƒåœ¾çš„å¯¹è±¡ï¼Œç„¶åæ¨æ–­å‡ºé‚£äº›ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰è¢«è®¿é—®çš„å¯¹è±¡ä¸€å®šæ˜¯åƒåœ¾äº†ã€‚call gc()æ–¹æ³•ä¸æ˜¯å¼ºåˆ¶åƒåœ¾å›æ”¶å‘ç”Ÿçš„ï¼Œç›¸åçš„ï¼Œå®ƒåªæ˜¯åœ¨å»ºè®®JVMç°åœ¨æ˜¯ä¸é”™çš„åšåƒåœ¾å›æ”¶çš„æ—¶é—´ã€‚</p><p>system.gc()æ˜¯ç”¨æ¥è¿è¡Œåƒåœ¾æ”¶é›†å™¨çš„ã€‚callè¿™ä¸ªæ–¹æ³•å°±æ„å‘³ç€Javaè™šæ‹Ÿæœºæ­£åœ¨åŠªåŠ›å»å›æ”¶æ²¡æœ‰è¢«ä½¿ç”¨çš„å¯¹è±¡ï¼Œä½¿å¾—ä»–ä»¬ç°åœ¨å ç”¨çš„å†…å­˜å¯ä»¥è¿›è¡Œå¿«é€Ÿåœ°å†åˆ©ç”¨ã€‚æ•´ä¸ªåƒåœ¾å›æ”¶åœ¨Javaä¸­æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ã€‚</p><p>system.gc()æ˜¯ä¸ªé™æ€æ–¹æ³•ï¼Œä½†æ˜¯æ‰‹åŠ¨è°ƒç”¨å®ƒå¾ˆæœ‰å¯èƒ½ä¼šè®©æ•´ä¸ªç³»ç»Ÿè¿è¡Œæ›´æ…¢çš„ï¼Œä¸€èˆ¬ä¸ºäº†åŠ å¿«æ•´ä½“çš„è¿è¡Œï¼Œä¼šä½¿ç”¨<code>-XX:+DisableExplicitGC</code>è¿™æ¡æŒ‡ä»¤ï¼Œè¿™æ ·å­JVMå°±ä¸ä¼šåœ¨ä½ æ‰‹åŠ¨å”¤é†’gcçš„æ—¶å€™ç›´æ¥callè¿™ä¸ªæ–¹æ³•äº†ã€‚</p><p>runtime.gc()å’Œsystem.gc()å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®è´¨ä¸Šsystem.gc()å†…éƒ¨å°±calläº†runtime.gc()ã€‚ å”¯ä¸€çš„ä¸åŒåœ¨äºSystem.gc()æ˜¯ç±»çš„æ–¹æ³•ç„¶è€Œruntime.gc()æ˜¯å®ä¾‹æ–¹æ³•ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="http://net-informations.com/java/cjava/gc.htm" target="_blank" rel="noopener">http://net-informations.com/java/cjava/gc.htm</a> </li><li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/System.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/api/java/lang/System.html</a> </li><li><a href="https://www.geeksforgeeks.org/garbage-collection-java/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/garbage-collection-java/</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby Totorial</title>
      <link href="/Ruby-Totorial/"/>
      <url>/Ruby-Totorial/</url>
      
        <content type="html"><![CDATA[<p>Met circumstances where need Ruby knowledge to resolve problems, thus need to do a quick touch on Ruby, at least know how to read ruby code. </p><p>Leran by doing, or we say, learn by satisfying current needs. </p><h1 id="1-Basics"><a href="#1-Basics" class="headerlink" title="1. Basics"></a>1. Basics</h1><ul><li>features <ul><li>object-oriented </li><li>server side scripting language </li><li>can be used to write common gateway interface(CGI) scripts</li></ul></li></ul><h2 id="1-1-Syntax-of-Ruby"><a href="#1-1-Syntax-of-Ruby" class="headerlink" title="1.1 Syntax of Ruby"></a>1.1 Syntax of Ruby</h2><ul><li>whitespace <ul><li>ignored in ruby code, except when they appear in strings. </li></ul></li><li>end of line<ul><li>you could use <ul><li>semicolons </li><li>newline characters as the ending of a statement </li></ul></li></ul></li><li>Ruby Identifiers<ul><li>case sensitive </li></ul></li><li>comments<ul><li><code>#</code></li><li><code>=begin</code> at beginning, <code>=end</code> at the end</li></ul></li></ul><pre><code>// Declares code to be called before the program run BEGIN {    code}// Declares code to be called at the end of the program END {    code}</code></pre><ul><li>classes and objects <ul><li>features<ul><li>data encapsulation </li><li>data abstraction </li><li>polymorphism</li><li>inheritance </li></ul></li></ul></li></ul><pre><code>// Class exampleClass Vehicle {   Number no_of_wheels   Number horsepower   Characters type_of_tank   Number Capacity   Function speeding {   }   Function driving {   }   Function halting {   }}</code></pre><h2 id="1-2-Class-and-Objects"><a href="#1-2-Class-and-Objects" class="headerlink" title="1.2 Class and Objects"></a>1.2 Class and Objects</h2><ul><li>Define a class in Ruby </li></ul><pre><code>// A class always starts with keyword class, followed by the name of the class. // Terminate a class by using the keyword end. class Customerend</code></pre><ul><li>Variables in a Ruby Class <ul><li>local variables <ul><li>defined in a method</li><li>begin with a lowercase letter or _. </li></ul></li><li>instance variables <ul><li>available across methods for any particular instance or object </li><li>instance variables change from object to object </li><li><code>@</code></li></ul></li><li>class variables <ul><li>available across different objects </li><li>belongs to the class and is a characteristic of a class </li><li><code>@@</code></li></ul></li><li>global variables <ul><li>Class variables are not available across classes, while global variables are.  </li><li><code>$</code></li></ul></li></ul></li></ul><pre><code>// Determine the number of objects that are being ccreated class Customer   @@no_of_customers = 0end</code></pre><ul><li>creating objects with <code>new</code> method<ul><li><code>object1 = Customer.new</code></li><li>object1 is object name</li><li>Customer is class</li><li>To instantiate a new object, you need to use class name followed by dot and new(keyword)</li></ul></li><li>custom method to create ruby objects (similar to constructor concept in Java)<ul><li>pass parameters to method new </li><li>when you plan to declare new method with parameters, you need to declare the method <strong>initialize</strong> at the time of the class creation </li></ul></li></ul><pre><code>class Customer   @@no_of_customers = 0   def initialize(id, name, addr)      @cust_id = id      @cust_name = name      @cust_addr = addr   endend// To create objects cust1 = Customer.new(&quot;1&quot;, &quot;John&quot;, &quot;Wisdom Apartments, Ludhiya&quot;)</code></pre><ul><li>member functions in class <ul><li>each method in a class starts with the keyword <code>def</code> followed by the method name </li></ul></li></ul><pre><code>class Sample    def function        statement 1        statement 2    endend// A full example #!/usr/bin/rubyclass Sample   def hello      puts &quot;Hello Ruby!&quot;   endend# Now using above class to create objectsobject = Sample. newobject.hello</code></pre><h2 id="1-3-Variables"><a href="#1-3-Variables" class="headerlink" title="1.3 Variables"></a>1.3 Variables</h2><ul><li>Global Variables <ul><li>begin with $ </li><li>uninitialized global variables have the value <code>nil</code> </li></ul></li></ul><pre><code>#!/usr/bin/ruby$global_variable = 10class Class1   def print_global      # In ruby, you can use HashTag to access any variables value       puts &quot;Global variable in Class1 is #$global_variable&quot;   endendclass Class2   def print_global      puts &quot;Global variable in Class2 is #$global_variable&quot;   endendclass1obj = Class1.newclass1obj.print_globalclass2obj = Class2.newclass2obj.print_global</code></pre><ul><li>Instance Variables <ul><li>begin with <code>@</code></li></ul></li></ul><pre><code>#!/usr/bin/rubyclass Customer   def initialize(id, name, addr)      @cust_id = id      @cust_name = name      @cust_addr = addr   end   def display_details()      puts &quot;Customer id #@cust_id&quot;      puts &quot;Customer name #@cust_name&quot;      puts &quot;Customer address #@cust_addr&quot;   endend# Create Objectscust1 = Customer.new(&quot;1&quot;, &quot;John&quot;, &quot;Wisdom Apartments, Ludhiya&quot;)cust2 = Customer.new(&quot;2&quot;, &quot;Poul&quot;, &quot;New Empire road, Khandala&quot;)# Call Methodscust1.display_details()cust2.display_details()</code></pre><ul><li>Class Variables <ul><li>begin with @@</li><li>must be initialized before they can be used in method definitions </li></ul></li></ul><pre><code>#!/usr/bin/rubyclass Customer   @@no_of_customers = 0   def initialize(id, name, addr)      @cust_id = id      @cust_name = name      @cust_addr = addr   end   def display_details()      puts &quot;Customer id #@cust_id&quot;      puts &quot;Customer name #@cust_name&quot;      puts &quot;Customer address #@cust_addr&quot;   end   def total_no_of_customers()      @@no_of_customers += 1      puts &quot;Total number of customers: #@@no_of_customers&quot;   endend# Create Objectscust1 = Customer.new(&quot;1&quot;, &quot;John&quot;, &quot;Wisdom Apartments, Ludhiya&quot;)cust2 = Customer.new(&quot;2&quot;, &quot;Poul&quot;, &quot;New Empire road, Khandala&quot;)# Call Methodscust1.total_no_of_customers()cust2.total_no_of_customers()</code></pre><ul><li><p>Local variables </p><ul><li>begin with a lowercase letter or <code>_</code></li><li>scope<ul><li>class</li><li>module</li><li>def</li><li>do to the corresponding end</li><li>blockâ€™s opening brace to its close brace </li></ul></li></ul></li><li><p>Constants</p><ul><li>Begin with an <strong>uppercase</strong> letter  </li><li>defined within a class or module </li></ul></li><li><p>Pseudo-variables </p><ul><li><p>self </p></li><li><p>true</p></li><li><p>false</p></li><li><p>nil </p><ul><li>Value representing undefined </li></ul></li><li><p><code>_FILE_</code></p><ul><li>the name of the current source file </li></ul></li><li><p><code>_LINE_</code></p><ul><li>the current line number in the source file <h2 id="1-4-Arrays"><a href="#1-4-Arrays" class="headerlink" title="1.4 Arrays"></a>1.4 Arrays</h2>Array are created by placing a comma-separated series of object references between the square brackets.</li></ul><p>#!/usr/bin/ruby</p><p>ary = [  â€œfredâ€, 10, 3.14, â€œThis is a stringâ€, â€œlast elementâ€, ]<br>ary.each do |i|<br> puts i<br>end</p></li></ul></li></ul><h2 id="1-5-Hashes"><a href="#1-5-Hashes" class="headerlink" title="1.5 Hashes"></a>1.5 Hashes</h2><p>Hash is created by placing a list of key/value pairs between braces, with either a comma or the sequence =&gt; between the key and the value. A trailing comma is ignored.</p><pre><code>#!/usr/bin/rubyhsh = colors = { &quot;red&quot; =&gt; 0xf00, &quot;green&quot; =&gt; 0x0f0, &quot;blue&quot; =&gt; 0x00f }hsh.each do |key, value|   print key, &quot; is &quot;, value, &quot;\n&quot;end</code></pre><h2 id="1-6-Ranges"><a href="#1-6-Ranges" class="headerlink" title="1.6 Ranges"></a>1.6 Ranges</h2><p>A Range represents an interval which is a set of values with a start and an end. Ranges may be constructed using the s..e and sâ€¦e literals, or with Range.new.</p><pre><code>#!/usr/bin/ruby(10..15).each do |n|    print n, &#39; &#39; end</code></pre><h2 id="1-7-Operators"><a href="#1-7-Operators" class="headerlink" title="1.7 Operators"></a>1.7 Operators</h2><ul><li><code>&lt;=&gt;</code><ul><li>ruturn 0 if first operand equals second</li><li>1 if first greater than second</li><li>-1 if first less than second </li></ul></li><li><code>.eql?</code><ul><li>true if the receiver and argument have both the same type and equal values</li></ul></li><li><code>equal?</code><ul><li>true if the receiver and argument have the same object id </li></ul></li><li><code>..</code><ul><li>1..10 creates a range from 1 to 10 inclusive</li></ul></li><li><code>...</code><ul><li>1â€¦10 creates a range from 1 to 9  </li></ul></li><li>defined? operators<ul><li>takes the form of a method call to determine whether or not the passed expression is defined</li><li>returns a description string of the expression, or nil if the expression isnâ€™t defined </li></ul></li><li>dot operators<ul><li></li></ul></li><li>double colon <code>::</code> operators<ul><li>You call a module method by preceding its name with the moduleâ€™s name and a period, and you reference a constant using the module name and two colons. </li><li><code>::</code> us a unary operator that allows constants, instance methods and class methods defined within a class or module to be accessed from anywhere outside the class or module </li><li>*<em>Classes and methods are considered to be constants too *</em></li></ul></li></ul><h2 id="1-8-Conditions"><a href="#1-8-Conditions" class="headerlink" title="1.8 Conditions"></a>1.8 Conditions</h2><pre><code>// if else condition checkif condition    code..elsif condition2    codeelse     codeend// case #!/usr/bin/ruby$age =  5case $agewhen 0 .. 2   puts &quot;baby&quot;when 3 .. 6   puts &quot;little child&quot;when 7 .. 12   puts &quot;child&quot;when 13 .. 18   puts &quot;youth&quot;else   puts &quot;adult&quot;end</code></pre><h2 id="1-9-Loops"><a href="#1-9-Loops" class="headerlink" title="1.9 Loops"></a>1.9 Loops</h2><pre><code>while condition do     codeend</code></pre><p>Executes code while conditional is true </p><pre><code>$i = 0$num = 5begin     puts(&quot;123&quot;)    $i += 1end while $i &lt; $num // for loopfor i in 0..5    puts &quot;Value of local variable is #{i}&quot;end// subtitute way of for loop(expression).each do |variable|     codeend// E.G (0..5).each do |i|    puts &quot;Value of local variable is #{i}&quot;end </code></pre><ul><li><code>next</code><ul><li>jump to the next iteration of the most internal loop </li></ul></li><li><code>redo</code><ul><li>restarts this iteration of the most internal loop, without checking loop condition  </li></ul></li><li><code>retry</code></li><li><code>break</code><ul><li>terminate the most internal loop  </li></ul></li></ul><h2 id="1-10-Methods"><a href="#1-10-Methods" class="headerlink" title="1.10 Methods"></a>1.10 Methods</h2><ul><li><p>used to bundle one or more repeatable statements into a single unit </p></li><li><p>method name should begin with a lowercase lettter </p></li><li><p>method should be defined before calling them </p></li><li><p>call the method by direcly type in the method name <code>method_name</code></p></li><li><p>with parameters <code>method_name 25, 30</code></p></li><li><p>Ruby will return the value of lat statement by default </p></li><li><p>or use the return statement </p></li><li><p>method defined in the class definition are marked as <strong>public</strong> by default </p></li><li><p>a block is always invoked from a function with the same name as that of the block </p><p>  def method_name (var1, var2)</p><pre><code>  expr</code></pre><p>  end </p></li><li><p>variable number of parameters </p><ul><li><code>def sample (*test)</code>   </li></ul></li></ul><h2 id="1-11-Blocks"><a href="#1-11-Blocks" class="headerlink" title="1.11 Blocks"></a>1.11 Blocks</h2><ul><li>definition <ul><li>consists of chunks of code</li><li>assign a name to a block </li><li>code in the block is always enclosed within braces <code>{}</code> or <code>()</code></li><li>a block is always invoked from a function with the same name as that of the block</li><li>invoke a block by using the <code>yield</code> statement </li></ul></li><li>if the last argument of a method is preceded by &amp;, then you can pass a block to this method and this block will be assigned to the last parameter. </li></ul><pre><code>#!/usr/bin/rubydef test(&amp;block)   block.callendtest { puts &quot;Hello World!&quot;}</code></pre><h2 id="1-12-Modules-and-Mixins"><a href="#1-12-Modules-and-Mixins" class="headerlink" title="1.12 Modules and Mixins"></a>1.12 Modules and Mixins</h2><ul><li>Module<ul><li>way of grouping together methods, classes, and constants </li><li>provides namespace and prevent name clashes<ul><li>a sandbox  </li></ul></li><li>implement mixin facility </li></ul></li></ul><pre><code>// syntaxmodule Identifier    statement1    statement2end</code></pre><ul><li>call a module method by precedint its name with the moduleâ€™s name and a period </li><li>reference a constant using the module name and two colons </li></ul><pre><code>#!/usr/bin/ruby# Module defined in trig.rb filemodule Trig   PI = 3.141592654   def Trig.sin(x)   # ..   end   def Trig.cos(x)   # ..   endend</code></pre><ul><li><p><code>require</code></p><ul><li>similar to import, include</li><li>if a third program wants to use any defined module, it can simply load the module files using the Ruby<code>require</code> statement </li></ul></li><li><p>mixin </p><ul><li>multiple inheratance </li></ul></li></ul><pre><code>module A   def a1   end   def a2   endendmodule B   def b1   end   def b2   endendclass Sampleinclude Ainclude B   def s1   endendsamp = Sample.newsamp.a1samp.a2samp.b1samp.b2samp.s1</code></pre><p>In this way, samp could call method defined in Module A and Module B</p><h2 id="1-13-Strings"><a href="#1-13-Strings" class="headerlink" title="1.13 Strings"></a>1.13 Strings</h2><ul><li>holds and manipulates an arbitrary sequence of one or more bytes</li></ul><h2 id="1-14-Array"><a href="#1-14-Array" class="headerlink" title="1.14 Array"></a>1.14 Array</h2><ul><li>ordered, integer indexed collections of any object</li><li>each element in an array is associated with and referred to by an index </li><li>creating arrays<ul><li><code>Array.new</code> </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ruby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PATH and LD_LIBRARY_PATH</title>
      <link href="/PATH-and-LD-LIBRARY-PATH/"/>
      <url>/PATH-and-LD-LIBRARY-PATH/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-LD-LIBRARY-PATH"><a href="#1-What-is-LD-LIBRARY-PATH" class="headerlink" title="1. What is LD_LIBRARY_PATH?"></a>1. What is LD_LIBRARY_PATH?</h1><p>LD_LIBRARY_PATH is a variable in linux to provide a list of additional directories in which to search for dynamically linkable libraries. </p><p>Consulted at time of execution , not consulted at link time </p><h1 id="2-PATH"><a href="#2-PATH" class="headerlink" title="2. PATH"></a>2. PATH</h1><p>PATH environment variable specifies the search paths for commands</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lombok</title>
      <link href="/Lombok/"/>
      <url>/Lombok/</url>
      
        <content type="html"><![CDATA[<p>Merely want to list all annotations here, and do some analysis. Lombok is a great tool to relieve java programmer from writing duplicate code. </p><h1 id="1-EqualsAndHashCode"><a href="#1-EqualsAndHashCode" class="headerlink" title="1. @EqualsAndHashCode"></a>1. @EqualsAndHashCode</h1><p>Generates hashCode and equals implementations from the fields of your object. </p><h2 id="1-1-Whatâ€™s-hashCode-equals-use-for"><a href="#1-1-Whatâ€™s-hashCode-equals-use-for" class="headerlink" title="1.1 Whatâ€™s hashCode/ equals use for?"></a>1.1 Whatâ€™s hashCode/ equals use for?</h2><p>Equals compare pass-in objectsâ€™ attributes, to see if they are the same. It compares all the field values to make judgement. </p><p>== compares whether two object references point to the same object</p><p>Use hashcode() method to optimize performance when comparing objects. <strong><em>Execute hashcode() returns a unique ID for each object in your program, which makes the task of comparing the whole state of the object much easier.</em></strong> </p><p>First run hashcode() method to judge if two objects are same, then run equals() method. </p><p>See <a href="https://www.javaworld.com/article/3305792/learn-java/java-challengers-4-comparing-java-objects-with-equals-and-hashcode.html" target="_blank" rel="noopener">Comparing Java objects with <code>equals()</code> and <code>hashcode()</code></a></p><h2 id="1-2-Implementation"><a href="#1-2-Implementation" class="headerlink" title="1.2 Implementation"></a>1.2 Implementation</h2><ol><li>By default, it uses all non-static and non-transient fields</li><li>Do modification by set <code>@EqualsAndHashCode.Include</code> or <code>@EqualsAndHashCode.Exclude</code></li></ol><h3 id="1-3-1-Apply-to-a-class-that-extends-another"><a href="#1-3-1-Apply-to-a-class-that-extends-another" class="headerlink" title="1.3.1 Apply to a class that extends another"></a>1.3.1 Apply to a class that extends another</h3><p>Normally, auto-generating an equals and hashCode method for such classes is a bad idea, as the superclass also defines fields, which also need equals/hashCode code but this code will not be generated. By setting callSuper to true, you can include the equals and hashCode methods of your superclass in the generated methods. For hashCode, the result of super.hashCode() is included in the hash algorithm, and forequals, the generated method will return false if the super implementation thinks it is not equal to the passed in object.  You can safely call your superclass equals if it, too, has a lombok-generated equals method.</p><p><code>callSuper</code>, set it to ture when you donâ€™t extend anything is a compile time error. </p><pre><code> import lombok.EqualsAndHashCode;@EqualsAndHashCodepublic class EqualsAndHashCodeExample {  private transient int transientVar = 10;  private String name;  private double score;  @EqualsAndHashCode.Exclude private Shape shape = new Square(5, 10);  private String[] tags;  @EqualsAndHashCode.Exclude private int id;  public String getName() {    return this.name;  }  @EqualsAndHashCode(callSuper=true)  public static class Square extends Shape {    private final int width, height;    public Square(int width, int height) {      this.width = width;      this.height = height;    }  }}</code></pre><h1 id="2-NonNull"><a href="#2-NonNull" class="headerlink" title="2. @NonNull"></a>2. @NonNull</h1><p>Use this annotation on the parameter of a mothod or constructor to have lombok generate a null-check statement. </p><p>And a @NonNull on a primitive parameter results in a warning. </p><pre><code> import lombok.NonNull;public class NonNullExample extends Something {  private String name;  public NonNullExample(@NonNull Person person) {    super(&quot;Hello&quot;);    this.name = person.getName();  }}</code></pre><h1 id="3-Cleanup"><a href="#3-Cleanup" class="headerlink" title="3. @Cleanup"></a>3. @Cleanup</h1><p>Itâ€™s an antomatic resource management: call your close() methods safely with no hassle!</p><p>You can use @Cleanup to <strong><em>ensure a given resource is automatically cleaned up before the code execution path exits your current scope</em></strong>. </p><p>For example, you can use it likeï¼š </p><pre><code>@Cleanup InputStream in = new FileInputStream(&quot;some/file&quot;);</code></pre><p>As a result, at the end of the scope you are in, <code>in.close()</code> is called. The call is guaranteed to run by way of a try/ finally construct. </p><p>If the type of object youâ€™d like to cleanup does not have a close method, you can specify the name of this method like:</p><pre><code>@Cleanup(&quot;dispose&quot;) org.eclipse.swt.widgets.CoolBar bar = new CoolBar(parent, 0); </code></pre><p>Notice: there should be no variables in the cleanup method. </p><pre><code> import lombok.Cleanup;import java.io.*;public class CleanupExample {  public static void main(String[] args) throws IOException {    @Cleanup InputStream in = new FileInputStream(args[0]);    @Cleanup OutputStream out = new FileOutputStream(args[1]);    byte[] b = new byte[10000];    while (true) {      int r = in.read(b);      if (r == -1) break;      out.write(b, 0, r);    }  }}</code></pre><h1 id="4-Getter-Setter"><a href="#4-Getter-Setter" class="headerlink" title="4. @Getter/ @Setter"></a>4. @Getter/ @Setter</h1><p>Annotate any field with Getter and Setter to let lombok generate the default getter/ setter automatically. </p><p>The generated getter/setter method will be public unless you explicitly specify an AccessLevel, as shown in the example below. Legal access levels are PUBLIC, PROTECTED, PACKAGE, and PRIVATE.</p><p>Also we can put the annotation on a class, in this way, itâ€™s as if you annotate all the non-static fields in the class with annotation. </p><pre><code> import lombok.AccessLevel;import lombok.Getter;import lombok.Setter;public class GetterSetterExample {  /**   * Age of the person. Water is wet.   *    * @param age New value for this person&#39;s age. Sky is blue.   * @return The current value of this person&#39;s age. Circles are round.   */  @Getter @Setter private int age = 10;  /**   * Name of the person.   * -- SETTER --   * Changes the name of this person.   *    * @param name The new value.   */  @Setter(AccessLevel.PROTECTED) private String name;  @Override public String toString() {    return String.format(&quot;%s (age: %d)&quot;, name, age);  }}</code></pre><h1 id="5-ToString"><a href="#5-ToString" class="headerlink" title="5. @ToString"></a>5. @ToString</h1><p>No need to start a debugger to see your fields, lombok can generate a toString for you. </p><p>Any <strong><em>class</em></strong> can be annotated with @ToString to let lombok generate an implementation of the toString() method. </p><p>We can set: </p><ul><li><p>includeFieldNames </p><ul><li>Add some clarity to the output </li></ul></li><li><p>@ToString.Exclude </p></li><li><p>@ToString(onlyExplicitlyIncluded = true)</p><ul><li>specify exactly which fields you wish to be used  </li><li>then marking each field you want to include with <code>@ToString.Include</code></li></ul></li><li><p>Can also include non static methods that take no argument  -&gt; use <code>@ToString.Include</code></p><p>  import lombok.ToString;</p><p>  @ToString<br>  public class ToStringExample {</p><pre><code>private static final int STATIC_VAR = 10;private String name;private Shape shape = new Square(5, 10);private String[] tags;@ToString.Exclude private int id;public String getName() {  return this.name;}@ToString(callSuper=true, includeFieldNames=true)public static class Square extends Shape {  private final int width, height;  public Square(int width, int height) {    this.width = width;    this.height = height;  }}</code></pre><p>  }</p></li></ul><h1 id="6-NoArgsConstructor-RequiredArgsConstructor-AllArgsConstructor"><a href="#6-NoArgsConstructor-RequiredArgsConstructor-AllArgsConstructor" class="headerlink" title="6. @NoArgsConstructor, @RequiredArgsConstructor, @AllArgsConstructor"></a>6. @NoArgsConstructor, @RequiredArgsConstructor, @AllArgsConstructor</h1><p>Constructors: </p><ul><li>Generates constructors that take no arguments</li><li>Generates constructors that take one argument per final/ non-null field </li><li>Generates constructors that take one argument for every field</li></ul><h2 id="6-1-NoArgsConstructor"><a href="#6-1-NoArgsConstructor" class="headerlink" title="6.1 @NoArgsConstructor"></a>6.1 @NoArgsConstructor</h2><p>@NoArgsConstructor will generate a constructor with no parameters. </p><p>If itâ€™s not possible(because of final fields), a compiler error will result, unless we use <code>@NoArgsConstructor(force = true)</code>. Then all final fields are initialized with 0/ false/ null </p><h2 id="6-2-RequiredArgsConstructor"><a href="#6-2-RequiredArgsConstructor" class="headerlink" title="6.2 @RequiredArgsConstructor"></a>6.2 @RequiredArgsConstructor</h2><p>@RequiredArgsConstructor  generates a constructor with 1 parameter for each field that requires special handling.  All <strong>non-initialized final fields</strong> get a parameter, as well as any fields that are marked as <strong>@NonNull</strong> that arenâ€™t initialized where they are declared. For those fields marked with @NonNull, an explicit null check is also generated. The constructor will throw a NullPointerException if any of the parameters intended for the fields marked with @NonNull contain null. The order of the parameters match the order in which the fields appear in your class.</p><h2 id="6-3-AllArgsConstructor"><a href="#6-3-AllArgsConstructor" class="headerlink" title="6.3 @AllArgsConstructor"></a>6.3 @AllArgsConstructor</h2><p>@AllArgsConstructor generates a constructor with 1 parameter for each field in your class. Fields marked with @NonNull result in null checks on those parameters.</p><h1 id="7-Data"><a href="#7-Data" class="headerlink" title="7. @Data"></a>7. @Data</h1><p>All togerther: a shortcut for: </p><ul><li>@ToString,</li><li>@EqualsAndHashCode</li><li>@Getter on all fields</li><li>@Setter on all non-final fields</li><li>@RequiredArgsConstructor </li></ul><p>@Data generates all the boilerplate that is normally associated with simple POJOs (Plain Old Java Objects) and beans: getters for all fields, setters for all non-final fields, and appropriate toString, equals and hashCode implementations that involve the fields of the class, and a constructor that initializes all final fields, as well as all non-final fields with no initializer that have been marked with @NonNull, in order to ensure the field is never null.</p><p>All generated getters and setters will be public</p><p>All fields marked as transient will not be considered for hashCode and equals. All static fields will be skipped entirely. </p><pre><code> import lombok.AccessLevel;import lombok.Setter;import lombok.Data;import lombok.ToString;@Data public class DataExample {  private final String name;  @Setter(AccessLevel.PACKAGE) private int age;  private double score;  private String[] tags;  @ToString(includeFieldNames=true)  @Data(staticConstructor=&quot;of&quot;)  public static class Exercise&lt;T&gt; {    private final String name;    private final T value;  }}</code></pre><h1 id="8-Value"><a href="#8-Value" class="headerlink" title="8. @Value"></a>8. @Value</h1><p>@Value is the immutable variant of @Data. All fields are made private and final by default. setters are not generated at all. </p><p>The class itself is also made final by default, becuase immutability is not something that can be forced onto a sunclass.</p><p>Actually, @Value equals to <code>final @ToString @EqualsAndHashCode @AllArgsConstructor @FieldDefaults(makeFinal = true, level = AccessLevel.PRIVATE) @Getter</code></p><pre><code>import lombok.AccessLevel;import lombok.experimental.NonFinal;import lombok.experimental.Value;import lombok.experimental.Wither;import lombok.ToString;@Value public class ValueExample {  String name;  @Wither(AccessLevel.PACKAGE) @NonFinal int age;  double score;  protected String[] tags;  @ToString(includeFieldNames=true)  @Value(staticConstructor=&quot;of&quot;)  public static class Exercise&lt;T&gt; {    String name;    T value;  }}</code></pre><h1 id="9-Builder"><a href="#9-Builder" class="headerlink" title="9. @Builder"></a>9. @Builder</h1><p>The @Builder annotation produces complex builder APIs for your classes.</p><p>@Builder lets you automatically produce the code required to have your class be instantiable with code such as:<br>Person.builder().name(â€œAdam Savageâ€).city(â€œSan Franciscoâ€).job(â€œMythbustersâ€).job(â€œUnchained Reactionâ€).build();</p><h1 id="10-Getter-lazy-true"><a href="#10-Getter-lazy-true" class="headerlink" title="10. @Getter(lazy = true)"></a>10. @Getter(lazy = true)</h1><p>You can let lombok generate a getter which will calculate a value once, the first time this getter is called, and cache it from then on. This can be useful if calculating the value takes a lot of CPU, or the value takes a lot of memory. To use this feature, create a private final variable, initialize it with the expression thatâ€™s expensive to run, and annotate your field with @Getter(lazy=true)</p><pre><code> import lombok.Getter;public class GetterLazyExample {  @Getter(lazy=true) private final double[] cached = expensive();  private double[] expensive() {    double[] result = new double[1000000];    for (int i = 0; i &lt; result.length; i++) {      result[i] = Math.asin(i);    }    return result;  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Annotation </tag>
            
            <tag> Lombok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSP Tutorial</title>
      <link href="/JSP-Tutorial/"/>
      <url>/JSP-Tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><h2 id="1-1-Intro"><a href="#1-1-Intro" class="headerlink" title="1.1 Intro"></a>1.1 Intro</h2><ul><li>JavaServer Pages <ul><li>develop webpages that support dynamic content </li><li>collect input from users through webpage forms</li><li>present records from a database or another source </li><li>creates webpage dynamically </li></ul></li></ul><h2 id="1-2-Architecture"><a href="#1-2-Architecture" class="headerlink" title="1.2 Architecture"></a>1.2 Architecture</h2><ul><li><p>JSP engine</p><ul><li>a container to process JSP pages  </li><li>responsible for intercepting requests for JSP pages </li></ul></li><li><p>JSP processing </p><ul><li>browser sends an HTTP request to the web server </li><li>web server recognizes that the HTTP request is for a JSP page and forwards it to a JSP engine. <ul><li>Finish by using the URL or JSP page which ends with .jsp instead of .html </li></ul></li><li>JSP engine loads the JSP page from disk and converts it into a servlet content. </li><li>JSP engine compiles the servlet into an executable class and forwards the original request to a servlet engine</li><li>A part of the web server called the servlet engine loads the Servlet class and executes it. During execution, the servlet produces an output in HTML format. The output is furthur passed on to the web server by the servlet engine inside an HTTP response.</li><li>The web server forwards the HTTP response to your browser in terms of static HTML content !!! Return static html directly </li><li>the web browser handles the dynamically generated HTML page inside the HTTP response exactly as if it were a static page </li></ul></li></ul><h2 id="1-3-Lifecycle"><a href="#1-3-Lifecycle" class="headerlink" title="1.3 Lifecycle"></a>1.3 Lifecycle</h2><p>A JSP life cycle is defined as the process from its creation till the destruction, Similar to a servlet life cycle with an additional step which is required to compile a JSP into servlet.</p><ul><li>compilation<ul><li>when a browser asks for a JSP, the JSP engine first checks to see whether it needs to compile the page </li><li>If the page has never been compiled, or if the JSP has been modified since it was last compiled, the JSP engine compiles the page</li><li>compile involves:<ul><li>parsing the JSP</li><li>turning the JSP into a servlet </li><li>compile the servlet </li></ul></li></ul></li><li>initialization<ul><li>invokes the jspInit() method before servicing any requests  </li></ul></li><li>execution<ul><li>represents all interactions with requests until the JSP is destroyed </li><li>Whenever a browser requests a JSP and the page has been loaded and initialized, the JSP engine invokes the _jspService() method in the JSP</li><li><code>void _jspService(HttpServletRequest request, HttpServletResponse response) {// Service handling code...}</code></li></ul></li><li>cleanup <ul><li>represents when a JSP is being removed from use by a container </li><li>The jspDestroy() method is the JSP equivalent of the destroy method for servlets. </li></ul></li></ul><h1 id="2-Syntax-Operations"><a href="#2-Syntax-Operations" class="headerlink" title="2. Syntax/ Operations"></a>2. Syntax/ Operations</h1><h2 id="2-1-Elements-of-JSP"><a href="#2-1-Elements-of-JSP" class="headerlink" title="2.1 Elements of JSP"></a>2.1 Elements of JSP</h2><h3 id="2-1-1-Scriptlet"><a href="#2-1-1-Scriptlet" class="headerlink" title="2.1.1 Scriptlet"></a>2.1.1 Scriptlet</h3><p>A scriptlet can contain any number of JAVA language statements, variable or method declarations, or expressions that are valid in the page scripting language. </p><p><code>&lt;%code fragment%&gt;</code></p><p>XML equivalent as follows: </p><pre><code>&lt;jsp:scriptlet&gt;   code fragment&lt;/jsp:scriptlet&gt;</code></pre><p>Any text, HTML tags, or JSP elements you write must be outside the scriptlet. </p><h3 id="2-1-2-JSP-Declarations"><a href="#2-1-2-JSP-Declarations" class="headerlink" title="2.1.2 JSP Declarations"></a>2.1.2 JSP Declarations</h3><p>A declaration declares one or more variables or methods that you can use in Java code later in the JSP file. You must declare the variable or method before you use it in the JSP file.</p><pre><code>&lt;%! declaration; [ declaration; ]+ ... %&gt;</code></pre><p>We can also write the XML equivalent of the above syntax as follows: </p><pre><code>&lt;jsp:declaration&gt;   code fragment&lt;/jsp:declaration&gt;</code></pre><h3 id="2-1-3-JSP-Expression"><a href="#2-1-3-JSP-Expression" class="headerlink" title="2.1.3 JSP Expression"></a>2.1.3 JSP Expression</h3><ul><li>Contains a scripting language expression that is evaluated, converted to a String, and inserted where the expression appears in the JSP file. </li><li>The expression element can contain any expression that is valid according to the Java Language Specification but you cannot use a semicolon to end an expression.</li></ul><pre><code>&lt;%= expression %&gt;&lt;jsp:expression&gt;    expression&lt;/jsp:expression&gt;</code></pre><h3 id="2-1-4-JSP-Comments"><a href="#2-1-4-JSP-Comments" class="headerlink" title="2.1.4 JSP Comments"></a>2.1.4 JSP Comments</h3><p>JSP comments marks text or statements that the JSP container should ignore. A JSP comment is useful when you want to hide or comment out. </p><p>&lt;%â€“ This is JSP comment â€“%&gt;</p><h3 id="2-1-5-JSP-Directives"><a href="#2-1-5-JSP-Directives" class="headerlink" title="2.1.5 JSP Directives"></a>2.1.5 JSP Directives</h3><ul><li>A JSP directive affects the overall structure of the servlet class. </li></ul><pre><code>&lt;%@ directive attribute=&quot;value&quot; %&gt;</code></pre><ul><li><code>&lt;%@ page. attribute=.. %&gt;</code><ul><li>Defines page dependent attributes<ul><li>scripting language</li><li>error page</li><li>buffering requirements </li></ul></li><li>instructions to the current page </li><li>attributes list <ul><li>buffer </li><li>autoFlush </li><li>contentType</li><li>errorPage</li><li>isErrorPage</li><li>extends</li><li>import</li><li>info </li><li>isThreadSafe</li><li>language</li><li>session </li><li>isELignored </li><li>isScriptingEnabled</li></ul></li></ul></li><li><code>&lt;%@ include ... %&gt;</code><ul><li>include a file during the translation phase  </li><li>tells the container to merge the content of other external files with the current JSP during the translation phase.</li></ul></li><li><code>&lt;%@ taglib ... %&gt;</code><ul><li>declares a tag library, containing custom actions, used in the page  </li></ul></li></ul><h3 id="2-1-6-JSP-Actions"><a href="#2-1-6-JSP-Actions" class="headerlink" title="2.1.6 JSP Actions"></a>2.1.6 JSP Actions</h3><p>JSP actions use contructs in XML syntax to control the behavior of the servlet engine</p><p>You can dynamically insert a file, reuse javaBeans components, forward the user to another page, or generate HTML for the java plugin </p><pre><code>&lt;jsp:action_name  attribute=&quot;value&gt;</code></pre><ul><li>jsp:include </li><li>jsp:useBean </li><li>jsp:setProperty</li><li>jsp:forward <ul><li>forward the requester to a new page </li></ul></li><li>jsp:plugin<ul><li>generates browser-specific code that makes an OBJECT or EMBED tag for the java plugin</li></ul></li><li>jsp:element <ul><li>defines XML elements dynamically </li></ul></li><li>jsp:attribute <ul><li>defines dynamically defined XML elementâ€™s attribute</li></ul></li><li>jsp:body<ul><li>Defines dynamically-defined XML elementâ€™s body.</li></ul></li><li>jsp:text <ul><li>write template text in JSP pages and documents </li></ul></li></ul><h2 id="2-2-JSP-Implicit-Objects"><a href="#2-2-JSP-Implicit-Objects" class="headerlink" title="2.2 JSP Implicit Objects"></a>2.2 JSP Implicit Objects</h2><p>JSP supports some automatically defined variables</p><ul><li>request <ul><li>HttpServletRequest object </li></ul></li><li>response <ul><li>HttpServletResponse object </li></ul></li><li>out <ul><li>send output  to the client </li></ul></li><li>session <ul><li>HttpSession object associated with the request </li></ul></li><li>application <ul><li>The servletContext object associated with the application context </li></ul></li><li>config <ul><li>servletConfig object associated with the page </li></ul></li><li>pageContext<ul><li>This encapsulates use of server-specific features like higher performance JspWriters.</li></ul></li><li>page<ul><li>This is simply a synonym for this, and is used to call the methods defined by the translated servlet class.</li></ul></li><li>exception <ul><li>The Exception object allows the exception data to be accessed by designated JSP. </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JSP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JMX - Tutorials</title>
      <link href="/JMX-Tutorials/"/>
      <url>/JMX-Tutorials/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><ul><li>JMX - Java Management extensions<ul><li>export standard metrics and custom metrics using MBeans to a monitoring system </li><li>understand how your application is performing <ul><li>memory </li><li>cpu</li><li>threads </li><li>API calls in a REST endpoint</li></ul></li></ul></li></ul><h1 id="2-Why-need-this"><a href="#2-Why-need-this" class="headerlink" title="2. Why need this?"></a>2. Why need this?</h1><ul><li>Large scale java applications <ul><li>gather performance information <ul><li>number of users connected </li></ul></li></ul></li><li>could provide a monitoring interface </li><li>any class that exports data to JMX is called a Managed Bean(MBean). These MBeans publish their metrics to a MBean Server provided by the Java platform. </li></ul><h1 id="3-Components"><a href="#3-Components" class="headerlink" title="3. Components"></a>3. Components</h1><h2 id="3-1-MBean"><a href="#3-1-MBean" class="headerlink" title="3.1 MBean"></a>3.1 MBean</h2><ul><li>Objects with methods that return information and export the information via the MBeanServer</li><li>Mainly have 4 types <ul><li>Standard MBean <ul><li>create an interface with getter  </li></ul></li><li>Dynamic MBean <ul><li>implements getters and setters to retrieve or modify the metric that can be auto discovered by implementing the javax.management.DynamicMBean interface </li></ul></li><li>Model MBean<ul><li>Generic, dynamic in runtime to instrument the resources  </li></ul></li><li>Open MBean<ul><li>Using a predefined set of java classes</li></ul></li></ul></li></ul><h1 id="4-Example"><a href="#4-Example" class="headerlink" title="4. Example"></a>4. Example</h1><pre><code>// Create an interface that the MBeanServer will retrieve information public interface SystemStatusMBean {   Integer getNumberOfSecondsRunning();   String getProgramName();   Long getNumberOfUnixSecondsRunning();   Boolean getSwitchStatus();}</code></pre><p>Actual Implementation </p><pre><code>    public class SystemStatus implements SystemStatusMBean {   private Integer numberOfSecondsRunning;   private String programName;   private Long numberOfUnixSecondsRunning;   private Boolean switchStatus;   private Thread backgroundThread;   public SystemStatus(String programName) {       // First we initialize all the metrics       this.backgroundThread = new Thread();       this.programName = programName;       this.numberOfSecondsRunning = 0;       this.numberOfUnixSecondsRunning = System.currentTimeMillis() / 1000L;       this.switchStatus = false;       // We will use a background thread to update the metrics       this.backgroundThread = new Thread(() -&gt; {           try {               while (true) {                   // Every second we update the metrics                   numberOfSecondsRunning += 1;                   numberOfUnixSecondsRunning += 1;                   switchStatus = !switchStatus;                   Thread.sleep(1000L);               }           } catch (Exception e) {               e.printStackTrace();           }       });       this.backgroundThread.setName(&quot;backgroundThread&quot;);       this.backgroundThread.start();   }</code></pre><h1 id="5-Operations-and-attributes"><a href="#5-Operations-and-attributes" class="headerlink" title="5. Operations and attributes"></a>5. Operations and attributes</h1><p>Class properties exported through MBeans are called attributes, and methods exported through MBeans are called operations.</p><ul><li>TotalCompilationTime <ul><li>Total time spent doing in JIT compilation  </li></ul></li><li>Garbage Collector - CollectionCount <ul><li>Number of garbage collection events fired since the JVM launch</li></ul></li><li>Garbage Collector - CollectionTime </li><li>FreePyhsicalMemorySize </li><li>CommitedVirtualMemorySize<ul><li>The amount of memory that is guaranteed to be available for use by JVM  </li></ul></li><li>ProcessCpuTime <ul><li>Time CPU has spent running the process  </li></ul></li><li>PeakThreadCount <ul><li>maximum number of threads being executed at the same time since the JVM was started or the peak was reset  </li></ul></li><li>ThreadCount <ul><li>the number of threads running at the current moment </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://sysdig.com/blog/jmx-monitoring-custom-metrics/" target="_blank" rel="noopener">https://sysdig.com/blog/jmx-monitoring-custom-metrics/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JMX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ˜¯å¦‚ä½•å·¥ä½œçš„</title>
      <link href="/Java%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/"/>
      <url>/Java%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#1-ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="1. ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•å·¥ä½œçš„"></a>1. ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•å·¥ä½œçš„</h1><p>æˆ‘ä»¬å¯ä»¥æŠŠç¼–ç¨‹è¯­è¨€æŒ‰ç…§ä¸åº•å±‚å®ç°çš„æ¥è¿‘ç¨‹åº¦æ¥åˆ’åˆ†å±‚æ¬¡ï¼Œæ›´åŠ é«˜å±‚æ¬¡çš„ç¼–ç¨‹è¯­è¨€ä¼šè®©æˆ‘ä»¬å†™èµ·æ¥æ›´åƒè‡ªç„¶è¯­è¨€ä¸€äº›ï¼Œæ¯”å¦‚Java, C++ã€‚è€Œä½å±‚æ¬¡çš„è¯­è¨€ï¼Œæ›´è´´è¿‘æœºå™¨è¯­è¨€ï¼Œå³åœ¨æè¿°åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>å¯¹äºå¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œå·¥ä½œçš„æ•´ä¸ªè¿‡ç¨‹æ˜¯ä»ç¼–è¯‘ - é“¾æ¥ - æ‰§è¡Œã€‚å°±æ˜¯ä»æºä»£ç å¼€å§‹ï¼Œç¼–è¯‘å™¨ä¼šè¿è¡Œæºä»£ç ï¼Œå°†å…¶è½¬åŒ–ä¸ºè´´è¿‘æœºå™¨è¯­è¨€çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º<code>Object</code> æ–‡ä»¶ã€‚ä¸€ç³»åˆ—çš„<code>Object</code>æ–‡ä»¶å¯ä»¥è¢«é“¾æ¥èµ·æ¥ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥åŠ è½½è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼Œå¹¶è¿è¡Œç¨‹åºã€‚</p><p>è¿˜æœ‰ä¸€éƒ¨åˆ†è¯­è¨€æ˜¯è§£é‡Šæ€§çš„ï¼Œæ¯”å¦‚Lisp, Schemaã€‚ä»–ä¼šé’ˆå¯¹æ¯ä¸€ä¸ªé«˜å±‚æ¬¡çš„è¯­å¥æ¥åšä½å±‚æ¬¡çš„ç¿»è¯‘ï¼Œç„¶åé¡ºåºæ‰§è¡Œä»–ä»¬ã€‚è¿™ä¸ªè¿‡ç¨‹ç›¸å½“äºæˆ‘é‡åˆ°ä¸€ä¸ªè¯­å¥ï¼Œç¿»è¯‘æˆè®¡ç®—æœºèƒ½çœ‹æ‡‚çš„è¯­è¨€ä»¥åï¼Œå†çœ‹ä¸‹ä¸€å¥â€¦</p><h1 id="2-Javaæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#2-Javaæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="2. Javaæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>2. Javaæ˜¯å¦‚ä½•å·¥ä½œçš„</h1><p>Javaæ˜¯ä¸ªå¹³å°ç‹¬ç«‹çš„è¯­è¨€ï¼Œé‚£ä»–æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ</p><p>é¦–å…ˆæˆ‘ä»¬è¦ç†è§£ä¸€ä¸‹ä»€ä¹ˆå«åšå¹³å°ç‹¬ç«‹ï¼Ÿ</p><blockquote><p>å¯¹äºå¾ˆå¤šç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆå¯ä»¥åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šæ‰§è¡Œçš„ä»£ç ã€‚æ¯”å¦‚ä½ åœ¨windowsæœºå™¨ä¸Šç¼–è¯‘ä¸€æ®µc++ä»£ç ï¼Œé‚£ä¹ˆç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥åœ¨ä»»ä½•å…¶ä»–çš„windowsç”µè„‘ä¸Šè¿è¡Œï¼Œä½†æ— æ³•åœ¨Macæˆ–è€…Linuxæœºå™¨ä¸Šè¿è¡Œã€‚</p></blockquote><p>å¯¹äºæ—©æœŸçš„è¯­è¨€æ¥è¯´ï¼Œè®¾è®¡è€…éœ€è¦é’ˆå¯¹æ¯ä¸€ä¸ªå¹³å°ä¸“é—¨è®¾è®¡ä¸€ä¸ªç¼–è¯‘å™¨ã€‚è€Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œå¦‚æœä½ æƒ³è‡ªå·±çš„ä»£ç åœ¨å¤šä¸ªå¹³å°ä¸Šéƒ½å¯ä»¥å·¥ä½œï¼Œä½ ä¹Ÿéœ€è¦é’ˆå¯¹æ€§çš„åšå¾ˆå¤šä¿®æ”¹ã€‚</p><p>Javaé‡æ–°ç»„ç»‡äº†ç¼–è¯‘-é“¾æ¥-æ‰§è¡Œè¿™ä¸ªå¾ªç¯ï¼Œå®ƒå°†å’Œå¹³å°ç›¸å…³çš„ä»£ç ç»™æŠ½è±¡å‡ºæ¥ï¼Œå’Œå…¶ä»–ä»£ç åˆ†å¼€ã€‚è¿™æ ·å­ï¼Œç¼–è¯‘çš„æ—¶å€™ä¸ä¼šç”Ÿæˆä¸€ä¸ªObjectæ–‡ä»¶ï¼Œåä¹‹ï¼Œä¼šç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶ï¼Œè¿™ä¸ªå­—èŠ‚ç æ–‡ä»¶æ˜¯å¹³å°ç‹¬ç«‹çš„ï¼Œå³å®ƒå¯ä»¥åœ¨ä»»ä½•å¹³å°è¿è¡Œã€‚é‚£ä¹ˆåˆšæ‰è¯´çš„å’Œå¹³å°ç›¸å…³çš„ä»£ç æ”¾åˆ°å“ªé‡Œäº†å‘¢ï¼Ÿä¸ºäº†æ‰§è¡Œå­—èŠ‚ç ï¼Œæˆ‘ä»¬éœ€è¦å”¤é†’javaè§£é‡Šå™¨ã€‚æ¯ä¸ªå¹³å°éƒ½ä¼šæœ‰è‡ªå·±çš„è§£é‡Šå™¨ï¼Œæ¥è§£å†³å’Œå¹³å°ç›¸å…³çš„é—®é¢˜ã€‚</p><p>å¯¹äºå…¶ä»–è¯­è¨€æ¥è¯´ï¼Œæ‰§è¡Œçš„è¿‡ç¨‹æ˜¯ ç¼–è¯‘ï¼Œé“¾æ¥ç„¶åæ‰§è¡Œã€‚å¯¹äºJavaæ¥è¯´ï¼Œæ›´åº”è¯¥è¯´æ˜¯ç¼–è¯‘ç„¶åé“¾æ¥ï¼Œæ‰§è¡Œã€‚</p><h1 id="3-Compile-vs-Runtime"><a href="#3-Compile-vs-Runtime" class="headerlink" title="3. Compile vs Runtime"></a>3. Compile vs Runtime</h1><p>æ•´ä¸ªä»£ç çš„lifecycle,ç¨‹åºå‘˜å…ˆå†™æºç ï¼Œé€šè¿‡æºç å®šä¹‰äº†ç¨‹åºæ˜¯æ¯”å¦‚å’Œå·¥ä½œçš„ã€‚è¿™äº›æºç å¿…é¡»è¦ç¼–è¯‘æˆæœºå™¨ç (javaé‡Œé¢ç­‰æ•ˆä¸ºå­—èŠ‚ç )ï¼Œç„¶åå˜æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™ä¸ªç¼–è¯‘çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºcompile time.</p><p>ä¸€ä¸ªç¼–è¯‘è¿‡çš„æ–‡ä»¶æ˜¯å¯ä»¥æ‰“å¼€å¹¶ä¸”è¿è¡Œçš„ï¼Œå½“ä¸€ä¸ªåº”ç”¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å«ä»–å¤„åœ¨runtimeå½“ä¸­ã€‚</p><p>compile errorä¸€èˆ¬æ˜¯åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ç”±ç¼–è¯‘å™¨æŠ¥çš„é”™ï¼Œå‘Šè¯‰æˆ‘ä»¬å“ªä¸€è¡Œå‡ºäº†ä»€ä¹ˆé—®é¢˜ã€‚è¿è¡Œæ—¶å€™çš„é”™è¯¯å°±å«åšruntime errorï¼Œè¿™å¾€å¾€æ˜¯ä¸€äº›é€»è¾‘é”™è¯¯ï¼Œç³»ç»Ÿå´©æºƒï¼Œæµé‡è¿‡å¤§ç­‰åŸå› é€ æˆçš„ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="http://www.cs.cmu.edu/~jcarroll/15-100-s05/supps/basics/history.html" target="_blank" rel="noopener">CMU Class Notes</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java Unit Test - Junit5</title>
      <link href="/Java-Unit-Test-Junit5/"/>
      <url>/Java-Unit-Test-Junit5/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Writing-Tests"><a href="#1-Writing-Tests" class="headerlink" title="1. Writing Tests"></a>1. Writing Tests</h1><p>JUnit5 = Junit Platform + Junit Jupiter + Junit Vintage </p><p>First test cases: </p><pre><code>import static org.junit.jupiter.api.Assertions.assertEquals;import example.util.Calculator;import org.junit.jupiter.api.Test;class MyFirstJUnitJupiterTests {    private final Calculator calculator = new Calculator();    @Test    void addition() {        assertEquals(2, calculator.add(1, 1));    }}</code></pre><h2 id="1-1-Annotations"><a href="#1-1-Annotations" class="headerlink" title="1.1 Annotations"></a>1.1 Annotations</h2><ul><li>@Test <ul><li>Denotes that a method is a test method. This annotation does not declare any attributes</li></ul></li><li>@ParameterizedTest <ul><li>Denote a method is a parameterized test </li><li>Make it possible to run a test multiple times with different arguments </li><li>Must declare at least one source that will provide the arguments for each invocation and then consume the arguments in teh test method </li></ul></li><li>@RepeatedTest <ul><li>denotes a method is a test template for a repeated test </li><li>Provides ability to repeat a test a specific number of times by annotating a method with <code>@RepeatedTest</code> and specify the total number of repetitions desired. </li></ul></li><li>@TestFactory <ul><li>denotes a method is a test factory for dynamic tests</li><li>dynamic test generated at runtime by a factory method that is annotated with @TestFactory </li><li>a factory for test case </li></ul></li><li>@TestTemplate<ul><li>denotes that a method is a template for test cases designed to be invoked multiple times depending on the number of invocation contexts returned by the registered providers. </li></ul></li><li>@TestMethodOrder <ul><li>Configure the test method execution order </li></ul></li><li>@TestInstance<ul><li>Used to configure the test instance lifecycle for the annotated test class.  </li></ul></li><li>@DisplayName<ul><li>Declares a custom display name for the test class or test method.</li></ul></li><li>@BeforeEach<ul><li>Denotes that the annotated method should be executed before each @Test, @RepeatedTest, @ParameterizedTest, or @TestFactory method in the current class; analogous to JUnit 4â€™s @Before. </li></ul></li><li>@AfterEach <ul><li>Denotes that the annotated method should be executed after each @Test, @RepeatedTest, @ParameterizedTest, or @TestFactory method in the current class; analogous to JUnit 4â€™s @After</li></ul></li><li>@BeforeAll <ul><li>Denotes that the annotated method should be executed before all @Test, @RepeatedTest, @ParameterizedTest, and @TestFactory methods in the current class; analogous to JUnit 4â€™s @BeforeClass. Such methods are inherited (unless they are hidden or overridden) and must be static (unless the â€œper-classâ€ test instance lifecycle is used).</li></ul></li><li>@AfterAll <ul><li>Denotes that the annotated method should be executed after all @Test, @RepeatedTest, @ParameterizedTest, and @TestFactory methods in the current class; analogous to JUnit 4â€™s @AfterClass. Such methods are inherited (unless they are hidden or overridden) and must be static</li></ul></li><li>@Nested <ul><li>Denotes that the annotated class is a non-static nested test class. @BeforeAll and @AfterAll methods cannot be used directly in a @Nested test class unless the â€œper-classâ€ test instance lifecycle is used.</li></ul></li><li>@Tag<ul><li>Used to declare tags for filtering tests, either at the class or method level; analogous to test groups in TestNG or Categories in JUnit 4. Such annotations are inherited at the class level but not at the method level.</li></ul></li><li>@Disabled <ul><li>Used to disable a test class or test method; analogous to JUnit 4â€™s @Ignore. Such annotations are not inherited.</li></ul></li><li>@ExtendWith<ul><li>Used to register extensions declaratively </li></ul></li><li>@RegisterExtension<ul><li>Used to register extensions programmatically via fields.</li></ul></li><li>@TempDir<ul><li>Used to supply a temporary directory via field injection or parameter injection in a lifecycle method or test method </li></ul></li></ul><h2 id="1-2-Test-classes-and-methods"><a href="#1-2-Test-classes-and-methods" class="headerlink" title="1.2 Test classes and methods"></a>1.2 Test classes and methods</h2><ul><li>Test classes must not be abstract and mush have a single constructor</li><li>Test method: any instance method that is directly annotated or meta-annotated with @Test, @RepeatedTest, @ParameterizedTest, @TestFactory, or @TestTemplate</li><li>Lifecycle Method: any method that is directly annotated or meta-annotated with @BeforeAll, @AfterAll, @BeforeEach, or @AfterEach</li></ul><p>A standard unit test class: </p><pre><code>import static org.junit.jupiter.api.Assertions.fail;import static org.junit.jupiter.api.Assumptions.assumeTrue;import org.junit.jupiter.api.AfterAll;import org.junit.jupiter.api.AfterEach;import org.junit.jupiter.api.BeforeAll;import org.junit.jupiter.api.BeforeEach;import org.junit.jupiter.api.Disabled;import org.junit.jupiter.api.Test;class StandardTests {    @BeforeAll    static void initAll() {    }    @BeforeEach    void init() {    }    @Test    void succeedingTest() {    }    @Test    void failingTest() {        fail(&quot;a failing test&quot;);    }    @Test    @Disabled(&quot;for demonstration purposes&quot;)    void skippedTest() {        // not executed    }    @Test    void abortedTest() {        assumeTrue(&quot;abc&quot;.contains(&quot;Z&quot;));        fail(&quot;test should have been aborted&quot;);    }    @AfterEach    void tearDown() {    }    @AfterAll    static void tearDownAll() {    }}</code></pre><h2 id="1-3-Assertions"><a href="#1-3-Assertions" class="headerlink" title="1.3 Assertions"></a>1.3 Assertions</h2><p>All assertions are static methods in org.junit.jupiter.api.Assertions class.</p><p>See <a href="https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/Assertions.html" target="_blank" rel="noopener">API doc</a> for detail: </p><ul><li>assertAll()</li><li>assertArrayEquals()</li><li>assertArrauEqualsString()</li><li>assertEquals()</li><li>assertNotEquals()</li><li>assertTimeout()</li><li>assertTimeoutPreemptively()</li><li>assertTure()</li><li>fail()</li></ul><pre><code>@Test    void dependentAssertions() {        // Within a code block, if an assertion fails the        // subsequent code in the same block will be skipped.        assertAll(&quot;properties&quot;,            () -&gt; {                String firstName = person.getFirstName();                assertNotNull(firstName);                // Executed only if the previous assertion is valid.                assertAll(&quot;first name&quot;,                    () -&gt; assertTrue(firstName.startsWith(&quot;J&quot;)),                    () -&gt; assertTrue(firstName.endsWith(&quot;e&quot;))                );            },            () -&gt; {                // Grouped assertion, so processed independently                // of results of first name assertions.                String lastName = person.getLastName();                assertNotNull(lastName);                // Executed only if the previous assertion is valid.                assertAll(&quot;last name&quot;,                    () -&gt; assertTrue(lastName.startsWith(&quot;D&quot;)),                    () -&gt; assertTrue(lastName.endsWith(&quot;e&quot;))                );            }        );    }</code></pre><h2 id="1-4-Assumptions"><a href="#1-4-Assumptions" class="headerlink" title="1.4 Assumptions"></a>1.4 Assumptions</h2><p>Assumptions is a collection of utility methods that support conditional test execution based on assumptions.In direct contrast to failed assertions, failed assumptions do not result in a test failure; rather, a failed assumption results in a <strong>test being aborted</strong>.</p><ul><li><p>assumeFalse()</p></li><li><p>assumeTrue()</p></li><li><p>assumingThat(boolean assumption, Executable executable)</p><p>   @Test</p><pre><code>  void testOnlyOnDeveloperWorkstation() {      assumeTrue(&quot;DEV&quot;.equals(System.getenv(&quot;ENV&quot;)),          () -&gt; &quot;Aborting test: not on developer workstation&quot;);      // remainder of test  }  @Test  void testInAllEnvironments() {      assumingThat(&quot;CI&quot;.equals(System.getenv(&quot;ENV&quot;)),          () -&gt; {              // perform these assertions only on the CI server              assertEquals(2, calculator.divide(4, 2));          });      // perform these assertions in all environments      assertEquals(42, calculator.multiply(6, 7));  }</code></pre></li></ul><h2 id="1-5-Test-Instance-Lifecycle"><a href="#1-5-Test-Instance-Lifecycle" class="headerlink" title="1.5 Test Instance Lifecycle"></a>1.5 Test Instance Lifecycle</h2><p>In order to allow individual test methods to be executed in isolation and to avoid unexpected side effects due to mutable test instance state, <strong>JUnit creates a new instance of each test class before executing each test method</strong></p><p>You can annotate your test class with <code>@TestInstance(Lifecycle.PER_CLASS)</code> if you <strong>prefer to execute all test methods on the same test instance</strong>. And if your test mothods rely on state stored in instance variables, may need to reset the state in @BeforeEach or @AfterEach methods. </p><p>The â€œper-classâ€ mode has some additional benefits over the default â€œper-methodâ€ mode. Specifically, with the â€œper-classâ€ mode it becomes possible to declare @BeforeAll and @AfterAll on non-static methods as well as on interface default methods. The â€œper-classâ€ mode therefore also makes it possible to use @BeforeAll and @AfterAll methods in @Nested test classes.</p><pre><code>@TestInstance(Lifecycle.PER_CLASS)interface TestLifecycleLogger {    static final Logger logger = Logger.getLogger(TestLifecycleLogger.class.getName());    @BeforeAll    default void beforeAllTests() {        logger.info(&quot;Before all tests&quot;);    }    @AfterAll    default void afterAllTests() {        logger.info(&quot;After all tests&quot;);    }    @BeforeEach    default void beforeEachTest(TestInfo testInfo) {        logger.info(() -&gt; String.format(&quot;About to execute [%s]&quot;,            testInfo.getDisplayName()));    }    @AfterEach    default void afterEachTest(TestInfo testInfo) {        logger.info(() -&gt; String.format(&quot;Finished executing [%s]&quot;,            testInfo.getDisplayName()));    }}</code></pre><h2 id="1-6-Repeated-Test"><a href="#1-6-Repeated-Test" class="headerlink" title="1.6 Repeated Test"></a>1.6 Repeated Test</h2><pre><code>import static org.junit.jupiter.api.Assertions.assertEquals;import java.util.logging.Logger;import org.junit.jupiter.api.BeforeEach;import org.junit.jupiter.api.DisplayName;import org.junit.jupiter.api.RepeatedTest;import org.junit.jupiter.api.RepetitionInfo;import org.junit.jupiter.api.TestInfo;class RepeatedTestsDemo {    private Logger logger = // ...    @BeforeEach    void beforeEach(TestInfo testInfo, RepetitionInfo repetitionInfo) {        int currentRepetition = repetitionInfo.getCurrentRepetition();        int totalRepetitions = repetitionInfo.getTotalRepetitions();        String methodName = testInfo.getTestMethod().get().getName();        logger.info(String.format(&quot;About to execute repetition %d of %d for %s&quot;, //            currentRepetition, totalRepetitions, methodName));    }    @RepeatedTest(10)    void repeatedTest() {        // ...    }    @RepeatedTest(5)    void repeatedTestWithRepetitionInfo(RepetitionInfo repetitionInfo) {        assertEquals(5, repetitionInfo.getTotalRepetitions());    }    @RepeatedTest(value = 1, name = &quot;{displayName} {currentRepetition}/{totalRepetitions}&quot;)    @DisplayName(&quot;Repeat!&quot;)    void customDisplayName(TestInfo testInfo) {        assertEquals(&quot;Repeat! 1/1&quot;, testInfo.getDisplayName());    }    @RepeatedTest(value = 1, name = RepeatedTest.LONG_DISPLAY_NAME)    @DisplayName(&quot;Details...&quot;)    void customDisplayNameWithLongPattern(TestInfo testInfo) {        assertEquals(&quot;Details... :: repetition 1 of 1&quot;, testInfo.getDisplayName());    }    @RepeatedTest(value = 5, name = &quot;Wiederholung {currentRepetition} von {totalRepetitions}&quot;)    void repeatedTestInGerman() {        // ...    }}</code></pre><h2 id="1-7-Parameterized-Tests"><a href="#1-7-Parameterized-Tests" class="headerlink" title="1.7 Parameterized Tests"></a>1.7 Parameterized Tests</h2><p>With parameterized, we could run a test multiple times with different arguments. And we must declare at least one source that will provide the arguments for each invocation and then consume the arguments in the test method. </p><pre><code>@ParameterizedTest@ValueSource(strings = { &quot;racecar&quot;, &quot;radar&quot;, &quot;able was I ere I saw elba&quot; })void palindromes(String candidate) {    assertTrue(StringUtils.isPalindrome(candidate));}</code></pre><h3 id="1-7-1-Annotations-used-in-parameterized-tests"><a href="#1-7-1-Annotations-used-in-parameterized-tests" class="headerlink" title="1.7.1 Annotations used in parameterized tests"></a>1.7.1 Annotations used in parameterized tests</h3><ul><li>@ValueSource<ul><li>specify a single array of literal values </li></ul></li><li>@NullSource<ul><li>provides a single null argument to the annotated @ParameterizedTest method.</li></ul></li><li>@EmptySource<ul><li>provides a single empty argument to the annotated @ParameterizedTest method for parameters of the following types: java.lang.String, java.util.List, java.util.Set, java.util.Map, primitive arrays (e.g., int[], char[][], etc.), object arrays (e.g.,String[], Integer[][], etc.).</li></ul></li><li>@NullAndEmptySource: <ul><li>a composed annotation that combines the functionality of @NullSource and @EmptySource.</li></ul></li></ul><pre><code>@ParameterizedTest@NullAndEmptySource@ValueSource(strings = { &quot; &quot;, &quot;   &quot;, &quot;\t&quot;, &quot;\n&quot; })void nullEmptyAndBlankStrings(String text) {    assertTrue(text == null || text.trim().isEmpty());}</code></pre><ul><li>@EnumSource<ul><li>provides a convenient way to use Enum constants. </li><li>also provides an optional names parameter that lets you specify which constants shall be used </li></ul></li></ul><pre><code>@ParameterizedTest@EnumSource(value = TimeUnit.class, names = { &quot;DAYS&quot;, &quot;HOURS&quot; })void testWithEnumSourceInclude(TimeUnit timeUnit) {    assertTrue(EnumSet.of(TimeUnit.DAYS, TimeUnit.HOURS).contains(timeUnit));}@ParameterizedTest@EnumSource(value = TimeUnit.class, mode = EXCLUDE, names = { &quot;DAYS&quot;, &quot;HOURS&quot; })void testWithEnumSourceExclude(TimeUnit timeUnit) {    assertFalse(EnumSet.of(TimeUnit.DAYS, TimeUnit.HOURS).contains(timeUnit));    assertTrue(timeUnit.name().length() &gt; 5);}</code></pre><ul><li>@MethodSource<ul><li>Allow you to refer to one or more factory methods of the test class or external classes </li><li>Each factory method must generate a stream of arguments</li></ul></li></ul><pre><code>@ParameterizedTest@MethodSource(&quot;stringProvider&quot;)void testWithExplicitLocalMethodSource(String argument) {    assertNotNull(argument);}static Stream&lt;String&gt; stringProvider() {    return Stream.of(&quot;apple&quot;, &quot;banana&quot;);}</code></pre><ul><li>@CsvSource </li><li>@CsvFileSource</li><li>@ArgumentsSource <ul><li>can be used to specify a custom resuable ArgumentsProvider </li><li>An implementation of ArgumentsProvider mush be declared as either a top-level class or as a static nested class. </li></ul></li></ul><pre><code>@ParameterizedTest@ArgumentsSource(MyArgumentsProvider.class)void testWithArgumentsSource(String argument) {    assertNotNull(argument);}public class MyArgumentsProvider implements ArgumentsProvider {    @Override    public Stream&lt;? extends Arguments&gt; provideArguments(ExtensionContext context) {        return Stream.of(&quot;apple&quot;, &quot;banana&quot;).map(Arguments::of);    }}</code></pre><h3 id="1-7-2-Lifecycle-and-Interoperability"><a href="#1-7-2-Lifecycle-and-Interoperability" class="headerlink" title="1.7.2 Lifecycle and Interoperability"></a>1.7.2 Lifecycle and Interoperability</h3><p>Each invocation of a parameterized test has the same lifecycle </p><h2 id="1-8-Test-Templates"><a href="#1-8-Test-Templates" class="headerlink" title="1.8 Test Templates"></a>1.8 Test Templates</h2><p>A @TestTemplate method is not a regular test case but rather a template for test cases. It is designed to be invoked multiple times depending on the number of invocation contexts returned by the registerd providers. </p><p>Thus, it must be used in conjunction with a registered TestTemplateInvocationContextProvider extension. Each invocation of a test template method behaves like the execution of a regular @Test method with full support for the same lifecycle callbacks and extensions.</p><h2 id="1-9-Dynamic-Tests"><a href="#1-9-Dynamic-Tests" class="headerlink" title="1.9 Dynamic Tests"></a>1.9 Dynamic Tests</h2><p> @Test describe methods that implement test cases. These test cases are static in the sense that they are fully specified at compile time, and their behavior cannot be changed by anything happening at runtime.</p><p> This new kind of test is a dynamic test which is generated at runtime by a factory method that is annotated with @TestFactory</p><p> In contrast to @Test methods, a @TestFactory method is not itself a test case but rather a factory for test cases. Thus, a dynamic test is the product of a factory. Technically speaking, a @TestFactory method must return a single DynamicNode or a Stream, Collection, Iterable, Iterator, or array of DynamicNode instances. Instantiable subclasses of DynamicNode are DynamicContainer and </p><p> DynamicContainer instances are composed of <strong>a display name</strong> and <strong>a list of dynamic child nodes</strong>, enabling the creation of arbitrarily nested hierarchies of dynamic nodes. DynamicTest instances will be executed lazily, enabling dynamic and even non-deterministic generation of test cases.</p><h3 id="1-9-1-Dynamic-test-lifecycle"><a href="#1-9-1-Dynamic-test-lifecycle" class="headerlink" title="1.9.1 Dynamic test lifecycle"></a>1.9.1 Dynamic test lifecycle</h3><p>The execution lifecycle of a dynamic test is quite different than it is for a standard @Test case. Specifically, there are <strong>no lifecycle callbacks for individual dynamic tests</strong>. This means that @BeforeEach and @AfterEach methods and their corresponding extension callbacks are** executed for the @TestFactory method** but not for each dynamic test. In other words, if you access fields from the test instance within a lambda expression for a dynamic test, those fields will not be reset by callback methods or extensions between the execution of individual dynamic tests generated by the same @TestFactory method.</p><h2 id="1-10-Parallel-Execution"><a href="#1-10-Parallel-Execution" class="headerlink" title="1.10 Parallel Execution"></a>1.10 Parallel Execution</h2><h3 id="1-10-1-Mode"><a href="#1-10-1-Mode" class="headerlink" title="1.10.1 Mode"></a>1.10.1 Mode</h3><p>Offers two mode: </p><ul><li>SAME_THREAD<ul><li>Force execution in the same thread used by the parent. For example, when used on a test method, the test method will be executed in the same thread as any @BeforeAll or @AfterAll methods of the containing test class. </li></ul></li><li>CONCURRENT<ul><li>Execute concurrently unless a resource lock forces execution in the same thread.</li></ul></li></ul><p>Alternatively, you can use the @Execution annotation to change the execution mode for the annotated element and its subelements (if any) which allows you to activate parallel execution for individual test classes, one by one.</p><h3 id="1-10-2-Synchronization"><a href="#1-10-2-Synchronization" class="headerlink" title="1.10.2 Synchronization"></a>1.10.2 Synchronization</h3><p>The @ResourceLock annotation allows you to declare that a test class or method uses a specific shared resource that requires synchronized access to ensure reliable test execution. </p><pre><code>@Execution(CONCURRENT)class SharedResourcesDemo {    private Properties backup;    @BeforeEach    void backup() {        backup = new Properties();        backup.putAll(System.getProperties());    }    @AfterEach    void restore() {        System.setProperties(backup);    }    @Test    @ResourceLock(value = SYSTEM_PROPERTIES, mode = READ)    void customPropertyIsNotSetByDefault() {        assertNull(System.getProperty(&quot;my.prop&quot;));    }    @Test    @ResourceLock(value = SYSTEM_PROPERTIES, mode = READ_WRITE)    void canSetCustomPropertyToApple() {        System.setProperty(&quot;my.prop&quot;, &quot;apple&quot;);        assertEquals(&quot;apple&quot;, System.getProperty(&quot;my.prop&quot;));    }    @Test    @ResourceLock(value = SYSTEM_PROPERTIES, mode = READ_WRITE)    void canSetCustomPropertyToBanana() {        System.setProperty(&quot;my.prop&quot;, &quot;banana&quot;);        assertEquals(&quot;banana&quot;, System.getProperty(&quot;my.prop&quot;));    }}</code></pre><h1 id="2-Extension-Model"><a href="#2-Extension-Model" class="headerlink" title="2. Extension Model"></a>2. Extension Model</h1><p>In contrast to Runner, TestRule and MethodRule extension points in JUnit4, the JUnit Jupiter extension model consists of a single, coherent concept â€“ Extension API. </p><h2 id="2-1-Registering-Extensions"><a href="#2-1-Registering-Extensions" class="headerlink" title="2.1 Registering Extensions"></a>2.1 Registering Extensions</h2><p>Extensions can be registered declaraticely via @ExtendWith, programmatically via @RegisterExtension, or automatically via Javaâ€™s ServiceLoader mechanism. </p><h3 id="2-1-1-Declarative-Extension-Registration"><a href="#2-1-1-Declarative-Extension-Registration" class="headerlink" title="2.1.1 Declarative Extension Registration"></a>2.1.1 Declarative Extension Registration</h3><pre><code>@ExtendWith(RandomParametersExtension.class)@Testvoid test(@Random int i) {    // ...}</code></pre><p>Notice: we could annotate it in class level to register an extension for all tests in this specific class. </p><p>We can also register multiple extensions: </p><pre><code>@ExtendWith({ DatabaseExtension.class, WebServerExtension.class })class MyFirstTests {    // ...}</code></pre><h3 id="2-1-2-Programmatic-Extension-Registration"><a href="#2-1-2-Programmatic-Extension-Registration" class="headerlink" title="2.1.2 Programmatic Extension Registration"></a>2.1.2 Programmatic Extension Registration</h3><p>Register extensions programmatically by annotating fields in test classes with @RegisterExtension </p><p>When an extension is registered declaratively via @ExtendWith, it can typically only be configured via annotations. In contrast, when an extension is registered via @RegisterExtension, it can be <strong>configured programmatically</strong> - for example, in order to pass arguments to the extensionâ€™s constructor, a static factory method, or a builder API.</p><p>If a @RegisterExtension field is static, the extension will be registered after extensions that are registered at the class level via @ExtendWith. Such static extensions are not limited in which extension APIs they can implement. Extensions registered via static fields may therefore implement class-level and instance-level extension APIs such as BeforeAllCallback, AfterAllCallback, and TestInstancePostProcessor as well as method-level extension APIs such as BeforeEachCallback, etc.</p><pre><code>class WebServerDemo {    @RegisterExtension    static WebServerExtension server = WebServerExtension.builder()        .enableSecurity(false)        .build();    @Test    void getProductList() {        WebClient webClient = new WebClient();        String serverUrl = server.getServerUrl();        // Use WebClient to connect to web server using serverUrl and verify response        assertEquals(200, webClient.get(serverUrl + &quot;/products&quot;).getResponseStatus());    }}</code></pre><ul><li><p>For a non-static field with @RegisterExtension, it will be registered after the test class has been instantiated </p></li><li><p>By default, an instance extension will be registered after extensions that are registered at the method level via @ExtendWith </p></li><li><p>If the class is configured with @TestInstance(Lifecycle.PER_CLASS) semantics, an instance extension will be registered at the method level via @ExtendWith.</p><p>  class DocumentationDemo {</p><pre><code>  static Path lookUpDocsDir() {      // return path to docs dir  }  // The configured DocumentationExtension will be automatically registered as an extension at the method level.  @RegisterExtension  DocumentationExtension docs = DocumentationExtension.forPath(lookUpDocsDir());  @Test  void generateDocumentation() {      // use this.docs ...  }</code></pre><p>  }</p></li></ul><h3 id="2-1-3-Automatic-Extension-Registration"><a href="#2-1-3-Automatic-Extension-Registration" class="headerlink" title="2.1.3 Automatic Extension Registration"></a>2.1.3 Automatic Extension Registration</h3><p>JUnit Jupiter also supports global extension registration via Javaâ€™s java.util.ServiceLoader mechanism, allowing third-party extensions to be *<em>auto-detected and automatically registered *</em>based on what is available in the classpath.</p><h2 id="2-2-Conditional-Test-Execution"><a href="#2-2-Conditional-Test-Execution" class="headerlink" title="2.2 Conditional Test Execution"></a>2.2 Conditional Test Execution</h2><p>Used to define conditional test execution. </p><p>An ExecutionCondition is evaluated for each container (e.g., a test class) to determine if all the tests it contains should be executed based on the supplied ExtensionContext</p><h2 id="2-3-Execution-Order-of-User-Code-and-Extensions"><a href="#2-3-Execution-Order-of-User-Code-and-Extensions" class="headerlink" title="2.3 Execution Order of User Code and Extensions"></a>2.3 Execution Order of User Code and Extensions</h2><p>When executing a test class that contains one or more test methods, a number of extension callbacks are called in addition to the user-supplied test and lifecycle methods.</p><p><img src="https://i.loli.net/2020/02/09/9OkZPCtrFL8RfYM.png" alt="fig1.png"></p><p>JUnit Jupiter always guarantees wrapping behavior for multiple registered extensions that implement lifecycle callbacks such as BeforeAllCallback, AfterAllCallback, BeforeEachCallback, AfterEachCallback, BeforeTestExecutionCallback, and AfterTestExecutionCallback.</p><p>That means that, given two extensions Extension1 and Extension2 with Extension1 registered before Extension2, <strong>any â€œbeforeâ€ callbacks implemented by Extension1 are guaranteed to execute before any â€œbeforeâ€ callbacks implemented by Extension2</strong>.</p><pre><code>import static example.callbacks.Logger.afterAllMethod;import static example.callbacks.Logger.afterEachMethod;import static example.callbacks.Logger.beforeAllMethod;import static example.callbacks.Logger.beforeEachMethod;import org.junit.jupiter.api.AfterAll;import org.junit.jupiter.api.AfterEach;import org.junit.jupiter.api.BeforeAll;import org.junit.jupiter.api.BeforeEach;/** * Abstract base class for tests that use the database. */abstract class AbstractDatabaseTests {    @BeforeAll    static void createDatabase() {        beforeAllMethod(AbstractDatabaseTests.class.getSimpleName() + &quot;.createDatabase()&quot;);    }    @BeforeEach    void connectToDatabase() {        beforeEachMethod(AbstractDatabaseTests.class.getSimpleName() + &quot;.connectToDatabase()&quot;);    }    @AfterEach    void disconnectFromDatabase() {        afterEachMethod(AbstractDatabaseTests.class.getSimpleName() + &quot;.disconnectFromDatabase()&quot;);    }    @AfterAll    static void destroyDatabase() {        afterAllMethod(AbstractDatabaseTests.class.getSimpleName() + &quot;.destroyDatabase()&quot;);    }}</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://junit.org/junit5/docs/current/user-guide/" target="_blank" rel="noopener">https://junit.org/junit5/docs/current/user-guide/</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Unit Test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ—¥å¿—ç®¡ç† - slf4j + log4j - æ¢ç©¶Distribute system çš„threadContextå¤ç”¨çš„é—®é¢˜</title>
      <link href="/Java%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86-slf4j-log4j-%E6%8E%A2%E7%A9%B6Distribute-system-%E7%9A%84threadContext%E5%A4%8D%E7%94%A8%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/Java%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86-slf4j-log4j-%E6%8E%A2%E7%A9%B6Distribute-system-%E7%9A%84threadContext%E5%A4%8D%E7%94%A8%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¸¸ç”¨æ—¥å¿—ç³»ç»Ÿä»‹ç»"><a href="#1-å¸¸ç”¨æ—¥å¿—ç³»ç»Ÿä»‹ç»" class="headerlink" title="1. å¸¸ç”¨æ—¥å¿—ç³»ç»Ÿä»‹ç»"></a>1. å¸¸ç”¨æ—¥å¿—ç³»ç»Ÿä»‹ç»</h1><ul><li>æ—¥å¿—é—¨é¢<ul><li>jcl - jakarta common logging  <ul><li>æ—¥å¿—æ¥å£ï¼Œæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ—¥å¿—ç»„ä»¶çš„å®ç° </li></ul></li><li>slf4j<ul><li>æ—¥å¿—æ¥å£</li><li>åœ¨logå±‚å’Œä»£ç å±‚ä¹‹é—´èµ·åˆ°é—¨é¢ä½œç”¨ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´åªè¦ä½¿ç”¨SLF4Jçš„æ¥å£ï¼Œå°±å¯ä»¥éšè—æ—¥å¿—çš„å…·ä½“å®ç°ï¼Œå…¶æä¾›çš„æ ¸å¿ƒAPIæ˜¯ä¸€äº›æ¥å£å’Œä¸€ä¸ªLoggerFactoryçš„å·¥å‚ç±»ï¼Œç”¨æˆ·åªéœ€è¦æŒ‰ç…§å…¶æä¾›çš„æ—¥å¿—æ¥å£è¿›è¡Œä½¿ç”¨ï¼Œæœ€ç»ˆæ—¥å¿—çš„æ ¼å¼ï¼Œè®°å½•çº§åˆ«ï¼Œè¾“å‡ºæ–¹å¼ç­‰éƒ½å¯ä»¥é€šè¿‡å…·ä½“æ—¥å¿—ç³»ç»Ÿçš„é…ç½®æ¥å®ç°</li></ul></li></ul></li><li>æ—¥å¿—æ¡†æ¶<ul><li>jul - java.util.logging </li><li>log4j</li><li>log4j2</li><li>logback<ul><li>slf4jçš„å®ç° </li><li>æ˜¯log4jçš„å‡çº§ç‰ˆ</li></ul></li></ul></li></ul><h1 id="2-æ—¥å¿—çº§åˆ«"><a href="#2-æ—¥å¿—çº§åˆ«" class="headerlink" title="2. æ—¥å¿—çº§åˆ«"></a>2. æ—¥å¿—çº§åˆ«</h1><ul><li>severe</li><li>warning </li><li>info</li><li>config</li><li>fine </li><li>finer </li></ul><h1 id="3-å¸¸è§ä½¿ç”¨æ–¹å¼"><a href="#3-å¸¸è§ä½¿ç”¨æ–¹å¼" class="headerlink" title="3. å¸¸è§ä½¿ç”¨æ–¹å¼"></a>3. å¸¸è§ä½¿ç”¨æ–¹å¼</h1><p>ä¸€èˆ¬å·¥ç¨‹ä¸Šä¼šé€‰æ‹©ä¸€ä¸ªæ—¥å¿—é—¨é¢ï¼ŒåŠ æ—¥å¿—æ¡†æ¶ï¼Œå¸¸ç”¨çš„é—¨é¢åŸºæœ¬ä¸Šè¿˜æ˜¯SLF4Jæ¯”è¾ƒå¤šï¼Œæ¡†æ¶çš„é€‰æ‹©å¾ˆå¤šï¼Œä¸»è¦æ˜¯éœ€è¦æ³¨æ„å·¥ç¨‹ä¸Šåˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤šçº¿ç¨‹æ–¹é¢çš„æ”¯æŒã€‚</p><h1 id="4-Log4j2-ThreadContextå¤ç”¨çš„é—®é¢˜"><a href="#4-Log4j2-ThreadContextå¤ç”¨çš„é—®é¢˜" class="headerlink" title="4. Log4j2 ThreadContextå¤ç”¨çš„é—®é¢˜"></a>4. Log4j2 ThreadContextå¤ç”¨çš„é—®é¢˜</h1><p>ThreadContextå‡ºç°çš„èƒŒæ™¯ä¸»è¦æ˜¯å› ä¸ºç°ä»£ç³»ç»ŸåŸºæœ¬ä¸Šéƒ½éœ€è¦éƒ½æ˜¯å’Œå¤šä¸ªclientæ‰“äº¤é“ï¼Œåœ¨ä¸€ä¸ªå…¸å‹çš„å¤šçº¿ç¨‹çš„åº”ç”¨ç³»ç»Ÿå½“ä¸­ï¼Œä¸åŒçš„çº¿ç¨‹å°±éœ€è¦å’Œä¸åŒçš„clientæ‰“äº¤é“.ä¸ºäº†èƒ½å¤Ÿåˆ†è¾¨å‡ºåŒä¸€ä¸ªclientå‘å‡ºçš„ä¸åŒlogè¯·æ±‚ï¼Œæˆ‘ä»¬å°±éœ€è¦ç»™æ¯ä¸ªè¯·æ±‚ä¸€ä¸ªidï¼Œæ¥åšæ ‡è®°ã€‚</p><p>Log4j2ä½¿ç”¨Thread Context Mapå’ŒThread Context Stackæ¥è¿›è¡Œæ ‡è®°ã€‚å¸¸ç”¨Mapï¼Œå› ä¸ºé”®å€¼å¯¹æ›´å®¹æ˜“è¿›è¡Œæ·»åŠ å’Œå¤„ç†</p><p>ä½¿ç”¨Stack: </p><pre><code>ThreadContext.push(UUID.randomUUID().toString()); // Add the fishtag;logger.debug(&quot;Message 1&quot;);...logger.debug(&quot;Message 2&quot;);..ThreadContext.pop();</code></pre><p>ä½¿ç”¨Map: </p><pre><code>ThreadContext.put(&quot;id&quot;, UUID.randomUUID().toString()); // Add the fishtag;ThreadContext.put(&quot;ipAddress&quot;, request.getRemoteAddr());ThreadContext.put(&quot;loginId&quot;, session.getAttribute(&quot;loginId&quot;));ThreadContext.put(&quot;hostName&quot;, request.getServerName());.logger.debug(&quot;Message 1&quot;);..logger.debug(&quot;Message 2&quot;);..ThreadContext.clear();</code></pre><p>é—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨Executor.execute(new CachedThreadPool())çš„è¯ï¼Œå› ä¸ºçº¿ç¨‹çš„å¤ç”¨ï¼Œï¼ˆæ‰€æœ‰ä½¿ç”¨å®Œçš„çº¿ç¨‹ä¼šå½’è¿˜åˆ°çº¿ç¨‹æ± å½“ä¸­ï¼‰ï¼Œé‚£ä¹ˆThreadContexté‡Œé¢çš„ä¸œè¥¿å¿…é¡»è¦è¿›è¡Œæ‰‹åŠ¨æ¸…é™¤ï¼Œæ‰èƒ½é˜²æ­¢åŸå…ˆè®°å½•çš„è¿™ä¸ªçº¿ç¨‹çš„ä¸œè¥¿è¢«å¤ç”¨æ‰ã€‚æ¯”å¦‚ä¸€èˆ¬ä¼šè®°å½•çš„[Client][API]æ­¤ç±»ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨getContext()å’ŒcloneStack()æ¥ä½¿å¾—å­çº¿ç¨‹è·å¾—çˆ¶çº¿ç¨‹çš„ä¿¡æ¯ã€‚</p><pre><code>ThreadContext.clearAll();ThreadContext.putAll(preSavedThreadContextMap);ThreadContext.setStack(preSavedThreadContextStack);</code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Log </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaåŸºç¡€çŸ¥è¯†</title>
      <link href="/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p>ç»™è‡ªå·±æ­ä¸ªè„šæ‰‹æ¶ï¼Œå»ºä¸ªåŸºç¡€çŸ¥è¯†çš„å°å­—å…¸ï¼ŒæŸ¥é—ç”¨(æŒç»­æ›´æ–°)ï¼š</p><h1 id="1-Javaå¹³å°"><a href="#1-Javaå¹³å°" class="headerlink" title="1.Javaå¹³å°"></a>1.Javaå¹³å°</h1><h2 id="1-1-Javaè§£é‡Šæ‰§è¡Œï¼Ÿ"><a href="#1-1-Javaè§£é‡Šæ‰§è¡Œï¼Ÿ" class="headerlink" title="1.1 Javaè§£é‡Šæ‰§è¡Œï¼Ÿ"></a>1.1 Javaè§£é‡Šæ‰§è¡Œï¼Ÿ</h2><p>Javaæºä»£ç ï¼Œé€šè¿‡javacç¼–è¯‘æˆå­—èŠ‚ç ï¼Œè¿è¡Œæ—¶é€šè¿‡JVMå†…åµŒçš„è§£é‡Šå™¨å°†å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†JVMéƒ½æä¾›äº†JIT(just in time),å³åŠ¨æ€ç¼–è¯‘å™¨ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶å°†çƒ­ç‚¹ä»£ç ç¼–æˆæœºå™¨ç ï¼Œè¿™ç§æƒ…å†µä¸‹çƒ­ç‚¹ä»£ç å°±å±äºç¼–è¯‘æ‰§è¡Œã€‚</p><h2 id="1-2-Javaç±»åŠ è½½æœºåˆ¶"><a href="#1-2-Javaç±»åŠ è½½æœºåˆ¶" class="headerlink" title="1.2 Javaç±»åŠ è½½æœºåˆ¶"></a>1.2 Javaç±»åŠ è½½æœºåˆ¶</h2><p>ç±»åŠ è½½å¤§è‡´è¿‡ç¨‹ï¼šåŠ è½½-éªŒè¯-é“¾æ¥-åˆå§‹åŒ–</p><h2 id="1-3-Javaåå°„æœºåˆ¶"><a href="#1-3-Javaåå°„æœºåˆ¶" class="headerlink" title="1.3 Javaåå°„æœºåˆ¶"></a>1.3 Javaåå°„æœºåˆ¶</h2><h2 id="1-4-é¢å‘å¯¹è±¡ç¼–ç¨‹SOLIDåŸåˆ™"><a href="#1-4-é¢å‘å¯¹è±¡ç¼–ç¨‹SOLIDåŸåˆ™" class="headerlink" title="1.4 é¢å‘å¯¹è±¡ç¼–ç¨‹SOLIDåŸåˆ™"></a>1.4 é¢å‘å¯¹è±¡ç¼–ç¨‹SOLIDåŸåˆ™</h2><ol><li>Single Responsibility </li><li>Open for extension, close for modification </li><li>Liskov Substitution </li><li>Interface Segragation </li><li>Dependency Injection </li></ol><p>E.G</p><pre><code>public class VIPCenter {  void serviceVIP(T extend User user&gt;) {     if (user instanceof SlumDogVIP) {        // ç©· X VIPï¼Œæ´»åŠ¨æŠ¢çš„é‚£ç§        // do somthing      } else if(user instanceof RealVIP) {        // do somthing      }      // ...  }</code></pre><p>å¢åŠ å…¶æ‰©å±•æ€§ï¼š</p><pre><code>public class VIPCenter {   private Map&lt;User.TYPE, ServiceProvider&gt; providers;   void serviceVIP(T extend User userï¼‰ {      providers.get(user.getType()).service(user);   } } interface ServiceProvider{   void service(T extend User user) ; } class SlumDogVIPServiceProvider implements ServiceProvider{   void service(T extend User user){     // do somthing   } } class RealVIPServiceProvider implements ServiceProvider{   void service(T extend User user) {     // do something   } } </code></pre><p>åœ¨å¦ä¸€ç¯‡åšæ–‡é‡Œï¼Œæœ‰å¯¹SOLIDçš„è¯¦ç»†æè¿°ï¼Œè¯¦æƒ…è§<a href="https://www.llchen60.com/2018/11/12/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/">é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</a></p><h2 id="1-5-ç±»åŠ è½½è¿‡ç¨‹"><a href="#1-5-ç±»åŠ è½½è¿‡ç¨‹" class="headerlink" title="1.5 ç±»åŠ è½½è¿‡ç¨‹"></a>1.5 ç±»åŠ è½½è¿‡ç¨‹</h2><p>load-link-initialize</p><ul><li>load </li></ul><p>é¦–å…ˆæ˜¯åŠ è½½é˜¶æ®µï¼ˆLoadingï¼‰ï¼Œå®ƒæ˜¯ Java å°†å­—èŠ‚ç æ•°æ®ä»ä¸åŒçš„æ•°æ®æºè¯»å–åˆ° JVM ä¸­ï¼Œå¹¶æ˜ å°„ä¸º JVM è®¤å¯çš„æ•°æ®ç»“æ„ï¼ˆClass å¯¹è±¡ï¼‰ï¼Œè¿™é‡Œçš„æ•°æ®æºå¯èƒ½æ˜¯å„ç§å„æ ·çš„å½¢æ€ï¼Œå¦‚ jar æ–‡ä»¶ã€class æ–‡ä»¶ï¼Œç”šè‡³æ˜¯ç½‘ç»œæ•°æ®æºç­‰ï¼›å¦‚æœè¾“å…¥æ•°æ®ä¸æ˜¯ ClassFile çš„ç»“æ„ï¼Œåˆ™ä¼šæŠ›å‡º ClassFormatErrorã€‚</p><ul><li>link </li></ul><p>ç¬¬äºŒé˜¶æ®µæ˜¯é“¾æ¥ï¼ˆLinkingï¼‰ï¼Œè¿™æ˜¯æ ¸å¿ƒçš„æ­¥éª¤ï¼Œç®€å•è¯´æ˜¯æŠŠåŸå§‹çš„ç±»å®šä¹‰ä¿¡æ¯å¹³æ»‘åœ°è½¬åŒ–å…¥ JVM è¿è¡Œçš„è¿‡ç¨‹ä¸­ã€‚è¿™é‡Œå¯è¿›ä¸€æ­¥ç»†åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>éªŒè¯ï¼Œ JVMéœ€è¦éªŒè¯å­—èŠ‚ä¿¡æ¯æ˜¯ç¬¦åˆJavaè™šæ‹Ÿæœºè§„èŒƒçš„ï¼Œå¦åˆ™ä¼šè¢«è®¤ä¸ºæ˜¯Verify Error</li><li>å‡†å¤‡ åˆ›å»ºç±»æˆ–æ¥å£ä¸­çš„é™æ€å˜é‡ï¼Œå¹¶åˆå§‹åŒ–é™æ€å˜é‡çš„åˆå§‹å€¼ï¼Œä¾§é‡ç‚¹åœ¨åˆ†é…æ‰€éœ€è¦çš„å†…å­˜ç©ºé—´ï¼Œä¸ä¼šå»æ‰§è¡Œæ›´è¿›ä¸€æ­¥çš„JVMæŒ‡ä»¤</li><li>è§£æã€‚å°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</li></ol><p>å†æ¥è°ˆè°ˆåŒäº²å§”æ´¾æ¨¡å‹ï¼Œç®€å•è¯´å°±æ˜¯å½“ç±»åŠ è½½å™¨ï¼ˆClass-Loaderï¼‰è¯•å›¾åŠ è½½æŸä¸ªç±»å‹çš„æ—¶å€™ï¼Œé™¤éçˆ¶åŠ è½½å™¨æ‰¾ä¸åˆ°ç›¸åº”ç±»å‹ï¼Œå¦åˆ™å°½é‡å°†è¿™ä¸ªä»»åŠ¡ä»£ç†ç»™å½“å‰åŠ è½½å™¨çš„çˆ¶åŠ è½½å™¨å»åšã€‚ä½¿ç”¨å§”æ´¾æ¨¡å‹çš„ç›®çš„æ˜¯é¿å…é‡å¤åŠ è½½ Java ç±»å‹ã€‚</p><h1 id="2-Javaè¯­è¨€ç‰¹æ€§"><a href="#2-Javaè¯­è¨€ç‰¹æ€§" class="headerlink" title="2. Javaè¯­è¨€ç‰¹æ€§"></a>2. Javaè¯­è¨€ç‰¹æ€§</h1><h2 id="2-1-æ³›å‹"><a href="#2-1-æ³›å‹" class="headerlink" title="2.1 æ³›å‹"></a>2.1 æ³›å‹</h2><h2 id="2-2-Lambda"><a href="#2-2-Lambda" class="headerlink" title="2.2 Lambda"></a>2.2 Lambda</h2><h2 id="2-3-Exception-Error"><a href="#2-3-Exception-Error" class="headerlink" title="2.3 Exception/ Error"></a>2.3 Exception/ Error</h2><h3 id="2-3-1-å®šä¹‰"><a href="#2-3-1-å®šä¹‰" class="headerlink" title="2.3.1 å®šä¹‰"></a>2.3.1 å®šä¹‰</h3><blockquote><p>Exception: ç¨‹åºæ­£å¸¸è¿è¡Œä¸­å¯ä»¥é¢„æ–™åˆ°çš„æ„å¤–æƒ…å†µï¼Œå¯èƒ½å¹¶ä¸”åº”è¯¥è¢«æ•è·ï¼Œè¿›è¡Œç›¸åº”å¤„ç†</p></blockquote><blockquote><p>Error: åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸åº”è¯¥å‡ºç°çš„æƒ…å†µã€‚ç»å¤§éƒ¨åˆ†çš„Erroréƒ½ä¼šå¯¼è‡´ç¨‹åºæ¯”å¦‚JVMè‡ªèº«å¤„äºéæ­£å¸¸çš„ã€ä¸å¯æ¢å¤çš„çŠ¶æ€</p></blockquote><p>Throwableåˆ†ç±»å›¾ï¼ï¼ï¼ï¼ï¼</p><p>å¼‚å¸¸ä¹‹æ‰€ä»¥å¾ˆå¼ºå¤§ï¼Œåœ¨è°ƒè¯•æ–¹é¢ï¼Œåœ¨äºå…¶å›ç­”äº†ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>ä»€ä¹ˆå‡ºäº†é”™ï¼Ÿ    å¼‚å¸¸ç±»å‹</li><li>åœ¨å“ªå‡ºäº†é”™ï¼Ÿ    å¼‚å¸¸å †æ ˆè·Ÿè¸ªä½ç½®</li><li>ä¸ºä»€ä¹ˆå‡ºé”™ï¼Ÿ    å¼‚å¸¸ä¿¡æ¯</li></ol><h3 id="2-3-2-Tips"><a href="#2-3-2-Tips" class="headerlink" title="2.3.2 Tips"></a>2.3.2 Tips</h3><ol><li>ä¸æ•è·é€šç”¨å¼‚å¸¸ï¼Œå†™è‡ªå·±çš„Exceptionï¼Œæ–¹ä¾¿Debug</li><li>ä¸è¦ç”Ÿåå¼‚å¸¸ï¼Œä¸çŸ¥é“æ€ä¹ˆå¤„ç†äº†å¯ä»¥ç»§ç»­å‘å¤–å±‚æŠ›å‡º</li><li>ææ—©æŠ›å‡ºï¼Œå»¶è¿Ÿæ•è·ï¼ </li><li>æŠŠå¼‚å¸¸å¤„ç†çš„è´£ä»»å¾€è°ƒç”¨é“¾çš„ä¸Šæ¸¸ä¼ é€’çš„æ–¹æ³•å°±æ˜¯åœ¨æ–¹æ³•çš„throwså­å¥å£°æ˜å¼‚å¸¸ã€‚<a href="https://www.zhihu.com/question/28254987" target="_blank" rel="noopener">(å¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸ï¼Ÿ)</a></li></ol><h3 id="2-3-3-æ€§èƒ½è§’åº¦åˆ†æ"><a href="#2-3-3-æ€§èƒ½è§’åº¦åˆ†æ" class="headerlink" title="2.3.3 æ€§èƒ½è§’åº¦åˆ†æ"></a>2.3.3 æ€§èƒ½è§’åº¦åˆ†æ</h3><ol><li>try-catchä»£ç æ®µä¼šäº§ç”Ÿé¢å¤–çš„æ€§èƒ½å¼€é”€ï¼Œå¾€å¾€ä¼šå½±å“JVMå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤åº”è¯¥ä»…æ•è·æœ‰å¿…è¦çš„ä»£ç ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ä¸€ä¸ªå¤§çš„tryåŒ…ä½æ•´æ®µä»£ç </li><li>Javaæ¯å®ä¾‹åŒ–ä¸€ä¸ªExceptionï¼Œéƒ½ä¼šå¯¹<strong>å½“æ—¶çš„æ ˆè¿›è¡Œå¿«ç…§</strong>ï¼Œè¿™æ˜¯ä¸ªæ¯”è¾ƒé‡çš„æ“ä½œã€‚</li></ol><h2 id="2-4-å¼•ç”¨"><a href="#2-4-å¼•ç”¨" class="headerlink" title="2.4 å¼•ç”¨"></a>2.4 å¼•ç”¨</h2><p>Javaä¸­é™¤äº†åŸå§‹æ•°æ®ç±»å‹çš„å˜é‡å…¶ä»–æ‰€æœ‰éƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼ŒæŒ‡å‘ä¸åŒçš„å¯¹è±¡ã€‚ç†è§£å¼•ç”¨ï¼Œä»¥ç†è§£Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’ŒJVMå†…éƒ¨çš„ç›¸å…³æœºåˆ¶ã€‚</p><p>ä¸åŒçš„å¼•ç”¨ç±»å‹ï¼Œä¸»è¦ä½“ç°åœ¨å¯¹è±¡çš„ä¸åŒçš„å¯è¾¾æ€§çŠ¶æ€å’Œå¯¹åƒåœ¾æ”¶é›†çš„å½±å“ã€‚</p><h3 id="2-4-1-å¼ºå¼•ç”¨"><a href="#2-4-1-å¼ºå¼•ç”¨" class="headerlink" title="2.4.1 å¼ºå¼•ç”¨"></a>2.4.1 å¼ºå¼•ç”¨</h3><p>Strong Reference, å³æ™®é€šå¯¹è±¡å¼•ç”¨ã€‚åªè¦è¿˜æœ‰å¼ºå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±ä¸ä¼šç¢°ã€‚</p><h3 id="2-4-2-å¼±å¼•ç”¨"><a href="#2-4-2-å¼±å¼•ç”¨" class="headerlink" title="2.4.2 å¼±å¼•ç”¨"></a>2.4.2 å¼±å¼•ç”¨</h3><p>ä¸èƒ½ä½¿å¯¹è±¡è±å…åƒåœ¾æ”¶é›†ï¼Œæä¾›ä¸€ç§è®¿é—®åœ¨å¼±å¼•ç”¨è£…å¤©ä¸‹å¯¹è±¡çš„é€”å¾„</p><p>ä½¿ç”¨weak referenceç±»æ¥å®ç°çš„</p><h3 id="2-4-3-è½¯å¼•ç”¨"><a href="#2-4-3-è½¯å¼•ç”¨" class="headerlink" title="2.4.3 è½¯å¼•ç”¨"></a>2.4.3 è½¯å¼•ç”¨</h3><p>Soft Reference. ç›¸å¯¹å¼ºå¼•ç”¨å¼±åŒ–ä¸€äº›çš„å¼•ç”¨ï¼Œå¯ä»¥è®©å¯¹è±¡è±å…ä¸€äº›åƒåœ¾æ”¶é›†ï¼Œåªæœ‰å½“JVMè®¤ä¸ºå†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šå»è¯•å›¾å›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ã€‚</p><p>ä½¿ç”¨soft referenceç±»å®ç°çš„</p><h3 id="2-4-4-å¹»è±¡å¼•ç”¨"><a href="#2-4-4-å¹»è±¡å¼•ç”¨" class="headerlink" title="2.4.4 å¹»è±¡å¼•ç”¨"></a>2.4.4 å¹»è±¡å¼•ç”¨</h3><p>è™šå¼•ç”¨ï¼Œæä¾›ä¸€ç§ç¡®ä¿å¯¹è±¡è¢«finalizeä»¥åï¼ŒåšæŸäº›äº‹æƒ…çš„æœºåˆ¶ã€‚</p><p>é€šè¿‡PhantomReferenceç±»æ¥å®ç°çš„</p><h2 id="2-5-String-vs-StringBuffer-vs-StringBuilder"><a href="#2-5-String-vs-StringBuffer-vs-StringBuilder" class="headerlink" title="2.5 String vs. StringBuffer vs. StringBuilder"></a>2.5 String vs. StringBuffer vs. StringBuilder</h2><ul><li><p>å­—ç¬¦ä¸²ç¼“å­˜ï¼Œæ”¾åœ¨å¯¹é‡ï¼Œåæ¥æ”¾åœ¨metaSpaceå½“ä¸­ï¼Œå¯ä»¥é€šè¿‡JVMè°ƒå‚æ¥ä¿®æ”¹å¤§å°</p><p>  -XX:+PrintStringTableStatistics<br>  -XX:StringTableSize=N</p></li><li><p>String å‹ç¼©</p></li></ul><p>ä»ä½¿ç”¨Charåˆ°ä½¿ç”¨Byte + æ ‡å¿—ç¼–ç ä½ã€‚ç´§å‡‘å­—ç¬¦ä¸²å¸¦æ¥äº†å¾ˆå¤§ä¼˜åŠ¿ï¼Œæ›´å°çš„å†…å­˜å ç”¨ï¼Œæ›´å¿«çš„æ“ä½œé€Ÿåº¦ã€‚</p><h3 id="2-5-1-String"><a href="#2-5-1-String" class="headerlink" title="2.5.1 String"></a>2.5.1 String</h3><p>Immutableç±»ï¼Œå£°æ˜ä¸ºfinal class,æ‰€æœ‰å±æ€§ä¹Ÿéƒ½æ˜¯finalçš„ã€‚</p><p>javaå¼•å…¥äº†å­—ç¬¦åˆ›å¸¸é‡æ± ï¼Œåˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¦–å…ˆçœ‹å¸¸é‡æ± é‡Œé¢æœ‰æ²¡æœ‰å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ç›´æ¥åˆ°æ± é‡Œæ‹¿å¯¹åº”çš„å¯¹è±¡å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºæ–°çš„ï¼Œå¹¶æ”¾åˆ°æ± é‡Œå»ã€‚</p><pre><code>String str1 = &quot;123&quot;;// æ”¾å…¥å¸¸é‡æ± String str2 = new String(&quot;123&quot;); // ä¸æ”¾å…¥å¸¸é‡æ± </code></pre><h3 id="2-5-2-StringBuffer"><a href="#2-5-2-StringBuffer" class="headerlink" title="2.5.2 StringBuffer"></a>2.5.2 StringBuffer</h3><p>ä¸ºäº†è§£å†³Stringæ‹¼æ¥äº§ç”Ÿå¤ªå¤šä¸­é—´å¯¹è±¡çš„é—®é¢˜ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å¯ä¿®æ”¹å­—ç¬¦åºåˆ—ã€‚ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</p><p>çº¿ç¨‹å®‰å…¨æ˜¯é€šè¿‡åœ¨å„ç§ä¿®æ”¹æ•°æ®çš„æ–¹æ³•ä¸ŠåŠ <code>synchronized</code>å…³é”®å­—æ¥å®ç°çš„ã€‚</p><p>åº•å±‚ä½¿ç”¨char/ byteæ•°ç»„ï¼Œç»§æ‰¿äº†AbstractStringBuilder</p><h3 id="2-5-3-StringBuilder"><a href="#2-5-3-StringBuilder" class="headerlink" title="2.5.3 StringBuilder"></a>2.5.3 StringBuilder</h3><p>ä¸StringBufferç±»ä¼¼ï¼Œå»æ‰äº†çº¿ç¨‹å®‰å…¨çš„éƒ¨åˆ†ï¼Œæœ‰æ•ˆå‡å°‘äº†å¼€é”€</p><p>åº•å±‚ä½¿ç”¨char/ byteæ•°ç»„ï¼Œç»§æ‰¿äº†AbstractStringBuilderã€‚</p><h2 id="2-6-Abstract-and-Interface"><a href="#2-6-Abstract-and-Interface" class="headerlink" title="2.6 Abstract and Interface"></a>2.6 Abstract and Interface</h2><h3 id="2-6-1-æ¥å£"><a href="#2-6-1-æ¥å£" class="headerlink" title="2.6.1 æ¥å£"></a>2.6.1 æ¥å£</h3><p>æ¥å£æ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œæ˜¯æŠ½è±¡æ–¹æ³•çš„é›†åˆï¼Œåˆ©ç”¨æ¥å£å¯ä»¥è¾¾åˆ°APIå®šä¹‰å’Œå®ç°åˆ†ç¦»çš„ç›®çš„ã€‚æ¥å£ä¸èƒ½å®ä¾‹åŒ–ï¼Œä¸èƒ½åŒ…å«ä»»ä½•éå¸¸é‡æˆå‘˜ï¼Œä»»ä½•fieldéƒ½æ˜¯éšå«ç€public static finalçš„æ„ä¹‰çš„ã€‚åŒæ—¶ï¼Œæ²¡æœ‰éé™æ€æ–¹æ³•çš„å®ç°ã€‚è¦ä¹ˆæ˜¯é™æ€æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯æŠ½è±¡æ–¹æ³•ã€‚</p><p>æ¥å£å¯ä»¥å¤šç»§æ‰¿ï¼ç±»åªå¯ä»¥å•ç»§æ‰¿</p><h3 id="2-6-2-æŠ½è±¡ç±»"><a href="#2-6-2-æŠ½è±¡ç±»" class="headerlink" title="2.6.2 æŠ½è±¡ç±»"></a>2.6.2 æŠ½è±¡ç±»</h3><p>ä¸èƒ½å®ä¾‹åŒ–çš„ç±»ï¼Œç”¨abstractå…³é”®å­—æ¥ä¿®é¥°ï¼Œå…¶ç›®çš„ä¸»è¦æ˜¯ä»£ç é‡ç”¨ã€‚æŠ½è±¡ç±»å¤§å¤šç”¨äºæŠ½å–ç›¸å…³Javaç±»çš„å…¬ç”¨æ–¹æ³•å®ç°æˆ–è€…æ˜¯å…±åŒæˆå‘˜å˜é‡ï¼Œç„¶åé€šè¿‡ç»§æ‰¿è¾¾åˆ°ä»£ç å¤ç”¨çš„ç›®çš„ã€‚Javaæ ‡å‡†åº“ä¸­ï¼Œæ¯”å¦‚Collectionæ¡†æ¶ï¼Œå¾ˆå¤šé€šç”¨éƒ¨åˆ†å°±æŠ½è±¡æˆäº†æŠ½è±¡ç±»æ¥ä½¿ç”¨ã€‚</p><h1 id="3-JavaåŸºç¡€ç±»åº“"><a href="#3-JavaåŸºç¡€ç±»åº“" class="headerlink" title="3. JavaåŸºç¡€ç±»åº“"></a>3. JavaåŸºç¡€ç±»åº“</h1><h2 id="3-1-é›†åˆ"><a href="#3-1-é›†åˆ" class="headerlink" title="3.1 é›†åˆ"></a>3.1 é›†åˆ</h2><h3 id="3-1-1-Vector-vs-ArrayList-vs-LinkedList"><a href="#3-1-1-Vector-vs-ArrayList-vs-LinkedList" class="headerlink" title="3.1.1 Vector vs. ArrayList vs.LinkedList"></a>3.1.1 Vector vs. ArrayList vs.LinkedList</h3><p>ä¸‰è€…éƒ½æ˜¯é›†åˆæ¡†æ¶ä¸­çš„Listï¼Œæ ¹æ®ä½ç½®æœ‰å®šä½ï¼Œæ·»åŠ æˆ–è€…åˆ é™¤çš„æ“ä½œã€‚Vectoræ˜¯Javaæ—©æœŸæä¾›çš„çº¿ç¨‹å®‰å…¨çš„åŠ¨æ€æ•°ç»„ã€‚ArrayListåŠ¨æ€æ•°ç»„ï¼Œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒArrayListæ‰©å®¹æ—¶ä¼šå¢åŠ 50%ã€‚LinkedListåŒå‘é“¾è¡¨ï¼Œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>Vector, arrayListä½œä¸ºåŠ¨æ€æ•°ç»„ï¼Œéå¸¸é€‚åˆéšæœºè®¿é—®çš„åœºåˆï¼Œæ’å…¥åˆ é™¤å…ƒç´ æ€§èƒ½ä¼šæ¯”è¾ƒå·®ï¼Œå› ä¸ºè¦ç§»åŠ¨åç»­çš„æ‰€æœ‰å…ƒç´ ã€‚LinkedListè¿›è¡ŒèŠ‚ç‚¹æ’å…¥ï¼Œåˆ é™¤ä¼šå¾ˆé«˜æ•ˆï¼Œä½†æ˜¯éšæœºè®¿é—®æ€§èƒ½å¾ˆå·®ã€‚</p><h3 id="3-1-2-Hashtable-vs-HashMap-vs-TreeMap"><a href="#3-1-2-Hashtable-vs-HashMap-vs-TreeMap" class="headerlink" title="3.1.2 Hashtable vs. HashMap vs. TreeMap"></a>3.1.2 Hashtable vs. HashMap vs. TreeMap</h3><p>Hashtableæ˜¯åŒæ­¥çš„ï¼Œæ€§èƒ½å¼€é”€å¤§</p><p>HashMap éåŒæ­¥çš„ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œputï¼Œgetæ“ä½œèƒ½è¾¾åˆ°å¸¸æ•°æ—¶é—´çš„æ€§èƒ½</p><p>TreeMapæ˜¯åŸºäºçº¢é»‘æ ‘çš„ä¸€ç§æä¾›é¡ºåºè®¿é—®çš„Mapï¼Œå’ŒHashmapä¸åŒï¼Œå®ƒçš„get\put\removeä¹‹ç±»çš„æ“ä½œéƒ½æ˜¯O(log(n))çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><h2 id="3-2-IO-NIO"><a href="#3-2-IO-NIO" class="headerlink" title="3.2 IO/NIO"></a>3.2 IO/NIO</h2><h3 id="3-2-1-IO"><a href="#3-2-1-IO" class="headerlink" title="3.2.1 IO"></a>3.2.1 IO</h3><p>java.ioåŒ…ï¼ŒåŸºäºæµæ¨¡å‹å®ç°ï¼Œæä¾›äº†æˆ‘ä»¬æœ€ç†ŸçŸ¥çš„ä¸€äº›IOåŠŸèƒ½ï¼Œæ¯”å¦‚FileæŠ½è±¡ã€è¾“å…¥è¾“å‡ºæµç­‰ã€‚äº¤äº’æ–¹å¼æ˜¯åŒæ­¥ã€é˜»å¡çš„æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¯»å–è¾“å…¥æµæˆ–è€…å†™å…¥è¾“å‡ºæµæ—¶ï¼Œåœ¨è¯»å†™åŠ¨ä½œä¹‹å‰ï¼Œçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡åœ¨é‚£é‡Œï¼Œä»–ä»¬ä¹‹é—´çš„è°ƒç”¨æ˜¯å¯é çš„çº¿æ€§é¡ºåºã€‚</p><h3 id="3-2-2-NIO"><a href="#3-2-2-NIO" class="headerlink" title="3.2.2 NIO"></a>3.2.2 NIO</h3><p>NIOæ¡†æ¶ï¼Œæä¾›Channel, selector, Bufferç­‰æ–°çš„æŠ½è±¡ï¼Œå¯ä»¥æ„å»º<strong>å¤šè·¯å¤ç”¨ï¼ŒåŒæ­¥éé˜»å¡IOç¨‹åº</strong>ï¼ŒåŒæ—¶æä¾›äº†æ›´æ¥è¿‘æ“ä½œç³»ç»Ÿåº•å±‚çš„é«˜æ€§èƒ½æ•°æ®æ“ä½œæ–¹å¼ã€‚</p><ul><li>Channel </li><li>Buffer</li><li>Selector </li></ul><h2 id="3-3-ç½‘ç»œ"><a href="#3-3-ç½‘ç»œ" class="headerlink" title="3.3 ç½‘ç»œ"></a>3.3 ç½‘ç»œ</h2><h2 id="3-4-å¹¶å‘"><a href="#3-4-å¹¶å‘" class="headerlink" title="3.4 å¹¶å‘"></a>3.4 å¹¶å‘</h2><h3 id="3-4-1-synchronized"><a href="#3-4-1-synchronized" class="headerlink" title="3.4.1 synchronized"></a>3.4.1 synchronized</h3><ul><li>æ¦‚å¿µ</li></ul><p>æ˜¯javaå†…éƒ¨çš„åŒæ­¥æœºåˆ¶ï¼Œä¹Ÿç§°ä¸ºintrinsic locking, æä¾›äº†äº’æ–¥çš„è¯­ä¹‰å’Œå¯è§æ€§ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å·²ç»è·å–å½“å‰é”æ—¶ï¼Œå…¶ä»–è¯•å›¾è·å–çš„çº¿ç¨‹åªèƒ½ç­‰å¾…æˆ–è€…é˜»å¡åœ¨é‚£é‡Œäº†ã€‚</p><p>åœ¨ Java 5 ä»¥å‰ï¼Œsynchronized æ˜¯ä»…æœ‰çš„åŒæ­¥æ‰‹æ®µï¼Œåœ¨ä»£ç ä¸­ï¼Œ synchronized å¯ä»¥ç”¨æ¥ä¿®é¥°æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨ç‰¹å®šçš„ä»£ç å—å„¿ä¸Šï¼Œæœ¬è´¨ä¸Š** synchronized æ–¹æ³•ç­‰åŒäºæŠŠæ–¹æ³•å…¨éƒ¨è¯­å¥ç”¨ synchronized å—åŒ…èµ·æ¥**ã€‚</p><ul><li>åº•å±‚å®ç°</li></ul><p>synchronizedä»£ç å—æ˜¯ç”±ä¸€å¯¹<code>monitorenter/ moniterexit</code>æŒ‡ä»¤æ¥å®ç°çš„ï¼ŒMonitorå¯¹è±¡æ˜¯åŒæ­¥çš„åŸºæœ¬å®ç°å•å…ƒã€‚</p><p>åœ¨ Java 6 ä¹‹å‰ï¼ŒMonitor çš„å®ç°å®Œå…¨æ˜¯ä¾é æ“ä½œç³»ç»Ÿå†…éƒ¨çš„äº’æ–¥é”ï¼Œå› ä¸ºéœ€è¦è¿›è¡Œç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œæ‰€ä»¥åŒæ­¥æ“ä½œæ˜¯ä¸€ä¸ªæ— å·®åˆ«çš„é‡é‡çº§æ“ä½œã€‚ç°ä»£çš„ï¼ˆOracleï¼‰JDK ä¸­ï¼ŒJVM å¯¹æ­¤è¿›è¡Œäº†å¤§åˆ€é˜”æ–§åœ°æ”¹è¿›ï¼Œæä¾›äº†ä¸‰ç§ä¸åŒçš„ Monitor å®ç°ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ä¸‰ç§ä¸åŒçš„é”ï¼šåæ–œé”ï¼ˆBiased Lockingï¼‰ã€è½»é‡çº§é”å’Œé‡é‡çº§é”ï¼Œå¤§å¤§æ”¹è¿›äº†å…¶æ€§èƒ½ã€‚</p><p>æ‰€è°“é”çš„å‡çº§ã€é™çº§ï¼Œå°±æ˜¯ JVM ä¼˜åŒ– synchronized è¿è¡Œçš„æœºåˆ¶ï¼Œå½“ JVM æ£€æµ‹åˆ°ä¸åŒçš„ç«äº‰çŠ¶å†µæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°é€‚åˆçš„é”å®ç°ï¼Œè¿™ç§åˆ‡æ¢å°±æ˜¯é”çš„å‡çº§ã€é™çº§ã€‚</p><p>æ²¡æœ‰ç«äº‰çš„æ—¶å€™ï¼Œé»˜è®¤ä½¿ç”¨åæ–œé”ã€‚JVMä¼šåˆ©ç”¨CASæ“ä½œï¼Œåœ¨å¯¹è±¡å¤´ä¸Šçš„Mark Wordéƒ¨åˆ†è®¾ç½®çº¿ç¨‹IDï¼Œä»¥è¡¨ç¤ºè¿™ä¸ªå¯¹è±¡åå‘äºå½“å‰çº¿ç¨‹ï¼Œæ‰€ä»¥å¹¶ä¸æ¶‰åŠçœŸæ­£çš„äº’æ–¥é”ã€‚å¦‚æœæœ‰å¦å¤–çš„çº¿ç¨‹è¯•å›¾é”å®šæŸä¸ªå·²ç»è¢«åæ–œè¿‡çš„å¯¹è±¡ï¼ŒJVMå°±éœ€è¦æ’¤é”€åæ–œé”ï¼Œå¹¶åˆ‡æ¢åˆ°è½»é‡é”çš„å®ç°ã€‚</p><h3 id="3-4-2-ReeantrantLock"><a href="#3-4-2-ReeantrantLock" class="headerlink" title="3.4.2 ReeantrantLock"></a>3.4.2 ReeantrantLock</h3><ul><li>ReentrantLock å†å…¥é”</li></ul><p>å†å…¥é”é€šè¿‡ä»£ç ç›´æ¥è°ƒç”¨lock()æ–¹æ³•æ¥è·å–ï¼Œæ˜¯è¡¨ç¤ºå½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾è·å–ä¸€ä¸ªå®ƒå·²ç»è·å–çš„é”æ—¶ï¼Œè¿™ä¸ªè·å–åŠ¨ä½œå°±è‡ªåŠ¨æˆåŠŸã€‚è¿™æ˜¯å¤šé”è·å–ç²’åº¦ä¸Šçš„ä¸€ä¸ªåŒºåˆ†ï¼Œé”çš„æŒæœ‰æ˜¯ä»¥çº¿ç¨‹ä¸ºå•ä½è€Œä¸æ˜¯åŸºäºè°ƒç”¨æ¬¡æ•°äº†ï¼Œjavaé”å®ç°å¼ºè°ƒå†å…¥æ€§æ˜¯ä¸ºäº†å’Œpthreadçš„è¡Œä¸ºè¿›è¡ŒåŒºåˆ†ã€‚</p><p>å†å…¥é”å¯ä»¥è®¾ç½®å…¬å¹³æ€§ï¼š</p><pre><code>ReentrantLock fairLock = new ReetrantLock(true);</code></pre><p>è¿™é‡Œæ‰€è°“çš„å…¬å¹³æ€§æ˜¯æŒ‡åœ¨ç«äº‰åœºæ™¯ä¸­ï¼Œå½“å…¬å¹³æ€§ä¸ºçœŸæ—¶ï¼Œä¼šå€¾å‘äºå°†é”èµ‹äºˆç­‰å¾…æ—¶é—´æœ€ä¹…çš„çº¿ç¨‹ã€‚å…¬å¹³æ€§æ˜¯å‡å°‘çº¿ç¨‹â€œé¥¥é¥¿â€ï¼ˆä¸ªåˆ«çº¿ç¨‹é•¿æœŸç­‰å¾…é”ï¼Œä½†å§‹ç»ˆæ— æ³•è·å–ï¼‰æƒ…å†µå‘ç”Ÿçš„ä¸€ä¸ªåŠæ³•ã€‚</p><p>ä½¿ç”¨synchronizedæˆ‘ä»¬æ— æ³•è¿›è¡Œå…¬å¹³æ€§çš„é€‰æ‹©ï¼Œå…¶æ°¸è¿œæ˜¯ä¸å…¬å¹³çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸»æµæ“ä½œç³»ç»Ÿçº¿ç¨‹è°ƒåº¦çš„é€‰æ‹©ã€‚é€šç”¨åœºæ™¯ä¸­ï¼Œå…¬å¹³æ€§æœªå¿…æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆé‡è¦ï¼ŒJava é»˜è®¤çš„è°ƒåº¦ç­–ç•¥å¾ˆå°‘ä¼šå¯¼è‡´ â€œé¥¥é¥¿â€å‘ç”Ÿã€‚ä¸æ­¤åŒæ—¶ï¼Œè‹¥è¦ä¿è¯å…¬å¹³æ€§åˆ™ä¼šå¼•å…¥é¢å¤–å¼€é”€ï¼Œè‡ªç„¶ä¼šå¯¼è‡´ä¸€å®šçš„ååé‡ä¸‹é™ã€‚</p><h3 id="3-4-3-æ­»é”"><a href="#3-4-3-æ­»é”" class="headerlink" title="3.4.3 æ­»é”"></a>3.4.3 æ­»é”</h3><h2 id="3-5-å®‰å…¨"><a href="#3-5-å®‰å…¨" class="headerlink" title="3.5 å®‰å…¨"></a>3.5 å®‰å…¨</h2><h1 id="4-JVMåŸºç¡€æ¦‚å¿µå’Œæœºåˆ¶"><a href="#4-JVMåŸºç¡€æ¦‚å¿µå’Œæœºåˆ¶" class="headerlink" title="4. JVMåŸºç¡€æ¦‚å¿µå’Œæœºåˆ¶"></a>4. JVMåŸºç¡€æ¦‚å¿µå’Œæœºåˆ¶</h1><h2 id="4-1-ç±»åŠ è½½æœºåˆ¶"><a href="#4-1-ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="4.1 ç±»åŠ è½½æœºåˆ¶"></a>4.1 ç±»åŠ è½½æœºåˆ¶</h2><h2 id="4-2-å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨"><a href="#4-2-å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="4.2 å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨"></a>4.2 å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨</h2><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.zhihu.com/question/28254987" target="_blank" rel="noopener">å¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸ï¼Ÿ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javadoc tutorial</title>
      <link href="/Javadoc-tutorial/"/>
      <url>/Javadoc-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-javadoc"><a href="#1-What-is-javadoc" class="headerlink" title="1. What is javadoc"></a>1. What is javadoc</h1><p>A tool comes with JDK and used for generating Java code documentation in <strong>HTML format from Java source code</strong>, which requires documentation in a predefined format </p><h1 id="2-Javadoc-tags"><a href="#2-Javadoc-tags" class="headerlink" title="2. Javadoc tags"></a>2. Javadoc tags</h1><ul><li>@author</li><li>{@code}<ul><li>Displays text in code font without interpreting the text as HTML markup or nested javadoc tags.</li></ul></li><li>{@docRoot}<ul><li>Represents the relative path to the generated documentâ€™s root directory from any generated page.</li></ul></li><li>@deprecated</li><li>@exception<ul><li>Adds a Throws subheading to the generated documentation, with the classname and description text.</li></ul></li><li>{@inheritDoc}<ul><li>Inherits a comment from the nearest inheritable class or implementable interface.</li></ul></li><li>{@link}<ul><li>Inserts an in-line link with the visible text label that points to the documentation for the specified package, class, or member name of a referenced class. </li></ul></li><li>@param</li><li>@return</li><li>@see</li><li>@serial</li><li>@serialData <ul><li>Documents the data written by the writeObject( ) or writeExternal( ) methods.</li></ul></li><li>@serialField<ul><li>Documents an ObjectStreamField component.</li></ul></li><li>@since <ul><li>Adds a since heading with the specified since text to the generated documentation</li></ul></li><li>@throws </li><li>{@value}<ul><li>When {@value} is used in the doc comment of a static field, it displays the value of that constant. </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java ç»§æ‰¿ä¸ç»„åˆ</title>
      <link href="/Java-%E7%BB%A7%E6%89%BF%E4%B8%8E%E7%BB%84%E5%90%88/"/>
      <url>/Java-%E7%BB%A7%E6%89%BF%E4%B8%8E%E7%BB%84%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯ç»„åˆï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯ç»„åˆï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ç»„åˆï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯ç»„åˆï¼Ÿ</h1><p>ç»„åˆå°†ç±»å®šä¹‰ä¸ºå„ä¸ªéƒ¨åˆ†çš„é›†åˆ</p><pre><code>public class MerchantListHelper {    // TODO     void addToDDB (ListEntry entry) {    }    void removeFromDDB(DDBRecord record) {    }    List&lt;ListEntry&gt; getFromDDB() {    }}public class MerchantBlacklistBizLogic {    private MerchantListHelper merchantListHelper;    merchantListHelper.addToDDB(blabla..);    merchantListHelper.removeFromDDB(blabla..)}</code></pre><h1 id="2-ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ"></a>2. ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ</h1><p>å°†çˆ¶ç±»å’Œå­ç±»é€šè¿‡é›†æˆå…³ç³»ç´§å¯†è”ç³»åœ¨ä¸€èµ· ï¼ˆç´§è€¦åˆï¼‰ã€‚ä½†ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ç»§æ‰¿ä¼šå…è®¸å†åˆ©ç”¨ç±»çš„æ–¹æ³•ä»¥åŠå…¶ä»–çš„å±æ€§ï¼Œä¼šå¾ˆä¾¿æ·ã€‚</p><p>ä½¿ç”¨super()æ–¹æ³•æ¥ç›´æ¥è®¿é—®çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ„é€ å™¨ï¼Œå±æ€§ç­‰ã€‚</p><pre><code>public Abstract class MerchantListHelper {    // TODO     abstract void addToDDB (ListEntry entry);    abstract void removeFromDDB(DDBRecord record);    abstract List&lt;ListEntry&gt; getFromDDB();}public class MerchantBlacklistBizLogic {    private MerchantListHelper merchantListHelper;    @Override    void addToDDB(ListEntry entry) {        // TODO    }    @Override    void removeFromDDB(DDBRecord record) {        // TODO    }    ...}</code></pre><h1 id="3-Use-cases"><a href="#3-Use-cases" class="headerlink" title="3. Use cases"></a>3. Use cases</h1><p>ç»„åˆå’Œç»§æ‰¿éƒ½å¯ä»¥å°†å­å¯¹è±¡æ”¾åˆ°æ–°çš„ç±»å½“ä¸­ï¼Œç»„åˆä¸€èˆ¬æ˜¯å½“ä½ æƒ³è¦åœ¨è¿™ä¸ªæ–°ç±»å½“ä¸­ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»çš„ç‰¹å¾çš„æ—¶å€™ã€‚è¿™æ„å‘³ç€ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ä½ å¯ä»¥åµŒå…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å…¶æ”¾åœ¨æ–°çš„ç±»å½“ä¸­ã€‚ ç»§æ‰¿è¡¨ç¤ºçš„æ˜¯ä¸€ç§is-açš„å…³ç³»ï¼Œç»„åˆè¡¨è¾¾çš„å«æœ‰æŸç§åŠŸèƒ½ã€‚</p><p>å¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦ç»§æ‰¿æˆ–è€…ç»„åˆ -&gt; çœ‹æ˜¯å¦éœ€è¦ä»ä½ çš„æ–°ç±»åˆ°åŸºæœ¬ç±»è¿›è¡Œå‘ä¸Šè½¬å‹ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="http://thedeanbear.com/2012/09/24/composition_vs_inheritance/" target="_blank" rel="noopener">http://thedeanbear.com/2012/09/24/composition_vs_inheritance/</a></li><li>Java Challengers #7: Debugging Java inheritance </li><li>javaworld.com/article/3409071/java-challenger-7-debugging-java-inheritance.html</li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Composition </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java åå°„æœºåˆ¶</title>
      <link href="/Java-%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"/>
      <url>/Java-%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»‹ç»"><a href="#1-ä»‹ç»" class="headerlink" title="1. ä»‹ç»"></a>1. ä»‹ç»</h1><p>Javaåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡Œæ—¶ç”¨æ¥åˆ¤å®šæˆ–è€…ä¿®æ”¹æ–¹æ³•ï¼Œç±»ï¼Œæ¥å£çš„è¡Œä¸ºçš„APIã€‚</p><ul><li><p>åå°„å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ç±»å’Œå¯¹è±¡ä¹‹é—´çš„ä¿¡æ¯ï¼Œä»¥åŠæˆ‘ä»¬å¯ä»¥ç”¨ç±»çš„å“ªäº›æ–¹æ³•æ¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡</p></li><li><p>é€šè¿‡åå°„ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™èµ‹äºˆç±»ä¸€ä¸ªæ–°çš„å¯¹è±¡</p></li><li><p>æœ‰ç”¨çš„è¿æ¥</p><ul><li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/index.html" target="_blank" rel="noopener">Reflection API</a></li><li><a href="https://docs.oracle.com/javase/tutorial/reflect/index.html" target="_blank" rel="noopener">Reflection Tutorial</a></li><li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html" target="_blank" rel="noopener">Classç±»çš„æ–¹æ³•</a><h1 id="2-ä½¿ç”¨èŒƒä¾‹"><a href="#2-ä½¿ç”¨èŒƒä¾‹" class="headerlink" title="2. ä½¿ç”¨èŒƒä¾‹"></a>2. ä½¿ç”¨èŒƒä¾‹</h1>åå°„å¯ä»¥ç”¨æ¥è·å–å…³äºç±»ï¼Œæ„é€ å™¨å’Œæ–¹æ³•çš„ä¿¡æ¯ï¼š</li></ul></li><li><p>class: getClass()æ–¹æ³•å¯ä»¥ç”¨æ¥è·å–å¯¹è±¡å±äºçš„ç±»çš„åå­—</p></li><li><p>Constructors: getConstructor()å¯ä»¥ç”¨æ¥è·å–å¯¹è±¡å±äºçš„ç±»çš„publicçš„æ„é€ å™¨</p></li><li><p>getMethods() å¯ä»¥ç”¨æ¥è·å–å¯¹è±¡å±äºçš„ç±»çš„publicçš„æ–¹æ³•</p><p>  // A simple Java program to demonstrate the use of reflection<br>  import java.lang.reflect.Method;<br>  import java.lang.reflect.Field;<br>  import java.lang.reflect.Constructor; </p><p>  // class whose object is to be created<br>  class Test<br>  { </p><pre><code>  // creating a private field   private String s;   // creating a public constructor   public Test() { s = &quot;GeeksforGeeks&quot;; }   // Creating a public method with no arguments   public void method1() {       System.out.println(&quot;The string is &quot; + s);   }   // Creating a public method with int as argument   public void method2(int n) {       System.out.println(&quot;The number is &quot; + n);   }   // creating a private method   private void method3() {       System.out.println(&quot;Private method invoked&quot;);   } </code></pre><p>  } </p><p>  class Demo<br>  { </p><pre><code>  public static void main(String args[]) throws Exception   {       // Creating object whose property is to be checked       Test obj = new Test();           // æ„å»ºç±»çš„å¯¹è±¡      // getclass method       Class cls = obj.getClass();       System.out.println(&quot;The name of class is &quot; +                           cls.getName());       // Getting the constructor of the class through the       // object of the class       Constructor constructor = cls.getConstructor();       System.out.println(&quot;The name of constructor is &quot; +                           constructor.getName());       System.out.println(&quot;The public methods of class are : &quot;);       // Getting methods of the class through the object       // of the class by using getMethods       Method[] methods = cls.getMethods();       // Printing method names       for (Method method:methods)           System.out.println(method.getName());       // creates object of desired method by providing the       // method name and parameter class as arguments to       // the getDeclaredMethod        // è¿™é‡Œæ˜¯é€šè¿‡æ–¹æ³•çš„åå­—å’Œè¾“å…¥å˜é‡æ¥è·å–å¯¹åº”çš„æ–¹æ³•      Method methodcall1 = cls.getDeclaredMethod(&quot;method2&quot;,                                               int.class);       // invokes the method at runtime       // è¿™é‡Œæ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œè¿™ä¸ªæ–¹æ³•       methodcall1.invoke(obj, 19);       // creates object of the desired field by providing       // the name of field as argument to the       // getDeclaredField method       // è¿è¡Œæ—¶è·å–å¯¹åº”çš„privateçš„å˜é‡      Field field = cls.getDeclaredField(&quot;s&quot;);       // allows the object to access the field irrespective       // of the access specifier used with the field       // å°†è¿™ä¸ªå˜é‡è®¾æˆå¯ä»¥è·å–çš„      field.setAccessible(true);       // takes object and the new value to be assigned       // to the field as arguments       field.set(obj, &quot;JAVA&quot;);       // Creates object of desired method by providing the       // method name as argument to the getDeclaredMethod       Method methodcall2 = cls.getDeclaredMethod(&quot;method1&quot;);       // invokes the method at runtime       methodcall2.invoke(obj);       // Creates object of the desired method by providing       // the name of method as argument to the       // getDeclaredMethod method       Method methodcall3 = cls.getDeclaredMethod(&quot;method3&quot;);       // allows the object to access the method irrespective       // of the access specifier used with the method       methodcall3.setAccessible(true);       // invokes the method at runtime       methodcall3.invoke(obj);   } </code></pre><p>  } </p></li></ul><h1 id="3-è¯¦ç»†åˆ†æ"><a href="#3-è¯¦ç»†åˆ†æ" class="headerlink" title="3. è¯¦ç»†åˆ†æ"></a>3. è¯¦ç»†åˆ†æ</h1><p>åå°„ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå³åœ¨è¿è¡Œæ—¶æ‹¿åˆ°classï¼Œå¹¶åˆ›å»ºç±»å¯¹åº”çš„å¯¹è±¡çš„æ–¹å¼ã€‚è¿™ç§å¥½å¤„æ˜¯æ›´å…·çµæ´»æ€§ï¼ŒåŠ£åŠ¿æ˜¯ä¼šæ…¢å¾ˆå¤šï¼Œä»£ç ä¼šç›¸å¯¹éš¾ç†è§£äº›ã€‚</p><p>ä»ä»£ç æœ¬èº«çš„è§’åº¦æ¥è®²ï¼Œæ˜¯æŒ‡ä¸€éƒ¨åˆ†ä»£ç æœ‰èƒ½åŠ›å»è§‚å¯Ÿ/æ£€æŸ¥å¦ä¸€éƒ¨åˆ†ä»£ç ã€‚ç”¨å·²çŸ¥çš„éƒ¨åˆ†åˆç†æ¨æ–­å‡ºæœªçŸ¥çš„éƒ¨åˆ†ï¼Œè¿™æœªçŸ¥çš„éƒ¨åˆ†å…¶å®æ˜¯æŒ‡è¿˜ä¸çŸ¥é“çš„ä¿¡æ¯ã€‚</p><p>ä¸€èˆ¬æ¥è¯´åœ¨Javaé‡Œæˆ‘ä»¬éƒ½æ˜¯å’Œæ³¨è§£ä¸€èµ·æ¥ä½¿ç”¨åå°„çš„ï¼Œ</p><p>å€¼å¾—æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯åå°„æ˜¯é€šè¿‡æ–¹æ³•ç­¾åæ¥ç¡®å®šæ–¹æ³•çš„ï¼Œ<code>getClass().getDeclaredMethod(&quot;age&quot;, Integer.class).invoke(this, 36);</code> æ–¹æ³•ç­¾åæŒ‡çš„æ˜¯<code>getDeclaredMethod()</code></p><h1 id="4-ä¼˜åŠ£åŠ¿"><a href="#4-ä¼˜åŠ£åŠ¿" class="headerlink" title="4. ä¼˜åŠ£åŠ¿"></a>4. ä¼˜åŠ£åŠ¿</h1><ul><li>å¥½å¤„<ul><li>åå°„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½“æˆ‘ä»¬çš„ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œéœ€è¦åŠ¨æ€çš„åŠ è½½ä¸€äº›ç±»è¿™äº›ç±»å¯èƒ½ä¹‹å‰ç”¨ä¸åˆ°æ‰€ä»¥ä¸ç”¨åŠ è½½åˆ°jvmï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦æ‰åŠ è½½ï¼Œè¿™æ ·çš„å¥½å¤„å¯¹äºæœåŠ¡å™¨æ¥è¯´ä¸è¨€è€Œå–»ï¼Œä¸¾ä¸ªä¾‹å­æˆ‘ä»¬çš„é¡¹ç›®åº•å±‚æœ‰æ—¶æ˜¯ç”¨mysqlï¼Œæœ‰æ—¶ç”¨oracleï¼Œ<strong>éœ€è¦åŠ¨æ€åœ°æ ¹æ®å®é™…æƒ…å†µåŠ è½½é©±åŠ¨ç±»ï¼Œè¿™ä¸ªæ—¶å€™åå°„å°±æœ‰ç”¨äº†</strong>ï¼Œå‡è®¾ <code>com.java.dbtest.myqlConnection</code>ï¼Œ<code>com.java.dbtest.oracleConnection</code>è¿™ä¸¤ä¸ªç±»æˆ‘ä»¬è¦ç”¨ï¼Œè¿™æ—¶å€™æˆ‘ä»¬çš„ç¨‹åºå°±å†™å¾—æ¯”è¾ƒåŠ¨æ€åŒ–ï¼Œé€šè¿‡<code>Class tc = Class.forName(&quot;com.java.dbtest.TestConnection&quot;);</code>é€šè¿‡ç±»çš„å…¨ç±»åè®©jvmåœ¨æœåŠ¡å™¨ä¸­æ‰¾åˆ°å¹¶åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œå¦‚æœæ˜¯oracleåˆ™ä¼ å…¥çš„å‚æ•°å°±å˜æˆå¦ä¸€ä¸ªäº†ã€‚è¿™æ—¶å€™å°±å¯ä»¥çœ‹åˆ°åå°„çš„å¥½å¤„äº†ï¼Œè¿™ä¸ªåŠ¨æ€æ€§å°±ä½“ç°å‡ºjavaçš„ç‰¹æ€§äº†ï¼</li><li>æ›´å…·æ‹“å±•æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è·å–ä¿¡æ¯</li><li>è·å–ä¸€äº›privateçš„åŸŸçš„å€¼æ–¹ä¾¿debug</li></ul></li><li>åŠ£åŠ¿<ul><li>æ›´æ…¢ï¼Œæœ‰å»¶æ—¶</li><li>ä¼šæš´éœ²ä¸€äº›æ¥å£</li><li>åå°„ä¼šè¦æ±‚è¿è¡Œçš„è®¸å¯ï¼Œå½“åœ¨secure managerä¸‹æ¥è¿è¡Œå¯èƒ½ä¸è¢«å…è®¸</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful" target="_blank" rel="noopener">https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful</a></li><li><a href="https://docs.oracle.com/javase/tutorial/reflect/index.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/tutorial/reflect/index.html</a></li><li><a href="https://docs.oracle.com/javase/tutorial/reflect/class/index.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/tutorial/reflect/class/index.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Reflection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java - serialization</title>
      <link href="/java-serialization/"/>
      <url>/java-serialization/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>An object is eligible for serialization if and only if its class implements the <strong>java.io.Serializable</strong> interface. Serializable is a marker interface (contains no methods) that tell the Java Virtual Machine (JVM) that the objects of this class is ready for being written to and read from a persistent storage or over the network.</p><h1 id="2-Why-we-need-serialization"><a href="#2-Why-we-need-serialization" class="headerlink" title="2. Why we need serialization?"></a>2. Why we need serialization?</h1><p>Itâ€™s used when the need arises to send data/ object over network or stored in files.</p><p>The thing is network and hard disk are hardware component that understand bits and bytes but not Java Objects. </p><p>Serialization is the translation of your Java objectâ€™s values/states to bytes to send it over network or save it.</p><p>Also used to store into database. </p><h1 id="3-Implementation"><a href="#3-Implementation" class="headerlink" title="3. Implementation"></a>3. Implementation</h1><p>Ways for serialize/ deserialize  â€“ xml JSON </p><p>Serialization process is instance independent. </p><ul><li>ObjectInputStream <ul><li>extends java.io.InputStream </li></ul></li></ul><pre><code>public final Object readObject() throws IOException, ClassNotFoundException;</code></pre><ul><li>ObjectOutputStream <ul><li>extends java.io.OutputStream</li></ul></li></ul><pre><code>public final void writeObject(Object o) throws IOException;</code></pre><h2 id="3-1-Example"><a href="#3-1-Example" class="headerlink" title="3.1 Example"></a>3.1 Example</h2><pre><code>public class Person implements Serializable {    private static final long serialVersionUID = 1L;    static String country = &quot;ITALY&quot;;    private int age;    private String name;    transient int height;    // getters and setters}@Testpublic void whenSerializingAndDeserializing_ThenObjectIsTheSame() ()   throws IOException, ClassNotFoundException {     Person person = new Person();    person.setAge(20);    person.setName(&quot;Joe&quot;);    FileOutputStream fileOutputStream      = new FileOutputStream(&quot;yourfile.txt&quot;);    ObjectOutputStream objectOutputStream       = new ObjectOutputStream(fileOutputStream);    objectOutputStream.writeObject(person);    objectOutputStream.flush();    objectOutputStream.close();    FileInputStream fileInputStream      = new FileInputStream(&quot;yourfile.txt&quot;);    ObjectInputStream objectInputStream      = new ObjectInputStream(fileInputStream);    Person p2 = (Person) objectInputStream.readObject();    objectInputStream.close();     assertTrue(p2.getAge() == p.getAge());    assertTrue(p2.getName().equals(p.getName()));}</code></pre><h1 id="4-Caveats"><a href="#4-Caveats" class="headerlink" title="4. Caveats"></a>4. Caveats</h1><ol><li>When a class implements the java.io.Serializable interface, all <strong>its sub-classes are serializable as well</strong>.</li><li>when an object has a reference to another object, these objects must implement the Serializable interface separately, or else a NotSerializableException will be thrown</li><li>JVM associates a version number with each serializable class. </li></ol><p>Reference</p><ol><li><a href="https://www.codejava.net/java-se/file-io/why-do-we-need-serialization-in-java" target="_blank" rel="noopener">https://www.codejava.net/java-se/file-io/why-do-we-need-serialization-in-java</a></li><li><a href="https://www.baeldung.com/java-serialization" target="_blank" rel="noopener">https://www.baeldung.com/java-serialization</a></li><li><a href="https://www.geeksforgeeks.org/serialization-in-java/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/serialization-in-java/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java Pattern Regexè¡¨è¾¾å¼</title>
      <link href="/Java-Pattern-Regex%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/Java-Pattern-Regex%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Patternï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Patternï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Patternï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Patternï¼Ÿ</h1><p>ä¸€èˆ¬æ¥è¯´å¦‚æœæˆ‘ä»¬è¦å¯¹StringåšæŸä¸ªèŒƒå¼ä¸‹çš„æ›¿æ¢æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨</p><pre><code>stringEG.replaceAll(&quot;(?i)@gmail\\.com$&quot;, &quot;&quot;);</code></pre><p>ä¸Šé¢è¿™è¡Œä»£ç æ˜¯å°†stringEGæœ€åçš„@gmail.comç»™æ›¿æ¢æ‰ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥è·å¾—ç”¨æˆ·åã€‚</p><p>è¿™ç§Replaceæ“ä½œæˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯ä¸Šè¿°æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå³æ¯æ¬¡è¿è¡Œéƒ½è¦æ‰§è¡Œä¸€éRegexæ“ä½œï¼Œè¿™æ ·å¾ˆè´¹æ—¶é—´ï¼Œæ¯æ¬¡éƒ½è¦è¿›è¡Œç¼–è¯‘ï¼ŒPatternå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>é€šè¿‡è®¾ç½®staticçš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†Compileå®Œçš„ç»“æœå­˜èµ·æ¥ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™ç›´æ¥ä½¿ç”¨è¿™ä¸ªç»“æœå³å¯ã€‚</p><p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤º:</p><pre><code>private static final Pattern USER_NAME_PATTERN = Pattern.compile(&quot;(?i)@gmail\\.com$);final String username =  USER_NAME_PATTERN.matcher(stringEG.replace(&quot;&quot;));</code></pre><h1 id="2-å¦‚ä½•ä½¿ç”¨Patternï¼Ÿ"><a href="#2-å¦‚ä½•ä½¿ç”¨Patternï¼Ÿ" class="headerlink" title="2. å¦‚ä½•ä½¿ç”¨Patternï¼Ÿ"></a>2. å¦‚ä½•ä½¿ç”¨Patternï¼Ÿ</h1><p>ä½¿ç”¨Java Patternï¼Œé‡ç‚¹åœ¨äºå¯¹äºæ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æ–‡ç«  - <a href="https://llchen60.com/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼</a>, é‡Œé¢æœ‰å¯¹æ­£åˆ™çš„è¯¦ç»†ä»‹ç»ã€‚</p><p>Patternå¯¹è±¡æ˜¯ä¸€ä¸ªå·²ç»ç¼–è¯‘è¿‡çš„æ­£åˆ™è¡¨è¾¾å¼çš„è¡¨è¾¾ï¼ŒPatternç±»æ²¡æœ‰publicçš„æ„é€ å™¨ï¼Œæƒ³è¦åˆ›å»ºä¸€ä¸ªPatternï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆè°ƒç”¨å…¶é™æ€çš„compile()æ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•ä¼šå¾—åˆ°ä¸€ä¸ªPatternå¯¹è±¡ã€‚</p><p>Matcher å¯¹è±¡ç”¨æ¥è§£é‡Šæ­£åˆ™è¡¨è¾¾å¼ç„¶åæ ¹æ®è¡¨è¾¾å¼æ¥æ‰¾ç¬¦åˆè§„åˆ™çš„ç›¸å…³è¡¨è¾¾ï¼ŒåŒæ ·æ²¡æœ‰publicçš„æ„é€ å™¨ï¼Œé€šè¿‡è°ƒç”¨matcher() æ–¹æ³•æ¥ä½œæ¯”è¾ƒ</p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Regex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java map() ä¸ flatMap()çš„æ¯”è¾ƒ</title>
      <link href="/Java-map-%E4%B8%8E-flatMap-%E7%9A%84%E6%AF%94%E8%BE%83/"/>
      <url>/Java-map-%E4%B8%8E-flatMap-%E7%9A%84%E6%AF%94%E8%BE%83/</url>
      
        <content type="html"><![CDATA[<p><code>map()</code>å’Œ<code>flatMap()</code>æ–¹æ³•éƒ½æ¥è‡ªäºfunctional languages. åœ¨Java8å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Optional, Streamè¿˜æœ‰CompletableFutureå½“ä¸­æ‰¾åˆ°ä»–ä»¬ã€‚</p><p>Streamä»£è¡¨ä¸€äº›åˆ—çš„å¯¹è±¡ï¼Œè€ŒOptionalä»£è¡¨ä¸€ä¸ªå­˜åœ¨æˆ–è€…ç©ºçš„å€¼ã€‚<code>map()</code>å’Œ<code>flatmap()</code>éƒ½æ˜¯èšåˆæ–¹æ³•ï¼Œå°½ç®¡å…¶æœ‰ç€ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œä½†æ˜¯å®é™…ä¸Šä»–ä»¬æœ‰å¾ˆå¤šçš„ä¸åŒã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥é€ä¸€å±•ç°ã€‚</p><h1 id="1-åœ¨Optionalså½“ä¸­"><a href="#1-åœ¨Optionalså½“ä¸­" class="headerlink" title="1. åœ¨Optionalså½“ä¸­"></a>1. åœ¨Optionalså½“ä¸­</h1><pre><code>// map()Optional&lt;String&gt; s = Optional.of(&quot;Test&quot;);assertEquals(Optional.of(&quot;TEST&quot;), s.map(String::toUpperCase));// å¦‚æœæƒ…å†µæ›´ä¸ºå¤æ‚ï¼Œå˜æˆOptional&lt;Optional&lt;String&gt;&gt;assertEquals(Optional.of(Optional.of(&quot;STRING&quot;)),     Optional.of(&quot;string&quot;).map(s -&gt; Optional.of(&quot;STRING&quot;)));// åŒæ ·çš„ä»£ç ç”¨flatmapæ¥è¡¨ç¤ºassertEquals(Optional.of(&quot;STRING&quot;), Optional.of(&quot;string&quot;).flatMap(s -&gt; Optional.of(&quot;STRING&quot;)));</code></pre><h1 id="2-åœ¨Streamså½“ä¸­"><a href="#2-åœ¨Streamså½“ä¸­" class="headerlink" title="2. åœ¨Streamså½“ä¸­"></a>2. åœ¨Streamså½“ä¸­</h1><p>mapæ–¹æ³•åªèƒ½åšä¸€å±‚çš„åºåˆ—åŒ–ï¼Œä½†æ˜¯flatmapå¯ä»¥åšå¤šå±‚çš„ï¼Œæ¥è§£å†³Stream&lt;Stream<R>&gt;çš„è¿™ç§ç»“æ„çš„é—®é¢˜ã€‚</p><pre><code>// å¯¹äºè¿™ç§å¤šå±‚æ¶æ„çš„, map()æ–¹æ³•å°±æ˜¾å¾—åŠ›æœ‰æœªé€®äº†List&lt;List&lt;String&gt;&gt; list = Arrays.asList(  Arrays.asList(&quot;a&quot;),  Arrays.asList(&quot;b&quot;));System.out.println(list);// flatmapå¯ä»¥å¾ˆå¥½çš„è§£å†³System.out.println(list.stream().flatMap(Collection::stream).collect(Collectors.toList()));</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.baeldung.com/java-difference-map-and-flatmap" target="_blank" rel="noopener">https://www.baeldung.com/java-difference-map-and-flatmap</a></li><li><a href="https://www.mkyong.com/java8/java-8-flatmap-example/" target="_blank" rel="noopener">https://www.mkyong.com/java8/java-8-flatmap-example/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Map </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java - ExecutorService</title>
      <link href="/Java-ExecutorService/"/>
      <url>/Java-ExecutorService/</url>
      
        <content type="html"><![CDATA[<p>ExecutorService is a framework provided by the JDK which simplifies the execution of tasks in <strong><em>asynchronous</em></strong> mode. ExecutorService automatically provides a pool of threads and API for assigning tasks to it. </p><h1 id="1-Instantiation"><a href="#1-Instantiation" class="headerlink" title="1. Instantiation"></a>1. Instantiation</h1><h2 id="1-1-Factory-methods-of-Executors-class"><a href="#1-1-Factory-methods-of-Executors-class" class="headerlink" title="1.1 Factory methods of Executors class"></a>1.1 Factory methods of Executors class</h2><p>Use its factory methods of the Executors class to create ExecutorService. </p><pre><code>ExecutorService executor = Executors.newFixedThreadPool(10);</code></pre><h2 id="1-2-Directly-create"><a href="#1-2-Directly-create" class="headerlink" title="1.2 Directly create"></a>1.2 Directly create</h2><pre><code>ExecutorService executorService =   new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS,     new LinkedBlockingQueue&lt;Runnable&gt;());</code></pre><h1 id="2-Assigning-Tasks"><a href="#2-Assigning-Tasks" class="headerlink" title="2. Assigning Tasks"></a>2. Assigning Tasks</h1><p>ExecutorService can execute Runnable and Callable tasks. </p><pre><code>Runnable runnableTask = () -&gt; {    try {        TimeUnit.MILLISECONDS.sleep(300);    } catch (InterruptedException e) {        e.printStackTrace();    }};Callable&lt;String&gt; callableTask = () -&gt; {    TimeUnit.MILLISECONDS.sleep(300);    return &quot;Task&#39;s execution&quot;;};List&lt;Callable&lt;String&gt;&gt; callableTasks = new ArrayList&lt;&gt;();callableTasks.add(callableTask);callableTasks.add(callableTask);callableTasks.add(callableTask);</code></pre><h2 id="2-1-execute"><a href="#2-1-execute" class="headerlink" title="2.1 execute()"></a>2.1 execute()</h2><p>The execute() method is void, and it doesnâ€™t give any possibility to get the result of taskâ€™s execution or to check the taskâ€™s status (is it running or executed).</p><pre><code>executerService.execute(runnableTask);</code></pre><h2 id="2-2-submit"><a href="#2-2-submit" class="headerlink" title="2.2 submit()"></a>2.2 submit()</h2><p>submit() submits a Callable or a Runnable task to an ExecutorService and returns a result of type Future.</p><pre><code>Future&lt;String&gt; future = executorService.submit(callableTask);</code></pre><h2 id="2-3-invokeAny"><a href="#2-3-invokeAny" class="headerlink" title="2.3 invokeAny()"></a>2.3 invokeAny()</h2><p>invokeAny() assigns a collection of tasks to an ExecutorService, causing each to be executed, and returns the result of a successful execution of one task (if there was a successful execution).</p><pre><code>String result = executorService.invokeAny(callableTasks);</code></pre><h2 id="2-4-invokeAll"><a href="#2-4-invokeAll" class="headerlink" title="2.4 invokeAll()"></a>2.4 invokeAll()</h2><p>invokeAll() assigns a collection of tasks to an ExecutorService, causing each to be executed, and returns the result of all task executions in the form of a list of objects of type Future.</p><pre><code>List&lt;Future&lt;String&gt;&gt; futures = executorService.invokeAll(callableTasks);</code></pre><h1 id="3-Shutdown"><a href="#3-Shutdown" class="headerlink" title="3. Shutdown"></a>3. Shutdown</h1><p>In general, the ExecutorService will not be automatically destroyed when there is not task to process. It will stay alive and wait for new work to do.</p><p>In some cases this is very helpful; for example, if an app needs to process tasks which appear on an irregular basis or the quantity of these tasks is not known at compile time.</p><p>On the other hand, an app could reach its end, but it will not be stopped because a waiting ExecutorService will cause the JVM to keep running.</p><h2 id="3-1-shutdown"><a href="#3-1-shutdown" class="headerlink" title="3.1 shutdown()"></a>3.1 shutdown()</h2><p>The shutdown() method doesnâ€™t cause an immediate destruction of the ExecutorService. It will make the ExecutorService stop accepting new tasks and shut down after all running threads finish their current work.</p><pre><code>executorService.shutdown();</code></pre><h2 id="3-2-shutdownNow"><a href="#3-2-shutdownNow" class="headerlink" title="3.2 shutdownNow()"></a>3.2 shutdownNow()</h2><p>The shutdownNow() method tries to destroy the ExecutorService immediately, but it doesnâ€™t guarantee that all the running threads will be stopped at the same time. This method returns a list of tasks which are waiting to be processed. It is up to the developer to decide what to do with these tasks.</p><pre><code>List&lt;Runnable&gt; notExecutedTasks = executorService.shutDownNow();</code></pre><h2 id="3-3-best-behavior"><a href="#3-3-best-behavior" class="headerlink" title="3.3 best behavior"></a>3.3 best behavior</h2><pre><code>executorService.shutdown();try {    if (!executorService.awaitTermination(800, TimeUnit.MILLISECONDS)) {        executorService.shutdownNow();    } } catch (InterruptedException e) {    executorService.shutdownNow();}</code></pre><h1 id="4-Future-interface"><a href="#4-Future-interface" class="headerlink" title="4. Future interface"></a>4. Future interface</h1><p>Future interface provides a <code>get()</code> which returns an actual result of the Callable taskâ€™s execution or null in the case of Runnable task. Calling the get() method while the task is still running will cause execution to block until the task is properly executed and the result is available.</p><pre><code>Future&lt;String&gt; future = executorService.submit(callableTask);String result = null;try {    result = future.get();} catch (InterruptedException | ExecutionException e) {    e.printStackTrace();}</code></pre><p>With very long blocking caused by the get() method, an applicationâ€™s performance can degrade. If the resulting data is not crucial, it is possible to avoid such a problem by using timeouts:</p><pre><code>String result = future.get(200, TimeUnit.MILLISECONDS);</code></pre><p>some other methods provided:</p><pre><code>cancel()isCancelled()isDone() </code></pre><h1 id="5-How-to-sync-the-value-across-different-threads"><a href="#5-How-to-sync-the-value-across-different-threads" class="headerlink" title="5. How to sync the value across different threads?"></a>5. How to sync the value across different threads?</h1><p>Suppose we have i++ in several threads, and they all perform such operations. To make the i computed properly, we need to make it atomic. </p><p>Use <code>AtomicInteger</code> or <code>synchronized</code> to get the final correct result. </p><p>Notice, <code>volatile</code> cannot make sure the final result is correct. It mainly makes sure the visibility of newest value, but there is possibility that we mound and switch to other thread before the new value being recorded. </p><p>AtomicInteger class uses CAS(Compare and swap) low level CPU operations. They allow you to modify a particular variable only if the present value is equal to something else (and is returned successfully).</p><h1 id="6-Executor-execute-and-ExecutorService-submit-differences"><a href="#6-Executor-execute-and-ExecutorService-submit-differences" class="headerlink" title="6. Executor.execute() and ExecutorService.submit() differences"></a>6. Executor.execute() and ExecutorService.submit() differences</h1><ol><li>execute(Runnable) does not return anything; while submit(Callable<T>) returns a Future object which allows a way to programatically cancel the running thread and get the return result. </li><li>submit() can accept both Runnable and Callable task but execute() can only accept the Runnable task</li><li>submit() return a Future object while execute() has no return</li><li>get() is a blocking call, which will take some time</li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Executor Service </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java - callback</title>
      <link href="/Java-callback/"/>
      <url>/Java-callback/</url>
      
        <content type="html"><![CDATA[<p>In C/ C++, callback refers to the mechanism of calling a function from another function. Memory address of a function is represented as function pointer here. SO the callback is achieved by passing the pointer of func1() to func2().</p><p>However, in java, there is no function pointer existing. And we use a callback object or a callback interface, and the interface is passed that refers to the location of a function. </p><p>Below is an example to compute tax by state tax and fedaral tax. Suppose federal tax keeps same while state tax vary by state. We can build interface and implements interface to realize it.<br>    // Java program to demonstrate callback mechanism<br>    // using interface is Java </p><pre><code>// Create interface import java.util.Scanner; interface STax {     double stateTax(); } // Implementation class of Punjab state tax class Punjab implements STax {     public double stateTax()     {         return 3000.0;     } } // Implementation class of Himachal Pardesh state tax class HP implements STax {     public double stateTax()     {         return 1000.0;     } } class TAX {     public static void main(String[] args) throws ClassNotFoundException, IllegalAccessException, InstantiationException     {         Scanner sc = new Scanner(System.in);         System.out.println(&quot;Enter the state name&quot;);         String state = sc.next(); // name of the state         // The state name is then stored in an object c         Class c = Class.forName(state);         // Create the new object of the class whose name is in c         // Stax interface reference is now referencing that new object         STax ref = (STax)c.newInstance();         /*Call the method to calculate total tax         and pass interface reference - this is callback .         Here, ref may refer to stateTax() of Punjab or HP classes         depending on the class for which the object is created         in the previous step         */        calculateTax(ref);     }     static void calculateTax(STax t)     {         // calculate central tax         double ct = 2000.0;         // calculate state tax         double st = t.stateTax();         double totaltax = st + ct;         // display total tax         System.out.println(&quot;Total tax =&quot; + totaltax);     } } </code></pre>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Callback </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java Annotations æ³¨è§£è¯¦è§£</title>
      <link href="/Java-Annotations-%E6%B3%A8%E8%A7%A3%E8%AF%A6%E8%A7%A3/"/>
      <url>/Java-Annotations-%E6%B3%A8%E8%A7%A3%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>Java annotationå¾ˆæœ‰ç”¨ï¼Œè¿™ç¯‡åšå®¢ä¼šå¸¦ç€å¤§å®¶å»ç†è§£Annotationçš„è¯­æ³•ä»¥åŠç”¨æ³•ï¼Œå¸Œæœ›èƒ½æœ‰æ‰€è£¨ç›Šã€‚</p><h1 id="1-Annotationæ¶æ„"><a href="#1-Annotationæ¶æ„" class="headerlink" title="1. Annotationæ¶æ„"></a>1. Annotationæ¶æ„</h1><h2 id="1-0-Annotationçš„ä»‹ç»"><a href="#1-0-Annotationçš„ä»‹ç»" class="headerlink" title="1.0 Annotationçš„ä»‹ç»"></a>1.0 Annotationçš„ä»‹ç»</h2><p>ç”¨ä¸€å¥è¯æ¥è§£é‡ŠAnnotationçš„è¯ï¼Œæˆ‘æƒ³å¯ä»¥ç§°å…¶ä¸ºMetadata(å…ƒæ•°æ®) - å³æ•°æ®çš„æ•°æ®ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘ä½¿ç”¨äº†@Overrideï¼š</p><pre><code>@Overridepublic String toString() {return &quot;This is String Representation of current object.&quot;;}</code></pre><p>é€šè¿‡æ³¨è§£çš„æ–¹å¼ï¼Œæˆ‘å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘é‡å†™äº†è¿™ä¸ªtoString()çš„æ–¹æ³•ã€‚ä½†å…¶å®å°±ç®—æˆ‘æ²¡æœ‰åŠ è¿™ä¸ªæ³¨è§£ï¼Œä»£ç ä»ç„¶æ˜¯å¯ä»¥æœ‰æ•ˆè¿è¡Œçš„ï¼Œé‚£ä¹ˆç”¨æ³¨è§£çš„å¥½å¤„æœ‰å“ªäº›å‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ³¨è§£å‘¢ï¼Ÿï¼Ÿï¼Ÿ </p><p>ä¸Šè¿°çš„æ³¨è§£å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘é‡å†™äº†çˆ¶ç±»é‡Œé¢çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åç¼–è¯‘å™¨ä¼šå»çˆ¶ç±»æ£€æŸ¥çœ‹è¿™ä¸ªæ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œé‚£å°±ä¼šæ‰”å‡ºä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥å‡å°‘é”™è¯¯çš„å‘ç”Ÿï¼Œå¹¶ä¸”æé«˜æ•´ä¸ªä»£ç çš„å¯è¯»æ€§ï¼Œç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›ä¾¿åˆ©ã€‚</p><p>å…¶å®å°±åƒä¸Šé¢è¯´çš„é‚£æ ·ï¼Œæ³¨è§£æ˜¯ä¸€ç§æºå¸¦å…ƒæ•°æ®çš„æ–¹å¼ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨æ³¨è§£ä¹‹å‰æ˜¯ç”¨XMLæ¥åšå…ƒæ•°æ®çš„å­˜å‚¨çš„ã€‚äºŒè€…å„æœ‰è‡ªå·±çš„é€‚ç”¨åœºæ™¯ã€‚å¯¹äºXMLæ¥è¯´ï¼Œå¦‚æœä½ å†™çš„åº”ç”¨æœ‰å¤§é‡çš„å¸¸æ•°ï¼Œå‚é‡ï¼Œç”¨XMLä¼šæ›´å¥½ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å¸¸é‡å’Œä»£ç å®Œå…¨è§£è€¦ï¼Œè¿™æ ·åœ¨æ”¹å˜å¸¸é‡å€¼çš„æ—¶å€™ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚å¦‚æœä½ æƒ³å¯¹å¤–æš´éœ²ä¸€äº›æ–¹æ³•æ¥åšæœåŠ¡ï¼Œé‚£æ³¨è§£ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å› ä¸ºè¿™ç§æƒ…å½¢ä¸‹å…ƒæ•°æ®æœ€å¥½å’Œæ–¹æ³•ç´§å¯†ç›¸è¿ï¼Œè®©å¼€å‘è€…æ„è¯†åˆ°è¿™ä¸ªæ–¹æ³•çš„ä¸€äº›ç‰¹å¾ã€‚</p><p>å¦å¤–æ³¨è§£æä¾›äº†ä¸€ä¸ªæ ‡å‡†çš„åœ¨ä»£ç ä¸­å®šä¹‰å…ƒæ•°æ®çš„æ–¹å¼ï¼Œåœ¨æ³¨è§£ä¹‹å‰å·¥ç¨‹å¸ˆå¸¸ä¼šè‡ªå·±å®šä¹‰ï¼Œæ¯”å¦‚æ³¨é‡Šï¼Œæ¥å£ï¼Œç­‰ç­‰ã€‚æ³¨è§£å°†è¿™ä¸ªè¿‡ç¨‹åšäº†æ ‡å‡†åŒ–ã€‚</p><h2 id="1-1-Annotation-ç»„æˆéƒ¨åˆ†"><a href="#1-1-Annotation-ç»„æˆéƒ¨åˆ†" class="headerlink" title="1.1 Annotation ç»„æˆéƒ¨åˆ†"></a>1.1 Annotation ç»„æˆéƒ¨åˆ†</h2><p><img src="fig1.jpg" alt="fig1.jpg"></p><ul><li>Annotation<ul><li>1 RetentionPolicy æ¯ä¸€ä¸ªæ³¨è§£å¯¹è±¡éƒ½ä¼šæœ‰å”¯ä¸€çš„RetentionPolicyå±æ€§</li><li>1 - n ElementType  æ¯ä¸ªæ³¨è§£å¯¹è±¡éƒ½å¯ä»¥æœ‰è‹¥å¹²ä¸ªElementTypeå±æ€§</li><li>Annotationæœ‰å¤šä¸ªå®ç°ç±»ï¼ŒåŒ…æ‹¬<ul><li>Deprecated </li><li>Documented</li><li>Inherited </li><li>Override </li><li>Retention </li><li>Target </li></ul></li></ul></li></ul><p>ç¬¬ä¸€ä¸ªå¾ˆé‡è¦çš„è§‚å¿µï¼Œå°±æ˜¯<strong><em>æ³¨è§£åªæ˜¯å…ƒæ•°æ®ï¼Œå®ƒä¸åŒ…æ‹¬ä»»ä½•çœŸæ­£çš„ä»£ç é€»è¾‘</em></strong>ã€‚</p><p>ç¬¬äºŒä¸ªå¾ˆé‡è¦çš„è§‚å¿µï¼Œå»ºç«‹åœ¨ç¬¬ä¸€ä¸ªçš„åŸºç¡€ä¹‹ä¸Šï¼Œå³å¦‚æœæ³¨è§£ä¸åŒ…æ‹¬ä»£ç é€»è¾‘ï¼Œé‚£ä¹ˆå°±ä¸€å®šæœ‰é’ˆå¯¹æ³¨è§£çš„æ¶ˆè´¹è€…ï¼Œæ¥è¯»å–æ³¨è§£æä¾›çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æ‰§è¡Œå¯¹åº”çš„ä»£ç é€»è¾‘ã€‚</p><p>æ¯”å¦‚ä»¥@overrideä¸ºä¾‹ï¼Œè¿™é‡ŒJVMå°±æ˜¯è¿™ä¸ªæ³¨è§£çš„æ¶ˆè´¹è€…ï¼Œå¹¶ä¸”åœ¨å­—èŠ‚ç çš„æ°´å¹³åˆ©ç”¨æ³¨è§£ä¿¡æ¯ã€‚</p><h3 id="1-1-1-Annotation-java"><a href="#1-1-1-Annotation-java" class="headerlink" title="1.1.1 Annotation.java"></a>1.1.1 Annotation.java</h3><pre><code>package java.lang.annotation;public interface Annotation {    boolean equals(Object obj);    int hashCode();    String toString();    Class&lt;? extends Annotation&gt; annotationType();}</code></pre><p>ä¸€ä¸ªæ¥å£</p><h3 id="1-1-2-ElementType-java"><a href="#1-1-2-ElementType-java" class="headerlink" title="1.1.2 ElementType.java"></a>1.1.2 ElementType.java</h3><pre><code>package java.lang.annotation;public enum ElementType {    TYPE,               /* ç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨é‡Šç±»å‹ï¼‰æˆ–æšä¸¾å£°æ˜  */    FIELD,              /* å­—æ®µå£°æ˜ï¼ˆåŒ…æ‹¬æšä¸¾å¸¸é‡ï¼‰  */    METHOD,             /* æ–¹æ³•å£°æ˜  */    PARAMETER,          /* å‚æ•°å£°æ˜  */    CONSTRUCTOR,        /* æ„é€ æ–¹æ³•å£°æ˜  */    LOCAL_VARIABLE,     /* å±€éƒ¨å˜é‡å£°æ˜  */    ANNOTATION_TYPE,    /* æ³¨é‡Šç±»å‹å£°æ˜  */    PACKAGE             /* åŒ…å£°æ˜  */}</code></pre><p>æšä¸¾ç±»å‹ï¼Œç”¨æ¥æŒ‡å®šAnnotationçš„ç±»å‹ã€‚å°±æ˜¯è¿™ä¸ªæ³¨è§£å¯¹è±¡æ˜¯ç”¨æ¥ä¿®é¥°ä»€ä¹ˆçš„ï¼Œæ˜¯æ–¹æ³•ï¼Œæ˜¯å˜é‡ï¼Œè¿˜æ˜¯å…¶ä»–çš„å„ç§â€¦</p><h3 id="1-1-3-RetentionPolicy-java"><a href="#1-1-3-RetentionPolicy-java" class="headerlink" title="1.1.3 RetentionPolicy.java"></a>1.1.3 RetentionPolicy.java</h3><pre><code>package java.lang.annotation;public enum RetentionPolicy {    SOURCE,            /* Annotationä¿¡æ¯ä»…å­˜åœ¨äºç¼–è¯‘å™¨å¤„ç†æœŸé—´ï¼Œç¼–è¯‘å™¨å¤„ç†å®Œä¹‹åå°±æ²¡æœ‰è¯¥Annotationä¿¡æ¯äº†  */    CLASS,             /* ç¼–è¯‘å™¨å°†Annotationå­˜å‚¨äºç±»å¯¹åº”çš„.classæ–‡ä»¶ä¸­ã€‚é»˜è®¤è¡Œä¸º  */    RUNTIME            /* ç¼–è¯‘å™¨å°†Annotationå­˜å‚¨äºclassæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¯ç”±JVMè¯»å…¥ */}</code></pre><p>RetentionPolicyæ˜¯Enumæšä¸¾ç±»å‹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶å¯¹åº”çš„è¡Œä¸ºã€‚</p><p><strong>RetentionPolicy.SOURCE</strong> â€“ Discard during the compile. These annotations donâ€™t make any sense after the compile has completed, so they arenâ€™t written to the bytecode. Examples @Override, @SuppressWarnings</p><p><strong>RetentionPolicy.CLASS</strong> â€“ Discard during class load. Useful when doing bytecode-level post-processing. Somewhat surprisingly, this is the default.</p><p><strong>RetentionPolicy.RUNTIME</strong> â€“ Do not discard. The annotation should be available for reflection at runtime. This is what we generally use for our custom annotations.</p><h2 id="1-2-é€šç”¨å®šä¹‰"><a href="#1-2-é€šç”¨å®šä¹‰" class="headerlink" title="1.2 é€šç”¨å®šä¹‰"></a>1.2 é€šç”¨å®šä¹‰</h2><pre><code>@Documented@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)public @interface MyAnnotation1 {}</code></pre><h3 id="1-2-1-interface"><a href="#1-2-1-interface" class="headerlink" title="1.2.1 @interface"></a>1.2.1 @interface</h3><p>æ„å‘³ç€å®ç°äº†java.lang.annotation.Annotationæ¥å£ï¼Œå³è¯¥æ³¨è§£å°±æ˜¯ä¸€ä¸ªAnnotationã€‚Annotationæ¥å£çš„å®ç°ç»†èŠ‚éƒ½ç”±ç¼–è¯‘å™¨æ¥å®Œæˆçš„ï¼Œé€šè¿‡@interfaceå®šä¹‰æ³¨è§£å¼ï¼Œè¯¥æ³¨è§£ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æ¥å£ã€‚</p><h3 id="1-2-2-Documented"><a href="#1-2-2-Documented" class="headerlink" title="1.2.2 @Documented"></a>1.2.2 @Documented</h3><p>ç±»å’Œæ–¹æ³•çš„Annotationåœ¨ç¼ºçœæƒ…å†µä¸‹æ˜¯ä¸å‡ºç°åœ¨javadocä¸­çš„ã€‚å¦‚æœä½¿ç”¨@Documentedä¿®é¥°è¯¥Annotationï¼Œåˆ™è¡¨ç¤ºå®ƒå¯ä»¥å‡ºç°åœ¨javadocä¸­ã€‚</p><h3 id="1-2-3-Target-ElementType-TYPE"><a href="#1-2-3-Target-ElementType-TYPE" class="headerlink" title="1.2.3 @Target(ElementType.TYPE)"></a>1.2.3 @Target(ElementType.TYPE)</h3><p>ElementTypeæ˜¯Annotationçš„ç±»å‹å±æ€§ï¼Œè€Œ@Targetçš„ä½œç”¨ï¼Œå°±æ˜¯æ¥æŒ‡å®šç±»å‹å±æ€§çš„</p><p>æœ‰@Targetï¼Œåˆ™è¯¥Annotationåªèƒ½ç”¨äºå…¶æ‰€æŒ‡å®šçš„åœ°æ–¹ï¼›è‹¥æ²¡æœ‰ï¼Œåˆ™è¯¥Annotationå¯ä»¥ç”¨äºä»»ä½•åœ°æ–¹</p><h3 id="1-2-4-Retention-RetentionPolicy-RUNTIME"><a href="#1-2-4-Retention-RetentionPolicy-RUNTIME" class="headerlink" title="1.2.4 @Retention(RetentionPolicy.RUNTIME)"></a>1.2.4 @Retention(RetentionPolicy.RUNTIME)</h3><p>RetentionPolicyæ˜¯Annotationçš„ç­–ç•¥å±æ€§ï¼Œ</p><h2 id="1-3-å¸¸ç”¨Annotation"><a href="#1-3-å¸¸ç”¨Annotation" class="headerlink" title="1.3 å¸¸ç”¨Annotation"></a>1.3 å¸¸ç”¨Annotation</h2><h3 id="1-3-1-Deprecated"><a href="#1-3-1-Deprecated" class="headerlink" title="1.3.1 @Deprecated"></a>1.3.1 @Deprecated</h3><pre><code>@Documented@Retention(RetentionPolicy.RUNTIME)public @interface Deprecated {}</code></pre><ol><li>@interface â€“ å®ƒçš„ç”¨æ¥ä¿®é¥°Deprecatedï¼Œæ„å‘³ç€Deprecatedå®ç°äº†java.lang.annotation.Annotationæ¥å£ï¼›å³Deprecatedå°±æ˜¯ä¸€ä¸ªæ³¨è§£ã€‚</li><li>@Documented â€“ å®ƒçš„ä½œç”¨æ˜¯è¯´æ˜è¯¥æ³¨è§£èƒ½å‡ºç°åœ¨javadocä¸­ã€‚</li><li>@Retention(RetentionPolicy.RUNTIME) â€“ å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®šDeprecatedçš„ç­–ç•¥æ˜¯RetentionPolicy.RUNTIMEã€‚è¿™å°±æ„å‘³ç€ï¼Œç¼–è¯‘å™¨ä¼šå°†Deprecatedçš„ä¿¡æ¯ä¿ç•™åœ¨.classæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯»å–ã€‚</li><li>@Deprecated æ‰€æ ‡æ³¨å†…å®¹ï¼Œä¸å†è¢«å»ºè®®ä½¿ç”¨ã€‚<h3 id="1-3-2-Override"><a href="#1-3-2-Override" class="headerlink" title="1.3.2 @Override"></a>1.3.2 @Override</h3></li></ol><h3 id="1-3-3-Documented"><a href="#1-3-3-Documented" class="headerlink" title="1.3.3 @Documented"></a>1.3.3 @Documented</h3><h3 id="1-3-4-Inherited"><a href="#1-3-4-Inherited" class="headerlink" title="1.3.4 @Inherited"></a>1.3.4 @Inherited</h3><p>ç”¨æ¥æ ‡æ³¨Annotationç±»å‹ï¼Œæ‰€æ ‡æ³¨çš„Annotationå…·æœ‰ç»§æ‰¿æ€§</p><pre><code>@Documented@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.ANNOTATION_TYPE)public @interface Inherited {}</code></pre><ol><li>@interface â€“ å®ƒçš„ç”¨æ¥ä¿®é¥°Inheritedï¼Œæ„å‘³ç€Inheritedå®ç°äº†java.lang.annotation.Annotationæ¥å£ï¼›å³Inheritedå°±æ˜¯ä¸€ä¸ªæ³¨è§£ã€‚</li><li>@Documented â€“ å®ƒçš„ä½œç”¨æ˜¯è¯´æ˜è¯¥æ³¨è§£èƒ½å‡ºç°åœ¨javadocä¸­ã€‚</li><li>@Retention(RetentionPolicy.RUNTIME) â€“ å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®šInheritedçš„ç­–ç•¥æ˜¯RetentionPolicy.RUNTIMEã€‚è¿™å°±æ„å‘³ç€ï¼Œç¼–è¯‘å™¨ä¼šå°†Inheritedçš„ä¿¡æ¯ä¿ç•™åœ¨.classæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯»å–ã€‚</li><li>@Target(ElementType.ANNOTATION_TYPE) â€“ å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®šInheritedçš„ç±»å‹æ˜¯ANNOTATION_TYPEã€‚è¿™å°±æ„å‘³ç€ï¼Œ@Inheritedåªèƒ½è¢«ç”¨æ¥æ ‡æ³¨â€œAnnotationç±»å‹â€ã€‚</li></ol><h3 id="1-3-5-Retention"><a href="#1-3-5-Retention" class="headerlink" title="1.3.5 @Retention"></a>1.3.5 @Retention</h3><p>ç”¨æ¥æ ‡æ³¨Annotationç±»å‹ï¼Œç”¨æ¥æŒ‡å®šRetentionPolicyå±æ€§</p><h3 id="1-3-6-Target"><a href="#1-3-6-Target" class="headerlink" title="1.3.6 @Target"></a>1.3.6 @Target</h3><p>@Targetåªèƒ½è¢«ç”¨æ¥æ ‡æ³¨â€œAnnotationç±»å‹â€ï¼Œè€Œä¸”å®ƒè¢«ç”¨æ¥æŒ‡å®šAnnotationçš„ElementTypeå±æ€§ã€‚</p><h3 id="1-3-7-SuppressWarnings"><a href="#1-3-7-SuppressWarnings" class="headerlink" title="1.3.7 @SuppressWarnings"></a>1.3.7 @SuppressWarnings</h3><p>@SuppressWarnings æ‰€æ ‡æ³¨å†…å®¹äº§ç”Ÿçš„è­¦å‘Šï¼Œç¼–è¯‘å™¨ä¼šå¯¹è¿™äº›è­¦å‘Šä¿æŒé™é»˜ã€‚</p><pre><code>@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})@Retention(RetentionPolicy.SOURCE)public @interface SuppressWarnings {    String[] value();}</code></pre><ol><li>@interface â€“ å®ƒçš„ç”¨æ¥ä¿®é¥°SuppressWarningsï¼Œæ„å‘³ç€SuppressWarningså®ç°äº†java.lang.annotation.Annotationæ¥å£ï¼›å³SuppressWarningså°±æ˜¯ä¸€ä¸ªæ³¨è§£ã€‚</li><li>@Retention(RetentionPolicy.SOURCE) â€“ å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®šSuppressWarningsçš„ç­–ç•¥æ˜¯RetentionPolicy.SOURCEã€‚è¿™å°±æ„å‘³ç€ï¼ŒSuppressWarningsä¿¡æ¯ä»…å­˜åœ¨äºç¼–è¯‘å™¨å¤„ç†æœŸé—´ï¼Œç¼–è¯‘å™¨å¤„ç†å®Œä¹‹åSuppressWarningså°±æ²¡æœ‰ä½œç”¨äº†ã€‚</li><li>@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE}) â€“ å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®šSuppressWarningsçš„ç±»å‹åŒæ—¶åŒ…æ‹¬TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLEã€‚</li></ol><ul><li>TYPEæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨é‡Šç±»å‹ï¼‰æˆ–æšä¸¾å£°æ˜â€ã€‚</li><li>FIELDæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œå­—æ®µå£°æ˜â€ã€‚</li><li>METHODæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œæ–¹æ³•â€ã€‚</li><li>PARAMETERæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œå‚æ•°â€ã€‚</li><li>CONSTRUCTORæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œæ„é€ æ–¹æ³•â€ã€‚</li><li>LOCAL_VARIABLEæ„å‘³ç€ï¼Œå®ƒèƒ½æ ‡æ³¨â€œå±€éƒ¨å˜é‡â€ã€‚</li></ul><ol start="4"><li>String[] value(); æ„å‘³ç€ï¼ŒSuppressWarningsèƒ½æŒ‡å®šå‚æ•°</li><li>SuppressWarnings çš„ä½œç”¨æ˜¯ï¼Œè®©ç¼–è¯‘å™¨å¯¹â€œå®ƒæ‰€æ ‡æ³¨çš„å†…å®¹â€çš„æŸäº›è­¦å‘Šä¿æŒé™é»˜ã€‚ä¾‹å¦‚ï¼Œâ€@SuppressWarnings(value={â€œdeprecationâ€, â€œuncheckedâ€})â€ è¡¨ç¤ºå¯¹â€œå®ƒæ‰€æ ‡æ³¨çš„å†…å®¹â€ä¸­çš„ â€œSuppressWarningsä¸å†å»ºè®®ä½¿ç”¨è­¦å‘Šâ€å’Œâ€œæœªæ£€æŸ¥çš„è½¬æ¢æ—¶çš„è­¦å‘Šâ€ä¿æŒæ²‰é»˜ã€‚<h1 id="2-åˆ›å»ºè‡ªå·±çš„Annotation"><a href="#2-åˆ›å»ºè‡ªå·±çš„Annotation" class="headerlink" title="2. åˆ›å»ºè‡ªå·±çš„Annotation"></a>2. åˆ›å»ºè‡ªå·±çš„Annotation</h1></li></ol><p>æ³¨è§£åªæ”¯æŒåŸºæœ¬ç±»å‹ï¼ŒStringï¼Œè¿˜æœ‰Enumã€‚æ‰€æœ‰çš„æ³¨è§£çš„å±æ€§éƒ½è¢«å®šä¹‰ä¸ºæ–¹æ³•ï¼Œdefaultçš„å€¼ä¹Ÿä¼šåœ¨æ–¹æ³•é‡Œæä¾›ã€‚</p><pre><code>@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)@interface Todo {public enum Priority {LOW, MEDIUM, HIGH}public enum Status {STARTED, NOT_STARTED}String author() default &quot;Yash&quot;;Priority priority() default Priority.LOW;Status status() default Status.NOT_STARTED;}</code></pre><p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ³¨è§£ï¼Œ@Todo</p><pre><code>@Todo(priority = Todo.Priority.MEDIUM, author = &quot;Yashwant&quot;, status = Todo.Status.STARTED)public void incompleteMethod1() {    //ä¸€äº›ä¸šåŠ¡é€»è¾‘}</code></pre><p>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ï¼Œå¦‚æœæ³¨è§£åªæœ‰ä¸€ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è¢«å‘½åä¸ºvalue,åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ä¸ç”¨ä½¿ç”¨å…·ä½“çš„å˜é‡åäº†ã€‚</p><pre><code>@interface Author{String value();}@Author(&quot;Yashwant&quot;)public void someMethod() {}</code></pre><p>å®šä¹‰å¥½æ³¨è§£ä»¥åï¼Œæˆ‘ä»¬éœ€è¦å†™æ³¨è§£çš„æ¶ˆè´¹è€…ï¼Œä½¿ç”¨åå°„ã€‚</p><pre><code>Class businessLogicClass = BusinessLogic.class;for(Method method : businessLogicClass.getMethods()) {    Todo todoAnnotation = (Todo)method.getAnnotation(Todo.class);    if(todoAnnotation != null) {    System.out.println(&quot; Method Name : &quot; + method.getName());    System.out.println(&quot; Author : &quot; + todoAnnotation.author());    System.out.println(&quot; Priority : &quot; + todoAnnotation.priority());    System.out.println(&quot; Status : &quot; + todoAnnotation.status());    }}</code></pre><h1 id="3-Reference"><a href="#3-Reference" class="headerlink" title="3. Reference"></a>3. Reference</h1><ol><li><a href="https://www.cnblogs.com/skywang12345/p/3344137.html" target="_blank" rel="noopener">https://www.cnblogs.com/skywang12345/p/3344137.html</a> </li><li><a href="https://dzone.com/articles/how-annotations-work-java" target="_blank" rel="noopener">https://dzone.com/articles/how-annotations-work-java</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Annotations </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jackson  java-json parser</title>
      <link href="/Jackson-java-json-parser/"/>
      <url>/Jackson-java-json-parser/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><ul><li>JSON <ul><li>JavaScript Object Notation </li><li>Data exchange format between browsers and web servers </li></ul></li><li>Jackson <ul><li>2 main parsers <ul><li>ObjectMapper <ul><li>parse JSON into custom Java objects, or into a jackson specific tree structure </li></ul></li><li>JsonParser <ul><li>JSON pull parser, parsing JSON one token at a time </li></ul></li></ul></li><li>2 main JSON generator<ul><li>ObjectMapper </li><li>JsonGenerator<ul><li>generate JSON one token at a time </li></ul></li></ul></li><li>3 main packages <ul><li>Jackson Core</li><li>Jackson Annotations</li><li>Jackson Databind </li></ul></li></ul></li></ul><h1 id="2-Parsers-JSON-to-Java-Object"><a href="#2-Parsers-JSON-to-Java-Object" class="headerlink" title="2. Parsers - JSON to Java Object"></a>2. Parsers - JSON to Java Object</h1><pre><code>ObjectMapper objectMapper = new ObjectMapper();String lakers = &quot;{ \&quot;SuperStar\&quot;:\&quot;Kobe Bryant\&quot;}&quot;;try {    Lakers lakers = objectMapper.readValue(lakers, Lakers.class);} catch (IOException e) {    log.error(e);}@Datapublic class Lakers {    private String superStar;}</code></pre><h2 id="2-1-How-Jackson-ObjectMapper-matches-JSON-fields-to-Java-Fields"><a href="#2-1-How-Jackson-ObjectMapper-matches-JSON-fields-to-Java-Fields" class="headerlink" title="2.1 How Jackson ObjectMapper matches JSON fields to Java Fields?"></a>2.1 How Jackson ObjectMapper matches JSON fields to Java Fields?</h2><p>By default, Jackson maps the fields of a JSON object to fields in a Java object by matching the names of the JSON field to the getter and setter methods in the Java object.<br>Jackson removes the â€œgetâ€ and â€œsetâ€ part of the names of the getter and setter methods, and converts the first character of the remaining name to lowercase.</p><p>If you want to customize the parsing process, you may want to use a custom serializer and deserializer, or use Jackson Annotations </p><h2 id="2-2-Fail-on-Null-for-primitive-types"><a href="#2-2-Fail-on-Null-for-primitive-types" class="headerlink" title="2.2 Fail on Null for primitive types"></a>2.2 Fail on Null for primitive types</h2><p>We could configure the Jackson ObjectMapper to fail if a JSON string contains a field with its value set to null. </p><pre><code>ObjectMapper objectMapper = new ObjectMapper();objectMapper.configure(DeserializationFeature.FAIL_ON_NULL_FOR_PRIMITIVES, true);</code></pre><h2 id="2-3-Jackson-JsonParser"><a href="#2-3-Jackson-JsonParser" class="headerlink" title="2.3 Jackson JsonParser"></a>2.3 Jackson JsonParser</h2><ul><li><p>lower level than the ObjectMapper </p><ul><li>faster than the ObjectMapper</li></ul></li><li><p>Create a JsonParser </p><ul><li><code>JsonFactory factory = new JsonFactory();</code></li><li><code>JsonParser parser = factory.createParser(carJson);</code></li></ul></li><li><p>Parsing Json with JsonParser</p><ul><li>break the JSON up into a sequence of tokens which you can iterate one by one </li></ul></li></ul><pre><code>String carJson =        &quot;{ \&quot;brand\&quot; : \&quot;Mercedes\&quot;, \&quot;doors\&quot; : 5 }&quot;;JsonFactory factory = new JsonFactory();JsonParser  parser  = factory.createParser(carJson);while(!parser.isClosed()){    JsonToken jsonToken = parser.nextToken();    System.out.println(&quot;jsonToken = &quot; + jsonToken);}</code></pre><h1 id="3-Generators-Java-Object-to-JSON"><a href="#3-Generators-Java-Object-to-JSON" class="headerlink" title="3. Generators - Java Object to JSON"></a>3. Generators - Java Object to JSON</h1><ul><li>ObjectMapper<ul><li>writeValue()</li><li>writeValueAsString()</li><li>writeValueAsBytes()</li></ul></li></ul><h2 id="3-1-Jackson-JsonGenerator"><a href="#3-1-Jackson-JsonGenerator" class="headerlink" title="3.1 Jackson JsonGenerator"></a>3.1 Jackson JsonGenerator</h2><ul><li>used to generate JSON from java objects </li></ul><pre><code>JsonFactory factory = new JsonFactory();JsonGenerator generator = factory.createGenerator(    new File(&quot;blabla&quot;), JsonEncoding.UTF8);</code></pre><h1 id="4-Jackson-JSON-Tree-Model"><a href="#4-Jackson-JSON-Tree-Model" class="headerlink" title="4. Jackson JSON Tree Model"></a>4. Jackson JSON Tree Model</h1><ul><li>A built-in tree model: used to represent a JSON object </li><li>Represented by the JsonNode class <ul><li>use the ObjectMapper to parse JSON into a JsonNode tree model</li></ul></li><li>JsonNode class lets you navigate the JSOn as a Java object in a quite flexible and dynamic way </li></ul><pre><code>String carJson =        &quot;{ \&quot;brand\&quot; : \&quot;Mercedes\&quot;, \&quot;doors\&quot; : 5 }&quot;;ObjectMapper objectMapper = new ObjectMapper();try {    JsonNode jsonNode = objectMapper.readValue(carJson, JsonNode.class);} catch (IOException e) {    e.printStackTrace();}// ways on how to access JSON fields, arrays and nested objects String carJson =    &quot;{ \&quot;brand\&quot; : \&quot;Mercedes\&quot;, \&quot;doors\&quot; : 5,&quot; +    &quot;  \&quot;owners\&quot; : [\&quot;John\&quot;, \&quot;Jack\&quot;, \&quot;Jill\&quot;],&quot; +    &quot;  \&quot;nestedObject\&quot; : { \&quot;field\&quot; : \&quot;value\&quot; } }&quot;;ObjectMapper objectMapper = new ObjectMapper();try {    JsonNode jsonNode = objectMapper.readValue(carJson, JsonNode.class);    // we could always use get() to get the node     JsonNode brandNode = jsonNode.get(&quot;brand&quot;);    String brand = brandNode.asText();    System.out.println(&quot;brand = &quot; + brand);    JsonNode doorsNode = jsonNode.get(&quot;doors&quot;);    int doors = doorsNode.asInt();    System.out.println(&quot;doors = &quot; + doors);    JsonNode array = jsonNode.get(&quot;owners&quot;);    JsonNode jsonNode = array.get(0);    String john = jsonNode.asText();    System.out.println(&quot;john  = &quot; + john);    JsonNode child = jsonNode.get(&quot;nestedObject&quot;);    JsonNode childField = child.get(&quot;field&quot;);    String field = childField.asText();    System.out.println(&quot;field = &quot; + field);} catch (IOException e) {    e.printStackTrace();}</code></pre><h2 id="4-1-Read-JsonNode-from-JSON"><a href="#4-1-Read-JsonNode-from-JSON" class="headerlink" title="4.1 Read JsonNode from JSON"></a>4.1 Read JsonNode from JSON</h2><pre><code>String jsonStr = blablabla;ObjectMapper objectMapper = new ObjectMapper();JsonNode jsonNode = objectMapper.readTree(json);</code></pre><h2 id="4-2-Write-JsonNode-to-JSON"><a href="#4-2-Write-JsonNode-to-JSON" class="headerlink" title="4.2 Write JsonNode to JSON"></a>4.2 Write JsonNode to JSON</h2><pre><code>ObjectMapper objectMapper = new ObjectMapper();JsonNode jsonNode = readJsonIntoJsonNode();String json = objectMapper.writeValueAsString(jsonNode);</code></pre><h1 id="5-JsonAnnotation"><a href="#5-JsonAnnotation" class="headerlink" title="5. JsonAnnotation"></a>5. JsonAnnotation</h1><ul><li>@JsonIgnore</li><li>@JsonIgnoreProperties<ul><li>specify a list of properties of a class to ignore </li></ul></li><li>@JsonIgnoreType</li><li>@JsonAutoDetect </li><li>@JsonSetter </li><li>@JsonCreator</li><li>@JsonProperty </li><li>@JsonInclude<ul><li>tells Jackson only to include properties under certain circumstances</li></ul></li><li>@JsonGetter <ul><li>tell Jackson that a certain field value should be obtained from calling a getter method instead of via direct field access </li></ul></li><li>@JsonPropertyOrder<ul><li>specify in what order the fields of your java object should be serialized into JSON</li></ul></li><li>@JsonValue<ul><li>tells jackson that it should not attempt to serialize the obejct itself, but rather call a method on the object which serialize the object to a JSON string </li></ul></li><li>@JsonSerialize <ul><li>specify a custom serializer for a field in a Java object  </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="http://tutorials.jenkov.com/java-json/jackson-objectmapper.html" target="_blank" rel="noopener">http://tutorials.jenkov.com/java-json/jackson-objectmapper.html</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Jackson </tag>
            
            <tag> Serialization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HashMapåœ¨Javaä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„</title>
      <link href="/HashMap%E5%9C%A8Java%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/"/>
      <url>/HashMap%E5%9C%A8Java%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/</url>
      
        <content type="html"><![CDATA[<p>HashMapæ˜¯å­˜å‚¨ä»¥åŠè·å–æ•°æ®çš„ä¸€ç§ç®€å•æœ‰æ•ˆçš„æ–¹å¼ï¼Œæœ¬æ–‡æ¢ç©¶Javaçš„HashMapçš„å†…éƒ¨å®ç°ã€‚</p><h1 id="1-å†…éƒ¨å­˜å‚¨"><a href="#1-å†…éƒ¨å­˜å‚¨" class="headerlink" title="1. å†…éƒ¨å­˜å‚¨"></a>1. å†…éƒ¨å­˜å‚¨</h1><p>Javaçš„HashMap Class implements <code>Map&lt;K,V&gt;</code> æ¥å£ã€‚è¿™ä¸ªæ¥å£çš„ä¸»è¦æ–¹æ³•æœ‰ï¼š</p><ul><li>put(K key, V value)</li><li>get(Object key)</li><li>remove(Object key)</li><li>Boolean containsKey(Object key)</li></ul><p>HashMapåœ¨å†…éƒ¨ç”¨é”®å€¼å¯¹æ¥è¿›è¡Œå­˜å‚¨ï¼Œä½†æ˜¯è¿˜åŒ…å«ä¸¤ä»½å…¶ä»–æ•°æ®ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li>ä¸€ä¸ªåˆ°å…¶ä»–çš„Entryçš„referenceï¼Œè¿™æ ·å­HashMapå°±å¯ä»¥åƒå­˜å•å‘é“¾è¡¨ä¸€æ ·æ¥å­˜Entries</li><li>ä¸€ä¸ªä»£è¡¨keyçš„å“ˆå¸Œå€¼çš„å€¼ã€‚å°†è¿™ä¸ªå€¼å­˜å‚¨æ¥é¿å…æ¯æ¬¡hashMapéœ€è¦çš„æ—¶å€™éƒ½è¦é‡æ–°è®¡ç®—ã€‚</li></ul><h2 id="1-1-Java-çš„Entryçš„å®ç°"><a href="#1-1-Java-çš„Entryçš„å®ç°" class="headerlink" title="1.1 Java çš„Entryçš„å®ç°"></a>1.1 Java çš„Entryçš„å®ç°</h2><pre><code>static class Entry&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {    final K key;    V value;    Entry&lt;K,V&gt; next;    int hash;}</code></pre><p>ä¸€ä¸ªHashMapå­˜å‚¨åœ¨å¤šä¸ªå•å‘é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªå•å‘é“¾è¡¨ç§°ä¸ºBucketsæˆ–è€…bins. æ‰€æœ‰çš„é“¾è¡¨éƒ½æ³¨å†Œåœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæ•°ç»„å…ƒç´ ä¸º<code>Entry&lt;K,V&gt;</code>. é»˜è®¤çš„æ•°ç»„å¤§å°æ˜¯16.<br><img src="https://i.loli.net/2020/02/05/yORJs9NVWXPt75p.jpg" alt="fig1.jpg"></p><p>æ‰€æœ‰æœ‰ç›¸åŒå“ˆå¸Œå€¼çš„keyå€¼ä¼šå­˜åœ¨åŒä¸€ä¸ªå•å‘é“¾è¡¨å½“ä¸­ï¼Œ å½“ä½¿ç”¨è€…ç”¨putæˆ–è€…getæ–¹æ³•çš„æ—¶å€™ï¼Œç¨‹åºä¼šè®¡ç®—éœ€è¦åˆ†é…æ­é…å“ªä¸ªé“¾è¡¨(æ•°ç»„çš„ä½ç½®)ï¼Œç„¶åä¼šåœ¨é“¾è¡¨é‡Œç”¨equalæ–¹æ³•å»æ‰¾entryä¸­æœ‰ç›¸åŒkeyçš„entry(é’ˆå¯¹getæ–¹æ³•è€Œè¨€)</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯å½“è°ƒç”¨putæ–¹æ³•æ—¶ï¼Œå¦‚æœæ‰¾åˆ°äº†åŒæ ·çš„keyï¼Œä¼šå°†valueè¿›è¡Œæ›¿æ¢ã€‚</p><p>é“¾è¡¨çš„åºå·(åœ¨æ•°ç»„ä¸­çš„ä½ç½®)ç”±ä»¥ä¸‹ä¸‰æ­¥æ¥ç”Ÿæˆï¼š</p><ul><li>å¾—åˆ°keyçš„å“ˆå¸Œå€¼</li><li>rehashå“ˆå¸Œå€¼ï¼Œæ¥é¿å…ä¸ä½³çš„å“ˆå¸Œå‡½æ•°æŠŠæ‰€æœ‰æ•°æ®éƒ½æ”¾åˆ°äº†ä¸€ä¸ªå•å‘é“¾è¡¨å½“ä¸­</li><li>ç”¨rehashçš„å“ˆå¸Œå€¼å’Œæ•°ç»„çš„å¤§å°åšä½æ©ç ï¼Œ </li></ul><pre><code>// the &quot;rehash&quot; function in JAVA 7 that takes the hashcode of the keystatic int hash(int h) {    h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12);    return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);}// the &quot;rehash&quot; function in JAVA 8 that directly takes the keystatic final int hash(Object key) {    int h;    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);    }// the function that returns the index from the rehashed hashstatic int indexFor(int h, int length) {    return h &amp; (length-1);}</code></pre><h2 id="1-2-è‡ªåŠ¨é‡ç½®å¤§å°"><a href="#1-2-è‡ªåŠ¨é‡ç½®å¤§å°" class="headerlink" title="1.2 è‡ªåŠ¨é‡ç½®å¤§å°"></a>1.2 è‡ªåŠ¨é‡ç½®å¤§å°</h2><p>åœ¨å¾—åˆ°åœ¨æ•°ç»„ä¸­çš„ä½ç½®ä»¥åï¼Œå‡è®¾è¦å¯»æ‰¾ä¸€ä¸ªkeyå€¼ï¼Œæˆ‘ä»¬éœ€è¦éå†æ•´ä¸ªå•å‘é“¾è¡¨ï¼Œæ¥æ‰¾åˆ°è¿™ä¸ªkeyå€¼ã€‚å¦‚æœarrayçš„sizeå›ºå®šçš„è¯ï¼Œå•ä¸ªé“¾è¡¨çš„å¤§å°å¯èƒ½ä¼šéå¸¸å¤§ï¼Œä¼šä½¿æ•´ä¸ªæŸ¥æ‰¾æ•ˆç‡å˜å¾—å¾ˆä½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªåŠ¨æ›´æ–°æ•´ä¸ªæ•°ç»„çš„å¤§å°æ¥ä¿è¯æŸ¥æ‰¾æ•ˆç‡ã€‚</p><p>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªHashMapçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰åˆå§‹æ•°ç»„çš„å¤§å°å’ŒåŠ è½½å‚æ•°(Load Factor).å¦‚æœä½ ä¸è‡ªè¡Œå®šä¹‰ï¼Œé‚£é»˜è®¤çš„æ•°ç»„å¤§å°æ˜¯16ï¼ŒåŠ è½½å‚æ•°æ˜¯0.75.</p><pre><code>public HashMap(int initialCapacity, float loadFactor)</code></pre><p>å½“ä½ è°ƒç”¨putæ–¹æ³•å°è¯•å¾€HashMapé‡ŒåŠ æ–°çš„entryçš„æ—¶å€™ï¼Œå‡½æ•°ä¼šæ£€æµ‹æ˜¯å¦éœ€è¦å»å¢åŠ æ•´ä¸ªæ•°ç»„çš„å¤§å°ã€‚HashMapä¼šå­˜å‚¨ä¸¤ä¸ªæ•°æ®ï¼š</p><ol><li>HashMapçš„å¤§å°ï¼šä»£è¡¨äº†HashMapä¸­çš„entryçš„æ•°é‡</li><li>Threshold = æ•°ç»„å½“ä¸‹çš„å¤§å° * load factor. </li></ol><p>å½“è°ƒç”¨putæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå…ˆæ£€æµ‹ç°åœ¨çš„æ•°ç»„çš„å¤§å°æ˜¯å¦è¶…è¿‡äº†å®šä¹‰çš„é˜ˆå€¼(Threshold)ï¼Œå¦‚æœè¶…è¿‡ï¼Œå°±ä¼šå°†å½“å‰æ•°ç»„çš„å¤§å°è¿›è¡ŒåŠ å€å¤„ç†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æ•°ç»„å¤§å°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå“ˆå¸Œå€¼å’Œæ•°ç»„å¤§å°å‡ä¸€çš„ä½æ“ä½œçš„å€¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´åŸå…ˆçš„entryä¼šæŒ‰ç…§ç°åœ¨çš„æ•°ç»„å¤§å°è¿›è¡Œé‡æ–°çš„åˆ†é…ï¼Œå°†ç°å­˜çš„æ‰€æœ‰entryåˆ†é…åˆ°ä¸åŒçš„bucketé‡Œé¢ã€‚</p><p>è¿™æ ·åšçš„ç›®çš„å°±æ˜¯å‡å°æ¯ä¸ªæ•°ç»„å…ƒç´ - å•å‘é“¾è¡¨çš„å¤§å°ï¼Œè®©put, remove, getæ“ä½œæ‰€éœ€è¦çš„æ—¶é—´åœ¨åˆç†çš„èŒƒå›´å†…ã€‚</p><p><img src="https://i.loli.net/2020/02/05/xk4JnhHSFTPupgQ.jpg" alt="fig2.jpg"></p><h1 id="2-çº¿ç¨‹å®‰å…¨ï¼Ÿ"><a href="#2-çº¿ç¨‹å®‰å…¨ï¼Ÿ" class="headerlink" title="2. çº¿ç¨‹å®‰å…¨ï¼Ÿ"></a>2. çº¿ç¨‹å®‰å…¨ï¼Ÿ</h1><p>HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ˜¯å› ä¸ºå‡è®¾ç°åœ¨åˆ°äº†è®¾çš„é˜ˆå€¼ï¼Œéœ€è¦è¿›è¡ŒHashMapå†…éƒ¨æ•°ç»„çš„resizeã€‚è¿™ä¸ªæ—¶å€™æ–°çš„entryå¯èƒ½æ˜¯ç”¨åŸå…ˆçš„å“ˆå¸Œå‡½æ•°æ¥åšbucketçš„åˆ†é…çš„ï¼Œè¿™æ ·å­å°±ä¼šé€ æˆæ•´ä¸ªæ•°æ®çš„ä¸åŒæ­¥ã€‚</p><h1 id="3-é”®å€¼çš„ä¸å¯å˜æ€§"><a href="#3-é”®å€¼çš„ä¸å¯å˜æ€§" class="headerlink" title="3. é”®å€¼çš„ä¸å¯å˜æ€§"></a>3. é”®å€¼çš„ä¸å¯å˜æ€§</h1><p>Stringå’ŒIntegeræ˜¯å¾ˆå¥½çš„é”®å€¼é€‰é¡¹ï¼Œå› ä¸ºä»–ä»¬æœ¬èº«å°±æ˜¯ä¸å¯å˜çš„ã€‚å¦‚æœä½ åˆ›å»ºè‡ªå·±çš„é”®å€¼ç±»ï¼Œè€Œä¸”è¿™ä¸ªé”®å€¼ç±»æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿè®¸å°±ä¼šåœ¨HashMapä¸­ä¸¢å¤±æ•°æ®ã€‚</p><p>å› ä¸ºæ—§å“ˆå¸Œå€¼æ˜¯è¢«å­˜å‚¨åœ¨Arrayä¸­çš„ï¼Œä½œä¸ºåˆ†é…åˆ°ç‰¹å®šbucketçš„åŸºå‡†ï¼Œä½ æ”¹å˜äº†é”®å€¼ï¼Œä¹Ÿå°±æ˜¯æ”¹å˜äº†ä¼ å…¥çš„å“ˆå¸Œå€¼ï¼Œè¿™æ—¶å€™è¿™æ˜¯å…¨æ–°çš„ä¸€æ¡æ•°æ®ï¼Œæ— æ³•å›åˆ°åŸæ¥çš„bucketï¼Œä¹Ÿæ— æ³•å¯¹å…¶è¿›è¡Œè¦†ç›–äº†ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="http://coding-geek.com/how-does-a-hashmap-work-in-java/" target="_blank" rel="noopener">Coding Geek</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> HashMap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Handling overload effectively with load balancers</title>
      <link href="/Handling-overload-effectively-with-load-balancers/"/>
      <url>/Handling-overload-effectively-with-load-balancers/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Fail-Smarter"><a href="#1-Fail-Smarter" class="headerlink" title="1. Fail Smarter"></a>1. Fail Smarter</h1><ul><li>Average latency has a spike, availability down</li><li>reasons <ul><li>dependencies </li><li>cascading effect </li><li>client change   peak </li></ul></li></ul><h1 id="2-Load-balancers"><a href="#2-Load-balancers" class="headerlink" title="2. Load balancers"></a>2. Load balancers</h1><ul><li>clients - load balancers - servers </li><li>hardware devices </li><li>multi tenant - use VIP - for efficiency </li><li>used for (features)<ul><li>scaling </li><li>even traffic distribution </li><li>overload protection</li></ul></li><li>how<ul><li>how to pick a server <ul><li>random dice </li><li>round robin </li><li>least conns </li></ul></li><li>desired algorithm - we use least conns <ul><li>simple </li><li>reliable </li><li>even </li></ul></li><li>max conns? </li><li>how to deal with overload? <ul><li>attributes <ul><li>cheap </li><li>local </li><li>buffering - having capacity soon </li><li>priority </li></ul></li><li>reject requests  - spillover - choose! <ul><li>close the TCP connection </li><li>no buffer </li></ul></li><li>hang on, wait in a queue - surge queue <ul><li>may mkes it take longer</li></ul></li></ul></li></ul></li><li>some default we set - maxConns - perhost setting <ul><li>littleâ€™s law <ul><li>arrival rate * time shopping = people in the store </li></ul></li><li>see load balancers how many services we have </li><li>fleet-wide concurrent requests / host count = <strong>avg conns</strong></li></ul></li></ul><ul><li>metrics matter <ul><li>latency netwrok latency + 25% <ul><li>client side </li><li>server side </li></ul></li><li>request rate </li></ul></li><li>coral server <ul><li>concurrent requests - outstanding request - in one host </li></ul></li><li>33% overhead room - dependency failures </li></ul><h1 id="3-Actual-behave"><a href="#3-Actual-behave" class="headerlink" title="3. Actual behave"></a>3. Actual behave</h1><ul><li>increase load to see average latency </li><li>run actual test </li><li>generate graph with outstanding requests <ul><li>see the cross of client timeout and p99 </li></ul></li></ul><h1 id="4-Abnormal-cases"><a href="#4-Abnormal-cases" class="headerlink" title="4. Abnormal cases"></a>4. Abnormal cases</h1><ul><li>dependency latency, timeout </li><li>network  packet loss </li></ul><ul><li>let server decide whatâ€™s the maxCon should be </li><li>coral has<ul><li>connection </li><li>worker  work thread </li></ul></li><li>classify requests <ul><li>importance <ul><li>droppable </li></ul></li><li>priority <ul><li>order  </li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Load Balancers </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Google Dagger Tutorial</title>
      <link href="/Google-Dagger-Tutorial/"/>
      <url>/Google-Dagger-Tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Comparisons"><a href="#1-Comparisons" class="headerlink" title="1. Comparisons"></a>1. Comparisons</h1><p>Spring is a giant collection of libraries and utilities. with a lot of integration, an XML configuration, runtime/ reflective bindings. Application already using Spring can use its dependency injection smoothly. </p><p>Dependency is only a small part of it. Guice and Dagger is lightweight and only a dependency injection framework</p><p>Dagger is very lightweight framework with very few integrations, java interface/ annotation configuration, and compile-time code generated bindings. </p><p>For dependency injection and IOC container, there is <a href="https://llchen60.com/IOC%E5%AE%B9%E5%99%A8%E5%92%8CDependency-Injection%E6%A8%A1%E5%BC%8F/" target="_blank" rel="noopener">a post in Chinese</a> wrote last year.</p><p>Also a big difference between those DI framework is when does the injection happen, compile time or runtime? </p><p>Run-time DI is <strong>based on reflection</strong> which is simpler to use but slower at run-time â€”- Spring, Guice </p><p>Compile-time DI is <strong>based on code generation</strong>. This means that all the heavy-weight operations are performed during compilation. It adds complexity but generally performs faster</p><h1 id="2-Implementation"><a href="#2-Implementation" class="headerlink" title="2. Implementation"></a>2. Implementation</h1><ul><li>POJO</li><li>Module<ul><li>a class provides or builds the objectsâ€™ dependencies </li></ul></li><li>Component<ul><li>an interface used to generate the injector </li></ul></li></ul><h2 id="2-1-POJO"><a href="#2-1-POJO" class="headerlink" title="2.1 POJO"></a>2.1 POJO</h2><pre><code>public class Car {    private Engine engine;    private Brand brand;    @Inject    public Car(Engine engine, Brand brand) {        this.engine = engine;        this.brand = brand;    }    // getters and setters}</code></pre><h2 id="2-2-Module"><a href="#2-2-Module" class="headerlink" title="2.2 Module"></a>2.2 Module</h2><pre><code>@Module // similar to @Controller  @Service public class VehiclesModule {    @Provides // similar to @Bean     public Engine provideEngine() {        return new Engine();    }    @Provides    @Singleton    public Brand provideBrand() {         return new Brand(&quot;lol&quot;);     }}</code></pre><h2 id="2-3-Component"><a href="#2-3-Component" class="headerlink" title="2.3 Component"></a>2.3 Component</h2><p>here we could return the real object we want to be the starting point of the whole mechanism:</p><p>Dagger will start from here, go through all the @Inject and satisfy those dependencies. In our example, will create engine and brand object. </p><pre><code>@Singleton@Component(modules = VehiclesModule.class)public interface VehiclesComponent {    Car buildCar();}</code></pre><h2 id="2-4-client-side"><a href="#2-4-client-side" class="headerlink" title="2.4 client side"></a>2.4 client side</h2><p>Notice: <code>DaggerVehiclesComponent</code> is created by dagger automatically. </p><pre><code>VehiclesComponent component = DaggerVehiclesComponent.create();Car eg = component.buildCar();</code></pre><h1 id="3-Dagger-User-Guide"><a href="#3-Dagger-User-Guide" class="headerlink" title="3. Dagger User Guide"></a>3. Dagger User Guide</h1><h2 id="3-1-Declaring-Dependencies"><a href="#3-1-Declaring-Dependencies" class="headerlink" title="3.1 Declaring Dependencies"></a>3.1 Declaring Dependencies</h2><p>Dagger constructs instances of application classes and satisfies their dependencies. It uses @Inject annotation to identify which constructors and fields it is interested in. </p><h2 id="3-2-Satisfying-Dependencies"><a href="#3-2-Satisfying-Dependencies" class="headerlink" title="3.2 Satisfying Dependencies"></a>3.2 Satisfying Dependencies</h2><p>By default, Dagger satisfies each dependency by constructing an instance of the requested type. It call <code>new SomeObject()</code> and setting its injectable fields. </p><ul><li>@Inject <ul><li>interfaces cannot be constructed </li><li>third party classes cannot be annotated </li><li>configurable objects must be configured </li></ul></li><li>Instead, use @provides <ul><li>all @provides methods should be named with a provide prefix and module classes are named with a Module suffix </li></ul></li></ul><h2 id="3-3-Building-the-Graph"><a href="#3-3-Building-the-Graph" class="headerlink" title="3.3 Building the Graph"></a>3.3 Building the Graph</h2><p>The @Inject and @Provides annotated classes form a graph of objects, linked by their dependencies. Build the application by <strong>an interface with methods that have no arguments and return the desired type</strong>. </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://stackoverflow.com/questions/39688830/why-use-develop-guice-when-you-have-spring-and-dagger" target="_blank" rel="noopener">https://stackoverflow.com/questions/39688830/why-use-develop-guice-when-you-have-spring-and-dagger</a></li><li><a href="https://www.baeldung.com/dagger-2" target="_blank" rel="noopener">https://www.baeldung.com/dagger-2</a></li><li><a href="https://rskupnik.github.io/dependency-injection-in-pet-project-dagger2" target="_blank" rel="noopener">https://rskupnik.github.io/dependency-injection-in-pet-project-dagger2</a></li><li><a href="https://dagger.dev/" target="_blank" rel="noopener">https://dagger.dev/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Dagger </tag>
            
            <tag> DI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Executor, ExecutorService and Executors</title>
      <link href="/Executor-ExecutorService-and-Executors/"/>
      <url>/Executor-ExecutorService-and-Executors/</url>
      
        <content type="html"><![CDATA[<p>Executor, ExecutorService and Executors, they are all part of Javaâ€™s Executor framework, this framework offers a threadpool. Thus we donâ€™t need to manage threads on our own, the pool can help us manage themselves. </p><p>A thread pool which is created when an application is a startup solves both of these problems. It has <strong>ready threads</strong> to serve clients when needed and it also has a bound on how many threads to create under load.</p><h1 id="1-Executor"><a href="#1-Executor" class="headerlink" title="1. Executor"></a>1. Executor</h1><p><strong>the core interface</strong> which is an abstraction for parallel execution</p><p>It separates task from execution, this is different from java.lang.Thread class which <strong>combines both task and its execution</strong>. </p><h1 id="2-ExecutorService"><a href="#2-ExecutorService" class="headerlink" title="2. ExecutorService"></a>2. ExecutorService</h1><p>ExecutorService is an extension of Executor interface and provides a facility for returning a Future object and terminate, or shut down the thread pool. Once the shutdown is called, the thread pool will not accept new task but complete any pending task. It also provides a submit() method which extends Executor.execute() method and returns a Future.</p><p>The Future object provides the facility of asynchronous execution, which means you donâ€™t need to wait until the execution finishes, you can just submit the task and go around, come back and check if Future object has the result, if execution is completed then it would have result which you can access by using the Future.get() method. Just remember that this method is a <strong>blocking method</strong> i.e. it will wait until execution finish and the result is available if itâ€™s not finished already.</p><p>By using the Future object returned by ExecutorService.submit() method, you can also cancel the execution if you are not interested anymore. It provides cancel() method to cancel any pending execution.</p><h1 id="3-Executors"><a href="#3-Executors" class="headerlink" title="3. Executors"></a>3. Executors</h1><p>Third one Executors is a utility class similar to Collections, which provides <strong>factory methods</strong> to create different types of thread pools e.g. fixed and cached thread pools. Letâ€™s see some more difference between these three classes.</p><h1 id="4-Difference"><a href="#4-Difference" class="headerlink" title="4. Difference"></a>4. Difference</h1><p>1) One of the key difference between Executor and ExecutorService interface is that <strong>former is a parent interface while ExecutorService extends Executor</strong> i.e. itâ€™s a sub-interface of Executor.</p><p>2) Another important difference between ExecutorService and Executor is that Executor defines execute() method which accepts an object of the Runnable interface, while submit() method can accept objects of both Runnable and Callable interfaces.</p><p>3) The third difference between Executor and ExecutorService interface is that execute() method doesnâ€™t return any result, its return type is void but submit() method returns the result of computation via a Future object. This is also the key difference between submit() and execute() method, which is one of the frequently asked Java concurrency interview questions.</p><p>4) The fourth difference between ExecutorService and Executor interface is that apart from allowing a client to submit a task, <strong>ExecutorService also provides methods to control the thread pool</strong> e.g. terminate the thread pool by calling the shutDown() method. You should also read â€œJava Concurrency in Practiceâ€ to learn more about the graceful shutdown of a thread-pool and how to handle pending tasks.</p><p>5) Executors class provides factory methods to create different kinds of thread pools e.g. newSingleThreadExecutor() creates a thread pool of just one thread, newFixedThreadPool(int numOfThreads) creates a thread pool of fixed number of threads and newCachedThreadPool() creates new threads when needed but reuse the existing threads if they are available.</p><h1 id="5-Differences-between-Executor-and-Thread"><a href="#5-Differences-between-Executor-and-Thread" class="headerlink" title="5. Differences between Executor and Thread"></a>5. Differences between Executor and Thread</h1><ol><li>Executor provides a thread pool in java, while Thread not. </li><li>java.lang.Thread is a class in Java while java.util.concurrent.Executor is an interface.</li><li>The Executor concept is actually an abstraction over parallel computation. It allows concurrent code to be run in managed way. On the other hand, Thread is a concrete way to run the code in parallel.</li><li>Executor decouples a task (the code which needs to be executed in parallel) from execution, while in the case of a Thread, both task and execution are tightly coupled.</li><li>The Executor concept allows your task is to be executed by a worker thread from the thread pool, while Thread itself execute your task</li><li>a Thread can only execute one Runnable task but an Executor can execute any number of Runnable task.</li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EnumMap vs HashMap</title>
      <link href="/EnumMap-vs-HashMap/"/>
      <url>/EnumMap-vs-HashMap/</url>
      
        <content type="html"><![CDATA[<h1 id="1-EnumMap"><a href="#1-EnumMap" class="headerlink" title="1. EnumMap"></a>1. EnumMap</h1><ul><li>Can only be used with <strong>enum type</strong> keys </li><li>Itâ€™s specialized implementation of Map Interface for use with enum type keys</li><li>Internally using <strong>arrays</strong> </li><li>stored in <strong>natural order</strong></li><li>not possible for collision </li><li>much efficient compared with HashMap </li></ul><h1 id="2-HashMap"><a href="#2-HashMap" class="headerlink" title="2. HashMap"></a>2. HashMap</h1><ul><li>Extends AbstrctMap and implement Map interface </li><li>Internally using hashTable</li><li>Possible for collision </li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.geeksforgeeks.org/enummap-class-java-example/" target="_blank" rel="noopener">https://www.geeksforgeeks.org/enummap-class-java-example/</a> </li><li><a href="https://walkingtechie.blogspot.com/2017/03/difference-between-enummap-and-hashmap.html" target="_blank" rel="noopener">https://walkingtechie.blogspot.com/2017/03/difference-between-enummap-and-hashmap.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Effective Java</title>
      <link href="/Effective-Java/"/>
      <url>/Effective-Java/</url>
      
        <content type="html"><![CDATA[<h1 id="1-General-Programming"><a href="#1-General-Programming" class="headerlink" title="1. General Programming"></a>1. General Programming</h1><h2 id="1-1-Scope-of-Local-variables"><a href="#1-1-Scope-of-Local-variables" class="headerlink" title="1.1 Scope of Local variables"></a>1.1 Scope of Local variables</h2><pre><code>for (Iterator&lt;Element&gt; i = c.iterator(); i.hasNext(); ) {    Element e = i.next();    ... // Do something with e and i}// code with bugIterator&lt;Element&gt; i2 = c2.iterator();while (i.hasNext()) {    Element e2 = i2.next();    ... // Do something with e2 and i2}</code></pre><p>i - i2. causing a runtime bug. This bug can be caught at compile time if you <strong>use local variable with minimal scope</strong>. </p><ol><li>Declare the scope of a local variable where it is first used </li><li>initialize every local variable</li><li>prefer for loops to while loops </li><li>keep methods small and focused on a single task </li></ol><h2 id="1-2-Use-library"><a href="#1-2-Use-library" class="headerlink" title="1.2 Use library"></a>1.2 Use library</h2><p>Use library will give you some advantages:</p><ul><li>The knowledge of experts who implemented it and the experience of others who used it before you. </li><li>Better performance that is implemented by experts.</li><li>New features that are added to the libraries in every major release. </li></ul><h2 id="1-3-Float-Double-and-Exact-Calculations"><a href="#1-3-Float-Double-and-Exact-Calculations" class="headerlink" title="1.3 Float, Double and Exact Calculations"></a>1.3 Float, Double and Exact Calculations</h2><pre><code>int getPossibleBoughtItems() {    double dollarFunds = 1.0;    int numItems = 0;    for (double price = 0.10; dollarFunds &gt;= price; price += 0.10) {        dollarFunds -= price;        numItems++;    }    return numItems;}</code></pre><p>We should use BigDecimal, int or long for exact calculations. We should avoid using float and double for exact calculations because they are carefully designed for accurate approximations in scientific and engineering calculations. </p><p>Note that the first method above will return 3, which is wrong, with funds left of $0.3999999999999999. The correct return should be 4, with funds left 0 (see the second implementation).</p><h2 id="1-4-Primitive-Types-and-Boxed-Primitives"><a href="#1-4-Primitive-Types-and-Boxed-Primitives" class="headerlink" title="1.4 Primitive Types and Boxed Primitives"></a>1.4 Primitive Types and Boxed Primitives</h2><p>When possible, you should use primitives, instead of boxed primitives, because: </p><ol><li>Unnecessary use of boxed primitives may result in a hideously slow program because of repeated boxed and unboxed operations. </li><li>whenboxes primitives are used, applying <code>==</code> operator is almost always wrong and can lead to deadly bugs that are difficult to discover. </li></ol><h2 id="1-5-Use-of-Strings-and-Other-Types"><a href="#1-5-Use-of-Strings-and-Other-Types" class="headerlink" title="1.5 Use of Strings and Other Types"></a>1.5 Use of Strings and Other Types</h2><pre><code>// goodpublic final class ThreadLocal&lt;T&gt; {    public ThreadLocal() {};    public void set (T value) {...};    public T get() {...};}// not good public final class ThreadLocal {    private ThreadLocal() {};    public static void set (String key, Object value) {...};    public static Object get(String key) {...};}</code></pre><p>We should avoid using String, because it is poor substitutes for other value types, or aggregate types, or capacity types. It is cumbersome, slower, error-prone and inflexible than other types. </p><h2 id="1-6-String-Builder-and-String-Concatenation"><a href="#1-6-String-Builder-and-String-Concatenation" class="headerlink" title="1.6 String Builder and String Concatenation"></a>1.6 String Builder and String Concatenation</h2><p>Use String Builder instead of String Concatenation, due to its poor performance. </p><pre><code>// Good public String firstNamesToString(List&lt;Person&gt; members) {    StringBuilder sb = new StringBuilder();    for (Person p : members) {        sb.append(&quot;[&quot;);        sb.append(p.firstName);        sb.append(&quot;]&quot;);    }    return sb.toString();}// Bad public String firstNamesToString(List&lt;Person&gt; members) {    String s = &quot;&quot;;    for (Person p : members) {        s += &quot;[&quot; + p.firstName + &quot;]&quot;;    }    return s;}</code></pre><h2 id="1-7-Interface-and-Class-reference"><a href="#1-7-Interface-and-Class-reference" class="headerlink" title="1.7 Interface and Class reference"></a>1.7 Interface and Class reference</h2><p>Use of interface reference </p><pre><code>public List&lt;Person&gt; getPeopleByFirstName(List&lt;Person&gt; members, String firstName) {}</code></pre><p>It would be desirable, more flexible and more backward-compatible to use interface types to refer to parameters, return values, variables and fields if appropriate interface types exist. If appropriate interface types do not exist, use least specific class types to refer to parameters, return values, variables and fields if appropriate interface types do not exist. </p><h1 id="2-Objects"><a href="#2-Objects" class="headerlink" title="2. Objects"></a>2. Objects</h1><h2 id="2-1-Static-Factory-Methods-and-Constructors"><a href="#2-1-Static-Factory-Methods-and-Constructors" class="headerlink" title="2.1 Static Factory Methods and Constructors"></a>2.1 Static Factory Methods and Constructors</h2><p>You are designing a class such as Date and you want to allow a client to obtain an instance of the class, given some input such as instant.</p><p>We should use static factory methods because Factory method has following advantages: </p><ol><li>have names </li><li>not required to create a new object each time invoked </li><li>can return an object of any subtype of their return type </li><li>decouple service provider frameworks </li></ol><h2 id="2-2-Builders-and-Constructors"><a href="#2-2-Builders-and-Constructors" class="headerlink" title="2.2 Builders and Constructors"></a>2.2 Builders and Constructors</h2><p>Use builders since it makes code easier for reading</p><h2 id="2-3-Singleton"><a href="#2-3-Singleton" class="headerlink" title="2.3 Singleton"></a>2.3 Singleton</h2><h3 id="2-3-1-Use-of-enum"><a href="#2-3-1-Use-of-enum" class="headerlink" title="2.3.1 Use of enum"></a>2.3.1 Use of enum</h3><pre><code>public enum MySingleton {    INSTANCE;    public void getDataByMarketplaceId(MarketplaceId id) { ... }}</code></pre><h3 id="2-3-2-Use-of-static-factory"><a href="#2-3-2-Use-of-static-factory" class="headerlink" title="2.3.2 Use of static factory"></a>2.3.2 Use of static factory</h3><pre><code>public class MySingleton {    private static final MySingleton INSTANCE = new MySingleton();    private MySingleton() { ... }    public static MySingleton getInstance() { return INSTANCE; }    public void getDataByMarketplaceId(MarketplaceId id) { ... }}</code></pre><h2 id="2-4-Reusable-Objects"><a href="#2-4-Reusable-Objects" class="headerlink" title="2.4 Reusable Objects"></a>2.4 Reusable Objects</h2><pre><code>public class RomanNumber {    private static Pattern ROMAN = Pattern.compile(&quot;^(?=.)M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$&quot;);    static boolean isRomanNumber(String s) {        return ROMAN.matcher(s).matches();    }}</code></pre><p>Reuse the expensive objects(here is Pattern), in performace critical situations. </p><h1 id="3-Classes"><a href="#3-Classes" class="headerlink" title="3. Classes"></a>3. Classes</h1><h2 id="3-1-Accessibility-of-Classes-and-Members"><a href="#3-1-Accessibility-of-Classes-and-Members" class="headerlink" title="3.1 Accessibility of Classes and Members"></a>3.1 Accessibility of Classes and Members</h2><p>Avoid using a public array because a nonzero length array is always mutable, and thus clients will be able to modify the elements of the array. </p><h2 id="3-2-Mutability"><a href="#3-2-Mutability" class="headerlink" title="3.2 Mutability"></a>3.2 Mutability</h2><p>In general, classes should be immutable unless thereâ€™s a very good reason to make them mutable; and if so, you should minimize mutability when designing and implementing classes. Rules to make a class immutable: </p><ol><li>Donâ€™t provide methods that modify the state of objects that you want to be immutable. </li><li>Ensure that the class cannâ€™t be extended.</li><li>Make all fields final to express your intent clearly</li><li>Make all fields private to prevent clients from obtaining access to mutable objects </li><li>Ensure exclusive access to any mutable components</li></ol><p>Try to use more immutability, since it offers benefits byu nature: </p><ol><li>Immutable objects are simple: providing failure atomicity </li><li>Inherently thread-safe, require no synchronization </li><li>Can share immutable objects freely</li><li>Immutable objects make great building blocks for other objects. </li></ol><h2 id="3-3-Interfaces-and-Abstract-Classes"><a href="#3-3-Interfaces-and-Abstract-Classes" class="headerlink" title="3.3 Interfaces and Abstract Classes"></a>3.3 Interfaces and Abstract Classes</h2><p>In general, use of interfaces is the best way to define a type that permits multiple implementations because a class can implement multiple interfaces whereas it cannot extend multiple abstract classes. </p><h2 id="3-4-Static-Member-Classes"><a href="#3-4-Static-Member-Classes" class="headerlink" title="3.4 Static Member Classes"></a>3.4 Static Member Classes</h2><pre><code>public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, Serializable {    ...    static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {        final int hash;        final K key;        V value;        Node&lt;K,V&gt; next;        ...        public final K getKey()        { return key; }        public final V getValue()      { return value; }        ...    }}</code></pre><p>A nested class is a class defined within another class, the former should exist only to serve the latter. If you declare a member class that doesnâ€™t require access to its enclosing instance then always put static modifier in its declaration. </p><p>If you omit this modifier then each instance will have a hidden extraneous reference to its enclosing instance, and storing this reference takes time and space. More seriously, it can result in the enclosing instance being retained when it would be otherwise be eligible for garbage collection, causing catastrophic memory leak.</p><h1 id="4-Methods-and-Generics"><a href="#4-Methods-and-Generics" class="headerlink" title="4. Methods and Generics"></a>4. Methods and Generics</h1><h2 id="4-1-Empty-and-Null-returns"><a href="#4-1-Empty-and-Null-returns" class="headerlink" title="4.1 Empty and Null returns"></a>4.1 Empty and Null returns</h2><p>Never return null in place of an empty array or collection because it will require clients to check null return for all method calls, ugly!</p><h2 id="4-2-Optional-Returns"><a href="#4-2-Optional-Returns" class="headerlink" title="4.2 Optional Returns"></a>4.2 Optional Returns</h2><pre><code>public static &lt;E extends Comparable&lt;E&gt;&gt; Optional&lt;E&gt; max(Collection&lt;E&gt; c) {    if (c.isEmpty()) {        return Optional.empty();    }    E result = null;    for (E e : c) {        if (result == null || e.compareTo(result) &gt; 0) {            result = Objects.requireNonNull(e);        }    }    return Optional.of(result);}</code></pre><p>Since Java 8, an Optional-returning method is possible, more flexible, and easier to use than one that throws an exception; it is also less error-prone than one that returns  null . Here are some best practices when using   Optional :</p><ul><li>Never return a null value from an optinal-returning method because doing so defeats the entire purpose of the facility.</li><li>Use helpers provided by the facility</li></ul><pre><code> String lastWordInLexicon = max(words).orElse(&quot;No words...&quot;); ,   Toy myToy = max(toys).orElseThrow(ToyException::new); </code></pre><ul><li>Container types, including collections, maps, streams, arrays, and optionals, should not be wrapped in optionals, because they have already provided facility to handle empty values.</li><li>Never return an optional of a boxed primitive type, with possible exception of  Boolean ,  Byte ,   Character ,  Short ,  Float . For other boxed primitive types, use  OptionalInt ,   OptionalLong ,  OptionalDouble  instead.</li></ul><h2 id="4-3-Generics-and-Unchecked-Warnings"><a href="#4-3-Generics-and-Unchecked-Warnings" class="headerlink" title="4.3 Generics and Unchecked Warnings"></a>4.3 Generics and Unchecked Warnings</h2><pre><code>public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;        implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable {    ...    public &lt;T&gt; T[] toArray(T[] a) {        if (a.length &lt; size) {            @SuppressWarnings(&quot;unchecked&quot;) T[] result = (T[]) Arrays.copyOf(elementData, size, a.getClass());            return result;        }        System.arraycopy(elementData, 0, a, 0, size);        if (a.length &gt; size) {            a[size] = null;        }        return a;    }    ...} </code></pre><p>Unchecked warnings are important; donâ€™t ignore them because every unchecked warning has the potential to throw a   ClassCastException  at runtime. You should do your best to eliminate as many of them as possible. If you canâ€™t, however, get rid of an unchecked warning, but you can prove that the code that provoke it is typesafe then suppress it with the corresponding annotation in the <strong>narrowest possible scope</strong>.</p><p>@SupressWarning: An anotation to surpress compile warnings about unchecked generic operations. </p><h2 id="4-4-Generics-and-Wildcards"><a href="#4-4-Generics-and-Wildcards" class="headerlink" title="4.4 Generics and Wildcards"></a>4.4 Generics and Wildcards</h2><pre><code>public class Stack&lt;E&gt; {    ...    public Stack() { ... }    public void push(E e) { ... }    public E pop() { ... }    public boolean isEmpty { ... }    public void pushAll(Iterable&lt;? extends E&gt; src) {        for (E e : src) {            push(e);        }    }    public void popAll(Collection&lt;? super E&gt; dst) {        while (!isEmpty()) {            dst.add(pop());        }    }}</code></pre><p>It is clear that for maximum flexibility you should use wildcard types on input parameters that represent producers or consumers.</p><ul><li>Remember PECS, which stands for <strong>Producer-Extends and Consumer-Super</strong>. Note that  Comparable  and   Comparator  are always consumers.</li></ul><h1 id="5-Exceptions"><a href="#5-Exceptions" class="headerlink" title="5. Exceptions"></a>5. Exceptions</h1><h2 id="5-1-Checked-Exceptions-and-Unchecked-Exceptions"><a href="#5-1-Checked-Exceptions-and-Unchecked-Exceptions" class="headerlink" title="5.1 Checked Exceptions and Unchecked Exceptions"></a>5.1 Checked Exceptions and Unchecked Exceptions</h2><pre><code>/** * Returns MarketplaceInfo of a given marketplace. * @throws NotFoundException if marketplaceId is not found; do not retry. * @throws ServiceUnavailableException if MarketplaceService does not respond after 3 retries. */public MarketplaceInfo getMarketplaceInfoById(MarketplaceId marketplaceId) {    try {        return getMarketplaceInfoByIdFromLocalCache(marketplaceId);    } catch (IOException e) {        try {            MarketplaceInfo info = getMarketplaceInfoByIdFromRemoteCache(marketplaceId);            putMarketplaceInfoToLocalCache(marketplaceId, info);            return info;        } catch (IOException e) {            for (int numRetries = 0; numRetries &lt; 3; numRetries++) {                try {                    // Call dependent service to get marketplace info                    MarketplaceInfo info = marketplaceService.getMarketplaceInfoById(marketplaceId);                    putMarketplaceInfoToLocalCache(marketplaceId, info);                    putMarketplaceInfoToRemoteCache(marketplaceId, info);                                    return info;                } catch (ServiceUnavailableException e) {                    sleep(5); // sleep 5 seconds before retry                } catch (NotFoundException e) {                    LOG.error(&quot;Unable to get marketplace info because marketplace id {} is not found.&quot;, marketplaceId);                    throw e;                }            }            throw new ServiceUnavailableException(&quot;Unable to get marketplace info after 3 retries.&quot;);        }    }}</code></pre><p>We should: </p><ul><li>throw checked exceptions, a subclass of Exception <ul><li>for recoverable conditions</li></ul></li><li>throw unchecked exceptions, a subclass of runtimeException <ul><li>for programming errors </li></ul></li></ul><p>When in doubt, throw unchecked exceptions. When throwing checked exceptions, add methods to aid in recovery for clients. </p><p>You should declare checked exceptions individually and document precisely the conditions under which each exception is thrown, by using Javadoc  @throws  tag. If the same exception is thrown by many methods in a class for the same reason then you can document it in the classâ€™s documentation comment. In addition, it is particularly important to document unchecked exceptions of methods in interfaces they may throw</p><h2 id="5-2-Exception-Implementation"><a href="#5-2-Exception-Implementation" class="headerlink" title="5.2 Exception Implementation"></a>5.2 Exception Implementation</h2><ul><li>Provide detail as much as possible</li><li>detail msg should contain the values of all parameters and fields that have contributed to the exception </li><li>No sensitive information contained </li></ul><h1 id="6-Lambdas-and-Streams"><a href="#6-Lambdas-and-Streams" class="headerlink" title="6. Lambdas and Streams"></a>6. Lambdas and Streams</h1><h2 id="6-1-Method-references"><a href="#6-1-Method-references" class="headerlink" title="6.1 Method references"></a>6.1 Method references</h2><ul><li><code>Integer::parseInt</code> -&gt; a static method reference for <code>str -&gt; Integer.parseInt(str)</code></li><li><code>Instant.now()::isAfter</code> -&gt; a bound method reference for <code>Instance i = Instant.now(); t -&gt; i.isAfter(t)</code></li><li><code>String::toLowerCase</code> -&gt; an unbound method reference for <code>str -&gt; str.toLowerCase()</code></li><li><code>TreeMap&lt;K, V&gt;::new</code> -&gt; A class constructor for <code>() -&gt; new TreeMap&lt;K, V&gt;</code></li></ul><h1 id="7-Concurrency"><a href="#7-Concurrency" class="headerlink" title="7. Concurrency"></a>7. Concurrency</h1><h2 id="7-1-Synchronize-Access-to-Sharable-Mutable-Data"><a href="#7-1-Synchronize-Access-to-Sharable-Mutable-Data" class="headerlink" title="7.1 Synchronize Access to Sharable Mutable Data"></a>7.1 Synchronize Access to Sharable Mutable Data</h2><p>When multiple threads share mutable data, each thread that reads or writes the data must <strong>perform synchronization</strong>, otherwise there is no guarantee that one threadâ€™s changes of the data will be visible to other threads, and therefore may cause liveness and safety failures. These failures are among the most difficult to debug.<br><code>var ++</code><br>It performs two operations on var : (1) it reads the value, (2) it writes back a new value that is equal to the old value plus one. If a second thread reads the field between the time the first thread reads the old value and writes back the new one, then both threads will see the same value and thus return the same serial number, OUCH; this is a safety failure.</p><p>Note that the best way to avoid safety failure is <strong>not to share mutable data</strong>, meaning share only immutable data or donâ€™t share at all â€” confine mutable data to a single thread. If you adopt this policy then you should document it carefully, so that the policy is maintained as your program evolves. It is also crucial to have a deep understanding of the frameworks and libraries youâ€™re using because they may introduce threads that you are unaware of.</p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cost of abstraction</title>
      <link href="/Cost-of-abstraction/"/>
      <url>/Cost-of-abstraction/</url>
      
        <content type="html"><![CDATA[<p>Duplicate is definitely something we are trying to get rid of, however, whatâ€™s the cost of abstraction? It seems some problem we could think for a while. </p><p>We should think of the tradeoff between code duplication and increased level of abstraction. </p><h1 id="1-Definition-cost-of-abstraction"><a href="#1-Definition-cost-of-abstraction" class="headerlink" title="1. Definition - cost of abstraction"></a>1. Definition - cost of abstraction</h1><ul><li>An abstraction is adding to the cognitive load of whoever works with the code </li><li>The main cost of abstraction: separating the implementation from the specification. Or we say separate the letter of function from the spirit of the function</li><li>The former being what the function does, the latter being what everybody believes it should do </li><li>Should involve everybody to consider what the code does, or we say what the function does </li></ul><h1 id="2-Thought"><a href="#2-Thought" class="headerlink" title="2. Thought"></a>2. Thought</h1><ul><li>The decision about creating an abstraction should not be taken lightly.</li><li>Thereâ€™s a large social cost to every abstraction, may lead the project to be unmaintainable.</li><li>lambda is also a way to reduce the abstraction layers in some way </li><li>Abstraction is a good way to get rid of verbose code, but itself may bring uncertainty to some extent. Only implement <strong><em>necessary</em></strong> abstraction. </li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CacheLoader æ•™ç¨‹</title>
      <link href="/CacheLoader-%E6%95%99%E7%A8%8B/"/>
      <url>/CacheLoader-%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-LoadingCache"><a href="#1-LoadingCache" class="headerlink" title="1. LoadingCache"></a>1. LoadingCache</h1><p>LoadingCacheæ˜¯æŒ‡ç”¨CacheLoaderå»ºç«‹çš„ç¼“å­˜ã€‚æƒ³è¦ä½¿ç”¨LoadingCacheçš„è¯ï¼Œå°±æ˜¯ä½¿ç”¨æ–¹æ³•<code>get(K)</code>ã€‚å¦‚æœä¸åœ¨LoadingCacheé‡Œé¢çš„è¯ï¼Œå°±ä¼šä½¿ç”¨CacheLoaderåšä¸€æ¬¡åŠ è½½ï¼›å¦‚æœæœ‰çš„è¯å°±ç›´æ¥æ‹¿å›ç»“æœäº†ã€‚</p><h1 id="2-ä½¿ç”¨CacheLoaderä»¥åŠLoadingCache"><a href="#2-ä½¿ç”¨CacheLoaderä»¥åŠLoadingCache" class="headerlink" title="2. ä½¿ç”¨CacheLoaderä»¥åŠLoadingCache"></a>2. ä½¿ç”¨CacheLoaderä»¥åŠLoadingCache</h1><pre><code>LoadingCache&lt;String, String&gt; loadingCache = CacheBuilder.newBuilder()    .build(new CacheLoader&lt;String, String&gt;() {        @Override        public String load(final String s) throws Exception {            return response;        }    });</code></pre><ul><li>CacheLoaderåœ¨ä½¿ç”¨newBuilder()åˆ›é€ æ–°å®ä¾‹çš„æ—¶å€™è¿˜å¯ä»¥åšå¾ˆå¤šçš„è®¾ç½®ï¼Œæ¯”å¦‚<ul><li><code>expireAfterAccess(long duration, TimeUnit unit)</code><ul><li>åœ¨æ¯ä¸ªentryè¢«åˆ›å»ºä»¥åï¼Œç»è¿‡ä¸€æ®µå›ºå®šçš„æ—¶é—´åšè‡ªåŠ¨ç§»é™¤æ“ä½œ</li></ul></li><li><code>maximumSize(long size)</code><ul><li>å®šä¹‰cacheèƒ½æœ‰çš„æœ€å¤§entryæ•°é‡ </li></ul></li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.baeldung.com/guava-cacheloader" target="_blank" rel="noopener">https://www.baeldung.com/guava-cacheloader</a> </li><li><a href="https://stackoverflow.com/questions/43993731/what-is-a-loadingcache" target="_blank" rel="noopener">https://stackoverflow.com/questions/43993731/what-is-a-loadingcache</a></li><li><a href="https://guava.dev/releases/21.0/api/docs/com/google/common/cache/LoadingCache.html" target="_blank" rel="noopener">https://guava.dev/releases/21.0/api/docs/com/google/common/cache/LoadingCache.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Cache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache-Ant</title>
      <link href="/Apache-Ant/"/>
      <url>/Apache-Ant/</url>
      
        <content type="html"><![CDATA[<p>Apache Ant is a Java-based build tool. A java library and command line tool, which aims to drive processes described in build files as targets and extension points dependent upon each other. </p><p>Main usage: build java applications. It can pilot any type of processes which can be described <strong>in terms of targets and tasks.</strong></p><h1 id="1-Writing-a-Simple-BuildFile"><a href="#1-Writing-a-Simple-BuildFile" class="headerlink" title="1. Writing a Simple BuildFile"></a>1. Writing a Simple BuildFile</h1><h2 id="1-1-Intro"><a href="#1-1-Intro" class="headerlink" title="1.1 Intro"></a>1.1 Intro</h2><p>Antâ€™s buildfile are written in XML. Each buildfile contains one project and as least one target. Targets contain task elements. Each task element of the build file can have an id attribute and can later be referred to by the value supplied to this. </p><p>The structure comes to be: </p><ul><li>project </li><li>target<ul><li>task elements<ul><li>id attribute </li></ul></li></ul></li></ul><h2 id="1-2-Projects"><a href="#1-2-Projects" class="headerlink" title="1.2 Projects"></a>1.2 Projects</h2><p>A project has three attributes: </p><ul><li>name <ul><li>the name of project</li></ul></li><li>default<ul><li>the default target to use when no target is supplied </li></ul></li><li>basedir<ul><li>the base directory from which all path calculations are done. A relative path is resolved relative to the directory containing the buildfile. </li><li>defaults to the parent directory of the buildfile </li></ul></li></ul><h2 id="1-3-Targets"><a href="#1-3-Targets" class="headerlink" title="1.3 Targets"></a>1.3 <a href="https://ant.apache.org/manual/targets.html" target="_blank" rel="noopener">Targets</a></h2><p>Itâ€™s a container of tasks that cooperate to reach a desired state during the build process. </p><p>A target can depend on other targets. **You might have a target for compiling, for example, and a target for creating a distributable. You can only build a distributable when you have compiled first, so the â€œdistributeâ€ target depends on the â€œcompileâ€ target. Ant resolves these dependencies</p><pre><code>&lt;target name=&quot;A&quot;/&gt;&lt;target name=&quot;B&quot; depends=&quot;A&quot;/&gt;&lt;target name=&quot;C&quot; depends=&quot;B&quot;/&gt;&lt;target name=&quot;D&quot; depends=&quot;C,B,A&quot;/&gt;</code></pre><p>Suppose we want to execute target D. From its depends attribute, you might think that first target C, then B and then A is executed. Wrong! C depends on B, and B depends on A, so first A is executed, then B, then C, and finally D.</p><p>A target also has the ability to perform its execution if(or unless) a property has been set. </p><pre><code>&lt;target name=&quot;myTarget&quot; depends=&quot;myTarget.check&quot; if=&quot;myTarget.run&quot;&gt;    &lt;echo&gt;Files foo.txt and bar.txt are present.&lt;/echo&gt;&lt;/target&gt;&lt;target name=&quot;myTarget.check&quot;&gt;    &lt;condition property=&quot;myTarget.run&quot;&gt;        &lt;and&gt;            &lt;available file=&quot;foo.txt&quot;/&gt;            &lt;available file=&quot;bar.txt&quot;/&gt;        &lt;/and&gt;    &lt;/condition&gt;&lt;/target&gt;</code></pre><h2 id="1-4-Tasks"><a href="#1-4-Tasks" class="headerlink" title="1.4 Tasks"></a>1.4 Tasks</h2><h3 id="1-4-1-Intro"><a href="#1-4-1-Intro" class="headerlink" title="1.4.1 Intro"></a>1.4.1 Intro</h3><p>Task is a piece of code that can be executed. </p><p>A task can have multiple attributes. The value of an attribute might contain reference to a property. These references will be resolved before the task is executed. </p><p>Task has a common structure: </p><pre><code>&lt;name attribute1=&quot;value1&quot; attribute2=&quot;value2&quot; ... /&gt;</code></pre><p>where name is the name of the task, attributeN is the attribute name, and valueN is the value for this attribute.</p><p>All tasks can have a name attribute, which will be used in the logging messages generated by Ant. </p><h3 id="1-4-2-Built-in-tasks"><a href="#1-4-2-Built-in-tasks" class="headerlink" title="1.4.2 Built-in tasks"></a>1.4.2 Built-in tasks</h3><p><a href="https://ant.apache.org/manual/tasklist.html" target="_blank" rel="noopener">https://ant.apache.org/manual/tasklist.html</a> </p><h3 id="1-4-3-Write-your-own-tasks"><a href="#1-4-3-Write-your-own-tasks" class="headerlink" title="1.4.3 Write your own tasks"></a>1.4.3 Write your own tasks</h3><p><a href="https://ant.apache.org/manual/develop.html#writingowntask" target="_blank" rel="noopener">https://ant.apache.org/manual/develop.html#writingowntask</a></p><h2 id="1-5-Properties"><a href="#1-5-Properties" class="headerlink" title="1.5 Properties"></a>1.5 <a href="https://ant.apache.org/manual/properties.html#if+unless" target="_blank" rel="noopener">Properties</a></h2><p>Properties are an important way to customize a build process or to just provide shortcuts for strings that are used repeatedly inside a buildfile.</p><p>In its most simple form properties are defined in the buildfile (for example by the property task) or might be set outside Ant. <strong>A property has a name and a value</strong>; the name is case-sensitive. Properties may be used in the value of task attributes or in the nested text of tasks that support them. This is done by <strong>placing the property name between â€œ${â€œ and â€œ}â€ in the attribute value</strong>. For example, if there is a builddir property with the value â€œbuildâ€, then this could be used in an attribute like this: ${builddir}/classes. This is resolved at run-time as build/classes.</p><pre><code>&lt;project name=&quot;MyProject&quot; default=&quot;dist&quot; basedir=&quot;.&quot;&gt;  &lt;description&gt;    simple example build file  &lt;/description&gt;  &lt;!-- set global properties for this build --&gt;  &lt;property name=&quot;src&quot; location=&quot;src&quot;/&gt;  &lt;property name=&quot;build&quot; location=&quot;build&quot;/&gt;  &lt;property name=&quot;dist&quot; location=&quot;dist&quot;/&gt;  &lt;target name=&quot;init&quot;&gt;    &lt;!-- Create the time stamp --&gt;    &lt;tstamp/&gt;    &lt;!-- Create the build directory structure used by compile --&gt;    &lt;mkdir dir=&quot;${build}&quot;/&gt;  &lt;/target&gt;  &lt;target name=&quot;compile&quot; depends=&quot;init&quot;        description=&quot;compile the source&quot;&gt;    &lt;!-- Compile the Java code from ${src} into ${build} --&gt;    &lt;javac srcdir=&quot;${src}&quot; destdir=&quot;${build}&quot;/&gt;  &lt;/target&gt;  &lt;target name=&quot;dist&quot; depends=&quot;compile&quot;        description=&quot;generate the distribution&quot;&gt;    &lt;!-- Create the distribution directory --&gt;    &lt;mkdir dir=&quot;${dist}/lib&quot;/&gt;    &lt;!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file --&gt;    &lt;jar jarfile=&quot;${dist}/lib/MyProject-${DSTAMP}.jar&quot; basedir=&quot;${build}&quot;/&gt;  &lt;/target&gt;  &lt;target name=&quot;clean&quot;        description=&quot;clean up&quot;&gt;    &lt;!-- Delete the ${build} and ${dist} directory trees --&gt;    &lt;delete dir=&quot;${build}&quot;/&gt;    &lt;delete dir=&quot;${dist}&quot;/&gt;  &lt;/target&gt;&lt;/project&gt;</code></pre><p>Properties are key-value pair where Apache Ant tries to expand ${key} to value at run time.  In general properties are of global scope, i.e., once they have been defined they are available for any task or target invoked subsequentlyâ€”it is not possible to set a property in a child build process created via the ant, antcall or subant tasks and make it available to the calling build process, though. </p><h3 id="1-5-2-Built-in-Properties"><a href="#1-5-2-Built-in-Properties" class="headerlink" title="1.5.2 Built-in Properties"></a>1.5.2 Built-in Properties</h3><p>Ant provides access to all system properties as if they had been defined using a <property> task. </p><ul><li>javadoc of <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#getProperties--" target="_blank" rel="noopener">System.getProperties</a></li><li>basedir: the absolute path of the projectâ€™s basedir </li><li>ant.file: the absolute path of the buildfile</li><li>ant.version</li><li>ant.project.name </li></ul><h1 id="2-Concepts-and-Types"><a href="#2-Concepts-and-Types" class="headerlink" title="2. Concepts and Types"></a>2. Concepts and Types</h1><h2 id="2-1-Concepts"><a href="#2-1-Concepts" class="headerlink" title="2.1 Concepts"></a>2.1 Concepts</h2><ul><li>targets and Extension-points </li><li>Properties and PropertyHelpers</li></ul><h2 id="2-2-List-of-Types"><a href="#2-2-List-of-Types" class="headerlink" title="2.2 List of Types"></a>2.2 List of Types</h2><p><a href="https://ant.apache.org/manual/index.html" target="_blank" rel="noopener">https://ant.apache.org/manual/index.html</a> </p><ul><li>Class Fileset </li><li>Description Type </li><li>Directory based Tasks</li><li>Dirset</li><li>Extension Package </li><li>Set of Extension Packages</li><li>FileList</li><li>FileSet </li><li>File Mappers </li><li>FilterChains and FilterReaders</li><li>FilterSet </li><li>MultiRootFileSet </li><li>PatternSet </li><li>Path-like Structures</li><li>Permissions</li><li>PropertySet </li><li>I/O redirectors </li><li>Regexp</li><li>Resources </li><li>Resource Collections </li><li>Selectors </li><li>TarFileSet </li><li>XMLCatalog </li><li>ZipFileSet </li></ul>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹èŒƒå¼ç³»åˆ—-é¢å‘å¯¹è±¡ç¼–ç¨‹</title>
      <link href="/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/"/>
      <url>/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å‡½æ•°å¼ç¼–ç¨‹-vs-é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#1-å‡½æ•°å¼ç¼–ç¨‹-vs-é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="1. å‡½æ•°å¼ç¼–ç¨‹ vs é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>1. å‡½æ•°å¼ç¼–ç¨‹ vs é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><p>å‡½æ•°å¼ç¼–ç¨‹ä¸»è¦æ˜¯æŠŠä¸€äº›åŠŸèƒ½æˆ–é€»è¾‘ä»£ç é€šè¿‡å‡½æ•°çš„æ‹¼è£…æ–¹å¼æ¥ç»„ç»‡ã€‚å°½é‡æ— çŠ¶æ€ï¼Œä½†æ˜¯çŠ¶æ€æ€»å½’æ˜¯éœ€è¦ä¸€äº›åœ°æ–¹æ¥å­˜æ”¾çš„ã€‚</p><p>å¯¹äºçŠ¶æ€å’Œæ•°æ®çš„å¤„ç†ï¼Œå¸¸ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¿™ä¸ªèŒƒå¼ã€‚</p><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§ï¼š </p><ul><li>å°è£…</li><li>ç»§æ‰¿</li><li>å¤šæ€</li></ul><h1 id="2-é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#2-é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="2. é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>2. é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><p>å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ï¼Œå°†å¯¹è±¡ä½œä¸ºç¨‹åºçš„åŸºæœ¬å•å…ƒã€‚å¯¹è±¡é‡Œçš„ç¨‹åºå¯ä»¥è®¿é—®åŠä¿®æ”¹å¯¹è±¡ç›¸å…³è”çš„æ•°æ®ã€‚</p><p>åœ¨ç¨‹åºä¸­åŒ…å«å„ç§ç‹¬ç«‹åˆç›¸äº’è°ƒç”¨çš„å¯¹è±¡çš„æ€æƒ³ã€‚é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½åº”è¯¥èƒ½å¤Ÿ<strong>æ¥å—æ•°æ®ï¼Œå¤„ç†æ•°æ®å¹¶å°†æ•°æ®ä¼ è¾¾ç»™å…¶å®ƒå¯¹è±¡</strong>ã€‚</p><h2 id="2-1-é¢å‘å¯¹è±¡çš„æ ¸å¿ƒç†å¿µ"><a href="#2-1-é¢å‘å¯¹è±¡çš„æ ¸å¿ƒç†å¿µ" class="headerlink" title="2.1 é¢å‘å¯¹è±¡çš„æ ¸å¿ƒç†å¿µ"></a>2.1 é¢å‘å¯¹è±¡çš„æ ¸å¿ƒç†å¿µ</h2><ol><li>Program to an interface, not an implementation </li></ol><ul><li>ä½¿ç”¨è€…ä¸éœ€è¦çŸ¥é“æ•°æ®ç±»å‹ï¼Œç»“æ„ï¼Œç®—æ³•çš„ç»†èŠ‚</li><li>ä½¿ç”¨è€…ä¸éœ€è¦çŸ¥é“å®ç°ç»†èŠ‚ï¼Œåªéœ€è¦çŸ¥é“æä¾›çš„æ¥å£</li><li>åˆ©äºæŠ½è±¡ã€å°è£…ã€åŠ¨æ€ç»‘å®šã€å¤šæ€</li></ul><ol start="2"><li>Favor object composition over class inheritance <ul><li>ç»§æ‰¿éœ€è¦ç»™å­ç±»æš´éœ²ä¸€äº›çˆ¶ç±»çš„è®¾è®¡å’Œå®ç°ç»†èŠ‚</li><li>çˆ¶ç±»çš„æ”¹å˜ä¼šé€ æˆå­ç±»ä¹Ÿéœ€è¦æ”¹å˜</li><li>ç»§æ‰¿æ›´å¤šæ˜¯ä¸ºäº†å¤šæ€</li></ul></li></ol><h2 id="2-2-tips"><a href="#2-2-tips" class="headerlink" title="2.2 tips"></a>2.2 tips</h2><ol><li>ä½¿ç”¨æ¥å£å®ç°å…·ä½“ç±»</li><li>å…¶ä»–ç±»è€¦åˆçš„æ˜¯æ¥å£è€Œä¸æ˜¯å®ç°ç±»ã€‚è¿™å°±æ˜¯å¤šæ€ï¼Œå…¶å¢åŠ äº†ç¨‹åºçš„å¯æ‰©å±•æ€§</li><li>æ¥å£ç¼–ç¨‹</li></ol><h2 id="2-3-ç¼ºç‚¹"><a href="#2-3-ç¼ºç‚¹" class="headerlink" title="2.3 ç¼ºç‚¹"></a>2.3 ç¼ºç‚¹</h2><p>è¶…çº§é‡çš„ä»£ç ç²˜åˆå±‚ï¼Œå¤§é‡çš„å°è£…</p><h1 id="3-æ§åˆ¶åè½¬"><a href="#3-æ§åˆ¶åè½¬" class="headerlink" title="3. æ§åˆ¶åè½¬"></a>3. æ§åˆ¶åè½¬</h1><p>Iocâ€”Inversion of Controlï¼Œå³â€œæ§åˆ¶åè½¬â€ï¼Œä¸æ˜¯ä»€ä¹ˆæŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ã€‚åœ¨Javaå¼€å‘ä¸­ï¼ŒIocæ„å‘³ç€å°†ä½ è®¾è®¡å¥½çš„å¯¹è±¡äº¤ç»™å®¹å™¨æ§åˆ¶ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„åœ¨ä½ çš„å¯¹è±¡å†…éƒ¨ç›´æ¥æ§åˆ¶ã€‚</p><p>ä¼ ç»ŸJava SEç¨‹åºè®¾è®¡ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨å¯¹è±¡å†…éƒ¨é€šè¿‡newè¿›è¡Œåˆ›å»ºå¯¹è±¡ï¼Œæ˜¯ç¨‹åºä¸»åŠ¨å»åˆ›å»ºä¾èµ–å¯¹è±¡ï¼›è€ŒIoCæ˜¯æœ‰ä¸“é—¨ä¸€ä¸ªå®¹å™¨æ¥åˆ›å»ºè¿™äº›å¯¹è±¡ï¼Œå³ç”±Iocå®¹å™¨æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºï¼›IoCå®¹å™¨æ§åˆ¶äº†å¯¹è±¡ï¼›ä¸»è¦æ§åˆ¶äº†å¤–éƒ¨èµ„æºè·å–ã€‚</p><p>æœ‰äº†IoCå®¹å™¨åï¼ŒæŠŠåˆ›å»ºå’ŒæŸ¥æ‰¾ä¾èµ–å¯¹è±¡çš„æ§åˆ¶æƒäº¤ç»™äº†å®¹å™¨ï¼Œç”±å®¹å™¨è¿›è¡Œæ³¨å…¥ç»„åˆå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´æ˜¯æ¾æ•£è€¦åˆï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿æµ‹è¯•ï¼Œåˆ©äºåŠŸèƒ½å¤ç”¨ï¼Œæ›´é‡è¦çš„æ˜¯ä½¿å¾—ç¨‹åºçš„æ•´ä¸ªä½“ç³»ç»“æ„å˜å¾—éå¸¸çµæ´»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç¨‹èŒƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹èŒƒå¼ç³»åˆ—-æ³›å‹ç¼–ç¨‹</title>
      <link href="/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/"/>
      <url>/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-èµ·æº"><a href="#1-èµ·æº" class="headerlink" title="1. èµ·æº"></a>1. èµ·æº</h1><p>ç¼–ç¨‹èŒƒå¼, programming paradigmï¼Œæ˜¯ä¸€ç±»å…¸å‹çš„ç¼–ç¨‹é£æ ¼ã€‚</p><p>å°†ä¸»æµç¼–ç¨‹è¯­è¨€åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼ŒåŠ ä¸Šå¯¹äºç¼–ç¨‹æœ¬è´¨çš„ç†è§£ã€‚å…±å››ç¯‡æ–‡ç« ã€‚</p><ul><li>æ³›å‹ç¼–ç¨‹</li><li>å‡½æ•°å¼ç¼–ç¨‹</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹</li><li>ç¼–ç¨‹æœ¬è´¨å’Œé€»è¾‘ç¼–ç¨‹</li></ul><h1 id="1-1-Cè¯­è¨€"><a href="#1-1-Cè¯­è¨€" class="headerlink" title="1.1 Cè¯­è¨€"></a>1.1 Cè¯­è¨€</h1><ul><li>å‡ ä¹ç°è¡Œçš„æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½æ˜¯ä»cè¯­è¨€æ‹“å±•æ¥çš„ï¼Œç®€è¿°cè¯­è¨€çš„ç‰¹æ€§ï¼š</li></ul><ol><li>é™æ€å¼±ç±»å‹è¯­è¨€ï¼Œä½¿ç”¨å˜é‡æ—¶éœ€è¦å£°æ˜å˜é‡ç±»å‹ï¼Œä½†ç±»å‹ä¹‹é—´æœ‰éšå¼è½¬æ¢</li><li>typedef å®šä¹‰ç±»å‹çš„åˆ«åï¼Œè¾¾åˆ°å˜é‡ç±»å‹çš„æŠ½è±¡</li><li>ä¸åŒå˜é‡ç±»å‹å¯ä»¥ç”¨ç»“æ„ä½“ç»„åˆåœ¨ä¸€èµ·</li></ol><ul><li>cè¯­è¨€çš„ç±»å‹æŠ½è±¡å¸¦æ¥çš„å¤æ‚åº¦çš„æå‡ï¼š </li></ul><pre><code>void swap(void* x, void* y, size_t size){     char tmp[size];     memcpy(tmp, y, size);     memcpy(y, x, size);     memcpy(x, tmp, size);}</code></pre><ul><li>åˆ©ç”¨å®å®šä¹‰æ¥åšæ³›å‹</li></ul><pre><code>#define swap(x, y, size) {\    char temp[size]; \    memcpy(temp, &amp;y, size); \    memcpy(&amp;y,   &amp;x, size); \    memcpy(&amp;x, temp, size); \}</code></pre><ul><li>æ¯”è¾ƒå¤§å°çš„å®å®šä¹‰</li></ul><pre><code>#define min(x, y)  ï¼ˆ(x)&gt;(y) ? (y) : (x)ï¼‰</code></pre><p>è¿™é‡Œå¦‚æœæ¯”è¾ƒ<code>min(x++, y++)</code>çš„è¯ï¼Œå„è‡ªä¼šåŠ ä¸¤æ¬¡</p><ul><li>å°ç»“<br>å¦‚æœè¯´ç¨‹åº = ç®—æ³• + æ•°æ®ï¼Œ Cè¯­è¨€ä¼šæœ‰è¿™å‡ ä¸ªé—®é¢˜</li></ul><ol><li>ä¸€ä¸ªé€šç”¨çš„ç®—æ³•ï¼Œéœ€è¦å¯¹æ‰€å¤„ç†çš„æ•°æ®çš„æ•°æ®ç±»å‹è¿›è¡Œé€‚é…ã€‚ä½†åœ¨é€‚é…æ•°æ®ç±»å‹çš„è¿‡ç¨‹ä¸­ï¼ŒC è¯­è¨€åªèƒ½ä½¿ç”¨ <code>void *</code> æˆ–å®æ›¿æ¢çš„æ–¹å¼ã€‚è¿™ä¸¤ç§æ–¹å¼å¯¼è‡´äº†ç±»å‹è¿‡äºå®½æ¾ï¼Œå¹¶å¸¦æ¥å¾ˆå¤šå…¶å®ƒé—®é¢˜ã€‚</li><li>é€‚é…æ•°æ®ç±»å‹ï¼Œéœ€è¦ C è¯­è¨€åœ¨æ³›å‹ä¸­åŠ å…¥ä¸€ä¸ªç±»å‹çš„ sizeï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¯†åˆ«ä¸äº†è¢«æ³›å‹åçš„æ•°æ®ç±»å‹ï¼Œè€Œ C è¯­è¨€æ²¡æœ‰è¿è¡Œæ—¶çš„ç±»å‹è¯†åˆ«ï¼Œæ‰€ä»¥ï¼Œåªèƒ½å°†è¿™ä¸ªå·¥ä½œæŠ›ç»™è°ƒç”¨æ³›å‹ç®—æ³•çš„ç¨‹åºå‘˜æ¥åšäº†</li><li>ç®—æ³•å…¶å®æ˜¯åœ¨æ“ä½œæ•°æ®ç»“æ„ï¼Œè€Œæ•°æ®åˆ™æ˜¯æ”¾åˆ°æ•°æ®ç»“æ„ä¸­çš„ã€‚æ‰€ä»¥ï¼ŒçœŸæ­£çš„æ³›å‹é™¤äº†é€‚é…æ•°æ®ç±»å‹å¤–ï¼Œè¿˜è¦é€‚é…æ•°æ®ç»“æ„ã€‚æœ€åè¿™ä¸ªäº‹æƒ…å¯¼è‡´æ³›å‹ç®—æ³•çš„å¤æ‚æ€¥å‰§ä¸Šå‡ã€‚æ¯”å¦‚å®¹å™¨å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œä¸åŒçš„æ•°æ®ä½“å¯èƒ½æœ‰éå¸¸ä¸ä¸€æ ·çš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ¨¡å‹ï¼Œå†æ¯”å¦‚å¯¹è±¡ä¹‹é—´çš„å¤åˆ¶ï¼Œè¦æŠŠå®ƒå­˜è¿›æ¥æˆ‘éœ€è¦æœ‰ä¸€ä¸ªå¤åˆ¶ï¼Œè¿™å…¶ä¸­åˆæ¶‰åŠåˆ°æ˜¯æ·±æ‹·è´ï¼Œè¿˜æ˜¯æµ…æ‹·è´ã€‚</li><li>æœ€åï¼Œåœ¨å®ç°æ³›å‹ç®—æ³•çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°è‡ªå·±åœ¨çº ç»“å“ªäº›ä¸œè¥¿åº”è¯¥æŠ›ç»™è°ƒç”¨è€…å¤„ç†ï¼Œå“ªäº›åˆæ˜¯å¯ä»¥å°è£…èµ·æ¥ã€‚å¦‚ä½•å¹³è¡¡å’Œé€‰æ‹©ï¼Œå¹¶æ²¡æœ‰å®šè®ºï¼Œä¹Ÿä¸å¥½è§£å†³ã€‚</li></ol><p>æ¯”å¦‚ C è¯­è¨€å°±æ˜¯è¿‡ç¨‹å¼çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåƒCè¯­è¨€è¿™æ ·çš„è¿‡ç¨‹å¼ç¼–ç¨‹è¯­è¨€ä¼˜ç‚¹æ˜¯åº•å±‚çµæ´»è€Œä¸”é«˜æ•ˆï¼Œç‰¹åˆ«é€‚åˆå¼€å‘è¿è¡Œè¾ƒå¿«ä¸”å¯¹ç³»ç»Ÿèµ„æºåˆ©ç”¨ç‡è¦æ±‚è¾ƒé«˜çš„ç¨‹åºï¼Œä½†æˆ‘ä¸Šé¢æŠ›å‡ºçš„é—®é¢˜å®ƒåœ¨åæ¥ä¹Ÿæ²¡æœ‰è¯•å›¾å»è§£å†³ï¼Œå› ä¸º<strong>ç¼–ç¨‹èŒƒå¼</strong>çš„é€‰æ‹©åŸºæœ¬å·²ç»å†³å®šäº†å®ƒçš„â€œå‘½è¿â€ã€‚</p><h1 id="2-æ³›å‹ç¼–ç¨‹"><a href="#2-æ³›å‹ç¼–ç¨‹" class="headerlink" title="2. æ³›å‹ç¼–ç¨‹"></a>2. æ³›å‹ç¼–ç¨‹</h1><h2 id="2-1-C-è¯­è¨€"><a href="#2-1-C-è¯­è¨€" class="headerlink" title="2.1 C++ è¯­è¨€"></a>2.1 C++ è¯­è¨€</h2><p>C++ å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯æ¥è§£å†³Cè¯­è¨€ä¸­çš„å„ç§é—®é¢˜å’Œå„ç§ä¸æ–¹ä¾¿ã€‚</p><ul><li>ç”¨å¼•ç”¨æ¥è§£å†³æŒ‡é’ˆçš„é—®é¢˜ã€‚</li><li>ç”¨ namespace æ¥è§£å†³åå­—ç©ºé—´å†²çªçš„é—®é¢˜ã€‚</li><li>é€šè¿‡ try-catch æ¥è§£å†³æ£€æŸ¥è¿”å›å€¼ç¼–ç¨‹çš„é—®é¢˜ã€‚</li><li>ç”¨ class æ¥è§£å†³å¯¹è±¡çš„åˆ›å»ºã€å¤åˆ¶ã€é”€æ¯çš„é—®é¢˜ï¼Œä»è€Œå¯ä»¥è¾¾åˆ°åœ¨ç»“æ„ä½“åµŒå¥—æ—¶å¯ä»¥æ·±åº¦å¤åˆ¶çš„å†…å­˜å®‰å…¨é—®é¢˜ã€‚</li><li>é€šè¿‡é‡è½½æ“ä½œç¬¦æ¥è¾¾åˆ°æ“ä½œä¸Šçš„æ³›å‹</li><li>é€šè¿‡æ¨¡æ¿ template å’Œè™šå‡½æ•°çš„å¤šæ€ä»¥åŠè¿è¡Œæ—¶è¯†åˆ«æ¥è¾¾åˆ°æ›´é«˜å±‚æ¬¡çš„æ³›å‹å’Œå¤šæ€ã€‚</li><li>ç”¨ RAIIã€æ™ºèƒ½æŒ‡é’ˆçš„æ–¹å¼ï¼Œè§£å†³äº† C è¯­è¨€ä¸­å› ä¸ºéœ€è¦é‡Šæ”¾èµ„æºè€Œå‡ºç°çš„é‚£äº›éå¸¸ ugly ä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™çš„ä»£ç çš„é—®é¢˜ã€‚</li><li>ç”¨ STL è§£å†³äº† C è¯­è¨€ä¸­ç®—æ³•å’Œæ•°æ®ç»“æ„çš„ N å¤šç§å‘ã€‚</li></ul><h2 id="2-2-C-è¯­è¨€çš„æ³›å‹ç¼–ç¨‹"><a href="#2-2-C-è¯­è¨€çš„æ³›å‹ç¼–ç¨‹" class="headerlink" title="2.2 C++ è¯­è¨€çš„æ³›å‹ç¼–ç¨‹"></a>2.2 C++ è¯­è¨€çš„æ³›å‹ç¼–ç¨‹</h2><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œç®—æ³•åº”è¯¥ä¸æ•°æ®ç»“æ„å’Œç±»å‹æ— å…³çš„ã€‚å„ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„åº”è¯¥èƒ½è‡ªå·±åšå¥½æ³›å‹å¤„ç†ï¼Œç®—æ³•æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å®ç°ã€‚</p><p>å¯¹äºæ³›å‹çš„æŠ½è±¡ï¼Œ<strong>éœ€è¦å›ç­”çš„é—®é¢˜æ˜¯ï¼š å¦‚æœæˆ‘ä»¬çš„æ•°æ®ç±»å‹ç¬¦åˆé€šç”¨ç®—æ³•ï¼Œé‚£ä¹ˆå¯¹æ•°æ®ç±»å‹çš„æœ€å°éœ€æ±‚æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ</strong></p><h3 id="2-2-1-C-å¦‚ä½•è§£å†³æ³›å‹é—®é¢˜çš„ï¼Ÿ"><a href="#2-2-1-C-å¦‚ä½•è§£å†³æ³›å‹é—®é¢˜çš„ï¼Ÿ" class="headerlink" title="2.2.1 C++ å¦‚ä½•è§£å†³æ³›å‹é—®é¢˜çš„ï¼Ÿ"></a>2.2.1 C++ å¦‚ä½•è§£å†³æ³›å‹é—®é¢˜çš„ï¼Ÿ</h3><ol><li>é€šè¿‡ç±»çš„æ–¹å¼è§£å†³</li></ol><ul><li>ç±»é‡Œé¢ä¼šæœ‰æ„é€ å‡½æ•°ã€ææ„å‡½æ•°è¡¨ç¤ºè¿™ä¸ªç±»çš„åˆ†é…å’Œé‡Šæ”¾ã€‚</li><li>è¿˜æœ‰å®ƒçš„æ‹·è´æ„é€ å‡½æ•°ï¼Œè¡¨ç¤ºäº†å¯¹å†…å­˜çš„å¤åˆ¶ã€‚</li><li>è¿˜æœ‰é‡è½½æ“ä½œç¬¦ï¼Œåƒæˆ‘ä»¬è¦å»æ¯”è¾ƒå¤§äºã€ç­‰äºã€ä¸ç­‰äºã€‚</li></ul><ol start="2"><li>é€šè¿‡æ¨¡æ¿è¾¾åˆ°ç±»å‹å’Œç®—æ³•çš„å¦¥å</li></ol><ul><li>æ¨¡æ¿æœ‰ç‚¹åƒ DSLï¼Œæ¨¡æ¿çš„ç‰¹åŒ–ä¼šæ ¹æ®ä½¿ç”¨è€…çš„ç±»å‹åœ¨ç¼–è¯‘æ—¶æœŸç”Ÿæˆé‚£ä¸ªæ¨¡æ¿çš„ä»£ç ã€‚</li><li>æ¨¡æ¿å¯ä»¥é€šè¿‡ä¸€ä¸ªè™šæ‹Ÿç±»å‹æ¥åšç±»å‹ç»‘å®šï¼Œè¿™æ ·ä¸ä¼šå¯¼è‡´ç±»å‹è½¬æ¢æ—¶çš„é—®é¢˜ã€‚</li></ul><ol start="3"><li>é€šè¿‡è™šå‡½æ•°å’Œè¿è¡Œæ—¶ç±»è¯†åˆ«</li></ol><ul><li>è™šå‡½æ•°å¸¦æ¥çš„å¤šæ€åœ¨è¯­ä¹‰ä¸Šå¯ä»¥è®©â€œåŒä¸€ç±»â€çš„ç±»å‹è¿›è¡Œæ³›å‹ã€‚</li><li>è¿è¡Œæ—¶ç±»å‹è¯†åˆ«æŠ€æœ¯å¯ä»¥åšåˆ°åœ¨æ³›å‹æ—¶å¯¹å…·ä½“ç±»å‹çš„ç‰¹æ®Šå¤„ç†ã€‚</li></ul><p>ä¸€ä¸ªè‰¯å¥½çš„æ³›å‹ç¼–ç¨‹éœ€è¦è§£å†³ 1ï¼‰ ç®—æ³•çš„æ³›å‹ 2ï¼‰ ç±»å‹çš„æ³›å‹  3ï¼‰ æ•°æ®ç»“æ„çš„æ³›å‹</p><h3 id="2-2-2-æ³›å‹ç¼–ç¨‹å®ä¾‹"><a href="#2-2-2-æ³›å‹ç¼–ç¨‹å®ä¾‹" class="headerlink" title="2.2.2 æ³›å‹ç¼–ç¨‹å®ä¾‹"></a>2.2.2 æ³›å‹ç¼–ç¨‹å®ä¾‹</h3><ol><li>Search å‡½æ•°</li></ol><p>ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½æ˜¯é¡ºåºå‹çš„ï¼Œä¸èƒ½ç”¨ <code>for(int i = 0; i &lt; len; i++)</code> æ¥åšæŠ½è±¡çš„ï¼Œæ¯”å¦‚hashtableï¼ŒäºŒå‰æ ‘ï¼Œå›¾å°±æ˜¯éé¡ºåºå‹çš„ã€‚è¿™ç§å†™æ³•å¯¹ä»–ä»¬æ¥è¯´æ²¡æœ‰æ„ä¹‰ã€‚</p><pre><code>template&lt;typename T, typename Iter&gt; Iter search(Iter pStart, Iter pEnd, T target) {    for(Iter p = pStart; p != pEnd; p++) {        if ( *p == target )             return p;    }    return NULL;}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼š </p><ul><li>ä½¿ç”¨ <code>typename T</code> æŠ½è±¡äº†æ•°æ®ç»“æ„ä¸­å­˜å‚¨æ•°æ®çš„ç±»å‹</li><li>ä½¿ç”¨ <code>typename Iter</code>ï¼Œè®©ä¸åŒçš„æ•°æ®ç»“æ„å®ç°è‡ªå·±çš„è¿­ä»£å™¨ï¼Œç”¨è¿™ç§æ–¹å¼æŠ½è±¡æ‰äº†ä¸åŒç±»å‹çš„æ•°æ®ç»“æ„ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬å¯¹æ•°æ®å®¹å™¨çš„éå†ä½¿ç”¨äº†Iterä¸­çš„++æ–¹æ³•ï¼Œè¿™æ˜¯æ•°æ®å®¹å™¨éœ€è¦é‡è½½çš„æ“ä½œç¬¦ï¼Œè¿™æ ·é€šè¿‡æ“ä½œç¬¦é‡è½½ä¹Ÿå°±æ³›å‹æ‰äº†éå†ã€‚</li><li>ä½¿ç”¨<code>*Iter</code>æ¥å–å¾—æŒ‡é’ˆçš„å†…å®¹ï¼Œè¿™ä¹Ÿæ˜¯é€šè¿‡é‡è½½*å–å€¼æ“ä½œç¬¦æ¥è¾¾åˆ°çš„æ³›å‹ã€‚</li><li>tips: <code>Iter</code> åœ¨å®é™…ä»£ç ä¸­ï¼Œæ˜¯ç±»ä¼¼äº<code>vector&lt;int&gt;::iterator</code> <code>map&lt;int, String&gt;::iterator</code>ã€‚æ˜¯ç”±ç›¸åº”çš„æ•°æ®å®¹å™¨æ¥å®ç°å’Œæä¾›çš„ã€‚</li></ul><ol start="2"><li>è¿­ä»£å™¨</li></ol><pre><code>template &lt;class T&gt;class container {public:    class iterator {    public:        typedef iterator self_type;        typedef T   value_type;        typedef T*  pointer;        typedef T&amp;     reference;        reference operator*();        pointer operator-&gt;();        bool operator==(const self_type&amp; rhs)ï¼›        bool operator!=(const self_type&amp; rhs)ï¼›        self_type operator++() { self_type i = *this; ptr_++; return i; }        self_type operator++(int junk) { ptr_++; return *this; }        ...        ...    private:        pointer _ptr;    };    iterator begin();    iterator end();    ...    ...};</code></pre><ul><li>ä¸€ä¸ªè¿­ä»£å™¨éœ€è¦ä¸ä¸€ä¸ªå®¹å™¨åœ¨ä¸€èµ·ï¼Œå› ä¸ºé‡Œé¢æ˜¯å¯¹è¿™ä¸ªå®¹å™¨çš„å…·ä½“çš„ä»£ç å®ç°</li><li>éœ€è¦é‡è½½ä¸€äº›æ“ä½œç¬¦</li><li>éœ€è¦typedefä¸€äº›ç±»å‹ï¼Œææ­»å®¹å™¨å†…çš„æ•°æ®çš„å®é™…ç±»å‹æ˜¯ä»€ä¹ˆæ ·å­çš„</li><li>begin() end()åŸºæœ¬æ“ä½œ</li></ul><ol start="3"><li>Sumï¼ˆï¼‰</li></ol><pre><code>template &lt;class Iter&gt; typename Iter::value_type sum(Iter start, Iter end, T init) {    typename Iter::value_type result = init;    while (start != end) {        result = result + *start;        start++;    }    return result;}</code></pre><ol start="4"><li>reduce()</li></ol><pre><code>template&lt;class Iter, class T, class Op&gt; T reduce (Iter start, Iter end, T init, Op op) {    T result = init;    while ( start != end ) {        result = op( result, *start );        start++;    }    return result;}</code></pre><h2 id="2-2-åŠ¨æ€ç±»å‹è¯­è¨€çš„æ³›å‹ç¼–ç¨‹"><a href="#2-2-åŠ¨æ€ç±»å‹è¯­è¨€çš„æ³›å‹ç¼–ç¨‹" class="headerlink" title="2.2 åŠ¨æ€ç±»å‹è¯­è¨€çš„æ³›å‹ç¼–ç¨‹"></a>2.2 åŠ¨æ€ç±»å‹è¯­è¨€çš„æ³›å‹ç¼–ç¨‹</h2><p>åœ¨ç¼–ç¨‹ä¸–ç•Œï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å¥½ä¸¤ä»¶äº‹æƒ…ï¼š </p><ol><li>ç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»å‹é—®é¢˜</li><li>å¯¹çœŸå®ä¸–ç•Œä¸­ä¸šåŠ¡ä»£ç çš„æŠ½è±¡ã€é‡ç”¨å’Œæ‹¼è£…</li></ol><h3 id="2-2-1-ç±»å‹ç³»ç»Ÿ"><a href="#2-2-1-ç±»å‹ç³»ç»Ÿ" class="headerlink" title="2.2.1 ç±»å‹ç³»ç»Ÿ"></a>2.2.1 ç±»å‹ç³»ç»Ÿ</h3><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç±»å‹ç³»ç»Ÿç”¨äºå®šä¹‰å¦‚ä½•å°†ç¼–ç¨‹è¯­è¨€ä¸­çš„æ•°å€¼å’Œè¡¨è¾¾å¼å½’ç±»ä¸ºè®¸å¤šä¸åŒçš„ç±»å‹ï¼Œä»¥åŠå¦‚ä½•æ“ä½œè¿™äº›ç±»å‹ï¼Œè¿˜æœ‰è¿™äº›ç±»å‹å¦‚ä½•äº’ç›¸ä½œç”¨ã€‚ç±»å‹å¯ä»¥ç¡®è®¤ä¸€ä¸ªå€¼æˆ–è€…ä¸€ç»„å€¼å…·æœ‰ç‰¹å®šçš„æ„ä¹‰å’Œç›®çš„ã€‚</p><p>ç±»å‹ç³»ç»Ÿåœ¨å„ç§è¯­è¨€ä¹‹é—´å¾ˆä¸åŒï¼Œå­˜åœ¨äºç¼–è¯‘æ—¶æœŸçš„è¯­æ³•ï¼Œä»¥åŠè¿è¡Œæ—¶æœŸçš„æ“ä½œå®ç°æ–¹å¼ã€‚</p><p>ç¨‹åºè¯­è¨€çš„ç±»å‹ç³»ç»Ÿä¸»è¦æä¾›å¦‚ä¸‹åŠŸèƒ½ï¼š </p><ul><li>ç¨‹åºè¯­è¨€çš„å®‰å…¨æ€§</li></ul><p>ä½¿ç”¨ç±»å‹å¯ä»¥è®©ç¼–è¯‘å™¨ä¾¦æµ‹ä¸€äº›ä»£ç çš„é”™è¯¯ã€‚ä¾‹å¦‚ï¼šå¯ä»¥è¯†åˆ«å‡ºä¸€ä¸ªé”™è¯¯æ— æ•ˆçš„è¡¨è¾¾å¼ã€‚å¦‚ï¼š<code>â€œHello, Worldâ€ + 3</code>è¿™æ ·çš„ä¸åŒæ•°æ®ç±»å‹é—´æ“ä½œçš„é—®é¢˜ã€‚å¼ºç±»å‹è¯­è¨€æä¾›æ›´å¤šçš„å®‰å…¨æ€§ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯ç»å¯¹çš„å®‰å…¨ã€‚</p><ul><li>åˆ©äºç¼–è¯‘å™¨çš„ä¼˜åŒ–</li></ul><p>é™æ€ç±»å‹è¯­è¨€çš„ç±»å‹å£°æ˜ï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨æ˜ç¡®åœ°çŸ¥é“ç¨‹åºå‘˜çš„æ„å›¾ã€‚å› æ­¤ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ä¿¡æ¯åšå¾ˆå¤šä»£ç ä¼˜åŒ–å·¥ä½œã€‚ä¾‹å¦‚ï¼šå¦‚æœæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªç±»å‹æ˜¯int,é‚£ä¹ˆç¼–è¯‘å°±çŸ¥é“ï¼Œè¿™ä¸ªç±»å‹ä¼šä»¥4ä¸ªå­—èŠ‚çš„å€æ•°è¿›è¡Œå¯¹é½ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥éå¸¸æœ‰æ•ˆåœ°åˆ©ç”¨æ›´æœ‰æ•ˆç‡çš„æœºå™¨æŒ‡ä»¤ã€‚ </p><ul><li>ä»£ç çš„å¯è¯»æ€§</li></ul><p>æœ‰ç±»å‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¯ä»¥è®©ä»£ç æ›´æ˜“è¯»å’Œæ›´æ˜“ç»´æŠ¤ã€‚ä»£ç çš„è¯­ä¹‰ä¹Ÿæ›´æ¸…æ¥šï¼Œä»£ç æ¨¡å—çš„æ¥å£ï¼ˆå¦‚å‡½æ•°ï¼‰ä¹Ÿæ›´ä¸°å¯Œå’Œæ›´æ¸…æ¥šã€‚</p><ul><li>æŠ½è±¡åŒ–</li></ul><p>ç±»å‹å…è®¸ç¨‹åºè®¾è®¡è€…å¯¹ç¨‹åºä»¥è¾ƒé«˜å±‚æ¬¡çš„æ–¹å¼æ€è€ƒï¼Œè€Œä¸æ˜¯çƒ¦äººçš„ä½å±‚æ¬¡å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´å‹æˆ–æ˜¯æµ®ç‚¹å‹æ¥å–ä»£åº•å±‚çš„å­—èŠ‚å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦ä¸²è®¾è®¡æˆä¸€ä¸ªå€¼ï¼Œè€Œä¸æ˜¯åº•å±‚çš„å­—èŠ‚çš„æ•°ç»„ã€‚ä»é«˜å±‚ä¸Šæ¥è¯´ï¼Œç±»å‹å¯ä»¥ç”¨æ¥å®šä¹‰ä¸åŒæ¨¡å—é—´çš„äº¤äº’åè®®ï¼Œæ¯”å¦‚å‡½æ•°çš„å…¥å‚ç±»å‹å’Œè¿”å›ç±»å‹ï¼Œä»è€Œå¯ä»¥è®©æ¥å£æ›´æœ‰è¯­ä¹‰ï¼Œè€Œä¸”ä¸åŒçš„æ¨¡å—æ•°æ®äº¤æ¢æ›´ä¸ºç›´è§‚å’Œæ˜“æ‡‚ã€‚</p><p>åœ¨åŠ¨æ€è¯­è¨€ä¸­ï¼Œä¸€ä¸ªå˜é‡çš„ç±»å‹æ˜¯ç”±è¿è¡Œæ—¶çš„è§£é‡Šå™¨æ¥åŠ¨æ€æ ‡è®°çš„ï¼Œè¿™æ ·å°±å¯ä»¥åŠ¨æ€åœ°å’Œåº•å±‚çš„è®¡ç®—æœºæŒ‡ä»¤æˆ–å†…å­˜å¸ƒå±€å¯¹åº”èµ·æ¥ã€‚</p><h1 id="3-æ³›å‹çš„æœ¬è´¨"><a href="#3-æ³›å‹çš„æœ¬è´¨" class="headerlink" title="3. æ³›å‹çš„æœ¬è´¨"></a>3. æ³›å‹çš„æœ¬è´¨</h1><ul><li>ç±»å‹æ˜¯å¯¹å†…å­˜çš„ä¸€ç§æŠ½è±¡ã€‚ä¸åŒçš„ç±»å‹ï¼Œä¼šæœ‰ä¸åŒçš„å†…å­˜å¸ƒå±€å’Œå†…å­˜åˆ†é…çš„ç­–ç•¥ã€‚</li><li>ä¸åŒçš„ç±»å‹ï¼Œæœ‰ä¸åŒçš„æ“ä½œã€‚æ‰€ä»¥ï¼Œå¯¹äºç‰¹å®šçš„ç±»å‹ï¼Œä¹Ÿæœ‰ç‰¹å®šçš„ä¸€ç»„æ“ä½œã€‚</li></ul><blockquote><p>Generic programming centers around the idea of abstracting from concrete, efficient algorithms to obtain generic algorithms that can be combined with different data representations to produce a wide variety of useful software.</p></blockquote><p>å±è”½æ‰æ•°æ®å’Œæ“ä½œæ•°æ®çš„ç»†èŠ‚ï¼Œè®©ç®—æ³•æ›´ä¸ºé€šç”¨ï¼Œè®©ç¼–ç¨‹è€…æ›´å¤šåœ°å…³æ³¨ç®—æ³•ç»“æ„ï¼Œè€Œä¸æ˜¯åœ¨ç®—æ³•ä¸­å¤„ç†ä¸åŒçš„æ•°æ®ç±»å‹ã€‚</p><p>è¦åšåˆ°æ³›å‹ï¼Œæˆ‘ä»¬éœ€è¦ï¼š </p><ul><li>æ ‡å‡†åŒ–æ‰ç±»å‹çš„å†…å­˜åˆ†é…ã€é‡Šæ”¾å’Œè®¿é—®ã€‚</li><li>æ ‡å‡†åŒ–æ‰ç±»å‹çš„æ“ä½œã€‚æ¯”å¦‚ï¼šæ¯”è¾ƒæ“ä½œï¼ŒI/O æ“ä½œï¼Œå¤åˆ¶æ“ä½œâ€¦â€¦</li><li>æ ‡å‡†åŒ–æ‰æ•°æ®å®¹å™¨çš„æ“ä½œã€‚æ¯”å¦‚ï¼šæŸ¥æ‰¾ç®—æ³•ã€è¿‡æ»¤ç®—æ³•ã€èšåˆç®—æ³•â€¦â€¦</li><li>æ ‡å‡†åŒ–æ‰ç±»å‹ä¸Šç‰¹æœ‰çš„æ“ä½œã€‚éœ€è¦æœ‰æ ‡å‡†åŒ–çš„æ¥å£æ¥å›è°ƒä¸åŒç±»å‹çš„å…·ä½“æ“ä½œâ€¦â€¦</li></ul><h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><p><a href="https://time.geekbang.org/column/48" target="_blank" rel="noopener">å·¦è€³å¬é£çš„æå®¢æ—¶é—´ä¸“æ </a></p><p><a href="https://blog.csdn.net/Hackbuteer1/article/details/7558868" target="_blank" rel="noopener">è™šå‡½æ•°</a></p><p><a href="https://lxwei.github.io/posts/262.html" target="_blank" rel="noopener">ä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶</a></p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç¨‹èŒƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹èŒƒå¼ç³»åˆ—-åŸºäºåŸå‹çš„ç¼–ç¨‹</title>
      <link href="/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E5%9F%BA%E4%BA%8E%E5%8E%9F%E5%9E%8B%E7%9A%84%E7%BC%96%E7%A8%8B/"/>
      <url>/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E5%9F%BA%E4%BA%8E%E5%8E%9F%E5%9E%8B%E7%9A%84%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>åŸºäºåŸå‹çš„ç¼–ç¨‹ï¼Œæ˜¯æŒ‡æ²¡æœ‰classåŒ–ï¼Œç›´æ¥ä½¿ç”¨å¯¹è±¡çš„ç¼–ç¨‹æ–¹å¼ã€‚åˆå«åšåŸºäºå®ä¾‹çš„ç¼–ç¨‹ï¼Œä¸»æµè¯­è¨€æ˜¯JavaScriptã€‚ </p><h1 id="1-ä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¯”è¾ƒ"><a href="#1-ä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¯”è¾ƒ" class="headerlink" title="1. ä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¯”è¾ƒ"></a>1. ä¸ä¼ ç»Ÿé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ¯”è¾ƒ</h1><h2 id="1-1-å…³æ³¨å¯¹è±¡å®ä¾‹è¡Œä¸ºï¼Œè€Œåå¯¹ç±»è¿›è¡Œåˆ’åˆ†"><a href="#1-1-å…³æ³¨å¯¹è±¡å®ä¾‹è¡Œä¸ºï¼Œè€Œåå¯¹ç±»è¿›è¡Œåˆ’åˆ†" class="headerlink" title="1.1 å…³æ³¨å¯¹è±¡å®ä¾‹è¡Œä¸ºï¼Œè€Œåå¯¹ç±»è¿›è¡Œåˆ’åˆ†"></a>1.1 å…³æ³¨å¯¹è±¡å®ä¾‹è¡Œä¸ºï¼Œè€Œåå¯¹ç±»è¿›è¡Œåˆ’åˆ†</h2><p>åœ¨åŸºäºç±»çš„ç¼–ç¨‹å½“ä¸­ï¼Œå¯¹è±¡æ€»å…±æœ‰ä¸¤ç§ç±»å‹ã€‚</p><ol><li>ç±»</li></ol><p>å®šä¹‰äº†å¯¹è±¡çš„åŸºæœ¬å¸ƒå±€ï¼Œå‡½æ•°ç‰¹æ€§ã€‚â€”-&gt; æ˜¯è¡Œä¸ºå’Œç»“æ„çš„é›†åˆï¼Œå¯¹æ‰€æœ‰çš„æ¥å£æ¥è¯´è¿™äº›ç±»çš„è¡Œä¸ºå’Œç»“æ„éƒ½æ˜¯ç›¸åŒçš„ã€‚</p><ol start="2"><li>æ¥å£</li></ol><p>æ˜¯å¯ä»¥ä½¿ç”¨çš„å¯¹è±¡,å®šä¹‰äº†ä¸€äº›è¡Œä¸ºï¼ŒåŸºäºç‰¹å®šç±»çš„æ ·å¼ã€‚</p><p>åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç±»çš„åˆ’åˆ†æ˜¯åŸºäºè¡Œä¸ºå’Œç»“æ„ï¼Œè€Œä¸æ˜¯çŠ¶æ€ã€‚åŸå‹ç¼–ç¨‹çš„ä¸»å¼ è€…æå€¡å…³æ³¨ä¸€ç³»åˆ—å¯¹è±¡å®ä¾‹çš„è¡Œä¸ºï¼Œè€Œåå…³æ³¨å°†å…¶åˆ’åˆ†åˆ°ä½¿ç”¨æ–¹å¼ç›¸ä¼¼çš„åŸå‹å¯¹è±¡ã€‚å®é™…ä¸Šè¯´ï¼Œä¸åŒä¹‹å¤„åœ¨äºå¯¹äºçŠ¶æ€çš„çœ‹é‡ç¨‹åº¦ã€‚</p><h2 id="1-2-åˆ›å»ºå®ä¾‹çš„æ—¶é—´"><a href="#1-2-åˆ›å»ºå®ä¾‹çš„æ—¶é—´" class="headerlink" title="1.2 åˆ›å»ºå®ä¾‹çš„æ—¶é—´"></a>1.2 åˆ›å»ºå®ä¾‹çš„æ—¶é—´</h2><p>å¯¹äºåŸºäºç±»çš„ç³»ç»Ÿï¼Œæ–°çš„å®ä¾‹æ˜¯é€šè¿‡ç±»æ„é€ å™¨ä»¥åŠå‚æ•°æ¥æ„é€ ï¼Œå®ä¾‹æ˜¯ç”±ç±»çš„è¡Œä¸ºå’Œç»“æ„æ¥å®šä¹‰çš„ã€‚</p><p>å¯¹äºåŸºäºåŸå‹çš„ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶å·²æœ‰çš„å¯¹è±¡æˆ–è€…é€šè¿‡æ‰©å±•ç©ºå¯¹è±¡æ¥åˆ›å»ºï¼Œæ˜¯åœ¨<strong>è¿è¡Œæ—¶</strong>å¯¹åŸå‹è¿›è¡Œä¿®æ”¹çš„ã€‚</p><h1 id="2-JavaScript-åŸå‹çš„æ¦‚å¿µ"><a href="#2-JavaScript-åŸå‹çš„æ¦‚å¿µ" class="headerlink" title="2. JavaScript åŸå‹çš„æ¦‚å¿µ"></a>2. JavaScript åŸå‹çš„æ¦‚å¿µ</h1><pre><code>var foo = {name: &quot;foo&quot;, one: 1, two: 2};var bar = {three: 3};bar.__proto__ = foo; // foo is...// If we try to access foo&#39;s properties from bar // from now on, we&#39;ll succeed. bar.one // Resolves to 1.// The child object&#39;s properties are also accessible.bar.three // Resolves to 3.// Own properties shadow prototype propertiesbar.name = &quot;bar&quot;;foo.name; // unaffected, resolves to &quot;foo&quot;bar.name; // Resolves to &quot;bar&quot;</code></pre><p>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸ª<code>_proto_</code>å±æ€§ï¼Œé€šè¿‡èµ‹å€¼æ“ä½œï¼Œbarçš„åŸå‹ç°åœ¨æ˜¯fooäº†ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨baré‡Œé¢è®¿é—®fooçš„å±æ€§ã€‚</p><h2 id="2-1-åŒºåˆ†-proto-ä»¥åŠprototype"><a href="#2-1-åŒºåˆ†-proto-ä»¥åŠprototype" class="headerlink" title="2.1 åŒºåˆ†_proto_ä»¥åŠprototype"></a>2.1 åŒºåˆ†<code>_proto_</code>ä»¥åŠ<code>prototype</code></h2><ul><li><p><code>_proto_</code><br>ä¸»è¦å®‰æ”¾åœ¨ä¸€ä¸ªå®é™…çš„å¯¹è±¡å½“ä¸­ï¼Œç”¨å®ƒæ¥äº§ç”Ÿä¸€ä¸ªé“¾æ¥ï¼Œç”¨äºå¯»æ‰¾æ–¹æ³•åæˆ–å±æ€§ã€‚ç”¨äºé“¾æ¥åŸå‹çš„ä¸€ä¸ªæŒ‡é’ˆã€‚</p></li><li><p><code>prototype</code><br>å½“ç”¨newæ¥æ„é€ ä¸€ä¸ªæ–°çš„å¯¹è±¡çš„æ—¶å€™æ„é€ <code>_proto_</code>çš„æ—¶å€™ç”¨çš„ï¼Œæ˜¯æ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§ã€‚</p></li></ul><h2 id="2-2-å¯¹è±¡çš„è¡¨ç°å½¢å¼"><a href="#2-2-å¯¹è±¡çš„è¡¨ç°å½¢å¼" class="headerlink" title="2.2 å¯¹è±¡çš„è¡¨ç°å½¢å¼"></a>2.2 å¯¹è±¡çš„è¡¨ç°å½¢å¼</h2><ul><li>Object </li><li>Function </li></ul><h1 id="3-Conclusion"><a href="#3-Conclusion" class="headerlink" title="3. Conclusion"></a>3. Conclusion</h1><p>å…¶å®æ˜¯ä¸€ç§å§”æ‰˜æ–¹å¼ï¼Œé€šè¿‡ä¸€ä¸ªåºåˆ—çš„æŒ‡é’ˆæ¥å®šä½å±æ€§ï¼Œå¯»æ‰¾æ•°æ®ã€‚å¯ä»¥å¸¦æ¥è¿è¡Œæ—¶çš„çµæ´»æ€§ï¼Œæ•°æ®æ–¹æ³•éƒ½å¯ä»¥è¿›è¡Œä¿®æ”¹äº†ã€‚ </p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç¨‹èŒƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹èŒƒå¼ç³»åˆ—-å‡½æ•°å¼ç¼–ç¨‹</title>
      <link href="/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
      <url>/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E7%B3%BB%E5%88%97-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»c-åˆ°å‡½æ•°å¼ç¼–ç¨‹"><a href="#1-ä»c-åˆ°å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="1. ä»c++åˆ°å‡½æ•°å¼ç¼–ç¨‹"></a>1. ä»c++åˆ°å‡½æ•°å¼ç¼–ç¨‹</h1><p>C++å¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†Cè¯­è¨€ä¸­çš„å„ç§é—®é¢˜å’Œä¸ä¾¿ï¼Œå°¤å…¶æ˜¯é€šè¿‡ç±»ã€æ¨¡æ¿ã€è™šå‡½æ•°å’Œè¿è¡Œæ—¶è¯†åˆ«ï¼Œè§£å†³äº†Cè¯­è¨€çš„æ³›å‹ç¼–ç¨‹é—®é¢˜ã€‚å‡½æ•°å¼ç¼–ç¨‹ -&gt; æ›´ä¸ºæŠ½è±¡çš„æ³›å‹ã€‚</p><h1 id="2-å‡½æ•°å¼ç¼–ç¨‹"><a href="#2-å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="2. å‡½æ•°å¼ç¼–ç¨‹"></a>2. å‡½æ•°å¼ç¼–ç¨‹</h1><h2 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h2><p>å‡½æ•°å¼ç¼–ç¨‹åªå…³å¿ƒ**å®šä¹‰çš„è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®ç›¸å…³çš„å…³ç³»ï¼Œæ•°å­¦è¡¨è¾¾å¼é‡Œé¢å…¶å®æ˜¯åœ¨åšä¸€ç§æ˜ å°„(mapping)ï¼Œè¾“å…¥çš„æ•°æ®å’Œè¾“å‡ºçš„æ•°æ®å…³ç³»æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œæ˜¯ç”¨å‡½æ•°æ¥å®šä¹‰çš„ã€‚</p><h2 id="2-2-ç‰¹å¾"><a href="#2-2-ç‰¹å¾" class="headerlink" title="2.2 ç‰¹å¾"></a>2.2 ç‰¹å¾</h2><h3 id="2-2-1-ä¼˜åŠ¿"><a href="#2-2-1-ä¼˜åŠ¿" class="headerlink" title="2.2.1 ä¼˜åŠ¿"></a>2.2.1 ä¼˜åŠ¿</h3><ul><li>stateless </li></ul><p>ä¸ç»´æŠ¤ä»»ä½•çŠ¶æ€ï¼Œç»™æ•°æ®ï¼Œæˆ‘åšå¤„ç†ï¼Œç„¶åç»™ä½ å¤„ç†å®Œçš„æ•°æ®ï¼Œä¸­é—´çš„è¿‡ç¨‹é‡ç”¨å®Œå°±æ²¡äº†</p><p>æ— çŠ¶æ€çš„è¯å¹¶è¡Œæ‰§è¡Œæ— å®³äº†ï¼Œé‡æ„ä»£ç æ— ä¼¤å®³</p><ul><li>immutable</li></ul><p>è¾“å…¥æ•°æ®åŠ¨äº†ï¼Œè¾“å‡ºæ•°æ®ä¹Ÿä¼šå˜ï¼Œæ„å‘³ç€æ–°çš„æ•°æ®é›†ä¼šè¢«è¿”å›</p><ul><li>æƒ°æ€§æ±‚å€¼</li></ul><p>è¡¨è¾¾å¼ä¸åœ¨å®ƒè¢«ç»‘å®šåˆ°å˜é‡ä¹‹åç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯åœ¨è¯¥å€¼è¢«å–ç”¨çš„æ—¶å€™æ±‚å€¼ã€‚</p><ul><li><p>ç¡®å®šæ€§</p><p>f(x)=y, è¿™ä¸ªå‡½æ•°æ— è®ºåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œéƒ½ä¼šå¾—åˆ°åŒæ ·çš„ç»“æœï¼Œè¿™ä¸ªæˆ‘ä»¬ç§°ä¹‹ä¸ºå‡½æ•°çš„ç¡®å®šæ€§ã€‚è€Œä¸æ˜¯åƒç¨‹åºä¸­çš„å¾ˆå¤šå‡½æ•°é‚£æ ·ï¼ŒåŒä¸€ä¸ªå‚æ•°ï¼Œå´ä¼šåœ¨ä¸åŒçš„åœºæ™¯ä¸‹è®¡ç®—å‡ºä¸åŒçš„ç»“æœã€‚æ‰€è°“ä¸åŒçš„åœºæ™¯ï¼Œå°±æ˜¯æˆ‘ä»¬çš„å‡½æ•°ä¼šæ ¹æ®è¿è¡Œä¸­çš„çŠ¶æ€ä¿¡æ¯çš„ä¸åŒè€Œå‘ç”Ÿå˜åŒ–ã€‚</p><h3 id="2-2-2-åŠ£åŠ¿"><a href="#2-2-2-åŠ£åŠ¿" class="headerlink" title="2.2.2 åŠ£åŠ¿"></a>2.2.2 åŠ£åŠ¿</h3><ul><li>æ•°æ®å¤åˆ¶å¾ˆä¸¥é‡</li><li>å‡½æ•°å¼ç¼–ç¨‹æŠ½è±¡åº¦æ›´é«˜ï¼Œå®ç°æ–¹å¼ä¸Šï¼Œå‡½æ•°å¥—å‡½æ•°ï¼Œå‡½æ•°è¿”å›å‡½æ•°ï¼Œå‡½æ•°é‡Œå®šä¹‰å‡½æ•°â€¦ </li></ul></li></ul><h2 id="2-3-å‡½æ•°å¼ç¼–ç¨‹ç”¨åˆ°çš„æŠ€æœ¯"><a href="#2-3-å‡½æ•°å¼ç¼–ç¨‹ç”¨åˆ°çš„æŠ€æœ¯" class="headerlink" title="2.3 å‡½æ•°å¼ç¼–ç¨‹ç”¨åˆ°çš„æŠ€æœ¯"></a>2.3 å‡½æ•°å¼ç¼–ç¨‹ç”¨åˆ°çš„æŠ€æœ¯</h2><ul><li>first class function å¤´ç­‰å‡½æ•°</li></ul><p>æŠŠå‡½æ•°å½“æˆå˜é‡æ¥ä½¿ç”¨ã€‚å¯ä»¥åƒå˜é‡ä¸€æ ·è¢«åˆ›å»ºã€ä¿®æ”¹ï¼Œå¹¶å½“æˆå˜é‡ä¸€æ ·ä¼ é€’ã€è¿”å›ï¼Œæˆ–è€…æ˜¯åœ¨å‡½æ•°ä¸­åµŒå¥—å‡½æ•° </p><ul><li>tail recursion optimization å°¾é€’å½’ä¼˜åŒ–</li></ul><p>å¦‚æœé€’å½’å¾ˆæ·±çš„è¯ï¼Œstackå—ä¸äº†ï¼Œä¼šå¯¼è‡´æ€§èƒ½å¤§å¹…åº¦ä¸‹é™ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨å°¾é€’å½’ä¼˜åŒ–æŠ€æœ¯ï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™éƒ½ä¼šé‡ç”¨stack</p><ul><li><p>map &amp; reduce</p></li><li><p>pipeline </p></li></ul><p>å°†å‡½æ•°å®ä¾‹æˆä¸€ä¸ªä¸ªactionï¼Œç„¶åå°†ä¸€ç»„actionæ”¾åˆ°ä¸€ä¸ªæ•°ç»„æˆ–åˆ—è¡¨ä¸­ï¼Œå†æŠŠæ•°æ®ä¼ ç»™è¿™ä¸ªaction listï¼Œæ•°æ®å°±è¢«å„ä¸ªå‡½æ•°æ‰€æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p><ul><li>recursing</li></ul><p>å°†å¤æ‚é—®é¢˜ç”¨ç®€å•çš„ä»£ç æè¿°å‡ºæ¥ã€‚</p><ul><li>currying é¢—ç²’åŒ–</li></ul><p>å°†ä¸€ä¸ªå‡½æ•°çš„å¤šä¸ªå‚æ•°åˆ†è§£æˆå¤šä¸ªå‡½æ•°ï¼Œç„¶åå°†å‡½æ•°å¤šå±‚å°è£…èµ·æ¥ï¼Œæ¯å±‚å‡½æ•°éƒ½è¿”å›ä¸€ä¸ªå‡½æ•°å»æ¥æ”¶ä¸‹ä¸€ä¸ªå‚æ•°ï¼Œè¿™å¯ä»¥ç®€åŒ–å‡½æ•°çš„å¤šä¸ªå‚æ•°ã€‚</p><ul><li>higher order function é«˜é˜¶å‡½æ•°</li></ul><p>å‡½æ•°å½“å‚æ•°ï¼ŒæŠŠä¼ å…¥çš„å‡½æ•°åšä¸€ä¸ªå°è£…ï¼Œç„¶åè¿”å›è¿™ä¸ªå°è£…å‡½æ•°</p><h2 id="2-4-å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µ"><a href="#2-4-å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µ" class="headerlink" title="2.4 å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µ"></a>2.4 å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µ</h2><pre><code>// éå‡½æ•°å¼ï¼Œæœ‰çŠ¶æ€çš„int cnt;void increment() {    cnt ++;}// å‡½æ•°å¼ï¼Œ æ— çŠ¶æ€çš„int increment(int cnt) {    return cnt + 1;}</code></pre><ul><li>æŠŠå‡½æ•°å½“æˆå˜é‡æ¥ç”¨ï¼Œå…³æ³¨æè¿°é—®é¢˜è€Œä¸æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¯ä»¥è®©ä»£ç æ›´æ˜“è¯»</li><li>å› ä¸ºå‡½æ•°è¿”å›é‡Œé¢çš„è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥å‡½æ•°å…³æ³¨çš„æ˜¯è¡¨è¾¾å¼ï¼Œå…³æ³¨çš„æ˜¯æè¿°è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸æ˜¯å¦‚ä½•å®ç°çš„</li></ul><h3 id="2-4-1-å‡½æ•°å¼ç¼–ç¨‹ä¾‹å­"><a href="#2-4-1-å‡½æ•°å¼ç¼–ç¨‹ä¾‹å­" class="headerlink" title="2.4.1  å‡½æ•°å¼ç¼–ç¨‹ä¾‹å­"></a>2.4.1  å‡½æ•°å¼ç¼–ç¨‹ä¾‹å­</h3><p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹ç›¸å…³çš„ç¤ºä¾‹ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ 3 è¾†è½¦æ¯”èµ›ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬åˆ†åˆ«ç»™è¿™ 3 è¾†è½¦æœ‰ 70% çš„æ¦‚ç‡å¯ä»¥å¾€å‰èµ°ä¸€æ­¥ï¼Œä¸€å…±æœ‰ 5 æ¬¡æœºä¼šï¼Œç„¶åæ‰“å‡ºæ¯ä¸€æ¬¡è¿™ 3 è¾†è½¦çš„å‰è¡ŒçŠ¶æ€ã€‚</p><pre><code>// Imperative Programming from random import randomtime = 5car_positions = [1, 1, 1]while time:    # decrease time    time -= 1    print &#39;&#39;    for i in range(len(car_positions)):        # move car        if random() &gt; 0.3:            car_positions[i] += 1        # draw car        print &#39;-&#39; * car_positions[i]</code></pre><p>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯å°†å¾ªç¯åˆ†æˆäº†å‡ ä¸ªå°å‡½æ•°ï¼Œä½†æ˜¯ç›¸äº’ä¹‹é—´çš„å‚æ•°æ˜¯å…±äº«çš„ï¼Œå‡½æ•°æ˜¯æœ‰çŠ¶æ€çš„ã€‚</p><pre><code>// make it to some function model from random import randomdef move_cars():    for i, _ in enumerate(car_positions):        if random() &gt; 0.3:            car_positions[i] += 1def draw_car(car_position):    print &#39;-&#39; * car_positiondef run_step_of_race():    global time    time -= 1    move_cars()def draw():    print &#39;&#39;    for car_position in car_positions:        draw_car(car_position)time = 5car_positions = [1, 1, 1]while time:    run_step_of_race()    draw()</code></pre><p>å‡½æ•°å¼å†™æ³•</p><pre><code>from random import randomdef move_cars(car_positions):    return map(lambda x: x + 1 if random() &gt; 0.3 else x, car_positions)def output_car(car_position):    return &#39;-&#39; * car_positiondef run_step_of_race(state):    return {&#39;time&#39;: state[&#39;time&#39;] - 1, &#39;car_positions&#39;: move_cars(state[&#39;car_positions&#39;])}def draw(state):    print &#39;&#39;    print &#39;\n&#39;.join(map(output_car, state[&#39;car_positions&#39;]))def race(state):    draw(state)    if state[&#39;time&#39;]:        race(run_step_of_race(state))race({&#39;time&#39;: 5,      &#39;car_positions&#39;: [1, 1, 1]})</code></pre><p>ä¸Šé¢çš„ä»£ç ä¾ç„¶æŠŠç¨‹åºçš„é€»è¾‘åˆ†æˆäº†å‡½æ•°ã€‚ä¸è¿‡è¿™äº›å‡½æ•°éƒ½æ˜¯å‡½æ•°å¼çš„ï¼Œå®ƒä»¬æœ‰ä¸‰ä¸ªç‰¹ç‚¹ï¼šå®ƒä»¬ä¹‹é—´æ²¡æœ‰å…±äº«çš„å˜é‡ï¼›å‡½æ•°é—´é€šè¿‡å‚æ•°å’Œè¿”å›å€¼æ¥ä¼ é€’æ•°æ®ï¼›åœ¨å‡½æ•°é‡Œæ²¡æœ‰ä¸´æ—¶å˜é‡ã€‚</p><h2 id="2-5-å‡½æ•°å¼è¯­è¨€å¸¸ç”¨å‡½æ•°"><a href="#2-5-å‡½æ•°å¼è¯­è¨€å¸¸ç”¨å‡½æ•°" class="headerlink" title="2.5 å‡½æ•°å¼è¯­è¨€å¸¸ç”¨å‡½æ•°"></a>2.5 å‡½æ•°å¼è¯­è¨€å¸¸ç”¨å‡½æ•°</h2><ol><li>map()</li><li>reduce()</li><li>filter()</li></ol><p>å¥½å¤„ï¼š </p><ol><li>æ•°æ®é›†ã€å¯¹æ•°æ®çš„æ“ä½œå’Œè¿”å›å€¼éƒ½æ”¾åœ¨äº†ä¸€èµ·ã€‚</li><li>æ²¡æœ‰äº†å¾ªç¯ä½“ï¼Œå°±å¯ä»¥å°‘äº†äº›ä¸´æ—¶ç”¨æ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œé€»è¾‘çš„å˜é‡ï¼Œä¹Ÿå°‘äº†æŠŠæ•°æ®å€’æ¥å€’å»çš„æ§åˆ¶é€»è¾‘ã€‚</li><li>ä»£ç å˜æˆäº†åœ¨æè¿°ä½ è¦å¹²ä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€ä¹ˆå¹²</li></ol><h3 id="2-5-1-E-G"><a href="#2-5-1-E-G" class="headerlink" title="2.5.1 E.G"></a>2.5.1 E.G</h3><p>process: </p><ol><li>æ‰¾å‡ºå¶æ•°</li><li>ä¹˜3</li><li>è½¬æˆå­—ç¬¦ä¸²</li></ol><pre><code>def process(num):# filter out non-evensif num % 2 != 0:    returnnum = num * 3num = &#39;The Number: %s&#39; % numreturn numnums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]for num in nums:    print process(num)# è¾“å‡ºï¼š# None# The Number: 6# None# The Number: 12# None# The Number: 18# None# The Number: 24# None# The Number: 30</code></pre><p>pipeline way</p><p>ä½¿ç”¨äº†yieldå…³é”®å­—ï¼Œè¿”å›generatorï¼Œä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ ï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„æ‰§è¡Œå‡½æ•°ã€‚æ„å‘³ç€åªæœ‰å…¶è¿”å›çš„è¿­ä»£å¯¹è±¡è¢«è¿­ä»£æ—¶ï¼Œyieldå‡½æ•°æ‰ä¼šçœŸæ­£è¿è¡Œ</p><pre><code>def even_filter(nums):for num in nums:    if num % 2 == 0:        yield numdef multiply_by_three(nums):    for num in nums:        yield num * 3def convert_to_string(nums):    for num in nums:        yield &#39;The Number: %s&#39; % numnums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]pipeline = convert_to_string(multiply_by_three(even_filter(nums)))for num in pipeline:    print num# è¾“å‡ºï¼š# The Number: 6# The Number: 12# The Number: 18# The Number: 24# The Number: 30</code></pre><p>ä½¿ç”¨map &amp; reduce</p><pre><code>def even_filter(nums):return filter(lambda x: x%2==0, nums)def multiply_by_three(nums):    return map(lambda x: x*3, nums)def convert_to_string(nums):    return map(lambda x: &#39;The Number: %s&#39; % x,  nums)nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]pipeline = convert_to_string(               multiply_by_three(                   even_filter(nums)               )            )for num in pipeline:    print num</code></pre><p>pipeline model </p><pre><code>class Pipe(object):def __init__(self, func):    self.func = funcdef __ror__(self, other):    def generator():        for obj in other:            if obj is not None:                yield self.func(obj)    return generator()@Pipedef even_filter(num):    return num if num % 2 == 0 else None@Pipedef multiply_by_three(num):    return num*3@Pipedef convert_to_string(num):    return &#39;The Number: %s&#39; % num@Pipedef echo(item):    print item    return itemdef force(sqs):    for item in sqs: passnums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]force(nums | even_filter | multiply_by_three | convert_to_string | echo)</code></pre><h2 id="3-ä¿®é¥°å™¨æ¨¡å¼-decorator"><a href="#3-ä¿®é¥°å™¨æ¨¡å¼-decorator" class="headerlink" title="3. ä¿®é¥°å™¨æ¨¡å¼ decorator"></a>3. ä¿®é¥°å™¨æ¨¡å¼ decorator</h2><p>Python ç”¨ä¸€ä¸ªå‡½æ•°æ¥æ„é€ å¦ä¸€ä¸ªå‡½æ•°</p><pre><code>def hello(fn):    def wrapper():        print &quot;hello, %s&quot; % fn.__name__        fn()        print &quot;goodbye, %s&quot; % fn.__name__    return wrapper@hellodef Hao():    print &quot;i am Hao Chen&quot;Hao()// code result:$ python hello.pyhello, Haoi am Hao Chengoodbye, Hao</code></pre><p>Hello æ³¨è§£å°±æ˜¯æˆ‘ä»¬å‰é¢å®šä¹‰çš„helloå‡½æ•°ï¼Œhelloå‡½æ•°ä¸­éœ€è¦ä¸€ä¸ªå‚æ•°fnï¼Œç”¨æ¥åšå›è°ƒï¼Œhelloå‡½æ•°ä¸­è¿”å›äº†ä¸€ä¸ªinnerå‡½æ•°wrapperï¼Œå›è°ƒäº†ä¼ è¿›æ¥çš„fn</p><h2 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4. æ€»ç»“"></a>4. æ€»ç»“</h2><p>å‡½æ•°å¼ç¼–ç¨‹ï¼Œå°†è¿ç®—è¿‡ç¨‹å°½é‡å†™æˆä¸€ç³»åˆ—åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œå…³æ³¨çš„æ˜¯åšä»€ä¹ˆè€Œä¸æ˜¯æ€ä¹ˆåšï¼Œè¢«ç§°ä¸ºå£°æ˜å¼ç¼–ç¨‹ã€‚ä»¥statelesså’Œimmutableä¸ºä¸»è¦ç‰¹ç‚¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç¨‹èŒƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬”è®° - é¢†åŸŸé©±åŠ¨è®¾è®¡ by Eric Evans</title>
      <link href="/%E7%AC%94%E8%AE%B0-%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1-by-Eric-Evans/"/>
      <url>/%E7%AC%94%E8%AE%B0-%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1-by-Eric-Evans/</url>
      
        <content type="html"><![CDATA[<p>åœ¨çœ‹åšæ–‡çš„æ—¶å€™çœ‹åˆ°äº†å…³äºDDDçš„å†…å®¹ï¼Œç¡®å®å‘ç°åœ¨å·¥ç¨‹ä¸Šç¢°åˆ°äº†ä¸€äº›äº›é—®é¢˜ï¼Œå…³äºæ ¸å¿ƒé¢†åŸŸï¼Œå…³äºé¢†åŸŸé©±åŠ¨ï¼Œæ¯•ç«ŸæŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å®é™…é—®é¢˜çš„ï¼Œåªæœ‰åœ¨å¯¹æŸä¸ªé¢†åŸŸæœ‰ç€è¾ƒæ·±çš„ç†è§£çš„å‰æä¸‹ï¼Œæ‰èƒ½åšå‡ºæ›´æœ‰åˆ©äºç»´æŠ¤ï¼Œæ›´å®¹æ˜“æ‰©å±•çš„è½¯ä»¶ã€‚</p><p>æœ¬ä¹¦æƒ³è¯´çš„å°±æ˜¯åœ¨å¤§è§„æ¨¡å·¥ç¨‹ä¸Šï¼Œå¦‚ä½•æ¥æ§åˆ¶æ•´ä½“çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªè‰¯å¥½çš„é¢†åŸŸæ¨¡å‹ï¼Œä¸ä»…ä»…åœç•™åœ¨é¢†åŸŸçš„è¡¨é¢ï¼Œè€Œæ˜¯è¦é€è¿‡è¡¨è±¡æŠ“ä½é¢†åŸŸçš„å®è´¨ç»“æ„ï¼Œä»è€Œä¸ºè½¯ä»¶å¼€å‘äººå‘˜æä¾›ä»–ä»¬æ‰€éœ€è¦çš„æ”¯æŒã€‚</p><p>è½¯ä»¶çš„è´Ÿè´£æ€§å¹¶ä¸ä»…ä»…åœ¨æŠ€æœ¯ä¸Šï¼Œè€Œæ˜¯æ¥è‡ªé¢†åŸŸæœ¬èº«ï¼Œç”¨æˆ·çš„æ´»åŠ¨æˆ–ä¸šåŠ¡ã€‚è¿™ç§å¤æ‚æ€§æˆ‘ä»¬éœ€è¦åœ¨è®¾è®¡ä¸Šè€ƒè™‘åˆ°çš„ã€‚</p><p>é¢†åŸŸæ¶‰åŠçš„å‰æï¼š </p><ol><li>åœ¨å¤§å¤šæ•°è½¯ä»¶é¡¹ç›®å½“ä¸­ï¼Œä¸»è¦çš„ç„¦ç‚¹åº”è¯¥æ˜¯é¢†åŸŸå’Œé¢†åŸŸé€»è¾‘</li><li>å¤æ‚çš„é¢†åŸŸè®¾è®¡åº”è¯¥åŸºäºæ¨¡å‹</li></ol><p>é¢†åŸŸé©±åŠ¨è®¾è®¡çš„å®è´¨æ˜¯<strong>æ¶ˆåŒ–å¸æ”¶å¤§é‡çŸ¥è¯†ï¼Œæœ€åäº§ç”Ÿä¸€ä¸ªåæ˜ æ·±å±‚æ¬¡é¢†åŸŸçŸ¥è¯†å¹¶èšç„¦äºå…³é”®æ¦‚å¿µçš„æ¨¡å‹</strong></p><h1 id="1-è®©é¢†åŸŸæ¨¡å‹å‘æŒ¥ä½œç”¨-é¢†åŸŸé©±åŠ¨å¼€å‘çš„åŸºæœ¬ç›®æ ‡"><a href="#1-è®©é¢†åŸŸæ¨¡å‹å‘æŒ¥ä½œç”¨-é¢†åŸŸé©±åŠ¨å¼€å‘çš„åŸºæœ¬ç›®æ ‡" class="headerlink" title="1. è®©é¢†åŸŸæ¨¡å‹å‘æŒ¥ä½œç”¨ - é¢†åŸŸé©±åŠ¨å¼€å‘çš„åŸºæœ¬ç›®æ ‡"></a>1. è®©é¢†åŸŸæ¨¡å‹å‘æŒ¥ä½œç”¨ - é¢†åŸŸé©±åŠ¨å¼€å‘çš„åŸºæœ¬ç›®æ ‡</h1><h2 id="1-1-å‡ ä¸ªåŸºæœ¬é—®é¢˜"><a href="#1-1-å‡ ä¸ªåŸºæœ¬é—®é¢˜" class="headerlink" title="1.1 å‡ ä¸ªåŸºæœ¬é—®é¢˜"></a>1.1 å‡ ä¸ªåŸºæœ¬é—®é¢˜</h2><ul><li>ä»€ä¹ˆæ˜¯æ¨¡å‹ï¼Ÿ <ul><li>æ¨¡å‹æ˜¯ä¸€ç§ç®€åŒ–ï¼Œæ˜¯å¯¹ç°å®çš„è§£é‡Šï¼Œå¹¶æŠŠä¸è§£å†³é—®é¢˜å¯†åˆ‡ç›¸å…³çš„æ–¹é¢æŠ½è±¡å‡ºæ¥ï¼Œè€Œå¿½ç•¥æ— å…³çš„ç»†èŠ‚ã€‚  </li><li>æ¨¡å‹æ˜¯ä¸ºäº†è§£å†³ä¿¡æ¯è¶…è½½é—®é¢˜çš„å·¥å…·</li><li>æ¨¡å‹æ˜¯ä¸€ç§çŸ¥è¯†å½¢å¼ï¼Œå®ƒå¯¹çŸ¥è¯†è¿›è¡Œæœ‰é€‰æ‹©çš„ç®€åŒ–å’Œæœ‰ç›®çš„çš„ç»“æ„åŒ– </li></ul></li><li>å¦‚ä½•ç•Œå®šé¢†åŸŸï¼Ÿ<ul><li>æ¯ä¸ªè½¯ä»¶ç¨‹åºçš„ç›®çš„éƒ½æ˜¯ä¸ºäº†æ‰§è¡ŒæŸé¡¹æ´»åŠ¨ï¼Œæˆ–è€…æ»¡è¶³ç”¨æˆ·çš„æŸç§éœ€æ±‚ã€‚ç”¨æˆ·ä¼šå°†è½¯ä»¶ç¨‹åºåº”ç”¨åœ¨æŸä¸ªä¸»é¢˜åŒºåŸŸå½“ä¸­ï¼Œè¿™ä¸ªåŒºåŸŸå°±å«åšè½¯ä»¶çš„é¢†åŸŸã€‚</li></ul></li><li>è½¯ä»¶çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ <ul><li>ç”¨æˆ·è§£å†³é¢†åŸŸç›¸å…³çš„é—®é¢˜çš„èƒ½åŠ› </li></ul></li></ul><h2 id="1-2-å¦‚ä½•æœ‰æ•ˆæ¶ˆåŒ–çŸ¥è¯†ï¼Ÿ"><a href="#1-2-å¦‚ä½•æœ‰æ•ˆæ¶ˆåŒ–çŸ¥è¯†ï¼Ÿ" class="headerlink" title="1.2 å¦‚ä½•æœ‰æ•ˆæ¶ˆåŒ–çŸ¥è¯†ï¼Ÿ"></a>1.2 å¦‚ä½•æœ‰æ•ˆæ¶ˆåŒ–çŸ¥è¯†ï¼Ÿ</h2><h3 id="1-2-1-æœ‰æ•ˆå»ºæ¨¡çš„è¦ç´ "><a href="#1-2-1-æœ‰æ•ˆå»ºæ¨¡çš„è¦ç´ " class="headerlink" title="1.2.1 æœ‰æ•ˆå»ºæ¨¡çš„è¦ç´ "></a>1.2.1 æœ‰æ•ˆå»ºæ¨¡çš„è¦ç´ </h3><ul><li>æ¨¡å‹ä¸å®ç°çš„ç»‘å®š  <ul><li>åœ¨æ¨¡å‹ä¸å®ç°ä¹‹é—´å»ºç«‹æ—©æœŸè¿æ¥ï¼Œåœ¨åç»­çš„æ‰€æœ‰è¿­ä»£å½“ä¸­ç»´æŠ¤è¯¥åŸå‹</li></ul></li><li>è·å¾—ä¸€ç§åŸºäºæ¨¡å‹çš„è¯­è¨€<ul><li>ä¸šåŠ¡å’ŒæŠ€æœ¯ä¸Šçš„å¯¹åº”çš„æ¨¡å‹çš„ç†Ÿæ‚‰ï¼Œå¯¹äºåè¯çš„æ„æ€è¾¾æˆä¸€è‡´</li></ul></li><li>å¼€å‘ä¸€ä¸ªè•´å«ä¸°å¯ŒçŸ¥è¯†çš„æ¨¡å‹</li><li>æç‚¼æ¨¡å‹ - ä¿è¯æ¨¡å‹æ•´ä½“ç»“æ„çš„ç²¾ç‚¼</li></ul><h3 id="1-2-2-çŸ¥è¯†æ¶ˆåŒ–"><a href="#1-2-2-çŸ¥è¯†æ¶ˆåŒ–" class="headerlink" title="1.2.2 çŸ¥è¯†æ¶ˆåŒ–"></a>1.2.2 çŸ¥è¯†æ¶ˆåŒ–</h3><p>åœ¨å¤§é‡ä¿¡æ¯å½“ä¸­æ¢å¯»æœ‰ç”¨çš„éƒ¨åˆ†ï¼Œç”±å¼€å‘äººå‘˜å’Œé¢†åŸŸä¸“å®¶ç»„æˆçš„å›¢é˜Ÿå…±åŒåä½œï¼Œæ”¶é›†ä¿¡æ¯å¹¶å¯»æ‰¾å¯¹ä¿¡æ¯æœ‰æ„ä¹‰çš„ç®€åŒ–è§†å›¾ã€‚</p><p>åœ¨ä½ çš„æ¶æ„å½“ä¸­åº”å½“æœ¬èº«å°±æœ‰é¢†åŸŸçš„ç‰¹å¾ï¼Œå³æŸéƒ¨åˆ†éœ€è¦èƒ½å¤Ÿæ¸…æ™°çš„ååº”å•†ä¸šä¸Šçš„å¯èƒ½éœ€æ±‚å’Œå¯èƒ½çš„æ‹“å±•ã€‚è¿™ç§ä¸œè¥¿å¦‚æœåœ¨åˆšåˆšå¼€å§‹çš„æ—¶å€™å°±èƒ½è¢«ç ”ç©¶åˆ°ï¼Œé‚£ä»¥åå°±ä¼šå¾ˆæ–¹ä¾¿äº†ã€‚</p><p>å¼€å‘å‡ºæ¥çš„è½¯ä»¶æ˜¯éœ€è¦èƒ½å¤Ÿååº”å‡ºé¢†åŸŸä¸“å®¶çš„æ€è€ƒæ–¹å¼çš„ï¼Œæˆ‘ä»¬ç”¨è‡ªå·±çš„æŠ€æœ¯æ¥è§£å†³ä»–ä»¬çš„é—®é¢˜ï¼Œç”¨ä»£ç æ„å»ºä»–ä»¬çš„æ€ç»´ä½“ç³»ã€‚</p><h2 id="1-3-è¯­è¨€çš„äº¤æµå’Œä½¿ç”¨"><a href="#1-3-è¯­è¨€çš„äº¤æµå’Œä½¿ç”¨" class="headerlink" title="1.3 è¯­è¨€çš„äº¤æµå’Œä½¿ç”¨"></a>1.3 è¯­è¨€çš„äº¤æµå’Œä½¿ç”¨</h2><ul><li>æ¨¡å‹ <ul><li>å¤´è„‘ä¸­å½¢æˆçš„ä¸é¡¹ç›®æœ‰å…³çš„æ¦‚å¿µé›†åˆï¼Œç”¨æœ¯è¯­å’Œå…³ç³»åæ˜ äº†é¢†åŸŸçš„æ·±å±‚å«ä¹‰ã€‚è¿™äº›æœ¯è¯­å’Œå…³ç³»æä¾›äº†æ¨¡å‹è¯­è¨€çš„è¯­ä¹‰</li><li>ä¸ä»…ä»…é™äºUMLå›¾ï¼Œéœ€è¦å……åˆ†åˆ©ç”¨å„ç§äº¤æµæ‰‹æ®µï¼Œä»¥æé«˜ä»£ç æœ¬èº«å’Œæµ‹è¯•çš„æ²Ÿé€šèƒ½åŠ›</li></ul></li></ul><h3 id="1-3-1-æ¨¡å¼ï¼š-Ubiquitous-Language"><a href="#1-3-1-æ¨¡å¼ï¼š-Ubiquitous-Language" class="headerlink" title="1.3.1 æ¨¡å¼ï¼š Ubiquitous Language"></a>1.3.1 æ¨¡å¼ï¼š Ubiquitous Language</h3><p>éœ€è¦ä¸€ç§é€šç”¨çš„ï¼Œå…±äº«çš„å›¢é˜Ÿè¯­è¨€ï¼Œè¿™ç§è¯­è¨€åº”è¯¥æ˜¯æ—¶åˆ»è¿›è¡Œæ£€éªŒçš„ã€‚è¯­è¨€ä¸Šçš„é¸¿æ²Ÿï¼Œå³æˆ‘ä»¬å¯¹åŒæ ·çš„è¯è¯­æ˜¯æ²¡æœ‰åŒæ ·çš„è®¤è¯†çš„ï¼Œè¿™å°±å¯¼è‡´äº†å½“æˆ‘ä»¬å¯¹æŸä¸ªé¢†åŸŸä¸å¤Ÿç†Ÿæ‚‰çš„æ—¶å€™ï¼Œå¯¹äºå„ç§æ¦‚å¿µçš„ç†è§£æ˜¯æœ‰å¾ˆå¤§é‡çš„æ¬ ç¼ºçš„ã€‚è€Œå„ç±»äººåœ¨å·¥ä½œçš„æ—¶å€™ä¹Ÿå¾ˆå®¹æ˜“ä¸ºäº†æ–¹ä¾¿åˆ›å»ºå°èŒƒå›´è¾¾æˆå…±è¯†çš„è¯­è¨€ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªå°èŒƒå›´ä¹‹å¤–æ˜¯æ²¡æœ‰äººçŸ¥é“å’Œäº†è§£è¿™ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ„æ€çš„ã€‚</p><ul><li>ä¸ºä»€ä¹ˆéœ€è¦è¿™ç§å…¬å…±è¯­è¨€ï¼Ÿ<ul><li>å°†å›¢é˜Ÿçš„æ²Ÿé€šå’Œè½¯ä»¶å®ç°ç´§å¯†è”ç³»èµ·æ¥</li><li>é¿å…å› ä¸ºå¯¹äºæ¦‚å¿µä¸åŒç†è§£å¸¦æ¥çš„äº¤æµæ²Ÿé€šæˆæœ¬é™¡å¢çš„é—®é¢˜</li></ul></li><li>è¯æ±‡è¡¨<ul><li>ç±»åç§°</li><li>ä¸»è¦æ“ä½œ</li><li>æœ¯è¯­ <ul><li>è®¨è®ºæ¨¡å‹å½“ä¸­å·²ç»æ˜ç¡®çš„è§„åˆ™</li><li>æˆ–è€…æ˜¯æ¨¡å‹ä¸Šçš„é«˜çº§ç»„ç»‡åŸåˆ™</li></ul></li></ul></li><li>tips<ul><li>æ¨¡å‹ä½œä¸ºè¯­è¨€çš„ä¸­å¿ƒï¼Œç¡®ä¿å›¢é˜Ÿåœ¨æ‰€æœ‰äº¤æµæ´»åŠ¨å’Œä»£ç ä¸­åšæŒä½¿ç”¨è¿™ç§è¯­è¨€</li><li>é€šè¿‡å°è¯•ä¸åŒçš„è¡¨ç¤ºæ–¹æ³•æ¥æ¶ˆé™¤éš¾ç‚¹ï¼Œç„¶åé‡æ„ä»£ç ï¼Œå¹¶å¯¹ç±»ã€æ–¹æ³•å’Œæ¨¡å—é‡æ–°å‘½åï¼Œä»¥ä¾¿ä¸æ–°æ¨¡å‹ä¸€è‡´ã€‚</li><li>éœ€è¦å¯¹å„ç§è¯è¯­ï¼Œæ— è®ºæ˜¯åœ¨å·¥ç¨‹ä¸Šçš„ï¼Œè¿˜æ˜¯åœ¨å•†ä¸šä¸Šçš„ï¼Œéƒ½æœ‰æ›´å¥½çš„ç†è§£</li><li>è¦è®¤è¯†åˆ°Uniquitous Languageå½“ä¸­çš„æ›´æ”¹å°±æ˜¯å¯¹æ¨¡å‹çš„æ›´æ”¹ã€‚</li></ul></li></ul><h3 id="1-3-2-æ–‡æ¡£å’Œå›¾"><a href="#1-3-2-æ–‡æ¡£å’Œå›¾" class="headerlink" title="1.3.2 æ–‡æ¡£å’Œå›¾"></a>1.3.2 æ–‡æ¡£å’Œå›¾</h3><ul><li>UMLå›¾æœ‰ç”¨ï¼Œä½†æ˜¯ä¼šå®¹æ˜“æ˜¯ä½ é™·å…¥ç»†èŠ‚å½“ä¸­</li><li>å›¾åº”è¯¥æ˜¯ä¸€ç§ç›´è§‚çš„ç»™ä½ ç»¼åˆæ¦‚å¿µå’Œè§†è§’çš„å·¥å…·ï¼Œè€Œä¸æ˜¯è½äºç»†èŠ‚å½“ä¸­ã€‚</li><li>è®¾è®¡çš„é‡è¦ç»†èŠ‚åº”è¯¥åœ¨ä»£ç å½“ä¸­ä½“ç°å‡ºæ¥</li></ul><ul><li>ä¹¦é¢è®¾è®¡æ–‡æ¡£<ul><li>æä¾›ç¨³å®šå’Œå…±äº«çš„äº¤æµ</li><li>æ–‡æ¡£åº”è¯¥ä½œä¸ºä»£ç å’Œå£å¤´äº¤æµçš„è¡¥å……</li></ul></li><li>è§£é‡Šæ€§æ¨¡å‹<ul><li>æ²¡æœ‰UML æ²¡æœ‰ç±»</li><li>å°±æ˜¯å•çº¯çš„ç”¨å›¾æ¥æè¿°å•†ä¸šä¸Šçš„ä½¿ç”¨æ¡ˆä¾‹</li></ul></li></ul><h1 id="2-æ¨¡å‹é©±åŠ¨è®¾è®¡çš„æ„é€ å—-é˜è¿°æ ¸å¿ƒæœ€ä½³å®è·µ"><a href="#2-æ¨¡å‹é©±åŠ¨è®¾è®¡çš„æ„é€ å—-é˜è¿°æ ¸å¿ƒæœ€ä½³å®è·µ" class="headerlink" title="2. æ¨¡å‹é©±åŠ¨è®¾è®¡çš„æ„é€ å— - é˜è¿°æ ¸å¿ƒæœ€ä½³å®è·µ"></a>2. æ¨¡å‹é©±åŠ¨è®¾è®¡çš„æ„é€ å— - é˜è¿°æ ¸å¿ƒæœ€ä½³å®è·µ</h1><h1 id="3-é€šè¿‡é‡æ„åŠ æ·±ç†è§£-å¦‚ä½•å°†æ„é€ å—è£…é…ä¸ºå®ç”¨çš„æ¨¡å‹"><a href="#3-é€šè¿‡é‡æ„åŠ æ·±ç†è§£-å¦‚ä½•å°†æ„é€ å—è£…é…ä¸ºå®ç”¨çš„æ¨¡å‹" class="headerlink" title="3. é€šè¿‡é‡æ„åŠ æ·±ç†è§£ - å¦‚ä½•å°†æ„é€ å—è£…é…ä¸ºå®ç”¨çš„æ¨¡å‹"></a>3. é€šè¿‡é‡æ„åŠ æ·±ç†è§£ - å¦‚ä½•å°†æ„é€ å—è£…é…ä¸ºå®ç”¨çš„æ¨¡å‹</h1><h1 id="4-æˆ˜ç•¥è®¾è®¡-è®¨è®ºåœ¨å¤æ‚ç³»ç»Ÿäº¤äº’ä¸­çš„æƒ…å†µ"><a href="#4-æˆ˜ç•¥è®¾è®¡-è®¨è®ºåœ¨å¤æ‚ç³»ç»Ÿäº¤äº’ä¸­çš„æƒ…å†µ" class="headerlink" title="4. æˆ˜ç•¥è®¾è®¡ - è®¨è®ºåœ¨å¤æ‚ç³»ç»Ÿäº¤äº’ä¸­çš„æƒ…å†µ"></a>4. æˆ˜ç•¥è®¾è®¡ - è®¨è®ºåœ¨å¤æ‚ç³»ç»Ÿäº¤äº’ä¸­çš„æƒ…å†µ</h1>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> System Design </tag>
            
            <tag> BackEnd </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -é«˜æ€§èƒ½æ¶æ„æ¨¡å¼</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E6%80%A7%E8%83%BD%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E6%80%A7%E8%83%BD%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é«˜æ€§èƒ½æ¶æ„æ¨¡å¼ï¼Œæœ¬æ–‡ä¼šæ€»ç»“ä¸šç•Œç›¸å¯¹æ¯”è¾ƒæˆç†Ÿçš„å„ç§æ¶æ„æ¨¡å¼ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåŸºäºè¿™äº›å·²æœ‰çš„æˆç†Ÿæ¨¡å¼ï¼Œç»“åˆä¸šåŠ¡å’Œå›¢é˜Ÿçš„å…·ä½“æƒ…å†µæ¥è¿›è¡Œä¸€å®šçš„ä¼˜åŒ–æˆ–è°ƒæ•´ã€‚</p><p>å¾ˆå¤šæƒ…å†µä¸‹é«˜æ€§èƒ½çš„è®¾è®¡æœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯å…³ç³»æ•°æ®åº“çš„è®¾è®¡ã€‚å•ä¸ªæ•°æ®åº“åœ¨å½“å‰æƒ…å†µä¸‹æ˜¯å¾ˆéš¾æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„äº†ï¼Œå¿…é¡»è€ƒè™‘<strong>æ•°æ®åº“é›†ç¾¤</strong>çš„æ–¹å¼æ¥æå‡æ€§èƒ½ã€‚é«˜æ€§èƒ½æ¶æ„ï¼Œå…¶å…³é”®ç‚¹å°±åœ¨äºæ•°æ®åº“å±‚å¦‚ä½•å®ç°é«˜æ€§èƒ½ï¼Œæœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œå…ˆæ¥ä»‹ç»è¯»å†™åˆ†ç¦»åŸç†ã€‚</p><h1 id="1-é«˜æ€§èƒ½æ•°æ®åº“é›†ç¾¤-è¯»å†™åˆ†ç¦»"><a href="#1-é«˜æ€§èƒ½æ•°æ®åº“é›†ç¾¤-è¯»å†™åˆ†ç¦»" class="headerlink" title="1. é«˜æ€§èƒ½æ•°æ®åº“é›†ç¾¤ - è¯»å†™åˆ†ç¦»"></a>1. é«˜æ€§èƒ½æ•°æ®åº“é›†ç¾¤ - è¯»å†™åˆ†ç¦»</h1><p>è¯»å†™åˆ†ç¦»çš„åŸºæœ¬åŸç†å°±æ˜¯å°†æ•°æ®åº“è¯»å†™æ“ä½œåˆ†æ•£åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚<br><img src="https://i.loli.net/2020/02/04/DHT92UafyWt4hZx.png" alt="fig1.png"></p><h2 id="1-1-åŸºæœ¬å®ç°-ä¸»ä»é›†ç¾¤"><a href="#1-1-åŸºæœ¬å®ç°-ä¸»ä»é›†ç¾¤" class="headerlink" title="1.1 åŸºæœ¬å®ç° - ä¸»ä»é›†ç¾¤"></a>1.1 åŸºæœ¬å®ç° - ä¸»ä»é›†ç¾¤</h2><ul><li>æ•°æ®åº“æœåŠ¡å™¨æ­å»ºä¸»ä»é›†ç¾¤ï¼Œä¸€ä¸»ä¸€ä»åˆ°ä¸€ä¸»å¤šä»çš†å¯ã€‚</li><li>æ•°æ®åº“ä¸»æœºè´Ÿè´£è¯»å†™æ“ä½œï¼Œä»æœºåªè´Ÿè´£è¯»æ“ä½œ</li><li>æ•°æ®åº“ä¸»æœºé€šè¿‡å¤åˆ¶å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œæ¯å°æ•°æ®åº“æœåŠ¡å™¨éƒ½å­˜å‚¨äº†æ‰€æœ‰çš„ä¸šåŠ¡æ•°æ®</li><li>ä¸šåŠ¡æœåŠ¡å™¨å°†å†™æ“ä½œå‘ç»™æ•°æ®åº“ä¸»æœºï¼Œå°†è¯»æ“ä½œå‘ç»™æ•°æ®åº“ä»æœº</li></ul><p>æ³¨æ„è¿™é‡Œå®ç°çš„ä¸»ä»é›†ç¾¤ï¼Œè€Œä¸æ˜¯ä¸»å¤‡é›†ç¾¤ï¼Œä¸»ä»ï¼Œä»å±çš„è¿˜æ˜¯è¦æ¥æ”¶è¯·æ±‚çš„ï¼Œä¸»å¤‡ä¸­çš„å¤‡æ˜¯å®Œå…¨çš„å¤‡ç”¨ç›®çš„ï¼ŒåŸºæœ¬ä¸ä¼šæœ‰æµé‡ã€‚</p><h2 id="1-2-ä¸»ä»å¤åˆ¶å»¶è¿Ÿ"><a href="#1-2-ä¸»ä»å¤åˆ¶å»¶è¿Ÿ" class="headerlink" title="1.2 ä¸»ä»å¤åˆ¶å»¶è¿Ÿ"></a>1.2 ä¸»ä»å¤åˆ¶å»¶è¿Ÿ</h2><p>ä»¥ MySQL ä¸ºä¾‹ï¼Œä¸»ä»å¤åˆ¶å»¶è¿Ÿå¯èƒ½è¾¾åˆ° 1 ç§’ï¼Œå¦‚æœæœ‰å¤§é‡æ•°æ®åŒæ­¥ï¼Œå»¶è¿Ÿ 1 åˆ†é’Ÿä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚ä¸»ä»å¤åˆ¶å»¶è¿Ÿä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä¸šåŠ¡æœåŠ¡å™¨å°†æ•°æ®å†™å…¥åˆ°æ•°æ®åº“ä¸»æœåŠ¡å™¨åç«‹åˆ»ï¼ˆ1 ç§’å†…ï¼‰è¿›è¡Œè¯»å–ï¼Œæ­¤æ—¶è¯»æ“ä½œè®¿é—®çš„æ˜¯ä»æœºï¼Œä¸»æœºè¿˜æ²¡æœ‰å°†æ•°æ®å¤åˆ¶è¿‡æ¥ï¼Œåˆ°ä»æœºè¯»å–æ•°æ®æ˜¯è¯»ä¸åˆ°æœ€æ–°æ•°æ®çš„ï¼Œä¸šåŠ¡ä¸Šå°±å¯èƒ½å‡ºç°é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·åˆšæ³¨å†Œå®Œåç«‹åˆ»ç™»å½•ï¼Œä¸šåŠ¡æœåŠ¡å™¨ä¼šæç¤ºä»–â€œä½ è¿˜æ²¡æœ‰æ³¨å†Œâ€ï¼Œè€Œç”¨æˆ·æ˜æ˜åˆšæ‰å·²ç»æ³¨å†ŒæˆåŠŸäº†ã€‚</p><p>è§£å†³å¤åˆ¶å»¶è¿Ÿçš„å¸¸è§æ–¹æ³•ï¼š</p><ul><li>å†™æ“ä½œä»¥åçš„è¯»æ“ä½œæŒ‡å®šå‘ç»™æ•°æ®åº“ä¸»æœåŠ¡å™¨<ul><li>å’Œä¸šåŠ¡å¼ºç»‘å®šï¼Œå®¹æ˜“å‘ç”Ÿbug</li></ul></li><li>è¯»ä»æœºå¤±è´¥ä¹‹åå†è¯»ä¸€æ¬¡ä¸»æœº<ul><li>äºŒæ¬¡è¯»å–å’Œä¸šåŠ¡æ— ç»‘å®šï¼Œåªéœ€è¦å¯¹åº•å±‚æ•°æ®åº“è®¿é—®çš„APIè¿›è¡Œå°è£…å³å¯ï¼Œå®ç°ä»£ä»·å°</li><li>ä¸è¶³ä¹‹å¤„æ˜¯å¦‚æœæœ‰å¤§é‡äºŒæ¬¡è¯»å–ï¼Œé‚£ä¹ˆä¸»æœºå‹åŠ›ä¼šå¾ˆå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å´©æºƒ</li><li>å…³é”®ä¸šåŠ¡è¯»å†™æ“ä½œå…¨éƒ¨æŒ‡å‘ä¸»æœºï¼Œéå…³é”®ä¸šåŠ¡é‡‡ç”¨è¯»å†™åˆ†ç¦»</li></ul></li></ul><h2 id="1-3-åˆ†é…æœºåˆ¶-å¦‚ä½•åŒºåˆ†è¯»å†™æ“ä½œï¼Œè®¿é—®ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨"><a href="#1-3-åˆ†é…æœºåˆ¶-å¦‚ä½•åŒºåˆ†è¯»å†™æ“ä½œï¼Œè®¿é—®ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨" class="headerlink" title="1.3 åˆ†é…æœºåˆ¶ - å¦‚ä½•åŒºåˆ†è¯»å†™æ“ä½œï¼Œè®¿é—®ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨"></a>1.3 åˆ†é…æœºåˆ¶ - å¦‚ä½•åŒºåˆ†è¯»å†™æ“ä½œï¼Œè®¿é—®ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨</h2><h3 id="1-3-1-ç¨‹åºä»£ç å°è£…"><a href="#1-3-1-ç¨‹åºä»£ç å°è£…" class="headerlink" title="1.3.1 ç¨‹åºä»£ç å°è£…"></a>1.3.1 ç¨‹åºä»£ç å°è£…</h3><p>æŒ‡åœ¨ä»£ç ä¸­æŠ½è±¡å‡ºä¸€ä¸ªæ•°æ®è®¿é—®å±‚ï¼Œå®ç°è¯»å†™åˆ†ç¦»çš„æ“ä½œå’Œæ•°æ®åº“æœåŠ¡å™¨çš„è¿æ¥ç®¡ç†ã€‚ä¾‹å¦‚åŸºäºHibernateè¿›è¡Œç®€å•å°è£…</p><p><img src="https://i.loli.net/2020/02/04/MjT7sUolRfiI1x4.png" alt="fig2.png"></p><ul><li>å®ç°ç®€å•ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡åšè¾ƒå¤šçš„å®šåˆ¶åŒ–åŠŸèƒ½</li><li>æ¯ä¸ªç¼–ç¨‹è¯­è¨€éƒ½è¦è‡ªå·±å®ç°ä¸€æ¬¡ï¼Œæ²¡æ³•é€šç”¨ï¼Œå¦‚æœä¸€ä¸ªä¸šåŠ¡åŒ…å«å¤šä¸ªç¼–ç¨‹è¯­è¨€çš„å¤šä¸ªå­ç³»ç»Ÿï¼Œé‚£ä¹ˆé‡å¤å¼€å‘å·¥ä½œé‡æ¯”è¾ƒå¤§</li><li>æ•…éšœæƒ…å†µä¸‹ï¼Œå¦‚æœä¸»ä»åˆ‡æ¢ï¼Œé‚£ä¹ˆæ‰€æœ‰ç³»ç»Ÿéƒ½å¾ˆå¯èƒ½éœ€è¦ä¿®æ”¹é…ç½®å¹¶é‡å¯</li></ul><h3 id="1-3-2-ä¸­é—´ä»¶å°è£…"><a href="#1-3-2-ä¸­é—´ä»¶å°è£…" class="headerlink" title="1.3.2 ä¸­é—´ä»¶å°è£…"></a>1.3.2 ä¸­é—´ä»¶å°è£…</h3><p>æŒ‡ç‹¬ç«‹å‡ºä¸€å¥—ç³»ç»Ÿæ¥ï¼Œå®ç°è¯»å†™æ“ä½œåˆ†ç¦»å’Œæ•°æ®åº“æœåŠ¡å™¨è¿æ¥çš„ç®¡ç†ã€‚ä¸­é—´ä»¶å¯¹ä¸šåŠ¡æœåŠ¡å™¨æä¾›SQLå…¼å®¹çš„åè®®ï¼Œä¸šåŠ¡æœåŠ¡å™¨æ— é¡»è‡ªå·±è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚å¯¹äºä¸šåŠ¡æœåŠ¡å™¨æ¥è¯´ï¼Œè®¿é—®ä¸­é—´ä»¶</p><p><img src="https://i.loli.net/2020/02/04/26cDtZv1Ia5rSye.png" alt="fig3.png"></p><ul><li>èƒ½å¤Ÿæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œå› ä¸ºä¸­é—´ä»¶å¯¹ä¸šåŠ¡æœåŠ¡å™¨æä¾›çš„æ˜¯æ ‡å‡†SQLæ¥å£</li><li>ä¸­é—´ä»¶è¦æ”¯æŒå®Œæ•´çš„SQLè¯­æ³•å’Œæ•°æ®åº“æœåŠ¡å™¨çš„åè®®ï¼Œå®ç°å¤æ‚ï¼Œbugä¼šæ¯”è¾ƒå¤šï¼Œéœ€è¦è¾ƒé•¿æ—¶é—´æ‰å¯ä»¥ç¨³å®šä¸‹æ¥</li><li>ä¸­é—´ä»¶è‡ªå·±ä¸æ‰§è¡Œè¯»å†™ï¼Œä½†æ˜¯æ‰€æœ‰æ•°æ®åº“çš„æ“ä½œè¯·æ±‚éƒ½è¦ç»è¿‡ä¸­é—´ä»¶ï¼Œæ‰€ä»¥å¯¹äºæ€§èƒ½æœ‰å¾ˆé«˜çš„è¦æ±‚</li><li>æ•°æ®åº“ä¸»ä»åˆ‡æ¢å¯¹ä¸šåŠ¡æœåŠ¡å™¨æ— æ„ŸçŸ¥ï¼Œæ•°æ®åº“ä¸­é—´ä»¶å¯ä»¥æ¢æµ‹æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»ä»çŠ¶æ€</li></ul><p>ç°åœ¨å¸‚é¢ä¸Šæœ‰çš„ä¸­é—´ä»¶ï¼ŒMySQL Router, Atlas </p><h1 id="2-åˆ†åº“åˆ†è¡¨"><a href="#2-åˆ†åº“åˆ†è¡¨" class="headerlink" title="2. åˆ†åº“åˆ†è¡¨"></a>2. åˆ†åº“åˆ†è¡¨</h1><p>è¯»å†™åˆ†ç¦»å¯ä»¥åˆ†æ•£æ•°æ®åº“è¯»å†™æ“ä½œçš„å‹åŠ›ï¼Œä½†æ²¡æœ‰åˆ†æ•£å­˜å‚¨å‹åŠ›ï¼Œå½“æ•°æ®é‡è¾¾åˆ°åƒä¸‡çº§åˆ«çš„æ—¶å€™ï¼Œå•å°æ•°æ®åº“æœåŠ¡å™¨çš„å­˜å‚¨èƒ½åŠ›ä¼šæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆ, è¿™ä½“ç°åœ¨ï¼š</p><ul><li>æ•°æ®é‡è¿‡å¤§ï¼Œè¯»å†™æ€§èƒ½ä¼šä¸‹é™ï¼›å³ä½¿æœ‰ç´¢å¼•ï¼Œç´¢å¼•ä¹Ÿä¼šå˜å¤§ï¼Œæ€§èƒ½åŒæ ·ä¼šä¸‹é™</li><li>æ•°æ®æ–‡ä»¶ä¼šå˜å¾—å¾ˆå¤§ï¼Œæ•°æ®åº“åŒ—éå’Œæ¢å¤éœ€è¦è€—è´¹å¾ˆé•¿æ—¶é—´</li><li>æ•°æ®æ–‡ä»¶è¶Šå¤§ï¼Œæç«¯æƒ…å†µä¸‹ä¸¢å¤±æ•°æ®çš„é£é™©å°±è¶Šé«˜</li></ul><p>åŸºäºä¸Šè¿°åŸå› ï¼Œå•ä¸ªæ•°æ®åº“æœåŠ¡å™¨å­˜å‚¨çš„æ•°æ®é‡ä¸èƒ½å¤ªå¤§ï¼Œéœ€è¦æ§åˆ¶åœ¨ä¸€å®šçš„èŒƒå›´å†…ã€‚å°†å­˜å‚¨åˆ†æ•£åˆ°å¤šå°æ•°æ®åº“æœåŠ¡å™¨ä¸Šã€‚</p><h2 id="2-1-ä¸šåŠ¡åˆ†åº“"><a href="#2-1-ä¸šåŠ¡åˆ†åº“" class="headerlink" title="2.1 ä¸šåŠ¡åˆ†åº“"></a>2.1 ä¸šåŠ¡åˆ†åº“</h2><blockquote><p>ä¸šåŠ¡åˆ†åº“æŒ‡çš„æ˜¯æŒ‰ç…§ä¸šåŠ¡æ¨¡å—å°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ã€‚</p></blockquote><p>è­¬å¦‚ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œå°†ç”¨æˆ·æ•°æ®ï¼Œå•†å“æ•°æ®ï¼Œè®¢å•æ•°æ®åˆ†å¼€æ”¾åˆ°ä¸‰å°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ä¸Šã€‚è™½ç„¶ä¸šåŠ¡åˆ†åº“èƒ½å¤Ÿåˆ†æ•£å­˜å‚¨å’Œè®¿é—®çš„å‹åŠ›ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚</p><h3 id="2-1-1-joinæ“ä½œé—®é¢˜"><a href="#2-1-1-joinæ“ä½œé—®é¢˜" class="headerlink" title="2.1.1 joinæ“ä½œé—®é¢˜"></a>2.1.1 joinæ“ä½œé—®é¢˜</h3><p>åŸå…ˆåœ¨ä¸€ä¸ªè¡¨é‡Œçš„æ•°æ®ç°åœ¨åˆ†æ•£åˆ°äº†å¤šä¸ªè¡¨å½“ä¸­ï¼Œè¿™å°±å¯¼è‡´æ— æ³•ä½¿ç”¨SQLçš„joinæ¥è¿›è¡ŒæŸ¥è¯¢äº†ã€‚</p><h3 id="2-1-2-äº‹åŠ¡é—®é¢˜"><a href="#2-1-2-äº‹åŠ¡é—®é¢˜" class="headerlink" title="2.1.2 äº‹åŠ¡é—®é¢˜"></a>2.1.2 äº‹åŠ¡é—®é¢˜</h3><p>åŸæœ¬åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­ä¸åŒçš„è¡¨å¯ä»¥åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ä¿®æ”¹ï¼Œä¸šåŠ¡åˆ†åº“ä»¥åï¼Œè¡¨åˆ†æ•£åˆ°äº†ä¸åŒçš„æ•°æ®åº“å½“ä¸­ï¼Œæ— æ³•é€šè¿‡äº‹åŠ¡ç»Ÿä¸€ä¿®æ”¹ã€‚ å°½ç®¡æœ‰ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ€§èƒ½å¤ªä½ï¼Œä¸é«˜æ€§èƒ½çš„å­˜å‚¨çš„ç›®æ ‡æ˜¯ç›¸è¿èƒŒçš„ã€‚</p><h3 id="2-1-3-æˆæœ¬é—®é¢˜"><a href="#2-1-3-æˆæœ¬é—®é¢˜" class="headerlink" title="2.1.3 æˆæœ¬é—®é¢˜"></a>2.1.3 æˆæœ¬é—®é¢˜</h3><p>ä¸€å°å˜å¤šå°</p><h2 id="2-2-ä¸šåŠ¡åˆ†è¡¨"><a href="#2-2-ä¸šåŠ¡åˆ†è¡¨" class="headerlink" title="2.2 ä¸šåŠ¡åˆ†è¡¨"></a>2.2 ä¸šåŠ¡åˆ†è¡¨</h2><p>å°†ä¸åŒä¸šåŠ¡æ•°æ®åˆ†æ•£å­˜å‚¨åˆ°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæ”¯æ’‘ç™¾ä¸‡ç”šè‡³åƒä¸‡ç”¨æˆ·è§„æ¨¡çš„ä¸šåŠ¡ï¼Œä½†å¦‚æœä¸šåŠ¡ç»§ç»­å‘å±•ï¼ŒåŒä¸€ä¸šåŠ¡çš„å•è¡¨æ•°æ®ä¹Ÿä¼šè¾¾åˆ°å•å°æ•°æ®åº“æœåŠ¡å™¨çš„å¤„ç†ç“¶é¢ˆã€‚ä¾‹å¦‚ï¼Œæ·˜å®çš„å‡ äº¿ç”¨æˆ·æ•°æ®ï¼Œå¦‚æœå…¨éƒ¨å­˜æ”¾åœ¨ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„ä¸€å¼ è¡¨ä¸­ï¼Œè‚¯å®šæ˜¯æ— æ³•æ»¡è¶³æ€§èƒ½è¦æ±‚çš„ï¼Œæ­¤æ—¶å°±éœ€è¦å¯¹å•è¡¨æ•°æ®è¿›è¡Œæ‹†åˆ†ã€‚</p><p>å•è¡¨æ•°æ®çš„æ‹†åˆ†æœ‰ä¸¤ç§æ–¹å¼ï¼š å‚ç›´åˆ†è¡¨å’Œæ°´å¹³åˆ†è¡¨</p><h3 id="2-2-1-å‚ç›´åˆ†è¡¨"><a href="#2-2-1-å‚ç›´åˆ†è¡¨" class="headerlink" title="2.2.1 å‚ç›´åˆ†è¡¨"></a>2.2.1 å‚ç›´åˆ†è¡¨</h3><p>åŸå…ˆæ¯”å¦‚æ˜¯id, name, age, sex, nickname, å‚ç›´åˆ†è¡¨ä»¥åå¯ä»¥å˜æˆ</p><ul><li>id, name, age</li><li>id, sex, nickname </li></ul><p>ä¹Ÿä¼šå¸¦æ¥å¤æ‚æ€§ï¼Œå³è¡¨æ“ä½œçš„æ•°é‡è¦å¢åŠ ï¼ŒåŸæ¥çš„ä¸€æ¬¡æŸ¥è¯¢ç°åœ¨è¦å˜æˆå¤šæ¬¡æŸ¥è¯¢äº†</p><h3 id="2-2-2-æ°´å¹³åˆ†è¡¨"><a href="#2-2-2-æ°´å¹³åˆ†è¡¨" class="headerlink" title="2.2.2 æ°´å¹³åˆ†è¡¨"></a>2.2.2 æ°´å¹³åˆ†è¡¨</h3><p>ç”¨2.2.1çš„ä¾‹å­æ¥è¯´æ˜çš„è¯ï¼Œä¼šåŒ…å«ä¸€æ ·çš„attributesï¼Œåªæ˜¯æ€»å…±è¡Œæ•°å˜le</p><p>æ°´å¹³åˆ†è¡¨ä»¥åï¼ŒæŸæ¡æ•°æ®å…·ä½“å±äºå“ªä¸ªåˆ‡åˆ†ä»¥åçš„å­è¡¨ï¼Œéœ€è¦ä¾é è·¯ç”±ç®—æ³•æ¥è¿›è¡Œè®¡ç®—</p><ul><li>èŒƒå›´è·¯ç”±<ul><li>ä½¿ç”¨ç”¨æˆ·IDç­‰åˆ†æ®µ</li><li>å¥½å¤„<ul><li>éšæ•°æ®å¢åŠ å¹³æ»‘çš„æ‰©å……æ–°è¡¨</li></ul></li><li>åå¤„<ul><li>åˆ†å¸ƒä¸å‡</li></ul></li></ul></li><li>Hashè·¯ç”±<ul><li>é€‰å–æŸä¸ªåˆ—çš„å€¼è¿›è¡ŒHashè¿ç®—ï¼Œç„¶åæ ¹æ®Hashç»“æœåˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®è¡¨å½“ä¸­</li><li>å¤æ‚ç‚¹<ul><li>åˆå§‹è¡¨çš„æ•°é‡é€‰å–ï¼Œå¤ªå¤šç»´æŠ¤éº»çƒ¦ï¼Œå¤ªå°‘å¯èƒ½ä¼šè®©å•è¡¨æ€§èƒ½å­˜åœ¨é—®é¢˜</li><li>ç”¨äº†Hashä»¥åé‡Hash(å¢åŠ è¡¨æ•°é‡)ä¼šéå¸¸éº»çƒ¦</li></ul></li><li>å¥½å¤„  åˆ†å¸ƒå‡åŒ€</li></ul></li><li>é…ç½®è·¯ç”±<ul><li>è·¯ç”±è¡¨ï¼Œç”¨ç‹¬ç«‹çš„è¡¨æ¥è®°å½•è·¯ç”±ä¿¡æ¯ </li><li>ç¼ºç‚¹å°±æ˜¯ä¼šå¤šæŸ¥è¯¢ä¸€æ¬¡ï¼Œå…ˆçœ‹äº†ä¸€çœ¼è·¯ç”±è¡¨å˜›</li></ul></li></ul><h1 id="3-é«˜æ€§èƒ½NoSQL"><a href="#3-é«˜æ€§èƒ½NoSQL" class="headerlink" title="3. é«˜æ€§èƒ½NoSQL"></a>3. é«˜æ€§èƒ½NoSQL</h1><p>å…³ç³»å‹æ•°æ®åº“å­˜åœ¨é—®é¢˜ï¼š</p><ul><li>å…³ç³»æ•°æ®åº“å­˜å‚¨çš„æ˜¯è¡Œè®°å½•ï¼Œæ— æ³•å­˜å‚¨æ•°æ®ç»“æ„</li><li>å…³ç³»æ•°æ®åº“çš„schemaæ‰©å±•ä¸æ–¹ä¾¿<ul><li>schemaæ˜¯å¼ºçº¦æŸçš„ï¼Œæ“ä½œä¸å­˜åœ¨çš„åˆ—ä¼šæŠ¥é”™ï¼Œä¸šåŠ¡å˜åŒ–æ—¶æ‰©å……åˆ—ä¹Ÿä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦æ‰§è¡ŒDDL (data definition language  create, alter, dropç­‰) è¯­å¥ä¿®æ”¹ï¼Œè€Œä¸”ä¿®æ”¹æ—¶å¯èƒ½ä¼šé•¿æ—¶é—´é”è¡¨</li></ul></li><li>å…³ç³»æ•°æ®åº“åœ¨å¤§æ•°æ®åœºæ™¯ä¸‹I/Oè¾ƒé«˜<ul><li>å¯¹äºæ¯ä¸€è¡Œæ•°æ®é‡éƒ½å¾ˆå¤§çš„è¡¨åšç»Ÿè®¡ä¹‹ç±»çš„è¿ç®—çš„æ—¶å€™I/Oä¼šå¾ˆé«˜ï¼Œå› ä¸ºå³ä½¿åªé’ˆå¯¹å…¶ä¸­æŸä¸€åˆ—è¿›è¡Œè¿ç®—ï¼Œå…³ç³»æ•°æ®åº“ä¹Ÿä¼šå°†æ•´è¡Œæ•°æ®ä»å­˜å‚¨è®¾å¤‡è¯»å…¥å†…å­˜ã€‚ </li></ul></li><li>å…³ç³»æ•°æ®åº“çš„å…¨æ–‡æœç´¢åŠŸèƒ½æ¯”è¾ƒå¼±</li></ul><p>é’ˆå¯¹ä¸Šé¢çš„é—®é¢˜ï¼Œäº§ç”Ÿäº†ä¸åŒçš„NoSQLè§£å†³æ–¹æ¡ˆï¼Œåœ¨æŸä¸€æ–¹é¢ä¼šæœ‰æ›´å¥½çš„è¡¨ç°ã€‚æ­¤å¤–ï¼ŒNoSQLçš„æ–¹æ¡ˆå¸¦æ¥çš„ä¼˜åŠ¿ï¼Œæœ¬è´¨ä¸Šæ˜¯ç‰ºç‰²ACIDä¸­çš„æŸä¸ªæˆ–è€…æŸå‡ ä¸ªç‰¹æ€§ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ç›²ç›®åœ°è¿·ä¿¡NoSQLæ˜¯é“¶å¼¹ï¼Œåº”è¯¥å°†NoSQlä½œä¸ºSQLçš„ä¸€ä¸ªæœ‰åŠ›è¡¥å……ã€‚</p><p>å¸¸è§NoSQLåˆ†ç±»ï¼š</p><ul><li>K-V å­˜å‚¨: è§£å†³SQLæ— æ³•å­˜å‚¨æ•°æ®ç»“æ„çš„é—®é¢˜</li><li>æ–‡æ¡£æ•°æ®åº“ï¼šè§£å†³SQLå¼ºschemaçº¦æŸçš„é—®é¢˜</li><li>åˆ—å¼æ•°æ®åº“ï¼šè§£å†³SQLå¤§æ•°æ®åœºæ™¯ä¸‹çš„I/Oé—®é¢˜ï¼Œä»¥HBaseä¸ºä»£è¡¨</li><li>å…¨æ–‡æœç´¢å¼•æ“ï¼šè§£å†³å…³ç³»æ•°æ®åº“çš„å…¨æ–‡æœç´¢æ€§èƒ½é—®é¢˜ï¼Œ ElasticSearch </li></ul><h2 id="3-1-Key-Valueå­˜å‚¨"><a href="#3-1-Key-Valueå­˜å‚¨" class="headerlink" title="3.1 Key - Valueå­˜å‚¨"></a>3.1 Key - Valueå­˜å‚¨</h2><p>Redis æ˜¯ K-V å­˜å‚¨çš„å…¸å‹ä»£è¡¨ï¼Œå®ƒæ˜¯ä¸€æ¬¾å¼€æºï¼ˆåŸºäº BSD è®¸å¯ï¼‰çš„é«˜æ€§èƒ½ K-V ç¼“å­˜å’Œå­˜å‚¨ç³»ç»Ÿã€‚Redis çš„ Value æ˜¯å…·ä½“çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬ stringã€hashã€listã€setã€sorted setã€bitmap å’Œ hyperloglogï¼Œæ‰€ä»¥å¸¸å¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ã€‚</p><p>æ›´çµæ´»çš„å¯¹æ•°æ®çš„æ“ä½œï¼š</p><ul><li>LPOP key ä»é˜Ÿåˆ—çš„å·¦è¾¹å‡ºé˜Ÿä¸€ä¸ªå…ƒç´ ã€‚</li><li>LINDEX key index è·å–ä¸€ä¸ªå…ƒç´ ï¼Œé€šè¿‡å…¶ç´¢å¼•åˆ—è¡¨ã€‚</li><li>LLEN key è·å¾—é˜Ÿåˆ—ï¼ˆListï¼‰çš„é•¿åº¦ã€‚</li></ul><p>Redis çš„ç¼ºç‚¹ä¸»è¦ä½“ç°åœ¨å¹¶ä¸æ”¯æŒå®Œæ•´çš„ ACID äº‹åŠ¡ï¼ŒRedis è™½ç„¶æä¾›äº‹åŠ¡åŠŸèƒ½ï¼Œä½† Redis çš„äº‹åŠ¡å’Œå…³ç³»æ•°æ®åº“çš„äº‹åŠ¡ä¸å¯åŒæ—¥è€Œè¯­ï¼ŒRedis çš„äº‹åŠ¡åªèƒ½ä¿è¯éš”ç¦»æ€§å’Œä¸€è‡´æ€§ï¼ˆI å’Œ Cï¼‰ï¼Œæ— æ³•ä¿è¯åŸå­æ€§å’ŒæŒä¹…æ€§ï¼ˆA å’Œ Dï¼‰ã€‚</p><h2 id="3-2-æ–‡æ¡£æ•°æ®åº“"><a href="#3-2-æ–‡æ¡£æ•°æ®åº“" class="headerlink" title="3.2 æ–‡æ¡£æ•°æ®åº“"></a>3.2 æ–‡æ¡£æ•°æ®åº“</h2><p>æœ€å¤§ç‰¹ç‚¹æ˜¯no-schemaï¼Œå¯ä»¥å­˜å‚¨å’Œè¯»å–ä»»æ„çš„æ•°æ®ã€‚å¸¦æ¥ä¼˜åŠ¿ï¼š</p><ul><li>æ–°å¢å­—æ®µç®€å•</li><li>å†å²æ•°æ®ä¸ä¼šå‡ºé”™</li><li>å¯ä»¥å¾ˆå®¹æ˜“å­˜å‚¨å¤æ‚æ•°æ®</li></ul><p>ç¼ºé™·</p><ul><li>äº‹åŠ¡</li><li>æ²¡æœ‰joinæ“ä½œ</li></ul><h2 id="3-3-åˆ—å¼æ•°æ®åº“"><a href="#3-3-åˆ—å¼æ•°æ®åº“" class="headerlink" title="3.3 åˆ—å¼æ•°æ®åº“"></a>3.3 åˆ—å¼æ•°æ®åº“</h2><p>æŒ‰ç…§åˆ—æ¥å­˜å‚¨æ•°æ®ï¼Œå…¸å‹åœºæ™¯æµ·é‡æ•°æ®ç»Ÿè®¡ï¼Œåªéœ€è¦å…¶ä¸­çš„ä¸€ä¸¤åˆ—çš„æ•°æ®å³å¯ã€‚I/Oç›¸å¯¹ä½ä¸€äº›ã€‚</p><p>åˆ—å¼å­˜å‚¨æœ‰æ›´é«˜çš„å­˜å‚¨å‹ç¼©æ¯”ï¼Œå› ä¸ºå•ä¸ªåˆ—çš„æ•°æ®ç›¸ä¼¼åº¦ä¸€èˆ¬æ¥è¯´æ¯”è¡Œæ›´é«˜ï¼Œèƒ½å¤Ÿè¾¾åˆ°æ›´é«˜çš„å‹ç¼©ç‡ã€‚</p><p>ä¸€èˆ¬å°†å…¶ç”¨åœ¨ç¦»çº¿çš„å¤§æ•°æ®åˆ†æå’Œç»Ÿè®¡çš„åœºæ™¯å½“ä¸­ï¼Œå› ä¸ºè¿™ç§åœºæ™¯ç»å¸¸æ˜¯é’ˆå¯¹éƒ¨åˆ†å•åˆ—æ¥è¿›è¡Œæ“ä½œçš„ï¼Œæ•°æ®å†™å…¥ä»¥åæ— é¡»æ›´æ–°åˆ é™¤ã€‚</p><h2 id="3-4-å…¨æ–‡æœç´¢å¼•æ“"><a href="#3-4-å…¨æ–‡æœç´¢å¼•æ“" class="headerlink" title="3.4 å…¨æ–‡æœç´¢å¼•æ“"></a>3.4 å…¨æ–‡æœç´¢å¼•æ“</h2><ul><li>å…¨æ–‡æœç´¢çš„æ¡ä»¶å¯ä»¥éšæ„æ’åˆ—ç»„åˆï¼Œå¦‚æœé€šè¿‡ç´¢å¼•æ¥æ»¡è¶³ï¼Œåˆ™ç´¢å¼•çš„æ•°é‡ä¼šéå¸¸å¤š</li><li>å…¨æ–‡æœç´¢çš„æ¨¡ç³ŠåŒ¹é…æ–¹å¼ï¼Œç´¢å¼•æ— æ³•æ»¡è¶³ï¼Œåªèƒ½ç”¨likeï¼Œè€Œlikeæ˜¯æ•´è¡¨æ‰«æï¼Œå¾ˆæ…¢</li></ul><h3 id="3-4-1-åŸºæœ¬åŸç†"><a href="#3-4-1-åŸºæœ¬åŸç†" class="headerlink" title="3.4.1 åŸºæœ¬åŸç†"></a>3.4.1 åŸºæœ¬åŸç†</h3><ul><li>å€’æ’ç´¢å¼•/ åå‘ç´¢å¼•<ul><li>å»ºç«‹å•è¯åˆ°æ–‡æ¡£çš„ç´¢å¼• </li><li>å³ç”¨å…³é”®è¯æ¥æŸ¥ï¼Œæ˜¾ç¤ºå‡ºå‡ºç°çš„åœ°æ–¹</li></ul></li></ul><h3 id="3-4-2-ä½¿ç”¨æ–¹å¼"><a href="#3-4-2-ä½¿ç”¨æ–¹å¼" class="headerlink" title="3.4.2 ä½¿ç”¨æ–¹å¼"></a>3.4.2 ä½¿ç”¨æ–¹å¼</h3><p>å°†æ•°æ®åº“é‡Œé¢çš„å†…å®¹è½¬æˆJSONæ ¼å¼ï¼Œç„¶åè¾“å…¥å…¨æ–‡æœç´¢å¼•æ“è¿›è¡Œæœç´¢ã€‚ ESèƒ½å¤Ÿä»¥å®æ—¶åŒ–çš„æ–¹å¼ï¼Œå­˜å‚¨å’Œæ£€ç´¢å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä»¤æ¯ä¸ªå­—æ®µéƒ½é»˜è®¤å¯ä»¥è¢«ç´¢å¼•ã€‚</p><h1 id="4-é«˜æ€§èƒ½ç¼“å­˜ç»“æ„"><a href="#4-é«˜æ€§èƒ½ç¼“å­˜ç»“æ„" class="headerlink" title="4. é«˜æ€§èƒ½ç¼“å­˜ç»“æ„"></a>4. é«˜æ€§èƒ½ç¼“å­˜ç»“æ„</h1><p>å­˜å‚¨ç³»ç»Ÿçš„èƒ½åŠ›æœ‰çš„æ—¶å€™å¹¶ä¸å¤Ÿç”¨ï¼Œæ¯”å¦‚</p><ul><li>éœ€è¦ç»è¿‡å¤æ‚è¿ç®—å¾—å‡ºçš„æ•°æ®  â€“ æ¯”å¦‚å®æ—¶åœ¨çº¿äººæ•°</li><li>è¯»å¤šå†™å°‘çš„æ•°æ®</li></ul><p>ç¼“å­˜å°±æ˜¯ä¸ºäº†å¼¥è¡¥å­˜å‚¨ç³»ç»Ÿåœ¨è¿™äº›å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸‹çš„ä¸è¶³ï¼Œå…¶åŸºæœ¬åŸç†å°±æ˜¯å°†å¯èƒ½é‡å¤ä½¿ç”¨çš„æ•°æ®æ”¾åˆ°å†…å­˜å½“ä¸­ï¼Œä¸€æ¬¡ç”Ÿæˆï¼Œå¤šæ¬¡ä½¿ç”¨ï¼Œé¿å…æ¯æ¬¡ä½¿ç”¨éƒ½å»è®¿é—®å­˜å‚¨ç³»ç»Ÿã€‚</p><p>ç¼“å­˜èƒ½å¤Ÿå¸¦æ¥æ€§èƒ½çš„å¤§å¹…æå‡ï¼Œä»¥memcacheä¸ºä¾‹ï¼Œå•å°å°±å¯ä»¥è¾¾åˆ°TPS50000ä»¥ä¸Šï¼ŒåŸºæœ¬æ¶æ„å°±æ˜¯ç¬¬ä¸€æ¬¡ä»æ•°æ®åº“æ‹¿æ•°æ®ï¼Œç¬¬äºŒæ¬¡åŠä»¥åå°±å¯ä»¥ä»memcachedä¸­æ¥å–å¾—æ•°æ®äº†ã€‚</p><h2 id="4-1-ç¼“å­˜ç©¿é€"><a href="#4-1-ç¼“å­˜ç©¿é€" class="headerlink" title="4.1 ç¼“å­˜ç©¿é€"></a>4.1 ç¼“å­˜ç©¿é€</h2><p>æŒ‡ç¼“å­˜æ²¡æœ‰å‘æŒ¥ä½œç”¨ï¼Œè™½ç„¶å»æŸ¥è¯¢äº†ç¼“å­˜æ•°æ®ï¼Œä½†æ˜¯ä¸åœ¨é‚£é‡Œé¢ï¼Œä¸šåŠ¡ç³»ç»Ÿå°±éœ€è¦å†æ¬¡å»å­˜å‚¨ç³»ç»ŸæŸ¥è¯¢æ•°æ®ï¼Œè¿™ç§æƒ…å†µçš„å‡ºç°é€šå¸¸æ˜¯å› ä¸ºï¼š</p><ul><li>å­˜å‚¨æ•°æ®ä¸å­˜åœ¨</li></ul><p>é»‘å®¢æ”»å‡»ï¼Œæ•…æ„å¤§é‡è®¿é—®æŸäº›è¯»å–ä¸å­˜åœ¨æ•°æ®çš„ä¸šåŠ¡ã€‚è§£å†³æ–¹æ¡ˆå°±æ˜¯è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œæ”¾åˆ°ç¼“å­˜é‡Œé¢ï¼Œè¿™æ ·ç¬¬äºŒæ¬¡è¯»å–ç¼“å­˜çš„æ—¶å€™å°±ä¼šè·å–é»˜è®¤å€¼ï¼Œè€Œä¸ä¼šç»§ç»­è®¿é—®å­˜å‚¨ç³»ç»Ÿã€‚</p><ul><li>ç¼“å­˜æ•°æ®ç”Ÿæˆè€—è´¹å¤§é‡çš„æ—¶é—´æˆ–è€…èµ„æº</li></ul><p>ç¬¬äºŒç§æƒ…å†µæ˜¯å­˜å‚¨ç³»ç»Ÿä¸­å­˜åœ¨æ•°æ®ï¼Œä½†ç”Ÿæˆç¼“å­˜æ•°æ®éœ€è¦è€—è´¹è¾ƒé•¿æ—¶é—´æˆ–è€…è€—è´¹å¤§é‡èµ„æºã€‚å¦‚æœåˆšå¥½åœ¨ä¸šåŠ¡è®¿é—®çš„æ—¶å€™ç¼“å­˜å¤±æ•ˆäº†ï¼Œé‚£ä¹ˆä¹Ÿä¼šå‡ºç°ç¼“å­˜æ²¡æœ‰å‘æŒ¥ä½œç”¨ï¼Œè®¿é—®å‹åŠ›å…¨éƒ¨é›†ä¸­åœ¨å­˜å‚¨ç³»ç»Ÿä¸Šçš„æƒ…å†µã€‚</p><p>å…¸å‹çš„å°±æ˜¯ç”µå•†çš„å•†å“åˆ†é¡µï¼Œå‡è®¾æˆ‘ä»¬åœ¨æŸä¸ªç”µå•†å¹³å°ä¸Šé€‰æ‹©â€œæ‰‹æœºâ€è¿™ä¸ªç±»åˆ«æŸ¥çœ‹ï¼Œç”±äºæ•°æ®å·¨å¤§ï¼Œä¸èƒ½æŠŠæ‰€æœ‰æ•°æ®éƒ½ç¼“å­˜èµ·æ¥ï¼Œåªèƒ½æŒ‰ç…§åˆ†é¡µæ¥è¿›è¡Œç¼“å­˜ï¼Œç”±äºéš¾ä»¥é¢„æµ‹ç”¨æˆ·åˆ°åº•ä¼šè®¿é—®å“ªäº›åˆ†é¡µï¼Œå› æ­¤ä¸šåŠ¡ä¸Šæœ€ç®€å•çš„å°±æ˜¯æ¯æ¬¡ç‚¹å‡»åˆ†é¡µçš„æ—¶å€™æŒ‰åˆ†é¡µè®¡ç®—å’Œç”Ÿæˆç¼“å­˜ã€‚é€šå¸¸æƒ…å†µä¸‹è¿™æ ·å®ç°æ˜¯åŸºæœ¬æ»¡è¶³è¦æ±‚çš„ï¼Œä½†æ˜¯å¦‚æœè¢«ç«äº‰å¯¹æ‰‹ç”¨çˆ¬è™«æ¥éå†çš„æ—¶å€™ï¼Œç³»ç»Ÿæ€§èƒ½å°±å¯èƒ½å‡ºç°é—®é¢˜ã€‚</p><h2 id="4-2-ç¼“å­˜é›ªå´©"><a href="#4-2-ç¼“å­˜é›ªå´©" class="headerlink" title="4.2 ç¼“å­˜é›ªå´©"></a>4.2 ç¼“å­˜é›ªå´©</h2><p>æ˜¯æŒ‡å½“ç¼“å­˜å¤±æ•ˆï¼ˆè¿‡æœŸï¼‰åå¼•èµ·ç³»ç»Ÿæ€§èƒ½æ€¥å‰§ä¸‹é™çš„æƒ…å†µã€‚å½“ç¼“å­˜è¿‡æœŸè¢«æ¸…é™¤åï¼Œä¸šåŠ¡ç³»ç»Ÿéœ€è¦é‡æ–°ç”Ÿæˆç¼“å­˜ï¼Œå› æ­¤éœ€è¦å†æ¬¡è®¿é—®å­˜å‚¨ç³»ç»Ÿï¼Œå†æ¬¡è¿›è¡Œè¿ç®—ï¼Œè¿™ä¸ªå¤„ç†æ­¥éª¤è€—æ—¶å‡ åæ¯«ç§’ç”šè‡³ä¸Šç™¾æ¯«ç§’ã€‚è€Œå¯¹äºä¸€ä¸ªé«˜å¹¶å‘çš„ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œå‡ ç™¾æ¯«ç§’å†…å¯èƒ½ä¼šæ¥åˆ°å‡ ç™¾ä¸Šåƒä¸ªè¯·æ±‚ã€‚ç”±äºæ—§çš„ç¼“å­˜å·²ç»è¢«æ¸…é™¤ï¼Œæ–°çš„ç¼“å­˜è¿˜æœªç”Ÿæˆï¼Œå¹¶ä¸”å¤„ç†è¿™äº›è¯·æ±‚çš„çº¿ç¨‹éƒ½ä¸çŸ¥é“å¦å¤–æœ‰ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç”Ÿæˆç¼“å­˜ï¼Œå› æ­¤æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šå»é‡æ–°ç”Ÿæˆç¼“å­˜ï¼Œéƒ½ä¼šå»è®¿é—®å­˜å‚¨ç³»ç»Ÿï¼Œä»è€Œå¯¹å­˜å‚¨ç³»ç»Ÿé€ æˆå·¨å¤§çš„æ€§èƒ½å‹åŠ›ã€‚è¿™äº›å‹åŠ›åˆä¼šæ‹–æ…¢æ•´ä¸ªç³»ç»Ÿï¼Œä¸¥é‡çš„ä¼šé€ æˆæ•°æ®åº“å®•æœºï¼Œä»è€Œå½¢æˆä¸€ç³»åˆ—è¿é”ååº”ï¼Œé€ æˆæ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚</p><p>ä¸ºäº†è§£å†³ï¼Œé€šå¸¸å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹æ¡ˆï¼š æ›´æ–°é”æœºåˆ¶å’Œåå°æ›´æ–°æœºåˆ¶ã€‚</p><h3 id="4-2-1-æ›´æ–°é”"><a href="#4-2-1-æ›´æ–°é”" class="headerlink" title="4.2.1 æ›´æ–°é”"></a>4.2.1 æ›´æ–°é”</h3><p>å¯¹ç¼“å­˜æ›´æ–°æ“ä½œè¿›è¡ŒåŠ é”ä¿æŠ¤ï¼Œä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¿›è¡Œç¼“å­˜æ›´æ–°ï¼Œæœªèƒ½è·å–æ›´æ–°é”çš„çº¿ç¨‹è¦ä¹ˆç­‰å¾…é”é‡Šæ”¾ä»¥åé‡æ–°è¯»å–ç¼“å­˜ï¼Œè¦ä¹ˆå°±è¿”å›ç©ºå€¼æˆ–è€…é»˜è®¤å€¼ã€‚</p><p>å¯¹äºé‡‡ç”¨åˆ†å¸ƒå¼é›†ç¾¤çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œç”±äºå­˜åœ¨å‡ åä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå³ä½¿å•å°æœåŠ¡å™¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ›´æ–°ç¼“å­˜ï¼Œä½†å‡ åä¸Šç™¾å°æœåŠ¡å™¨ä¸€èµ·ç®—ä¸‹æ¥ä¹Ÿä¼šæœ‰å‡ åä¸Šç™¾ä¸ªçº¿ç¨‹åŒæ—¶æ¥æ›´æ–°ç¼“å­˜ï¼ŒåŒæ ·å­˜åœ¨é›ªå´©çš„é—®é¢˜ã€‚å› æ­¤åˆ†å¸ƒå¼é›†ç¾¤çš„ä¸šåŠ¡ç³»ç»Ÿè¦å®ç°æ›´æ–°é”æœºåˆ¶ï¼Œéœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼é”ï¼Œå¦‚ ZooKeeperã€‚</p><h3 id="4-2-2-åå°æ›´æ–°"><a href="#4-2-2-åå°æ›´æ–°" class="headerlink" title="4.2.2 åå°æ›´æ–°"></a>4.2.2 åå°æ›´æ–°</h3><p>ç”±åå°çº¿ç¨‹æ¥æ›´æ–°ç¼“å­˜ï¼Œè€Œä¸æ˜¯ä¸šåŠ¡çº¿ç¨‹ã€‚ç¼“å­˜æœ¬èº«çš„æœ‰æ•ˆæœŸè®¾ç½®ä¸ºæ°¸ä¹…ï¼Œåå°çº¿ç¨‹å®šæ—¶æ›´æ–°ç¼“å­˜ã€‚</p><p>åå°å®šæ—¶æœºåˆ¶éœ€è¦è€ƒè™‘ä¸€ç§ç‰¹æ®Šçš„åœºæ™¯ï¼Œå½“ç¼“å­˜ç³»ç»Ÿå†…å­˜ä¸å¤Ÿæ—¶ï¼Œä¼šâ€œè¸¢æ‰â€ä¸€äº›ç¼“å­˜æ•°æ®ï¼Œä»ç¼“å­˜è¢«â€œè¸¢æ‰â€åˆ°ä¸‹ä¸€æ¬¡å®šæ—¶æ›´æ–°ç¼“å­˜çš„è¿™æ®µæ—¶é—´å†…ï¼Œä¸šåŠ¡çº¿ç¨‹è¯»å–ç¼“å­˜è¿”å›ç©ºå€¼ï¼Œè€Œä¸šåŠ¡çº¿ç¨‹æœ¬èº«åˆä¸ä¼šå»æ›´æ–°ç¼“å­˜ï¼Œå› æ­¤ä¸šåŠ¡ä¸Šçœ‹åˆ°çš„ç°è±¡å°±æ˜¯æ•°æ®ä¸¢äº†ã€‚è§£å†³çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>åå°çº¿ç¨‹é™¤äº†å®šæ—¶æ›´æ–°ç¼“å­˜ï¼Œè¿˜è¦é¢‘ç¹åœ°å»è¯»å–ç¼“å­˜ï¼ˆä¾‹å¦‚ï¼Œ1 ç§’æˆ–è€… 100 æ¯«ç§’è¯»å–ä¸€æ¬¡ï¼‰ï¼Œå¦‚æœå‘ç°ç¼“å­˜è¢«â€œè¸¢äº†â€å°±ç«‹åˆ»æ›´æ–°ç¼“å­˜ï¼Œè¿™ç§æ–¹å¼å®ç°ç®€å•ï¼Œä½†è¯»å–æ—¶é—´é—´éš”ä¸èƒ½è®¾ç½®å¤ªé•¿ï¼Œå› ä¸ºå¦‚æœç¼“å­˜è¢«è¸¢äº†ï¼Œç¼“å­˜è¯»å–é—´éš”æ—¶é—´åˆå¤ªé•¿ï¼Œè¿™æ®µæ—¶é—´å†…ä¸šåŠ¡è®¿é—®éƒ½æ‹¿ä¸åˆ°çœŸæ­£çš„æ•°æ®è€Œæ˜¯ä¸€ä¸ªç©ºçš„ç¼“å­˜å€¼ï¼Œç”¨æˆ·ä½“éªŒä¸€èˆ¬ã€‚</li><li>ä¸šåŠ¡çº¿ç¨‹å‘ç°ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¸€æ¡æ¶ˆæ¯é€šçŸ¥åå°çº¿ç¨‹æ›´æ–°ç¼“å­˜ã€‚å¯èƒ½ä¼šå‡ºç°å¤šä¸ªä¸šåŠ¡çº¿ç¨‹éƒ½å‘é€äº†ç¼“å­˜æ›´æ–°æ¶ˆæ¯ï¼Œä½†å…¶å®å¯¹åå°çº¿ç¨‹æ²¡æœ‰å½±å“ï¼Œåå°çº¿ç¨‹æ”¶åˆ°æ¶ˆæ¯åæ›´æ–°ç¼“å­˜å‰å¯ä»¥åˆ¤æ–­ç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å°±ä¸æ‰§è¡Œæ›´æ–°æ“ä½œã€‚è¿™ç§æ–¹å¼å®ç°ä¾èµ–æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤æ‚åº¦ä¼šé«˜ä¸€äº›ï¼Œä½†ç¼“å­˜æ›´æ–°æ›´åŠæ—¶ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½ã€‚</li></ul><h2 id="4-3-ç¼“å­˜çƒ­ç‚¹"><a href="#4-3-ç¼“å­˜çƒ­ç‚¹" class="headerlink" title="4.3 ç¼“å­˜çƒ­ç‚¹"></a>4.3 ç¼“å­˜çƒ­ç‚¹</h2><p>å¤åˆ¶å¤šä»½ç¼“å­˜å‰¯æœ¬ï¼Œå°†è¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œå‡è½»ç¼“å­˜çƒ­ç‚¹å¯¼è‡´çš„å•å°ç¼“å­˜æœåŠ¡å™¨çš„å‹åŠ›ã€‚</p><p>æ³¨æ„ä¸åŒçš„ç¼“å­˜å‰¯æœ¬ä¸è¦è®¾ç½®ç»Ÿä¸€çš„è¿‡æœŸæ—¶é—´ï¼Œå¦åˆ™ä¼šå‡ºç°æ‰€æœ‰ç¼“å­˜å‰¯æœ¬åŒæ—¶ç”ŸæˆåŒæ—¶å¤±æ•ˆçš„æƒ…å†µï¼Œä»è€Œå¼•å‘ç¼“å­˜é›ªå´©æ•ˆåº”ã€‚æ­£ç¡®çš„åšæ³•æ˜¯è®¾å®šä¸€ä¸ªè¿‡æœŸçš„æ—¶é—´èŒƒå›´ï¼Œä¸åŒçš„ç¼“å­˜å‰¯æœ¬çš„è¿‡æœŸæ—¶é—´æ˜¯æŒ‡å®šèŒƒå›´å†…çš„éšæœºå€¼ã€‚</p><h1 id="5-å•æœåŠ¡å™¨é«˜æ€§èƒ½æ¨¡å¼-å¹¶å‘æ¨¡å‹"><a href="#5-å•æœåŠ¡å™¨é«˜æ€§èƒ½æ¨¡å¼-å¹¶å‘æ¨¡å‹" class="headerlink" title="5. å•æœåŠ¡å™¨é«˜æ€§èƒ½æ¨¡å¼ - å¹¶å‘æ¨¡å‹"></a>5. å•æœåŠ¡å™¨é«˜æ€§èƒ½æ¨¡å¼ - å¹¶å‘æ¨¡å‹</h1><ul><li>å½±å“é«˜æ€§èƒ½æ•ˆæœçš„å› ç´ <ul><li>ç£ç›˜</li><li>æ“ä½œç³»ç»Ÿ</li><li>CPU</li><li>å†…å­˜</li><li>ç¼“å­˜</li><li>ç½‘ç»œ</li><li>ç¼–ç¨‹è¯­è¨€</li><li>æ¶æ„</li></ul></li></ul><p>é«˜æ€§èƒ½æ¶æ„è®¾è®¡ä¸»è¦é›†ä¸­åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š</p><ul><li>å°½é‡æå‡å•æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œå°†å•æœåŠ¡å™¨çš„æ€§èƒ½å‘æŒ¥åˆ°æè‡´</li><li>å¦‚æœå•æœåŠ¡å™¨æ— æ³•æ”¯æ’‘æ€§èƒ½ï¼Œè®¾è®¡æœåŠ¡å™¨é›†ç¾¤æ–¹æ¡ˆ</li></ul><ul><li><p>å…³é”®è®¾è®¡ç‚¹</p><ul><li>æœåŠ¡å™¨å¦‚ä½•ç®¡ç†è¿æ¥</li><li>æœåŠ¡å™¨å¦‚ä½•å¤„ç†è¯·æ±‚</li></ul></li><li><p>å¸¸è§åˆ†ç±»</p><ul><li>æµ·é‡è¿æ¥æµ·é‡è¯·æ±‚ï¼šåŒåä¸€</li><li>å¸¸é‡è¿æ¥æµ·é‡è¯·æ±‚ï¼šä¸­é—´ä»¶</li><li>æµ·é‡è¿æ¥å¸¸é‡è¯·æ±‚ï¼šé—¨æˆ·ç½‘ç«™</li><li>å¸¸é‡è¿æ¥å¸¸é‡è¯·æ±‚ï¼šå†…éƒ¨è¿è¥ç³»ç»Ÿï¼Œç®¡ç†ç³»ç»Ÿ<br>è¿™ä¸¤ä¸ªè®¾è®¡ç‚¹éƒ½å’Œæ“ä½œç³»ç»Ÿçš„I/Oæ¨¡å‹ä»¥åŠè¿›ç¨‹æ¨¡å‹ç›¸å…³ã€‚</li></ul></li><li><p>BIO: ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªè¯·æ±‚</p></li><li><p>NIOï¼šåˆ©ç”¨å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œé€šè¿‡å°‘é‡çš„çº¿ç¨‹å¤„ç†å¤§é‡çš„è¯·æ±‚</p></li><li><p>I/O æ¨¡å‹</p><ul><li>é˜»å¡</li><li>éé˜»å¡</li><li>åŒæ­¥</li><li>å¼‚æ­¥</li></ul></li><li><p>è¿›ç¨‹æ¨¡å‹</p><ul><li>å•è¿›ç¨‹</li><li>å¤šè¿›ç¨‹</li><li>å¤šçº¿ç¨‹</li></ul></li></ul><h2 id="5-1-PPC-Process-Per-Connection"><a href="#5-1-PPC-Process-Per-Connection" class="headerlink" title="5.1 PPC - Process Per Connection"></a>5.1 PPC - Process Per Connection</h2><p>æ¯æ¬¡æœ‰æ–°çš„è¿æ¥å°±æ–°å»ºä¸€ä¸ªè¿›ç¨‹å»ä¸“é—¨å¤„ç†è¿™ä¸ªè¿æ¥çš„è¯·æ±‚ï¼Œè¿™ä¹Ÿæ˜¯ä¼ ç»Ÿçš„UNIXç½‘ç»œæœåŠ¡å™¨é”é‡‡ç”¨çš„æ¨¡å‹ã€‚</p><p><img src="https://i.loli.net/2020/02/04/NDdUCRi3klst8qM.png" alt="fig4.png"></p><ul><li>çˆ¶è¿›ç¨‹æ¥å—è¿æ¥</li><li>çˆ¶è¿›ç¨‹forkå­è¿›ç¨‹</li><li>å­è¿›ç¨‹å¤„ç†è¿æ¥çš„è¯»å†™è¯·æ±‚</li><li>å­è¿›ç¨‹å…³é—­è¿æ¥</li></ul><p>PPC æ¨¡å¼å®ç°ç®€å•ï¼Œæ¯”è¾ƒé€‚åˆæœåŠ¡å™¨çš„è¿æ¥æ•°æ²¡é‚£ä¹ˆå¤šçš„æƒ…å†µï¼Œä¾‹å¦‚æ•°æ®åº“æœåŠ¡å™¨ã€‚å¯¹äºæ™®é€šçš„ä¸šåŠ¡æœåŠ¡å™¨ï¼Œåœ¨äº’è”ç½‘å…´èµ·ä¹‹å‰ï¼Œç”±äºæœåŠ¡å™¨çš„è®¿é—®é‡å’Œå¹¶å‘é‡å¹¶æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œè¿™ç§æ¨¡å¼å…¶å®è¿ä½œå¾—ä¹ŸæŒºå¥½ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ª web æœåŠ¡å™¨ CERN httpd å°±é‡‡ç”¨äº†è¿™ç§æ¨¡å¼ã€‚ä½†éšç€äº’è”ç½‘æ˜ŸæœŸï¼ŒæœåŠ¡å™¨çš„å¹¶å‘é‡å’Œè®¿é—®é‡éƒ½æœ‰äº†å¾ˆå¤§çš„æé«˜ï¼Œè¿™ç§æ–¹æ³•å°±æ¶Œç°å‡ºäº†ä¸å°‘å¼Šç«¯</p><ul><li>forkä»£ä»·æ¯”è¾ƒé«˜ï¼Œè¦åˆ†é…å¾ˆå¤šå†…æ ¸èµ„æºï¼Œéœ€è¦å°†å†…å­˜æ˜ åƒä»çˆ¶è¿›ç¨‹å¤åˆ¶åˆ°å­è¿›ç¨‹ã€‚</li><li>çˆ¶å­è¿›ç¨‹é€šä¿¡å¤æ‚ï¼Œçˆ¶è¿›ç¨‹forkå­è¿›ç¨‹æ—¶ï¼Œæ–‡ä»¶æè¿°ç¬¦å¯ä»¥é€šè¿‡å†…å­˜æ˜ åƒå¤åˆ¶ä»çˆ¶è¿›ç¨‹ä¼ åˆ°å­è¿›ç¨‹ï¼Œä½†forkå®Œæˆä¹‹åï¼Œçˆ¶å­è¿›ç¨‹é€šä¿¡å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œéœ€è¦é‡‡ç”¨IPC(Interprocess Communication)ä¹‹ç±»çš„è¿›ç¨‹é€šä¿¡æ–¹æ¡ˆã€‚</li><li>æ”¯æŒçš„å¹¶å‘è¿æ¥æ•°é‡æœ‰é™ï¼Œå¦‚æœæ¯ä¸ªè¿æ¥å­˜æ´»æ—¶é—´æ¯”è¾ƒé•¿ï¼Œè€Œä¸”æ–°çš„è¿æ¥åˆæºæºä¸æ–­çš„æ¥ï¼Œåˆ™è¿›ç¨‹æ•°é‡ä¼šè¶Šæ¥è¶Šå¤šï¼Œæ“ä½œç³»ç»Ÿè¿›ç¨‹è°ƒåº¦å’Œåˆ‡æ¢çš„é¢‘ç‡ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ï¼Œç³»ç»Ÿçš„å‹åŠ›ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒPPCæ–¹æ¡ˆæœ€å¤§çš„å¹¶å‘è¿æ¥æ•°å°±å‡ ç™¾çš„æ ·å­ã€‚</li></ul><h2 id="5-2-prefork-æå‰åˆ›å»ºè¿›ç¨‹"><a href="#5-2-prefork-æå‰åˆ›å»ºè¿›ç¨‹" class="headerlink" title="5.2 prefork æå‰åˆ›å»ºè¿›ç¨‹"></a>5.2 prefork æå‰åˆ›å»ºè¿›ç¨‹</h2><p>åœ¨å¯åŠ¨çš„æ—¶å€™å°±é¢„å…ˆåˆ›å»ºå¥½è¿›ç¨‹ï¼Œç„¶åå¼€å§‹æ¥å—ç”¨æˆ·çš„è¯·æ±‚ã€‚å½“æœ‰æ–°çš„è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥çœå»forkè¿›ç¨‹çš„æ“ä½œï¼Œè®©ç”¨æˆ·è®¿é—®æ›´å¿«ï¼Œä½“éªŒæ›´å¥½ã€‚</p><p><img src="https://i.loli.net/2020/02/04/2ukZmRXP8cWyolE.jpg" alt="fig5.jpg"></p><p>å®ç°å…³é”®ç‚¹åœ¨å¤šä¸ªå­è¿›ç¨‹éƒ½acceptåŒä¸€ä¸ªsocketï¼Œå½“æœ‰æ–°çš„è¿æ¥æ¥å…¥æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹èƒ½æœ€åacceptæˆåŠŸã€‚</p><p>preforkè¿˜æ˜¯å’ŒPPCä¸€æ ·ï¼Œå­˜åœ¨çˆ¶å­è¿›ç¨‹é€šä¿¡å¤æ‚ï¼Œæ”¯æŒçš„å¹¶å‘è¿æ¥æ•°é‡æœ‰é™çš„é—®é¢˜ã€‚</p><h2 id="5-3-TPC-Thread-Per-Connection"><a href="#5-3-TPC-Thread-Per-Connection" class="headerlink" title="5.3 TPC - Thread Per Connection"></a>5.3 TPC - Thread Per Connection</h2><p>æ¯æ¬¡æœ‰æ–°çš„è¿æ¥ï¼Œå°±å»ºç«‹ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»ä¸“é—¨å¤„ç†è¿™ä¸ªè¿æ¥çš„è¯·æ±‚ã€‚ä¸è¿›ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹æ›´è½»é‡çº§ï¼Œåˆ›å»ºçº¿ç¨‹çš„æ¶ˆè€—æ¯”è¿›ç¨‹è¦å°‘å¾—å¤šï¼›åŒæ—¶å› ä¸ºå¤šçº¿ç¨‹å…±äº«è¿›ç¨‹å†…å­˜ç©ºé—´ï¼Œå°±å¯ä»¥ç®€åŒ–çº¿ç¨‹ä¹‹é—´é€šä¿¡çš„å¤æ‚ç¨‹åº¦ã€‚</p><p><img src="https://i.loli.net/2020/02/04/3qdx1ofOb8sLW4k.png" alt="fig6.png"></p><ul><li>çˆ¶è¿›ç¨‹æ¥å—è¿æ¥</li><li>çˆ¶è¿›ç¨‹åˆ›å»ºå­çº¿ç¨‹</li><li>å­çº¿ç¨‹å¤„ç†è¿æ¥çš„è¯»å†™è¯·æ±‚</li><li>å­çº¿ç¨‹å…³é—­è¿æ¥</li></ul><p>å’ŒPPCç›¸æ¯”ï¼Œä¸»è¿›ç¨‹ä¸ç”¨closeäº†ï¼ŒåŸå› æ˜¯å­çº¿ç¨‹æ˜¯å…±äº«ä¸»è¿›ç¨‹çš„è¿›ç¨‹ç©ºé—´çš„ï¼Œè¿æ¥çš„æ–‡ä»¶æè¿°ç¬¦å¹¶æ²¡æœ‰è¢«å¤åˆ¶ï¼Œå› æ­¤åªéœ€è¦ä¸€æ¬¡closeå³å¯ã€‚</p><p>TPCå¼•å…¥äº†æ–°çš„é—®é¢˜ï¼š</p><ul><li>åˆ›å»ºçº¿ç¨‹ä¾ç„¶æœ‰è€—æŸï¼Œæ€§èƒ½é—®é¢˜</li><li>çº¿ç¨‹é—´çš„äº’æ–¥å’Œå…±äº«çš„å¤æ‚åº¦</li><li>å¤šçº¿ç¨‹ä¼šäº’ç›¸å½±å“ï¼ŒæŸä¸ªçº¿ç¨‹å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹çš„é€€å‡º</li></ul><p>åœ¨å¹¶å‘å‡ ç™¾çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¼šæ›´å¤šé‡‡ç”¨PPCçš„æ–¹æ¡ˆï¼Œå› ä¸ºæ— æ­»é”çš„é£é™©ï¼Œä¹Ÿä¸ä¼šæœ‰å¤šè¿›ç¨‹ä¹‹é—´çš„ç›¸äº’å½±å“ï¼Œç¨³å®šæ€§æ›´é«˜ã€‚</p><h2 id="5-4-prethread"><a href="#5-4-prethread" class="headerlink" title="5.4 prethread"></a>5.4 prethread</h2><p>é¢„å…ˆåˆ›å»ºçº¿ç¨‹ï¼Œç„¶åæ‰å¼€å§‹æ¥å—ç”¨æˆ·çš„è¯·æ±‚ï¼Œå½“æœ‰æ–°çš„è¿æ¥è¿›æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥çœå»åˆ›å»ºçº¿ç¨‹çš„æ“ä½œï¼Œè®©ç”¨æˆ·æ„Ÿè§‰æ›´å¿«ã€‚å¸¸ç”¨çš„å®ç°æ–¹å¼ï¼š</p><ul><li>ä¸»è¿›ç¨‹acceptï¼Œç„¶åå°†è¿æ¥äº¤ç»™æŸä¸ªçº¿ç¨‹å¤„ç†</li><li>å­çº¿ç¨‹éƒ½å°è¯•å»acceptï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹acceptæˆåŠŸ</li></ul><p><img src="https://i.loli.net/2020/02/04/8GsTH1Fokv2PLYf.jpg" alt="fig7.jpg"></p><h2 id="5-5-Reactor"><a href="#5-5-Reactor" class="headerlink" title="5.5 Reactor"></a>5.5 Reactor</h2><p>PPCæ¨¡å¼çš„é—®é¢˜æ˜¯æ¯ä¸ªè¿æ¥éƒ½è¦åˆ›å»ºè¿›ç¨‹ï¼Œè¿æ¥ç»“æŸè¿›ç¨‹å°±è¢«é”€æ¯äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç„å‡†èµ„æºå¤ç”¨ï¼Œå³ä¸å†å•ç‹¬ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºè¿›ç¨‹ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ± ï¼Œå°†è¿æ¥åˆ†é…ç»™è¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªè¿æ¥çš„ä¸šåŠ¡ã€‚</p><blockquote><p>ä¸€ä¸ªè¿›ç¨‹å¤„ç†å¤šä¸ªè¿æ¥çš„ä¸šåŠ¡</p></blockquote><p>å¼•å…¥èµ„æºæ± çš„å¤„ç†æ–¹å¼åï¼Œä¼šå¼•å‡ºä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šè¿›ç¨‹å¦‚ä½•æ‰èƒ½é«˜æ•ˆåœ°å¤„ç†å¤šä¸ªè¿æ¥çš„ä¸šåŠ¡ï¼Ÿå½“ä¸€ä¸ªè¿æ¥ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œè¿›ç¨‹å¯ä»¥é‡‡ç”¨â€œread -&gt; ä¸šåŠ¡å¤„ç† -&gt; writeâ€çš„å¤„ç†æµç¨‹ï¼Œå¦‚æœå½“å‰è¿æ¥æ²¡æœ‰æ•°æ®å¯ä»¥è¯»ï¼Œåˆ™è¿›ç¨‹å°±é˜»å¡åœ¨ read æ“ä½œä¸Šã€‚è¿™ç§é˜»å¡çš„æ–¹å¼åœ¨ä¸€ä¸ªè¿æ¥ä¸€ä¸ªè¿›ç¨‹çš„åœºæ™¯ä¸‹æ²¡æœ‰é—®é¢˜ï¼Œä½†å¦‚æœä¸€ä¸ªè¿›ç¨‹å¤„ç†å¤šä¸ªè¿æ¥ï¼Œè¿›ç¨‹é˜»å¡åœ¨æŸä¸ªè¿æ¥çš„ read æ“ä½œä¸Šï¼Œæ­¤æ—¶å³ä½¿å…¶ä»–è¿æ¥æœ‰æ•°æ®å¯è¯»ï¼Œè¿›ç¨‹ä¹Ÿæ— æ³•å»å¤„ç†ï¼Œå¾ˆæ˜¾ç„¶è¿™æ ·æ˜¯æ— æ³•åšåˆ°é«˜æ€§èƒ½çš„ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†readæ“ä½œæ”¹ä¸ºéé˜»å¡çš„ï¼Œç„¶åè¿›ç¨‹ä¸æ–­è½®è¯¢å¤šä¸ªè¿æ¥ã€‚ä½†æ˜¯è¿™æ ·åšï¼Œä¸å¥½çš„åœ°æ–¹åœ¨äºè½®è¯¢è€—è´¹CPUèµ„æºï¼›å…¶æ¬¡ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹å¤„ç†æˆåƒä¸Šä¸‡çš„è¿æ¥ï¼Œè½®è¯¢çš„æ•ˆç‡æ˜¯å¾ˆä½çš„ã€‚</p><blockquote><p>æ›´å¥½çš„è§£å†³åŠæ³•ï¼Œåªæœ‰å½“è¿æ¥ä¸Šæœ‰æ•°æ®çš„æ—¶å€™è¿›ç¨‹æ‰å»å¤„ç†ï¼Œè¿™å°±æ˜¯I/Oå¤šè·¯å¤ç”¨çš„æŠ€æœ¯çš„æ¥æº</p></blockquote><ul><li>å½“å¤šæ¡è¿æ¥å…±ç”¨ä¸€ä¸ªé˜»å¡å¯¹è±¡åï¼Œè¿›ç¨‹åªéœ€è¦åœ¨ä¸€ä¸ªé˜»å¡å¯¹è±¡ä¸Šç­‰å¾…ï¼Œè€Œæ— é¡»å†è½®è¯¢æ‰€æœ‰è¿æ¥ï¼Œå¸¸è§çš„è¿æ¥æ–¹å¼æœ‰select\epoll\kqueueç­‰ã€‚</li><li>å½“æŸæ¡è¿æ¥æœ‰æ–°çš„æ•°æ®å¯ä»¥å¤„ç†æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥è¿›ç¨‹ï¼Œè¿›ç¨‹ä»é˜»å¡çŠ¶æ€è¿”å›ï¼Œå¼€å§‹è¿›è¡Œä¸šåŠ¡å¤„ç†</li></ul><p>I/Oå¤šè·¯å¤ç”¨ç»“åˆçº¿ç¨‹æ± ï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„Reactoräº†ï¼Œå³äº‹ä»¶ååº”çš„æ„æ€</p><p>Reactorä¼šæ ¹æ®äº‹ä»¶ç±»å‹æ¥è°ƒç”¨ç›¸åº”çš„ä»£ç è¿›è¡Œå¤„ç†ï¼Œä¹Ÿæˆä¸ºdispatcheræ¨¡å¼ï¼ŒæŒ‡çš„æ˜¯I/Oå¤šè·¯å¤ç”¨ç»Ÿä¸€ç›‘å¬äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶ååˆ†é…ç»™æŸä¸ªè¿›ç¨‹çš„è¿‡ç¨‹ã€‚ </p><ul><li>Reactoræ¨¡å¼çš„benefits<ul><li>reactoræ•°é‡å¯ä»¥å˜åŒ–</li><li>èµ„æºæ± çš„æ•°é‡å¯ä»¥å˜åŒ–: ä»¥è¿›ç¨‹ä¸ºä¾‹ï¼Œå¯ä»¥æ˜¯å•è¿›ç¨‹çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªè¿›ç¨‹çš„</li></ul></li></ul><ul><li>å¸¸è§çš„ä½¿ç”¨æ–¹å¼<ul><li>å• Reactor å•è¿›ç¨‹ / çº¿ç¨‹ã€‚</li><li>å• Reactor å¤šçº¿ç¨‹ã€‚</li><li>å¤š Reactor å¤šè¿›ç¨‹ / çº¿ç¨‹ã€‚</li></ul></li></ul><p>ä¸Šè¿°æ–¹æ¡ˆé€‰æ‹©è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹ï¼Œæ›´å¤šå’Œå¹³å°ä»¥åŠç¼–ç¨‹è¯­è¨€ç›¸å…³ã€‚ä¾‹å¦‚Javaä¸€èˆ¬ä½¿ç”¨çº¿ç¨‹ - Netty, Nginxé€‰æ‹©è¿›ç¨‹</p><h3 id="5-5-1-å•Reactor-å•è¿›ç¨‹-çº¿ç¨‹"><a href="#5-5-1-å•Reactor-å•è¿›ç¨‹-çº¿ç¨‹" class="headerlink" title="5.5.1 å•Reactor å•è¿›ç¨‹/ çº¿ç¨‹"></a>5.5.1 å•Reactor å•è¿›ç¨‹/ çº¿ç¨‹</h3><p><img src="https://i.loli.net/2020/02/04/YW2N7ZBcuirMUAb.png" alt="fig8.png"></p><ul><li>select, accept, read, sendæ˜¯æ ‡å‡†çš„ç½‘ç»œç¼–ç¨‹API</li><li>dispatchå’Œä¸šåŠ¡å¤„ç†æ˜¯éœ€è¦å®Œæˆçš„æ“ä½œ</li><li>Reactorå¯¹è±¡é€šè¿‡selectç›‘æ§è¿æ¥æ—¶é—´ï¼Œæ”¶åˆ°äº‹ä»¶ä»¥åé€šè¿‡dispatchæ¥è¿›è¡Œè½¬å‘</li><li>å¦‚æœæ˜¯è¿æ¥å»ºç«‹äº‹ä»¶ï¼Œå°±äº¤ç»™Acceptorï¼Œæ¥æ¥å—è¿æ¥ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªHandleræ¥å¤„ç†æ¥ä¸‹æ¥çš„å„ç§äº‹ä»¶</li><li>å¦‚æœä¸æ˜¯è¿æ¥äº‹ä»¶ï¼Œå°±ä¼šç”¨ä¸Šé¢å·²ç»å»ºå¥½çš„handleræ¥å¤„ç†è¯·æ±‚ï¼Œåšå‡ºå“åº”</li><li>Handlerä¼šå®Œæˆread - ä¸šåŠ¡å¤„ç† -sendçš„å®Œæ•´ä¸šåŠ¡æµç¨‹</li></ul><ul><li>Benefits<ul><li>æ— è¿›ç¨‹é—´é€šä¿¡</li><li>æ— è¿›ç¨‹ç«äº‰</li></ul></li><li>Weakness<ul><li>åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œæ— æ³•å‘æŒ¥å‡ºå¤šæ ¸CPUçš„æ€§èƒ½</li><li>handleråœ¨å¤„ç†æŸä¸ªè¿æ¥ä¸Šçš„ä¸šåŠ¡æ—¶ï¼Œæ•´ä¸ªè¿›ç¨‹å°±æ— æ³•å¤„ç†</li></ul></li></ul><p>åªé€‚ç”¨äºä¸šåŠ¡å¤„ç†éå¸¸å¿«é€Ÿçš„åœºæ™¯ï¼Œç›®å‰æ¯”è¾ƒè‘—åçš„ä½¿ç”¨è¿™ä¸ªçš„å¼€æºè½¯ä»¶æ˜¯Redis</p><h3 id="5-5-2-å•Reactor-å¤šçº¿ç¨‹"><a href="#5-5-2-å•Reactor-å¤šçº¿ç¨‹" class="headerlink" title="5.5.2 å•Reactor å¤šçº¿ç¨‹"></a>5.5.2 å•Reactor å¤šçº¿ç¨‹</h3><p><img src="https://i.loli.net/2020/02/04/GlJTpkZ4DojR9HN.png" alt="fig9.png"></p><ul><li>ä¸»çº¿ç¨‹å½“ä¸­ï¼ŒReactorå¯¹è±¡é€šè¿‡selectç›‘æ§è¿æ¥æ—¶é—´ï¼Œæ”¶åˆ°äº‹ä»¶åé€šè¿‡dispatchè¿›è¡Œåˆ†å‘</li><li>blablaâ€¦ similar to above</li><li>Handleråªè´Ÿè´£å“åº”äº‹ä»¶ï¼Œä¸è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼›Handleré€šè¿‡readè¯»å–åˆ°æ•°æ®åï¼Œä¼šå‘ç»™processorè¿›è¡Œä¸šåŠ¡å¤„ç†</li><li>Processorä¼šåœ¨ç‹¬ç«‹çš„å­çº¿ç¨‹å½“ä¸­å®ŒæˆçœŸæ­£çš„ä¸šåŠ¡å¤„ç†ï¼Œç„¶åå°†å“åº”ç»“æœå‘ç»™ä¸»è¿›ç¨‹çš„Handlerå¤„ç†ï¼›Handleræ”¶åˆ°å“åº”ä»¥åé€šè¿‡sendå°†å“åº”ç»“æœè¿”å›ç»™client </li><li>Benefits<ul><li>èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸å¤šCPUçš„å¤„ç†èƒ½åŠ›</li></ul></li><li>Weakness<ul><li>å¤šçº¿ç¨‹æ•°æ®å…±äº«å’Œè®¿é—®æ¯”è¾ƒå¤æ‚</li><li>reactoræ‰¿æ‹…æ‰€æœ‰äº‹ä»¶çš„ç›‘å¬å’Œå“åº”ï¼Œåªåœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œï¼Œç¬é—´é«˜å¹¶å‘ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆ</li></ul></li></ul><h3 id="5-5-3-å¤šReactor-å¤šè¿›ç¨‹-çº¿ç¨‹"><a href="#5-5-3-å¤šReactor-å¤šè¿›ç¨‹-çº¿ç¨‹" class="headerlink" title="5.5.3 å¤šReactor å¤šè¿›ç¨‹/ çº¿ç¨‹"></a>5.5.3 å¤šReactor å¤šè¿›ç¨‹/ çº¿ç¨‹</h3><p><img src="https://i.loli.net/2020/02/04/wfyzTL47eUjQaBY.png" alt="fig10.png"></p><ul><li>çˆ¶è¿›ç¨‹ä¸­mainReactorå¯¹è±¡é€šè¿‡selectç›‘æ§è¿æ¥å»ºç«‹äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶åé€šè¿‡Acceptoræ¥æ”¶ï¼Œå°†æ–°çš„è¿æ¥åˆ†é…ç»™æŸä¸ªå­è¿›ç¨‹ã€‚</li><li>å­è¿›ç¨‹çš„subReactorå°†mainReactoråˆ†é…çš„è¿æ¥åŠ å…¥è¿æ¥é˜Ÿåˆ—è¿›è¡Œç›‘å¬ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªHandlerç”¨äºå¤„ç†è¿æ¥çš„å„ç§äº‹ä»¶</li><li>å½“æœ‰æ–°çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒsubReactorä¼šè°ƒç”¨è¿æ¥å¯¹åº”çš„handleræ¥è¿›è¡Œå“åº”</li><li>handlerå®Œæˆread - ä¸šåŠ¡å¤„ç† -sendçš„æµç¨‹</li><li>Benefits<ul><li>çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„èŒè´£éå¸¸æ˜ç¡®ï¼Œçˆ¶è¿›ç¨‹åªè´Ÿè´£æ¥æ”¶æ–°è¿æ¥ï¼Œå­è¿›ç¨‹è´Ÿè´£å®Œæˆåç»­çš„ä¸šåŠ¡å¤„ç†ã€‚</li><li>çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„äº¤äº’å¾ˆç®€å•ï¼Œçˆ¶è¿›ç¨‹åªéœ€è¦æŠŠæ–°è¿æ¥ä¼ ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹æ— é¡»è¿”å›æ•°æ®ã€‚</li><li>å­è¿›ç¨‹ä¹‹é—´æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œæ— é¡»åŒæ­¥å…±äº«ä¹‹ç±»çš„å¤„ç†ï¼ˆè¿™é‡Œä»…é™äºç½‘ç»œæ¨¡å‹ç›¸å…³çš„ selectã€readã€send ç­‰æ— é¡»åŒæ­¥å…±äº«ï¼Œâ€œä¸šåŠ¡å¤„ç†â€è¿˜æ˜¯æœ‰å¯èƒ½éœ€è¦åŒæ­¥å…±äº«çš„ï¼‰ã€‚</li></ul></li></ul><h2 id="5-6-Proactor"><a href="#5-6-Proactor" class="headerlink" title="5.6 Proactor"></a>5.6 Proactor</h2><p>Reactoræ˜¯éé˜»å¡åŒæ­¥ç½‘ç»œæ¨¡å‹ï¼Œå› ä¸ºçœŸæ­£çš„readå’Œsendæ“ä½œéƒ½éœ€è¦ç”¨æˆ·è¿›ç¨‹åŒæ­¥æ“ä½œï¼Œproactorå°†å…¶å¼‚æ­¥åŒ–ï¼Œ</p><p><img src="https://i.loli.net/2020/02/04/gV6YdJM3CLloBiA.png" alt="fig11.png"></p><ul><li>Proactor Initiator è´Ÿè´£åˆ›å»º Proactor å’Œ Handlerï¼Œå¹¶å°† Proactor å’Œ Handler éƒ½é€šè¿‡ Asynchronous Operation Processor æ³¨å†Œåˆ°å†…æ ¸ã€‚</li><li>Asynchronous Operation Processor è´Ÿè´£å¤„ç†æ³¨å†Œè¯·æ±‚ï¼Œå¹¶å®Œæˆ I/O æ“ä½œã€‚</li><li>Asynchronous Operation Processor å®Œæˆ I/O æ“ä½œåé€šçŸ¥ Proactorã€‚</li><li>Proactor æ ¹æ®ä¸åŒçš„äº‹ä»¶ç±»å‹å›è°ƒä¸åŒçš„ Handler è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚</li><li>Handler å®Œæˆä¸šåŠ¡å¤„ç†ï¼ŒHandler ä¹Ÿå¯ä»¥æ³¨å†Œæ–°çš„ Handler åˆ°å†…æ ¸è¿›ç¨‹ã€‚</li></ul><h2 id="5-7-åŒæ­¥é˜»å¡IO-vs-åŒæ­¥éé˜»å¡IO-vs-å¼‚æ­¥éé˜»å¡IO"><a href="#5-7-åŒæ­¥é˜»å¡IO-vs-åŒæ­¥éé˜»å¡IO-vs-å¼‚æ­¥éé˜»å¡IO" class="headerlink" title="5.7 åŒæ­¥é˜»å¡IO vs åŒæ­¥éé˜»å¡IO vs å¼‚æ­¥éé˜»å¡IO"></a>5.7 åŒæ­¥é˜»å¡IO vs åŒæ­¥éé˜»å¡IO vs å¼‚æ­¥éé˜»å¡IO</h2><table><thead><tr><th>-</th><th>ç­‰å¾…æ•°æ®å‡†å¤‡å¥½çš„é˜¶æ®µï¼ˆè¯»åˆ°å†…æ ¸ç¼“å­˜ï¼‰</th><th>å°†æ•°æ®ä»å†…æ ¸è¯»åˆ°ç”¨æˆ·ç©ºé—´</th></tr></thead><tbody><tr><td>åŒæ­¥é˜»å¡IO</td><td>é˜»å¡</td><td>é˜»å¡</td></tr><tr><td>åŒæ­¥éé˜»å¡IO</td><td>éé˜»å¡</td><td>é˜»å¡</td></tr><tr><td>å¼‚æ­¥éé˜»å¡IO</td><td>éé˜»å¡</td><td>éé˜»å¡</td></tr></tbody></table><h1 id="6-é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡-åˆ†ç±»åŠæ¶æ„-é«˜æ€§èƒ½é›†ç¾¤"><a href="#6-é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡-åˆ†ç±»åŠæ¶æ„-é«˜æ€§èƒ½é›†ç¾¤" class="headerlink" title="6. é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ - åˆ†ç±»åŠæ¶æ„ - é«˜æ€§èƒ½é›†ç¾¤"></a>6. é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ - åˆ†ç±»åŠæ¶æ„ - é«˜æ€§èƒ½é›†ç¾¤</h1><p>é«˜æ€§èƒ½é›†ç¾¤çš„æœ¬è´¨ï¼š é€šè¿‡å¢åŠ æ›´å¤šçš„æœåŠ¡å™¨æ¥æå‡ç³»ç»Ÿæ•´ä½“çš„è®¡ç®—èƒ½åŠ›ã€‚</p><p>ç”±äºè®¡ç®—æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå³åŒæ ·çš„è¾“å…¥æ•°æ®å’Œé€»è¾‘ï¼Œæ— è®ºåœ¨å“ªå°æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œéƒ½åº”è¯¥å¾—åˆ°ç›¸åŒçš„è¾“å‡ºã€‚å› æ­¤é«˜æ€§èƒ½é›†ç¾¤è®¾è®¡çš„å¤æ‚åº¦ä¸»è¦ä½“ç°åœ¨<strong>ä»»åŠ¡åˆ†é…</strong>è¿™éƒ¨åˆ†ï¼Œéœ€è¦è®¾è®¡åˆç†çš„ä»»åŠ¡åˆ†é…ç­–ç•¥ï¼Œå°†è®¡ç®—ä»»åŠ¡åˆ†é…åˆ°å¤šå°æœåŠ¡å™¨ä¸Šæ¥æ‰§è¡Œã€‚</p><p>å³å¤æ‚æ€§ä¸»è¦ä½“ç°åœ¨éœ€è¦å¢åŠ ä¸€ä¸ªä»»åŠ¡åˆ†é…å™¨ï¼Œä»¥åŠä¸ºä»»åŠ¡é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä»»åŠ¡åˆ†é…ç®—æ³•ã€‚</p><ul><li>ä»»åŠ¡åˆ†é…ç®—æ³•çš„è€ƒè™‘å› ç´ <ul><li>è®¡ç®—å•å…ƒçš„è´Ÿè½½å‡è¡¡</li><li>åŸºäºè´Ÿè½½è€ƒè™‘</li><li>åŸºäºæ€§èƒ½(ååé‡ã€å“åº”æ—¶é—´)è€ƒè™‘</li><li>åŸºäºä¸šåŠ¡è€ƒè™‘</li></ul></li></ul><h2 id="6-1-è´Ÿè½½å‡è¡¡åˆ†ç±»"><a href="#6-1-è´Ÿè½½å‡è¡¡åˆ†ç±»" class="headerlink" title="6.1 è´Ÿè½½å‡è¡¡åˆ†ç±»"></a>6.1 è´Ÿè½½å‡è¡¡åˆ†ç±»</h2><h3 id="6-1-1-DNSè´Ÿè½½å‡è¡¡"><a href="#6-1-1-DNSè´Ÿè½½å‡è¡¡" class="headerlink" title="6.1.1 DNSè´Ÿè½½å‡è¡¡"></a>6.1.1 DNSè´Ÿè½½å‡è¡¡</h3><p>ç”¨äºå®ç°åœ°ç†çº§åˆ«çš„å‡è¡¡ï¼Œå…¶åŸç†æ˜¯DNSè§£æåŒä¸€ä¸ªåŸŸåï¼Œå¯ä»¥è¿”å›ä¸åŒçš„IPåœ°å€ã€‚<br><img src="https://i.loli.net/2020/02/04/9Srot2PfYW35pux.jpg" alt="fig12.jpg"></p><ul><li>Benefits <ul><li>ç®€å•ï¼Œæˆæœ¬ä½</li><li>è´Ÿè½½å‡è¡¡å·¥ä½œäº¤ç»™DNSæœåŠ¡å™¨æ¥å¤„ç†ï¼Œæ— é¡»è‡ªå·±å¼€å‘æˆ–è€…ç»´æŠ¤è´Ÿè½½å‡è¡¡è®¾å¤‡</li><li>å°±è¿‘è®¿é—®ï¼Œæå‡è®¿é—®é€Ÿåº¦</li></ul></li><li>weakness<ul><li>æ›´æ–°ä¸åŠæ—¶ï¼ŒDNSç¼“å­˜æ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ›´æ–°ç¼“å­˜ä»¥åï¼Œè¿˜æœ‰å¾ˆå¤šç”¨æˆ·ä¼šè®¿é—®ä¿®æ”¹å‰çš„IPï¼Œè¿™æ ·çš„è®¿é—®ä¼šå¤±è´¥çš„</li><li>æ‰©å±•æ€§å·®ï¼ŒDNSè´Ÿè½½å‡è¡¡æ§åˆ¶æƒåœ¨åŸŸåå•†é‚£é‡Œï¼Œæ— æ³•æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é’ˆå¯¹å…¶åšæ›´å¤šçš„å®šåˆ¶åŒ–åŠŸèƒ½å’Œç‰¹æ€§çš„æ‹“å±•</li><li>åˆ†é…ç­–ç•¥æ¯”è¾ƒç®€å•: DNSè´Ÿè½½å‡è¡¡çš„æ”¯æŒç®—æ³•å°‘ï¼Œä¸èƒ½åŒºåˆ†æœåŠ¡å™¨çš„å·®å¼‚(ä¸èƒ½æ ¹æ®ç³»ç»Ÿä¸æœåŠ¡çš„çŠ¶æ€æ¥åˆ¤æ–­è´Ÿè½½)ï¼Œä¹Ÿæ— æ³•æ„ŸçŸ¥åç«¯æœåŠ¡å™¨çš„çŠ¶æ€ã€‚</li></ul></li></ul><h3 id="6-1-2-ç¡¬ä»¶è´Ÿè½½å‡è¡¡"><a href="#6-1-2-ç¡¬ä»¶è´Ÿè½½å‡è¡¡" class="headerlink" title="6.1.2 ç¡¬ä»¶è´Ÿè½½å‡è¡¡"></a>6.1.2 ç¡¬ä»¶è´Ÿè½½å‡è¡¡</h3><p>æŒ‡é€šè¿‡å•ç‹¬çš„ç¡¬ä»¶è®¾å¤‡æ¥å®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œç±»ä¼¼è·¯ç”±å™¨äº¤æ¢æœºï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç”¨äºè´Ÿè½½å‡è¡¡çš„åŸºç¡€ç½‘ç»œè®¾å¤‡ã€‚</p><ul><li><p>benefits </p><ul><li>åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå„å±‚çº§è´Ÿè½½å‡è¡¡</li><li>æ€§èƒ½å¼ºå¤§ï¼Œ100ä¸‡ä»¥ä¸Šçš„å¹¶å‘</li><li>ç¨³å®šæ€§é«˜</li><li>æ”¯æŒå®‰å…¨é˜²æŠ¤  DDos</li></ul></li><li><p>weakness</p><ul><li>ä»·æ ¼æ˜‚è´µ</li><li>æ‰©å±•èƒ½åŠ›å·®</li></ul></li></ul><h3 id="6-1-3-è½¯ä»¶è´Ÿè½½å‡è¡¡"><a href="#6-1-3-è½¯ä»¶è´Ÿè½½å‡è¡¡" class="headerlink" title="6.1.3 è½¯ä»¶è´Ÿè½½å‡è¡¡"></a>6.1.3 è½¯ä»¶è´Ÿè½½å‡è¡¡</h3><p>é€šè¿‡è´Ÿè½½å‡è¡¡è½¯ä»¶æ¥å®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œå¸¸è§çš„æœ‰Nginx - è½¯ä»¶çš„7å±‚è´Ÿè½½å‡è¡¡å’ŒLVS - Linuxå†…æ ¸çš„4å±‚è´Ÿè½½å‡è¡¡ã€‚</p><p>Nginxæ”¯æŒHTTPï¼ŒEmailåè®®; è€ŒLVSæ˜¯4å±‚è´Ÿè½½å‡è¡¡ï¼Œå’Œåè®®æ— å…³ï¼Œå‡ ä¹æ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥åšã€‚</p><p>è½¯ç¡¬ä»¶æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºæ€§èƒ½ï¼Œç¡¬ä»¶è´Ÿè½½å‡è¡¡æ€§èƒ½è¦è¿œè¿œé«˜äºè½¯ä»¶çš„å¤æ‚å‡è¡¡æ€§èƒ½ï¼Œä½†æ˜¯è½¯ä»¶çš„ä¼šä¾¿å®œå¾ˆå¤šã€‚</p><p><img src="https://i.loli.net/2020/02/04/3of7nFr6Ou1XsHg.jpg" alt="fig13.jpg"></p><ul><li>benefits<ul><li>éƒ¨ç½²ç»´æŠ¤ç®€å•</li><li>ä¾¿å®œ</li><li>çµæ´»ï¼Œå¯æ‰©å±•</li></ul></li></ul><h3 id="6-1-4-è´Ÿè½½å‡è¡¡çš„å…¸å‹æ¶æ„"><a href="#6-1-4-è´Ÿè½½å‡è¡¡çš„å…¸å‹æ¶æ„" class="headerlink" title="6.1.4 è´Ÿè½½å‡è¡¡çš„å…¸å‹æ¶æ„"></a>6.1.4 è´Ÿè½½å‡è¡¡çš„å…¸å‹æ¶æ„</h3><p>æ˜¯ç»“åˆèµ·æ¥ä¸€èµ·ç”¨çš„ï¼ŒDNSè´Ÿè½½å‡è¡¡ç”¨äºå®ç°åœ°ç†çº§åˆ«çš„è´Ÿè½½å‡è¡¡ï¼Œç¡¬ä»¶è´Ÿè½½å‡è¡¡ç”¨äºå®ç°é›†ç¾¤çº§åˆ«çš„è´Ÿè½½å‡è¡¡ï¼Œè½¯ä»¶è´Ÿè½½å‡è¡¡ç”¨äºå®ç°æœºå™¨çº§åˆ«çš„è´Ÿè½½å‡è¡¡ã€‚</p><p>æ•´ä¸ªç³»ç»Ÿçš„è´Ÿè½½å‡è¡¡åˆ†ä¸ºä¸‰å±‚ï¼š</p><ul><li>åœ°ç†çº§åˆ«è´Ÿè½½å‡è¡¡</li><li>é›†ç¾¤çº§åˆ«è´Ÿè½½å‡è¡¡  ç”¨ç¡¬ä»¶è®¾å¤‡æ¥åšå¹³å‡</li><li>æœºå™¨çº§åˆ«çš„è´Ÿè½½å‡è¡¡  ç”¨nginxï¼Œæ”¶åˆ°ç”¨æˆ·çš„è¯·æ±‚ä¹‹åï¼Œå°†ç”¨æˆ·çš„è¯·æ±‚å‘é€ç»™é›†ç¾¤é‡Œé¢çš„æŸå°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†ç”¨æˆ·çš„ä¸šåŠ¡è¯·æ±‚å¹¶è¿”å›ä¸šåŠ¡å“åº”</li></ul><h2 id="6-2-é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡-ç®—æ³•"><a href="#6-2-é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡-ç®—æ³•" class="headerlink" title="6.2 é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ - ç®—æ³•"></a>6.2 é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ - ç®—æ³•</h2><h3 id="6-2-1-åˆ†ç±»"><a href="#6-2-1-åˆ†ç±»" class="headerlink" title="6.2.1 åˆ†ç±»"></a>6.2.1 åˆ†ç±»</h3><ul><li>ä»»åŠ¡å¹³åˆ†ç±»ï¼šè´Ÿè½½å‡è¡¡ç³»ç»Ÿå°†æ”¶åˆ°çš„ä»»åŠ¡å¹³å‡åˆ†é…ç»™æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œçš„â€œå¹³å‡â€å¯ä»¥æ˜¯ç»å¯¹æ•°é‡çš„å¹³å‡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¯”ä¾‹æˆ–è€…æƒé‡ä¸Šçš„å¹³å‡ã€‚</li><li>è´Ÿè½½å‡è¡¡ç±»ï¼šè´Ÿè½½å‡è¡¡ç³»ç»Ÿæ ¹æ®æœåŠ¡å™¨çš„è´Ÿè½½æ¥è¿›è¡Œåˆ†é…ï¼Œè¿™é‡Œçš„è´Ÿè½½å¹¶ä¸ä¸€å®šæ˜¯é€šå¸¸æ„ä¹‰ä¸Šæˆ‘ä»¬è¯´çš„â€œCPU è´Ÿè½½â€ï¼Œè€Œæ˜¯ç³»ç»Ÿå½“å‰çš„å‹åŠ›ï¼Œå¯ä»¥ç”¨ CPU è´Ÿè½½æ¥è¡¡é‡ï¼Œä¹Ÿå¯ä»¥ç”¨è¿æ¥æ•°ã€I/O ä½¿ç”¨ç‡ã€ç½‘å¡ååé‡ç­‰æ¥è¡¡é‡ç³»ç»Ÿçš„å‹åŠ›ã€‚</li><li>æ€§èƒ½æœ€ä¼˜ç±»ï¼šè´Ÿè½½å‡è¡¡ç³»ç»Ÿæ ¹æ®æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥è¿›è¡Œä»»åŠ¡åˆ†é…ï¼Œä¼˜å…ˆå°†æ–°ä»»åŠ¡åˆ†é…ç»™å“åº”æœ€å¿«çš„æœåŠ¡å™¨ã€‚</li><li>Hash ç±»ï¼šè´Ÿè½½å‡è¡¡ç³»ç»Ÿæ ¹æ®ä»»åŠ¡ä¸­çš„æŸäº›å…³é”®ä¿¡æ¯è¿›è¡Œ Hash è¿ç®—ï¼Œå°†ç›¸åŒ Hash å€¼çš„è¯·æ±‚åˆ†é…åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚å¸¸è§çš„æœ‰æºåœ°å€ Hashã€ç›®æ ‡åœ°å€ Hashã€session id hashã€ç”¨æˆ· ID Hash ç­‰ã€‚</li></ul><h3 id="6-2-2-è½®è¯¢"><a href="#6-2-2-è½®è¯¢" class="headerlink" title="6.2.2 è½®è¯¢"></a>6.2.2 è½®è¯¢</h3><p>è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ”¶åˆ°è¯·æ±‚åï¼ŒæŒ‰ç…§é¡ºåºè½®æµåˆ†é…åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ— é¡»å…³æ³¨â€œæœåŠ¡å™¨æœ¬èº«çŠ¶æ€â€ï¼Œè¿™é‡Œçš„å…³é”®è¯æ˜¯â€œæœ¬èº«â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æœåŠ¡å™¨åœ¨è¿è¡Œï¼Œè¿è¡ŒçŠ¶æ€æ˜¯ä¸å…³æ³¨çš„ã€‚ä½†å¦‚æœæœåŠ¡å™¨ç›´æ¥å®•æœºäº†ï¼Œæˆ–è€…æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡ç³»ç»Ÿæ–­è¿äº†ï¼Œè¿™æ—¶è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ˜¯èƒ½å¤Ÿæ„ŸçŸ¥çš„ï¼Œä¹Ÿéœ€è¦åšå‡ºç›¸åº”çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå°†æœåŠ¡å™¨ä»å¯åˆ†é…æœåŠ¡å™¨åˆ—è¡¨ä¸­åˆ é™¤ï¼Œå¦åˆ™å°±ä¼šå‡ºç°æœåŠ¡å™¨éƒ½å®•æœºäº†ï¼Œä»»åŠ¡è¿˜ä¸æ–­åœ°åˆ†é…ç»™å®ƒï¼Œè¿™æ˜æ˜¾æ˜¯ä¸åˆç†çš„ã€‚</p><h3 id="6-2-3-åŠ æƒè½®è¯¢"><a href="#6-2-3-åŠ æƒè½®è¯¢" class="headerlink" title="6.2.3 åŠ æƒè½®è¯¢"></a>6.2.3 åŠ æƒè½®è¯¢</h3><p>è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ ¹æ®æœåŠ¡å™¨æƒé‡è¿›è¡Œä»»åŠ¡åˆ†é…ï¼Œè¿™é‡Œçš„æƒé‡ä¸€èˆ¬æ˜¯æ ¹æ®ç¡¬ä»¶é…ç½®è¿›è¡Œé™æ€é…ç½®çš„ï¼Œé‡‡ç”¨åŠ¨æ€çš„æ–¹å¼è®¡ç®—ä¼šæ›´åŠ å¥‘åˆä¸šåŠ¡ï¼Œä½†å¤æ‚åº¦ä¹Ÿä¼šæ›´é«˜ã€‚åŠ æƒè½®è¯¢ä¸»è¦ä¸ºäº†è§£å†³ä¸åŒæœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›æœ‰å·®å¼‚çš„é—®é¢˜ã€‚</p><h3 id="6-2-4-è´Ÿè½½æœ€ä½ä¼˜å…ˆ"><a href="#6-2-4-è´Ÿè½½æœ€ä½ä¼˜å…ˆ" class="headerlink" title="6.2.4 è´Ÿè½½æœ€ä½ä¼˜å…ˆ"></a>6.2.4 è´Ÿè½½æœ€ä½ä¼˜å…ˆ</h3><p>ä»æœåŠ¡å™¨çš„è§’åº¦å‡ºå‘æ¥çœ‹å¦‚ä½•è¿›è¡Œè´Ÿè½½åˆ†é…</p><p>è´Ÿè½½å‡è¡¡ç³»ç»Ÿå°†ä»»åŠ¡åˆ†é…ç»™å½“å‰è´Ÿè½½æœ€ä½çš„æœåŠ¡å™¨ï¼Œè¿™é‡Œçš„è´Ÿè½½æ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹å’Œä¸šåŠ¡åœºæ™¯ï¼Œå¯ä»¥ç”¨ä¸åŒçš„æŒ‡æ ‡æ¥è¡¡é‡ã€‚ä¾‹å¦‚ï¼š</p><ul><li>LVS è¿™ç§ 4 å±‚ç½‘ç»œè´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œå¯ä»¥ä»¥â€œè¿æ¥æ•°â€æ¥åˆ¤æ–­æœåŠ¡å™¨çš„çŠ¶æ€ï¼ŒæœåŠ¡å™¨è¿æ¥æ•°è¶Šå¤§ï¼Œè¡¨æ˜æœåŠ¡å™¨å‹åŠ›è¶Šå¤§ã€‚</li><li>Nginx è¿™ç§ 7 å±‚ç½‘ç»œè´Ÿè½½ç³»ç»Ÿï¼Œå¯ä»¥ä»¥â€œHTTP è¯·æ±‚æ•°â€æ¥åˆ¤æ–­æœåŠ¡å™¨çŠ¶æ€ï¼ˆNginx å†…ç½®çš„è´Ÿè½½å‡è¡¡ç®—æ³•ä¸æ”¯æŒè¿™ç§æ–¹å¼ï¼Œéœ€è¦è¿›è¡Œæ‰©å±•ï¼‰ã€‚</li><li>å¦‚æœæˆ‘ä»¬è‡ªå·±å¼€å‘è´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹æ¥é€‰æ‹©æŒ‡æ ‡è¡¡é‡ç³»ç»Ÿå‹åŠ›ã€‚å¦‚æœæ˜¯ CPU å¯†é›†å‹ï¼Œå¯ä»¥ä»¥â€œCPU è´Ÿè½½â€æ¥è¡¡é‡ç³»ç»Ÿå‹åŠ›ï¼›å¦‚æœæ˜¯ I/O å¯†é›†å‹ï¼Œå¯ä»¥ä»¥â€œI/O è´Ÿè½½â€æ¥è¡¡é‡ç³»ç»Ÿå‹åŠ›ã€‚</li></ul><p>è´Ÿè½½æœ€ä½ä¼˜å…ˆç®—æ³•è§£å†³äº†è½®è¯¢ç®—æ³•ä¸­æ— æ³•æ„ŸçŸ¥æœåŠ¡å™¨çŠ¶æ€çš„é—®é¢˜ï¼Œä½†å¤æ‚åº¦ä¼šå¢åŠ å¾ˆå¤šã€‚</p><ul><li>æœ€å°‘è¿æ¥æ•°ä¼˜å…ˆçš„ç®—æ³•è¦æ±‚è´Ÿè½½å‡è¡¡ç³»ç»Ÿç»Ÿè®¡æ¯ä¸ªæœåŠ¡å™¨å½“å‰å»ºç«‹çš„è¿æ¥ï¼Œå…¶åº”ç”¨åœºæ™¯ä»…é™äºè´Ÿè½½å‡è¡¡æ¥æ”¶çš„ä»»ä½•è¿æ¥è¯·æ±‚éƒ½ä¼šè½¬å‘ç»™æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™å¦‚æœè´Ÿè½½å‡è¡¡ç³»ç»Ÿå’ŒæœåŠ¡å™¨ä¹‹é—´æ˜¯å›ºå®šçš„è¿æ¥æ± æ–¹å¼ï¼Œå°±ä¸é€‚åˆé‡‡å–è¿™ç§ç®—æ³•ã€‚ä¾‹å¦‚ï¼ŒLVS å¯ä»¥é‡‡å–è¿™ç§ç®—æ³•è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œè€Œä¸€ä¸ªé€šè¿‡è¿æ¥æ± çš„æ–¹å¼è¿æ¥ MySQL é›†ç¾¤çš„è´Ÿè½½å‡è¡¡ç³»ç»Ÿå°±ä¸é€‚åˆé‡‡å–è¿™ç§ç®—æ³•è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</li><li>CPU è´Ÿè½½æœ€ä½ä¼˜å…ˆçš„ç®—æ³•è¦æ±‚è´Ÿè½½å‡è¡¡ç³»ç»Ÿä»¥æŸç§æ–¹å¼æ”¶é›†æ¯ä¸ªæœåŠ¡å™¨çš„ CPU è´Ÿè½½ï¼Œè€Œä¸”è¦ç¡®å®šæ˜¯ä»¥ 1 åˆ†é’Ÿçš„è´Ÿè½½ä¸ºæ ‡å‡†ï¼Œè¿˜æ˜¯ä»¥ 15 åˆ†é’Ÿçš„è´Ÿè½½ä¸ºæ ‡å‡†ï¼Œä¸å­˜åœ¨ 1 åˆ†é’Ÿè‚¯å®šæ¯” 15 åˆ†é’Ÿè¦å¥½æˆ–è€…å·®ã€‚ä¸åŒä¸šåŠ¡æœ€ä¼˜çš„æ—¶é—´é—´éš”æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ—¶é—´é—´éš”å¤ªçŸ­å®¹æ˜“é€ æˆé¢‘ç¹æ³¢åŠ¨ï¼Œæ—¶é—´é—´éš”å¤ªé•¿åˆå¯èƒ½é€ æˆå³°å€¼æ¥ä¸´æ—¶å“åº”ç¼“æ…¢ã€‚</li></ul><h3 id="6-2-5-æ€§èƒ½æœ€ä¼˜ç±»"><a href="#6-2-5-æ€§èƒ½æœ€ä¼˜ç±»" class="headerlink" title="6.2.5 æ€§èƒ½æœ€ä¼˜ç±»"></a>6.2.5 æ€§èƒ½æœ€ä¼˜ç±»</h3><p>ä»å®¢æˆ·ç«¯çš„è§’åº¦ï¼Œå’Œè´Ÿè½½æœ€ä½ä¼˜å…ˆç±»ç®—æ³•ç±»ä¼¼ï¼Œæ€§èƒ½æœ€ä¼˜ä¼˜å…ˆç±»ç®—æ³•æœ¬è´¨ä¸Šä¹Ÿæ˜¯æ„ŸçŸ¥äº†æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œåªæ˜¯é€šè¿‡å“åº”æ—¶é—´è¿™ä¸ªå¤–éƒ¨æ ‡å‡†æ¥è¡¡é‡æœåŠ¡å™¨çŠ¶æ€è€Œå·²ã€‚å› æ­¤æ€§èƒ½æœ€ä¼˜ä¼˜å…ˆç±»ç®—æ³•å­˜åœ¨çš„é—®é¢˜å’Œè´Ÿè½½æœ€ä½ä¼˜å…ˆç±»ç®—æ³•ç±»ä¼¼ï¼Œå¤æ‚åº¦éƒ½å¾ˆé«˜ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š</p><ul><li>è´Ÿè½½å‡è¡¡ç³»ç»Ÿéœ€è¦æ”¶é›†å’Œåˆ†ææ¯ä¸ªæœåŠ¡å™¨æ¯ä¸ªä»»åŠ¡çš„å“åº”æ—¶é—´ï¼Œåœ¨å¤§é‡ä»»åŠ¡å¤„ç†çš„åœºæ™¯ä¸‹ï¼Œè¿™ç§æ”¶é›†å’Œç»Ÿè®¡æœ¬èº«ä¹Ÿä¼šæ¶ˆè€—è¾ƒå¤šçš„æ€§èƒ½ã€‚</li><li>ä¸ºäº†å‡å°‘è¿™ç§ç»Ÿè®¡ä¸Šçš„æ¶ˆè€—ï¼Œå¯ä»¥é‡‡å–é‡‡æ ·çš„æ–¹å¼æ¥ç»Ÿè®¡ï¼Œå³ä¸ç»Ÿè®¡æ‰€æœ‰ä»»åŠ¡çš„å“åº”æ—¶é—´ï¼Œè€Œæ˜¯æŠ½æ ·ç»Ÿè®¡éƒ¨åˆ†ä»»åŠ¡çš„å“åº”æ—¶é—´æ¥ä¼°ç®—æ•´ä½“ä»»åŠ¡çš„å“åº”æ—¶é—´ã€‚é‡‡æ ·ç»Ÿè®¡è™½ç„¶èƒ½å¤Ÿå‡å°‘æ€§èƒ½æ¶ˆè€—ï¼Œä½†ä½¿å¾—å¤æ‚åº¦è¿›ä¸€æ­¥ä¸Šå‡ï¼Œå› ä¸ºè¦ç¡®å®šåˆé€‚çš„é‡‡æ ·ç‡</li><li>é‡‡æ ·å‘¨æœŸï¼Œè¦10sæ€§èƒ½æœ€ä¼˜è¿˜æ˜¯1minæ€§èƒ½æœ€ä¼˜</li></ul><h3 id="6-2-6-Hashç±»"><a href="#6-2-6-Hashç±»" class="headerlink" title="6.2.6 Hashç±»"></a>6.2.6 Hashç±»</h3><p>è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ ¹æ®ä»»åŠ¡ä¸­çš„æŸäº›å…³é”®ä¿¡æ¯è¿›è¡Œ Hash è¿ç®—ï¼Œå°†ç›¸åŒ Hash å€¼çš„è¯·æ±‚åˆ†é…åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·åšçš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†æ»¡è¶³ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><ul><li>æºåœ°å€Hash<ul><li>å°†æ¥æºäºåŒä¸€ä¸ªæº IP åœ°å€çš„ä»»åŠ¡åˆ†é…ç»™åŒä¸€ä¸ªæœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œé€‚åˆäºå­˜åœ¨äº‹åŠ¡ã€ä¼šè¯çš„ä¸šåŠ¡ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬é€šè¿‡æµè§ˆå™¨ç™»å½•ç½‘ä¸Šé“¶è¡Œæ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¼šè¯ä¿¡æ¯ï¼Œè¿™ä¸ªä¼šè¯æ˜¯ä¸´æ—¶çš„ï¼Œå…³é—­æµè§ˆå™¨åå°±å¤±æ•ˆã€‚ç½‘ä¸Šé“¶è¡Œåå°æ— é¡»æŒä¹…åŒ–ä¼šè¯ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨æŸå°æœåŠ¡å™¨ä¸Šä¸´æ—¶ä¿å­˜è¿™ä¸ªä¼šè¯å°±å¯ä»¥äº†ï¼Œä½†éœ€è¦ä¿è¯ç”¨æˆ·åœ¨ä¼šè¯å­˜åœ¨æœŸé—´ï¼Œæ¯æ¬¡éƒ½èƒ½è®¿é—®åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™ç§ä¸šåŠ¡åœºæ™¯å°±å¯ä»¥ç”¨æºåœ°å€ Hash æ¥å®ç°ã€‚</li></ul></li><li>ID Hash<ul><li>å°†æŸä¸ª ID æ ‡è¯†çš„ä¸šåŠ¡åˆ†é…åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸­è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œçš„ ID ä¸€èˆ¬æ˜¯ä¸´æ—¶æ€§æ•°æ®çš„ IDï¼ˆå¦‚ session idï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸Šè¿°çš„ç½‘ä¸Šé“¶è¡Œç™»å½•çš„ä¾‹å­ï¼Œç”¨ session id hash åŒæ ·å¯ä»¥å®ç°åŒä¸€ä¸ªä¼šè¯æœŸé—´ï¼Œç”¨æˆ·æ¯æ¬¡éƒ½æ˜¯è®¿é—®åˆ°åŒä¸€å°æœåŠ¡å™¨çš„ç›®çš„ã€‚ </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -é«˜å¯ç”¨æ¶æ„æ¨¡å¼</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-CAP-åŸç†"><a href="#1-CAP-åŸç†" class="headerlink" title="1. CAP åŸç†"></a>1. CAP åŸç†</h1><p>CAPåŸç†è®¨è®ºå¾—æ˜¯å¯¹äºæ•°æ®çš„è¯»å†™æ“ä½œï¼Œå¹¶ä¸æ˜¯åœ¨è®¨è®ºæ•´ä¸ªç³»ç»Ÿçš„å„ä¸ªæ–¹é¢çš„åŠŸèƒ½ã€‚å¹¶ä¸”è®¨è®ºå¾—æ˜¯åœ¨äº’è”å’Œåˆ†äº«æ•°æ®è¿‡ç¨‹å½“ä¸­å‡ºç°çš„é—®é¢˜</p><ul><li>Consistency  ä¸€è‡´æ€§<ul><li>where all nodes see the same data at the same time </li><li>a read is guaranteed to return the most recent write for a given client </li></ul></li><li>Availability å¯ç”¨æ€§<ul><li>guarantee that every request receives a response about whether it succeed or fail </li><li>a non-faling node will return a reasonable response within a reasonable amount of time (no error or timeout)</li></ul></li><li>Partition tolerance  åˆ†åŒºå®¹é”™æ€§ <ul><li>the system continues to operate even if any one part of the system is lost or fails  </li><li>the system will continue to function when network partitions occur </li></ul></li></ul><h2 id="1-1-CAPçš„é€‰æ‹©"><a href="#1-1-CAPçš„é€‰æ‹©" class="headerlink" title="1.1. CAPçš„é€‰æ‹©"></a>1.1. CAPçš„é€‰æ‹©</h2><p>åˆ†å¸ƒå¼ç³»ç»Ÿç†è®ºä¸Šæ¥è¯´æ— æ³•é€‰æ‹©CAæ¶æ„ï¼Œå› ä¸ºPæ˜¯å®¢è§‚å­˜åœ¨çš„ï¼Œå½“ç½‘ç»œåˆ†åŒºå‘ç”Ÿçš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯Cï¼Œé‚£ä¹ˆåªèƒ½å›æŠ¥é”™è¯¯ç»™Clientï¼Œè¿™å®è´¨ä¸Šå°±è¿åäº†Aäº†ã€‚</p><h3 id="1-1-1-CPæ¶æ„"><a href="#1-1-1-CPæ¶æ„" class="headerlink" title="1.1.1 CPæ¶æ„"></a>1.1.1 CPæ¶æ„</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œå½“å‘ç”Ÿåˆ†åŒºç°è±¡åï¼ŒN1 èŠ‚ç‚¹ä¸Šçš„æ•°æ®å·²ç»æ›´æ–°åˆ° yï¼Œä½†ç”±äº N1 å’Œ N2 ä¹‹é—´çš„å¤åˆ¶é€šé“ä¸­æ–­ï¼Œæ•°æ® y æ— æ³•åŒæ­¥åˆ° N2ï¼ŒN2 èŠ‚ç‚¹ä¸Šçš„æ•°æ®è¿˜æ˜¯ xã€‚è¿™æ—¶å®¢æˆ·ç«¯ C è®¿é—® N2 æ—¶ï¼ŒN2 éœ€è¦è¿”å› Errorï¼Œæç¤ºå®¢æˆ·ç«¯ Câ€œç³»ç»Ÿç°åœ¨å‘ç”Ÿäº†é”™è¯¯â€ï¼Œè¿™ç§å¤„ç†æ–¹å¼è¿èƒŒäº†å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰çš„è¦æ±‚ï¼Œå› æ­¤ CAP ä¸‰è€…åªèƒ½æ»¡è¶³ CPã€‚</p><p><img src="https://i.loli.net/2020/02/04/xXwWelYMtLu2hVv.png" alt="fig1.png"></p><h3 id="1-1-2-APæ¶æ„"><a href="#1-1-2-APæ¶æ„" class="headerlink" title="1.1.2 APæ¶æ„"></a>1.1.2 APæ¶æ„</h3><p>ä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼Œå½“å‘ç”Ÿåˆ†åŒºç°è±¡åï¼ŒN1 èŠ‚ç‚¹ä¸Šçš„æ•°æ®å·²ç»æ›´æ–°åˆ° yï¼Œä½†ç”±äº N1 å’Œ N2 ä¹‹é—´çš„å¤åˆ¶é€šé“ä¸­æ–­ï¼Œæ•°æ® y æ— æ³•åŒæ­¥åˆ° N2ï¼ŒN2 èŠ‚ç‚¹ä¸Šçš„æ•°æ®è¿˜æ˜¯ xã€‚è¿™æ—¶å®¢æˆ·ç«¯ C è®¿é—® N2 æ—¶ï¼ŒN2 å°†å½“å‰è‡ªå·±æ‹¥æœ‰çš„æ•°æ® x è¿”å›ç»™å®¢æˆ·ç«¯ C äº†ï¼Œè€Œå®é™…ä¸Šå½“å‰æœ€æ–°çš„æ•°æ®å·²ç»æ˜¯ y äº†ï¼Œè¿™å°±ä¸æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰çš„è¦æ±‚äº†ï¼Œå› æ­¤ CAP ä¸‰è€…åªèƒ½æ»¡è¶³ APã€‚æ³¨æ„ï¼šè¿™é‡Œ N2 èŠ‚ç‚¹è¿”å› xï¼Œè™½ç„¶ä¸æ˜¯ä¸€ä¸ªâ€œæ­£ç¡®â€çš„ç»“æœï¼Œä½†æ˜¯ä¸€ä¸ªâ€œåˆç†â€çš„ç»“æœï¼Œå› ä¸º x æ˜¯æ—§çš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªé”™ä¹±çš„å€¼ï¼Œåªæ˜¯ä¸æ˜¯æœ€æ–°çš„æ•°æ®è€Œå·²ã€‚</p><h2 id="1-2-CAP-ç»†èŠ‚"><a href="#1-2-CAP-ç»†èŠ‚" class="headerlink" title="1.2 CAP ç»†èŠ‚"></a>1.2 CAP ç»†èŠ‚</h2><h3 id="1-2-1-å…³æ³¨ç²’åº¦-æ•°æ®"><a href="#1-2-1-å…³æ³¨ç²’åº¦-æ•°æ®" class="headerlink" title="1.2.1 å…³æ³¨ç²’åº¦ - æ•°æ®"></a>1.2.1 å…³æ³¨ç²’åº¦ - æ•°æ®</h3><p>æ¯ä¸ªç³»ç»Ÿéƒ½ä¸å¯èƒ½åªå¤„ç†ä¸€ç§æ•°æ®ï¼Œè€Œæ˜¯åŒ…å«å¤šç§ç±»å‹çš„æ•°æ®ï¼Œæœ‰çš„æ•°æ®å¿…é¡»é€‰æ‹©CPï¼Œæœ‰çš„æ•°æ®å¿…é¡»é€‰æ‹©APã€‚å¦‚æœæˆ‘ä»¬ä»æ•´ä¸ªç³»ç»Ÿçš„è§’åº¦ä¸Šå»é€‰æ‹©CPè¿˜æ˜¯APï¼Œå¾ˆå®¹æ˜“é¡¾æ­¤å¤±å½¼ï¼Œæ— è®ºæ€ä¹ˆåšéƒ½æœ‰é—®é¢˜ã€‚</p><p>æ¯”å¦‚ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œé‚£ä¹ˆç”¨æˆ·è´¦æˆ·æ•°æ®ä¼šé€‰æ‹©CPï¼Œè€Œç”¨æˆ·ä¿¡æ¯æ•°æ®ä¼šé€‰æ‹©APã€‚å› ä¸ºåœ¨çœŸçš„å¯¹CAPåšåº”ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†ç³»ç»Ÿå†…çš„æ•°æ®æŒ‰ç…§ä¸åŒçš„åº”ç”¨åœºæ™¯å’Œè¦æ±‚æ¥è¿›è¡Œåˆ†ç±»ï¼Œæ¯ç±»æ•°æ®é€‰æ‹©ä¸åŒçš„ç­–ç•¥ï¼Œè€Œä¸æ˜¯é™å®šæ•´ä¸ªç³»ç»Ÿçš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯åŒä¸€ä¸ªç­–ç•¥ã€‚</p><h3 id="1-2-2-CAPæ˜¯å¿½ç•¥ç½‘ç»œå»¶è¿Ÿçš„"><a href="#1-2-2-CAPæ˜¯å¿½ç•¥ç½‘ç»œå»¶è¿Ÿçš„" class="headerlink" title="1.2.2 CAPæ˜¯å¿½ç•¥ç½‘ç»œå»¶è¿Ÿçš„"></a>1.2.2 CAPæ˜¯å¿½ç•¥ç½‘ç»œå»¶è¿Ÿçš„</h3><p>ä»èŠ‚ç‚¹Aåˆ°èŠ‚ç‚¹Bçš„å¤åˆ¶ï¼Œä¸€å®šæ˜¯éœ€è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´çš„ï¼Œä»å‡ æ¯«ç§’åˆ°å‡ åæ¯«ç§’ä¸ç­‰ã€‚è¿™æ„å‘³ç€ï¼ŒCAPçš„ç†è®ºå½“ä¸­çš„Cåœ¨å®è·µä¸­æ˜¯ä¸å¯èƒ½å®Œç¾å®ç°çš„ã€‚</p><p>å› æ­¤å¯¹äºå’Œé‡‘é’±ç›¸å…³çš„ï¼Œæˆ–è€…æ˜¯å’ŒæŠ¢è´­ç›¸å…³çš„å•†å“åº“å­˜ï¼ŒæŠ€æœ¯ä¸Šæ˜¯æ— æ³•åšåˆ°åˆ†å¸ƒå¼åœºæ™¯ä¸‹å®Œç¾çš„ä¸€è‡´æ€§çš„ã€‚è€Œä¸šåŠ¡ä¸Šåˆå¿…é¡»è¦æ±‚ä¸€è‡´æ€§ï¼Œå› æ­¤å•ä¸ªç”¨æˆ·çš„ä½™é¢ï¼Œå•†å“åº“å­˜ç­‰åªèƒ½å•ç‚¹å†™å…¥ï¼Œç„¶åè®©å…¶ä»–èŠ‚ç‚¹åšå¤‡ä»½ï¼Œæ— æ³•åšåˆ°åˆ†å¸ƒå¼æƒ…å†µä¸‹çš„å¤šç‚¹å†™å…¥ã€‚</p><p><img src="https://i.loli.net/2020/02/04/FkRpQHwIXcj5hCW.png" alt="fig3.png"></p><p>è¿™ç§è®¾è®¡çš„é—®é¢˜åœ¨äºæŸä¸ªèŠ‚ç‚¹æ•…éšœçš„æ—¶å€™ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸Šçš„ç”¨æˆ·å°±æ— æ³•è¿›è¡Œè¯»å†™æ“ä½œäº†ï¼Œä½†ç«™åœ¨æ•´ä½“ä¸Šæ¥çœ‹ï¼Œè¿™ç§è®¾è®¡å¯ä»¥é™ä½æ•…éšœæ—¶å—å½±å“çš„ç”¨æˆ·çš„æ•°é‡å’ŒèŒƒå›´ã€‚</p><h3 id="1-2-3-åˆ†åŒºå¤„ç†"><a href="#1-2-3-åˆ†åŒºå¤„ç†" class="headerlink" title="1.2.3 åˆ†åŒºå¤„ç†"></a>1.2.3 åˆ†åŒºå¤„ç†</h3><p>å¦‚æœå‡ºç°äº†åˆ†åŒºï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨åˆ†åŒºæœŸé—´è®°å½•è¶³å¤Ÿå¤šçš„æ—¥å¿—ï¼Œå½“åˆ†åŒºæ•…éšœè§£å†³ä¹‹åï¼Œç³»ç»Ÿæ ¹æ®æ—¥å¿—è¿›è¡Œæ•°æ®æ¢å¤ï¼Œä½¿å¾—é‡æ–°è¾¾åˆ°CAçš„çŠ¶æ€</p><h2 id="1-3-BASE"><a href="#1-3-BASE" class="headerlink" title="1.3 BASE"></a>1.3 BASE</h2><ul><li>basically available åŸºæœ¬å¯ç”¨<ul><li>å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ï¼Œå³ä¿è¯æ ¸å¿ƒå¯ç”¨</li></ul></li><li>soft state è½¯çŠ¶æ€<ul><li>å…è®¸ç³»ç»Ÿå­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œè€Œè¯¥ä¸­é—´çŠ¶æ€ä¸ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“å¯ç”¨æ€§ã€‚è¿™é‡Œçš„ä¸­é—´çŠ¶æ€æ˜¯CAPç†è®ºä¸­çš„æ•°æ®ä¸ä¸€è‡´ </li></ul></li><li>eventual consistency  æœ€ç»ˆä¸€è‡´æ€§ <ul><li>ç³»ç»Ÿçš„æ‰€æœ‰æ•°æ®å‰¯æœ¬ç»è¿‡ä¸€å®šæ—¶é—´ä¹‹åï¼Œæœ€ç»ˆèƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚</li></ul></li></ul><h2 id="2-3-FMEAåˆ†æè¡¨"><a href="#2-3-FMEAåˆ†æè¡¨" class="headerlink" title="2.3 FMEAåˆ†æè¡¨"></a>2.3 FMEAåˆ†æè¡¨</h2><h3 id="2-3-1-åŠŸèƒ½ç‚¹"><a href="#2-3-1-åŠŸèƒ½ç‚¹" class="headerlink" title="2.3.1 åŠŸèƒ½ç‚¹"></a>2.3.1 åŠŸèƒ½ç‚¹</h3><ul><li>ä»ç”¨æˆ·è§’åº¦çœ‹æ¶‰åŠåˆ°çš„åŠŸèƒ½ç‚¹<ul><li>ç”¨æˆ·è§’åº¦ï¼Œå³ç™»å½•æ³¨å†Œè¿™ç§åŠŸèƒ½</li><li>è€Œä¸æ˜¯æ•°æ®åº“ç¼“å­˜è¿™ç§</li></ul></li></ul><h3 id="2-3-2-æ•…éšœæ¨¡å¼"><a href="#2-3-2-æ•…éšœæ¨¡å¼" class="headerlink" title="2.3.2 æ•…éšœæ¨¡å¼"></a>2.3.2 æ•…éšœæ¨¡å¼</h3><ul><li>ç³»ç»Ÿä¼šå‡ºç°ä»€ä¹ˆæ ·çš„æ•…éšœ<ul><li>åŒ…æ‹¬æ•…éšœç‚¹</li><li>æ•…éšœæ¨¡å¼<ul><li>å‡è®¾æŸç§æ•…éšœç°è±¡å³å¯</li></ul></li></ul></li><li>æ•…éšœæ¨¡å¼çš„æè¿°è¦å°½é‡ç²¾ç¡®ï¼Œå¤šä½¿ç”¨é‡åŒ–çš„å€¼æ¥è¿›è¡Œæè¿°ï¼Œé¿å…æ³›åŒ–çš„æ–¹å¼ã€‚æ¯”å¦‚è¯´æ…¢ï¼Œæ…¢åˆ°3ç§’æ¯”è¯´å•çº¯çš„æ…¢è¦å¥½å¾—å¤šã€‚</li></ul><h3 id="2-3-3-æ•…éšœå½±å“"><a href="#2-3-3-æ•…éšœå½±å“" class="headerlink" title="2.3.3 æ•…éšœå½±å“"></a>2.3.3 æ•…éšœå½±å“</h3><p>å½“å‘ç”Ÿæ•…éšœæ¨¡å¼ä¸­æè¿°çš„æ•…éšœæ—¶ï¼ŒåŠŸèƒ½ç‚¹å…·ä½“ä¼šå—åˆ°ä»€ä¹ˆå½±å“ã€‚å¸¸è§çš„å½±å“æœ‰ï¼š</p><ul><li>åŠŸèƒ½ç‚¹å®Œå…¨ä¸å¯ç”¨</li><li>éƒ¨åˆ†ä¸å¯ç”¨</li><li>å“åº”ç¼“æ…¢</li><li>åŠŸèƒ½å‡ºé”™</li></ul><p>æ•…éšœå½±å“ä¹Ÿåº”è¯¥å°½é‡å‡†ç¡®æè¿°ï¼Œæ¯”å¦‚å¯èƒ½å½±å“20%çš„ç”¨æˆ·ä¹‹ç±»çš„ã€‚</p><h3 id="2-3-4-ä¸¥é‡ç¨‹åº¦"><a href="#2-3-4-ä¸¥é‡ç¨‹åº¦" class="headerlink" title="2.3.4 ä¸¥é‡ç¨‹åº¦"></a>2.3.4 ä¸¥é‡ç¨‹åº¦</h3><p>ç«™åœ¨ä¸šåŠ¡çš„è§’åº¦æ¥çœ‹æ•…éšœçš„å½±å“ç¨‹åº¦ï¼Œä¸€èˆ¬åˆ†ä¸ºè‡´å‘½/ é«˜/ ä¸­/ ä½/ æ—  äº”ä¸ªæ¡£æ¬¡ã€‚</p><p>ä¸¥é‡ç¨‹åº¦ = åŠŸèƒ½ç‚¹é‡è¦ç¨‹åº¦ x æ•…éšœå½±å“èŒƒå›´ x åŠŸèƒ½ç‚¹å—æŸç¨‹åº¦</p><h3 id="2-3-5-æ•…éšœåŸå› "><a href="#2-3-5-æ•…éšœåŸå› " class="headerlink" title="2.3.5 æ•…éšœåŸå› "></a>2.3.5 æ•…éšœåŸå› </h3><p>åˆ—å‡ºæ•…éšœåŸå› ï¼Œæ˜¯ä¸ºäº†</p><ul><li>æ•…éšœåŸå› éƒ½å…·æœ‰ä¸åŒçš„æ¦‚ç‡ï¼Œè¿™ä¼šå½±å“æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ</li><li>ä¸åŒæ•…éšœåŸå› æ£€æµ‹æ‰‹æ®µä¸åŒ</li><li>å¤„ç†æªæ–½ä¸åŒ</li></ul><h3 id="2-3-6-æ•…éšœæ¦‚ç‡"><a href="#2-3-6-æ•…éšœæ¦‚ç‡" class="headerlink" title="2.3.6 æ•…éšœæ¦‚ç‡"></a>2.3.6 æ•…éšœæ¦‚ç‡</h3><ul><li>ç¡¬ä»¶</li><li>å¼€æºç³»ç»Ÿ</li><li>è‡ªç ”ç³»ç»Ÿ</li></ul><h3 id="2-3-7-é£é™©ç¨‹åº¦"><a href="#2-3-7-é£é™©ç¨‹åº¦" class="headerlink" title="2.3.7 é£é™©ç¨‹åº¦"></a>2.3.7 é£é™©ç¨‹åº¦</h3><p>é£é™©ç¨‹åº¦ = ä¸¥é‡ç¨‹åº¦ x æ•…éšœæ¦‚ç‡</p><h3 id="2-3-8-å·²æœ‰æªæ–½"><a href="#2-3-8-å·²æœ‰æªæ–½" class="headerlink" title="2.3.8 å·²æœ‰æªæ–½"></a>2.3.8 å·²æœ‰æªæ–½</h3><ul><li>æ£€æµ‹å‘Šè­¦<ul><li>æ£€æµ‹æ•…éšœï¼Œå‘Šè­¦ï¼Œäººå·¥å¹²é¢„</li></ul></li><li>å®¹é”™<ul><li>ç³»ç»Ÿé€šè¿‡å¤‡ä»½æ‰‹æ®µæ¥åº”å¯¹</li></ul></li><li>è‡ªæ¢å¤<ul><li>æ£€æµ‹åˆ°æ•…éšœä»¥åï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨æ¢å¤ã€‚æ¯”å¦‚ï¼ŒHadoopæ£€æµ‹åˆ°æŸå°æœºå™¨æ•…éšœä¹‹åï¼Œå°†å­˜å‚¨åœ¨è¿™å°æœºå™¨çš„å‰¯æœ¬é‡æ–°åˆ†é…åˆ°åˆ«çš„æœºå™¨ä¸Šã€‚ </li></ul></li></ul><h3 id="2-3-9-è§„é¿æªæ–½"><a href="#2-3-9-è§„é¿æªæ–½" class="headerlink" title="2.3.9 è§„é¿æªæ–½"></a>2.3.9 è§„é¿æªæ–½</h3><ul><li>æŠ€æœ¯æ‰‹æ®µ<ul><li>å†—ä½™å¤‡ä»½ç­‰ </li></ul></li><li>ç®¡ç†æ‰‹æ®µ<ul><li>ç¡¬ä»¶å®šæœŸæ›´æ–° </li></ul></li></ul><h3 id="2-3-10-è§£å†³æªæ–½"><a href="#2-3-10-è§£å†³æªæ–½" class="headerlink" title="2.3.10 è§£å†³æªæ–½"></a>2.3.10 è§£å†³æªæ–½</h3><p>ä¸ºäº†èƒ½å¤Ÿè§£å†³é—®é¢˜è€Œç»™å‡ºçš„æ–¹æ¡ˆï¼Œå¾€å¾€æ˜¯æŠ€æœ¯æ‰‹æ®µ</p><h3 id="2-3-11-åç»­è§„åˆ’"><a href="#2-3-11-åç»­è§„åˆ’" class="headerlink" title="2.3.11 åç»­è§„åˆ’"></a>2.3.11 åç»­è§„åˆ’</h3><p>ç»¼åˆå‰é¢çš„åˆ†æï¼Œå°±å¯ä»¥çœ‹å‡ºå“ªäº›æ•…éšœæˆ‘ä»¬ç›®å‰è¿˜ç¼ºä¹å¯¹åº”çš„æªæ–½ï¼Œå“ªäº›å·²æœ‰æªæ–½è¿˜ä¸å¤Ÿï¼Œé’ˆå¯¹è¿™äº›ä¸è¶³çš„åœ°æ–¹ï¼Œå†ç»“åˆé£é™©ç¨‹åº¦è¿›è¡Œæ’åºï¼Œç»™å‡ºåç»­çš„æ”¹è¿›è§„åˆ’ã€‚è¿™äº›è§„åˆ’æ—¢å¯ä»¥æ˜¯æŠ€æœ¯æ‰‹æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯ç®¡ç†æ‰‹æ®µï¼›å¯ä»¥æ˜¯è§„é¿æªæ–½ï¼Œä¹Ÿå¯ä»¥æ˜¯è§£å†³æªæ–½ã€‚åŒæ—¶éœ€è¦è€ƒè™‘èµ„æºçš„æŠ•å…¥æƒ…å†µï¼Œä¼˜å…ˆå°†é£é™©ç¨‹åº¦é«˜çš„ç³»ç»Ÿéšæ‚£è§£å†³ã€‚</p><h1 id="3-é«˜å¯ç”¨å­˜å‚¨æ¶æ„"><a href="#3-é«˜å¯ç”¨å­˜å‚¨æ¶æ„" class="headerlink" title="3. é«˜å¯ç”¨å­˜å‚¨æ¶æ„"></a>3. é«˜å¯ç”¨å­˜å‚¨æ¶æ„</h1><p>å­˜å‚¨é«˜å¯ç”¨æ–¹æ¡ˆ â€“ æœ¬è´¨ â€“ <strong><em>å°†æ•°æ®å¤åˆ¶åˆ°å¤šä¸ªå­˜å‚¨è®¾å¤‡å½“ä¸­ï¼Œé€šè¿‡æ•°æ®å†—ä½™çš„æ–¹å¼æ¥å®ç°é«˜å¯ç”¨</em></strong>ï¼Œ å…¶å¤æ‚æ€§ä¸»è¦ä½“ç°åœ¨å¦‚ä½•åº”å¯¹å¤åˆ¶å»¶è¿Ÿå’Œä¸­æ–­å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚å› æ­¤ï¼Œå¯¹ä»»ä½•ä¸€ä¸ªé«˜å¯ç”¨å­˜å‚¨æ–¹æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>æ•°æ®å¦‚ä½•å¤åˆ¶çš„</li><li>å„ä¸ªèŠ‚ç‚¹çš„èŒè´£æ˜¯ä»€ä¹ˆ</li><li>å¦‚ä½•åº”å¯¹å¤åˆ¶å»¶è¿Ÿ</li><li>å¦‚ä½•åº”å¯¹å¤åˆ¶ä¸­æ–­</li></ul><h2 id="3-1-åŒæœºæ¶æ„"><a href="#3-1-åŒæœºæ¶æ„" class="headerlink" title="3.1 åŒæœºæ¶æ„"></a>3.1 åŒæœºæ¶æ„</h2><h3 id="3-1-1-ä¸»å¤‡å¤åˆ¶"><a href="#3-1-1-ä¸»å¤‡å¤åˆ¶" class="headerlink" title="3.1.1 ä¸»å¤‡å¤åˆ¶"></a>3.1.1 ä¸»å¤‡å¤åˆ¶</h3><p><img src="https://i.loli.net/2020/02/04/CgcTbUFLiJDKE6u.jpg" alt="fig4.jpg"></p><p>ä¸»å¤‡æ¶æ„çš„å¤‡æœºèµ·åˆ°ä¸€ä¸ªå¤‡ä»½çš„ä½œç”¨ï¼Œå¹¶ä¸æ‰¿æ‹…å®é™…çš„ä¸šåŠ¡è¯»å†™æ“ä½œï¼Œå¦‚æœå°†å¤‡æœºæ”¹ä¸ºä¸»æœºï¼Œæ˜¯éœ€è¦è¿›è¡Œäººå·¥æ“ä½œçš„ã€‚</p><ul><li>ä¼˜åŠ¿<ul><li>è¶³å¤Ÿç®€å•</li><li>å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œä¸éœ€è¦æ„ŸçŸ¥å¤‡æœºçš„å­˜åœ¨</li><li>å¯¹äºä¸»å¤‡ä¹‹é—´ï¼Œåªéœ€è¦è¿›è¡Œæ•°æ®å¤åˆ¶ï¼Œæ— é¡»è¿›è¡ŒçŠ¶æ€åˆ¤æ–­å’Œä¸»å¤‡åˆ‡æ¢è¿™ç±»å¤æ‚æ“ä½œ</li></ul></li><li>åŠ£åŠ¿<ul><li>å¤‡ä»½æ— è¯»å†™çš„æµé‡ï¼Œå› æ­¤ç¡¬ä»¶æˆæœ¬ä¸Šæ˜¯æœ‰æµªè´¹çš„</li><li>æ•…éšœä¹‹åéœ€è¦äººå·¥å¹²é¢„ï¼Œæ— æ³•åšè‡ªåŠ¨æ¢å¤</li></ul></li></ul><h3 id="3-1-2-ä¸»ä»å¤åˆ¶"><a href="#3-1-2-ä¸»ä»å¤åˆ¶" class="headerlink" title="3.1.2 ä¸»ä»å¤åˆ¶"></a>3.1.2 ä¸»ä»å¤åˆ¶</h3><p><img src="https://i.loli.net/2020/02/04/JyKOIvYmc78Ut2Q.jpg" alt="fig5.jpg"></p><ul><li>ä¼˜åŠ¿<ul><li>ä¸»ä»å¤åˆ¶åœ¨ä¸»æœºæ•…éšœæ—¶ï¼Œè¯»æ“ä½œç›¸å…³çš„ä¸šåŠ¡å¯ä»¥ç»§ç»­è¿è¡Œ</li><li>ä¸»ä»å¤åˆ¶æ¶æ„çš„ä»æœºæä¾›è¯»æ“ä½œï¼Œå‘æŒ¥äº†ç¡¬ä»¶çš„æ€§èƒ½</li></ul></li><li>åŠ£åŠ¿<ul><li>ä¸»ä»å¤åˆ¶å½“ä¸­ï¼Œå®¢æˆ·ç«¯éœ€è¦æ„ŸçŸ¥ä¸»ä»å…³ç³»ï¼Œå¹¶å°†ä¸åŒçš„æ“ä½œå‘ç»™ä¸åŒçš„æœºå™¨è¿›è¡Œå¤„ç†ï¼Œå¤æ‚åº¦æ¯”ä¸»å¤‡çš„è¦é«˜</li><li>ä¸»ä»å¤åˆ¶æ¶æ„å½“ä¸­ï¼Œä»æœºæä¾›è¯»ä¸šåŠ¡ï¼Œå¦‚æœä¸»ä»å¤åˆ¶å»¶è¿Ÿæ¯”è¾ƒå¤§ï¼Œä¸šåŠ¡ä¼šå› ä¸ºæ•°æ®ä¸ä¸€è‡´å‡ºç°é—®é¢˜</li><li>æ•…éšœæ—¶éœ€è¦äººå·¥å¹²é¢„</li></ul></li></ul><h3 id="3-1-3-ä¸»å¤‡-ä¸»ä»åˆ‡æ¢"><a href="#3-1-3-ä¸»å¤‡-ä¸»ä»åˆ‡æ¢" class="headerlink" title="3.1.3 ä¸»å¤‡/ ä¸»ä»åˆ‡æ¢"></a>3.1.3 ä¸»å¤‡/ ä¸»ä»åˆ‡æ¢</h3><p>ç³»ç»Ÿè‡ªåŠ¨å†³å®šä¸»æœºè§’è‰²ï¼Œå¹¶å®Œæˆè§’è‰²çš„åˆ‡æ¢ã€‚</p><p>ä»¥ä¸»å¤‡ä¸ºä¾‹ï¼Œéœ€è¦è€ƒè™‘çš„é—®é¢˜æœ‰ï¼š</p><h4 id="3-1-3-1-ä¸»å¤‡é—´çŠ¶æ€åˆ¤æ–­"><a href="#3-1-3-1-ä¸»å¤‡é—´çŠ¶æ€åˆ¤æ–­" class="headerlink" title="3.1.3.1 ä¸»å¤‡é—´çŠ¶æ€åˆ¤æ–­"></a>3.1.3.1 ä¸»å¤‡é—´çŠ¶æ€åˆ¤æ–­</h4><ul><li>çŠ¶æ€ä¼ é€’æ¸ é“<ul><li>ç›¸äº’ä¹‹é—´çš„è¿æ¥</li><li>ç¬¬ä¸‰æ–¹ä»²è£</li></ul></li><li>çŠ¶æ€æ£€æµ‹çš„å†…å®¹<ul><li>æœºå™¨æ˜¯å¦æ‰ç”µ</li><li>è¿›ç¨‹æ˜¯å¦å­˜åœ¨</li><li>å“åº”æ˜¯å¦ç¼“æ…¢</li></ul></li></ul><h4 id="3-1-3-2-åˆ‡æ¢å†³ç­–"><a href="#3-1-3-2-åˆ‡æ¢å†³ç­–" class="headerlink" title="3.1.3.2 åˆ‡æ¢å†³ç­–"></a>3.1.3.2 åˆ‡æ¢å†³ç­–</h4><ul><li>åˆ‡æ¢æ—¶æœº</li><li>åˆ‡æ¢ç­–ç•¥</li><li>è‡ªåŠ¨ç¨‹åº¦</li></ul><h4 id="3-1-3-3-æ•°æ®å†²çªè§£å†³"><a href="#3-1-3-3-æ•°æ®å†²çªè§£å†³" class="headerlink" title="3.1.3.3 æ•°æ®å†²çªè§£å†³"></a>3.1.3.3 æ•°æ®å†²çªè§£å†³</h4><ul><li>éœ€è¦åšå…·ä½“çš„åº”ç”¨åœºæ™¯çš„å…·ä½“åˆ†æäº†</li></ul><h4 id="3-1-3-4-å¸¸è§ä¸»å¤‡åˆ‡æ¢æ¶æ„"><a href="#3-1-3-4-å¸¸è§ä¸»å¤‡åˆ‡æ¢æ¶æ„" class="headerlink" title="3.1.3.4 å¸¸è§ä¸»å¤‡åˆ‡æ¢æ¶æ„"></a>3.1.3.4 å¸¸è§ä¸»å¤‡åˆ‡æ¢æ¶æ„</h4><ul><li>äº’è¿å¼<ul><li>ä¸»å¤‡ä¹‹é—´è¿›è¡ŒçŠ¶æ€ä¼ é€’</li><li>ç¼ºç‚¹<ul><li>çŠ¶æ€ä¼ é€’é€šé“æœ¬èº«å­˜åœ¨é—®é¢˜çš„è¯ï¼Œå¤‡æœºä¹Ÿä¼šè‡ªåŠ¨å‡çº§ä¸ºä¸»æœºï¼Œé€ æˆæœ‰ä¸¤ä¸ªä¸»æœºçš„ç»“æœ</li></ul></li></ul></li><li>ä¸­ä»‹å¼<ul><li>å¼•å…¥ç¬¬ä¸‰æ–¹ä¸­ä»‹ï¼Œä¸»å¤‡é—´ä¸ç›´æ¥è¿æ¥ï¼Œè€Œæ˜¯å»è¿æ¥ä¸­ä»‹ï¼Œå¹¶ä¸”é€šè¿‡ä¸­ä»‹æ¥ä¼ é€’çŠ¶æ€ä¿¡æ¯</li><li>è¿æ¥ç®¡ç†ä»¥åŠçŠ¶æ€å†³ç­–éƒ½æ›´ç®€å•ä¸€äº›äº†</li></ul></li><li>æ¨¡æ‹Ÿå¼<ul><li>ä¸»å¤‡ä¹‹é—´ä¸ä¼ é€’ä»»ä½•çŠ¶æ€æ•°æ®ï¼Œè€Œæ˜¯å¤‡æœºæ¨¡æ‹Ÿæˆä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå‘ä¸»æœºå‘èµ·æ¨¡æ‹Ÿçš„è¯»å†™æ“ä½œï¼Œæ ¹æ®è¯»å†™æ“ä½œçš„å“åº”æƒ…å†µæ¥åˆ¤æ–­ä¸»æœºçš„çŠ¶æ€ã€‚ </li></ul></li></ul><h3 id="3-1-4-ä¸»ä¸»å¤åˆ¶"><a href="#3-1-4-ä¸»ä¸»å¤åˆ¶" class="headerlink" title="3.1.4 ä¸»ä¸»å¤åˆ¶"></a>3.1.4 ä¸»ä¸»å¤åˆ¶</h3><p><img src="https://i.loli.net/2020/02/04/o8ZKUvW4VEeY1nQ.png" alt="fig6.png"></p><ul><li>ä¸¤å°éƒ½æ˜¯ä¸»æœºï¼Œä¸å­˜åœ¨åˆ‡æ¢çš„æ¦‚å¿µ</li><li>å®¢æˆ·ç«¯æ— é¡»åŒºåˆ†ä¸åŒè§’è‰²çš„ä¸»æœºï¼Œéšä¾¿è®²è¯»å†™æ“ä½œå‘é€ç»™å“ªå°ä¸»æœºéƒ½æ˜¯å¯ä»¥çš„</li><li>åŒå‘å¤åˆ¶æœ¬èº«çš„éš¾ä»¥å®ç°<ul><li>æ¯”å¦‚æ•°æ®åº“åŒæ­¥ï¼ŒIDå¦‚ä½•åšæ›´æ–°ç­‰</li><li>ä¸€èˆ¬é€‚åˆäºä¸´æ—¶æ€§ï¼Œå¯ä¸¢å¤±ï¼Œå¯è¦†ç›–çš„æ•°æ®åœºæ™¯</li></ul></li></ul><h2 id="3-2-é›†ç¾¤å’Œåˆ†åŒº"><a href="#3-2-é›†ç¾¤å’Œåˆ†åŒº" class="headerlink" title="3.2 é›†ç¾¤å’Œåˆ†åŒº"></a>3.2 é›†ç¾¤å’Œåˆ†åŒº</h2><h3 id="3-2-1-æ•°æ®é›†ç¾¤"><a href="#3-2-1-æ•°æ®é›†ç¾¤" class="headerlink" title="3.2.1 æ•°æ®é›†ç¾¤"></a>3.2.1 æ•°æ®é›†ç¾¤</h3><p>ä¸»å¤‡ï¼Œä¸»ä»ï¼Œä¸»ä¸»éƒ½æœ‰ä¸€ä¸ªéšå«çš„å‡è®¾ï¼Œä¸»æœºèƒ½å¤Ÿå­˜å‚¨æ‰€æœ‰æ•°æ®ã€‚ä½†æ˜¯åœ¨å®é™…åœºæ™¯å½“ä¸­ï¼Œä¸€å°ä¸»æœºçš„å­˜å‚¨å’Œå¤„ç†èƒ½åŠ›éƒ½æ˜¯ååˆ†æœ‰é™çš„ï¼Œå•å°æœåŠ¡å™¨ä¸€å®šæ˜¯æ— æ³•å­˜å‚¨å’Œå¤„ç†çš„ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨å¤šå°æœåŠ¡å™¨æ¥å­˜å‚¨æ•°æ®ï¼Œå®ç°ä¸€ä¸ªæ•°æ®é›†ç¾¤æ¶æ„ã€‚</p><p>æ•°æ®é›†ç¾¤åˆå¯ä»¥åˆ†ä¸ºæ•°æ®é›†ä¸­é›†ç¾¤ï¼Œæ•°æ®åˆ†æ•£é›†ç¾¤</p><h4 id="3-2-1-1-æ•°æ®é›†ä¸­é›†ç¾¤"><a href="#3-2-1-1-æ•°æ®é›†ä¸­é›†ç¾¤" class="headerlink" title="3.2.1.1 æ•°æ®é›†ä¸­é›†ç¾¤"></a>3.2.1.1 æ•°æ®é›†ä¸­é›†ç¾¤</h4><p><img src="https://i.loli.net/2020/02/04/93XQRrAHzuItK86.png" alt="fig7.png"></p><p> å®¢æˆ·ç«¯ä¸ä¸»æœºè¿›è¡Œäº¤æµï¼Œä¸»æœºè¿›è¡Œæ•°æ®å¤åˆ¶åˆ°å„ä¸ªå¤‡æœºä¸Šå»ã€‚Zookeeperè§£å†³äº†å¤§éƒ¨åˆ†æ•°æ®é›†ä¸­é›†ç¾¤ä¸­ä¼šå‡ºç°çš„é—®é¢˜ã€‚</p><ul><li>å¤šæ¡å¤åˆ¶é€šé“ï¼Œä¼šå¢å¤§ä¸»æœºå¤åˆ¶çš„å‹åŠ›ï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•é™ä½ä¸»æœºå¤åˆ¶å‹åŠ›</li><li>å¤šæ¡å¤åˆ¶é€šé“ä¼šå¯¼è‡´å¤šä¸ªå¤‡æœºä¹‹é—´æ•°æ®ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¤‡æœºä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§è¿›è¡Œæ£€æŸ¥å’Œä¿®æ­£</li><li>å¤‡æœºå¦‚ä½•æ£€æŸ¥ä¸»æœºçš„çŠ¶æ€ï¼Œå¦‚ä½•å¤„ç†ä¸åŒå¤‡æœºå¯¹ä¸»æœºçŠ¶æ€çš„ä¸åŒåˆ¤æ–­</li><li>ä¸»æœºæ•…éšœä»¥åï¼Œå¦‚ä½•å†³å®šæ–°çš„ä¸»æœº</li></ul><h4 id="3-2-1-2-æ•°æ®åˆ†æ•£é›†ç¾¤"><a href="#3-2-1-2-æ•°æ®åˆ†æ•£é›†ç¾¤" class="headerlink" title="3.2.1.2 æ•°æ®åˆ†æ•£é›†ç¾¤"></a>3.2.1.2 æ•°æ®åˆ†æ•£é›†ç¾¤</h4><ul><li><p>å¤šä¸ªæœåŠ¡å™¨ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œæ¯å°æœåŠ¡å™¨éƒ½ä¼šè´Ÿè´£å­˜å‚¨ä¸€éƒ¨åˆ†æ•°æ®ï¼›åŒæ—¶ä¸ºäº†æå‡ç¡¬ä»¶åˆ©ç”¨ç‡ï¼Œæ¯å°æœåŠ¡å™¨åˆä¼šå¤‡ä»½ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p></li><li><p>æ•°æ®åˆ†é…ç®—æ³•éœ€è¦è€ƒè™‘åˆ°ï¼š</p><ul><li>å‡è¡¡æ€§ â€“ æ•°æ®åˆ†åŒºï¼Œæ•°æ®å®¹é‡åŸºæœ¬ä¸Šç›¸åŒ</li><li>å®¹é”™æ€§ â€“ å½“æœåŠ¡å™¨æ•…éšœæ—¶ï¼Œç®—æ³•éœ€è¦å°†åŸæ¥åˆ†é…ç»™æ•…éšœæœåŠ¡å™¨çš„æ•°æ®åˆ†åŒºåˆ†é…ç»™å…¶ä»–æœåŠ¡å™¨</li><li>å¯ä¼¸ç¼©æ€§ â€“ é›†ç¾¤å®¹é‡ä¸å¤Ÿï¼Œæ‰©å……äº†æ–°çš„æœåŠ¡å™¨ä¹‹åï¼Œç®—æ³•èƒ½å¤Ÿè‡ªåŠ¨å°†éƒ¨åˆ†æ•°æ®åˆ†åŒºè¿ç§»åˆ°æ–°æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¿è¯æ‰©å®¹åæ‰€æœ‰æœåŠ¡å™¨çš„å‡è¡¡æ€§</li></ul></li><li><p>éœ€è¦æœ‰ä¸€å°æœºå™¨æ¥æ‰§è¡Œæ•°æ®åˆ†é…ç®—æ³•</p></li></ul><h3 id="3-2-2-æ•°æ®åˆ†åŒº"><a href="#3-2-2-æ•°æ®åˆ†åŒº" class="headerlink" title="3.2.2 æ•°æ®åˆ†åŒº"></a>3.2.2 æ•°æ®åˆ†åŒº</h3><p>é’ˆå¯¹äºå½±å“å¾ˆå¤§çš„äº‹æ•…æˆ–è€…ç¾éš¾æ¥è¯´ï¼Œæœ‰å¯èƒ½ä¼šä½¿å¾—æ‰€æœ‰ç¡¬ä»¶å…¨éƒ¨æ•…éšœã€‚æ•°æ®åˆ†åŒºæŒ‡çš„æ˜¯æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œåˆ†åŒºï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„åœ°ç†ä½ç½®ä¸Šï¼Œæ¯ä¸ªåˆ†åŒºå­˜å‚¨ä¸€éƒ¨åˆ†æ•°æ®ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥è§„é¿åœ°ç†çº§åˆ«çš„æ•…éšœæ‰€é€ æˆçš„çš„å½±å“ã€‚</p><ul><li>æ•°æ®åˆ†åŒºçš„è€ƒè™‘å› ç´ <ul><li>æ•°æ®é‡</li><li>åˆ†åŒºè§„åˆ™</li><li>å¤åˆ¶è§„åˆ™<ul><li>é›†ä¸­å¼<ul><li>æ€»çš„å¤‡ä»½ä¸­å¿ƒï¼Œæ‰€æœ‰åˆ†åŒºå°†æ•°æ®å¤‡ä»½åˆ°å¤‡ä»½ä¸­å¿ƒ</li><li>è®¾è®¡ç®€å•ï¼Œå¯äº’ä¸å½±å“</li><li>æ‰©å±•å®¹æ˜“</li><li>æˆæœ¬è¾ƒé«˜ï¼Œéœ€è¦å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„å¤‡ä»½ä¸­å¿ƒ</li></ul></li><li>äº’å¤‡å¼<ul><li>æ¯ä¸ªåˆ†åŒºå¤‡ä»½å¦å¤–ä¸€ä¸ªåˆ†åŒºçš„æ•°æ®</li><li>å¤æ‚åº¦é«˜ï¼Œç›¸äº’ä¹‹é—´å¼ºå…³è”</li><li>æˆæœ¬ä½</li></ul></li><li>ç‹¬ç«‹å¼<ul><li>æ¯ä¸ªåˆ†åŒºéƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹çš„å¤‡ä»½ä¸­å¿ƒ</li><li>æ‰©å±•å®¹æ˜“ï¼Œè®¾è®¡ç®€å•</li><li>æˆæœ¬å¾ˆé«˜</li></ul></li></ul></li></ul></li></ul><h1 id="4-è®¡ç®—é«˜å¯ç”¨æ¶æ„"><a href="#4-è®¡ç®—é«˜å¯ç”¨æ¶æ„" class="headerlink" title="4. è®¡ç®—é«˜å¯ç”¨æ¶æ„"></a>4. è®¡ç®—é«˜å¯ç”¨æ¶æ„</h1><p>å½“éƒ¨åˆ†ç¡¬ä»¶æŸåæ—¶ï¼Œè®¡ç®—ä»»åŠ¡èƒ½å¤Ÿç»§ç»­æ­£å¸¸è¿è¡Œã€‚å› æ­¤è®¡ç®—é«˜å¯ç”¨çš„æœ¬è´¨æ˜¯é€šè¿‡å†—ä½™æ¥è§„é¿éƒ¨åˆ†æ•…éšœçš„é£é™©ã€‚å³é€šè¿‡å¢åŠ æ›´å¤šçš„æœåŠ¡å™¨æ¥è¾¾åˆ°è®¡ç®—é«˜å¯ç”¨ã€‚</p><p>è®¾è®¡å¤æ‚åº¦ä¸»è¦ä½“ç°åœ¨ä»»åŠ¡ç®¡ç†ä¸Šï¼Œå³å½“ä»»åŠ¡åœ¨æŸå°æœåŠ¡å™¨ä¸Šæ‰§è¡Œå¤±è´¥ä»¥åï¼Œå¦‚ä½•å°†ä»»åŠ¡é‡æ–°åˆ†é…åˆ°æ–°çš„æœåŠ¡å™¨è¿›è¡Œæ‰§è¡Œã€‚</p><h2 id="4-1-å“ªäº›æœåŠ¡å™¨å¯ä»¥æ‰§è¡Œä»»åŠ¡"><a href="#4-1-å“ªäº›æœåŠ¡å™¨å¯ä»¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="4.1 å“ªäº›æœåŠ¡å™¨å¯ä»¥æ‰§è¡Œä»»åŠ¡"></a>4.1 å“ªäº›æœåŠ¡å™¨å¯ä»¥æ‰§è¡Œä»»åŠ¡</h2><ul><li>ç‰¹å®šæœåŠ¡å™¨</li><li>æ¯ä¸ªæœåŠ¡å™¨</li></ul><h2 id="4-2-ä»»åŠ¡å¦‚ä½•é‡æ–°æ‰§è¡Œ"><a href="#4-2-ä»»åŠ¡å¦‚ä½•é‡æ–°æ‰§è¡Œ" class="headerlink" title="4.2 ä»»åŠ¡å¦‚ä½•é‡æ–°æ‰§è¡Œ"></a>4.2 ä»»åŠ¡å¦‚ä½•é‡æ–°æ‰§è¡Œ</h2><ul><li>å¯¹å·²ç»åˆ†é…çš„ä»»åŠ¡å³ä½¿æ‰§è¡Œå¤±è´¥ä¹Ÿä¸åšä»»ä½•å¤„ç†ï¼Œç³»ç»Ÿåªéœ€è¦ä¿è¯æ–°çš„ä»»åŠ¡èƒ½å¤Ÿåˆ†é…åˆ°å…¶ä»–éæ•…éšœçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œå³å¯</li><li>è®¾è®¡ä¸€ä¸ªä»»åŠ¡ç®¡ç†å™¨æ¥ç®¡ç†éœ€è¦æ‰§è¡Œçš„è®¡ç®—ä»»åŠ¡ï¼ŒæœåŠ¡å™¨æ‰§è¡Œä»»åŠ¡åï¼Œéœ€è¦å‘ä»»åŠ¡ç®¡ç†å™¨åé¦ˆä»»åŠ¡æ‰§è¡Œçš„ç»“æœï¼Œä»»åŠ¡ç®¡ç†å™¨æ ¹æ®ä»»åŠ¡æ‰§è¡Œç»“æœæ¥å†³å®šæ˜¯å¦éœ€è¦å°†ä»»åŠ¡é‡æ–°åˆ†é…åˆ°å¦å¤–çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</li></ul><h2 id="4-3-å¸¸è§çš„è®¡ç®—é«˜å¯ç”¨æ¶æ„"><a href="#4-3-å¸¸è§çš„è®¡ç®—é«˜å¯ç”¨æ¶æ„" class="headerlink" title="4.3 å¸¸è§çš„è®¡ç®—é«˜å¯ç”¨æ¶æ„"></a>4.3 å¸¸è§çš„è®¡ç®—é«˜å¯ç”¨æ¶æ„</h2><h3 id="4-3-1-ä¸»å¤‡"><a href="#4-3-1-ä¸»å¤‡" class="headerlink" title="4.3.1 ä¸»å¤‡"></a>4.3.1 ä¸»å¤‡</h3><p><img src="https://i.loli.net/2020/02/04/mGLY492oBbOqitu.png" alt="fig8.png"></p><ul><li>å’Œå­˜å‚¨é«˜å¯ç”¨ç±»ä¼¼ï¼Œä¸è¿‡æ›´ç®€å•ï¼Œå› ä¸ºä¸éœ€è¦åšæ•°æ®å¤åˆ¶çš„</li><li>ä¸»æœºæ‰§è¡Œæ‰€æœ‰è®¡ç®—ä»»åŠ¡</li><li>ä¸»æœºæ•…éšœï¼Œä»»åŠ¡åˆ†é…å™¨ä¸ä¼šè‡ªåŠ¨å°†è®¡ç®—ä»»åŠ¡å‘ç»™å¤‡æœºï¼Œç³»ç»Ÿæ­¤æ—¶æ˜¯ä¸å¯ç”¨çŠ¶æ€</li><li>å¦‚æœä¸»æœºæ¢å¤(äººå·¥æˆ–è‡ªåŠ¨)ï¼Œä»»åŠ¡åˆ†é…å™¨ç»§ç»­å°†ä»»åŠ¡å‘é€ç»™ä¸»æœº</li><li>å¦‚æœä¸»æœºä¸èƒ½å¤Ÿæ¢å¤ï¼Œåˆ™éœ€è¦äººå·¥æ“ä½œï¼Œå°†å¤‡æœºå‡ä¸ºä¸»æœºï¼Œç„¶åè®©ä»»åŠ¡åˆ†é…å™¨å°†ä»»åŠ¡å‘é€ç»™æ–°çš„ä¸»æœº</li></ul><h3 id="4-3-2-ä¸»ä»"><a href="#4-3-2-ä¸»ä»" class="headerlink" title="4.3.2 ä¸»ä»"></a>4.3.2 ä¸»ä»</h3><p><img src="https://i.loli.net/2020/02/04/Z4yh5EUqFCBPokT.png" alt="fig9.png"></p><ul><li>ä¸»æœºæ‰§è¡Œéƒ¨åˆ†è®¡ç®—ä»»åŠ¡ï¼Œå¤‡æœºä¹Ÿæ‰§è¡Œä¸€éƒ¨åˆ†</li><li>ä¸»æœºæ•…éšœæ—¶ï¼Œä»»åŠ¡åˆ†é…å™¨è¿˜æ˜¯ä¼šå‘ç»™ä¸»æœº</li><li>ä¸èƒ½æ¢å¤ï¼Œäººå·¥æ“ä½œï¼Œå¤‡æœºå˜ä¸»æœºï¼Œå¢åŠ æ–°çš„å¤‡æœº</li><li>å¥½å¤„æ˜¯ä»æœºæ‰§è¡Œä»»åŠ¡ï¼Œå‘æŒ¥äº†ç¡¬ä»¶æ€§èƒ½ï¼›ç¼ºç‚¹æ˜¯éœ€è¦å°†ä»»åŠ¡åˆ†ç±»ï¼Œä»»åŠ¡åˆ†é…å™¨ä¼šå¤æ‚ä¸€äº›</li></ul><h3 id="4-3-3-é›†ç¾¤"><a href="#4-3-3-é›†ç¾¤" class="headerlink" title="4.3.3 é›†ç¾¤"></a>4.3.3 é›†ç¾¤</h3><p>ç³»ç»Ÿéœ€è¦èƒ½å¤Ÿè‡ªåŠ¨å®Œæˆåˆ‡æ¢æ“ä½œï¼Œè¿™æ˜¯é«˜å¯ç”¨é›†ç¾¤æ–¹æ¡ˆã€‚æ ¹æ®èŠ‚ç‚¹çš„è§’è‰²ï¼Œå¯ä»¥åˆ†æˆå¯¹ç§°é›†ç¾¤ï¼Œé›†ç¾¤å†…çš„æ¯ä¸ªæœåŠ¡å™¨éƒ½æœ‰ä¸€æ ·çš„è§’è‰²ï¼Œéƒ½å¯ä»¥æ‰§è¡Œæ‰€æœ‰çš„ä»»åŠ¡ï¼›å¦ä¸€ç±»æ˜¯éå¯¹ç§°é›†ç¾¤ï¼Œé›†ç¾¤ä¸­æœåŠ¡å™¨åˆ†ä¸ºå¤šä¸ªä¸åŒè§’è‰²ï¼Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚</p><h4 id="4-3-3-1-å¯¹ç§°é›†ç¾¤-è´Ÿè½½å‡è¡¡é›†ç¾¤"><a href="#4-3-3-1-å¯¹ç§°é›†ç¾¤-è´Ÿè½½å‡è¡¡é›†ç¾¤" class="headerlink" title="4.3.3.1 å¯¹ç§°é›†ç¾¤ - è´Ÿè½½å‡è¡¡é›†ç¾¤"></a>4.3.3.1 å¯¹ç§°é›†ç¾¤ - è´Ÿè½½å‡è¡¡é›†ç¾¤</h4><p><img src="https://i.loli.net/2020/02/04/hIbCsuAmKclkiqT.png" alt="fig10.png"></p><ul><li>ä»»åŠ¡åˆ†é…å™¨é‡‡å–æŸç§ç­–ç•¥(éšæœºã€è½®è¯¢ç­‰)å°†è®¡ç®—ä»»åŠ¡åˆ†é…ç»™é›†ç¾¤å½“ä¸­çš„ä¸åŒæœåŠ¡å™¨</li><li>å½“é›†ç¾¤ä¸­çš„æŸå°æœåŠ¡å™¨å‡ºç°æ•…éšœä»¥åï¼Œä»»åŠ¡åˆ†é…å™¨ä¸å†å°†ä»»åŠ¡åˆ†é…ç»™å®ƒï¼Œè€Œæ˜¯å°†ä»»åŠ¡åˆ†é…ç»™å…¶ä»–æœåŠ¡å™¨æ‰§è¡Œ</li><li>å½“æ•…éšœçš„æœåŠ¡å™¨æ¢å¤ä¹‹åï¼Œä»»åŠ¡åˆ†é…å™¨é‡æ–°å°†ä»»åŠ¡åˆ†é…ç»™å®ƒæ‰§è¡Œ</li></ul><ul><li>éš¾ç‚¹<ul><li>åˆ†é…ç­–ç•¥<ul><li>è½®è¯¢</li><li>éšæœº</li></ul></li><li>æ£€æµ‹æœåŠ¡å™¨çŠ¶æ€<ul><li>æœåŠ¡å™¨æœ¬èº«çŠ¶æ€<ul><li>æ˜¯å¦å®•æœº</li><li>ç½‘ç»œæ˜¯å¦æ­£å¸¸</li></ul></li><li>ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€<ul><li>ä»»åŠ¡å¡æ­»</li><li>æ‰§è¡Œæ—¶é—´è¿‡é•¿ç­‰</li></ul></li><li>ä¸€èˆ¬æ¥è¯´æ˜¯é€šè¿‡åœ¨ä»»åŠ¡åˆ†é…å™¨å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡å¿ƒè·³æ¥ä¼ é€’ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯å’Œä»»åŠ¡ä¿¡æ¯ï¼Œç„¶åæ ¹æ®å®é™…æƒ…å†µæ¥ç¡®å®šçŠ¶æ€ï¼Œåˆ¤æ–­æ¡ä»¶</li></ul></li></ul></li></ul><h4 id="4-3-3-2-éå¯¹ç§°é›†ç¾¤"><a href="#4-3-3-2-éå¯¹ç§°é›†ç¾¤" class="headerlink" title="4.3.3.2 éå¯¹ç§°é›†ç¾¤"></a>4.3.3.2 éå¯¹ç§°é›†ç¾¤</h4><ul><li>é›†ç¾¤é€šè¿‡æŸç§æ–¹å¼æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡å™¨è§’è‰²<ul><li>ZAB ç®—æ³•</li></ul></li><li>å½“æŒ‡å®šç±»å‹çš„æœåŠ¡å™¨æ•…éšœæ—¶ï¼Œéœ€è¦é‡æ–°åˆ†é…è§’è‰² </li><li>æ¯”å‡è¡¡è´Ÿè½½æ›´å¤æ‚<ul><li>ä»»åŠ¡åˆ†é…ç­–ç•¥æ›´åŠ å¤æ‚ - éœ€è¦å°†ä»»åŠ¡åˆ’åˆ†ä¸ºä¸åŒç±»å‹å¹¶åˆ†é…ç»™ä¸åŒè§’è‰²çš„é›†ç¾¤èŠ‚ç‚¹</li><li>è§’è‰²åˆ†é…ç­–ç•¥å®ç°æ›´å¤æ‚      </li></ul></li></ul><h1 id="5-å¼‚åœ°å¤šæ´»æ¶æ„"><a href="#5-å¼‚åœ°å¤šæ´»æ¶æ„" class="headerlink" title="5. å¼‚åœ°å¤šæ´»æ¶æ„"></a>5. å¼‚åœ°å¤šæ´»æ¶æ„</h1><ul><li>å¼‚åœ° - åœ°ç†ä½ç½®ä¸Šçš„ä¸åŒ</li><li>å¤šæ´» - ä¸åŒåœ°ç†ä½ç½®ä¸Šçš„ç³»ç»Ÿéƒ½èƒ½æä¾›ä¸šåŠ¡æœåŠ¡</li><li>å¼‚åœ°å¤šæ´»æ ‡å‡†<ul><li>ç”¨æˆ·æ— è®ºè®¿é—®å“ªä¸€ä¸ªåœ°ç‚¹çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œéƒ½èƒ½å¤Ÿå¾—åˆ°æ­£ç¡®çš„ä¸šåŠ¡æœåŠ¡</li><li>æŸä¸ªåœ°æ–¹ä¸šåŠ¡å¼‚å¸¸çš„æ—¶å€™ï¼Œç”¨æˆ·è®¿é—®å…¶ä»–åœ°æ–¹æ­£å¸¸çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œèƒ½å¤Ÿå¾—åˆ°æ­£ç¡®çš„ä¸šåŠ¡æœåŠ¡</li></ul></li><li>å¼‚åœ°å¤šæ´»å®ç°ä»£ä»·éå¸¸é«˜<ul><li>ç³»ç»Ÿå¤æ‚åº¦æ˜¾è‘—ä¸Šå‡</li><li>æˆæœ¬ä¸Šå‡</li></ul></li><li>éœ€è¦å¼‚åœ°å¤šæ´»çš„åœºæ™¯<ul><li>æ»´æ»´</li><li>å¾®ä¿¡</li><li>æ”¯ä»˜å®ç­‰</li></ul></li></ul><h2 id="5-1-æ¶æ„æ¨¡å¼"><a href="#5-1-æ¶æ„æ¨¡å¼" class="headerlink" title="5.1 æ¶æ„æ¨¡å¼"></a>5.1 æ¶æ„æ¨¡å¼</h2><h3 id="5-1-1-åŒåŸå¼‚åŒº"><a href="#5-1-1-åŒåŸå¼‚åŒº" class="headerlink" title="5.1.1 åŒåŸå¼‚åŒº"></a>5.1.1 åŒåŸå¼‚åŒº</h3><p>å°†ä¸šåŠ¡éƒ¨ç½²åœ¨åŒä¸€ä¸ªåŸå¸‚ä¸åŒåŒºçš„å¤šä¸ªæœºæˆ¿å½“ä¸­ã€‚è™½ç„¶è¿˜æ˜¯æ— æ³•åœ¨åœ°éœ‡æµ·å•¸ç­‰å¤§ç¾å®³é¢å‰å­˜æ´»ï¼Œä½†æ˜¯åŒåŸå¼‚åŒºé€šè¿‡å…‰çº¤çš„è®¾å®šï¼Œå¯ä»¥å®ç°å‡ ä¹å’ŒåŒä¸€ä¸ªæœºæˆ¿ç›¸åŒçš„ç½‘ç»œä¼ è¾“é€Ÿåº¦ã€‚è¿™æ ·å°½ç®¡æ˜¯å¤šä¸ªæœºæˆ¿ï¼Œä½†æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºä¸€ä¸ªæœºæˆ¿æ¥çœ‹å¾…ã€‚</p><p>è¿˜æ˜¯ä¸ªçœ‹æ¦‚ç‡çš„é—®é¢˜ï¼Œå’Œåœ°éœ‡æµ·å•¸ç›¸æ¯”ï¼Œæœºæˆ¿ç«ç¾åœç”µè¿™ç§äº‹æƒ…æ›´æœ‰å¯èƒ½å‘ç”Ÿï¼Œå¯¹äºæ­¤ç±»æ•…éšœï¼ŒåŒåŸå¼‚åŒºæ¶æ„éƒ½å¯ä»¥å¾ˆå¥½åœ°è§£å†³ã€‚</p><h3 id="5-1-2-è·¨åŸå¼‚åœ°"><a href="#5-1-2-è·¨åŸå¼‚åœ°" class="headerlink" title="5.1.2 è·¨åŸå¼‚åœ°"></a>5.1.2 è·¨åŸå¼‚åœ°</h3><p>å°†ä¸šåŠ¡éƒ¨ç½²åœ¨ä¸åŒåŸå¸‚çš„å¤šä¸ªæœºæˆ¿å½“ä¸­ã€‚è·ç¦»è¦è¶³å¤Ÿè¿œï¼Œä»¥åº”å¯¹æç«¯ç¾éš¾äº‹ä»¶ã€‚ä½†æ˜¯ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ï¼Œä¸¤ä¸ªæœºæˆ¿å°±å‡ ä¹æ— æ³•å®ç°åŒæ­¥äº†ã€‚</p><p>æ­£å› ä¸ºæ— æ³•åŒæ­¥ï¼Œæ‰€ä»¥å¯¹äºååˆ†æ•æ„Ÿçš„æ•°æ®ï¼Œæ¯”å¦‚è¯´è´¦æˆ·ä½™é¢è¿™ç±»ï¼Œå°±ä¸ä¼šä½¿ç”¨è·¨åŸå¼‚åœ°è¿™ç§æ–¹å¼äº†ã€‚</p><h3 id="5-1-3-è·¨å›½å¼‚åœ°"><a href="#5-1-3-è·¨å›½å¼‚åœ°" class="headerlink" title="5.1.3 è·¨å›½å¼‚åœ°"></a>5.1.3 è·¨å›½å¼‚åœ°</h3><ul><li>ä¸»è¦ä¸ºäº†ä¸ºä¸åŒåœ°åŒºçš„ç”¨æˆ·æä¾›æœåŠ¡</li><li>æˆ–è€…æ˜¯åªè¯»ç±»ä¸šåŠ¡åšå¤šæ´»</li></ul><h2 id="5-2-å¼‚åœ°å¤šæ´»è®¾è®¡æŠ€å·§"><a href="#5-2-å¼‚åœ°å¤šæ´»è®¾è®¡æŠ€å·§" class="headerlink" title="5.2 å¼‚åœ°å¤šæ´»è®¾è®¡æŠ€å·§"></a>5.2 å¼‚åœ°å¤šæ´»è®¾è®¡æŠ€å·§</h2><h3 id="5-2-1-ä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»"><a href="#5-2-1-ä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»" class="headerlink" title="5.2.1 ä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»"></a>5.2.1 ä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»</h3><p>å› ä¸ºä¿è¯æ‰€æœ‰ä¸šåŠ¡çš„å¼‚åœ°å¤šæ´»æ˜¯ä¸ç°å®çš„ï¼Œæ¯”å¦‚æ³¨å†Œï¼Œç™»å½•ï¼Œç”¨æˆ·ä¿¡æ¯éƒ½è¦ä¿æŒåŒæ­¥ã€‚æ³¨å†Œä¸åº”è¯¥ä¿æŒå¼‚åœ°å¤šæ´»ï¼Œå› ä¸ºä¸€èˆ¬éƒ½æœ‰å•ä¸ªæ‰‹æœºå·çš„é™åˆ¶ï¼Œå¦‚æœå¼‚åœ°æœåŠ¡å™¨ï¼Œå°±æ— æ³•æ£€æµ‹æ˜¯å¦å·²ç»æ³¨å†Œè¿‡äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªå•†ä¸šé€»è¾‘ä¸Šçš„å¾ˆå¤§çš„æ‚–è®ºäº†ï¼Œä¸å¯ä»¥è¿™æ ·åšã€‚</p><p>åŒç†å¯¹äºç”¨æˆ·ä¿¡æ¯ä¹Ÿæ˜¯ï¼Œæ ¹æ®æ›´æ–°æ—¶é—´çš„æ¿€æ´»å’Œè¯†åˆ«ä¹Ÿå¾ˆå¯èƒ½ä¼šå› ä¸ºä¸åŒçš„æœºå™¨æ—¶é—´çš„é—®é¢˜ï¼Œè€Œå¯¼è‡´æœ€ç»ˆæ˜¯ä¸å‡†ç¡®çš„ï¼Œä¼šå¸¦æ¥å¾ˆä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>ç™»å½•æ‰æ˜¯æœ€æœ€éœ€è¦ä¿è¯å¼‚åœ°å¤šæ´»çš„åŠŸèƒ½ã€‚</p><h3 id="5-2-2-ä¿è¯æ ¸å¿ƒæ•°æ®æœ€ç»ˆä¸€è‡´æ€§"><a href="#5-2-2-ä¿è¯æ ¸å¿ƒæ•°æ®æœ€ç»ˆä¸€è‡´æ€§" class="headerlink" title="5.2.2 ä¿è¯æ ¸å¿ƒæ•°æ®æœ€ç»ˆä¸€è‡´æ€§"></a>5.2.2 ä¿è¯æ ¸å¿ƒæ•°æ®æœ€ç»ˆä¸€è‡´æ€§</h3><p>å¼‚åœ°å¤šæ´»æœ¬è´¨ä¸Šæ˜¯é€šè¿‡å¼‚åœ°çš„æ•°æ®å†—ä½™ï¼Œæ¥ä¿è¯åœ¨æç«¯çš„å¼‚å¸¸æƒ…å†µä¸‹ï¼Œä¸šåŠ¡ä¹Ÿèƒ½æ­£å¸¸æä¾›ç»™ç”¨æˆ·ã€‚å³éœ€è¦å®ç°<strong>æ•°æ®çš„å¿«é€ŸåŒæ­¥</strong>ã€‚</p><ul><li>å°½é‡å‡å°‘å¼‚åœ°å¤šæ´»æœºæˆ¿çš„è·ç¦»ï¼Œæ­å»ºé«˜é€Ÿç½‘ç»œ</li><li>å°½é‡å‡å°‘æ•°æ®åŒæ­¥ï¼ŒåªåŒæ­¥æ ¸å¿ƒä¸šåŠ¡ç›¸å…³çš„æ•°æ®</li><li>ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸ä¿è¯å®æ—¶çš„</li></ul><h2 id="5-3-å¦‚ä½•åº”å¯¹æ¥å£çº§çš„æ•…éšœ"><a href="#5-3-å¦‚ä½•åº”å¯¹æ¥å£çº§çš„æ•…éšœ" class="headerlink" title="5.3 å¦‚ä½•åº”å¯¹æ¥å£çº§çš„æ•…éšœ"></a>5.3 å¦‚ä½•åº”å¯¹æ¥å£çº§çš„æ•…éšœ</h2><p>æ¥å£çº§æ•…éšœçš„å…¸å‹è¡¨ç°å°±æ˜¯ç³»ç»Ÿå¹¶æ²¡æœ‰å®•æœºï¼Œç½‘ç»œä¹Ÿæ²¡ä¸­æ–­ï¼Œä½†ä¸šåŠ¡å´å‡ºç°äº†é—®é¢˜ã€‚ä¾‹å¦‚ï¼š</p><ul><li>ä¸šåŠ¡å“åº”ç¼“æ…¢</li><li>è®¿é—®å¤§é‡è¶…æ—¶</li><li>å¤§é‡è®¿é—®å‡ºç°å¼‚å¸¸</li></ul><p>è¿™ç±»é—®é¢˜çš„ä¸»è¦åŸå› åœ¨äºç³»ç»Ÿå‹åŠ›å¤ªå¤§ï¼Œè´Ÿè½½å¤ªé«˜ï¼Œå¯¼è‡´æ— æ³•å¿«é€Ÿå¤„ç†ä¸šåŠ¡è¯·æ±‚ï¼Œç”±æ­¤å¼•å‘äº†æ›´å¤šçš„åç»­é—®é¢˜ã€‚å¸¸è§çš„æ¯”å¦‚è¯´æ•°æ®åº“æ…¢æŸ¥è¯¢ï¼Œå°†æ•°æ®åº“çš„æœåŠ¡å™¨èµ„æºè€—å°½äº†ï¼Œå¯¼è‡´è¯»å†™è¶…æ—¶ï¼Œä¸šåŠ¡è¯»å†™æ•°æ®åº“è¦ä¹ˆè¶…æ—¶ï¼Œæ— æ³•è¿æ¥ï¼›ä»ç”¨æˆ·çš„è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯è®¿é—®å¾ˆæ…¢ï¼Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚ </p><h3 id="5-3-1-æ¥å£çº§æ•…éšœçš„åŸå› "><a href="#5-3-1-æ¥å£çº§æ•…éšœçš„åŸå› " class="headerlink" title="5.3.1 æ¥å£çº§æ•…éšœçš„åŸå› "></a>5.3.1 æ¥å£çº§æ•…éšœçš„åŸå› </h3><ul><li>å†…éƒ¨åŸå› <ul><li>ç¨‹åºbugå¯¼è‡´æ­»å¾ªç¯</li><li>æŸä¸ªæ¥å£å¯¼è‡´æ•°æ®åº“æ…¢æŸ¥è¯¢</li><li>ç¨‹åºé€»è¾‘ä¸å®Œå–„å¯¼è‡´è€—å°½å†…å­˜</li></ul></li><li>å¤–éƒ¨åŸå› <ul><li>é»‘å®¢æ”»å‡»</li><li>ä¿ƒé”€ï¼ŒæŠ¢è´­å¼•å…¥è¿œè¶…å¹³æ—¶çš„ç”¨æˆ·</li><li>ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¤§é‡è¯·æ±‚</li><li>ç¬¬ä¸‰æ–¹ç³»ç»Ÿå“åº”ç¼“æ…¢</li></ul></li><li>è§£å†³çš„æ ¸å¿ƒæ€æƒ³<ul><li>ä¼˜å…ˆä¿è¯æ ¸å¿ƒä¸šåŠ¡</li><li>ä¼˜å…ˆä¿è¯ç»å¤§éƒ¨åˆ†ç”¨æˆ·</li></ul></li></ul><h3 id="5-3-2-é™çº§"><a href="#5-3-2-é™çº§" class="headerlink" title="5.3.2 é™çº§"></a>5.3.2 é™çº§</h3><p>ç³»ç»Ÿå°†æŸäº›ä¸šåŠ¡æˆ–è€…æ¥å£çš„åŠŸèƒ½é™ä½ï¼Œåªæä¾›éƒ¨åˆ†åŠŸèƒ½æˆ–è€…å®Œå…¨åœæ‰æ‰€æœ‰åŠŸèƒ½</p><ul><li>ç³»ç»Ÿåé—¨é™çº§<ul><li>æ¯”å¦‚æä¾›ä¸€ä¸ªé™çº§URLï¼Œå½“è®¿é—®è¿™ä¸ªURLçš„æ—¶å€™ï¼Œå°±ç›¸å½“äºæä¾›äº†ä¸€ä¸ªé™çº§æ“ä½œ</li></ul></li><li>ç‹¬ç«‹é™çº§ç³»ç»Ÿ<ul><li>ç‹¬ç«‹å‡ºç³»ç»Ÿï¼Œå®ç°æƒé™ç®¡ç†æ‰¹é‡æ“ä½œç­‰åŠŸèƒ½ã€‚</li></ul></li></ul><h3 id="5-3-3-ç†”æ–­"><a href="#5-3-3-ç†”æ–­" class="headerlink" title="5.3.3 ç†”æ–­"></a>5.3.3 ç†”æ–­</h3><ul><li>å’Œé™çº§åšå¯¹æ¯”<ul><li>é™çº§æ˜¯ç”¨æ¥å¤„ç†ç³»ç»Ÿè‡ªèº«çš„æ•…éšœ</li><li>ç†”æ–­æ˜¯åº”å¯¹ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿçš„æ•…éšœçš„æƒ…å†µ</li></ul></li><li>ç†”æ–­æœºåˆ¶çš„å…³é”®åœ¨äºä¸€ä¸ªç»Ÿä¸€çš„APIè°ƒç”¨å±‚ï¼Œç”±APIè°ƒç”¨å±‚æ¥è¿›è¡Œé‡‡æ ·æˆ–è€…ç»Ÿè®¡</li><li>å¦ä¸€ä¸ªå…³é”®æ˜¯é˜ˆå€¼çš„è®¾è®¡ï¼Œä¸€èˆ¬æ˜¯æ ¹æ®åˆ†æç¡®å®šé˜ˆå€¼ï¼Œç„¶åä¸Šçº¿è§‚å¯Ÿæ•ˆæœï¼Œå†è¿›è¡Œè°ƒä¼˜</li></ul><h3 id="5-3-4-é™æµ"><a href="#5-3-4-é™æµ" class="headerlink" title="5.3.4 é™æµ"></a>5.3.4 é™æµ</h3><p>ä»ç”¨æˆ·è®¿é—®å‹åŠ›çš„è§’åº¦æ¥è€ƒè™‘ï¼Œåªå…è®¸ç³»ç»Ÿèƒ½å¤Ÿæ‰¿è½½çš„è®¿é—®é‡æ¥è®¿é—®ï¼Œè¶…å‡ºç³»ç»Ÿè®¿é—®èƒ½åŠ›çš„è¯·æ±‚å°†è¢«ä¸¢å¼ƒã€‚</p><ul><li>åŸºäºè¯·æ±‚é™æµ<ul><li>å¸¸ç”¨æ–¹å¼<ul><li>é™åˆ¶æ€»é‡<ul><li>æ¯”å¦‚é™åˆ¶æ€»ç”¨æˆ·çš„ä¸Šé™ </li></ul></li><li>é™åˆ¶æ—¶é—´é‡<ul><li>é™åˆ¶ä¸€æ®µæ—¶é—´å†…æŸä¸ªæŒ‡æ ‡çš„ä¸Šé™  æ¯”å¦‚è¯·æ±‚tps</li></ul></li></ul></li><li>è¿™ç§æ–¹å¼æ›´å¤šæ˜¯è‹±è¯­ä¸šåŠ¡åŠŸèƒ½æ¯”è¾ƒç®€å•çš„ç³»ç»Ÿï¼Œå› ä¸ºå¾ˆå¯èƒ½é˜ˆå€¼éœ€è¦ä¸æ–­è°ƒæ•´çš„</li></ul></li><li>åŸºäºèµ„æºé™æµ<ul><li>æ‰¾åˆ°ç³»ç»Ÿå†…éƒ¨å½±å“æ€§èƒ½çš„å…³é”®èµ„æºï¼Œå¯¹å…¶ä½¿ç”¨ä¸Šé™è¿›è¡Œé™åˆ¶<ul><li>è¿æ¥æ•°</li><li>æ–‡ä»¶å¥æŸ„</li><li>çº¿ç¨‹æ•°</li><li>è¯·æ±‚é˜Ÿåˆ—</li></ul></li></ul></li></ul><h3 id="5-3-5-æ’é˜Ÿ"><a href="#5-3-5-æ’é˜Ÿ" class="headerlink" title="5.3.5 æ’é˜Ÿ"></a>5.3.5 æ’é˜Ÿ</h3><ul><li>ä¸ç›´æ¥æ‰”æ‰è¯·æ±‚ï¼Œæ’é˜Ÿ</li><li>æ’é˜Ÿæ¨¡å—<ul><li>å°†è¯·æ±‚ä»¥å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼ä¿å­˜ä¸‹æ¥</li></ul></li><li>è°ƒåº¦æ¨¡å—<ul><li>è´Ÿè´£æ’é˜Ÿæ¨¡å—åˆ°æœåŠ¡æ¨¡å—çš„åŠ¨æ€è°ƒåº¦</li></ul></li><li>æœåŠ¡æ¨¡å—<ul><li>è°ƒç”¨çœŸæ­£ä¸šåŠ¡æ¥å¤„ç†æœåŠ¡ï¼Œå¹¶è¿”å›å¤„ç†ç»“æœï¼Œè°ƒç”¨æ’é˜Ÿæ¨¡å—çš„æ¥å£å›å†™å¤„ç†ç»“æœã€‚ </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
            <tag> CAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -æ¶æ„è®¾è®¡æµç¨‹</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è¯†åˆ«å¤æ‚åº¦"><a href="#1-è¯†åˆ«å¤æ‚åº¦" class="headerlink" title="1. è¯†åˆ«å¤æ‚åº¦"></a>1. è¯†åˆ«å¤æ‚åº¦</h1><p>å…·ä½“æƒ…å†µéœ€è¦å…·ä½“åˆ†æï¼Œå³è¿™ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦ä½“ç°åœ¨å“ªä¸€ä¸ªæ–¹é¢ã€‚ä¸€ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦ä¸»è¦æ¥æºäºé«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œå¯æ‰©å±•è¿™å‡ ä¸ªæ–¹é¢ã€‚</p><p>æ­£ç¡®çš„åšæ³•æ˜¯å°†ä¸»è¦çš„å¤æ‚åº¦é—®é¢˜åˆ—å‡ºæ¥ï¼Œç„¶åæ ¹æ®ä¸šåŠ¡ã€æŠ€æœ¯ã€å›¢é˜Ÿç­‰ç»¼åˆæƒ…å†µè¿›è¡Œæ’åºï¼Œä¼˜å…ˆè§£å†³å½“å‰é¢ä¸´çš„æœ€ä¸»è¦çš„å¤æ‚é—®é¢˜ã€‚</p><p>å¤šä¸ªç³»ç»Ÿä¹‹é—´çš„å¼ºè€¦åˆï¼Œå¯ä»¥é€šè¿‡ä¿¡æ¯é˜Ÿåˆ—æ¥è§£è€¦ã€‚è¦æ³¨æ„ä»é«˜å¯ç”¨ï¼Œé«˜æ€§èƒ½ï¼Œå¯æ‰©å±•å‡ ä¸ªç»´åº¦å¯¹å…¶è¿›è¡Œåˆ†æï¼Œçœ‹æ•´ä¸ªæ¶æ„è°ƒæ•´çš„å¤æ‚åº¦åœ¨å“ªé‡Œï¼Œç„¶ååšé’ˆå¯¹æ€§çš„æå‡ã€‚</p><p>å¹³å‡TPSï¼Œ QPSï¼Œå³°å€¼TPS (average x 3)ï¼Œ</p><h1 id="2-è®¾è®¡å¤‡é€‰æ–¹æ¡ˆ"><a href="#2-è®¾è®¡å¤‡é€‰æ–¹æ¡ˆ" class="headerlink" title="2. è®¾è®¡å¤‡é€‰æ–¹æ¡ˆ"></a>2. è®¾è®¡å¤‡é€‰æ–¹æ¡ˆ</h1><p>æ¶æ„å¸ˆéœ€è¦å¯¹å·²ç»å­˜åœ¨çš„æŠ€æœ¯éå¸¸ç†Ÿæ‚‰ï¼Œå¯¹å·²ç»ç»è¿‡éªŒè¯çš„æ¶æ„æ¨¡å¼çƒ‚ç†Ÿäºå¿ƒï¼Œç„¶åæ ¹æ®è‡ªå·±å¯¹äºä¸šåŠ¡çš„ç†è§£ï¼ŒæŒ‘é€‰åˆé€‚çš„æ¶æ„æ¨¡å¼è¿›è¡Œç»„åˆï¼Œå†å¯¹ç»„åˆä¹‹åçš„æ–¹æ¡ˆè¿›è¡Œä¿®æ”¹å’Œè°ƒæ•´ã€‚</p><p>ç›®å‰ï¼Œåªè¦æ˜ç¡®äº†åº”ç”¨åœºæ™¯ï¼Œå¤æ‚åº¦ä¸Šçš„é™åˆ¶å› ç´ ï¼Œæˆ‘ä»¬å¾€å¾€èƒ½æ‰¾åˆ°ç›¸å¯¹æˆç†Ÿçš„æŠ€æœ¯æ¥ç›´æ¥ä½¿ç”¨ã€‚ä¾‹å¦‚</p><ul><li>é«˜å¯ç”¨ä¸»å¤‡æ–¹æ¡ˆ</li><li>é›†ç¾¤æ–¹æ¡ˆ</li><li>é«˜æ€§èƒ½è´Ÿè½½å‡è¡¡</li><li>å¤šè·¯å¤ç”¨</li><li>å¯æ‹“å±•çš„åˆ†å±‚</li><li>æ’ä»¶åŒ–æŠ€æœ¯</li></ul><p>è®¾è®¡å¤‡é€‰æ–¹æ¡ˆçš„tips</p><ul><li>å¤šè®¾è®¡å‡ ä¸ªå¤‡é€‰æ–¹æ³•ï¼Œ3-5ä¸ªä¸ºå®œ</li><li>æ–¹æ¡ˆä¹‹é—´çš„å·®å¼‚è¦æ¯”è¾ƒæ˜æ˜¾</li><li>å¤‡é€‰æ–¹æ¡ˆçš„æŠ€æœ¯ä¸è¦åªå±€é™äºå·²ç»ç†Ÿæ‚‰çš„æŠ€æœ¯</li><li>å¤‡é€‰æ–¹æ¡ˆä¸éœ€è¦å¤ªè¿‡äºè¯¦ç»†çš„ï¼Œå…³æ³¨çš„æ˜¯æŠ€æœ¯é€‰å‹ï¼Œè€Œä¸æ˜¯æŠ€æœ¯ç»†èŠ‚</li></ul><p>å¯¹äºé«˜æ€§èƒ½å†™å…¥</p><ul><li>é›†ç¾¤</li><li>ç›´æ¥å†™å…¥ä¸€å°æ­£å¸¸çš„æœåŠ¡å™¨å³å¯<br>é«˜å¯ç”¨å­˜å‚¨</li><li>å·²ç»å†™å…¥çš„ä¿¡æ¯åœ¨å•å°æœåŠ¡å™¨å®•æœºçš„æƒ…å†µä¸‹ä¸ä¸¢å¤±</li><li>ä½¿ç”¨MySQLçš„ä¸»å¤‡å¤åˆ¶åŠŸèƒ½<br>é«˜å¯ç”¨è¯»å–</li><li>è¦æ±‚å·²ç»å†™å…¥çš„æ¶ˆæ¯åœ¨å•å°æœåŠ¡å™¨å®•æœºçš„æƒ…å†µä¸‹å¯ä»¥ç»§ç»­è¯»å–</li><li>æœåŠ¡å™¨çš„ä¸»å¤‡æ–¹æ¡ˆ</li></ul><h1 id="3-è¯„ä¼°å’Œé€‰æ‹©å¤‡é€‰æ–¹æ¡ˆ"><a href="#3-è¯„ä¼°å’Œé€‰æ‹©å¤‡é€‰æ–¹æ¡ˆ" class="headerlink" title="3. è¯„ä¼°å’Œé€‰æ‹©å¤‡é€‰æ–¹æ¡ˆ"></a>3. è¯„ä¼°å’Œé€‰æ‹©å¤‡é€‰æ–¹æ¡ˆ</h1><ul><li>å¤šè§’åº¦ç¯è¯„<ul><li>åˆ—å‡ºéœ€è¦å…³æ³¨çš„è´¨é‡å±æ€§ç‚¹</li><li>åˆ†åˆ«ä»è¿™äº›è´¨é‡å±æ€§çš„ç»´åº¦å»è¯„ä¼°æ¯ä¸ªæ–¹æ¡ˆï¼Œå†ç»¼åˆæŒ‘é€‰é€‚åˆå½“æ—¶æƒ…å†µçš„æœ€ä¼˜æ–¹æ¡ˆ</li></ul></li><li>æ–¹æ¡ˆè´¨é‡å±æ€§ç‚¹<ul><li>æ€§èƒ½</li><li>å¯ç”¨æ€§</li><li>ç¡¬ä»¶æˆæœ¬</li><li>é¡¹ç›®æŠ•å…¥</li><li>å¤æ‚åº¦</li><li>å®‰å…¨æ€§</li><li>å¯æ‹“å±•æ€§</li></ul></li><li>å¯¹äºéœ€è¦è¯„ä¼°æœªæ¥ä¸šåŠ¡å‘å±•çš„è§„æ¨¡æ—¶ï¼Œä¸€èˆ¬å¯ä»¥å°†å½“å‰çš„ä¸šåŠ¡è§„æ¨¡ä¹˜ä»¥2-4 å³å¯ã€‚</li><li>å°†è´¨é‡å±æ€§æŒ‰ç…§ä¼˜å…ˆçº§æ’åº</li></ul><h1 id="4-è¯¦ç»†æ–¹æ¡ˆè®¾è®¡"><a href="#4-è¯¦ç»†æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="4. è¯¦ç»†æ–¹æ¡ˆè®¾è®¡"></a>4. è¯¦ç»†æ–¹æ¡ˆè®¾è®¡</h1><p>å°†æ–¹æ¡ˆæ¶‰åŠçš„å…³é”®æŠ€æœ¯ç»†èŠ‚ç»™ç¡®å®šä¸‹æ¥ã€‚</p><ul><li>å‡å¦‚æˆ‘ä»¬ç¡®å®šä½¿ç”¨ Elasticsearch æ¥åšå…¨æ–‡æœç´¢ï¼Œé‚£ä¹ˆå°±éœ€è¦ç¡®å®š Elasticsearch çš„ç´¢å¼•æ˜¯æŒ‰ç…§ä¸šåŠ¡åˆ’åˆ†ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¤§ç´¢å¼•å°±å¯ä»¥äº†ï¼›å‰¯æœ¬æ•°é‡æ˜¯ 2 ä¸ªã€3 ä¸ªè¿˜æ˜¯ 4 ä¸ªï¼Œé›†ç¾¤èŠ‚ç‚¹æ•°é‡æ˜¯ 3 ä¸ªè¿˜æ˜¯ 6 ä¸ªç­‰ã€‚</li><li>å‡å¦‚æˆ‘ä»¬ç¡®å®šä½¿ç”¨ MySQL åˆ†åº“åˆ†è¡¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ç¡®å®šå“ªäº›è¡¨è¦åˆ†åº“åˆ†è¡¨ï¼ŒæŒ‰ç…§ä»€ä¹ˆç»´åº¦æ¥åˆ†åº“åˆ†è¡¨ï¼Œåˆ†åº“åˆ†è¡¨åè”åˆæŸ¥è¯¢æ€ä¹ˆå¤„ç†ç­‰ã€‚</li><li>å‡å¦‚æˆ‘ä»¬ç¡®å®šå¼•å…¥ Nginx æ¥åšè´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆ Nginx çš„ä¸»å¤‡æ€ä¹ˆåšï¼ŒNginx çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ç”¨å“ªä¸ªï¼ˆæƒé‡åˆ†é…ï¼Ÿè½®è¯¢ï¼Ÿip_hashï¼Ÿï¼‰ç­‰ã€‚<ul><li>è½®è¯¢</li><li>åŠ æƒè½®è¯¢ - åç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡</li><li>ip_hash - æ¯ä¸ªæ–¹å¯å›ºå®šè®¿é—®åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œè§£å†³sessionçš„é—®é¢˜</li><li>fair - æŒ‰ç…§å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ï¼Œèƒ½å¤Ÿæœ€å¤§åŒ–å¹³è¡¡å„åç«¯æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå¯ä»¥é€‚ç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡è¡¡çš„æƒ…å†µ</li><li>url_hash - æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œé€‚ç”¨äºåç«¯æœåŠ¡å™¨èƒ½å¤Ÿå°†urlçš„å“åº”ç»“æœç¼“å­˜çš„æƒ…å†µ</li></ul></li></ul><ul><li>é€šè¿‡åˆ†æ­¥éª¤ï¼Œåˆ†é˜¶æ®µï¼Œåˆ†ç³»ç»Ÿç­‰æ–¹å¼ï¼Œå°½é‡é™ä½æ–¹æ¡ˆçš„å¤æ‚åº¦ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹  - æ¶æ„è®¾è®¡æ–‡æ¡£æ¨¡æ¿</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E6%A8%A1%E6%9D%BF/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<p>æ•´ä¸ªæµç¨‹åº”å½“æ˜¯åœ¨åˆšå¼€å§‹çš„æ—¶å€™æœ‰å‡ ä¸ªæ–¹æ¡ˆï¼Œç„¶ååœ¨ç»è¿‡è®¨è®ºå’Œåˆ†æä»¥åæ•´ç†å‡ºå”¯ä¸€å¯ä»¥çš„æ–¹æ¡ˆï¼Œç„¶åå†åˆ›å»ºæ¶æ„è®¾è®¡çš„è¯¦ç»†æ–‡æ¡£ï¼Œè¿™ä¸ªæ—¶å€™ç†è®ºä¸Šåº”è¯¥</p><h1 id="1-å¤‡é€‰æ–¹æ¡ˆæ¨¡æ¿"><a href="#1-å¤‡é€‰æ–¹æ¡ˆæ¨¡æ¿" class="headerlink" title="1. å¤‡é€‰æ–¹æ¡ˆæ¨¡æ¿"></a>1. å¤‡é€‰æ–¹æ¡ˆæ¨¡æ¿</h1><h2 id="1-1-éœ€æ±‚ä»‹ç»"><a href="#1-1-éœ€æ±‚ä»‹ç»" class="headerlink" title="1.1 éœ€æ±‚ä»‹ç»"></a>1.1 éœ€æ±‚ä»‹ç»</h2><ul><li>éœ€æ±‚çš„èƒŒæ™¯</li><li>éœ€æ±‚çš„ç›®æ ‡</li><li>éœ€æ±‚çš„èŒƒå›´</li></ul><h2 id="1-2-éœ€æ±‚åˆ†æ"><a href="#1-2-éœ€æ±‚åˆ†æ" class="headerlink" title="1.2 éœ€æ±‚åˆ†æ"></a>1.2 éœ€æ±‚åˆ†æ</h2><h3 id="1-2-1-5W"><a href="#1-2-1-5W" class="headerlink" title="1.2.1 5W"></a>1.2.1 5W</h3><ul><li>Who å¼€å‘è€… ä½¿ç”¨è€… è´­ä¹°è€… å†³ç­–è€…ç­‰</li><li>When éœ€æ±‚ä½¿ç”¨æ—¶é—´ï¼ŒåŒ…æ‹¬å­£èŠ‚ï¼Œæ—¶é—´ï¼Œé‡Œç¨‹ç¢‘ç­‰</li><li>What éœ€æ±‚çš„äº§å‡ºæ˜¯ä»€ä¹ˆï¼ŒåŒ…æ‹¬ç³»ç»Ÿï¼Œæ•°æ®ï¼Œæ–‡ä»¶ï¼Œå¼€å‘åº“ï¼Œå¹³å°ç­‰</li><li>Where  éœ€æ±‚çš„åº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬å›½å®¶ï¼Œåœ°ç‚¹ï¼Œç¯å¢ƒç­‰</li><li>Why  éœ€æ±‚éœ€è¦è§£å†³çš„é—®é¢˜ï¼Œé€šå¸¸å’Œéœ€æ±‚èƒŒæ™¯ç›¸å…³</li></ul><h3 id="1-2-2-1H"><a href="#1-2-2-1H" class="headerlink" title="1.2.2 1H"></a>1.2.2 1H</h3><p>HowæŒ‡çš„æ˜¯å…³é”®ä¸šåŠ¡æµç¨‹</p><h3 id="1-2-3-8C"><a href="#1-2-3-8C" class="headerlink" title="1.2.3 8C"></a>1.2.3 8C</h3><p>8ä¸ªçº¦æŸå’Œé™åˆ¶ï¼ŒåŒ…æ‹¬</p><ul><li>performance</li><li>cost</li><li>time</li><li>reliability</li><li>security</li><li>compliance</li><li>technology</li><li>compatibility</li></ul><h2 id="1-3-å¤æ‚åº¦åˆ†æ"><a href="#1-3-å¤æ‚åº¦åˆ†æ" class="headerlink" title="1.3 å¤æ‚åº¦åˆ†æ"></a>1.3 å¤æ‚åº¦åˆ†æ</h2><h3 id="1-3-1-é«˜å¯ç”¨"><a href="#1-3-1-é«˜å¯ç”¨" class="headerlink" title="1.3.1 é«˜å¯ç”¨"></a>1.3.1 é«˜å¯ç”¨</h3><h3 id="1-3-2-é«˜æ€§èƒ½"><a href="#1-3-2-é«˜æ€§èƒ½" class="headerlink" title="1.3.2 é«˜æ€§èƒ½"></a>1.3.2 é«˜æ€§èƒ½</h3><h3 id="1-3-3-å¯æ‰©å±•"><a href="#1-3-3-å¯æ‰©å±•" class="headerlink" title="1.3.3 å¯æ‰©å±•"></a>1.3.3 å¯æ‰©å±•</h3><h2 id="1-4-å…¶ä»–å¤‡é€‰æ–¹æ¡ˆåŠè¯„ä¼°"><a href="#1-4-å…¶ä»–å¤‡é€‰æ–¹æ¡ˆåŠè¯„ä¼°" class="headerlink" title="1.4 å…¶ä»–å¤‡é€‰æ–¹æ¡ˆåŠè¯„ä¼°"></a>1.4 å…¶ä»–å¤‡é€‰æ–¹æ¡ˆåŠè¯„ä¼°</h2><h1 id="2-æ¶æ„è®¾è®¡æ¨¡æ¿"><a href="#2-æ¶æ„è®¾è®¡æ¨¡æ¿" class="headerlink" title="2. æ¶æ„è®¾è®¡æ¨¡æ¿"></a>2. æ¶æ„è®¾è®¡æ¨¡æ¿</h1><h2 id="2-1-æ€»ä½“æ–¹æ¡ˆ"><a href="#2-1-æ€»ä½“æ–¹æ¡ˆ" class="headerlink" title="2.1 æ€»ä½“æ–¹æ¡ˆ"></a>2.1 æ€»ä½“æ–¹æ¡ˆ</h2><p>æ•´ä½“æè¿°æ–¹æ¡ˆçš„ç»“æ„ï¼Œæ¶æ„å›¾ï¼Œä»¥åŠé’ˆå¯¹æ¶æ„å›¾çš„æè¿°ï¼ŒåŒ…æ‹¬æ¨¡å—æˆ–è€…å­ç³»ç»Ÿçš„èŒè´£æè¿°ï¼Œæ ¸å¿ƒæµç¨‹</p><h2 id="2-2-æ¶æ„æ€»è§ˆ"><a href="#2-2-æ¶æ„æ€»è§ˆ" class="headerlink" title="2.2 æ¶æ„æ€»è§ˆ"></a>2.2 æ¶æ„æ€»è§ˆ</h2><p>æ¶æ„å›¾ä»¥åŠæ¶æ„çš„æè¿°</p><h2 id="2-3-æ ¸å¿ƒæµç¨‹"><a href="#2-3-æ ¸å¿ƒæµç¨‹" class="headerlink" title="2.3 æ ¸å¿ƒæµç¨‹"></a>2.3 æ ¸å¿ƒæµç¨‹</h2><h2 id="2-4-è¯¦ç»†è®¾è®¡"><a href="#2-4-è¯¦ç»†è®¾è®¡" class="headerlink" title="2.4 è¯¦ç»†è®¾è®¡"></a>2.4 è¯¦ç»†è®¾è®¡</h2><h3 id="2-4-1-é«˜å¯ç”¨è®¾è®¡"><a href="#2-4-1-é«˜å¯ç”¨è®¾è®¡" class="headerlink" title="2.4.1 é«˜å¯ç”¨è®¾è®¡"></a>2.4.1 é«˜å¯ç”¨è®¾è®¡</h3><h3 id="2-4-2-é«˜æ€§èƒ½è®¾è®¡"><a href="#2-4-2-é«˜æ€§èƒ½è®¾è®¡" class="headerlink" title="2.4.2 é«˜æ€§èƒ½è®¾è®¡"></a>2.4.2 é«˜æ€§èƒ½è®¾è®¡</h3><h3 id="2-4-3-å¯æ‰©å±•è®¾è®¡"><a href="#2-4-3-å¯æ‰©å±•è®¾è®¡" class="headerlink" title="2.4.3 å¯æ‰©å±•è®¾è®¡"></a>2.4.3 å¯æ‰©å±•è®¾è®¡</h3><h3 id="2-4-4-å®‰å…¨è®¾è®¡"><a href="#2-4-4-å®‰å…¨è®¾è®¡" class="headerlink" title="2.4.4 å®‰å…¨è®¾è®¡"></a>2.4.4 å®‰å…¨è®¾è®¡</h3><h2 id="2-5-éƒ¨ç½²æ–¹æ¡ˆ"><a href="#2-5-éƒ¨ç½²æ–¹æ¡ˆ" class="headerlink" title="2.5 éƒ¨ç½²æ–¹æ¡ˆ"></a>2.5 éƒ¨ç½²æ–¹æ¡ˆ</h2><ul><li>ç¡¬ä»¶è¦æ±‚</li><li>æœåŠ¡å™¨éƒ¨ç½²æ–¹å¼</li><li>ç»„ç½‘æ–¹å¼</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹  - å®æˆ˜</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E6%88%98/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æŠ€æœ¯æ¼”è¿›çš„åŠ¨åŠ›-ä¼ä¸šå‘å±•"><a href="#1-æŠ€æœ¯æ¼”è¿›çš„åŠ¨åŠ›-ä¼ä¸šå‘å±•" class="headerlink" title="1. æŠ€æœ¯æ¼”è¿›çš„åŠ¨åŠ› - ä¼ä¸šå‘å±•"></a>1. æŠ€æœ¯æ¼”è¿›çš„åŠ¨åŠ› - ä¼ä¸šå‘å±•</h1><h2 id="1-1-ä¸šåŠ¡å’ŒæŠ€æœ¯ä¹‹é—´çš„å…³ç³»"><a href="#1-1-ä¸šåŠ¡å’ŒæŠ€æœ¯ä¹‹é—´çš„å…³ç³»" class="headerlink" title="1.1 ä¸šåŠ¡å’ŒæŠ€æœ¯ä¹‹é—´çš„å…³ç³»"></a>1.1 ä¸šåŠ¡å’ŒæŠ€æœ¯ä¹‹é—´çš„å…³ç³»</h2><ul><li>äº§å“ç±»<ul><li>æŠ€æœ¯åˆ›æ–°æ¨åŠ¨ä¸šåŠ¡å‘å±• </li><li>ç”¨æˆ·é€‰æ‹©äº§å“çš„æ ¹æœ¬é©±åŠ¨åŠ›æ˜¯åŠŸèƒ½</li></ul></li><li>æœåŠ¡ç±»<ul><li>ä¸šåŠ¡å‘å±•æ¨åŠ¨æŠ€æœ¯åˆ›æ–° </li><li>ç”¨æˆ·é€‰æ‹©æœåŠ¡çš„æ ¹æœ¬é©±åŠ¨åŠ›æ˜¯è§„æ¨¡</li></ul></li></ul><h1 id="2-æŠ€æœ¯æ¼”è¿›çš„æ¨¡å¼-ï¼ˆå¤æ‚æ€§ï¼Œç”¨æˆ·è§„æ¨¡ï¼‰"><a href="#2-æŠ€æœ¯æ¼”è¿›çš„æ¨¡å¼-ï¼ˆå¤æ‚æ€§ï¼Œç”¨æˆ·è§„æ¨¡ï¼‰" class="headerlink" title="2. æŠ€æœ¯æ¼”è¿›çš„æ¨¡å¼ ï¼ˆå¤æ‚æ€§ï¼Œç”¨æˆ·è§„æ¨¡ï¼‰"></a>2. æŠ€æœ¯æ¼”è¿›çš„æ¨¡å¼ ï¼ˆå¤æ‚æ€§ï¼Œç”¨æˆ·è§„æ¨¡ï¼‰</h1><ul><li>ä¸šåŠ¡æ—¶æœŸåˆ†ç±»<ul><li>åˆåˆ›æœŸ</li><li>å‘å±•æœŸ</li><li>ç«äº‰æœŸ</li><li>æˆç†ŸæœŸ</li></ul></li></ul><h2 id="2-1-åˆåˆ›æœŸ"><a href="#2-1-åˆåˆ›æœŸ" class="headerlink" title="2.1 åˆåˆ›æœŸ"></a>2.1 åˆåˆ›æœŸ</h2><p>åˆ›æ–°å‡ºæ–°çš„ç†å¿µï¼Œé€šè¿‡ç”¨æˆ·ä½¿ç”¨ï¼Œå¿«é€Ÿè¿­ä»£ï¼Œä¸æ–­å®Œå–„ã€‚å¯¹äºä¸šåŠ¡çš„è¦æ±‚å°±æ˜¯å¿«ã€‚</p><h2 id="2-2-å‘å±•æœŸ"><a href="#2-2-å‘å±•æœŸ" class="headerlink" title="2.2 å‘å±•æœŸ"></a>2.2 å‘å±•æœŸ</h2><p>å¤§é‡åŠ å…¥åŠŸèƒ½ï¼ŒæŠ€æœ¯æ–¹é¢çš„æ ¸å¿ƒå·¥ä½œå°±æ˜¯å¿«é€Ÿå®ç°å„ç§éœ€æ±‚ã€‚</p><ul><li>å †åŠŸèƒ½</li><li>ä¼˜åŒ– vs é‡æ–°æ¶æ„</li><li>æ¶æ„æœŸ - æ‹†åˆ†</li></ul><h2 id="2-3-ç«äº‰æœŸ"><a href="#2-3-ç«äº‰æœŸ" class="headerlink" title="2.3 ç«äº‰æœŸ"></a>2.3 ç«äº‰æœŸ</h2><p>æ›´è¿…é€Ÿçš„å‘å±•ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“å‡ºç°é‡å¤é€ è½®å­ï¼Œä»¥åŠç³»ç»Ÿäº¤äº’å¾ˆä¹±ç­‰é—®é¢˜</p><p>å› æ­¤ä¸€èˆ¬éƒ½æ˜¯åšå¹³å°åŒ–ä»¥åŠæœåŠ¡åŒ–çš„æ“ä½œã€‚</p><ul><li>å¹³å°åŒ–<ul><li>å­˜å‚¨å¹³å°åŒ–</li><li>æ•°æ®åº“å¹³å°åŒ–</li><li>ç¼“å­˜å¹³å°åŒ–</li></ul></li></ul><h2 id="2-4-æˆç†ŸæœŸ"><a href="#2-4-æˆç†ŸæœŸ" class="headerlink" title="2.4 æˆç†ŸæœŸ"></a>2.4 æˆç†ŸæœŸ</h2><p>ç³»ç»Ÿæ€§çš„é’ˆå¯¹æ€§ä¼˜åŒ–</p><h1 id="3-General"><a href="#3-General" class="headerlink" title="3. General"></a>3. General</h1><p><img src="https://i.loli.net/2020/02/04/ViqLHs2aExQUAru.png" alt="fig1.png"></p><ul><li>çºµå‘æ’åˆ—<ul><li>æµ‹è¯•å¹³å°</li><li>è¿ç»´å¹³å°</li><li>æ•°æ®å¹³å°</li><li>ç®¡ç†å¹³å°</li></ul></li><li>æ¨ªå‘<ul><li>ä¸šåŠ¡å±‚</li><li>ç”¨æˆ·å±‚<ul><li>ç”¨æˆ·ç®¡ç†</li><li>æ¶ˆæ¯æ¨é€</li><li>å­˜å‚¨äº‘</li><li>å›¾ç‰‡äº‘</li></ul></li><li>ç½‘ç»œå±‚<ul><li>è´Ÿè½½å‡è¡¡</li><li>CDN</li></ul></li><li>æœåŠ¡å±‚<ul><li>é…ç½®ä¸­å¿ƒ</li><li>æœåŠ¡ä¸­å¿ƒ</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li></ul></li><li>å¼€å‘å±‚<ul><li>å¼€å‘æ¡†æ¶</li><li>æœåŠ¡å™¨</li><li>å®¹å™¨</li></ul></li><li>å­˜å‚¨å±‚<ul><li>SQL</li><li>NoSQL</li><li>å°æ–‡ä»¶</li><li>å¤§æ–‡ä»¶</li></ul></li></ul></li></ul><h1 id="4-å­˜å‚¨å±‚æŠ€æœ¯"><a href="#4-å­˜å‚¨å±‚æŠ€æœ¯" class="headerlink" title="4. å­˜å‚¨å±‚æŠ€æœ¯"></a>4. å­˜å‚¨å±‚æŠ€æœ¯</h1><h2 id="4-1-SQL"><a href="#4-1-SQL" class="headerlink" title="4.1 SQL"></a>4.1 SQL</h2><ul><li>NoSQL - Not only SQL </li><li>æ•°æ®åº“æ‹†åˆ†æ»¡è¶³æ€§èƒ½è¦æ±‚ï¼Œä½†æ˜¯ä¼šå¸¦æ¥å¤æ‚åº¦é—®é¢˜<ul><li>æ•°æ®å¦‚ä½•æ‹†åˆ†</li><li>æ•°æ®å¦‚ä½•ç»„åˆ</li></ul></li><li>å½“ä¸šåŠ¡å‘å±•åˆ°ä¸€å®šé˜¶æ®µä¹‹åï¼Œä¼šå°†è¿™éƒ¨åˆ†åŠŸèƒ½ç‹¬ç«‹æˆä¸­é—´ä»¶</li><li>è€Œååœ¨SQLé›†ç¾¤ä¸Šæ„å»ºSQLå­˜å‚¨å¹³å°ï¼Œä»¥å¯¹ä¸šåŠ¡é€æ˜çš„å½¢å¼æä¾›èµ„æºåˆ†é…ã€æ•°æ®å¤‡ä»½ã€è¿ç§»ã€å®¹ç¾ã€è¯»å†™åˆ†ç¦»ã€åˆ†åº“åˆ†è¡¨ç­‰ä¸€ç³»åˆ—æœåŠ¡</li></ul><h2 id="4-2-NoSQL"><a href="#4-2-NoSQL" class="headerlink" title="4.2 NoSQL"></a>4.2 NoSQL</h2><p>åœ¨NoSQLé›†ç¾¤çš„åŸºç¡€ä¸Šå®ç°ç»Ÿä¸€çš„å­˜å‚¨å¹³å°ï¼Œå®ç°ä»¥ä¸‹çš„åŠŸèƒ½ï¼š</p><ul><li>èµ„æºæŒ‰éœ€åŠ¨æ€åˆ†é…</li><li>èµ„æºè‡ªåŠ¨åŒ–ç®¡ç†</li><li>æ•…éšœè‡ªåŠ¨åŒ–ç®¡ç†</li></ul><h2 id="4-3-å°æ–‡ä»¶å­˜å‚¨"><a href="#4-3-å°æ–‡ä»¶å­˜å‚¨" class="headerlink" title="4.3 å°æ–‡ä»¶å­˜å‚¨"></a>4.3 å°æ–‡ä»¶å­˜å‚¨</h2><p>å±•ç¤ºæ€§è´¨çš„æ•°æ®ï¼Œæ¯”å¦‚å•†å“å›¾ç‰‡ï¼Œå•†å“æè¿°ï¼›ç‰¹å¾æ˜¯æ•°æ®å°ï¼Œä½†æ•°é‡å·¨å¤§</p><h2 id="4-4-å¤§æ–‡ä»¶å­˜å‚¨"><a href="#4-4-å¤§æ–‡ä»¶å­˜å‚¨" class="headerlink" title="4.4 å¤§æ–‡ä»¶å­˜å‚¨"></a>4.4 å¤§æ–‡ä»¶å­˜å‚¨</h2><ul><li>ä¸šåŠ¡ä¸Šçš„å¤§æ•°æ®<ul><li>youtubeçš„è§†é¢‘</li><li>ç”µå½±</li></ul></li><li>æµ·é‡æ—¥å¿—æ•°æ®<ul><li>è®¿é—®æ—¥å¿—</li><li>æ“ä½œæ—¥å¿—</li><li>ç”¨æˆ·è½¨è¿¹æ—¥å¿—</li></ul></li></ul><p>å‡ ä¸ªå¼€æºæ–¹æ¡ˆ</p><ul><li>Hadoop</li><li>HBase</li><li>Storm</li><li>Hive</li></ul><h1 id="5-å¼€å‘å±‚æŠ€æœ¯"><a href="#5-å¼€å‘å±‚æŠ€æœ¯" class="headerlink" title="5. å¼€å‘å±‚æŠ€æœ¯"></a>5. å¼€å‘å±‚æŠ€æœ¯</h1><h2 id="5-1-å¼€å‘æ¡†æ¶"><a href="#5-1-å¼€å‘æ¡†æ¶" class="headerlink" title="5.1 å¼€å‘æ¡†æ¶"></a>5.1 å¼€å‘æ¡†æ¶</h2><p>æ•´ä¸ªå…¬å¸ä½¿ç”¨åŒæ ·çš„æ¡†æ¶å’ŒæŠ€æœ¯å¯ä»¥è§£å†³ç»„å’Œç»„ä¹‹é—´æ²Ÿé€šçš„é—®é¢˜ï¼Œå¤§å¤§æå‡ç»„ç»‡å’Œå›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ã€‚</p><p>å¯¹äºæ¡†æ¶ï¼Œåº”è¯¥é€‰æ‹©æˆç†Ÿçš„æ¡†æ¶ï¼Œé¿å…ç›²ç›®è¿½é€æ–°æŠ€æœ¯ã€‚</p><ul><li>java<ul><li>SSH</li><li>SpringMVC</li><li>Play </li></ul></li><li>Ruby<ul><li>Ruby on Rails</li></ul></li><li>PHP<ul><li>ThinkPHP</li></ul></li><li>Python <ul><li>Django </li></ul></li></ul><h2 id="5-2-WebæœåŠ¡å™¨"><a href="#5-2-WebæœåŠ¡å™¨" class="headerlink" title="5.2 WebæœåŠ¡å™¨"></a>5.2 WebæœåŠ¡å™¨</h2><ul><li>Java<ul><li>Tomcat</li><li>JBoss </li><li>Besin </li></ul></li><li>PHP/ Python <ul><li>Nginx</li></ul></li><li>Apache </li></ul><h2 id="5-3-å®¹å™¨"><a href="#5-3-å®¹å™¨" class="headerlink" title="5.3 å®¹å™¨"></a>5.3 å®¹å™¨</h2><p>DockeræŠ€æœ¯ï¼Œä¸è·¨å¹³å°ï¼Œä½†æ˜¯å¯åŠ¨å¿«ï¼Œå‡ ä¹ä¸å èµ„æº</p><p>å¯ä»¥åŸºäºDockeræ‰“é€ è‡ªåŠ¨åŒ–è¿ç»´</p><h1 id="6-æœåŠ¡å±‚æŠ€æœ¯"><a href="#6-æœåŠ¡å±‚æŠ€æœ¯" class="headerlink" title="6. æœåŠ¡å±‚æŠ€æœ¯"></a>6. æœåŠ¡å±‚æŠ€æœ¯</h1><p>æœåŠ¡å±‚çš„ä¸»è¦ç›®æ ‡å°±æ˜¯é™ä½ç³»ç»Ÿé—´ç›¸äº’å…³è”çš„å¤æ‚åº¦ã€‚</p><h2 id="6-1-é…ç½®ä¸­å¿ƒ"><a href="#6-1-é…ç½®ä¸­å¿ƒ" class="headerlink" title="6.1 é…ç½®ä¸­å¿ƒ"></a>6.1 é…ç½®ä¸­å¿ƒ</h2><ul><li>é›†ä¸­ç®¡ç†å„ä¸ªç³»ç»Ÿçš„é…ç½®</li><li>å„ç³»ç»Ÿç®¡ç†è‡ªå·±çš„é…ç½®ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜<ul><li>éœ€è¦å¤šä¸ªç³»ç»Ÿé…åˆçš„æ—¶å€™ï¼Œé…ç½®åˆ†æ•£ï¼Œåˆ™é…ç½®æ£€æŸ¥å’Œæ²Ÿé€šåè°ƒéƒ½ä¼šæ¯”è¾ƒè´¹æ—¶é—´</li><li>å¤„ç†çº¿ä¸Šé—®é¢˜ï¼Œéœ€è¦æŸ¥è¯¢å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œç›¸äº’æ¯”è¾ƒï¼Œå¾ˆéº»çƒ¦</li><li>å„ç³»ç»Ÿè‡ªå·±é…ç½®ï¼Œå¾€å¾€ç”¨æ–‡æœ¬æ–¹å¼ï¼Œæ²¡æœ‰è‡ªåŠ¨çš„æ ¡éªŒæœºåˆ¶ï¼Œå°±æ¯”è¾ƒå®¹æ˜“å‡ºç°é”™è¯¯</li></ul></li><li>é…ç½®ä¸­å¿ƒï¼Œåšæˆé€šç”¨ç³»ç»Ÿï¼Œç»™æ‰€æœ‰ç³»ç»Ÿæ¥ä½¿ç”¨<ul><li>é›†ä¸­é…ç½®</li><li>ç¨‹åºåŒ–çš„è§„åˆ™æ£€æŸ¥ï¼Œé¿å…å¸¸è§é”™è¯¯ï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æ£€æŸ¥</li><li>å¤‡ä»½äº†ç³»ç»Ÿçš„é…ç½®ï¼Œä¾¿äºå¿«é€Ÿæ­å»ºç³»ç»Ÿå’Œæ¢å¤ä¸šåŠ¡</li></ul></li></ul><h2 id="6-2-æœåŠ¡ä¸­å¿ƒ"><a href="#6-2-æœåŠ¡ä¸­å¿ƒ" class="headerlink" title="6.2 æœåŠ¡ä¸­å¿ƒ"></a>6.2 æœåŠ¡ä¸­å¿ƒ</h2><p>æœåŠ¡ä¸­å¿ƒæ˜¯ç”¨æ¥è§£å†³è·¨ç³»ç»Ÿä¾èµ–çš„é…ç½®å’Œè°ƒåº¦é—®é¢˜çš„ã€‚</p><h3 id="6-2-1-æœåŠ¡åå­—ç³»ç»Ÿ-â€“-Service-Name-System"><a href="#6-2-1-æœåŠ¡åå­—ç³»ç»Ÿ-â€“-Service-Name-System" class="headerlink" title="6.2.1 æœåŠ¡åå­—ç³»ç»Ÿ â€“ Service Name System"></a>6.2.1 æœåŠ¡åå­—ç³»ç»Ÿ â€“ Service Name System</h3><p>å°†Serviceçš„åç§°è§£æä¸º<code>host+port+æ¥å£åç§°</code></p><p><img src="https://i.loli.net/2020/02/04/HqVy9UlC35ceauY.png" alt="fig2.png"></p><h3 id="6-2-2-æœåŠ¡æ€»çº¿ç³»ç»Ÿ-â€“-Service-Bus-System"><a href="#6-2-2-æœåŠ¡æ€»çº¿ç³»ç»Ÿ-â€“-Service-Bus-System" class="headerlink" title="6.2.2 æœåŠ¡æ€»çº¿ç³»ç»Ÿ â€“ Service Bus System"></a>6.2.2 æœåŠ¡æ€»çº¿ç³»ç»Ÿ â€“ Service Bus System</h3><p>æœ‰æ€»çº¿ç³»ç»Ÿå®Œæˆè°ƒç”¨ï¼ŒæœåŠ¡è¯·æ±‚æ–¹ä¸éœ€è¦ç›´æ¥å’ŒæœåŠ¡æä¾›æ–¹è¿›è¡Œäº¤äº’äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/04/G2UmVfZCIBpcLSD.png" alt="fig3.png"></p><p><img src="https://i.loli.net/2020/02/04/D5QZEIuiFAWoN1s.png" alt="fig4.png"></p><h2 id="6-3-æ¶ˆæ¯é˜Ÿåˆ—"><a href="#6-3-æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="6.3 æ¶ˆæ¯é˜Ÿåˆ—"></a>6.3 æ¶ˆæ¯é˜Ÿåˆ—</h2><p>å¾ˆå¤šä¸šåŠ¡å¤„ç†éœ€è¦é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±æ˜¯ä¸ºäº†å®ç°è¿™ç§è·¨ç³»ç»Ÿå¼‚æ­¥é€šçŸ¥çš„ä¸­é—´ä»¶ç³»ç»Ÿã€‚</p><h1 id="7-ç½‘ç»œå±‚æŠ€æœ¯"><a href="#7-ç½‘ç»œå±‚æŠ€æœ¯" class="headerlink" title="7. ç½‘ç»œå±‚æŠ€æœ¯"></a>7. ç½‘ç»œå±‚æŠ€æœ¯</h1><h2 id="7-1-è´Ÿè½½å‡è¡¡"><a href="#7-1-è´Ÿè½½å‡è¡¡" class="headerlink" title="7.1 è´Ÿè½½å‡è¡¡"></a>7.1 è´Ÿè½½å‡è¡¡</h2><ul><li>DNS<ul><li>åœ°ç†çº§åˆ«çš„è´Ÿè½½å‡è¡¡ </li></ul></li><li>Nginx, LVS, F5 <ul><li>åŒä¸€ä¸ªåœ°ç‚¹å†…æœºå™¨çº§åˆ«çš„è´Ÿè½½å‡è¡¡</li></ul></li><li>CDN<h2 id="7-2-å¤šæœºæˆ¿-è·¨å›½å¤šæœºæˆ¿"><a href="#7-2-å¤šæœºæˆ¿-è·¨å›½å¤šæœºæˆ¿" class="headerlink" title="7.2 å¤šæœºæˆ¿ + è·¨å›½å¤šæœºæˆ¿"></a>7.2 å¤šæœºæˆ¿ + è·¨å›½å¤šæœºæˆ¿</h2><h2 id="7-3-å¤šä¸­å¿ƒ"><a href="#7-3-å¤šä¸­å¿ƒ" class="headerlink" title="7.3 å¤šä¸­å¿ƒ"></a>7.3 å¤šä¸­å¿ƒ</h2></li></ul><p>æ¯ä¸ªä¸­å¿ƒéƒ½å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸”ä¸šåŠ¡å¯ä»¥è‡ªåŠ¨åœ¨å¤šä¸­å¿ƒä¹‹é—´åˆ‡æ¢ã€‚</p><h1 id="8-ç”¨æˆ·å±‚æŠ€æœ¯"><a href="#8-ç”¨æˆ·å±‚æŠ€æœ¯" class="headerlink" title="8. ç”¨æˆ·å±‚æŠ€æœ¯"></a>8. ç”¨æˆ·å±‚æŠ€æœ¯</h1><h2 id="8-1-ç”¨æˆ·ç®¡ç†"><a href="#8-1-ç”¨æˆ·ç®¡ç†" class="headerlink" title="8.1 ç”¨æˆ·ç®¡ç†"></a>8.1 ç”¨æˆ·ç®¡ç†</h2><ul><li>å•ç‚¹ç™»å½• (SSO) - ç»Ÿä¸€ç™»å½•<ul><li>cookie</li><li>Json</li><li>token </li><li>CAS </li></ul></li></ul><p><img src="https://i.loli.net/2020/02/04/y9ScKCkWZvTomLY.png" alt="fig5.png"></p><ul><li>æˆæƒç™»å½•<ul><li>OAuth 2.0</li></ul></li></ul><h2 id="8-2-æ¶ˆæ¯æ¨é€"><a href="#8-2-æ¶ˆæ¯æ¨é€" class="headerlink" title="8.2 æ¶ˆæ¯æ¨é€"></a>8.2 æ¶ˆæ¯æ¨é€</h2><ul><li>æ ¹æ®é€”å¾„<ul><li>çŸ­ä¿¡</li><li>é‚®ä»¶</li><li>ç«™å†…ä¿¡</li><li>Appæ¨é€</li></ul></li><li>æ¶ˆæ¯æ¨é€çš„åŠŸèƒ½<ul><li>è®¾å¤‡ç®¡ç†<ul><li>å”¯ä¸€æ ‡è¯†</li><li>æ³¨å†Œ</li><li>æ³¨é”€</li></ul></li><li>è¿æ¥ç®¡ç†</li><li>æ¶ˆæ¯ç®¡ç†</li></ul></li></ul><p>æŠ€æœ¯ä¸Šçš„æŒ‘æˆ˜ï¼š</p><ul><li><p>æµ·é‡è®¾å¤‡å’Œç”¨æˆ·ç®¡ç†</p><ul><li>éœ€è¦å°†ç”¨æˆ·å’Œè®¾å¤‡å…³è”èµ·æ¥</li><li>æå–ç”¨æˆ·ç‰¹å¾å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç±»æˆ–è€…æ‰“æ ‡ç­¾</li></ul></li><li><p>è¿æ¥ä¿æ´»</p><ul><li>æƒ³æ¨é€æ¶ˆæ¯å¿…é¡»æœ‰è¿æ¥é€šé“</li><li>ä½†æ˜¯æ‰‹æœºç­‰ç»ˆç«¯éƒ½ä¼šé™åˆ¶åå°åº”ç”¨çš„è¿è¡Œ</li><li>åº”ç”¨æ‰¾å‚å•†æ‹‰ç™½åå•ï¼Œhhhh</li></ul></li><li><p>æ¶ˆæ¯ç®¡ç†</p><ul><li>æ ¹æ®ç”¨æˆ·çš„ç‰¹å¾ï¼Œé€‰æ‹©ä¸€äº›ç”¨æˆ·è¿›è¡Œæ¶ˆæ¯æ¨é€</li><li>è¿™éƒ¨åˆ†çš„é€»è¾‘çš„è®¾è®¡å¿…é¡»ååˆ†çµæ´»<h2 id="8-3-å­˜å‚¨äº‘ï¼Œå›¾ç‰‡äº‘"><a href="#8-3-å­˜å‚¨äº‘ï¼Œå›¾ç‰‡äº‘" class="headerlink" title="8.3 å­˜å‚¨äº‘ï¼Œå›¾ç‰‡äº‘"></a>8.3 å­˜å‚¨äº‘ï¼Œå›¾ç‰‡äº‘</h2></li></ul></li><li><p>å°æ–‡ä»¶å­˜å‚¨</p></li></ul><h1 id="9-ä¸šåŠ¡å±‚æŠ€æœ¯"><a href="#9-ä¸šåŠ¡å±‚æŠ€æœ¯" class="headerlink" title="9. ä¸šåŠ¡å±‚æŠ€æœ¯"></a>9. ä¸šåŠ¡å±‚æŠ€æœ¯</h1><p>ä¸»è¦æ˜¯éšç€å‘å±•ä¸šåŠ¡å±‚å˜å¾—è¶Šæ¥è¶Šå¤§äº†ï¼Œéœ€è¦åšçš„æœ€ä¸»è¦çš„å°±æ˜¯æ‹†åˆ†äº†ï¼Œå°†æ•´ä½“å¤æ‚æ€§åˆ†æ•£åˆ°å¤šä¸ªå­ä¸šåŠ¡æˆ–è€…å­ç³»ç»Ÿå½“ä¸­ã€‚</p><p>å½“å­ç³»ç»Ÿå¤ªå¤šçš„æ—¶å€™ï¼Œå†åšé«˜å†…èšï¼Œä½è€¦åˆçš„æ“ä½œï¼Œå³å°†èŒè´£å…³è”æ¯”è¾ƒå¼ºçš„å­ç³»ç»Ÿåˆæˆä¸€ä¸ªè™šæ‹Ÿä¸šåŠ¡åŸŸï¼Œç„¶åé€šè¿‡ç½‘å…³å¯¹å¤–ç»Ÿä¸€å‘ˆç°ã€‚</p><h1 id="10-å¹³å°æŠ€æœ¯"><a href="#10-å¹³å°æŠ€æœ¯" class="headerlink" title="10. å¹³å°æŠ€æœ¯"></a>10. å¹³å°æŠ€æœ¯</h1><h2 id="10-1-è¿ç»´å¹³å°"><a href="#10-1-è¿ç»´å¹³å°" class="headerlink" title="10.1 è¿ç»´å¹³å°"></a>10.1 è¿ç»´å¹³å°</h2><ul><li>é…ç½®<ul><li>ä¸»è¦è´Ÿè´£èµ„æºçš„ç®¡ç†<ul><li>æœºå™¨ç®¡ç†</li><li>IPåœ°å€ç®¡ç†</li><li>è™šæ‹Ÿæœºç®¡ç†</li></ul></li></ul></li><li>éƒ¨ç½²<ul><li>ä¸»è¦è´Ÿè´£å°†ç³»ç»Ÿå‘å¸ƒåˆ°çº¿ä¸Š<ul><li>åŒ…ç®¡ç†</li><li>ç°åº¦å‘å¸ƒç®¡ç†</li><li>å›æ»š</li></ul></li></ul></li><li>ç›‘æ§<ul><li>ä¸»è¦è´Ÿè´£æ”¶é›†ç³»ç»Ÿä¸Šçº¿è¿è¡Œä¹‹åçš„ç›¸å…³æ•°æ®å¹¶è¿›è¡Œç›‘æ§ï¼Œä»¥ä¾¿åŠæ—¶å‘ç°é—®é¢˜ </li></ul></li><li>åº”æ€¥<ul><li>ä¸»è¦è´Ÿè´£ç³»ç»Ÿå‡ºæ•…éšœä»¥åçš„å¤„ç†<ul><li>åœæ­¢ç¨‹åº</li><li>ä¸‹çº¿æ•…éšœæœºå™¨</li><li>åˆ‡æ¢IP</li></ul></li></ul></li></ul><h2 id="10-2-æµ‹è¯•å¹³å°"><a href="#10-2-æµ‹è¯•å¹³å°" class="headerlink" title="10.2 æµ‹è¯•å¹³å°"></a>10.2 æµ‹è¯•å¹³å°</h2><ul><li>å•å…ƒæµ‹è¯•</li><li>é›†æˆæµ‹è¯•</li><li>æ¥å£æµ‹è¯•</li><li>æ€§èƒ½æµ‹è¯•</li></ul><p>é‡ç‚¹å°±æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä½¿æµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿé‡å¤æ‰§è¡Œï¼Œæ— é¡»äººå·¥å‚ä¸ï¼Œä»¥æé«˜æµ‹è¯•æ•ˆç‡ã€‚</p><h3 id="10-2-1-ç”¨ä¾‹ç®¡ç†"><a href="#10-2-1-ç”¨ä¾‹ç®¡ç†" class="headerlink" title="10.2.1 ç”¨ä¾‹ç®¡ç†"></a>10.2.1 ç”¨ä¾‹ç®¡ç†</h3><p>æµ‹è¯•è‡ªåŠ¨åŒ–çš„ä¸»è¦æ‰‹æ®µå°±æ˜¯é€šè¿‡è„šæœ¬æˆ–è€…ä»£ç æ¥è¿›è¡Œæµ‹è¯•ï¼Œä¸ºäº†é‡å¤æ‰§è¡Œæ­¤ç±»ä»£ç ï¼Œæµ‹è¯•å¹³å°éœ€è¦å°†ç”¨ä¾‹è¿›è¡Œç®¡ç†ï¼Œç®¡ç†çš„ç»´åº¦æœ‰ä¸šåŠ¡ã€ç³»ç»Ÿã€æµ‹è¯•ç±»å‹ã€ç”¨ä¾‹ä»£ç ã€‚ä¾‹å¦‚ç½‘è´­ä¸šåŠ¡çš„è®¢å•ç³»ç»Ÿçš„æ¥å£æµ‹è¯•ç”¨ä¾‹ã€‚</p><h3 id="10-2-2-èµ„æºç®¡ç†"><a href="#10-2-2-èµ„æºç®¡ç†" class="headerlink" title="10.2.2 èµ„æºç®¡ç†"></a>10.2.2 èµ„æºç®¡ç†</h3><p>å…·ä½“çš„è¿è¡Œç¯å¢ƒçš„é…ç½®ï¼ŒåŒ…æ‹¬</p><ul><li>ç¡¬ä»¶<ul><li>æœåŠ¡å™¨</li><li>æ‰‹æœº</li><li>å¹³æ¿</li></ul></li><li>è½¯ä»¶<ul><li>æ“ä½œç³»ç»Ÿ</li><li>æ•°æ®åº“</li><li>Javaè™šæ‹Ÿæœº</li></ul></li><li>ä¸šåŠ¡ç³»ç»Ÿ</li></ul><h3 id="10-2-3-ä»»åŠ¡ç®¡ç†"><a href="#10-2-3-ä»»åŠ¡ç®¡ç†" class="headerlink" title="10.2.3 ä»»åŠ¡ç®¡ç†"></a>10.2.3 ä»»åŠ¡ç®¡ç†</h3><p>å°†æµ‹è¯•ç”¨ä¾‹åˆ†é…åˆ°å…·ä½“çš„èµ„æºä¸Šæ¥æ‰§è¡Œï¼Œè·Ÿè¸ªä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µã€‚ä»»åŠ¡ç®¡ç†æ˜¯æµ‹è¯•å¹³å°è®¾è®¡çš„æ ¸å¿ƒï¼Œå…¶å°†æµ‹è¯•å¹³å°çš„å„ä¸ªéƒ¨åˆ†ä¸²è”èµ·æ¥ä»è€Œå®Œæˆè‡ªåŠ¨åŒ–æµ‹è¯•</p><h3 id="10-2-4-æ•°æ®ç®¡ç†"><a href="#10-2-4-æ•°æ®ç®¡ç†" class="headerlink" title="10.2.4 æ•°æ®ç®¡ç†"></a>10.2.4 æ•°æ®ç®¡ç†</h3><p>è®°å½•å„ç§ç›¸å…³çš„æ•°æ®</p><ul><li>æ‰§è¡Œæ—¶é—´</li><li>æ‰§è¡Œç»“æœ</li><li>ç”¨ä¾‹æ‰§è¡ŒæœŸé—´çš„CPUï¼Œå†…å­˜å ç”¨æƒ…å†µ</li></ul><h2 id="10-3-æ•°æ®å¹³å°"><a href="#10-3-æ•°æ®å¹³å°" class="headerlink" title="10.3 æ•°æ®å¹³å°"></a>10.3 æ•°æ®å¹³å°</h2><ul><li>æ•°æ®ç®¡ç†<ul><li>æ•°æ®é‡‡é›†<ul><li>æ—¥å¿—</li><li>ç”¨æˆ·è¡Œä¸º</li><li>ä¸šåŠ¡æ•°æ®</li></ul></li><li>æ•°æ®å­˜å‚¨<ul><li>å°†ä»ä¸šåŠ¡ç³»ç»Ÿé‡‡é›†çš„æ•°æ®å­˜å‚¨åˆ°æ•°æ®å¹³å°ï¼Œç”¨äºåç»­æ•°æ®åˆ†æ </li></ul></li><li>æ•°æ®è®¿é—®<ul><li>è´Ÿè´£å¯¹å¤–æä¾›å„ç§åè®®ç”¨äºè¯»å†™æ•°æ® </li></ul></li><li>æ•°æ®å®‰å…¨</li></ul></li><li>æ•°æ®åˆ†æ<ul><li>æ•°æ®ç»Ÿè®¡</li><li>æ•°æ®æŒ–æ˜</li><li>æœºå™¨å­¦ä¹ </li><li>æ·±åº¦å­¦ä¹ </li></ul></li><li>æ•°æ®åº”ç”¨</li></ul><h2 id="10-4-ç®¡ç†å¹³å°"><a href="#10-4-ç®¡ç†å¹³å°" class="headerlink" title="10.4 ç®¡ç†å¹³å°"></a>10.4 ç®¡ç†å¹³å°</h2><p>ç®¡ç†å¹³å°çš„æ ¸å¿ƒèŒè´£å°±æ˜¯æƒé™ç®¡ç†ï¼Œè¦åšèº«ä»½è®¤è¯ä»¥åŠæƒé™æ§åˆ¶ã€‚</p><ul><li>èº«ä»½è®¤è¯<ul><li>ç¡®å®šå½“å‰çš„æ“ä½œäººå‘˜èº«ä»½ï¼Œé˜²æ­¢éæ³•äººå‘˜è¿›å…¥ç³»ç»Ÿ</li></ul></li><li>æƒé™æ§åˆ¶<ul><li>æ ¹æ®èº«ä»½ç¡®å®šæƒé™ </li></ul></li></ul><h1 id="11-Some-tips"><a href="#11-Some-tips" class="headerlink" title="11. Some tips"></a>11. Some tips</h1><h2 id="11-1-å¦‚ä½•é€‰æ‹©å¼€æºé¡¹ç›®"><a href="#11-1-å¦‚ä½•é€‰æ‹©å¼€æºé¡¹ç›®" class="headerlink" title="11.1 å¦‚ä½•é€‰æ‹©å¼€æºé¡¹ç›®"></a>11.1 å¦‚ä½•é€‰æ‹©å¼€æºé¡¹ç›®</h2><ul><li>ä¸è¦é‡å¤é€ è½®å­</li><li>ä½†è¦æ‰¾åˆ°åˆé€‚çš„è½®å­</li></ul><h3 id="11-1-1-é€‰æ‹©æ–¹æ³•"><a href="#11-1-1-é€‰æ‹©æ–¹æ³•" class="headerlink" title="11.1.1 é€‰æ‹©æ–¹æ³•"></a>11.1.1 é€‰æ‹©æ–¹æ³•</h3><ul><li>èšç„¦äºæ˜¯å¦æ»¡è¶³ä¸šåŠ¡ï¼Œè€Œä¸æ˜¯èšç„¦äºå¼€æºé¡¹ç›®æœ¬èº«æ˜¯å¦è¶³å¤Ÿä¼˜ç§€</li><li>èšç„¦äºè¯¥é¡¹ç›®æ˜¯å¦è¶³å¤Ÿæˆç†Ÿ<ul><li>ç‰ˆæœ¬å·</li><li>ä½¿ç”¨çš„å…¬å¸æ•°é‡</li><li>ç¤¾åŒºæ´»è·ƒç¨‹åº¦</li></ul></li><li>èšç„¦äºè¿ç»´èƒ½åŠ›<ul><li>å¼€æºé¡¹ç›®æ—¥å¿—æ˜¯å¦é½å…¨</li><li>æ˜¯å¦æœ‰å‘½ä»¤è¡Œï¼Œç®¡ç†æ§åˆ¶å°ç­‰ç»´æŠ¤å·¥å…·</li><li>æ˜¯å¦æœ‰æ•…éšœæ£€æµ‹å’Œæ¢å¤çš„èƒ½åŠ›ï¼Œä¾‹å¦‚å‘Šè­¦ï¼Œåˆ‡æ¢ç­‰</li></ul></li></ul><h3 id="11-1-2-å¦‚ä½•æ·±å…¥äº†è§£ä¸€ä¸ªå¼€æºé¡¹ç›®"><a href="#11-1-2-å¦‚ä½•æ·±å…¥äº†è§£ä¸€ä¸ªå¼€æºé¡¹ç›®" class="headerlink" title="11.1.2 å¦‚ä½•æ·±å…¥äº†è§£ä¸€ä¸ªå¼€æºé¡¹ç›®"></a>11.1.2 å¦‚ä½•æ·±å…¥äº†è§£ä¸€ä¸ªå¼€æºé¡¹ç›®</h3><ul><li>é€šè¯»å¼€æºé¡¹ç›®çš„è®¾è®¡æ–‡æ¡£ï¼Œç™½çš®ä¹¦ï¼Œäº†è§£å…¶è®¾è®¡åŸç†</li><li>æ ¸å¯¹æ¯ä¸ªé…ç½®é¡¹çš„ä½œç”¨å’Œå½±å“ï¼Œè¯†åˆ«å‡ºå…³é”®é…ç½®é¡¹</li><li>è¿›è¡Œå¤šç§åœºæ™¯çš„æ€§èƒ½æµ‹è¯•</li><li>è¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œè§‚å¯ŸCPUã€å†…å­˜ã€ç£ç›˜I/Oç­‰å…³é”®æŒ‡æ ‡</li><li>è¿›è¡Œæ•…éšœæµ‹è¯•</li></ul><h3 id="11-1-3-å¦‚ä½•åŸºäºå¼€æºé¡¹ç›®åšäºŒæ¬¡å¼€å‘"><a href="#11-1-3-å¦‚ä½•åŸºäºå¼€æºé¡¹ç›®åšäºŒæ¬¡å¼€å‘" class="headerlink" title="11.1.3 å¦‚ä½•åŸºäºå¼€æºé¡¹ç›®åšäºŒæ¬¡å¼€å‘"></a>11.1.3 å¦‚ä½•åŸºäºå¼€æºé¡¹ç›®åšäºŒæ¬¡å¼€å‘</h3><ul><li>ä¸æ”¹åŠ¨åŸç³»ç»Ÿï¼Œå› ä¸ºè¿˜è¦è¦èƒ½å¤Ÿåˆå¹¶ï¼Œä¸åŸæ¥çš„èƒ½å¤Ÿå…¼å®¹å°±å†å¥½ä¸è¿‡äº†</li><li>å¼€å‘è¾…åŠ©ç³»ç»Ÿ<ul><li>ç›‘æ§</li><li>æŠ¥è­¦</li><li>è´Ÿè½½å‡è¡¡</li><li>ç®¡ç†</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -å¤æ‚åº¦æ¥æº</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90/</url>
      
        <content type="html"><![CDATA[<p>æ¶æ„è®¾è®¡çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶ç³»ç»Ÿå¤æ‚åº¦å¸¦æ¥çš„é—®é¢˜ï¼Œé‚£ä¹ˆå¤æ‚åº¦çš„æ¥æºåˆ°åº•åœ¨å“ªé‡Œå‘¢ï¼Ÿ </p><h1 id="1-é«˜æ€§èƒ½"><a href="#1-é«˜æ€§èƒ½" class="headerlink" title="1. é«˜æ€§èƒ½"></a>1. é«˜æ€§èƒ½</h1><h2 id="1-1-å•æœºå¤æ‚åº¦"><a href="#1-1-å•æœºå¤æ‚åº¦" class="headerlink" title="1.1 å•æœºå¤æ‚åº¦"></a>1.1 å•æœºå¤æ‚åº¦</h2><p>æ“ä½œç³»ç»Ÿ - æ˜¯å°†ç¡¬ä»¶æ€§èƒ½å……åˆ†å‘æŒ¥å‡ºæ¥çš„å…³é”®ã€‚</p><ul><li>æœ€åˆæ˜¯åªæœ‰è¾“å…¥è®¡ç®—ä»¥åŠè¾“å‡ºåŠŸèƒ½</li><li>æ‰¹å¤„ç† - å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤é¢„å…ˆå†™ä¸‹æ¥ï¼Œå½¢æˆä¸€ä¸ªæŒ‡ä»¤æ¸…å•ï¼Œç„¶åå°†ä»»åŠ¡äº¤ç»™è®¡ç®—æœºæ‰§è¡Œï¼Œè¯»å–ä»»åŠ¡ä¸­çš„æŒ‡ä»¤æ¸…å•å¹¶è¿›è¡Œå¤„ç†</li><li>è¿›ç¨‹ - è¿›ç¨‹å¯¹åº”ä»»åŠ¡ï¼Œéƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œè¿›ç¨‹é—´äº’ä¸ç›¸å…³</li><li>è¿›ç¨‹é—´çš„é€šä¿¡<ul><li>ç®¡é“</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li><li>ä¿¡å·é‡</li><li>å…±äº«å­˜å‚¨</li></ul></li><li>çº¿ç¨‹<ul><li>è¿›ç¨‹å†…éƒ¨çš„å­ä»»åŠ¡ï¼Œéƒ½å…±äº«åŒä¸€ä»½è¿›ç¨‹æ•°æ®ã€‚ä¸ºä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼Œæœ‰äº†äº’æ–¥é”æœºåˆ¶ã€‚æœ‰äº†å¤šçº¿ç¨‹ä»¥åï¼Œæ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•ä½å°±å˜æˆäº†çº¿ç¨‹ï¼Œè€Œè¿›ç¨‹å˜æˆäº†æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„æœ€å°å•ä½ã€‚</li></ul></li><li>å¤šä¸ªCPUçœŸæ­£åŒæ—¶æ‰§è¡Œè®¡ç®—ä»»åŠ¡<ul><li>SMP symmetric multi processor </li><li>NUMA  Non uniform memory access </li><li>MPP  Massive Parallel Processing </li></ul></li></ul><h2 id="1-2-é›†ç¾¤å¤æ‚åº¦"><a href="#1-2-é›†ç¾¤å¤æ‚åº¦" class="headerlink" title="1.2 é›†ç¾¤å¤æ‚åº¦"></a>1.2 é›†ç¾¤å¤æ‚åº¦</h2><p>çªç„¶å‘ç°åŒåä¸€å³°å€¼ï¼Œæ”¯ä»˜å®èƒ½åˆ°æ¯ç§’12ä¸‡ç¬”ï¼›çº¢åŒ…èƒ½è¾¾åˆ°76ä¸‡ã€‚é€šè¿‡å¤§é‡æœºå™¨æ¥æå‡æ€§èƒ½ï¼Œå¹¶ä¸ä»…ä»…æ˜¯å¢åŠ æœºå™¨è¿™ä¹ˆç®€å•ï¼Œè®©å¤šå°æœºå™¨æ¥é…åˆè¾¾åˆ°é«˜æ€§èƒ½çš„ç›®çš„ï¼Œæ˜¯ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œå¤æ‚åœ¨äºï¼š</p><ul><li>ä»»åŠ¡åˆ†é…<ul><li>ä»»åŠ¡åˆ†é…å™¨<ul><li>ç¡¬ä»¶ç½‘ç»œè®¾å¤‡ äº¤æ¢æœº</li><li>è½¯ä»¶ç½‘ç»œè®¾å¤‡  LVS</li><li>è´Ÿè½½å‡è¡¡è½¯ä»¶  Nginix  HAProxy</li><li>åˆ†é…ç®—æ³•<ul><li>è½®è¯¢</li><li>æŒ‰æƒé‡åˆ†é…</li><li>æŒ‰è´Ÿè½½åˆ†é…</li></ul></li></ul></li><li>ä»»åŠ¡åˆ†é…å™¨å’Œä¸šåŠ¡æœåŠ¡å™¨çš„è¿æ¥<ul><li>é€‰æ‹©åˆé€‚çš„è¿æ¥æ–¹å¼</li><li>ç®¡ç†è¿æ¥<ul><li>è¿æ¥å»ºç«‹ï¼Œæ£€æµ‹ï¼Œä¸­æ–­åçš„å¤„ç† </li></ul></li></ul></li><li>ç»§ç»­æ‹“å±• -&gt; ä»»åŠ¡åˆ†é…å™¨ä¹Ÿè¦å˜æˆå¤šå°äº†<ul><li>æ­¤æ—¶éœ€è¦å°†ä¸åŒçš„ç”¨æˆ·åˆ†é…åˆ°ä¸åŒçš„ä»»åŠ¡åˆ†é…å™¨ä¸Š<ul><li>DNSè½®è¯¢ï¼ŒCDNï¼Œ GSLB(Global Server Load Balance)</li></ul></li><li>ä»»åŠ¡åˆ†é…å™¨å’Œä¸šåŠ¡æœåŠ¡å™¨ï¼Œå¤šå¯¹å¤šçš„ç½‘çŠ¶ç»“æ„</li></ul></li></ul></li><li>ä»»åŠ¡åˆ†è§£<ul><li>ä»»åŠ¡åˆ†é…åˆ°ä¸åŒçš„æœºå™¨ä¸Šå¸¦æ¥çš„å¸®åŠ©ä¼šé€’å‡çš„ï¼Œå› ä¸ºå½“ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ï¼Œå•å°æœºå™¨çš„æ€§èƒ½ä¸å¤Ÿç”¨äº†ï¼Œæ‰€ä»¥å°±éœ€è¦è¿›è¡Œä»»åŠ¡åˆ†è§£æ¥åšä¼˜åŒ–</li><li>å¯ä»¥ä»é€»è¾‘ä¸Šå°†å„ä¸ªå­ä¸šåŠ¡è¿›è¡Œæ‹†åˆ†ï¼Œå°†ä¸€æ•´ä¸ªä¸šåŠ¡ç³»ç»Ÿæ‹†åˆ†æˆå°è€Œç®€å•ï¼Œä½†æ˜¯éœ€è¦å¤šä¸ªç³»ç»Ÿé…åˆçš„ä¸šåŠ¡ç³»ç»Ÿ</li><li>ä¸ºä»€ä¹ˆèƒ½æå‡æ€§èƒ½ï¼Ÿ ä»£ç è¿˜æ˜¯é‚£äº›ä»£ç å“‡ï¼Ÿ<ul><li>ç®€å•çš„ç³»ç»Ÿæ›´å®¹æ˜“åˆ†æå‡ºç“¶é¢ˆï¼Œæ›´å®¹æ˜“åšåˆ°é«˜æ€§èƒ½</li><li>å¯ä»¥é’ˆå¯¹å•ä¸ªä»»åŠ¡è¿›è¡Œæ‹“å±•</li><li>å½“ç„¶ä¸èƒ½åˆ’åˆ†çš„å¤ªç»†ï¼Œå› ä¸ºç½‘ç»œçš„è°ƒç”¨æ€§èƒ½è¿œæ¯”ç³»ç»Ÿå†…çš„å‡½æ•°è°ƒç”¨è¦ä½</li></ul></li></ul></li></ul><h1 id="2-é«˜å¯ç”¨"><a href="#2-é«˜å¯ç”¨" class="headerlink" title="2. é«˜å¯ç”¨"></a>2. é«˜å¯ç”¨</h1><blockquote><p>ç³»ç»Ÿæ— ä¸­æ–­åœ°æ‰§è¡Œå…¶åŠŸèƒ½çš„èƒ½åŠ›ï¼Œä»£è¡¨ç³»ç»Ÿçš„å¯ç”¨æ€§ç¨‹åº¦</p></blockquote><blockquote><p>é€šè¿‡å†—ä½™æ¥å®ç°é«˜å¯ç”¨ï¼Œä¸é«˜æ€§èƒ½çš„åŒºåˆ«åœ¨äºï¼Œé«˜æ€§èƒ½å¢åŠ æœºå™¨çš„ç›®çš„åœ¨äºæ‰©å±•å¤„ç†æ€§èƒ½ï¼›é«˜å¯ç”¨å¢åŠ æœºå™¨çš„ç›®çš„åœ¨äºå†—ä½™å¤„ç†å•å…ƒ</p></blockquote><h2 id="2-1-è®¡ç®—é«˜å¯ç”¨"><a href="#2-1-è®¡ç®—é«˜å¯ç”¨" class="headerlink" title="2.1 è®¡ç®—é«˜å¯ç”¨"></a>2.1 è®¡ç®—é«˜å¯ç”¨</h2><p>å¤šå°æœåŠ¡å™¨æ—¶ä¸»å¤‡çš„é€‰æ‹©ï¼Œå…·ä½“é‡‡ç”¨ä»€ä¹ˆæ–¹å¼ï¼Œä¸»å¤‡åˆ†åˆ«çš„ä¸ªæ•°ï¼Œç»“åˆå®é™…ä¸šåŠ¡éœ€æ±‚æ¥åˆ†æå’Œåˆ¤æ–­ã€‚</p><h2 id="2-2-å­˜å‚¨é«˜å¯ç”¨"><a href="#2-2-å­˜å‚¨é«˜å¯ç”¨" class="headerlink" title="2.2 å­˜å‚¨é«˜å¯ç”¨"></a>2.2 å­˜å‚¨é«˜å¯ç”¨</h2><p>é«˜å¯ç”¨è®¾è®¡çš„å…³é”®ç‚¹å°±åœ¨äºå­˜å‚¨é«˜å¯ç”¨äº†ï¼ŒåŒºåˆ«åœ¨äºå°†æ•°æ®ä»ä¸€å°æœºå™¨æ¬åˆ°å¦ä¸€å°æœºå™¨ï¼Œéœ€è¦ç»è¿‡çº¿è·¯è¿›è¡Œä¼ è¾“</p><p>æ— è®ºæ˜¯æ­£å¸¸æƒ…å†µä¸‹çš„ä¼ è¾“å»¶è¿Ÿï¼Œè¿˜æ˜¯å¼‚å¸¸æƒ…å†µä¸‹çš„ä¼ è¾“ä¸­æ–­ï¼Œéƒ½ä¼šå¯¼è‡´ç³»ç»Ÿçš„æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹æˆ–è€…æ—¶é—´æ®µæ˜¯ä¸ä¸€è‡´çš„ï¼Œè€Œæ•°æ®çš„ä¸ä¸€è‡´åˆä¼šå¯¼è‡´ä¸šåŠ¡é—®é¢˜ï¼›å­˜å‚¨é«˜å¯ç”¨çš„éš¾ç‚¹ä¸åœ¨äºå¦‚ä½•å¤‡ä»½æ•°æ®ï¼Œè€Œåœ¨äºå¦‚ä½•å‡å°‘æˆ–è€…è§„é¿æ•°æ®ä¸ä¸€è‡´å¯¹ä¸šåŠ¡é€ æˆçš„å½±å“ã€‚</p><p>åˆ†å¸ƒå¼é¢†åŸŸçš„CAPå®šç†ï¼Œå­˜å‚¨é«˜å¯ç”¨æ€§ä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§ï¼Œæœ€å¤šæ»¡è¶³å…¶ä¸­ä¸¤ä¸ªï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åœ¨åšæ¶æ„è®¾è®¡çš„æ—¶å€™ç»“åˆä¸šåŠ¡è¿›è¡Œå–èˆã€‚</p><h2 id="2-3-é«˜å¯ç”¨çŠ¶æ€å†³ç­–"><a href="#2-3-é«˜å¯ç”¨çŠ¶æ€å†³ç­–" class="headerlink" title="2.3 é«˜å¯ç”¨çŠ¶æ€å†³ç­–"></a>2.3 é«˜å¯ç”¨çŠ¶æ€å†³ç­–</h2><p>æ— è®ºæ˜¯è®¡ç®—é«˜å¯ç”¨è¿˜æ˜¯å­˜å‚¨é«˜å¯ç”¨ï¼Œå…¶åŸºç¡€éƒ½æ˜¯çŠ¶æ€å†³ç­–ï¼Œå³ç³»ç»Ÿéœ€è¦èƒ½å¤Ÿåˆ¤æ–­å½“å‰çš„çŠ¶æ€æ˜¯æ­£å¸¸è¿˜æ˜¯å¼‚å¸¸çš„ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸å°±è¦é‡‡å–è¡ŒåŠ¨æ¥ä¿è¯é«˜å¯ç”¨ã€‚ä½†ä¸€ä¸ªçŸ›ç›¾ç‚¹åœ¨äºï¼š </p><p><strong>é€šè¿‡å†—ä½™å®ç°çš„é«˜å¯ç”¨ï¼ŒçŠ¶æ€å†³ç­–æœ¬è´¨ä¸Šå°±ä¸å¯èƒ½åšåˆ°å®Œå…¨æ­£ç¡®</strong></p><p>å¸¸è§çš„å†³ç­–æ–¹å¼ï¼š</p><ul><li>ç‹¬è£å¼<ul><li>åªæœ‰ä¸€ä¸ªå†³ç­–è€…</li><li>nä¸ªä¸ŠæŠ¥è€…</li><li>ä¸ä¼šå‡ºç°å†³ç­–æ··ä¹±ï¼Œä½†æ˜¯å†³ç­–è€…æœ¬èº«æ•…éšœçš„æ—¶å€™ï¼Œç³»ç»Ÿå°±å´©äº†</li></ul></li><li>åå•†å¼<ul><li>ä¸¤ä¸ªç‹¬ç«‹çš„ä¸ªä½“é€šè¿‡äº¤æµä¿¡æ¯ï¼Œæ ¹æ®è§„åˆ™è¿›è¡Œå†³ç­–</li><li>ä¸»å¤‡å†³ç­–</li><li>2å°æœåŠ¡å™¨å¯åŠ¨æ—¶éƒ½æ˜¯å¤‡æœº</li><li>å»ºç«‹è¿æ¥</li><li>äº¤æ¢çŠ¶æ€ä¿¡æ¯</li><li>æŸ1å°æœåŠ¡å™¨åšå‡ºå†³ç­–ï¼Œæˆä¸ºä¸»æœºï¼›å¦ä¸€å°ç»§ç»­ä¿æŒå¤‡æœºèº«ä»½</li><li>åå•†å¼ å½“è¿æ¥å‡ºé—®é¢˜çš„æ—¶å€™ï¼Œé‡‡ç”¨å“ªä¸ªï¼Ÿ ä¸¤ä¸»ï¼Ÿ å¤šè¿æ¥ï¼Ÿ ä»ç„¶å­˜åœ¨é—®é¢˜çš„</li></ul></li><li>æ°‘ä¸»å¼<ul><li>å¤šä¸ªç‹¬ç«‹ä¸ªä½“é€šè¿‡æŠ•ç¥¨çš„æ–¹å¼è¿›è¡ŒçŠ¶æ€å†³ç­–</li><li>ZooKeeperé›†ç¾¤åœ¨é€‰ä¸¾leaderæ—¶å°±é‡‡ç”¨è¿™ç§æ–¹å¼</li><li>å¯¹äºè¿æ¥æ–­å¼€ï¼Œå¯èƒ½å‡ºç°å¤šä¸ªleaderçš„é—®é¢˜çš„è§£å†³<ul><li>æŠ•ç¥¨èŠ‚ç‚¹æ•°å¿…é¡»è¶…è¿‡ç³»ç»Ÿæ€»ç»“ç‚¹æ•°çš„ä¸€åŠçš„è§„åˆ™ </li></ul></li></ul></li></ul><h1 id="3-å¯æ‹“å±•æ€§"><a href="#3-å¯æ‹“å±•æ€§" class="headerlink" title="3. å¯æ‹“å±•æ€§"></a>3. å¯æ‹“å±•æ€§</h1><ul><li>å¯æ‹“å±•æ€§æŒ‡ç³»ç»Ÿä¸ºäº†åº”å¯¹å°†æ¥çš„éœ€æ±‚å˜åŒ–è€Œæä¾›çš„ä¸€ç§æ‰©å±•èƒ½åŠ›ï¼Œå½“æœ‰æ–°çš„éœ€æ±‚å‡ºç°çš„æ—¶å€™ï¼Œç³»ç»Ÿä¸éœ€è¦æˆ–è€…ä»…ä»…éœ€è¦å°‘é‡ä¿®æ”¹å°±å¯ä»¥æ”¯æŒï¼Œæ— é¡»æ•´ä¸ªç³»ç»Ÿçš„é‡æ„æˆ–è€…é‡å»ºã€‚</li><li>é¢å‘å¯¹è±¡çš„æ€æƒ³ä»¥åŠè®¾è®¡æ¨¡å¼çš„è¯ç”Ÿä¸æ¼”åŒ–ï¼Œéƒ½æ˜¯åœ¨åŠªåŠ›æå‡ä»£ç çš„å¯æ‹“å±•æ€§</li><li>è®¾è®¡å…·å¤‡è‰¯å¥½å¯æ‹“å±•æ€§çš„ç³»ç»Ÿçš„åŸºæœ¬æ¡ä»¶<ul><li>æ­£ç¡®é¢„æµ‹å˜åŒ–<ul><li>ä¸èƒ½æ¯ä¸ªç‚¹éƒ½è€ƒè™‘å¯æ‹“å±•æ€§</li><li>ä¸èƒ½å®Œå…¨ä¸è€ƒè™‘å¯æ‹“å±•æ€§</li><li>æ‰€æœ‰çš„é¢„æµ‹éƒ½å­˜åœ¨å‡ºé”™çš„å¯èƒ½æ€§</li></ul></li><li>å®Œç¾å°è£…å˜åŒ–<ul><li>ä¸€èˆ¬æ¥è¯´ä¼šå°†å˜åŒ–å°è£…åœ¨ä¸€ä¸ªå˜åŒ–å±‚ï¼Œå°†ä¸å˜çš„éƒ¨åˆ†å°è£…åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç¨³å®šå±‚</li><li>æˆ–è€…æç‚¼å‡ºä¸€ä¸ªæŠ½è±¡å±‚å’Œä¸€ä¸ªå®ç°å±‚</li></ul></li></ul></li></ul><h1 id="4-ä½æˆæœ¬ï¼Œå®‰å…¨ï¼Œè§„æ¨¡"><a href="#4-ä½æˆæœ¬ï¼Œå®‰å…¨ï¼Œè§„æ¨¡" class="headerlink" title="4. ä½æˆæœ¬ï¼Œå®‰å…¨ï¼Œè§„æ¨¡"></a>4. ä½æˆæœ¬ï¼Œå®‰å…¨ï¼Œè§„æ¨¡</h1><ul><li>ä½æˆæœ¬<ul><li>é€šè¿‡å‡å°‘æœåŠ¡å™¨çš„æ•°é‡æ¥è¾¾æˆä½æˆæœ¬çš„ç›®æ ‡</li><li>é¦–å…ˆæŒ‡å®šä¸€ä¸ªæˆæœ¬ç›®æ ‡ï¼Œå½“æˆ‘ä»¬æ ¹æ®é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„è¦æ±‚è®¾è®¡å‡ºæ–¹æ¡ˆæ—¶ï¼Œè¯„ä¼°ä¸€ä¸‹æ–¹æ¡ˆèƒ½å¦æ»¡è¶³æˆæœ¬ç›®æ ‡ï¼Œå¦‚æœä¸è¡Œï¼Œå°±è¦é‡æ–°è®¾è®¡æ¶æ„</li><li>é€šè¿‡å¼•å…¥æ–°æŠ€æœ¯æ¥è¾¾åˆ°ç›®æ ‡<ul><li>NoSQL è§£å†³å…³ç³»å‹æ•°æ®åº“æ— æ³•åº”å¯¹é«˜å¹¶å‘æƒ…å†µä¸‹çš„è®¿é—®å‹åŠ›çš„é—®é¢˜</li><li>å…¨æ–‡æœç´¢å¼•æ“æ˜¯ä¸ºäº†è§£å†³å…³ç³»å‹æ•°æ®åº“likeæœç´¢çš„ä½æ•ˆçš„é—®é¢˜</li><li>Hadoopçš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³ä¼ ç»Ÿæ–‡ä»¶ä½“ç»Ÿæ— æ³•åº”å¯¹æµ·é‡æ•°æ®å­˜å‚¨å’Œè®¡ç®—çš„é—®é¢˜</li></ul></li></ul></li><li>å®‰å…¨<ul><li>åŠŸèƒ½å®‰å…¨<ul><li>XSSæ”»å‡»</li><li>CSRFæ”»å‡»</li><li>SQLæ³¨å…¥</li><li>Windowsæ¼æ´</li><li>å¯†ç ç ´è§£</li></ul></li><li>æ¶æ„å®‰å…¨<ul><li>é˜²ç«å¢™<ul><li>éš”ç¦»ç½‘ç»œ</li><li>é€šè¿‡å°†ç½‘ç»œåˆ’åˆ†æˆä¸åŒçš„åŒºåŸŸï¼Œåˆ¶å®šå‡ºä¸åŒåŒºåŸŸä¹‹é—´çš„è®¿é—®æ§åˆ¶ç­–ç•¥æ¥æ§åˆ¶ä¸åŒä¿¡ä»»ç¨‹åº¦åŒºåŸŸé—´ä¼ é€çš„æ•°æ®æµ</li><li>å¤ªè´µï¼Œå¾ˆéš¾å®ç°</li></ul></li><li>ä¸€èˆ¬è¿˜æ˜¯é è¿è¥å•†æˆ–è€…äº‘æœåŠ¡å•†å¼ºå¤§çš„å¸¦å®½å’Œæµé‡æ¸…æ´—èƒ½åŠ›</li></ul></li></ul></li><li>è§„æ¨¡<ul><li>è§„æ¨¡å¸¦æ¥çš„å¤æ‚åº¦ - é‡å˜å¸¦æ¥çš„è´¨å˜</li><li>åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œå¤æ‚åº¦æŒ‡æ•°çº§å¢åŠ </li><li>æ•°æ®è¶Šæ¥è¶Šå¤š</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -å¯æ‰©å±•æ¶æ„æ¨¡å¼</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8F%AF%E6%89%A9%E5%B1%95%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8F%AF%E6%89%A9%E5%B1%95%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¯æ‰©å±•æ¶æ„çš„åŸºæœ¬æ€æƒ³å’Œæ¨¡å¼"><a href="#1-å¯æ‰©å±•æ¶æ„çš„åŸºæœ¬æ€æƒ³å’Œæ¨¡å¼" class="headerlink" title="1. å¯æ‰©å±•æ¶æ„çš„åŸºæœ¬æ€æƒ³å’Œæ¨¡å¼"></a>1. å¯æ‰©å±•æ¶æ„çš„åŸºæœ¬æ€æƒ³å’Œæ¨¡å¼</h1><p>è½¯ä»¶ç³»ç»Ÿä¸ç¡¬ä»¶/å»ºç­‘ç³»ç»Ÿæœ€å¤§çš„å·®å¼‚åœ¨äºè½¯ä»¶æ˜¯å¯æ‰©å±•çš„ï¼Œä¼šä¸æ–­æ›´æ–°ï¼Œä¸æ–­å‘å±•ã€‚å¦‚ä½•é¿å…æ‰©å±•æ—¶æ”¹åŠ¨èŒƒå›´å¤ªå¤§ï¼Œæ˜¯è½¯ä»¶æ¶æ„å¯æ‰©å±•æ€§è®¾è®¡çš„ä¸»è¦æ€è€ƒç‚¹ã€‚</p><h2 id="1-1-åŸºæœ¬æ€æƒ³-æ‹†åˆ†"><a href="#1-1-åŸºæœ¬æ€æƒ³-æ‹†åˆ†" class="headerlink" title="1.1 åŸºæœ¬æ€æƒ³ - æ‹†åˆ†"></a>1.1 åŸºæœ¬æ€æƒ³ - æ‹†åˆ†</h2><p>å°†å¤§ç³»ç»Ÿç»†åˆ†ä¸ºå°ç³»ç»Ÿï¼Œæ‰©å±•æ—¶åªæ˜¯ä¿®æ”¹å…¶ä¸­ä¸€éƒ¨åˆ†å³å¯ï¼Œæ— é¡»æ•´ä¸ªç³»ç»Ÿåˆ°å¤„éƒ½æ”¹ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥å‡å°‘æ”¹åŠ¨èŒƒå›´ï¼Œé™ä½æ”¹åŠ¨é£é™©ã€‚</p><p>ä¸åŒçš„æ‹†åˆ†æ–¹å¼ï¼Œæœ¬è´¨ä¸Šå†³å®šäº†ç³»ç»Ÿçš„æ‰©å±•æ–¹å¼</p><h3 id="1-1-1-é¢å‘æµç¨‹æ‹†åˆ†-åˆ†å±‚æ¶æ„"><a href="#1-1-1-é¢å‘æµç¨‹æ‹†åˆ†-åˆ†å±‚æ¶æ„" class="headerlink" title="1.1.1 é¢å‘æµç¨‹æ‹†åˆ† - åˆ†å±‚æ¶æ„"></a>1.1.1 é¢å‘æµç¨‹æ‹†åˆ† - åˆ†å±‚æ¶æ„</h3><p>å°†æ•´ä¸ªä¸šåŠ¡æµç¨‹åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µä½œä¸ºä¸€éƒ¨åˆ†</p><p>æ‰©å±•æ—¶å¤§éƒ¨åˆ†æƒ…å†µåªéœ€è¦ä¿®æ”¹ä¸€å±‚ï¼Œæˆ–è€…ç›¸å…³è”çš„ä¸¤å±‚ï¼Œä¸ä¼šå‡ºç°æ‰€æœ‰å±‚éƒ½éœ€è¦ä¿®æ”¹çš„æƒ…å†µçš„ã€‚</p><h3 id="1-1-2-é¢å‘æœåŠ¡æ‹†åˆ†-SOAï¼Œå¾®æœåŠ¡"><a href="#1-1-2-é¢å‘æœåŠ¡æ‹†åˆ†-SOAï¼Œå¾®æœåŠ¡" class="headerlink" title="1.1.2 é¢å‘æœåŠ¡æ‹†åˆ† - SOAï¼Œå¾®æœåŠ¡"></a>1.1.2 é¢å‘æœåŠ¡æ‹†åˆ† - SOAï¼Œå¾®æœåŠ¡</h3><p>å°†ç³»ç»Ÿæä¾›çš„æœåŠ¡æ‹†åˆ†ï¼Œæ¯ä¸ªæœåŠ¡ä½œä¸ºä¸€éƒ¨åˆ†</p><p>æ‰©å±•æ—¶åªéœ€è¦æ‰©å±•ç›¸å…³æœåŠ¡å³å¯ã€‚</p><h3 id="1-1-3-é¢å‘åŠŸèƒ½æ‹†åˆ†-å¾®å†…æ ¸æ¶æ„"><a href="#1-1-3-é¢å‘åŠŸèƒ½æ‹†åˆ†-å¾®å†…æ ¸æ¶æ„" class="headerlink" title="1.1.3 é¢å‘åŠŸèƒ½æ‹†åˆ† - å¾®å†…æ ¸æ¶æ„"></a>1.1.3 é¢å‘åŠŸèƒ½æ‹†åˆ† - å¾®å†…æ ¸æ¶æ„</h3><p>å°†ç³»ç»Ÿæä¾›çš„åŠŸèƒ½æ‹†åˆ†ï¼Œæ¯ä¸ªåŠŸèƒ½ä½œä¸ºä¸€éƒ¨åˆ†</p><p>æ‰©å±•æ—¶åªéœ€è¦æ‰©å±•ç›¸å…³åŠŸèƒ½å³å¯</p><h1 id="2-åˆ†å±‚æ¶æ„"><a href="#2-åˆ†å±‚æ¶æ„" class="headerlink" title="2. åˆ†å±‚æ¶æ„"></a>2. åˆ†å±‚æ¶æ„</h1><p>Nå±‚æ¶æ„ï¼Œé€»è¾‘ä¸Šçš„åˆ†å±‚</p><h2 id="2-1-C-S-B-Sæ¶æ„"><a href="#2-1-C-S-B-Sæ¶æ„" class="headerlink" title="2.1 C/S, B/Sæ¶æ„"></a>2.1 C/S, B/Sæ¶æ„</h2><p>åˆ’åˆ†çš„å¯¹è±¡æ˜¯æ•´ä¸ªä¸šåŠ¡ç³»ç»Ÿï¼Œåˆ’åˆ†çš„ç»´åº¦æ˜¯ç”¨æˆ·äº¤äº’ï¼Œå°†å’Œç”¨æˆ·äº¤äº’çš„éƒ¨åˆ†ç‹¬ç«‹ä¸ºä¸€å±‚ï¼Œæ”¯æ’‘ç”¨æˆ·äº¤äº’çš„åå°ä½œä¸ºå¦å¤–ä¸€å±‚ã€‚ </p><h2 id="2-2-MVC-MVPæ¶æ„"><a href="#2-2-MVC-MVPæ¶æ„" class="headerlink" title="2.2 MVC, MVPæ¶æ„"></a>2.2 MVC, MVPæ¶æ„</h2><p>åˆ’åˆ†çš„å¯¹è±¡æ˜¯å•ä¸ªä¸šåŠ¡å­ç³»ç»Ÿï¼Œåˆ’åˆ†çš„ç»´åº¦æ˜¯èŒè´£ï¼Œå°†ä¸åŒçš„èŒè´£åˆ’åˆ†åˆ°ç‹¬ç«‹å±‚ï¼Œä½†å„å±‚çš„ä¾èµ–å…³ç³»ä¼šç›¸å¯¹æ¯”è¾ƒçµæ´»ã€‚</p><h2 id="2-3-é€»è¾‘åˆ†å±‚æ¶æ„"><a href="#2-3-é€»è¾‘åˆ†å±‚æ¶æ„" class="headerlink" title="2.3 é€»è¾‘åˆ†å±‚æ¶æ„"></a>2.3 é€»è¾‘åˆ†å±‚æ¶æ„</h2><p>åˆ’åˆ†çš„å¯¹è±¡å¯ä»¥æ˜¯å•ä¸ªä¸šåŠ¡å­ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯æ•´ä¸ªä¸šåŠ¡ç³»ç»Ÿï¼Œåˆ’åˆ†çš„ç»´åº¦ä¹Ÿæ˜¯èŒè´£ã€‚è™½ç„¶éƒ½æ˜¯åŸºäºèŒè´£åˆ’åˆ†ï¼Œä½†æ˜¯ä¸åŒç‚¹åœ¨äºé€»è¾‘åˆ†å±‚æ¶æ„ä¸­çš„å±‚æ˜¯è‡ªé¡¶å‘ä¸‹ä¾èµ–çš„ã€‚</p><h2 id="2-4-åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒ"><a href="#2-4-åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒ" class="headerlink" title="2.4 åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒ"></a>2.4 åˆ†å±‚æ¶æ„çš„æ ¸å¿ƒ</h2><p>ä¿è¯å„å±‚ä¹‹é—´çš„å·®å¼‚è¶³å¤Ÿæ¸…æ™°ï¼Œè¾¹ç•Œè¶³å¤Ÿæ˜æ˜¾ï¼Œè®©äººçœ‹åˆ°æ¶æ„å›¾ä¹‹åå°±èƒ½çœ‹æ‡‚æ•´ä¸ªæ¶æ„ã€‚</p><p>åˆ†å±‚æ¶æ„èƒ½å¤Ÿè¾ƒå¥½æ”¯æ’‘ç³»ç»Ÿæ‰©å±•çš„æœ¬è´¨åœ¨äº<strong>éš”ç¦»å…³æ³¨ç‚¹</strong>ï¼Œå³æ¯å±‚çš„ç»„ä»¶åªä¼šå¤„ç†æœ¬å±‚çš„é€»è¾‘ï¼Œè¿™æ ·å¯ä»¥æ”¯æ’‘ç³»ç»Ÿåœ¨æŸå±‚ä¸Šå¿«é€Ÿæ‰©å±•ã€‚</p><p>è¦ä¿è¯å±‚ä¸å±‚ä¹‹é—´çš„ä¾èµ–æ˜¯ç¨³å®šçš„ã€‚</p><p>åˆ†å±‚ç»“æ„çš„å¦å¤–ä¸€ä¸ªç‰¹ç‚¹æ˜¯å±‚å±‚ä¼ é€’ï¼Œå³ä¸€æ—¦åˆ†å±‚ç¡®å®šï¼Œæ•´ä¸ªä¸šåŠ¡æµç¨‹å°±ä¼šæŒ‰ç…§å±‚è¿›è¡Œä¾æ¬¡ä¼ é€’ï¼Œä¸èƒ½åœ¨å±‚ä¹‹é—´è¿›è¡Œè·³è·ƒã€‚</p><h1 id="3-SOA-amp-å¾®æœåŠ¡"><a href="#3-SOA-amp-å¾®æœåŠ¡" class="headerlink" title="3. SOA &amp; å¾®æœåŠ¡"></a>3. SOA &amp; å¾®æœåŠ¡</h1><h2 id="3-1-SOA-Service-Oriented-Architecture-é¢å‘æœåŠ¡çš„æ¶æ„"><a href="#3-1-SOA-Service-Oriented-Architecture-é¢å‘æœåŠ¡çš„æ¶æ„" class="headerlink" title="3.1 SOA - Service Oriented Architecture - é¢å‘æœåŠ¡çš„æ¶æ„"></a>3.1 SOA - Service Oriented Architecture - é¢å‘æœåŠ¡çš„æ¶æ„</h2><p>æå‡ºçš„èƒŒæ™¯æ˜¯ä¼ä¸šå†…éƒ¨çš„ITç³»ç»Ÿé‡å¤å»ºè®¾å¹¶ä¸”æ•ˆç‡æä½çš„é—®é¢˜ï¼ŒSOAæå‡ºäº†å‡ ä¸ªå…³é”®æ¦‚å¿µ</p><h3 id="3-1-1-æœåŠ¡"><a href="#3-1-1-æœåŠ¡" class="headerlink" title="3.1.1 æœåŠ¡"></a>3.1.1 æœåŠ¡</h3><p>æ‰€æœ‰ä¸šåŠ¡åŠŸèƒ½éƒ½æ˜¯ä¸€é¡¹æœåŠ¡ï¼Œæ„å‘³ç€è¦å¯¹å¤–æä¾›å¼€æ”¾çš„èƒ½åŠ›ï¼Œå½“å…¶ä»–ç³»ç»Ÿéœ€è¦ä½¿ç”¨è¿™é¡¹åŠŸèƒ½æ—¶ï¼Œä¸éœ€è¦åšå®šåˆ¶åŒ–å¼€å‘ã€‚</p><h3 id="3-1-2-ESB"><a href="#3-1-2-ESB" class="headerlink" title="3.1.2 ESB"></a>3.1.2 ESB</h3><p>Enterprise Service Bus - ä¼ä¸šæœåŠ¡æ€»çº¿. å±è”½å¼‚æ„ç³»ç»Ÿå¯¹å¤–æä¾›å„ç§ä¸åŒçš„æ¥å£æ–¹å¼ï¼Œä»¥æ­¤è¾¾åˆ°æœåŠ¡é—´é«˜æ•ˆçš„äº’è”äº’é€šã€‚</p><p>ESBåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯ç°å®ä¸­çš„åè®®ç§ç±»å¾ˆå¤šï¼Œå¦‚JMSï¼ŒWSï¼ŒHTTPï¼ŒRPCç­‰ï¼Œæ•°æ®æ ¼å¼ä¹Ÿå¤šç§å¤šæ ·ï¼Œè½¬æ¢çš„è¿‡ç¨‹æ˜¯éœ€è¦è€—è´¹å¤§é‡è®¡ç®—æ€§èƒ½çš„ï¼Œå½“ESBæ‰¿è½½çš„æ¶ˆæ¯å¤ªå¤šæ—¶ï¼ŒESBæœ¬èº«ä¼šæˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚</p><h3 id="3-1-3-æ¾è€¦åˆ"><a href="#3-1-3-æ¾è€¦åˆ" class="headerlink" title="3.1.3 æ¾è€¦åˆ"></a>3.1.3 æ¾è€¦åˆ</h3><p>å‡å°‘å„ä¸ªæœåŠ¡é—´çš„ä¾èµ–å’Œäº’ç›¸å½±å“ã€‚</p><h2 id="3-2-MicroService-å¾®æœåŠ¡"><a href="#3-2-MicroService-å¾®æœåŠ¡" class="headerlink" title="3.2 MicroService - å¾®æœåŠ¡"></a>3.2 MicroService - å¾®æœåŠ¡</h2><h3 id="3-2-1-å¾®æœåŠ¡ä¸SOAçš„å…³ç³»"><a href="#3-2-1-å¾®æœåŠ¡ä¸SOAçš„å…³ç³»" class="headerlink" title="3.2.1 å¾®æœåŠ¡ä¸SOAçš„å…³ç³»"></a>3.2.1 å¾®æœåŠ¡ä¸SOAçš„å…³ç³»</h3><p><img src="https://i.loli.net/2020/02/04/VgmIHRSsCUL2b6u.png" alt="fig1.png"></p><ul><li>å¾®æœåŠ¡ä¸SOAç›¸ä¼¼ä½†æ˜¯æœ¬è´¨ä¸Šå¹¶ä¸ç›¸åŒ<ul><li>æ˜¯å¦æœ‰ESB<ul><li>å¾®æœåŠ¡æ¨èä½¿ç”¨åŒä¸€çš„åè®®å’Œæ ¼å¼<ul><li>ä¾‹å¦‚RESTfulåè®®ï¼Œ RPCåè®® </li></ul></li></ul></li><li>æœåŠ¡çš„ç²’åº¦<ul><li>å¾®æœåŠ¡çš„æœåŠ¡ç²’åº¦ç›¸å¯¹è¾ƒç»† </li></ul></li><li>æœåŠ¡äº¤ä»˜<ul><li>å¾®æœåŠ¡æ¶æ„ç†å¿µæ˜¯å¿«é€Ÿäº¤ä»˜ï¼Œç›¸åº”çš„å°±è¦æ±‚é‡‡å–è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ŒæŒç»­é›†æˆï¼Œè‡ªåŠ¨åŒ–éƒ¨ç½²ç­‰æ•æ·å¼€å‘ç›¸å…³çš„æœ€ä½³å®è·µã€‚ </li></ul></li><li>åº”ç”¨åœºæ™¯<ul><li>SOAæ›´é€‚åˆäºåºå¤§ã€å¤æ‚ã€å¼‚æ„çš„ä¼ä¸šåŒ–ç³»ç»Ÿ</li><li>å¾®æœåŠ¡æ›´é€‚åˆäºå¿«é€Ÿï¼Œè½»é‡çº§ï¼ŒåŸºäºWebçš„äº’è”ç½‘ç³»ç»Ÿ</li></ul></li></ul></li></ul><h3 id="3-2-2-å¾®æœåŠ¡çš„é™·é˜±"><a href="#3-2-2-å¾®æœåŠ¡çš„é™·é˜±" class="headerlink" title="3.2.2 å¾®æœåŠ¡çš„é™·é˜±"></a>3.2.2 å¾®æœåŠ¡çš„é™·é˜±</h3><ul><li>æœåŠ¡åˆ’åˆ†è¿‡ç»†ï¼ŒæœåŠ¡é—´å…³ç³»å¤æ‚</li><li>æœåŠ¡æ•°é‡å¤ªå¤šï¼Œå›¢é˜Ÿæ•ˆç‡æ€¥å‰§ä¸‹é™</li><li>è°ƒç”¨é“¾å¤ªé•¿ï¼Œæ€§èƒ½ä¸‹é™<ul><li>ä¸€èˆ¬çº¿ä¸Šçš„ä¸šåŠ¡æ¥å£ä¹‹é—´çš„è°ƒç”¨ï¼Œå¹³å‡å“åº”æ—¶é—´å¤§çº¦ä¸º50æ¯«ç§’</li></ul></li><li>è°ƒç”¨é“¾å¤ªé•¿ï¼Œé—®é¢˜å®šä½å›°éš¾</li><li>éœ€è¦è‡ªåŠ¨åŒ–çš„æ”¯æ’‘ä»¥å®ç°å¿«é€Ÿäº¤ä»˜</li></ul><h1 id="4-å¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ"><a href="#4-å¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ" class="headerlink" title="4. å¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ"></a>4. å¾®æœåŠ¡æ¶æ„æœ€ä½³å®è·µ</h1><h2 id="4-1-æ–¹æ³•è®º"><a href="#4-1-æ–¹æ³•è®º" class="headerlink" title="4.1 æ–¹æ³•è®º"></a>4.1 æ–¹æ³•è®º</h2><h3 id="4-1-1-äººå‘˜åˆ†é…"><a href="#4-1-1-äººå‘˜åˆ†é…" class="headerlink" title="4.1.1 äººå‘˜åˆ†é…"></a>4.1.1 äººå‘˜åˆ†é…</h3><ul><li>3ä¸ªäººè´Ÿè´£ä¸€ä¸ªå¾®æœåŠ¡</li></ul><h3 id="4-1-2-æ‹†åˆ†é€»è¾‘çš„æ–¹æ³•"><a href="#4-1-2-æ‹†åˆ†é€»è¾‘çš„æ–¹æ³•" class="headerlink" title="4.1.2 æ‹†åˆ†é€»è¾‘çš„æ–¹æ³•"></a>4.1.2 æ‹†åˆ†é€»è¾‘çš„æ–¹æ³•</h3><ul><li>åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†<ul><li>å°†ä¸šåŠ¡æ¨¡å—æŒ‰ç…§èŒè´£èŒƒå›´è¯†åˆ«å‡ºæ¥ï¼Œæ¯ä¸ªå•ç‹¬çš„ä¸šåŠ¡æ¨¡å—æ‹†åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡</li><li>æ‹†åˆ†ç²’åº¦çš„è€ƒè™‘ - çœ‹äººæ•°æœ€å¥½ </li></ul></li><li>åŸºäºå¯æ‰©å±•æ‹†åˆ†<ul><li>å°†ç³»ç»Ÿä¸­çš„ä¸šåŠ¡æ¨¡å—æŒ‰ç…§ç¨³å®šæ€§æ’åº<ul><li>ç¨³å®šæœåŠ¡</li><li>å˜åŠ¨æœåŠ¡</li></ul></li><li>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æå‡é¡¹ç›®å¿«é€Ÿè¿­ä»£çš„æ•ˆç‡ï¼Œé¿å…åœ¨å¼€å‘çš„æ—¶å€™ï¼Œä¸å°å¿ƒå½±å“äº†å·²æœ‰çš„æˆç†ŸåŠŸèƒ½å¯¼è‡´çº¿ä¸Šçš„é—®é¢˜ã€‚</li></ul></li><li>åŸºäºå¯é æ€§æ‹†åˆ†<ul><li>å°†ä¸šåŠ¡æ¨¡å—æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºæ’åºï¼Œå°†å¯é æ€§è¦æ±‚é«˜çš„æ ¸å¿ƒæœåŠ¡å’Œå¯é æ€§è¦æ±‚ä½çš„éæ ¸å¿ƒæœåŠ¡æ‹†åˆ†ï¼Œç„¶åé‡ç‚¹ä¿è¯æ ¸å¿ƒæœåŠ¡çš„é«˜å¯ç”¨</li></ul></li><li>åŸºäºæ€§èƒ½æ‹†åˆ†<ul><li>å°†æ€§èƒ½è¦æ±‚é«˜æˆ–è€…æ€§èƒ½å‹åŠ›å¤§çš„æ¨¡å—æ‹†åˆ†å‡ºæ¥ï¼Œé¿å…å½±å“å…¶ä»–æœåŠ¡å™¨<h2 id="4-2-åŸºç¡€è®¾æ–½"><a href="#4-2-åŸºç¡€è®¾æ–½" class="headerlink" title="4.2 åŸºç¡€è®¾æ–½"></a>4.2 åŸºç¡€è®¾æ–½</h2></li></ul></li></ul><p><img src="https://i.loli.net/2020/02/04/wVulTOvkeKRjpH4.jpg" alt="fig2.jpg"></p><ul><li>æœåŠ¡å‘ç°ã€æœåŠ¡è·¯ç”±ã€æœåŠ¡å®¹é”™</li><li>æ¥å£æ¡†æ¶ã€APIç½‘å…³</li><li>è‡ªåŠ¨åŒ–éƒ¨ç½²ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€é…ç½®ä¸­å¿ƒ</li><li>æœåŠ¡ç›‘æ§ã€æœåŠ¡è·Ÿè¸ªã€æœåŠ¡å®‰å…¨</li></ul><h3 id="4-2-1-è‡ªåŠ¨åŒ–æµ‹è¯•"><a href="#4-2-1-è‡ªåŠ¨åŒ–æµ‹è¯•" class="headerlink" title="4.2.1 è‡ªåŠ¨åŒ–æµ‹è¯•"></a>4.2.1 è‡ªåŠ¨åŒ–æµ‹è¯•</h3><ul><li>ä»£ç çº§çš„å•å…ƒæµ‹è¯•</li><li>å•ä¸ªç³»ç»Ÿçº§çš„é›†æˆæµ‹è¯•</li><li>ç³»ç»Ÿé—´çš„æ¥å£æµ‹è¯•</li></ul><h3 id="4-2-2-è‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#4-2-2-è‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="4.2.2 è‡ªåŠ¨åŒ–éƒ¨ç½²"></a>4.2.2 è‡ªåŠ¨åŒ–éƒ¨ç½²</h3><ul><li>ç‰ˆæœ¬ç®¡ç†</li><li>èµ„æºç®¡ç†</li><li>éƒ¨ç½²æ“ä½œ</li><li>å›é€€æ“ä½œ</li></ul><h3 id="4-2-3-é…ç½®ä¸­å¿ƒ"><a href="#4-2-3-é…ç½®ä¸­å¿ƒ" class="headerlink" title="4.2.3 é…ç½®ä¸­å¿ƒ"></a>4.2.3 é…ç½®ä¸­å¿ƒ</h3><ul><li>ç»Ÿä¸€çš„é…ç½®ä¸­å¿ƒæ¥ç®¡ç†æ‰€æœ‰å¾®æœåŠ¡èŠ‚ç‚¹çš„é…ç½®</li><li>é…ç½®ä¸­å¿ƒåŒ…æ‹¬<ul><li>ç‰ˆæœ¬ç®¡ç†</li><li>å¢åˆ æ”¹æŸ¥é…ç½®</li><li>ç»“ç‚¹ç®¡ç†</li><li>é…ç½®åŒæ­¥</li><li>é…ç½®æ¨é€</li></ul></li></ul><h3 id="4-2-4-æ¥å£æ¡†æ¶"><a href="#4-2-4-æ¥å£æ¡†æ¶" class="headerlink" title="4.2.4 æ¥å£æ¡†æ¶"></a>4.2.4 æ¥å£æ¡†æ¶</h3><p>é™¤äº†ç»Ÿä¸€æ¥å£åè®®ï¼Œè¿˜è¦ç»Ÿä¸€æ¥å£ä¼ é€’çš„æ•°æ®æ ¼å¼</p><h3 id="4-2-5-APIç½‘å…³"><a href="#4-2-5-APIç½‘å…³" class="headerlink" title="4.2.5 APIç½‘å…³"></a>4.2.5 APIç½‘å…³</h3><p>å†…éƒ¨å¾®æœåŠ¡æ˜¯ç›¸äº’è¿é€šçš„ï¼Œç›¸äº’è®¿é—®éƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„ã€‚å¦‚æœå¤–éƒ¨ç³»ç»Ÿæƒ³è°ƒç”¨ç³»ç»Ÿçš„æŸä¸ªåŠŸèƒ½ï¼Œä¹Ÿé‡‡å–ç‚¹å¯¹ç‚¹çš„æ–¹å¼ï¼Œé‚£ä¹ˆå¤–éƒ¨ç³»ç»Ÿä¼šå¾ˆå´©ï¼Œå› ä¸ºå…¶æ— æ³•ç†è§£è¿™ä¹ˆå¤šå¾®æœåŠ¡çš„èŒè´£åˆ†å·¥å’Œè¾¹ç•Œï¼Œå®ƒåªä¼šå…³æ³¨å…¶æ‰€éœ€è¦çš„èƒ½åŠ›ï¼Œè€Œä¸ä¼šå…³æ³¨è¿™ä¸ªèƒ½åŠ›åº”è¯¥ç”±å“ªä¸ªå¾®æœåŠ¡æä¾›ã€‚</p><p>====ã€‹ å¾®æœåŠ¡éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„APIç½‘å…³ï¼Œè´Ÿè´£å¤–éƒ¨ç³»ç»Ÿçš„è®¿é—®æ“ä½œ</p><p>APIç½‘å…³æ˜¯å¤–éƒ¨ç³»ç»Ÿè®¿é—®çš„æ¥å£ï¼Œæ‰€æœ‰çš„å¤–éƒ¨ç³»ç»Ÿæ¥å…¥ç³»ç»Ÿéƒ½éœ€è¦é€šè¿‡APIç½‘å…³ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>æ¥å…¥é‰´æƒ - æ˜¯å¦å…è®¸æ¥å…¥</li><li>æƒé™æ§åˆ¶ - å¯ä»¥è®¿é—®å“ªäº›åŠŸèƒ½</li><li>ä¼ è¾“åŠ å¯† </li><li>è¯·æ±‚è·¯ç”±</li><li>æµé‡æ§åˆ¶</li></ul><h3 id="4-2-6-æœåŠ¡å‘ç°"><a href="#4-2-6-æœåŠ¡å‘ç°" class="headerlink" title="4.2.6 æœåŠ¡å‘ç°"></a>4.2.6 æœåŠ¡å‘ç°</h3><ul><li>è‡ªç†å¼ç»“æ„<ul><li>æ¯ä¸ªå¾®æœåŠ¡è‡ªå·±å®ŒæˆæœåŠ¡å‘ç°</li></ul></li><li>ä»£ç†å¼<ul><li>å¾®æœåŠ¡ä¹‹é—´æœ‰ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼Œæœ‰è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ¥å®Œæˆå¾®æœåŠ¡ä¹‹é—´çš„æœåŠ¡å‘ç° </li></ul></li></ul><p><img src="https://i.loli.net/2020/02/04/PWs5h1L2EFHizZn.png" alt="fig3.png"></p><p><img src="https://i.loli.net/2020/02/04/hmHp54yirJAWPgQ.png" alt="fig4.png"></p><h3 id="4-2-7-æœåŠ¡å®¹é”™"><a href="#4-2-7-æœåŠ¡å®¹é”™" class="headerlink" title="4.2.7 æœåŠ¡å®¹é”™"></a>4.2.7 æœåŠ¡å®¹é”™</h3><ul><li>è¯·æ±‚é‡è¯•</li><li>æµé‡æ§åˆ¶</li><li>æœåŠ¡éš”ç¦»</li></ul><h3 id="4-2-8-æœåŠ¡ç›‘æ§"><a href="#4-2-8-æœåŠ¡ç›‘æ§" class="headerlink" title="4.2.8 æœåŠ¡ç›‘æ§"></a>4.2.8 æœåŠ¡ç›‘æ§</h3><ul><li>å®æ—¶æœé›†ä¿¡æ¯å¹¶è¿›è¡Œåˆ†æï¼Œé¿å…æ•…éšœåå†æ¥åˆ†æï¼Œå‡å°‘äº†å¤„ç†æ—¶é—´</li><li>åœ¨å®æ—¶åˆ†æçš„åŸºç¡€ä¸Šè¿›è¡Œé¢„è­¦ï¼Œåœ¨é—®é¢˜èŒèŠ½çš„é˜¶æ®µå‘è§‰å¹¶é¢„è­¦ï¼Œé™ä½é—®é¢˜çš„å½±å“èŒƒå›´å’Œå½±å“æ—¶é—´</li></ul><h3 id="4-2-9-æœåŠ¡è·Ÿè¸ª"><a href="#4-2-9-æœåŠ¡è·Ÿè¸ª" class="headerlink" title="4.2.9 æœåŠ¡è·Ÿè¸ª"></a>4.2.9 æœåŠ¡è·Ÿè¸ª</h3><p>å¯¹äºå•ä¸ªè¯·æ±‚çš„å®Œæ•´è·Ÿè¸ªï¼Œè®°å½•å•ä¸ªè¯·æ±‚çš„å‘èµ·æ—¶é—´ï¼Œå“åº”æ—¶é—´ï¼Œå“åº”é”™è¯¯ç ï¼Œè¯·æ±‚å‚æ•°ï¼Œè¿”å›çš„JSONå¯¹è±¡ç­‰ä¿¡æ¯ã€‚</p><h3 id="4-2-10-æœåŠ¡å®‰å…¨"><a href="#4-2-10-æœåŠ¡å®‰å…¨" class="headerlink" title="4.2.10 æœåŠ¡å®‰å…¨"></a>4.2.10 æœåŠ¡å®‰å…¨</h3><ul><li>æ¥å…¥å®‰å…¨</li><li>æ•°æ®å®‰å…¨</li><li>ä¼ è¾“å®‰å…¨</li></ul><h1 id="5-å¾®å†…æ ¸æ¶æ„"><a href="#5-å¾®å†…æ ¸æ¶æ„" class="headerlink" title="5. å¾®å†…æ ¸æ¶æ„"></a>5. å¾®å†…æ ¸æ¶æ„</h1><p>ä¹Ÿè¢«ç§°ä¸ºæ’ä»¶åŒ–æ¶æ„(Plug-in Architecture), æ˜¯ä¸€ç§é¢å‘åŠŸèƒ½è¿›è¡Œæ‹†åˆ†çš„å¯æ‰©å±•æ€§æ¶æ„ã€‚</p><h2 id="5-1-åŸºæœ¬æ¶æ„"><a href="#5-1-åŸºæœ¬æ¶æ„" class="headerlink" title="5.1 åŸºæœ¬æ¶æ„"></a>5.1 åŸºæœ¬æ¶æ„</h2><ul><li>æ ¸å¿ƒç³»ç»Ÿ<ul><li>è´Ÿè´£å’Œå…·ä½“ä¸šåŠ¡åŠŸèƒ½æ— å…³çš„é€šç”¨åŠŸèƒ½ï¼Œä¾‹å¦‚æ¨¡å—åŠ è½½ï¼Œæ¨¡å—é—´é€šä¿¡ </li></ul></li><li>æ’ä»¶æ¨¡å—<ul><li>è´Ÿè´£å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/04/kz3Wg4ehDEc2xqv.png" alt="fig5.png"></p><p>å¾®å†…æ ¸æ¶æ„æœ¬è´¨å°±æ˜¯å°†å˜åŒ–çš„éƒ¨åˆ†å°è£…åœ¨æ’ä»¶é‡Œé¢ï¼Œä»è€Œè¾¾åˆ°å¿«é€Ÿçµæ´»æ‰©å±•çš„ç›®çš„ï¼Œè€Œåˆä¸ä¼šå½±å“æ•´ä½“ç³»ç»Ÿçš„ç¨³å®šã€‚</p><h2 id="5-2-è®¾è®¡å…³é”®ç‚¹"><a href="#5-2-è®¾è®¡å…³é”®ç‚¹" class="headerlink" title="5.2 è®¾è®¡å…³é”®ç‚¹"></a>5.2 è®¾è®¡å…³é”®ç‚¹</h2><h3 id="5-2-1-æ’ä»¶ç®¡ç†"><a href="#5-2-1-æ’ä»¶ç®¡ç†" class="headerlink" title="5.2.1 æ’ä»¶ç®¡ç†"></a>5.2.1 æ’ä»¶ç®¡ç†</h3><p>é€šè¿‡æ’ä»¶æ³¨å†Œè¡¨ï¼Œæ¥çŸ¥é“å½“å‰æœ‰å“ªäº›æ’ä»¶ï¼Œå¦‚ä½•åŠ è½½ä»¥åŠä½•æ—¶åŠ è½½ã€‚æ’ä»¶æ³¨å†Œè¡¨å«æœ‰æ¯ä¸ªæ’ä»¶æ¨¡å—çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶åå­—ï¼Œä½ç½®ï¼ŒåŠ è½½æ—¶æœºç­‰ã€‚</p><h3 id="5-2-2-æ’ä»¶è¿æ¥"><a href="#5-2-2-æ’ä»¶è¿æ¥" class="headerlink" title="5.2.2 æ’ä»¶è¿æ¥"></a>5.2.2 æ’ä»¶è¿æ¥</h3><p>æ’ä»¶æ˜¯å¦‚ä½•è¿æ¥åˆ°æ ¸å¿ƒç³»ç»Ÿçš„ã€‚</p><p>å¸¸è§è¿æ¥æœºåˆ¶ï¼š</p><ul><li>OSGi </li><li>æ¶ˆæ¯æ¨¡å¼</li><li>ä¾èµ–æ³¨å…¥</li><li>åˆ†å¸ƒå¼åè®®  RPCï¼Œ HTTP</li></ul><h3 id="5-2-3-æ’ä»¶é€šä¿¡"><a href="#5-2-3-æ’ä»¶é€šä¿¡" class="headerlink" title="5.2.3 æ’ä»¶é€šä¿¡"></a>5.2.3 æ’ä»¶é€šä¿¡</h3><p>å®é™…åº”ç”¨å½“ä¸­ä¼šå‡ºç°æŸä¸ªä¸šåŠ¡æµç¨‹éœ€è¦å¤šä¸ªæ’ä»¶åä½œï¼Œè¿™å°±è¦æ±‚ä¸¤ä¸ªæ’ä»¶ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ç”±äºæ’ä»¶ä¹‹é—´æ²¡æœ‰ç›´æ¥çš„è”ç³»ï¼Œé€šä¿¡å¿…é¡»é€šè¿‡æ ¸å¿ƒç³»ç»Ÿï¼Œå› æ­¤æ ¸å¿ƒç³»ç»Ÿéœ€è¦æä¾›æ’ä»¶é€šä¿¡æœºåˆ¶ã€‚</p><h2 id="5-3-OSGiæ¡†æ¶"><a href="#5-3-OSGiæ¡†æ¶" class="headerlink" title="5.3 OSGiæ¡†æ¶"></a>5.3 OSGiæ¡†æ¶</h2><p><img src="https://i.loli.net/2020/02/04/QBtP6Gqxea5bV1Z.png" alt="fig6.png"></p><p>è¯¥æ¡†æ¶ä¸ºé€šè¿‡ç½‘ç»œå‘è®¾å¤‡æä¾›æœåŠ¡å»ºç«‹å¼€å‘çš„æ ‡å‡†ã€‚è¯¥æ¡†æ¶çš„åˆå§‹ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªåœ¨å¹¿åŸŸç½‘å’Œå±€åŸŸç½‘æˆ–è®¾å¤‡ä¸Šå±•å¼€ä¸šåŠ¡çš„åŸºç¡€å¹³å°ï¼Œä½†å› ä¸ºå…¶çš„åŠ¨æ€åŒ–ï¼Œçƒ­æ‹”æ’ï¼Œé«˜å¯å¤ç”¨æ€§çš„ç‰¹ç‚¹ï¼Œæˆä¸ºäº†é¦–é€‰çš„æ’ä»¶åŒ–æ ‡å‡†ã€‚</p><h3 id="5-3-1-æ¨¡å—å±‚-Module"><a href="#5-3-1-æ¨¡å—å±‚-Module" class="headerlink" title="5.3.1 æ¨¡å—å±‚ (Module)"></a>5.3.1 æ¨¡å—å±‚ (Module)</h3><p>æ¨¡å—å±‚å®ç°æ’ä»¶ç®¡ç†åŠŸèƒ½ï¼Œæ’ä»¶è¢«ç§°ä¸ºBundleï¼Œæ¯ä¸ªBundleæ˜¯ä¸€ä¸ªJavaçš„JARæ–‡ä»¶ã€‚æ¨¡å—å±‚é‡Œå«æœ‰æ‰€æœ‰çš„æ’ä»¶ã€‚</p><h3 id="5-3-2-ç”Ÿå‘½å‘¨æœŸå±‚-Lifecycle"><a href="#5-3-2-ç”Ÿå‘½å‘¨æœŸå±‚-Lifecycle" class="headerlink" title="5.3.2 ç”Ÿå‘½å‘¨æœŸå±‚ (Lifecycle)"></a>5.3.2 ç”Ÿå‘½å‘¨æœŸå±‚ (Lifecycle)</h3><p>å®ç°æ’ä»¶è¿æ¥åŠŸèƒ½ï¼Œæä¾›äº†æ‰§è¡Œæ—¶çš„æ¨¡å—ç®¡ç†ï¼Œæ¨¡å—å¯¹åº•å±‚OSGiæ¡†æ¶çš„è®¿é—®ã€‚ç”Ÿå‘½å‘¨æœŸå±‚ç²¾ç¡®å®šä¹‰äº†Bundleç”Ÿå‘½å‘¨æœŸçš„æ“ä½œ(å®‰è£…ã€æ›´æ–°ã€å¯åŠ¨ã€åœæ­¢ã€å¸è½½)ï¼ŒBundleå¿…é¡»æŒ‰ç…§è§„èŒƒå®ç°å„ä¸ªæ“ä½œã€‚</p><h3 id="5-3-3-æœåŠ¡å±‚-Service"><a href="#5-3-3-æœåŠ¡å±‚-Service" class="headerlink" title="5.3.3 æœåŠ¡å±‚ (Service)"></a>5.3.3 æœåŠ¡å±‚ (Service)</h3><p>æœåŠ¡å±‚å®ç°æ’ä»¶é€šä¿¡çš„åŠŸèƒ½ã€‚OSGiæä¾›äº†ä¸€ä¸ªæœåŠ¡æ³¨å†Œçš„åŠŸèƒ½ï¼Œç”¨äºæ’ä»¶å°†è‡ªå·±èƒ½æä¾›çš„æœåŠ¡æ³¨å†Œåˆ°OSGiæ ¸å¿ƒçš„æœåŠ¡æ³¨å†Œä¸­å¿ƒå½“ä¸­ï¼Œå¦‚æœæŸä¸ªæœåŠ¡æƒ³ç”¨å…¶ä»–æœåŠ¡ï¼Œåˆ™ç›´æ¥åœ¨æœåŠ¡æ³¨å†Œä¸­å¿ƒæœç´¢å¯ç”¨æœåŠ¡ä¸­å¿ƒå³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -åŸåˆ™</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8E%9F%E5%88%99/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>ç¨‹åºå‘˜å’Œæ¶æ„å¸ˆä¹‹é—´çš„åŒºåˆ«ï¼šå¦‚ä½•å¤„ç†ä¸ç¡®å®šæ€§çš„ã€‚å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œç¼–ç¨‹æœ¬èº«ä¸èƒ½å­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œæ‰§è¡Œç»“æœéœ€è¦æ˜¯ç¡®å®šçš„ã€‚ä½†æ˜¯å¯¹äºæ¶æ„è®¾è®¡æ¥è¯´ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ç¡®å®šçš„ï¼ŒåŒæ ·çš„ä¸€ä¸ªç³»ç»Ÿï¼Œå¯èƒ½ABä¸¤å®¶å…¬å¸åšå‡ºçš„æ¶æ„å·®å¼‚å¾ˆå¤§ï¼Œä½†æ˜¯éƒ½èƒ½æ­£ç¡®è¿è½¬ã€‚<strong>æ¶æ„è®¾è®¡å¸¸å¸¸é¢å¯¹å¤šç§å¯èƒ½æ€§æ¥è¿›è¡Œé€‰æ‹©</strong>ã€‚</p><p>å¤ªå¤šçš„é€‰æ‹©ï¼Œéœ€è¦ä¸€äº›æ¡†æ¶æ¥æ›´å¥½çš„åšå‡ºå†³å®šã€‚</p><h1 id="1-åˆé€‚åŸåˆ™-åˆé€‚ä¼˜äºä¸šç•Œé¢†å…ˆ"><a href="#1-åˆé€‚åŸåˆ™-åˆé€‚ä¼˜äºä¸šç•Œé¢†å…ˆ" class="headerlink" title="1. åˆé€‚åŸåˆ™ - åˆé€‚ä¼˜äºä¸šç•Œé¢†å…ˆ"></a>1. åˆé€‚åŸåˆ™ - åˆé€‚ä¼˜äºä¸šç•Œé¢†å…ˆ</h1><p>éœ€ä¸éœ€è¦ï¼Ÿæœ‰æ²¡æœ‰é‚£ä¹ˆå¤šäººåŠ›ï¼Ÿæœ‰æ²¡æœ‰è¶³å¤Ÿçš„åº”ç”¨åœºæ™¯ï¼Ÿ </p><h1 id="2-ç®€å•åŸåˆ™"><a href="#2-ç®€å•åŸåˆ™" class="headerlink" title="2. ç®€å•åŸåˆ™"></a>2. ç®€å•åŸåˆ™</h1><p>ç®€å•ä¼˜äºå¤æ‚çš„ï¼Œå¤æ‚åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸâ€œå¯èƒ½â€æ„å‘³ç€é—®é¢˜ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦æŒç»­åœ¨ä¸Šé¢æ”¹è¿›çš„ã€‚</p><ul><li>å¤æ‚æ€§ä½“ç°åœ¨<ul><li>ç»“æ„çš„å¤æ‚æ€§<ul><li>ç»„ä»¶æ•°é‡å¤š</li><li>ç»„ä»¶ä¹‹é—´çš„å…³ç³»æ›´ä¸ºå¤æ‚</li><li>æŸä¸ªç»„ä»¶çš„æ”¹åŠ¨ï¼Œä¼šå½±å“å…³è”çš„æ‰€æœ‰ç»„ä»¶</li><li>å®šä½ä¸€ä¸ªå¤æ‚ç³»ç»Ÿå½“ä¸­çš„é—®é¢˜æ€»æ˜¯æ¯”ç®€å•ç³»ç»Ÿçš„æ›´åŠ å›°éš¾</li></ul></li><li>é€»è¾‘çš„å¤æ‚æ€§<ul><li>ä¸€ä¸ªç»„ä»¶æ‰¿æ‹…å¤ªå¤šåŠŸèƒ½ä¼šå¯¹å¼€å‘ç»´æŠ¤éƒ½é€ æˆå¾ˆå¤§çš„å›°æ‰°</li><li></li></ul></li></ul></li></ul><h1 id="3-æ¼”åŒ–åŸåˆ™"><a href="#3-æ¼”åŒ–åŸåˆ™" class="headerlink" title="3. æ¼”åŒ–åŸåˆ™"></a>3. æ¼”åŒ–åŸåˆ™</h1><p>æ¼”åŒ–ä¼˜äºä¸€æ­¥åˆ°ä½ï¼Œå› ä¸ºè½¯ä»¶çš„æ›´æ–°ï¼Œæ¶æ„çš„å˜åŒ–éå¸¸å¿«ã€‚è½¯ä»¶çš„æ¶æ„éœ€è¦æ ¹æ®ä¸šåŠ¡çš„å‘å±•ä¸æ–­å˜åŒ–ã€‚</p><ul><li>è®¾è®¡å‡ºæ¥çš„æ¶æ„è¦æ»¡è¶³å½“æ—¶çš„ä¸šåŠ¡éœ€è¦</li><li>æ¶æ„è¦ä¸æ–­åœ°åœ¨å®é™…åº”ç”¨è¿‡ç¨‹å½“ä¸­è¿­ä»£ï¼Œä¿ç•™ä¼˜ç§€çš„è®¾è®¡ï¼Œä¿®å¤æœ‰ç¼ºé™·çš„è®¾è®¡ï¼Œé€æ¸å®Œå–„æ¶æ„</li><li>å½“ä¸šåŠ¡å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ¶æ„è¦æ‰©å±•ï¼Œé‡æ„ç”šè‡³é‡å†™</li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„å­¦ä¹ -general</title>
      <link href="/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-general/"/>
      <url>/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0-general/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ¶æ„Intro"><a href="#1-æ¶æ„Intro" class="headerlink" title="1. æ¶æ„Intro"></a>1. æ¶æ„Intro</h1><ul><li>æ¶æ„è®¾è®¡çš„å…³é”®æ€ç»´æ˜¯<strong>åˆ¤æ–­å’Œå–èˆ</strong>ï¼Œç¨‹åºè®¾è®¡çš„å…³é”®æ€ç»´æ˜¯<strong>é€»è¾‘å’Œå®ç°</strong>ã€‚</li></ul><h2 id="1-1-æ¶æ„ä¸–ç•Œçš„å†å²èƒŒæ™¯"><a href="#1-1-æ¶æ„ä¸–ç•Œçš„å†å²èƒŒæ™¯" class="headerlink" title="1.1 æ¶æ„ä¸–ç•Œçš„å†å²èƒŒæ™¯"></a>1.1 æ¶æ„ä¸–ç•Œçš„å†å²èƒŒæ™¯</h2><ul><li>æœºå™¨è¯­è¨€ <ul><li>01ä¹¦å†™</li><li>éš¾è¯»ï¼Œéš¾å†™ï¼Œéš¾æ”¹</li></ul></li><li>æ±‡ç¼–è¯­è¨€<ul><li>ç”¨åœ°å€ç¬¦å·æˆ–æ ‡å·ä»£æ›¿æŒ‡ä»¤æˆ–æ“ä½œæ•°çš„åœ°å€</li><li>é¢å‘æœºå™¨çš„è¯­è¨€ï¼Œä¸å¤Ÿå‹å¥½</li></ul></li><li>é«˜çº§è¯­è¨€<ul><li>Fortran å…¬å¼ç¿»è¯‘å™¨</li><li>LISP æšä¸¾å¤„ç†å™¨</li><li>Cobol é€šç”¨å•†ä¸šå¯¼å‘è¯­è¨€</li></ul></li></ul><h1 id="2-æ¦‚å¿µæ¢³ç†"><a href="#2-æ¦‚å¿µæ¢³ç†" class="headerlink" title="2. æ¦‚å¿µæ¢³ç†"></a>2. æ¦‚å¿µæ¢³ç†</h1><h2 id="2-1-ç³»ç»Ÿä¸å­ç³»ç»Ÿ"><a href="#2-1-ç³»ç»Ÿä¸å­ç³»ç»Ÿ" class="headerlink" title="2.1 ç³»ç»Ÿä¸å­ç³»ç»Ÿ"></a>2.1 ç³»ç»Ÿä¸å­ç³»ç»Ÿ</h2><blockquote><p>ç³»ç»Ÿæ³›æŒ‡ç”±ä¸€ç¾¤æœ‰å…³è”çš„ä¸ªä½“ç»„æˆï¼Œæ ¹æ®æŸç§è§„åˆ™è¿ä½œï¼Œèƒ½å®Œæˆä¸ªåˆ«å…ƒä»¶ä¸èƒ½å•ç‹¬å®Œæˆçš„å·¥ä½œçš„ç¾¤ä½“</p></blockquote><ul><li>ç³»ç»Ÿ<ul><li>å…³è”ï¼šç›¸äº’ä¹‹é—´æœ‰å…³è”</li><li>è§„åˆ™ï¼šæŒ‰ç…§æŒ‡å®šçš„è§„åˆ™è¿ä½œ</li><li>èƒ½åŠ›ï¼šäº§ç”Ÿäº†æ–°çš„ä¸ªä½“ä¸å…·å¤‡çš„èƒ½åŠ›</li></ul></li><li>å­ç³»ç»Ÿ<ul><li>æ›´å¤§ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†</li></ul></li></ul><p>åˆ’åˆ†ç³»ç»Ÿçš„æ—¶å€™ä¸€èˆ¬æ˜¯æŒ‰ç…§ä¸šåŠ¡ç³»ç»Ÿæ¥åˆ’åˆ†çš„ï¼Œå¯èƒ½ä¸€ä¸ªå­ç³»ç»Ÿé‡Œé¢ä¼šæœ‰æœåŠ¡å±‚ï¼Œæ•°æ®å±‚ï¼Œblabla. </p><h2 id="2-2-æ¨¡å—ä¸ç»„ä»¶"><a href="#2-2-æ¨¡å—ä¸ç»„ä»¶" class="headerlink" title="2.2 æ¨¡å—ä¸ç»„ä»¶"></a>2.2 æ¨¡å—ä¸ç»„ä»¶</h2><ul><li><p>æ¨¡å—</p><ul><li>äº’ç›¸æœ‰ç´§å¯†å…³è”çš„è½¯ä»¶ç»„ç»‡</li><li>ç¨‹åºå’Œæ•°æ®ç»“æ„ä¸¤éƒ¨åˆ†</li><li>æ¨¡å—ä½œä¸ºåˆæˆçš„å•ä½</li><li>æ¨¡å—çš„æ¥å£è¡¨è¾¾äº†ç”±è¯¥æ¨¡å—æä¾›çš„åŠŸèƒ½å’Œè°ƒç”¨å®ƒæ‰€éœ€çš„å…ƒç´ </li><li>æ¨¡å—æ˜¯å¯ä»¥åˆ†å¼€æ¥ç¼–å†™çš„å•ä½</li></ul></li><li><p>ç»„ä»¶</p><ul><li>è‡ªåŒ…å«çš„ï¼Œå¯ç¼–ç¨‹çš„ï¼Œå¯é‡ç”¨çš„ä¸è¯­è¨€æ— å…³çš„è½¯ä»¶å•å…ƒ</li></ul></li><li><p>Summary</p><ul><li>æ¨¡å—å’Œç»„ä»¶éƒ½æ˜¯ç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†ï¼Œåªæ˜¯ä»ä¸åŒè§’åº¦æ¥æ‹†åˆ†äº†ç³»ç»Ÿ</li><li>é€»è¾‘è§’åº¦æ‹†åˆ†ç³»ç»Ÿï¼Œå¾—åˆ°çš„å°±æ˜¯æ¨¡å—ï¼›åˆ’åˆ†æ¨¡å—çš„ä¸»è¦ç›®çš„æ˜¯èŒè´£åˆ†ç¦»</li><li>åˆ’åˆ†ç»„ä»¶çš„ä¸»è¦ç›®çš„æ˜¯å•å…ƒå¤ç”¨</li></ul></li><li><p>E.G</p><ul><li>ä¸€ä¸ªä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼Œé€»è¾‘è§’åº¦ï¼Œå¯ä»¥åˆ’åˆ†æˆç™»å½•æ³¨å†Œæ¨¡å—ï¼Œä¸ªäººä¿¡æ¯æ¨¡å—ï¼Œä¸ªäººæˆç»©æ¨¡å—</li><li>ç‰©ç†è§’åº¦ï¼ŒNginxï¼ŒWebæœåŠ¡å™¨ï¼ŒMysql</li></ul></li></ul><h2 id="2-3-æ¡†æ¶ä¸æ¶æ„"><a href="#2-3-æ¡†æ¶ä¸æ¶æ„" class="headerlink" title="2.3 æ¡†æ¶ä¸æ¶æ„"></a>2.3 æ¡†æ¶ä¸æ¶æ„</h2><ul><li>æ¡†æ¶<ul><li>ä¸ºäº†å®ç°æŸä¸ªä¸šç•Œæ ‡å‡†æˆ–å®Œæˆç‰¹å®šçš„åŸºæœ¬ä»»åŠ¡çš„è½¯ä»¶ç»„ä»¶è§„èŒƒï¼Œä¹ŸæŒ‡ä¸ºäº†å®ç°æŸä¸ªè½¯ä»¶ç»„ä»¶è§„èŒƒæ—¶ï¼Œæä¾›è§„èŒƒé”è¦æ±‚çš„åŸºç¡€åŠŸèƒ½çš„è½¯ä»¶äº§å“</li><li>æ¡†æ¶æ˜¯ç»„ä»¶è§„èŒƒ - MVC MVVM J2EE</li><li>æä¾›åŸºç¡€åŠŸèƒ½çš„äº§å“</li><li>é¢å‘ç¼–ç¨‹æˆ–é…ç½®çš„åŠæˆå“</li></ul></li></ul><blockquote><p>æ¶æ„æŒ‡è½¯ä»¶ç³»ç»Ÿçš„åŸºç¡€ç»“æ„ï¼Œåˆ›é€ è¿™äº›åŸºç¡€ç»“æ„çš„å‡†åˆ™ä»¥åŠå¯¹è¿™äº›ç»“æ„çš„æè¿°</p></blockquote><ul><li>è½¯ä»¶æ¶æ„æŒ‡è½¯ä»¶ç³»ç»Ÿçš„é¡¶å±‚ç»“æ„<ul><li>ç³»ç»Ÿæ˜¯ä¸€ç¾¤å…³è”ä¸ªä½“ç»„æˆï¼Œå¯ä»¥ä½¿å­ç³»ç»Ÿï¼Œæ¨¡å—ï¼Œç»„ä»¶ç­‰</li><li>ç³»ç»Ÿä¸­çš„ä¸ªä½“éœ€è¦æ ¹æ®æŸç§è§„åˆ™è¿ä½œ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å•å·¥å‚æ¨¡å¼</title>
      <link href="/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é™æ€/ç®€å•å·¥å‚æ¨¡å¼æ˜¯å·¥å‚æ¨¡å¼ä¸­æœ€ç®€å•çš„ä¸€ç§å®ç°ï¼Œä½†æ˜¯å®ƒå®ç°äº†å·¥å‚æ¨¡å¼çš„ç²¾é«“ï¼Œå³å°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»å¼€ï¼Œå®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨å·¥å‚æ¥åˆ›å»ºå…·ä½“çš„äº§å“ç±»ã€‚</p><h1 id="1-é—®é¢˜æè¿°"><a href="#1-é—®é¢˜æè¿°" class="headerlink" title="1. é—®é¢˜æè¿°"></a>1. é—®é¢˜æè¿°</h1><pre><code>class Chart {    private String type; //å›¾è¡¨ç±»å‹    public Chart(Object[][] data, String type) {        this.type = type;        if (type.equalsIgnoreCase(&quot;histogram&quot;)) {            //åˆå§‹åŒ–æŸ±çŠ¶å›¾        }        else if (type.equalsIgnoreCase(&quot;pie&quot;)) {            //åˆå§‹åŒ–é¥¼çŠ¶å›¾        }        else if (type.equalsIgnoreCase(&quot;line&quot;)) {            //åˆå§‹åŒ–æŠ˜çº¿å›¾        }    }    public void display() {        if (this.type.equalsIgnoreCase(&quot;histogram&quot;)) {            //æ˜¾ç¤ºæŸ±çŠ¶å›¾        }        else if (this.type.equalsIgnoreCase(&quot;pie&quot;)) {            //æ˜¾ç¤ºé¥¼çŠ¶å›¾        }        else if (this.type.equalsIgnoreCase(&quot;line&quot;)) {            //æ˜¾ç¤ºæŠ˜çº¿å›¾        }        }}</code></pre><p>é—®é¢˜ï¼š</p><ol><li>å†—é•¿</li><li>èŒè´£å¤ªé‡</li><li>Constructoræ„å»ºä¼šéå¸¸è€—æ—¶</li></ol><h1 id="2-ç®€å•å·¥ç¨‹æ¨¡å¼æ¦‚è¿°"><a href="#2-ç®€å•å·¥ç¨‹æ¨¡å¼æ¦‚è¿°" class="headerlink" title="2. ç®€å•å·¥ç¨‹æ¨¡å¼æ¦‚è¿°"></a>2. ç®€å•å·¥ç¨‹æ¨¡å¼æ¦‚è¿°</h1><h2 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h2><p>é¦–å…ˆå°†éœ€è¦åˆ›å»ºçš„å„ç§ä¸åŒå¯¹è±¡ï¼ˆä¾‹å¦‚å„ç§ä¸åŒçš„Chartå¯¹è±¡ï¼‰çš„ç›¸å…³ä»£ç å°è£…åˆ°ä¸åŒçš„ç±»ä¸­ï¼Œè¿™äº›ç±»ç§°ä¸ºå…·ä½“äº§å“ç±»ï¼Œè€Œå°†å®ƒä»¬å…¬å…±çš„ä»£ç è¿›è¡ŒæŠ½è±¡å’Œæå–åå°è£…åœ¨ä¸€ä¸ªæŠ½è±¡äº§å“ç±»ä¸­ï¼Œæ¯ä¸€ä¸ªå…·ä½“äº§å“ç±»éƒ½æ˜¯æŠ½è±¡äº§å“ç±»çš„å­ç±»ï¼›ç„¶åæä¾›ä¸€ä¸ªå·¥å‚ç±»ç”¨äºåˆ›å»ºå„ç§äº§å“ï¼Œåœ¨å·¥å‚ç±»ä¸­æä¾›ä¸€ä¸ªåˆ›å»ºäº§å“çš„å·¥å‚æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ ¹æ®æ‰€ä¼ å…¥çš„å‚æ•°ä¸åŒåˆ›å»ºä¸åŒçš„å…·ä½“äº§å“å¯¹è±¡ï¼›å®¢æˆ·ç«¯åªéœ€è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•å¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°å³å¯å¾—åˆ°ä¸€ä¸ªäº§å“å¯¹è±¡ã€‚</p><ul><li>å…·ä½“äº§å“ç±»</li><li>æŠ½è±¡äº§å“ç±»</li><li>å·¥å‚ç±» - åˆ›å»ºäº§å“ï¼Œå·¥å‚æ–¹æ³•</li><li>å®¢æˆ·ç«¯ è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•å¾—åˆ°äº§å“å¯¹è±¡</li></ul><blockquote><p>ç®€å•å·¥å‚æ¨¡å¼(Simple Factory Pattern)ï¼šå®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œå®ƒå¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚å› ä¸ºåœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ç”¨äºåˆ›å»ºå®ä¾‹çš„æ–¹æ³•æ˜¯<strong>é™æ€(static)<em>æ–¹æ³•</em></strong>ï¼Œå› æ­¤ç®€å•å·¥å‚æ¨¡å¼åˆè¢«ç§°ä¸ºé™æ€å·¥å‚æ–¹æ³•(Static Factory Method)æ¨¡å¼ï¼Œå®ƒå±äºç±»åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><h2 id="2-2-ç»“æ„"><a href="#2-2-ç»“æ„" class="headerlink" title="2.2 ç»“æ„"></a>2.2 ç»“æ„</h2><p><img src="https://i.loli.net/2020/02/04/N5tmV9o1EPlgFLr.jpg" alt="sf1.jpeg"></p><ul><li>Factory</li></ul><p>å·¥å‚è§’è‰²å³å·¥å‚ç±»ï¼Œå®ƒæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒï¼Œè´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰äº§å“å®ä¾‹çš„å†…éƒ¨é€»è¾‘ï¼›å·¥å‚ç±»å¯ä»¥è¢«å¤–ç•Œç›´æ¥è°ƒç”¨ï¼Œåˆ›å»ºæ‰€éœ€çš„äº§å“å¯¹è±¡ï¼›åœ¨å·¥å‚ç±»ä¸­æä¾›äº†é™æ€çš„å·¥å‚æ–¹æ³•factoryMethod()ï¼Œå®ƒçš„è¿”å›ç±»å‹ä¸ºæŠ½è±¡äº§å“ç±»å‹Productã€‚</p><ul><li>Product æŠ½è±¡äº§å“</li></ul><p>å®ƒæ˜¯å·¥å‚ç±»æ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œå°è£…äº†å„ç§äº§å“å¯¹è±¡çš„å…¬æœ‰æ–¹æ³•ï¼Œå®ƒçš„å¼•å…¥å°†æé«˜ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œä½¿å¾—åœ¨å·¥å‚ç±»ä¸­åªéœ€å®šä¹‰ä¸€ä¸ªé€šç”¨çš„å·¥å‚æ–¹æ³•ï¼Œå› ä¸ºæ‰€æœ‰åˆ›å»ºçš„å…·ä½“äº§å“å¯¹è±¡éƒ½æ˜¯å…¶å­ç±»å¯¹è±¡ã€‚</p><ul><li>ConcreteProduct å…·ä½“äº§å“</li></ul><p>å®ƒæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„åˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰è¢«åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹ã€‚æ¯ä¸€ä¸ªå…·ä½“äº§å“è§’è‰²éƒ½ç»§æ‰¿äº†æŠ½è±¡äº§å“è§’è‰²ï¼Œéœ€è¦å®ç°åœ¨æŠ½è±¡äº§å“ä¸­å£°æ˜çš„æŠ½è±¡æ–¹æ³•ã€‚</p><h1 id="3-ä»£ç å®ç°"><a href="#3-ä»£ç å®ç°" class="headerlink" title="3 ä»£ç å®ç°"></a>3 ä»£ç å®ç°</h1><pre><code>abstract class Product {    //æ‰€æœ‰äº§å“ç±»çš„å…¬å…±ä¸šåŠ¡æ–¹æ³•    public void methodSame() {        //å…¬å…±æ–¹æ³•çš„å®ç°    }    //å£°æ˜æŠ½è±¡ä¸šåŠ¡æ–¹æ³•    public abstract void methodDiff();}class ConcreteProduct extends Product {//å®ç°ä¸šåŠ¡æ–¹æ³•    public void methodDiff() {    //ä¸šåŠ¡æ–¹æ³•çš„å®ç°    }}class Factory {    //é™æ€å·¥å‚æ–¹æ³•    public static Product getProduct(String arg) {        Product product = null;        if (arg.equalsIgnoreCase(&quot;A&quot;)) {            product = new ConcreteProductA();            //åˆå§‹åŒ–è®¾ç½®product        }        else if (arg.equalsIgnoreCase(&quot;B&quot;)) {            product = new ConcreteProductB();            //åˆå§‹åŒ–è®¾ç½®product        }        return product;    }}//å®¢æˆ·ç«¯ä»£ç ï¼Œç›´æ¥è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•æ¥å¾—åˆ°äº§å“å¯¹è±¡class Client {    public static void main(String args[]) {        Product product;         product = Factory.getProduct(&quot;A&quot;); //é€šè¿‡å·¥å‚ç±»åˆ›å»ºäº§å“å¯¹è±¡        product.methodSame();        product.methodDiff();    }}</code></pre><h2 id="3-1-ç»“æ„å›¾"><a href="#3-1-ç»“æ„å›¾" class="headerlink" title="3.1 ç»“æ„å›¾"></a>3.1 ç»“æ„å›¾</h2><p><img src="https://i.loli.net/2020/02/04/FdsgZtQ27rE1NTU.jpg" alt="sf2.jpeg"></p><h2 id="3-2-å®Œæ•´æ–¹æ¡ˆ"><a href="#3-2-å®Œæ•´æ–¹æ¡ˆ" class="headerlink" title="3.2 å®Œæ•´æ–¹æ¡ˆ"></a>3.2 å®Œæ•´æ–¹æ¡ˆ</h2><pre><code>//æŠ½è±¡å›¾è¡¨æ¥å£ï¼šæŠ½è±¡äº§å“ç±»interface Chart {    public void display();}//æŸ±çŠ¶å›¾ç±»ï¼šå…·ä½“äº§å“ç±»class HistogramChart implements Chart {    public HistogramChart() {        System.out.println(&quot;åˆ›å»ºæŸ±çŠ¶å›¾ï¼&quot;);    }    public void display() {        System.out.println(&quot;æ˜¾ç¤ºæŸ±çŠ¶å›¾ï¼&quot;);    }}//é¥¼çŠ¶å›¾ç±»ï¼šå…·ä½“äº§å“ç±»class PieChart implements Chart {    public PieChart() {        System.out.println(&quot;åˆ›å»ºé¥¼çŠ¶å›¾ï¼&quot;);    }    public void display() {        System.out.println(&quot;æ˜¾ç¤ºé¥¼çŠ¶å›¾ï¼&quot;);    }}//æŠ˜çº¿å›¾ç±»ï¼šå…·ä½“äº§å“ç±»class LineChart implements Chart {    public LineChart() {        System.out.println(&quot;åˆ›å»ºæŠ˜çº¿å›¾ï¼&quot;);    }    public void display() {        System.out.println(&quot;æ˜¾ç¤ºæŠ˜çº¿å›¾ï¼&quot;);    }}//å›¾è¡¨å·¥å‚ç±»ï¼šå·¥å‚ç±»class ChartFactory {    //é™æ€å·¥å‚æ–¹æ³•    public static Chart getChart(String type) {        Chart chart = null;        if (type.equalsIgnoreCase(&quot;histogram&quot;)) {            chart = new HistogramChart();            System.out.println(&quot;åˆå§‹åŒ–è®¾ç½®æŸ±çŠ¶å›¾ï¼&quot;);        }        else if (type.equalsIgnoreCase(&quot;pie&quot;)) {            chart = new PieChart();            System.out.println(&quot;åˆå§‹åŒ–è®¾ç½®é¥¼çŠ¶å›¾ï¼&quot;);        }        else if (type.equalsIgnoreCase(&quot;line&quot;)) {            chart = new LineChart();            System.out.println(&quot;åˆå§‹åŒ–è®¾ç½®æŠ˜çº¿å›¾ï¼&quot;);                    }        return chart;    }}</code></pre><h2 id="3-3-æ”¹è¿›"><a href="#3-3-æ”¹è¿›" class="headerlink" title="3.3 æ”¹è¿›"></a>3.3 æ”¹è¿›</h2><p>å°†é€‰æ‹©å…·ä½“çš„chartç±»çš„ä»£ç å°è£…åˆ°xmlæ–‡ä»¶é‡Œï¼Œç„¶åå†™ä¸€ä¸ªç›¸åº”çš„æ–¹æ³•å»è¯»å–XMLå‚æ•°ã€‚</p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;config&gt;    &lt;chartType&gt;histogram&lt;/chartType&gt;&lt;/config&gt;</code></pre><p>å†™ä¸€ä¸ªå·¥å…·ç±»ï¼Œæ¥è·å–XMLæ–‡ä»¶é‡Œçš„å‚æ•°</p><pre><code>import javax.xml.parsers.*;import org.w3c.dom.*;import org.xml.sax.SAXException;import java.io.*;public class XMLUtil {    //è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å›¾è¡¨ç±»å‹ï¼Œå¹¶è¿”å›ç±»å‹å    public static String getChartType() {        try {            //åˆ›å»ºæ–‡æ¡£å¯¹è±¡            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();            DocumentBuilder builder = dFactory.newDocumentBuilder();            Document doc;                                        doc = builder.parse(new File(&quot;config.xml&quot;));             //è·å–åŒ…å«å›¾è¡¨ç±»å‹çš„æ–‡æœ¬èŠ‚ç‚¹            NodeList nl = doc.getElementsByTagName(&quot;chartType&quot;);            Node classNode = nl.item(0).getFirstChild();            String chartType = classNode.getNodeValue().trim();            return chartType;        }              catch(Exception e) {               e.printStackTrace();            return null;        }    }}</code></pre><h1 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4.æ€»ç»“"></a>4.æ€»ç»“</h1><p><img src="https://i.loli.net/2020/02/04/aSZD7Iv5A1wsN2C.jpg" alt="sf3.jpeg"></p><h2 id="4-1-ä¼˜åŠ¿"><a href="#4-1-ä¼˜åŠ¿" class="headerlink" title="4.1 ä¼˜åŠ¿"></a>4.1 ä¼˜åŠ¿</h2><ol><li>å°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»</li><li>å®¢æˆ·ç«¯ä¸å†ç›´æ¥åˆ›å»ºäº§å“å¯¹è±¡ï¼Œä»…ä»…æ¶ˆè´¹äº§å“</li><li>é…ç½®æ–‡ä»¶ï¼Œæé«˜ç³»ç»Ÿçµæ´»æ€§</li></ol><h2 id="4-2-ç¼ºé™·"><a href="#4-2-ç¼ºé™·" class="headerlink" title="4.2 ç¼ºé™·"></a>4.2 ç¼ºé™·</h2><ol><li>å·¥å‚ç±»é›†ä¸­äº†æ‰€æœ‰çš„åˆ›å»ºé€»è¾‘ï¼ŒèŒè´£å¤ªé‡ã€‚ä¸€æ—¦ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½è¦å—å½±å“ã€‚</li><li>åŠ¿å¿…å¢åŠ ç±»çš„ä¸ªæ•°ï¼Œå¼•å…¥æ–°çš„å·¥å‚ç±»ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç†è§£ç¨‹åº¦</li><li>ç³»ç»Ÿæ‰©å±•å›°éš¾ï¼ï¼ï¼ä¸€æ—¦æ·»åŠ æ–°äº§å“å°±å¿…é¡»ä¿®æ”¹å·¥å‚é€»è¾‘</li><li>ä½¿ç”¨äº†é™æ€å·¥å‚æ–¹æ³•ï¼Œé€ æˆå·¥å‚è§’è‰²æ— æ³•å½¢æˆåŸºäºç»§æ‰¿çš„ç­‰çº§ç»“æ„</li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ½è±¡å·¥å‚æ¨¡å¼</title>
      <link href="/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>å·¥å‚æ–¹æ³•æ¨¡å¼é€šè¿‡å¼•å…¥å·¥å‚ç­‰çº§ç»“æ„ï¼Œè§£å†³äº†ç®€å•å·¥å‚æ¨¡å¼ä¸­å·¥å‚ç±»èŒè´£å¤ªé‡çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±äºå·¥å‚æ–¹æ³•æ¨¡å¼ä¸­çš„æ¯ä¸€ä¸ªå·¥å‚åªç”Ÿäº§ä¸€ç±»äº§å“ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡çš„å·¥å‚ç±»ï¼ŒåŠ¿å¿…ä¼šå¢åŠ ç³»ç»Ÿçš„å¼€é”€ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>å°†ä¸€äº›ç›¸å…³çš„äº§å“ç»„æˆä¸€ä¸ªäº§å“æ—ï¼Œç”±åŒä¸€ä¸ªå·¥å‚æ¥ç»Ÿä¸€ç”Ÿäº§</strong>ã€‚</p><h1 id="1-åˆå§‹è®¾è®¡"><a href="#1-åˆå§‹è®¾è®¡" class="headerlink" title="1. åˆå§‹è®¾è®¡"></a>1. åˆå§‹è®¾è®¡</h1><p>  Sunnyè½¯ä»¶å…¬å¸æ¬²å¼€å‘ä¸€å¥—ç•Œé¢çš®è‚¤åº“ï¼Œå¯ä»¥å¯¹Javaæ¡Œé¢è½¯ä»¶è¿›è¡Œç•Œé¢ç¾åŒ–ã€‚ä¸ºäº†ä¿æŠ¤ç‰ˆæƒï¼Œè¯¥çš®è‚¤åº“æºä»£ç ä¸æ‰“ç®—å…¬å¼€ï¼Œè€Œåªå‘ç”¨æˆ·æä¾›å·²æ‰“åŒ…ä¸ºjaræ–‡ä»¶çš„classå­—èŠ‚ç æ–‡ä»¶ã€‚ç”¨æˆ·åœ¨ä½¿ç”¨æ—¶å¯ä»¥é€šè¿‡èœå•æ¥é€‰æ‹©çš®è‚¤ï¼Œä¸åŒçš„çš®è‚¤å°†æä¾›è§†è§‰æ•ˆæœä¸åŒçš„æŒ‰é’®ã€æ–‡æœ¬æ¡†ã€ç»„åˆæ¡†ç­‰ç•Œé¢å…ƒç´ ï¼Œ<br><img src="https://i.loli.net/2020/02/04/RnYfcDpNqtkuCPj.jpg" alt="fm1.jpg"></p><p>  é‡‡ç”¨å·¥å‚æ¨¡å¼è¿›è¡Œç³»ç»Ÿè®¾è®¡çš„ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/04/UAnaQOVXW4vZiSY.jpg" alt="fm2.jpg"></p><h2 id="1-1-å­˜åœ¨çš„é—®é¢˜"><a href="#1-1-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="1.1 å­˜åœ¨çš„é—®é¢˜"></a>1.1 å­˜åœ¨çš„é—®é¢˜</h2><ol><li>å½“éœ€è¦å¢åŠ æ–°çš„çš®è‚¤æ—¶ï¼Œè™½ç„¶ä¸è¦ä¿®æ”¹ç°æœ‰ä»£ç ï¼Œä½†æ˜¯éœ€è¦å¢åŠ å¤§é‡ç±»ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªæ–°å¢å…·ä½“ç»„ä»¶éƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå…·ä½“å·¥å‚ï¼Œ<strong><em>ç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œè¿™æ— ç–‘ä¼šå¯¼è‡´ç³»ç»Ÿè¶Šæ¥è¶Šåºå¤§ï¼Œå¢åŠ ç³»ç»Ÿçš„ç»´æŠ¤æˆæœ¬å’Œè¿è¡Œå¼€é”€</em></strong>ï¼›</li><li>ç”±äºåŒä¸€ç§é£æ ¼çš„å…·ä½“ç•Œé¢ç»„ä»¶é€šå¸¸è¦ä¸€èµ·æ˜¾ç¤ºï¼Œå› æ­¤éœ€è¦ä¸ºæ¯ä¸ªç»„ä»¶éƒ½é€‰æ‹©ä¸€ä¸ªå…·ä½“å·¥å‚ï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æ—¶å¿…é¡»é€ä¸ªè¿›è¡Œè®¾ç½®ï¼Œå¦‚æœæŸä¸ªå…·ä½“å·¥å‚é€‰æ‹©å¤±è¯¯å°†ä¼šå¯¼è‡´ç•Œé¢æ˜¾ç¤ºæ··ä¹±ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥é€‚å½“å¢åŠ ä¸€äº›çº¦æŸè¯­å¥ï¼Œä½†å®¢æˆ·ç«¯ä»£ç å’Œé…ç½®æ–‡ä»¶éƒ½è¾ƒä¸ºå¤æ‚ã€‚</li></ol><h1 id="2-äº§å“ç­‰çº§ç»“æ„"><a href="#2-äº§å“ç­‰çº§ç»“æ„" class="headerlink" title="2. äº§å“ç­‰çº§ç»“æ„"></a>2. äº§å“ç­‰çº§ç»“æ„</h1><p>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­å…·ä½“å·¥å‚è´Ÿè´£ç”Ÿäº§å…·ä½“çš„äº§å“ï¼Œæ¯ä¸€ä¸ª<strong><em>å…·ä½“å·¥å‚</em></strong>å¯¹åº”ä¸€ç§å…·ä½“äº§å“ï¼Œå·¥å‚æ–¹æ³•å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå…·ä½“å·¥å‚ä¸­åªæœ‰ä¸€ä¸ªæˆ–è€…ä¸€ç»„é‡è½½çš„å·¥å‚æ–¹æ³•ã€‚<strong><em>ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›ä¸€ä¸ªå·¥å‚å¯ä»¥æä¾›å¤šä¸ªäº§å“å¯¹è±¡ï¼Œè€Œä¸æ˜¯å•ä¸€çš„äº§å“å¯¹è±¡</em></strong>ï¼Œå¦‚ä¸€ä¸ªç”µå™¨å·¥å‚ï¼Œå®ƒå¯ä»¥ç”Ÿäº§ç”µè§†æœºã€ç”µå†°ç®±ã€ç©ºè°ƒç­‰å¤šç§ç”µå™¨ï¼Œè€Œä¸æ˜¯åªç”Ÿäº§æŸä¸€ç§ç”µå™¨ã€‚</p><h2 id="2-1-æ¦‚å¿µ"><a href="#2-1-æ¦‚å¿µ" class="headerlink" title="2.1 æ¦‚å¿µ"></a>2.1 æ¦‚å¿µ</h2><ol><li>äº§å“ç­‰çº§ç»“æ„</li></ol><p>å³äº§å“çš„ç»§æ‰¿ç»“æ„</p><ol start="2"><li>äº§å“æ—</li></ol><p>æŒ‡ç”±åŒä¸€ä¸ªå·¥å‚ç”Ÿäº§çš„ï¼Œä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„ä¸€ç»„äº§å“</p><p><img src="https://i.loli.net/2020/02/04/qJn7UsTMcC9tzw3.jpg" alt="fm3.jpg"></p><p><img src="https://i.loli.net/2020/02/04/n8ezWVCKOUSmN7p.jpg" alt="fm4.jpg"></p><p>å½“ç³»ç»Ÿæ‰€æä¾›çš„å·¥å‚ç”Ÿäº§çš„å…·ä½“äº§å“ä¸æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œè€Œæ˜¯å¤šä¸ªä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ï¼Œå±äºä¸åŒç±»å‹çš„å…·ä½“äº§å“ã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯æ‰€æœ‰å½¢å¼çš„å·¥å‚æ¨¡å¼ä¸­æœ€ä¸ºæŠ½è±¡å’Œæœ€å…·ä¸€èˆ¬æ€§çš„ä¸€ç§å½¢å¼ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œä¸€ä¸ªå·¥å‚ç­‰çº§ç»“æ„å¯ä»¥è´Ÿè´£å¤šä¸ªä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„äº§å“å¯¹è±¡çš„åˆ›å»ºã€‚å½“ä¸€ä¸ªå·¥å‚ç­‰çº§ç»“æ„å¯ä»¥åˆ›å»ºå‡ºåˆ†å±äºä¸åŒäº§å“ç­‰çº§ç»“æ„çš„ä¸€ä¸ªäº§å“æ—ä¸­çš„æ‰€æœ‰å¯¹è±¡æ—¶ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æ¯”å·¥å‚æ–¹æ³•æ¨¡å¼æ›´ä¸ºç®€å•ã€æ›´æœ‰æ•ˆç‡ã€‚</p><h1 id="3-æŠ½è±¡å·¥å‚æ¨¡å¼æ¦‚è¿°"><a href="#3-æŠ½è±¡å·¥å‚æ¨¡å¼æ¦‚è¿°" class="headerlink" title="3. æŠ½è±¡å·¥å‚æ¨¡å¼æ¦‚è¿°"></a>3. æŠ½è±¡å·¥å‚æ¨¡å¼æ¦‚è¿°</h1><p>ä¸ºåˆ›å»ºä¸€ç»„å¯¹è±¡æä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä¸å·¥å‚æ–¹æ³•æ¨¡å¼ç›¸æ¯”ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼ä¸­çš„å…·ä½“å·¥å‚ä¸åªæ˜¯åˆ›å»ºä¸€ç§äº§å“ï¼Œå®ƒè´Ÿè´£åˆ›å»ºä¸€æ—äº§å“ï¼š</p><blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory Pattern)ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼åˆç§°ä¸ºKitæ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><p> åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæ¯ä¸€ä¸ªå…·ä½“å·¥å‚éƒ½æä¾›äº†å¤šä¸ªå·¥å‚æ–¹æ³•ç”¨äºäº§ç”Ÿå¤šç§ä¸åŒç±»å‹çš„äº§å“ï¼Œè¿™äº›äº§å“æ„æˆäº†ä¸€ä¸ªäº§å“æ—</p><h2 id="3-1-åŒ…å«çš„è§’è‰²"><a href="#3-1-åŒ…å«çš„è§’è‰²" class="headerlink" title="3.1 åŒ…å«çš„è§’è‰²"></a>3.1 åŒ…å«çš„è§’è‰²</h2><ol><li>Abstract Factory æŠ½è±¡å·¥å‚</li></ol><p>å£°æ˜äº†ä¸€ç»„ç”¨äºåˆ›å»ºä¸€æ—äº§å“çš„æ–¹æ³•ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€ç§äº§å“</p><ol start="2"><li>Concrete Factory å…·ä½“å·¥å‚</li></ol><p>å®ç°äº†åœ¨æŠ½è±¡å·¥å‚ä¸­å£°æ˜çš„åˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œç”Ÿæˆä¸€ç»„å…·ä½“çš„äº§å“ï¼Œè¿™äº›äº§å“æ„æˆäº†ä¸€ä¸ªäº§å“æ—</p><ol start="3"><li>Abstract Product æŠ½è±¡äº§å“</li></ol><p>ä¸ºæ¯ç§äº§å“å£°æ˜æ¥å£ï¼Œåœ¨æŠ½è±¡äº§å“ä¸­å£°æ˜äº†äº§å“æ‰€å…·æœ‰çš„ä¸šåŠ¡æ–¹æ³•</p><ol start="4"><li>Concrete Product å…·ä½“äº§å“</li></ol><p>å®šä¹‰å…·ä½“å·¥å‚äº§ç”Ÿçš„å…·ä½“äº§å“å¯¹è±¡ï¼Œå®ç°æŠ½è±¡äº§å“æ¥å£ä¸­å£°æ˜çš„ä¸šåŠ¡æ–¹æ³•ã€‚</p><h2 id="3-2-å…·ä½“å®ç°"><a href="#3-2-å…·ä½“å®ç°" class="headerlink" title="3.2 å…·ä½“å®ç°"></a>3.2 å…·ä½“å®ç°</h2><p>åœ¨æŠ½è±¡å·¥å‚ä¸­å£°æ˜äº†å¤šä¸ªå·¥å‚æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºä¸åŒç±»å‹çš„äº§å“ï¼ŒæŠ½è±¡å·¥å‚å¯ä»¥æ˜¯æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–è€…å…·ä½“ç±»ï¼Œ</p><pre><code>abstract class AbstractFactory {    public abstract AbstractProductA createProductA(); //å·¥å‚æ–¹æ³•ä¸€    public abstract AbstractProductB createProductB(); //å·¥å‚æ–¹æ³•äºŒâ€¦â€¦}</code></pre><p>å…·ä½“å·¥å‚å®ç°äº†æŠ½è±¡å·¥å‚ï¼Œæ¯ä¸€ä¸ªå…·ä½“çš„å·¥å‚æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªç‰¹å®šçš„äº§å“å¯¹è±¡ï¼Œè€ŒåŒä¸€ä¸ªå…·ä½“å·¥å‚æ‰€åˆ›å»ºçš„äº§å“å¯¹è±¡æ„æˆäº†ä¸€ä¸ªäº§å“æ—ã€‚</p><pre><code>class ConcreteFactory1 extends AbstractFactory {    //å·¥å‚æ–¹æ³•ä¸€    public AbstractProductA createProductA() {        return new ConcreteProductA1();    }    //å·¥å‚æ–¹æ³•äºŒ    public AbstractProductB createProductB() {        return new ConcreteProductB1();    }â€¦â€¦}</code></pre><h1 id="4-å®Œæ•´æ–¹æ¡ˆ"><a href="#4-å®Œæ•´æ–¹æ¡ˆ" class="headerlink" title="4. å®Œæ•´æ–¹æ¡ˆ"></a>4. å®Œæ•´æ–¹æ¡ˆ</h1><p><img src="https://i.loli.net/2020/02/04/628fTVDd9QaOrxm.jpg" alt="fm5.jpg"></p><p><img src="https://i.loli.net/2020/02/04/vJZSa3Ddi8olf6g.jpg" alt="fm6.jpg"></p><p>SkinFactoryæ¥å£å……å½“æŠ½è±¡å·¥å‚ï¼Œå…¶å­ç±»SpringSkinFactoryå’ŒSummerSkinFactoryå……å½“å…·ä½“å·¥å‚ï¼Œæ¥å£Buttonã€TextFieldå’ŒComboBoxå……å½“æŠ½è±¡äº§å“ï¼Œå…¶å­ç±»SpringButtonã€SpringTextFieldã€SpringComboBoxå’ŒSummerButtonã€SummerTextFieldã€SummerComboBoxå……å½“å…·ä½“äº§å“ã€‚</p><p>//åœ¨æœ¬å®ä¾‹ä¸­æˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œäº†å¤§é‡ç®€åŒ–ï¼Œå®é™…ä½¿ç”¨æ—¶ï¼Œç•Œé¢ç»„ä»¶çš„åˆå§‹åŒ–ä»£ç è¾ƒä¸ºå¤æ‚ï¼Œè¿˜éœ€è¦ä½¿ç”¨JDKä¸­ä¸€äº›å·²æœ‰ç±»ï¼Œä¸ºäº†çªå‡ºæ ¸å¿ƒä»£ç ï¼Œåœ¨æ­¤åªæä¾›æ¡†æ¶ä»£ç å’Œæ¼”ç¤ºè¾“å‡ºã€‚<br>    //æŒ‰é’®æ¥å£ï¼šæŠ½è±¡äº§å“<br>    interface Button {<br>        public void display();<br>    }</p><pre><code>//SpringæŒ‰é’®ç±»ï¼šå…·ä½“äº§å“class SpringButton implements Button {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºæµ…ç»¿è‰²æŒ‰é’®ã€‚&quot;);    }}//SummeræŒ‰é’®ç±»ï¼šå…·ä½“äº§å“class SummerButton implements Button {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºæµ…è“è‰²æŒ‰é’®ã€‚&quot;);    }    }//æ–‡æœ¬æ¡†æ¥å£ï¼šæŠ½è±¡äº§å“interface TextField {    public void display();}//Springæ–‡æœ¬æ¡†ç±»ï¼šå…·ä½“äº§å“class SpringTextField implements TextField {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºç»¿è‰²è¾¹æ¡†æ–‡æœ¬æ¡†ã€‚&quot;);    }}//Summeræ–‡æœ¬æ¡†ç±»ï¼šå…·ä½“äº§å“class SummerTextField implements TextField {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºè“è‰²è¾¹æ¡†æ–‡æœ¬æ¡†ã€‚&quot;);    }    }//ç»„åˆæ¡†æ¥å£ï¼šæŠ½è±¡äº§å“interface ComboBox {    public void display();}//Springç»„åˆæ¡†ç±»ï¼šå…·ä½“äº§å“class SpringComboBox implements ComboBox {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºç»¿è‰²è¾¹æ¡†ç»„åˆæ¡†ã€‚&quot;);    }}//Summerç»„åˆæ¡†ç±»ï¼šå…·ä½“äº§å“class SummerComboBox implements ComboBox {    public void display() {        System.out.println(&quot;æ˜¾ç¤ºè“è‰²è¾¹æ¡†ç»„åˆæ¡†ã€‚&quot;);    }    }//ç•Œé¢çš®è‚¤å·¥å‚æ¥å£ï¼šæŠ½è±¡å·¥å‚interface SkinFactory {    public Button createButton();    public TextField createTextField();    public ComboBox createComboBox();}//Springçš®è‚¤å·¥å‚ï¼šå…·ä½“å·¥å‚class SpringSkinFactory implements SkinFactory {    public Button createButton() {        return new SpringButton();    }    public TextField createTextField() {        return new SpringTextField();    }    public ComboBox createComboBox() {        return new SpringComboBox();    }}//Summerçš®è‚¤å·¥å‚ï¼šå…·ä½“å·¥å‚class SummerSkinFactory implements SkinFactory {    public Button createButton() {        return new SummerButton();    }    public TextField createTextField() {        return new SummerTextField();    }    public ComboBox createComboBox() {        return new SummerComboBox();    }}</code></pre><p>å¼•å…¥å·¥å…·ç±»å’Œé…ç½®æ–‡ä»¶ï¼Œå¢å¼ºç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§</p><pre><code>import javax.xml.parsers.*;import org.w3c.dom.*;import org.xml.sax.SAXException;import java.io.*;public class XMLUtil {//è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å…·ä½“ç±»ç±»åï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡    public static Object getBean() {        try {            //åˆ›å»ºæ–‡æ¡£å¯¹è±¡            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();            DocumentBuilder builder = dFactory.newDocumentBuilder();            Document doc;                                        doc = builder.parse(new File(&quot;config.xml&quot;));             //è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹            NodeList nl = doc.getElementsByTagName(&quot;className&quot;);            Node classNode=nl.item(0).getFirstChild();            String cName=classNode.getNodeValue();            //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›            Class c=Class.forName(cName);              Object obj=c.newInstance();            return obj;        }           catch(Exception e) {               e.printStackTrace();               return null;           }    }}</code></pre><p>é…ç½®æ–‡ä»¶config.xmlä¸­å­˜å‚¨å…·ä½“å·¥å‚ç±»çš„ç±»å</p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;config&gt;    &lt;className&gt;SpringSkinFactory&lt;/className&gt;&lt;/config&gt;</code></pre><h1 id="5-å¼€é—­åŸåˆ™çš„å€¾æ–œæ€§"><a href="#5-å¼€é—­åŸåˆ™çš„å€¾æ–œæ€§" class="headerlink" title="5. å¼€é—­åŸåˆ™çš„å€¾æ–œæ€§"></a>5. å¼€é—­åŸåˆ™çš„å€¾æ–œæ€§</h1><p>Sunnyå…¬å¸ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼è®¾è®¡äº†ç•Œé¢çš®è‚¤åº“ï¼Œè¯¥çš®è‚¤åº“å¯ä»¥è¾ƒä¸ºæ–¹ä¾¿åœ°å¢åŠ æ–°çš„çš®è‚¤ï¼Œä½†æ˜¯ç°åœ¨é‡åˆ°ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼šç”±äºè®¾è®¡æ—¶è€ƒè™‘ä¸å…¨é¢ï¼Œå¿˜è®°ä¸ºå•é€‰æŒ‰é’®(RadioButton)æä¾›ä¸åŒçš®è‚¤çš„é£æ ¼åŒ–æ˜¾ç¤ºï¼Œå¯¼è‡´æ— è®ºé€‰æ‹©å“ªç§çš®è‚¤ï¼Œå•é€‰æŒ‰é’®éƒ½æ˜¾å¾—é‚£ä¹ˆâ€œæ ¼æ ¼ä¸å…¥â€ã€‚Sunnyå…¬å¸çš„è®¾è®¡äººå‘˜å†³å®šå‘ç³»ç»Ÿä¸­å¢åŠ å•é€‰æŒ‰é’®ï¼Œä½†æ˜¯å‘ç°åŸæœ‰ç³»ç»Ÿå±…ç„¶ä¸èƒ½å¤Ÿåœ¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€çš„å‰æä¸‹å¢åŠ æ–°çš„ç»„ä»¶ï¼ŒåŸå› æ˜¯æŠ½è±¡å·¥å‚SkinFactoryä¸­æ ¹æœ¬æ²¡æœ‰æä¾›åˆ›å»ºå•é€‰æŒ‰é’®çš„æ–¹æ³•ï¼Œå¦‚æœéœ€è¦å¢åŠ å•é€‰æŒ‰é’®ï¼Œé¦–å…ˆéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚æ¥å£SkinFactoryï¼Œåœ¨å…¶ä¸­æ–°å¢å£°æ˜åˆ›å»ºå•é€‰æŒ‰é’®çš„æ–¹æ³•ï¼Œç„¶åé€ä¸ªä¿®æ”¹å…·ä½“å·¥å‚ç±»ï¼Œå¢åŠ ç›¸åº”æ–¹æ³•ä»¥å®ç°åœ¨ä¸åŒçš„çš®è‚¤ä¸­åˆ›å»ºå•é€‰æŒ‰é’®ï¼Œæ­¤å¤–è¿˜éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œå¦åˆ™å•é€‰æŒ‰é’®æ— æ³•åº”ç”¨äºç°æœ‰ç³»ç»Ÿã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨æœ¬æ¨¡å¼ä¸­ï¼Œå¢åŠ æ–°çš„äº§å“æ—å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„å¾ˆéº»çƒ¦ã€‚</p><ol><li>å¢åŠ äº§å“æ—</li></ol><p>å¯¹äºå¢åŠ æ–°çš„äº§å“æ—ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¾ˆå¥½åœ°æ”¯æŒäº†â€œå¼€é—­åŸåˆ™â€ï¼Œåªéœ€è¦å¢åŠ å…·ä½“äº§å“å¹¶å¯¹åº”å¢åŠ ä¸€ä¸ªæ–°çš„å…·ä½“å·¥å‚ï¼Œå¯¹å·²æœ‰ä»£ç æ— é¡»åšä»»ä½•ä¿®æ”¹ã€‚</p><ol start="2"><li>å¢åŠ äº§å“ç­‰çº§ç»“æ„</li></ol><p>å¯¹äºå¢åŠ æ–°çš„äº§å“æ—ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¾ˆå¥½åœ°æ”¯æŒäº†â€œå¼€é—­åŸåˆ™â€ï¼Œåªéœ€è¦å¢åŠ å…·ä½“äº§å“å¹¶å¯¹åº”å¢åŠ ä¸€ä¸ªæ–°çš„å…·ä½“å·¥å‚ï¼Œå¯¹å·²æœ‰ä»£ç æ— é¡»åšä»»ä½•ä¿®æ”¹ã€‚</p><h1 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h1><h2 id="6-1-ä¼˜åŠ¿"><a href="#6-1-ä¼˜åŠ¿" class="headerlink" title="6.1 ä¼˜åŠ¿"></a>6.1 ä¼˜åŠ¿</h2><ol><li>éš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œä½¿å¾—æ›´æ¢å…·ä½“å·¥å‚å˜å¾—å®¹æ˜“ã€‚æ‰€æœ‰çš„å…·ä½“å·¥å‚éƒ½å®ç°äº†æŠ½è±¡å·¥å‚ä¸­å®šä¹‰çš„é‚£äº›å…¬å…±æ¥å£ï¼Œå› æ­¤åªéœ€è¦æ”¹å˜å…·ä½“å·¥å‚çš„å®ä¾‹ï¼Œå°±å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šæ”¹å˜æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿçš„è¡Œä¸ºã€‚</li><li>å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½å¤Ÿä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚</li></ol><h2 id="6-2-åŠ£åŠ¿"><a href="#6-2-åŠ£åŠ¿" class="headerlink" title="6.2 åŠ£åŠ¿"></a>6.2 åŠ£åŠ¿</h2><ol><li>å¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„éº»çƒ¦ï¼Œéœ€è¦å¯¹åŸæœ‰ç³»ç»Ÿè¿›è¡Œè¾ƒå¤§çš„ä¿®æ”¹ï¼Œç”šè‡³éœ€è¦ä¿®æ”¹æŠ½è±¡å±‚ä»£ç ï¼Œè¿™æ˜¾ç„¶ä¼šå¸¦æ¥è¾ƒå¤§çš„ä¸ä¾¿ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡çº¢åŒ…é«˜å¹¶å‘æ¶æ„è®¾è®¡</title>
      <link href="/%E5%BE%AE%E4%BF%A1%E7%BA%A2%E5%8C%85%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"/>
      <url>/%E5%BE%AE%E4%BF%A1%E7%BA%A2%E5%8C%85%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¾®ä¿¡çº¢åŒ…ä¸šåŠ¡ç‰¹ç‚¹ä»¥åŠæŠ€æœ¯éš¾ç‚¹"><a href="#1-å¾®ä¿¡çº¢åŒ…ä¸šåŠ¡ç‰¹ç‚¹ä»¥åŠæŠ€æœ¯éš¾ç‚¹" class="headerlink" title="1. å¾®ä¿¡çº¢åŒ…ä¸šåŠ¡ç‰¹ç‚¹ä»¥åŠæŠ€æœ¯éš¾ç‚¹"></a>1. å¾®ä¿¡çº¢åŒ…ä¸šåŠ¡ç‰¹ç‚¹ä»¥åŠæŠ€æœ¯éš¾ç‚¹</h1><h2 id="1-1-ä¸šåŠ¡ç‰¹ç‚¹"><a href="#1-1-ä¸šåŠ¡ç‰¹ç‚¹" class="headerlink" title="1.1 ä¸šåŠ¡ç‰¹ç‚¹"></a>1.1 ä¸šåŠ¡ç‰¹ç‚¹</h2><p>ç±»ä¼¼äºçº¿ä¸Šçš„ç§’æ€ï¼Œæµ·é‡çš„å¹¶å‘è¯·æ±‚ï¼›æ›´ä¸¥æ ¼çš„å®‰å…¨çº§åˆ«ï¼Œå› ä¸ºç‰µæ‰¯åˆ°èµ„é‡‘äº¤æ˜“ï¼Œæ‰€ä»¥å°±ä¸å¯ä»¥æœ‰åƒç”¨ç§’æ€æ´»åŠ¨å½“ä¸­çš„é‚£ç§è¶…å–çš„æ–¹å¼ã€‚</p><h2 id="1-2-æµç¨‹"><a href="#1-2-æµç¨‹" class="headerlink" title="1.2 æµç¨‹"></a>1.2 æµç¨‹</h2><ul><li><p>proxy</p><ul><li>å¤„ç†è¯·æ±‚æ¥å…¥ </li></ul></li><li><p>server</p><ul><li>ä¸»è¦ä¸šåŠ¡é€»è¾‘ </li></ul></li><li><p>DB</p><ul><li>æ•°æ®æŒä¹…åŒ– </li><li>äº‹åŠ¡çº§åˆ«çš„å®Œæˆ - å®Œå…¨æ‰§è¡Œæˆ–è€…å®Œå…¨ä¸æ‰§è¡Œ<ul><li>é”åº“å­˜<ul><li>ä¸ºäº†é¿å…å¹¶å‘è¯·æ±‚æ—¶å‡ºç°è¶…å–æƒ…å†µ</li><li>æŠ€æœ¯éš¾ç‚¹ï¼Œå½“å¤§é‡ç”¨æˆ·åŒæ—¶åšç§’æ€æ“ä½œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªåˆ°è¾¾DBçš„è¯·æ±‚é”ä½äº†è¿™è¡Œåº“å­˜è®°å½•ã€‚åœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡å®Œæˆæäº¤ä¹‹å‰è¿™ä¸ªé”ä¸€ç›´è¢«ç¬¬ä¸€ä¸ªè¯·æ±‚å ç”¨ã€‚â€”â€”&gt; æŠ€æœ¯éš¾ç‚¹ï¼Œå¹¶å‘è¯·æ±‚æŠ¢é”</li></ul></li><li>æ’å…¥ç§’æ€è®°å½•</li><li>æ›´æ–°åº“å­˜</li></ul></li></ul></li><li><p>Cache </p><ul><li>ç¼“å­˜åº“å­˜æ•°é‡ </li></ul></li></ul><h1 id="2-å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„é«˜å¹¶å‘è§£å†³æ–¹æ¡ˆ"><a href="#2-å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„é«˜å¹¶å‘è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2. å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„é«˜å¹¶å‘è§£å†³æ–¹æ¡ˆ"></a>2. å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„é«˜å¹¶å‘è§£å†³æ–¹æ¡ˆ</h1><h2 id="2-1-é«˜å¹¶å‘é—®é¢˜å¸¸ç”¨æ–¹æ¡ˆ"><a href="#2-1-é«˜å¹¶å‘é—®é¢˜å¸¸ç”¨æ–¹æ¡ˆ" class="headerlink" title="2.1 é«˜å¹¶å‘é—®é¢˜å¸¸ç”¨æ–¹æ¡ˆ"></a>2.1 é«˜å¹¶å‘é—®é¢˜å¸¸ç”¨æ–¹æ¡ˆ</h2><h3 id="2-1-1-ä½¿ç”¨å†…å­˜æ“ä½œæ›¿ä»£å®æ—¶çš„DBäº‹åŠ¡æ“ä½œ"><a href="#2-1-1-ä½¿ç”¨å†…å­˜æ“ä½œæ›¿ä»£å®æ—¶çš„DBäº‹åŠ¡æ“ä½œ" class="headerlink" title="2.1.1 ä½¿ç”¨å†…å­˜æ“ä½œæ›¿ä»£å®æ—¶çš„DBäº‹åŠ¡æ“ä½œ"></a>2.1.1 ä½¿ç”¨å†…å­˜æ“ä½œæ›¿ä»£å®æ—¶çš„DBäº‹åŠ¡æ“ä½œ</h3><p>server åˆ°å†…å­˜Cacheï¼Œåšæ‰£åº“å­˜çš„æ“ä½œï¼Œç„¶åå†…å­˜Cacheå¼‚æ­¥æŒä¹…åŒ–åˆ°æ•°æ®åº“ã€‚ä½†æ˜¯å¦‚æœå†…å­˜Cacheç‚¸äº†ï¼Œæˆ–è€…å†…å­˜Cacheæ›´æ–°ï¼Œä½†æ˜¯DDBæ²¡æœ‰æ›´æ–°ï¼Œéƒ½ä¼šå¾ˆå´©ã€‚å¤šä¸ªæœåŠ¡å™¨ä¹‹é—´çš„åŒæ­¥ä¹Ÿä¼šæ˜¯ä¸€ä¸ªä¸å°çš„é—®é¢˜ã€‚</p><h3 id="2-1-2-ä½¿ç”¨ä¹è§‚é”-instead-of-æ‚²è§‚é”"><a href="#2-1-2-ä½¿ç”¨ä¹è§‚é”-instead-of-æ‚²è§‚é”" class="headerlink" title="2.1.2 ä½¿ç”¨ä¹è§‚é” instead of æ‚²è§‚é”"></a>2.1.2 ä½¿ç”¨ä¹è§‚é” instead of æ‚²è§‚é”</h3><ul><li>ä¹è§‚é”<ul><li>å‡è®¾å¤šç”¨æˆ·å¹¶å‘çš„äº‹åŠ¡å¤„ç†æ—¶ä¸ä¼šç›¸äº’å½±å“ã€‚åœ¨æäº¤æ•°æ®æ›´æ–°ä¹‹å‰ï¼Œæ¯ä¸ªäº‹åŠ¡ä¼šæ£€æŸ¥åœ¨è¯¥äº‹åŠ¡è¯»å–æ•°æ®ä¹‹åï¼Œæœ‰æ²¡æœ‰å…¶ä»–äº‹åŠ¡åˆä¿®æ”¹äº†æ•°æ®ã€‚å¦‚æœå…¶ä»–äº‹åŠ¡ç”¨æ›´æ–°çš„è¯ï¼Œæ­£åœ¨æäº¤çš„äº‹åŠ¡ä¼šè¿›è¡Œå›æ»šã€‚</li></ul></li><li>æ‚²è§‚é”<ul><li>é˜»æ­¢ä¸€ä¸ªäº‹åŠ¡ä»¥å½±å“å…¶ä»–ç”¨æˆ·çš„æ–¹å¼æ¥ä¿®æ”¹æ•°æ®</li></ul></li></ul><p>å¯¹äºå¾®ä¿¡çº¢åŒ…çš„ä½¿ç”¨åœºæ™¯ï¼Œå³éœ€è¦åœ¨DBé‡Œç»´æŠ¤ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œåœ¨æ›´æ–°åº“å­˜çš„æ“ä½œè¿›è¡Œä¹‹å‰ï¼Œå…ˆå»DBè·å–å½“å‰ç‰ˆæœ¬å·ï¼Œç„¶ååœ¨æ›´æ–°åº“å­˜çš„äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œæ£€æŸ¥æ˜¯å¦è¢«ä¿®æ”¹ã€‚</p><p>è¿™ä¹ˆåšçš„é—®é¢˜åœ¨äºï¼š</p><ul><li>ä¹è§‚é”ï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶æŠ¢çº¢åŒ…ï¼Œé‚£åŠ¿å¿…åªæœ‰ä¸€ä¸ªæˆåŠŸï¼Œå¦å¤–çš„éƒ½ä¼šæ˜¾ç¤ºå¤±è´¥ - æŠ¥é”™ï¼Œè¿™å°±ç”¨æˆ·ä½“éªŒå¾ˆå·®åŠ²äº†</li><li>è€Œä¸”ä¼šé€ æˆåˆšå¼€å§‹å¯èƒ½å¤±è´¥ï¼Œåé¢å› ä¸ºå¹¶å‘å°äº†ï¼Œæœ‰æˆåŠŸçš„æ¡ˆä¾‹çš„å¯èƒ½æ€§</li><li>å¤§é‡æ— æ•ˆè¯·æ±‚ï¼Œå›æ»šï¼Œç»™DBå¸¦æ¥å¾ˆå¤§å‹åŠ›</li></ul><h2 id="2-2-å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ"><a href="#2-2-å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.2 å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ"></a>2.2 å¾®ä¿¡çº¢åŒ…ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ</h2><ul><li>ç³»ç»Ÿå‚ç›´SETåŒ–<ul><li>ç”ŸæˆIDä½œä¸ºçº¢åŒ…çš„å”¯ä¸€æ ‡è¯†</li><li>çº¢åŒ…ç³»ç»Ÿæ ¹æ®IDåšå‚ç›´åˆ‡åˆ†ï¼Œä¸€ä¸ªå‚ç›´é€»è¾‘é“¾æ¡ä¸Šçš„Serverå’ŒDBä»¬å«åšä¸€ä¸ªSET</li><li>å„ä¸ªSETç›¸äº’ç‹¬ç«‹ï¼Œä¸”è§£è€¦ï¼Œæ¯ä¸ªçº¢åŒ…IDçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šåœ¨åŒä¸€ä¸ªSETå½“ä¸­æ¥å¤„ç†<ul><li>çœ‹èµ·æ¥åƒæ˜¯éœ€è¦ä¸»å¤‡ä¸¤å°æœåŠ¡å™¨ï¼Œå¤‡ç”¨æœåŠ¡å™¨å¹³å¸¸æ²¡æœ‰æµé‡ï¼Œå®Œå…¨ç”¨æ¥åœ¨ä¸»æœåŠ¡å™¨å‡ºé—®é¢˜çš„æ—¶å€™ï¼Œç›´æ¥è½¬å¤‡ç”¨</li></ul></li></ul></li><li>é€»è¾‘Serverå±‚å°†è¯·æ±‚æ’é˜Ÿï¼Œè§£å†³DBå¹¶å‘é—®é¢˜<ul><li>å°†æ‹†çº¢åŒ…çš„äº‹åŠ¡æ“ä½œåšä¸²è¡Œå¤„ç†ï¼Œåœ¨Serverå±‚åšFIFOçš„æ’é˜Ÿå¤„ç†</li></ul></li><li>memcachedæ§åˆ¶å¹¶å‘<ul><li>åˆ©ç”¨CASåŸå­ç´¯å¢æ“ä½œï¼Œæ§åˆ¶åŒæ—¶è¿›å…¥DBæ‹†çº¢åŒ…çš„è¯·æ±‚æ•°ï¼Œè¶…è¿‡é¢„å®šå€¼å°±ç›´æ¥æ‹’ç»æœåŠ¡ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥åšDBè´Ÿè½½è¿‡é«˜æ—¶çš„é™çº§ä½“éªŒ</li></ul></li><li>åŒç»´åº¦åº“å­˜è¡¨è®¾è®¡<ul><li>TTL </li><li>å†·çƒ­æ•°æ®åˆ†ç¦»</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å»ºé€ è€…æ¨¡å¼</title>
      <link href="/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>å»ºé€ è€…æ¨¡å¼ï¼Œåˆç§°ä¸ºç”Ÿæˆå™¨æ¨¡å¼ï¼Œä¸ºå®¢æˆ·ç«¯è¿”å›ä¸€ä¸ªç”±å¤šä¸ªéƒ¨ä»¶ç»„æˆçš„å¤æ‚äº§å“ã€‚</p><h1 id="1-å»ºé€ è€…æ¨¡å¼æ¦‚è¿°"><a href="#1-å»ºé€ è€…æ¨¡å¼æ¦‚è¿°" class="headerlink" title="1. å»ºé€ è€…æ¨¡å¼æ¦‚è¿°"></a>1. å»ºé€ è€…æ¨¡å¼æ¦‚è¿°</h1><p>å°ä¾‹å­ï¼Œè®¾è®¡æ¸¸æˆè§’è‰²ç—…å¯ä»¥å¿«é€Ÿç”Ÿæˆã€‚å¯¹äºå„ç§è§’è‰²æ¥è¯´ï¼Œåˆ›å»ºæ­¥éª¤ç›¸å¯¹æ¯”è¾ƒç±»ä¼¼ï¼Œé€æ­¥åˆ›å»ºå…¶ç»„æˆéƒ¨åˆ†ï¼Œå†å°†å„ç»„æˆéƒ¨åˆ†è£…é…æˆä¸€ä¸ªå®Œæ•´çš„æ¸¸æˆè§’è‰²ã€‚</p><p>å»ºé€ è€…æ¨¡å¼å°†å®¢æˆ·ç«¯å’ŒåŒ…å«å„ä¸ªç»„æˆéƒ¨åˆ†çš„å¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹åˆ†ç¦»ï¼Œå®¢æˆ·ç«¯æ— é¡»çŸ¥é“å¤æ‚å¯¹è±¡çš„å†…éƒ¨ç»„æˆéƒ¨åˆ†ä¸è£…é…æ–¹å¼ï¼Œåªéœ€è¦çŸ¥é“æ‰€éœ€å»ºé€ è€…çš„ç±»å‹å³å¯ã€‚</p><blockquote><p>å»ºé€ è€…æ¨¡å¼ï¼Œå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><h2 id="1-1-å»ºé€ è€…æ¨¡å¼ç»“æ„"><a href="#1-1-å»ºé€ è€…æ¨¡å¼ç»“æ„" class="headerlink" title="1.1 å»ºé€ è€…æ¨¡å¼ç»“æ„"></a>1.1 å»ºé€ è€…æ¨¡å¼ç»“æ„</h2><p><img src="https://i.loli.net/2020/02/04/Tl4oLzhx16i9Uvq.gif" alt="1.gif"><br>å»ºé€ è€…æ¨¡å¼ç»“æ„å›¾</p><h2 id="1-2-å»ºé€ è€…æ¨¡å¼è§’è‰²"><a href="#1-2-å»ºé€ è€…æ¨¡å¼è§’è‰²" class="headerlink" title="1.2 å»ºé€ è€…æ¨¡å¼è§’è‰²"></a>1.2 å»ºé€ è€…æ¨¡å¼è§’è‰²</h2><ol><li>Builder(æŠ½è±¡å»ºé€ è€…)</li></ol><p>ä¸ºåˆ›å»ºä¸€ä¸ªäº§å“Productå¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šæŠ½è±¡æ¥å£ï¼ŒåŒ…å«ä¸¤ç±»æ–¹æ³•ã€‚ä¸€æ˜¯buildPart()ï¼Œ äºŒæ˜¯getResult()æ–¹æ³•</p><ol start="2"><li>ConcreteBuilder(å…·ä½“å»ºé€ è€…)</li></ol><p>å®ç°äº†Builderæ¥å£ï¼Œå®ç°å„ä¸ªéƒ¨ä»¶çš„å…·ä½“æ„é€ å’Œè£…é…æ–¹æ³•ï¼Œå®šä¹‰å¹¶æ˜ç¡®å…¶æ‰€åˆ›å»ºçš„å¤æ‚å¯¹è±¡ã€‚</p><ol start="3"><li>Product(äº§å“è§’è‰²)</li></ol><p>æ˜¯è¢«æ„å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ªç»„æˆéƒ¨ä»¶ï¼Œå…·ä½“å»ºé€ è€…åˆ›å»ºè¯¥äº§å“ï¼Œå¹¶å®šä¹‰å…¶è£…é…è¿‡ç¨‹</p><ol start="4"><li>Director(æŒ‡æŒ¥è€…)</li></ol><p>æŒ‡æŒ¥è€…åˆç§°ä¸ºå¯¼æ¼”ç±»ï¼Œå®ƒè´Ÿè´£å®‰æ’<strong>å¤æ‚å¯¹è±¡çš„å»ºé€ æ¬¡åº</strong>ï¼ŒæŒ‡æŒ¥è€…ä¸æŠ½è±¡å»ºé€ è€…ä¹‹é—´å­˜åœ¨å…³è”å…³ç³»ï¼Œå¯ä»¥åœ¨å…¶construct()å»ºé€ æ–¹æ³•ä¸­è°ƒç”¨å»ºé€ è€…å¯¹è±¡çš„éƒ¨ä»¶æ„é€ ä¸è£…é…æ–¹æ³•ï¼Œå®Œæˆå¤æ‚å¯¹è±¡çš„å»ºé€ ã€‚å®¢æˆ·ç«¯ä¸€èˆ¬åªéœ€è¦ä¸æŒ‡æŒ¥è€…è¿›è¡Œäº¤äº’ï¼Œåœ¨å®¢æˆ·ç«¯ç¡®å®šå…·ä½“å»ºé€ è€…çš„ç±»å‹ï¼Œå¹¶å®ä¾‹åŒ–å…·ä½“å»ºé€ è€…å¯¹è±¡ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å’Œåå°„æœºåˆ¶ï¼‰ï¼Œç„¶åé€šè¿‡æŒ‡æŒ¥è€…ç±»çš„æ„é€ å‡½æ•°æˆ–è€…Setteræ–¹æ³•å°†è¯¥å¯¹è±¡ä¼ å…¥æŒ‡æŒ¥è€…ç±»ä¸­ã€‚</p><p>åœ¨å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ªæŒ‡æŒ¥è€…ç±»Directorï¼Œè¯¥ç±»ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼šä¸€æ–¹é¢å®ƒéš”ç¦»äº†å®¢æˆ·ä¸åˆ›å»ºè¿‡ç¨‹ï¼›å¦ä¸€æ–¹é¢å®ƒæ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æŸä¸ªbuildPartX()æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ä»¥åŠå¤šä¸ªbuildPartX()æ–¹æ³•è°ƒç”¨çš„å…ˆåæ¬¡åºç­‰ã€‚æŒ‡æŒ¥è€…é’ˆå¯¹æŠ½è±¡å»ºé€ è€…ç¼–ç¨‹ï¼Œå®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“å…·ä½“å»ºé€ è€…çš„ç±»å‹ï¼Œå³å¯é€šè¿‡æŒ‡æŒ¥è€…ç±»è°ƒç”¨å»ºé€ è€…çš„ç›¸å…³æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå®Œæ•´çš„äº§å“å¯¹è±¡ã€‚</p><h1 id="2-æ¸¸æˆè§’è‰²åˆ›å»ºè§£å†³æ–¹æ¡ˆ"><a href="#2-æ¸¸æˆè§’è‰²åˆ›å»ºè§£å†³æ–¹æ¡ˆ" class="headerlink" title="2. æ¸¸æˆè§’è‰²åˆ›å»ºè§£å†³æ–¹æ¡ˆ"></a>2. æ¸¸æˆè§’è‰²åˆ›å»ºè§£å†³æ–¹æ¡ˆ</h1><p><img src="https://i.loli.net/2020/02/04/R7D3qoj6ugxTIiQ.gif" alt="2.gif"><br>è§’è‰²åˆ›å»ºç»“æ„å›¾</p><p>Actorè§’è‰²ç±»</p><pre><code>// import lombok@Dataclass Actor{    private String type;    private String sex;    private String face;    private String costume;    private String hairstyle;}</code></pre><p>è§’è‰²å»ºé€ èµ·ï¼šæŠ½è±¡å»ºé€ è€…</p><pre><code>abstract class ActorBuilder {    public void buildType() {        actor.setType(&quot;Charm&quot;);    }}</code></pre><p>æŒ‡æŒ¥è€…ç±»<br>    class ActorController {<br>        public Actor construct(ActorBuilder ab) {<br>            Actor actor;<br>            ab.buildType();<br>            ab.buildSex();<br>            â€¦<br>            actor = ab.createActor();<br>            return actor;<br>        }<br>    }</p><h1 id="3-å…³äºDirectorçš„è®¨è®º"><a href="#3-å…³äºDirectorçš„è®¨è®º" class="headerlink" title="3. å…³äºDirectorçš„è®¨è®º"></a>3. å…³äºDirectorçš„è®¨è®º</h1><h2 id="3-1-çœç•¥Director"><a href="#3-1-çœç•¥Director" class="headerlink" title="3.1 çœç•¥Director"></a>3.1 çœç•¥Director</h2><p>å°†Directorå’ŒæŠ½è±¡å»ºé€ è€…Builderè¿›è¡Œåˆå¹¶ï¼Œåœ¨Builderä¸­æä¾›é€æ­¥æ„å»ºå¤æ‚äº§å“å¯¹è±¡çš„construct()æ–¹æ³•ï¼Œæ§åˆ¶è°ƒç”¨çš„å…ˆåæ¬¡åºã€‚</p><pre><code>abstract class ActorBuilder{       protected static Actor actor = new  Actor();       public  abstract void buildType();       public  abstract void buildSex();       public  abstract void buildFace();       public  abstract void buildCostume();       public  abstract void buildHairstyle();       public static Actor  construct(ActorBuilder ab)       {              ab.buildType();              ab.buildSex();              ab.buildFace();              ab.buildCostume();              ab.buildHairstyle();              return actor;       }}</code></pre><h2 id="3-2-è®¾å€¼é’©å­æ–¹æ³•"><a href="#3-2-è®¾å€¼é’©å­æ–¹æ³•" class="headerlink" title="3.2 è®¾å€¼é’©å­æ–¹æ³•"></a>3.2 è®¾å€¼é’©å­æ–¹æ³•</h2><p>æ¥æ§åˆ¶å¯¹BuilderPartçš„è°ƒç”¨</p><h1 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4. æ€»ç»“"></a>4. æ€»ç»“</h1><h2 id="4-1-ä¼˜ç‚¹"><a href="#4-1-ä¼˜ç‚¹" class="headerlink" title="4.1 ä¼˜ç‚¹"></a>4.1 ä¼˜ç‚¹</h2><ol><li>äº§å“æœ¬èº«ä¸åˆ›å»ºè¿‡ç¨‹è§£è€¦</li><li>å…·ä½“å»ºé€ è€…ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹</li></ol><h2 id="4-2-ç¼ºç‚¹"><a href="#4-2-ç¼ºç‚¹" class="headerlink" title="4.2 ç¼ºç‚¹"></a>4.2 ç¼ºç‚¹</h2><ol><li>åŒä¸€ä¸ªBuilderå»ºçš„å¾ˆç±»ä¼¼å•Šï¼Œéœ€è¦äº§å“æœ¬èº«ç›¸ä¼¼ç¨‹åº¦æ¯”è¾ƒé«˜ï¼Œå¦åˆ™ä¼šå¾ˆå—é™</li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å‚æ–¹æ³•æ¨¡å¼</title>
      <link href="/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç®€å•å·¥å‚æ¨¡å¼è™½ç„¶ç®€å•ï¼Œä½†å­˜åœ¨ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ã€‚å½“ç³»ç»Ÿä¸­éœ€è¦å¼•å…¥æ–°äº§å“æ—¶ï¼Œç”±äºé™æ€å·¥å‚æ–¹æ³•é€šè¿‡æ‰€ä¼ å…¥å‚æ•°çš„ä¸åŒæ¥åˆ›å»ºä¸åŒçš„äº§å“ï¼Œè¿™å¿…å®šè¦ä¿®æ”¹å·¥å‚ç±»çš„æºä»£ç ï¼Œå°†è¿èƒŒâ€œå¼€é—­åŸåˆ™â€ï¼Œå¦‚ä½•å®ç°å¢åŠ æ–°äº§å“è€Œä¸å½±å“å·²æœ‰ä»£ç ï¼Ÿå·¥å‚æ–¹æ³•æ¨¡å¼åº”è¿è€Œç”Ÿï¼Œæœ¬æ–‡å°†ä»‹ç»ç¬¬äºŒç§å·¥å‚æ¨¡å¼â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚</p></blockquote><h1 id="1-æ—¥å¿—è®°å½•å™¨çš„è®¾è®¡"><a href="#1-æ—¥å¿—è®°å½•å™¨çš„è®¾è®¡" class="headerlink" title="1. æ—¥å¿—è®°å½•å™¨çš„è®¾è®¡"></a>1. æ—¥å¿—è®°å½•å™¨çš„è®¾è®¡</h1><p>Sunnyè½¯ä»¶å…¬å¸æ¬²å¼€å‘ä¸€ä¸ªç³»ç»Ÿè¿è¡Œæ—¥å¿—è®°å½•å™¨(Logger)ï¼Œè¯¥è®°å½•å™¨å¯ä»¥é€šè¿‡å¤šç§é€”å¾„ä¿å­˜ç³»ç»Ÿçš„è¿è¡Œæ—¥å¿—ï¼Œå¦‚é€šè¿‡æ–‡ä»¶è®°å½•æˆ–æ•°æ®åº“è®°å½•ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶çµæ´»åœ°æ›´æ¢æ—¥å¿—è®°å½•æ–¹å¼ã€‚åœ¨è®¾è®¡å„ç±»æ—¥å¿—è®°å½•å™¨æ—¶ï¼ŒSunnyå…¬å¸çš„å¼€å‘äººå‘˜å‘ç°éœ€è¦å¯¹æ—¥å¿—è®°å½•å™¨è¿›è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œåˆå§‹åŒ–å‚æ•°çš„è®¾ç½®è¿‡ç¨‹è¾ƒä¸ºå¤æ‚ï¼Œè€Œä¸”æŸäº›å‚æ•°çš„è®¾ç½®æœ‰ä¸¥æ ¼çš„å…ˆåæ¬¡åºï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿè®°å½•å¤±è´¥ã€‚å¦‚ä½•å°è£…è®°å½•å™¨çš„åˆå§‹åŒ–è¿‡ç¨‹å¹¶ä¿è¯å¤šç§è®°å½•å™¨åˆ‡æ¢çš„çµæ´»æ€§æ˜¯Sunnyå…¬å¸å¼€å‘äººå‘˜é¢ä¸´çš„ä¸€ä¸ªéš¾é¢˜ã€‚</p><h2 id="1-1-è®¾è®¡è¦ç‚¹"><a href="#1-1-è®¾è®¡è¦ç‚¹" class="headerlink" title="1.1 è®¾è®¡è¦ç‚¹"></a>1.1 è®¾è®¡è¦ç‚¹</h2><ol><li>éœ€è¦å°è£…æ—¥å¿—è®°å½•å™¨çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¿™äº›åˆå§‹åŒ–å·¥ä½œè¾ƒä¸ºå¤æ‚ï¼Œä¾‹å¦‚éœ€è¦åˆå§‹åŒ–å…¶ä»–ç›¸å…³çš„ç±»ï¼Œè¿˜æœ‰å¯èƒ½éœ€è¦è¯»å–é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚è¿æ¥æ•°æ®åº“æˆ–åˆ›å»ºæ–‡ä»¶ï¼‰ï¼Œå¯¼è‡´ä»£ç è¾ƒé•¿ï¼Œå¦‚æœå°†å®ƒä»¬éƒ½å†™åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œä¼šå¯¼è‡´æ„é€ å‡½æ•°åºå¤§ï¼Œä¸åˆ©äºä»£ç çš„ä¿®æ”¹å’Œç»´æŠ¤</li><li>ç”¨æˆ·å¯èƒ½éœ€è¦æ›´æ¢æ—¥å¿—è®°å½•æ–¹å¼ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­éœ€è¦æä¾›ä¸€ç§çµæ´»çš„æ–¹å¼æ¥é€‰æ‹©æ—¥å¿—è®°å½•å™¨ï¼Œå°½é‡åœ¨ä¸ä¿®æ”¹æºä»£ç çš„åŸºç¡€ä¸Šæ›´æ¢æˆ–è€…å¢åŠ æ—¥å¿—è®°å½•æ–¹å¼ã€‚</li></ol><p><img src="https://i.loli.net/2020/02/03/7ArHEvCctiokB4U.jpg" alt="gc1.jpeg"></p><p>ç”¨ç®€å•å·¥å‚æ¨¡å¼æ¥åšç³»ç»Ÿè®¾è®¡ï¼ŒLoggerFactoryæ¥åˆ›å»ºå…·ä½“çš„loggerï¼ŒæŠ½è±¡ç±»loggerè¢«å‡ ä¸ªå…·ä½“çš„loggerç±»å®ç°ï¼Œå®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨LoggerFactoryæ¥ç”Ÿæˆå…·ä½“çš„loggerå¯¹è±¡ã€‚</p><pre><code>//æ—¥å¿—è®°å½•å™¨å·¥å‚class LoggerFactory {    //é™æ€å·¥å‚æ–¹æ³•    public static Logger createLogger(String args) {        if(args.equalsIgnoreCase(&quot;db&quot;)) {            //è¿æ¥æ•°æ®åº“ï¼Œä»£ç çœç•¥            //åˆ›å»ºæ•°æ®åº“æ—¥å¿—è®°å½•å™¨å¯¹è±¡            Logger logger = new DatabaseLogger();             //åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;        }        else if(args.equalsIgnoreCase(&quot;file&quot;)) {            //åˆ›å»ºæ—¥å¿—æ–‡ä»¶            //åˆ›å»ºæ–‡ä»¶æ—¥å¿—è®°å½•å™¨å¯¹è±¡            Logger logger = new FileLogger();             //åˆå§‹åŒ–æ–‡ä»¶æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;                    }        else {            return null;        }    }}</code></pre><p>é€šè¿‡è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å°†æ—¥å¿—è®°å½•å™¨çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ï¼Œå®¢æˆ·ç«¯åªéœ€ä½¿ç”¨ç”±å·¥å‚ç±»åˆ›å»ºçš„æ—¥å¿—è®°å½•å™¨å¯¹è±¡å³å¯ã€‚ä½†ä»å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ol><li>å·¥å‚ç±»è¿‡äºåºå¤§ï¼ŒåŒ…å«äº†å¤§é‡çš„ifâ€¦elseâ€¦ä»£ç ï¼Œå¯¼è‡´ç»´æŠ¤å’Œæµ‹è¯•éš¾åº¦å¢å¤§</li><li>ç³»ç»Ÿæ‰©å±•ä¸çµæ´»ï¼Œå¦‚æœå¢åŠ æ–°ç±»å‹çš„æ—¥å¿—è®°å½•å™¨ï¼Œå¿…é¡»ä¿®æ”¹é™æ€å·¥å‚æ–¹æ³•çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿åäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li></ol><h1 id="2-å·¥å‚æ–¹æ³•æ¨¡å¼æ¦‚è¿°"><a href="#2-å·¥å‚æ–¹æ³•æ¨¡å¼æ¦‚è¿°" class="headerlink" title="2. å·¥å‚æ–¹æ³•æ¨¡å¼æ¦‚è¿°"></a>2. å·¥å‚æ–¹æ³•æ¨¡å¼æ¦‚è¿°</h1><p>ç®€å•å·¥å‚æ¨¡å¼åªæä¾›äº†ä¸€ä¸ªå·¥å‚ç±»ï¼Œè¯¥å·¥å‚ç±»å¤„äºå¯¹äº§å“ç±»è¿›è¡Œå®ä¾‹åŒ–çš„ä¸­å¿ƒä½ç½®ï¼Œå®ƒéœ€è¦çŸ¥é“æ¯ä¸€ä¸ªäº§å“å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ï¼Œå¹¶å†³å®šä½•æ—¶å®ä¾‹åŒ–å“ªä¸€ä¸ªäº§å“ç±»ã€‚ç®€å•å·¥å‚æ¨¡å¼æœ€å¤§çš„ç¼ºç‚¹æ˜¯<strong>å½“æœ‰æ–°äº§å“è¦åŠ å…¥åˆ°ç³»ç»Ÿä¸­æ—¶ï¼Œå¿…é¡»ä¿®æ”¹å·¥å‚ç±»ï¼Œéœ€è¦åœ¨å…¶ä¸­åŠ å…¥å¿…è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€</strong>ã€‚ æ­¤å¤–ï¼Œåœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ï¼Œæ‰€æœ‰çš„äº§å“éƒ½ç”±åŒä¸€ä¸ªå·¥å‚åˆ›å»ºï¼Œå·¥å‚ç±»èŒè´£è¾ƒé‡ï¼Œä¸šåŠ¡é€»è¾‘è¾ƒä¸ºå¤æ‚ï¼Œå…·ä½“äº§å“ä¸å·¥å‚ç±»ä¹‹é—´çš„è€¦åˆåº¦é«˜ï¼Œä¸¥é‡å½±å“äº†ç³»ç»Ÿçš„çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼Œè€Œå·¥å‚æ–¹æ³•æ¨¡å¼åˆ™å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><h2 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h2><blockquote><p>å·¥å‚æ–¹æ³•æ¨¡å¼ä¸å†æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å·¥å‚ç±»æ¥åˆ›å»ºæ‰€æœ‰çš„äº§å“å¯¹è±¡ï¼Œè€Œæ˜¯é’ˆå¯¹ä¸åŒçš„äº§å“æä¾›ä¸åŒçš„å·¥å‚ï¼Œç³»ç»Ÿæä¾›ä¸€ä¸ªä¸äº§å“ç­‰çº§ç»“æ„å¯¹åº”çš„å·¥å‚ç­‰çº§ç»“æ„ã€‚</p></blockquote><blockquote><p>å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method Pattern)ï¼š<strong><em>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå°†å“ªä¸€ä¸ªç±»å®ä¾‹åŒ–</em></strong>ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼è®©ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼åˆç®€ç§°ä¸ºå·¥å‚æ¨¡å¼(Factory Pattern)ï¼Œåˆå¯ç§°ä½œè™šæ‹Ÿæ„é€ å™¨æ¨¡å¼(Virtual Constructor Pattern)æˆ–å¤šæ€å·¥å‚æ¨¡å¼(Polymorphic Factory Pattern)ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§ç±»åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><p><img src="https://i.loli.net/2020/02/03/lFQLbIy2eUzV8Nu.jpg" alt="gc2.jpeg"></p><h2 id="2-2-ç»„æˆ"><a href="#2-2-ç»„æˆ" class="headerlink" title="2.2 ç»„æˆ"></a>2.2 ç»„æˆ</h2><p>å·¥å‚æ–¹æ³•æ¨¡å¼åŒ…å«ä»¥ä¸‹å‡ ä¸ªç»„æˆéƒ¨åˆ†ï¼š</p><ul><li>Product æŠ½è±¡äº§å“</li></ul><p>å®ƒæ˜¯å®šä¹‰äº§å“çš„æ¥å£ï¼Œæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼æ‰€åˆ›å»ºå¯¹è±¡çš„è¶…ç±»å‹ï¼Œä¹Ÿå°±æ˜¯äº§å“å¯¹è±¡çš„å…¬å…±çˆ¶ç±»ã€‚</p><ul><li>Concrete Product å…·ä½“äº§å“</li></ul><p>å®ƒå®ç°äº†æŠ½è±¡äº§å“æ¥å£ï¼ŒæŸç§ç±»å‹çš„å…·ä½“äº§å“ç”±ä¸“é—¨çš„å…·ä½“å·¥å‚åˆ›å»ºï¼Œå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚</p><ul><li>Factory æŠ½è±¡å·¥å‚</li></ul><p>åœ¨æŠ½è±¡å·¥å‚ç±»ä¸­ï¼Œå£°æ˜äº†å·¥å‚æ–¹æ³•(Factory Method)ï¼Œç”¨äºè¿”å›ä¸€ä¸ªäº§å“ã€‚æŠ½è±¡å·¥å‚æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œæ‰€æœ‰åˆ›å»ºå¯¹è±¡çš„å·¥å‚ç±»éƒ½å¿…é¡»å®ç°è¯¥æ¥å£ã€‚</p><ul><li>Concrete Factory å…·ä½“å·¥å‚</li></ul><p>å®ƒæ˜¯æŠ½è±¡å·¥å‚ç±»çš„å­ç±»ï¼Œå®ç°äº†æŠ½è±¡å·¥å‚ä¸­å®šä¹‰çš„å·¥å‚æ–¹æ³•ï¼Œå¹¶å¯ç”±å®¢æˆ·ç«¯è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“äº§å“ç±»çš„å®ä¾‹ã€‚</p><h2 id="2-3-å®ç°"><a href="#2-3-å®ç°" class="headerlink" title="2.3 å®ç°"></a>2.3 å®ç°</h2><p>æŠ½è±¡å·¥å‚ï¼Œå¯ä»¥ä½¿æ¥å£ï¼Œæˆ–è€…æ˜¯æŠ½è±¡ç±»</p><pre><code>interface Factory {    public Product factoryMethod();}</code></pre><p>æŠ½è±¡å·¥å‚å£°æ˜äº†å·¥å‚æ–¹æ³•ä½†æ˜¯å¹¶æœªå®ç°å·¥å‚æ–¹æ³•ï¼Œå…·ä½“äº§å“å¯¹è±¡çš„åˆ›å»ºç”±å…¶å­ç±»è´Ÿè´£ï¼Œå®¢æˆ·ç«¯é’ˆå¯¹æŠ½è±¡å·¥å‚ç¼–ç¨‹ï¼Œ<strong><em>è¿è¡Œæ—¶å†æŒ‡å®šå…·ä½“å·¥å‚ç±»</em></strong>ã€‚ä¸åŒçš„å…·ä½“å·¥å‚å¯ä»¥åˆ›å»ºä¸åŒçš„å…·ä½“äº§å“ã€‚</p><pre><code>class ConcreteFactory implements Factory {    public Product factoryMethod() {        return new ConcreteProduct();    }}</code></pre><p> åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œå…·ä½“å·¥å‚ç±»åœ¨å®ç°å·¥å‚æ–¹æ³•æ—¶é™¤äº†åˆ›å»ºå…·ä½“äº§å“å¯¹è±¡ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è´Ÿè´£äº§å“å¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œä»¥åŠä¸€äº›èµ„æºå’Œç¯å¢ƒé…ç½®å·¥ä½œï¼Œä¾‹å¦‚è¿æ¥æ•°æ®åº“ã€åˆ›å»ºæ–‡ä»¶ç­‰ã€‚</p><p> åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œåªéœ€å…³æ³¨å·¥å‚ç±»å³å¯ï¼Œä¸åŒçš„å…·ä½“å·¥å‚å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“ã€‚</p><pre><code> â€¦â€¦Factory factory;factory = new ConcreteFactory(); //å¯é€šè¿‡é…ç½®æ–‡ä»¶å®ç°Product product;product = factory.factoryMethod();â€¦â€¦</code></pre><h2 id="2-4-å®Œæ•´è§£å†³æ–¹æ¡ˆ"><a href="#2-4-å®Œæ•´è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.4 å®Œæ•´è§£å†³æ–¹æ¡ˆ"></a>2.4 å®Œæ•´è§£å†³æ–¹æ¡ˆ</h2><p><img src="https://i.loli.net/2020/02/03/f6Stw3NPsXAiyC4.jpg" alt="gc3.jpeg"></p><p>Loggeræ˜¯æŠ½è±¡äº§å“ï¼Œ å…¶å­ç±»FileLoggerå’ŒDatabaseLoggerå……å½“å…·ä½“äº§å“ï¼ŒLoggerFactoryæ¥å£å……å½“æŠ½è±¡å·¥å‚ï¼Œå…¶å­ç±»FileLoggerFactoryå’ŒDatabaseLoggerFactoryå……å½“å…·ä½“å·¥å‚ã€‚</p><pre><code>//æ—¥å¿—è®°å½•å™¨æ¥å£ï¼šæŠ½è±¡äº§å“interface Logger {    public void writeLog();}//æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼šå…·ä½“äº§å“class DatabaseLogger implements Logger {    public void writeLog() {        System.out.println(&quot;æ•°æ®åº“æ—¥å¿—è®°å½•ã€‚&quot;);    }}//æ–‡ä»¶æ—¥å¿—è®°å½•å™¨ï¼šå…·ä½“äº§å“class FileLogger implements Logger {    public void writeLog() {        System.out.println(&quot;æ–‡ä»¶æ—¥å¿—è®°å½•ã€‚&quot;);    }}//æ—¥å¿—è®°å½•å™¨å·¥å‚æ¥å£ï¼šæŠ½è±¡å·¥å‚interface LoggerFactory {    public Logger createLogger();}//æ•°æ®åº“æ—¥å¿—è®°å½•å™¨å·¥å‚ç±»ï¼šå…·ä½“å·¥å‚class DatabaseLoggerFactory implements LoggerFactory {    public Logger createLogger() {            //è¿æ¥æ•°æ®åº“ï¼Œä»£ç çœç•¥            //åˆ›å»ºæ•°æ®åº“æ—¥å¿—è®°å½•å™¨å¯¹è±¡            Logger logger = new DatabaseLogger();             //åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;    }    }//æ–‡ä»¶æ—¥å¿—è®°å½•å™¨å·¥å‚ç±»ï¼šå…·ä½“å·¥å‚class FileLoggerFactory implements LoggerFactory {    public Logger createLogger() {            //åˆ›å»ºæ–‡ä»¶æ—¥å¿—è®°å½•å™¨å¯¹è±¡            Logger logger = new FileLogger();             //åˆ›å»ºæ–‡ä»¶ï¼Œä»£ç çœç•¥            return logger;    }    }</code></pre><p>å®¢æˆ·ç«¯æµ‹è¯•ä»£ç ï¼š</p><pre><code>class Client {    public static void main(String args[]) {        LoggerFactory factory;        Logger logger;        factory = new FileLoggerFactory(); //å¯å¼•å…¥é…ç½®æ–‡ä»¶å®ç°        logger = factory.createLogger();        logger.writeLog();    }}</code></pre><h2 id="2-5-åå°„ä¸é…ç½®æ–‡ä»¶"><a href="#2-5-åå°„ä¸é…ç½®æ–‡ä»¶" class="headerlink" title="2.5 åå°„ä¸é…ç½®æ–‡ä»¶"></a>2.5 åå°„ä¸é…ç½®æ–‡ä»¶</h2><p><strong><em>å¦‚ä½•åœ¨ä¸ä¿®æ”¹ä»»ä½•å®¢æˆ·ç«¯ä»£ç çš„åŸºç¡€ä¸Šæ›´æ–°æˆ–å¢åŠ æ–°çš„æ—¥å¿—è®°å½•æ–¹å¼ï¼Ÿ</em></strong></p><p>åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å°†ä¸å†ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºå·¥å‚å¯¹è±¡ï¼Œè€Œæ˜¯å°†å…·ä½“å·¥å‚ç±»çš„ç±»åå­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ï¼ˆå¦‚XMLæ–‡ä»¶ï¼‰ä¸­ï¼Œ<strong>é€šè¿‡è¯»å–é…ç½®æ–‡ä»¶è·å–ç±»åå­—ç¬¦ä¸²</strong>ï¼Œå†ä½¿ç”¨<strong>Javaçš„åå°„æœºåˆ¶</strong>ï¼Œæ ¹æ®ç±»åå­—ç¬¦ä¸²ç”Ÿæˆå¯¹è±¡ã€‚åœ¨æ•´ä¸ªå®ç°è¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°ä¸¤ä¸ªæŠ€æœ¯ï¼šJavaåå°„æœºåˆ¶ä¸é…ç½®æ–‡ä»¶è¯»å–ã€‚</p><blockquote><p>Javaåå°„æœºåˆ¶</p></blockquote><p>æ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡Œæ—¶è·å–å·²çŸ¥åç§°çš„ç±»æˆ–å·²æœ‰å¯¹è±¡çš„ç›¸å…³ä¿¡æ¯çš„ä¸€ç§æœºåˆ¶ï¼ŒåŒ…æ‹¬ç±»çš„æ–¹æ³•ã€å±æ€§ã€çˆ¶ç±»ç­‰ä¿¡æ¯ï¼Œè¿˜åŒ…æ‹¬å®ä¾‹çš„åˆ›å»ºå’Œå®ä¾‹ç±»å‹çš„åˆ¤æ–­ç­‰ã€‚åœ¨åå°„ä¸­ä½¿ç”¨æœ€å¤šçš„ç±»æ˜¯<strong>Classï¼ŒClassç±»çš„å®ä¾‹è¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„Javaåº”ç”¨ç¨‹åºä¸­çš„ç±»å’Œæ¥å£</strong>ï¼Œå…¶forName(String className)æ–¹æ³•å¯ä»¥è¿”å›ä¸å¸¦æœ‰ç»™å®šå­—ç¬¦ä¸²åçš„ç±»æˆ–æ¥å£ç›¸å…³è”çš„ Classå¯¹è±¡ï¼Œå†é€šè¿‡Classå¯¹è±¡çš„newInstance()æ–¹æ³•åˆ›å»ºæ­¤å¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„ä¸€ä¸ªæ–°å®ä¾‹ï¼Œå³é€šè¿‡ä¸€ä¸ªç±»åå­—ç¬¦ä¸²å¾—åˆ°ç±»çš„å®ä¾‹ã€‚</p><pre><code>   //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›   Class c=Class.forName(&quot;String&quot;);   Object obj=c.newInstance();   return obj;</code></pre><p>è€Œåä½¿ç”¨XMLæ ¼å¼çš„é…ç½®æ–‡ä»¶config.xmlç”¨äºå­˜å‚¨å…·ä½“æ—¥å¿—è®°å½•å™¨å·¥å‚ç±»ç±»åï¼š</p><pre><code>&lt;!â€” config.xml --&gt;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;config&gt;    &lt;className&gt;FileLoggerFactory&lt;/className&gt;&lt;/config&gt;</code></pre><p>ç„¶åç”¨ä¸€ä¸ªåä¸ºXMLUtilçš„å·¥å…·ç±»æ¥è·å–xmlæ–‡ä»¶å®šä¹‰çš„ç±»ï¼Œ<strong>å¹¶ä¸”ç”Ÿæˆå®ä¾‹å¯¹è±¡</strong>ã€‚ </p><pre><code>//å·¥å…·ç±»XMLUtil.javaimport javax.xml.parsers.*;import org.w3c.dom.*;import org.xml.sax.SAXException;import java.io.*;public class XMLUtil {//è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å…·ä½“ç±»ç±»åï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡    public static Object getBean() {        try {            //åˆ›å»ºDOMæ–‡æ¡£å¯¹è±¡            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();            DocumentBuilder builder = dFactory.newDocumentBuilder();            Document doc;                                        doc = builder.parse(new File(&quot;config.xml&quot;));             //è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹            NodeList nl = doc.getElementsByTagName(&quot;className&quot;);            Node classNode=nl.item(0).getFirstChild();            String cName=classNode.getNodeValue();            //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›            Class c=Class.forName(cName);              Object obj=c.newInstance();            return obj;        }           catch(Exception e) {               e.printStackTrace();               return null;         }    }}</code></pre><p>è€Œåå®¢æˆ·ç«¯ä¸éœ€è¦å†ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºå…·ä½“çš„å·¥å‚ç±»äº†ï¼Œå¯ä»¥å°†å…·ä½“å·¥å‚ç±»çš„ç±»åå­˜å‚¨åœ¨XMLæ–‡ä»¶ä¸­ï¼Œå†é€šè¿‡XMLUtilç±»çš„é™æ€å·¥å‚æ–¹æ³•getBean()è¿›è¡Œå¯¹è±¡çš„å®ä¾‹åŒ–</p><pre><code>class Client {    public static void main(String args[]) {        LoggerFactory factory;        Logger logger;        factory = (LoggerFactory)XMLUtil.getBean(); //getBean()çš„è¿”å›ç±»å‹ä¸ºObjectï¼Œéœ€è¦è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢        logger = factory.createLogger();        logger.writeLog();    }}</code></pre><p>å¼•å…¥äº†Utilå’ŒXMLé…ç½®æ–‡ä»¶ä¹‹åï¼Œå¦‚æœè¦å¢åŠ æ–°çš„æ—¥å¿—è®°å½•æ–¹å¼ï¼Œåªéœ€è¦ï¼š</p><ol><li>æ–°çš„æ—¥å¿—è®°å½•å™¨éœ€è¦ç»§æ‰¿æŠ½è±¡æ—¥å¿—è®°å½•å™¨Logger</li><li>å¯¹åº”å¢åŠ ä¸€ä¸ªæ–°çš„å…·ä½“æ—¥å¿—è®°å½•å™¨å·¥å‚ï¼Œç»§æ‰¿æŠ½è±¡æ—¥å¿—è®°å½•å™¨å·¥å‚LoggerFactoryï¼Œå¹¶å®ç°å…¶ä¸­çš„å·¥å‚æ–¹æ³•createLogger()ï¼Œè®¾ç½®å¥½åˆå§‹åŒ–å‚æ•°å’Œç¯å¢ƒå˜é‡ï¼Œè¿”å›å…·ä½“æ—¥å¿—è®°å½•å™¨å¯¹è±¡ï¼›</li><li>ä¿®æ”¹é…ç½®æ–‡ä»¶config.xmlï¼Œå°†æ–°å¢çš„å…·ä½“æ—¥å¿—è®°å½•å™¨å·¥å‚ç±»çš„ç±»åå­—ç¬¦ä¸²æ›¿æ¢åŸæœ‰å·¥å‚ç±»ç±»åå­—ç¬¦ä¸²</li><li>ç¼–è¯‘æ–°å¢çš„å…·ä½“æ—¥å¿—è®°å½•å™¨ç±»å’Œå…·ä½“æ—¥å¿—è®°å½•å™¨å·¥å‚ç±»ï¼Œè¿è¡Œå®¢æˆ·ç«¯æµ‹è¯•ç±»å³å¯ä½¿ç”¨æ–°çš„æ—¥å¿—è®°å½•æ–¹å¼ï¼Œè€ŒåŸæœ‰ç±»åº“ä»£ç æ— é¡»åšä»»ä½•ä¿®æ”¹ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ol><h2 id="2-6-é‡è½½çš„å·¥å‚æ–¹æ³•"><a href="#2-6-é‡è½½çš„å·¥å‚æ–¹æ³•" class="headerlink" title="2.6 é‡è½½çš„å·¥å‚æ–¹æ³•"></a>2.6 é‡è½½çš„å·¥å‚æ–¹æ³•</h2><p>å‘ç°å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥åˆå§‹åŒ–æ—¥å¿—è®°å½•å™¨ï¼Œä¾‹å¦‚å¯ä»¥ä¸ºå„ç§æ—¥å¿—è®°å½•å™¨æä¾›é»˜è®¤å®ç°ï¼›è¿˜å¯ä»¥ä¸ºæ•°æ®åº“æ—¥å¿—è®°å½•å™¨æä¾›æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œä¸ºæ–‡ä»¶æ—¥å¿—è®°å½•å™¨æä¾›æ–‡ä»¶è·¯å¾„ï¼›ä¹Ÿå¯ä»¥å°†å‚æ•°å°è£…åœ¨ä¸€ä¸ªObjectç±»å‹çš„å¯¹è±¡ä¸­ï¼Œé€šè¿‡Objectå¯¹è±¡å°†é…ç½®å‚æ•°ä¼ å…¥å·¥å‚ç±»ã€‚æ­¤æ—¶ï¼Œå¯ä»¥æä¾›ä¸€ç»„é‡è½½çš„å·¥å‚æ–¹æ³•ï¼Œä»¥ä¸åŒçš„æ–¹å¼å¯¹äº§å“å¯¹è±¡è¿›è¡Œåˆ›å»ºã€‚å½“ç„¶ï¼Œå¯¹äºåŒä¸€ä¸ªå…·ä½“å·¥å‚è€Œè¨€ï¼Œæ— è®ºä½¿ç”¨å“ªä¸ªå·¥å‚æ–¹æ³•ï¼Œåˆ›å»ºçš„äº§å“ç±»å‹å‡è¦ç›¸åŒã€‚</p><p><img src="https://i.loli.net/2020/02/03/l8TdOYBKXeCmqbD.jpg" alt="gc4.jpeg"></p><p>å¼•å…¥é‡è½½æ–¹æ³•åï¼ŒæŠ½è±¡å·¥å‚LoggerFactoryçš„ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p><pre><code>interface LoggerFactory {    public Logger createLogger();    public Logger createLogger(String args);    public Logger createLogger(Object obj);}</code></pre><p>å…·ä½“å·¥å‚ç±»DatabaseLoggerFactoryä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p><pre><code>class DatabaseLoggerFactory implements LoggerFactory {    public Logger createLogger() {            //ä½¿ç”¨é»˜è®¤æ–¹å¼è¿æ¥æ•°æ®åº“ï¼Œä»£ç çœç•¥            Logger logger = new DatabaseLogger();             //åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;    }    public Logger createLogger(String args) {            //ä½¿ç”¨å‚æ•°argsä½œä¸ºè¿æ¥å­—ç¬¦ä¸²æ¥è¿æ¥æ•°æ®åº“ï¼Œä»£ç çœç•¥            Logger logger = new DatabaseLogger();             //åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;    }        public Logger createLogger(Object obj) {            //ä½¿ç”¨å°è£…åœ¨å‚æ•°objä¸­çš„è¿æ¥å­—ç¬¦ä¸²æ¥è¿æ¥æ•°æ®åº“ï¼Œä»£ç çœç•¥            Logger logger = new DatabaseLogger();             //ä½¿ç”¨å°è£…åœ¨å‚æ•°objä¸­çš„æ•°æ®æ¥åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—è®°å½•å™¨ï¼Œä»£ç çœç•¥            return logger;    }    }//å…¶ä»–å…·ä½“å·¥å‚ç±»ä»£ç çœç•¥</code></pre><p>åœ¨æŠ½è±¡å·¥å‚ä¸­å®šä¹‰å¤šä¸ªé‡è½½çš„å·¥å‚æ–¹æ³•ï¼Œåœ¨å…·ä½“å·¥å‚ä¸­å®ç°äº†è¿™äº›å·¥å‚æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥åŒ…å«ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼Œä»¥æ»¡è¶³å¯¹ä¸åŒäº§å“å¯¹è±¡çš„éœ€æ±‚ã€‚</p><h2 id="2-7-å·¥å‚æ–¹æ³•çš„éšè—"><a href="#2-7-å·¥å‚æ–¹æ³•çš„éšè—" class="headerlink" title="2.7 å·¥å‚æ–¹æ³•çš„éšè—"></a>2.7 å·¥å‚æ–¹æ³•çš„éšè—</h2><p> æœ‰æ—¶å€™ï¼Œä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ–å®¢æˆ·ç«¯çš„ä½¿ç”¨ï¼Œè¿˜å¯ä»¥å¯¹å®¢æˆ·ç«¯éšè—å·¥å‚æ–¹æ³•ï¼Œæ­¤æ—¶ï¼Œåœ¨å·¥å‚ç±»ä¸­å°†ç›´æ¥è°ƒç”¨äº§å“ç±»çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå®¢æˆ·ç«¯æ— é¡»è°ƒç”¨å·¥å‚æ–¹æ³•åˆ›å»ºäº§å“ï¼Œç›´æ¥é€šè¿‡å·¥å‚å³å¯ä½¿ç”¨æ‰€åˆ›å»ºçš„å¯¹è±¡ä¸­çš„ä¸šåŠ¡æ–¹æ³•ã€‚</p><p><img src="gc5.jpeg" alt="gc5.jpeg"></p><p>å°±æ˜¯æŠ½è±¡å·¥å‚ç±»ä»æ¥å£å˜æˆabstractç±»ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªæŠ½è±¡ç±»é‡Œé¢å®ç°äº§å“ç±»çš„ä¸šåŠ¡æ–¹æ³•ã€‚</p><pre><code>//æ”¹ä¸ºæŠ½è±¡ç±»abstract class LoggerFactory {    //åœ¨å·¥å‚ç±»ä¸­ç›´æ¥è°ƒç”¨æ—¥å¿—è®°å½•å™¨ç±»çš„ä¸šåŠ¡æ–¹æ³•writeLog()    public void writeLog() {        Logger logger = this.createLogger();        logger.writeLog();    }    public abstract Logger createLogger();    }</code></pre><p>å®¢æˆ·ç«¯ä»£ç ä¿®æ”¹æˆï¼š</p><pre><code>class Client {    public static void main(String args[]) {        LoggerFactory factory;        factory = (LoggerFactory)XMLUtil.getBean();        factory.writeLog(); //ç›´æ¥ä½¿ç”¨å·¥å‚å¯¹è±¡æ¥è°ƒç”¨äº§å“å¯¹è±¡çš„ä¸šåŠ¡æ–¹æ³•    }}</code></pre><h1 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a>3. æ€»ç»“</h1><h2 id="3-1-ä¼˜åŠ¿"><a href="#3-1-ä¼˜åŠ¿" class="headerlink" title="3.1 ä¼˜åŠ¿"></a>3.1 ä¼˜åŠ¿</h2><ol><li>å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºå®¢æˆ·æ‰€éœ€è¦çš„äº§å“ï¼ŒåŒæ—¶è¿˜å‘å®¢æˆ·éšè—äº†å“ªç§å…·ä½“äº§å“ç±»å°†è¢«å®ä¾‹åŒ–è¿™ä¸€ç»†èŠ‚ï¼Œ<strong>ç”¨æˆ·åªéœ€è¦å…³å¿ƒæ‰€éœ€äº§å“å¯¹åº”çš„å·¥å‚ï¼Œæ— é¡»å…³å¿ƒåˆ›å»ºç»†èŠ‚ï¼Œç”šè‡³æ— é¡»çŸ¥é“å…·ä½“äº§å“ç±»çš„ç±»å</strong>ã€‚</li><li>åŸºäºå·¥å‚è§’è‰²å’Œäº§å“è§’è‰²çš„<strong>å¤šæ€æ€§è®¾è®¡</strong>æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å…³é”®ã€‚å®ƒèƒ½å¤Ÿè®©å·¥å‚å¯ä»¥è‡ªä¸»ç¡®å®šåˆ›å»ºä½•ç§äº§å“å¯¹è±¡ï¼Œè€Œå¦‚ä½•åˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„ç»†èŠ‚åˆ™å®Œå…¨å°è£…åœ¨å…·ä½“å·¥å‚å†…éƒ¨ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼ä¹‹æ‰€ä»¥åˆè¢«ç§°ä¸ºå¤šæ€å·¥å‚æ¨¡å¼ï¼Œå°±æ­£æ˜¯å› ä¸ºæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»éƒ½å…·æœ‰åŒä¸€æŠ½è±¡çˆ¶ç±»ã€‚</li><li>ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯åœ¨ç³»ç»Ÿä¸­åŠ å…¥æ–°äº§å“æ—¶ï¼Œæ— é¡»ä¿®æ”¹æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“æä¾›çš„æ¥å£ï¼Œæ— é¡»ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œä¹Ÿæ— é¡»ä¿®æ”¹å…¶ä»–çš„å…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ï¼Œ<strong>è€Œåªè¦æ·»åŠ ä¸€ä¸ªå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“å°±å¯ä»¥äº†</strong>ï¼Œè¿™æ ·ï¼Œç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä¹Ÿå°±å˜å¾—éå¸¸å¥½ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ol><h2 id="3-2-åŠ£åŠ¿"><a href="#3-2-åŠ£åŠ¿" class="headerlink" title="3.2 åŠ£åŠ¿"></a>3.2 åŠ£åŠ¿</h2><ol><li>åœ¨æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»ï¼Œè€Œä¸”è¿˜è¦æä¾›ä¸ä¹‹å¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°å°†æˆå¯¹å¢åŠ ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œæœ‰æ›´å¤šçš„ç±»éœ€è¦ç¼–è¯‘å’Œè¿è¡Œï¼Œä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸€äº›é¢å¤–çš„å¼€é”€ã€‚</li><li>ç”±äºè€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œéœ€è¦å¼•å…¥æŠ½è±¡å±‚ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å‡ä½¿ç”¨æŠ½è±¡å±‚è¿›è¡Œå®šä¹‰ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦ï¼Œä¸”åœ¨å®ç°æ—¶å¯èƒ½éœ€è¦ç”¨åˆ°DOMã€åå°„ç­‰æŠ€æœ¯ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å®ç°éš¾åº¦ã€‚</li></ol><h1 id="4-Reference"><a href="#4-Reference" class="headerlink" title="4. Reference"></a>4. Reference</h1><p><a href="https://blog.csdn.net/lovelion/article/details/9306457" target="_blank" rel="noopener">1. CSDN Liuwei</a></p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç¡®å®šä¸€ä¸ªæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°</title>
      <link href="/%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%9C%80%E5%A4%A7%E8%BF%9E%E6%8E%A5%E6%95%B0/"/>
      <url>/%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%9C%80%E5%A4%A7%E8%BF%9E%E6%8E%A5%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è¿æ¥æ•°å®šä¹‰"><a href="#1-è¿æ¥æ•°å®šä¹‰" class="headerlink" title="1. è¿æ¥æ•°å®šä¹‰"></a>1. è¿æ¥æ•°å®šä¹‰</h1><p>å¯¹äºç»™å®šçš„ä¸€ä¸ªæœåŠ¡å™¨è€Œè¨€ï¼Œåœ¨ä»»æ„æ—¶åˆ»èƒ½å¤ŸåŒæ—¶å¤„ç†çš„æœ€å¤§è¿æ¥æ•°ã€‚</p><h1 id="2-Tips"><a href="#2-Tips" class="headerlink" title="2. Tips"></a>2. Tips</h1><h2 id="2-1-å¦‚æœè¶…è¿‡äº†ä¼šæ€ä¹ˆæ ·"><a href="#2-1-å¦‚æœè¶…è¿‡äº†ä¼šæ€ä¹ˆæ ·" class="headerlink" title="2.1 å¦‚æœè¶…è¿‡äº†ä¼šæ€ä¹ˆæ ·"></a>2.1 å¦‚æœè¶…è¿‡äº†ä¼šæ€ä¹ˆæ ·</h2><ul><li>å¦‚æœä½¿ç”¨äº†Spilloverçš„featureï¼Œé¢å¤–çš„è¯·æ±‚ä¼šè¢«æ”¾ç½®åˆ°é˜Ÿåˆ—é‡Œ</li><li>å¦‚æœæ²¡ä½¿ç”¨ï¼Œé‚£ä¹ˆHTTP 503ä¼šè¿”å›ï¼Œå¯¹äºTCPè¿æ¥ï¼Œä¼šè¢«é‡ç½®æ‰</li></ul><h2 id="2-2-å¦‚æœå¾—å‡ºå‡†ç¡®çš„å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿ"><a href="#2-2-å¦‚æœå¾—å‡ºå‡†ç¡®çš„å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿ" class="headerlink" title="2.2 å¦‚æœå¾—å‡ºå‡†ç¡®çš„å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿ"></a>2.2 å¦‚æœå¾—å‡ºå‡†ç¡®çš„å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Ÿ</h2><p>æ²¡æœ‰åŠæ³•ç›´æ¥å¾—å‡ºï¼Œå› ä¸ºè¿è¡Œçš„ä»£ç æœ¬èº«ï¼Œæœºå™¨æœ¬èº«éƒ½ä¼šå¯¹ç»“æœäº§ç”Ÿå½±å“çš„ï¼Œæœ€å¥½çš„æ–¹å¼ä¾æ—§æ˜¯åšæµ‹è¯•ï¼Œå³ä¸åœæ›´æ”¹æœ€å¤§è¿æ¥æ•°ï¼Œå•ç‹¬æµ‹è¯•ä¸€ä¸ªhoståœ¨ä¸åŒè¿æ¥æ•°çš„æƒ…å†µä¸‹çš„metricsï¼Œè­¬å¦‚å»¶æ—¶é—®é¢˜ï¼Œæœ‰æ²¡æœ‰fatals, etc. ä»¥æ­¤æ¥å¾—åˆ°é’ˆå¯¹å®é™…æƒ…å†µçš„æ­£ç¡®åœ°å€¼ã€‚</p><h2 id="2-3-General-å…¬å¼"><a href="#2-3-General-å…¬å¼" class="headerlink" title="2.3 General å…¬å¼"></a>2.3 General å…¬å¼</h2><ul><li>éœ€è¦ä½¿ç”¨çš„CPUæ—¶é—´ (local resource)</li><li>è¿œç«¯ï¼Œç½‘è·¯å»¶æ—¶ ï¼ˆremote latencyï¼‰</li><li>CPU æ ¸å¿ƒæ•°é‡</li></ul><p>å‚è€ƒå…¬å¼</p><pre><code>maxConns = ((local + remote) / local) * cores</code></pre>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åŸå‹æ¨¡å¼</title>
      <link href="/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸå‹æ¨¡å¼æ¦‚è¿°"><a href="#1-åŸå‹æ¨¡å¼æ¦‚è¿°" class="headerlink" title="1. åŸå‹æ¨¡å¼æ¦‚è¿°"></a>1. åŸå‹æ¨¡å¼æ¦‚è¿°</h1><p>åŸå‹æ¨¡å¼æŒ‡ï¼šé€šè¿‡ä¸€ä¸ªåŸå‹å¯¹è±¡å…‹éš†å‡ºå¤šä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ã€‚</p><p>åœ¨ä½¿ç”¨åŸå‹æ¨¡å¼æ—¶ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå†é€šè¿‡å¤åˆ¶è¿™ä¸ªåŸå‹å¯¹è±¡æ¥åˆ›å»ºæ›´å¤šåŒç±»å‹çš„å¯¹è±¡ã€‚</p><blockquote><p>ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚åŸå‹æ¨¡å¼æ—¶ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p></blockquote><h2 id="1-1-å·¥ä½œåŸç†"><a href="#1-1-å·¥ä½œåŸç†" class="headerlink" title="1.1 å·¥ä½œåŸç†"></a>1.1 å·¥ä½œåŸç†</h2><p>å°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™è¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡æ‹·è´è‡ªå·±æ¥å®ç°åˆ›å»ºè¿‡ç¨‹ã€‚</p><p>é€šè¿‡å…‹éš†æ–¹æ³•æ‰€åˆ›å»ºçš„å¯¹è±¡æ˜¯å…¨æ–°çš„ï¼Œåœ¨å†…å­˜ä¸­æœ‰æ–°çš„åœ°å€ï¼Œå¯¹å…‹éš†å¯¹è±¡æ‰€äº§ç”Ÿçš„å¯¹è±¡è¿›è¡Œä¿®æ”¹ä¸ä¼šå¯¹åŸå‹å¯¹è±¡äº§ç”Ÿä»»ä½•å½±å“ã€‚</p><h2 id="1-2-åŒ…å«è§’è‰²"><a href="#1-2-åŒ…å«è§’è‰²" class="headerlink" title="1.2 åŒ…å«è§’è‰²"></a>1.2 åŒ…å«è§’è‰²</h2><p><img src="https://i.loli.net/2020/02/03/NSa3iLpPcvoCfIq.gif" alt="1.gif"></p><ul><li>Prototype (æŠ½è±¡åŸå‹ç±»)</li></ul><p>æ˜¯å£°æ˜å…‹éš†æ–¹æ³•çš„æ¥å£ï¼Œæ˜¯æ‰€æœ‰å…·ä½“ç±»å‹ç±»çš„å…¬å…±çˆ¶ç±»ã€‚æŠ½è±¡ç±»/ æ¥å£/ å…·ä½“å®ç°ç±»</p><ul><li>ConcretePrototype (å…·ä½“åŸå‹ç±»)</li></ul><p>å®ç°äº†æŠ½è±¡åŸå‹ç±»ä¸­å£°æ˜çš„å…‹éš†æ–¹æ³•ï¼Œåœ¨å…‹éš†æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªè‡ªå·±çš„å…‹éš†å¯¹è±¡</p><ul><li>Client</li></ul><p>è®©ä¸€ä¸ªåŸå‹å¯¹è±¡å…‹éš†è‡ªèº«ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å®¢æˆ·ç±»é’ˆå¯¹æŠ½è±¡åŸå‹ç±»Prototypeç¼–ç¨‹ï¼Œå› æ­¤ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©å…·ä½“åŸå‹ç±»ï¼Œæ‰©å±•æ€§åŠ å¼ºäº†ã€‚</p><h1 id="2-åŸå‹æ¨¡å¼çš„å®ç°"><a href="#2-åŸå‹æ¨¡å¼çš„å®ç°" class="headerlink" title="2. åŸå‹æ¨¡å¼çš„å®ç°"></a>2. åŸå‹æ¨¡å¼çš„å®ç°</h1><h2 id="2-1-é€šç”¨å®ç°æ–¹æ³•"><a href="#2-1-é€šç”¨å®ç°æ–¹æ³•" class="headerlink" title="2.1 é€šç”¨å®ç°æ–¹æ³•"></a>2.1 é€šç”¨å®ç°æ–¹æ³•</h2><pre><code>class ConcretePrototype implements Prototype {    private String attr; //æˆå‘˜å±æ€§    public void setAttr(String attr) {        this.attr = attr;    }    public String getAttr() {        return this.attr;    }    public Prototype clone() //å…‹éš†æ–¹æ³•    {        Prototype prototype = new ConcretePrototype(); //åˆ›å»ºæ–°å¯¹è±¡        prototype.setAttr(this.attr);        return prototype;    }}</code></pre><h2 id="2-2-Javaæä¾›çš„clone-æ–¹æ³•"><a href="#2-2-Javaæä¾›çš„clone-æ–¹æ³•" class="headerlink" title="2.2 Javaæä¾›çš„clone()æ–¹æ³•"></a>2.2 Javaæä¾›çš„clone()æ–¹æ³•</h2><p>æ‰€æœ‰çš„Javaç±»éƒ½ç»§æ‰¿è‡ªjava.lang.Objectã€‚äº‹å®ä¸Šï¼ŒObjectæä¾›äº†clone()æ–¹æ³•ï¼Œå¯ä»¥å°†ä¸€ä¸ªJavaå¯¹è±¡å¤åˆ¶ä¸€ä»½ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥å®ç°å…‹éš†çš„ã€‚</p><pre><code>class ConcretePrototype implements Cloneable {    public Prototype clone() {    ã€€ã€€Object object = null;    ã€€ã€€try {    ã€€ã€€ã€€ã€€ã€€object = super.clone();    ã€€ã€€} catch (CloneNotSupportedException exception) {    ã€€ã€€ã€€ã€€ã€€System.err.println(&quot;Not support cloneable&quot;);    ã€€ã€€}    ã€€ã€€return (Prototype )object;    }}</code></pre><p>Javaä¸­çš„clone()æ»¡è¶³ï¼š</p><ol><li>å¯¹äºä»»ä½•å¯¹è±¡ï¼Œéƒ½æœ‰<code>x.clone() != x</code>ï¼Œå³å…‹éš†æ–¹æ³•åˆ›å»ºäº†æ–°çš„å¯¹è±¡</li><li>å¯¹äºä»»ä½•å¯¹è±¡ï¼Œéƒ½æœ‰<code>x.clone().getClass() == x.getClass()</code>ï¼Œå³å…‹éš†å¯¹è±¡ä¸åŸå‹å¯¹è±¡çš„ç±»å‹ä¸€æ ·</li><li>æ´¾ç”Ÿç±»éœ€è¦å®ç°Cloneableæ¥å£</li></ol><h1 id="3-åŸå‹æ¨¡å¼å®ç°å·¥ä½œå‘¨æŠ¥å¿«é€Ÿåˆ›å»º"><a href="#3-åŸå‹æ¨¡å¼å®ç°å·¥ä½œå‘¨æŠ¥å¿«é€Ÿåˆ›å»º" class="headerlink" title="3. åŸå‹æ¨¡å¼å®ç°å·¥ä½œå‘¨æŠ¥å¿«é€Ÿåˆ›å»º"></a>3. åŸå‹æ¨¡å¼å®ç°å·¥ä½œå‘¨æŠ¥å¿«é€Ÿåˆ›å»º</h1><p><img src="https://i.loli.net/2020/02/03/Ci24JYEqs6z8GgX.gif" alt="2.gif"></p><p>å¿«é€Ÿåˆ›å»ºå‘¨æŠ¥ç»“æ„å›¾</p><p>//å·¥ä½œå‘¨æŠ¥WeeklyLogï¼šå…·ä½“åŸå‹ç±»ï¼Œè€ƒè™‘åˆ°ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç†è§£æ€§ï¼Œåªåˆ—å‡ºéƒ¨åˆ†ä¸æ¨¡å¼ç›¸å…³çš„æ ¸å¿ƒä»£ç </p><pre><code>class WeeklyLog implements Cloneable{    private String name;    private String date;    private String content;    public  void setName(String name) {        this.name  = name;    }    public  void setDate(String date) {        this.date  = date;    }    public  void setContent(String content) {        this.content  = content;    }    public  String getName() {        return  (this.name);    }    public  String getDate() {        return  (this.date);    }    public  String getContent() {        return  (this.content);    }     //å…‹éš†æ–¹æ³•clone()ï¼Œæ­¤å¤„ä½¿ç”¨Javaè¯­è¨€æä¾›çš„å…‹éš†æœºåˆ¶    public WeeklyLog clone()    {        Object obj = null;        try {        obj = super.clone();        return (WeeklyLog)obj;      } catch(CloneNotSupportedException e) {        System.out.println(&quot;ä¸æ”¯æŒå¤åˆ¶ï¼&quot;);        return null;        }    }}</code></pre><p>æµ‹è¯•ä»£ç :</p><pre><code>class Client{    public  static void main(String args[])    {              WeeklyLog log_previous = new WeeklyLog();  //åˆ›å»ºåŸå‹å¯¹è±¡              log_previous.setName(&quot;å¼ æ— å¿Œ&quot;);              log_previous.setDate(&quot;ç¬¬12å‘¨&quot;);              log_previous.setContent(&quot;è¿™å‘¨å·¥ä½œå¾ˆå¿™ï¼Œæ¯å¤©åŠ ç­ï¼&quot;);              System.out.println(&quot;****å‘¨æŠ¥****&quot;);              System.out.println(&quot;å‘¨æ¬¡ï¼š&quot; +  log_previous.getDate());              System.out.println(&quot;å§“åï¼š&quot; +  log_previous.getName());              System.out.println(&quot;å†…å®¹ï¼š&quot; +  log_previous.getContent());              System.out.println(&quot;--------------------------------&quot;);              WeeklyLog  log_new;              log_new  = log_previous.clone(); //è°ƒç”¨å…‹éš†æ–¹æ³•åˆ›å»ºå…‹éš†å¯¹è±¡              log_new.setDate(&quot;ç¬¬13å‘¨&quot;);              System.out.println(&quot;****å‘¨æŠ¥****&quot;);              System.out.println(&quot;å‘¨æ¬¡ï¼š&quot; + log_new.getDate());              System.out.println(&quot;å§“åï¼š&quot; + log_new.getName());              System.out.println(&quot;å†…å®¹ï¼š&quot; + log_new.getContent());       }}</code></pre><h1 id="4-æµ…å…‹éš†ä¸æ·±å…‹éš†"><a href="#4-æµ…å…‹éš†ä¸æ·±å…‹éš†" class="headerlink" title="4. æµ…å…‹éš†ä¸æ·±å…‹éš†"></a>4. æµ…å…‹éš†ä¸æ·±å…‹éš†</h1><p>åœ¨javaä¸­ï¼Œæ•°æ®ç±»å‹åˆ†ä¸ºå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œå€¼ç±»å‹åŒ…æ‹¬int,double, byte, boolean, charç­‰ï¼Œå¼•ç”¨ç±»å‹åŒ…æ‹¬ç±»ï¼Œæ¥å£ï¼Œæ•°ç»„ç­‰ã€‚æµ…å…‹éš†ä¸æ·±å…‹éš†çš„åŒºåˆ«åœ¨äºæ˜¯å¦æ”¯æŒå¼•ç”¨ç±»å‹çš„æˆå‘˜å˜é‡çš„å¤åˆ¶ã€‚</p><h2 id="4-1-æµ…å…‹éš†"><a href="#4-1-æµ…å…‹éš†" class="headerlink" title="4.1 æµ…å…‹éš†"></a>4.1 æµ…å…‹éš†</h2><p><img src="https://i.loli.net/2020/02/03/xbMHXnZEd3NJlgh.gif" alt="3.gif"><br>æµ…å…‹éš†ç¤ºæ„å›¾</p><p>å¦‚æœåŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™å°†å¼•ç”¨å¯¹è±¡çš„åœ°å€å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´äºŒè€…çš„æˆå‘˜å˜é‡æŒ‡å‘äº†ç›¸åŒçš„å†…å­˜åœ°å€ã€‚<strong><em>åœ¨æµ…å…‹éš†ä¸­ï¼Œå½“å¯¹è±¡è¢«å¤åˆ¶æ—¶åªå¤åˆ¶å®ƒæœ¬èº«å’Œå…¶ä¸­åŒ…å«çš„å€¼ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè€Œå¼•ç”¨ç±»å‹çš„æˆå‘˜å¯¹è±¡å¹¶æ²¡æœ‰å¤åˆ¶</em></strong>ã€‚</p><p><img src="https://i.loli.net/2020/02/03/KiLnFxBw2ODJvuI.gif" alt="4.gif"><br>å¸¦é™„ä»¶çš„å‘¨æŠ¥ç»“æ„å›¾</p><p>é™„ä»¶ç±»ä»£ç ï¼š</p><pre><code>//é™„ä»¶ç±»class Attachment{    private String name; //é™„ä»¶å    public void setName(String name) {        this.name = name;    }    public String getName() {        return this.name;    }    public void download() {        System.out.println(&quot;ä¸‹è½½é™„ä»¶ï¼Œæ–‡ä»¶åä¸º&quot; + name);    }}</code></pre><p>å·¥ä½œå‘¨æŠ¥ç±»ä»£ç </p><pre><code>//å·¥ä½œå‘¨æŠ¥WeeklyLogclass WeeklyLog implements Cloneable{     //ä¸ºäº†ç®€åŒ–è®¾è®¡å’Œå®ç°ï¼Œå‡è®¾ä¸€ä»½å·¥ä½œå‘¨æŠ¥ä¸­åªæœ‰ä¸€ä¸ªé™„ä»¶å¯¹è±¡ï¼Œå®é™…æƒ…å†µä¸­å¯ä»¥åŒ…å«å¤šä¸ªé™„ä»¶ï¼Œå¯ä»¥é€šè¿‡Listç­‰é›†åˆå¯¹è±¡æ¥å®ç°       private Attachment attachment;       private String name;       private  String date;       private  String content;       public void setAttachment(Attachment  attachment) {              this.attachment = attachment;       }       public  void setName(String name) {              this.name  = name;       }       public  void setDate(String date) {              this.date  = date;       }       public  void setContent(String content) {              this.content  = content;       }       public Attachment  getAttachment(){              return (this.attachment);       }       public  String getName() {              return  (this.name);       }       public  String getDate() {              return  (this.date);       }       public  String getContent() {              return  (this.content);       }     //ä½¿ç”¨clone()æ–¹æ³•å®ç°æµ…å…‹éš†       public WeeklyLog clone()       {              Object obj = null;              try              {                     obj = super.clone();                     return (WeeklyLog)obj;              }              catch(CloneNotSupportedException  e)              {                System.out.println(&quot;ä¸æ”¯æŒå¤åˆ¶ï¼&quot;);                     return null;              }       }}</code></pre><p>å®¢æˆ·ç«¯ä»£ç ï¼š</p><pre><code>class Client{       public  static void main(String args[])       {              WeeklyLog  log_previous, log_new;              log_previous  = new WeeklyLog(); //åˆ›å»ºåŸå‹å¯¹è±¡              Attachment  attachment = new Attachment(); //åˆ›å»ºé™„ä»¶å¯¹è±¡              log_previous.setAttachment(attachment);  //å°†é™„ä»¶æ·»åŠ åˆ°å‘¨æŠ¥ä¸­              log_new  = log_previous.clone(); //è°ƒç”¨å…‹éš†æ–¹æ³•åˆ›å»ºå…‹éš†å¯¹è±¡              //æ¯”è¾ƒå‘¨æŠ¥              System.out.println(&quot;å‘¨æŠ¥æ˜¯å¦ç›¸åŒï¼Ÿ &quot; + (log_previous ==  log_new));              //æ¯”è¾ƒé™„ä»¶              System.out.println(&quot;é™„ä»¶æ˜¯å¦ç›¸åŒï¼Ÿ &quot; +  (log_previous.getAttachment() == log_new.getAttachment()));       }}</code></pre><h2 id="4-2-æ·±å…‹éš†"><a href="#4-2-æ·±å…‹éš†" class="headerlink" title="4.2 æ·±å…‹éš†"></a>4.2 æ·±å…‹éš†</h2><p>æ— è®ºåŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ï¼Œéƒ½å°†å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ã€‚å³æ·±å…‹éš†ä¸­ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«è¢«å¤åˆ¶å¤–ï¼Œå¯¹è±¡æ‰€åŒ…å«çš„æ‰€æœ‰æˆå‘˜å˜é‡ä¹Ÿå°†å¤åˆ¶ã€‚</p><p><img src="https://i.loli.net/2020/02/03/6QblH4gmPvqx2FN.gif" alt="5.gif"><br>æ·±å…‹éš†ç¤ºæ„å›¾</p><p>å¦‚æœè¦å®ç°æ·±å…‹éš†ï¼Œåœ¨Javaä¸­å¯ä»¥é€šè¿‡åºåˆ—åŒ–Serializationç­‰æ–¹å¼æ¥å®ç°ã€‚</p><p>åºåˆ—åŒ–ï¼Œå°†å¯¹è±¡å†™åˆ°æµé‡Œï¼Œé€šè¿‡åºåˆ—åŒ–çš„æ‹·è´ä¸ä»…å¯ä»¥å¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œä¹Ÿå¯ä»¥å¤åˆ¶å…¶å¼•ç”¨çš„æˆå‘˜å¯¹è±¡ã€‚å› æ­¤é€šè¿‡åºåˆ—åŒ–å°†å¯¹è±¡å†™åˆ°ä¸€ä¸ªæµä¸­ï¼Œå†ä»æµé‡Œå°†å…¶è¯»å‡ºæ¥ï¼Œå¯ä»¥å®ç°æ·±å…‹éš†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°åºåˆ—åŒ–çš„å¯¹è±¡å…¶ç±»å¿…é¡»å®ç°<strong>Serializableæ¥å£</strong>ï¼Œå¦åˆ™æ— æ³•å®ç°åºåˆ—åŒ–æ“ä½œã€‚</p><p><img src="https://i.loli.net/2020/02/03/1vYLodkxTpSJ5q2.gif" alt="6.gif"><br>å¸¦é™„ä»¶çš„å‘¨æŠ¥ç»“æ„å›¾</p><p>é™„ä»¶ç±»ï¼š</p><p>import  java.io.*;</p><p>//é™„ä»¶ç±»</p><pre><code>class  Attachment implements Serializable{       private  String name; //é™„ä»¶å       public  void setName(String name)       {              this.name  = name;       }       public  String getName()       {              return  this.name;       }     public void download()     {            System.out.println(&quot;ä¸‹è½½é™„ä»¶ï¼Œæ–‡ä»¶åä¸º&quot; + name);     }}</code></pre><p>å·¥ä½œå‘¨æŠ¥ç±»ä»£ç å®ç°ï¼š</p><pre><code>import  java.io.*;//å·¥ä½œå‘¨æŠ¥ç±»class  WeeklyLog implements Serializable{       private  Attachment attachment;       private  String name;       private  String date;       private  String content;       public  void setAttachment(Attachment attachment) {              this.attachment  = attachment;       }       public  void setName(String name) {              this.name  = name       }       public  void setDate(String date) {              this.date  = date;       }       public  void setContent(String content) {              this.content  = content;       }       public  Attachment getAttachment(){              return  (this.attachment);       }       public  String getName() {              return  (this.name);       }       public  String getDate() {              return  (this.date);       }       public  String getContent() {              return  (this.content);       }   //ä½¿ç”¨åºåˆ—åŒ–æŠ€æœ¯å®ç°æ·±å…‹éš†       public WeeklyLog deepClone() throws  IOException, ClassNotFoundException, OptionalDataException       {              //å°†å¯¹è±¡å†™å…¥æµä¸­              ByteArrayOutputStream bao=new  ByteArrayOutputStream();              ObjectOutputStream oos=new  ObjectOutputStream(bao);              oos.writeObject(this);              //å°†å¯¹è±¡ä»æµä¸­å–å‡º              ByteArrayInputStream bis=new  ByteArrayInputStream(bao.toByteArray());              ObjectInputStream ois=new  ObjectInputStream(bis);              return  (WeeklyLog)ois.readObject();       }}</code></pre><p>å®¢æˆ·ç«¯ä»£ç ï¼š</p><pre><code>class Client{       public  static void main(String args[])       {              WeeklyLog  log_previous, log_new = null;              log_previous  = new WeeklyLog(); //åˆ›å»ºåŸå‹å¯¹è±¡              Attachment  attachment = new Attachment(); //åˆ›å»ºé™„ä»¶å¯¹è±¡              log_previous.setAttachment(attachment);  //å°†é™„ä»¶æ·»åŠ åˆ°å‘¨æŠ¥ä¸­              try              {                     log_new =  log_previous.deepClone(); //è°ƒç”¨æ·±å…‹éš†æ–¹æ³•åˆ›å»ºå…‹éš†å¯¹è±¡                                }              catch(Exception e)              {                  System.err.println(&quot;å…‹éš†å¤±è´¥ï¼&quot;);              }              //æ¯”è¾ƒå‘¨æŠ¥              System.out.println(&quot;å‘¨æŠ¥æ˜¯å¦ç›¸åŒï¼Ÿ &quot; + (log_previous ==  log_new));              //æ¯”è¾ƒé™„ä»¶              System.out.println(&quot;é™„ä»¶æ˜¯å¦ç›¸åŒï¼Ÿ &quot; +  (log_previous.getAttachment() == log_new.getAttachment()));       }}</code></pre><blockquote><p>Tips: javaä¸­çš„Cloneableå’ŒSerializableæ¥å£çš„ä»£ç å¾ˆç®€å•ï¼Œéƒ½æ˜¯ç©ºæ¥å£ï¼Œä¹Ÿæˆä¸ºæ ‡è¯†æ¥å£ï¼Œå…¶ä¸­æ²¡æœ‰ä»»ä½•æ–¹æ³•çš„å®šä¹‰ï¼Œå…¶ä½œç”¨æ˜¯å‘Šè¯‰JREè¿™äº›æ¥å£çš„å®ç°ç±»æ˜¯å¦å…·æœ‰æŸä¸ªåŠŸèƒ½ã€‚</p></blockquote><h2 id="4-3-Javaä¸­å®ç°æ·±å…‹éš†çš„æ–¹æ³•æµ…æ"><a href="#4-3-Javaä¸­å®ç°æ·±å…‹éš†çš„æ–¹æ³•æµ…æ" class="headerlink" title="4.3 Javaä¸­å®ç°æ·±å…‹éš†çš„æ–¹æ³•æµ…æ"></a>4.3 Javaä¸­å®ç°æ·±å…‹éš†çš„æ–¹æ³•æµ…æ</h2><h3 id="4-3-1-Apache-Commons-Lang"><a href="#4-3-1-Apache-Commons-Lang" class="headerlink" title="4.3.1 Apache Commons Lang"></a>4.3.1 Apache Commons Lang</h3><p>SerializationUtils#clone, will perform a deep copy when all classes in the object graph implement the serializable interface. </p><h3 id="4-3-2-Json-Serialization-with-Gson"><a href="#4-3-2-Json-Serialization-with-Gson" class="headerlink" title="4.3.2 Json Serialization with Gson"></a>4.3.2 Json Serialization with Gson</h3><p>No need for Serializable interface</p><pre><code>gson.fromJson(gson.toJson(userA), User.class);</code></pre><h3 id="4-3-3-constructor"><a href="#4-3-3-constructor" class="headerlink" title="4.3.3 constructor"></a>4.3.3 constructor</h3><p>ç›´æ¥handmade, ç”¨constructorç”Ÿæˆä¸€ä¸ªæ–°çš„æƒ³è¦çš„å¯¹è±¡ã€‚</p><h1 id="5-åŸå‹ç®¡ç†å™¨"><a href="#5-åŸå‹ç®¡ç†å™¨" class="headerlink" title="5. åŸå‹ç®¡ç†å™¨"></a>5. åŸå‹ç®¡ç†å™¨</h1><p>åŸå‹ç®¡ç†å™¨(Prototype Manager)æ˜¯å°†å¤šä¸ªåŸå‹å¯¹è±¡å­˜å‚¨åœ¨ä¸€ä¸ªé›†åˆä¸­ä¾›å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸“é—¨è´Ÿè´£å…‹éš†å¯¹è±¡çš„å·¥å‚ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªé›†åˆç”¨äºå­˜å‚¨åŸå‹å¯¹è±¡ï¼Œå¦‚æœéœ€è¦æŸä¸ªåŸå‹å¯¹è±¡çš„ä¸€ä¸ªå…‹éš†ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶é›†åˆä¸­å¯¹åº”çš„åŸå‹å¯¹è±¡æ¥è·å¾—ã€‚åœ¨åŸå‹ç®¡ç†å™¨ä¸­é’ˆå¯¹æŠ½è±¡åŸå‹ç±»è¿›è¡Œç¼–ç¨‹ï¼Œä»¥ä¾¿æ‰©å±•ã€‚</p><p><img src="https://i.loli.net/2020/02/03/9UmnSAyI7az4kjl.gif" alt="7.gif"><br>å¸¦åŸå‹ç®¡ç†å™¨çš„åŸå‹æ¨¡å¼å›¾ </p><h2 id="5-1-å®ä¾‹-å…¬æ–‡ç®¡ç†å™¨"><a href="#5-1-å®ä¾‹-å…¬æ–‡ç®¡ç†å™¨" class="headerlink" title="5.1 å®ä¾‹-å…¬æ–‡ç®¡ç†å™¨"></a>5.1 å®ä¾‹-å…¬æ–‡ç®¡ç†å™¨</h2><p><img src="https://i.loli.net/2020/02/03/zE3ahLk6lvKfw4J.gif" alt="8.gif"><br>å…¬æ–‡ç®¡ç†å™¨ç»“æ„å›¾</p><p>ä»£ç å®ç°ï¼š </p><pre><code>import java.util.*;//æŠ½è±¡å…¬æ–‡æ¥å£ï¼Œä¹Ÿå¯å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œæä¾›clone()æ–¹æ³•çš„å®ç°ï¼Œå°†ä¸šåŠ¡æ–¹æ³•å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•interface OfficialDocument extends  Cloneable{       public  OfficialDocument clone();       public  void display();}//å¯è¡Œæ€§åˆ†ææŠ¥å‘Š(Feasibility Analysis Report)ç±»class FAR implements OfficialDocument{       public  OfficialDocument clone()      {              OfficialDocument  far = null;              try              {                     far  = (OfficialDocument)super.clone();              }              catch(CloneNotSupportedException  e)              {                  System.out.println(&quot;ä¸æ”¯æŒå¤åˆ¶ï¼&quot;);              }              return  far;       }       public  void display()       {         System.out.println(&quot;ã€Šå¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€‹&quot;);       }}//è½¯ä»¶éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦(Software Requirements Specification)ç±»class SRS implements OfficialDocument{       public  OfficialDocument clone()       {              OfficialDocument  srs = null;              try              {                     srs  = (OfficialDocument)super.clone();              }              catch(CloneNotSupportedException  e)              {                 System.out.println(&quot;ä¸æ”¯æŒå¤åˆ¶ï¼&quot;);              }              return  srs;       }       public  void display()       {             System.out.println(&quot;ã€Šè½¯ä»¶éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ã€‹&quot;);       }}//åŸå‹ç®¡ç†å™¨ï¼ˆä½¿ç”¨é¥¿æ±‰å¼å•ä¾‹å®ç°ï¼‰class  PrototypeManager{       //å®šä¹‰ä¸€ä¸ªHashtableï¼Œç”¨äºå­˜å‚¨åŸå‹å¯¹è±¡       private Hashtable ht=new Hashtable();       private static PrototypeManager pm =  new PrototypeManager();       //ä¸ºHashtableå¢åŠ å…¬æ–‡å¯¹è±¡        private  PrototypeManager()     {              ht.put(&quot;far&quot;,new  FAR());              ht.put(&quot;srs&quot;,new  SRS());                    }     //å¢åŠ æ–°çš„å…¬æ–‡å¯¹è±¡       public void addOfficialDocument(String  key,OfficialDocument doc)       {              ht.put(key,doc);       }       //é€šè¿‡æµ…å…‹éš†è·å–æ–°çš„å…¬æ–‡å¯¹è±¡       public OfficialDocument  getOfficialDocument(String key)       {              return  ((OfficialDocument)ht.get(key)).clone();       }       public static PrototypeManager  getPrototypeManager()       {              return pm;       }}</code></pre><p>å®¢æˆ·ç«¯ä»£ç å¦‚ä¸‹ï¼š </p><pre><code>class Client{       public  static void main(String args[])       {              //è·å–åŸå‹ç®¡ç†å™¨å¯¹è±¡              PrototypeManager pm =  PrototypeManager.getPrototypeManager();                OfficialDocument  doc1,doc2,doc3,doc4;              doc1  = pm.getOfficialDocument(&quot;far&quot;);              doc1.display();              doc2  = pm.getOfficialDocument(&quot;far&quot;);              doc2.display();              System.out.println(doc1  == doc2);              doc3  = pm.getOfficialDocument(&quot;srs&quot;);              doc3.display();              doc4  = pm.getOfficialDocument(&quot;srs&quot;);              doc4.display();              System.out.println(doc3  == doc4);       }}</code></pre><p> åœ¨PrototypeManagerä¸­å®šä¹‰äº†ä¸€ä¸ªHashtableç±»å‹çš„é›†åˆå¯¹è±¡ï¼Œä½¿ç”¨â€œé”®å€¼å¯¹â€æ¥å­˜å‚¨åŸå‹å¯¹è±¡ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡Keyï¼ˆå¦‚â€œfarâ€æˆ–â€œsrsâ€ï¼‰æ¥è·å–å¯¹åº”åŸå‹å¯¹è±¡çš„å…‹éš†å¯¹è±¡ã€‚PrototypeManagerç±»æä¾›äº†ç±»ä¼¼å·¥å‚æ–¹æ³•çš„getOfficialDocument()æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ªå…‹éš†å¯¹è±¡ã€‚</p><h1 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h1><h2 id="6-1-ä¼˜ç‚¹"><a href="#6-1-ä¼˜ç‚¹" class="headerlink" title="6.1 ä¼˜ç‚¹"></a>6.1 ä¼˜ç‚¹</h2><ol><li>ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹</li><li>å®¢æˆ·ç«¯å¯ä»¥é’ˆå¯¹æŠ½è±¡åŸå‹ç±»è¿›è¡Œç¼–ç¨‹ï¼Œå…·ä½“åŸå‹ç±»å†™åœ¨é…ç½®æ–‡ä»¶ä¸­</li><li>æŠ€å·¥ç®€åŒ–çš„åˆ›å»ºç»“æ„</li></ol><h2 id="6-2-ç¼ºç‚¹"><a href="#6-2-ç¼ºç‚¹" class="headerlink" title="6.2 ç¼ºç‚¹"></a>6.2 ç¼ºç‚¹</h2><ol><li>æ¯ä¸€ä¸ªç±»æœ‰è‡ªå·±çš„å…‹éš†æ–¹æ³•ï¼Œä¸”ä½äºä¸€ä¸ªç±»çš„å†…éƒ¨ï¼Œå¯¹å·²æœ‰ç±»è¿›è¡Œæ”¹é€ çš„æ—¶å€™ï¼Œéœ€è¦ä¿®æ”¹æºä»£ç </li><li>æ·±å…‹éš†å¤æ‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h1><p>è§‚å¯Ÿè€…æ¨¡å¼æ—¨åœ¨æè¿°å¦‚ä¸‹è¡Œä¸ºï¼šå³ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€æˆ–è€…è¡Œä¸ºçš„å˜åŒ–å°†å¯¼è‡´å…¶ä»–å¯¹è±¡çš„çŠ¶æ€æˆ–è€…è¡Œä¸ºä¹Ÿå‘ç”Ÿå˜åŒ–ï¼Œä»–ä»¬ä¹‹é—´å°†äº§ç”Ÿè”åŠ¨ã€‚ä¸ºäº†æ›´å¥½åœ°æè¿°å¯¹è±¡ä¹‹é—´è¿™ç§ä¸€å¯¹å¤š(ä¸€å¯¹ä¸€)çš„è”åŠ¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼åº”è¿è€Œç”Ÿï¼Œå…¶å®šä¹‰äº†å¯¹è±¡ä¹‹é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜èƒ½å¤Ÿå½±å“å…¶ä»–å¯¹è±¡ã€‚</p><ul><li>Publish/ subscribe</li><li>Model/ View</li><li>Source/ Listener </li></ul><h1 id="2-æ¦‚è¿°"><a href="#2-æ¦‚è¿°" class="headerlink" title="2. æ¦‚è¿°"></a>2. æ¦‚è¿°</h1><p><img src="https://i.loli.net/2020/02/03/M6poTJ5PChWrReB.jpg" alt="fig1.jpg"></p><ul><li>subject<ul><li>è¢«è§‚å¯Ÿçš„å¯¹è±¡</li><li>åœ¨subjectå½“ä¸­å®šä¹‰äº†ä¸€ä¸ªè§‚å¯Ÿè€…çš„é›†åˆ</li><li>ä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…æ¥è§‚å¯Ÿ</li><li>å®šä¹‰äº†é€šçŸ¥æ–¹æ³•notify() </li></ul></li><li>concreteSubject <ul><li>å…·ä½“ç›®æ ‡ï¼Œç›®æ ‡ç±»çš„å­ç±»</li><li>é€šå¸¸åŒ…å«<strong>ç»å¸¸å‘ç”Ÿæ”¹å˜çš„æ•°æ®</strong>ï¼Œå½“å…¶çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå‘å®ƒçš„å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ï¼›åŒæ—¶å®ƒè¿˜å®ç°äº†åœ¨ç›®æ ‡ç±»å½“ä¸­å®šä¹‰çš„æŠ½è±¡ä¸šåŠ¡é€»è¾‘æ–¹æ³•ã€‚</li></ul></li><li>observer<ul><li>è§‚å¯Ÿè€…å°†å¯¹è§‚å¯Ÿç›®æ ‡çš„æ”¹å˜åšå‡ºååº”ï¼Œè§‚å¯Ÿè€…ä¸€èˆ¬å®šä¹‰ä¸ºæ¥å£ï¼Œè¯¥æ¥å£å£°æ˜äº†æ›´æ–°æ•°æ®çš„æ–¹æ³•update()</li></ul></li><li>concreteObserver<ul><li>åœ¨å…·ä½“è§‚å¯Ÿè€…ä¸­ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…·ä½“ç›®æ ‡çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œå­˜å‚¨å…·ä½“è§‚å¯Ÿè€…çš„æœ‰å…³çŠ¶æ€ã€‚è¿™äº›çŠ¶æ€éœ€è¦å’Œå…·ä½“ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ï¼Œå®ç°äº†update()æ–¹æ³•ã€‚</li></ul></li></ul><pre><code>import java.util.*;abstract class Subject {    //å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆç”¨äºå­˜å‚¨æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡    protected ArrayList&lt;Observer&gt; observers= new ArrayList();    //æ³¨å†Œæ–¹æ³•ï¼Œç”¨äºå‘è§‚å¯Ÿè€…é›†åˆä¸­å¢åŠ ä¸€ä¸ªè§‚å¯Ÿè€…    public void attach(Observer observer) {        observers.add(observer);    }    //æ³¨é”€æ–¹æ³•ï¼Œç”¨äºåœ¨è§‚å¯Ÿè€…é›†åˆä¸­åˆ é™¤ä¸€ä¸ªè§‚å¯Ÿè€…    public void detach(Observer observer) {        observers.remove(observer);    }    //å£°æ˜æŠ½è±¡é€šçŸ¥æ–¹æ³•    public abstract void notify();}class ConcreteSubject extends Subject {    //å®ç°é€šçŸ¥æ–¹æ³•    public void notify() {        //éå†è§‚å¯Ÿè€…é›†åˆï¼Œè°ƒç”¨æ¯ä¸€ä¸ªè§‚å¯Ÿè€…çš„å“åº”æ–¹æ³•        for(Object obs:observers) {            ((Observer)obs).update();        }    }    }interface Observer {    //å£°æ˜å“åº”æ–¹æ³•    public void update();}class ConcreteObserver implements Observer {    //å®ç°å“åº”æ–¹æ³•    public void update() {        //å…·ä½“å“åº”ä»£ç     }}</code></pre><h1 id="3-JDKå¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ"><a href="#3-JDKå¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ" class="headerlink" title="3. JDKå¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ"></a>3. JDKå¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ</h1><p><img src="https://i.loli.net/2020/02/03/tv5Zh68AQiSfIXC.jpg" alt="fig2.jpg"></p><ul><li>Observable ç±»<ul><li>å®šä¹‰äº†ä¸€ä¸ªListæ¥å­˜å‚¨è§‚å¯Ÿè€…å¯¹è±¡</li><li>addObserver(Observer o)</li><li>deleteObserver(Observer o)</li><li>notifyObservers()</li><li>deleteObservers()</li><li>setChanged()</li><li>clearChanged()</li><li>hasChanged()</li><li>countObservers()</li></ul></li></ul><p>Observeræ¥å£è¿˜æœ‰Observableç±»å¯ä»¥ç›´æ¥ä½œä¸ºè§‚å¯Ÿè€…æ¨¡å¼çš„æŠ½è±¡å±‚ï¼Œå†è‡ªå®šä¹‰å…·ä½“è§‚å¯Ÿè€…ç±»å’Œå…·ä½“çš„è§‚å¯Ÿç›®æ ‡ç±»ã€‚</p><h1 id="4-Review"><a href="#4-Review" class="headerlink" title="4. Review"></a>4. Review</h1><ul><li>ä¼˜ç‚¹<ul><li>å®ç°è¡¨ç¤ºå±‚å’Œæ•°æ®é€»è¾‘å±‚çš„åˆ†ç¦»ï¼Œå®šä¹‰äº†ç¨³å®šçš„æ¶ˆæ¯æ›´æ–°ä¼ é€’æœºåˆ¶ï¼Œå¹¶æŠ½è±¡äº†æ›´æ–°æ¥å£</li><li>åœ¨è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹ä¸€ä¸ªæŠ½è±¡çš„è€¦åˆ</li><li>è§‚å¯Ÿç›®æ ‡åªéœ€è¦ç»´æŒä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…çš„é›†åˆï¼Œæ— é¡»äº†è§£å…¶å…·ä½“çš„è§‚å¯Ÿè€…</li></ul></li><li>ç¼ºé™·<ul><li>å¤ªå¤šè§‚å¯Ÿè€…ï¼Œéƒ½é€šçŸ¥å¾ˆè€—æ—¶çš„</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.csdn.net/lovelion/article/details/7720232" target="_blank" rel="noopener">https://blog.csdn.net/lovelion/article/details/7720232</a></li><li><a href="https://blog.csdn.net/LoveLion/article/details/7720490" target="_blank" rel="noopener">https://blog.csdn.net/LoveLion/article/details/7720490</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Design Pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</title>
      <link href="/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/"/>
      <url>/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><p>æ”¯æŒå¯ç»´æŠ¤æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯å¤ç”¨æ€§</p><h1 id="2-è®¾è®¡åŸåˆ™"><a href="#2-è®¾è®¡åŸåˆ™" class="headerlink" title="2.è®¾è®¡åŸåˆ™"></a>2.è®¾è®¡åŸåˆ™</h1><h2 id="2-1-å•ä¸€èŒè´£åŸåˆ™-Single-Responsibility-Principle"><a href="#2-1-å•ä¸€èŒè´£åŸåˆ™-Single-Responsibility-Principle" class="headerlink" title="2.1 å•ä¸€èŒè´£åŸåˆ™ Single Responsibility Principle"></a>2.1 å•ä¸€èŒè´£åŸåˆ™ Single Responsibility Principle</h2><p>ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£ï¼Œåªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£ã€‚</p><p>æ‰¿æ‹…çš„è´£ä»»è¶Šå¤šï¼Œé‚£è¢«å¤ç”¨çš„å¯èƒ½æ€§å°±è¶Šå°ã€‚å¤šèŒè´£æ„å‘³ç€æ˜¯æŠŠå¤šä¸ªç±»è€¦åˆäº†èµ·æ¥</p><p><img src="https://i.loli.net/2020/02/03/jKXMsxyiB6z3uac.jpg" alt="å•ä¸€èŒè´£1.jpg"><br>CustomerDataChartç±»åŒ…å«äº†ä¸æ•°æ®åº“çš„è¿æ¥ï¼ŒæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯å’Œåˆ›å»ºæ˜¾ç¤ºå›¾æ ‡ä¸‰å¤§æ–¹é¢çš„åŠŸèƒ½ï¼Œåº”è¯¥å°†å…¶åˆ†ä¸ºä¸‰ä¸ªç±»ï¼Œåˆ†åˆ«è¿›è¡Œå¤„ç†</p><p><img src="https://i.loli.net/2020/02/03/X4Z1TfBRzkMLSNW.jpg" alt="å•ä¸€èŒè´£2.jpg"><br>DBUtil  è´Ÿè´£è¿æ¥æ•°æ®åº“<br>CustomerDao è´Ÿè´£æ“ä½œæ•°æ®åº“ä¸­çš„Customerè¡¨<br>CustomerDataChart è´Ÿè´£å›¾è¡¨çš„ç”Ÿæˆçš„æ˜¾ç¤º</p><h2 id="2-2-å¼€é—­åŸåˆ™-Open-Closed-Principle"><a href="#2-2-å¼€é—­åŸåˆ™-Open-Closed-Principle" class="headerlink" title="2.2 å¼€é—­åŸåˆ™ Open-Closed Principle"></a>2.2 å¼€é—­åŸåˆ™ Open-Closed Principle</h2><p>è½¯ä»¶å®ä½“åº”å¯¹æ‹“å±•å¼€æ”¾ï¼Œè€Œå¯¹ä¿®æ”¹å…³é—­ã€‚<strong><em>è½¯ä»¶å®ä½“åº”è¯¥å°½é‡åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•ã€‚</em></strong></p><p>ä¸ºäº†æ»¡è¶³å¼€é—­åŸåˆ™ï¼Œéœ€è¦å¯¹ç³»ç»Ÿè¿›è¡ŒæŠ½è±¡åŒ–è®¾è®¡ï¼ï¼ï¼ä¸ºç³»ç»Ÿå®šä¹‰ä¸€ä¸ªç›¸å¯¹ç¨³å®šçš„æŠ½è±¡å±‚ï¼Œè€Œåå°†ä¸åŒçš„å®ç°è¡Œä¸ºç§»è‡³å…·ä½“çš„å®ç°å±‚ä¸­å®Œæˆã€‚å¦‚æœéœ€è¦ä¿®æ”¹ç³»ç»Ÿçš„è¡Œä¸ºï¼Œæ— é¡»å¯¹æŠ½è±¡å±‚è¿›è¡Œä»»ä½•æ”¹åŠ¨ï¼Œåªéœ€è¦å¢åŠ æ–°çš„å…·ä½“ç±»æ¥å®ç°æ–°çš„ä¸šåŠ¡åŠŸèƒ½å³å¯ï¼Œå®ç°åœ¨ä¸ä¿®æ”¹å·²æœ‰ä»£ç çš„åŸºç¡€ä¸Šæ‰©å±•ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œè¾¾åˆ°å¼€é—­åŸåˆ™çš„è¦æ±‚ã€‚</p><p><img src="https://i.loli.net/2020/02/03/6SEFzrxNtTgMPQK.jpg" alt="å¼€é—­åŸåˆ™1.jpg"></p><p><img src="https://i.loli.net/2020/02/03/bM73ZsD4UkdJ9QP.jpg" alt="å¼€é—­åŸåˆ™2.jpg"></p><p>åŠ ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ¯ä¸€ç§Chartå¯ä»¥extendsè¿™ä¸ªæŠ½è±¡ç±»ï¼Œç„¶ååšå…·ä½“çš„å®ç°ã€‚åœ¨ChartDisplayç±»ä¸­ï¼Œå¯ä»¥å®ä¾‹åŒ–Chartç±»ï¼Œè°ƒç”¨å…¶display()æ–¹æ³•æ¥æ˜¾ç¤ºå¯¹åº”çš„å›¾è¡¨ã€‚å½“è¦æ”¹å˜çš„æ—¶å€™ï¼ŒåŠ ä¸€ä¸ªå®ç°ç±»ï¼Œåœ¨å®¢æˆ·ç«¯æ³¨å…¥è¿™ä¸ªå¯¹è±¡å³å¯ã€‚</p><h2 id="2-3-é‡Œæ°ä»£æ¢åŸåˆ™-Liskov-Substitution-Principle"><a href="#2-3-é‡Œæ°ä»£æ¢åŸåˆ™-Liskov-Substitution-Principle" class="headerlink" title="2.3 é‡Œæ°ä»£æ¢åŸåˆ™ Liskov Substitution Principle"></a>2.3 é‡Œæ°ä»£æ¢åŸåˆ™ Liskov Substitution Principle</h2><p>æ‰€æœ‰å¼•ç”¨åŸºç±»å¯¹è±¡çš„åœ°æ–¹èƒ½å¤Ÿé€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡</p><p>åœ¨è½¯ä»¶ä¸­ï¼Œå°†ä¸€ä¸ªåŸºç±»çš„å¯¹è±¡æ›¿æ¢æˆå…¶å­ç±»å¯¹è±¡ï¼Œç¨‹åºå°†ä¸ä¼šäº§ç”Ÿä»»ä½•é”™è¯¯å’Œå¼‚å¸¸ï¼Œåè¿‡æ¥åˆ™ä¸æˆç«‹ã€‚</p><p>é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ã€‚ç”±äºä½¿ç”¨åŸºç±»å¯¹è±¡çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å­ç±»ï¼Œå› æ­¤<strong><em>åœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨åŸºç±»ç±»å‹æ¥å¯¹å¯¹è±¡è¿›è¡Œå®šä¹‰ï¼Œè€Œåœ¨è¿è¡Œæ—¶å†ç¡®å®šå…¶å­ç±»ç±»å‹ï¼Œç”¨å­ç±»å¯¹è±¡æ¥æ›¿æ¢çˆ¶ç±»å¯¹è±¡ã€‚</em></strong></p><h3 id="2-3-1-æ³¨æ„äº‹é¡¹"><a href="#2-3-1-æ³¨æ„äº‹é¡¹" class="headerlink" title="2.3.1 æ³¨æ„äº‹é¡¹"></a>2.3.1 æ³¨æ„äº‹é¡¹</h3><ol><li>å­ç±»çš„æ‰€æœ‰æ–¹æ³•å¿…é¡»åœ¨çˆ¶ç±»ä¸­å£°æ˜ï¼Œæˆ–å­ç±»å¿…é¡»å®ç°çˆ¶ç±»ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ã€‚æ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Œåœ¨ç¨‹åºä¸­é€šå¸¸ä½¿ç”¨çˆ¶ç±»æ¥è¿›è¡Œå®šä¹‰ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•åªå­˜åœ¨å­ç±»ä¸­ï¼Œåœ¨çˆ¶ç±»ä¸­ä¸æä¾›ç›¸åº”çš„å£°æ˜ï¼Œåˆ™æ— æ³•åœ¨ä»¥çˆ¶ç±»å®šä¹‰çš„å¯¹è±¡ä¸­ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</li><li>æˆ‘ä»¬åœ¨è¿ç”¨é‡Œæ°ä»£æ¢åŸåˆ™æ—¶ï¼Œå°½é‡æŠŠçˆ¶ç±»è®¾è®¡ä¸º<strong>æŠ½è±¡ç±»æˆ–è€…æ¥å£</strong>ï¼Œè®©å­ç±»ç»§æ‰¿çˆ¶ç±»æˆ–å®ç°çˆ¶æ¥å£ï¼Œå¹¶å®ç°åœ¨çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œè¿è¡Œæ—¶ï¼Œå­ç±»å®ä¾‹æ›¿æ¢çˆ¶ç±»å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰©å±•ç³»ç»Ÿçš„åŠŸèƒ½ï¼ŒåŒæ—¶æ— é¡»ä¿®æ”¹åŸæœ‰å­ç±»çš„ä»£ç ï¼Œå¢åŠ æ–°çš„åŠŸèƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªæ–°çš„å­ç±»æ¥å®ç°ã€‚é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å¼€é—­åŸåˆ™çš„å…·ä½“å®ç°æ‰‹æ®µä¹‹ä¸€ã€‚</li></ol><p><img src="https://i.loli.net/2020/02/03/OXI4TrtJ1j3gzVa.jpg" alt="é‡Œæ°åŸåˆ™1.jpg"></p><p><img src="https://i.loli.net/2020/02/03/4PuoLXtib6SQCKH.jpg" alt="é‡Œæ°åŸåˆ™2.jpg"></p><p>é€šè¿‡å¢åŠ æŠ½è±¡ç±»ï¼Œè®©å­ç±»æ¥æ›¿æ¢çˆ¶ç±»çš„æ–¹å¼æ¥è¿›è¡Œç¼–ç¨‹ï¼Œå¢å¼ºä»£ç çš„å¤ç”¨æ€§ã€‚</p><h2 id="2-4-ä¾èµ–å€’è½¬åŸåˆ™-Dependence-Inversion-Principle"><a href="#2-4-ä¾èµ–å€’è½¬åŸåˆ™-Dependence-Inversion-Principle" class="headerlink" title="2.4 ä¾èµ–å€’è½¬åŸåˆ™ Dependence Inversion Principle"></a>2.4 ä¾èµ–å€’è½¬åŸåˆ™ Dependence Inversion Principle</h2><p>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡</p><blockquote><p>é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹ã€‚</p></blockquote><p>åœ¨ç¨‹åºä»£ç ä¸­ä¼ é€’å‚æ•°æ—¶æˆ–è€…åœ¨å…³è”å…³ç³»ä¸­ï¼Œå°½é‡å¼•ç”¨å±‚æ¬¡é«˜çš„æŠ½è±¡å±‚ç±»ï¼Œå³ï¼Œä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»è¿›è¡Œå˜é‡ç±»å‹å£°æ˜ã€å‚æ•°ç±»å‹å£°æ˜ã€æ–¹æ³•è¿”å›ç±»å‹å£°æ˜ï¼Œä»¥åŠæ•°æ®ç±»å‹çš„è½¬æ¢ç­‰ï¼Œè€Œä¸è¦ç”¨å…·ä½“ç±»æ¥åšè¿™äº›äº‹æƒ…ã€‚</p><p>ä¸ºäº†ç¡®ä¿è¯¥åŸåˆ™çš„åº”ç”¨ï¼Œ<strong><em>ä¸€ä¸ªå…·ä½“ç±»åº”å½“åªå®ç°æ¥å£æˆ–æŠ½è±¡ç±»ä¸­å£°æ˜è¿‡çš„æ–¹æ³•ï¼Œè€Œä¸è¦ç»™å‡ºå¤šä½™çš„æ–¹æ³•ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨åˆ°åœ¨å­ç±»ä¸­å¢åŠ çš„æ–°æ–¹æ³•ã€‚</em></strong></p><p>åœ¨å®ç°ä¾èµ–å€’è½¬åŸåˆ™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æŠ½è±¡å±‚ç¼–ç¨‹ï¼Œè€Œå°†å…·ä½“ç±»çš„å¯¹è±¡é€šè¿‡ä¾èµ–æ³¨å…¥(DependencyInjection, DI)çš„æ–¹å¼æ³¨å…¥åˆ°å…¶ä»–å¯¹è±¡ä¸­ï¼Œä¾èµ–æ³¨å…¥æ˜¯æŒ‡å½“ä¸€ä¸ªå¯¹è±¡è¦ä¸å…¶ä»–å¯¹è±¡å‘ç”Ÿä¾èµ–å…³ç³»æ—¶ï¼Œé€šè¿‡æŠ½è±¡æ¥æ³¨å…¥æ‰€ä¾èµ–çš„å¯¹è±¡ã€‚å¸¸ç”¨çš„æ³¨å…¥æ–¹å¼æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>æ„é€ æ³¨å…¥</li></ul><p>æ„é€ æ³¨å…¥æ˜¯æŒ‡é€šè¿‡æ„é€ å‡½æ•°æ¥ä¼ å…¥å…·ä½“ç±»çš„å¯¹è±¡</p><ul><li>è®¾å€¼æ³¨å…¥ï¼ˆSetteræ³¨å…¥ï¼‰</li></ul><p>è®¾å€¼æ³¨å…¥æ˜¯æŒ‡é€šè¿‡Setteræ–¹æ³•æ¥ä¼ å…¥å…·ä½“ç±»çš„å¯¹è±¡</p><ul><li>æ¥å£æ³¨å…¥</li></ul><p>è€Œæ¥å£æ³¨å…¥æ˜¯æŒ‡é€šè¿‡åœ¨æ¥å£ä¸­å£°æ˜çš„ä¸šåŠ¡æ–¹æ³•æ¥ä¼ å…¥å…·ä½“ç±»çš„å¯¹è±¡ã€‚</p><p><strong>è¿™äº›æ–¹æ³•åœ¨å®šä¹‰æ—¶ä½¿ç”¨çš„æ˜¯æŠ½è±¡ç±»å‹ï¼Œåœ¨è¿è¡Œæ—¶å†ä¼ å…¥å…·ä½“ç±»å‹çš„å¯¹è±¡ï¼Œç”±å­ç±»å¯¹è±¡æ¥è¦†ç›–çˆ¶ç±»å¯¹è±¡ã€‚</strong></p><p>åŠ äº†ä¸€ä¸ªæŠ½è±¡çš„DataConvertorï¼Œé¢å‘å®ƒæ¥è¿›è¡Œç¼–ç¨‹ï¼Œç„¶ååœ¨Configé‡Œé¢å®šä¹‰åˆ°åº•éœ€è¦å“ªä¸€ä¸ªConvertorçš„å…·ä½“å®ç°ç±»</p><p><img src="https://i.loli.net/2020/02/03/n4DwgFpP91Ua2vX.jpg" alt="ä¾èµ–å€’è½¬1.jpg"></p><p><img src="https://i.loli.net/2020/02/03/vq8aUZGpfMWhiAN.jpg" alt="ä¾èµ–å€’è½¬2.jpg"></p><h2 id="2-5-æ¥å£éš”ç¦»åŸåˆ™-Interface-Segragation-Principle"><a href="#2-5-æ¥å£éš”ç¦»åŸåˆ™-Interface-Segragation-Principle" class="headerlink" title="2.5 æ¥å£éš”ç¦»åŸåˆ™ Interface Segragation Principle"></a>2.5 æ¥å£éš”ç¦»åŸåˆ™ Interface Segragation Principle</h2><p>ä½¿ç”¨å¤šä¸ªä¸“é—¨æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ã€‚å³å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–é‚£äº›å®ƒä¸éœ€è¦çš„æ¥å£ã€‚</p><p><strong><em>æ¯ä¸ªæ¥å£åº”è¯¥æ‰¿æ‹…ä¸€ç§ç›¸å¯¹ç‹¬ç«‹çš„è§’è‰²</em></strong> </p><p>å°½é‡æä¾›çª„æ¥å£ï¼Œæ ¹æ®ä¸åŒçš„èŒè´£åˆ†åˆ«æ”¾åœ¨ä¸åŒçš„å°æ¥å£å½“ä¸­</p><p> åœ¨ä½¿ç”¨æ¥å£éš”ç¦»åŸåˆ™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„æ§åˆ¶æ¥å£çš„ç²’åº¦ï¼Œæ¥å£ä¸èƒ½å¤ªå°ï¼Œå¦‚æœå¤ªå°ä¼šå¯¼è‡´ç³»ç»Ÿä¸­æ¥å£æ³›æ»¥ï¼Œä¸åˆ©äºç»´æŠ¤ï¼›æ¥å£ä¹Ÿä¸èƒ½å¤ªå¤§ï¼Œå¤ªå¤§çš„æ¥å£å°†è¿èƒŒæ¥å£éš”ç¦»åŸåˆ™ï¼Œçµæ´»æ€§è¾ƒå·®ï¼Œä½¿ç”¨èµ·æ¥å¾ˆä¸æ–¹ä¾¿ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ¥å£ä¸­ä»…åŒ…å«ä¸ºæŸä¸€ç±»ç”¨æˆ·å®šåˆ¶çš„æ–¹æ³•å³å¯ï¼Œä¸åº”è¯¥å¼ºè¿«å®¢æˆ·ä¾èµ–äºé‚£äº›å®ƒä»¬ä¸ç”¨çš„æ–¹æ³•ã€‚</p><p><img src="https://i.loli.net/2020/02/03/aEnKRgm2THM8L6c.jpg" alt="æ¥å£éš”ç¦»1.jpg"><br><img src="https://i.loli.net/2020/02/03/K1iNF5jB2aGHoVc.jpg" alt="æ¥å£éš”ç¦»2.jpg"></p><h2 id="2-6-åˆæˆå¤ç”¨åŸåˆ™-Composite-Reuse-Principle"><a href="#2-6-åˆæˆå¤ç”¨åŸåˆ™-Composite-Reuse-Principle" class="headerlink" title="2.6 åˆæˆå¤ç”¨åŸåˆ™ Composite Reuse Principle"></a>2.6 åˆæˆå¤ç”¨åŸåˆ™ Composite Reuse Principle</h2><p>å°½é‡ä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç»§æ‰¿æ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„</p><p>åœ¨ä¸€ä¸ªæ–°çš„å¯¹è±¡é‡Œï¼Œé€šè¿‡å…³è”å…³ç³»ï¼ˆç»„åˆå…³ç³»å’Œèšåˆå…³ç³»ï¼‰æ¥ä½¿ç”¨ä¸€äº›å·²æœ‰å¯¹è±¡ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚æ–°å¯¹è±¡é€šè¿‡å§”æ´¾è°ƒç”¨å·²æœ‰å¯¹è±¡çš„æ–¹æ³•è¾¾åˆ°å¤ç”¨åŠŸèƒ½çš„ç›®çš„ã€‚</p><blockquote><p>å…ˆè€ƒè™‘ç»„åˆï¼Œå†è€ƒè™‘ç»§æ‰¿</p></blockquote><p>ç»„åˆ/èšåˆå¯ä»¥ä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ï¼Œé™ä½ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œä¸€ä¸ªç±»çš„å˜åŒ–å¯¹å…¶ä»–ç±»é€ æˆçš„å½±å“ç›¸å¯¹è¾ƒå°‘ï¼›å…¶æ¬¡æ‰è€ƒè™‘ç»§æ‰¿ï¼Œåœ¨ä½¿ç”¨ç»§æ‰¿æ—¶ï¼Œéœ€è¦ä¸¥æ ¼éµå¾ªé‡Œæ°ä»£æ¢åŸåˆ™ï¼Œæœ‰æ•ˆä½¿ç”¨ç»§æ‰¿ä¼šæœ‰åŠ©äºå¯¹é—®é¢˜çš„ç†è§£ï¼Œé™ä½å¤æ‚åº¦ï¼Œè€Œæ»¥ç”¨ç»§æ‰¿åè€Œä¼šå¢åŠ ç³»ç»Ÿæ„å»ºå’Œç»´æŠ¤çš„éš¾åº¦ä»¥åŠç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œå› æ­¤éœ€è¦æ…é‡ä½¿ç”¨ç»§æ‰¿å¤ç”¨</p><p>ç»§æ‰¿å¤ç”¨ä¼šç ´åç³»ç»Ÿçš„å°è£…æ€§ï¼Œå› ä¸ºç»§æ‰¿ä¼šå°†åŸºç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»â€”â€”&gt; <strong>ç™½ç®±å¤ç”¨</strong>ã€‚å¦‚æœåŸºç±»å‘ç”Ÿæ”¹å˜ï¼Œå­ç±»çš„å®ç°ä¹Ÿå¿…é¡»æ”¹å˜ã€‚è¿™æ ·å­åšæ²¡æœ‰è¶³å¤Ÿçš„çµæ´»æ€§ã€‚</p><p>ç»„åˆæˆ–è€…èšåˆå…³ç³»æ˜¯å°†å·²æœ‰å¯¹è±¡çº³å…¥åˆ°æ–°å¯¹è±¡å½“ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚æ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œä½†æ˜¯å…·ä½“å®ç°æ˜¯å¯¹å…¶ä¸å¯è§çš„ã€‚åˆæˆå¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œæ–°å¯¹è±¡å¯ä»¥åŠ¨æ€çš„å¼•ç”¨ä¸æˆå‘˜å¯¹è±¡ç±»å‹ç›¸åŒçš„å…¶ä»–å¯¹è±¡ã€‚</p><blockquote><p>å¯¹äºâ€Has Aâ€å…³ç³»ï¼Œä½¿ç”¨åˆæˆå¤ç”¨ï¼Œå¯¹äºâ€Is Aâ€å…³ç³»ï¼Œä½¿ç”¨ç»§æ‰¿</p></blockquote><p><img src="https://i.loli.net/2020/02/03/iQuJD2VyKEzNB8P.jpg" alt="åˆæˆå¤ç”¨1.jpg"></p><p><img src="https://i.loli.net/2020/02/03/HUb5O1qjXk7BYKu.jpg" alt="åˆæˆå¤ç”¨2.jpg"></p><h2 id="2-7-è¿ªç±³ç‰¹æ³•åˆ™-Law-of-Demeter"><a href="#2-7-è¿ªç±³ç‰¹æ³•åˆ™-Law-of-Demeter" class="headerlink" title="2.7 è¿ªç±³ç‰¹æ³•åˆ™ Law of Demeter"></a>2.7 è¿ªç±³ç‰¹æ³•åˆ™ Law of Demeter</h2><p>ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œè¿™æ˜¯å¯¹è½¯ä»¶å®ä½“ä¹‹é—´é€šä¿¡çš„é™åˆ¶ã€‚</p><p>å½“å…¶ä¸­ä¸€ä¸ªæ¨¡å—å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œä¼šå°½é‡å°‘åœ°å½±å“å…¶ä»–æ¨¡å—ï¼Œæ‰©å±•ä¼šç›¸å¯¹å®¹æ˜“ã€‚</p><p>åªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>å½“å‰å¯¹è±¡æœ¬èº«</li><li>ä»¥å‚æ•°å½¢å¼ä¼ å…¥åˆ°å½“å‰å¯¹è±¡æ–¹æ³•ä¸­çš„å¯¹è±¡</li><li>å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡</li><li>å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡</li></ol><p>å¦‚æœå…¶ä¸­çš„ä¸€ä¸ªå¯¹è±¡éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„æŸä¸€ä¸ªæ–¹æ³•çš„è¯ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰è€…è½¬å‘è¿™ä¸ªè°ƒç”¨ã€‚ç®€è¨€ä¹‹ï¼Œå°±æ˜¯é€šè¿‡å¼•å…¥ä¸€ä¸ªåˆç†çš„ç¬¬ä¸‰è€…æ¥é™ä½ç°æœ‰å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p><p>ï¼ï¼ï¼ é€šè¿‡å¼•å…¥ä¸­é—´ä»¶æ¥é™ä½æ•´ä½“çš„è€¦åˆåº¦</p><p><img src="https://i.loli.net/2020/02/03/6CxEVeahFjcQ9AN.jpg" alt="è¿ªç±³ç‰¹1.jpg"></p><p><img src="https://i.loli.net/2020/02/03/KHX1vnuDbTewQaY.jpg" alt="è¿ªç±³ç‰¹2.jpg"></p><h1 id="3-Reference"><a href="#3-Reference" class="headerlink" title="3. Reference"></a>3. Reference</h1><p><a href="https://blog.csdn.net/lovelion/article/details/7536532" target="_blank" rel="noopener">LiuWeiâ€™s CSDN</a></p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> System Design </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ··æ²Œå·¥ç¨‹</title>
      <link href="/%E6%B7%B7%E6%B2%8C%E5%B7%A5%E7%A8%8B/"/>
      <url>/%E6%B7%B7%E6%B2%8C%E5%B7%A5%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¾®æœåŠ¡æ¶æ„çš„æŒ‘æˆ˜"><a href="#1-å¾®æœåŠ¡æ¶æ„çš„æŒ‘æˆ˜" class="headerlink" title="1. å¾®æœåŠ¡æ¶æ„çš„æŒ‘æˆ˜"></a>1. å¾®æœåŠ¡æ¶æ„çš„æŒ‘æˆ˜</h1><p>å½“å‰çš„è¶‹åŠ¿å°±æ˜¯å¾®æœåŠ¡æ¶æ„ï¼Œå°†åŸæœ‰ç³»ç»Ÿæ‹†åˆ†ä¸ºæ›´åŠ çµæ´»ã€æœ‰ä¸šåŠ¡è¾¹ç•Œã€ä¸Šä¸‹æ–‡ã€æ¾æ•£è€¦åˆã€å¯ç‹¬ç«‹éƒ¨ç½²çš„æœåŠ¡æ¥åº”å¯¹å¿«é€Ÿå˜åŒ–çš„æ¶ˆè´¹å¸‚åœºã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯¹äºå¤æ‚ä¸šåŠ¡æˆ–é—ç•™ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD:Domain-Driven Design)æœ‰æ•ˆçš„è§£å†³é™ç•Œä¸Šä¸‹æ–‡åˆ’åˆ†ã€æœåŠ¡è¾¹ç•Œå®šä¹‰ä»¥åŠç»„ç»‡ç»“æ„è°ƒæ•´ç­‰é—®é¢˜ã€‚é™¤äº†è¿™äº›ï¼Œæˆ‘ä»¬çš„å¼€å‘å›¢é˜Ÿè¿˜é¢ä¸´ç€å…¶ä»–çš„æŒ‘æˆ˜ï¼šå¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€æ•°æ®ä¸€è‡´æ€§ã€å®¹é”™è®¾è®¡ã€é™æµè®¾è®¡ã€èˆ±å£è®¾è®¡ç­‰é—®é¢˜ã€‚é‚£ä¹ˆå¦‚æ­¤å¤æ‚çš„ç³»ç»Ÿå¦‚ä½•æ¥ä¿è¯ç³»ç»Ÿâ€œè´¨é‡â€å‘¢ï¼Ÿ</p><p>é•¿ä¹…ä»¥æ¥ï¼Œâ€œæµ‹è¯•é‡‘å­—å¡”â€éƒ½æ˜¯æ•æ·å¼€å‘å›¢é˜Ÿä¿è¯é¡¹ç›®äº¤ä»˜è´¨é‡çš„å®ˆåˆ™ï¼Œè€Œâ€œæµ‹è¯•é‡‘å­—å¡”â€ä¹Ÿç¡®å®ä»ä¸åŒçš„ç»´åº¦æ¶µç›–äº†æ–¹æ³•è°ƒç”¨ã€ä¸šåŠ¡é€»è¾‘ã€ç”¨æˆ·è¡Œä¸ºç­‰æ–¹é¢ã€‚</p><p>End2End test -&gt; API test -&gt; Unit test</p><p>é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¥‘çº¦æµ‹è¯•æ¥ä¿è¯è°ƒç”¨æ–¹ä¸æä¾›æ–¹çš„ä¸€è‡´æ€§ï¼Œç„¶è€Œä¸ƒæœˆæµ‹è¯•åªèƒ½è¦†ç›–åˆ°ä¸šåŠ¡é€»è¾‘çš„ç»´åº¦ï¼Œéœ€è¦æ›´æ·±å…¥çš„äº†è§£å¾®æœåŠ¡ç‰¹æ€§ä»¥æœŸæ›´å¥½çš„å¼€å‘ä¸æ”¹é€ ã€‚</p><p>è­¬å¦‚å¾®æœåŠ¡ç³»ç»Ÿçš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€å¾®æœåŠ¡å®¹é”™ä¿æŠ¤ã€APIæœåŠ¡ç½‘å…³ã€åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªå°±æ— æ³•è¢«å¥‘çº¦æµ‹è¯•æµ‹è¯•ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰åŠæ³•é¿å…ç¾éš¾çš„å‘ç”Ÿï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯â€œæ¢ç´¢ç³»ç»Ÿæ•…éšœè¾¹ç•Œï¼ŒéªŒè¯ç³»ç»Ÿç¾éš¾æ¢å¤èƒ½åŠ›â€ã€‚ä»¥å¾€çš„â€œæœºæˆ¿â€æ—¶ä»£çš„ä¸€äº›æ•…éšœæ¼”ç»ƒä¸€èˆ¬é€šè¿‡æ–­ç½‘ã€æ–­ç”µæ¨¡æ‹Ÿå•ç‚¹æ•…éšœï¼Œæ¥æµ‹è¯•ç³»ç»Ÿçš„æ¢å¤èƒ½åŠ›ï¼Œè€Œæ–°å‹çš„åˆ†å¸ƒå¼æœåŠ¡æ—¶ä»£æ¶ˆé™¤äº†å•ç‚¹æ•…éšœï¼Œä½†ä¹Ÿå¼•å…¥äº†æ›´å¤šå¤æ‚çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¯é æ€§æ›´å¼ºã€å®¹é”™æ€§å’Œæ‰©å®¹æ€§æ›´é«˜çš„ç³»ç»Ÿã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœ‰ç­–ç•¥çš„ã€æœ‰æ–¹æ³•çš„å®è·µæ–¹æ¡ˆå¯¹ç³»ç»Ÿè¿›è¡Œä¸€å®šç¨‹åº¦çš„â€œéšæœºç ´åâ€ï¼Œé€šè¿‡è®©ç³»ç»Ÿâ€æ„ŸæŸ“â€œï¼Œæ¥æå‡ç³»ç»Ÿçš„â€å…ç–«åŠ›â€œã€‚</p><h1 id="2-æ··æ²Œå·¥ç¨‹"><a href="#2-æ··æ²Œå·¥ç¨‹" class="headerlink" title="2. æ··æ²Œå·¥ç¨‹"></a>2. æ··æ²Œå·¥ç¨‹</h1><p>æ··æ²Œå·¥ç¨‹æ˜¯ä¸€ç§å¯è¯•éªŒçš„ã€åŸºäºç³»ç»Ÿçš„æ–¹æ³•æ¥å¤„ç†å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ··ä¹±é—®é¢˜ã€‚é€šè¿‡ä¸æ–­è¯•éªŒï¼Œäº†è§£ç³»ç»Ÿçš„å®é™…èƒ½æ‰¿å—çš„éŸ§æ€§è¾¹ç•Œå¹¶å»ºç«‹ä¿¡å¿ƒï¼Œé€šè¿‡ä¸åŒçš„è¯•éªŒæ–¹æ³•å’Œç›®çš„ï¼Œè§‚å¯Ÿåˆ†å¸ƒå¼ç³»ç»Ÿçš„è¡Œä¸ºå’Œååº”ã€‚ä¸€å¥è¯â€”â€”ä»¥è¯•éªŒçš„æ–¹æ³•å°½æ—©æ­éœ²ç³»ç»Ÿå¼±ç‚¹ã€‚</p><p>æ··æ²Œå·¥ç¨‹ç±»ä¼¼äºâ€œæ•…éšœæ¼”ç»ƒâ€ï¼Œä¸å±€é™äºæµ‹è¯•ï¼Œè€Œæ›´åƒæ˜¯å·¥ç¨‹å®è·µã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œé€šå¸¸çš„æµ‹è¯•ç”¨ä¾‹ä¼šæœ‰â€œæœŸæœ›ç»“æœâ€å’Œâ€œå®é™…ç»“æœâ€ï¼Œé€šè¿‡å°†ä¸¤ä¸ªç»“æœæ¯”è¾ƒï¼Œæˆ–è€…å¯¹ç”¨æˆ·è¡Œä¸ºçš„é¢„æœŸï¼Œæ¥åˆ¤æ–­æµ‹è¯•é€šè¿‡æˆ–å¤±è´¥ã€‚è€Œæ··æ²Œè¯•éªŒç±»ä¼¼äºâ€<strong>æ¢ç´¢æ€§æµ‹è¯•</strong>â€œï¼Œè¯•éªŒæœ¬èº«æ²¡æœ‰æ˜ç¡®æ˜¯è¾“å…¥å’Œé¢„æœŸç»“æœï¼Œé€šè¿‡å¯¹ç³»ç»Ÿå’ŒæœåŠ¡çš„å¹²é¢„ï¼Œæ¥è§‚å¯Ÿç³»ç»Ÿçš„â€ååº”â€œã€‚æˆ‘ä»¬å°†æ··æ²Œå·¥ç¨‹åŸåˆ™èå…¥åœ¨è¯•éªŒè¿‡ç¨‹ä¸­ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒå°è§„æ¨¡æ¨¡æ‹Ÿç³»ç»Ÿæ•…éšœå¹¶å®šæœŸè‡ªåŠ¨åŒ–æ‰§è¡Œè¯•éªŒï¼Œé€šè¿‡è¯•éªŒç»“æœä¸æ­£å¸¸ç»“æœè¿›è¡Œæ¯”å¯¹ï¼Œè§‚å¯Ÿç³»ç»Ÿâ€è¾¹ç•Œâ€œã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://insights.thoughtworks.cn/microservice-architecture-chaotic-engineering/#utm_source=rss&amp;utm_medium=rss" target="_blank" rel="noopener">https://insights.thoughtworks.cn/microservice-architecture-chaotic-engineering/#utm_source=rss&amp;utm_medium=rss</a>   </p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BackEnd </tag>
            
            <tag> æ··æ²Œå·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IOCå®¹å™¨å’ŒDependency Injectionæ¨¡å¼</title>
      <link href="/IOC%E5%AE%B9%E5%99%A8%E5%92%8CDependency-Injection%E6%A8%A1%E5%BC%8F/"/>
      <url>/IOC%E5%AE%B9%E5%99%A8%E5%92%8CDependency-Injection%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>Martin Fowlerçš„æ–‡ç« ï¼Œåœ¨æ–‡ä¸­æ·±å…¥æ¢ç´¢æ§åˆ¶åè½¬çš„çš„å·¥ä½œåŸç†ï¼Œç»™å®ƒä¸€ä¸ªæ›´èƒ½æè¿°å…¶ç‰¹ç‚¹çš„åå­—â€”â€”â€ä¾èµ–æ³¨å…¥â€ï¼ˆDependency Injectionï¼‰ï¼Œå¹¶å°†å…¶ä¸â€æœåŠ¡å®šä½å™¨â€ï¼ˆService Locatorï¼‰æ¨¡å¼ä½œä¸€ä¸ªæ¯”è¾ƒã€‚æ¢è®¨äº†å¼‚åŒã€‚æœ€æœ€é‡è¦çš„ï¼Œä¹Ÿæ˜¯æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥æ³¨æ„çš„æ˜¯ï¼šåº”è¯¥å°†æœåŠ¡çš„é…ç½®å’Œåº”ç”¨ç¨‹åºå†…éƒ¨å¯¹æœåŠ¡çš„ä½¿ç”¨åˆ†ç¦»å¼€ã€‚è¿™ä¹Ÿæ˜¯æ§åˆ¶åè½¬ä»¥åŠæœåŠ¡å®šä½å™¨ä¸€ç›´åœ¨åšçš„ã€‚</p><h1 id="1-é—®é¢˜"><a href="#1-é—®é¢˜" class="headerlink" title="1. é—®é¢˜"></a>1. é—®é¢˜</h1><p>J2EEå¼€å‘è€…å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯<strong><em>å¦‚ä½•ç»„è£…ä¸åŒçš„ç¨‹åºå…ƒç´ </em></strong>ï¼šå¦‚æœwebæ§åˆ¶å™¨ä½“ç³»ç»“æ„å’Œæ•°æ®åº“æ¥å£æ˜¯ç”±ä¸åŒçš„å›¢é˜Ÿæ‰€å¼€å‘çš„ï¼Œå½¼æ­¤å‡ ä¹ä¸€æ— æ‰€çŸ¥ï¼Œä½ åº”è¯¥å¦‚ä½•è®©å®ƒä»¬é…åˆå·¥ä½œï¼Ÿå¾ˆå¤šæ¡†æ¶å°è¯•è¿‡è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰å‡ ä¸ªæ¡†æ¶ç´¢æ€§æœè¿™ä¸ªæ–¹å‘å‘å±•ï¼Œæä¾›äº†æ›´é€šç”¨çš„â€ç»„è£…å„å±‚ç»„ä»¶â€çš„æ–¹æ¡ˆã€‚è¿™æ ·çš„æ¡†æ¶é€šå¸¸è¢«ç§°ä¸ºâ€è½»é‡çº§å®¹å™¨â€ï¼ŒPicoContainerå’ŒSpringéƒ½åœ¨æ­¤åˆ—ä¸­ã€‚</p><h2 id="2-å®ä¾‹"><a href="#2-å®ä¾‹" class="headerlink" title="2.å®ä¾‹"></a>2.å®ä¾‹</h2><p>æœ‰ä¸€ä¸ªæä¾›ä¸€ä»½ç”µå½±æ¸…å•çš„ç»„ä»¶ï¼Œæ¸…å•ä¸Šåˆ—å‡ºæœ‰ä¸€ä½ç‰¹å®šå¯¼æ¼”æ‰§å¯¼çš„å½±ç‰‡</p><pre><code>class MovieLister...public Movie[] moviesDirectedBy(String arg){    List allMovies = finder.findAll();    for (Iterator it = allMovies.iterator(); it.hasNext();)    {        Movie movie = (Movie) it.next();        if (!movie.getDirector().equals(arg))        {            it.remove();        }    }    return (Movie[]) allMovies.toArray(new Movie[allMovies.size()]);}</code></pre><p>è¿™ä¸ªåŠŸèƒ½çš„å®ç°æå…¶ç®€å•ï¼šmoviesDirectedByæ–¹æ³•é¦–å…ˆè¯·æ±‚finderï¼ˆå½±ç‰‡æœå¯»è€…ï¼‰å¯¹è±¡ï¼ˆæˆ‘ä»¬ç¨åä¼šè°ˆåˆ°è¿™ä¸ªå¯¹è±¡ï¼‰è¿”å›åè€…æ‰€çŸ¥é“çš„æ‰€æœ‰å½±ç‰‡ï¼Œç„¶åéå†finderå¯¹è±¡è¿”å›çš„æ¸…å•ï¼Œå¹¶è¿”å›å…¶ä¸­ç”±ç‰¹å®šçš„æŸä¸ªå¯¼æ¼”æ‰§å¯¼çš„å½±ç‰‡ã€‚éå¸¸ç®€å•ï¼Œä¸è¿‡ä¸å¿…æ‹…å¿ƒï¼Œè¿™åªæ˜¯æ•´ä¸ªä¾‹å­çš„è„šæ‰‹æ¶ç½¢äº†ã€‚<strong><em>æˆ‘ä»¬çœŸæ­£æƒ³è¦è€ƒå¯Ÿçš„æ˜¯finderå¯¹è±¡ï¼Œæˆ–è€…è¯´ï¼Œå¦‚ä½•å°†MovieListerå¯¹è±¡ä¸ç‰¹å®šçš„finderå¯¹è±¡è¿æ¥èµ·æ¥</em></strong>ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯¹è¿™ä¸ªé—®é¢˜ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Ÿå› ä¸º<strong><em>æˆ‘å¸Œæœ›ä¸Šé¢è¿™ä¸ªæ¼‚äº®çš„moviesDirectedByæ–¹æ³•å®Œå…¨ä¸ä¾èµ–äºå½±ç‰‡çš„å®é™…å­˜å‚¨æ–¹å¼ã€‚</em></strong>æ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½å¼•ç”¨ä¸€ä¸ªfinderå¯¹è±¡ï¼Œè€Œfinderå¯¹è±¡åˆ™å¿…é¡»çŸ¥é“å¦‚ä½•å¯¹findAll æ–¹æ³•ä½œå‡ºå›åº”ã€‚ä¸ºäº†å¸®åŠ©è¯»è€…æ›´æ¸…æ¥šåœ°ç†è§£ï¼Œæˆ‘ç»™finderå®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼š</p><pre><code>public interface MovieFinder{    List findAll();}</code></pre><p>ç°åœ¨ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ²¡æœ‰ä»€ä¹ˆè€¦åˆå…³ç³»ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘è¦å®é™…å¯»æ‰¾å½±ç‰‡æ—¶ï¼Œå°±å¿…é¡»æ¶‰åŠåˆ°MovieFinderçš„æŸä¸ªå…·ä½“å­ç±»ã€‚åœ¨è¿™é‡Œï¼Œ<em>æˆ‘æŠŠæ¶‰åŠå…·ä½“å­ç±»çš„ä»£ç æ”¾åœ¨MovieListerç±»çš„æ„é€ å‡½æ•°ä¸­</em>ã€‚</p><pre><code>class MovieLister...private MovieFinder finder;public MovieLister(){    finder = new ColonDelimitedMovieFinder(&quot;movies1.txt&quot;);}</code></pre><p>è¿™ä¸ªå®ç°ç±»çš„åå­—å°±è¯´æ˜ï¼šæˆ‘å°†è¦ä»ä¸€ä¸ªé€—å·åˆ†éš”çš„æ–‡æœ¬æ–‡ä»¶ä¸­è·å¾—å½±ç‰‡åˆ—è¡¨ã€‚ä½ ä¸å¿…æ“å¿ƒå…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œåªè¦è®¾æƒ³è¿™æ ·ä¸€ä¸ªå®ç°ç±»å°±å¯ä»¥äº†ã€‚å¦‚æœè¿™ä¸ªç±»åªç”±æˆ‘è‡ªå·±ä½¿ç”¨ï¼Œä¸€åˆ‡éƒ½æ²¡é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘çš„æœ‹å‹å¹æœäºè¿™ä¸ªç²¾å½©çš„åŠŸèƒ½ï¼Œä¹Ÿæƒ³ä½¿ç”¨æˆ‘çš„ç¨‹åºï¼Œé‚£åˆä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚æœä»–ä»¬ä¹ŸæŠŠå½±ç‰‡æ¸…å•ä¿å­˜åœ¨ä¸€ä¸ªé€—å·åˆ†éš”çš„æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ä¹ŸæŠŠè¿™ä¸ªæ–‡ä»¶å‘½åä¸ºâ€ movie1.txt â€œï¼Œé‚£ä¹ˆä¸€åˆ‡è¿˜æ˜¯æ²¡é—®é¢˜ã€‚å¦‚æœä»–ä»¬åªæ˜¯ç»™è¿™ä¸ªæ–‡ä»¶æ”¹æ”¹åï¼Œæˆ‘ä¹Ÿå¯ä»¥ä»ä¸€ä¸ªé…ç½®æ–‡ä»¶è·å¾—æ–‡ä»¶åï¼Œè¿™ä¹Ÿå¾ˆå®¹æ˜“ã€‚<strong>ä½†æ˜¯ï¼Œå¦‚æœä»–ä»¬ç”¨å®Œå…¨ä¸åŒçš„æ–¹å¼â€”â€”ä¾‹å¦‚SQL æ•°æ®åº“ã€XML æ–‡ä»¶ã€web serviceï¼Œæˆ–è€…å¦ä¸€ç§æ ¼å¼çš„æ–‡æœ¬æ–‡ä»¶â€”â€”æ¥å­˜å‚¨å½±ç‰‡æ¸…å•å‘¢ï¼Ÿ</strong>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨å¦ä¸€ä¸ªç±»æ¥è·å–æ•°æ®ã€‚ç”±äºå·²ç»å®šä¹‰äº†MovieFinderæ¥å£ï¼Œæˆ‘å¯ä»¥ä¸ç”¨ä¿®æ”¹moviesDirectedByæ–¹æ³•ã€‚ä½†æ˜¯ï¼Œæˆ‘<strong><em>ä»ç„¶éœ€è¦é€šè¿‡æŸç§é€”å¾„è·å¾—åˆé€‚çš„MovieFinderå®ç°ç±»çš„å®ä¾‹</em></strong>ã€‚</p><p><img src="https://i.loli.net/2020/02/03/B2Nf9MX6VIL4oKP.gif" alt="figure1.gif"></p><p>MovieListerç±»æ—¢ä¾èµ–äºMovieFinderæ¥å£ï¼Œä¹Ÿä¾èµ–äºå…·ä½“çš„å®ç°ç±»ã€‚æˆ‘ä»¬å½“ç„¶å¸Œæœ›MovieListerç±»åªä¾èµ–äºæ¥å£ï¼Œä½†æˆ‘ä»¬è¦å¦‚ä½•è·å¾—ä¸€ä¸ªMovieFinderå­ç±»çš„å®ä¾‹å‘¢ï¼Ÿ</p><p>åœ¨Patterns of Enterprise Application Architectureä¸€ä¹¦ä¸­ï¼Œæˆ‘ä»¬æŠŠè¿™ç§æƒ…å†µç§°ä¸º<strong>æ’ä»¶ï¼ˆpluginï¼‰</strong>ï¼šMovieFinderçš„å®ç°ç±»<strong>ä¸æ˜¯åœ¨ç¼–è¯‘æœŸè¿å…¥ç¨‹åºä¹‹ä¸­çš„</strong>ï¼Œå› ä¸ºæˆ‘å¹¶ä¸çŸ¥é“æˆ‘çš„æœ‹å‹ä¼šä½¿ç”¨å“ªä¸ªå®ç°ç±»ã€‚æˆ‘ä»¬å¸Œæœ›MovieListerç±»èƒ½å¤Ÿä¸MovieFinderçš„ä»»ä½•å®ç°ç±»é…åˆå·¥ä½œï¼Œå¹¶ä¸”å…è®¸<strong>åœ¨è¿è¡ŒæœŸæ’å…¥å…·ä½“çš„å®ç°ç±»</strong>ï¼Œæ’å…¥åŠ¨ä½œå®Œå…¨è„±ç¦»æˆ‘ï¼ˆåŸä½œè€…ï¼‰çš„æ§åˆ¶ã€‚è¿™é‡Œçš„é—®é¢˜å°±æ˜¯ï¼š<strong>å¦‚ä½•è®¾è®¡è¿™ä¸ªè¿æ¥è¿‡ç¨‹ï¼Œä½¿MovieListerç±»åœ¨ä¸çŸ¥é“å®ç°ç±»ç»†èŠ‚çš„å‰æä¸‹ä¸å…¶å®ä¾‹ååŒå·¥ä½œã€‚</strong></p><p>å°†è¿™ä¸ªä¾‹å­æ¨è€Œå¹¿ä¹‹ï¼Œåœ¨ä¸€ä¸ªçœŸå®çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰æ•°åä¸ªæœåŠ¡å’Œç»„ä»¶ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œæˆ‘ä»¬æ€»å¯ä»¥å¯¹ä½¿ç”¨ç»„ä»¶çš„æƒ…å½¢åŠ ä»¥æŠ½è±¡ï¼Œ<strong>é€šè¿‡æ¥å£ä¸å…·ä½“çš„ç»„ä»¶äº¤æµ</strong>ï¼ˆå¦‚æœç»„ä»¶å¹¶æ²¡æœ‰è®¾è®¡ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é€‚é…å™¨ä¸ä¹‹äº¤æµï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›ä»¥ä¸åŒçš„æ–¹å¼éƒ¨ç½²è¿™ä¸ªç³»ç»Ÿï¼Œå°±éœ€è¦ç”¨æ’ä»¶æœºåˆ¶æ¥å¤„ç†æœåŠ¡ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹ï¼Œè¿™æ ·æˆ‘ä»¬æ‰å¯èƒ½åœ¨ä¸åŒçš„éƒ¨ç½²æ–¹æ¡ˆä¸­ä½¿ç”¨ä¸åŒçš„å®ç°ã€‚æ‰€ä»¥ï¼Œç°åœ¨çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š<strong>å¦‚ä½•å°†è¿™äº›æ’ä»¶ç»„åˆæˆä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Ÿè¿™æ­£æ˜¯æ–°ç”Ÿçš„è½»é‡çº§å®¹å™¨æ‰€é¢ä¸´çš„ä¸»è¦é—®é¢˜ï¼Œè€Œå®ƒä»¬è§£å†³è¿™ä¸ªé—®é¢˜çš„æ‰‹æ®µæ— ä¸€ä¾‹å¤–åœ°æ˜¯æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼‰æ¨¡å¼</strong>ã€‚</p><h1 id="3-æ§åˆ¶åè½¬"><a href="#3-æ§åˆ¶åè½¬" class="headerlink" title="3. æ§åˆ¶åè½¬"></a>3. æ§åˆ¶åè½¬</h1><p>å‡ ä½è½»é‡çº§å®¹å™¨çš„ä½œè€…æ›¾éª„å‚²åœ°å¯¹æˆ‘è¯´ï¼šè¿™äº›å®¹å™¨éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å®ç°äº†æ§åˆ¶åè½¬ã€‚è¿™æ ·çš„è¯´è¾è®©æˆ‘æ·±æ„Ÿè¿·æƒ‘ï¼šæ§åˆ¶åè½¬æ˜¯æ¡†æ¶æ‰€å…±æœ‰çš„ç‰¹å¾ï¼Œå¦‚æœä»…ä»…å› ä¸ºä½¿ç”¨äº†æ§åˆ¶åè½¬å°±è®¤ä¸ºè¿™äº›è½»é‡çº§å®¹å™¨ä¸ä¼—ä¸åŒï¼Œå°±å¥½è±¡åœ¨è¯´æˆ‘çš„è½¿è½¦æ˜¯ä¸ä¼—ä¸åŒçš„ï¼Œå› ä¸ºå®ƒæœ‰å››ä¸ªè½®å­ã€‚</p><p>é—®é¢˜çš„å…³é”®åœ¨äºï¼šå®ƒä»¬åè½¬äº†å“ªæ–¹é¢çš„æ§åˆ¶ï¼Ÿæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦åˆ°çš„æ§åˆ¶åè½¬é’ˆå¯¹çš„æ˜¯ç”¨æˆ·ç•Œé¢çš„ä¸»æ§æƒã€‚æ—©æœŸçš„ç”¨æˆ·ç•Œé¢æ˜¯å®Œå…¨ç”±åº”ç”¨ç¨‹åºæ¥æ§åˆ¶çš„ï¼Œä½ é¢„å…ˆè®¾è®¡ä¸€ç³»åˆ—å‘½ä»¤ï¼Œä¾‹å¦‚è¾“å…¥å§“åã€è¾“å…¥åœ°å€ç­‰ï¼Œåº”ç”¨ç¨‹åºé€æ¡è¾“å‡ºæç¤ºä¿¡æ¯ï¼Œå¹¶å–å›ç”¨æˆ·çš„å“åº”ã€‚è€Œåœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ç¯å¢ƒä¸‹ï¼ŒUIæ¡†æ¶å°†è´Ÿè´£æ‰§è¡Œä¸€ä¸ªä¸»å¾ªç¯ï¼Œä½ çš„åº”ç”¨ç¨‹åºåªéœ€ä¸ºå±å¹•çš„å„ä¸ªåŒºåŸŸæä¾›äº‹ä»¶å¤„ç†å‡½æ•°å³å¯ã€‚åœ¨è¿™é‡Œï¼Œç¨‹åºçš„ä¸»æ§æƒå‘ç”Ÿäº†åè½¬ï¼šä»åº”ç”¨ç¨‹åºç§»åˆ°äº†æ¡†æ¶ã€‚å¯¹äºè¿™äº›æ–°ç”Ÿçš„å®¹å™¨ï¼Œå®ƒä»¬åè½¬çš„æ˜¯å¦‚ä½•å®šä½æ’ä»¶çš„å…·ä½“å®ç°ã€‚åœ¨å‰é¢é‚£ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼ŒMovieListerç±»è´Ÿè´£å®šä½MovieFinderçš„å…·ä½“å®ç°â€”â€”å®ƒç›´æ¥å®ä¾‹åŒ–åè€…çš„ä¸€ä¸ªå­ç±»ã€‚è¿™æ ·ä¸€æ¥ï¼ŒMovieFinderä¹Ÿå°±ä¸æˆå…¶ä¸ºä¸€ä¸ªæ’ä»¶äº†ï¼Œå› ä¸ºå®ƒå¹¶ä¸æ˜¯åœ¨è¿è¡ŒæœŸæ’å…¥åº”ç”¨ç¨‹åºä¸­çš„ã€‚è€Œè¿™äº›è½»é‡çº§å®¹å™¨åˆ™ä½¿ç”¨äº†æ›´ä¸ºçµæ´»çš„åŠæ³•ï¼Œ<strong>åªè¦æ’ä»¶éµå¾ªä¸€å®šçš„è§„åˆ™ï¼Œä¸€ä¸ªç‹¬ç«‹çš„ç»„è£…æ¨¡å—å°±èƒ½å¤Ÿå°†æ’ä»¶çš„å…·ä½“å®ç°æ³¨å°„åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</strong>å› æ­¤ï¼Œæˆ‘æƒ³æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ªæ¨¡å¼èµ·ä¸€ä¸ªæ›´èƒ½è¯´æ˜å…¶ç‰¹ç‚¹çš„åå­—â€”â€”â€æ§åˆ¶åè½¬â€è¿™ä¸ªåå­—å¤ªæ³›äº†ï¼Œå¸¸å¸¸è®©äººæœ‰äº›è¿·æƒ‘ã€‚ä¸å¤šä½IoC çˆ±å¥½è€…è®¨è®ºä¹‹åï¼Œæˆ‘ä»¬å†³å®šå°†è¿™ä¸ªæ¨¡å¼å«åšâ€ä¾èµ–æ³¨å…¥â€ï¼ˆDependency Injectionï¼‰ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘å°†å¼€å§‹ä»‹ç»Dependency Injectionæ¨¡å¼çš„å‡ ç§ä¸åŒå½¢å¼ã€‚ä¸è¿‡ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘è¦é¦–å…ˆæŒ‡å‡ºï¼šè¦æ¶ˆé™¤åº”ç”¨ç¨‹åºå¯¹æ’ä»¶å®ç°çš„ä¾èµ–ï¼Œä¾èµ–æ³¨å…¥å¹¶ä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ServiceLocatoræ¨¡å¼è·å¾—åŒæ ·çš„æ•ˆæœã€‚ä»‹ç»å®ŒDependency Injectionæ¨¡å¼ä¹‹åï¼Œæˆ‘ä¹Ÿä¼šè°ˆåˆ°ServiceLocator æ¨¡å¼ã€‚</p><h2 id="3-1-ä¾èµ–æ³¨å…¥çš„å‡ ç§å½¢å¼"><a href="#3-1-ä¾èµ–æ³¨å…¥çš„å‡ ç§å½¢å¼" class="headerlink" title="3.1 ä¾èµ–æ³¨å…¥çš„å‡ ç§å½¢å¼"></a>3.1 ä¾èµ–æ³¨å…¥çš„å‡ ç§å½¢å¼</h2><p>Dependency Injectionæ¨¡å¼çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šç”¨ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼ˆè£…é…å™¨ï¼‰æ¥è·å¾—MovieFinderçš„ä¸€ä¸ªåˆé€‚çš„å®ç°ï¼Œå¹¶å°†å…¶å®ä¾‹èµ‹ç»™MovieListerç±»çš„ä¸€ä¸ªå­—æ®µã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å›¾2æ‰€ç¤ºçš„ä¾èµ–å›¾ï¼š</p><p><img src="https://i.loli.net/2020/02/03/wySa8WINcA2Xp49.gif" alt="figure2.gif"></p><h3 id="3-1-1-æ„é€ å‡½æ•°æ³¨å…¥"><a href="#3-1-1-æ„é€ å‡½æ•°æ³¨å…¥" class="headerlink" title="3.1.1 æ„é€ å‡½æ•°æ³¨å…¥"></a>3.1.1 æ„é€ å‡½æ•°æ³¨å…¥</h3><p>è¿™é‡Œä½¿ç”¨PicoContainerï¼Œä¸€ä¸ªè½»é‡çº§å®¹å™¨æ¥å®Œæˆä¾èµ–æ³¨å…¥ã€‚</p><p>PicoContaineré€šè¿‡æ„é€ å‡½æ•°æ¥åˆ¤æ–­å¦‚ä½•å°†MovieFinderå®ä¾‹æ³¨å…¥MovieLister ç±»ã€‚å› æ­¤ï¼ŒMovieListerç±»å¿…é¡»å£°æ˜ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å«æ‰€æœ‰éœ€è¦æ³¨å…¥çš„å…ƒç´ ï¼š</p><pre><code>class MovieLister...    public MovieLister(MovieFinder finder)    {        this.finder = finder;    }</code></pre><p>MovieFinderå®ä¾‹æœ¬èº«ä¹Ÿå°†ç”±PicoContaineræ¥ç®¡ç†ï¼Œå› æ­¤æ–‡æœ¬æ–‡ä»¶çš„åå­—ä¹Ÿå¯ä»¥ç”±å®¹å™¨æ³¨å…¥ï¼š</p><pre><code>class ColonMovieFinder...    public ColonMovieFinder(String filename)    {        this.filename = filename;    }</code></pre><p>éšåï¼Œéœ€è¦å‘Šè¯‰PicoContainerï¼šå„ä¸ªæ¥å£åˆ†åˆ«ä¸å“ªä¸ªå®ç°ç±»å…³è”ã€å°†å“ªä¸ªå­—ç¬¦ä¸²æ³¨å…¥MovieFinderç»„ä»¶ã€‚</p><pre><code>private MutablePicoContainer configureContainer(){    MutablePicoContainer pico = new DefaultPicoContainer();    Parameter[] finderParams = {newConstantParameter(&quot;movies1.txt&quot;)};    pico.registerComponentImplementation(MovieFinder.class,ColonMovieFinder.class, finderParams);    pico.registerComponentImplementation(MovieLister.class);    return pico;}</code></pre><p>è¿™æ®µé…ç½®ä»£ç é€šå¸¸ä½äºå¦ä¸€ä¸ªç±»ã€‚å¯¹äºæˆ‘ä»¬è¿™ä¸ªä¾‹å­ï¼Œä½¿ç”¨æˆ‘çš„MovieLister ç±»çš„æœ‹å‹éœ€è¦åœ¨è‡ªå·±çš„è®¾ç½®ç±»ä¸­ç¼–å†™åˆé€‚çš„é…ç½®ä»£ç ã€‚å½“ç„¶ï¼Œè¿˜å¯ä»¥å°†è¿™äº›é…ç½®ä¿¡æ¯æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ã€‚ä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªç±»æ¥è¯»å–é…ç½®æ–‡ä»¶ï¼Œç„¶åå¯¹å®¹å™¨è¿›è¡Œåˆé€‚çš„è®¾ç½®ã€‚å°½ç®¡PicoContaineræœ¬èº«å¹¶ä¸åŒ…å«è¿™é¡¹åŠŸèƒ½ï¼Œä½†å¦ä¸€ä¸ªä¸å®ƒå…³ç³»ç´§å¯†çš„é¡¹ç›®NanoContaineræä¾›äº†ä¸€äº›åŒ…è£…ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨XMLé…ç½®æ–‡ä»¶ä¿å­˜é…ç½®ä¿¡æ¯ã€‚NanoContainerèƒ½å¤Ÿè§£æXMLæ–‡ä»¶ï¼Œå¹¶å¯¹åº•ä¸‹çš„PicoContainerè¿›è¡Œé…ç½®ã€‚è¿™ä¸ªé¡¹ç›®çš„å“²å­¦è§‚å¿µå°±æ˜¯ï¼šå°†é…ç½®æ–‡ä»¶çš„æ ¼å¼ä¸åº•ä¸‹çš„é…ç½®æœºåˆ¶åˆ†ç¦»å¼€ã€‚</p><pre><code>public void testWithPico(){    MutablePicoContainer pico = configureContainer();    MovieLister lister = (MovieLister)pico.getComponentInstance(MovieLister.class);    Movie[] movies = lister.moviesDirectedBy(&quot;Sergio Leone&quot;);    assertEquals(&quot;Once Upon a Time in the West&quot;,movies[0].getTitle());}</code></pre><h3 id="3-1-2-è®¾å€¼æ–¹æ³•æ³¨å…¥"><a href="#3-1-2-è®¾å€¼æ–¹æ³•æ³¨å…¥" class="headerlink" title="3.1.2 è®¾å€¼æ–¹æ³•æ³¨å…¥"></a>3.1.2 è®¾å€¼æ–¹æ³•æ³¨å…¥</h3><p>Spring æ¡†æ¶æ˜¯ä¸€ä¸ªç”¨é€”å¹¿æ³›çš„ä¼ä¸šçº§Java å¼€å‘æ¡†æ¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†é’ˆå¯¹äº‹åŠ¡ã€æŒä¹…åŒ–æ¡†æ¶ã€webåº”ç”¨å¼€å‘å’ŒJDBCç­‰å¸¸ç”¨åŠŸèƒ½çš„æŠ½è±¡ã€‚å’ŒPicoContainerä¸€æ ·ï¼Œå®ƒä¹ŸåŒæ—¶æ”¯æŒæ„é€ å‡½æ•°æ³¨å…¥å’Œè®¾å€¼æ–¹æ³•æ³¨å…¥ï¼Œä½†è¯¥é¡¹ç›®çš„å¼€å‘è€…æ›´æ¨èä½¿ç”¨è®¾å€¼æ–¹æ³•æ³¨å…¥â€”â€”æ°å¥½é€‚åˆè¿™ä¸ªä¾‹å­ã€‚ä¸ºäº†è®©MovieListerç±»æ¥å—æ³¨å…¥ï¼Œæˆ‘éœ€è¦ä¸ºå®ƒå®šä¹‰ä¸€ä¸ªè®¾å€¼æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å—ç±»å‹ä¸ºMovieFinderçš„å‚æ•°ï¼š</p><pre><code>class MovieLister...private MovieFinder finder;public void setFinder(MovieFinder finder){    this.finder = finder;}</code></pre><p>ç±»ä¼¼åœ°ï¼Œåœ¨MovieFinderçš„å®ç°ç±»ä¸­ï¼Œæˆ‘ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªè®¾å€¼æ–¹æ³•ï¼Œæ¥å—ç±»å‹ä¸ºString çš„å‚æ•°ï¼š</p><pre><code>class ColonMovieFinder...    public void setFilename(String filename)    {        this.filename = filename;    }</code></pre><p>ç¬¬ä¸‰æ­¥æ˜¯è®¾å®šé…ç½®æ–‡ä»¶ã€‚Spring æ”¯æŒå¤šç§é…ç½®æ–¹å¼ï¼Œä½ å¯ä»¥é€šè¿‡XML æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä»£ç ä¸­é…ç½®ã€‚ä¸è¿‡ï¼ŒXML æ–‡ä»¶æ˜¯æ¯”è¾ƒç†æƒ³çš„é…ç½®æ–¹å¼ã€‚</p><pre><code>&lt;beans&gt;    &lt;bean id=&quot;MovieLister&quot; class=&quot;spring.MovieLister&quot;&gt;        &lt;property name=&quot;finder&quot;&gt;            &lt;ref local=&quot;MovieFinder&quot;/&gt;        &lt;/property&gt;    &lt;/bean&gt;    &lt;bean id=&quot;MovieFinder&quot; class=&quot;spring.ColonMovieFinder&quot;&gt;        &lt;property name=&quot;filename&quot;&gt;            &lt;value&gt;movies1.txt&lt;/value&gt;        &lt;/property&gt;    &lt;/bean&gt;&lt;/beans&gt;</code></pre><p>æµ‹è¯•ä»£ç ï¼š</p><pre><code>public void testWithSpring() throws Exception{    ApplicationContext ctx = newFileSystemXmlApplicationContext(&quot;spring.xml&quot;);    MovieLister lister = (MovieLister) ctx.getBean(&quot;MovieLister&quot;);    Movie[] movies = lister.moviesDirectedBy(&quot;Sergio Leone&quot;);    assertEquals(&quot;Once Upon a Time in the West&quot;,movies[0].getTitle());}</code></pre><h3 id="3-1-3-æ¥å£æ³¨å…¥"><a href="#3-1-3-æ¥å£æ³¨å…¥" class="headerlink" title="3.1.3 æ¥å£æ³¨å…¥"></a>3.1.3 æ¥å£æ³¨å…¥</h3><p>é™¤äº†å‰é¢ä¸¤ç§æ³¨å…¥æŠ€æœ¯ï¼Œè¿˜å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰éœ€è¦æ³¨å…¥çš„ä¿¡æ¯ï¼Œå¹¶é€šè¿‡æ¥å£å®Œæˆæ³¨å…¥ã€‚Avalonæ¡†æ¶å°±ä½¿ç”¨äº†ç±»ä¼¼çš„æŠ€æœ¯ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘é¦–å…ˆç”¨ç®€å•çš„èŒƒä¾‹ä»£ç è¯´æ˜å®ƒçš„ç”¨æ³•ï¼Œåé¢è¿˜ä¼šæœ‰æ›´æ·±å…¥çš„è®¨è®ºã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œ<strong>ç»„ä»¶çš„æ³¨å…¥å°†é€šè¿‡è¿™ä¸ªæ¥å£è¿›è¡Œ</strong>ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™ä¸ªæ¥å£çš„ç”¨é€”æ˜¯å°†ä¸€ä¸ªMovieFinderå®ä¾‹æ³¨å…¥ç»§æ‰¿äº†è¯¥æ¥å£çš„å¯¹è±¡ã€‚</p><pre><code>public interface InjectFinder{    void injectFinder(MovieFinder finder);}</code></pre><p>è¿™ä¸ªæ¥å£åº”è¯¥ç”±æä¾›MovieFinderæ¥å£çš„äººä¸€å¹¶æä¾›ã€‚ä»»ä½•æƒ³è¦ä½¿ç”¨MovieFinderå®ä¾‹çš„ç±»ï¼ˆä¾‹å¦‚MovieListerç±»ï¼‰éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ã€‚</p><pre><code>class MovieLister implements InjectFinder...    public void injectFinder(MovieFinder finder)    {        this.finder = finder;    }</code></pre><p>ç„¶åï¼Œæˆ‘ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•å°†æ–‡ä»¶åæ³¨å…¥MovieFinderçš„å®ç°ç±»ï¼š</p><pre><code>public interface InjectFilename{    void injectFilename (String filename);}class ColonMovieFinder implements MovieFinder, InjectFilename...    public void injectFilename(String filename)    {        this.filename = filename;    }</code></pre><p>ç°åœ¨ï¼Œè¿˜éœ€è¦ç”¨ä¸€äº›é…ç½®ä»£ç å°†æ‰€æœ‰çš„ç»„ä»¶å®ç°è£…é…èµ·æ¥ã€‚ç®€å•èµ·è§ï¼Œæˆ‘ç›´æ¥åœ¨ä»£ç ä¸­å®Œæˆé…ç½®ï¼Œå¹¶å°†é…ç½®å¥½çš„MovieLister å¯¹è±¡ä¿å­˜åœ¨åä¸ºlisterçš„å­—æ®µä¸­ï¼š</p><pre><code>class IfaceTester...    private MovieLister lister;    private void configureLister()    {        ColonMovieFinder finder = new ColonMovieFinder();        finder.injectFilename(&quot;movies1.txt&quot;);        lister = new MovieLister();        lister.injectFinder(finder);    }</code></pre><p>æµ‹è¯•ä»£ç ï¼š</p><pre><code>class IfaceTester...public void testIface(){    configureLister();    Movie[] movies = lister.moviesDirectedBy(&quot;Sergio Leone&quot;);    assertEquals(&quot;Once Upon a Time in the West&quot;,movies[0].getTitle());}</code></pre><h2 id="3-2-æ„é€ å‡½æ•°æ³¨å…¥-vs-è®¾å€¼æ–¹æ³•æ³¨å…¥"><a href="#3-2-æ„é€ å‡½æ•°æ³¨å…¥-vs-è®¾å€¼æ–¹æ³•æ³¨å…¥" class="headerlink" title="3.2 æ„é€ å‡½æ•°æ³¨å…¥ vs. è®¾å€¼æ–¹æ³•æ³¨å…¥"></a>3.2 æ„é€ å‡½æ•°æ³¨å…¥ vs. è®¾å€¼æ–¹æ³•æ³¨å…¥</h2><p>åœ¨ç»„åˆæœåŠ¡æ—¶ï¼Œä½ æ€»å¾—éµå¾ªä¸€å®šçš„çº¦å®šï¼Œæ‰å¯èƒ½å°†æ‰€æœ‰ä¸œè¥¿æ‹¼è£…èµ·æ¥ã€‚<strong>ä¾èµ–æ³¨å…¥çš„ä¼˜ç‚¹ä¸»è¦åœ¨äºï¼šå®ƒåªéœ€è¦éå¸¸ç®€å•çš„çº¦å®šâ€”â€”è‡³å°‘å¯¹äºæ„é€ å‡½æ•°æ³¨å…¥å’Œè®¾å€¼æ–¹æ³•æ³¨å…¥æ¥è¯´æ˜¯è¿™æ ·</strong>ã€‚ç›¸æ¯”äºè¿™ä¸¤è€…ï¼Œæ¥å£æ³¨å…¥çš„ä¾µç•¥æ€§è¦å¼ºå¾—å¤šï¼Œæ¯”èµ·Service Locatoræ¨¡å¼çš„ä¼˜åŠ¿ä¹Ÿä¸é‚£ä¹ˆæ˜æ˜¾ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è¦æä¾›ä¸€ä¸ªç»„ä»¶ç»™å¤šä¸ªä½¿ç”¨è€…ï¼Œæ„é€ å‡½æ•°æ³¨å…¥å’Œè®¾å€¼æ–¹æ³•æ³¨å…¥çœ‹èµ·æ¥å¾ˆæœ‰å¸å¼•åŠ›ã€‚ä½ ä¸å¿…åœ¨ç»„ä»¶ä¸­åŠ å…¥ä»€ä¹ˆå¸Œå¥‡å¤æ€ªçš„ä¸œè¥¿ï¼Œæ³¨å…¥å™¨å¯ä»¥ç›¸å½“è½»æ¾åœ°æŠŠæ‰€æœ‰ä¸œè¥¿é…ç½®èµ·æ¥ã€‚</p><p>è®¾å€¼å‡½æ•°æ³¨å…¥å’Œæ„é€ å‡½æ•°æ³¨å…¥ä¹‹é—´çš„é€‰æ‹©ç›¸å½“æœ‰è¶£ï¼Œå› ä¸ºå®ƒæŠ˜å°„å‡ºé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€äº›æ›´æ™®éçš„é—®é¢˜ï¼šåº”è¯¥åœ¨å“ªé‡Œå¡«å……å¯¹è±¡çš„å­—æ®µï¼Œæ„é€ å‡½æ•°è¿˜æ˜¯è®¾å€¼æ–¹æ³•ï¼Ÿ</p><p>ä¸€ç›´ä»¥æ¥ï¼Œæˆ‘é¦–é€‰çš„åšæ³•æ˜¯å°½é‡åœ¨æ„é€ é˜¶æ®µå°±åˆ›å»ºå®Œæ•´ã€åˆæ³•çš„å¯¹è±¡â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­å¡«å……å¯¹è±¡å­—æ®µã€‚è¿™æ ·åšçš„å¥½å¤„å¯ä»¥è¿½æº¯åˆ°Kent Beckåœ¨Smalltalk Best Practice Patternsä¸€ä¹¦ä¸­ä»‹ç»çš„ä¸¤ä¸ªæ¨¡å¼ï¼šConstructor Methodå’ŒConstructor Parameter Methodã€‚å¸¦æœ‰å‚æ•°çš„æ„é€ å‡½æ•°å¯ä»¥æ˜ç¡®åœ°å‘Šè¯‰ä½ å¦‚ä½•åˆ›å»ºä¸€ä¸ªåˆæ³•çš„å¯¹è±¡ã€‚å¦‚æœåˆ›å»ºåˆæ³•å¯¹è±¡çš„æ–¹å¼ä¸æ­¢ä¸€ç§ï¼Œä½ è¿˜å¯ä»¥æä¾›å¤šä¸ªæ„é€ å‡½æ•°ï¼Œä»¥è¯´æ˜ä¸åŒçš„ç»„åˆæ–¹å¼ã€‚</p><p>æ„é€ å‡½æ•°åˆå§‹åŒ–çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼šä½ å¯ä»¥éšè—ä»»ä½•ä¸å¯å˜çš„å­—æ®µâ€”â€”åªè¦ä¸ä¸ºå®ƒæä¾›è®¾å€¼æ–¹æ³•å°±è¡Œäº†ã€‚æˆ‘è®¤ä¸ºè¿™å¾ˆé‡è¦ï¼šå¦‚æœæŸä¸ªå­—æ®µæ˜¯ä¸åº”è¯¥è¢«æ”¹å˜çš„ï¼Œæ²¡æœ‰é’ˆå¯¹è¯¥å­—æ®µçš„è®¾å€¼æ–¹æ³•å°±å¾ˆæ¸…æ¥šåœ°è¯´æ˜äº†è¿™ä¸€ç‚¹ã€‚å¦‚æœä½ é€šè¿‡è®¾å€¼æ–¹æ³•å®Œæˆåˆå§‹åŒ–ï¼Œæš´éœ²å‡ºæ¥çš„è®¾å€¼æ–¹æ³•å¾ˆå¯èƒ½æˆä¸ºä½ å¿ƒå¤´æ°¸è¿œçš„ç—›ã€‚ï¼ˆå®é™…ä¸Šï¼Œåœ¨è¿™ç§æ—¶å€™æˆ‘æ›´æ„¿æ„å›é¿é€šå¸¸çš„è®¾å€¼æ–¹æ³•çº¦å®šï¼Œè€Œæ˜¯ä½¿ç”¨è¯¸å¦‚initFooä¹‹ç±»çš„æ–¹æ³•åï¼Œä»¥è¡¨æ˜è¯¥æ–¹æ³•åªåº”è¯¥åœ¨å¯¹è±¡åˆ›å»ºä¹‹åˆè°ƒç”¨ã€‚ï¼‰</p><p>ä¸è¿‡ï¼Œä¸–äº‹æ€»æœ‰ä¾‹å¤–ã€‚å¦‚æœå‚æ•°å¤ªå¤šï¼Œæ„é€ å‡½æ•°ä¼šæ˜¾å¾—å‡Œä¹±ä¸å ªï¼Œç‰¹åˆ«æ˜¯å¯¹äºä¸æ”¯æŒå…³é”®å­—å‚æ•°çš„è¯­è¨€æ›´æ˜¯å¦‚æ­¤ã€‚çš„ç¡®ï¼Œå¦‚æœæ„é€ å‡½æ•°å‚æ•°åˆ—è¡¨å¤ªé•¿ï¼Œé€šå¸¸æ ‡å¿—ç€å¯¹è±¡å¤ªè¿‡ç¹å¿™ï¼Œç†åº”å°†å…¶æ‹†åˆ†æˆå‡ ä¸ªå¯¹è±¡ï¼Œä½†æœ‰äº›æ—¶å€™ä¹Ÿç¡®å®éœ€è¦é‚£ä¹ˆå¤šçš„å‚æ•°ã€‚å¦‚æœæœ‰ä¸æ­¢ä¸€ç§çš„æ–¹å¼å¯ä»¥æ„é€ ä¸€ä¸ªåˆæ³•çš„å¯¹è±¡ï¼Œä¹Ÿå¾ˆéš¾é€šè¿‡æ„é€ å‡½æ•°æè¿°è¿™ä¸€ä¿¡æ¯ï¼Œå› ä¸ºæ„é€ å‡½æ•°ä¹‹é—´åªèƒ½é€šè¿‡å‚æ•°çš„ä¸ªæ•°å’Œç±»å‹åŠ ä»¥åŒºåˆ†ã€‚è¿™å°±æ˜¯Factory Methodæ¨¡å¼é€‚ç”¨çš„åœºåˆäº†ï¼Œå·¥å‚æ–¹æ³•<strong>å¯ä»¥å€ŸåŠ©å¤šä¸ªç§æœ‰æ„é€ å‡½æ•°å’Œè®¾å€¼æ–¹æ³•çš„ç»„åˆæ¥å®Œæˆè‡ªå·±çš„ä»»åŠ¡</strong>ã€‚ç»å…¸Factory Methodæ¨¡å¼çš„é—®é¢˜åœ¨äºï¼šå®ƒä»¬å¾€å¾€ä»¥é™æ€æ–¹æ³•çš„å½¢å¼å‡ºç°ï¼Œä½ æ— æ³•åœ¨æ¥å£ä¸­å£°æ˜å®ƒä»¬ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œä½†é‚£åˆå˜æˆå¦ä¸€ä¸ªæœåŠ¡å®ä½“äº†ã€‚å·¥å‚æœåŠ¡æ˜¯ä¸€ç§ä¸é”™çš„æŠ€å·§ï¼Œä½†ä½ ä»ç„¶éœ€è¦ä»¥æŸç§æ–¹å¼å®ä¾‹åŒ–è¿™ä¸ªå·¥å‚å¯¹è±¡ï¼Œé—®é¢˜ä»ç„¶æ²¡æœ‰è§£å†³ã€‚</p><p>å¦‚æœè¦ä¼ å…¥çš„å‚æ•°æ˜¯åƒå­—ç¬¦ä¸²è¿™æ ·çš„ç®€å•ç±»å‹ï¼Œæ„é€ å‡½æ•°æ³¨å…¥ä¹Ÿä¼šå¸¦æ¥ä¸€äº›éº»çƒ¦ã€‚ä½¿ç”¨è®¾å€¼æ–¹æ³•æ³¨å…¥æ—¶ï¼Œä½ å¯ä»¥åœ¨æ¯ä¸ªè®¾å€¼æ–¹æ³•çš„åå­—ä¸­è¯´æ˜å‚æ•°çš„ç”¨é€”ï¼›è€Œä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥æ—¶ï¼Œä½ åªèƒ½é å‚æ•°çš„ä½ç½®æ¥å†³å®šæ¯ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œè€Œè®°ä½å‚æ•°çš„æ­£ç¡®ä½ç½®æ˜¾ç„¶è¦å›°éš¾å¾—å¤šã€‚</p><p>å¦‚æœå¯¹è±¡æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œå¯¹è±¡ä¹‹é—´åˆå­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œäº‹æƒ…å°±ä¼šå˜å¾—ç‰¹åˆ«è®¨åŒã€‚ä¸ºäº†è®©æ‰€æœ‰ä¸œè¥¿éƒ½æ­£ç¡®åœ°åˆå§‹åŒ–ï¼Œä½ å¿…é¡»å°†å¯¹å­ç±»æ„é€ å‡½æ•°çš„è°ƒç”¨è½¬å‘ç»™è¶…ç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶åå¤„ç†è‡ªå·±çš„å‚æ•°ã€‚è¿™å¯èƒ½é€ æˆæ„é€ å‡½æ•°è§„æ¨¡çš„è¿›ä¸€æ­¥è†¨èƒ€ã€‚</p><p>å°½ç®¡æœ‰è¿™äº›ç¼ºé™·ï¼Œä½†æˆ‘ä»ç„¶å»ºè®®ä½ é¦–å…ˆè€ƒè™‘æ„é€ å‡½æ•°æ³¨å…¥ã€‚ä¸è¿‡ï¼Œä¸€æ—¦å‰é¢æåˆ°çš„é—®é¢˜çœŸçš„æˆäº†é—®é¢˜ï¼Œä½ å°±åº”è¯¥å‡†å¤‡è½¬ä¸ºä½¿ç”¨è®¾å€¼æ–¹æ³•æ³¨å…¥ã€‚</p><h2 id="3-3-ä»£ç é…ç½®-vs-é…ç½®æ–‡ä»¶"><a href="#3-3-ä»£ç é…ç½®-vs-é…ç½®æ–‡ä»¶" class="headerlink" title="3.3 ä»£ç é…ç½® vs é…ç½®æ–‡ä»¶"></a>3.3 ä»£ç é…ç½® vs é…ç½®æ–‡ä»¶</h2><p>å¦ä¸€ä¸ªé—®é¢˜ç›¸å¯¹ç‹¬ç«‹ï¼Œä½†ä¹Ÿç»å¸¸ä¸å…¶ä»–é—®é¢˜ç‰µæ¶‰åœ¨ä¸€èµ·ï¼šå¦‚ä½•é…ç½®æœåŠ¡çš„ç»„è£…ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶è¿˜æ˜¯ç›´æ¥ç¼–ç ç»„è£…ï¼Ÿå¯¹äºå¤§å¤šæ•°éœ€è¦åœ¨å¤šå¤„éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œä¸€ä¸ªå•ç‹¬çš„é…ç½®æ–‡ä»¶ä¼šæ›´åˆé€‚ã€‚é…ç½®æ–‡ä»¶å‡ ä¹éƒ½æ˜¯XML æ–‡ä»¶ï¼ŒXML ä¹Ÿçš„ç¡®å¾ˆé€‚åˆè¿™ä¸€ç”¨é€”ã€‚ä¸è¿‡ï¼Œæœ‰äº›æ—¶å€™ç›´æ¥åœ¨ç¨‹åºä»£ç ä¸­å®ç°è£…é…ä¼šæ›´ç®€å•ã€‚è­¬å¦‚ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä¹Ÿæ²¡æœ‰å¾ˆå¤šéƒ¨ç½²ä¸Šçš„å˜åŒ–ï¼Œè¿™æ—¶ç”¨å‡ å¥ä»£ç æ¥é…ç½®å°±æ¯”XML æ–‡ä»¶è¦æ¸…æ™°å¾—å¤šã€‚</p><p>ä¸ä¹‹ç›¸å¯¹çš„ï¼Œæœ‰æ—¶åº”ç”¨ç¨‹åºçš„ç»„è£…éå¸¸å¤æ‚ï¼Œæ¶‰åŠå¤§é‡çš„æ¡ä»¶æ­¥éª¤ã€‚ä¸€æ—¦ç¼–ç¨‹è¯­è¨€ä¸­çš„é…ç½®é€»è¾‘å¼€å§‹å˜å¾—å¤æ‚ï¼Œä½ å°±åº”è¯¥ç”¨ä¸€ç§åˆé€‚çš„è¯­è¨€æ¥æè¿°é…ç½®ä¿¡æ¯ï¼Œä½¿ç¨‹åºé€»è¾‘å˜å¾—æ›´æ¸…æ™°ã€‚ç„¶åï¼Œ<strong>ä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªæ„é€ å™¨ï¼ˆbuilderï¼‰ç±»æ¥å®Œæˆè£…é…å·¥ä½œ</strong>ã€‚å¦‚æœä½¿ç”¨æ„é€ å™¨çš„æƒ…æ™¯ä¸æ­¢ä¸€ç§ï¼Œä½ å¯ä»¥æä¾›å¤šä¸ªæ„é€ å™¨ç±»ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªç®€å•çš„é…ç½®æ–‡ä»¶åœ¨å®ƒä»¬ä¹‹é—´é€‰æ‹©ã€‚</p><p>æˆ‘å¸¸å¸¸å‘ç°ï¼Œäººä»¬å¤ªæ€¥äºå®šä¹‰é…ç½®æ–‡ä»¶ã€‚ç¼–ç¨‹è¯­è¨€é€šå¸¸ä¼šæä¾›ç®€æ·è€Œå¼ºå¤§çš„é…ç½®ç®¡ç†æœºåˆ¶ï¼Œç°ä»£ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥å°†ç¨‹åºç¼–è¯‘æˆå°çš„æ¨¡å—ï¼Œå¹¶å°†å…¶æ’å…¥å¤§å‹ç³»ç»Ÿä¸­ã€‚å¦‚æœç¼–è¯‘è¿‡ç¨‹ä¼šå¾ˆè´¹åŠ›ï¼Œè„šæœ¬è¯­è¨€ä¹Ÿå¯ä»¥åœ¨è¿™æ–¹é¢æä¾›å¸®åŠ©ã€‚é€šå¸¸è®¤ä¸ºï¼Œé…ç½®æ–‡ä»¶ä¸åº”è¯¥ç”¨ç¼–ç¨‹è¯­è¨€æ¥ç¼–å†™ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦èƒ½å¤Ÿè¢«ä¸æ‡‚ç¼–ç¨‹çš„ç³»ç»Ÿç®¡ç†äººå‘˜ç¼–è¾‘ã€‚ä½†æ˜¯ï¼Œè¿™ç§æƒ…å†µå‡ºç°çš„å‡ ç‡æœ‰å¤šå¤§å‘¢ï¼Ÿæˆ‘ä»¬çœŸçš„å¸Œæœ›ä¸æ‡‚ç¼–ç¨‹çš„ç³»ç»Ÿç®¡ç†äººå‘˜æ¥æ”¹å˜ä¸€ä¸ªå¤æ‚çš„æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºçš„äº‹åŠ¡éš”ç¦»ç­‰çº§å—ï¼Ÿåªæœ‰åœ¨éå¸¸ç®€å•çš„æ—¶å€™ï¼Œéç¼–ç¨‹è¯­è¨€çš„é…ç½®æ–‡ä»¶æ‰æœ‰æœ€å¥½çš„æ•ˆæœã€‚å¦‚æœé…ç½®ä¿¡æ¯å¼€å§‹å˜å¾—å¤æ‚ï¼Œå°±åº”è¯¥è€ƒè™‘é€‰æ‹©ä¸€ç§åˆé€‚çš„ç¼–ç¨‹è¯­è¨€æ¥ç¼–å†™é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨Java ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬å¬åˆ°äº†æ¥è‡ªé…ç½®æ–‡ä»¶çš„ä¸å’Œè°éŸ³â€”â€”æ¯ä¸ªç»„ä»¶éƒ½æœ‰å®ƒè‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œè€Œä¸”æ ¼å¼è¿˜å„ä¸ç›¸åŒã€‚å¦‚æœä½ è¦ä½¿ç”¨ä¸€æ‰“è¿™æ ·çš„ç»„ä»¶ï¼Œä½ å°±å¾—ç»´æŠ¤ä¸€æ‰“çš„é…ç½®æ–‡ä»¶ï¼Œé‚£ä¼šå¾ˆå¿«è®©ä½ çƒ¦æ­»ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼šå§‹ç»ˆæä¾›ä¸€ç§æ ‡å‡†çš„é…ç½®æ–¹å¼ï¼Œä½¿ç¨‹åºå‘˜èƒ½å¤Ÿé€šè¿‡åŒä¸€ä¸ªç¼–ç¨‹æ¥å£è½»æ¾åœ°å®Œæˆé…ç½®å·¥ä½œã€‚è‡³äºå…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œä»…ä»…æŠŠå®ƒä»¬å½“ä½œä¸€ç§å¯é€‰çš„åŠŸèƒ½ã€‚å€ŸåŠ©è¿™ä¸ªç¼–ç¨‹æ¥å£ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°ç®¡ç†é…ç½®æ–‡ä»¶ã€‚å¦‚æœä½ ç¼–å†™äº†ä¸€ä¸ªç»„ä»¶ï¼Œåˆ™å¯ä»¥ç”±ç»„ä»¶çš„ä½¿ç”¨è€…æ¥é€‰æ‹©å¦‚ä½•ç®¡ç†é…ç½®ä¿¡æ¯ï¼šä½¿ç”¨ä½ çš„ç¼–ç¨‹æ¥å£ã€ç›´æ¥æ“ä½œé…ç½®æ–‡ä»¶æ ¼å¼ï¼Œæˆ–è€…å®šä¹‰ä»–ä»¬è‡ªå·±çš„é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œå¹¶å°†å…¶ä¸ä½ çš„ç¼–ç¨‹æ¥å£ç›¸ç»“åˆã€‚</p><h2 id="3-4-åˆ†ç¦»é…ç½®å’Œä½¿ç”¨"><a href="#3-4-åˆ†ç¦»é…ç½®å’Œä½¿ç”¨" class="headerlink" title="3.4 åˆ†ç¦»é…ç½®å’Œä½¿ç”¨"></a>3.4 åˆ†ç¦»é…ç½®å’Œä½¿ç”¨</h2><p>æ‰€æœ‰è¿™ä¸€åˆ‡çš„å…³é”®åœ¨äºï¼š<strong><em>æœåŠ¡çš„é…ç½®åº”è¯¥ä¸ä½¿ç”¨åˆ†å¼€</em></strong>ã€‚å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¾è®¡åŸåˆ™â€”â€”åˆ†ç¦»æ¥å£ä¸å®ç°ã€‚åœ¨é¢å‘å¯¹è±¡ç¨‹åºé‡Œï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªåœ°æ–¹ç”¨æ¡ä»¶é€»è¾‘æ¥å†³å®šå…·ä½“å®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ï¼Œä»¥åçš„æ¡ä»¶åˆ†æ”¯éƒ½ç”±å¤šæ€æ¥å®ç°ï¼Œè€Œä¸æ˜¯ç»§ç»­é‡å¤å‰é¢çš„æ¡ä»¶é€»è¾‘ï¼Œè¿™å°±æ˜¯åˆ†ç¦»æ¥å£ä¸å®ç°çš„åŸåˆ™ã€‚</p><p>å¦‚æœå¯¹äºä¸€æ®µä»£ç è€Œè¨€ï¼Œæ¥å£ä¸å®ç°çš„åˆ†ç¦»è¿˜åªæ˜¯æœ‰ç”¨çš„è¯ï¼Œé‚£ä¹ˆå½“ä½ éœ€è¦ä½¿ç”¨å¤–éƒ¨å…ƒç´ ï¼ˆä¾‹å¦‚ç»„ä»¶å’ŒæœåŠ¡ï¼‰æ—¶ï¼Œå®ƒå°±æ˜¯ç”Ÿæ­»æ”¸å…³çš„å¤§äº‹ã€‚è¿™é‡Œçš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šä½ æ˜¯å¦å¸Œæœ›å°†é€‰æ‹©å…·ä½“å®ç°ç±»çš„å†³ç­–æ¨è¿Ÿåˆ°éƒ¨ç½²é˜¶æ®µã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨æ’å…¥æŠ€æœ¯ã€‚ä½¿ç”¨äº†æ’å…¥æŠ€æœ¯ä¹‹åï¼Œæ’ä»¶çš„è£…é…åŸåˆ™ä¸Šæ˜¯ä¸åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†åˆ†å¼€çš„ï¼Œè¿™æ ·ä½ å°±å¯ä»¥è½»æ¾åœ°é’ˆå¯¹ä¸åŒçš„éƒ¨ç½²æ›¿æ¢ä¸åŒçš„é…ç½®ã€‚è¿™ç§é…ç½®æœºåˆ¶å¯ä»¥é€šè¿‡æœåŠ¡å®šä½å™¨æ¥å®ç°ï¼ˆService Locatoræ¨¡å¼ï¼‰ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©ä¾èµ–æ³¨å…¥ç›´æ¥å®Œæˆï¼ˆDependency Injection æ¨¡å¼ï¼‰ã€‚</p><h1 id="4-ç»“è®ºä¸æ€è€ƒ"><a href="#4-ç»“è®ºä¸æ€è€ƒ" class="headerlink" title="4. ç»“è®ºä¸æ€è€ƒ"></a>4. ç»“è®ºä¸æ€è€ƒ</h1><p>åœ¨æ—¶ä¸‹æµè¡Œçš„è½»é‡çº§å®¹å™¨éƒ½ä½¿ç”¨äº†ä¸€ä¸ªå…±åŒçš„æ¨¡å¼æ¥ç»„è£…åº”ç”¨ç¨‹åºæ‰€éœ€çš„æœåŠ¡ï¼Œæˆ‘æŠŠè¿™ä¸ªæ¨¡å¼ç§°ä¸ºDependency Injectionï¼Œå®ƒå¯ä»¥æœ‰æ•ˆåœ°æ›¿ä»£Service Locatoræ¨¡å¼ã€‚åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œä¸¤è€…ä¸ç›¸ä¸Šä¸‹ï¼Œä½†æˆ‘è®¤ä¸ºService Locatoræ¨¡å¼ç•¥æœ‰ä¼˜åŠ¿ï¼Œå› ä¸ºå®ƒçš„è¡Œä¸ºæ–¹å¼æ›´ä¸ºç›´è§‚ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ å¼€å‘çš„ç»„ä»¶è¦äº¤ç»™å¤šä¸ªåº”ç”¨ç¨‹åºå»ä½¿ç”¨ï¼Œé‚£ä¹ˆDependency Injectionæ¨¡å¼ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p><p>å¦‚æœä½ å†³å®šä½¿ç”¨Dependency Injectionæ¨¡å¼ï¼Œè¿™é‡Œè¿˜æœ‰å‡ ç§ä¸åŒçš„é£æ ¼å¯ä¾›é€‰æ‹©ã€‚æˆ‘å»ºè®®ä½ é¦–å…ˆè€ƒè™‘æ„é€ å‡½æ•°æ³¨å…¥ï¼›å¦‚æœé‡åˆ°äº†æŸäº›ç‰¹å®šçš„é—®é¢˜ï¼Œå†æ”¹ç”¨è®¾å€¼æ–¹æ³•æ³¨å…¥ã€‚å¦‚æœä½ è¦é€‰æ‹©ä¸€ä¸ªå®¹å™¨ï¼Œåœ¨å…¶ä¹‹ä¸Šè¿›è¡Œå¼€å‘ï¼Œæˆ‘å»ºè®®ä½ é€‰æ‹©åŒæ—¶æ”¯æŒè¿™ä¸¤ç§æ³¨å…¥æ–¹å¼çš„å®¹å™¨ã€‚</p><p>Service Locator æ¨¡å¼å’ŒDependency Injection æ¨¡å¼ä¹‹é—´çš„é€‰æ‹©å¹¶æ˜¯æœ€é‡è¦çš„ï¼Œæ›´é‡è¦çš„æ˜¯ï¼šåº”è¯¥å°†æœåŠ¡çš„é…ç½®å’Œåº”ç”¨ç¨‹åºå†…éƒ¨å¯¹æœåŠ¡çš„ä½¿ç”¨åˆ†ç¦»å¼€ã€‚</p><p><a href="https://martinfowler.com/articles/injection.html" target="_blank" rel="noopener">1.[Inversion of Control Containers and the Dependency Injection pattern]</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> BackEnd </tag>
            
            <tag> IOC </tag>
            
            <tag> Dependency Injection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UML - Class Diagram</title>
      <link href="/UML-Class-Diagram/"/>
      <url>/UML-Class-Diagram/</url>
      
        <content type="html"><![CDATA[<p>Alright, some basic knowledge collecting from wiki, uml tutorial websites. Merely regrad this blog as a reference, when you creating/ reading some class disgram, you might wanna look at the blog for better understanding. </p><h1 id="1-Visibility"><a href="#1-Visibility" class="headerlink" title="1. Visibility"></a>1. Visibility</h1><ul><li>+ public </li><li>- private </li><li># protected </li><li>~ package </li></ul><h1 id="2-Relationships"><a href="#2-Relationships" class="headerlink" title="2. Relationships"></a>2. Relationships</h1><p>Types of logical connections found on class and object diagrams. </p><p><img src="https://i.loli.net/2020/02/03/EHNIMsw3hv142yd.png" alt="fig1.png"></p><h2 id="2-1-Dependency"><a href="#2-1-Dependency" class="headerlink" title="2.1 Dependency"></a>2.1 Dependency</h2><p>A sementic connection between dependent and independent model elements. </p><h2 id="2-2-Association"><a href="#2-2-Association" class="headerlink" title="2.2 Association"></a>2.2 Association</h2><p>A binary association </p><h2 id="2-3-Aggregation"><a href="#2-3-Aggregation" class="headerlink" title="2.3 Aggregation"></a>2.3 Aggregation</h2><p>Has a assocation relationship </p><h2 id="2-4-Compostion"><a href="#2-4-Compostion" class="headerlink" title="2.4 Compostion"></a>2.4 Compostion</h2><p>Has a, and without parent, child will not exist </p><h2 id="2-5-Inheritance"><a href="#2-5-Inheritance" class="headerlink" title="2.5 Inheritance"></a>2.5 Inheritance</h2><h2 id="2-6-Realization-Implementation"><a href="#2-6-Realization-Implementation" class="headerlink" title="2.6 Realization/ Implementation"></a>2.6 Realization/ Implementation</h2><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://en.wikipedia.org/wiki/Class_diagram" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Class_diagram</a></li><li><a href="https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html" target="_blank" rel="noopener">https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> System Design </tag>
            
            <tag> UML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Event Storming</title>
      <link href="/Event-Storming/"/>
      <url>/Event-Storming/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯äº‹ä»¶é£æš´ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯äº‹ä»¶é£æš´ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯äº‹ä»¶é£æš´ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯äº‹ä»¶é£æš´ï¼Ÿ</h1><p>é€šè¿‡ä¾¿ç­¾è€Œä¸æ˜¯ä»£ç æ¥ç†è§£ä½ çš„æ•´ä¸ªç³»ç»Ÿï¼Œå¹¶ä¸æ–­é©æ–°ä½ çš„å•†ä¸šé€»è¾‘å’Œéœ€æ±‚ã€‚</p><p>æ„å»ºä¸€ä¸ªèƒ½å¤Ÿå¯¹äº‹ä»¶åŠæ—¶ä½œå‡ºååº”çš„ç³»ç»Ÿ</p><p>äº‹ä»¶é£æš´æ˜¯ä¸€ç§ç»„ç»‡æ¶æ„çš„æ–¹æ³•ï¼Œä»–æ˜¯åœ¨è®¨è®ºäº‹ä»¶åœ¨ä½ çš„ç»„ç»‡é‡Œçš„æµåŠ¨ï¼Œå¹¶å°†å…¶ç”¨ä¸€ç§æ˜“äºç†è§£çš„æ–¹å¼æ¨¡å‹åŒ–ã€‚</p><p>å®è´¨ä¸Šæƒ³åšçš„äº‹æƒ…æ˜¯é€šè¿‡äº¤æµï¼Œèƒ½å¤Ÿæ›´åŠ è¿…é€Ÿçš„äº†è§£åˆ°åœ¨è¿™ä¸ªç®€å•äº‹æƒ…çš„èƒŒåéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œäº†è§£åˆ°æ•°æ®/ä¿¡æ¯ç©¶ç«Ÿæ˜¯å¦‚ä½•åœ¨å¤šä¸ªç³»ç»Ÿé—´è¿›è¡ŒæµåŠ¨çš„ã€‚</p><p>æƒ³è¾¾åˆ°çš„ç›®æ ‡å°±æ˜¯é€šè¿‡ä¾¿ç­¾çº¸åœ¨ç™½æ¿ä¸Šå±•ç°å‡ºåœ¨æ¯ä¸ªæ­¥éª¤å½“ä¸­æƒ³è¦åšçš„äº‹æƒ…ï¼Œè¿™æ ·èƒ½æ›´å¥½çš„ç†è§£å•†ä¸šéœ€æ±‚ï¼Œä¸éœ€è¦å¤ªè¿‡äºå…³æ³¨æŠ€æœ¯ç»†èŠ‚ã€‚</p><h1 id="2-å…³é”®çš„å‡ ä¸ªæ¦‚å¿µ"><a href="#2-å…³é”®çš„å‡ ä¸ªæ¦‚å¿µ" class="headerlink" title="2. å…³é”®çš„å‡ ä¸ªæ¦‚å¿µ"></a>2. å…³é”®çš„å‡ ä¸ªæ¦‚å¿µ</h1><h2 id="2-1-Events-and-Reactions"><a href="#2-1-Events-and-Reactions" class="headerlink" title="2.1 Events and Reactions"></a>2.1 Events and Reactions</h2><p>å¯ä»¥ç®€åŒ–ä¸ºå› æœå…³ç³»ï¼Œæˆ–è€…è¯´æ˜¯èµ·å› åŠå…¶å½±å“ã€‚é‡è¦çš„äº‹ä»¶ä¼šåœ¨ç³»ç»Ÿå½“ä¸­å¼•å‘ä¸€äº›å½±å“ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸ºä»€ä¹ˆè¿™äº›ååº”ä¼šå‘ç”Ÿï¼Œä»¥åŠå…¶æ˜¯æ€ä¹ˆæ ·å‘ç”Ÿçš„ã€‚</p><h2 id="2-2-äº‹ä»¶æµ"><a href="#2-2-äº‹ä»¶æµ" class="headerlink" title="2.2 äº‹ä»¶æµ"></a>2.2 äº‹ä»¶æµ</h2><p>å•ç‹¬çš„äº‹ä»¶æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„å½±å“ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„æ˜¯äº‹ä»¶æµï¼Œå³äº‹ä»¶åœ¨ä¸€æ®µæ—¶é—´å†…çš„å˜åŒ–ã€‚æˆ‘ä»¬è¦åšçš„å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨ä¾¿ç­¾çº¸ï¼Œä»å·¦åˆ°å³ï¼ŒæŒ‰ç…§æ—¶é—´é¡ºåºï¼Œè®°å½•ä¸‹äº‹ä»¶çš„å‘ç”Ÿã€‚å½“æˆ‘ä»¬æœ‰äº†è¿™æ ·çš„ä¸€ä¸ªçº¿æ€§çš„äº‹ä»¶æµä»¥åï¼Œä¸‹ä¸€æ­¥æ˜¯å»æ€è€ƒäº‹ä»¶æ˜¯å› ä½•è€Œå‘ç”Ÿçš„ã€‚</p><h2 id="2-3-Reactions"><a href="#2-3-Reactions" class="headerlink" title="2.3 Reactions"></a>2.3 Reactions</h2><p>åé¦ˆæ˜¯åœ¨å…¶ä»–äº‹ä»¶å‘ç”Ÿä»¥åå‘ç”Ÿçš„äº‹ä»¶ã€‚ â€“ this happens whenever that happens. </p><h2 id="2-4-Policy"><a href="#2-4-Policy" class="headerlink" title="2.4 Policy"></a>2.4 Policy</h2><p>Policyæ˜¯æŒ‡äº‹ä»¶å’Œå…¶åé¦ˆçš„æ•´ä½“æµåŠ¨ã€‚æˆ‘ä»¬ç§°å…¶ä¸ºpolicy æ˜¯å› ä¸ºè¿™ä¸ªæµåŠ¨æ•æ‰åˆ°äº†æ ¸å¿ƒçš„å•†ä¸šé€»è¾‘å’Œè§„åˆ™ã€‚</p><h2 id="2-5-Commands"><a href="#2-5-Commands" class="headerlink" title="2.5 Commands"></a>2.5 Commands</h2><p>æ¥ä»£è¡¨ç”¨æˆ·çš„æŸäº›è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºå¯ä»¥è§¦å‘æŸäº›äº‹ä»¶çš„å‘ç”Ÿï¼Œæˆ–è€…è¯´è¿™äº›è¡Œä¸ºæœ¬èº«å¾ˆæœ‰å¯èƒ½å°±æ˜¯æŸäº›äº‹ä»¶ï¼Œè€Œè¿™äº›äº‹ä»¶ä¼šè§¦å‘æŸäº›reactionï¼Œç„¶åå†åº¦è§¦å‘äº‹ä»¶ï¼Œä¸€ä»¥è´¯ä¹‹ã€‚</p><h1 id="3-èƒŒåé€»è¾‘"><a href="#3-èƒŒåé€»è¾‘" class="headerlink" title="3. èƒŒåé€»è¾‘"></a>3. èƒŒåé€»è¾‘</h1><p>ä¸ªäººæ„Ÿè§‰è¿™ä¸ä»…ä»…æ˜¯åº”ç”¨åœ¨æŠ€æœ¯æ¶æ„å’Œæ¨¡å‹ä¸Šï¼Œä»»ä½•å•†ä¸šä¸Šçš„äº‹åŠ¡ï¼Œæƒ³è¦æ˜æ™°å•†ä¸šé€»è¾‘ï¼Œéƒ½å¯ä»¥ç”¨è¿™ä¸€å¥—é€»è¾‘é“¾æ¡æ¥è¿›è¡Œåˆ†æã€‚æ ¸å¿ƒå°±æ˜¯ç”¨æˆ·è¡Œä¸ºï¼Œäº‹ä»¶ï¼Œå¹³å°/app å¯¹äº‹ä»¶ä½œå‡ºçš„ååº”ï¼Œä¸‰è€…å½¢æˆä¸€ä¸ªå¯ä»¥å¾ªç¯å¾€å¤çš„åœˆï¼Œä¸åœå¸¦æ¥æ–°çš„è¡Œä¸ºå’Œæ–°çš„åé¦ˆã€‚è¿™æ˜¯è¡Œä¸ºç¯ï¼Œè¿˜æœ‰åˆ©ç›Šç¯ï¼Œå³æ¯ä¸ªè§’è‰²åœ¨è¿™æ•´ä¸ªè¿‡ç¨‹å½“ä¸­äº¤æ¢äº†ä»€ä¹ˆï¼Œè·å¾—äº†ä»€ä¹ˆã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://ziobrando.blogspot.com/2013/11/introducing-event-storming.html" target="_blank" rel="noopener">https://ziobrando.blogspot.com/2013/11/introducing-event-storming.html</a></li><li><a href="https://blog.redelastic.com/corporate-arts-crafts-modelling-reactive-systems-with-event-storming-73c6236f5dd7" target="_blank" rel="noopener">https://blog.redelastic.com/corporate-arts-crafts-modelling-reactive-systems-with-event-storming-73c6236f5dd7</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DDD-é¢†åŸŸé©±åŠ¨è®¾è®¡</title>
      <link href="/DDD-%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"/>
      <url>/DDD-%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡"><a href="#1-1-ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡"></a>1.1 ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡</h2><p>ã€ã€‘=op90q`</p><blockquote><p>DDDæ˜¯é¢å‘å¯¹è±¡çš„ä¸€å¥—æ–¹è¨€ï¼Œæä¾›äº†ä¸€ç§åŸºäºä¸šåŠ¡é¢†åŸŸçš„å¯¹è±¡åˆ’åˆ†å’Œåˆ†ç±»æ–¹æ³•ï¼Œå…¶æœ€å¤§çš„ä»·å€¼å°±åœ¨äºå¯¹äºè½¯ä»¶å¼€å‘è¿‡ç¨‹å…¨ç”Ÿå‘½å‘¨æœŸä½¿ç”¨è¯­è¨€çš„ç»Ÿä¸€ã€‚</p></blockquote><h2 id="1-2-å¸¸ç”¨åè¯"><a href="#1-2-å¸¸ç”¨åè¯" class="headerlink" title="1.2 å¸¸ç”¨åè¯"></a>1.2 å¸¸ç”¨åè¯</h2><ul><li>Controller </li><li>Service </li><li>Repository </li><li>Entity </li></ul><h2 id="1-3-ä¸ºä»€ä¹ˆä½¿ç”¨DDD"><a href="#1-3-ä¸ºä»€ä¹ˆä½¿ç”¨DDD" class="headerlink" title="1.3 ä¸ºä»€ä¹ˆä½¿ç”¨DDD?"></a>1.3 ä¸ºä»€ä¹ˆä½¿ç”¨DDD?</h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨é¢å‘å¯¹è±¡è¯­è¨€æ¥è§£å†³å®é™…é—®é¢˜çš„æ—¶å€™ï¼ŒçŸ¥é“æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡ï¼Œä½†æˆ‘ä»¬å¹¶æ²¡æœ‰æ˜ç¡®çš„å…³äºå¯¹è±¡åº”å½“å¦‚ä½•ç»„ç»‡å’Œåˆ’åˆ†çš„è§„èŒƒã€‚</p><p>ä½œä¸ºæŠ€æœ¯äººå‘˜ï¼Œæˆ‘ä»¬ä¹ æƒ¯äºä»æŠ€æœ¯è§’åº¦æ¥å‡ºå‘è¿›è¡Œæ€è€ƒï¼Œå‡ºç°äº†ç”¨<strong>æŠ€æœ¯è¯­è¨€</strong>å®šä¹‰å¯¹è±¡çš„ä¹ æƒ¯ï¼Œä¾‹å¦‚DAO(Data Access Objects), DTO(Data Transfer Object)è¿™ç±»å¯¹è±¡åŠå…¶ä½“ç°å‡ºæ¥çš„åˆ’åˆ†æ–¹å¼ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬æ—¥å¸¸å·¥ä½œå½“ä¸­å¾ˆå¤šæ—¶é—´éœ€è¦åšå¤§é‡çš„ä¸šåŠ¡è¯­è¨€å’ŒæŠ€æœ¯è¯­è¨€çš„ç›¸äº’ç¿»è¯‘ã€‚DDD - Domain Driven Design å°±æ˜¯æƒ³è§£å†³è¿™æ ·çš„ç›¸äº’ç¿»è¯‘çš„é—®é¢˜ï¼Œå¸Œæœ›èƒ½é€šè¿‡ä¸€å¥—é¢å‘å¯¹è±¡çš„åˆ†ç±»æ–¹æ³•ï¼Œä»é¢†åŸŸè§¦å‘ï¼Œå®ç°è½¯ä»¶å¼€å‘è¿‡ç¨‹å½“ä¸­å„ä¸ªè§’è‰²å’Œç¯å¢ƒçš„ç»Ÿä¸€è¯­è¨€(Ubiquitous Language).ä¾‹å¦‚ä½¿ç”¨Repositoryï¼ˆä»“åº“ï¼‰æ›¿ä»£æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ï¼Œå°±æ›´èƒ½è®©ä¸šåŠ¡å’ŒæŠ€æœ¯åŒæ—¶ç†è§£è¿™ä¸ªå¯¹è±¡çš„ä½œç”¨äº†ã€‚</p><p>DDDåˆ†ä¸ºæˆ˜æœ¯å’Œæˆ˜ç•¥ä¸¤éƒ¨åˆ†ï¼Œæ°å¥½å¯ä»¥ç”¨åœ¨å¾®æœåŠ¡çš„åˆ’åˆ†å½“ä¸­ã€‚æˆ‘ä»¬éœ€è¦åˆ©ç”¨DDDçš„æˆ˜ç•¥éƒ¨åˆ†ï¼Œåˆ’åˆ†é—®é¢˜åŸŸï¼Œæ¥åˆç†å¯¹å¾®æœåŠ¡è¿›è¡Œåˆ’åˆ†ã€‚</p><h1 id="2-äº‹ä»¶é£æš´-EventStorming"><a href="#2-äº‹ä»¶é£æš´-EventStorming" class="headerlink" title="2. äº‹ä»¶é£æš´ EventStorming"></a>2. äº‹ä»¶é£æš´ EventStorming</h1><blockquote><p>æ˜¯ä¸€å¥—ç‹¬ç«‹çš„é€šè¿‡åä½œåŸºäºäº‹ä»¶è¿˜åŸç³»ç»Ÿå…¨è²Œï¼Œä»è€Œå¿«é€Ÿåˆ†æå¤æ‚ä¸šåŠ¡é¢†åŸŸï¼Œå®Œæˆé¢†åŸŸå»ºæ¨¡çš„æ–¹æ³•ã€‚</p></blockquote><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://insights.thoughtworks.cn/ddd-eventstorming-zhongtai/#utm_source=rss&amp;utm_medium=rss" target="_blank" rel="noopener">https://insights.thoughtworks.cn/ddd-eventstorming-zhongtai/#utm_source=rss&amp;utm_medium=rss</a></li><li><a href="https://www.eventstorming.com/#services" target="_blank" rel="noopener">https://www.eventstorming.com/#services</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ</title>
      <link href="/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/"/>
      <url>/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-å¹¶å‘è¯»å†™"><a href="#1-1-å¹¶å‘è¯»å†™" class="headerlink" title="1.1 å¹¶å‘è¯»å†™"></a>1.1 å¹¶å‘è¯»å†™</h2><p>ç§’æ€è¦è§£å†³çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šå¹¶å‘è¯»ä¸å¹¶å‘å†™ã€‚</p><p>å¹¶å‘è¯»çš„ä¼˜åŒ–ç†å¿µæ˜¯å°½é‡å‡å°‘ç”¨æˆ·åˆ°æœåŠ¡ç«¯æ¥è¯»æ•°æ®ï¼Œæˆ–è€…è®©ä»–ä»¬è¯»æ›´å°‘çš„æ•°æ®ï¼›å¹¶å‘å†™çš„å¤„ç†åŸåˆ™ä¸€æ ·ï¼Œè¦æ±‚æˆ‘ä»¬åœ¨æ•°æ®åº“å±‚é¢ç‹¬ç«‹å‡ºä¸€ä¸ªåº“ï¼Œåšç‰¹æ®Šçš„å¤„ç†ã€‚</p><p>å…¶æ¬¡ï¼Œè¿˜éœ€è¦é’ˆå¯¹ç§’æ€ç³»ç»Ÿåšä¸€äº›ä¿æŠ¤ï¼Œé’ˆå¯¹æ„æ–™ä¹‹å¤–çš„æƒ…å†µè®¾è®¡å…œåº•æ–¹æ¡ˆï¼Œä»¥é˜²æ­¢æœ€åçš„æƒ…å†µå‘ç”Ÿã€‚</p><h2 id="1-2-APIè®¾è®¡åŸåˆ™"><a href="#1-2-APIè®¾è®¡åŸåˆ™" class="headerlink" title="1.2 APIè®¾è®¡åŸåˆ™"></a>1.2 APIè®¾è®¡åŸåˆ™</h2><p>å€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼šå¦‚æœæƒ³æ‰“é€ å¹¶ç»´æŠ¤ä¸€ä¸ªè¶…å¤§æµé‡å¹¶å‘è¯»å†™ã€é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„ç³»ç»Ÿï¼Œåœ¨æ•´ä¸ªç”¨æˆ·è¯·æ±‚è·¯å¾„ä¸Šä»æµè§ˆå™¨åˆ°æœåŠ¡ç«¯æˆ‘ä»¬è¦éµå¾ªå‡ ä¸ªåŸåˆ™ï¼Œå°±æ˜¯ä¿è¯<strong><em>ç”¨æˆ·è¯·æ±‚çš„æ•°æ®å°½é‡å°‘ã€è¯·æ±‚æ•°å°½é‡å°‘ã€è·¯å¾„å°½é‡çŸ­ã€ä¾èµ–å°½é‡å°‘ï¼Œä¸è¦æœ‰å•ç‚¹</em></strong></p><h2 id="1-3-ç§’æ€æ¶æ„åŸåˆ™"><a href="#1-3-ç§’æ€æ¶æ„åŸåˆ™" class="headerlink" title="1.3 ç§’æ€æ¶æ„åŸåˆ™"></a>1.3 ç§’æ€æ¶æ„åŸåˆ™</h2><h3 id="1-3-1-é«˜å¯ç”¨"><a href="#1-3-1-é«˜å¯ç”¨" class="headerlink" title="1.3.1 é«˜å¯ç”¨"></a>1.3.1 é«˜å¯ç”¨</h3><p>æ•´ä¸ªç³»ç»Ÿæ¶æ„éœ€è¦æ»¡è¶³é«˜å¯ç”¨æ€§ï¼Œæµé‡ç¬¦åˆé¢„æœŸçš„æ—¶å€™è‚¯å®šè¦ç¨³å®šï¼Œå°±æ˜¯è¶…å‡ºé¢„æœŸä¹ŸåŒæ ·ä¸èƒ½æ‰é“¾å­ï¼Œä¿è¯ç§’æ€äº§å“é¡ºåˆ©å–å‡ºã€‚</p><h3 id="1-3-2-ä¸€è‡´æ€§"><a href="#1-3-2-ä¸€è‡´æ€§" class="headerlink" title="1.3.2 ä¸€è‡´æ€§"></a>1.3.2 ä¸€è‡´æ€§</h3><p>æ•°æ®å¿…é¡»ä¸€è‡´ï¼Œå³æˆäº¤æ€»é‡å¿…é¡»å’Œè®¾å®šçš„æ•°é‡ä¸€è‡´ã€‚</p><h3 id="1-3-3-é«˜å¯ç”¨"><a href="#1-3-3-é«˜å¯ç”¨" class="headerlink" title="1.3.3 é«˜å¯ç”¨"></a>1.3.3 é«˜å¯ç”¨</h3><p>ç³»ç»Ÿçš„æ€§èƒ½è¦è¶³å¤Ÿå¼ºï¼Œæ”¯æ’‘è¶³å¤Ÿå¤§çš„æµé‡ï¼Œä¸ä»…æ˜¯æœåŠ¡ç«¯è¦åšæè‡´çš„æ€§èƒ½ä¼˜åŒ–ï¼Œè€Œä¸”åœ¨æ•´ä¸ªè¯·æ±‚é“¾è·¯ä¸Šéƒ½è¦åšååŒçš„ä¼˜åŒ–ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½è¦å¿«ä¸€ç‚¹ï¼Œæ•´ä¸ªç³»ç»Ÿå°±å®Œç¾äº†ã€‚</p><p>æœ¬æ–‡å°†ä»è¿™ä¸‰ä¸ªåŸåˆ™ä¸Šæ¥åˆ†åˆ«è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p><h1 id="2-æ¶æ„åŸåˆ™"><a href="#2-æ¶æ„åŸåˆ™" class="headerlink" title="2. æ¶æ„åŸåˆ™"></a>2. æ¶æ„åŸåˆ™</h1><p>ç§’æ€ç³»ç»Ÿæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ»¡è¶³å¤§å¹¶å‘ã€é«˜æ€§èƒ½å’Œé«˜å¯ç”¨çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p><h2 id="2-1-æ•°æ®å°½é‡å°‘"><a href="#2-1-æ•°æ®å°½é‡å°‘" class="headerlink" title="2.1 æ•°æ®å°½é‡å°‘"></a>2.1 æ•°æ®å°½é‡å°‘</h2><p>ç”¨æˆ·è¯·æ±‚çš„æ•°æ®èƒ½å°‘å°±å°‘ï¼Œè¯·æ±‚çš„æ•°æ®åŒ…æ‹¬ä¸Šä¼ ç»™ç³»ç»Ÿçš„æ•°æ®å’Œç³»ç»Ÿè¿”å›ç»™ç”¨æˆ·çš„æ•°æ®ã€‚</p><p>å› ä¸ºè¿™äº›æ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“éœ€è¦æ—¶é—´ï¼Œå…¶æ¬¡ä¸ç®¡æ˜¯è¯·æ±‚æ•°æ®è¿˜æ˜¯è¿”å›æ•°æ®éƒ½éœ€è¦æœåŠ¡å™¨å¤„ç†ï¼Œè€ŒæœåŠ¡å™¨åœ¨å†™ç½‘ç»œçš„æ—¶å€™é€šå¸¸éƒ½è¦åšå‹ç¼©å’Œå­—ç¬¦ç¼–ç ï¼Œè¿™äº›éƒ½éå¸¸æ¶ˆè€—CPUï¼Œæ‰€ä»¥å‡å°‘ä¼ è¾“çš„æ•°æ®é‡å¯ä»¥æ˜¾è‘—å‡å°‘CPUçš„ä½¿ç”¨ã€‚</p><p>åŒæ ·ï¼Œæ•°æ®å°½é‡å°‘è¿˜è¦æ±‚ç³»ç»Ÿä¾èµ–çš„æ•°æ®èƒ½å°‘å°±å°‘ï¼ŒåŒ…æ‹¬ç³»ç»Ÿå®ŒæˆæŸäº›ä¸šåŠ¡é€»è¾‘éœ€è¦è¯»å–å’Œä¿å­˜çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¸€èˆ¬æ˜¯å’Œåå°æœåŠ¡ä»¥åŠæ•°æ®åº“æ‰“äº¤é“çš„ã€‚è°ƒç”¨å…¶ä»–æœåŠ¡ä¼šæ¶‰åŠæ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè¿™ä¹Ÿæ˜¯CPUçš„ä¸€å¤§æ€æ‰‹ï¼ŒåŒæ ·ä¹Ÿä¼šå¢åŠ å»¶æ—¶ã€‚è€Œä¸”æ•°æ®åº“æœ¬èº«ä¹Ÿå¾ˆå®¹æ˜“æˆä¸ºç“¶é¢ˆï¼Œå› æ­¤è¶Šå°‘å’Œæ•°æ®åº“æ‰“äº¤é“è¶Šå¥½ã€‚</p><h2 id="2-2-è¯·æ±‚æ•°å°½é‡å°‘"><a href="#2-2-è¯·æ±‚æ•°å°½é‡å°‘" class="headerlink" title="2.2 è¯·æ±‚æ•°å°½é‡å°‘"></a>2.2 è¯·æ±‚æ•°å°½é‡å°‘</h2><p>ç”¨æˆ·è¯·æ±‚çš„é¡µé¢è¿”å›åï¼Œæµè§ˆå™¨æ¸²æŸ“è¿™ä¸ªé¡µé¢è¿˜è¦åŒ…å«å…¶ä»–çš„é¢å¤–è¯·æ±‚ï¼Œæ¯”å¦‚è¯´ï¼Œè¿™ä¸ªé¡µé¢ä¾èµ–çš„ CSS/JavaScriptã€å›¾ç‰‡ï¼Œä»¥åŠ Ajax è¯·æ±‚ç­‰ç­‰éƒ½å®šä¹‰ä¸ºâ€œé¢å¤–è¯·æ±‚â€ï¼Œè¿™äº›é¢å¤–è¯·æ±‚åº”è¯¥å°½é‡å°‘ã€‚å› ä¸ºæµè§ˆå™¨æ¯å‘å‡ºä¸€ä¸ªè¯·æ±‚éƒ½å¤šå°‘ä¼šæœ‰ä¸€äº›æ¶ˆè€—ï¼Œä¾‹å¦‚å»ºç«‹è¿æ¥è¦åšä¸‰æ¬¡æ¡æ‰‹ï¼Œæœ‰çš„æ—¶å€™æœ‰é¡µé¢ä¾èµ–æˆ–è€…è¿æ¥æ•°é™åˆ¶ï¼Œä¸€äº›è¯·æ±‚ï¼ˆä¾‹å¦‚ JavaScriptï¼‰è¿˜éœ€è¦ä¸²è¡ŒåŠ è½½ç­‰ã€‚å¦å¤–ï¼Œå¦‚æœä¸åŒè¯·æ±‚çš„åŸŸåä¸ä¸€æ ·çš„è¯ï¼Œè¿˜æ¶‰åŠè¿™äº›åŸŸåçš„ DNS è§£æï¼Œå¯èƒ½ä¼šè€—æ—¶æ›´ä¹…ã€‚æ‰€ä»¥ä½ è¦è®°ä½çš„æ˜¯ï¼Œå‡å°‘è¯·æ±‚æ•°å¯ä»¥æ˜¾è‘—å‡å°‘ä»¥ä¸Šè¿™äº›å› ç´ å¯¼è‡´çš„èµ„æºæ¶ˆè€—ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡å°‘è¯·æ±‚æ•°æœ€å¸¸ç”¨çš„ä¸€ä¸ªå®è·µå°±æ˜¯åˆå¹¶ CSS å’Œ JavaScript æ–‡ä»¶ï¼ŒæŠŠå¤šä¸ª JavaScript æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨ URL ä¸­ç”¨é€—å·éš”å¼€ï¼ˆ<code>https://g.xxx.com/tm/xx-b/4.0.94/mods/??module-preview/index.xtpl.js,module-jhs/index.xtpl.js,module-focus/index.xtpl.js</code>ï¼‰ã€‚è¿™ç§æ–¹å¼åœ¨æœåŠ¡ç«¯ä»ç„¶æ˜¯å•ä¸ªæ–‡ä»¶å„è‡ªå­˜æ”¾ï¼Œåªæ˜¯æœåŠ¡ç«¯ä¼šæœ‰ä¸€ä¸ªç»„ä»¶è§£æè¿™ä¸ª URLï¼Œç„¶ååŠ¨æ€æŠŠè¿™äº›æ–‡ä»¶åˆå¹¶èµ·æ¥ä¸€èµ·è¿”å›ã€‚</p><h2 id="2-3-è·¯å¾„è¦å°½é‡çŸ­"><a href="#2-3-è·¯å¾„è¦å°½é‡çŸ­" class="headerlink" title="2.3 è·¯å¾„è¦å°½é‡çŸ­"></a>2.3 è·¯å¾„è¦å°½é‡çŸ­</h2><p>è·¯å¾„æŒ‡çš„æ˜¯ç”¨æˆ·å‘å‡ºè¯·æ±‚åˆ°è¿”å›æ•°æ®è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦ç»è¿‡çš„ä¸­é—´èŠ‚ç‚¹çš„æ•°é‡ã€‚</p><p>é€šå¸¸ï¼Œè¿™äº›èŠ‚ç‚¹å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç³»ç»Ÿæˆ–è€…ä¸€ä¸ªæ–°çš„ Socket è¿æ¥ï¼ˆæ¯”å¦‚ä»£ç†æœåŠ¡å™¨åªæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ Socket è¿æ¥æ¥è½¬å‘è¯·æ±‚ï¼‰ã€‚æ¯ç»è¿‡ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€èˆ¬éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Socket è¿æ¥ã€‚</p><p>ç„¶è€Œï¼Œæ¯å¢åŠ ä¸€ä¸ªè¿æ¥éƒ½ä¼šå¢åŠ æ–°çš„ä¸ç¡®å®šæ€§ã€‚ä»æ¦‚ç‡ç»Ÿè®¡ä¸Šæ¥è¯´ï¼Œå‡å¦‚ä¸€æ¬¡è¯·æ±‚ç»è¿‡ 5 ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å¯ç”¨æ€§æ˜¯ 99.9% çš„è¯ï¼Œé‚£ä¹ˆæ•´ä¸ªè¯·æ±‚çš„å¯ç”¨æ€§æ˜¯ï¼š99.9% çš„ 5 æ¬¡æ–¹ï¼Œçº¦ç­‰äº 99.5%ã€‚</p><p>æ‰€ä»¥ç¼©çŸ­è¯·æ±‚è·¯å¾„ä¸ä»…å¯ä»¥å¢åŠ å¯ç”¨æ€§ï¼ŒåŒæ ·å¯ä»¥æœ‰æ•ˆæå‡æ€§èƒ½ï¼ˆå‡å°‘ä¸­é—´èŠ‚ç‚¹å¯ä»¥å‡å°‘æ•°æ®çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼‰ï¼Œå¹¶å‡å°‘å»¶æ—¶ï¼ˆå¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“è€—æ—¶ï¼‰ã€‚</p><p>è¦ç¼©çŸ­è®¿é—®è·¯å¾„å¯ä»¥å°†å¤šä¸ªç›¸äº’æœ‰å¼ºä¾èµ–çš„åº”ç”¨åˆå¹¶éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œå°†è¿œç¨‹è¿‡ç¨‹è°ƒç”¨å˜æˆJVMå†…éƒ¨çš„æ–¹æ³•è°ƒç”¨ã€‚</p><h2 id="2-4-ä¾èµ–è¦å°½é‡å°‘"><a href="#2-4-ä¾èµ–è¦å°½é‡å°‘" class="headerlink" title="2.4 ä¾èµ–è¦å°½é‡å°‘"></a>2.4 ä¾èµ–è¦å°½é‡å°‘</h2><p>æ‰€è°“ä¾èµ–ï¼ŒæŒ‡çš„æ˜¯è¦å®Œæˆä¸€æ¬¡ç”¨æˆ·è¯·æ±‚å¿…é¡»ä¾èµ–çš„ç³»ç»Ÿæˆ–è€…æœåŠ¡ã€‚ </p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¯´ä½ è¦å±•ç¤ºç§’æ€é¡µé¢ï¼Œè€Œè¿™ä¸ªé¡µé¢å¿…é¡»å¼ºä¾èµ–å•†å“ä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ï¼Œè¿˜æœ‰å…¶ä»–å¦‚ä¼˜æƒ åˆ¸ã€æˆäº¤åˆ—è¡¨ç­‰è¿™äº›å¯¹ç§’æ€ä¸æ˜¯éè¦ä¸å¯çš„ä¿¡æ¯ï¼ˆå¼±ä¾èµ–ï¼‰ï¼Œè¿™äº›å¼±ä¾èµ–åœ¨ç´§æ€¥æƒ…å†µä¸‹å°±å¯ä»¥å»æ‰ã€‚</p><p>è¦å‡å°‘ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç³»ç»Ÿè¿›è¡Œåˆ†çº§ï¼Œæ¯”å¦‚ 0 çº§ç³»ç»Ÿã€1 çº§ç³»ç»Ÿã€2 çº§ç³»ç»Ÿã€3 çº§ç³»ç»Ÿï¼Œ0 çº§ç³»ç»Ÿå¦‚æœæ˜¯æœ€é‡è¦çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆ 0 çº§ç³»ç»Ÿå¼ºä¾èµ–çš„ç³»ç»Ÿä¹ŸåŒæ ·æ˜¯æœ€é‡è¦çš„ç³»ç»Ÿï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>æ³¨æ„ï¼Œ0 çº§ç³»ç»Ÿè¦å°½é‡å‡å°‘å¯¹ 1 çº§ç³»ç»Ÿçš„å¼ºä¾èµ–ï¼Œé˜²æ­¢é‡è¦çš„ç³»ç»Ÿè¢«ä¸é‡è¦çš„ç³»ç»Ÿæ‹–å®ã€‚ä¾‹å¦‚æ”¯ä»˜ç³»ç»Ÿæ˜¯ 0 çº§ç³»ç»Ÿï¼Œè€Œä¼˜æƒ åˆ¸æ˜¯ 1 çº§ç³»ç»Ÿçš„è¯ï¼Œåœ¨æç«¯æƒ…å†µä¸‹å¯ä»¥æŠŠä¼˜æƒ åˆ¸ç»™é™çº§ï¼Œé˜²æ­¢æ”¯ä»˜ç³»ç»Ÿè¢«ä¼˜æƒ åˆ¸è¿™ä¸ª 1 çº§ç³»ç»Ÿç»™æ‹–å®ã€‚</p><h2 id="2-5-ä¸è¦æœ‰å•ç‚¹"><a href="#2-5-ä¸è¦æœ‰å•ç‚¹" class="headerlink" title="2.5 ä¸è¦æœ‰å•ç‚¹"></a>2.5 ä¸è¦æœ‰å•ç‚¹</h2><p>ä¸èƒ½æœ‰å•ç‚¹ï¼Œå› ä¸ºå•ç‚¹æ„å‘³ç€æ²¡æœ‰å¤‡ä»½ï¼Œé£é™©ä¸å¯æ§ï¼Œè®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€ä¸ªæœ€é‡è¦çš„åŸåˆ™å°±æ˜¯æ¶ˆé™¤å•ç‚¹ã€‚</p><p>å¦‚ä½•é¿å…å•ç‚¹ï¼Ÿ â€”-&gt; é¿å…å°†æœåŠ¡çš„çŠ¶æ€å’Œæœºå™¨ç»‘å®šï¼Œå³æŠŠæœåŠ¡æ— çŠ¶æ€åŒ–ï¼Œè¿™æ ·æœåŠ¡å°±å¯ä»¥åœ¨æœºå™¨ä¸­éšæ„ç§»åŠ¨äº†ã€‚ </p><p>å¦‚ä½•é‚£æŠŠæœåŠ¡çš„çŠ¶æ€å’Œæœºå™¨è§£è€¦å‘¢ï¼Ÿè¿™é‡Œä¹Ÿæœ‰å¾ˆå¤šå®ç°æ–¹å¼ã€‚ä¾‹å¦‚æŠŠå’Œæœºå™¨ç›¸å…³çš„é…ç½®åŠ¨æ€åŒ–ï¼Œè¿™äº›å‚æ•°å¯ä»¥é€šè¿‡é…ç½®ä¸­å¿ƒæ¥åŠ¨æ€æ¨é€ï¼Œåœ¨æœåŠ¡å¯åŠ¨æ—¶åŠ¨æ€æ‹‰å–ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨è¿™äº›é…ç½®ä¸­å¿ƒè®¾ç½®ä¸€äº›è§„åˆ™æ¥æ–¹ä¾¿åœ°æ”¹å˜è¿™äº›æ˜ å°„å…³ç³»ã€‚</p><p>åº”ç”¨æ— çŠ¶æ€åŒ–æ˜¯æœ‰æ•ˆé¿å…å•ç‚¹çš„ä¸€ç§æ–¹å¼ï¼Œä½†æ˜¯åƒå­˜å‚¨æœåŠ¡æœ¬èº«å¾ˆéš¾æ— çŠ¶æ€åŒ–ï¼Œå› ä¸ºæ•°æ®è¦å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œæœ¬èº«å°±è¦å’Œæœºå™¨ç»‘å®šï¼Œé‚£ä¹ˆè¿™ç§åœºæ™¯ä¸€èˆ¬è¦é€šè¿‡å†—ä½™å¤šä¸ªå¤‡ä»½çš„æ–¹å¼æ¥è§£å†³å•ç‚¹é—®é¢˜ã€‚</p><h1 id="3-ä¸åŒåœºæ™¯ä¸‹çš„ä¸åŒæ¶æ„æ¡ˆä¾‹"><a href="#3-ä¸åŒåœºæ™¯ä¸‹çš„ä¸åŒæ¶æ„æ¡ˆä¾‹" class="headerlink" title="3. ä¸åŒåœºæ™¯ä¸‹çš„ä¸åŒæ¶æ„æ¡ˆä¾‹"></a>3. ä¸åŒåœºæ™¯ä¸‹çš„ä¸åŒæ¶æ„æ¡ˆä¾‹</h1><p>å¦‚æœä½ æƒ³å¿«é€Ÿæ­å»ºä¸€ä¸ªç®€å•çš„ç§’æ€ç³»ç»Ÿï¼Œåªéœ€è¦æŠŠä½ çš„å•†å“è´­ä¹°é¡µé¢å¢åŠ ä¸€ä¸ªâ€œå®šæ—¶ä¸Šæ¶â€åŠŸèƒ½ï¼Œä»…åœ¨ç§’æ€å¼€å§‹æ—¶æ‰è®©ç”¨æˆ·çœ‹åˆ°è´­ä¹°æŒ‰é’®ï¼Œå½“å•†å“çš„åº“å­˜å–å®Œäº†ä¹Ÿå°±ç»“æŸäº†ã€‚è¿™å°±æ˜¯å½“æ—¶ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ç§’æ€ç³»ç»Ÿå®ç°æ–¹å¼ã€‚</p><p>ä½†éšç€è¯·æ±‚é‡çš„åŠ å¤§ï¼ˆæ¯”å¦‚ä» 1w/s åˆ°äº† 10w/s çš„é‡çº§ï¼‰ï¼Œè¿™ä¸ªç®€å•çš„æ¶æ„å¾ˆå¿«å°±é‡åˆ°äº†ç“¶é¢ˆï¼Œå› æ­¤éœ€è¦åšæ¶æ„æ”¹é€ æ¥æå‡ç³»ç»Ÿæ€§èƒ½ã€‚è¿™äº›æ¶æ„æ”¹é€ åŒ…æ‹¬ï¼š</p><ol><li>æŠŠç§’æ€ç³»ç»Ÿç‹¬ç«‹å‡ºæ¥å•ç‹¬æ‰“é€ ä¸€ä¸ªç³»ç»Ÿï¼Œè¿™æ ·å¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°åšä¼˜åŒ–ï¼Œä¾‹å¦‚è¿™ä¸ªç‹¬ç«‹å‡ºæ¥çš„ç³»ç»Ÿå°±å‡å°‘äº†åº—é“ºè£…ä¿®çš„åŠŸèƒ½ï¼Œå‡å°‘äº†é¡µé¢çš„å¤æ‚åº¦ï¼›</li><li>åœ¨ç³»ç»Ÿéƒ¨ç½²ä¸Šä¹Ÿç‹¬ç«‹åšä¸€ä¸ªæœºå™¨é›†ç¾¤ï¼Œè¿™æ ·ç§’æ€çš„å¤§æµé‡å°±ä¸ä¼šå½±å“åˆ°æ­£å¸¸çš„å•†å“è´­ä¹°é›†ç¾¤çš„æœºå™¨è´Ÿè½½ï¼›</li><li>å°†çƒ­ç‚¹æ•°æ®ï¼ˆå¦‚åº“å­˜æ•°æ®ï¼‰å•ç‹¬æ”¾åˆ°ä¸€ä¸ªç¼“å­˜ç³»ç»Ÿä¸­ï¼Œä»¥æé«˜â€œè¯»æ€§èƒ½â€ï¼›</li><li>å¢åŠ ç§’æ€ç­”é¢˜ï¼Œé˜²æ­¢æœ‰ç§’æ€å™¨æŠ¢å•ã€‚</li></ol><p>æ­¤æ—¶ç§’æ€å·²ç»æˆä¸ºäº†ä¸€ä¸ªç‹¬ç«‹çš„æ–°ç³»ç»Ÿï¼Œå¦å¤–æ ¸å¿ƒçš„ä¸€äº›æ•°æ®æ”¾åˆ°äº†ç¼“å­˜å½“ä¸­ï¼Œå…¶ä»–çš„å…³è”ç³»ç»Ÿä¹Ÿéƒ½ä»¥ç‹¬ç«‹é›†ç¾¤çš„æ–¹å¼è¿›è¡Œéƒ¨ç½²ã€‚</p><p><img src="https://i.loli.net/2020/02/03/9RJsCGFtgbcyrhZ.jpg" alt="fig1.jpg"></p><p>ä½†æ˜¯è¿™ä¸ªæ¶æ„ä»ç„¶æ— æ³•æ”¯æŒè¶…è¿‡100w/sçš„è¯·æ±‚é‡ï¼Œå› æ­¤ä¸ºäº†è¿›ä¸€æ­¥æé«˜ç§’æ€ç³»ç»Ÿçš„æ€§èƒ½ï¼Œåˆå¯¹æ¶æ„åšäº†è¿›ä¸€æ­¥çš„å‡çº§ï¼Œæ¯”å¦‚ï¼š</p><ol><li>å¯¹é¡µé¢è¿›è¡Œå½»åº•çš„åŠ¨é™åˆ†ç¦»ï¼Œä½¿å¾—ç”¨æˆ·ç§’æ€æ—¶ä¸éœ€è¦åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œè€Œåªéœ€è¦ç‚¹å‡»æŠ¢å®æŒ‰é’®ï¼Œå€Ÿæ­¤æŠŠé¡µé¢åˆ·æ–°çš„æ•°æ®é™åˆ°æœ€å°‘ï¼›</li><li>åœ¨æœåŠ¡ç«¯å¯¹ç§’æ€å•†å“è¿›è¡Œæœ¬åœ°ç¼“å­˜ï¼Œä¸éœ€è¦å†è°ƒç”¨ä¾èµ–ç³»ç»Ÿçš„åå°æœåŠ¡è·å–æ•°æ®ï¼Œç”šè‡³ä¸éœ€è¦å»å…¬å…±çš„ç¼“å­˜é›†ç¾¤ä¸­æŸ¥è¯¢æ•°æ®ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥å‡å°‘ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸”èƒ½å¤Ÿé¿å…å‹å®å…¬å…±ç¼“å­˜é›†ç¾¤ã€‚</li><li>å¢åŠ ç³»ç»Ÿé™æµä¿æŠ¤ï¼Œé˜²æ­¢æœ€åçš„æƒ…å†µå‘ç”Ÿ</li></ol><p>æ­¤æ—¶æ•´ä¸ªç³»ç»Ÿæ¶æ„å˜æˆäº†è¿™ä¸ªæ ·å­ï¼Œå·²ç»å¯¹é¡µé¢è¿›è¡Œäº†è¿›ä¸€æ­¥çš„é™æ€åŒ–ï¼Œç§’æ€è¿‡ç¨‹å½“ä¸­å°±ä¸éœ€è¦åˆ·æ–°æ•´ä¸ªé¡µé¢äº†ï¼Œåªéœ€è¦å‘æœåŠ¡ç«¯è¯·æ±‚å¾ˆå°‘çš„åŠ¨æ€æ•°æ®ã€‚è€Œä¸”æœ€å…³é”®çš„è¯¦æƒ…å’Œäº¤æ˜“ç³»ç»Ÿéƒ½å¢åŠ äº†æœ¬åœ°ç¼“å­˜ï¼Œæ¥æå‰ç¼“å­˜ç§’æ€å•†å“çš„ä¿¡æ¯ï¼Œçƒ­ç‚¹æ•°æ®åº“ä¹Ÿåšäº†ç‹¬ç«‹éƒ¨ç½²ã€‚</p><p><img src="https://i.loli.net/2020/02/03/46cK3CdURO8Yngp.jpg" alt="fig2.jpg"></p><p>ä»å‰é¢çš„å‡ æ¬¡å‡çº§æ¥çœ‹ï¼Œå…¶å®è¶Šåˆ°åé¢éœ€è¦å®šåˆ¶çš„åœ°æ–¹è¶Šå¤šï¼Œä¹Ÿå°±æ˜¯è¶Šâ€œä¸é€šç”¨â€ã€‚ä¾‹å¦‚ï¼ŒæŠŠç§’æ€å•†å“ç¼“å­˜åœ¨æ¯å°æœºå™¨çš„å†…å­˜ä¸­ï¼Œè¿™ç§æ–¹å¼æ˜¾ç„¶ä¸é€‚åˆå¤ªå¤šçš„å•†å“åŒæ—¶è¿›è¡Œç§’æ€çš„æƒ…å†µï¼Œå› ä¸ºå•æœºçš„å†…å­˜å§‹ç»ˆæœ‰é™ã€‚æ‰€ä»¥è¦å–å¾—æè‡´çš„æ€§èƒ½ï¼Œå°±è¦åœ¨å…¶ä»–åœ°æ–¹ï¼ˆæ¯”å¦‚ï¼Œé€šç”¨æ€§ã€æ˜“ç”¨æ€§ã€æˆæœ¬ç­‰æ–¹é¢ï¼‰æœ‰æ‰€ç‰ºç‰²ã€‚</p><h1 id="4-åŠ¨é™åˆ†ç¦»çš„æ–¹æ¡ˆ"><a href="#4-åŠ¨é™åˆ†ç¦»çš„æ–¹æ¡ˆ" class="headerlink" title="4. åŠ¨é™åˆ†ç¦»çš„æ–¹æ¡ˆ"></a>4. åŠ¨é™åˆ†ç¦»çš„æ–¹æ¡ˆ</h1><p>ç§’æ€ç³»ç»Ÿéœ€è¦è®©è¯·æ±‚æ•ˆç‡è¶³å¤Ÿé«˜ - æé«˜å•æ¬¡è¯·æ±‚çš„æ•ˆç‡ï¼Œå‡å°‘æ²¡å¿…è¦çš„è¯·æ±‚ã€‚</p><h2 id="4-1-ä½•ä¸ºåŠ¨é™æ•°æ®"><a href="#4-1-ä½•ä¸ºåŠ¨é™æ•°æ®" class="headerlink" title="4.1 ä½•ä¸ºåŠ¨é™æ•°æ®"></a>4.1 ä½•ä¸ºåŠ¨é™æ•°æ®</h2><p>å°†ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼ˆå¦‚HTMLï¼‰åˆ’åˆ†ä¸ºåŠ¨æ€æ•°æ®å’Œé™æ€æ•°æ®ã€‚è€ŒåŠ¨æ€é™æ€æ•°æ®çš„åˆ’åˆ†ï¼Œåœ¨äºçœ‹é¡µé¢ä¸­è¾“å‡ºçš„æ•°æ®æ˜¯å¦å’ŒURLï¼Œæµè§ˆè€…ï¼Œæ—¶é—´ï¼Œåœ°åŸŸç›¸å…³ï¼Œä»¥åŠæ˜¯å¦å«æœ‰Cookieç­‰ç§å¯†æ•°æ®ã€‚</p><ol><li>å¯¹å¾ˆå¤šåª’ä½“ç±»çš„ç½‘ç«™æ¥è¯´ï¼Œæ— è®ºè°æ¥çœ‹æ–‡ç« ï¼Œå±•ç¤ºçš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå“ªæ€•è¿™æ˜¯ä¸ªåŠ¨æ€é¡µé¢ï¼Œå®ƒä»ç„¶æ˜¯ä¸ªå…¸å‹çš„é™æ€æ•°æ®ã€‚</li><li>è®¿é—®æ·˜å®çš„é¦–é¡µï¼Œæ¯ä¸ªäººçœ‹åˆ°çš„é¡µé¢å¯èƒ½éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šæ ¹æ®è®¿é—®è€…ä¸ªäººä¿¡æ¯è¿›è¡Œçš„æ¨èï¼Œè¿™äº›ä¸ªæ€§åŒ–çš„æ•°æ®å°±ç§°ä¸ºåŠ¨æ€æ•°æ®ã€‚</li></ol><p>è¿™é‡Œå†å¼ºè°ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬æ‰€è¯´çš„é™æ€æ•°æ®ï¼Œä¸èƒ½ä»…ä»…ç†è§£ä¸ºä¼ ç»Ÿæ„ä¹‰ä¸Šå®Œå…¨å­˜åœ¨ç£ç›˜ä¸Šçš„ HTML é¡µé¢ï¼Œå®ƒä¹Ÿå¯èƒ½æ˜¯ç»è¿‡ Java ç³»ç»Ÿäº§ç”Ÿçš„é¡µé¢ï¼Œä½†æ˜¯å®ƒè¾“å‡ºçš„é¡µé¢æœ¬èº«ä¸åŒ…å«ä¸Šé¢æ‰€è¯´çš„é‚£äº›å› ç´ ã€‚ä¹Ÿå°±æ˜¯æ‰€è°“â€œåŠ¨æ€â€è¿˜æ˜¯â€œé™æ€â€ï¼Œå¹¶ä¸æ˜¯è¯´æ•°æ®æœ¬èº«æ˜¯å¦åŠ¨é™ï¼Œè€Œæ˜¯æ•°æ®ä¸­æ˜¯å¦å«æœ‰å’Œè®¿é—®è€…ç›¸å…³çš„ä¸ªæ€§åŒ–æ•°æ®ã€‚</p><p>è¿™æ ·åšåŠ¨é™åˆ†ç¦»çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹åˆ†ç¦»å‡ºæ¥çš„é™æ€æ•°æ®åšç¼“å­˜ï¼Œæœ‰äº†ç¼“å­˜ä»¥åï¼Œé™æ€æ•°æ®çš„è®¿é—®æ•ˆç‡è‚¯å®šå°±æé«˜äº†ã€‚</p><h2 id="4-2-å¦‚ä½•å¯¹é™æ€æ•°æ®åšç¼“å­˜ï¼Ÿ"><a href="#4-2-å¦‚ä½•å¯¹é™æ€æ•°æ®åšç¼“å­˜ï¼Ÿ" class="headerlink" title="4.2 å¦‚ä½•å¯¹é™æ€æ•°æ®åšç¼“å­˜ï¼Ÿ"></a>4.2 å¦‚ä½•å¯¹é™æ€æ•°æ®åšç¼“å­˜ï¼Ÿ</h2><h3 id="4-2-1-è·ç¦»ç”¨æˆ·æœ€è¿‘"><a href="#4-2-1-è·ç¦»ç”¨æˆ·æœ€è¿‘" class="headerlink" title="4.2.1 è·ç¦»ç”¨æˆ·æœ€è¿‘"></a>4.2.1 è·ç¦»ç”¨æˆ·æœ€è¿‘</h3><p>å°†é™æ€æ•°æ®ç¼“å­˜åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ã€‚é™æ€æ•°æ®å°±æ˜¯é‚£äº›ç›¸å¯¹ä¸ä¼šå˜åŒ–çš„æ•°æ®ï¼Œå› æ­¤å¯ä»¥åšç¼“å­˜ã€‚å¸¸è§çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç¼“å­˜åœ¨ï¼š</p><ol><li>ç”¨æˆ·æµè§ˆå™¨</li><li>CDNä¸Š</li><li>æœåŠ¡ç«¯çš„Cacheä¸­</li></ol><h3 id="4-2-2-é™æ€åŒ–æ”¹é€ è¦ç›´æ¥ç¼“å­˜HTTPè¿æ¥"><a href="#4-2-2-é™æ€åŒ–æ”¹é€ è¦ç›´æ¥ç¼“å­˜HTTPè¿æ¥" class="headerlink" title="4.2.2 é™æ€åŒ–æ”¹é€ è¦ç›´æ¥ç¼“å­˜HTTPè¿æ¥"></a>4.2.2 é™æ€åŒ–æ”¹é€ è¦ç›´æ¥ç¼“å­˜HTTPè¿æ¥</h3><p>ç³»ç»Ÿçš„é™æ€åŒ–æ”¹é€ æ˜¯ç›´æ¥ç¼“å­˜HTTPè¿æ¥è€Œä¸ä»…ä»…æ˜¯æ•°æ®äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒWebä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚URLç›´æ¥å»é™¤å¯¹åº”çš„HTTPå“åº”å¤´å’Œå“åº”ä½“ç„¶åç›´æ¥è¿”å›ï¼Œè¿™ä¸ªå“åº”è¿‡ç¨‹è¿HTTPåè®®éƒ½ä¸ç”¨é‡æ–°ç»„è£…ï¼Œç”šè‡³è¿HTTPè¯·æ±‚å¤´ä¹Ÿä¸éœ€è¦è§£æã€‚</p><p><img src="https://i.loli.net/2020/02/03/ydBbWKCeip8jGm5.jpg" alt="fig3.jpg"></p><h3 id="4-2-3-ç¼“å­˜è¯­è¨€"><a href="#4-2-3-ç¼“å­˜è¯­è¨€" class="headerlink" title="4.2.3 ç¼“å­˜è¯­è¨€"></a>4.2.3 ç¼“å­˜è¯­è¨€</h3><p>ä¸åŒè¯­è¨€å†™çš„cacheè½¯ä»¶å¤„ç†ç¼“å­˜æ•°æ®çš„æ•ˆç‡ä¹Ÿå„ä¸ç›¸åŒã€‚ä»¥Javaä¸ºä¾‹ï¼ŒJavaä¸æ“…é•¿å¤„ç†å¤§é‡è¿æ¥è¯·æ±‚ï¼Œæ¯ä¸ªè¿æ¥æ¶ˆè€—çš„å†…å­˜ä¼šæ¯”è¾ƒå¤šï¼ŒServletå®¹å™¨è§£æHTTPåè®®æ¯”è¾ƒæ…¢ã€‚æ‰€ä»¥å¯ä»¥ä¸åœ¨Javaå±‚åšç¼“å­˜ï¼Œè€Œæ˜¯ç›´æ¥åœ¨WebæœåŠ¡å™¨å±‚ä¸Šåšï¼Œè¿™æ ·å°±å¯ä»¥å±è”½Javaçš„ä¸€äº›å¼±ç‚¹ï¼›è€Œç›¸æ¯”èµ·æ¥ï¼ŒWebæœåŠ¡å™¨(Nginx, Apache, Varnish)ä¼šæ›´åŠ æ“…é•¿å¤„ç†å¤§å¹¶å‘çš„é™æ€æ–‡ä»¶è¯·æ±‚ã€‚</p><h2 id="4-3-é™æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ"><a href="#4-3-é™æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ" class="headerlink" title="4.3 é™æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ"></a>4.3 é™æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ</h2><p>ä»¥å•†å“è¯¦æƒ…é¡µä¸ºä¾‹ï¼š</p><h3 id="4-3-1-URLå”¯ä¸€åŒ–"><a href="#4-3-1-URLå”¯ä¸€åŒ–" class="headerlink" title="4.3.1 URLå”¯ä¸€åŒ–"></a>4.3.1 URLå”¯ä¸€åŒ–</h3><p>è¦ç¼“å­˜æ•´ä¸ªHTTPè¿æ¥ï¼Œä»¥URLä½œä¸ºç¼“å­˜çš„key</p><h3 id="4-3-2-åˆ†ç¦»æµè§ˆè€…ç›¸å…³çš„å› ç´ "><a href="#4-3-2-åˆ†ç¦»æµè§ˆè€…ç›¸å…³çš„å› ç´ " class="headerlink" title="4.3.2 åˆ†ç¦»æµè§ˆè€…ç›¸å…³çš„å› ç´ "></a>4.3.2 åˆ†ç¦»æµè§ˆè€…ç›¸å…³çš„å› ç´ </h3><p>åˆ†ç¦»ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ï¼Œæ˜¯å¦ç™»å½•ä»¥åŠç™»å½•èº«ä»½ç­‰ç­‰ã€‚</p><h3 id="4-3-3-åˆ†ç¦»æ—¶é—´å› ç´ "><a href="#4-3-3-åˆ†ç¦»æ—¶é—´å› ç´ " class="headerlink" title="4.3.3 åˆ†ç¦»æ—¶é—´å› ç´ "></a>4.3.3 åˆ†ç¦»æ—¶é—´å› ç´ </h3><p>æœåŠ¡ç«¯è¾“å‡ºçš„æ˜¯å“ªä¹Ÿé€šè¿‡åŠ¨æ€è¯·æ±‚è·å–</p><h3 id="4-3-4-å¼‚æ­¥åŒ–åœ°åŸŸå› ç´ "><a href="#4-3-4-å¼‚æ­¥åŒ–åœ°åŸŸå› ç´ " class="headerlink" title="4.3.4 å¼‚æ­¥åŒ–åœ°åŸŸå› ç´ "></a>4.3.4 å¼‚æ­¥åŒ–åœ°åŸŸå› ç´ </h3><p>è¯¦æƒ…é¡µé¢ä¸Šä¸åœ°åŸŸç›¸å…³çš„å› ç´ åšæˆå¼‚æ­¥è·å–çš„æ–¹å¼</p><h3 id="4-3-5-å»æ‰Cookie"><a href="#4-3-5-å»æ‰Cookie" class="headerlink" title="4.3.5 å»æ‰Cookie"></a>4.3.5 å»æ‰Cookie</h3><p>æœåŠ¡ç«¯è¾“å‡ºçš„é¡µé¢åŒ…å«çš„ Cookie å¯ä»¥é€šè¿‡ä»£ç è½¯ä»¶æ¥åˆ é™¤ï¼Œå¦‚ Web æœåŠ¡å™¨ Varnish å¯ä»¥é€šè¿‡ unset req.http.cookie å‘½ä»¤å»æ‰ Cookieã€‚æ³¨æ„ï¼Œè¿™é‡Œè¯´çš„å»æ‰ Cookie å¹¶ä¸æ˜¯ç”¨æˆ·ç«¯æ”¶åˆ°çš„é¡µé¢å°±ä¸å« Cookie äº†ï¼Œè€Œæ˜¯è¯´ï¼Œåœ¨ç¼“å­˜çš„é™æ€æ•°æ®ä¸­ä¸å«æœ‰ Cookieã€‚</p><h2 id="4-4-åŠ¨æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ"><a href="#4-4-åŠ¨æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ" class="headerlink" title="4.4 åŠ¨æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ"></a>4.4 åŠ¨æ€æ•°æ®å¤„ç†æ–¹æ¡ˆ</h2><h3 id="4-4-1-ESI-Edge-Side-Includes"><a href="#4-4-1-ESI-Edge-Side-Includes" class="headerlink" title="4.4.1 ESI (Edge Side Includes)"></a>4.4.1 ESI (Edge Side Includes)</h3><p>åœ¨Webä»£ç†æœåŠ¡å™¨ä¸ŠåšåŠ¨æ€å†…å®¹è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚æ’å…¥åˆ°é™æ€é¡µé¢ä¸­ï¼Œå½“ç”¨æˆ·æ‹¿åˆ°é¡µé¢æ—¶å·²ç»æ˜¯ä¸€ä¸ªå®Œæ•´çš„é¡µé¢äº†ã€‚å¯¹æœåŠ¡ç«¯æ€§èƒ½æœ‰å½±å“ï¼Œä½†æ˜¯ç”¨æˆ·ä½“éªŒä¼šæ¯”è¾ƒå¥½</p><h3 id="4-4-2-CSI-Client-Side-Include"><a href="#4-4-2-CSI-Client-Side-Include" class="headerlink" title="4.4.2 CSI (Client Side Include)"></a>4.4.2 CSI (Client Side Include)</h3><p>å•ç‹¬å‘å‡ºå¼‚æ­¥Javascriptè¯·æ±‚ï¼Œå‘æœåŠ¡ç«¯è·å–åŠ¨æ€å†…å®¹ã€‚è¿™ç§æ–¹å¼æœåŠ¡ç«¯æ€§èƒ½æ›´å¥½ï¼Œä½†æ˜¯ç”¨æˆ·ç«¯å¯èƒ½ä¼šæœ‰å»¶æ—¶ï¼Œä½“éªŒä¼šå·®ä¸€äº›</p><h2 id="4-5-åŠ¨é™åˆ†ç¦»æ¶æ„æ–¹æ¡ˆ"><a href="#4-5-åŠ¨é™åˆ†ç¦»æ¶æ„æ–¹æ¡ˆ" class="headerlink" title="4.5 åŠ¨é™åˆ†ç¦»æ¶æ„æ–¹æ¡ˆ"></a>4.5 åŠ¨é™åˆ†ç¦»æ¶æ„æ–¹æ¡ˆ</h2><h3 id="4-5-1-å®ä½“æœºå•æœºéƒ¨ç½²"><a href="#4-5-1-å®ä½“æœºå•æœºéƒ¨ç½²" class="headerlink" title="4.5.1 å®ä½“æœºå•æœºéƒ¨ç½²"></a>4.5.1 å®ä½“æœºå•æœºéƒ¨ç½²</h3><p>è¿™ç§æ–¹æ¡ˆæ˜¯å°†è™šæ‹Ÿæœºæ”¹ä¸ºå®ä½“æœºï¼Œä»¥å¢å¤§ Cache çš„å®¹é‡ï¼Œå¹¶ä¸”é‡‡ç”¨äº†ä¸€è‡´æ€§ Hash åˆ†ç»„çš„æ–¹å¼æ¥æå‡å‘½ä¸­ç‡ã€‚è¿™é‡Œå°† Cache åˆ†æˆè‹¥å¹²ç»„ï¼Œæ˜¯å¸Œæœ›èƒ½è¾¾åˆ°å‘½ä¸­ç‡å’Œè®¿é—®çƒ­ç‚¹çš„å¹³è¡¡ã€‚Hash åˆ†ç»„è¶Šå°‘ï¼Œç¼“å­˜çš„å‘½ä¸­ç‡è‚¯å®šå°±ä¼šè¶Šé«˜ï¼Œä½†çŸ­æ¿æ˜¯ä¹Ÿä¼šä½¿å•ä¸ªå•†å“é›†ä¸­åœ¨ä¸€ä¸ªåˆ†ç»„ä¸­ï¼Œå®¹æ˜“å¯¼è‡´ Cache è¢«å‡»ç©¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥é€‚å½“å¢åŠ å¤šä¸ªç›¸åŒçš„åˆ†ç»„ï¼Œæ¥å¹³è¡¡è®¿é—®çƒ­ç‚¹å’Œå‘½ä¸­ç‡çš„é—®é¢˜ã€‚</p><p>Nginx+Cache+Javaç»“æ„å®ä½“æœºå•æœºéƒ¨ç½²<br><img src="https://i.loli.net/2020/02/03/m6GuWRPxrk4hvK8.jpg" alt="fig4.jpg"></p><p>è¿™ç§éƒ¨ç½²æ–¹å¼æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p><ol><li>æ²¡æœ‰ç½‘ç»œç“¶é¢ˆï¼Œè€Œä¸”èƒ½ä½¿ç”¨å¤§å†…å­˜ï¼›</li><li>æ—¢èƒ½æå‡å‘½ä¸­ç‡ï¼Œåˆèƒ½å‡å°‘ Gzip å‹ç¼©ï¼›</li><li>å‡å°‘ Cache å¤±æ•ˆå‹åŠ›ï¼Œå› ä¸ºé‡‡ç”¨å®šæ—¶å¤±æ•ˆæ–¹å¼ï¼Œä¾‹å¦‚åªç¼“å­˜ 3 ç§’é’Ÿï¼Œè¿‡æœŸå³è‡ªåŠ¨å¤±æ•ˆã€‚</li></ol><p>è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œè™½ç„¶æŠŠé€šå¸¸åªéœ€è¦è™šæ‹Ÿæœºæˆ–è€…å®¹å™¨è¿è¡Œçš„ Java åº”ç”¨æ¢æˆå®ä½“æœºï¼Œä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼Œå®ƒä¼šå¢åŠ å•æœºçš„å†…å­˜å®¹é‡ï¼Œä½†æ˜¯ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿé€ æˆäº† CPU çš„æµªè´¹ï¼Œå› ä¸ºå•ä¸ªçš„ Java è¿›ç¨‹å¾ˆéš¾ç”¨å®Œæ•´ä¸ªå®ä½“æœºçš„ CPUã€‚</p><p>å¦å¤–å°±æ˜¯ï¼Œä¸€ä¸ªå®ä½“æœºä¸Šéƒ¨ç½²äº† Java åº”ç”¨åˆä½œä¸º Cache æ¥ä½¿ç”¨ï¼Œè¿™é€ æˆäº†è¿ç»´ä¸Šçš„é«˜å¤æ‚åº¦ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæŠ˜ä¸­çš„æ–¹æ¡ˆã€‚å¦‚æœä½ çš„å…¬å¸é‡Œï¼Œæ²¡æœ‰æ›´å¤šçš„ç³»ç»Ÿæœ‰ç±»ä¼¼éœ€æ±‚ï¼Œé‚£ä¹ˆè¿™æ ·åšä¹Ÿæ¯”è¾ƒåˆé€‚ï¼Œå¦‚æœä½ ä»¬æœ‰å¤šä¸ªä¸šåŠ¡ç³»ç»Ÿéƒ½æœ‰é™æ€åŒ–æ”¹é€ çš„éœ€æ±‚ï¼Œé‚£è¿˜æ˜¯å»ºè®®æŠŠ Cache å±‚å•ç‹¬æŠ½å‡ºæ¥å…¬ç”¨æ¯”è¾ƒåˆç†ï¼Œå¦‚ä¸‹é¢çš„æ–¹æ¡ˆ 2 æ‰€ç¤ºã€‚</p><h3 id="4-5-2-ç»Ÿä¸€Cacheå±‚"><a href="#4-5-2-ç»Ÿä¸€Cacheå±‚" class="headerlink" title="4.5.2 ç»Ÿä¸€Cacheå±‚"></a>4.5.2 ç»Ÿä¸€Cacheå±‚</h3><p>æ‰€è°“ç»Ÿä¸€ Cache å±‚ï¼Œå°±æ˜¯å°†å•æœºçš„ Cache ç»Ÿä¸€åˆ†ç¦»å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªå•ç‹¬çš„ Cache é›†ç¾¤ã€‚ç»Ÿä¸€ Cache å±‚æ˜¯ä¸ªæ›´ç†æƒ³çš„å¯æ¨å¹¿æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/03/oJjRUqAkN8PVGaM.jpg" alt="fig5.jpg"></p><p>ç»Ÿä¸€Cacheå±‚ï¼Œå¯ä»¥å‡å°‘è¿ç»´æˆæœ¬ï¼Œä¹Ÿæ–¹ä¾¿æ¥å…¥å…¶ä»–é™æ€åŒ–ç³»ç»Ÿï¼Œè¿˜æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ol><li>å•ç‹¬ä¸€ä¸ª Cache å±‚ï¼Œå¯ä»¥å‡å°‘å¤šä¸ªåº”ç”¨æ¥å…¥æ—¶ä½¿ç”¨ Cache çš„æˆæœ¬ã€‚è¿™æ ·æ¥å…¥çš„åº”ç”¨åªè¦ç»´æŠ¤è‡ªå·±çš„ Java ç³»ç»Ÿå°±å¥½ï¼Œä¸éœ€è¦å•ç‹¬ç»´æŠ¤ Cacheï¼Œè€Œåªå…³å¿ƒå¦‚ä½•ä½¿ç”¨å³å¯ã€‚</li><li>ç»Ÿä¸€ Cache çš„æ–¹æ¡ˆæ›´æ˜“äºç»´æŠ¤ï¼Œå¦‚åé¢åŠ å¼ºç›‘æ§ã€é…ç½®çš„è‡ªåŠ¨åŒ–ï¼Œåªéœ€è¦ä¸€å¥—è§£å†³æ–¹æ¡ˆå°±è¡Œï¼Œç»Ÿä¸€èµ·æ¥ç»´æŠ¤å‡çº§ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚</li><li>å¯ä»¥å…±äº«å†…å­˜ï¼Œæœ€å¤§åŒ–åˆ©ç”¨å†…å­˜ï¼Œä¸åŒç³»ç»Ÿä¹‹é—´çš„å†…å­˜å¯ä»¥åŠ¨æ€åˆ‡æ¢ï¼Œä»è€Œèƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹å„ç§æ”»å‡»ã€‚</li></ol><p>è¿™ç§æ–¹æ¡ˆä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ï¼š</p><ol><li>Cache å±‚å†…éƒ¨äº¤æ¢ç½‘ç»œæˆä¸ºç“¶é¢ˆï¼›</li><li>ç¼“å­˜æœåŠ¡å™¨çš„ç½‘å¡ä¹Ÿä¼šæ˜¯ç“¶é¢ˆï¼›</li><li>æœºå™¨å°‘é£é™©è¾ƒå¤§ï¼ŒæŒ‚æ‰ä¸€å°å°±ä¼šå½±å“å¾ˆå¤§ä¸€éƒ¨åˆ†ç¼“å­˜æ•°æ®ã€‚</li></ol><p>è¦è§£å†³ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œå¯ä»¥å†å¯¹ Cache åš Hash åˆ†ç»„ï¼Œå³ä¸€ç»„ Cache ç¼“å­˜çš„å†…å®¹ç›¸åŒï¼Œè¿™æ ·èƒ½å¤Ÿé¿å…çƒ­ç‚¹æ•°æ®è¿‡åº¦é›†ä¸­å¯¼è‡´æ–°çš„ç“¶é¢ˆäº§ç”Ÿã€‚</p><h3 id="4-5-3-ä½¿ç”¨CDN"><a href="#4-5-3-ä½¿ç”¨CDN" class="headerlink" title="4.5.3 ä½¿ç”¨CDN"></a>4.5.3 ä½¿ç”¨CDN</h3><p>åœ¨å°†æ•´ä¸ªç³»ç»ŸåšåŠ¨é™åˆ†ç¦»åï¼Œæˆ‘ä»¬è‡ªç„¶ä¼šæƒ³åˆ°æ›´è¿›ä¸€æ­¥çš„æ–¹æ¡ˆï¼Œå°±æ˜¯å°† Cache è¿›ä¸€æ­¥å‰ç§»åˆ° CDN ä¸Šï¼Œå› ä¸º CDN ç¦»ç”¨æˆ·æœ€è¿‘ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚</p><p>æœ‰å‡ ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼š </p><ol><li>å¤±æ•ˆé—®é¢˜</li></ol><p>å‰é¢æˆ‘ä»¬ä¹Ÿæœ‰æåˆ°è¿‡ç¼“å­˜æ—¶æ•ˆçš„é—®é¢˜ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç†è§£ï¼Œæˆ‘å†æ¥è§£é‡Šä¸€ä¸‹ã€‚è°ˆåˆ°é™æ€æ•°æ®æ—¶ï¼Œæˆ‘è¯´è¿‡ä¸€ä¸ªå…³é”®è¯å«â€œç›¸å¯¹ä¸å˜â€ï¼Œå®ƒçš„è¨€å¤–ä¹‹æ„æ˜¯â€œå¯èƒ½ä¼šå˜åŒ–â€ã€‚æ¯”å¦‚ä¸€ç¯‡æ–‡ç« ï¼Œç°åœ¨ä¸å˜ï¼Œä½†å¦‚æœä½ å‘ç°ä¸ªé”™åˆ«å­—ï¼Œæ˜¯ä¸æ˜¯å°±ä¼šå˜åŒ–äº†ï¼Ÿå¦‚æœä½ çš„ç¼“å­˜æ—¶æ•ˆå¾ˆé•¿ï¼Œé‚£ç”¨æˆ·ç«¯åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…çœ‹åˆ°çš„éƒ½æ˜¯é”™çš„ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸­ä¹Ÿæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ CDN å¯ä»¥åœ¨ç§’çº§æ—¶é—´å†…ï¼Œè®©åˆ†å¸ƒåœ¨å…¨å›½å„åœ°çš„ Cache åŒæ—¶å¤±æ•ˆï¼Œè¿™å¯¹ CDN çš„å¤±æ•ˆç³»ç»Ÿè¦æ±‚å¾ˆé«˜ã€‚</p><ol start="2"><li>å‘½ä¸­ç‡é—®é¢˜</li></ol><p>Cache æœ€é‡è¦çš„ä¸€ä¸ªè¡¡é‡æŒ‡æ ‡å°±æ˜¯â€œé«˜å‘½ä¸­ç‡â€ï¼Œä¸ç„¶ Cache çš„å­˜åœ¨å°±å¤±å»äº†æ„ä¹‰ã€‚åŒæ ·ï¼Œå¦‚æœå°†æ•°æ®å…¨éƒ¨æ”¾åˆ°å…¨å›½çš„ CDN ä¸Šï¼Œå¿…ç„¶å¯¼è‡´ Cache åˆ†æ•£ï¼Œè€Œ Cache åˆ†æ•£åˆä¼šå¯¼è‡´è®¿é—®è¯·æ±‚å‘½ä¸­åŒä¸€ä¸ª Cache çš„å¯èƒ½æ€§é™ä½ï¼Œé‚£ä¹ˆå‘½ä¸­ç‡å°±æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p><ol start="3"><li>å‘å¸ƒæ›´æ–°é—®é¢˜</li></ol><p>å¦‚æœä¸€ä¸ªä¸šåŠ¡ç³»ç»Ÿæ¯å‘¨éƒ½æœ‰æ—¥å¸¸ä¸šåŠ¡éœ€è¦å‘å¸ƒï¼Œé‚£ä¹ˆå‘å¸ƒç³»ç»Ÿå¿…é¡»è¶³å¤Ÿç®€æ´é«˜æ•ˆï¼Œè€Œä¸”ä½ è¿˜è¦è€ƒè™‘æœ‰é—®é¢˜æ—¶å¿«é€Ÿå›æ»šå’Œæ’æŸ¥é—®é¢˜çš„ç®€ä¾¿æ€§ã€‚</p><p>ä»å‰é¢çš„åˆ†ææ¥çœ‹ï¼Œå°†å•†å“è¯¦æƒ…ç³»ç»Ÿæ”¾åˆ°å…¨å›½çš„æ‰€æœ‰ CDN èŠ‚ç‚¹ä¸Šæ˜¯ä¸å¤ªç°å®çš„ï¼Œå› ä¸ºå­˜åœ¨å¤±æ•ˆé—®é¢˜ã€å‘½ä¸­ç‡é—®é¢˜ä»¥åŠç³»ç»Ÿçš„å‘å¸ƒæ›´æ–°é—®é¢˜ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥é€‰æ‹©è‹¥å¹²ä¸ªèŠ‚ç‚¹æ¥å°è¯•å®æ–½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯â€œå¯ä»¥â€ï¼Œä½†æ˜¯è¿™æ ·çš„èŠ‚ç‚¹éœ€è¦æ»¡è¶³å‡ ä¸ªæ¡ä»¶ï¼š</p><ol><li>é è¿‘è®¿é—®é‡æ¯”è¾ƒé›†ä¸­çš„åœ°åŒº</li><li>ç¦»ä¸»ç«™ç›¸å¯¹è¾ƒè¿œ</li><li>èŠ‚ç‚¹åˆ°ä¸»ç«™é—´çš„ç½‘ç»œæ¯”è¾ƒå¥½ï¼Œæ¯”è¾ƒç¨³å®š</li><li>èŠ‚ç‚¹å®¹é‡å¤§ï¼Œä¸ä¼šå ç”¨å…¶ä»–CDNå¤ªå¤šçš„èµ„æº</li></ol><p>åŸºäºä¸Šé¢å‡ ä¸ªå› ç´ ï¼Œé€‰æ‹© CDN çš„äºŒçº§ Cache æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºäºŒçº§ Cache æ•°é‡åå°‘ï¼Œå®¹é‡ä¹Ÿæ›´å¤§ï¼Œè®©ç”¨æˆ·çš„è¯·æ±‚å…ˆå›æºçš„ CDN çš„äºŒçº§ Cache ä¸­ï¼Œå¦‚æœæ²¡å‘½ä¸­å†å›æºç«™è·å–æ•°æ®ï¼Œéƒ¨ç½²æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/03/Eu5q7bATK4xFkSW.jpg" alt="fig6.jpg"></p><p>ä½¿ç”¨ CDN çš„äºŒçº§ Cache ä½œä¸ºç¼“å­˜ï¼Œå¯ä»¥è¾¾åˆ°å’Œå½“å‰æœåŠ¡ç«¯é™æ€åŒ– Cache ç±»ä¼¼çš„å‘½ä¸­ç‡ï¼Œå› ä¸ºèŠ‚ç‚¹æ•°ä¸å¤šï¼ŒCache ä¸æ˜¯å¾ˆåˆ†æ•£ï¼Œè®¿é—®é‡ä¹Ÿæ¯”è¾ƒé›†ä¸­ï¼Œè¿™æ ·ä¹Ÿå°±è§£å†³äº†å‘½ä¸­ç‡é—®é¢˜ï¼ŒåŒæ—¶èƒ½å¤Ÿç»™ç”¨æˆ·æœ€å¥½çš„è®¿é—®ä½“éªŒï¼Œæ˜¯å½“å‰æ¯”è¾ƒç†æƒ³çš„ä¸€ç§ CDN åŒ–æ–¹æ¡ˆã€‚</p><h1 id="5-å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®"><a href="#5-å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®" class="headerlink" title="5. å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®"></a>5. å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®</h1><p>æœ‰ä¸€éƒ¨åˆ†æ•°æ®æ˜¯ä¼šè¢«å¤§é‡ç”¨æˆ·è®¿é—®çš„çƒ­å–å•†å“ï¼Œè¿™éƒ¨åˆ†å•†å“æ˜¯éœ€è¦ç‰¹æ®Šå…³æ³¨çš„ï¼Œå› ä¸ºå…¶ä¼šå¯¹ç³»ç»Ÿäº§ç”Ÿä¸€ç³»åˆ—çš„å½±å“ã€‚</p><p>é¦–å…ˆï¼Œçƒ­ç‚¹è¯·æ±‚ä¼šå¤§é‡å ç”¨æœåŠ¡å™¨å¤„ç†èµ„æºï¼Œè™½ç„¶è¿™ä¸ªçƒ­ç‚¹å¯èƒ½å æ€»é‡çš„å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œç„¶è€Œå´å¯èƒ½æŠ¢å 90%ä»¥ä¸Šçš„æœåŠ¡å™¨èµ„æºï¼Œå¦‚æœè¿™ä¸ªçƒ­ç‚¹è¯·æ±‚è¿˜æ˜¯æ²¡æœ‰ä»·å€¼çš„æ— æ•ˆè¯·æ±‚ï¼Œé‚£ä¹ˆå¯¹ç³»ç»Ÿèµ„æºæ¥è¯´å®Œå…¨æ˜¯æµªè´¹ã€‚</p><h2 id="5-1-ä»€ä¹ˆæ˜¯çƒ­ç‚¹"><a href="#5-1-ä»€ä¹ˆæ˜¯çƒ­ç‚¹" class="headerlink" title="5.1 ä»€ä¹ˆæ˜¯çƒ­ç‚¹"></a>5.1 ä»€ä¹ˆæ˜¯çƒ­ç‚¹</h2><h3 id="5-1-1-çƒ­ç‚¹æ“ä½œ"><a href="#5-1-1-çƒ­ç‚¹æ“ä½œ" class="headerlink" title="5.1.1 çƒ­ç‚¹æ“ä½œ"></a>5.1.1 çƒ­ç‚¹æ“ä½œ</h3><p>ä¾‹å¦‚å¤§é‡çš„åˆ·æ–°é¡µé¢ï¼Œå¤§é‡æ·»åŠ è´­ç‰©è½¦ï¼Œé›¶ç‚¹å¤§é‡çš„ä¸‹å•ç­‰ã€‚è¿™äº›æ“ä½œå¯ä»¥æŠ½è±¡ä¸ºâ€œè¯»è¯·æ±‚â€å’Œâ€œå†™è¯·æ±‚â€ï¼Œè¿™ä¸¤ç§è¯·æ±‚çš„å¤„ç†æ–¹å¼å¤§ç›¸å¾„åº­ï¼Œè¯»è¯·æ±‚çš„ä¼˜åŒ–ç©ºé—´æ¯”è¾ƒå¤§ï¼Œè€Œå†™è¯·æ±‚çš„ç“¶é¢ˆä¸€èˆ¬éƒ½åœ¨å­˜å‚¨å±‚ï¼Œä¼˜åŒ–çš„æ€è·¯å°±æ˜¯æ ¹æ®CAPç†è®ºåšå¹³è¡¡ã€‚</p><h3 id="5-1-2-çƒ­ç‚¹æ•°æ®"><a href="#5-1-2-çƒ­ç‚¹æ•°æ®" class="headerlink" title="5.1.2 çƒ­ç‚¹æ•°æ®"></a>5.1.2 çƒ­ç‚¹æ•°æ®</h3><p>çƒ­ç‚¹æ•°æ®å°±æ˜¯ç”¨æˆ·çš„çƒ­ç‚¹è¯·æ±‚å¯¹åº”çš„æ•°æ®ï¼Œåˆå¯ä»¥åˆ†ä¸ºé™æ€çƒ­ç‚¹æ•°æ®å’ŒåŠ¨æ€çƒ­ç‚¹æ•°æ®ã€‚</p><p>é™æ€çƒ­ç‚¹æ•°æ®ï¼Œå°±æ˜¯èƒ½å¤Ÿæå‰é¢„æµ‹çš„çƒ­ç‚¹æ•°æ®ã€‚åŠ¨æ€çƒ­ç‚¹æ•°æ®ï¼Œå°±æ˜¯ä¸èƒ½è¢«æå‰é¢„æµ‹åˆ°çš„ï¼Œç³»ç»Ÿåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶äº§ç”Ÿçš„çƒ­ç‚¹ã€‚</p><h2 id="5-2-å‘ç°çƒ­ç‚¹æ•°æ®"><a href="#5-2-å‘ç°çƒ­ç‚¹æ•°æ®" class="headerlink" title="5.2 å‘ç°çƒ­ç‚¹æ•°æ®"></a>5.2 å‘ç°çƒ­ç‚¹æ•°æ®</h2><h3 id="5-2-1-å‘ç°é™æ€çƒ­ç‚¹æ•°æ®"><a href="#5-2-1-å‘ç°é™æ€çƒ­ç‚¹æ•°æ®" class="headerlink" title="5.2.1 å‘ç°é™æ€çƒ­ç‚¹æ•°æ®"></a>5.2.1 å‘ç°é™æ€çƒ­ç‚¹æ•°æ®</h3><p>å¦‚å‰é¢è®²çš„ï¼Œé™æ€çƒ­ç‚¹æ•°æ®å¯ä»¥é€šè¿‡å•†ä¸šæ‰‹æ®µï¼Œä¾‹å¦‚å¼ºåˆ¶è®©å–å®¶é€šè¿‡æŠ¥åå‚åŠ çš„æ–¹å¼æå‰æŠŠçƒ­ç‚¹å•†å“ç­›é€‰å‡ºæ¥ï¼Œå®ç°æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªè¿è¥ç³»ç»Ÿï¼ŒæŠŠå‚åŠ æ´»åŠ¨çš„å•†å“æ•°æ®è¿›è¡Œæ‰“æ ‡ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªåå°ç³»ç»Ÿå¯¹è¿™äº›çƒ­ç‚¹å•†å“è¿›è¡Œé¢„å¤„ç†ï¼Œå¦‚æå‰è¿›è¡Œç¼“å­˜ã€‚ä½†æ˜¯è¿™ç§é€šè¿‡æŠ¥åæå‰ç­›é€‰çš„æ–¹å¼ä¹Ÿä¼šå¸¦æ¥æ–°çš„é—®é¢˜ï¼Œå³å¢åŠ å–å®¶çš„ä½¿ç”¨æˆæœ¬ï¼Œè€Œä¸”å®æ—¶æ€§è¾ƒå·®ï¼Œä¹Ÿä¸å¤ªçµæ´»ã€‚</p><p>ä¸è¿‡ï¼Œé™¤äº†æå‰æŠ¥åç­›é€‰è¿™ç§æ–¹å¼ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡æŠ€æœ¯æ‰‹æ®µæå‰é¢„æµ‹ï¼Œä¾‹å¦‚å¯¹ä¹°å®¶æ¯å¤©è®¿é—®çš„å•†å“è¿›è¡Œå¤§æ•°æ®è®¡ç®—ï¼Œç„¶åç»Ÿè®¡å‡º TOP N çš„å•†å“ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™äº› TOP N çš„å•†å“å°±æ˜¯çƒ­ç‚¹å•†å“ã€‚</p><h3 id="5-2-2-å‘ç°åŠ¨æ€çƒ­ç‚¹æ•°æ®"><a href="#5-2-2-å‘ç°åŠ¨æ€çƒ­ç‚¹æ•°æ®" class="headerlink" title="5.2.2 å‘ç°åŠ¨æ€çƒ­ç‚¹æ•°æ®"></a>5.2.2 å‘ç°åŠ¨æ€çƒ­ç‚¹æ•°æ®</h3><p>å…·ä½“å®ç°</p><ol><li>æ„å»ºå¼‚æ­¥ç³»ç»Ÿï¼Œç”¨æ¥æ”¶é›†äº¤æ˜“é“¾è·¯ä¸Šå„ä¸ªç¯èŠ‚ä¸­çš„ä¸­é—´ä»¶äº§å“çš„çƒ­ç‚¹Keyï¼Œä¾‹å¦‚Nginxã€ç¼“å­˜ã€RPCæœåŠ¡æ¡†æ¶</li><li>å»ºç«‹ä¸€ä¸ªçƒ­ç‚¹ä¸ŠæŠ¥å’Œå¯ä»¥æŒ‰ç…§éœ€æ±‚è®¢é˜…çš„çƒ­ç‚¹æœåŠ¡çš„ä¸‹å‘è§„èŒƒã€‚å› ä¸ºäº¤æ˜“é“¾è·¯ä¸Šå„ä¸ªç³»ç»Ÿ(åŒ…æ‹¬è¯¦æƒ…ï¼Œè´­ç‰©è½¦ï¼Œäº¤æ˜“ï¼Œä¼˜æƒ ï¼Œåº“å­˜ç­‰ç­‰)ä¼šæœ‰è®¿é—®ä¸Šçš„æ—¶é—´å·®ï¼Œéœ€è¦å°†ä¸Šæ¸¸å·²ç»å‘ç°çš„çƒ­ç‚¹é€ä¼ ç»™ä¸‹æ¸¸ç³»ç»Ÿï¼Œæå‰åšå¥½ä¿æŠ¤ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå¤§ä¿ƒé«˜å³°æœŸï¼Œè¯¦æƒ…ç³»ç»Ÿæ˜¯æœ€æ—©çŸ¥é“çš„ã€‚</li><li>å°†ä¸Šæ¸¸ç³»ç»Ÿæ”¶é›†çš„çƒ­ç‚¹æ•°æ®å‘é€åˆ°çƒ­ç‚¹æœåŠ¡å°ï¼Œè®©ä¸‹æ¸¸ç³»ç»Ÿæå‰çŸ¥é“ä¿¡æ¯ï¼Œåšçƒ­ç”µä¿æŠ¤</li></ol><p><img src="https://i.loli.net/2020/02/03/hGd5HWVLaEKAwZS.jpg" alt="fig7.jpg"></p><p>æˆ‘ä»¬é€šè¿‡éƒ¨ç½²åœ¨æ¯å°æœºå™¨ä¸Šçš„ Agent æŠŠæ—¥å¿—æ±‡æ€»åˆ°èšåˆå’Œåˆ†æé›†ç¾¤ä¸­ï¼Œç„¶åæŠŠç¬¦åˆä¸€å®šè§„åˆ™çš„çƒ­ç‚¹æ•°æ®ï¼Œé€šè¿‡è®¢é˜…åˆ†å‘ç³»ç»Ÿå†æ¨é€åˆ°ç›¸åº”çš„ç³»ç»Ÿä¸­ã€‚ä½ å¯ä»¥æ˜¯æŠŠçƒ­ç‚¹æ•°æ®å¡«å……åˆ° Cache ä¸­ï¼Œæˆ–è€…ç›´æ¥æ¨é€åˆ°åº”ç”¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œè¿˜å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œæ‹¦æˆªï¼Œæ€»ä¹‹ä¸‹æ¸¸ç³»ç»Ÿå¯ä»¥è®¢é˜…è¿™äº›æ•°æ®ï¼Œç„¶åæ ¹æ®è‡ªå·±çš„éœ€æ±‚å†³å®šå¦‚ä½•å¤„ç†è¿™äº›æ•°æ®ã€‚</p><p>Tips:</p><ol><li>çƒ­ç‚¹æœåŠ¡çš„åå°æŠ“å–çƒ­ç‚¹æ•°æ®æ—¥å¿—çš„æ–¹å¼æœ€å¥½é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼›å¯ä»¥ä¿è¯é€šè¿‡æ€§ï¼Œä¸ä¼šå½±å“ä¸šåŠ¡ç³»ç»Ÿå’Œä¸­é—´ä»¶äº§å“çš„ä¸»æµç¨‹ã€‚</li><li>çƒ­ç‚¹æœåŠ¡å’Œä¸­é—´ä»¶è‡ªèº«éœ€è¦æœ‰çƒ­ç”µä¿æŠ¤æ¨¡å—ï¼Œæ¯ä¸ªä¸­é—´ä»¶å’Œåº”ç”¨å’Œéœ€è¦ä¿æŠ¤è‡ªå·±</li><li>çƒ­ç‚¹å‘ç°éœ€è¦æ¥è¿‘å®æ—¶ï¼Œå› ä¸ºåªæœ‰æ¥è¿‘å®æ—¶æ‰æœ‰æ„ä¹‰ï¼Œèƒ½åŠæ—¶å¯¹ä¸‹æ¸¸ç³»ç»Ÿæä¾›ä¿æŠ¤</li></ol><h2 id="5-3-å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®"><a href="#5-3-å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®" class="headerlink" title="5.3 å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®"></a>5.3 å¦‚ä½•å¤„ç†çƒ­ç‚¹æ•°æ®</h2><h3 id="5-3-1-ä¼˜åŒ–"><a href="#5-3-1-ä¼˜åŒ–" class="headerlink" title="5.3.1 ä¼˜åŒ–"></a>5.3.1 ä¼˜åŒ–</h3><p>ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œå¦‚æœçƒ­ç‚¹æ•°æ®åšäº†åŠ¨é™åˆ†ç¦»ï¼Œé‚£ä¹ˆå¯ä»¥é•¿æœŸç¼“å­˜é™æ€æ•°æ®ã€‚</p><h3 id="5-3-2-é™åˆ¶"><a href="#5-3-2-é™åˆ¶" class="headerlink" title="5.3.2 é™åˆ¶"></a>5.3.2 é™åˆ¶</h3><p>ä¿æŠ¤æœºåˆ¶ï¼Œæ¯”å¦‚å¯¹å•†å“çš„ASINåšä¸€è‡´æ€§hashï¼Œç„¶åæ ¹æ®hashåšåˆ†æ¡¶ï¼Œæ¯ä¸ªåˆ†æ¡¶å¤„ç½®ä¸€ä¸ªå¤„ç†é˜Ÿåˆ—ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°†çƒ­ç‚¹å•†å“é™åˆ¶åœ¨ä¸€ä¸ªè¯·æ±‚é˜Ÿåˆ—å½“ä¸­ï¼Œé˜²æ­¢å› ä¸ºæŸäº›çƒ­ç‚¹å•†å“å ç”¨å¤ªå¤šçš„æœåŠ¡å™¨èµ„æºï¼Œè€Œä½¿å¾—å…¶ä»–è¯·æ±‚å§‹ç»ˆå¾—ä¸åˆ°æœåŠ¡å™¨çš„å¤„ç†èµ„æºã€‚ </p><h3 id="5-3-3-éš”ç¦»"><a href="#5-3-3-éš”ç¦»" class="headerlink" title="5.3.3 éš”ç¦»"></a>5.3.3 éš”ç¦»</h3><p>å°†çƒ­ç‚¹æ•°æ®éš”ç¦»å‡ºæ¥ï¼Œé’ˆå¯¹çƒ­ç‚¹æ•°æ®å¯ä»¥å†åšä¼˜åŒ–</p><ol><li>ä¸šåŠ¡éš”ç¦» - å•†ä¸šé€»è¾‘ä¸Šè¿è¡Œä¸Šçš„éš”ç¦»</li><li>ç³»ç»Ÿéš”ç¦» - è¿è¡Œæ—¶çš„éš”ç¦»</li><li>æ•°æ®éš”ç¦» - å•ç‹¬æ•°æ®åº“ Cacheé›†ç¾¤</li></ol><h1 id="6-æµé‡å‰Šå³°"><a href="#6-æµé‡å‰Šå³°" class="headerlink" title="6. æµé‡å‰Šå³°"></a>6. æµé‡å‰Šå³°</h1><p>ç§’æ€è¯·æ±‚åœ¨æ—¶é—´ä¸Šæ˜¯é«˜åº¦é›†ä¸­äºæŸä¸€ç‰¹å®šçš„æ—¶é—´ç‚¹çš„ï¼Œè¿™æ ·ä¸€æ¥ä¼šæœ‰ä¸€ä¸ªç‰¹åˆ«é«˜çš„æµé‡å³°å€¼ï¼Œå®ƒå¯¹èµ„æºçš„æ¶ˆè€—æ˜¯ç¬æ—¶çš„ã€‚</p><p>ä½†æ˜¯å¯¹äºç§’æ€è¿™ä¸ªåœºæ™¯æ¥è¯´ï¼Œæœ€ç»ˆèƒ½å¤ŸæŠ¢åˆ°çš„å•†å“çš„äººæ•°æ˜¯å›ºå®šçš„ï¼Œå¹¶å‘è¯»è¶Šé«˜ï¼Œæ— æ•ˆè¯·æ±‚ä¹Ÿå°±è¶Šå¤šäº†ã€‚</p><p>ä»ä¸šåŠ¡è§’åº¦ä¸Šæ¥è¯´ï¼Œç§’æ€å¸Œæœ›æ›´å¤šçš„äººèƒ½å¤Ÿå‚ä¸è¿›æ¥ï¼Œæ›´å¤šçš„äººæ¥åˆ·æ–°é¡µé¢ï¼Œä½†æ˜¯çœŸæ­£å¼€å§‹ä¸‹å•çš„æ—¶å€™ï¼Œç§’æ€è¯·æ±‚å°±ä¸æ˜¯è¶Šå¤šè¶Šå¥½äº†ï¼Œå¯ä»¥è®¾è®¡ä¸€äº›è§„åˆ™ï¼Œè®©å¹¶å‘çš„è¯·æ±‚æ›´å¤šçš„å»¶ç¼“ï¼Œç”šè‡³æˆ‘ä»¬å¯ä»¥è¿‡æ»¤æ‰ä¸€äº›æ— æ•ˆè¯·æ±‚ã€‚</p><h2 id="6-1-å‰Šå³°çš„åŸå› "><a href="#6-1-å‰Šå³°çš„åŸå› " class="headerlink" title="6.1 å‰Šå³°çš„åŸå› "></a>6.1 å‰Šå³°çš„åŸå› </h2><p>æˆ‘ä»¬çŸ¥é“æœåŠ¡å™¨çš„å¤„ç†èµ„æºæ˜¯æ’å®šçš„ï¼Œä½ ç”¨æˆ–è€…ä¸ç”¨å®ƒçš„å¤„ç†èƒ½åŠ›éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å‡ºç°å³°å€¼çš„è¯ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å¿™åˆ°å¤„ç†ä¸è¿‡æ¥ï¼Œé—²çš„æ—¶å€™å´åˆæ²¡æœ‰ä»€ä¹ˆè¦å¤„ç†ã€‚ä½†æ˜¯ç”±äºè¦ä¿è¯æœåŠ¡è´¨é‡ï¼Œæˆ‘ä»¬çš„å¾ˆå¤šå¤„ç†èµ„æºåªèƒ½æŒ‰ç…§å¿™çš„æ—¶å€™æ¥é¢„ä¼°ï¼Œè€Œè¿™ä¼šå¯¼è‡´èµ„æºçš„ä¸€ä¸ªæµªè´¹ã€‚</p><p>å‰Šå³°ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿè®©æœåŠ¡ç«¯å¤„ç†å˜å¾—æ›´åŠ å¹³ç¨³ï¼Œä¹Ÿä¸ºäº†èƒ½å¤ŸèŠ‚çœæœåŠ¡å™¨çš„èµ„æºæˆæœ¬ã€‚ä»ç§’æ€è¿™ä¸ªåœºæ™¯æ¥è¯´ï¼Œå°±æ˜¯æ›´å¤šå»¶ç¼“ç”¨æˆ·è¯·æ±‚çš„å‘å‡ºï¼Œä»¥ä¾¿å‡å°‘æˆ–è€…è¿‡æ»¤æ‰ä¸€äº›æ— æ•ˆè¯·æ±‚ï¼Œéµä»è¯·æ±‚æ•°è¦å°½é‡å°‘çš„åŸåˆ™ã€‚</p><h2 id="6-2-æ— æŸå‰Šå³°æ–¹å¼"><a href="#6-2-æ— æŸå‰Šå³°æ–¹å¼" class="headerlink" title="6.2 æ— æŸå‰Šå³°æ–¹å¼"></a>6.2 æ— æŸå‰Šå³°æ–¹å¼</h2><h3 id="6-2-1-æ’é˜Ÿ"><a href="#6-2-1-æ’é˜Ÿ" class="headerlink" title="6.2.1 æ’é˜Ÿ"></a>6.2.1 æ’é˜Ÿ</h3><p>ç”¨æ¶ˆæ¯é˜Ÿåˆ—ç¼“å†²ç¬æ—¶æµé‡ï¼Œå°†åŒæ­¥çš„ç›´æ¥è°ƒç”¨è½¬æ¢æˆå¼‚æ­¥çš„é—´æ¥æ¨é€ï¼Œä¸­é—´é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—åœ¨ä¸€ç«¯æ‰¿æ¥ç¬æ—¶çš„æµé‡æ´ªå³°ï¼Œåœ¨å¦å¤–ä¸€ç«¯å¹³æ»‘åœ°å°†ä¿¡æ¯æ¨é€å‡ºå»ã€‚</p><p><img src="https://i.loli.net/2020/02/03/dyp5UfOgsSHC3hi.jpg" alt="fig8.jpg"></p><p>ä½†æ˜¯å¦‚æœæµé‡å³°å€¼æŒç»­ä¸€æ®µæ—¶é—´ï¼Œè¶…è¿‡äº†æ¶ˆæ¯é˜Ÿåˆ—çš„å¤„ç†ä¸Šé™ï¼Œè¿˜æ˜¯ä¼šè¢«å‹å®çš„ã€‚</p><p>å…¶ä»–å¸¸è§çš„æ’é˜Ÿæ–¹å¼æœ‰ï¼š</p><ol><li>åˆ©ç”¨çº¿ç¨‹æ± åŠ é”ç­‰å¾…</li><li>å…ˆè¿›å…ˆå‡ºã€å…ˆè¿›åå‡ºç­‰å¸¸ç”¨çš„å†…å­˜æ’é˜Ÿç®—æ³•çš„å®ç°</li><li>å°†è¯·æ±‚åºåˆ—åŒ–åˆ°æ–‡ä»¶å½“ä¸­ï¼Œç„¶åå†é¡ºåºè¯»æ–‡ä»¶</li></ol><h3 id="6-2-2-ç­”é¢˜"><a href="#6-2-2-ç­”é¢˜" class="headerlink" title="6.2.2 ç­”é¢˜"></a>6.2.2 ç­”é¢˜</h3><p>ç¬¬ä¸€ä¸ªç›®çš„æ˜¯é˜²æ­¢éƒ¨åˆ†ä¹°å®¶ä½¿ç”¨ç§’æ€å™¨åœ¨å‚åŠ ç§’æ€æ—¶ä½œå¼Šã€‚2011 å¹´ç§’æ€éå¸¸ç«çš„æ—¶å€™ï¼Œç§’æ€å™¨ä¹Ÿæ¯”è¾ƒçŒ–ç—ï¼Œå› è€Œæ²¡æœ‰è¾¾åˆ°å…¨æ°‘å‚ä¸å’Œè¥é”€çš„ç›®çš„ï¼Œæ‰€ä»¥ç³»ç»Ÿå¢åŠ äº†ç­”é¢˜æ¥é™åˆ¶ç§’æ€å™¨ã€‚å¢åŠ ç­”é¢˜åï¼Œä¸‹å•çš„æ—¶é—´åŸºæœ¬æ§åˆ¶åœ¨ 2s åï¼Œç§’æ€å™¨çš„ä¸‹å•æ¯”ä¾‹ä¹Ÿå¤§å¤§ä¸‹é™ã€‚</p><p>ç¬¬äºŒä¸ªç›®çš„å…¶å®å°±æ˜¯å»¶ç¼“è¯·æ±‚ï¼Œèµ·åˆ°å¯¹è¯·æ±‚æµé‡è¿›è¡Œå‰Šå³°çš„ä½œç”¨ï¼Œä»è€Œè®©ç³»ç»Ÿèƒ½å¤Ÿæ›´å¥½åœ°æ”¯æŒç¬æ—¶çš„æµé‡é«˜å³°ã€‚è¿™ä¸ªé‡è¦çš„åŠŸèƒ½å°±æ˜¯æŠŠå³°å€¼çš„ä¸‹å•è¯·æ±‚æ‹‰é•¿ï¼Œä»ä»¥å‰çš„ 1s ä¹‹å†…å»¶é•¿åˆ° 2s~10sã€‚è¿™æ ·ä¸€æ¥ï¼Œè¯·æ±‚å³°å€¼åŸºäºæ—¶é—´åˆ†ç‰‡äº†ã€‚è¿™ä¸ªæ—¶é—´çš„åˆ†ç‰‡å¯¹æœåŠ¡ç«¯å¤„ç†å¹¶å‘éå¸¸é‡è¦ï¼Œä¼šå¤§å¤§å‡è½»å‹åŠ›ã€‚è€Œä¸”ï¼Œç”±äºè¯·æ±‚å…·æœ‰å…ˆåé¡ºåºï¼Œé åçš„è¯·æ±‚åˆ°æ¥æ—¶è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰åº“å­˜äº†ï¼Œå› æ­¤æ ¹æœ¬åˆ°ä¸äº†æœ€åçš„ä¸‹å•æ­¥éª¤ï¼Œæ‰€ä»¥çœŸæ­£çš„å¹¶å‘å†™å°±éå¸¸æœ‰é™äº†ã€‚è¿™ç§è®¾è®¡æ€è·¯ç›®å‰ç”¨å¾—éå¸¸æ™®éï¼Œå¦‚å½“å¹´æ”¯ä»˜å®çš„â€œå’»ä¸€å’»â€ã€å¾®ä¿¡çš„â€œæ‘‡ä¸€æ‘‡â€éƒ½æ˜¯ç±»ä¼¼çš„æ–¹å¼ã€‚</p><h3 id="6-2-3-åˆ†å±‚è¿‡æ»¤"><a href="#6-2-3-åˆ†å±‚è¿‡æ»¤" class="headerlink" title="6.2.3 åˆ†å±‚è¿‡æ»¤"></a>6.2.3 åˆ†å±‚è¿‡æ»¤</h3><p>é‡‡ç”¨æ¼æ–—å¼çš„è®¾è®¡</p><p><img src="https://i.loli.net/2020/02/03/GCXLQ2UsIqElavZ.jpg" alt="fig9.jpg"></p><p>å‡å¦‚è¯·æ±‚åˆ†åˆ«ç»è¿‡ CDNã€å‰å°è¯»ç³»ç»Ÿï¼ˆå¦‚å•†å“è¯¦æƒ…ç³»ç»Ÿï¼‰ã€åå°ç³»ç»Ÿï¼ˆå¦‚äº¤æ˜“ç³»ç»Ÿï¼‰å’Œæ•°æ®åº“è¿™å‡ å±‚ï¼Œé‚£ä¹ˆï¼š</p><ul><li>å¤§éƒ¨åˆ†æ•°æ®å’Œæµé‡åœ¨ç”¨æˆ·æµè§ˆå™¨æˆ–è€… CDN ä¸Šè·å–ï¼Œè¿™ä¸€å±‚å¯ä»¥æ‹¦æˆªå¤§éƒ¨åˆ†æ•°æ®çš„è¯»å–</li><li>ç»è¿‡ç¬¬äºŒå±‚ï¼ˆå³å‰å°ç³»ç»Ÿï¼‰æ—¶æ•°æ®ï¼ˆåŒ…æ‹¬å¼ºä¸€è‡´æ€§çš„æ•°æ®ï¼‰å°½é‡å¾—èµ° Cacheï¼Œè¿‡æ»¤ä¸€äº›æ— æ•ˆçš„è¯·æ±‚</li><li>å†åˆ°ç¬¬ä¸‰å±‚åå°ç³»ç»Ÿï¼Œä¸»è¦åšæ•°æ®çš„äºŒæ¬¡æ£€éªŒï¼Œå¯¹ç³»ç»Ÿåšå¥½ä¿æŠ¤å’Œé™æµï¼Œè¿™æ ·æ•°æ®é‡å’Œè¯·æ±‚å°±è¿›ä¸€æ­¥å‡å°‘</li><li>æœ€ååœ¨æ•°æ®å±‚å®Œæˆæ•°æ®çš„å¼ºä¸€è‡´æ€§æ ¡éªŒ</li></ul><p>åˆ†å±‚è¿‡æ»¤çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨ä¸åŒçš„å±‚æ¬¡å°½å¯èƒ½åœ°è¿‡æ»¤æ‰æ— æ•ˆè¯·æ±‚ï¼Œè®©æ¼æ–—æœ€æœ«ç«¯çš„æ‰æ˜¯æœ‰æ•ˆçš„è¯·æ±‚ã€‚è€Œè¾¾åˆ°è¿™ç§æ•ˆæœï¼Œæˆ‘ä»¬å°±å¿…é¡»å¯¹æ•°æ®åšåˆ†å±‚çš„æ ¡éªŒã€‚</p><p>åˆ†å±‚æ ¡éªŒçš„åŸºæœ¬åŸåˆ™æœ‰ï¼š</p><ol><li>å°†åŠ¨æ€è¯·æ±‚çš„è¯»æ•°æ®ç¼“å­˜åœ¨Webç«¯ï¼Œè¿‡æ»¤æ‰æ— æ•ˆçš„æ•°æ®è¯»</li><li>å¯¹è¯»æ•°æ®ä¸åšå¼ºä¸€è‡´æ€§æ ¡éªŒï¼Œå‡å°‘å› ä¸ºä¸€è‡´æ€§æ ¡éªŒäº§ç”Ÿçš„ç“¶é¢ˆé—®é¢˜</li><li>å¯¹å†™æ•°æ®è¿›è¡ŒåŸºäºæ—¶é—´çš„åˆç†åˆ†ç‰‡ï¼Œè¿‡æ»¤æ‰è¿‡æœŸçš„å¤±æ•ˆè¯·æ±‚</li><li>å¯¹å†™è¯·æ±‚åšé™æµä¿æŠ¤ï¼Œå°†è¶…å‡ºç³»ç»Ÿæ‰¿è½½èƒ½åŠ›çš„è¯·æ±‚è¿‡æ»¤æ‰</li><li>å¯¹å†™æ•°æ®è¿›è¡Œå¼ºä¸€è‡´æ€§æ ¡éªŒï¼Œåªä¿ç•™æœ€åæœ‰æ•ˆçš„æ•°æ®</li></ol><p>åˆ†å±‚æ ¡éªŒçš„ç›®çš„æ˜¯ï¼šåœ¨è¯»ç³»ç»Ÿä¸­ï¼Œå°½é‡å‡å°‘ç”±äºä¸€è‡´æ€§æ ¡éªŒå¸¦æ¥çš„ç³»ç»Ÿç“¶é¢ˆï¼Œä½†æ˜¯å°½é‡å°†ä¸å½±å“æ€§èƒ½çš„æ£€æŸ¥æ¡ä»¶æå‰ï¼Œå¦‚ç”¨æˆ·æ˜¯å¦å…·æœ‰ç§’æ€èµ„æ ¼ã€å•†å“çŠ¶æ€æ˜¯å¦æ­£å¸¸ã€ç”¨æˆ·ç­”é¢˜æ˜¯å¦æ­£ç¡®ã€ç§’æ€æ˜¯å¦å·²ç»ç»“æŸã€æ˜¯å¦éæ³•è¯·æ±‚ã€è¥é”€ç­‰ä»·ç‰©æ˜¯å¦å……è¶³ç­‰ï¼›åœ¨å†™æ•°æ®ç³»ç»Ÿä¸­ï¼Œä¸»è¦å¯¹å†™çš„æ•°æ®ï¼ˆå¦‚â€œåº“å­˜â€ï¼‰åšä¸€è‡´æ€§æ£€æŸ¥ï¼Œæœ€ååœ¨æ•°æ®åº“å±‚ä¿è¯æ•°æ®çš„æœ€ç»ˆå‡†ç¡®æ€§ï¼ˆå¦‚â€œåº“å­˜â€ä¸èƒ½å‡ä¸ºè´Ÿæ•°ï¼‰ã€‚</p><h1 id="7-å½±å“æ€§èƒ½çš„å› ç´ "><a href="#7-å½±å“æ€§èƒ½çš„å› ç´ " class="headerlink" title="7. å½±å“æ€§èƒ½çš„å› ç´ "></a>7. å½±å“æ€§èƒ½çš„å› ç´ </h1><h2 id="7-1-æ€§èƒ½çš„å®šä¹‰"><a href="#7-1-æ€§èƒ½çš„å®šä¹‰" class="headerlink" title="7.1 æ€§èƒ½çš„å®šä¹‰"></a>7.1 æ€§èƒ½çš„å®šä¹‰</h2><p>æœåŠ¡è®¾å¤‡çš„ä¸åŒå¯¹äºæ€§èƒ½çš„å®šä¹‰ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¾‹å¦‚CPUä¸»è¦çœ‹ä¸»é¢‘ï¼Œç£ç›˜ä¸»è¦çœ‹IOPS(Input/ output Operations Per Second, å³æ¯ç§’è¿›è¡Œè¯»å†™æ“ä½œçš„æ¬¡æ•°)ã€‚</p><p>å…³äºç§’æ€ï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºç³»ç»ŸæœåŠ¡ç«¯çš„æ€§èƒ½ï¼Œä¸€èˆ¬ä½¿ç”¨QPSæ¥è¡¡é‡ï¼Œè¿˜æœ‰ä¸€ä¸ªå½±å“å’ŒQPSæ¯æ¯ç›¸å…³ï¼Œå³å“åº”æ—¶é—´(Response Time, RT)ï¼Œå¯ä»¥ç†è§£ä¸ºæœåŠ¡å™¨å¤„ç†å“åº”çš„è€—æ—¶ã€‚</p><p>æ­£å¸¸æƒ…å†µä¸‹å“åº”æ—¶é—´è¶ŠçŸ­ï¼Œä¸€ç§’é’Ÿå¤„ç†çš„è¯·æ±‚æ•°å°±ä¼šè¶Šå¤šï¼Œè¿™åœ¨å•çº¿ç¨‹å¤„ç†çš„æƒ…å†µä¸‹çœ‹èµ·æ¥æ˜¯çº¿æ€§å…³ç³»ï¼Œå³æˆ‘ä»¬åªè¦æŠŠæ¯ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´é™åˆ°æœ€ä½ï¼Œé‚£ä¹ˆæ€§èƒ½å°±ä¼šæœ€é«˜ã€‚è€Œåœ¨å¤šçº¿ç¨‹å½“ä¸­ï¼Œæ€»QPS = ï¼ˆ1000ms/ å“åº”æ—¶é—´ï¼‰x çº¿ç¨‹æ•°ï¼Œä»è¿™ä¸ªè§’åº¦ä¸Šæ¥çœ‹ï¼Œæ€§èƒ½å’Œä¸¤ä¸ªå› ç´ ç›¸å…³ï¼Œä¸€ä¸ªæ˜¯ä¸€æ¬¡å“åº”çš„æœåŠ¡ç«¯çš„è€—æ—¶ï¼Œä¸€ä¸ªæ˜¯å¤„ç†è¯·æ±‚çš„çº¿ç¨‹æ•°ã€‚</p><h3 id="7-1-1-å“åº”æ—¶é—´"><a href="#7-1-1-å“åº”æ—¶é—´" class="headerlink" title="7.1.1 å“åº”æ—¶é—´"></a>7.1.1 å“åº”æ—¶é—´</h3><p>å¯¹äºå¤§éƒ¨åˆ†çš„Webç³»ç»Ÿè€Œè¨€ï¼Œå“åº”æ—¶é—´ä¸€èˆ¬æ˜¯ç”±CPUæ‰§è¡Œæ—¶é—´å’Œçº¿ç¨‹ç­‰å¾…æ—¶é—´ç»„æˆçš„ï¼Œå³æœåŠ¡å™¨åœ¨å¤„ç†ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä¸€éƒ¨åˆ†æ˜¯CPUæœ¬èº«åœ¨åšè¿ç®—ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯å„ç§ç­‰å¾…ã€‚</p><p>ç†è§£äº†æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„é€»è¾‘ï¼Œä¼°è®¡ä½ ä¼šè¯´ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸å»å‡å°‘è¿™ç§ç­‰å¾…æ—¶é—´ã€‚å¾ˆé—æ†¾ï¼Œæ ¹æ®æˆ‘ä»¬å®é™…çš„æµ‹è¯•å‘ç°ï¼Œå‡å°‘çº¿ç¨‹ç­‰å¾…æ—¶é—´å¯¹æå‡æ€§èƒ½çš„å½±å“æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡å¾—é‚£ä¹ˆå¤§ï¼Œå®ƒå¹¶ä¸æ˜¯çº¿æ€§çš„æå‡å…³ç³»ï¼Œè¿™ç‚¹åœ¨å¾ˆå¤šä»£ç†æœåŠ¡å™¨ï¼ˆProxyï¼‰ä¸Šå¯ä»¥åšéªŒè¯ã€‚</p><p>å¦‚æœä»£ç†æœåŠ¡å™¨æœ¬èº«æ²¡æœ‰CPUæ¶ˆè€—ï¼Œæˆ‘ä»¬åœ¨æ¯æ¬¡ç»™ä»£ç†æœåŠ¡å™¨ä»£ç†çš„è¯·æ±‚åŠ ä¸ªå»¶æ—¶ï¼Œå³å¢åŠ å“åº”æ—¶é—´ï¼Œä½†æ˜¯è¿™å¯¹ä»£ç†æœåŠ¡å™¨æœ¬èº«çš„ååé‡å¹¶æ²¡æœ‰å¤šå¤§çš„å½±å“ï¼Œå› ä¸ºä»£ç†æœåŠ¡å™¨æœ¬èº«çš„èµ„æºå¹¶æ²¡æœ‰è¢«æ¶ˆè€—ï¼Œå¯ä»¥é€šè¿‡å¢åŠ ä»£ç†æœåŠ¡å™¨çš„å¤„ç†çº¿ç¨‹æ•°ï¼Œæ¥å¼¥è¡¥å“åº”æ—¶é—´å¯¹ä»£ç†æœåŠ¡å™¨çš„ QPS çš„å½±å“ã€‚</p><p>å…¶å®ï¼ŒçœŸæ­£å¯¹æ€§èƒ½æœ‰å½±å“çš„æ˜¯ CPU çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸º CPU çš„æ‰§è¡ŒçœŸæ­£æ¶ˆè€—äº†æœåŠ¡å™¨çš„èµ„æºã€‚ç»è¿‡å®é™…çš„æµ‹è¯•ï¼Œå¦‚æœå‡å°‘ CPU ä¸€åŠçš„æ‰§è¡Œæ—¶é—´ï¼Œå°±å¯ä»¥å¢åŠ ä¸€å€çš„ QPSã€‚</p><h3 id="7-1-2-çº¿ç¨‹æ•°"><a href="#7-1-2-çº¿ç¨‹æ•°" class="headerlink" title="7.1.2 çº¿ç¨‹æ•°"></a>7.1.2 çº¿ç¨‹æ•°</h3><p>å¹¶ä¸æ˜¯çº¿ç¨‹æ•°è¶Šå¤šè¶Šå¥½ï¼Œæ€»QPSå°±ä¼šè¶Šå¤§ï¼Œå› ä¸ºçº¿ç¨‹æœ¬èº«ä¹Ÿæ¶ˆè€—èµ„æºï¼Œä¼šå—åˆ°å…¶ä»–å› ç´ çš„åˆ¶çº¦ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹è¶Šå¤šç³»ç»Ÿçš„çº¿ç¨‹åˆ‡æ¢æˆæœ¬å°±ä¼šè¶Šé«˜ï¼Œè€Œä¸”æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šè€—è´¹ä¸€å®šçš„å†…å­˜ã€‚</p><p>é»˜è®¤çš„é…ç½®ä¸€èˆ¬ä¸ºï¼š</p><blockquote><p>çº¿ç¨‹æ•° = 2 x CPUæ ¸æ•° + 1</p></blockquote><p>è¿˜æœ‰ä¸€ä¸ªæ ¹æ®æœ€ä½³å®è·µå¾—å‡ºæ¥çš„å…¬å¼ä¸ºï¼š</p><blockquote><p>çº¿ç¨‹æ•° = [(çº¿ç¨‹ç­‰å¾…æ—¶é—´ + çº¿ç¨‹CPUæ—¶é—´) / çº¿ç¨‹CPUæ—¶é—´] x CPUæ•°é‡</p></blockquote><p>å› æ­¤è¦æå‡æ€§èƒ½ï¼Œæˆ‘ä»¬å°±è¦å‡å°‘CPUçš„æ‰§è¡Œæ—¶é—´ï¼Œå¦å¤–å°±æ˜¯è¦è®¾ç½®ä¸€ä¸ªåˆç†çš„å¹¶å‘çº¿ç¨‹æ•°é‡ï¼Œé€šè¿‡è¿™ä¸¤æ–¹é¢æ¥æ˜¾è‘—æå‡æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</p><h2 id="7-2-å¦‚ä½•å‘ç°ç“¶é¢ˆ"><a href="#7-2-å¦‚ä½•å‘ç°ç“¶é¢ˆ" class="headerlink" title="7.2 å¦‚ä½•å‘ç°ç“¶é¢ˆ"></a>7.2 å¦‚ä½•å‘ç°ç“¶é¢ˆ</h2><p>æœåŠ¡å™¨ä¼šå‡ºç°ç“¶é¢ˆçš„åœ°æ–¹å¾ˆå¤šï¼Œä¾‹å¦‚CPUï¼Œ å†…å­˜ï¼Œ ç£ç›˜ä»¥åŠç½‘ç»œç­‰å¯èƒ½éƒ½ä¼šå¯¼è‡´ç“¶é¢ˆã€‚å¦å¤–ä¸åŒçš„ç³»ç»Ÿå¯¹äºç“¶é¢ˆçš„å…³æ³¨åº¦ä¸ä¸€æ ·ï¼Œä¾‹å¦‚å¯¹ç¼“å­˜ç³»ç»Ÿæ¥è¯´ï¼Œåˆ¶çº¦çš„æ˜¯å†…å­˜ï¼Œè€Œå¯¹å­˜å‚¨å‹çš„ç³»ç»Ÿæ¥è¯´I/O æ›´å®¹æ˜“å‡ºç°ç“¶é¢ˆã€‚</p><p>è€Œå¯¹äºç§’æ€ï¼Œç“¶é¢ˆæ›´å®¹æ˜“å‘ç”Ÿåœ¨CPUä¸Šã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•å‘ç° CPU çš„ç“¶é¢ˆå‘¢ï¼Ÿå…¶å®æœ‰å¾ˆå¤š CPU è¯Šæ–­å·¥å…·å¯ä»¥å‘ç° CPU çš„æ¶ˆè€—ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯ JProfiler å’Œ Yourkit è¿™ä¸¤ä¸ªå·¥å…·ï¼Œå®ƒä»¬å¯ä»¥åˆ—å‡ºæ•´ä¸ªè¯·æ±‚ä¸­æ¯ä¸ªå‡½æ•°çš„ CPU æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥å‘ç°å“ªä¸ªå‡½æ•°æ¶ˆè€—çš„ CPU æ—¶é—´æœ€å¤šï¼Œä»¥ä¾¿ä½ æœ‰é’ˆå¯¹æ€§åœ°åšä¼˜åŒ–ã€‚</p><p>å½“ç„¶è¿˜æœ‰ä¸€äº›åŠæ³•ä¹Ÿå¯ä»¥è¿‘ä¼¼åœ°ç»Ÿè®¡ CPU çš„è€—æ—¶ï¼Œä¾‹å¦‚é€šè¿‡ jstack å®šæ—¶åœ°æ‰“å°è°ƒç”¨æ ˆï¼Œå¦‚æœæŸäº›å‡½æ•°è°ƒç”¨é¢‘ç¹æˆ–è€…è€—æ—¶è¾ƒå¤šï¼Œé‚£ä¹ˆé‚£äº›å‡½æ•°å°±ä¼šå¤šæ¬¡å‡ºç°åœ¨ç³»ç»Ÿè°ƒç”¨æ ˆé‡Œï¼Œè¿™æ ·ç›¸å½“äºé‡‡æ ·çš„æ–¹å¼ä¹Ÿèƒ½å¤Ÿå‘ç°è€—æ—¶è¾ƒå¤šçš„å‡½æ•°ã€‚</p><p>è™½è¯´ç§’æ€ç³»ç»Ÿçš„ç“¶é¢ˆå¤§éƒ¨åˆ†åœ¨ CPUï¼Œä½†è¿™å¹¶ä¸è¡¨ç¤ºå…¶ä»–æ–¹é¢å°±ä¸€å®šä¸å‡ºç°ç“¶é¢ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæµ·é‡è¯·æ±‚æ¶Œè¿‡æ¥ï¼Œä½ çš„é¡µé¢åˆæ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆç½‘ç»œå°±æœ‰å¯èƒ½å‡ºç°ç“¶é¢ˆã€‚</p><p>æ€æ ·ç®€å•åœ°åˆ¤æ–­ CPU æ˜¯ä¸æ˜¯ç“¶é¢ˆå‘¢ï¼Ÿä¸€ä¸ªåŠæ³•å°±æ˜¯çœ‹å½“ QPS è¾¾åˆ°æé™æ—¶ï¼Œä½ çš„æœåŠ¡å™¨çš„ CPU ä½¿ç”¨ç‡æ˜¯ä¸æ˜¯è¶…è¿‡äº† 95%ï¼Œå¦‚æœæ²¡æœ‰è¶…è¿‡ï¼Œé‚£ä¹ˆè¡¨ç¤º CPU è¿˜æœ‰æå‡çš„ç©ºé—´ï¼Œè¦ä¹ˆæ˜¯æœ‰é”é™åˆ¶ï¼Œè¦ä¹ˆæ˜¯æœ‰è¿‡å¤šçš„æœ¬åœ° I/O ç­‰å¾…å‘ç”Ÿã€‚</p><h2 id="7-3-å¦‚ä½•ä¼˜åŒ–ç³»ç»Ÿ"><a href="#7-3-å¦‚ä½•ä¼˜åŒ–ç³»ç»Ÿ" class="headerlink" title="7.3 å¦‚ä½•ä¼˜åŒ–ç³»ç»Ÿ"></a>7.3 å¦‚ä½•ä¼˜åŒ–ç³»ç»Ÿ</h2><p>é’ˆå¯¹Javaæ¥è¯´çš„ï¼š</p><h3 id="7-3-1-å‡å°‘ç¼–ç "><a href="#7-3-1-å‡å°‘ç¼–ç " class="headerlink" title="7.3.1 å‡å°‘ç¼–ç "></a>7.3.1 å‡å°‘ç¼–ç </h3><p>Javaçš„ç¼–ç è¿è¡Œæ¯”è¾ƒæ…¢ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œåªè¦æ¶‰åŠå­—ç¬¦ä¸²çš„æ“ä½œéƒ½ä¼šæ¯”è¾ƒæ¶ˆè€—CPUèµ„æºï¼Œä¸ç®¡æ˜¯ç£ç›˜IOè¿˜æ˜¯ç½‘ç»œIOï¼Œå› ä¸ºéƒ½éœ€è¦å°†å­—ç¬¦è½¬æ¢æˆå­—èŠ‚ï¼Œè¿™ä¸ªè½¬æ¢å¿…é¡»ç¼–ç ã€‚</p><p>æ¯ä¸ªå­—ç¬¦çš„ç¼–ç éƒ½éœ€è¦æŸ¥è¡¨ï¼Œè€Œè¿™ç§æŸ¥è¡¨çš„æ“ä½œéå¸¸è€—èµ„æºï¼Œæ‰€ä»¥å‡å°‘å­—ç¬¦åˆ°å­—èŠ‚æˆ–è€…ç›¸åçš„è½¬æ¢ã€å‡å°‘å­—ç¬¦ç¼–ç ä¼šéå¸¸æœ‰æˆæ•ˆã€‚å‡å°‘ç¼–ç å°±å¯ä»¥å¤§å¤§æå‡æ€§èƒ½ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å‡å°‘ç¼–ç å‘¢ï¼Ÿä¾‹å¦‚ï¼Œç½‘é¡µè¾“å‡ºæ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œæµè¾“å‡ºçš„ï¼Œå³ç”¨ resp.getOutputStream() å‡½æ•°å†™æ•°æ®ï¼ŒæŠŠä¸€äº›é™æ€çš„æ•°æ®æå‰è½¬åŒ–æˆå­—èŠ‚ï¼Œç­‰åˆ°çœŸæ­£å¾€å¤–å†™çš„æ—¶å€™å†ç›´æ¥ç”¨ OutputStream() å‡½æ•°å†™ï¼Œå°±å¯ä»¥å‡å°‘é™æ€æ•°æ®çš„ç¼–ç è½¬æ¢ã€‚</p><h3 id="7-3-2-å‡å°‘åºåˆ—åŒ–"><a href="#7-3-2-å‡å°‘åºåˆ—åŒ–" class="headerlink" title="7.3.2 å‡å°‘åºåˆ—åŒ–"></a>7.3.2 å‡å°‘åºåˆ—åŒ–</h3><p>åºåˆ—åŒ–ä¹Ÿæ˜¯Javaæ€§èƒ½çš„ä¸€å¤§å¤©æ•Œï¼Œå‡å°‘Javaå½“ä¸­çš„åºåˆ—åŒ–æ“ä½œä¹Ÿèƒ½å¤§å¤§æå‡æ€§èƒ½ã€‚åˆå› ä¸ºåºåˆ—åŒ–å¾€å¾€æ˜¯å’Œç¼–ç åŒæ—¶å‘ç”Ÿçš„ï¼Œæ‰€ä»¥å‡å°‘åºåˆ—åŒ–ä¹Ÿå°±å‡å°‘äº†ç¼–ç ã€‚</p><p>åºåˆ—åŒ–å¤§éƒ¨åˆ†æ˜¯åœ¨ RPC ä¸­å‘ç”Ÿçš„ï¼Œå› æ­¤é¿å…æˆ–è€…å‡å°‘ RPC å°±å¯ä»¥å‡å°‘åºåˆ—åŒ–ï¼Œå½“ç„¶å½“å‰çš„åºåˆ—åŒ–åè®®ä¹Ÿå·²ç»åšäº†å¾ˆå¤šä¼˜åŒ–æ¥æå‡æ€§èƒ½ã€‚æœ‰ä¸€ç§æ–°çš„æ–¹æ¡ˆï¼Œå°±æ˜¯å¯ä»¥å°†å¤šä¸ªå…³è”æ€§æ¯”è¾ƒå¼ºçš„åº”ç”¨è¿›è¡Œâ€œåˆå¹¶éƒ¨ç½²â€ï¼Œè€Œå‡å°‘ä¸åŒåº”ç”¨ä¹‹é—´çš„ RPC ä¹Ÿå¯ä»¥å‡å°‘åºåˆ—åŒ–çš„æ¶ˆè€—ã€‚</p><p>æ‰€è°“â€œåˆå¹¶éƒ¨ç½²â€ï¼Œå°±æ˜¯æŠŠä¸¤ä¸ªåŸæœ¬åœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒåº”ç”¨åˆå¹¶éƒ¨ç½²åˆ°ä¸€å°æœºå™¨ä¸Šï¼Œå½“ç„¶ä¸ä»…ä»…æ˜¯éƒ¨ç½²åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œè¿˜è¦åœ¨åŒä¸€ä¸ª Tomcat å®¹å™¨ä¸­ï¼Œä¸”ä¸èƒ½èµ°æœ¬æœºçš„ Socketï¼Œè¿™æ ·æ‰èƒ½é¿å…åºåˆ—åŒ–çš„äº§ç”Ÿã€‚</p><h3 id="7-3-3-Java-ç§’æ€åœºæ™¯çš„é’ˆå¯¹æ€§ä¼˜åŒ–"><a href="#7-3-3-Java-ç§’æ€åœºæ™¯çš„é’ˆå¯¹æ€§ä¼˜åŒ–" class="headerlink" title="7.3.3 Java ç§’æ€åœºæ™¯çš„é’ˆå¯¹æ€§ä¼˜åŒ–"></a>7.3.3 Java ç§’æ€åœºæ™¯çš„é’ˆå¯¹æ€§ä¼˜åŒ–</h3><p>Java å’Œé€šç”¨çš„ Web æœåŠ¡å™¨ï¼ˆå¦‚ Nginx æˆ– Apache æœåŠ¡å™¨ï¼‰ç›¸æ¯”ï¼Œåœ¨å¤„ç†å¤§å¹¶å‘çš„ HTTP è¯·æ±‚æ—¶è¦å¼±ä¸€ç‚¹ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šå¯¹å¤§æµé‡çš„ Web ç³»ç»Ÿåšé™æ€åŒ–æ”¹é€ ï¼Œè®©å¤§éƒ¨åˆ†è¯·æ±‚å’Œæ•°æ®ç›´æ¥åœ¨ Nginx æœåŠ¡å™¨æˆ–è€… Web ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚ Varnishã€Squid ç­‰ï¼‰ä¸Šç›´æ¥è¿”å›ï¼ˆè¿™æ ·å¯ä»¥å‡å°‘æ•°æ®çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼‰ï¼Œè€Œ Java å±‚åªéœ€å¤„ç†å°‘é‡æ•°æ®çš„åŠ¨æ€è¯·æ±‚ã€‚é’ˆå¯¹è¿™äº›è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ‰‹æ®µè¿›è¡Œä¼˜åŒ–ï¼š</p><ul><li>ç›´æ¥ä½¿ç”¨ Servlet å¤„ç†è¯·æ±‚ã€‚é¿å…ä½¿ç”¨ä¼ ç»Ÿçš„ MVC æ¡†æ¶ï¼Œè¿™æ ·å¯ä»¥ç»•è¿‡ä¸€å¤§å †å¤æ‚ä¸”ç”¨å¤„ä¸å¤§çš„å¤„ç†é€»è¾‘ï¼ŒèŠ‚çœ 1ms æ—¶é—´ï¼ˆå…·ä½“å–å†³äºä½ å¯¹ MVC æ¡†æ¶çš„ä¾èµ–ç¨‹åº¦ï¼‰ã€‚</li><li>ç›´æ¥è¾“å‡ºæµæ•°æ®ã€‚ä½¿ç”¨ resp.getOutputStream() è€Œä¸æ˜¯ resp.getWriter() å‡½æ•°ï¼Œå¯ä»¥çœæ‰ä¸€äº›ä¸å˜å­—ç¬¦æ•°æ®çš„ç¼–ç ï¼Œä»è€Œæå‡æ€§èƒ½ï¼›æ•°æ®è¾“å‡ºæ—¶æ¨èä½¿ç”¨ JSON è€Œä¸æ˜¯æ¨¡æ¿å¼•æ“ï¼ˆä¸€èˆ¬éƒ½æ˜¯è§£é‡Šæ‰§è¡Œï¼‰æ¥è¾“å‡ºé¡µé¢ã€‚</li></ul><h3 id="7-3-4-å¹¶å‘è¯»ä¼˜åŒ–"><a href="#7-3-4-å¹¶å‘è¯»ä¼˜åŒ–" class="headerlink" title="7.3.4 å¹¶å‘è¯»ä¼˜åŒ–"></a>7.3.4 å¹¶å‘è¯»ä¼˜åŒ–</h3><p>ä¹Ÿè®¸æœ‰è¯»è€…ä¼šè§‰å¾—è¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“è§£å†³ï¼Œæ— éå°±æ˜¯æ”¾åˆ° Tair ç¼“å­˜é‡Œé¢ã€‚é›†ä¸­å¼ç¼“å­˜ä¸ºäº†ä¿è¯å‘½ä¸­ç‡ä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨ä¸€è‡´æ€§ Hashï¼Œæ‰€ä»¥åŒä¸€ä¸ª key ä¼šè½åˆ°åŒä¸€å°æœºå™¨ä¸Šã€‚è™½ç„¶å•å°ç¼“å­˜æœºå™¨ä¹Ÿèƒ½æ”¯æ’‘ 30w/s çš„è¯·æ±‚ï¼Œä½†è¿˜æ˜¯è¿œä¸è¶³ä»¥åº”å¯¹åƒâ€œå¤§ç§’â€è¿™ç§çº§åˆ«çš„çƒ­ç‚¹å•†å“ã€‚é‚£ä¹ˆï¼Œè¯¥å¦‚ä½•å½»åº•è§£å†³å•ç‚¹çš„ç“¶é¢ˆå‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯é‡‡ç”¨åº”ç”¨å±‚çš„ LocalCacheï¼Œå³åœ¨ç§’æ€ç³»ç»Ÿçš„å•æœºä¸Šç¼“å­˜å•†å“ç›¸å…³çš„æ•°æ®ã€‚</p><p>é‚£ä¹ˆï¼Œåˆå¦‚ä½•ç¼“å­˜ï¼ˆCacheï¼‰æ•°æ®å‘¢ï¼Ÿä½ éœ€è¦åˆ’åˆ†æˆåŠ¨æ€æ•°æ®å’Œé™æ€æ•°æ®åˆ†åˆ«è¿›è¡Œå¤„ç†ï¼š</p><ul><li>åƒå•†å“ä¸­çš„â€œæ ‡é¢˜â€å’Œâ€œæè¿°â€è¿™äº›æœ¬èº«ä¸å˜çš„æ•°æ®ï¼Œä¼šåœ¨ç§’æ€å¼€å§‹ä¹‹å‰å…¨é‡æ¨é€åˆ°ç§’æ€æœºå™¨ä¸Šï¼Œå¹¶ä¸€ç›´ç¼“å­˜åˆ°ç§’æ€ç»“æŸï¼›</li><li>åƒåº“å­˜è¿™ç±»åŠ¨æ€æ•°æ®ï¼Œä¼šé‡‡ç”¨â€œè¢«åŠ¨å¤±æ•ˆâ€çš„æ–¹å¼ç¼“å­˜ä¸€å®šæ—¶é—´ï¼ˆä¸€èˆ¬æ˜¯æ•°ç§’ï¼‰ï¼Œå¤±æ•ˆåå†å»ç¼“å­˜æ‹‰å–æœ€æ–°çš„æ•°æ®ã€‚</li></ul><p>è¿˜æœ‰å…³äºä¸€è‡´æ€§çš„é—®é¢˜ï¼Œå› ä¸ºåº“å­˜æ˜¯åœ¨ä¸æ–­æ›´æ–°çš„ï¼Œè¿™å°±è¦ç”¨åˆ°å‰é¢ä»‹ç»çš„è¯»æ•°æ®çš„åˆ†å±‚æ ¡éªŒåŸåˆ™äº†ï¼Œè¯»çš„åœºæ™¯å¯ä»¥å…è®¸ä¸€å®šçš„è„æ•°æ®ï¼Œå› ä¸ºè¿™é‡Œçš„è¯¯åˆ¤åªä¼šå¯¼è‡´å°‘é‡åŸæœ¬æ— åº“å­˜çš„ä¸‹å•è¯·æ±‚è¢«è¯¯è®¤ä¸ºæœ‰åº“å­˜ï¼Œå¯ä»¥ç­‰åˆ°çœŸæ­£å†™æ•°æ®æ—¶å†ä¿è¯æœ€ç»ˆçš„ä¸€è‡´æ€§ï¼Œé€šè¿‡åœ¨æ•°æ®çš„é«˜å¯ç”¨æ€§å’Œä¸€è‡´æ€§ä¹‹é—´çš„å¹³è¡¡ï¼Œæ¥è§£å†³é«˜å¹¶å‘çš„æ•°æ®è¯»å–é—®é¢˜ã€‚</p><h1 id="8-å‡åº“å­˜è®¾è®¡çš„æ ¸å¿ƒé€»è¾‘"><a href="#8-å‡åº“å­˜è®¾è®¡çš„æ ¸å¿ƒé€»è¾‘" class="headerlink" title="8. å‡åº“å­˜è®¾è®¡çš„æ ¸å¿ƒé€»è¾‘"></a>8. å‡åº“å­˜è®¾è®¡çš„æ ¸å¿ƒé€»è¾‘</h1><p>ä¸è¶…å–æ˜¯ç§’æ€ç³»ç»Ÿçš„å‰æã€‚å‡åº“å­˜åˆ°åº•åº”è¯¥æ˜¯åœ¨ä¸‹å•é˜¶æ®µè¿˜æ˜¯ä»˜æ¬¾é˜¶æ®µå‘¢ï¼Ÿ </p><h2 id="8-1-å‡åº“å­˜çš„æ–¹å¼"><a href="#8-1-å‡åº“å­˜çš„æ–¹å¼" class="headerlink" title="8.1 å‡åº“å­˜çš„æ–¹å¼"></a>8.1 å‡åº“å­˜çš„æ–¹å¼</h2><h3 id="8-1-1-ä¸‹å•å‡åº“å­˜"><a href="#8-1-1-ä¸‹å•å‡åº“å­˜" class="headerlink" title="8.1.1 ä¸‹å•å‡åº“å­˜"></a>8.1.1 ä¸‹å•å‡åº“å­˜</h3><p>å³å½“ä¹°å®¶ä¸‹å•ä¹‹åï¼Œåœ¨å•†å“çš„æ€»åº“å­˜ä¸­å‡å»ä¹°å®¶è´­ä¹°çš„æ•°é‡ã€‚è¿™ç§æ–¹å¼æ§åˆ¶æœ€ç²¾ç¡®ï¼Œä¸‹å•æ—¶ç›´æ¥é€šè¿‡æ•°æ®åº“çš„äº‹åŠ¡æœºåˆ¶æ§åˆ¶å•†å“åº“å­˜ï¼Œè¿™æ ·ä¸€å®šä¸ä¼šå‡ºç°è¶…å–çš„ç°è±¡ã€‚ä½†æ˜¯æœ‰äº›äººä¸‹å®Œå•ä»¥åå¹¶ä¸ä¼šä»˜æ¬¾ã€‚</p><h3 id="8-1-2-ä»˜æ¬¾å‡åº“å­˜"><a href="#8-1-2-ä»˜æ¬¾å‡åº“å­˜" class="headerlink" title="8.1.2 ä»˜æ¬¾å‡åº“å­˜"></a>8.1.2 ä»˜æ¬¾å‡åº“å­˜</h3><p>å³ä¹°å®¶ä¸‹å•åï¼Œå¹¶ä¸ç«‹å³å‡åº“å­˜ï¼Œè€Œæ˜¯ç­‰åˆ°æœ‰ç”¨æˆ·ä»˜æ¬¾åæ‰çœŸæ­£å‡åº“å­˜ï¼Œå¦åˆ™åº“å­˜ä¸€ç›´ä¿ç•™ç»™å…¶ä»–ä¹°å®¶ã€‚ä½†å› ä¸ºä»˜æ¬¾æ—¶æ‰å‡åº“å­˜ï¼Œå¦‚æœå¹¶å‘æ¯”è¾ƒé«˜ï¼Œæœ‰å¯èƒ½å‡ºç°ä¹°å®¶ä¸‹å•åä»˜ä¸äº†æ¬¾çš„æƒ…å†µï¼Œå› ä¸ºå¯èƒ½å•†å“å·²ç»è¢«å…¶ä»–äººä¹°èµ°äº†ã€‚</p><h3 id="8-1-3-é¢„æ‰£åº“å­˜"><a href="#8-1-3-é¢„æ‰£åº“å­˜" class="headerlink" title="8.1.3 é¢„æ‰£åº“å­˜"></a>8.1.3 é¢„æ‰£åº“å­˜</h3><p>è¿™ç§æ–¹å¼ç›¸å¯¹å¤æ‚ä¸€äº›ï¼Œä¹°å®¶ä¸‹å•åï¼Œåº“å­˜ä¸ºå…¶ä¿ç•™ä¸€å®šçš„æ—¶é—´ï¼ˆå¦‚ 10 åˆ†é’Ÿï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œåº“å­˜å°†ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé‡Šæ”¾åå…¶ä»–ä¹°å®¶å°±å¯ä»¥ç»§ç»­è´­ä¹°ã€‚åœ¨ä¹°å®¶ä»˜æ¬¾å‰ï¼Œç³»ç»Ÿä¼šæ ¡éªŒè¯¥è®¢å•çš„åº“å­˜æ˜¯å¦è¿˜æœ‰ä¿ç•™ï¼šå¦‚æœæ²¡æœ‰ä¿ç•™ï¼Œåˆ™å†æ¬¡å°è¯•é¢„æ‰£ï¼›å¦‚æœåº“å­˜ä¸è¶³ï¼ˆä¹Ÿå°±æ˜¯é¢„æ‰£å¤±è´¥ï¼‰åˆ™ä¸å…è®¸ç»§ç»­ä»˜æ¬¾ï¼›å¦‚æœé¢„æ‰£æˆåŠŸï¼Œåˆ™å®Œæˆä»˜æ¬¾å¹¶å®é™…åœ°å‡å»åº“å­˜ã€‚</p><h2 id="8-2-å¯èƒ½å­˜åœ¨çš„é—®é¢˜"><a href="#8-2-å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="8.2 å¯èƒ½å­˜åœ¨çš„é—®é¢˜"></a>8.2 å¯èƒ½å­˜åœ¨çš„é—®é¢˜</h2><p>å‡å¦‚æˆ‘ä»¬é‡‡ç”¨â€œä¸‹å•å‡åº“å­˜â€çš„æ–¹å¼ï¼Œå³ç”¨æˆ·ä¸‹å•åå°±å‡å»åº“å­˜ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¹°å®¶ä¸‹å•åä»˜æ¬¾çš„æ¦‚ç‡ä¼šå¾ˆé«˜ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜ã€‚ä½†æ˜¯æœ‰ä¸€ç§åœºæ™¯ä¾‹å¤–ï¼Œå°±æ˜¯å½“å–å®¶å‚åŠ æŸä¸ªæ´»åŠ¨æ—¶ï¼Œæ­¤æ—¶æ´»åŠ¨çš„æœ‰æ•ˆæ—¶é—´æ˜¯å•†å“çš„é»„é‡‘å”®å–æ—¶é—´ï¼Œå¦‚æœæœ‰ç«äº‰å¯¹æ‰‹é€šè¿‡æ¶æ„ä¸‹å•çš„æ–¹å¼å°†è¯¥å–å®¶çš„å•†å“å…¨éƒ¨ä¸‹å•ï¼Œè®©è¿™æ¬¾å•†å“çš„åº“å­˜å‡ä¸ºé›¶ï¼Œé‚£ä¹ˆè¿™æ¬¾å•†å“å°±ä¸èƒ½æ­£å¸¸å”®å–äº†ã€‚è¦çŸ¥é“ï¼Œè¿™äº›æ¶æ„ä¸‹å•çš„äººæ˜¯ä¸ä¼šçœŸæ­£ä»˜æ¬¾çš„ï¼Œè¿™æ­£æ˜¯â€œä¸‹å•å‡åº“å­˜â€æ–¹å¼çš„ä¸è¶³ä¹‹å¤„ã€‚</p><p>æ—¢ç„¶â€œä¸‹å•å‡åº“å­˜â€å¯èƒ½å¯¼è‡´æ¶æ„ä¸‹å•ï¼Œä»è€Œå½±å“å–å®¶çš„å•†å“é”€å”®ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è§£å†³å‘¢ï¼Ÿä½ å¯èƒ½ä¼šæƒ³ï¼Œé‡‡ç”¨â€œä»˜æ¬¾å‡åº“å­˜â€çš„æ–¹å¼æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Ÿçš„ç¡®å¯ä»¥ã€‚ä½†æ˜¯ï¼Œâ€œä»˜æ¬¾å‡åº“å­˜â€åˆä¼šå¯¼è‡´å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šåº“å­˜è¶…å–ã€‚</p><p>å‡å¦‚æœ‰ 100 ä»¶å•†å“ï¼Œå°±å¯èƒ½å‡ºç° 300 äººä¸‹å•æˆåŠŸçš„æƒ…å†µï¼Œå› ä¸ºä¸‹å•æ—¶ä¸ä¼šå‡åº“å­˜ï¼Œæ‰€ä»¥ä¹Ÿå°±å¯èƒ½å‡ºç°ä¸‹å•æˆåŠŸæ•°è¿œè¿œè¶…è¿‡çœŸæ­£åº“å­˜æ•°çš„æƒ…å†µï¼Œè¿™å°¤å…¶ä¼šå‘ç”Ÿåœ¨åšæ´»åŠ¨çš„çƒ­é—¨å•†å“ä¸Šã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¼šå¯¼è‡´å¾ˆå¤šä¹°å®¶ä¸‹å•æˆåŠŸä½†æ˜¯ä»˜ä¸äº†æ¬¾ï¼Œä¹°å®¶çš„è´­ç‰©ä½“éªŒè‡ªç„¶æ¯”è¾ƒå·®ã€‚</p><p>é‚£ä¹ˆï¼Œæ—¢ç„¶â€œä¸‹å•å‡åº“å­˜â€å’Œâ€œä»˜æ¬¾å‡åº“å­˜â€éƒ½æœ‰ç¼ºç‚¹ï¼Œæˆ‘ä»¬èƒ½å¦æŠŠä¸¤è€…ç›¸ç»“åˆï¼Œå°†ä¸¤æ¬¡æ“ä½œè¿›è¡Œå‰åå…³è”èµ·æ¥ï¼Œä¸‹å•æ—¶å…ˆé¢„æ‰£ï¼Œåœ¨è§„å®šæ—¶é—´å†…ä¸ä»˜æ¬¾å†é‡Šæ”¾åº“å­˜ï¼Œå³é‡‡ç”¨â€œé¢„æ‰£åº“å­˜â€è¿™ç§æ–¹å¼å‘¢ï¼Ÿ</p><p>è¿™ç§æ–¹æ¡ˆç¡®å®å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£ä¸Šé¢çš„é—®é¢˜ã€‚ä½†æ˜¯å¦å°±å½»åº•è§£å†³äº†å‘¢ï¼Ÿå…¶å®æ²¡æœ‰ï¼é’ˆå¯¹æ¶æ„ä¸‹å•è¿™ç§æƒ…å†µï¼Œè™½ç„¶æŠŠæœ‰æ•ˆçš„ä»˜æ¬¾æ—¶é—´è®¾ç½®ä¸º 10 åˆ†é’Ÿï¼Œä½†æ˜¯æ¶æ„ä¹°å®¶å®Œå…¨å¯ä»¥åœ¨ 10 åˆ†é’Ÿåå†æ¬¡ä¸‹å•ï¼Œæˆ–è€…é‡‡ç”¨ä¸€æ¬¡ä¸‹å•å¾ˆå¤šä»¶çš„æ–¹å¼æŠŠåº“å­˜å‡å®Œã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œè§£å†³åŠæ³•è¿˜æ˜¯è¦ç»“åˆå®‰å…¨å’Œåä½œå¼Šçš„æªæ–½æ¥åˆ¶æ­¢ã€‚</p><p>ä¾‹å¦‚ï¼Œç»™ç»å¸¸ä¸‹å•ä¸ä»˜æ¬¾çš„ä¹°å®¶è¿›è¡Œè¯†åˆ«æ‰“æ ‡ï¼ˆå¯ä»¥åœ¨è¢«æ‰“æ ‡çš„ä¹°å®¶ä¸‹å•æ—¶ä¸å‡åº“å­˜ï¼‰ã€ç»™æŸäº›ç±»ç›®è®¾ç½®æœ€å¤§è´­ä¹°ä»¶æ•°ï¼ˆä¾‹å¦‚ï¼Œå‚åŠ æ´»åŠ¨çš„å•†å“ä¸€äººæœ€å¤šåªèƒ½ä¹° 3 ä»¶ï¼‰ï¼Œä»¥åŠå¯¹é‡å¤ä¸‹å•ä¸ä»˜æ¬¾çš„æ“ä½œè¿›è¡Œæ¬¡æ•°é™åˆ¶ç­‰ã€‚</p><p>é’ˆå¯¹â€œåº“å­˜è¶…å–â€è¿™ç§æƒ…å†µï¼Œåœ¨ 10 åˆ†é’Ÿæ—¶é—´å†…ä¸‹å•çš„æ•°é‡ä»ç„¶æœ‰å¯èƒ½è¶…è¿‡åº“å­˜æ•°é‡ï¼Œé‡åˆ°è¿™ç§æƒ…å†µæˆ‘ä»¬åªèƒ½åŒºåˆ«å¯¹å¾…ï¼šå¯¹æ™®é€šçš„å•†å“ä¸‹å•æ•°é‡è¶…è¿‡åº“å­˜æ•°é‡çš„æƒ…å†µï¼Œå¯ä»¥é€šè¿‡è¡¥è´§æ¥è§£å†³ï¼›ä½†æ˜¯æœ‰äº›å–å®¶å®Œå…¨ä¸å…è®¸åº“å­˜ä¸ºè´Ÿæ•°çš„æƒ…å†µï¼Œé‚£åªèƒ½åœ¨ä¹°å®¶ä»˜æ¬¾æ—¶æç¤ºåº“å­˜ä¸è¶³ã€‚</p><h2 id="8-3-å¤§å‹ç§’æ€ä¸­å¦‚ä½•å‡åº“å­˜"><a href="#8-3-å¤§å‹ç§’æ€ä¸­å¦‚ä½•å‡åº“å­˜" class="headerlink" title="8.3 å¤§å‹ç§’æ€ä¸­å¦‚ä½•å‡åº“å­˜"></a>8.3 å¤§å‹ç§’æ€ä¸­å¦‚ä½•å‡åº“å­˜</h2><p>å¯¹äºä¸€èˆ¬ä¸šåŠ¡ç³»ç»Ÿè€Œè¨€ï¼Œä¸€èˆ¬æ˜¯é¢„æ‰£åº“å­˜çš„æ–¹æ¡ˆï¼Œè¶…å‡ºæœ‰æ•ˆä»˜æ¬¾æ—¶é—´è®¢å•å°±ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚è€Œå¯¹äºç§’æ€åœºæ™¯ï¼Œä¸€èˆ¬é‡‡ç”¨ä¸‹å•å‡åº“å­˜ã€‚</p><p>â€œä¸‹å•å‡åº“å­˜â€åœ¨æ•°æ®ä¸€è‡´æ€§ä¸Šï¼Œä¸»è¦å°±æ˜¯ä¿è¯å¤§å¹¶å‘è¯·æ±‚æ—¶åº“å­˜æ•°æ®ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œä¹Ÿå°±æ˜¯è¦ä¿è¯æ•°æ®åº“ä¸­çš„åº“å­˜å­—æ®µå€¼ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œä¸€èˆ¬æˆ‘ä»¬æœ‰å¤šç§è§£å†³æ–¹æ¡ˆï¼šä¸€ç§æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­é€šè¿‡äº‹åŠ¡æ¥åˆ¤æ–­ï¼Œå³ä¿è¯å‡ååº“å­˜ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œå¦åˆ™å°±å›æ»šï¼›å¦ä¸€ç§åŠæ³•æ˜¯ç›´æ¥è®¾ç½®æ•°æ®åº“çš„å­—æ®µæ•°æ®ä¸ºæ— ç¬¦å·æ•´æ•°ï¼Œè¿™æ ·å‡ååº“å­˜å­—æ®µå€¼å°äºé›¶æ—¶ä¼šç›´æ¥æ‰§è¡Œ SQL è¯­å¥æ¥æŠ¥é”™ï¼›å†æœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨ CASE WHEN åˆ¤æ–­è¯­å¥ï¼Œä¾‹å¦‚è¿™æ ·çš„ SQL è¯­å¥ï¼š</p><pre><code>UPDATE item SET inventory = CASE WHEN inventory &gt;= xxx THEN inventory-xxx ELSE inventory END</code></pre><p>ç§’æ€å•†å“å’Œæ™®é€šå•†å“çš„å‡åº“å­˜è¿˜æ˜¯æœ‰äº›å·®å¼‚çš„ï¼Œä¾‹å¦‚å•†å“æ•°é‡æ¯”è¾ƒå°‘ï¼Œäº¤æ˜“æ—¶é—´æ®µä¹Ÿæ¯”è¾ƒçŸ­ï¼Œå› æ­¤è¿™é‡Œæœ‰ä¸€ä¸ªå¤§èƒ†çš„å‡è®¾ï¼Œå³èƒ½å¦æŠŠç§’æ€å•†å“å‡åº“å­˜ç›´æ¥æ”¾åˆ°ç¼“å­˜ç³»ç»Ÿä¸­å®ç°ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åœ¨ç¼“å­˜ä¸­å‡åº“å­˜æˆ–è€…åœ¨ä¸€ä¸ªå¸¦æœ‰æŒä¹…åŒ–åŠŸèƒ½çš„ç¼“å­˜ç³»ç»Ÿï¼ˆå¦‚ Redisï¼‰ä¸­å®Œæˆå‘¢ï¼Ÿ</p><p>å¦‚æœä½ çš„ç§’æ€å•†å“çš„å‡åº“å­˜é€»è¾‘éå¸¸å•ä¸€ï¼Œæ¯”å¦‚æ²¡æœ‰å¤æ‚çš„ SKU åº“å­˜å’Œæ€»åº“å­˜è¿™ç§è”åŠ¨å…³ç³»çš„è¯ï¼Œæˆ‘è§‰å¾—å®Œå…¨å¯ä»¥ã€‚ä½†æ˜¯å¦‚æœæœ‰æ¯”è¾ƒå¤æ‚çš„å‡åº“å­˜é€»è¾‘ï¼Œæˆ–è€…éœ€è¦ä½¿ç”¨äº‹åŠ¡ï¼Œä½ è¿˜æ˜¯å¿…é¡»åœ¨æ•°æ®åº“ä¸­å®Œæˆå‡åº“å­˜ã€‚</p><p>ç”±äº MySQL å­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹ï¼ŒåŒä¸€æ•°æ®åœ¨æ•°æ®åº“é‡Œè‚¯å®šæ˜¯ä¸€è¡Œå­˜å‚¨ï¼ˆMySQLï¼‰ï¼Œå› æ­¤ä¼šæœ‰å¤§é‡çº¿ç¨‹æ¥ç«äº‰ InnoDB è¡Œé”ï¼Œè€Œå¹¶å‘åº¦è¶Šé«˜æ—¶ç­‰å¾…çº¿ç¨‹ä¼šè¶Šå¤šï¼ŒTPSï¼ˆTransaction Per Secondï¼Œå³æ¯ç§’å¤„ç†çš„æ¶ˆæ¯æ•°ï¼‰ä¼šä¸‹é™ï¼Œå“åº”æ—¶é—´ï¼ˆRTï¼‰ä¼šä¸Šå‡ï¼Œæ•°æ®åº“çš„ååé‡å°±ä¼šä¸¥é‡å—å½±å“ã€‚</p><p>è¿™å°±å¯èƒ½å¼•å‘ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å•ä¸ªçƒ­ç‚¹å•†å“ä¼šå½±å“æ•´ä¸ªæ•°æ®åº“çš„æ€§èƒ½ï¼Œ å¯¼è‡´ 0.01% çš„å•†å“å½±å“ 99.99% çš„å•†å“çš„å”®å–ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æ„¿æ„çœ‹åˆ°çš„æƒ…å†µã€‚ä¸€ä¸ªè§£å†³æ€è·¯æ˜¯éµå¾ªå‰é¢ä»‹ç»çš„åŸåˆ™è¿›è¡Œéš”ç¦»ï¼ŒæŠŠçƒ­ç‚¹å•†å“æ”¾åˆ°å•ç‹¬çš„çƒ­ç‚¹åº“ä¸­ã€‚ä½†æ˜¯è¿™æ— ç–‘ä¼šå¸¦æ¥ç»´æŠ¤ä¸Šçš„éº»çƒ¦ï¼Œæ¯”å¦‚è¦åšçƒ­ç‚¹æ•°æ®çš„åŠ¨æ€è¿ç§»ä»¥åŠå•ç‹¬çš„æ•°æ®åº“ç­‰ã€‚</p><p>è€Œåˆ†ç¦»çƒ­ç‚¹å•†å“åˆ°å•ç‹¬çš„æ•°æ®åº“è¿˜æ˜¯æ²¡æœ‰è§£å†³å¹¶å‘é”çš„é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¦è§£å†³å¹¶å‘é”çš„é—®é¢˜ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š</p><ol><li>åº”ç”¨å±‚æ’é˜Ÿ</li></ol><p>æŒ‰ç…§å•†å“ç»´åº¦è®¾ç½®é˜Ÿåˆ—é¡ºåºæ‰§è¡Œï¼Œè¿™æ ·èƒ½å‡å°‘åŒä¸€å°æœºå™¨å¯¹æ•°æ®åº“åŒä¸€è¡Œè®°å½•è¿›è¡Œæ“ä½œçš„å¹¶å‘åº¦ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ§åˆ¶å•ä¸ªå•†å“å ç”¨æ•°æ®åº“è¿æ¥çš„æ•°é‡ï¼Œé˜²æ­¢çƒ­ç‚¹å•†å“å ç”¨å¤ªå¤šçš„æ•°æ®åº“è¿æ¥ã€‚</p><ol start="2"><li>æ•°æ®åº“æ’é˜Ÿ</li></ol><p>åº”ç”¨å±‚åªèƒ½åšåˆ°å•æœºçš„æ’é˜Ÿï¼Œä½†æ˜¯åº”ç”¨æœºå™¨æ•°æœ¬èº«å¾ˆå¤šï¼Œè¿™ç§æ’é˜Ÿæ–¹å¼æ§åˆ¶å¹¶å‘çš„èƒ½åŠ›ä»ç„¶æœ‰é™ï¼Œæ‰€ä»¥å¦‚æœèƒ½åœ¨æ•°æ®åº“å±‚åšå…¨å±€æ’é˜Ÿæ˜¯æœ€ç†æƒ³çš„ã€‚é˜¿é‡Œçš„æ•°æ®åº“å›¢é˜Ÿå¼€å‘äº†é’ˆå¯¹è¿™ç§ MySQL çš„ InnoDB å±‚ä¸Šçš„è¡¥ä¸ç¨‹åºï¼ˆpatchï¼‰ï¼Œå¯ä»¥åœ¨æ•°æ®åº“å±‚ä¸Šå¯¹å•è¡Œè®°å½•åšåˆ°å¹¶å‘æ’é˜Ÿã€‚</p><h1 id="9-å¦‚ä½•è®¾è®¡å…œåº•æ–¹æ¡ˆï¼Ÿ"><a href="#9-å¦‚ä½•è®¾è®¡å…œåº•æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="9. å¦‚ä½•è®¾è®¡å…œåº•æ–¹æ¡ˆï¼Ÿ"></a>9. å¦‚ä½•è®¾è®¡å…œåº•æ–¹æ¡ˆï¼Ÿ</h1><h2 id="9-1-é«˜å¯ç”¨å»ºè®¾åº”è¯¥ä»å“ªé‡Œç€æ‰‹ï¼Ÿ"><a href="#9-1-é«˜å¯ç”¨å»ºè®¾åº”è¯¥ä»å“ªé‡Œç€æ‰‹ï¼Ÿ" class="headerlink" title="9.1 é«˜å¯ç”¨å»ºè®¾åº”è¯¥ä»å“ªé‡Œç€æ‰‹ï¼Ÿ"></a>9.1 é«˜å¯ç”¨å»ºè®¾åº”è¯¥ä»å“ªé‡Œç€æ‰‹ï¼Ÿ</h2><p><img src="https://i.loli.net/2020/02/03/pJX2oIyCGUVY7H5.jpg" alt="fig10.jpg"></p><ol><li>æ¶æ„é˜¶æ®µ - è€ƒè™‘ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§ï¼Œè¦é¿å…å‡ºç°å•ç‚¹é—®é¢˜ã€‚ä¾‹å¦‚å¤šæœºæˆ¿å•å…ƒåŒ–éƒ¨ç½²ï¼Œå³ä½¿æŸä¸ªåŸå¸‚çš„æŸä¸ªæœºæˆ¿å‡ºç°æ•´ä½“æ•…éšœï¼Œä»ç„¶ä¸ä¼šå½±å“æ•´ä½“ç½‘ç«™çš„è¿è½¬ã€‚</li><li>ç¼–ç é˜¶æ®µ - ä¿è¯ä»£ç çš„å¥å£®æ€§ï¼Œä¾‹å¦‚æ¶‰åŠåˆ°è¿œç¨‹è°ƒç”¨çš„é—®é¢˜çš„æ—¶å€™ï¼Œè¦è®¾ç½®åˆç†çš„è¶…æ—¶é€€å‡ºæœºåˆ¶ï¼Œé˜²æ­¢è¢«å…¶ä»–ç³»ç»Ÿæ‹–å®ï¼Œä¹Ÿè¦å¯¹è°ƒç”¨çš„è¿”å›ç»“æœé›†æœ‰é¢„æœŸï¼Œé˜²æ­¢è¿”å›çš„ç»“æœè¶…å‡ºç¨‹åºå¤„ç†çš„èŒƒå›´ã€‚å³å¯¹é”™è¯¯å¼‚å¸¸è¿›è¡Œæ•è·ï¼Œå¯¹æ— æ³•é¢„æ–™çš„é”™è¯¯è¦æœ‰é»˜è®¤å¤„ç†ç»“æœã€‚</li><li>æµ‹è¯•é˜¶æ®µ - æµ‹è¯•ä¸»è¦æ˜¯ä¿è¯æµ‹è¯•ç”¨ä¾‹çš„è¦†ç›–åº¦ï¼Œä¿è¯æœ€åæƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç›¸åº”çš„å¤„ç†æµç¨‹ã€‚</li><li>å‘å¸ƒé˜¶æ®µ - è¦æœ‰ç´§æ€¥çš„å›æ»šæœºåˆ¶</li><li>è¿è¡Œé˜¶æ®µ - è¿è¡Œæ€æ˜¯å¸¸æ€ï¼Œé‡è¦çš„æ˜¯å¯¹ç³»ç»Ÿçš„ç›‘æ§è¦å‡†ç¡®åŠæ—¶ï¼Œå‘ç°é—®é¢˜èƒ½å¤Ÿå‡†ç¡®æŠ¥è­¦å¹¶ä¸”æŠ¥è­¦æ•°æ®è¦å‡†ç¡®è¯¦ç»†ï¼Œä»¥ä¾¿äºæ’æŸ¥é—®é¢˜ã€‚</li><li>æ•…éšœå‘ç”Ÿ - åŠæ—¶æ­¢æŸï¼Œä¾‹å¦‚ç”±äºç¨‹åºé—®é¢˜å¯¼è‡´å•†å“ä»·æ ¼é”™è¯¯ï¼Œå°±è¦åŠæ—¶ä¸‹æ¶å•†å“æˆ–è€…å…³é—­è´­ä¹°é“¾æ¥ï¼Œé˜²æ­¢é€ æˆé‡å¤§èµ„äº§æŸå¤±ã€‚</li></ol><p>ä¸ºä»€ä¹ˆç³»ç»Ÿçš„é«˜å¯ç”¨å»ºè®¾è¦æ”¾åˆ°æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å…¨é¢è€ƒè™‘ï¼Ÿå› ä¸ºæˆ‘ä»¬åœ¨æ¯ä¸ªç¯èŠ‚ä¸­éƒ½å¯èƒ½çŠ¯é”™ï¼Œè€Œæœ‰äº›ç¯èŠ‚çŠ¯çš„é”™ï¼Œä½ åœ¨åé¢æ˜¯æ— æ³•å¼¥è¡¥çš„ã€‚ä¾‹å¦‚åœ¨æ¶æ„é˜¶æ®µï¼Œä½ æ²¡æœ‰æ¶ˆé™¤å•ç‚¹é—®é¢˜ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸Šçº¿åï¼Œé‡åˆ°çªå‘æµé‡æŠŠå•ç‚¹ç»™æŒ‚äº†ï¼Œä½ å°±åªèƒ½å¹²çªçœ¼ï¼Œæœ‰æ—¶å€™æƒ³åŠ æœºå™¨éƒ½åŠ ä¸è¿›å»ã€‚æ‰€ä»¥é«˜å¯ç”¨å»ºè®¾æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œå¿…é¡»åœ¨æ¯ä¸ªç¯èŠ‚éƒ½åšå¥½ã€‚</p><p>é‚£ä¹ˆé’ˆå¯¹ç§’æ€ç³»ç»Ÿï¼Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»åœ¨é‡åˆ°å¤§æµé‡æ—¶ï¼Œåº”è¯¥ä»å“ªäº›æ–¹é¢æ¥ä¿éšœç³»ç»Ÿçš„ç¨³å®šè¿è¡Œï¼Œæ‰€ä»¥æ›´å¤šçš„æ˜¯çœ‹å¦‚ä½•é’ˆå¯¹è¿è¡Œé˜¶æ®µè¿›è¡Œå¤„ç†ï¼Œè¿™å°±å¼•å‡ºäº†æ¥ä¸‹æ¥çš„å†…å®¹ï¼šé™çº§ã€é™æµå’Œæ‹’ç»æœåŠ¡ã€‚</p><h2 id="9-2-é™çº§"><a href="#9-2-é™çº§" class="headerlink" title="9.2 é™çº§"></a>9.2 é™çº§</h2><p>æ‰€è°“â€œé™çº§â€ï¼Œå°±æ˜¯å½“ç³»ç»Ÿçš„å®¹é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œé™åˆ¶æˆ–è€…å…³é—­ç³»ç»Ÿçš„æŸäº›éæ ¸å¿ƒåŠŸèƒ½ï¼Œä»è€ŒæŠŠæœ‰é™çš„èµ„æºä¿ç•™ç»™æ›´æ ¸å¿ƒçš„ä¸šåŠ¡ã€‚å®ƒæ˜¯ä¸€ä¸ªæœ‰ç›®çš„ã€æœ‰è®¡åˆ’çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ‰€ä»¥å¯¹é™çº§æˆ‘ä»¬ä¸€èˆ¬éœ€è¦æœ‰ä¸€å¥—é¢„æ¡ˆæ¥é…åˆæ‰§è¡Œã€‚å¦‚æœæˆ‘ä»¬æŠŠå®ƒç³»ç»ŸåŒ–ï¼Œå°±å¯ä»¥é€šè¿‡é¢„æ¡ˆç³»ç»Ÿå’Œå¼€å…³ç³»ç»Ÿæ¥å®ç°é™çº§ã€‚</p><p>é™çº§æ–¹æ¡ˆå¯ä»¥è¿™æ ·è®¾è®¡ï¼šå½“ç§’æ€æµé‡è¾¾åˆ° 5w/s æ—¶ï¼ŒæŠŠæˆäº¤è®°å½•çš„è·å–ä»å±•ç¤º 20 æ¡é™çº§åˆ°åªå±•ç¤º 5 æ¡ã€‚â€œä» 20 æ”¹åˆ° 5â€è¿™ä¸ªæ“ä½œç”±ä¸€ä¸ªå¼€å…³æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ä¸€ä¸ªèƒ½å¤Ÿä»å¼€å…³ç³»ç»ŸåŠ¨æ€è·å–çš„ç³»ç»Ÿå‚æ•°ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ç»™å‡ºå¼€å…³ç³»ç»Ÿçš„ç¤ºæ„å›¾ã€‚å®ƒåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å¼€å…³æ§åˆ¶å°ï¼Œå®ƒä¿å­˜äº†å¼€å…³çš„å…·ä½“é…ç½®ä¿¡æ¯ï¼Œä»¥åŠå…·ä½“æ‰§è¡Œå¼€å…³æ‰€å¯¹åº”çš„æœºå™¨åˆ—è¡¨ï¼›å¦ä¸€éƒ¨åˆ†æ˜¯æ‰§è¡Œä¸‹å‘å¼€å…³æ•°æ®çš„ Agentï¼Œä¸»è¦ä»»åŠ¡å°±æ˜¯ä¿è¯å¼€å…³è¢«æ­£ç¡®æ‰§è¡Œï¼Œå³ä½¿ç³»ç»Ÿé‡å¯åä¹Ÿä¼šç”Ÿæ•ˆã€‚</p><p><img src="https://i.loli.net/2020/02/03/MsuI54DXOFAKU7G.jpg" alt="fig11.jpg"></p><h2 id="9-3-é™æµ"><a href="#9-3-é™æµ" class="headerlink" title="9.3 é™æµ"></a>9.3 é™æµ</h2><p>å¦‚æœè¯´é™çº§æ˜¯ç‰ºç‰²äº†ä¸€éƒ¨åˆ†æ¬¡è¦çš„åŠŸèƒ½å’Œç”¨æˆ·çš„ä½“éªŒæ•ˆæœï¼Œé‚£ä¹ˆé™æµå°±æ˜¯æ›´æç«¯çš„ä¸€ç§ä¿æŠ¤æªæ–½äº†ã€‚é™æµå°±æ˜¯å½“ç³»ç»Ÿå®¹é‡è¾¾åˆ°ç“¶é¢ˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡é™åˆ¶ä¸€éƒ¨åˆ†æµé‡æ¥ä¿æŠ¤ç³»ç»Ÿï¼Œå¹¶åšåˆ°æ—¢å¯ä»¥äººå·¥æ‰§è¡Œå¼€å…³ï¼Œä¹Ÿæ”¯æŒè‡ªåŠ¨åŒ–ä¿æŠ¤çš„æªæ–½ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘åŒæ ·ç»™å‡ºäº†é™æµç³»ç»Ÿçš„ç¤ºæ„å›¾ã€‚æ€»ä½“æ¥è¯´ï¼Œé™æµæ—¢å¯ä»¥æ˜¯åœ¨å®¢æˆ·ç«¯é™æµï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨æœåŠ¡ç«¯é™æµã€‚æ­¤å¤–ï¼Œé™æµçš„å®ç°æ–¹å¼æ—¢è¦æ”¯æŒ URL ä»¥åŠæ–¹æ³•çº§åˆ«çš„é™æµï¼Œä¹Ÿè¦æ”¯æŒåŸºäº QPS å’Œçº¿ç¨‹çš„é™æµã€‚</p><ul><li>å®¢æˆ·ç«¯é™æµ</li></ul><p>å¥½å¤„å¯ä»¥é™åˆ¶è¯·æ±‚çš„å‘å‡ºï¼Œé€šè¿‡å‡å°‘å‘å‡ºæ— ç”¨è¯·æ±‚ä»è€Œå‡å°‘å¯¹ç³»ç»Ÿçš„æ¶ˆè€—ã€‚ç¼ºç‚¹å°±æ˜¯å½“å®¢æˆ·ç«¯æ¯”è¾ƒåˆ†æ•£æ—¶ï¼Œæ²¡æ³•è®¾ç½®åˆç†çš„é™æµé˜ˆå€¼ï¼šå¦‚æœé˜ˆå€¼è®¾çš„å¤ªå°ï¼Œä¼šå¯¼è‡´æœåŠ¡ç«¯æ²¡æœ‰è¾¾åˆ°ç“¶é¢ˆæ—¶å®¢æˆ·ç«¯å·²ç»è¢«é™åˆ¶ï¼›è€Œå¦‚æœè®¾çš„å¤ªå¤§ï¼Œåˆ™èµ·ä¸åˆ°é™åˆ¶çš„ä½œç”¨ã€‚</p><ul><li>æœåŠ¡ç«¯é™æµ</li></ul><p>å¥½å¤„æ˜¯å¯ä»¥æ ¹æ®æœåŠ¡ç«¯çš„æ€§èƒ½è®¾ç½®åˆç†çš„é˜ˆå€¼ï¼Œè€Œç¼ºç‚¹å°±æ˜¯è¢«é™åˆ¶çš„è¯·æ±‚éƒ½æ˜¯æ— æ•ˆçš„è¯·æ±‚ï¼Œå¤„ç†è¿™äº›æ— æ•ˆçš„è¯·æ±‚æœ¬èº«ä¹Ÿä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚</p><p><img src="https://i.loli.net/2020/02/03/zm8P6fRyoUsclSj.jpg" alt="fig12.jpg"></p><p>åœ¨é™æµçš„å®ç°æ‰‹æ®µä¸Šæ¥è®²ï¼ŒåŸºäº QPS å’Œçº¿ç¨‹æ•°çš„é™æµåº”ç”¨æœ€å¤šï¼Œæœ€å¤§ QPS å¾ˆå®¹æ˜“é€šè¿‡å‹æµ‹æå‰è·å–ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„ç³»ç»Ÿæœ€é«˜æ”¯æŒ 1w QPS æ—¶ï¼Œå¯ä»¥è®¾ç½® 8000 æ¥è¿›è¡Œé™æµä¿æŠ¤ã€‚çº¿ç¨‹æ•°é™æµåœ¨å®¢æˆ·ç«¯æ¯”è¾ƒæœ‰æ•ˆï¼Œä¾‹å¦‚åœ¨è¿œç¨‹è°ƒç”¨æ—¶æˆ‘ä»¬è®¾ç½®è¿æ¥æ± çš„çº¿ç¨‹æ•°ï¼Œè¶…å‡ºè¿™ä¸ªå¹¶å‘çº¿ç¨‹è¯·æ±‚ï¼Œå°±å°†çº¿ç¨‹è¿›è¡Œæ’é˜Ÿæˆ–è€…ç›´æ¥è¶…æ—¶ä¸¢å¼ƒã€‚</p><p>é™æµæ— ç–‘ä¼šå½±å“ç”¨æˆ·çš„æ­£å¸¸è¯·æ±‚ï¼Œæ‰€ä»¥å¿…ç„¶ä¼šå¯¼è‡´ä¸€éƒ¨åˆ†ç”¨æˆ·è¯·æ±‚å¤±è´¥ï¼Œå› æ­¤åœ¨ç³»ç»Ÿå¤„ç†è¿™ç§å¼‚å¸¸æ—¶ä¸€å®šè¦è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢å› è¢«é™æµçš„è¯·æ±‚ä¸èƒ½ fast failï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰è€Œæ‹–å®ç³»ç»Ÿã€‚</p><h2 id="9-4-æ‹’ç»æœåŠ¡"><a href="#9-4-æ‹’ç»æœåŠ¡" class="headerlink" title="9.4 æ‹’ç»æœåŠ¡"></a>9.4 æ‹’ç»æœåŠ¡</h2><p>å½“ç³»ç»Ÿè´Ÿè½½è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œä¾‹å¦‚ CPU ä½¿ç”¨ç‡è¾¾åˆ° 90% æˆ–è€…ç³»ç»Ÿ load å€¼è¾¾åˆ° 2*CPU æ ¸æ•°æ—¶ï¼Œç³»ç»Ÿç›´æ¥æ‹’ç»æ‰€æœ‰è¯·æ±‚ï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€æš´åŠ›ä½†ä¹Ÿæœ€æœ‰æ•ˆçš„ç³»ç»Ÿä¿æŠ¤æ–¹å¼ã€‚ä¾‹å¦‚ç§’æ€ç³»ç»Ÿï¼Œæˆ‘ä»¬åœ¨å¦‚ä¸‹å‡ ä¸ªç¯èŠ‚è®¾è®¡è¿‡è½½ä¿æŠ¤ï¼š</p><p>åœ¨æœ€å‰ç«¯çš„ Nginx ä¸Šè®¾ç½®è¿‡è½½ä¿æŠ¤ï¼Œå½“æœºå™¨è´Ÿè½½è¾¾åˆ°æŸä¸ªå€¼æ—¶ç›´æ¥æ‹’ç» HTTP è¯·æ±‚å¹¶è¿”å› 503 é”™è¯¯ç ï¼Œåœ¨ Java å±‚åŒæ ·ä¹Ÿå¯ä»¥è®¾è®¡è¿‡è½½ä¿æŠ¤ã€‚</p><p>æ‹’ç»æœåŠ¡å¯ä»¥è¯´æ˜¯ä¸€ç§ä¸å¾—å·²çš„å…œåº•æ–¹æ¡ˆï¼Œç”¨ä»¥é˜²æ­¢æœ€åæƒ…å†µå‘ç”Ÿï¼Œé˜²æ­¢å› æŠŠæœåŠ¡å™¨å‹è·¨è€Œé•¿æ—¶é—´å½»åº•æ— æ³•æä¾›æœåŠ¡ã€‚åƒè¿™ç§ç³»ç»Ÿè¿‡è½½ä¿æŠ¤è™½ç„¶åœ¨è¿‡è½½æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œä½†æ˜¯ç³»ç»Ÿä»ç„¶å¯ä»¥è¿ä½œï¼Œå½“è´Ÿè½½ä¸‹é™æ—¶åˆå¾ˆå®¹æ˜“æ¢å¤ï¼Œæ‰€ä»¥æ¯ä¸ªç³»ç»Ÿå’Œæ¯ä¸ªç¯èŠ‚éƒ½åº”è¯¥è®¾ç½®è¿™ä¸ªå…œåº•æ–¹æ¡ˆï¼Œå¯¹ç³»ç»Ÿåšæœ€åæƒ…å†µä¸‹çš„ä¿æŠ¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SystemDesign </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç§’æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(åä¸€)-ç”¨åŒåä¸€ç†é¡ºèµ·æ¥çš„ç½‘ç»œåè®®</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%8D%81%E4%B8%80-%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%90%86%E9%A1%BA%E8%B5%B7%E6%9D%A5%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%8D%81%E4%B8%80-%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%90%86%E9%A1%BA%E8%B5%B7%E6%9D%A5%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¼šå°½å¯èƒ½è¯¦ç»†æè¿°åŒåä¸€çš„æŠ€æœ¯æ ˆï¼Œå¸Œæœ›å¯¹å¤§å®¶èƒ½æœ‰æ‰€è£¨ç›Šã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹ä¼šåˆ†ä¸ºåä¸ªé˜¶æ®µï¼Œæ¥ä¸‹æ¥ä¹Ÿä¼šåˆ†åˆ«ä»è¿™åä¸ªæ–¹é¢è¿›è¡Œè®²è¿°ï¼š </p><ul><li>éƒ¨ç½²é«˜å¯ç”¨é«˜å¹¶å‘çš„ç”µå•†å¹³å°</li><li>å¹¿æ’­å…¨ç½‘</li><li>åŸŸåè§£æ</li></ul><h1 id="1-éƒ¨ç½²é«˜å¯ç”¨é«˜å¹¶å‘çš„ç”µå•†å¹³å°"><a href="#1-éƒ¨ç½²é«˜å¯ç”¨é«˜å¹¶å‘çš„ç”µå•†å¹³å°" class="headerlink" title="1. éƒ¨ç½²é«˜å¯ç”¨é«˜å¹¶å‘çš„ç”µå•†å¹³å°"></a>1. éƒ¨ç½²é«˜å¯ç”¨é«˜å¹¶å‘çš„ç”µå•†å¹³å°</h1><p><img src="https://i.loli.net/2020/02/02/6AuPT1RQZilKpcB.jpg" alt="fig1.jpg"></p><ul><li>ä¸»ç«™ç‚¹</li><li>å¤šæœºæˆ¿ï¼Œå¤šAvailable zone </li><li>æ•°æ®ä¸­å¿ƒï¼Œä¸€ä¸ªAZ<ul><li>æ±‡èšäº¤æ¢æœº <ul><li>æœºæŸœ<ul><li>æ¥å…¥äº¤æ¢æœº </li><li>æœåŠ¡å™¨</li></ul></li></ul></li></ul></li></ul><p>è¿™äº›æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„éƒ½æ˜¯è®¡ç®—èŠ‚ç‚¹ï¼Œæ¯å°ä¸Šé¢éƒ½æœ‰Open vSwitchåˆ›å»ºçš„è™šæ‹Ÿäº¤æ¢æœºï¼Œå°†æ¥åœ¨è¿™å°æœºå™¨ä¸Šåˆ›å»ºçš„è™šæ‹Ÿæœºï¼Œéƒ½ä¼šè¿åˆ°Open vSwitchä¸Šã€‚</p><p><img src="https://i.loli.net/2020/02/02/JCiMoL1DwbGcqQB.jpg" alt="fig2.jpg"></p><ul><li>åˆ›å»ºVPC</li><li>æŒ‡å®šIPæ®µ<ul><li>è¿™æ ·ä»¥åéƒ¨ç½²çš„æ‰€æœ‰åº”ç”¨éƒ½ä¼šåœ¨è¿™ä¸ªè™šæ‹Ÿç½‘ç»œå½“ä¸­ï¼Œä½¿ç”¨ä½ åˆ†é…çš„è¿™ä¸ªIPæ®µ</li><li>å³ä½¿åŒä¸€å°ç‰©ç†æœºï¼Œä¸åŒçš„VPCä¹Ÿä¸ä¼šç›¸é€š</li><li>å¤šä¸ªå¯ç”¨åŒºï¼Œä¸ºæ¯ä¸ªå¯ç”¨åŒºåˆ†é…Subnet<ul><li>åœ¨ä¸¤ä¸ªå¯ç”¨åŒºé‡Œé¢ç½‘æ®µä¸åŒçš„æ—¶å€™ï¼Œå°±å¯ä»¥é…ç½®è·¯ç”±ç­–ç•¥ï¼Œè®¿é—®å¦ä¸€ä¸ªå¯ç”¨åŒº</li></ul></li></ul></li><li>åˆ›å»ºæ•°æ®åº“æŒä¹…åŒ–å±‚<ul><li>äº‘å¹³å°ç»™æ¯ä¸ªSubnetçš„æ•°æ®åº“å®ä¾‹åˆ†é…ä¸€ä¸ªåŸŸåï¼Œåœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šå¯ç”¨åŒºå’ŒSubnetï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„æ•°æ®åº“å®ä¾‹å¯ä»¥é€šè¿‡è¿™ä¸ªSubnetçš„ç§ç½‘IPè¿›è¡Œè®¿é—®ã€‚ </li><li>å„ä¸ªå¯ç”¨åŒºéƒ½è¦æœ‰æ•°æ®åº“ï¼Œä¸»ä»æ•°æ®åº“ï¼Œäº‘å¹³å°ä¼šæä¾›æ•°æ®åº“åŒæ­¥å·¥å…·ï¼Œå°†åº”ç”¨å†™å…¥çš„ä¸»æ•°æ®åŒæ­¥ç»™å¤‡æ•°æ®åº“é›†ç¾¤</li></ul></li><li>åˆ›å»ºç¼“å­˜é›†ç¾¤<ul><li>æ¯ä¸ªå¯ç”¨åŒºï¼ŒSubnetæœ‰ä¸€å¥—</li><li>ç¼“å­˜çš„æ•°æ®å†™åœ¨å†…å­˜ä¸­</li><li>å› ä¸ºè¾ƒé«˜çš„è¯»å†™æ€§èƒ½è¦æ±‚ï¼Œä¸€èˆ¬ä¸éœ€è¦è·¨å¯ç”¨åŒºè¯»å†™</li></ul></li><li>å†™çš„ç¨‹åºä»¬â€¦<ul><li>ç›¸äº’å…³ç³»<ul><li>ä¹‹é—´é€šè¿‡RPCç›¸äº’è°ƒç”¨</li><li>éœ€è¦åˆ°æ³¨å†Œä¸­å¿ƒå»è¿›è¡Œæ³¨å†Œ</li><li>ç½‘ç»œé€šä¿¡æ˜¯è™šæ‹Ÿæœºå’Œè™šæ‹Ÿæœºä¹‹é—´çš„</li><li>ä¸åŒçš„å¯ç”¨åŒºä¹‹é—´ï¼Œé€šè¿‡æ ¸å¿ƒäº¤æ¢æœºè¿åœ¨ä¸€èµ·ï¼Œæ ¸å¿ƒäº¤æ¢æœºä¹‹å¤–æ˜¯è¾¹ç•Œè·¯ç”±å™¨ã€‚</li></ul></li><li>åŸºç¡€æœåŠ¡å±‚</li><li>ç»„åˆæœåŠ¡å±‚</li><li>Controllerå±‚</li><li>Nginxå±‚<ul><li>è´Ÿè½½å‡è¡¡ä¹Ÿæ˜¯äº‘å¹³å°æä¾›çš„ PaaS æœåŠ¡ï¼Œä¹Ÿæ˜¯å±äºæŸä¸ª VPC çš„ï¼Œéƒ¨ç½²åœ¨è™šæ‹Ÿæœºé‡Œé¢çš„ï¼Œä½†æ˜¯è´Ÿè½½å‡è¡¡æœ‰ä¸ªå¤–ç½‘çš„ IPï¼Œè¿™ä¸ªå¤–ç½‘çš„ IP åœ°å€å°±æ˜¯åœ¨ç½‘å…³èŠ‚ç‚¹çš„å¤–ç½‘ç½‘å£ä¸Šçš„ã€‚åœ¨ç½‘å…³èŠ‚ç‚¹ä¸Šï¼Œä¼šæœ‰ NAT è§„åˆ™ï¼Œå°†å¤–ç½‘ IP åœ°å€è½¬æ¢ä¸º VPC é‡Œé¢çš„ç§ç½‘ IP åœ°å€ï¼Œé€šè¿‡è¿™äº›ç§ç½‘ IP åœ°å€è®¿é—®åˆ°è™šæ‹Ÿæœºä¸Šçš„è´Ÿè½½å‡è¡¡èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡è´Ÿè½½å‡è¡¡èŠ‚ç‚¹è½¬å‘åˆ° API ç½‘å…³çš„èŠ‚ç‚¹ã€‚ </li></ul></li><li>APIç½‘å…³<ul><li>ç½‘å…³èŠ‚ç‚¹çš„å¤–ç½‘ç½‘å£æ˜¯å¸¦å…¬ç½‘IPåœ°å€çš„ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªè™šæ‹Ÿç½‘å…³è½¬å‘æ¨¡å—ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªOVSï¼Œå°†ç§ç½‘IPåœ°å€æ”¾åˆ°VXLANéš§é“é‡Œé¢ï¼Œè½¬å‘åˆ°è™šæ‹Ÿæœºä¸Šï¼Œä»è€Œå®ç°å¤–ç½‘å’Œè™šæ‹Ÿæœºç½‘ç»œä¹‹é—´çš„äº’é€šã€‚</li></ul></li><li>æ™ºèƒ½DNS<ul><li>å¯¹äºä¸åŒåœ°åŒºå’Œä¸åŒè¿è¥å•†çš„ç”¨æˆ·ï¼Œä¿è¯è®¿é—®é€Ÿåº¦</li></ul></li><li>CDNä¸è¾¹ç¼˜èŠ‚ç‚¹<ul><li>å­˜å‚¨é™æ€èµ„æºåˆ°å¯¹è±¡å­˜å‚¨é‡Œ</li><li>é€šè¿‡CDNä¸‹å‘åˆ°è¾¹ç¼˜èŠ‚ç‚¹</li></ul></li></ul></li></ul><h1 id="2-å¹¿æ’­ç»™å…¨ç½‘"><a href="#2-å¹¿æ’­ç»™å…¨ç½‘" class="headerlink" title="2. å¹¿æ’­ç»™å…¨ç½‘"></a>2. å¹¿æ’­ç»™å…¨ç½‘</h1><p><img src="https://i.loli.net/2020/02/02/padlBADogKVHhGI.jpg" alt="fig3.jpg"></p><p>å¤–ç½‘IPæ˜¯æ”¾åœ¨è™šæ‹Ÿç½‘å…³çš„å¤–ç½‘ç½‘å£ä¸Šçš„ï¼Œé€šè¿‡BGPè·¯ç”±åè®®è®©å…¨ä¸–ç•ŒçŸ¥é“ã€‚</p><p>BGPè·¯ç”±åè®® Border Gateway Protocolï¼Œ å»ä¸­å¿ƒåŒ–è‡ªæ²»è·¯ç”±åè®®ï¼Œé€šè¿‡ç»´æŠ¤IPè·¯ç”±è¡¨æ¥å®ç°è‡ªæ²»ç³»ç»Ÿä¹‹é—´çš„å¯è¾¾æ€§ï¼Œå±äºçŸ¢é‡è·¯ç”±åè®®</p><p>æ¯ä¸ªå¯ç”¨åŒºéƒ½æœ‰è‡ªå·±çš„æ±‡èšäº¤æ¢æœºï¼Œæ¯ä¸ªRegionä¹Ÿæœ‰è‡ªå·±çš„æ ¸å¿ƒäº¤æ¢åŒºåŸŸã€‚</p><p>åœ¨æ ¸å¿ƒäº¤æ¢å¤–é¢æ˜¯å®‰å…¨è®¾å¤‡ï¼Œç„¶åæ˜¯è¾¹ç•Œè·¯ç”±å™¨ã€‚è¾¹ç•Œè·¯ç”±å™¨ä¼šå’Œå¤šä¸ªè¿è¥å•†è¿æ¥ï¼Œä»è€Œæ¯ä¸ªè¿è¥å•†éƒ½èƒ½å¤Ÿè®¿é—®åˆ°è¿™ä¸ªç½‘ç«™ã€‚è¾¹ç•Œè·¯ç”±å™¨å¯ä»¥é€šè¿‡BGPåè®®ï¼Œå°†è‡ªå·±çš„æ•°æ®ä¸­å¿ƒé‡Œé¢çš„å¤–ç½‘IPå‘å¤–å¹¿æ’­ã€‚</p><h1 id="3-åŸŸåè§£æåœ°å€"><a href="#3-åŸŸåè§£æåœ°å€" class="headerlink" title="3. åŸŸåè§£æåœ°å€"></a>3. åŸŸåè§£æåœ°å€</h1><p><img src="https://i.loli.net/2020/02/02/HoziVPFMukRL9wa.jpg" alt="fig4.jpg"></p><p>å®¢æˆ·çš„æ‰‹æœºå¼€æœºä»¥åï¼Œåœ¨é™„è¿‘å¯»æ‰¾åŸºç«™ eNodeBï¼Œå‘é€è¯·æ±‚ï¼Œç”³è¯·ä¸Šç½‘ã€‚åŸºç«™å°†è¯·æ±‚å‘ç»™ MMEï¼ŒMME å¯¹æ‰‹æœºè¿›è¡Œè®¤è¯å’Œé‰´æƒï¼Œè¿˜ä¼šè¯·æ±‚ HSS çœ‹æœ‰æ²¡æœ‰é’±ï¼Œçœ‹çœ‹æ˜¯åœ¨å“ªé‡Œä¸Šç½‘ã€‚</p><p>å½“ MME é€šè¿‡äº†æ‰‹æœºçš„è®¤è¯ä¹‹åï¼Œå¼€å§‹å»ºç«‹éš§é“ï¼Œå»ºè®¾çš„æ•°æ®é€šè·¯åˆ†ä¸¤æ®µè·¯ï¼Œå…¶å®æ˜¯ä¸¤ä¸ªéš§é“ã€‚ä¸€æ®µæ˜¯ä» eNodeB åˆ° SGWï¼Œç¬¬äºŒæ®µæ˜¯ä» SGW åˆ° PGWï¼Œåœ¨ PGW ä¹‹å¤–ï¼Œå°±æ˜¯äº’è”ç½‘ã€‚</p><p>PGW ä¼šä¸ºæ‰‹æœºåˆ†é…ä¸€ä¸ª IP åœ°å€ï¼Œæ‰‹æœºä¸Šç½‘éƒ½æ˜¯å¸¦ç€è¿™ä¸ª IP åœ°å€çš„ã€‚å½“åœ¨æ‰‹æœºä¸Šé¢æ‰“å¼€ä¸€ä¸ª App çš„æ—¶å€™ï¼Œé¦–å…ˆè¦åšçš„äº‹æƒ…å°±æ˜¯è§£æè¿™ä¸ªç½‘ç«™çš„åŸŸåã€‚</p><p>åœ¨æ‰‹æœºè¿è¥å•†æ‰€åœ¨çš„äº’è”ç½‘åŒºåŸŸé‡Œï¼Œæœ‰ä¸€ä¸ªæœ¬åœ°çš„ DNSï¼Œæ‰‹æœºä¼šå‘è¿™ä¸ª DNS è¯·æ±‚è§£æ DNSã€‚å½“è¿™ä¸ª DNS æœ¬åœ°æœ‰ç¼“å­˜ï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œæœ¬åœ° DNS æ‰éœ€è¦é€’å½’åœ°ä»æ ¹ DNS æœåŠ¡å™¨ï¼ŒæŸ¥åˆ°.com çš„é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œæœ€ç»ˆæŸ¥åˆ°æƒå¨ DNS æœåŠ¡å™¨ã€‚</p><p>å¦‚æœé…ç½®äº†DNSå’Œå…¨å±€è´Ÿè½½å‡è¡¡ï¼Œåœ¨æƒå¨DNSæœåŠ¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®CNAMEçš„æ–¹å¼ï¼Œèµ·ä¸€ä¸ªåˆ«åï¼Œç„¶åå‘Šè¯‰æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œè®©å®ƒè¯·æ±‚ GSLB è§£æè¿™ä¸ªåŸŸåï¼ŒGSLB å°±å¯ä»¥åœ¨è§£æè¿™ä¸ªåŸŸåçš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡è‡ªå·±çš„ç­–ç•¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p><p>GSLB é€šè¿‡æŸ¥çœ‹è¯·æ±‚å®ƒçš„æœ¬åœ° DNS æœåŠ¡å™¨æ‰€åœ¨çš„è¿è¥å•†å’Œåœ°å€ï¼Œå°±çŸ¥é“ç”¨æˆ·æ‰€åœ¨çš„è¿è¥å•†å’Œåœ°å€ï¼Œç„¶åå°†è·ç¦»ç”¨æˆ·ä½ç½®æ¯”è¾ƒè¿‘çš„ Region é‡Œé¢ï¼Œä¸‰ä¸ªè´Ÿè½½å‡è¡¡ SLB çš„å…¬ç½‘ IP åœ°å€ï¼Œè¿”å›ç»™æœ¬åœ° DNS æœåŠ¡å™¨ã€‚æœ¬åœ° DNS è§£æå™¨å°†ç»“æœç¼“å­˜åï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>å¯¹äºæ‰‹æœº App æ¥è¯´ï¼Œå¯ä»¥ç»•è¿‡åˆšæ‰çš„ä¼ ç»Ÿ DNS è§£ææœºåˆ¶ï¼Œç›´æ¥åªè¦ HTTPDNS æœåŠ¡ï¼Œé€šè¿‡ç›´æ¥è°ƒç”¨ HTTPDNS æœåŠ¡å™¨ï¼Œå¾—åˆ°è¿™ä¸‰ä¸ª SLB çš„å…¬ç½‘ IP åœ°å€ã€‚</p><h1 id="4-è´­ç‰©å‰æµè§ˆçš„è¿‡ç¨‹-é™æ€èµ„æºCDN"><a href="#4-è´­ç‰©å‰æµè§ˆçš„è¿‡ç¨‹-é™æ€èµ„æºCDN" class="headerlink" title="4. è´­ç‰©å‰æµè§ˆçš„è¿‡ç¨‹ - é™æ€èµ„æºCDN"></a>4. è´­ç‰©å‰æµè§ˆçš„è¿‡ç¨‹ - é™æ€èµ„æºCDN</h1><p><img src="https://i.loli.net/2020/02/02/HmRsg9l7X1yzF4q.jpg" alt="fig5.jpg"></p><p>DNS -&gt; CDN -&gt; Cloud </p><p>æˆ‘ä»¬éƒ¨ç½²ç”µå•†åº”ç”¨çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå°†é™æ€èµ„æºä¿å­˜åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š </p><ul><li>æ¥å…¥å±‚nginxåé¢çš„varnishç¼“å­˜é‡Œ</li><li>å¯¹äºæ¯”è¾ƒå¤§ï¼Œä¸å¸¸æ›´æ–°çš„é™æ€å›¾ç‰‡ï¼Œä¼šä¿å­˜åœ¨å¯¹è±¡å­˜å‚¨é‡Œé¢</li></ul><p>è¿™ä¸¤ä¸ªåœ°æ–¹çš„é™æ€èµ„æºéƒ½ä¼šé…ç½®CDNï¼Œå°†èµ„æºä¸‹å‘åˆ°è¾¹ç¼˜èŠ‚ç‚¹ã€‚</p><p>é…ç½®äº†CDNä¹‹åï¼Œæƒå¨DNSæœåŠ¡å™¨ä¸Šï¼Œä¼šä¸º<strong>é™æ€èµ„æºè®¾ç½®ä¸€ä¸ªCNAMEåˆ«å</strong>ï¼ŒæŒ‡å‘å¦å¤–ä¸€ä¸ªåŸŸåï¼Œcdn.comï¼Œè¿”å›ç»™æœ¬åœ°çš„DNSæœåŠ¡å™¨ã€‚å½“æœ¬åœ° DNS æœåŠ¡å™¨æ‹¿åˆ°è¿™ä¸ªæ–°çš„åŸŸåæ—¶ï¼Œéœ€è¦ç»§ç»­è§£æè¿™ä¸ªæ–°çš„åŸŸåã€‚è¿™ä¸ªæ—¶å€™ï¼Œå†è®¿é—®çš„æ—¶å€™å°±ä¸æ˜¯åŸæ¥çš„æƒå¨ DNS æœåŠ¡å™¨äº†ï¼Œè€Œæ˜¯cdn.comçš„æƒå¨DNSæœåŠ¡å™¨ï¼Œè¿™æ˜¯CDNè‡ªå·±çš„ã€‚</p><p>åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¿˜æ˜¯ä¼šè®¾ç½®ä¸€ä¸ª CNAMEï¼ŒæŒ‡å‘å¦å¤–ä¸€ä¸ªåŸŸåï¼Œä¹Ÿå³ CDN ç½‘ç»œçš„å…¨å±€è´Ÿè½½å‡è¡¡å™¨ã€‚</p><p>æœ¬åœ° DNS æœåŠ¡å™¨å»è¯·æ±‚ CDN çš„å…¨å±€è´Ÿè½½å‡è¡¡å™¨è§£æåŸŸåï¼Œå…¨å±€è´Ÿè½½å‡è¡¡å™¨ä¼šä¸ºç”¨æˆ·é€‰æ‹©ä¸€å°åˆé€‚çš„ç¼“å­˜æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå°† IP è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å»è®¿é—®è¿™ä¸ªè¾¹ç¼˜èŠ‚ç‚¹ï¼Œä¸‹è½½èµ„æºã€‚ç¼“å­˜æœåŠ¡å™¨å“åº”ç”¨æˆ·è¯·æ±‚ï¼Œå°†ç”¨æˆ·æ‰€éœ€å†…å®¹ä¼ é€åˆ°ç”¨æˆ·ç»ˆç«¯ã€‚</p><p><strong><em>å¦‚æœè¿™å°ç¼“å­˜æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰ç”¨æˆ·æƒ³è¦çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿™å°æœåŠ¡å™¨å°±è¦å‘å®ƒçš„ä¸Šä¸€çº§ç¼“å­˜æœåŠ¡å™¨è¯·æ±‚å†…å®¹ï¼Œç›´è‡³è¿½æº¯åˆ°ç½‘ç«™çš„æºæœåŠ¡å™¨ï¼Œå°†å†…å®¹æ‹‰åˆ°æœ¬åœ°</em></strong></p><h1 id="5-ä¸‹å•è¿‡ç¨‹ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥"><a href="#5-ä¸‹å•è¿‡ç¨‹ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥" class="headerlink" title="5. ä¸‹å•è¿‡ç¨‹ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥"></a>5. ä¸‹å•è¿‡ç¨‹ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥</h1><p>å¯¹äºä¸‹å•ï¼Œç½‘ç«™ä¼šæä¾›RESTfulçš„ä¸‹å•æ¥å£ï¼Œè¿™ç§æ“ä½œæœ‰å¾ˆå¼ºçš„ç§å¯†æ€§ï¼Œå› æ­¤éœ€è¦é€šè¿‡HTTPSåè®®è¿›è¡Œè¯·æ±‚ã€‚</p><p><img src="https://i.loli.net/2020/02/02/ENjJD3su5RIHdAk.jpg" alt="fig6.jpg"></p><p>å»ºç«‹TCPè¿æ¥çš„è¡Œä¸ºæ˜¯åœ¨æ‰‹æœºçš„APPå’Œè´Ÿè½½å‡è¡¡å™¨SLBä¹‹é—´å‘ç”Ÿçš„ã€‚</p><p>å¯¹äºTCPè¿æ¥æ¥è®²ï¼Œéœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œä¸ºäº†ç»´æŠ¤è¿™ä¸ªè¿æ¥ï¼ŒåŒæ–¹éƒ½éœ€è¦åœ¨TCPå±‚ç»´æŠ¤ä¸€ä¸ªè¿æ¥çš„çŠ¶æ€æœºã€‚</p><p>ä¸€å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº CLOSED çŠ¶æ€ã€‚æœåŠ¡ç«¯å…ˆæ˜¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº LISTEN çŠ¶æ€ã€‚ç„¶åå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥ SYNï¼Œä¹‹åå¤„äº SYN-SENT çŠ¶æ€ã€‚æœåŠ¡ç«¯æ”¶åˆ°å‘èµ·çš„è¿æ¥ï¼Œè¿”å› SYNï¼Œå¹¶ä¸” ACK å®¢æˆ·ç«¯çš„ SYNï¼Œä¹‹åå¤„äº SYN-RCVD çŠ¶æ€ã€‚</p><p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯å‘é€çš„ SYN å’Œ ACK ä¹‹åï¼Œå‘é€ ACK çš„ ACKï¼Œä¹‹åå¤„äº ESTABLISHED çŠ¶æ€ã€‚è¿™æ˜¯å› ä¸ºï¼Œå®ƒä¸€å‘ä¸€æ”¶æˆåŠŸäº†ã€‚æœåŠ¡ç«¯æ”¶åˆ° ACK çš„ ACK ä¹‹åï¼Œå¤„äº ESTABLISHED çŠ¶æ€ï¼Œå› ä¸ºå®ƒçš„ä¸€å‘ä¸€æ”¶ä¹ŸæˆåŠŸäº†ã€‚</p><p>TCPå±‚è¿æ¥å»ºç«‹å®Œæ¯•ä¹‹åï¼Œæ¥ä¸‹æ¥æ˜¯åœ¨HTTPSå±‚å»ºç«‹è¿æ¥ï¼Œåœ¨HTTPSçš„äº¤æ¢è¿‡ç¨‹ä¸­ï¼ŒTCPå±‚å§‹ç»ˆå¤„äºESTABLISHEDçŠ¶æ€ã€‚</p><p>å¯¹äº HTTPSï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ Client Hello æ¶ˆæ¯åˆ°æœåŠ¡å™¨ï¼Œç”¨æ˜æ–‡ä¼ è¾“ TLS ç‰ˆæœ¬ä¿¡æ¯ã€åŠ å¯†å¥—ä»¶å€™é€‰åˆ—è¡¨ã€å‹ç¼©ç®—æ³•å€™é€‰åˆ—è¡¨ç­‰ä¿¡æ¯ã€‚å¦å¤–ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªéšæœºæ•°ï¼Œåœ¨åå•†å¯¹ç§°å¯†é’¥çš„æ—¶å€™ä½¿ç”¨ã€‚</p><p>ç„¶åï¼ŒæœåŠ¡å™¨ä¼šè¿”å› Server Hello æ¶ˆæ¯ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨é€‰æ‹©ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ã€åŠ å¯†å¥—ä»¶ã€å‹ç¼©ç®—æ³•ç­‰ã€‚è¿™ä¹Ÿæœ‰ä¸€ä¸ªéšæœºæ•°ï¼Œç”¨äºåç»­çš„å¯†é’¥åå•†ã€‚</p><p>ç„¶åï¼ŒæœåŠ¡å™¨ä¼šç»™ä½ ä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„è¯ä¹¦ï¼Œç„¶åè¯´ï¼šâ€œServer Hello Doneï¼Œæˆ‘è¿™é‡Œå°±è¿™äº›ä¿¡æ¯äº†ã€‚â€</p><p>å®¢æˆ·ç«¯å½“ç„¶ä¸ç›¸ä¿¡è¿™ä¸ªè¯ä¹¦ï¼Œäºæ˜¯ä»è‡ªå·±ä¿¡ä»»çš„ CA ä»“åº“ä¸­ï¼Œæ‹¿ CA çš„è¯ä¹¦é‡Œé¢çš„å…¬é’¥å»è§£å¯†ç”µå•†ç½‘ç«™çš„è¯ä¹¦ã€‚å¦‚æœèƒ½å¤ŸæˆåŠŸï¼Œåˆ™è¯´æ˜ç”µå•†ç½‘ç«™æ˜¯å¯ä¿¡çš„ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šä¸æ–­å¾€ä¸Šè¿½æº¯ CAã€CA çš„ CAã€CA çš„ CA çš„ CAï¼Œåæ­£ç›´åˆ°ä¸€ä¸ªæˆä¿¡çš„ CAï¼Œå°±å¯ä»¥äº†ã€‚</p><p>è¯ä¹¦éªŒè¯å®Œæ¯•ä¹‹åï¼Œè§‰å¾—è¿™ä¸ªæœåŠ¡ç«¯æ˜¯å¯ä¿¡çš„ï¼Œäºæ˜¯å®¢æˆ·ç«¯è®¡ç®—äº§ç”Ÿéšæœºæ•°å­— Pre-masterï¼Œå‘é€ Client Key Exchangeï¼Œç”¨è¯ä¹¦ä¸­çš„å…¬é’¥åŠ å¯†ï¼Œå†å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¯ä»¥é€šè¿‡ç§é’¥è§£å¯†å‡ºæ¥ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæ— è®ºæ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨ï¼Œéƒ½æœ‰äº†ä¸‰ä¸ªéšæœºæ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šè‡ªå·±çš„ã€å¯¹ç«¯çš„ï¼Œä»¥åŠåˆšç”Ÿæˆçš„ Pre-Master éšæœºæ•°ã€‚é€šè¿‡è¿™ä¸‰ä¸ªéšæœºæ•°ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº§ç”Ÿç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚</p><p>æœ‰äº†å¯¹ç§°å¯†é’¥ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥è¯´ï¼šâ€œChange Cipher Specï¼Œå’±ä»¬ä»¥åéƒ½é‡‡ç”¨åå•†çš„é€šä¿¡å¯†é’¥å’ŒåŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡äº†ã€‚â€</p><p>ç„¶åå®¢æˆ·ç«¯å‘é€ä¸€ä¸ª Encrypted Handshake Messageï¼Œå°†å·²ç»å•†å®šå¥½çš„å‚æ•°ç­‰ï¼Œé‡‡ç”¨åå•†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œå‘é€ç»™æœåŠ¡å™¨ç”¨äºæ•°æ®ä¸æ¡æ‰‹éªŒè¯ã€‚</p><p>åŒæ ·ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥å‘é€ Change Cipher Specï¼Œè¯´ï¼šâ€œæ²¡é—®é¢˜ï¼Œå’±ä»¬ä»¥åéƒ½é‡‡ç”¨åå•†çš„é€šä¿¡å¯†é’¥å’ŒåŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡äº†â€ï¼Œå¹¶ä¸”ä¹Ÿå‘é€ Encrypted Handshake Message çš„æ¶ˆæ¯è¯•è¯•ã€‚</p><p>å½“åŒæ–¹æ¡æ‰‹ç»“æŸä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡å¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†ä¼ è¾“äº†ã€‚</p><h1 id="6-å‘é€ä¸‹å•è¯·æ±‚çš„ç½‘ç»œåŒ…"><a href="#6-å‘é€ä¸‹å•è¯·æ±‚çš„ç½‘ç»œåŒ…" class="headerlink" title="6. å‘é€ä¸‹å•è¯·æ±‚çš„ç½‘ç»œåŒ…"></a>6. å‘é€ä¸‹å•è¯·æ±‚çš„ç½‘ç»œåŒ…</h1><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹è¿æ¥ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å‘é€ä¸‹å•è¯·æ±‚çš„ç½‘ç»œåŒ…äº†ã€‚</p><p>åœ¨ç”¨æˆ·å±‚å‘é€çš„æ˜¯ HTTP çš„ç½‘ç»œåŒ…ï¼Œå› ä¸ºæœåŠ¡ç«¯æä¾›çš„æ˜¯ RESTful APIï¼Œå› è€Œ HTTP å±‚å‘é€çš„å°±æ˜¯ä¸€ä¸ªè¯·æ±‚ã€‚</p><pre><code>POST /purchaseOrder HTTP/1.1Host: www.llchen60.comContent-Type: application/json; charset=utf-8Content-Length: nnn{ &quot;order&quot;: {  &quot;date&quot;: &quot;2018-07-01&quot;,  &quot;className&quot;: &quot; è¶£è°ˆç½‘ç»œåè®® &quot;,  &quot;Author&quot;: &quot; leilei &quot; }}</code></pre><p>HTTPæŠ¥æ–‡åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†</p><ul><li>è¯·æ±‚è¡Œ<ul><li><a href="http://www.llchen60.com/purchaseOrder">www.llchen60.com/purchaseOrder</a></li></ul></li><li>è¯·æ±‚é¦–éƒ¨<ul><li>key valueçš„å½¢å¼ï¼Œ é€šè¿‡å†’å·åˆ†éš” </li></ul></li><li>è¯·æ±‚çš„æ­£æ–‡å®ä½“</li></ul><p>HTTPè¯·æ±‚çš„æŠ¥æ–‡æ ¼å¼æå¥½äº†ä»¥åï¼Œæµè§ˆå™¨ä¼šå°†å…¶äº¤ç»™ä¼ è¾“å±‚ï¼Œäº¤ç»™çš„æ–¹å¼æ˜¯ç”¨socketè¿›è¡Œç¨‹åºè®¾è®¡ã€‚</p><p>HTTPåè®®æ˜¯åŸºäºTCPåè®®çš„ï¼Œæ‰€ä»¥ä½¿ç”¨é¢å‘è¿æ¥çš„æ–¹å¼å‘é€è¯·æ±‚ï¼Œé€šè¿‡StreamäºŒè¿›åˆ¶æµçš„æ–¹å¼ä¼ ç»™å¯¹æ–¹ã€‚åˆ°äº†TCPå±‚ï¼Œå®ƒä¼šæŠŠäºŒè¿›åˆ¶æµå˜æˆä¸€ä¸ªæŠ¥æ–‡æ®µå‘é€ç»™æœåŠ¡å™¨ã€‚</p><p>åœ¨ TCP å¤´é‡Œé¢ï¼Œä¼šæœ‰æºç«¯å£å·å’Œç›®æ ‡ç«¯å£å·ï¼Œ<strong>ç›®æ ‡ç«¯å£å·ä¸€èˆ¬æ˜¯æœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£å·</strong>ï¼Œæºç«¯å£å·åœ¨æ‰‹æœºç«¯ï¼Œå¾€å¾€æ˜¯éšæœºåˆ†é…ä¸€ä¸ªç«¯å£å·ã€‚è¿™ä¸ªç«¯å£å·åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç”¨äºåŒºåˆ†è¯·æ±‚å’Œè¿”å›ï¼Œå‘ç»™é‚£ä¸ªåº”ç”¨ã€‚</p><p>åœ¨ IP å¤´é‡Œé¢ï¼Œéƒ½éœ€è¦åŠ ä¸Šè‡ªå·±çš„åœ°å€ï¼ˆå³æºåœ°å€ï¼‰å’Œå®ƒæƒ³è¦å»çš„åœ°æ–¹ï¼ˆå³ç›®æ ‡åœ°å€ï¼‰ã€‚å½“ä¸€ä¸ªæ‰‹æœºä¸Šçº¿çš„æ—¶å€™ï¼ŒPGW ä¼šç»™è¿™ä¸ªæ‰‹æœºåˆ†é…ä¸€ä¸ª IP åœ°å€ï¼Œè¿™å°±æ˜¯æºåœ°å€ï¼Œè€Œç›®æ ‡åœ°å€åˆ™æ˜¯äº‘å¹³å°çš„è´Ÿè½½å‡è¡¡å™¨çš„å¤–ç½‘ IP åœ°å€ã€‚</p><p>åœ¨ IP å±‚ï¼Œå®¢æˆ·ç«¯éœ€è¦æŸ¥çœ‹ç›®æ ‡åœ°å€å’Œè‡ªå·±æ˜¯å¦æ˜¯åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œè®¡ç®—æ˜¯å¦æ˜¯åŒä¸€ä¸ªç½‘æ®µï¼Œå¾€å¾€éœ€è¦é€šè¿‡ CIDR å­ç½‘æ©ç æ¥è®¡ç®—ã€‚</p><p>å¯¹äºè¿™ä¸ªä¸‹å•åœºæ™¯ï¼Œç›®æ ‡ IP å’Œæº IP ä¸ä¼šåœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œå› è€Œéœ€è¦å‘é€åˆ°é»˜è®¤çš„ç½‘å…³ã€‚ä¸€èˆ¬é€šè¿‡ DHCP åˆ†é… IP åœ°å€çš„æ—¶å€™ï¼ŒåŒæ—¶é…ç½®é»˜è®¤ç½‘å…³çš„ IP åœ°å€ã€‚</p><p>ä½†æ˜¯å®¢æˆ·ç«¯ä¸ä¼šç›´æ¥ä½¿ç”¨é»˜è®¤ç½‘å…³çš„ IP åœ°å€ï¼Œè€Œæ˜¯å‘é€ ARP åè®®ï¼Œæ¥è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œç„¶åå°†ç½‘å…³ MAC ä½œä¸ºç›®æ ‡ MACï¼Œè‡ªå·±çš„ MAC ä½œä¸ºæº MACï¼Œæ”¾å…¥ MAC å¤´ï¼Œå‘é€å‡ºå»ã€‚</p><p>å®Œæ•´çš„ç½‘ç»œåŒ…å¦‚ä¸‹æ‰€ç¤ºï¼š </p><p><img src="https://i.loli.net/2020/02/02/MfVQxW1XCzjuLN7.jpg" alt="fig7.jpg"></p><h1 id="7-æµæ§æ‹¥å¡ä¸é‡ä¼ "><a href="#7-æµæ§æ‹¥å¡ä¸é‡ä¼ " class="headerlink" title="7. æµæ§æ‹¥å¡ä¸é‡ä¼ "></a>7. æµæ§æ‹¥å¡ä¸é‡ä¼ </h1><p>å¯¹äºæ‰‹æœºæ¥è®²ï¼Œé»˜è®¤çš„ç½‘å…³åœ¨ PGW ä¸Šã€‚åœ¨ç§»åŠ¨ç½‘ç»œé‡Œé¢ï¼Œä»æ‰‹æœºåˆ° SGWï¼Œåˆ° PGW æ˜¯æœ‰ä¸€æ¡éš§é“çš„ã€‚åœ¨è¿™æ¡éš§é“é‡Œé¢ï¼Œä¼šå°†ä¸Šé¢çš„è¿™ä¸ªåŒ…ä½œä¸ºéš§é“çš„ä¹˜å®¢åè®®æ”¾åœ¨é‡Œé¢ï¼Œå¤–é¢ SGW å’Œ PGW åœ¨æ ¸å¿ƒç½‘æœºæˆ¿çš„ IP åœ°å€ã€‚ç½‘ç»œåŒ…ç›´åˆ° PGWï¼ˆPGW æ˜¯éš§é“çš„å¦ä¸€ç«¯ï¼‰æ‰å°†é‡Œé¢çš„åŒ…è§£å‡ºæ¥ï¼Œè½¬å‘åˆ°å¤–éƒ¨ç½‘ç»œã€‚</p><p>ä»æ‰‹æœºå‘é€å‡ºæ¥çš„ç½‘ç»œåŒ…çš„ç»“æ„å¦‚ä¸‹ï¼š</p><ul><li>æºMACåœ°å€</li><li>ç›®æ ‡MACåœ°å€ï¼š ç½‘å…³PGWä¸Šé¢çš„éš§é“ç«¯ç‚¹çš„MAC</li><li>æºIPï¼š UEçš„IPåœ°å€</li><li>ç›®æ ‡IPï¼š SLBçš„å…¬ç½‘IPåœ°å€</li></ul><p>è¿›å…¥éš§é“ä¹‹åï¼Œè¦å°è£…å¤–å±‚çš„ç½‘ç»œåœ°å€ï¼Œå› è€Œç½‘ç»œåŒ…çš„æ ¼å¼ä¸ºï¼š</p><ul><li>å¤–å±‚æºMACï¼š E-NodeBçš„MAC</li><li>å¤–å±‚ç›®æ ‡MACï¼š SGWçš„MAC</li><li>å¤–å±‚æºIPï¼š E-NodeBçš„IP</li><li>å¤–å±‚ç›®æ ‡IPï¼š SGWçš„IP</li><li>å†…å±‚æº MACï¼šæ‰‹æœºä¹Ÿå³ UE çš„ MAC</li><li>å†…å±‚ç›®æ ‡ MACï¼šç½‘å…³ PGW ä¸Šé¢çš„éš§é“ç«¯ç‚¹çš„ MAC</li><li>å†…å±‚æº IPï¼šUE çš„ IP åœ°å€</li><li>å†…å±‚ç›®æ ‡ IPï¼šSLB çš„å…¬ç½‘ IP åœ°å€</li></ul><p>å½“éš§é“åœ¨ SGW çš„æ—¶å€™ï¼Œåˆ‡æ¢äº†ä¸€ä¸ªéš§é“ï¼Œä¼šä» SGW åˆ° PGW çš„éš§é“ï¼Œå› è€Œç½‘ç»œåŒ…çš„æ ¼å¼ä¸ºï¼š</p><ul><li>å¤–å±‚æº MACï¼šSGW çš„ MAC</li><li>å¤–å±‚ç›®æ ‡ MACï¼šPGW çš„ MAC</li><li>å¤–å±‚æº IPï¼šSGW çš„ IP</li><li>å¤–å±‚ç›®æ ‡ IPï¼šPGW çš„ IP</li><li>å†…å±‚æº MACï¼šæ‰‹æœºä¹Ÿå³ UE çš„ MAC</li><li>å†…å±‚ç›®æ ‡ MACï¼šç½‘å…³ PGW ä¸Šé¢çš„éš§é“ç«¯ç‚¹çš„ MAC</li><li>å†…å±‚æº IPï¼šUE çš„ IP åœ°å€</li><li>å†…å±‚ç›®æ ‡ IPï¼šSLB çš„å…¬ç½‘ IP åœ°å€</li></ul><p>åœ¨ PGW çš„éš§é“ç«¯ç‚¹å°†åŒ…è§£å‡ºæ¥ï¼Œè½¬å‘å‡ºå»çš„æ—¶å€™ï¼Œä¸€èˆ¬åœ¨ PGW å‡ºå¤–éƒ¨ç½‘ç»œçš„è·¯ç”±å™¨ä¸Šï¼Œä¼šéƒ¨ç½² NAT æœåŠ¡ï¼Œå°†æ‰‹æœºçš„ IP åœ°å€è½¬æ¢ä¸ºå…¬ç½‘ IP åœ°å€ï¼Œå½“è¯·æ±‚è¿”å›çš„æ—¶å€™ï¼Œå† NAT å›æ¥ã€‚å› è€Œåœ¨PGWä¹‹åï¼Œç½‘ç»œåŒ…æ ¼å¼ä¸ºï¼š </p><ul><li>æº MACï¼šPGW å‡ºå£çš„ MACï¼›</li><li>ç›®æ ‡ MACï¼šNAT ç½‘å…³çš„ MACï¼›</li><li>æº IPï¼šUE çš„ IP åœ°å€ï¼›</li><li>ç›®æ ‡ IPï¼šSLB çš„å…¬ç½‘ IP åœ°å€ã€‚</li></ul><p>åœ¨NATç½‘å…³ï¼Œç½‘ç»œåŒ…çš„æ ¼å¼å˜æˆï¼š </p><ul><li>æº MACï¼šNAT ç½‘å…³çš„ MAC</li><li>ç›®æ ‡ MACï¼šA2 è·¯ç”±å™¨çš„ MAC</li><li>æº IPï¼šUE çš„å…¬ç½‘ IP åœ°å€</li><li>ç›®æ ‡ IPï¼šSLB çš„å…¬ç½‘ IP åœ°å€</li></ul><p><img src="https://i.loli.net/2020/02/02/GMPYBduQXoiTgcW.jpg" alt="fig8.jpg"></p><p>å‡ºäº† NAT ç½‘å…³ï¼Œå°±ä»æ ¸å¿ƒç½‘åˆ°è¾¾äº†äº’è”ç½‘ã€‚åœ¨ç½‘ç»œä¸–ç•Œï¼Œæ¯ä¸€ä¸ªè¿è¥å•†çš„ç½‘ç»œæˆä¸ºè‡ªæ²»ç³»ç»Ÿ ASã€‚æ¯ä¸ªè‡ªæ²»ç³»ç»Ÿéƒ½æœ‰è¾¹ç•Œè·¯ç”±å™¨ï¼Œé€šè¿‡å®ƒå’Œå¤–é¢çš„ä¸–ç•Œå»ºç«‹è”ç³»ã€‚</p><p>å¦‚ä½•ä»å‡ºå£çš„è¿è¥å•†åˆ°è¾¾äº‘å¹³å°çš„è¾¹ç•Œè·¯ç”±å™¨ï¼Ÿåœ¨è·¯ç”±å™¨ä¹‹é—´éœ€è¦é€šè¿‡ BGP åè®®å®ç°ï¼ŒBGP åˆåˆ†ä¸ºä¸¤ç±»ï¼ŒeBGP å’Œ iBGPã€‚è‡ªæ²»ç³»ç»Ÿä¹‹é—´ã€è¾¹ç•Œè·¯ç”±å™¨ä¹‹é—´ä½¿ç”¨ eBGP å¹¿æ’­è·¯ç”±ã€‚å†…éƒ¨ç½‘ç»œä¹Ÿéœ€è¦è®¿é—®å…¶ä»–çš„è‡ªæ²»ç³»ç»Ÿã€‚</p><p>è¾¹ç•Œè·¯ç”±å™¨å¦‚ä½•å°† BGP å­¦ä¹ åˆ°çš„è·¯ç”±å¯¼å…¥åˆ°å†…éƒ¨ç½‘ç»œå‘¢ï¼Ÿé€šè¿‡è¿è¡Œ iBGPï¼Œä½¿å†…éƒ¨çš„è·¯ç”±å™¨èƒ½å¤Ÿæ‰¾åˆ°åˆ°è¾¾å¤–ç½‘ç›®çš„åœ°æœ€å¥½çš„è¾¹ç•Œè·¯ç”±å™¨ã€‚</p><p>ç½‘ç«™çš„ SLB çš„å…¬ç½‘ IP åœ°å€æ—©å·²ç»é€šè¿‡äº‘å¹³å°çš„è¾¹ç•Œè·¯ç”±å™¨ï¼Œè®©å…¨ç½‘éƒ½çŸ¥é“äº†ã€‚äºæ˜¯è¿™ä¸ªä¸‹å•çš„ç½‘ç»œåŒ…é€‰æ‹©çš„ä¸‹ä¸€è·³æ˜¯ A2ï¼Œä¹Ÿå³å°† A2 çš„ MAC åœ°å€æ”¾åœ¨ç›®æ ‡ MAC åœ°å€ä¸­ã€‚</p><p>åˆ°è¾¾ A2 ä¹‹åï¼Œä»è·¯ç”±è¡¨ä¸­æ‰¾åˆ°ä¸‹ä¸€è·³æ˜¯è·¯ç”±å™¨ C1ï¼Œäºæ˜¯å°†ç›®æ ‡ MAC æ¢æˆ C1 çš„ MAC åœ°å€ã€‚åˆ°è¾¾ C1 ä¹‹åï¼Œæ‰¾åˆ°ä¸‹ä¸€è·³æ˜¯ C2ï¼Œå°†ç›®æ ‡ MAC åœ°å€è®¾ç½®ä¸º C2 çš„ MACã€‚åˆ°è¾¾ C2 åï¼Œæ‰¾åˆ°ä¸‹ä¸€è·³æ˜¯äº‘å¹³å°çš„è¾¹ç•Œè·¯ç”±å™¨ï¼Œäºæ˜¯å°†ç›®æ ‡ MAC è®¾ç½®ä¸ºè¾¹ç•Œè·¯ç”±å™¨çš„ MAC åœ°å€ã€‚</p><p>ä½ ä¼šå‘ç°ï¼Œè¿™ä¸€è·¯ï¼Œéƒ½æ˜¯åªæ¢ MACï¼Œä¸æ¢ç›®æ ‡ IP åœ°å€ã€‚è¿™å°±æ˜¯æ‰€è°“ä¸‹ä¸€è·³çš„æ¦‚å¿µã€‚åœ¨äº‘å¹³å°çš„è¾¹ç•Œè·¯ç”±å™¨ï¼Œä¼šå°†ä¸‹å•çš„åŒ…è½¬å‘è¿›æ¥ï¼Œç»è¿‡æ ¸å¿ƒäº¤æ¢ï¼Œæ±‡èšäº¤æ¢ï¼Œåˆ°è¾¾å¤–ç½‘ç½‘å…³èŠ‚ç‚¹ä¸Šçš„ SLB çš„å…¬ç½‘ IP åœ°å€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰‹æœºåˆ° SLB çš„å…¬ç½‘ IPï¼Œæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„è¿æ¥ï¼Œè¿æ¥çš„è¿‡ç¨‹å‘é€äº†å¾ˆå¤šåŒ…ã€‚æ‰€æœ‰è¿™äº›åŒ…ï¼Œæ— è®ºæ˜¯ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿˜æ˜¯ HTTPS çš„å¯†é’¥äº¤æ¢ï¼Œéƒ½æ˜¯è¦èµ°å¦‚æ­¤å¤æ‚çš„è¿‡ç¨‹åˆ°è¾¾ SLB çš„ï¼Œå½“ç„¶æ¯ä¸ªåŒ…èµ°çš„è·¯å¾„ä¸ä¸€å®šä¸€è‡´ã€‚</p><p>ç½‘ç»œåŒ…èµ°åœ¨è¿™ä¸ªå¤æ‚çš„é“è·¯ä¸Šï¼Œå¾ˆå¯èƒ½ä¸€ä¸å°å¿ƒå°±ä¸¢äº†ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™å°±éœ€è¦å€ŸåŠ© TCP çš„æœºåˆ¶é‡æ–°å‘é€ã€‚</p><p>æ—¢ç„¶ TCP è¦å¯¹åŒ…è¿›è¡Œé‡ä¼ ï¼Œå°±éœ€è¦ç»´æŠ¤ Sequence Numberï¼Œçœ‹å“ªäº›åŒ…åˆ°äº†ï¼Œå“ªäº›æ²¡åˆ°ï¼Œå“ªäº›éœ€è¦é‡ä¼ ï¼Œä¼ è¾“çš„é€Ÿåº¦åº”è¯¥æ§åˆ¶åˆ°å¤šå°‘ï¼Œè¿™å°±æ˜¯TCPçš„æ»‘åŠ¨çª—å£åè®®ã€‚</p><p><img src="https://i.loli.net/2020/02/02/uKBpG8RZn5lHeEU.jpg" alt="fig9.jpg"></p><p>æ•´ä¸ª TCP çš„å‘é€ï¼Œä¸€å¼€å§‹ä¼šåå•†ä¸€ä¸ª Sequence Numberï¼Œä»è¿™ä¸ª Sequence Number å¼€å§‹ï¼Œæ¯ä¸ªåŒ…éƒ½æœ‰ç¼–å·ã€‚æ»‘åŠ¨çª—å£å°†æ¥æ”¶æ–¹çš„ç½‘ç»œåŒ…åˆ†æˆå››ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å·²ç»æ¥æ”¶ï¼Œå·²ç» ACKï¼Œå·²ç»äº¤ç»™åº”ç”¨å±‚çš„åŒ…</li><li>å·²ç»æ¥æ”¶ï¼Œå·²ç» ACKï¼Œæœªå‘é€ç»™åº”ç”¨å±‚</li><li>å·²ç»æ¥æ”¶ï¼Œå°šæœªå‘é€ ACK</li><li>æœªæ¥æ”¶ï¼Œå°šæœ‰ç©ºé—²çš„ç¼“å­˜åŒºåŸŸ</li></ul><p>å¯¹äº TCP å±‚æ¥è®²ï¼Œæ¯ä¸€ä¸ªåŒ…éƒ½æœ‰ ACKã€‚ACK éœ€è¦ä» SLB å›å¤åˆ°æ‰‹æœºç«¯ï¼Œå°†ä¸Šé¢çš„é‚£ä¸ªè¿‡ç¨‹åå‘æ¥ä¸€éï¼Œå½“ç„¶è·¯å¾„ä¸ä¸€å®šä¸€è‡´ï¼Œå¯è§ ACK ä¹Ÿä¸æ˜¯é‚£ä¹ˆè½»æ¾çš„äº‹æƒ…ã€‚</p><p>å¦‚æœå‘é€æ–¹è¶…è¿‡ä¸€å®šçš„æ—¶é—´æ²¡æœ‰æ”¶åˆ° ACKï¼Œå°±ä¼šé‡æ–°å‘é€ã€‚åªæœ‰ TCP å±‚ ACK è¿‡çš„åŒ…ï¼Œæ‰ä¼šå‘ç»™åº”ç”¨å±‚ï¼Œå¹¶ä¸”åªä¼šå‘é€ä¸€ä»½ï¼Œå¯¹äºä¸‹å•çš„åœºæ™¯ï¼Œåº”ç”¨å±‚æ˜¯ HTTP å±‚ã€‚</p><p>ä½ å¯èƒ½ä¼šé—®äº†ï¼ŒTCP è€æ˜¯é‡å¤å‘é€ï¼Œä¼šä¸ä¼šå¯¼è‡´ä¸€ä¸ªå•ä¸‹äº†ä¸¤éï¼Ÿæ˜¯å¦è¦æ±‚æœåŠ¡ç«¯å®ç°å¹‚ç­‰ï¼Ÿä» TCP çš„æœºåˆ¶æ¥çœ‹ï¼Œæ˜¯ä¸ä¼šçš„ã€‚åªæœ‰æ”¶ä¸åˆ° ACK çš„åŒ…æ‰ä¼šé‡å¤å‘ï¼Œå‘åˆ°æ¥æ”¶ç«¯ï¼Œåœ¨çª—å£é‡Œé¢åªä¿å­˜ä¸€ä»½ï¼Œæ‰€ä»¥åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒé‡ä¼ å¯¼è‡´äºŒæ¬¡ä¸‹å•ã€‚</p><p>ä½†æ˜¯ TCP è¿æ¥ä¼šå› ä¸ºæŸç§åŸå› æ–­äº†ï¼Œä¾‹å¦‚æ‰‹æœºä¿¡å·ä¸å¥½ï¼Œè¿™ä¸ªæ—¶å€™æ‰‹æœºæŠŠæ‰€æœ‰çš„åŠ¨ä½œé‡æ–°åšä¸€éï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„ TCP è¿æ¥ï¼Œåœ¨ HTTP å±‚è°ƒç”¨ä¸¤æ¬¡ RESTful APIã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½ä¼šå¯¼è‡´ä¸¤éä¸‹å•çš„æƒ…å†µï¼Œå› è€Œ RESTful API éœ€è¦å®ç°å¹‚ç­‰ã€‚</p><p>å½“ ACK è¿‡çš„åŒ…å‘ç»™åº”ç”¨å±‚ä¹‹åï¼ŒTCP å±‚çš„ç¼“å­˜å°±ç©ºäº†å‡ºæ¥ï¼Œè¿™ä¼šå¯¼è‡´ä¸Šé¢å›¾ä¸­çš„å¤§ä¸‰è§’ï¼Œä¹Ÿå³æ¥æ”¶æ–¹èƒ½å¤Ÿå®¹çº³çš„æ€»ç¼“å­˜ï¼Œæ•´ä½“é¡ºæ—¶é’ˆæ»‘åŠ¨ã€‚å°çš„ä¸‰è§’å½¢ï¼Œä¹Ÿå³æ¥æ”¶æ–¹å‘ŠçŸ¥å‘é€æ–¹çš„çª—å£æ€»å¤§å°ï¼Œä¹Ÿå³è¿˜æ²¡æœ‰å®Œå…¨ç¡®è®¤æ”¶åˆ°çš„ç¼“å­˜å¤§å°ï¼Œå¦‚æœæŠŠè¿™äº›å¡«æ»¡äº†ï¼Œå°±ä¸èƒ½å†å‘äº†ï¼Œå› ä¸ºæ²¡ç¡®è®¤æ”¶åˆ°ï¼Œæ‰€ä»¥ä¸€ä¸ªéƒ½ä¸èƒ½æ‰”ã€‚</p><h1 id="8-ä»æ•°æ®ä¸­å¿ƒè¿›ç½‘å…³ï¼Œå…¬ç½‘NATæˆç§ç½‘"><a href="#8-ä»æ•°æ®ä¸­å¿ƒè¿›ç½‘å…³ï¼Œå…¬ç½‘NATæˆç§ç½‘" class="headerlink" title="8. ä»æ•°æ®ä¸­å¿ƒè¿›ç½‘å…³ï¼Œå…¬ç½‘NATæˆç§ç½‘"></a>8. ä»æ•°æ®ä¸­å¿ƒè¿›ç½‘å…³ï¼Œå…¬ç½‘NATæˆç§ç½‘</h1><p>åŒ…ä»æ‰‹æœºç«¯åˆ°äº†SLBå…¬ç½‘IPæ‰€åœ¨çš„å…¬ç½‘ç½‘å£ï¼Œç”±äºåŒ¹é…ä¸Šäº†MACåœ°å€å’ŒIPåœ°å€ï¼Œå› è€Œå°†ç½‘ç»œåŒ…æ”¶äº†èµ·æ¥ã€‚</p><p><img src="https://i.loli.net/2020/02/02/I4NUqCcgnXFZ5TQ.jpg" alt="fig10.jpg"></p><p>åœ¨è™šæ‹Ÿç½‘å…³èŠ‚ç‚¹çš„å¤–ç½‘ç½‘å£ä¸Šï¼Œä¼šæœ‰ä¸€ä¸ª NAT è§„åˆ™ï¼Œå°†å…¬ç½‘ IP åœ°å€è½¬æ¢ä¸º VPC é‡Œé¢çš„ç§ç½‘ IP åœ°å€ï¼Œè¿™ä¸ªç§ç½‘ IP åœ°å€å°±æ˜¯ SLB çš„ HAProxy æ‰€åœ¨çš„è™šæ‹Ÿæœºçš„ç§ç½‘ IP åœ°å€ã€‚</p><p>å½“ç„¶ä¸ºäº†æ‰¿è½½æ¯”è¾ƒå¤§çš„ååé‡ï¼Œè™šæ‹Ÿç½‘å…³èŠ‚ç‚¹ä¼šæœ‰å¤šä¸ªï¼Œç‰©ç†ç½‘ç»œä¼šå°†æµé‡åˆ†å‘åˆ°ä¸åŒçš„è™šæ‹Ÿç½‘å…³èŠ‚ç‚¹ã€‚åŒæ · HAProxy ä¹Ÿä¼šæ˜¯ä¸€ä¸ªå¤§çš„é›†ç¾¤ï¼Œè™šæ‹Ÿç½‘å…³ä¼šé€‰æ‹©æŸä¸ªè´Ÿè½½å‡è¡¡èŠ‚ç‚¹ï¼Œå°†æŸä¸ªè¯·æ±‚åˆ†å‘ç»™å®ƒï¼Œè´Ÿè½½å‡è¡¡ä¹‹åæ˜¯ Controller å±‚ï¼Œä¹Ÿæ˜¯éƒ¨ç½²åœ¨è™šæ‹Ÿæœºé‡Œé¢çš„ã€‚</p><p>å½“ç½‘ç»œåŒ…é‡Œé¢çš„ç›®æ ‡ IP å˜æˆç§æœ‰ IP åœ°å€ä¹‹åï¼Œè™šæ‹Ÿè·¯ç”±ä¼šæŸ¥æ‰¾è·¯ç”±è§„åˆ™ï¼Œå°†ç½‘ç»œåŒ…ä»ä¸‹æ–¹çš„ç§ç½‘ç½‘å£å‘å‡ºæ¥ã€‚è¿™ä¸ªæ—¶å€™åŒ…çš„æ ¼å¼ä¸ºï¼š</p><ul><li>æº MACï¼šç½‘å…³ MACï¼›</li><li>ç›®æ ‡ MACï¼šHAProxy è™šæ‹Ÿæœºçš„ MACï¼›</li><li>æº IPï¼šUE çš„å…¬ç½‘ IPï¼›</li><li>ç›®æ ‡ IPï¼šHAProxy è™šæ‹Ÿæœºçš„ç§ç½‘ IPã€‚</li></ul><h1 id="9-è¿›å…¥éš§é“ï¼ŒRPCè¿œç¨‹è°ƒç”¨ä¸‹å•"><a href="#9-è¿›å…¥éš§é“ï¼ŒRPCè¿œç¨‹è°ƒç”¨ä¸‹å•" class="headerlink" title="9. è¿›å…¥éš§é“ï¼ŒRPCè¿œç¨‹è°ƒç”¨ä¸‹å•"></a>9. è¿›å…¥éš§é“ï¼ŒRPCè¿œç¨‹è°ƒç”¨ä¸‹å•</h1><p>åœ¨è™šæ‹Ÿè·¯ç”±èŠ‚ç‚¹ä¸Šï¼Œä¹Ÿä¼šæœ‰ OVSï¼Œå°†ç½‘ç»œåŒ…å°è£…åœ¨ VXLAN éš§é“é‡Œé¢ï¼ŒVXLAN ID å°±æ˜¯ç»™ä½ çš„ç§Ÿæˆ·åˆ›å»º VPC çš„æ—¶å€™åˆ†é…çš„ã€‚åŒ…çš„æ ¼å¼ä¸ºï¼š</p><ul><li>å¤–å±‚æº MACï¼šç½‘å…³ç‰©ç†æœº MACï¼›</li><li>å¤–å±‚ç›®æ ‡ MACï¼šç‰©ç†æœº A çš„ MACï¼›</li><li>å¤–å±‚æº IPï¼šç½‘å…³ç‰©ç†æœº IPï¼›</li><li>å¤–å±‚ç›®æ ‡ IPï¼šç‰©ç†æœº A çš„ IPï¼›</li><li>å†…å±‚æº MACï¼šç½‘å…³ MACï¼›</li><li>å†…å±‚ç›®æ ‡ MACï¼šHAProxy è™šæ‹Ÿæœºçš„ MACï¼›</li><li>å†…å±‚æº IPï¼šUE çš„å…¬ç½‘ IPï¼›</li><li>å†…å±‚ç›®æ ‡ IPï¼šHAProxy è™šæ‹Ÿæœºçš„ç§ç½‘ IPã€‚</li></ul><p>åœ¨ç‰©ç†æœº A ä¸Šï¼ŒOVS ä¼šå°†åŒ…ä» VXLAN éš§é“é‡Œé¢è§£å‡ºæ¥ï¼Œå‘ç»™ HAProxy æ‰€åœ¨çš„è™šæ‹Ÿæœºã€‚HAProxy æ‰€åœ¨çš„è™šæ‹Ÿæœºå‘ç° MAC åœ°å€åŒ¹é…ï¼Œç›®æ ‡ IP åœ°å€åŒ¹é…ï¼Œå°±æ ¹æ® TCP ç«¯å£ï¼Œå°†åŒ…å‘ç»™ HAProxy è¿›ç¨‹ï¼Œå› ä¸º HAProxy æ˜¯åœ¨ç›‘å¬è¿™ä¸ª TCP ç«¯å£çš„ã€‚å› è€Œ HAProxy å°±æ˜¯è¿™ä¸ª TCP è¿æ¥çš„æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯æ˜¯æ‰‹æœºã€‚å¯¹äº TCP çš„è¿æ¥çŠ¶æ€ã€æ»‘åŠ¨çª—å£ç­‰ï¼Œéƒ½æ˜¯åœ¨ HAProxy ä¸Šç»´æŠ¤çš„ã€‚</p><p>åœ¨è¿™é‡Œ HAProxy æ˜¯ä¸€ä¸ªå››å±‚è´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå³å®ƒåªè§£æåˆ° TCP å±‚ï¼Œé‡Œé¢çš„ HTTP åè®®å®ƒä¸å…³å¿ƒï¼Œå°±å°†è¯·æ±‚è½¬å‘ç»™åç«¯çš„å¤šä¸ª Controller å±‚çš„ä¸€ä¸ªã€‚</p><p>HAProxy å‘å‡ºå»çš„ç½‘ç»œåŒ…å°±è®¤ä¸º HAProxy æ˜¯å®¢æˆ·ç«¯äº†ï¼Œçœ‹ä¸åˆ°æ‰‹æœºç«¯äº†ã€‚ç½‘ç»œåŒ…æ ¼å¼å¦‚ä¸‹ï¼š</p><ul><li>æº MACï¼šHAProxy æ‰€åœ¨è™šæ‹Ÿæœºçš„ MACï¼›</li><li>ç›®æ ‡ MACï¼šController å±‚æ‰€åœ¨è™šæ‹Ÿæœºçš„ MACï¼›</li><li>æº IPï¼šHAProxy æ‰€åœ¨è™šæ‹Ÿæœºçš„ç§ç½‘ IPï¼›</li><li>ç›®æ ‡ IPï¼šController å±‚æ‰€åœ¨è™šæ‹Ÿæœºçš„ç§ç½‘ IPã€‚</li></ul><p>è¿™ä¸ªåŒ…å‘å‡ºå»ä¹‹åï¼Œä¼šè¢«ç‰©ç†æœºä¸Šçš„OVSæ”¾å…¥VXLANéš§é“é‡Œé¢ï¼Œç½‘ç»œåŒ…æ ¼å¼ä¸º;</p><ul><li>å¤–å±‚æº MACï¼šç‰©ç†æœº A çš„ MACï¼›</li><li>å¤–å±‚ç›®æ ‡ MACï¼šç‰©ç†æœº B çš„ MACï¼›</li><li>å¤–å±‚æº IPï¼šç‰©ç†æœº A çš„ IPï¼›</li><li>å¤–å±‚ç›®æ ‡ IPï¼šç‰©ç†æœº B çš„ IPï¼›</li><li>å†…å±‚æº MACï¼šHAProxy æ‰€åœ¨è™šæ‹Ÿæœºçš„ MACï¼›</li><li>å†…å±‚ç›®æ ‡ MACï¼šController å±‚æ‰€åœ¨è™šæ‹Ÿæœºçš„ MACï¼›</li><li>å†…å±‚æº IPï¼šHAProxy æ‰€åœ¨è™šæ‹Ÿæœºçš„ç§ç½‘ IPï¼›</li><li>å†…å±‚ç›®æ ‡ IPï¼šController å±‚æ‰€åœ¨è™šæ‹Ÿæœºçš„ç§ç½‘ IPã€‚</li></ul><p>åœ¨ç‰©ç†æœº B ä¸Šï¼ŒOVS ä¼šå°†åŒ…ä» VXLAN éš§é“é‡Œé¢è§£å‡ºæ¥ï¼Œå‘ç»™ Controller å±‚æ‰€åœ¨çš„è™šæ‹Ÿæœºã€‚Controller å±‚æ‰€åœ¨çš„è™šæ‹Ÿæœºå‘ç° MAC åœ°å€åŒ¹é…ï¼Œç›®æ ‡ IP åœ°å€åŒ¹é…ï¼Œå°±æ ¹æ® TCP ç«¯å£ï¼Œå°†åŒ…å‘ç»™ Controller å±‚çš„è¿›ç¨‹ï¼Œå› ä¸ºå®ƒåœ¨ç›‘å¬è¿™ä¸ª TCP ç«¯å£ã€‚</p><p>åœ¨ HAProxy å’Œ Controller å±‚ä¹‹é—´ï¼Œç»´æŠ¤ä¸€ä¸ª TCP çš„è¿æ¥ã€‚</p><p>Controller å±‚æ”¶åˆ°åŒ…ä¹‹åï¼Œå®ƒæ˜¯å…³å¿ƒ HTTP é‡Œé¢æ˜¯ä»€ä¹ˆçš„ï¼Œäºæ˜¯è§£å¼€ HTTP çš„åŒ…ï¼Œå‘ç°æ˜¯ä¸€ä¸ª POST è¯·æ±‚ï¼Œå†…å®¹æ˜¯ä¸‹å•è´­ä¹°ä¸€ä¸ªè¯¾ç¨‹ã€‚</p><h1 id="10-ä¸‹å•æ‰£å‡åº“å­˜ï¼Œæ•°æ®å…¥åº“è¿”å›æˆåŠŸ"><a href="#10-ä¸‹å•æ‰£å‡åº“å­˜ï¼Œæ•°æ®å…¥åº“è¿”å›æˆåŠŸ" class="headerlink" title="10. ä¸‹å•æ‰£å‡åº“å­˜ï¼Œæ•°æ®å…¥åº“è¿”å›æˆåŠŸ"></a>10. ä¸‹å•æ‰£å‡åº“å­˜ï¼Œæ•°æ®å…¥åº“è¿”å›æˆåŠŸ</h1><p>ä¸€èˆ¬åœ¨ç»„åˆæœåŠ¡å±‚ä¼šæœ‰ä¸“é—¨ç®¡ç†ä¸‹å•çš„æœåŠ¡ï¼ŒControllerå±‚ä¼šé€šè¿‡RPCè°ƒç”¨è¿™ä¸ªç»„åˆæœåŠ¡å±‚ã€‚</p><p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Dubboï¼Œåˆ™ Controller å±‚éœ€è¦è¯»å–æ³¨å†Œä¸­å¿ƒï¼Œå°†ä¸‹å•æœåŠ¡çš„è¿›ç¨‹åˆ—è¡¨æ‹¿å‡ºæ¥ï¼Œé€‰å‡ºä¸€ä¸ªæ¥è°ƒç”¨ã€‚Dubbo ä¸­é»˜è®¤çš„ RPC åè®®æ˜¯ Hessian2ã€‚Hessian2 å°†ä¸‹å•çš„è¿œç¨‹è°ƒç”¨åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶è¿›è¡Œä¼ è¾“ã€‚</p><p>Netty æ˜¯ä¸€ä¸ªéé˜»å¡çš„åŸºäºäº‹ä»¶çš„ç½‘ç»œä¼ è¾“æ¡†æ¶ã€‚Controller å±‚å’Œä¸‹å•æœåŠ¡ä¹‹é—´ï¼Œä½¿ç”¨äº† Netty çš„ç½‘ç»œä¼ è¾“æ¡†æ¶ã€‚æœ‰äº† Nettyï¼Œå°±ä¸ç”¨è‡ªå·±ç¼–å†™å¤æ‚çš„å¼‚æ­¥ Socket ç¨‹åºäº†ã€‚Netty ä½¿ç”¨çš„æ–¹å¼ï¼Œå°±æ˜¯IOå¤šè·¯å¤ç”¨ã€‚</p><p>Netty è¿˜æ˜¯å·¥ä½œåœ¨ Socket è¿™ä¸€å±‚çš„ï¼Œå‘é€çš„ç½‘ç»œåŒ…è¿˜æ˜¯åŸºäº TCP çš„ã€‚åœ¨ TCP çš„ä¸‹å±‚ï¼Œè¿˜æ˜¯éœ€è¦å°è£…ä¸Š IP å¤´å’Œ MAC å¤´ã€‚å¦‚æœè·¨ç‰©ç†æœºé€šä¿¡ï¼Œè¿˜æ˜¯éœ€è¦å°è£…çš„å¤–å±‚çš„ VXLAN éš§é“é‡Œé¢ã€‚å½“ç„¶åº•å±‚çš„è¿™äº›å°è£…ï¼ŒNetty éƒ½ä¸æ„ŸçŸ¥ï¼Œå®ƒåªè¦åšå¥½å®ƒçš„å¼‚æ­¥é€šä¿¡å³å¯ã€‚</p><p>åœ¨ Netty çš„æœåŠ¡ç«¯ï¼Œä¹Ÿå³ä¸‹å•æœåŠ¡ä¸­ï¼Œæ”¶åˆ°è¯·æ±‚åï¼Œå…ˆç”¨ Hessian2 çš„æ ¼å¼è¿›è¡Œè§£å‹ç¼©ã€‚ç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°çº¿ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œåœ¨çº¿ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨ä¸‹å•çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>ä¸‹å•çš„ä¸šåŠ¡é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œå¾€å¾€è¦è°ƒç”¨åŸºç¡€æœåŠ¡å±‚é‡Œé¢çš„åº“å­˜æœåŠ¡ã€ä¼˜æƒ åˆ¸æœåŠ¡ç­‰ï¼Œå°†å¤šä¸ªæœåŠ¡è°ƒç”¨å®Œæ¯•ï¼Œæ‰ç®—ä¸‹å•æˆåŠŸã€‚ä¸‹å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡å’Œä¼˜æƒ åˆ¸æœåŠ¡ï¼Œä¹Ÿæ˜¯é€šè¿‡ Dubbo çš„æ¡†æ¶ï¼Œé€šè¿‡æ³¨å†Œä¸­å¿ƒæ‹¿åˆ°åº“å­˜æœåŠ¡å’Œä¼˜æƒ åˆ¸æœåŠ¡çš„åˆ—è¡¨ï¼Œç„¶åé€‰ä¸€ä¸ªè°ƒç”¨ã€‚</p><p>è°ƒç”¨çš„æ—¶å€™ï¼Œç»Ÿä¸€ä½¿ç”¨ Hessian2 è¿›è¡Œåºåˆ—åŒ–ï¼Œä½¿ç”¨ Netty è¿›è¡Œä¼ è¾“ï¼Œåº•å±‚å¦‚æœè·¨ç‰©ç†æœºï¼Œä»ç„¶éœ€è¦é€šè¿‡ VXLAN çš„å°è£…å’Œè§£å°è£…ã€‚</p><p>å’±ä»¬ä»¥åº“å­˜ä¸ºä¾‹å­çš„æ—¶å€™ï¼Œè®²è¿°è¿‡å¹‚ç­‰çš„æ¥å£å®ç°çš„é—®é¢˜ã€‚å› ä¸ºå¦‚æœæ‰£å‡åº“å­˜ï¼Œä»…ä»…æ˜¯è°è°ƒç”¨è°å‡ä¸€ã€‚è¿™æ ·å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ‰£å‡åº“å­˜å› ä¸ºä¸€æ¬¡è°ƒç”¨å¤±è´¥ï¼Œè€Œå¤šæ¬¡è°ƒç”¨ï¼Œè¿™é‡ŒæŒ‡çš„ä¸æ˜¯ TCP å¤šæ¬¡é‡è¯•ï¼Œè€Œæ˜¯åº”ç”¨å±‚è°ƒç”¨çš„å¤šæ¬¡é‡è¯•ï¼Œå°±ä¼šå­˜åœ¨åº“å­˜æ‰£å‡å¤šæ¬¡çš„æƒ…å†µã€‚</p><p>è¿™é‡Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨ä¹è§‚é”ï¼ˆCompare and Setï¼Œç®€ç§° CASï¼‰ã€‚CAS è¦è€ƒè™‘ä¸‰ä¸ªæ–¹é¢ï¼Œå½“å‰çš„åº“å­˜æ•°ã€é¢„æœŸåŸæ¥çš„åº“å­˜æ•°å’Œç‰ˆæœ¬ï¼Œä»¥åŠæ–°çš„åº“å­˜æ•°ã€‚åœ¨æ“ä½œä¹‹å‰ï¼ŒæŸ¥è¯¢å‡ºåŸæ¥çš„åº“å­˜æ•°å’Œç‰ˆæœ¬ï¼ŒçœŸæ­£æ‰£å‡åº“å­˜çš„æ—¶å€™ï¼Œåˆ¤æ–­å¦‚æœå½“å‰åº“å­˜çš„å€¼ä¸é¢„æœŸåŸå€¼å’Œç‰ˆæœ¬ç›¸åŒ¹é…ï¼Œåˆ™å°†åº“å­˜å€¼æ›´æ–°ä¸ºæ–°å€¼ï¼Œå¦åˆ™ä¸åšä»»ä½•æ“ä½œã€‚</p><p>è¿™æ˜¯ä¸€ç§åŸºäºçŠ¶æ€è€ŒéåŸºäºåŠ¨ä½œçš„è®¾è®¡ï¼Œç¬¦åˆ RESTful çš„æ¶æ„è®¾è®¡åŸåˆ™ã€‚è¿™æ ·çš„è®¾è®¡æœ‰åˆ©äºé«˜å¹¶å‘åœºæ™¯ã€‚å½“å¤šä¸ªçº¿ç¨‹å°è¯•ä½¿ç”¨ CAS åŒæ—¶æ›´æ–°åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹èƒ½æ›´æ–°å˜é‡çš„å€¼ï¼Œè€Œå…¶å®ƒçº¿ç¨‹éƒ½å¤±è´¥ï¼Œå¤±è´¥çš„çº¿ç¨‹å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ˜¯è¢«å‘ŠçŸ¥è¿™æ¬¡ç«äº‰ä¸­å¤±è´¥ï¼Œå¹¶å¯ä»¥å†æ¬¡å°è¯•ã€‚</p><p>æœ€ç»ˆï¼Œå½“ä¸‹å•æ›´æ–°åˆ°åˆ†å¸ƒå¼æ•°æ®åº“å½“ä¸­ä¹‹åï¼Œæ•´ä¸ªä¸‹å•è¿‡ç¨‹ç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> Distributed System </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(å) - RPC, SOAP, RESTful</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%8D%81-RPC-SOAP-RESTful/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%8D%81-RPC-SOAP-RESTful/</url>
      
        <content type="html"><![CDATA[<h1 id="1-RPCåè®®ç»¼è¿°"><a href="#1-RPCåè®®ç»¼è¿°" class="headerlink" title="1. RPCåè®®ç»¼è¿°"></a>1. RPCåè®®ç»¼è¿°</h1><p><img src="https://i.loli.net/2020/02/02/jrVzNFexLaUElXY.jpg" alt="fig1.jpg"></p><p>æˆ‘ä»¬éœ€è¦ç ”ç©¶çš„æ˜¯åœ¨ç½‘ç»œæ‰“é€šä»¥åï¼ŒæœåŠ¡ä¹‹é—´æ˜¯å¦‚ä½•äº’ç›¸è°ƒç”¨çš„å‘¢ï¼Ÿ</p><p>å®è´¨ä¸Šæ˜¯è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹ä¹‹é—´å»ºç«‹ä¸€ä¸ªTCPæˆ–è€…UDPè¿æ¥ï¼Œæ¥è¿›è¡Œé€šä¿¡çš„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/sWc8My2XSKHukzv.jpg" alt="fig2.jpg"></p><p>ä½†æ˜¯å®é™…è¿‡ç¨‹ä¼šéå¸¸å¤æ‚ï¼Œå‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œå³å®¢æˆ·ç«¯è°ƒç”¨ä¸€ä¸ªåŠ æ³•å‡½æ•°ï¼Œå°†ä¸¤ä¸ªæ•´æ•°ç›¸åŠ è¿”å›ä»–ä»¬çš„å’Œã€‚æ”¾åœ¨è¿œç¨‹è°ƒç”¨ä¸Šï¼Œå› ä¸ºè¦ç‰µæ‰¯åˆ°ç½‘ç»œï¼Œå°±è¦ç‰µæ‰¯åˆ°Socketç¼–ç¨‹.</p><h2 id="1-1-å®ç°è¿œç¨‹è°ƒç”¨çš„é—®é¢˜"><a href="#1-1-å®ç°è¿œç¨‹è°ƒç”¨çš„é—®é¢˜" class="headerlink" title="1.1 å®ç°è¿œç¨‹è°ƒç”¨çš„é—®é¢˜"></a>1.1 å®ç°è¿œç¨‹è°ƒç”¨çš„é—®é¢˜</h2><ol><li>å¦‚ä½•è§„å®šè¿œç¨‹è°ƒç”¨çš„è¯­æ³•ï¼Ÿ </li></ol><p>å¦‚ä½•è¡¨ç¤ºåŠ å‡ï¼Œå¦‚ä½•è¡¨ç¤ºæ•´æ•°é—´çš„å’Œå°æ•°é—´çš„ï¼Ÿ </p><ol start="2"><li>å¦‚ä½•ä¼ é€’å‚æ•°ï¼Ÿ </li></ol><p>å‚æ•°å’Œæ“ä½œç¬¦çš„ä¼ é€’é¡ºåºï¼›TCPæµå¦‚ä½•åŒºåˆ†å„ä¸ªå‚æ•°</p><ol start="3"><li>å¦‚ä½•è¡¨ç¤ºæ•°æ®ï¼Ÿ</li></ol><p>å¯¹äºé•¿åº¦ä¸ä¸€å®šçš„ç±»ï¼Œç»“æ„ä½“ï¼Œæ€ä¹ˆç»™ç©ºé—´æ¥ä¼ é€’ï¼Ÿ<br>Big Endian å’ŒLittle Endianï¼Œé‡‡ç”¨çš„æ–¹å¼ä¸ä¸€æ ·çš„é—®é¢˜ã€‚</p><ol start="4"><li>å¦‚ä½•çŸ¥é“ä¸€ä¸ªæœåŠ¡ç«¯éƒ½å®ç°äº†å“ªäº›è¿œç¨‹è°ƒç”¨ï¼Ÿä»å“ªä¸ªç«¯å£å¯ä»¥è®¿é—®åˆ°ï¼Ÿ</li></ol><p>å‡è®¾æœåŠ¡ç«¯å®ç°äº†å¤šä¸ªè¿œç¨‹è°ƒç”¨ï¼Œæ¯ä¸ªå¯èƒ½å®ç°åœ¨ä¸åŒçš„è¿›ç¨‹å½“ä¸­ï¼Œç›‘å¬çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œè€Œä¸”ç”±äºæœåŠ¡ç«¯éƒ½æ˜¯è‡ªå·±å®ç°çš„ï¼Œä¸å¯èƒ½ä½¿ç”¨ä¸€ä¸ªå¤§å®¶éƒ½å…¬è®¤çš„ç«¯å£ï¼Œè€Œä¸”æœ‰å¯èƒ½å¤šä¸ªè¿›ç¨‹éƒ¨ç½²åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå¤§å®¶å°±éœ€è¦æŠ¢å ç«¯å£ï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼Œå¾€å¾€ä½¿ç”¨éšæœºç«¯å£ï¼Œé‚£å®¢æˆ·ç«¯å¦‚ä½•æ‰¾åˆ°è¿™äº›ç›‘å¬çš„ç«¯å£å‘¢ï¼Ÿ</p><ol start="5"><li>å‘ç”Ÿäº†é”™è¯¯ã€é‡ä¼ ã€ä¸¢åŒ…ã€æ€§èƒ½ç­‰é—®é¢˜æ€ä¹ˆåŠï¼Ÿ </li></ol><p>æœ¬åœ°è°ƒç”¨æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ä¸€æ—¦åˆ°ç½‘ç»œä¸Šï¼Œè¿™äº›é—®é¢˜éƒ½éœ€è¦å¤„ç†ï¼Œå› ä¸ºç½‘ç»œæ˜¯ä¸å¯é çš„ï¼Œè™½ç„¶åœ¨åŒä¸€ä¸ªè¿æ¥ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯é€šè¿‡ TCP åè®®ä¿è¯ä¸¢åŒ…ã€é‡ä¼ çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨å´©æºƒäº†åˆé‡å¯ï¼Œå½“å‰è¿æ¥æ–­å¼€äº†ï¼ŒTCP å°±ä¿è¯ä¸äº†äº†ï¼Œéœ€è¦åº”ç”¨è‡ªå·±è¿›è¡Œé‡æ–°è°ƒç”¨ï¼Œé‡æ–°ä¼ è¾“ä¼šä¸ä¼šåŒæ ·çš„æ“ä½œåšä¸¤éï¼Œè¿œç¨‹è°ƒç”¨æ€§èƒ½ä¼šä¸ä¼šå—å½±å“å‘¢ï¼Ÿ</p><h2 id="1-2-åè®®çº¦å®šé—®é¢˜"><a href="#1-2-åè®®çº¦å®šé—®é¢˜" class="headerlink" title="1.2 åè®®çº¦å®šé—®é¢˜"></a>1.2 åè®®çº¦å®šé—®é¢˜</h2><p>ä¸Šè¿°çš„å„ç§é—®é¢˜æ˜¯éœ€è¦æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åå•†æ¥è§£å†³çš„ï¼ŒJay Nelsonå†™äº†ä¸€ç¯‡è®ºæ–‡ï¼Œ<a href="http://www.cs.cmu.edu/~dga/15-712/F07/papers/birrell842.pdf" target="_blank" rel="noopener">Implementing Remote Procedure Calls</a> å®šä¹‰äº†RPCçš„æ ‡å‡†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/KJDQzCel3fSuvTy.jpg" alt="fig3.jpg"></p><h3 id="1-2-1-å®¢æˆ·ç«¯å‘èµ·è¿œç¨‹è°ƒç”¨"><a href="#1-2-1-å®¢æˆ·ç«¯å‘èµ·è¿œç¨‹è°ƒç”¨" class="headerlink" title="1.2.1 å®¢æˆ·ç«¯å‘èµ·è¿œç¨‹è°ƒç”¨"></a>1.2.1 å®¢æˆ·ç«¯å‘èµ·è¿œç¨‹è°ƒç”¨</h3><p>é€šè¿‡æœ¬åœ°è°ƒç”¨æœ¬åœ°è°ƒç”¨æ–¹çš„Stubï¼Œè´Ÿè´£å°†è°ƒç”¨çš„æ¥å£ã€æ–¹æ³•å’Œå‚æ•°ï¼Œé€šè¿‡çº¦å®šçš„åè®®è§„èŒƒè¿›è¡Œç¼–ç ï¼Œå¹¶é€šè¿‡æœ¬åœ°çš„RPCRuntimeè¿›è¡Œä¼ è¾“ï¼Œå°†è°ƒç”¨ç½‘ç»œåŒ…å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚</p><h3 id="1-2-2-æœåŠ¡å™¨ç«¯å¤„ç†è¯·æ±‚"><a href="#1-2-2-æœåŠ¡å™¨ç«¯å¤„ç†è¯·æ±‚" class="headerlink" title="1.2.2 æœåŠ¡å™¨ç«¯å¤„ç†è¯·æ±‚"></a>1.2.2 æœåŠ¡å™¨ç«¯å¤„ç†è¯·æ±‚</h3><p>æœåŠ¡å™¨ç«¯çš„RPCRuntimeæ”¶åˆ°è¯·æ±‚ä»¥åï¼Œäº¤ç»™æä¾›æ–¹Stubè¿›è¡Œè§£ç ï¼Œç„¶åè°ƒç”¨æœåŠ¡ç«¯çš„æ–¹æ³•ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œæ–¹æ³•ï¼Œè¿”å›ç»“æœï¼Œæä¾›æ–¹Stubå°†è¿”å›ç»“æœç¼–ç åï¼Œå‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯çš„RPCRuntimeæ”¶åˆ°ç»“æœï¼Œå‘ç»™è°ƒç”¨æ–¹Stubè§£ç å¾—åˆ°ç»“æœï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><h3 id="1-2-3-åˆ†æ"><a href="#1-2-3-åˆ†æ" class="headerlink" title="1.2.3 åˆ†æ"></a>1.2.3 åˆ†æ</h3><p>è¿™é‡Œé¢åˆ†äº†ä¸‰ä¸ªå±‚æ¬¡ï¼Œå¯¹äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼Œéƒ½åƒæ˜¯æœ¬åœ°è°ƒç”¨ä¸€æ ·ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å¤„ç†å°±å¯ä»¥äº†ã€‚å¯¹äºStubå±‚ï¼Œä¸»è¦å¤„ç†åŒæ–¹çº¦å®šå¥½çš„è¯­æ³•ã€è¯­ä¹‰ã€å°è£…ã€è§£å°è£…ã€‚å¯¹äºRPCRuntimeï¼Œä¸»è¦å¤„ç†é«˜æ€§èƒ½çš„ä¼ è¾“ï¼Œä»¥åŠç½‘ç»œçš„é”™è¯¯å’Œå¼‚å¸¸ã€‚</p><h2 id="1-3-RPCè°ƒç”¨ç»†èŠ‚"><a href="#1-3-RPCè°ƒç”¨ç»†èŠ‚" class="headerlink" title="1.3 RPCè°ƒç”¨ç»†èŠ‚"></a>1.3 RPCè°ƒç”¨ç»†èŠ‚</h2><p>æœ€æ—©çš„RPCæ˜¯åœ¨NFSåè®®ä¸­ä½¿ç”¨çš„ã€‚NFS(Network File System)å°±æ˜¯ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿã€‚è¦ä½¿NFSæˆåŠŸè¿è¡Œï¼Œè¦å¯åŠ¨ä¸¤ä¸ªæœåŠ¡ç«¯ï¼Œä¸€ä¸ªæ˜¯MountIDï¼Œç”¨æ¥æŒ‚è½½æ–‡ä»¶è·¯å¾„ï¼›ä¸€ä¸ªæ˜¯nfsdï¼Œç”¨æ¥è¯»å†™æ–‡ä»¶ã€‚NFSå¯ä»¥åœ¨æœ¬åœ°mountä¸€ä¸ªè¿œç¨‹çš„ç›®å½•åˆ°æœ¬åœ°çš„ä¸€ä¸ªç›®å½•ï¼Œä»è€Œæœ¬åœ°çš„ç”¨æˆ·åœ¨è¿™ä¸ªç›®å½•é‡Œé¢è¯»å†™çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ“ä½œçš„æ˜¯è¿œç¨‹å¦ä¸€å°æœºå™¨ä¸Šçš„æ–‡ä»¶ã€‚</p><p><img src="https://i.loli.net/2020/02/02/lQ6Cbu58OWX7vTE.jpg" alt="fig4.jpg"></p><p>XDR(External Data Representationï¼Œå¤–éƒ¨æ•°æ®è¡¨ç¤ºæ³•)æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ•°æ®å‹ç¼©æ ¼å¼ï¼Œå¯ä»¥è¡¨ç¤ºåŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºç»“æ„ä½“ã€‚</p><p><img src="https://i.loli.net/2020/02/02/XTKIjcPuGNeiYt7.jpg" alt="fig5.jpg"></p><p>åœ¨RPCçš„è°ƒç”¨ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®ç±»å‹éƒ½è¦å°è£…æˆç±»ä¼¼çš„æ ¼å¼ã€‚è€Œä¸”RPCçš„è°ƒç”¨å’Œç»“æœçš„è¿”å›ï¼Œä¹Ÿæœ‰ä¸¥æ ¼çš„æ ¼å¼ã€‚</p><ul><li>XID å”¯ä¸€æ ‡è¯†ä¸€å¯¹è¯·æ±‚å’Œå›å¤ã€‚è¯·æ±‚ä¸º 0ï¼Œå›å¤ä¸º 1ã€‚</li><li>RPC æœ‰ç‰ˆæœ¬å·ï¼Œä¸¤ç«¯è¦åŒ¹é… RPC åè®®çš„ç‰ˆæœ¬å·ã€‚å¦‚æœä¸åŒ¹é…ï¼Œå°±ä¼šè¿”å› Denyï¼ŒåŸå› å°±æ˜¯ RPC_MISMATCHã€‚</li><li>ç¨‹åºæœ‰ç¼–å·ã€‚å¦‚æœæœåŠ¡ç«¯æ‰¾ä¸åˆ°è¿™ä¸ªç¨‹åºï¼Œå°±ä¼šè¿”å› PROG_UNAVAILã€‚</li><li>ç¨‹åºæœ‰ç‰ˆæœ¬å·ã€‚å¦‚æœç¨‹åºçš„ç‰ˆæœ¬å·ä¸åŒ¹é…ï¼Œå°±ä¼šè¿”å› PROG_MISMATCHã€‚</li><li>ä¸€ä¸ªç¨‹åºå¯ä»¥æœ‰å¤šä¸ªæ–¹æ³•ï¼Œæ–¹æ³•ä¹Ÿæœ‰ç¼–å·ï¼Œå¦‚æœæ‰¾ä¸åˆ°æ–¹æ³•ï¼Œå°±ä¼šè¿”å› PROC_UNAVAILã€‚</li><li>è°ƒç”¨éœ€è¦è®¤è¯é‰´æƒï¼Œå¦‚æœä¸é€šè¿‡ï¼Œåˆ™ Denyã€‚</li><li>å¯¹äºå‚æ•°åˆ—è¡¨ï¼Œå¦‚æœå‚æ•°æ— æ³•è§£æï¼Œåˆ™è¿”å›GARBAGE_ARGS</li></ul><p><img src="https://i.loli.net/2020/02/02/oqLCI6nlrb9HpFZ.jpg" alt="fig6.jpg"></p><p>å› æ­¤ä¸ºäº†å¯ä»¥æˆåŠŸè°ƒç”¨RPCï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å®ç°RPCçš„æ—¶å€™ï¼Œé¦–å…ˆè¦å®šä¹‰ä¸€ä¸ªåŒæ–¹éƒ½è®¤å¯çš„ç¨‹åºã€ç‰ˆæœ¬ã€æ–¹æ³•ã€å‚æ•°ç­‰ã€‚</p><p><img src="https://i.loli.net/2020/02/02/FplZqHnDdILKmkw.jpg" alt="fig7.jpg"></p><p>å¦‚æœè¿˜æ˜¯ä¸Šé¢çš„åŠ æ³•ï¼Œåˆ™åŒæ–¹çº¦å®šä¸ºä¸€ä¸ªåè®®å®šä¹‰æ–‡ä»¶ï¼ŒåŒç†å¦‚æœæ˜¯ NFSã€mount å’Œè¯»å†™ï¼Œä¹Ÿä¼šæœ‰ç±»ä¼¼çš„å®šä¹‰ã€‚</p><p>æœ‰äº†åè®®å®šä¹‰æ–‡ä»¶ï¼ŒONC RPC ä¼šæä¾›ä¸€ä¸ªå·¥å…·ï¼Œæ ¹æ®è¿™ä¸ªæ–‡ä»¶ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ Stub ç¨‹åºã€‚</p><p><img src="https://i.loli.net/2020/02/02/tjTU6N2nwdbEpZz.jpg" alt="fig8.jpg"></p><p>æœ€ä¸‹å±‚çš„æ˜¯XDRæ–‡ä»¶ï¼Œç”¨äºç¼–ç å’Œè§£ç å‚æ•°ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±äº«çš„ï¼Œå› ä¸ºåªæœ‰åŒæ–¹ä¸€è‡´æ‰èƒ½æˆåŠŸé€šä¿¡ã€‚</p><p>åœ¨å®¢æˆ·ç«¯ï¼Œä¼šè°ƒç”¨ clnt_create åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œç„¶åè°ƒç”¨ add_1ï¼Œè¿™æ˜¯ä¸€ä¸ª Stub å‡½æ•°ï¼Œæ„Ÿè§‰æ˜¯åœ¨è°ƒç”¨æœ¬åœ°ä¸€æ ·ã€‚å…¶å®æ˜¯è¿™ä¸ªå‡½æ•°å‘èµ·äº†ä¸€ä¸ª RPC è°ƒç”¨ï¼Œé€šè¿‡è°ƒç”¨ clnt_call æ¥è°ƒç”¨ ONC RPC çš„ç±»åº“ï¼Œæ¥çœŸæ­£å‘é€è¯·æ±‚ã€‚</p><p>å½“ç„¶æœåŠ¡ç«¯ä¹Ÿæœ‰ä¸€ä¸ª Stub ç¨‹åºï¼Œç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå½“è°ƒç”¨åˆ°è¾¾çš„æ—¶å€™ï¼Œåˆ¤æ–­å¦‚æœæ˜¯ addï¼Œåˆ™è°ƒç”¨çœŸæ­£çš„æœåŠ¡ç«¯é€»è¾‘ï¼Œä¹Ÿå³å°†ä¸¤ä¸ªæ•°åŠ èµ·æ¥ã€‚</p><p>æœåŠ¡ç«¯å°†ç»“æœè¿”å›æœåŠ¡ç«¯çš„ Stubï¼Œè¿™ä¸ª Stub ç¨‹åºå‘é€ç»“æœç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯çš„ Stub ç¨‹åºæ­£åœ¨ç­‰å¾…ç»“æœï¼Œå½“ç»“æœåˆ°è¾¾å®¢æˆ·ç«¯ Stubï¼Œå°±å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯çš„åº”ç”¨ç¨‹åºï¼Œä»è€Œå®Œæˆæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ã€‚</p><h2 id="1-4-ä¼ è¾“é—®é¢˜"><a href="#1-4-ä¼ è¾“é—®é¢˜" class="headerlink" title="1.4 ä¼ è¾“é—®é¢˜"></a>1.4 ä¼ è¾“é—®é¢˜</h2><p>ä¼ è¾“é—®é¢˜ä¸»è¦è§£å†³é”™è¯¯ï¼Œé‡ä¼ ï¼Œä¸¢åŒ…ï¼Œæ€§èƒ½çš„é—®é¢˜ï¼Œè¿™äº›ä¸æ˜¯Stubæ¥è§£å†³çš„ï¼Œè€Œæ˜¯ç”±One RPCç±»åº“æ¥å®ç°ã€‚</p><p><img src="https://i.loli.net/2020/02/02/FKCS6taMrDpizqv.jpg" alt="fig9.jpg"></p><p>åœ¨è¿™ä¸ªç±»åº“ä¸­ï¼Œä¸ºäº†è§£å†³ä¼ è¾“é—®é¢˜ï¼Œå¯¹äºæ¯ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¼ è¾“ç®¡ç†å±‚ï¼Œè€Œæ¯ä¸€æ¬¡RPCè°ƒç”¨ï¼Œéƒ½ä¼šæ˜¯ä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨ä¼ è¾“ç®¡ç†å±‚ä¼šæœ‰é˜Ÿåˆ—æœºåˆ¶ã€æ‹¥å¡æ§åˆ¶æœºåˆ¶ç­‰ç­‰ã€‚</p><p>ç”±äºåœ¨ç½‘ç»œä¼ è¾“çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦ç­‰å¾…ï¼Œå› è€ŒåŒæ­¥çš„æ–¹å¼å¾€å¾€æ•ˆç‡æ¯”è¾ƒä½ï¼Œå› è€Œä¹Ÿå°±æœ‰ Socket çš„å¼‚æ­¥æ¨¡å‹ã€‚ä¸ºäº†èƒ½å¤Ÿå¼‚æ­¥å¤„ç†ï¼Œå¯¹äºè¿œç¨‹è°ƒç”¨çš„å¤„ç†ï¼Œå¾€å¾€æ˜¯é€šè¿‡çŠ¶æ€æœºæ¥å®ç°çš„ã€‚åªæœ‰å½“æ»¡è¶³æŸä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œæ‰è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå¦‚æœä¸æ»¡è¶³çŠ¶æ€ï¼Œä¸æ˜¯åœ¨é‚£é‡Œç­‰ï¼Œè€Œæ˜¯å°†èµ„æºç•™å‡ºæ¥ï¼Œç”¨æ¥å¤„ç†å…¶ä»–çš„ RPC è°ƒç”¨ã€‚</p><p><img src="https://i.loli.net/2020/02/02/rJ7AGCRfNMSVtHc.jpg" alt="fig10.jpg"></p><p>é¦–å…ˆï¼Œè¿›å…¥èµ·å§‹çŠ¶æ€ï¼ŒæŸ¥çœ‹ RPC çš„ä¼ è¾“å±‚é˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰ç©ºé—²çš„ä½ç½®ï¼Œå¯ä»¥å¤„ç†æ–°çš„ RPC ä»»åŠ¡ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜å¤ªå¿™äº†ï¼Œæˆ–ç›´æ¥ç»“æŸæˆ–é‡è¯•ã€‚å¦‚æœç”³è¯·æˆåŠŸï¼Œå°±å¯ä»¥åˆ†é…å†…å­˜ï¼Œè·å–æœåŠ¡çš„ç«¯å£å·ï¼Œç„¶åè¿æ¥æœåŠ¡å™¨ã€‚</p><p>è¿æ¥çš„è¿‡ç¨‹è¦æœ‰ä¸€æ®µæ—¶é—´ï¼Œå› è€Œè¦ç­‰å¾…è¿æ¥çš„ç»“æœï¼Œä¼šæœ‰è¿æ¥å¤±è´¥ï¼Œæˆ–ç›´æ¥ç»“æŸæˆ–é‡è¯•ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œåˆ™å¼€å§‹å‘é€ RPC è¯·æ±‚ï¼Œç„¶åç­‰å¾…è·å– RPC ç»“æœï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿéœ€è¦ä¸€å®šçš„æ—¶é—´ï¼›å¦‚æœå‘é€å‡ºé”™ï¼Œå¯ä»¥é‡æ–°å‘é€ï¼›å¦‚æœè¿æ¥æ–­äº†ï¼Œå¯ä»¥é‡æ–°è¿æ¥ï¼›å¦‚æœè¶…æ—¶ï¼Œå¯ä»¥é‡æ–°ä¼ è¾“ï¼›å¦‚æœè·å–åˆ°ç»“æœï¼Œå°±å¯ä»¥è§£ç ï¼Œæ­£å¸¸ç»“æŸã€‚</p><h2 id="1-5-æœåŠ¡å‘ç°é—®é¢˜"><a href="#1-5-æœåŠ¡å‘ç°é—®é¢˜" class="headerlink" title="1.5 æœåŠ¡å‘ç°é—®é¢˜"></a>1.5 æœåŠ¡å‘ç°é—®é¢˜</h2><p>å¦‚ä½•æ‰¾åˆ°RPCæœåŠ¡ç«¯çš„éšæœºç«¯å£ï¼Œåœ¨Onc RPCä¸­ï¼ŒæœåŠ¡å‘ç°æ˜¯é€šè¿‡portmapperå®ç°çš„</p><p><img src="https://i.loli.net/2020/02/02/5BRPnap1Z9GcfkK.jpg" alt="fig11.jpg"></p><p>portmapper ä¼šå¯åŠ¨åœ¨ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ç«¯å£ä¸Šï¼ŒRPC ç¨‹åºç”±äºæ˜¯ç”¨æˆ·è‡ªå·±å†™çš„ï¼Œä¼šç›‘å¬åœ¨ä¸€ä¸ªéšæœºç«¯å£ä¸Šï¼Œä½†æ˜¯ RPC ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå‘ portmapper æ³¨å†Œã€‚å®¢æˆ·ç«¯è¦è®¿é—® RPC æœåŠ¡ç«¯è¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œé¦–å…ˆæŸ¥è¯¢ portmapperï¼Œè·å– RPC æœåŠ¡ç«¯ç¨‹åºçš„éšæœºç«¯å£ï¼Œç„¶åå‘è¿™ä¸ªéšæœºç«¯å£å»ºç«‹è¿æ¥ï¼Œå¼€å§‹ RPC è°ƒç”¨ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œmount å‘½ä»¤çš„ RPC è°ƒç”¨ï¼Œå°±æ˜¯è¿™æ ·å®ç°çš„ã€‚</p><h1 id="2-åŸºäºXMLçš„SOAPåè®®"><a href="#2-åŸºäºXMLçš„SOAPåè®®" class="headerlink" title="2. åŸºäºXMLçš„SOAPåè®®"></a>2. åŸºäºXMLçš„SOAPåè®®</h1><p>ä¸Šè¿°çš„ONC RPCåè®®è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š </p><ol><li>éœ€è¦åŒæ–¹çš„å‹ç¼©æ ¼å¼å®Œå…¨ä¸€è‡´</li><li>åè®®ä¿®æ”¹ä¸çµæ´»</li><li>ç‰ˆæœ¬é—®é¢˜</li></ol><p>å³è¿˜æ˜¯å¾ˆéš¾åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´è¿›è¡Œå¼€å‘ã€‚</p><h2 id="2-1-XML-amp-SOAP"><a href="#2-1-XML-amp-SOAP" class="headerlink" title="2.1 XML &amp; SOAP"></a>2.1 XML &amp; SOAP</h2><p>è¦è®©æ‰€æœ‰ä¸åŒçš„äººéƒ½èƒ½çœ‹æ‡‚æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç”¨<strong>æ–‡æœ¬ç±»</strong>çš„æ–¹å¼è¿›è¡Œä¼ è¾“ï¼Œæ— è®ºå“ªä¸ªå®¢æˆ·ç«¯è·å¾—è¿™ä¸ªæ–‡æœ¬ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“å®ƒçš„æ„ä¹‰ã€‚</p><h2 id="2-2-ä¼ è¾“åè®®é—®é¢˜"><a href="#2-2-ä¼ è¾“åè®®é—®é¢˜" class="headerlink" title="2.2 ä¼ è¾“åè®®é—®é¢˜"></a>2.2 ä¼ è¾“åè®®é—®é¢˜</h2><p>åŸºäºXMLçš„æœ€è‘—åçš„é€šä¿¡åè®®å°±æ˜¯SOAPäº†(Simple Object Access Protocol)-ç®€å•å¯¹è±¡è®¿é—®åè®®ã€‚ä½¿ç”¨XMLç¼–å†™ç®€å•çš„è¯·æ±‚å’Œå›å¤æ¶ˆæ¯ï¼Œå¹¶ç”¨HTTPåè®®è¿›è¡Œä¼ è¾“ã€‚</p><p>SOAPå°†è¯·æ±‚å’Œå›å¤æ”¾åœ¨ä¸€ä¸ªä¿¡å°é‡Œï¼Œå°±åƒä¼ é€’é‚®ä»¶ä¸€æ ·ï¼Œæœ‰æŠ¬å¤´ä¸æ­£æ–‡çš„åŒºåˆ«ã€‚</p><pre><code>POST /purchaseOrder HTTP/1.1Host: www.baidu.comContent-Type: application/soap+xml; charset=utf-8Content-Length: nnn&lt;?xml version=&quot;1.0&quot;?&gt;&lt;soap:Envelope xmlns:soap=&quot;http://www.w3.org/2001/12/soap-envelope&quot;soap:encodingStyle=&quot;http://www.w3.org/2001/12/soap-encoding&quot;&gt;    &lt;soap:Header&gt;        &lt;m:Trans xmlns:m=&quot;http://www.w3schools.com/transaction/&quot;          soap:mustUnderstand=&quot;1&quot;&gt;1234        &lt;/m:Trans&gt;    &lt;/soap:Header&gt;    &lt;soap:Body xmlns:m=&quot;http://www.baidu.com/perchaseOrder&quot;&gt;        &lt;m:purchaseOrder&quot;&gt;            &lt;order&gt;                &lt;date&gt;2018-07-01&lt;/date&gt;                &lt;className&gt; RPC &amp; SOAP &lt;/className&gt;                &lt;Author&gt; LLCHEN &lt;/Author&gt;            &lt;/order&gt;        &lt;/m:purchaseOrder&gt;    &lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</code></pre><p>è¿™ä¸ªè¯·æ±‚ä½¿ç”¨POSTæ–¹æ³•ï¼Œå‘é€ä¸€ä¸ªæ ¼å¼ä¸º<code>application/soap + xml</code>çš„XMLæ­£æ–‡ç»™<a href="http://www.baidu.comï¼Œä»è€Œä¸‹ä¸€ä¸ªå•ï¼Œè¿™ä¸ªè®¢å•å°è£…åœ¨SOAPçš„ä¿¡å°é‡Œã€‚" target="_blank" rel="noopener">www.baidu.comï¼Œä»è€Œä¸‹ä¸€ä¸ªå•ï¼Œè¿™ä¸ªè®¢å•å°è£…åœ¨SOAPçš„ä¿¡å°é‡Œã€‚</a></p><h2 id="2-3-åè®®çº¦å®šé—®é¢˜"><a href="#2-3-åè®®çº¦å®šé—®é¢˜" class="headerlink" title="2.3 åè®®çº¦å®šé—®é¢˜"></a>2.3 åè®®çº¦å®šé—®é¢˜</h2><p>å› ä¸ºæœåŠ¡å¼€å‘å‡ºæ¥æ˜¯ç»™é™Œç”Ÿäººç”¨çš„ï¼Œå°±åƒä¸Šé¢ä¸‹å•çš„é‚£ä¸ª XML æ–‡ä»¶ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå®ƒå¦‚ä½•çŸ¥é“åº”è¯¥æ‹¼è£…æˆä¸Šé¢çš„æ ¼å¼å‘¢ï¼Ÿè¿™å°±éœ€è¦å¯¹äºæœåŠ¡è¿›è¡Œæè¿°ï¼Œå› ä¸ºè°ƒç”¨çš„äººä¸è®¤è¯†ä½ ï¼Œæ‰€ä»¥æ²¡åŠæ³•æ‰¾åˆ°ä½ ï¼Œé—®ä½ çš„æœåŠ¡åº”è¯¥å¦‚ä½•è°ƒç”¨ã€‚</p><p>å½“ç„¶ä½ å¯ä»¥å†™æ–‡æ¡£ï¼Œç„¶åæ”¾åœ¨å®˜æ–¹ç½‘ç«™ä¸Šï¼Œä½†æ˜¯ä½ çš„æ–‡æ¡£ä¸ä¸€å®šæ›´æ–°å¾—é‚£ä¹ˆåŠæ—¶ï¼Œè€Œä¸”ä½ ä¹Ÿå†™çš„æ–‡æ¡£ä¹Ÿä¸ä¸€å®šé‚£ä¹ˆä¸¥è°¨ï¼Œæ‰€ä»¥å¸¸å¸¸ä¼šæœ‰è°ƒè¯•ä¸æˆåŠŸçš„æƒ…å†µã€‚å› è€Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§ç›¸å¯¹æ¯”è¾ƒä¸¥è°¨çš„<strong>WebæœåŠ¡æè¿°è¯­è¨€ï¼Œ WSDL(Web Service Description Languages)</strong></p><p>åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œè¦å®šä¹‰ä¸€ä¸ªç±»å‹çš„orderï¼Œä¸ä¸Šé¢çš„XMLå¯¹åº”èµ·æ¥ã€‚</p><pre><code> &lt;wsdl:types&gt;  &lt;xsd:schema targetNamespace=&quot;http://www.example.org/geektime&quot;&gt;   &lt;xsd:complexType name=&quot;order&quot;&gt;    &lt;xsd:element name=&quot;date&quot; type=&quot;xsd:string&quot;&gt;&lt;/xsd:element&gt;&lt;xsd:element name=&quot;className&quot; type=&quot;xsd:string&quot;&gt;&lt;/xsd:element&gt;&lt;xsd:element name=&quot;Author&quot; type=&quot;xsd:string&quot;&gt;&lt;/xsd:element&gt;    &lt;xsd:element name=&quot;price&quot; type=&quot;xsd:int&quot;&gt;&lt;/xsd:element&gt;   &lt;/xsd:complexType&gt;  &lt;/xsd:schema&gt; &lt;/wsdl:types&gt;</code></pre><p>å®šä¹‰ä¸€ä¸ªmessageç»“æ„</p><pre><code> &lt;wsdl:message name=&quot;purchase&quot;&gt;  &lt;wsdl:part name=&quot;purchaseOrder&quot; element=&quot;tns:order&quot;&gt;&lt;/wsdl:part&gt; &lt;/wsdl:message&gt;</code></pre><p>æš´éœ²ä¸€ä¸ªç«¯å£</p><pre><code> &lt;wsdl:portType name=&quot;PurchaseOrderService&quot;&gt;  &lt;wsdl:operation name=&quot;purchase&quot;&gt;   &lt;wsdl:input message=&quot;tns:purchase&quot;&gt;&lt;/wsdl:input&gt;   &lt;wsdl:output message=&quot;......&quot;&gt;&lt;/wsdl:output&gt;  &lt;/wsdl:operation&gt; &lt;/wsdl:portType&gt;</code></pre><p>ç¼–å†™ä¸€ä¸ªbindingï¼Œå°†ä¸Šé¢å®šä¹‰çš„ä¿¡æ¯ç»‘å®šåˆ°SOAPè¯·æ±‚çš„bodyé‡Œé¢</p><pre><code> &lt;wsdl:binding name=&quot;purchaseOrderServiceSOAP&quot; type=&quot;tns:PurchaseOrderService&quot;&gt;  &lt;soap:binding style=&quot;rpc&quot;   transport=&quot;http://schemas.xmlsoap.org/soap/http&quot; /&gt;  &lt;wsdl:operation name=&quot;purchase&quot;&gt;   &lt;wsdl:input&gt;    &lt;soap:body use=&quot;literal&quot; /&gt;   &lt;/wsdl:input&gt;   &lt;wsdl:output&gt;    &lt;soap:body use=&quot;literal&quot; /&gt;   &lt;/wsdl:output&gt;  &lt;/wsdl:operation&gt; &lt;/wsdl:binding&gt;</code></pre><p>å¯¹åº”çš„Serviceï¼š</p><pre><code> &lt;wsdl:service name=&quot;PurchaseOrderServiceImplService&quot;&gt;  &lt;wsdl:port binding=&quot;tns:purchaseOrderServiceSOAP&quot; name=&quot;PurchaseOrderServiceImplPort&quot;&gt;   &lt;soap:address location=&quot;http://www.geektime.com:8080/purchaseOrder&quot; /&gt;  &lt;/wsdl:port&gt; &lt;/wsdl:service&gt;</code></pre><h2 id="2-4-æœåŠ¡å‘ç°é—®é¢˜"><a href="#2-4-æœåŠ¡å‘ç°é—®é¢˜" class="headerlink" title="2.4 æœåŠ¡å‘ç°é—®é¢˜"></a>2.4 æœåŠ¡å‘ç°é—®é¢˜</h2><p>é‡‡ç”¨UDDIåè®®(Universal Description, Discovery, and Integration),å³ç»Ÿä¸€æè¿°ã€å‘ç°å’Œç»§æ‰¿åè®®ã€‚å®ƒå…¶å®æ˜¯ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡æä¾›æ–¹å¯ä»¥å°†ä¸Šé¢çš„ WSDL æè¿°æ–‡ä»¶ï¼Œå‘å¸ƒåˆ°è¿™ä¸ªæ³¨å†Œä¸­å¿ƒï¼Œæ³¨å†Œå®Œæ¯•åï¼ŒæœåŠ¡ä½¿ç”¨æ–¹å¯ä»¥æŸ¥æ‰¾åˆ°æœåŠ¡çš„æè¿°ï¼Œå°è£…ä¸ºæœ¬åœ°çš„å®¢æˆ·ç«¯è¿›è¡Œè°ƒç”¨ã€‚</p><h1 id="3-åŸºäºJSONçš„RESTfulæ¥å£åè®®"><a href="#3-åŸºäºJSONçš„RESTfulæ¥å£åè®®" class="headerlink" title="3. åŸºäºJSONçš„RESTfulæ¥å£åè®®"></a>3. åŸºäºJSONçš„RESTfulæ¥å£åè®®</h1><h2 id="3-1-RESTful"><a href="#3-1-RESTful" class="headerlink" title="3.1 RESTful"></a>3.1 RESTful</h2><p>ç„¶è€Œ RESTful å¯ä¸ä»…ä»…æ˜¯æŒ‡ APIï¼Œè€Œæ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå…¨ç§° Representational State Transferï¼Œè¡¨è¿°æ€§çŠ¶æ€è½¬ç§»</p><h2 id="3-2-åè®®çº¦å®šé—®é¢˜"><a href="#3-2-åè®®çº¦å®šé—®é¢˜" class="headerlink" title="3.2 åè®®çº¦å®šé—®é¢˜"></a>3.2 åè®®çº¦å®šé—®é¢˜</h2><p>å’Œ SOAP ä¸ä¸€æ ·ï¼ŒREST ä¸æ˜¯ä¸€ç§ä¸¥æ ¼è§„å®šçš„æ ‡å‡†ï¼Œå®ƒå…¶å®æ˜¯ä¸€ç§è®¾è®¡é£æ ¼ã€‚å¦‚æœæŒ‰è¿™ç§é£æ ¼è¿›è¡Œè®¾è®¡ï¼ŒRESTful æ¥å£å’Œ SOAP æ¥å£éƒ½èƒ½åšåˆ°ï¼Œåªä¸è¿‡åé¢çš„æ¶æ„æ˜¯ REST å€¡å¯¼çš„ï¼Œè€Œ SOAP ç›¸å¯¹æ¯”è¾ƒå…³æ³¨å‰é¢çš„æ¥å£ã€‚</p><p>ç„¶è€Œæœ¬åœ°è°ƒç”¨å’Œè¿œç¨‹è·¨ç½‘ç»œè°ƒç”¨æ¯•ç«Ÿä¸ä¸€æ ·ï¼Œè¿™é‡Œçš„ä¸ä¸€æ ·è¿˜ä¸ä»…ä»…æ˜¯å› ä¸ºæœ‰ç½‘ç»œè€Œå¯¼è‡´çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åˆ†ç¦»ï¼Œä»è€Œå¸¦æ¥çš„ç½‘ç»œæ€§èƒ½é—®é¢˜ã€‚æ›´é‡è¦çš„é—®é¢˜æ˜¯ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è°æ¥ç»´æŠ¤çŠ¶æ€ã€‚æ‰€è°“çš„çŠ¶æ€å°±æ˜¯å¯¹æŸä¸ªæ•°æ®å½“å‰å¤„ç†åˆ°ä»€ä¹ˆç¨‹åº¦äº†ã€‚</p><p>å½“æœ‰äº† RPC ä¹‹åï¼Œæˆ‘ä»¬æœ¬æ¥æœŸæœ›å¯¹ä¸Šå±‚é€æ˜ï¼Œå°±åƒä¸Šä¸€èŠ‚è¯´çš„â€œè¿œåœ¨å¤©è¾¹ï¼Œå°½åœ¨çœ¼å‰â€ã€‚äºæ˜¯ä½¿ç”¨ RPC çš„æ—¶å€™ï¼Œå¯¹äºçŠ¶æ€çš„é—®é¢˜ä¹Ÿæ²¡æœ‰å¤ªå¤šçš„è€ƒè™‘ã€‚ä¸Šé¢çš„ä¾‹å­éƒ½æ˜¯åœ¨ RPC åœºæ™¯ä¸‹ï¼Œç”±æœåŠ¡ç«¯æ¥ç»´æŠ¤çŠ¶æ€ï¼Œå¾ˆå¤š SOAP æ¥å£è®¾è®¡çš„æ—¶å€™ï¼Œä¹Ÿå¸¸å¸¸æŒ‰è¿™ç§æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼åŸæ¥æ²¡æœ‰é—®é¢˜ï¼Œæ˜¯å› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„æ¯”ä¾‹æ²¡æœ‰å¤±è¡¡ã€‚å› ä¸ºä¸€èˆ¬ä¸ä¼šåŒæ—¶æœ‰å¤ªå¤šçš„å®¢æˆ·ç«¯åŒæ—¶è¿ä¸Šæ¥ï¼Œæ‰€ä»¥ NFS è¿˜èƒ½æŠŠæ¯ä¸ªå®¢æˆ·ç«¯çš„çŠ¶æ€éƒ½è®°ä½ã€‚</p><p>ä½†æ˜¯äº’è”ç½‘åœºæ™¯ä¸‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°±å½»åº•å¤±è¡¡äº†ã€‚ä½ å¯ä»¥æƒ³è±¡â€œåŒåä¸€â€ï¼Œå¤šå°‘äººåŒæ—¶æ¥è´­ç‰©ï¼Œä½œä¸ºæœåŠ¡ç«¯ï¼Œå®ƒèƒ½è®°å¾—è¿‡æ¥å—ï¼Ÿå½“ç„¶ä¸å¯èƒ½ï¼Œåªå¥½å¤šä¸ªæœåŠ¡ç«¯åŒæ—¶æä¾›æœåŠ¡ï¼Œå¤§å®¶åˆ†æ‹…ä¸€ä¸‹ã€‚ä½†æ˜¯è¿™å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒæœåŠ¡ç«¯æ€ä¹ˆæŠŠè‡ªå·±è®°ä½çš„å®¢æˆ·ç«¯çŠ¶æ€å‘Šè¯‰å¦ä¸€ä¸ªæœåŠ¡ç«¯å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œä½ è®©æˆ‘ç»™ä½ åˆ†æ‹…å·¥ä½œï¼Œä½ ä¹Ÿè¦æŠŠå·¥ä½œçš„å‰å› åæœç»™æˆ‘è¯´æ¸…æ¥šå•Šï¼</p><p>å› æ­¤åº”è¯¥æ˜¯æœåŠ¡ç«¯åªè®°å½•èµ„æºçš„çŠ¶æ€ï¼Œè€Œå®¢æˆ·ç«¯è‡ªå·±ç»´æŠ¤è‡ªå·±çš„çŠ¶æ€ï¼Œæ¯”å¦‚å·²ç»è®¿é—®åˆ°å“ªä¸ªç›®å½•äº†ï¼Œå“ªä¸€é¡µç­‰ç­‰è¿™ç±»ä¿¡æ¯ã€‚</p><p>å½“å®¢æˆ·ç«¯ç»´æŠ¤äº†è‡ªå·±çš„çŠ¶æ€çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦è¿™æ ·è°ƒç”¨æœåŠ¡ç«¯äº†ã€‚é€šè¿‡è¿™ç§è®©å®¢æˆ·ç«¯è®°å½•è‡ªå·±çš„çŠ¶æ€çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æœåŠ¡ç«¯çš„æ— çŠ¶æ€åŒ–ï¼Œå°±å¯ä»¥è®©æœåŠ¡ç«¯æ¥æ¨ªå‘æ‰©å±•äº†ã€‚</p><p>æ‰€è°“çš„æ— çŠ¶æ€ï¼Œå…¶å®æ˜¯æœåŠ¡ç«¯ç»´æŠ¤èµ„æºçš„çŠ¶æ€ï¼Œå®¢æˆ·ç«¯ç»´æŠ¤ä¼šè¯çš„çŠ¶æ€ã€‚å¯¹äºæœåŠ¡ç«¯æ¥è®²ï¼Œåªæœ‰èµ„æºçš„çŠ¶æ€æ”¹å˜äº†ï¼Œå®¢æˆ·ç«¯æ‰è°ƒç”¨ POSTã€PUTã€DELETE æ–¹æ³•æ¥æ‰¾æˆ‘ï¼›å¦‚æœèµ„æºçš„çŠ¶æ€æ²¡å˜ï¼Œåªæ˜¯å®¢æˆ·ç«¯çš„çŠ¶æ€å˜äº†ï¼Œå°±ä¸ç”¨å‘Šè¯‰æˆ‘äº†ï¼Œå¯¹äºæˆ‘æ¥è¯´éƒ½æ˜¯ç»Ÿä¸€çš„ GETã€‚</p><p>è™½ç„¶è¿™åªæ”¹è¿›äº† GETï¼Œä½†æ˜¯å·²ç»å¸¦æ¥äº†å¾ˆå¤§çš„è¿›æ­¥ã€‚å› ä¸ºå¯¹äºäº’è”ç½‘åº”ç”¨ï¼Œå¤§å¤šæ•°æ˜¯è¯»å¤šå†™å°‘çš„ã€‚<strong>è€Œä¸”åªè¦æœåŠ¡ç«¯çš„èµ„æºçŠ¶æ€ä¸å˜ï¼Œå°±ç»™äº†æˆ‘ä»¬ç¼“å­˜çš„å¯èƒ½ã€‚ä¾‹å¦‚å¯ä»¥å°†çŠ¶æ€ç¼“å­˜åˆ°æ¥å…¥å±‚ï¼Œç”šè‡³ç¼“å­˜åˆ° CDN çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œè¿™éƒ½æ˜¯èµ„æºçŠ¶æ€ä¸å˜çš„å¥½å¤„</strong>ã€‚</p><p>æŒ‰ç…§è¿™ç§æ€è·¯ï¼Œå¯¹äºAPIçš„è®¾è®¡ï¼Œå°±æ…¢æ…¢å˜æˆäº†ä»¥èµ„æºä¸ºæ ¸å¿ƒï¼Œè€Œä¸æ˜¯ä»¥è¿‡ç¨‹ä¸ºæ ¸å¿ƒäº†ã€‚ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯åªéœ€è¦å®¢æˆ·ç«¯å‘Šè¯‰å®ƒä½ éœ€è¦ä»€ä¹ˆèµ„æºå°±å¥½äº†ï¼Œå…·ä½“çš„è¿‡ç¨‹å’ŒåŠ¨ä½œå°±ä¸éœ€è¦çŸ¥é“äº†ã€‚</p><p>è¿˜æ˜¯æ–‡ä»¶ç›®å½•çš„ä¾‹å­ã€‚å®¢æˆ·ç«¯åº”è¯¥è®¿é—®å“ªä¸ªç»å¯¹è·¯å¾„ï¼Œè€Œéä¸€ä¸ªåŠ¨ä½œï¼Œæˆ‘å°±è¦è¿›å…¥æŸä¸ªè·¯å¾„ã€‚å†å¦‚ï¼Œåº“å­˜çš„è°ƒç”¨ï¼Œåº”è¯¥æŸ¥çœ‹å½“å‰çš„åº“å­˜æ•°ç›®ï¼Œç„¶åå‡å»è´­ä¹°çš„æ•°é‡ï¼Œå¾—åˆ°ç»“æœçš„åº“å­˜æ•°ã€‚è¿™ä¸ªæ—¶å€™åº”è¯¥è®¾ç½®ä¸ºç›®æ ‡åº“å­˜æ•°ï¼ˆä½†æ˜¯å½“å‰åº“å­˜æ•°è¦åŒ¹é…ï¼‰ï¼Œè€Œéå‘ŠçŸ¥å‡å»å¤šå°‘åº“å­˜ã€‚</p><p>è¿™ç§ API çš„è®¾è®¡éœ€è¦å®ç°å¹‚ç­‰ï¼Œå› ä¸ºç½‘ç»œä¸ç¨³å®šï¼Œå°±ä¼šç»å¸¸å‡ºé”™ï¼Œå› è€Œéœ€è¦é‡è¯•ï¼Œä½†æ˜¯ä¸€æ—¦é‡è¯•ï¼Œå°±ä¼šå­˜åœ¨å¹‚ç­‰çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªè°ƒç”¨ï¼Œå¤šæ¬¡è°ƒç”¨çš„ç»“æœåº”è¯¥ä¸€æ ·ï¼Œä¸èƒ½ä¸€æ¬¡æ”¯ä»˜è°ƒç”¨ï¼Œå› ä¸ºè°ƒç”¨ä¸‰æ¬¡å˜æˆäº†æ”¯ä»˜ä¸‰æ¬¡ã€‚ä¸èƒ½è¿›å…¥ cd aï¼Œåšäº†ä¸‰æ¬¡ï¼Œå°±å˜æˆäº† cd a/a/aã€‚ä¹Ÿä¸èƒ½æ‰£å‡åº“å­˜ï¼Œè°ƒç”¨äº†ä¸‰æ¬¡ï¼Œå°±æ‰£å‡ä¸‰æ¬¡åº“å­˜ã€‚</p><p>å½“ç„¶æŒ‰ç…§è¿™ç§è®¾è®¡æ¨¡å¼ï¼Œæ— è®º RESTful API è¿˜æ˜¯ SOAP API éƒ½å¯ä»¥å°†æ¶æ„å®ç°æˆæ— çŠ¶æ€çš„ï¼Œé¢å‘èµ„æºçš„ã€å¹‚ç­‰çš„ã€æ¨ªå‘æ‰©å±•çš„ã€å¯ç¼“å­˜çš„ã€‚</p><p>ä½†SOAPçš„XMLæ­£æ–‡å¯ä»¥æ”¾ä»»ä½•åŠ¨ä½œï¼Œè€ŒRESTfulåŸºæœ¬æè¿°çš„å°±æ˜¯èµ„æºçš„çŠ¶æ€ï¼Œæ²¡æ³•æè¿°åŠ¨ä½œï¼Œèƒ½å‘å‡ºçš„åŠ¨ä½œåªæœ‰CRUDã€‚</p><h2 id="3-3-æœåŠ¡å‘ç°é—®é¢˜"><a href="#3-3-æœåŠ¡å‘ç°é—®é¢˜" class="headerlink" title="3.3 æœåŠ¡å‘ç°é—®é¢˜"></a>3.3 æœåŠ¡å‘ç°é—®é¢˜</h2><p>æœ‰ä¸ªè‘—åçš„åŸºäº RESTful API çš„è·¨ç³»ç»Ÿè°ƒç”¨æ¡†æ¶å« Spring  Cloudã€‚åœ¨ Spring  Cloud ä¸­æœ‰ä¸€ä¸ªç»„ä»¶å« Eurekaã€‚ä¼ è¯´ï¼Œé˜¿åŸºç±³å¾·åœ¨æ´—æ¾¡æ—¶å‘ç°æµ®åŠ›åŸç†ï¼Œé«˜å…´å¾—æ¥ä¸åŠç©¿ä¸Šè£¤å­ï¼Œè·‘åˆ°è¡—ä¸Šå¤§å–Šï¼šâ€œEurekaï¼ˆæˆ‘æ‰¾åˆ°äº†ï¼‰ï¼â€æ‰€ä»¥ Eureka æ˜¯ç”¨æ¥å®ç°æ³¨å†Œä¸­å¿ƒçš„ï¼Œè´Ÿè´£ç»´æŠ¤æ³¨å†Œçš„æœåŠ¡åˆ—è¡¨ã€‚</p><p>æœåŠ¡åˆ†æœåŠ¡æä¾›æ–¹ï¼Œå®ƒå‘ Eureka åšæœåŠ¡æ³¨å†Œã€ç»­çº¦å’Œä¸‹çº¿ç­‰æ“ä½œï¼Œæ³¨å†Œçš„ä¸»è¦æ•°æ®åŒ…æ‹¬æœåŠ¡åã€æœºå™¨ IPã€ç«¯å£å·ã€åŸŸåç­‰ç­‰ã€‚</p><p>å¦å¤–ä¸€æ–¹æ˜¯æœåŠ¡æ¶ˆè´¹æ–¹ï¼Œå‘ Eureka è·å–æœåŠ¡æä¾›æ–¹çš„æ³¨å†Œä¿¡æ¯ã€‚ä¸ºäº†å®ç°è´Ÿè½½å‡è¡¡å’Œå®¹é”™ï¼ŒæœåŠ¡æä¾›æ–¹å¯ä»¥æ³¨å†Œå¤šä¸ªã€‚</p><p>å½“æ¶ˆè´¹æ–¹è¦è°ƒç”¨æœåŠ¡çš„æ—¶å€™ï¼Œä¼šä»æ³¨å†Œä¸­å¿ƒè¯»å‡ºå¤šä¸ªæœåŠ¡æ¥ï¼Œé‚£æ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿå½“ç„¶æ˜¯ RESTful æ–¹å¼äº†ã€‚</p><p>Spring Cloud æä¾›ä¸€ä¸ª RestTemplate å·¥å…·ï¼Œç”¨äºå°†è¯·æ±‚å¯¹è±¡è½¬æ¢ä¸º JSONï¼Œå¹¶å‘èµ· Rest è°ƒç”¨ï¼ŒRestTemplate çš„è°ƒç”¨ä¹Ÿæ˜¯åˆ† POSTã€PUTã€GETã€  DELETE çš„ï¼Œå½“ç»“æœè¿”å›çš„æ—¶å€™ï¼Œæ ¹æ®è¿”å›çš„ JSON è§£ææˆå¯¹è±¡ã€‚</p><h1 id="4-äºŒè¿›åˆ¶ç±»RPCåè®®"><a href="#4-äºŒè¿›åˆ¶ç±»RPCåè®®" class="headerlink" title="4. äºŒè¿›åˆ¶ç±»RPCåè®®"></a>4. äºŒè¿›åˆ¶ç±»RPCåè®®</h1><p>æ¥å…¥å±‚è®¾è®¡ï¼Œåœ¨CDN, DNSå½“ä¸­ï¼Œå¯¹äºé™æ€èµ„æºæˆ–è€…åŠ¨æ€èµ„æºé™æ€åŒ–çš„éƒ¨åˆ†éƒ½å¯ä»¥åšç¼“å­˜ã€‚ä½†æ˜¯å¯¹äºä¸‹å•ï¼Œæ”¯ä»˜ç­‰äº¤æ˜“åœºæ™¯ï¼Œè¿˜æ˜¯éœ€è¦è°ƒç”¨APIã€‚</p><p>å¯¹äºå¾®æœåŠ¡çš„æ¶æ„ï¼ŒAPIéœ€è¦ä¸€ä¸ªAPIç½‘å…³ç»Ÿä¸€è¿›è¡Œç®¡ç†ã€‚å®ç°æ–¹å¼æœ‰ï¼šç”¨Nginxæˆ–è€…OpenRestyç»“åˆLuaè„šæœ¬ã€‚åœ¨Spring Cloudå½“ä¸­ï¼Œç”¨ç»„ä»¶Zuulä¹Ÿå¯ä»¥ã€‚</p><h2 id="4-1-æ•°æ®ä¸­å¿ƒå†…éƒ¨æ˜¯å¦‚ä½•è°ƒç”¨çš„ï¼Ÿ"><a href="#4-1-æ•°æ®ä¸­å¿ƒå†…éƒ¨æ˜¯å¦‚ä½•è°ƒç”¨çš„ï¼Ÿ" class="headerlink" title="4.1 æ•°æ®ä¸­å¿ƒå†…éƒ¨æ˜¯å¦‚ä½•è°ƒç”¨çš„ï¼Ÿ"></a>4.1 æ•°æ®ä¸­å¿ƒå†…éƒ¨æ˜¯å¦‚ä½•è°ƒç”¨çš„ï¼Ÿ</h2><p>APIç½‘å…³ç”¨æ¥ç®¡ç†APIï¼Œä½†æ˜¯APIçš„å®ç°ä¸€èˆ¬åœ¨Controllerå±‚è¿›è¡Œå®ç°ï¼Œè¿™ä¸€å±‚å¯¹å¤–æä¾›APIã€‚å› ä¸ºæ˜¯é¢å‘å¤§è§„æ¨¡äº’è”ç½‘åº”ç”¨çš„ï¼Œæ‰€ä»¥ä¸»æµè¿˜æ˜¯ä½¿ç”¨RESTful APIã€‚</p><p><img src="https://i.loli.net/2020/02/02/r5w7jdebPcLEDty.jpg" alt="fig12.jpg"></p><p>éå¸¸æ£’çš„åˆ†å±‚å›¾:</p><ol><li>å®¢æˆ·ç«¯è¿›å…¥çš„è¯·æ±‚é¦–å…ˆä¼šè¿›å…¥è´Ÿè½½å‡è¡¡ç³»ç»Ÿ-nginx</li><li>é™æ€èµ„æºå…ˆåˆ°Varnishæ‰¾</li><li>åŠ¨æ€èµ„æºå»Redisæ‰¾</li><li>2ï¼Œ3æ˜¯è´Ÿè´£æ•´ä¸ªé¡µé¢çš„æ¸²æŸ“</li><li>å¯¹äºAPIè°ƒç”¨ï¼Œä¼šåˆ°Controllerå±‚å»è§£å†³ï¼Œè¿™é‡Œä¸»è¦æ˜¯å¤„ç†å„ç§ä¸šåŠ¡é€»è¾‘çš„</li><li>Controllerå±‚ä¸‹æ–¹ä¼šæœ‰ç»†åŒ–çš„åŸºç¡€æœåŠ¡å±‚</li><li>ç¼“å­˜å±‚</li><li>æŒä¹…åŒ–å±‚ï¼ˆåˆ†å¸ƒå¼æ•°æ®åº“+æœç´¢å¼•æ“ï¼‰</li></ol><p>åœ¨Controllerä¹‹å†…ï¼Œå°±æ˜¯äº’è”ç½‘åº”ç”¨çš„ä¸šåŠ¡é€»è¾‘å®ç°äº†ã€‚ä¸šåŠ¡é€»è¾‘çš„å®ç°æœ€å¥½æ˜¯æ— çŠ¶æ€çš„ï¼Œä»è€Œå¯ä»¥æ¨ªå‘æ‰©å±•ï¼Œä½†æ˜¯èµ„æºçš„çŠ¶æ€è¿˜æ˜¯éœ€è¦æœåŠ¡ç«¯æ¥ç»´æŠ¤çš„ã€‚èµ„æºçš„çŠ¶æ€ä¸åº”è¯¥ç»´æŠ¤åœ¨ä¸šåŠ¡é€»è¾‘å±‚ï¼Œè€Œæ˜¯åœ¨æœ€åº•å±‚çš„æŒä¹…åŒ–å±‚ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®åº“å’ŒElastic Search.</p><p>è¿™äº›æœåŠ¡ç«¯çš„çŠ¶æ€ï¼Œä¾‹å¦‚è®¢å•ã€åº“å­˜ã€å•†å“ç­‰ï¼Œéƒ½æ˜¯é‡ä¸­ä¹‹é‡ï¼Œéƒ½éœ€è¦æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸Šï¼Œæ•°æ®ä¸èƒ½ä¸¢ï¼Œä½†æ˜¯ç”±äºç¡¬ç›˜è¯»å†™æ€§èƒ½å·®ï¼Œå› è€ŒæŒä¹…åŒ–å±‚å¾€å¾€ååé‡ä¸èƒ½è¾¾åˆ°äº’è”ç½‘åº”ç”¨è¦æ±‚çš„ååé‡ï¼Œå› è€Œå‰é¢è¦æœ‰ä¸€å±‚ç¼“å­˜å±‚ï¼Œä½¿ç”¨ Redis æˆ–è€… memcached å°†è¯·æ±‚æ‹¦æˆªä¸€é“ï¼Œä¸èƒ½è®©æ‰€æœ‰çš„è¯·æ±‚éƒ½è¿›å…¥æ•°æ®åº“â€œä¸­å†›å¤§è¥â€ã€‚</p><p>ç¼“å­˜å’ŒæŒä¹…åŒ–å±‚ä¹‹ä¸Šä¸€èˆ¬æ˜¯<strong>åŸºç¡€æœåŠ¡å±‚</strong>ï¼Œè¿™é‡Œé¢æä¾›ä¸€äº›åŸå­åŒ–çš„æ¥å£ã€‚ä¾‹å¦‚ï¼Œå¯¹äºç”¨æˆ·ã€å•†å“ã€è®¢å•ã€åº“å­˜çš„å¢åˆ æŸ¥æ”¹ï¼Œå°†ç¼“å­˜å’Œæ•°æ®åº“å¯¹å†ä¸Šå±‚çš„ä¸šåŠ¡é€»è¾‘å±è”½ä¸€é“ã€‚æœ‰äº†è¿™ä¸€å±‚ï¼Œä¸Šå±‚ä¸šåŠ¡é€»è¾‘çœ‹åˆ°çš„éƒ½æ˜¯æ¥å£ï¼Œè€Œä¸ä¼šè°ƒç”¨æ•°æ®åº“å’Œç¼“å­˜ã€‚å› è€Œå¯¹äºç¼“å­˜å±‚çš„æ‰©å®¹ï¼Œæ•°æ®åº“çš„åˆ†åº“åˆ†è¡¨ï¼Œæ‰€æœ‰çš„æ”¹å˜ï¼Œéƒ½æˆªæ­¢åˆ°è¿™ä¸€å±‚ï¼Œè¿™æ ·æœ‰åˆ©äºå°†æ¥å¯¹äºç¼“å­˜å’Œæ•°æ®åº“çš„è¿ç»´ã€‚</p><p>å†ä¸Šé¢å°±æ˜¯<strong>ç»„åˆå±‚</strong>ã€‚å› ä¸ºåŸºç¡€æœåŠ¡å±‚åªæ˜¯æä¾›ç®€å•çš„æ¥å£ï¼Œå®ç°ç®€å•çš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ä¸‹å•ï¼Œè¦æ‰£ä¼˜æƒ åˆ¸ï¼Œæ‰£å‡åº“å­˜ç­‰ï¼Œå°±è¦åœ¨ç»„åˆæœåŠ¡å±‚å®ç°ã€‚</p><p>è¿™æ ·ï¼ŒController å±‚ã€ç»„åˆæœåŠ¡å±‚ã€åŸºç¡€æœåŠ¡å±‚å°±ä¼šç›¸äº’è°ƒç”¨ï¼Œè¿™ä¸ªè°ƒç”¨æ˜¯åœ¨æ•°æ®ä¸­å¿ƒå†…éƒ¨çš„ï¼Œé‡ä¹Ÿä¼šæ¯”è¾ƒå¤§ï¼Œè¿˜æ˜¯ä½¿ç”¨ RPC çš„æœºåˆ¶å®ç°çš„ã€‚</p><p>ç”±äºæœåŠ¡æ¯”è¾ƒå¤šï¼Œéœ€è¦ä¸€ä¸ªå•ç‹¬çš„æ³¨å†Œä¸­å¿ƒæ¥åšæœåŠ¡å‘ç°ã€‚æœåŠ¡æä¾›æ–¹ä¼šå°†è‡ªå·±æä¾›å“ªäº›æœåŠ¡æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸­å»ï¼ŒåŒæ—¶æœåŠ¡æ¶ˆè´¹æ–¹è®¢é˜…è¿™ä¸ªæœåŠ¡ï¼Œä»è€Œå¯ä»¥å¯¹è¿™ä¸ªæœåŠ¡è¿›è¡Œè°ƒç”¨ã€‚</p><p>è°ƒç”¨çš„æ—¶å€™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œçš„ RPC è°ƒç”¨ï¼Œåº”è¯¥ç”¨äºŒè¿›åˆ¶è¿˜æ˜¯æ–‡æœ¬ç±»ï¼Ÿå…¶å®æ–‡æœ¬çš„æœ€å¤§é—®é¢˜æ˜¯ï¼Œå ç”¨å­—èŠ‚æ•°ç›®æ¯”è¾ƒå¤šã€‚æ¯”å¦‚æ•°å­— 123ï¼Œå…¶å®æœ¬æ¥äºŒè¿›åˆ¶ 8 ä½å°±å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœå˜æˆæ–‡æœ¬ï¼Œå°±æˆäº†å­—ç¬¦ä¸² 123ã€‚å¦‚æœæ˜¯ UTF-8 ç¼–ç çš„è¯ï¼Œå°±æ˜¯ä¸‰ä¸ªå­—èŠ‚ï¼›å¦‚æœæ˜¯ UTF-16ï¼Œå°±æ˜¯å…­ä¸ªå­—èŠ‚ã€‚åŒæ ·çš„ä¿¡æ¯ï¼Œè¦å¤šè´¹å¥½å¤šçš„ç©ºé—´ï¼Œä¼ è¾“èµ·æ¥ä¹Ÿæ›´åŠ å å¸¦å®½ï¼Œæ—¶å»¶ä¹Ÿé«˜ã€‚å› è€Œå¯¹äºæ•°æ®ä¸­å¿ƒå†…éƒ¨çš„ç›¸äº’è°ƒç”¨ï¼Œå¾ˆå¤šå…¬å¸é€‰å‹çš„æ—¶å€™ï¼Œè¿˜æ˜¯å¸Œæœ›é‡‡ç”¨æ›´åŠ çœç©ºé—´å’Œå¸¦å®½çš„äºŒè¿›åˆ¶çš„æ–¹æ¡ˆã€‚</p><h2 id="4-2-DubboæœåŠ¡åŒ–æ¡†æ¶äºŒè¿›åˆ¶çš„RPCæ–¹å¼"><a href="#4-2-DubboæœåŠ¡åŒ–æ¡†æ¶äºŒè¿›åˆ¶çš„RPCæ–¹å¼" class="headerlink" title="4.2 DubboæœåŠ¡åŒ–æ¡†æ¶äºŒè¿›åˆ¶çš„RPCæ–¹å¼"></a>4.2 DubboæœåŠ¡åŒ–æ¡†æ¶äºŒè¿›åˆ¶çš„RPCæ–¹å¼</h2><p><img src="https://i.loli.net/2020/02/02/fX8e25rG6xkBpq4.jpg" alt="fig13.jpg"></p><p>Dubbo ä¼šåœ¨å®¢æˆ·ç«¯çš„æœ¬åœ°å¯åŠ¨ä¸€ä¸ª Proxyï¼Œå…¶å®å°±æ˜¯å®¢æˆ·ç«¯çš„ Stubï¼Œå¯¹äºè¿œç¨‹çš„è°ƒç”¨éƒ½é€šè¿‡è¿™ä¸ª Stub è¿›è¡Œå°è£…ã€‚</p><p>æ¥ä¸‹æ¥ï¼ŒDubbo ä¼šä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡ç«¯çš„åˆ—è¡¨ï¼Œæ ¹æ®è·¯ç”±è§„åˆ™å’Œè´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œåœ¨å¤šä¸ªæœåŠ¡ç«¯ä¸­é€‰æ‹©ä¸€ä¸ªæœ€åˆé€‚çš„æœåŠ¡ç«¯è¿›è¡Œè°ƒç”¨ã€‚</p><p>è°ƒç”¨æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œé¦–å…ˆè¦è¿›è¡Œç¼–ç å’Œåºåˆ—åŒ–ï¼Œå½¢æˆ Dubbo å¤´å’Œåºåˆ—åŒ–çš„æ–¹æ³•å’Œå‚æ•°ã€‚å°†ç¼–ç å¥½çš„æ•°æ®ï¼Œäº¤ç»™ç½‘ç»œå®¢æˆ·ç«¯è¿›è¡Œå‘é€ï¼Œç½‘ç»œæœåŠ¡ç«¯æ”¶åˆ°æ¶ˆæ¯åï¼Œè¿›è¡Œè§£ç ã€‚ç„¶åå°†ä»»åŠ¡åˆ†å‘ç»™æŸä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œåœ¨çº¿ç¨‹ä¸­ä¼šè°ƒç”¨æœåŠ¡ç«¯çš„ä»£ç é€»è¾‘ï¼Œç„¶åè¿”å›ç»“æœã€‚</p><h2 id="4-3-å¦‚ä½•è§£å†³åè®®çº¦å®šé—®é¢˜ï¼Ÿ"><a href="#4-3-å¦‚ä½•è§£å†³åè®®çº¦å®šé—®é¢˜ï¼Ÿ" class="headerlink" title="4.3 å¦‚ä½•è§£å†³åè®®çº¦å®šé—®é¢˜ï¼Ÿ"></a>4.3 å¦‚ä½•è§£å†³åè®®çº¦å®šé—®é¢˜ï¼Ÿ</h2><p>Dubbo ä¸­é»˜è®¤çš„ RPC åè®®æ˜¯ Hessian2ã€‚ä¸ºäº†ä¿è¯ä¼ è¾“çš„æ•ˆç‡ï¼ŒHessian2 å°†è¿œç¨‹è°ƒç”¨åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶è¿›è¡Œä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œä¸€å®šçš„å‹ç¼©ã€‚è¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼ŒåŒä¸ºäºŒè¿›åˆ¶çš„åºåˆ—åŒ–åè®®ï¼ŒHessian2 å’Œå‰é¢çš„äºŒè¿›åˆ¶çš„ RPC æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼ŸHessian2 æ˜¯è§£å†³äº†ä¸€äº›é—®é¢˜çš„ã€‚ä¾‹å¦‚ï¼ŒåŸæ¥è¦å®šä¹‰ä¸€ä¸ªåè®®æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è¿™ä¸ªæ–‡ä»¶ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ Stubï¼Œæ‰èƒ½è¿›è¡Œç›¸äº’è°ƒç”¨ï¼Œè¿™æ ·ä½¿å¾—ä¿®æ”¹å°±ä¼šä¸æ–¹ä¾¿ã€‚Hessian2 ä¸éœ€è¦å®šä¹‰è¿™ä¸ªåè®®æ–‡ä»¶ï¼Œè€Œæ˜¯è‡ªæè¿°çš„ã€‚ä»€ä¹ˆæ˜¯è‡ªæè¿°å‘¢ï¼Ÿ</p><p>æ‰€è°“è‡ªæè¿°å°±æ˜¯ï¼Œå…³äºè°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯ä»€ä¹ˆï¼Œå¦ä¸€æ–¹ä¸éœ€è¦æ‹¿åˆ°æŸä¸ªåè®®æ–‡ä»¶ã€æ‹¿åˆ°äºŒè¿›åˆ¶ï¼Œé å®ƒæœ¬èº«æ ¹æ® Hessian2 çš„è§„åˆ™ï¼Œå°±èƒ½è§£æå‡ºæ¥ã€‚</p><h2 id="4-4-å¦‚ä½•è§£å†³RPCä¼ è¾“é—®é¢˜ï¼Ÿ"><a href="#4-4-å¦‚ä½•è§£å†³RPCä¼ è¾“é—®é¢˜ï¼Ÿ" class="headerlink" title="4.4 å¦‚ä½•è§£å†³RPCä¼ è¾“é—®é¢˜ï¼Ÿ"></a>4.4 å¦‚ä½•è§£å†³RPCä¼ è¾“é—®é¢˜ï¼Ÿ</h2><p>Dubboä½¿ç”¨äº†Nettyçš„ç½‘ç»œä¼ è¾“æ¡†æ¶ã€‚</p><p>Nettyæ˜¯ä¸€ä¸ªéé˜»å¡çš„åŸºäºäº‹ä»¶çš„ç½‘ç»œä¼ è¾“æ¡†æ¶ï¼Œåœ¨æœåŠ¡ç«¯å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå¹¶æ³¨å†Œä»¥ä¸‹äº‹ä»¶ï¼š</p><ul><li>è¿æ¥äº‹ä»¶ - å½“æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿æ¥äº‹ä»¶æ—¶ï¼Œä¼šè°ƒç”¨void connected(Channel channel)æ–¹æ³•</li><li>å½“<strong>å¯å†™äº‹ä»¶</strong>è§¦å‘æ—¶ï¼Œä¼šè°ƒç”¨void sent(Channel channel, Object message)ï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯è¿”å›å“åº”æ•°æ®</li><li>å½“<strong>å¯è¯»äº‹ä»¶</strong>è§¦å‘æ—¶ï¼Œä¼šè°ƒç”¨ void received(Channel channel, Object message) ï¼ŒæœåŠ¡ç«¯åœ¨æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚æ•°æ®ã€‚</li><li>å½“<strong>å‘ç”Ÿå¼‚å¸¸</strong>æ—¶ï¼Œä¼šè°ƒç”¨ void caught(Channel channel, Throwable exception)ã€‚</li></ul><p>å½“äº‹ä»¶è§¦å‘ä¹‹åï¼ŒæœåŠ¡ç«¯åœ¨è¿™äº›å‡½æ•°ä¸­çš„é€»è¾‘ï¼Œå¯ä»¥é€‰æ‹©<strong>ç›´æ¥åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢è¿›è¡Œæ“ä½œï¼Œè¿˜æ˜¯å°†è¯·æ±‚åˆ†å‘åˆ°çº¿ç¨‹æ± </strong>å»å¤„ç†ã€‚ä¸€èˆ¬å¼‚æ­¥çš„æ•°æ®è¯»å†™éƒ½éœ€è¦å¦å¤–çš„çº¿ç¨‹æ± å‚ä¸ï¼Œåœ¨çº¿ç¨‹æ± ä¸­ä¼š<strong>è°ƒç”¨çœŸæ­£çš„æœåŠ¡ç«¯ä¸šåŠ¡ä»£ç é€»è¾‘</strong>ï¼Œè¿”å›ç»“æœ</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¯´äº†æ•°æ®ä¸­å¿ƒé‡Œé¢çš„ç›¸äº’è°ƒç”¨ã€‚ä¸ºäº†é«˜æ€§èƒ½ï¼Œå¤§å®¶éƒ½æ„¿æ„ç”¨äºŒè¿›åˆ¶ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆåæœŸ Spring Cloud åˆå…´èµ·äº†å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼Œå¹¶å‘é‡è¶Šæ¥è¶Šå¤§ï¼Œå·²ç»åˆ°äº†å¾®æœåŠ¡çš„é˜¶æ®µã€‚åŒåŸæ¥çš„ SOA ä¸åŒï¼Œå¾®æœåŠ¡ç²’åº¦æ›´ç»†ï¼Œæ¨¡å—ä¹‹é—´çš„å…³ç³»æ›´åŠ å¤æ‚ã€‚</p><p>åœ¨ä¸Šé¢çš„æ¶æ„ä¸­ï¼Œå¦‚æœä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼è¿›è¡Œåºåˆ—åŒ–ï¼Œè™½ç„¶ä¸ç”¨åè®®æ–‡ä»¶æ¥ç”Ÿæˆ Stubï¼Œä½†æ˜¯å¯¹äºæ¥å£çš„å®šä¹‰ï¼Œä»¥åŠä¼ çš„å¯¹è±¡ DTOï¼Œ<strong>è¿˜æ˜¯éœ€è¦å…±äº« JAR</strong>ã€‚å› ä¸ºåªæœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æœ‰è¿™ä¸ª JARï¼Œæ‰èƒ½æˆåŠŸåœ°åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p><p>ä½†å½“å…³ç³»å¤æ‚çš„æ—¶å€™ï¼ŒJAR çš„ä¾èµ–ä¹Ÿå˜å¾—å¼‚å¸¸å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œè€Œä¸”å¦‚æœåœ¨ DTO é‡ŒåŠ ä¸€ä¸ªå­—æ®µï¼ŒåŒæ–¹çš„ JAR æ²¡æœ‰åŒ¹é…å¥½ï¼Œä¹Ÿä¼šå¯¼è‡´åºåˆ—åŒ–ä¸æˆåŠŸï¼Œè€Œä¸”è¿˜æœ‰å¯èƒ½å¾ªç¯ä¾èµ–ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§é€‰æ‹©ã€‚</p><ol><li>å»ºç«‹ä¸¥æ ¼çš„é¡¹ç›®ç®¡ç†æµç¨‹</li></ol><ul><li>ä¸å…è®¸å¾ªç¯è°ƒç”¨ï¼Œä¸å…è®¸è·¨å±‚è°ƒç”¨ï¼Œåªå‡†ä¸Šå±‚è°ƒç”¨ä¸‹å±‚ï¼Œä¸å…è®¸ä¸‹å±‚è°ƒç”¨ä¸Šå±‚ã€‚</li><li>æ¥å£è¦ä¿æŒå…¼å®¹æ€§ï¼Œä¸å…¼å®¹çš„æ¥å£æ–°æ·»åŠ è€Œéæ”¹åŸæ¥çš„ï¼Œå½“æ¥å£é€šè¿‡ç›‘æ§ï¼Œå‘ç°ä¸ç”¨çš„æ—¶å€™ï¼Œå†ä¸‹æ‰ã€‚</li><li>å‡çº§çš„æ—¶å€™ï¼Œå…ˆå‡çº§æœåŠ¡æä¾›ç«¯ï¼Œå†å‡çº§æœåŠ¡æ¶ˆè´¹ç«¯ã€‚</li></ul><ol start="2"><li>æ”¹ç”¨RESTfulæ–¹å¼</li></ol><ul><li>ä½¿ç”¨ Spring Cloudï¼Œæ¶ˆè´¹ç«¯å’Œæä¾›ç«¯ä¸ç”¨å…±äº« JARï¼Œå„å£°æ˜å„çš„ï¼Œåªè¦èƒ½å˜æˆ JSON å°±è¡Œï¼Œè€Œä¸” JSON ä¹Ÿæ˜¯æ¯”è¾ƒçµæ´»çš„ã€‚</li><li>ä½¿ç”¨ RESTful çš„æ–¹å¼ï¼Œæ€§èƒ½ä¼šé™ä½ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡æ¨ªå‘æ‰©å±•æ¥æŠµæ¶ˆå•æœºçš„æ€§èƒ½æŸè€—ã€‚</li></ul><h1 id="5-è·¨è¯­è¨€ç±»RPCåè®®"><a href="#5-è·¨è¯­è¨€ç±»RPCåè®®" class="headerlink" title="5. è·¨è¯­è¨€ç±»RPCåè®®"></a>5. è·¨è¯­è¨€ç±»RPCåè®®</h1><p>é€šè¿‡å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒäºŒè¿›åˆ¶çš„ä¼ è¾“æ€§èƒ½å¥½ï¼Œæ–‡æœ¬ç±»çš„ä¼ è¾“æ€§èƒ½å·®ä¸€äº›ï¼›äºŒè¿›åˆ¶çš„éš¾ä»¥è·¨è¯­è¨€ï¼Œæ–‡æœ¬ç±»çš„å¯ä»¥è·¨è¯­è¨€ï¼›è¦å†™åè®®æ–‡ä»¶çš„ä¸¥è°¨ä¸€äº›ï¼Œä¸å†™åè®®æ–‡ä»¶çš„çµæ´»ä¸€äº›ã€‚è™½ç„¶éƒ½æœ‰æœåŠ¡å‘ç°æœºåˆ¶ï¼Œæœ‰çš„å¯ä»¥è¿›è¡ŒæœåŠ¡æ²»ç†ï¼Œæœ‰çš„åˆ™æ²¡æœ‰ã€‚</p><p>RPCä»æœ€åˆçš„å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ¨¡å¼ï¼Œæœ€ç»ˆæ¼”åŒ–åˆ°å¾®æœåŠ¡ã€‚å¯¹äºRPCæ¡†æ¶çš„è¦æ±‚ä¹Ÿå¼€å§‹é€æ¸å˜å¤šï¼Œè¦æ±‚å¦‚ä¸‹ï¼š </p><ol><li>ä¼ è¾“æ€§èƒ½å¾ˆé‡è¦ï¼Œå› ä¸ºæœåŠ¡ä¹‹é—´çš„è°ƒç”¨å¤ªè¿‡é¢‘ç¹ï¼Œè¿˜æ˜¯äºŒè¿›åˆ¶çš„è¶Šå¿«è¶Šå¥½</li><li>è·¨è¯­è¨€å¾ˆé‡è¦ï¼Œå› ä¸ºæœåŠ¡å¤šäº†ï¼Œä»€ä¹ˆè¯­è¨€å†™æˆçš„éƒ½æœ‰ï¼Œè€Œä¸”ä¸åŒçš„åœºæ™¯é€‚å®œç”¨ä¸åŒçš„è¯­è¨€ï¼Œä¸èƒ½ä¸€ä¸ªè¯­è¨€èµ°åˆ°åº•ã€‚</li><li>æœ€å¥½æ—¢ä¸¥è°¨åˆçµæ´»ï¼Œæ·»åŠ ä¸€ä¸ªå­—æ®µä¸éœ€è¦é‡æ–°ç¼–è¯‘å’Œå‘å¸ƒç¨‹åº</li><li>æœ€å¥½æ—¢æœ‰æœåŠ¡å‘ç°ï¼Œä¹Ÿæœ‰æœåŠ¡æ²»ç†ï¼Œå°±åƒDubboå’ŒSpring Cloudè¿™æ ·å­ã€‚</li></ol><h2 id="5-1-gRPCåè®®"><a href="#5-1-gRPCåè®®" class="headerlink" title="5.1 gRPCåè®®"></a>5.1 gRPCåè®®</h2><p>äºŒè¿›åˆ¶ä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥è·¨è¯­è¨€ä¼ è¾“ã€‚å› ä¸ºè¯­è¨€ä¸åŒï¼Œè¿˜å‹ç¼©è¿‡äº†ï¼Œæ‰€ä»¥åŒæ–¹å¿…é¡»æä¸€ä¸ªåè®®çº¦å®šæ–‡ä»¶ï¼Œè§„å®šå¥½åŒæ–¹æ²Ÿé€šçš„ä¸“ä¸šæœ¯è¯­ï¼Œè¿™æ ·æ¥è®©æ•´ä¸ªæ²Ÿé€šæ›´åŠ é¡ºç•…ã€‚</p><p>å¯¹äº GRPC æ¥è®²ï¼ŒäºŒè¿›åˆ¶åºåˆ—åŒ–åè®®æ˜¯ Protocol Buffersã€‚é¦–å…ˆï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªåè®®æ–‡ä»¶.protoã€‚</p><pre><code>syntax = â€œproto3â€;package com.llchen60.grpcoption java_package = â€œcom.llchen60.grpcâ€;message Order {  required string date = 1;  required string classname = 2;  required string author = 3;  required int price = 4;}message OrderResponse {  required string message = 1;}service PurchaseOrder {  rpc Purchase (Order) returns (OrderResponse) {}}</code></pre><p>åœ¨è¿™ä¸ªåè®®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæŒ‡å®šä½¿ç”¨ proto3 çš„è¯­æ³•ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨** Protocol Buffers çš„è¯­æ³•<strong>ï¼Œå®šä¹‰ä¸¤ä¸ªæ¶ˆæ¯çš„ç±»å‹ï¼Œä¸€ä¸ªæ˜¯å‘å‡ºå»çš„å‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¿”å›çš„ç»“æœã€‚é‡Œé¢çš„æ¯ä¸€ä¸ªå­—æ®µï¼Œä¾‹å¦‚ dateã€classnameã€authorã€price éƒ½æœ‰</strong>å”¯ä¸€çš„ä¸€ä¸ªæ•°å­—æ ‡è¯†**ï¼Œè¿™æ ·åœ¨å‹ç¼©çš„æ—¶å€™ï¼Œå°±ä¸ç”¨ä¼ è¾“å­—æ®µåç§°äº†ï¼Œåªä¼ è¾“è¿™ä¸ªæ•°å­—æ ‡è¯†å°±è¡Œäº†ï¼Œèƒ½èŠ‚çœå¾ˆå¤šç©ºé—´ã€‚</p><p>æœ€åå®šä¹‰ä¸€ä¸ªServiceï¼Œé‡Œé¢ä¼šæœ‰ä¸€ä¸ªRPCè°ƒç”¨çš„å£°æ˜ï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆè¯­è¨€ï¼Œéƒ½æœ‰ç›¸åº”çš„å·¥å…·ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„Stubç¨‹åºï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥åƒè°ƒç”¨æœ¬åœ°ä¸€æ ·ï¼Œè°ƒç”¨è¿œç¨‹çš„æœåŠ¡äº†ã€‚</p><h2 id="5-2-åè®®çº¦å®šé—®é¢˜"><a href="#5-2-åè®®çº¦å®šé—®é¢˜" class="headerlink" title="5.2 åè®®çº¦å®šé—®é¢˜"></a>5.2 åè®®çº¦å®šé—®é¢˜</h2><p>Protocol Buffersï¼Œæ˜¯ä¸€ä¸ªæœ‰ç€å¾ˆé«˜çš„å‹ç¼©æ•ˆç‡çš„åºåˆ—åŒ–åè®®ã€‚å¯¹äº int ç±»å‹ 32 ä½çš„ï¼Œä¸€èˆ¬éƒ½éœ€è¦ 4 ä¸ª Byte è¿›è¡Œå­˜å‚¨ã€‚åœ¨ Protocol Buffers ä¸­ï¼Œä½¿ç”¨çš„æ˜¯å˜é•¿æ•´æ•°çš„å½¢å¼ã€‚å¯¹äºæ¯ä¸€ä¸ª Byte çš„ 8 ä½ï¼Œæœ€é«˜ä½éƒ½æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚å¦‚æœè¯¥ä½ä¸º 1ï¼Œè¡¨ç¤ºè¿™ä¸ªæ•°å­—æ²¡å®Œï¼Œåç»­çš„ Byte ä¹Ÿå±äºè¿™ä¸ªæ•°å­—ï¼›å¦‚æœè¯¥ä½ä¸º 0ï¼Œåˆ™è¿™ä¸ªæ•°å­—åˆ°æ­¤ç»“æŸã€‚å…¶ä»–çš„ 7 ä¸ª Bit æ‰æ˜¯ç”¨æ¥è¡¨ç¤ºæ•°å­—çš„å†…å®¹ã€‚å› æ­¤ï¼Œå°äº 128 çš„æ•°å­—éƒ½å¯ä»¥ç”¨ä¸€ä¸ª Byte è¡¨ç¤ºï¼›å¤§äº 128 çš„æ•°å­—ï¼Œæ¯”å¦‚ 130ï¼Œä¼šç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚å¯¹äºæ¯ä¸€ä¸ªå­—æ®µï¼Œä½¿ç”¨çš„æ˜¯ TLVï¼ˆTagï¼ŒLengthï¼ŒValueï¼‰çš„å­˜å‚¨åŠæ³•ã€‚å…¶ä¸­ Tag = (field_num &lt;&lt; 3) | wire_typeã€‚field_num å°±æ˜¯åœ¨ proto æ–‡ä»¶ä¸­ï¼Œç»™æ¯ä¸ªå­—æ®µæŒ‡å®šå”¯ä¸€çš„æ•°å­—æ ‡è¯†ï¼Œè€Œ wire_type ç”¨äºæ ‡è¯†åé¢çš„æ•°æ®ç±»å‹ã€‚</p><p><img src="https://i.loli.net/2020/02/02/Rvy2MsuzKemHNb6.jpg" alt="fig14.jpg"></p><p>åœ¨çµæ´»æ€§æ–¹é¢ï¼Œè¿™ç§åŸºäºåè®®æ–‡ä»¶çš„äºŒè¿›åˆ¶å‹ç¼©åè®®å¾€å¾€å­˜åœ¨æ›´æ–°ä¸æ–¹ä¾¿çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å› ä¸ºéœ€æ±‚çš„æ”¹å˜éœ€è¦æ·»åŠ æˆ–è€…åˆ é™¤å­—æ®µã€‚è¿™ä¸€ç‚¹ä¸Šï¼ŒProtocol Buffersè€ƒè™‘äº†å…¼å®¹æ€§ï¼Œåœ¨ä¸Šé¢çš„åè®®æ–‡ä»¶å½“ä¸­ï¼Œæ¯ä¸€ä¸ªå­—æ®µéƒ½æœ‰ä¿®é¥°ç¬¦ï¼Œæ¯”å¦‚ï¼š</p><ul><li>required </li><li>optional </li><li>repeated </li></ul><p>å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹åè®®æ–‡ä»¶ï¼Œå¯¹äºèµ‹ç»™æŸä¸ªæ ‡ç­¾çš„æ•°å­—ï¼Œä¾‹å¦‚ string author=3ï¼Œè¿™ä¸ªå°±ä¸è¦æ”¹å˜äº†ï¼Œæ”¹å˜äº†å°±ä¸è®¤äº†ï¼›ä¹Ÿä¸è¦æ·»åŠ æˆ–è€…åˆ é™¤ required å­—æ®µï¼Œå› ä¸ºè§£æçš„æ—¶å€™ï¼Œå‘ç°æ²¡æœ‰è¿™ä¸ªå­—æ®µå°±ä¼šæŠ¥é”™ã€‚å¯¹äº optional å’Œ repeated å­—æ®µï¼Œå¯ä»¥åˆ é™¤ï¼Œä¹Ÿå¯ä»¥æ·»åŠ ã€‚è¿™å°±ç»™äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å‡çº§çš„å¯èƒ½æ€§ã€‚</p><h2 id="5-3-ç½‘ç»œä¼ è¾“é—®é¢˜"><a href="#5-3-ç½‘ç»œä¼ è¾“é—®é¢˜" class="headerlink" title="5.3 ç½‘ç»œä¼ è¾“é—®é¢˜"></a>5.3 ç½‘ç»œä¼ è¾“é—®é¢˜</h2><p>å‡è®¾æ˜¯JavaæŠ€æœ¯æ ˆï¼Œé‚£ä¹ˆgRPCçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡Netty Channelä½œä¸ºæ•°æ®é€šé“ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½è¢«å°è£…æˆHTTP2.0çš„Streamå½“ä¸­ã€‚</p><p>Nettyæ˜¯ä¸€ä¸ªæç¬‘çš„åŸºäºå¼‚æ­¥IOçš„ç½‘ç»œä¼ è¾“æ¡†æ¶ï¼Œ</p><p>HTTP2.0è¿˜å°†æ‰€æœ‰çš„ä¼ è¾“ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶å¯¹å®ƒä»¬é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ç¼–ç ã€‚</p><p>é€šè¿‡è¿™ä¸¤ç§æœºåˆ¶ï¼ŒHTTP 2.0 çš„å®¢æˆ·ç«¯å¯ä»¥å°†å¤šä¸ªè¯·æ±‚åˆ†åˆ°ä¸åŒçš„æµä¸­ï¼Œç„¶åå°†è¯·æ±‚å†…å®¹æ‹†æˆå¸§ï¼Œè¿›è¡ŒäºŒè¿›åˆ¶ä¼ è¾“ã€‚è¿™äº›å¸§å¯ä»¥æ‰“æ•£ä¹±åºå‘é€ï¼Œ ç„¶åæ ¹æ®æ¯ä¸ªå¸§é¦–éƒ¨çš„æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ä¼˜å…ˆçº§ï¼Œå†³å®šä¼˜å…ˆå¤„ç†å“ªä¸ªæµçš„æ•°æ®ã€‚</p><p><img src="https://i.loli.net/2020/02/02/bqVPBtkcZwWL5A4.jpg" alt="fig15.jpg"></p><p>ç”±äºåŸºäºHTTP2.0ï¼ŒgRPCå’Œå…¶ä»–çš„RPCä¸åŒï¼Œå¯ä»¥å®šä¹‰å››ç§æœåŠ¡æ–¹æ³•ã€‚</p><h3 id="5-3-1-å•å‘RPC"><a href="#5-3-1-å•å‘RPC" class="headerlink" title="5.3.1 å•å‘RPC"></a>5.3.1 å•å‘RPC</h3><p>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡ç«¯ï¼Œä»æœåŠ¡ç«¯è·å–ä¸€ä¸ªåº”ç­”ï¼Œå°±åƒæ™®é€šçš„ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¸€æ ·ã€‚</p><pre><code>rpc SayHello(HelloRequest) returns (HelloResponse){}</code></pre><h3 id="5-3-2-æœåŠ¡ç«¯æµå¼RPC"><a href="#5-3-2-æœåŠ¡ç«¯æµå¼RPC" class="headerlink" title="5.3.2 æœåŠ¡ç«¯æµå¼RPC"></a>5.3.2 æœåŠ¡ç«¯æµå¼RPC</h3><p>æœåŠ¡ç«¯è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªç»“æœï¼Œè€Œæ˜¯ä¸€æ‰¹ã€‚å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡ç«¯ï¼Œå¯è·å–ä¸€ä¸ªæ•°æ®æµç”¨æ¥è¯»å–ä¸€ç³»åˆ—ä¿¡æ¯ã€‚å®¢æˆ·ç«¯ä»è¿”å›çš„æ•°æ®æµé‡Œä¸€ç›´è¯»å–ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„æ¶ˆæ¯ä¸ºæ­¢ã€‚</p><pre><code>rpc LotsOfReplies(HelloRequest) returns (stream HelloResponse){}</code></pre><h3 id="5-3-3-å®¢æˆ·ç«¯æµå¼RPC"><a href="#5-3-3-å®¢æˆ·ç«¯æµå¼RPC" class="headerlink" title="5.3.3 å®¢æˆ·ç«¯æµå¼RPC"></a>5.3.3 å®¢æˆ·ç«¯æµå¼RPC</h3><p>å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯ä¸€æ‰¹ï¼Œå®¢æˆ·ç«¯ç”¨æä¾›çš„ä¸€ä¸ªæ•°æ®æµå†™å…¥å¹¶å‘é€ä¸€ç³»åˆ—æ¶ˆæ¯ç»™æœåŠ¡ç«¯ã€‚ä¸€æ—¦å®¢æˆ·ç«¯å®Œæˆæ¶ˆæ¯å†™å…¥ï¼Œå°±ç­‰å¾…æœåŠ¡ç«¯è¯»å–è¿™äº›æ¶ˆæ¯å¹¶è¿”å›åº”ç­”ã€‚</p><pre><code>rpc LotsOfGreetings(stream HelloRequest) returns (HelloResponse) {}</code></pre><h3 id="5-3-4-åŒå‘æµå¼RPC"><a href="#5-3-4-åŒå‘æµå¼RPC" class="headerlink" title="5.3.4 åŒå‘æµå¼RPC"></a>5.3.4 åŒå‘æµå¼RPC</h3><p>å³ä¸¤è¾¹éƒ½å¯ä»¥åˆ†åˆ«é€šè¿‡ä¸€ä¸ªè¯»å†™æ•°æ®æµæ¥å‘é€ä¸€ç³»åˆ—æ¶ˆæ¯ã€‚è¿™ä¸¤ä¸ªæ•°æ®æµæ“ä½œæ˜¯<strong>ç›¸äº’ç‹¬ç«‹</strong>çš„ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯<strong>èƒ½æŒ‰å…¶å¸Œæœ›çš„ä»»æ„é¡ºåºè¯»å†™</strong>ï¼ŒæœåŠ¡ç«¯å¯ä»¥åœ¨å†™åº”ç­”å‰ç­‰å¾…æ‰€æœ‰çš„å®¢æˆ·ç«¯æ¶ˆæ¯ï¼Œæˆ–è€…å®ƒå¯ä»¥å…ˆè¯»ä¸€ä¸ªæ¶ˆæ¯å†å†™ä¸€ä¸ªæ¶ˆæ¯ï¼Œæˆ–è€…è¯»å†™ç›¸ç»“åˆçš„å…¶ä»–æ–¹å¼ã€‚æ¯ä¸ªæ•°æ®æµé‡Œæ¶ˆæ¯çš„é¡ºåºä¼šè¢«ä¿æŒã€‚</p><pre><code>rpc BidiHello(stream HelloRequest) returns (stream HelloResponse){}</code></pre><p>å¦‚æœåŸºäº HTTP  2.0ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’æ–¹å¼è¦ä¸°å¯Œå¾—å¤šï¼Œä¸ä»…å¯ä»¥å•æ–¹å‘è¿œç¨‹è°ƒç”¨ï¼Œè¿˜å¯ä»¥å®ç°å½“æœåŠ¡ç«¯çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œä¸»åŠ¨é€šçŸ¥å®¢æˆ·ç«¯ã€‚</p><h2 id="5-4-æœåŠ¡å‘ç°ä¸æ²»ç†é—®é¢˜"><a href="#5-4-æœåŠ¡å‘ç°ä¸æ²»ç†é—®é¢˜" class="headerlink" title="5.4 æœåŠ¡å‘ç°ä¸æ²»ç†é—®é¢˜"></a>5.4 æœåŠ¡å‘ç°ä¸æ²»ç†é—®é¢˜</h2><p>gRPCæœ¬èº«æ²¡æœ‰æä¾›æœåŠ¡å‘ç°çš„æœºåˆ¶ï¼Œéœ€è¦å€ŸåŠ©å…¶ä»–çš„ç»„ä»¶ï¼Œå‘ç°è¦è®¿é—®çš„æœåŠ¡ç«¯ï¼Œåœ¨å¤šä¸ªæœåŠ¡ç«¯ä¹‹é—´è¿›è¡Œå®¹é”™å’Œè´Ÿè½½å‡è¡¡ã€‚</p><p>è¿™ä¸ªåœ°æ–¹çš„é‡ç‚¹é—®é¢˜åœ¨äºå¦‚ä½•å‘ç°æœåŠ¡ç«¯ï¼Œå¹¶æ ¹æ®æœåŠ¡ç«¯çš„å˜åŒ–ï¼ŒåŠ¨æ€ä¿®æ”¹è´Ÿè½½å‡è¡¡å™¨çš„é…ç½®ã€‚</p><h3 id="5-4-1-Envoyé…ç½®"><a href="#5-4-1-Envoyé…ç½®" class="headerlink" title="5.4.1 Envoyé…ç½®"></a>5.4.1 Envoyé…ç½®</h3><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€ç§å¯¹äº GRPC æ”¯æŒæ¯”è¾ƒå¥½çš„è´Ÿè½½å‡è¡¡å™¨ Envoyã€‚å…¶å® Envoy ä¸ä»…ä»…æ˜¯è´Ÿè½½å‡è¡¡å™¨ï¼Œå®ƒè¿˜æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ C++ å†™çš„ Proxy è½¬å‘å™¨ï¼Œå¯ä»¥é…ç½®éå¸¸çµæ´»çš„è½¬å‘è§„åˆ™ã€‚</p><p>è¿™äº›è§„åˆ™å¯ä»¥æ˜¯é™æ€çš„ï¼Œæ”¾åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™åŠ è½½ã€‚è¦æƒ³é‡æ–°åŠ è½½ï¼Œä¸€èˆ¬éœ€è¦é‡æ–°å¯åŠ¨ï¼Œä½†æ˜¯ Envoy æ”¯æŒçƒ­åŠ è½½å’Œçƒ­é‡å¯ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯å°†è§„åˆ™è®¾ç½®ä¸ºåŠ¨æ€çš„ï¼Œæ”¾åœ¨ç»Ÿä¸€çš„åœ°æ–¹ç»´æŠ¤ã€‚è¿™ä¸ªç»Ÿä¸€çš„åœ°æ–¹åœ¨ Envoy çœ¼ä¸­è¢«ç§°ä¸ºæœåŠ¡å‘ç°ï¼ˆDiscovery Serviceï¼‰ï¼Œè¿‡ä¸€æ®µæ—¶é—´å»è¿™é‡Œæ‹¿ä¸€ä¸‹é…ç½®ï¼Œå°±ä¿®æ”¹äº†è½¬å‘ç­–ç•¥ã€‚</p><p>æ— è®ºæ˜¯é™æ€çš„ï¼Œè¿˜æ˜¯åŠ¨æ€çš„ï¼Œåœ¨é…ç½®é‡Œé¢å¾€å¾€ä¼šé…ç½®å››ä¸ªä¸œè¥¿ï¼š </p><ol><li>listener: Envoyæ—¢ç„¶æ˜¯Proxyï¼Œä¸“é—¨åšè½¬å‘ï¼Œå°±å¾—ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ¥å…¥è¯·æ±‚ï¼Œç„¶åæ‰èƒ½æ ¹æ®ç­–ç•¥è½¬å‘ï¼Œè¿™ä¸ªç›‘å¬çš„ç«¯å£å°±ç§°ä¸ºlistener.</li><li>endpoint: æ˜¯ç›®æ ‡çš„IPåœ°å€å’Œç«¯å£ã€‚è¿™ä¸ªæ˜¯proxyæœ€ç»ˆå°†è¯·æ±‚è½¬å‘åˆ°çš„åœ°æ–¹ã€‚</li><li>cluster: ä¸€ä¸ªclusteræ˜¯å…·æœ‰å®Œå…¨ç›¸åŒè¡Œä¸ºçš„å¤šä¸ªendpointï¼Œå³å¦‚æœæœ‰ä¸‰ä¸ªæœåŠ¡ç«¯åœ¨è¿è¡Œï¼Œå°±ä¼šæœ‰ä¸‰ä¸ªIPå’Œç«¯å£ï¼Œä½†æ˜¯éƒ¨ç½²çš„æ˜¯å®Œå…¨ç›¸åŒçš„ä¸‰ä¸ªæœåŠ¡ï¼Œå®ƒä»¬ç»„æˆäº†ä¸€ä¸ªclusterï¼Œä»clusteråˆ°endpointçš„è¿‡ç¨‹ç§°ä¸ºè´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥è½®è¯¢ã€‚</li><li>route: æœ‰æ—¶å€™å¤šä¸ªclusterå…·æœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ˜¯ä¸åŒçš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡routeè§„åˆ™ï¼Œé€‰æ‹©å°†è¯·æ±‚è·¯ç”±åˆ°æŸä¸€ä¸ªç‰ˆæœ¬å·å½“ä¸­ï¼Œå°±åˆ°äº†å¯¹åº”çš„clusteré‡Œé¢ã€‚</li></ol><p>å¦‚æœæ˜¯é™æ€çš„ï¼Œåˆ™å°†åç«¯çš„æœåŠ¡ç«¯çš„ IP åœ°å€æ‹¿åˆ°ï¼Œç„¶åæ”¾åœ¨é…ç½®æ–‡ä»¶é‡Œé¢å°±å¯ä»¥äº†ã€‚</p><p>å¦‚æœæ˜¯åŠ¨æ€çš„ï¼Œå°±éœ€è¦é…ç½®ä¸€ä¸ªæœåŠ¡å‘ç°ä¸­å¿ƒï¼Œè¿™ä¸ªæœåŠ¡å‘ç°ä¸­å¿ƒè¦å®ç° Envoy çš„ APIï¼ŒEnvoy å¯ä»¥ä¸»åŠ¨å»æœåŠ¡å‘ç°ä¸­å¿ƒæ‹‰å–è½¬å‘ç­–ç•¥ã€‚</p><p><img src="https://i.loli.net/2020/02/02/TFIJXoGlNMCh1Ec.jpg" alt="fig16.jpg"></p><p>çœ‹æ¥ï¼ŒEnvoy è¿›ç¨‹å’ŒæœåŠ¡å‘ç°ä¸­å¿ƒä¹‹é—´è¦ç»å¸¸ç›¸äº’é€šä¿¡ï¼Œäº’ç›¸æ¨é€æ•°æ®ï¼Œæ‰€ä»¥ Envoy åœ¨æ§åˆ¶é¢å’ŒæœåŠ¡å‘ç°ä¸­å¿ƒæ²Ÿé€šçš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨ GRPCï¼Œä¹Ÿå°±å¤©ç„¶å…·å¤‡åœ¨ç”¨æˆ·é¢æ”¯æ’‘ GRPC çš„èƒ½åŠ›ã€‚</p><h3 id="5-4-2-Envoy-åŠŸèƒ½"><a href="#5-4-2-Envoy-åŠŸèƒ½" class="headerlink" title="5.4.2 Envoy åŠŸèƒ½"></a>5.4.2 Envoy åŠŸèƒ½</h3><ul><li>é…ç½®è·¯ç”±ç­–ç•¥</li></ul><p>ä¾‹å¦‚åç«¯çš„æœåŠ¡æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡é…ç½® Envoy çš„ routeï¼Œæ¥è®¾ç½®ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´ï¼Œä¹Ÿå³ä¸¤ä¸ª cluster ä¹‹é—´çš„ route è§„åˆ™ï¼Œä¸€ä¸ªå  99% çš„æµé‡ï¼Œä¸€ä¸ªå  1% çš„æµé‡ã€‚</p><ul><li>è´Ÿè½½å‡è¡¡ç­–ç•¥</li></ul><p>å¯¹äºä¸€ä¸ª cluster ä¸‹çš„å¤šä¸ªendpointï¼Œå¯ä»¥é…ç½®è´Ÿè½½å‡è¡¡æœºåˆ¶å’Œå¥åº·æ£€æŸ¥æœºåˆ¶ï¼Œå½“æœåŠ¡ç«¯æ–°å¢äº†ä¸€ä¸ªï¼Œæˆ–è€…æŒ‚äº†ä¸€ä¸ªï¼Œéƒ½èƒ½å¤ŸåŠæ—¶é…ç½® Envoyï¼Œè¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p><p><img src="https://i.loli.net/2020/02/02/E7Qrsp6q2tySUK5.jpg" alt="fig17.jpg"></p><p>æ‰€æœ‰è¿™äº›èŠ‚ç‚¹çš„å˜åŒ–éƒ½ä¼šä¸Šä¼ åˆ°æ³¨å†Œä¸­å¿ƒï¼Œæ‰€æœ‰è¿™äº›ç­–ç•¥éƒ½å¯ä»¥é€šè¿‡æ³¨å†Œä¸­å¿ƒè¿›è¡Œä¸‹å‘ï¼Œæ‰€ä»¥ï¼Œæ›´ä¸¥æ ¼çš„æ„ä¹‰ä¸Šè®²ï¼Œæ³¨å†Œä¸­å¿ƒå¯ä»¥ç§°ä¸ºæ³¨å†Œæ²»ç†ä¸­å¿ƒã€‚</p><p>Envoy è¿™ä¹ˆç‰›ï¼Œæ˜¯ä¸æ˜¯èƒ½å¤Ÿå°†æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨å…¨éƒ¨ç”±å®ƒä»£ç†ï¼Ÿå¦‚æœè¿™æ ·ï¼ŒæœåŠ¡ä¹Ÿä¸ç”¨åƒ Dubboï¼Œæˆ–è€… Spring Cloud ä¸€æ ·ï¼Œè‡ªå·±æ„ŸçŸ¥åˆ°æ³¨å†Œä¸­å¿ƒï¼Œè‡ªå·±æ³¨å†Œï¼Œè‡ªå·±æ²»ç†ï¼Œå¯¹åº”ç”¨å¹²é¢„æ¯”è¾ƒå¤§ã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„åº”ç”¨èƒ½å¤Ÿæ„è¯†ä¸åˆ°æœåŠ¡æ²»ç†çš„å­˜åœ¨ï¼Œå°±æ˜¯ç›´æ¥è¿›è¡Œ GRPC çš„è°ƒç”¨å°±å¯ä»¥äº†ã€‚</p><p>è¿™å°±æ˜¯æœªæ¥æœåŠ¡æ²»ç†çš„è¶‹åŠ¿<strong><em>Service Mesh</em></strong>ï¼Œå³åº”ç”¨ä¹‹é—´çš„ç›¸äº’è°ƒç”¨å…¨éƒ¨ç”±Envoyè¿›è¡Œä»£ç†ï¼ŒæœåŠ¡ä¹‹é—´çš„æ²»ç†ä¹Ÿè¢«Envoyè¿›è¡Œä»£ç†ï¼Œå®Œå…¨å°†æœåŠ¡æ²»ç†æŠ½è±¡å‡ºæ¥ï¼Œåˆ°å¹³å°å±‚è§£å†³ã€‚</p><p><img src="https://i.loli.net/2020/02/02/8naO9kR1dh3K4Cj.jpg" alt="fig18.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RESTFul </tag>
            
            <tag> RPC </tag>
            
            <tag> SOAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(ä¹)-äº‘</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B9%9D-%E4%BA%91/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B9%9D-%E4%BA%91/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è™šæ‹Ÿç½‘å¡"><a href="#1-è™šæ‹Ÿç½‘å¡" class="headerlink" title="1. è™šæ‹Ÿç½‘å¡"></a>1. è™šæ‹Ÿç½‘å¡</h1><p>æ•°æ®ä¸­å¿ƒçš„ç»´æŠ¤éå¸¸å¤æ‚éº»çƒ¦ï¼Œä¸»è¦ä½“ç°åœ¨é‡‡è´­ï¼Œè¿ç»´ï¼Œè§„æ ¼ï¼Œå¤ç”¨ç­‰æ–¹é¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘æ˜äº†è™šæ‹Ÿæœºï¼Œå¹¶åŸºäºå®ƒäº§ç”Ÿäº†äº‘è®¡ç®—æŠ€æœ¯ã€‚</p><h2 id="1-1-ç‰©ç†æœºåˆ°è™šæ‹Ÿæœº"><a href="#1-1-ç‰©ç†æœºåˆ°è™šæ‹Ÿæœº" class="headerlink" title="1.1 ç‰©ç†æœºåˆ°è™šæ‹Ÿæœº"></a>1.1 ç‰©ç†æœºåˆ°è™šæ‹Ÿæœº</h2><p>è½¯ä»¶æ¨¡æ‹Ÿç¡¬ä»¶çš„æ–¹å¼ï¼Œæ•°æ®ä¸­å¿ƒé‡Œé¢ç”¨çš„æ˜¯qumu-kvmï¼Œèƒ½è®©ä½ åœ¨ä¸€å°å·¨å¤§çš„ç‰©ç†æœºé‡Œé¢ï¼Œæå‡ºä¸€å°å°å°æœºå™¨ã€‚è¿™å¥—è½¯ä»¶å°±èƒ½è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼šä¸€ç‚¹å°±èƒ½åˆ›å»ºï¼Œä¸€ç‚¹å°±èƒ½é”€æ¯ã€‚æƒ³å¤šå¤§å°±æœ‰å¤šå¤§ï¼Œæ¯æ¬¡åˆ›å»ºçš„ç³»ç»Ÿéƒ½è¿˜æ˜¯æ–°çš„ã€‚</p><p>å…¶å®åšçš„äº‹æƒ…å°±å’ŒOSåšçš„äº‹æƒ…ä¸€æ ·ï¼Œè®©è™šæ‹Ÿæœºè§‰å¾—è‡ªå·±åœ¨ä½¿ç”¨ç‹¬ç«‹çš„è®¾å¤‡ï¼Œå æœ‰æ‰€æœ‰çš„å†…å­˜ï¼ŒCPUï¼Œç½‘ç»œï¼Œç¡¬ç›˜ã€‚</p><p>å®è´¨ä¸Šæ˜¯å¤šä¸ªè™šæ‹Ÿæœºè½®æµä½¿ç”¨ç‰©ç†CPUï¼Œå†…å­˜ä¹Ÿæ˜¯ä½¿ç”¨è™šæ‹Ÿå†…å­˜æ˜ å°„çš„æ–¹å¼ï¼Œæœ€ç»ˆæ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸Šã€‚ç¡¬ç›˜åœ¨ä¸€å—å¤§çš„æ–‡ä»¶ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªNä¸ªGçš„æ–‡ä»¶ï¼Œä½œä¸ºè™šæ‹Ÿæœºçš„ç¡¬ç›˜ã€‚</p><h2 id="1-2-è™šæ‹Ÿç½‘å¡çš„åŸç†-å¦‚ä½•å°†è™šæ‹Ÿæœºçš„ç½‘ç»œå’Œç‰©ç†æœºçš„ç½‘ç»œè¿æ¥èµ·æ¥ï¼Ÿ"><a href="#1-2-è™šæ‹Ÿç½‘å¡çš„åŸç†-å¦‚ä½•å°†è™šæ‹Ÿæœºçš„ç½‘ç»œå’Œç‰©ç†æœºçš„ç½‘ç»œè¿æ¥èµ·æ¥ï¼Ÿ" class="headerlink" title="1.2 è™šæ‹Ÿç½‘å¡çš„åŸç† - å¦‚ä½•å°†è™šæ‹Ÿæœºçš„ç½‘ç»œå’Œç‰©ç†æœºçš„ç½‘ç»œè¿æ¥èµ·æ¥ï¼Ÿ"></a>1.2 è™šæ‹Ÿç½‘å¡çš„åŸç† - å¦‚ä½•å°†è™šæ‹Ÿæœºçš„ç½‘ç»œå’Œç‰©ç†æœºçš„ç½‘ç»œè¿æ¥èµ·æ¥ï¼Ÿ</h2><p><img src="https://i.loli.net/2020/02/02/PkNpQgShKDFRtyx.jpg" alt="fig1.jpg"></p><p>è™šæ‹Ÿæœºæ˜¯ç‰©ç†æœºä¸Šè·‘ç€çš„ä¸€ä¸ªè½¯ä»¶ï¼Œè¿™ä¸ªè½¯ä»¶å¯ä»¥åƒå…¶ä»–åº”ç”¨æ‰“å¼€æ–‡ä»¶ä¸€æ ·ï¼Œæ‰“å¼€ä¸€ä¸ªç§°è°“TUN/TAPçš„Char Dev(å­—ç¬¦è®¾å¤‡æ–‡ä»¶)ã€‚æ‰“å¼€äº†è¿™ä¸ªå­—ç¬¦è®¾å¤‡æ–‡ä»¶ä¹‹åï¼Œåœ¨ç‰©ç†æœºä¸Šå°±èƒ½çœ‹åˆ°ä¸€å¼ è™šæ‹ŸTAPç½‘å¡ã€‚</p><p>è™šæ‹Ÿæœºä¼šæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨è‡ªå·±çš„è™šæ‹Ÿçš„èº«ä¸Š(hhhh)è™šæ‹Ÿå‡ºä¸€å¼ ç½‘å¡ï¼Œè®©è™šæ‹Ÿæœºé‡Œçš„åº”ç”¨è§‰å¾—å®ƒä»¬çœŸçš„æœ‰ä¸€å¼ ç½‘å¡ã€‚ç„¶åï¼Œæ‰€æœ‰çš„ç½‘ç»œåŒ…éƒ½å¾€è¿™é‡Œå‘ã€‚</p><p>å½“ç„¶ï¼Œç½‘ç»œåŒ…ä¼šåˆ°è™šæ‹ŸåŒ–è½¯ä»¶è¿™é‡Œã€‚å®ƒä¼šå°†ç½‘ç»œåŒ…è½¬æ¢æˆä¸º<strong>æ–‡ä»¶</strong>æµï¼Œå†™å…¥å­—ç¬¦è®¾å¤‡ï¼Œå°±åƒå†™ä¸€ä¸ªæ–‡ä»¶ä¸€æ ·ã€‚å†…æ ¸ä¸­ TUN/TAP å­—ç¬¦è®¾å¤‡é©±åŠ¨ä¼šæ”¶åˆ°è¿™ä¸ªå†™å…¥çš„æ–‡ä»¶æµï¼Œäº¤ç»™ TUN/TAP çš„è™šæ‹Ÿç½‘å¡é©±åŠ¨ã€‚è¿™ä¸ªé©±åŠ¨å°†æ–‡ä»¶æµå†æ¬¡è½¬æˆç½‘ç»œåŒ…ï¼Œäº¤ç»™ TCP/IP åè®®æ ˆï¼Œæœ€ç»ˆä»è™šæ‹Ÿ TAP ç½‘å¡å‘å‡ºæ¥ï¼Œæˆä¸ºæ ‡å‡†çš„ç½‘ç»œåŒ…ã€‚è¿™æ ·æ•°æ®å°±èƒ½ä»è™šæ‹Ÿæœºé‡Œé¢æœ€ç»ˆå‘é€åˆ°è™šæ‹Ÿæœºçš„å¤–é¢ã€‚</p><h2 id="1-3-è™šæ‹Ÿç½‘å¡çš„è¿æ¥"><a href="#1-3-è™šæ‹Ÿç½‘å¡çš„è¿æ¥" class="headerlink" title="1.3 è™šæ‹Ÿç½‘å¡çš„è¿æ¥"></a>1.3 è™šæ‹Ÿç½‘å¡çš„è¿æ¥</h2><h3 id="1-3-1-äº‘è®¡ç®—ä¸­çš„ç½‘ç»œé—®é¢˜"><a href="#1-3-1-äº‘è®¡ç®—ä¸­çš„ç½‘ç»œé—®é¢˜" class="headerlink" title="1.3.1 äº‘è®¡ç®—ä¸­çš„ç½‘ç»œé—®é¢˜"></a>1.3.1 äº‘è®¡ç®—ä¸­çš„ç½‘ç»œé—®é¢˜</h3><ul><li>å…±äº«ï¼š å°½ç®¡æ¯ä¸ªè™šæ‹Ÿæœºéƒ½ä¼šæœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä½†æ˜¯ç‰©ç†æœºå¯èƒ½åªæœ‰æœ‰é™çš„ç½‘å¡ã€‚è¿™ä¹ˆå¤šè™šæ‹Ÿç½‘å¡å¦‚ä½•å…±äº«åŒä¸€ä¸ªå‡ºå£ï¼Ÿ </li><li>éš”ç¦»ï¼š å®‰å…¨éš”ç¦»-åŒä¸€ä¸ªæœºå™¨ä¸Šçš„ä¸¤ä¸ªè™šæ‹Ÿæœºå±äºä¸¤ä¸ªç”¨æˆ·ï¼Œæ€ä¹ˆä¿è¯ç›¸äº’ä¹‹é—´ä¸ä¼šè¢«çªƒå¬ï¼Ÿ  æµé‡éš”ç¦»-åŒä¸€ä¸ªæœºå™¨ä¸Šçš„ä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œä¸€ä¸ªå ç”¨å¤§é‡å¸¦å®½ï¼Œå¦å¤–ä¸€ä¸ªè¿˜èƒ½ä¸Šç½‘ä¹ˆï¼Ÿ </li><li>äº’é€šï¼š åŒä¸€ä¸ªæœºå™¨ä¸¤ä¸ªè™šæ‹Ÿæœºï¼ŒåŒä¸€ç”¨æˆ·ï¼Œå¦‚ä½•é€šä¿¡ï¼Ÿ ä¸åŒç‰©ç†æœºä¸Šä¸¤ä¸ªè™šæ‹Ÿæœºï¼Œå±äºåŒä¸€ä¸ªç”¨æˆ·çš„è¯ï¼Œè¿™ä¸¤ä¸ªå¦‚ä½•ç›¸äº’é€šä¿¡ï¼Ÿ </li><li>çµæ´»ï¼š è™šæ‹Ÿæœºä¼šç»å¸¸æœ‰åˆ›å»ºï¼Œåˆ é™¤çš„æ“ä½œï¼Œæˆ–è€…æ‰€æœ‰é…ç½®çš„è¿ç§»æ¬è¿ï¼Œéœ€è¦èƒ½å¤Ÿè¿›è¡Œçµæ´»é…ç½®ã€‚</li></ul><h3 id="1-3-2-å…±äº«ä¸äº’é€šçš„é—®é¢˜"><a href="#1-3-2-å…±äº«ä¸äº’é€šçš„é—®é¢˜" class="headerlink" title="1.3.2 å…±äº«ä¸äº’é€šçš„é—®é¢˜"></a>1.3.2 å…±äº«ä¸äº’é€šçš„é—®é¢˜</h3><ul><li>ä¸€å°ç‰©ç†æœºä¸Šæœ‰å¤šä¸ªè™šæ‹Ÿæœºï¼Œå¤šä¸ªè™šæ‹Ÿç½‘å¡ï¼Œè¿™äº›è™šæ‹Ÿç½‘å¡å¦‚ä½•è¿æ¥åœ¨ä¸€èµ·ï¼Œè¿›è¡Œç›¸äº’è®¿é—®ï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¿é—®å¤–ç½‘çš„å‘¢ï¼Ÿ </li></ul><h4 id="1-3-2-1-ç½‘æ¡¥"><a href="#1-3-2-1-ç½‘æ¡¥" class="headerlink" title="1.3.2.1 ç½‘æ¡¥"></a>1.3.2.1 ç½‘æ¡¥</h4><p>ç‰©ç†æœºä¸Šåº”è¯¥æœ‰ä¸€ä¸ªè™šæ‹Ÿçš„äº¤æ¢æœºï¼Œé€šè¿‡åˆ›å»ºè™šæ‹Ÿçš„ç½‘æ¡¥  <code>brctl addbr br0</code> å°†å‡ ä¸ªè™šæ‹Ÿæœºçš„è™šæ‹Ÿç½‘å¡éƒ½è¿æ¥åˆ°è™šæ‹Ÿç½‘æ¡¥brctl addif br0 tap0ä¸Šï¼Œè¿™æ ·è®²ä¸¤ä¸ªè™šæ‹Ÿæœºé…ç½®ç›¸åŒçš„å­ç½‘ç½‘æ®µï¼Œä¸¤å°è™šæ‹Ÿæœºå°±èƒ½å¤Ÿç›¸äº’é€šä¿¡äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/f9AW6sK2tF4qNMO.jpg" alt="fig2.jpg"></p><p>è¦è®©å‡ å°è™šæ‹Ÿæœºéƒ½èƒ½è®¿é—®å¤–ç½‘ï¼Œå¯ä»¥é‡‡ç”¨æ¡¥æ¥çš„æ–¹å¼ï¼Œå½¢æˆä»¥ä¸‹çš„ç»“æ„ï¼š</p><p><img src="https://i.loli.net/2020/02/02/WA1KMhrXbvt4ke9.jpg" alt="fig3.jpg"></p><p>è¿™ä¸ªæ—¶å€™å¦‚æœä½ å»çœ‹ä½ çš„IPåœ°å€ï¼Œä¼šå‘ç°ä½ çš„è™šæ‹Ÿæœºçš„åœ°å€å’Œä½ çš„ç¬”è®°æœ¬ç”µè„‘å’Œä½ æ—è¾¹çš„äººçš„ç½‘æ®µæ˜¯ä¸€è‡´çš„ã€‚å› ä¸ºç½‘æ¡¥å°†è¿™å‡ ä¸ªéƒ½è¿æ¥èµ·æ¥äº†ã€‚åœ¨æ•°æ®ä¸­å¿ƒé‡Œé¢ï¼Œé‡‡å–çš„ä¹Ÿæ˜¯ç±»ä¼¼çš„æŠ€æœ¯ï¼Œåªä¸è¿‡éƒ½æ˜¯ Linuxï¼Œåœ¨æ¯å°æœºå™¨ä¸Šéƒ½åˆ›å»ºç½‘æ¡¥ br0ï¼Œè™šæ‹Ÿæœºçš„ç½‘å¡éƒ½è¿åˆ° br0 ä¸Šï¼Œç‰©ç†ç½‘å¡ä¹Ÿè¿åˆ°br0ä¸Šï¼Œæ‰€æœ‰çš„br0éƒ½é€šè¿‡ç‰©ç†ç½‘å¡å‡ºæ¥è¿æ¥åˆ°ç‰©ç†äº¤æ¢æœºä¸Šã€‚</p><p><img src="https://i.loli.net/2020/02/02/HyPYxt9M5Ob2gJd.jpg" alt="fig4.jpg"><br><img src="https://i.loli.net/2020/02/02/nkVRqf7bU1YtDPi.jpg" alt="fig9.jpg"></p><p>ä½ è¿˜è®°å¾—å—ï¼Ÿåœ¨ä¸€ä¸ªäºŒå±‚ç½‘ç»œé‡Œé¢ï¼Œæœ€å¤§çš„é—®é¢˜æ˜¯å¹¿æ’­ã€‚ä¸€ä¸ªæ•°æ®ä¸­å¿ƒçš„ç‰©ç†æœºå·²ç»å¾ˆå¤šäº†ï¼Œå¹¿æ’­å·²ç»éå¸¸ä¸¥é‡ï¼Œéœ€è¦é€šè¿‡ VLAN è¿›è¡Œåˆ’åˆ†ã€‚å¦‚æœä½¿ç”¨äº†è™šæ‹Ÿæœºï¼Œå‡è®¾ä¸€å°ç‰©ç†æœºé‡Œé¢åˆ›å»º 10 å°è™šæ‹Ÿæœºï¼Œå…¨éƒ¨åœ¨ä¸€ä¸ªäºŒå±‚ç½‘ç»œé‡Œé¢ï¼Œé‚£å¹¿æ’­å°±ä¼šå¾ˆä¸¥é‡ï¼Œæ‰€ä»¥é™¤éæ˜¯ä½ çš„æ¡Œé¢è™šæ‹Ÿæœºæˆ–è€…æ•°æ®ä¸­å¿ƒè§„æ¨¡éå¸¸å°ï¼Œæ‰å¯ä»¥ä½¿ç”¨è¿™ç§ç›¸å¯¹ç®€å•çš„æ–¹å¼ã€‚</p><h4 id="1-3-2-2-NAT"><a href="#1-3-2-2-NAT" class="headerlink" title="1.3.2.2 NAT"></a>1.3.2.2 NAT</h4><p><img src="https://i.loli.net/2020/02/02/rnV3TutSEp9Z72B.jpg" alt="fig5.jpg"></p><p>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œä½ ç™»å½•åˆ°è™šæ‹Ÿæœºé‡Œé¢æŸ¥çœ‹ IP åœ°å€ï¼Œä¼šå‘ç°è™šæ‹Ÿæœºçš„ç½‘ç»œæ˜¯è™šæ‹Ÿæœºçš„ï¼Œç‰©ç†æœºçš„ç½‘ç»œæ˜¯ç‰©ç†æœºçš„ï¼Œä¸¤ä¸ªä¸ç›¸åŒã€‚è™šæ‹Ÿæœºè¦æƒ³è®¿é—®ç‰©ç†æœºçš„æ—¶å€™ï¼Œéœ€è¦å°†åœ°å€ NAT æˆä¸ºç‰©ç†æœºçš„åœ°å€ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜ä¼šåœ¨ä½ çš„ç¬”è®°æœ¬ç”µè„‘é‡Œå†…ç½®ä¸€ä¸ª DHCP æœåŠ¡å™¨ï¼Œä¸ºç¬”è®°æœ¬ç”µè„‘ä¸Šçš„è™šæ‹ŸæœºåŠ¨æ€åˆ†é… IP åœ°å€ã€‚å› ä¸ºè™šæ‹Ÿæœºçš„ç½‘ç»œè‡ªæˆä½“ç³»ï¼Œéœ€è¦è¿›è¡Œ IP ç®¡ç†ã€‚ä¸ºä»€ä¹ˆæ¡¥æ¥æ–¹å¼ä¸éœ€è¦å‘¢ï¼Ÿå› ä¸ºæ¡¥æ¥å°†ç½‘ç»œæ‰“å¹³äº†ï¼Œè™šæ‹Ÿæœºçš„ IP åœ°å€åº”è¯¥ç”±ç‰©ç†ç½‘ç»œçš„ DHCP æœåŠ¡å™¨åˆ†é…ã€‚</p><p><img src="https://i.loli.net/2020/02/02/9PSTLm8MdbO6f3v.jpg" alt="fig6.jpg"></p><p>è™šæ‹Ÿæœºæ˜¯ä½ çš„ç”µè„‘ï¼Œè·¯ç”±å™¨å’Œ DHCP Server ç›¸å½“äºå®¶ç”¨è·¯ç”±å™¨æˆ–è€…å¯å®¤é•¿çš„ç”µè„‘ï¼Œç‰©ç†ç½‘å¡ç›¸å½“äºä½ ä»¬å®¿èˆçš„å¤–ç½‘ç½‘å£ï¼Œç”¨äºè®¿é—®äº’è”ç½‘ã€‚æ‰€æœ‰ç”µè„‘éƒ½é€šè¿‡å†…ç½‘ç½‘å£è¿æ¥åˆ°ä¸€ä¸ªç½‘æ¡¥ br0 ä¸Šï¼Œè™šæ‹Ÿæœºè¦æƒ³è®¿é—®äº’è”ç½‘ï¼Œéœ€è¦é€šè¿‡ br0 è¿åˆ°è·¯ç”±å™¨ä¸Šï¼Œç„¶åé€šè¿‡è·¯ç”±å™¨å°†è¯·æ±‚ NAT æˆä¸ºç‰©ç†ç½‘ç»œçš„åœ°å€ï¼Œè½¬å‘åˆ°ç‰©ç†ç½‘ç»œã€‚</p><p>å¦‚æœæ˜¯ä½ è‡ªå·±ç™»å½•åˆ°ç‰©ç†æœºä¸Šåšä¸ªç®€å•é…ç½®ï¼Œä½ å¯ä»¥ç®€åŒ–ä¸€ä¸‹ã€‚ä¾‹å¦‚å°†è™šæ‹Ÿæœºæ‰€åœ¨ç½‘ç»œçš„ç½‘å…³çš„åœ°å€ç›´æ¥é…ç½®åˆ° br0 ä¸Šï¼Œä¸ç”¨ DHCP Serverï¼Œæ‰‹åŠ¨é…ç½®æ¯å°è™šæ‹Ÿæœºçš„ IP åœ°å€ï¼Œé€šè¿‡å‘½ä»¤ iptables -t nat -A POSTROUTING -o ethX -j MASQUERADEï¼Œç›´æ¥åœ¨ç‰©ç†ç½‘å¡ ethX ä¸Šè¿›è¡Œ NATï¼Œæ‰€æœ‰ä»è¿™ä¸ªç½‘å¡å‡ºå»çš„åŒ…éƒ½ NAT æˆè¿™ä¸ªç½‘å¡çš„åœ°å€ã€‚é€šè¿‡è®¾ç½® net.ipv4.ip_forward = 1ï¼Œå¼€å¯ç‰©ç†æœºçš„è½¬å‘åŠŸèƒ½ï¼Œç›´æ¥åšè·¯ç”±å™¨ï¼Œè€Œä¸ç”¨å•ç‹¬çš„è·¯ç”±å™¨ï¼Œè¿™æ ·è™šæ‹Ÿæœºå°±èƒ½ç›´æ¥ä¸Šç½‘äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/6nB4Z2ekyQMivqP.jpg" alt="fig7.jpg"></p><h2 id="1-3-3-éš”ç¦»é—®é¢˜"><a href="#1-3-3-éš”ç¦»é—®é¢˜" class="headerlink" title="1.3.3 éš”ç¦»é—®é¢˜"></a>1.3.3 éš”ç¦»é—®é¢˜</h2><p>å¦‚æœä¸€å°æœºå™¨ä¸Šçš„ä¸¤ä¸ªè™šæ‹Ÿæœºä¸å±äºåŒä¸€ä¸ªç”¨æˆ·ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå¥½åœ¨ brctl åˆ›å»ºçš„ç½‘æ¡¥ä¹Ÿæ˜¯æ”¯æŒ VLAN åŠŸèƒ½çš„ï¼Œå¯ä»¥è®¾ç½®ä¸¤ä¸ªè™šæ‹Ÿæœºçš„ tagï¼Œè¿™æ ·åœ¨è¿™ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šï¼Œä¸¤ä¸ªè™šæ‹Ÿæœºæ˜¯ä¸äº’é€šçš„ã€‚</p><p>ä½†æ˜¯å¦‚ä½•è·¨ç‰©ç†æœºäº’é€šï¼Œå¹¶ä¸”å®ç° VLAN çš„éš”ç¦»å‘¢ï¼Ÿç”±äº brctl åˆ›å»ºçš„ç½‘æ¡¥ä¸Šé¢çš„ tag æ˜¯æ²¡åŠæ³•åœ¨ç½‘æ¡¥ä¹‹å¤–çš„èŒƒå›´å†…èµ·ä½œç”¨çš„ï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦å¯»æ‰¾å…¶ä»–çš„æ–¹å¼ã€‚</p><p>æœ‰ä¸€ä¸ªå‘½ä»¤<code>vconfig</code>ï¼Œå¯ä»¥åŸºäºç‰©ç†ç½‘å¡eth0åˆ›å»ºå¸¦VLANçš„è™šæ‹Ÿç½‘å¡ï¼Œæ‰€æœ‰ä»è¿™ä¸ªè™šæ‹Ÿç½‘å¡å‡ºå»çš„åŒ…ï¼Œéƒ½å¸¦è¿™ä¸ªVLANï¼Œå¦‚æœè¿™æ ·è·¨ç‰©ç†æœºçš„äº’é€šå’Œéš”ç¦»å°±å¯ä»¥é€šè¿‡è¿™ä¸ªç½‘å¡æ¥å®ç°äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/HtvwWh5iqmpDfze.jpg" alt="fig8.jpg"></p><p>é¦–å…ˆä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…ä¸åŒçš„ VLANï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªç”¨æˆ· VLAN 10ï¼Œä¸€ä¸ªç”¨æˆ· VLAN 20ã€‚åœ¨ä¸€å°ç‰©ç†æœºä¸Šï¼ŒåŸºäºç‰©ç†ç½‘å¡ï¼Œä¸ºæ¯ä¸ªç”¨æˆ·ç”¨ vconfig åˆ›å»ºä¸€ä¸ªå¸¦ VLAN çš„ç½‘å¡ã€‚ä¸åŒçš„ç”¨æˆ·ä½¿ç”¨ä¸åŒçš„è™šæ‹Ÿç½‘æ¡¥ï¼Œå¸¦ VLAN çš„è™šæ‹Ÿç½‘å¡ä¹Ÿè¿æ¥åˆ°è™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚</p><p>è¿™æ ·æ˜¯å¦èƒ½ä¿è¯ä¸¤ä¸ªç”¨æˆ·çš„éš”ç¦»æ€§å‘¢ï¼Ÿä¸åŒçš„ç”¨æˆ·ç”±äºç½‘æ¡¥ä¸é€šï¼Œä¸èƒ½ç›¸äº’é€šä¿¡ï¼Œä¸€æ—¦å‡ºäº†ç½‘æ¡¥ï¼Œç”±äº VLAN ä¸åŒï¼Œä¹Ÿä¸ä¼šå°†åŒ…è½¬å‘åˆ°å¦ä¸€ä¸ªç½‘æ¡¥ä¸Šã€‚å¦å¤–ï¼Œå‡ºäº†ç‰©ç†æœºï¼Œä¹Ÿæ˜¯å¸¦ç€ VLAN ID çš„ã€‚åªè¦ç‰©ç†äº¤æ¢æœºä¹Ÿæ˜¯æ”¯æŒ VLAN çš„ï¼Œåˆ°è¾¾å¦ä¸€å°ç‰©ç†æœºçš„æ—¶å€™ï¼ŒVLAN ID ä¾ç„¶åœ¨ï¼Œå®ƒåªä¼šå°†åŒ…è½¬å‘ç»™ç›¸åŒ VLAN çš„ç½‘å¡å’Œç½‘æ¡¥ï¼Œæ‰€ä»¥è·¨ç‰©ç†æœºï¼Œä¸åŒçš„ VLAN ä¹Ÿä¸ä¼šç›¸äº’é€šä¿¡ã€‚</p><p>ä½¿ç”¨ brctl åˆ›å»ºå‡ºæ¥çš„ç½‘æ¡¥åŠŸèƒ½æ˜¯ç®€å•çš„ï¼ŒåŸºäº VLAN çš„è™šæ‹Ÿç½‘å¡ä¹Ÿèƒ½å®ç°ç®€å•çš„éš”ç¦»ã€‚ä½†æ˜¯è¿™éƒ½ä¸æ˜¯å¤§è§„æ¨¡äº‘å¹³å°èƒ½å¤Ÿæ»¡è¶³çš„ï¼Œä¸€ä¸ªæ˜¯ VLAN çš„éš”ç¦»ï¼Œæ•°ç›®å¤ªå°‘ã€‚å‰é¢æˆ‘ä»¬å­¦è¿‡ï¼ŒVLAN ID åªæœ‰ 4096 ä¸ªï¼Œæ˜æ˜¾ä¸å¤Ÿç”¨ã€‚å¦å¤–ä¸€ç‚¹æ˜¯è¿™ä¸ªé…ç½®ä¸å¤Ÿçµæ´»ã€‚è°å’Œè°é€šï¼Œè°å’Œè°ä¸é€šï¼Œæµé‡çš„éš”ç¦»ä¹Ÿæ²¡æœ‰å®ç°ï¼Œè¿˜æœ‰å¤§é‡æ”¹è¿›çš„ç©ºé—´ã€‚</p><h1 id="2-äº‘ä¸­ç½‘ç»œQos"><a href="#2-äº‘ä¸­ç½‘ç»œQos" class="headerlink" title="2. äº‘ä¸­ç½‘ç»œQos"></a>2. äº‘ä¸­ç½‘ç»œQos</h1><p>æµé‡æ§åˆ¶æŠ€æœ¯ï¼Œæ¥å®ç°Quality of Service,ä»è€Œä¿éšœå¤§å¤šæ•°äººçš„æœåŠ¡è´¨é‡</p><p><img src="https://i.loli.net/2020/02/02/joSwOU5tpml7a6n.jpg" alt="fig10.jpg"></p><p>æˆ‘ä»¬èƒ½æ§åˆ¶çš„åªæœ‰å‡ºæ–¹å‘ï¼Œé€šè¿‡Shapingï¼Œå°†å‡ºçš„æµé‡æ§åˆ¶æˆè‡ªå·±æƒ³è¦çš„æ¨¡æ ·ã€‚è€Œè¿›å…¥çš„æ–¹å‘æ— æ³•æ§åˆ¶ï¼Œåªèƒ½é€šè¿‡Policyå°†åŒ…ä¸¢å¼ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(å…«)-æ•°æ®ä¸­å¿ƒ, VPN, ç§»åŠ¨ç½‘ç»œ</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%85%AB-%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83-VPN-%E7%A7%BB%E5%8A%A8%E7%BD%91%E7%BB%9C/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%85%AB-%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83-VPN-%E7%A7%BB%E5%8A%A8%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ•°æ®ä¸­å¿ƒ"><a href="#1-æ•°æ®ä¸­å¿ƒ" class="headerlink" title="1. æ•°æ®ä¸­å¿ƒ"></a>1. æ•°æ®ä¸­å¿ƒ</h1><p>æ•°æ®ä¸­å¿ƒé‡Œéƒ½æ˜¯æœåŠ¡å™¨ï¼Œæ”¾åœ¨æœºæ¶ä¸Š(Rack)ã€‚æ•°æ®ä¸­å¿ƒçš„å‡ºå£å’Œå…¥å£ä¹Ÿæ˜¯è·¯ç”±å™¨ï¼Œå¤šä¸ªè¾¹ç•Œè·¯ç”±å™¨ä½¿å…¶å¯ç”¨æ€§æ›´é«˜ã€‚</p><p>ä¸ºäº†é«˜å¯ç”¨æ€§ï¼Œæ•°æ®ä¸­å¿ƒçš„è¾¹ç•Œè·¯ç”±å™¨ä¼šè¿æ¥å¤šä¸ªè¿è¥å•†ç½‘ç»œã€‚</p><p>å¯¹äºå„ä¸ªæœºæ¶ä¸Šçš„æœåŠ¡å™¨ï¼Œéœ€è¦ç”¨äº¤æ¢æœºè¿›è¡Œè¿æ¥ï¼ŒTOR(Top of Rack)ã€‚</p><p><img src="https://i.loli.net/2020/02/02/PudyE2nb3oJ8ARr.jpg" alt="fig1.jpg"></p><p>å½“ä¸€ä¸ªæœºæ¶æ”¾ä¸ä¸‹çš„æ—¶å€™ï¼Œå°±éœ€è¦å¤šä¸ªæœºæ¶ï¼Œå¹¶ä½¿ç”¨äº¤æ¢æœºå°†å¤šä¸ªæœºæ¶è¿æ¥èµ·æ¥ã€‚è¿™äº›äº¤æ¢æœºç§°ä¸ºæ±‡èšå±‚äº¤æ¢æœºã€‚</p><p>æ•°æ®ä¸­å¿ƒçš„æœåŠ¡å™¨éœ€è¦æœ‰è‡³å°‘ä¸¤ä¸ªç½‘å¡ï¼Œä¿è¯å¯ç”¨æ€§ã€‚å¯¹ç½‘å¡è¦è¿›è¡Œç½‘å¡ç»‘å®šçš„æ“ä½œã€‚</p><p>è¿™å°±éœ€è¦æœåŠ¡å™¨å’Œäº¤æ¢æœºéƒ½æ”¯æŒä¸€ç§åè®®ï¼ŒLACP, Link Aggregation Control Protocolã€‚äº’ç›¸é€šä¿¡ï¼Œå°†å¤šä¸ªç½‘å¡èšåˆæˆä¸€ä¸ªç½‘å¡ï¼Œå¤šä¸ªç½‘çº¿èšåˆæˆä¸€ä¸ªç½‘çº¿ï¼Œåœ¨ç½‘çº¿ä¹‹é—´å¯ä»¥è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå¯ä»¥ä¸ºé«˜å¯ç”¨ä½œå‡†å¤‡ã€‚</p><p><img src="https://i.loli.net/2020/02/02/81kG3HRJU4KfYWE.jpg" alt="fig2.jpg"></p><p>äº¤æ¢æœºæœ‰ä¸€ç§æŠ€æœ¯å«ä½œå †å ï¼Œå°†å¤šä¸ªäº¤æ¢æœºå½¢æˆä¸€ä¸ªé€»è¾‘çš„äº¤æ¢æœºï¼ŒæœåŠ¡å™¨é€šè¿‡å¤šæ ¹çº¿åˆ†é…è¿åˆ°å¤šä¸ªæ¥å…¥å±‚äº¤æ¢æœºä¸Šï¼Œè€Œæ¥å…¥å±‚äº¤æ¢æœºå¤šæ ¹çº¿åˆ†åˆ«è¿æ¥åˆ°å¤šä¸ªäº¤æ¢æœºä¸Šï¼Œå¹¶ä¸”é€šè¿‡å †å çš„ç§æœ‰åè®®ï¼Œå½¢æˆåŒæ´»çš„è¿æ¥æ–¹å¼ã€‚</p><p><img src="https://i.loli.net/2020/02/02/8nGwLsV6ziAWIgP.jpg" alt="fig3.jpg"></p><p>æ±‡èšå±‚å°†å¤§é‡çš„èŠ‚ç‚¹ç›¸äº’è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€ä¸ªé›†ç¾¤ã€‚åœ¨è¿™ä¸ªé›†ç¾¤é‡Œé¢ï¼ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡äºŒå±‚äº’é€šï¼Œè¿™ä¸ªåŒºåŸŸæˆä¸ºä¸€ä¸ªPOD(Point of Delivery)ï¼Œ åˆç§°ä¸ºå¯ç”¨åŒº(Available Zone). </p><p>å½“èŠ‚ç‚¹æ•°ç›®å†å¤šçš„æ—¶å€™ï¼Œä¸€ä¸ªå¯ç”¨åŒºæ”¾ä¸ä¸‹ï¼Œéœ€è¦å°†å¤šä¸ªå¯ç”¨åŒºè¿åœ¨ä¸€èµ·ï¼Œè¿æ¥å¤šä¸ªå¯ç”¨åŒºçš„äº¤æ¢æœºç§°ä¸ºæ ¸å¿ƒäº¤æ¢æœºã€‚</p><p><img src="https://i.loli.net/2020/02/02/GcgNHiBLT9OUey1.jpg" alt="fig4.jpg"></p><p><img src="https://i.loli.net/2020/02/02/G2qbpI8MNBdTCVr.jpg" alt="fig5.jpg"></p><h1 id="2-VPN"><a href="#2-VPN" class="headerlink" title="2. VPN"></a>2. VPN</h1><p><img src="https://i.loli.net/2020/02/02/qwKnYlM3y4saCHr.jpg" alt="fig6.jpg"></p><p>VPN(Virtual Private Network)ï¼Œ è™šæ‹Ÿä¸“ç”¨ç½‘ï¼Œå°±æ˜¯åˆ©ç”¨å¼€æ”¾çš„å…¬ä¼—ç½‘ç»œï¼Œå»ºç«‹ä¸“ç”¨æ•°æ®ä¼ è¾“é€šé“ï¼Œå°†è¿œç¨‹çš„åˆ†æ”¯æœºæ„ã€ç§»åŠ¨åŠå…¬äººå‘˜è¿æ¥èµ·æ¥ã€‚</p><h2 id="2-1-VPNæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#2-1-VPNæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="2.1 VPNæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>2.1 VPNæ˜¯å¦‚ä½•å·¥ä½œçš„</h2><p>VPNé€šè¿‡éš§é“æŠ€æœ¯åœ¨å…¬ä¼—ç½‘ç»œä¸Šä»¿çœŸä¸€æ¡ç‚¹åˆ°ç‚¹çš„ä¸“çº¿ï¼Œæ˜¯é€šè¿‡ä¸€ç§åè®®æ¥ä¼ è¾“å¦å¤–ä¸€ç§åè®®çš„æŠ€æœ¯ï¼šè¿™é‡Œé¢æ¶‰åŠä¸‰ç§åè®®ï¼šä¹˜å®¢åè®®ã€éš§é“åè®®ã€æ‰¿è½½åè®®ã€‚</p><p>ä»¥IPsecåè®®ä¸ºä¾‹è¯´æ˜</p><p><img src="https://i.loli.net/2020/02/02/3rCDzlsnipXjH8A.jpg" alt="fig7.jpg"></p><p>IPsec VPN, æ˜¯åŸºäºIPåè®®çš„å®‰å…¨éš§é“åè®®ï¼Œä¸ºäº†ä¿è¯åœ¨å…¬ç½‘ä¸Šä¿¡æ¯çš„å®‰å…¨ï¼Œå› è€Œé‡‡å–äº†ä¸€å®šçš„æœºåˆ¶ä¿è¯å®‰å…¨æ€§ã€‚</p><h2 id="2-2-VPN-é‡‡å–çš„ä¿è¯å®‰å…¨çš„æœºåˆ¶"><a href="#2-2-VPN-é‡‡å–çš„ä¿è¯å®‰å…¨çš„æœºåˆ¶" class="headerlink" title="2.2 VPN é‡‡å–çš„ä¿è¯å®‰å…¨çš„æœºåˆ¶"></a>2.2 VPN é‡‡å–çš„ä¿è¯å®‰å…¨çš„æœºåˆ¶</h2><ol><li>ç§å¯†æ€§</li></ol><p>é€šè¿‡åŠ å¯†æŠŠæ•°æ®ä»æ˜æ–‡ç¼–ç¨‹æ— æ³•è¯»æ‡‚çš„å¯†æ–‡ï¼Œä»è€Œç¡®ä¿æ•°æ®çš„ç§å¯†æ€§ã€‚é‡‡ç”¨å¯¹ç§°åŠ å¯†ï¼Œ å› ä¸ºVPNä¸€æ—¦å»ºç«‹ï¼Œæ˜¯éœ€è¦ä¼ è¾“å¤§é‡æ•°æ®çš„ã€‚</p><p>å­˜åœ¨åŠ å¯†å¯†é’¥å¦‚ä½•ä¼ è¾“çš„é—®é¢˜ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°å› ç‰¹ç½‘å¯†é’¥äº¤æ¢åè®®(IKE, Internet Key Exchange)ã€‚</p><ol start="2"><li>å®Œæ•´æ€§</li></ol><p>æ•°æ®æ²¡æœ‰è¢«éæ³•ç¯¡æ”¹ï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œhashè¿ç®—ï¼Œäº§ç”Ÿç±»ä¼¼äºæŒ‡çº¹çš„æ•°æ®æ‘˜è¦ï¼Œä»¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§</p><ol start="3"><li>çœŸå®æ€§</li></ol><p>æ•°æ®ç¡®å®æ˜¯ç”±ç‰¹å®šçš„å¯¹ç«¯å‘å‡ºï¼Œé€šè¿‡èº«ä»½è®¤è¯å¯ä»¥ä¿è¯æ•°æ®çš„çœŸå®æ€§ã€‚</p><ol start="4"><li>ä¿è¯å¯¹æ–¹çœŸå®çš„æ–¹å¼</li></ol><ul><li>é¢„å…±äº«ç§˜é’¥</li><li>æ•°å­—ç­¾åéªŒè¯</li></ul><h2 id="2-3-IPsec-VPNåè®®"><a href="#2-3-IPsec-VPNåè®®" class="headerlink" title="2.3 IPsec VPNåè®®"></a>2.3 IPsec VPNåè®®</h2><p><img src="https://i.loli.net/2020/02/02/PXUnhNDlZmbHi6L.jpg" alt="fig8.jpg"></p><p>åœ¨è¿™ä¸ªåè®®æ—é‡Œé¢ï¼Œæœ‰ä¸¤ç§åè®®ï¼ŒåŒºåˆ«åœ¨äºå°è£…ç½‘ç»œ åŒ…çš„æ ¼å¼ä¸ä¸€æ ·ã€‚</p><ul><li>AH(Authentication Header)ï¼Œåªèƒ½è¿›è¡Œæ•°æ®æ‘˜è¦ï¼Œä¸èƒ½å®ç°æ•°æ®åŠ å¯†</li><li>ESP(Encapsulating Security Payload), èƒ½å¤Ÿè¿›è¡Œæ•°æ®åŠ å¯†å’Œæ•°æ®æ‘˜è¦</li></ul><p>åœ¨è¿™ä¸ªåè®®æ—é‡Œï¼Œæœ‰åŠ å¯†ç®—æ³•å’Œæ‘˜è¦ç®—æ³•ã€‚åŒ…å«äº†ä¸¤å¤§ç»„ä»¶ï¼Œä¸€ä¸ªç”¨äºVPNçš„åŒæ–¹è¦è¿›è¡Œå¯¹ç§°å¯†é’¥äº¤æ¢çš„IKEç»„ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯VPNçš„åŒæ–¹è¦å¯¹è¿æ¥è¿›è¡Œç»´æŠ¤çš„SA(Security Association) ç»„ä»¶ã€‚</p><h2 id="2-4-IPsec-VPN-å»ºç«‹è¿‡ç¨‹"><a href="#2-4-IPsec-VPN-å»ºç«‹è¿‡ç¨‹" class="headerlink" title="2.4 IPsec VPN å»ºç«‹è¿‡ç¨‹"></a>2.4 IPsec VPN å»ºç«‹è¿‡ç¨‹</h2><h3 id="2-4-1-å»ºç«‹IKEè‡ªå·±çš„SA-Security-Association"><a href="#2-4-1-å»ºç«‹IKEè‡ªå·±çš„SA-Security-Association" class="headerlink" title="2.4.1 å»ºç«‹IKEè‡ªå·±çš„SA(Security Association)"></a>2.4.1 å»ºç«‹IKEè‡ªå·±çš„SA(Security Association)</h3><p>ç”¨æ¥ç»´æŠ¤ä¸€ä¸ªé€šè¿‡èº«ä»½è®¤è¯å’Œå®‰å…¨ä¿æŠ¤çš„é€šé“ï¼Œä¸ºç¬¬äºŒä¸ªé˜¶æ®µæä¾›æœåŠ¡ã€‚é€šè¿‡DH(Diffie-Hellman)ç®—æ³•è®¡ç®—å‡ºä¸€ä¸ªå¯¹ç§°å¯†é’¥Kã€‚</p><p>DHç®—æ³•å¾ˆå·§å¦™ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çº¦å®šä¸¤ä¸ªå…¬å¼€çš„è´¨æ•°på’Œqï¼Œç„¶åå®¢æˆ·ç«¯éšæœºäº§ç”Ÿä¸€ä¸ªæ•°aä½œä¸ºè‡ªå·±çš„ç§é’¥ï¼ŒæœåŠ¡ç«¯éšæœºäº§ç”Ÿä¸€ä¸ªbä½œä¸ºè‡ªå·±çš„ç§é’¥ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ ¹æ®p q aè®¡ç®—å‡ºå…¬é’¥Aï¼ŒæœåŠ¡ç«¯æ ¹æ®pï¼Œqï¼Œbè®¡ç®—å‡ºå…¬é’¥Bï¼Œç„¶ååŒæ–¹äº¤æ¢å…¬é’¥Aå’ŒBã€‚</p><p>è‡³æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡eç«¯å¯ä»¥æ ¹æ®å·²æœ‰ä¿¡æ¯ï¼Œå„è‡ªç‹¬ç«‹ç®—å‡ºç›¸åŒçš„ç»“æœKï¼Œå°±æ˜¯å¯¹ç§°å¯†é’¥ã€‚ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œå¯¹ç§°å¯†é’¥ä»æ¥æ²¡æœ‰åœ¨é€šé“ä¸Šä¼ è¾“è¿‡ï¼Œåªä¼ è¾“äº†ç”Ÿæˆå¯†é’¥çš„ææ–™ã€‚æˆªè·çš„äººæ ¹æœ¬æ— æ³•ç®—å‡ºåˆ°åº•æ˜¯ç”Ÿæˆäº†ä»€ä¹ˆæ•°å­—ã€‚</p><p><img src="https://i.loli.net/2020/02/02/mowAje5ZFLitCfJ.jpg" alt="fig9.jpg"></p><h3 id="2-4-2-å»ºç«‹IPsec-SA"><a href="#2-4-2-å»ºç«‹IPsec-SA" class="headerlink" title="2.4.2 å»ºç«‹IPsec SA"></a>2.4.2 å»ºç«‹IPsec SA</h3><p>åœ¨è¿™ä¸ªSAé‡Œé¢ï¼ŒåŒæ–¹ä¼šç”Ÿæˆä¸€ä¸ªéšæœºçš„å¯¹ç§°å¯†é’¥Mï¼Œç”±KåŠ å¯†ä¼ ç»™å¯¹æ–¹ï¼Œç„¶åä½¿ç”¨Mè¿›è¡ŒåŒæ–¹æ¥ä¸‹æ¥é€šä¿¡çš„æ•°æ®ã€‚å¯¹ç§°å¯†é’¥Mæ˜¯æœ‰è¿‡æœŸæ—¶é—´çš„ï¼Œä¼šè¿‡ä¸€æ®µæ—¶é—´ï¼Œé‡æ–°ç”Ÿæˆä¸€æ¬¡ï¼Œä»è€Œé˜²æ­¢è¢«ç ´è§£ã€‚</p><p>IPsec SA é‡Œé¢æœ‰ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>SPI(Security Parameter Index),ç”¨äºæ ‡è¯†ä¸åŒçš„è¿æ¥</li><li>åŒæ–¹å•†é‡å¥½çš„åŠ å¯†ç®—æ³•ï¼Œå“ˆå¸Œç®—æ³•å’Œå°è£…ç®—æ³•</li><li>ç”Ÿå­˜å‘¨æœŸï¼Œè¶…è¿‡è¿™ä¸ªå‘¨æœŸï¼Œå°±è¦é‡æ–°ç”Ÿæˆä¸€ä¸ªIPsec SAï¼Œé‡æ–°ç”Ÿæˆå¯¹ç§°å¯†é’¥</li></ul><p><img src="https://i.loli.net/2020/02/02/RfP8cp4zw9KT27G.jpg" alt="fig10.jpg"></p><p>å½“IPsecå»ºç«‹å¥½ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹æ‰“åŒ…å°è£…ä¼ è¾“äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/NlPSm6hzrvQxAcj.jpg" alt="fig11.jpg"></p><p>å·¦é¢æ˜¯åŸå§‹çš„ IP åŒ…ï¼Œåœ¨ IP å¤´é‡Œé¢ï¼Œä¼šæŒ‡å®šä¸Šä¸€å±‚çš„åè®®ä¸º TCPã€‚ESP è¦å¯¹ IP åŒ…è¿›è¡Œå°è£…ï¼Œå› è€Œ IP å¤´é‡Œé¢çš„ä¸Šä¸€å±‚åè®®ä¸º ESPã€‚åœ¨ ESP çš„æ­£æ–‡é‡Œé¢ï¼ŒESP çš„å¤´éƒ¨æœ‰åŒæ–¹å•†è®¨å¥½çš„ SPIï¼Œä»¥åŠè¿™æ¬¡ä¼ è¾“çš„åºåˆ—å·ã€‚</p><p>æ¥ä¸‹æ¥å…¨éƒ¨æ˜¯åŠ å¯†çš„å†…å®¹ã€‚å¯ä»¥é€šè¿‡å¯¹ç§°å¯†é’¥è¿›è¡Œè§£å¯†ï¼Œè§£å¯†ååœ¨æ­£æ–‡çš„æœ€åï¼ŒæŒ‡æ˜äº†é‡Œé¢çš„åè®®æ˜¯ä»€ä¹ˆã€‚å¦‚æœæ˜¯ IPï¼Œåˆ™éœ€è¦å…ˆè§£æ IP å¤´ï¼Œç„¶åè§£æ TCP å¤´ï¼Œè¿™æ˜¯ä»éš§é“å‡ºæ¥åè§£å°è£…çš„è¿‡ç¨‹ã€‚</p><p>æœ‰äº† IPsec VPN ä¹‹åï¼Œå®¢æˆ·ç«¯å‘é€çš„æ˜æ–‡çš„ IP åŒ…ï¼Œéƒ½ä¼šè¢«åŠ ä¸Š ESP å¤´å’Œ IP å¤´ï¼Œåœ¨å…¬ç½‘ä¸Šä¼ è¾“ï¼Œç”±äºåŠ å¯†ï¼Œå¯ä»¥ä¿è¯ä¸è¢«çªƒå–ï¼Œåˆ°äº†å¯¹ç«¯åï¼Œå»æ‰ ESP çš„å¤´ï¼Œè¿›è¡Œè§£å¯†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/muPYyMVGEKWLFz6.jpg" alt="fig12.jpg"></p><p>è¿™ç§ç‚¹å¯¹ç‚¹çš„åŸºäº IP çš„ VPNï¼Œèƒ½æ»¡è¶³äº’é€šçš„è¦æ±‚ï¼Œä½†æ˜¯é€Ÿåº¦å¾€å¾€æ¯”è¾ƒæ…¢ï¼Œè¿™æ˜¯ç”±åº•å±‚ IP åè®®çš„ç‰¹æ€§å†³å®šçš„ã€‚IP ä¸æ˜¯é¢å‘è¿æ¥çš„ï¼Œæ˜¯å°½åŠ›è€Œä¸ºçš„åè®®ï¼Œæ¯ä¸ª IP åŒ…è‡ªç”±é€‰æ‹©è·¯å¾„ï¼Œåˆ°æ¯ä¸€ä¸ªè·¯ç”±å™¨ï¼Œéƒ½è‡ªå·±å»æ‰¾ä¸‹ä¸€è·³ï¼Œä¸¢äº†å°±ä¸¢äº†ï¼Œæ˜¯é ä¸Šä¸€å±‚ TCP çš„é‡å‘æ¥ä¿è¯å¯é æ€§ã€‚</p><p><img src="https://i.loli.net/2020/02/02/TSRuA7tq8eLphHZ.jpg" alt="fig13.jpg"></p><p>å› ä¸º IP ç½‘ç»œä»è®¾è®¡çš„æ—¶å€™ï¼Œå°±è®¤ä¸ºæ˜¯ä¸å¯é çš„ï¼Œæ‰€ä»¥å³ä½¿åŒä¸€ä¸ªè¿æ¥ï¼Œä¹Ÿå¯èƒ½é€‰æ‹©ä¸åŒçš„é“è·¯ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸€æ¡é“è·¯å´©æºƒçš„æ—¶å€™ï¼Œæ€»æœ‰å…¶ä»–çš„è·¯å¯ä»¥èµ°ã€‚å½“ç„¶ï¼Œå¸¦æ¥çš„ä»£ä»·å°±æ˜¯ï¼Œä¸æ–­çš„è·¯ç”±æŸ¥æ‰¾ï¼Œæ•ˆç‡æ¯”è¾ƒå·®ã€‚</p><p>å’Œ IP å¯¹åº”çš„å¦ä¸€ç§æŠ€æœ¯ç§°ä¸º ATMã€‚è¿™ç§åè®®å’Œ IP åè®®çš„ä¸åŒåœ¨äºï¼Œå®ƒæ˜¯é¢å‘è¿æ¥çš„ã€‚ä½ å¯ä»¥è¯´ TCP ä¹Ÿæ˜¯é¢å‘è¿æ¥çš„å•Šã€‚è¿™ä¸¤ä¸ªä¸åŒï¼ŒATM å’Œ IP æ˜¯ä¸€ä¸ªå±‚æ¬¡çš„ï¼Œå’Œ TCP ä¸æ˜¯ä¸€ä¸ªå±‚æ¬¡çš„ã€‚</p><p>å¦å¤–ï¼ŒTCP æ‰€è°“çš„é¢å‘è¿æ¥ï¼Œæ˜¯ä¸åœåœ°é‡è¯•æ¥ä¿è¯æˆåŠŸï¼Œå…¶å®ä¸‹å±‚çš„ IP è¿˜æ˜¯ä¸é¢å‘è¿æ¥çš„ï¼Œä¸¢äº†å°±ä¸¢äº†ã€‚ATM æ˜¯ä¼ è¾“ä¹‹å‰å…ˆå»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œå½¢æˆä¸€ä¸ªè™šæ‹Ÿçš„é€šè·¯ï¼Œä¸€æ—¦è¿æ¥å»ºç«‹äº†ï¼Œæ‰€æœ‰çš„åŒ…éƒ½æŒ‰ç…§ç›¸åŒçš„è·¯å¾„èµ°ï¼Œä¸ä¼šåˆ†å¤´è¡Œäº‹ã€‚</p><p><img src="https://i.loli.net/2020/02/02/u36xtoN72KkBGQZ.jpg" alt="fig14.jpg"></p><p>ATMçš„å¥½å¤„æ˜¯ä¸éœ€è¦æ¯æ¬¡éƒ½æŸ¥è·¯ç”±è¡¨äº†ï¼Œè™šæ‹Ÿè·¯å¾„å·²ç»å»ºç«‹ï¼Œæ‰“ä¸Šäº†æ ‡ç­¾ï¼Œåç»­çš„åŒ…è·Ÿç€èµ°å°±å¯ä»¥äº†ï¼›ä½†æ˜¯ä¸€æ—¦è™šæ‹Ÿè·¯å¾„ä¸Šçš„æŸä¸ªè·¯ç”±å™¨åäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿æ¥å°±æ–­äº†.</p><h2 id="2-4-3-å¤šåè®®æ ‡ç­¾äº¤æ¢-MPLS-Multi-Protocol-Label-Switching"><a href="#2-4-3-å¤šåè®®æ ‡ç­¾äº¤æ¢-MPLS-Multi-Protocol-Label-Switching" class="headerlink" title="2.4.3 å¤šåè®®æ ‡ç­¾äº¤æ¢(MPLS, Multi-Protocol Label Switching)"></a>2.4.3 å¤šåè®®æ ‡ç­¾äº¤æ¢(MPLS, Multi-Protocol Label Switching)</h2><p>è¿™ç§åè®®å¯ä»¥ç»“åˆIPå’ŒATMåè®®çš„ä¼˜ç‚¹ï¼Œå…¶ç»“æ„æ˜¯åœ¨åŸå§‹çš„IPå¤´ä¹‹å¤–ï¼Œå¤šäº†MPLSçš„å¤´ï¼Œé‡Œé¢å¯ä»¥æ‰“æ ‡ç­¾ã€‚</p><p><img src="https://i.loli.net/2020/02/02/WxC8o6wYshu1bSJ.jpg" alt="fig15.jpg"></p><p>åœ¨ MPLS å¤´é‡Œé¢ï¼Œé¦–å…ˆæ˜¯æ ‡ç­¾å€¼å  20 ä½ï¼Œæ¥ç€æ˜¯ 3 ä½å®éªŒä½ï¼Œå†æ¥ä¸‹æ¥æ˜¯ 1 ä½æ ˆåº•æ ‡å¿—ä½ï¼Œè¡¨ç¤ºå½“å‰æ ‡ç­¾æ˜¯å¦ä½äºæ ˆåº•äº†ã€‚è¿™æ ·å°±å…è®¸å¤šä¸ªæ ‡ç­¾è¢«ç¼–ç åˆ°åŒä¸€ä¸ªæ•°æ®åŒ…ä¸­ï¼Œå½¢æˆæ ‡ç­¾æ ˆã€‚æœ€åæ˜¯ 8 ä½ TTL å­˜æ´»æ—¶é—´å­—æ®µï¼Œå¦‚æœæ ‡ç­¾æ•°æ®åŒ…çš„å‡ºå‘ TTL å€¼ä¸º 0ï¼Œé‚£ä¹ˆè¯¥æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­çš„ç”Ÿå‘½æœŸè¢«è®¤ä¸ºå·²ç»è¿‡æœŸäº†ã€‚</p><p>æœ‰äº†æ ‡ç­¾ï¼Œè¿˜éœ€è¦è®¾å¤‡è®¤è¿™ä¸ªæ ‡ç­¾ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ ¹æ®è¿™ä¸ªæ ‡ç­¾è½¬å‘ï¼Œè¿™ç§èƒ½å¤Ÿè½¬å‘æ ‡ç­¾çš„è·¯ç”±å™¨ç§°ä¸ºæ ‡ç­¾äº¤æ¢è·¯ç”±å™¨(LSR, Label Switching Router).</p><p>è¿™ç§è·¯ç”±å™¨ä¼šæœ‰ä¸¤ä¸ªè¡¨æ ¼ï¼Œä¸€ä¸ªæ˜¯ä¼ ç»Ÿçš„FIBï¼Œè·¯ç”±è¡¨ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯LFIBï¼Œæ ‡ç­¾è½¬å‘è¡¨ã€‚æœ‰ç€è¿™ä¸¤ä¸ªè¡¨ï¼Œå°±æ—¢å¯ä»¥è¿›è¡Œæ™®é€šçš„è·¯ç”±è½¬å‘ï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒåŸºäºæ ‡ç­¾çš„è½¬å‘ã€‚</p><p><img src="https://i.loli.net/2020/02/02/p2WM8XwjtuLRxNn.jpg" alt="fig16.jpg"></p><p>æœ‰äº†æ ‡ç­¾è½¬å‘è¡¨ï¼Œè½¬å‘çš„è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½è¿›è¡Œæ™®é€šè·¯ç”±çš„æŸ¥æ‰¾äº†ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬åŒºåˆ† MPLS åŒºåŸŸå’Œé MPLS åŒºåŸŸã€‚åœ¨ MPLS åŒºåŸŸä¸­é—´ï¼Œä½¿ç”¨æ ‡ç­¾è¿›è¡Œè½¬å‘ï¼Œé MPLS åŒºåŸŸï¼Œä½¿ç”¨æ™®é€šè·¯ç”±è½¬å‘ï¼Œåœ¨è¾¹ç¼˜èŠ‚ç‚¹ä¸Šï¼Œéœ€è¦æœ‰èƒ½åŠ›å°†å¯¹äºæ™®é€šè·¯ç”±çš„è½¬å‘ï¼Œå˜æˆå¯¹äºæ ‡ç­¾çš„è½¬å‘ã€‚</p><p>ä¾‹å¦‚å›¾ä¸­è¦è®¿é—® 114.1.1.1ï¼Œåœ¨è¾¹ç•Œä¸ŠæŸ¥æ‰¾æ™®é€šè·¯ç”±ï¼Œå‘ç°é©¬ä¸Šè¦è¿›å…¥ MPLS åŒºåŸŸäº†ï¼Œè¿›å»äº†å¯¹åº”æ ‡ç­¾ 1ï¼Œäºæ˜¯åœ¨ IP å¤´å¤–é¢åŠ ä¸€ä¸ªæ ‡ç­¾ 1ï¼Œåœ¨åŒºåŸŸé‡Œé¢ï¼Œæ ‡ç­¾ 1 è¦å˜æˆæ ‡ç­¾ 3ï¼Œæ ‡ç­¾ 3 åˆ°è¾¾å‡ºå£è¾¹ç¼˜ï¼Œå°†æ ‡ç­¾å»æ‰ï¼ŒæŒ‰ç…§è·¯ç”±å‘å‡ºã€‚</p><p>è¿™æ ·ä¸€ä¸ªé€šè¿‡æ ‡ç­¾è½¬åŒ–è€Œå»ºç«‹çš„è·¯å¾„ç§°ä¸ºLSPï¼Œæ ‡ç­¾äº¤æ¢è·¯å¾„ã€‚åœ¨ä¸€æ¡LSPä¸Šï¼Œæ²¿æ•°æ®åŒ…ä¼ é€çš„æ–¹å‘ï¼Œç›¸é‚»çš„LSRåˆ†åˆ«å«åšä¸Šæ¸¸LSR(upstream LSR), å’Œä¸‹æ¸¸LSR(downstream LSR).</p><p>MPLSæœ‰ä¸ªåŠ¨æ€ç”Ÿæˆæ ‡ç­¾çš„åè®®, LDP(Label Distribution Protocol)ã€‚ å…¶å® LDP ä¸ IP å¸®æ´¾ä¸­çš„è·¯ç”±åè®®ååˆ†ç›¸åƒï¼Œé€šè¿‡ LSR çš„äº¤äº’ï¼Œäº’ç›¸å‘ŠçŸ¥å»å“ªé‡Œåº”è¯¥æ‰“å“ªä¸ªæ ‡ç­¾ï¼Œç§°ä¸ºæ ‡ç­¾åˆ†å‘ï¼Œå¾€å¾€æ˜¯ä»ä¸‹æ¸¸å¼€å§‹çš„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/dVlJvoAQfKLSwsb.jpg" alt="fig17.jpg"></p><p>å¦‚æœæœ‰ä¸€ä¸ªè¾¹ç¼˜èŠ‚ç‚¹å‘ç°è‡ªå·±çš„è·¯ç”±è¡¨ä¸­å‡ºç°äº†æ–°çš„ç›®çš„åœ°å€ï¼Œå®ƒå°±è¦ç»™åˆ«äººè¯´ï¼Œæˆ‘èƒ½åˆ°è¾¾ä¸€æ¡æ–°çš„è·¯å¾„äº†ã€‚</p><p>å¦‚æœæ­¤è¾¹ç¼˜èŠ‚ç‚¹å­˜åœ¨ä¸Šæ¸¸ LSRï¼Œå¹¶ä¸”å°šæœ‰å¯ä¾›åˆ†é…çš„æ ‡ç­¾ï¼Œåˆ™è¯¥èŠ‚ç‚¹ä¸ºæ–°çš„è·¯å¾„åˆ†é…æ ‡ç­¾ï¼Œå¹¶å‘ä¸Šæ¸¸å‘å‡ºæ ‡ç­¾æ˜ å°„æ¶ˆæ¯ï¼Œå…¶ä¸­åŒ…å«åˆ†é…çš„æ ‡ç­¾ç­‰ä¿¡æ¯ã€‚</p><p>æ”¶åˆ°æ ‡ç­¾æ˜ å°„æ¶ˆæ¯çš„ LSR è®°å½•ç›¸åº”çš„æ ‡ç­¾æ˜ å°„ä¿¡æ¯ï¼Œåœ¨å…¶æ ‡ç­¾è½¬å‘è¡¨ä¸­å¢åŠ ç›¸åº”çš„æ¡ç›®ã€‚æ­¤ LSR ä¸ºå®ƒçš„ä¸Šæ¸¸ LSR åˆ†é…æ ‡ç­¾ï¼Œå¹¶ç»§ç»­å‘ä¸Šæ¸¸ LSR å‘é€æ ‡ç­¾æ˜ å°„æ¶ˆæ¯ã€‚</p><p>å½“å…¥å£ LSR æ”¶åˆ°æ ‡ç­¾æ˜ å°„æ¶ˆæ¯æ—¶ï¼Œåœ¨æ ‡ç­¾è½¬å‘è¡¨ä¸­å¢åŠ ç›¸åº”çš„æ¡ç›®ã€‚è¿™æ—¶ï¼Œå°±å®Œæˆäº† LSP çš„å»ºç«‹ã€‚æœ‰äº†æ ‡ç­¾ï¼Œè½¬å‘è½»æ¾å¤šäº†ï¼Œä½†æ˜¯è¿™ä¸ªå’Œ VPN ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæˆ‘ä»¬ VPN é€šé“é‡Œé¢åŒ…çš„è½¬å‘ï¼Œéƒ½æ˜¯é€šè¿‡æ ‡ç­¾çš„æ–¹å¼è¿›è¡Œï¼Œæ•ˆç‡å°±ä¼šé«˜å¾ˆå¤šã€‚æ‰€ä»¥è¦æƒ³ä¸ªåŠæ³•æŠŠ MPLS åº”ç”¨äº VPNã€‚</p><p><img src="https://i.loli.net/2020/02/02/9F5D3xSad7PzhYw.jpg" alt="fig18.jpg"></p><p>åœ¨MPLS VPNä¸­ï¼Œç½‘ç»œä¸­çš„è·¯ç”±å™¨åˆ†æˆä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>PE (Provider Edge): è¿è¥å•†ç½‘ç»œä¸å®¢æˆ·ç½‘ç»œç›¸è¿çš„è¾¹ç¼˜ç½‘ç»œè®¾å¤‡</li><li>CE (Customer Edge): å®¢æˆ·ç½‘ç»œä¸PEç›¸è¿æ¥çš„è¾¹ç¼˜è®¾å¤‡</li><li>P (Provider): æŒ‡è¿è¥å•†ç½‘ç»œä¸­é™¤äº†PEä»¥å¤–çš„å…¶ä»–è¿è¥å•†ç½‘ç»œè®¾å¤‡</li></ul><p>ä¸ºä»€ä¹ˆè¦è¿™æ ·åˆ†å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å‘ç°ï¼Œåœ¨è¿è¥å•†ç½‘ç»œé‡Œé¢ï¼Œä¹Ÿå³ P Router ä¹‹é—´ï¼Œä½¿ç”¨æ ‡ç­¾æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºéƒ½åœ¨è¿è¥å•†çš„ç®¡æ§ä¹‹ä¸‹ï¼Œå¯¹äºç½‘æ®µï¼Œè·¯ç”±éƒ½å¯ä»¥è‡ªå·±æ§åˆ¶ã€‚ä½†æ˜¯ä¸€æ—¦å®¢æˆ·è¦æ¥å…¥è¿™ä¸ªç½‘ç»œï¼Œå°±å¤æ‚å¾—å¤šã€‚</p><p>é¦–å…ˆæ˜¯å®¢æˆ·åœ°å€é‡å¤çš„é—®é¢˜ã€‚å®¢æˆ·æ‰€ä½¿ç”¨çš„å¤§å¤šæ•°éƒ½æ˜¯ç§ç½‘çš„åœ°å€ (192.168.X.X;10.X.X.X;172.X.X.X)ï¼Œè€Œä¸”å¾ˆå¤šæƒ…å†µä¸‹éƒ½ä¼šä¸å…¶å®ƒçš„å®¢æˆ·é‡å¤ã€‚</p><p>æ¯”å¦‚ï¼Œæœºæ„ A å’Œæœºæ„ B éƒ½ä½¿ç”¨äº† 192.168.101.0/24 ç½‘æ®µçš„åœ°å€ï¼Œè¿™å°±å‘ç”Ÿäº†åœ°å€ç©ºé—´é‡å ï¼ˆOverlapping Address Spacesï¼‰ã€‚</p><p>é¦–å…ˆå›°æƒ‘çš„æ˜¯ BGP åè®®ï¼Œæ—¢ç„¶ VPN å°†ä¸¤ä¸ªæ•°æ®ä¸­å¿ƒè¿èµ·æ¥ï¼Œåº”è¯¥çœ‹èµ·æ¥åƒä¸€ä¸ªæ•°æ®ä¸­å¿ƒä¸€æ ·ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ°è¾¾å¦ä¸€ç«¯éœ€è¦é€šè¿‡ BGP å°†è·¯ç”±å¹¿æ’­è¿‡å»ï¼Œä¼ ç»Ÿ BGP æ— æ³•æ­£ç¡®å¤„ç†åœ°å€ç©ºé—´é‡å çš„ VPN çš„è·¯ç”±ã€‚</p><p>å‡è®¾æœºæ„ A å’Œæœºæ„ B éƒ½ä½¿ç”¨äº† 192.168.101.0/24 ç½‘æ®µçš„åœ°å€ï¼Œå¹¶å„è‡ªå‘å¸ƒäº†ä¸€æ¡å»å¾€æ­¤ç½‘æ®µçš„è·¯ç”±ï¼ŒBGP å°†åªä¼šé€‰æ‹©å…¶ä¸­ä¸€æ¡è·¯ç”±ï¼Œä»è€Œå¯¼è‡´å»å¾€å¦ä¸€ä¸ª VPN çš„è·¯ç”±ä¸¢å¤±ã€‚</p><p>æ‰€ä»¥ PE è·¯ç”±å™¨ä¹‹é—´ä½¿ç”¨ç‰¹æ®Šçš„ MP-BGP æ¥å‘å¸ƒ VPN è·¯ç”±ï¼Œåœ¨ç›¸äº’æ²Ÿé€šçš„æ¶ˆæ¯ä¸­ï¼Œåœ¨ä¸€èˆ¬ 32 ä½ IPv4 çš„åœ°å€ä¹‹å‰åŠ ä¸Šä¸€ä¸ªå®¢æˆ·æ ‡ç¤ºçš„åŒºåˆ†ç¬¦ç”¨äºå®¢æˆ·åœ°å€çš„åŒºåˆ†ï¼Œè¿™ç§ç§°ä¸º VPN-IPv4 åœ°å€æ—ï¼Œè¿™æ · PE è·¯ç”±å™¨ä¼šæ”¶åˆ°å¦‚ä¸‹çš„æ¶ˆæ¯ï¼Œæœºæ„ A çš„ 192.168.101.0/24 åº”è¯¥å¾€è¿™é¢èµ°ï¼Œæœºæ„ B çš„ 192.168.101.0/24 åˆ™åº”è¯¥å»å¦å¤–ä¸€ä¸ªæ–¹å‘ã€‚</p><p>å¦å¤–ä¸€ä¸ªå›°æƒ‘æ˜¯è·¯ç”±è¡¨ï¼Œå½“ä¸¤ä¸ªå®¢æˆ·çš„IPåŒ…åˆ°è¾¾PEçš„æ—¶å€™ï¼ŒPEå°±å›°æƒ‘äº†ï¼Œå› ä¸ºç½‘æ®µæ˜¯é‡å¤çš„ã€‚å¦‚ä½•åŒºåˆ†å“ªäº›è·¯ç”±æ˜¯å±äºå“ªäº›å®¢æˆ· VPN å†…çš„ï¼Ÿå¦‚ä½•ä¿è¯ VPN ä¸šåŠ¡è·¯ç”±ä¸æ™®é€šè·¯ç”±ä¸ç›¸äº’å¹²æ‰°ï¼Ÿ</p><p>åœ¨ PE ä¸Šï¼Œå¯ä»¥é€šè¿‡ VRFï¼ˆVPN Routing&amp;Forwarding Instanceï¼‰å»ºç«‹æ¯ä¸ªå®¢æˆ·ä¸€ä¸ªè·¯ç”±è¡¨ï¼Œä¸å…¶å®ƒ VPN å®¢æˆ·è·¯ç”±å’Œæ™®é€šè·¯ç”±ç›¸äº’åŒºåˆ†ã€‚å¯ä»¥ç†è§£ä¸ºä¸“å±äºå®¢æˆ·çš„å°è·¯ç”±å™¨ã€‚</p><p>è¿œç«¯ PE é€šè¿‡ MP-BGP åè®®æŠŠä¸šåŠ¡è·¯ç”±æ”¾åˆ°è¿‘ç«¯ PEï¼Œè¿‘ç«¯ PE æ ¹æ®ä¸åŒçš„å®¢æˆ·é€‰æ‹©å‡ºç›¸å…³å®¢æˆ·çš„ä¸šåŠ¡è·¯ç”±æ”¾åˆ°ç›¸åº”çš„ VRF è·¯ç”±è¡¨ä¸­ã€‚</p><p>VPNæŠ¥æ–‡è½¬å‘é‡‡ç”¨ä¸¤å±‚æ ‡ç­¾çš„æ–¹å¼ï¼š</p><ul><li>ç¬¬ä¸€å±‚ï¼ˆå¤–å±‚ï¼‰æ ‡ç­¾åœ¨éª¨å¹²ç½‘å†…éƒ¨è¿›è¡Œäº¤æ¢ï¼ŒæŒ‡ç¤ºä» PE åˆ°å¯¹ç«¯ PE çš„ä¸€æ¡ LSPã€‚VPN æŠ¥æ–‡åˆ©ç”¨è¿™å±‚æ ‡ç­¾ï¼Œå¯ä»¥æ²¿ LSP åˆ°è¾¾å¯¹ç«¯ PEï¼›</li><li>ç¬¬äºŒå±‚ï¼ˆå†…å±‚ï¼‰æ ‡ç­¾åœ¨ä»å¯¹ç«¯ PE åˆ°è¾¾ CE æ—¶ä½¿ç”¨ï¼Œåœ¨ PE ä¸Šï¼Œé€šè¿‡æŸ¥æ‰¾ VRF è¡¨é¡¹ï¼ŒæŒ‡ç¤ºæŠ¥æ–‡åº”è¢«é€åˆ°å“ªä¸ª VPN ç”¨æˆ·ï¼Œæˆ–è€…æ›´å…·ä½“ä¸€äº›ï¼Œåˆ°è¾¾å“ªä¸€ä¸ª CEã€‚è¿™æ ·ï¼Œå¯¹ç«¯ PE æ ¹æ®å†…å±‚æ ‡ç­¾å¯ä»¥æ‰¾åˆ°è½¬å‘æŠ¥æ–‡çš„æ¥å£ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/02/fTPFVvbBgOxsqE5.jpg" alt="fig19.jpg"></p><p>ä¸¾ä¾‹è¯´æ˜MPLS VPNçš„åŒ…å‘é€è¿‡ç¨‹</p><ol><li>æœºæ„ A å’Œæœºæ„ B éƒ½å‘å‡ºä¸€ä¸ªç›®çš„åœ°å€ä¸º 192.168.101.0/24 çš„ IP æŠ¥æ–‡ï¼Œåˆ†åˆ«ç”±å„è‡ªçš„ CE å°†æŠ¥æ–‡å‘é€è‡³ PEã€‚</li><li>PE ä¼šæ ¹æ®æŠ¥æ–‡åˆ°è¾¾çš„æ¥å£åŠç›®çš„åœ°å€æŸ¥æ‰¾ VPN å®ä¾‹è¡¨é¡¹ VRFï¼ŒåŒ¹é…åå°†æŠ¥æ–‡è½¬å‘å‡ºå»ï¼ŒåŒæ—¶æ‰“ä¸Šå†…å±‚å’Œå¤–å±‚ä¸¤ä¸ªæ ‡ç­¾ã€‚å‡è®¾é€šè¿‡ MP-BGP é…ç½®çš„è·¯ç”±ï¼Œä¸¤ä¸ªæŠ¥æ–‡åœ¨éª¨å¹²ç½‘èµ°ç›¸åŒçš„è·¯å¾„ã€‚</li><li>MPLS ç½‘ç»œåˆ©ç”¨æŠ¥æ–‡çš„å¤–å±‚æ ‡ç­¾ï¼Œå°†æŠ¥æ–‡ä¼ é€åˆ°å‡ºå£ PEï¼ŒæŠ¥æ–‡åœ¨åˆ°è¾¾å‡ºå£ PE 2 å‰ä¸€è·³æ—¶å·²ç»è¢«å‰¥ç¦»å¤–å±‚æ ‡ç­¾ï¼Œä»…å«å†…å±‚æ ‡ç­¾ã€‚</li><li>å‡ºå£ PE æ ¹æ®å†…å±‚æ ‡ç­¾å’Œç›®çš„åœ°å€æŸ¥æ‰¾ VPN å®ä¾‹è¡¨é¡¹ VRFï¼Œç¡®å®šæŠ¥æ–‡çš„å‡ºæ¥å£ï¼Œå°†æŠ¥æ–‡è½¬å‘è‡³å„è‡ªçš„ CEã€‚</li><li>CE æ ¹æ®æ­£å¸¸çš„ IP è½¬å‘è¿‡ç¨‹å°†æŠ¥æ–‡ä¼ é€åˆ°ç›®çš„åœ°ã€‚</li></ol><h1 id="3-ç§»åŠ¨ç½‘ç»œ"><a href="#3-ç§»åŠ¨ç½‘ç»œ" class="headerlink" title="3. ç§»åŠ¨ç½‘ç»œ"></a>3. ç§»åŠ¨ç½‘ç»œ</h1><p>ç ”ç©¶ä¸‹æ‰‹æœºä¸Šç½‘çš„åœºæ™¯ï¼š</p><h2 id="3-1-2Gç½‘ç»œ"><a href="#3-1-2Gç½‘ç»œ" class="headerlink" title="3.1 2Gç½‘ç»œ"></a>3.1 2Gç½‘ç»œ</h2><p>2Gæ—¶ä»£ä¸Šç½‘ä¸æ˜¯ä½¿ç”¨çš„IPç½‘ç»œï¼Œè€Œæ˜¯ç”µè¯ç½‘ç»œï¼Œèµ°æ¨¡æ‹Ÿä¿¡å·ï¼Œå«åšå…¬å…±äº¤æ¢ç”µè¯ç½‘(PSTN, Public Switched Telephone Network)</p><p>æ‰‹æœºé€šè¿‡æ”¶å‘æ— çº¿ä¿¡å·æ¥é€šä¿¡ï¼Œæˆä¸ºMobile Stationï¼Œ ç®€ç§°MSï¼Œéœ€è¦åµŒå…¥SIMã€‚æ‰‹æœºæ˜¯å®¢æˆ·ç«¯ï¼Œè€Œæ— çº¿ä¿¡å·çš„æœåŠ¡ç«¯ï¼Œå°±æ˜¯åŸºç«™å­ç³»ç»Ÿ(BBS, Base Station SubsystemBSS).</p><blockquote><p>æ— è®ºæ— çº¿é€šä¿¡å¦‚ä½•æ— çº¿ï¼Œæœ€ç»ˆè¿˜è¦è¿æ¥åˆ°æœ‰çº¿ç½‘ç»œé‡Œã€‚</p></blockquote><p>å› è€Œï¼ŒåŸºç«™å­ç³»ç»Ÿåˆ†ä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†å¯¹å¤–æä¾›æ— çº¿é€šä¿¡ï¼Œå«ä½œåŸºç«™æ”¶å‘ä¿¡å°ï¼ˆBTSï¼ŒBase Transceiver Stationï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†å¯¹å†…è¿æ¥æœ‰çº¿ç½‘ç»œï¼Œå«ä½œåŸºç«™æ§åˆ¶å™¨ï¼ˆBSCï¼ŒBase Station Controllerï¼‰ã€‚åŸºç«™æ”¶å‘ä¿¡å°é€šè¿‡æ— çº¿æ”¶åˆ°æ•°æ®åï¼Œè½¬å‘ç»™åŸºç«™æ§åˆ¶å™¨ã€‚</p><p>è¿™éƒ¨åˆ†å±äºæ— çº¿çš„éƒ¨åˆ†ï¼Œç»Ÿç§°ä¸ºæ— çº¿æ¥å…¥ç½‘ï¼ˆRANï¼ŒRadio Access Networkï¼‰ã€‚</p><p>åŸºç«™æ§åˆ¶å™¨é€šè¿‡æœ‰çº¿ç½‘ç»œï¼Œè¿æ¥åˆ°æä¾›æ‰‹æœºä¸šåŠ¡çš„è¿è¥å•†çš„æ•°æ®ä¸­å¿ƒï¼Œè¿™éƒ¨åˆ†ç§°ä¸ºæ ¸å¿ƒç½‘ï¼ˆCNï¼ŒCore Networkï¼‰ã€‚æ ¸å¿ƒç½‘è¿˜æ²¡æœ‰çœŸçš„è¿›å…¥äº’è”ç½‘ï¼Œè¿™éƒ¨åˆ†è¿˜æ˜¯ä¸»è¦æä¾›æ‰‹æœºä¸šåŠ¡ï¼Œæ˜¯æ‰‹æœºä¸šåŠ¡çš„æœ‰çº¿éƒ¨åˆ†ã€‚</p><p>é¦–å…ˆæ¥å¾…åŸºç«™æ¥çš„æ•°æ®çš„æ˜¯ç§»åŠ¨ä¸šåŠ¡äº¤æ¢ä¸­å¿ƒï¼ˆMSCï¼ŒMobile Service Switching Centerï¼‰ï¼Œå®ƒæ˜¯è¿›å…¥æ ¸å¿ƒç½‘çš„å…¥å£ï¼Œä½†æ˜¯å®ƒä¸ä¼šè®©ä½ ç›´æ¥è¿æ¥åˆ°äº’è”ç½‘ä¸Šã€‚</p><p>å› ä¸ºåœ¨è®©ä½ çš„æ‰‹æœºçœŸæ­£è¿›å…¥äº’è”ç½‘ä¹‹å‰ï¼Œæä¾›æ‰‹æœºä¸šåŠ¡çš„è¿è¥å•†ï¼Œéœ€è¦è®¤è¯æ˜¯ä¸æ˜¯åˆæ³•çš„æ‰‹æœºæ¥å…¥ã€‚åˆ«ä½ è‡ªå·±é€ äº†ä¸€å¼ æ‰‹æœºå¡ï¼Œå°±è¿æ¥ä¸Šæ¥ã€‚é‰´æƒä¸­å¿ƒï¼ˆAUCï¼ŒAuthentication Centerï¼‰å’Œè®¾å¤‡è¯†åˆ«å¯„å­˜å™¨ï¼ˆEIRï¼ŒEquipment Identity Registerï¼‰ä¸»è¦æ˜¯è´Ÿè´£å®‰å…¨æ€§çš„ã€‚</p><p>å¦å¤–ï¼Œéœ€è¦çœ‹ä½ æ˜¯æœ¬åœ°çš„å·ï¼Œè¿˜æ˜¯å¤–åœ°çš„å·ï¼Œè¿™ä¸ªç‰µæ‰¯åˆ°è®¡è´¹çš„é—®é¢˜ï¼Œå¼‚åœ°æ”¶è´¹è¿˜æ˜¯å¾ˆè´µçš„ã€‚è®¿é—®ä½ç½®å¯„å­˜å™¨ï¼ˆVLRï¼ŒVisit Location Registerï¼‰æ˜¯çœ‹ä½ ç›®å‰åœ¨çš„åœ°æ–¹ï¼Œå½’å±ä½ç½®å¯„å­˜å™¨ï¼ˆHLRï¼ŒHome Location Registerï¼‰æ˜¯çœ‹ä½ çš„å·ç å½’å±åœ°ã€‚</p><p>å½“ä½ çš„æ‰‹æœºå¡æ—¢åˆæ³•åˆæœ‰é’±çš„æ—¶å€™ï¼Œæ‰å…è®¸ä½ ä¸Šç½‘ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ä¸€ä¸ªç½‘å…³ï¼Œè¿æ¥æ ¸å¿ƒç½‘å’ŒçœŸæ­£çš„äº’è”ç½‘ã€‚ç½‘å…³ç§»åŠ¨äº¤æ¢ä¸­å¿ƒï¼ˆGMSC ï¼ŒGateway Mobile Switching Centerï¼‰å°±æ˜¯å¹²è¿™ä¸ªçš„ï¼Œç„¶åæ˜¯çœŸæ­£çš„äº’è¿ç½‘ã€‚åœ¨ 2G æ—¶ä»£ï¼Œè¿˜æ˜¯ç”µè¯ç½‘ç»œ PSTNã€‚</p><p>æ•°æ®ä¸­å¿ƒé‡Œçš„è¿™äº›æ¨¡å—ç»Ÿç§°ä¸ºç½‘ç»œå­ç³»ç»Ÿ(NSS, Network and Switching Subsystem)</p><p><img src="https://i.loli.net/2020/02/02/SOJQsF8LxMjBkia.jpg" alt="fig20.jpg"></p><p>2Gæ—¶ä»£çš„ä¸Šç½‘ï¼Œæœ‰å‡ ä¸ªæ ¸å¿ƒç‚¹ï¼š</p><ul><li>æ‰‹æœºé€šè¿‡æ— çº¿ä¿¡å·è¿æ¥åŸºç«™ï¼›</li><li>åŸºç«™ä¸€é¢æœå‰æ¥æ— çº¿ï¼Œä¸€é¢æœåæ¥æ ¸å¿ƒç½‘ï¼›</li><li>æ ¸å¿ƒç½‘ä¸€é¢æœå‰æ¥åˆ°åŸºç«™è¯·æ±‚ï¼Œä¸€æ˜¯åˆ¤æ–­ä½ æ˜¯å¦åˆæ³•ï¼ŒäºŒæ˜¯åˆ¤æ–­ä½ æ˜¯ä¸æ˜¯æœ¬åœ°å·ï¼Œè¿˜æœ‰æ²¡æœ‰é’±ï¼Œä¸€é¢é€šè¿‡ç½‘å…³è¿æ¥ç”µè¯ç½‘ç»œã€‚</li></ul><h2 id="3-2-2-5Gç½‘ç»œ"><a href="#3-2-2-5Gç½‘ç»œ" class="headerlink" title="3.2 2.5Gç½‘ç»œ"></a>3.2 2.5Gç½‘ç»œ</h2><p>åæ¥ä» 2G åˆ°äº† 2.5Gï¼Œä¹Ÿå³åœ¨åŸæ¥ç”µè·¯äº¤æ¢çš„åŸºç¡€ä¸Šï¼ŒåŠ å…¥äº†åˆ†ç»„äº¤æ¢ä¸šåŠ¡ï¼Œæ”¯æŒ Packet çš„è½¬å‘ï¼Œä»è€Œæ”¯æŒ IP ç½‘ç»œã€‚</p><p>åœ¨ä¸Šè¿°ç½‘ç»œçš„åŸºç¡€ä¸Šï¼ŒåŸºç«™ä¸€é¢æœå‰æ¥æ— çº¿ï¼Œä¸€é¢æœåæ¥æ ¸å¿ƒç½‘ã€‚åœ¨æœåçš„ç»„ä»¶ä¸­ï¼Œå¤šäº†ä¸€ä¸ªåˆ†ç»„æ§åˆ¶å•å…ƒï¼ˆPCUï¼ŒPacket Control Unitï¼‰ï¼Œç”¨ä»¥æä¾›åˆ†ç»„äº¤æ¢é€šé“ã€‚</p><p>åœ¨æ ¸å¿ƒç½‘é‡Œé¢ï¼Œæœ‰ä¸ªæœå‰çš„æ¥å¾…å‘˜ï¼ˆSGSNï¼ŒService GPRS Supported Nodeï¼‰å’Œæœåè¿æ¥ IP ç½‘ç»œçš„ç½‘å…³å‹ GPRS æ”¯æŒèŠ‚ç‚¹ï¼ˆGGSNï¼ŒGateway GPRS Supported Nodeï¼‰ã€‚</p><p><img src="https://i.loli.net/2020/02/02/6G2FysU1h7YvZNr.jpg" alt="fig21.jpg"></p><h2 id="3-3-3Gç½‘ç»œ"><a href="#3-3-3Gç½‘ç»œ" class="headerlink" title="3.3 3Gç½‘ç»œ"></a>3.3 3Gç½‘ç»œ</h2><p>åˆ°äº† 3G æ—¶ä»£ï¼Œä¸»è¦æ˜¯æ— çº¿é€šä¿¡æŠ€æœ¯æœ‰äº†æ”¹è¿›ï¼Œå¤§å¤§å¢åŠ äº†æ— çº¿çš„å¸¦å®½ã€‚</p><p>ä»¥ W-CDMA ä¸ºä¾‹ï¼Œç†è®ºæœ€é«˜ 2M çš„ä¸‹è¡Œé€Ÿåº¦ï¼Œå› è€ŒåŸºç«™æ”¹å˜äº†ï¼Œä¸€é¢æœå¤–çš„æ˜¯ Node  Bï¼Œä¸€é¢æœå†…è¿æ¥æ ¸å¿ƒç½‘çš„æ˜¯æ— çº¿ç½‘ç»œæ§åˆ¶å™¨ï¼ˆRNCï¼ŒRadio Network Controllerï¼‰ã€‚æ ¸å¿ƒç½‘ä»¥åŠè¿æ¥çš„ IP ç½‘ç»œæ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚</p><p><img src="https://i.loli.net/2020/02/02/3oOgzejCiLG86Sk.jpg" alt="fig22.jpg"></p><h2 id="3-4-4Gç½‘ç»œ"><a href="#3-4-4Gç½‘ç»œ" class="headerlink" title="3.4 4Gç½‘ç»œ"></a>3.4 4Gç½‘ç»œ</h2><p><img src="https://i.loli.net/2020/02/02/vAWC6fOwgQmSa37.jpg" alt="fig30.jpg"></p><p>4Gç½‘ç»œçš„åè®®ç›¸å¯¹å¤æ‚äº†å¾ˆå¤šï¼š</p><p><img src="https://i.loli.net/2020/02/02/pJBhu8y2LR6FSrV.jpg" alt="fig23.jpg"></p><h3 id="3-4-1-æ§åˆ¶é¢åè®®"><a href="#3-4-1-æ§åˆ¶é¢åè®®" class="headerlink" title="3.4.1 æ§åˆ¶é¢åè®®"></a>3.4.1 æ§åˆ¶é¢åè®®</h3><p>å…¶ä¸­è™šçº¿éƒ¨åˆ†æ˜¯æ§åˆ¶é¢çš„åè®®ã€‚å½“ä¸€ä¸ªæ‰‹æœºæƒ³ä¸Šç½‘çš„æ—¶å€™ï¼Œå…ˆè¦è¿æ¥ eNodeBï¼Œå¹¶é€šè¿‡ S1-MME æ¥å£ï¼Œè¯·æ±‚ MME å¯¹è¿™ä¸ªæ‰‹æœºè¿›è¡Œè®¤è¯å’Œé‰´æƒã€‚S1-MME åè®®æ ˆå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://i.loli.net/2020/02/02/LCZHKxFuf1tJbBd.jpg" alt="fig24.jpg"></p><p>UEæ˜¯æ‰‹æœºï¼ŒeNodeBæœå‰å¯¹æ¥æ— çº¿ç½‘ç»œï¼Œæœåå¯¹æ¥æ ¸å¿ƒç½‘ç»œï¼Œåœ¨æ§åˆ¶é¢å¯¹æ¥çš„æ˜¯MMEã€‚</p><p>eNodeä¸MMEä¹‹é—´çš„è¿æ¥æ˜¯é IPç½‘ç»œï¼Œè€Œåœ¨IPå±‚ä¸Šï¼Œæ˜¯ç”¨çš„SCTPã€‚è¿™æ˜¯é¢å‘è¿æ¥çš„ä¼ è¾“å±‚çš„åè®®ï¼Œæ›´é€‚åˆç§»åŠ¨ç½‘ç»œã€‚ç»§æ‰¿äº†TCPè¾ƒä¸ºå®Œå–„çš„æ‹¥å¡æ§åˆ¶ï¼Œå¹¶æ”¹è¿›äº†TCPçš„ä¸è¶³ä¹‹å¤„ã€‚</p><p>SCTPç‰¹ç‚¹æ˜¯å¤šå®¿ä¸»ï¼Œå¼•å…¥äº†è”åˆçš„æ¦‚å¿µï¼Œå°†å¤šä¸ªæ¥å£ã€å¤šæ¡è·¯å¾„æ”¾åˆ°ä¸€ä¸ªassociationå½“ä¸­ï¼Œå½“æ£€æµ‹åˆ°ä¸€æ¡è·¯å¾„å¤±æ•ˆæ—¶ï¼Œåè®®å°±ä¼šä»å¦å¤–ä¸€æ¡è·¯å¾„æ¥å‘é€é€šä¿¡æ•°æ®ã€‚åº”ç”¨ç¨‹åºç”šè‡³ä¸å¿…çŸ¥é“å‘ç”Ÿäº†æ•…éšœå’Œæ¢å¤ï¼Œä»è€Œæä¾›æ›´é«˜çš„å¯ç”¨æ€§å’Œå¯é æ€§ã€‚</p><p>SCTPè¿˜å¯ä»¥å°†ä¸€ä¸ªè”åˆåˆ†æˆå¤šä¸ªæµã€‚ä¸€ä¸ªè”åˆä¸­çš„æ‰€æœ‰æµéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä½†å‡ä¸è¿™ä¸ªè”åˆç›¸å…³ã€‚æ¯ä¸ªæµéƒ½ç»™å®šäº†ä¸€ä¸ªæµç¼–å·ï¼Œè¢«ç¼–ç åˆ°SCTPæŠ¥æ–‡å½“ä¸­ï¼Œé€šè¿‡è”åˆåœ¨ç½‘ç»œä¸Šä¼ é€ã€‚åœ¨TCPçš„æœºåˆ¶å½“ä¸­ï¼Œç”±äºå¼ºåˆ¶é¡ºåºï¼Œå¯¼è‡´å‰ä¸€ä¸ªä¸åˆ°è¾¾ï¼Œåä¸€ä¸ªå°±å¾—ç­‰å¾…ï¼ŒSCTPçš„å¤šä¸ªæµä¸ä¼šç›¸äº’é˜»å¡ã€‚</p><p>SCPè¿˜å¯ä»¥è¿›è¡Œå››æ¬¡æ¡æ‰‹ï¼Œé˜²æ­¢ SYN æ”»å‡»ã€‚åœ¨ TCP ä¸­æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå½“æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·çš„ SYN ä¹‹åï¼Œè¿”å›ä¸€ä¸ª SYN-ACK ä¹‹å‰ï¼Œå°±å»ºç«‹æ•°æ®ç»“æ„ï¼Œå¹¶è®°å½•ä¸‹çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯å‘é€ ACK çš„ ACKã€‚å½“æ¶æ„å®¢æˆ·ç«¯ä½¿ç”¨è™šå‡çš„æºåœ°å€æ¥ä¼ªé€ å¤§é‡ SYN æŠ¥æ–‡æ—¶ï¼ŒæœåŠ¡ç«¯éœ€è¦åˆ†é…å¤§é‡çš„èµ„æºï¼Œæœ€ç»ˆè€—å°½èµ„æºï¼Œæ— æ³•å¤„ç†æ–°çš„è¯·æ±‚ã€‚</p><p>SCTP å¯ä»¥é€šè¿‡å››æ¬¡æ¡æ‰‹å¼•å…¥ Cookie çš„æ¦‚å¿µï¼Œæ¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™ç§æ”»å‡»çš„äº§ç”Ÿã€‚åœ¨ SCTP ä¸­ï¼Œå®¢æˆ·æœºä½¿ç”¨ä¸€ä¸ª INIT æŠ¥æ–‡å‘èµ·ä¸€ä¸ªè¿æ¥ã€‚æœåŠ¡å™¨ä½¿ç”¨ä¸€ä¸ª INIT-ACK æŠ¥æ–‡è¿›è¡Œå“åº”ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº† Cookieã€‚ç„¶åå®¢æˆ·ç«¯å°±ä½¿ç”¨ä¸€ä¸ª COOKIE-ECHO æŠ¥æ–‡è¿›è¡Œå“åº”ï¼Œå…¶ä¸­åŒ…å«äº†æœåŠ¡å™¨æ‰€å‘é€çš„ Cookieã€‚è¿™ä¸ªæ—¶å€™ï¼ŒæœåŠ¡å™¨ä¸ºè¿™ä¸ªè¿æ¥åˆ†é…èµ„æºï¼Œå¹¶é€šè¿‡å‘å®¢æˆ·æœºå‘é€ä¸€ä¸ª COOKIE-ACK æŠ¥æ–‡å¯¹å…¶è¿›è¡Œå“åº”ã€‚</p><p>SCTPè¿˜å¯ä»¥å¯¹ä¿¡æ¯è¿›è¡Œåˆ†å¸§ã€‚TCPæ˜¯é¢å‘æµçš„ï¼Œå³å‘é€çš„æ•°æ®æ²¡å¤´æ²¡å°¾ï¼Œæ²¡æœ‰æ˜æ˜¾çš„ç•Œé™ã€‚è¿™å¯¹äºå‘é€æ•°æ®æ²¡æœ‰ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºå‘é€ä¸€ä¸ªä¸ªæ¶ˆæ¯ç±»å‹çš„æ•°æ®ï¼Œå°±ä¸å¤ªæ–¹ä¾¿äº†ã€‚æœ‰å¯èƒ½å®¢æˆ·ç«¯å†™å…¥10ä¸ªå­—èŠ‚ï¼Œå†å†™å…¥20ä¸ªã€‚æœåŠ¡ç«¯ä¸æ˜¯æŒ‰ç…§10-20æ¥è¯»çš„ï¼Œè€Œæ˜¯å…ˆ25ä¸ªå­—èŠ‚ï¼Œå†è¯»å…¥5ä¸ªå­—èŠ‚ï¼Œéœ€è¦ä¸šåŠ¡å±‚å»ç»„åˆæˆæ¶ˆæ¯ã€‚</p><p>SCTPå€Ÿé‰´äº†UDPçš„æœºåˆ¶ï¼Œåœ¨æ•°æ®ä¼ è¾“ä¸­æä¾›äº†æ¶ˆæ¯åˆ†å¸§åŠŸèƒ½ã€‚å½“ä¸€ç«¯å¯¹ä¸€ä¸ªå¥—æ¥å­—æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œå¯ç¡®ä¿å¯¹ç­‰ç«¯è¯»å‡ºçš„æ•°æ®å¤§å°ä¸æ­¤ç›¸åŒã€‚ </p><p>SCTPåœ¨æ–­å¼€è¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æŒ¥æ‰‹ã€‚åœ¨TCPé‡Œé¢ï¼Œæ–­å¼€è¿æ¥æ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Œäº‘æºªå¦ä¸€ç«¯å¤„äºåŠå…³é—­çš„çŠ¶æ€ã€‚SCTPé€‰æ‹©æ”¾å¼ƒè¿™ç§çŠ¶æ€ï¼Œå½“ä¸€ç«¯å…³é—­è‡ªå·±çš„å¥—æ¥å­—çš„æ—¶å€™ï¼Œå¯¹ç­‰çš„ä¸¤ç«¯å…¨éƒ¨éœ€è¦å…³é—­ï¼Œå°†æ¥ä»»ä½•ä¸€ç«¯éƒ½ä¸å…è®¸å†è¿›è¡Œæ•°æ®çš„ç§»åŠ¨äº†ã€‚</p><p>å½“ MME é€šè¿‡è®¤è¯é‰´æƒï¼ŒåŒæ„è¿™ä¸ªæ‰‹æœºä¸Šç½‘çš„æ—¶å€™ï¼Œéœ€è¦å»ºç«‹ä¸€ä¸ªæ•°æ®é¢çš„æ•°æ®é€šè·¯ã€‚å»ºç«‹é€šè·¯çš„è¿‡ç¨‹è¿˜æ˜¯æ§åˆ¶é¢çš„äº‹æƒ…ï¼Œå› è€Œä½¿ç”¨çš„æ˜¯æ§åˆ¶é¢çš„åè®® GTP-Cã€‚</p><p>å»ºè®¾çš„æ•°æ®é€šè·¯åˆ†ä¸¤æ®µè·¯ï¼Œå…¶å®æ˜¯ä¸¤ä¸ªéš§é“ã€‚ä¸€æ®µæ˜¯ä» eNodeB åˆ° SGWï¼Œè¿™ä¸ªæ•°æ®é€šè·¯ç”± MME é€šè¿‡ S1-MME åè®®å‘Šè¯‰ eNodeBï¼Œå®ƒæ˜¯éš§é“çš„ä¸€ç«¯ï¼Œé€šè¿‡ S11 å‘Šè¯‰ SGWï¼Œå®ƒæ˜¯éš§é“çš„å¦ä¸€ç«¯ã€‚ç¬¬äºŒç«¯æ˜¯ä» SGW åˆ° PGWï¼ŒSGW é€šè¿‡ S11 åè®®çŸ¥é“è‡ªå·±æ˜¯å…¶ä¸­ä¸€ç«¯ï¼Œå¹¶ä¸»åŠ¨é€šè¿‡ S5 åè®®ï¼Œå‘Šè¯‰ PGW å®ƒæ˜¯éš§é“çš„å¦ä¸€ç«¯ã€‚</p><p>GTP-Cåè®®æ˜¯åŸºäºUDPçš„ï¼Œå¦‚æœçœ‹GTPçš„å¤´ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰éš§é“çš„IDè¿˜æœ‰åºåˆ—å·ã€‚ </p><p><img src="https://i.loli.net/2020/02/02/wHfyhS7pLVe1RQl.jpg" alt="fig25.jpg"></p><h3 id="3-4-2-æ•°æ®é¢åè®®"><a href="#3-4-2-æ•°æ®é¢åè®®" class="headerlink" title="3.4.2 æ•°æ®é¢åè®®"></a>3.4.2 æ•°æ®é¢åè®®</h3><p>å½“ä¸¤ä¸ªéš§é“éƒ½æ‰“é€šï¼Œæ¥åœ¨ä¸€èµ·çš„æ—¶å€™ï¼ŒPGW ä¼šç»™æ‰‹æœºåˆ†é…ä¸€ä¸ª IP åœ°å€ï¼Œè¿™ä¸ª IP åœ°å€æ˜¯éš§é“å†…éƒ¨çš„ IP åœ°å€ï¼Œå¯ä»¥ç±»æ¯”ä¸º IPsec åè®®é‡Œé¢çš„ IP åœ°å€ã€‚è¿™ä¸ª IP åœ°å€æ˜¯å½’æ‰‹æœºè¿è¥å•†ç®¡ç†çš„ã€‚ç„¶åï¼Œæ‰‹æœºå¯ä»¥ä½¿ç”¨è¿™ä¸ª IP åœ°å€ï¼Œè¿æ¥ eNodeBï¼Œä» eNodeB ç»è¿‡ S1-U åè®®ï¼Œé€šè¿‡ç¬¬ä¸€æ®µéš§é“åˆ°è¾¾ SGWï¼Œå†ä» SGW ç»è¿‡ S8 åè®®ï¼Œé€šè¿‡ç¬¬äºŒæ®µéš§é“åˆ°è¾¾ PGWï¼Œç„¶åé€šè¿‡ PGW è¿æ¥åˆ°äº’è”ç½‘ã€‚</p><p>æ•°æ®é¢çš„åè®®é€šè¿‡GTP-U, å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/4eWXgcECuIbB3qk.jpg" alt="fig26.jpg"></p><p>æ‰‹æœºæ¯å‘å‡ºä¸€ä¸ªåŒ…ï¼Œéƒ½ç”±GTP-Uéš§é“åè®®å°è£…èµ·æ¥ï¼š</p><p><img src="https://i.loli.net/2020/02/02/WIgOKsLhw7tRpX8.jpg" alt="fig27.jpg"></p><p>å’Œ IPsec åè®®å¾ˆç±»ä¼¼ï¼Œåˆ†ä¸ºä¹˜å®¢åè®®ã€éš§é“åè®®ã€æ‰¿è½½åè®®ã€‚å…¶ä¸­ä¹˜å®¢åè®®æ˜¯æ‰‹æœºå‘å‡ºæ¥çš„åŒ…ï¼ŒIP æ˜¯æ‰‹æœºçš„ IPï¼Œéš§é“åè®®é‡Œé¢æœ‰éš§é“ IDï¼Œä¸åŒçš„æ‰‹æœºä¸Šçº¿ä¼šå»ºç«‹ä¸åŒçš„éš§é“ï¼Œå› è€Œéœ€è¦éš§é“ ID æ¥æ ‡è¯†ã€‚æ‰¿è½½åè®®çš„ IP åœ°å€æ˜¯ SGW å’Œ PGW çš„ IP åœ°å€ã€‚</p><h3 id="3-4-3-æ‰‹æœºä¸Šç½‘æµç¨‹"><a href="#3-4-3-æ‰‹æœºä¸Šç½‘æµç¨‹" class="headerlink" title="3.4.3 æ‰‹æœºä¸Šç½‘æµç¨‹"></a>3.4.3 æ‰‹æœºä¸Šç½‘æµç¨‹</h3><p>Attach:</p><p><img src="https://i.loli.net/2020/02/02/hwtE7aFNjqgSOCu.jpg" alt="fig28.jpg"></p><ol><li>æ‰‹æœºå¼€æœºä»¥åï¼Œåœ¨é™„è¿‘å¯»æ‰¾åŸºç«™ eNodeBï¼Œæ‰¾åˆ°åç»™ eNodeB å‘é€ Attach Requestï¼Œè¯´â€œæˆ‘æ¥å•¦ï¼Œæˆ‘è¦ä¸Šç½‘â€ã€‚</li><li>eNodeB å°†è¯·æ±‚å‘ç»™ MMEï¼Œè¯´â€œæœ‰ä¸ªæ‰‹æœºè¦ä¸Šç½‘â€ã€‚</li><li>MME å»è¯·æ±‚æ‰‹æœºï¼Œä¸€æ˜¯è®¤è¯ï¼ŒäºŒæ˜¯é‰´æƒï¼Œè¿˜ä¼šè¯·æ±‚ HSS çœ‹çœ‹æœ‰æ²¡æœ‰é’±ï¼Œçœ‹çœ‹æ˜¯åœ¨å“ªé‡Œä¸Šç½‘ã€‚</li><li>å½“ MME é€šè¿‡äº†æ‰‹æœºçš„è®¤è¯ä¹‹åï¼Œå¼€å§‹åˆ†é…éš§é“ï¼Œå…ˆå‘Šè¯‰ SGWï¼Œè¯´è¦åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼ˆCreate Sessionï¼‰ã€‚åœ¨è¿™é‡Œé¢ï¼Œä¼šç»™ SGW åˆ†é…ä¸€ä¸ªéš§é“ ID  t1ï¼Œå¹¶ä¸”è¯·æ±‚ SGW ç»™è‡ªå·±ä¹Ÿåˆ†é…ä¸€ä¸ªéš§é“ IDã€‚</li><li>SGW è½¬å¤´å‘ PGW è¯·æ±‚å»ºç«‹ä¸€ä¸ªä¼šè¯ï¼Œä¸º PGW çš„æ§åˆ¶é¢åˆ†é…ä¸€ä¸ªéš§é“ ID  t2ï¼Œä¹Ÿç»™ PGW çš„æ•°æ®é¢åˆ†é…ä¸€ä¸ªéš§é“ ID  t3ï¼Œå¹¶ä¸”è¯·æ±‚ PGW ç»™è‡ªå·±çš„æ§åˆ¶é¢å’Œæ•°æ®é¢åˆ†é…éš§é“ IDã€‚</li><li>PGW å›å¤ SGW è¯´â€œåˆ›å»ºä¼šè¯æˆåŠŸâ€ï¼Œä½¿ç”¨è‡ªå·±çš„æ§åˆ¶é¢éš§é“ ID t2ï¼Œå›å¤é‡Œé¢æºå¸¦ç€ç»™ SGW æ§åˆ¶é¢åˆ†é…çš„éš§é“ ID  t4 å’Œæ§åˆ¶é¢çš„éš§é“ ID  t5ï¼Œè‡³æ­¤ SGW å’Œ PGW ç›´æ¥çš„éš§é“å»ºè®¾å®Œæˆã€‚åŒæ–¹è¯·æ±‚å¯¹æ–¹ï¼Œéƒ½è¦å¸¦ç€å¯¹æ–¹ç»™è‡ªå·±åˆ†é…çš„éš§é“ IDï¼Œä»è€Œæ ‡å¿—æ˜¯è¿™ä¸ªæ‰‹æœºçš„è¯·æ±‚ã€‚</li><li>æ¥ä¸‹æ¥ SGW å›å¤ MME è¯´â€œåˆ›å»ºä¼šè¯æˆåŠŸâ€ï¼Œä½¿ç”¨è‡ªå·±çš„éš§é“ ID  t1 è®¿é—® MMEï¼Œå›å¤é‡Œé¢æœ‰ç»™ MME åˆ†é…éš§é“ ID  t6ï¼Œä¹Ÿæœ‰ SGW ç»™ eNodeB åˆ†é…çš„éš§é“ ID  t7ã€‚</li><li>å½“ MME å‘ç°åé¢çš„éš§é“éƒ½å»ºè®¾æˆåŠŸä¹‹åï¼Œå°±å‘Šè¯‰ eNodeBï¼Œâ€œåé¢çš„éš§é“å·²ç»å»ºè®¾å®Œæ¯•ï¼ŒSGW ç»™ä½ åˆ†é…çš„éš§é“ ID æ˜¯ t7ï¼Œä½ å¯ä»¥å¼€å§‹è¿ä¸Šæ¥äº†ï¼Œä½†æ˜¯ä½ ä¹Ÿè¦ç»™ SGW åˆ†é…ä¸€ä¸ªéš§é“ IDâ€ã€‚</li><li>eNodeB å‘Šè¯‰ MME è‡ªå·±ç»™ SGW åˆ†é…ä¸€ä¸ªéš§é“ï¼ŒID ä¸º t8ã€‚</li><li>MME å°† eNodeB ç»™ SGW åˆ†é…çš„éš§é“ ID  t8 å‘ŠçŸ¥ SGWï¼Œä»è€Œå‰é¢çš„éš§é“ä¹Ÿå»ºè®¾å®Œæ¯•ã€‚</li></ol><h3 id="3-4-4-å¼‚åœ°ä¸Šç½‘é—®é¢˜"><a href="#3-4-4-å¼‚åœ°ä¸Šç½‘é—®é¢˜" class="headerlink" title="3.4.4 å¼‚åœ°ä¸Šç½‘é—®é¢˜"></a>3.4.4 å¼‚åœ°ä¸Šç½‘é—®é¢˜</h3><p>ä¸ºä»€ä¹ˆè¦åˆ† SGW å’Œ PGW å‘¢ï¼Œä¸€ä¸ª GW ä¸å¯ä»¥å—ï¼ŸSGW æ˜¯ä½ æœ¬åœ°çš„è¿è¥å•†çš„è®¾å¤‡ï¼Œè€Œ PGW æ˜¯ä½ æ‰€å±çš„è¿è¥å•†çš„è®¾å¤‡ã€‚å¦‚æœä½ åœ¨å·´å¡ç½—é‚£ï¼Œä¸€ä¸‹é£æœºï¼Œæ‰‹æœºå¼€æœºï¼Œå‘¨å›´æœå¯»åˆ°çš„è‚¯å®šæ˜¯å·´å¡ç½—é‚£çš„ eNodeBã€‚é€šè¿‡ MME å»æŸ¥å¯»å›½å†…è¿è¥å•†çš„ HSSï¼Œçœ‹ä½ æ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦è¿˜æœ‰é’±ã€‚å¦‚æœå…è®¸ä¸Šç½‘ï¼Œä½ çš„æ‰‹æœºå’Œå·´å¡ç½—é‚£çš„ SGW ä¼šå»ºç«‹ä¸€ä¸ªéš§é“ï¼Œç„¶åå·´å¡ç½—é‚£çš„ SGW å’Œå›½å†…è¿è¥å•†çš„ PGW å»ºç«‹ä¸€ä¸ªéš§é“ï¼Œç„¶åé€šè¿‡å›½å†…è¿è¥å•†çš„ PGW ä¸Šç½‘ã€‚</p><p><img src="https://i.loli.net/2020/02/02/baY14UCmQ6ZkjOs.jpg" alt="fig29.jpg"></p><p>è¿™æ ·åˆ¤æ–­ä½ æ˜¯å¦èƒ½ä¸Šç½‘çš„åœ¨å›½å†…è¿è¥å•†çš„ HSSï¼Œæ§åˆ¶ä½ ä¸Šç½‘ç­–ç•¥çš„æ˜¯å›½å†…è¿è¥å•†çš„ PCRFï¼Œç»™æ‰‹æœºåˆ†é…çš„ IP åœ°å€ä¹Ÿæ˜¯å›½å†…è¿è¥å•†çš„ PGW è´Ÿè´£çš„ï¼Œç»™æ‰‹æœºåˆ†é…çš„ IP åœ°å€ä¹Ÿæ˜¯å›½å†…è¿è¥å•†é‡Œç»Ÿè®¡çš„ã€‚è¿è¥å•†ç”±äºæ˜¯åœ¨ PGW é‡Œé¢ç»Ÿè®¡çš„ï¼Œè¿™æ ·ä½ çš„ä¸Šç½‘æµé‡å…¨éƒ¨é€šè¿‡å›½å†…è¿è¥å•†å³å¯ï¼Œåªä¸è¿‡å·´å¡ç½—é‚£è¿è¥å•†ä¹Ÿè¦å’Œå›½å†…è¿è¥å•†è¿›è¡Œæµé‡ç»“ç®—ã€‚</p><p>ç”±äºä½ çš„ä¸Šç½‘ç­–ç•¥æ˜¯ç”±å›½å†…è¿è¥å•†åœ¨ PCRF ä¸­æ§åˆ¶çš„ï¼Œå› è€Œä½ è¿˜æ˜¯ä¸Šä¸äº†è„¸ä¹¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Data Center </tag>
            
            <tag> VPN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(ä¸ƒ)-æµåª’ä½“åè®®(ç½‘ç»œç›´æ’­å½“ä¸­çš„è§†é¢‘å‹ç¼©ä¸ä¼ æ’­é—®é¢˜)</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%83-%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE-%E7%BD%91%E7%BB%9C%E7%9B%B4%E6%92%AD%E5%BD%93%E4%B8%AD%E7%9A%84%E8%A7%86%E9%A2%91%E5%8E%8B%E7%BC%A9%E4%B8%8E%E4%BC%A0%E6%92%AD%E9%97%AE%E9%A2%98/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%83-%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE-%E7%BD%91%E7%BB%9C%E7%9B%B4%E6%92%AD%E5%BD%93%E4%B8%AD%E7%9A%84%E8%A7%86%E9%A2%91%E5%8E%8B%E7%BC%A9%E4%B8%8E%E4%BC%A0%E6%92%AD%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-è§†é¢‘å‹ç¼©"><a href="#1-è§†é¢‘å‹ç¼©" class="headerlink" title="1. è§†é¢‘å‹ç¼©"></a>1. è§†é¢‘å‹ç¼©</h1><p>ç½‘ç»œç›´æ’­,è§†é¢‘å‹ç¼©æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„æŠ€æœ¯ï¼Œå› ä¸ºå‡è®¾æ¯ä¸€å¼ å›¾ç‰‡å¤§å°ä¸º1024 * 768ï¼Œæ¯ä¸ªåƒç´ ç”±RGBç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªå 8ä½ï¼Œå…±24ä½ã€‚é‚£ä¹ˆæ¯ç§’é’Ÿçš„è§†é¢‘å¤§å°ä¸ºï¼š</p><p>30å¸§ x 1024 x 768 x 24 = 70,778,880 Bytes<br>å¦‚æœä¸€åˆ†é’Ÿçš„è§†é¢‘ï¼Œå°±å·²ç»æ˜¯4ä¸ªGäº†ã€‚</p><p>è§£å†³çš„æ–¹å¼æ˜¯ç¼–ç ï¼Œé€šè¿‡å¯¹å›¾ç‰‡çš„å‹ç¼©ï¼Œä½¿æ’­æ”¾çš„æ—¶å€™ç”»é¢çœ‹èµ·æ¥ä»ç„¶è¶³å¤Ÿç²¾ç¾ã€‚</p><h2 id="1-1-è§†é¢‘å’Œå›¾ç‰‡å‹ç¼©è¿‡ç¨‹ç‰¹å¾"><a href="#1-1-è§†é¢‘å’Œå›¾ç‰‡å‹ç¼©è¿‡ç¨‹ç‰¹å¾" class="headerlink" title="1.1 è§†é¢‘å’Œå›¾ç‰‡å‹ç¼©è¿‡ç¨‹ç‰¹å¾"></a>1.1 è§†é¢‘å’Œå›¾ç‰‡å‹ç¼©è¿‡ç¨‹ç‰¹å¾</h2><h3 id="1-1-1-ç©ºé—´å†—ä½™"><a href="#1-1-1-ç©ºé—´å†—ä½™" class="headerlink" title="1.1.1 ç©ºé—´å†—ä½™"></a>1.1.1 ç©ºé—´å†—ä½™</h3><p>å›¾åƒçš„ç›¸é‚»åƒç´ ä¹‹é—´æœ‰è¾ƒå¼ºçš„ç›¸å…³æ€§ï¼Œä¸€å¼ å›¾ç‰‡ç›¸é‚»åƒç´ å¾€å¾€æ˜¯æ¸å˜çš„ï¼Œä¸æ˜¯çªå˜çš„ï¼Œæ²¡å¿…è¦æ¯ä¸ªåƒç´ éƒ½å®Œæ•´åœ°ä¿å­˜ï¼Œå¯ä»¥éš”å‡ ä¸ªä¿å­˜ä¸€ä¸ªï¼Œä¸­é—´çš„ç”¨ç®—æ³•è®¡ç®—å‡ºæ¥ã€‚</p><h3 id="1-1-2-æ—¶é—´å†—ä½™"><a href="#1-1-2-æ—¶é—´å†—ä½™" class="headerlink" title="1.1.2 æ—¶é—´å†—ä½™"></a>1.1.2 æ—¶é—´å†—ä½™</h3><p>è§†é¢‘åºåˆ—çš„ç›¸é‚»å›¾åƒä¹‹é—´å†…å®¹ç›¸ä¼¼ã€‚ä¸€ä¸ªè§†é¢‘ä¸­è¿ç»­å‡ºç°çš„å›¾ç‰‡ä¹Ÿä¸æ˜¯çªå˜çš„ï¼Œå¯ä»¥æ ¹æ®å·²æœ‰çš„å›¾ç‰‡è¿›è¡Œé¢„æµ‹å’Œæ¨æ–­ã€‚</p><h3 id="1-1-3-è§†è§‰å†—ä½™"><a href="#1-1-3-è§†è§‰å†—ä½™" class="headerlink" title="1.1.3 è§†è§‰å†—ä½™"></a>1.1.3 è§†è§‰å†—ä½™</h3><p>äººçš„è§†è§‰ç³»ç»Ÿå¯¹æŸäº›ç»†èŠ‚ä¸æ•æ„Ÿï¼Œå› æ­¤ä¸ä¼šæ¯ä¸€ä¸ªç»†èŠ‚éƒ½æ³¨æ„åˆ°ï¼Œå¯ä»¥å…è®¸ä¸¢å¤±ä¸€äº›æ•°æ®ã€‚</p><h3 id="1-1-4-ç¼–ç å†—ä½™"><a href="#1-1-4-ç¼–ç å†—ä½™" class="headerlink" title="1.1.4 ç¼–ç å†—ä½™"></a>1.1.4 ç¼–ç å†—ä½™</h3><p>ä¸åŒåƒç´ å€¼å‡ºç°çš„æ¦‚ç‡ä¸åŒï¼Œæ¦‚ç‡é«˜çš„ç”¨çš„å­—èŠ‚å°‘ï¼Œæ¦‚ç‡ä½çš„ç”¨çš„å­—èŠ‚å¤š</p><p>æ•´ä¸ªå‹ç¼©è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/s1dCD9uOXyP7t4E.jpg" alt="fig1.jpg"></p><h2 id="1-2-è§†é¢‘ç¼–ç çš„ä¸¤å¤§ç§ç±»-æµæ´¾"><a href="#1-2-è§†é¢‘ç¼–ç çš„ä¸¤å¤§ç§ç±»-æµæ´¾" class="headerlink" title="1.2 è§†é¢‘ç¼–ç çš„ä¸¤å¤§ç§ç±»/ æµæ´¾"></a>1.2 è§†é¢‘ç¼–ç çš„ä¸¤å¤§ç§ç±»/ æµæ´¾</h2><h3 id="1-2-1-ITU-International-Telecommunications-Union"><a href="#1-2-1-ITU-International-Telecommunications-Union" class="headerlink" title="1.2.1 ITU International Telecommunications Union"></a>1.2.1 ITU International Telecommunications Union</h3><p>VCEG(Video Conding Experts Group),è§†é¢‘ç¼–ç ï¼Œä¾§é‡äºä¼ è¾“</p><h3 id="1-2-2-ISO-International-Standards-Organization"><a href="#1-2-2-ISO-International-Standards-Organization" class="headerlink" title="1.2.2 ISO International Standards Organization"></a>1.2.2 ISO International Standards Organization</h3><p>MPEG(Moving Picture Experts Group)ï¼Œè§†é¢‘å­˜å‚¨</p><h2 id="1-2-ç½‘ç»œç›´æ’­"><a href="#1-2-ç½‘ç»œç›´æ’­" class="headerlink" title="1.2 ç½‘ç»œç›´æ’­"></a>1.2 ç½‘ç»œç›´æ’­</h2><p>ç½‘ç»œåè®®å°†ç¼–ç å¥½çš„è§†é¢‘æµï¼Œä»ä¸»æ’­ç«¯æ¨é€åˆ°æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæœ‰ä¸ªè¿è¡Œäº†åŒæ ·åè®®çš„æœåŠ¡ç«¯æ¥æ¥æ”¶è¿™äº›ç½‘ç»œåŒ…ï¼Œä»è€Œå¾—åˆ°é‡Œé¢çš„è§†é¢‘æµã€‚</p><p>æœåŠ¡ç«¯æ¥åˆ°è§†é¢‘æµä»¥åï¼Œå¯¹è§†é¢‘æµè¿›è¡Œè½¬ç ï¼Œä¿è¯ç”¨å„ç§å®¢æˆ·ç«¯éƒ½èƒ½çœ‹åˆ°ç›´æ’­ã€‚</p><p>å¦‚æœæœ‰éå¸¸å¤šçš„è§‚ä¼—ï¼ŒåŒæ—¶çœ‹ä¸€ä¸ªè§†é¢‘ç›´æ’­ï¼Œéƒ½ä»ä¸€ä¸ªæœåŠ¡å™¨ä¸Šæ‹‰æµï¼Œå‹åŠ›å¤ªå¤§äº†ï¼Œå› è€Œéœ€è¦ä¸€ä¸ªè§†é¢‘çš„åˆ†å‘ç½‘ç»œï¼Œå°†è§†é¢‘é¢„å…ˆåŠ è½½åˆ°å°±è¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œæ¥é™ä½æœåŠ¡å™¨çš„å‹åŠ›ã€‚</p><p><img src="https://i.loli.net/2020/02/02/CqdINFefH17Pvph.jpg" alt="fig2.jpg"></p><h2 id="1-3-è§†é¢‘å›¾ç‰‡å‹ç¼©è¿‡ç¨‹è¯¦è§£"><a href="#1-3-è§†é¢‘å›¾ç‰‡å‹ç¼©è¿‡ç¨‹è¯¦è§£" class="headerlink" title="1.3 è§†é¢‘å›¾ç‰‡å‹ç¼©è¿‡ç¨‹è¯¦è§£"></a>1.3 è§†é¢‘å›¾ç‰‡å‹ç¼©è¿‡ç¨‹è¯¦è§£</h2><h3 id="1-3-1-ç¼–ç "><a href="#1-3-1-ç¼–ç " class="headerlink" title="1.3.1 ç¼–ç "></a>1.3.1 ç¼–ç </h3><p>ä¼šå°†è§†é¢‘åºåˆ—åˆ†ä¸ºä¸‰ç§å¸§ï¼Œæ¥åˆ†åˆ«è¿›è¡Œå‹ç¼©è¡Œä¸ºï¼š</p><ul><li>I å¸§</li></ul><p>ä¹Ÿç§°å…³é”®å¸§ã€‚é‡Œé¢æ˜¯å®Œæ•´çš„å›¾ç‰‡ï¼Œåªéœ€è¦æœ¬å¸§æ•°æ®ï¼Œå°±å¯ä»¥å®Œæˆè§£ç ã€‚</p><ul><li>P å¸§</li></ul><p>å‰å‘é¢„æµ‹ç¼–ç å¸§ã€‚P å¸§è¡¨ç¤ºçš„æ˜¯è¿™ä¸€å¸§è·Ÿä¹‹å‰çš„ä¸€ä¸ªå…³é”®å¸§ï¼ˆæˆ– P å¸§ï¼‰çš„å·®åˆ«ï¼Œè§£ç æ—¶éœ€è¦ç”¨ä¹‹å‰ç¼“å­˜çš„ç”»é¢ï¼Œå åŠ ä¸Šå’Œæœ¬å¸§å®šä¹‰çš„å·®åˆ«ï¼Œç”Ÿæˆæœ€ç»ˆç”»é¢ã€‚</p><ul><li>B å¸§</li></ul><p>åŒå‘é¢„æµ‹å†…æ’ç¼–ç å¸§ã€‚B å¸§è®°å½•çš„æ˜¯æœ¬å¸§ä¸å‰åå¸§çš„å·®åˆ«ã€‚è¦è§£ç  B å¸§ï¼Œä¸ä»…è¦å–å¾—ä¹‹å‰çš„ç¼“å­˜ç”»é¢ï¼Œè¿˜è¦è§£ç ä¹‹åçš„ç”»é¢ï¼Œé€šè¿‡å‰åç”»é¢çš„æ•°æ®ä¸æœ¬å¸§æ•°æ®çš„å åŠ ï¼Œå–å¾—æœ€ç»ˆçš„ç”»é¢ã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼ŒI å¸§æœ€å®Œæ•´ï¼ŒB å¸§å‹ç¼©ç‡æœ€é«˜ï¼Œè€Œå‹ç¼©åå¸§çš„åºåˆ—ï¼Œåº”è¯¥æ˜¯åœ¨ IBBP çš„é—´éš”å‡ºç°çš„ã€‚è¿™å°±æ˜¯é€šè¿‡æ—¶åºè¿›è¡Œç¼–ç </p><p><img src="https://i.loli.net/2020/02/02/yS8dkhIKF5Xaf3w.jpg" alt="fig3.jpg"></p><p>åœ¨ä¸€å¸§ä¸­ï¼Œåˆ†æˆå¤šä¸ªç‰‡ï¼Œæ¯ä¸ªç‰‡ä¸­åˆ†æˆå¤šä¸ªå®å—ï¼Œæ¯ä¸ªå®å—åˆ†æˆå¤šä¸ªå­å—ï¼Œè¿™æ ·å°†ä¸€å¼ å¤§çš„å›¾åˆ†è§£æˆä¸€ä¸ªä¸ªå°å—ï¼Œå¯ä»¥æ–¹ä¾¿è¿›è¡Œç©ºé—´ä¸Šçš„ç¼–ç ã€‚</p><p>å¸§ -&gt; ç‰‡ -&gt; å®å— -&gt; å­å—</p><p>ç¼–ç åçš„æ•´ä¸ªåºåˆ—æ˜¯è¦å‹ç¼©ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶æµåœ¨ç½‘ç»œä¸Šä¼ æ’­çš„ï¼Œå› æ­¤éœ€è¦åˆ†å‰²æˆä¸€ä¸ªä¸ªç½‘ç»œæå–å•å…ƒ(NALU, network abstraction layer unit). </p><p><img src="https://i.loli.net/2020/02/02/dMZ329Vrgj6ynex.jpg" alt="fig4.jpg"></p><p>æ¯ä¸€ä¸ª NALU é¦–å…ˆæ˜¯ä¸€ä¸ªèµ·å§‹æ ‡è¯†ç¬¦ï¼Œç”¨äºæ ‡è¯† NALU ä¹‹é—´çš„é—´éš”ï¼›ç„¶åæ˜¯ NALU çš„å¤´ï¼Œé‡Œé¢ä¸»è¦é…ç½®äº† NALU çš„ç±»å‹ï¼›æœ€ç»ˆ Payload é‡Œé¢æ˜¯ NALU æ‰¿è½½çš„æ•°æ®ã€‚</p><p>åœ¨ NALU å¤´é‡Œé¢ï¼Œä¸»è¦çš„å†…å®¹æ˜¯ç±»å‹NAL Type.</p><ul><li>0x07 è¡¨ç¤º SPSï¼Œæ˜¯åºåˆ—å‚æ•°é›†ï¼Œ åŒ…æ‹¬ä¸€ä¸ªå›¾åƒåºåˆ—çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¦‚å›¾åƒå°ºå¯¸ã€è§†é¢‘æ ¼å¼ç­‰ã€‚</li><li>0x08 è¡¨ç¤º PPSï¼Œæ˜¯å›¾åƒå‚æ•°é›†ï¼ŒåŒ…æ‹¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰åˆ†ç‰‡çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬å›¾åƒç±»å‹ã€åºåˆ—å·ç­‰ã€‚</li><li>åœ¨ä¼ è¾“è§†é¢‘æµä¹‹å‰ï¼Œå¿…é¡»è¦ä¼ è¾“è¿™ä¸¤ç±»å‚æ•°ï¼Œä¸ç„¶æ— æ³•è§£ç ã€‚ä¸ºäº†ä¿è¯å®¹é”™æ€§ï¼Œæ¯ä¸€ä¸ª I å¸§å‰é¢ï¼Œéƒ½ä¼šä¼ ä¸€éè¿™ä¸¤ä¸ªå‚æ•°é›†åˆã€‚</li></ul><p>å¦‚æœ NALU Header é‡Œé¢çš„è¡¨ç¤ºç±»å‹æ˜¯ SPS æˆ–è€… PPSï¼Œåˆ™ Payload ä¸­å°±æ˜¯çœŸæ­£çš„å‚æ•°é›†çš„å†…å®¹ã€‚</p><p>å¦‚æœç±»å‹æ˜¯å¸§ï¼Œåˆ™ Payload ä¸­æ‰æ˜¯æ­£çš„è§†é¢‘æ•°æ®ï¼Œå½“ç„¶ä¹Ÿæ˜¯ä¸€å¸§ä¸€å¸§å­˜æ”¾çš„ï¼Œå‰é¢è¯´äº†ï¼Œä¸€å¸§çš„å†…å®¹è¿˜æ˜¯æŒºå¤šçš„ï¼Œå› è€Œæ¯ä¸€ä¸ª NALU é‡Œé¢ä¿å­˜çš„æ˜¯ä¸€ç‰‡ã€‚å¯¹äºæ¯ä¸€ç‰‡ï¼Œåˆ°åº•æ˜¯ I å¸§ï¼Œè¿˜æ˜¯ P å¸§ï¼Œè¿˜æ˜¯ B å¸§ï¼Œåœ¨ç‰‡ç»“æ„é‡Œé¢ä¹Ÿæœ‰ä¸ª Headerï¼Œè¿™é‡Œé¢æœ‰ä¸ªç±»å‹ï¼Œç„¶åæ˜¯ç‰‡çš„å†…å®¹ã€‚</p><p><strong>ä¸€ä¸ªè§†é¢‘ï¼Œå¯ä»¥æ‹†åˆ†æˆä¸€ç³»åˆ—çš„å¸§ï¼Œæ¯ä¸€å¸§æ‹†åˆ†æˆä¸€ç³»åˆ—çš„ç‰‡ï¼Œæ¯ä¸€ç‰‡éƒ½æ”¾åœ¨ä¸€ä¸ª NALU é‡Œé¢ï¼ŒNALU ä¹‹é—´éƒ½æ˜¯é€šè¿‡ç‰¹æ®Šçš„èµ·å§‹æ ‡è¯†ç¬¦åˆ†éš”ï¼Œåœ¨æ¯ä¸€ä¸ª I å¸§çš„ç¬¬ä¸€ç‰‡å‰é¢ï¼Œè¦æ’å…¥å•ç‹¬ä¿å­˜ SPS å’Œ PPS çš„ NALUï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªé•¿é•¿çš„ NALU åºåˆ—</strong></p><h3 id="1-3-2-æ¨æµ"><a href="#1-3-2-æ¨æµ" class="headerlink" title="1.3.2 æ¨æµ"></a>1.3.2 æ¨æµ</h3><p>éœ€è¦å°†è¿™ä¸ªäºŒè¿›åˆ¶æµæ‰“åŒ…æˆç½‘ç»œåŒ…è¿›è¡Œå‘é€ï¼Œä¸€èˆ¬ä½¿ç”¨RTMPåè®®ã€‚</p><p>RTMPåè®®æ˜¯åŸºäºTCPçš„ï¼Œå› æ­¤è‚¯å®šéœ€è¦åŒæ–¹å»ºç«‹ä¸€ä¸ªTCPçš„è¿æ¥ã€‚åœ¨æœ‰TCPçš„è¿æ¥çš„åŸºç¡€ä¸Šï¼Œè¿˜éœ€è¦å»ºç«‹ä¸€ä¸ªRTMPçš„è¿æ¥ï¼Œå³åœ¨ç¨‹åºå½“ä¸­ï¼Œéœ€è¦è°ƒç”¨RTMPç±»åº“çš„Connectå‡½æ•°æ˜¾ç¤ºåˆ›å»ºä¸€ä¸ªè¿æ¥ã€‚</p><p>RTMPéœ€è¦å•ç‹¬ä¸€ä¸ªè¿æ¥çš„åŸå› åœ¨äºï¼šåŒæ–¹éœ€è¦äº’ç›¸çŸ¥é“ç‰ˆæœ¬å·ï¼Œæ—¶é—´æˆ³(çœ‹æ—¶é—´æˆ³çš„å·®å€¼)</p><p>æœªæ¥æ²Ÿé€šè¿™äº›äº‹æƒ…ï¼Œéœ€è¦å‘é€å…­æ¡æ¶ˆæ¯ï¼šå®¢æˆ·ç«¯å‘é€ C0ã€C1ã€  C2ï¼ŒæœåŠ¡å™¨å‘é€ S0ã€  S1ã€  S2ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯å‘é€ C0 è¡¨ç¤ºè‡ªå·±çš„ç‰ˆæœ¬å·ï¼Œä¸å¿…ç­‰å¯¹æ–¹çš„å›å¤ï¼Œç„¶åå‘é€ C1 è¡¨ç¤ºè‡ªå·±çš„æ—¶é—´æˆ³ã€‚æœåŠ¡å™¨åªæœ‰åœ¨æ”¶åˆ° C0 çš„æ—¶å€™ï¼Œæ‰èƒ½è¿”å› S0ï¼Œè¡¨æ˜è‡ªå·±çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯ä»¥æ–­å¼€è¿æ¥ã€‚<br>æœåŠ¡å™¨å‘é€å®Œ S0 åï¼Œä¹Ÿä¸ç”¨ç­‰ä»€ä¹ˆï¼Œå°±ç›´æ¥å‘é€è‡ªå·±çš„æ—¶é—´æˆ³ S1ã€‚å®¢æˆ·ç«¯æ”¶åˆ° S1 çš„æ—¶å€™ï¼Œå‘ä¸€ä¸ªçŸ¥é“äº†å¯¹æ–¹æ—¶é—´æˆ³çš„ ACK  C2ã€‚åŒç†æœåŠ¡å™¨æ”¶åˆ° C1 çš„æ—¶å€™ï¼Œå‘ä¸€ä¸ªçŸ¥é“äº†å¯¹æ–¹æ—¶é—´æˆ³çš„ ACK  S2ã€‚<br>æ¡æ‰‹å®Œæˆã€‚</p><p><img src="https://i.loli.net/2020/02/02/4DgIibdfYF9xmPl.jpg" alt="fig5.jpg"></p><p>æ¡æ‰‹ä¹‹åï¼ŒåŒæ–¹éœ€è¦äº’ç›¸ä¼ é€’ä¸€äº›æ§åˆ¶ä¿¡æ¯ï¼Œæ¯”å¦‚Chunkå—çš„å¤§å°ï¼Œçª—å£å¤§å°ç­‰ã€‚çœŸæ­£ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œè¿˜æ˜¯éœ€è¦åˆ›å»ºä¸€ä¸ªæµStreamï¼Œç„¶åé€šè¿‡è¿™ä¸ªStreamæ¥æ¨æµpublishã€‚ </p><p>æ¨æµçš„è¿‡ç¨‹ï¼Œå°±æ˜¯å°†NALUæ”¾åœ¨messageé‡Œé¢å‘é€ï¼Œç§°ä¸ºRTMP PacketåŒ…ã€‚æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/id8BeJZkDrVbpQX.jpg" alt="fig6.jpg"></p><p>å‘é€çš„æ—¶å€™ï¼Œå»æ‰ NALU çš„èµ·å§‹æ ‡è¯†ç¬¦ã€‚å› ä¸ºè¿™éƒ¨åˆ†å¯¹äº RTMP åè®®æ¥è®²æ²¡æœ‰ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œå°† SPS å’Œ PPS å‚æ•°é›†å°è£…æˆä¸€ä¸ª RTMP åŒ…å‘é€ï¼Œç„¶åå‘é€ä¸€ä¸ªä¸ªç‰‡çš„ NALUã€‚</p><p>RTMP åœ¨æ”¶å‘æ•°æ®çš„æ—¶å€™å¹¶ä¸æ˜¯ä»¥ Message ä¸ºå•ä½çš„ï¼Œè€Œæ˜¯æŠŠ Message æ‹†åˆ†æˆ Chunk å‘é€ï¼Œè€Œä¸”å¿…é¡»åœ¨ä¸€ä¸ª Chunk å‘é€å®Œæˆä¹‹åï¼Œæ‰èƒ½å¼€å§‹å‘é€ä¸‹ä¸€ä¸ª Chunkã€‚æ¯ä¸ª Chunk ä¸­éƒ½å¸¦æœ‰ Message  IDï¼Œè¡¨ç¤ºå±äºå“ªä¸ª Messageï¼Œæ¥æ”¶ç«¯ä¹Ÿä¼šæŒ‰ç…§è¿™ä¸ª ID å°† Chunk ç»„è£…æˆ Messageã€‚</p><p>å‰é¢è¿æ¥çš„æ—¶å€™ï¼Œè®¾ç½®çš„ Chunk å—å¤§å°å°±æ˜¯æŒ‡è¿™ä¸ª Chunkã€‚å°†å¤§çš„æ¶ˆæ¯å˜ä¸ºå°çš„å—å†å‘é€ï¼Œå¯ä»¥åœ¨ä½å¸¦å®½çš„æƒ…å†µä¸‹ï¼Œå‡å°‘ç½‘ç»œæ‹¥å¡ã€‚</p><p>ä¸¾ä¸€ä¸ªåˆ†å—çš„ä¾‹å­ï¼š</p><p>å‡è®¾ä¸€ä¸ªè§†é¢‘çš„æ¶ˆæ¯é•¿åº¦ä¸º 307ï¼Œä½†æ˜¯ Chunk å¤§å°çº¦å®šä¸º 128ï¼Œäºæ˜¯ä¼šæ‹†åˆ†ä¸ºä¸‰ä¸ª Chunkã€‚</p><p>ç¬¬ä¸€ä¸ª Chunk çš„ Typeï¼0ï¼Œè¡¨ç¤º Chunk å¤´æ˜¯å®Œæ•´çš„ï¼›å¤´é‡Œé¢ Timestamp ä¸º 1000ï¼Œæ€»é•¿åº¦ Length ä¸º 307ï¼Œç±»å‹ä¸º 9ï¼Œæ˜¯ä¸ªè§†é¢‘ï¼ŒStream  ID ä¸º 12346ï¼Œæ­£æ–‡éƒ¨åˆ†æ‰¿æ‹… 128 ä¸ªå­—èŠ‚çš„ Dataã€‚</p><p>ç¬¬äºŒä¸ª Chunk ä¹Ÿè¦å‘é€ 128 ä¸ªå­—èŠ‚ï¼ŒChunk å¤´ç”±äºå’Œç¬¬ä¸€ä¸ª Chunk ä¸€æ ·ï¼Œå› æ­¤é‡‡ç”¨ Chunk Typeï¼3ï¼Œè¡¨ç¤ºå¤´ä¸€æ ·å°±ä¸å†å‘é€äº†ã€‚</p><p>ç¬¬ä¸‰ä¸ª Chunk è¦å‘é€çš„ Data çš„é•¿åº¦ä¸º 307-128-128=51 ä¸ªå­—èŠ‚ï¼Œè¿˜æ˜¯é‡‡ç”¨ Typeï¼3ã€‚</p><p><img src="https://i.loli.net/2020/02/02/TvqDHjO9eQ8bcBo.jpg" alt="fig7.jpg"></p><p>è¿™æ ·æ•°æ®å°±èƒ½æºæºä¸æ–­åˆ°è¾¾æµåª’ä½“æœåŠ¡å™¨</p><p><img src="https://i.loli.net/2020/02/02/7gvWiSIFkPX64Oe.jpg" alt="fig8.jpg"></p><p>è¿™ä¸ªæ—¶å€™ï¼Œå¤§é‡è§‚çœ‹ç›´æ’­çš„è§‚ä¼—å°±å¯ä»¥é€šè¿‡ RTMP åè®®ä»æµåª’ä½“æœåŠ¡å™¨ä¸Šæ‹‰å–ï¼Œä½†æ˜¯è¿™ä¹ˆå¤šçš„ç”¨æˆ·é‡ï¼Œéƒ½å»åŒä¸€ä¸ªåœ°æ–¹æ‹‰å–ï¼ŒæœåŠ¡å™¨å‹åŠ›ä¼šå¾ˆå¤§ï¼Œè€Œä¸”ç”¨æˆ·åˆ†å¸ƒåœ¨å…¨å›½ç”šè‡³å…¨çƒï¼Œå¦‚æœéƒ½å»ç»Ÿä¸€çš„ä¸€ä¸ªåœ°æ–¹ä¸‹è½½ï¼Œä¹Ÿä¼šæ—¶å»¶æ¯”è¾ƒé•¿ï¼Œéœ€è¦æœ‰åˆ†å‘ç½‘ç»œã€‚</p><p>åˆ†å‘ç½‘ç»œåˆ†ä¸ºä¸­å¿ƒå’Œè¾¹ç¼˜ä¸¤å±‚ã€‚è¾¹ç¼˜å±‚æœåŠ¡å™¨éƒ¨ç½²åœ¨å…¨å›½å„åœ°åŠæ¨ªè·¨å„å¤§è¿è¥å•†é‡Œï¼Œå’Œç”¨æˆ·è·ç¦»å¾ˆè¿‘ã€‚ä¸­å¿ƒå±‚æ˜¯æµåª’ä½“æœåŠ¡é›†ç¾¤ï¼Œè´Ÿè´£å†…å®¹çš„è½¬å‘ã€‚æ™ºèƒ½è´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼Œæ ¹æ®ç”¨æˆ·çš„åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå°±è¿‘é€‰æ‹©è¾¹ç¼˜æœåŠ¡å™¨ï¼Œä¸ºç”¨æˆ·æä¾›æ¨ / æ‹‰æµæœåŠ¡ã€‚ä¸­å¿ƒå±‚ä¹Ÿè´Ÿè´£è½¬ç æœåŠ¡ï¼Œä¾‹å¦‚ï¼ŒæŠŠ RTMP åè®®çš„ç æµè½¬æ¢ä¸º HLS ç æµã€‚</p><p><img src="https://i.loli.net/2020/02/02/tcimUEH6WRv8wsA.jpg" alt="fig9.jpg"></p><h3 id="1-3-3-æ‹‰æµ"><a href="#1-3-3-æ‹‰æµ" class="headerlink" title="1.3.3 æ‹‰æµ"></a>1.3.3 æ‹‰æµ</h3><p>è§‚ä¼—çš„å®¢æˆ·ç«¯é€šè¿‡RTMPæ‹‰æµçš„è¿‡ç¨‹ï¼š</p><p><img src="https://i.loli.net/2020/02/02/9Br2WsplhnkzvjK.jpg" alt="fig10.jpg"></p><h1 id="2-P2P"><a href="#2-P2P" class="headerlink" title="2. P2P"></a>2. P2P</h1><h2 id="2-1-ä¼ è¾“å¤§æ–‡ä»¶çš„ç°æœ‰æ–¹å¼"><a href="#2-1-ä¼ è¾“å¤§æ–‡ä»¶çš„ç°æœ‰æ–¹å¼" class="headerlink" title="2.1 ä¼ è¾“å¤§æ–‡ä»¶çš„ç°æœ‰æ–¹å¼"></a>2.1 ä¼ è¾“å¤§æ–‡ä»¶çš„ç°æœ‰æ–¹å¼</h2><h3 id="2-1-1-HTTPæ–¹å¼"><a href="#2-1-1-HTTPæ–¹å¼" class="headerlink" title="2.1.1 HTTPæ–¹å¼"></a>2.1.1 HTTPæ–¹å¼</h3><p>æœ€ç®€å•çš„æ˜¯é€šè¿‡HTTPè¿›è¡Œä¸‹è½½ï¼Œä½†æ˜¯é€šè¿‡æµè§ˆå™¨ä¸‹è½½é€Ÿåº¦éå¸¸æ…¢ã€‚</p><h3 id="2-1-2-FTPæ–¹å¼"><a href="#2-1-2-FTPæ–¹å¼" class="headerlink" title="2.1.2 FTPæ–¹å¼"></a>2.1.2 FTPæ–¹å¼</h3><p>è¿˜å¯ä»¥é€šè¿‡FTPï¼Œå³æ–‡ä»¶ä¼ è¾“åè®®ï¼ŒFTPé€šè¿‡ä¸¤ä¸ªTCPè¿æ¥æ¥ä¼ è¾“ä¸€ä¸ªæ–‡ä»¶ã€‚</p><ul><li>æ§åˆ¶è¿æ¥</li></ul><p>æœåŠ¡å™¨ä»¥è¢«åŠ¨çš„æ–¹å¼ï¼Œæ‰“å¼€ç”¨äºFTPçš„ç«¯å£21ï¼Œå®¢æˆ·ç«¯åˆ™ä¸»åŠ¨å‘èµ·è¿æ¥ã€‚è¯¥è¿æ¥å°†å‘½ä»¤ä»å®¢æˆ·ç«¯ä¼ ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¼ å›æœåŠ¡å™¨çš„åº”ç­”ã€‚</p><ul><li>æ•°æ®è¿æ¥</li></ul><p>æ¯å½“ä¸€ä¸ªæ–‡ä»¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ•°æ®è¿æ¥</p><p>FTPæœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼</p><ul><li>ä¸»åŠ¨æ¨¡å¼ PORT</li></ul><p>å®¢æˆ·ç«¯éšæœºæ‰“å¼€ä¸€ä¸ªå¤§äº1024çš„ç«¯å£Nï¼Œå‘æœåŠ¡å™¨çš„å‘½ä»¤ç«¯å£21å‘èµ·è¿æ¥ï¼ŒåŒæ—¶å¼€æ”¾N+1ç«¯å£ç›‘å¬ï¼Œå¹¶å‘æœåŠ¡å™¨å‘å‡º prot N+1çš„å‘½ä»¤ï¼Œç”±æœåŠ¡å™¨ä»è‡ªå·±çš„æ•°æ®ç«¯å£20ä¸»åŠ¨è¿æ¥åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„æ•°æ®ç«¯å£N+1 </p><ul><li>è¢«åŠ¨æ¨¡å¼ PASV</li></ul><p>å½“å¼€å¯ä¸€ä¸ªFTPè¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯æ‰“å¼€ä¸¤ä¸ªä»»æ„çš„æœ¬åœ°ç«¯å£Nï¼ˆä»ç„¶éœ€è¦å¤§äº1024ï¼‰å’ŒN+1.ç¬¬ä¸€ä¸ªç«¯å£è¿æ¥æœåŠ¡å™¨çš„21ç«¯å£ï¼Œæäº¤PASVå‘½ä»¤ã€‚ç„¶åï¼ŒæœåŠ¡å™¨ä¼šå¼€å¯ä¸€ä¸ªä»»æ„çš„ç«¯å£Pï¼ˆå¤§äº1024ï¼‰ï¼Œè¿”å›â€227 entering passive modeâ€ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰FTPæœåŠ¡å™¨å¼€æ”¾çš„ç”¨æ¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„ç«¯å£ã€‚å®¢æˆ·ç«¯æ”¶åˆ°ä¿¡æ¯è·å–ç«¯å£å·ä»¥åï¼Œä¼šé€šè¿‡N+1å·ç«¯å£è¿æ¥æœåŠ¡å™¨çš„ç«¯å£Pï¼Œç„¶ååœ¨ä¸¤ä¸ªç«¯å£ä¹‹é—´è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p><h2 id="2-2-P2Pæ¦‚å¿µ"><a href="#2-2-P2Pæ¦‚å¿µ" class="headerlink" title="2.2 P2Pæ¦‚å¿µ"></a>2.2 P2Pæ¦‚å¿µ</h2><p>é¦–å…ˆæ— è®ºæ˜¯HTTPçš„æ–¹å¼è¿˜æ˜¯FTPçš„æ–¹å¼ï¼Œéƒ½éš¾ä»¥è§£å†³å•ä¸€æœåŠ¡å™¨çš„å¸¦å®½å‹åŠ›çš„é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨çš„éƒ½æ˜¯ä¼ ç»Ÿçš„å®¢æˆ·ç«¯æœåŠ¡å™¨æ–¹å¼ã€‚P2Pæ˜¯æŒ‡peer-to-peerã€‚èµ„æºå¼€å§‹å¹¶ä¸é›†ä¸­åœ°å­˜å‚¨åœ¨æŸäº›è®¾å¤‡ä¸Šï¼Œè€Œæ˜¯åˆ†æ•£åœ°å­˜å‚¨åœ¨å¤šå°è®¾å¤‡ä¸Šã€‚</p><p>æƒ³è¦ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦å¾—åˆ°é‚£äº›å·²ç»å­˜åœ¨äº†æ–‡ä»¶çš„peerï¼Œå¹¶å’Œè¿™äº›peerä¹‹é—´å»ºç«‹ç‚¹å¯¹ç‚¹çš„è¿æ¥ï¼Œè€Œä¸éœ€è¦åˆ°ä¸­å¿ƒæœåŠ¡å™¨ä¸Šï¼Œå°±å¯ä»¥å°±è¿‘ä¸‹è½½æ–‡ä»¶ã€‚åŒæ—¶åœ¨åšä¸‹è½½å’Œä¸Šä¼ ã€‚</p><h2 id="2-3-ç§å­-torrent-æ–‡ä»¶"><a href="#2-3-ç§å­-torrent-æ–‡ä»¶" class="headerlink" title="2.3 ç§å­(.torrent) æ–‡ä»¶"></a>2.3 ç§å­(.torrent) æ–‡ä»¶</h2><p>éœ€è¦çŸ¥é“å“ªäº›peeræœ‰è¿™äº›æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦ç”¨åˆ°ç§å­ï¼Œå°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„.torrentæ–‡ä»¶ã€‚ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šåˆ†åˆ«æ˜¯announce(tracker URL) å’Œæ–‡ä»¶ä¿¡æ¯</p><h3 id="2-3-1-æ–‡ä»¶ä¿¡æ¯"><a href="#2-3-1-æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="2.3.1 æ–‡ä»¶ä¿¡æ¯"></a>2.3.1 æ–‡ä»¶ä¿¡æ¯</h3><ul><li>infoåŒº</li></ul><p>æŒ‡å®šè¯¥ä¸­è¥¿æœ‰å‡ ä¸ªæ–‡ä»¶ã€æ–‡ä»¶æœ‰å¤šé•¿ã€ç›®å½•ç»“æ„ï¼Œä»¥åŠç›®å½•å’Œæ–‡ä»¶çš„åå­—ã€‚</p><ul><li>nameå­—æ®µ</li></ul><p>æŒ‡å®šé¡¶å±‚ç›®å½•çš„åå­—</p><ul><li>æ¯ä¸ªæ®µçš„å¤§å°</li></ul><p>BitTorrentåè®®æŠŠä¸€ä¸ªæ–‡ä»¶åˆ†æˆå¾ˆå¤šå°æ®µï¼Œç„¶ååˆ†æ®µä¸‹è½½ã€‚</p><ul><li>æ®µå“ˆå¸Œå€¼</li></ul><p>å°†æ•´ä¸ªç§å­ç§ï¼Œæ¯ä¸ªæ®µçš„SHA-1å“ˆå¸Œå€¼æ‹¼åœ¨ä¸€èµ·ã€‚</p><h3 id="2-3-2-ä¸‹è½½è¿‡ç¨‹"><a href="#2-3-2-ä¸‹è½½è¿‡ç¨‹" class="headerlink" title="2.3.2 ä¸‹è½½è¿‡ç¨‹"></a>2.3.2 ä¸‹è½½è¿‡ç¨‹</h3><p>ä¸‹è½½æ—¶ï¼ŒBT å®¢æˆ·ç«¯é¦–å…ˆè§£æ.torrent æ–‡ä»¶ï¼Œå¾—åˆ° tracker åœ°å€ï¼Œç„¶åè¿æ¥ tracker æœåŠ¡å™¨ã€‚tracker æœåŠ¡å™¨å›åº”ä¸‹è½½è€…çš„è¯·æ±‚ï¼Œå°†å…¶ä»–ä¸‹è½½è€…ï¼ˆåŒ…æ‹¬å‘å¸ƒè€…ï¼‰çš„ IP æä¾›ç»™ä¸‹è½½è€…ã€‚ä¸‹è½½è€…å†è¿æ¥å…¶ä»–ä¸‹è½½è€…ï¼Œæ ¹æ®.torrent æ–‡ä»¶ï¼Œä¸¤è€…åˆ†åˆ«å¯¹æ–¹å‘ŠçŸ¥è‡ªå·±å·²ç»æœ‰çš„å—ï¼Œç„¶åäº¤æ¢å¯¹æ–¹æ²¡æœ‰çš„æ•°æ®ã€‚æ­¤æ—¶ä¸éœ€è¦å…¶ä»–æœåŠ¡å™¨å‚ä¸ï¼Œå¹¶åˆ†æ•£äº†å•ä¸ªçº¿è·¯ä¸Šçš„æ•°æ®æµé‡ï¼Œå› æ­¤å‡è½»äº†æœåŠ¡å™¨çš„è´Ÿæ‹…ã€‚</p><p>ä¸‹è½½è€…æ¯å¾—åˆ°ä¸€ä¸ªå—ï¼Œéœ€è¦ç®—å‡ºä¸‹è½½å—çš„ Hash éªŒè¯ç ï¼Œå¹¶ä¸.torrent æ–‡ä»¶ä¸­çš„å¯¹æ¯”ã€‚å¦‚æœä¸€æ ·ï¼Œåˆ™è¯´æ˜å—æ­£ç¡®ï¼Œä¸ä¸€æ ·åˆ™éœ€è¦é‡æ–°ä¸‹è½½è¿™ä¸ªå—ã€‚è¿™ç§è§„å®šæ˜¯ä¸ºäº†è§£å†³ä¸‹è½½å†…å®¹çš„å‡†ç¡®æ€§é—®é¢˜ã€‚</p><p>ä»è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æ–¹å¼ç‰¹åˆ«ä¾èµ– trackerã€‚tracker éœ€è¦æ”¶é›†ä¸‹è½½è€…ä¿¡æ¯çš„æœåŠ¡å™¨ï¼Œå¹¶å°†æ­¤ä¿¡æ¯æä¾›ç»™å…¶ä»–ä¸‹è½½è€…ï¼Œä½¿ä¸‹è½½è€…ä»¬ç›¸äº’è¿æ¥èµ·æ¥ï¼Œä¼ è¾“æ•°æ®ã€‚è™½ç„¶ä¸‹è½½çš„è¿‡ç¨‹æ˜¯éä¸­å¿ƒåŒ–çš„ï¼Œä½†æ˜¯åŠ å…¥è¿™ä¸ª P2P ç½‘ç»œçš„æ—¶å€™ï¼Œéƒ½éœ€è¦å€ŸåŠ© tracker ä¸­å¿ƒæœåŠ¡å™¨ï¼Œè¿™ä¸ªæœåŠ¡å™¨æ˜¯ç”¨æ¥ç™»è®°æœ‰å“ªäº›ç”¨æˆ·åœ¨è¯·æ±‚å“ªäº›èµ„æºã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç§å·¥ä½œæ–¹å¼æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œä¸€æ—¦ tracker æœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–è€…çº¿è·¯é­åˆ°å±è”½ï¼ŒBT å·¥å…·å°±æ— æ³•æ­£å¸¸å·¥ä½œäº†ã€‚</p><h2 id="2-4-å»ä¸­å¿ƒåŒ–ç½‘ç»œ-Distributed-Hash-Table"><a href="#2-4-å»ä¸­å¿ƒåŒ–ç½‘ç»œ-Distributed-Hash-Table" class="headerlink" title="2.4 å»ä¸­å¿ƒåŒ–ç½‘ç»œ(Distributed Hash Table)"></a>2.4 å»ä¸­å¿ƒåŒ–ç½‘ç»œ(Distributed Hash Table)</h2><p>æ¯ä¸ªåŠ å…¥è¿™ä¸ªDHTç½‘ç»œçš„äººéƒ½è¦è´Ÿè´£å­˜å‚¨è¿™ä¸ªç½‘ç»œé‡Œçš„èµ„æºä¿¡æ¯å’Œå…¶å®ƒæˆå‘˜çš„è”ç³»ä¿¡æ¯ï¼Œç›¸å½“äºæ‰€æœ‰äººä¸€èµ·æ„æˆäº†ä¸€ä¸ªåºå¤§çš„åˆ†å¸ƒå¼å­˜å‚¨æ•°æ®åº“ã€‚</p><h3 id="2-4-1-Kademlia-åè®®"><a href="#2-4-1-Kademlia-åè®®" class="headerlink" title="2.4.1 Kademlia åè®®"></a>2.4.1 Kademlia åè®®</h3><p>ä»»ä½•ä¸€ä¸ªBitTorrentå¯åŠ¨ä¹‹åï¼Œéƒ½æœ‰ä¸¤ä¸ªè§’è‰²ï¼šä¸€ä¸ªæ˜¯peerï¼Œç›‘å¬ä¸€ä¸ªTCPç«¯å£ï¼Œç”¨æ¥ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ï¼›å¦ä¸€ä¸ªè§’è‰²DHT nodeï¼Œç›‘å¬ä¸€ä¸ªUDPç«¯å£ï¼Œé€šè¿‡è¿™ä¸ªè§’è‰²ï¼Œè¿™ä¸ªèŠ‚ç‚¹å°±å¯ä»¥åŠ å…¥åˆ°ä¸€ä¸ªDHTç½‘ç»œå½“ä¸­ã€‚</p><p><img src="https://i.loli.net/2020/02/02/573ksTWaqClEcJo.jpg" alt="fig11.jpg"></p><p>åœ¨ DHT ç½‘ç»œé‡Œé¢ï¼Œæ¯ä¸€ä¸ª DHT node éƒ½æœ‰ä¸€ä¸ª IDã€‚è¿™ä¸ª ID æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„ä¸²ã€‚æ¯ä¸ª DHT node éƒ½æœ‰è´£ä»»æŒæ¡ä¸€äº›çŸ¥è¯†ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç´¢å¼•ï¼Œå³å®ƒåº”è¯¥çŸ¥é“æŸäº›æ–‡ä»¶æ—¶ä¿å­˜åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šçš„ï¼Œè¿™äº›ä¿¡æ¯å°±è¶³å¤Ÿäº†ï¼Œè€Œå®ƒè‡ªå·±æœ¬èº«ä¸ä¸€å®šå°±æ˜¯ä¿å­˜è¿™ä¸ªæ–‡ä»¶çš„èŠ‚ç‚¹ã€‚</p><h3 id="2-4-2-å“ˆå¸Œå€¼"><a href="#2-4-2-å“ˆå¸Œå€¼" class="headerlink" title="2.4.2 å“ˆå¸Œå€¼"></a>2.4.2 å“ˆå¸Œå€¼</h3><p>æ¯ä¸ªæ–‡ä»¶å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œè€ŒDHT nodeçš„IDæ˜¯å’Œå“ˆå¸Œå€¼ç›¸åŒé•¿åº¦çš„ä¸²ã€‚</p><p>DHT ç®—æ³•æ˜¯è¿™æ ·è§„å®šçš„ï¼šå¦‚æœä¸€ä¸ªæ–‡ä»¶è®¡ç®—å‡ºä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œåˆ™å’Œè¿™ä¸ªå“ˆå¸Œå€¼ä¸€æ ·çš„é‚£ä¸ª DHT nodeï¼Œå°±æœ‰è´£ä»»çŸ¥é“ä»å“ªé‡Œä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œå³ä¾¿å®ƒè‡ªå·±æ²¡ä¿å­˜è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>å½“ç„¶ä¸ä¸€å®šè¿™ä¹ˆå·§ï¼Œæ€»èƒ½æ‰¾åˆ°å’Œå“ˆå¸Œå€¼ä¸€æ¨¡ä¸€æ ·çš„ï¼Œæœ‰å¯èƒ½ä¸€æ¨¡ä¸€æ ·çš„ DHT node ä¹Ÿä¸‹çº¿äº†ï¼Œæ‰€ä»¥ DHT ç®—æ³•è¿˜è§„å®šï¼šé™¤äº†ä¸€æ¨¡ä¸€æ ·çš„é‚£ä¸ª DHT node åº”è¯¥çŸ¥é“ï¼ŒID å’Œè¿™ä¸ªå“ˆå¸Œå€¼éå¸¸æ¥è¿‘çš„ N ä¸ª DHT node ä¹Ÿåº”è¯¥çŸ¥é“ã€‚</p><p>ä»€ä¹ˆå«å’Œå“ˆå¸Œå€¼æ¥è¿‘å‘¢ï¼Ÿä¾‹å¦‚åªä¿®æ”¹äº†æœ€åä¸€ä½ï¼Œå°±å¾ˆæ¥è¿‘ï¼›ä¿®æ”¹äº†å€’æ•° 2 ä½ï¼Œä¹Ÿä¸è¿œï¼›ä¿®æ”¹äº†å€’æ•° 3 ä½ï¼Œä¹Ÿå¯ä»¥æ¥å—ã€‚æ€»ä¹‹ï¼Œå‡‘é½äº†è§„å®šçš„ N è¿™ä¸ªæ•°å°±è¡Œã€‚</p><p>åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œç§å­.torrent æ–‡ä»¶é‡Œé¢å°±ä¸å†æ˜¯ tracker çš„åœ°å€äº†ï¼Œè€Œæ˜¯ä¸€ä¸ª list çš„ node çš„åœ°å€ï¼Œè€Œæ‰€æœ‰è¿™äº› node éƒ½æ˜¯å·²ç»åœ¨ DHT ç½‘ç»œé‡Œé¢çš„ã€‚å½“ç„¶éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¾ˆå¯èƒ½æœ‰é€€å‡ºçš„ï¼Œæœ‰ä¸‹çº¿çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å‡è®¾ï¼Œä¸ä¼šæ‰€æœ‰çš„éƒ½è”ç³»ä¸ä¸Šï¼Œæ€»æœ‰ä¸€ä¸ªèƒ½è”ç³»ä¸Šã€‚</p><p>node new åªè¦åœ¨ç§å­é‡Œé¢æ‰¾åˆ°ä¸€ä¸ª DHT nodeï¼Œå°±åŠ å…¥äº†ç½‘ç»œã€‚</p><p>node new ä¼šè®¡ç®—æ–‡ä»¶ 1 çš„å“ˆå¸Œå€¼ï¼Œå¹¶æ ¹æ®è¿™ä¸ªå“ˆå¸Œå€¼äº†è§£åˆ°ï¼Œå’Œè¿™ä¸ªå“ˆå¸Œå€¼åŒ¹é…ï¼Œæˆ–è€…å¾ˆæ¥è¿‘çš„ node ä¸ŠçŸ¥é“å¦‚ä½•ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼å°±æ˜¯ node Cã€‚</p><p>ä½†æ˜¯ node new ä¸çŸ¥é“æ€ä¹ˆè”ç³»ä¸Š node Cï¼Œå› ä¸ºç§å­é‡Œé¢çš„ node åˆ—è¡¨é‡Œé¢å¾ˆå¯èƒ½æ²¡æœ‰ node Cï¼Œä½†æ˜¯å®ƒå¯ä»¥é—®ï¼ŒDHT ç½‘ç»œç‰¹åˆ«åƒä¸€ä¸ªç¤¾äº¤ç½‘ç»œï¼Œnode new åªæœ‰å»å®ƒèƒ½è”ç³»ä¸Šçš„ node é—®ï¼Œä½ ä»¬çŸ¥é“ä¸çŸ¥é“ node C çš„è”ç³»æ–¹å¼å‘€ï¼Ÿ</p><p>åœ¨ DHT ç½‘ç»œä¸­ï¼Œæ¯ä¸ª node éƒ½ä¿å­˜äº†ä¸€å®šçš„è”ç³»æ–¹å¼ï¼Œä½†æ˜¯è‚¯å®šæ²¡æœ‰ node çš„æ‰€æœ‰è”ç³»æ–¹å¼ã€‚DHT ç½‘ç»œä¸­ï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡äº’ç›¸é€šä¿¡ï¼Œä¹Ÿä¼šäº¤æµè”ç³»æ–¹å¼ï¼Œä¹Ÿä¼šåˆ é™¤è”ç³»æ–¹å¼ã€‚</p><p>åœ¨ node C ä¸Šï¼Œå‘Šè¯‰ node newï¼Œä¸‹è½½æ–‡ä»¶ 1ï¼Œè¦å» Bã€Dã€ Fï¼Œäºæ˜¯ node new é€‰æ‹©å’Œ node B è¿›è¡Œ peer è¿æ¥ï¼Œå¼€å§‹ä¸‹è½½ï¼Œå®ƒä¸€æ—¦å¼€å§‹ä¸‹è½½ï¼Œè‡ªå·±æœ¬åœ°ä¹Ÿæœ‰æ–‡ä»¶ 1 äº†ï¼Œäºæ˜¯ node new å‘Šè¯‰ node C ä»¥åŠå’Œ node C çš„ ID å¾ˆåƒçš„é‚£äº›èŠ‚ç‚¹ï¼Œæˆ‘ä¹Ÿæœ‰æ–‡ä»¶ 1 äº†ï¼Œå¯ä»¥åŠ å…¥é‚£ä¸ªæ–‡ä»¶æ‹¥æœ‰è€…åˆ—è¡¨äº†ã€‚</p><p>ä½†æ˜¯ä½ ä¼šå‘ç° node new ä¸Šæ²¡æœ‰æ–‡ä»¶ç´¢å¼•ï¼Œä½†æ˜¯æ ¹æ®å“ˆå¸Œç®—æ³•ï¼Œä¸€å®šä¼šæœ‰æŸäº›æ–‡ä»¶çš„å“ˆå¸Œå€¼æ˜¯å’Œ node new çš„ ID åŒ¹é…ä¸Šçš„ã€‚åœ¨ DHT ç½‘ç»œä¸­ï¼Œä¼šæœ‰èŠ‚ç‚¹å‘Šè¯‰å®ƒï¼Œä½ æ—¢ç„¶åŠ å…¥äº†å’±ä»¬è¿™ä¸ªç½‘ç»œï¼Œä½ ä¹Ÿæœ‰è´£ä»»çŸ¥é“æŸäº›æ–‡ä»¶çš„ä¸‹è½½åœ°å€ã€‚</p><h1 id="3-DNS"><a href="#3-DNS" class="headerlink" title="3. DNS"></a>3. DNS</h1><h2 id="3-1-DNSæœåŠ¡å™¨"><a href="#3-1-DNSæœåŠ¡å™¨" class="headerlink" title="3.1 DNSæœåŠ¡å™¨"></a>3.1 DNSæœåŠ¡å™¨</h2><p>DNSæœåŠ¡å™¨å¾ˆé‡è¦ï¼Œæ ¹æ®åç§°æ¥æŸ¥æ‰¾å¯¹åº”çš„IPåœ°å€çš„åè®®ã€‚DNSæœåŠ¡å™¨ï¼Œä¸€å®šè¦è®¾ç½®æˆé«˜å¯ç”¨ã€é«˜å¹¶å‘å’Œåˆ†å¸ƒå¼çš„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/7nKk5iPVNmQRdot.jpg" alt="fig12.jpg"></p><ul><li>æ ¹DNSæœåŠ¡å™¨ï¼šè¿”å›é¡¶çº§åŸŸDNSæœåŠ¡å™¨çš„IPåœ°å€</li><li>é¡¶çº§åŸŸDNSæœåŠ¡å™¨ï¼šè¿”å›æƒå¨DNSæœåŠ¡å™¨çš„IPåœ°å€</li><li>æƒå¨DNSæœåŠ¡å™¨ï¼šè¿”å›ç›¸åº”ä¸»æœºçš„IPåœ°å€</li></ul><h2 id="3-2-DNSè§£ææµç¨‹"><a href="#3-2-DNSè§£ææµç¨‹" class="headerlink" title="3.2 DNSè§£ææµç¨‹"></a>3.2 DNSè§£ææµç¨‹</h2><p><img src="https://i.loli.net/2020/02/02/oRQapO7AxS3jKqt.jpg" alt="fig13.jpg"></p><ol><li>ç”µè„‘å®¢æˆ·ç«¯ä¼šå‘å‡ºä¸€ä¸ª DNS è¯·æ±‚ï¼Œé—® <a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> çš„ IP æ˜¯å•¥å•Šï¼Œå¹¶å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ (æœ¬åœ° DNS)ã€‚é‚£æœ¬åœ°åŸŸåæœåŠ¡å™¨ (æœ¬åœ° DNS) æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœæ˜¯é€šè¿‡ DHCP é…ç½®ï¼Œæœ¬åœ° DNS ç”±ä½ çš„ç½‘ç»œæœåŠ¡å•†ï¼ˆISPï¼‰ï¼Œå¦‚ç”µä¿¡ã€ç§»åŠ¨ç­‰è‡ªåŠ¨åˆ†é…ï¼Œå®ƒé€šå¸¸å°±åœ¨ä½ ç½‘ç»œæœåŠ¡å•†çš„æŸä¸ªæœºæˆ¿ã€‚</li><li>æœ¬åœ° DNS æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ä½ å¯ä»¥æƒ³è±¡è¿™å°æœåŠ¡å™¨ä¸Šç¼“å­˜äº†ä¸€å¼ åŸŸåä¸ä¹‹å¯¹åº” IP åœ°å€çš„å¤§è¡¨æ ¼ã€‚å¦‚æœèƒ½æ‰¾åˆ° <a href="http://www.163.comï¼Œå®ƒç›´æ¥å°±è¿”å›" target="_blank" rel="noopener">www.163.comï¼Œå®ƒç›´æ¥å°±è¿”å›</a> IP åœ°å€ã€‚å¦‚æœæ²¡æœ‰ï¼Œæœ¬åœ° DNS ä¼šå»é—®å®ƒçš„æ ¹åŸŸåæœåŠ¡å™¨ï¼šâ€œè€å¤§ï¼Œèƒ½å‘Šè¯‰æˆ‘ <a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> çš„ IP åœ°å€å—ï¼Ÿâ€æ ¹åŸŸåæœåŠ¡å™¨æ˜¯æœ€é«˜å±‚æ¬¡çš„ï¼Œå…¨çƒå…±æœ‰ 13 å¥—ã€‚å®ƒä¸ç›´æ¥ç”¨äºåŸŸåè§£æï¼Œä½†èƒ½æŒ‡æ˜ä¸€æ¡é“è·¯ã€‚</li><li>æ ¹ DNS æ”¶åˆ°æ¥è‡ªæœ¬åœ° DNS çš„è¯·æ±‚ï¼Œå‘ç°åç¼€æ˜¯ .comï¼Œè¯´ï¼šâ€œå“¦ï¼Œ<a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> å•Šï¼Œè¿™ä¸ªåŸŸåæ˜¯ç”±.com åŒºåŸŸç®¡ç†ï¼Œæˆ‘ç»™ä½ å®ƒçš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼Œä½ å»é—®é—®å®ƒå§ã€‚â€</li><li>æœ¬åœ° DNS è½¬å‘é—®é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼šâ€œè€äºŒï¼Œä½ èƒ½å‘Šè¯‰æˆ‘ <a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> çš„ IP åœ°å€å—ï¼Ÿâ€é¡¶çº§åŸŸåæœåŠ¡å™¨å°±æ˜¯å¤§åé¼é¼çš„æ¯”å¦‚ .comã€.netã€ .org è¿™äº›ä¸€çº§åŸŸåï¼Œå®ƒè´Ÿè´£ç®¡ç†äºŒçº§åŸŸåï¼Œæ¯”å¦‚ 163.comï¼Œæ‰€ä»¥å®ƒèƒ½æä¾›ä¸€æ¡æ›´æ¸…æ™°çš„æ–¹å‘ã€‚</li><li>é¡¶çº§åŸŸåæœåŠ¡å™¨è¯´ï¼šâ€œæˆ‘ç»™ä½ è´Ÿè´£ <a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> åŒºåŸŸçš„æƒå¨ DNS æœåŠ¡å™¨çš„åœ°å€ï¼Œä½ å»é—®å®ƒåº”è¯¥èƒ½é—®åˆ°ã€‚â€</li><li>æœ¬åœ° DNS è½¬å‘é—®æƒå¨ DNS æœåŠ¡å™¨ï¼šâ€œæ‚¨å¥½ï¼Œ<a href="http://www.163.com" target="_blank" rel="noopener">www.163.com</a> å¯¹åº”çš„ IP æ˜¯å•¥å‘€ï¼Ÿâ€163.com çš„æƒå¨ DNS æœåŠ¡å™¨ï¼Œå®ƒæ˜¯åŸŸåè§£æç»“æœçš„åŸå‡ºå¤„ã€‚ä¸ºå•¥å«æƒå¨å‘¢ï¼Ÿå°±æ˜¯æˆ‘çš„åŸŸåæˆ‘åšä¸»ã€‚</li><li>æƒé™ DNS æœåŠ¡å™¨æŸ¥è¯¢åå°†å¯¹åº”çš„ IP åœ°å€ X.X.X.X å‘Šè¯‰æœ¬åœ° DNSã€‚</li><li>æœ¬åœ° DNS å†å°† IP åœ°å€è¿”å›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å’Œç›®æ ‡å»ºç«‹è¿æ¥ã€‚</li></ol><h2 id="3-3-DNS-è´Ÿè½½å‡è¡¡"><a href="#3-3-DNS-è´Ÿè½½å‡è¡¡" class="headerlink" title="3.3 DNS è´Ÿè½½å‡è¡¡"></a>3.3 DNS è´Ÿè½½å‡è¡¡</h2><p>DNSé€šè¿‡åç§°æ˜ å°„ä¸ºIPåœ°å€çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šéƒ½æ˜ å°„åˆ°åŒä¸€ä¸ªIPåœ°å€ï¼Œä¼šæ ¹æ®è·ç¦»é€‰æ‹©æœ€è¿‘çš„ã€‚</p><h3 id="3-3-1-DNSå†…éƒ¨è´Ÿè½½å‡è¡¡"><a href="#3-3-1-DNSå†…éƒ¨è´Ÿè½½å‡è¡¡" class="headerlink" title="3.3.1 DNSå†…éƒ¨è´Ÿè½½å‡è¡¡"></a>3.3.1 DNSå†…éƒ¨è´Ÿè½½å‡è¡¡</h3><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªåº”ç”¨è¦è®¿é—®æ•°æ®åº“ï¼Œåœ¨è¿™ä¸ªåº”ç”¨é‡Œé¢åº”è¯¥é…ç½®è¿™ä¸ªæ•°æ®åº“çš„ IP åœ°å€ï¼Œè¿˜æ˜¯åº”è¯¥é…ç½®è¿™ä¸ªæ•°æ®åº“çš„åŸŸåå‘¢ï¼Ÿæ˜¾ç„¶åº”è¯¥é…ç½®åŸŸåï¼Œå› ä¸ºä¸€æ—¦è¿™ä¸ªæ•°æ®åº“ï¼Œå› ä¸ºæŸç§åŸå› ï¼Œæ¢åˆ°äº†å¦å¤–ä¸€å°æœºå™¨ä¸Šï¼Œè€Œå¦‚æœæœ‰å¤šä¸ªåº”ç”¨éƒ½é…ç½®äº†è¿™å°æ•°æ®åº“çš„è¯ï¼Œä¸€æ¢ IP åœ°å€ï¼Œå°±éœ€è¦å°†è¿™äº›åº”ç”¨å…¨éƒ¨ä¿®æ”¹ä¸€éã€‚ä½†æ˜¯å¦‚æœé…ç½®äº†åŸŸåï¼Œåˆ™åªè¦åœ¨ DNS æœåŠ¡å™¨é‡Œï¼Œå°†åŸŸåæ˜ å°„ä¸ºæ–°çš„ IP åœ°å€ï¼Œè¿™ä¸ªå·¥ä½œå°±å®Œæˆäº†ï¼Œå¤§å¤§ç®€åŒ–äº†è¿ç»´ã€‚</p><p>éƒ½å°½é‡ç”¨åŸŸåè¿›è¡Œé…ç½®ï¼Œç„¶åå°±å¯ä»¥åœ¨DNSå±‚é¢ä¸Šå¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œæ¯”å¦‚è½®è¯¢ä¸åŒçš„IPåœ°å€ï¼Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚</p><h3 id="3-3-2-å…¨å±€è´Ÿè½½å‡è¡¡"><a href="#3-3-2-å…¨å±€è´Ÿè½½å‡è¡¡" class="headerlink" title="3.3.2 å…¨å±€è´Ÿè½½å‡è¡¡"></a>3.3.2 å…¨å±€è´Ÿè½½å‡è¡¡</h3><p>ä¸ºäº†ä¿è¯æˆ‘ä»¬çš„åº”ç”¨é«˜å¯ç”¨ï¼Œå¾€å¾€ä¼šéƒ¨ç½²åœ¨å¤šä¸ªæœºæˆ¿ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½ä¼šæœ‰è‡ªå·±çš„ IP åœ°å€ã€‚å½“ç”¨æˆ·è®¿é—®æŸä¸ªåŸŸåçš„æ—¶å€™ï¼Œè¿™ä¸ª IP åœ°å€å¯ä»¥è½®è¯¢è®¿é—®å¤šä¸ªæ•°æ®ä¸­å¿ƒã€‚å¦‚æœä¸€ä¸ªæ•°æ®ä¸­å¿ƒå› ä¸ºæŸç§åŸå› æŒ‚äº†ï¼Œåªè¦åœ¨ DNS æœåŠ¡å™¨é‡Œé¢ï¼Œå°†è¿™ä¸ªæ•°æ®ä¸­å¿ƒå¯¹åº”çš„ IP åœ°å€åˆ é™¤ï¼Œå°±å¯ä»¥å®ç°ä¸€å®šçš„é«˜å¯ç”¨ã€‚</p><h3 id="3-3-3-DNSè®¿é—®æ•°æ®ä¸­å¿ƒä¸­å¯¹è±¡å­˜å‚¨ä¸Šçš„é™æ€èµ„æº"><a href="#3-3-3-DNSè®¿é—®æ•°æ®ä¸­å¿ƒä¸­å¯¹è±¡å­˜å‚¨ä¸Šçš„é™æ€èµ„æº" class="headerlink" title="3.3.3 DNSè®¿é—®æ•°æ®ä¸­å¿ƒä¸­å¯¹è±¡å­˜å‚¨ä¸Šçš„é™æ€èµ„æº"></a>3.3.3 DNSè®¿é—®æ•°æ®ä¸­å¿ƒä¸­å¯¹è±¡å­˜å‚¨ä¸Šçš„é™æ€èµ„æº</h3><p>æˆ‘ä»¬é€šè¿‡ DNS è®¿é—®æ•°æ®ä¸­å¿ƒä¸­å¯¹è±¡å­˜å‚¨ä¸Šçš„é™æ€èµ„æºä¸ºä¾‹ï¼Œçœ‹ä¸€çœ‹æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p>å‡è®¾å…¨å›½æœ‰å¤šä¸ªæ•°æ®ä¸­å¿ƒï¼Œæ‰˜ç®¡åœ¨å¤šä¸ªè¿è¥å•†ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒä¸‰ä¸ªå¯ç”¨åŒºï¼ˆAvailable Zoneï¼‰ã€‚å¯¹è±¡å­˜å‚¨é€šè¿‡è·¨å¯ç”¨åŒºéƒ¨ç½²ï¼Œå®ç°é«˜å¯ç”¨æ€§ã€‚åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒä¸­ï¼Œéƒ½è‡³å°‘éƒ¨ç½²ä¸¤ä¸ªå†…éƒ¨è´Ÿè½½å‡è¡¡å™¨ï¼Œå†…éƒ¨è´Ÿè½½å‡è¡¡å™¨åé¢å¯¹æ¥å¤šä¸ªå¯¹è±¡å­˜å‚¨çš„å‰ç½®æœåŠ¡å™¨ï¼ˆProxy-serverï¼‰ã€‚</p><p><img src="https://i.loli.net/2020/02/02/ZJqxP9mMeatDEjo.jpg" alt="fig14.jpg"></p><ol><li>å½“ä¸€ä¸ªå®¢æˆ·ç«¯è¦è®¿é—® object.yourcompany.com çš„æ—¶å€™ï¼Œéœ€è¦å°†åŸŸåè½¬æ¢ä¸º IP åœ°å€è¿›è¡Œè®¿é—®ï¼Œæ‰€ä»¥å®ƒè¦è¯·æ±‚æœ¬åœ° DNS è§£æå™¨ã€‚</li><li>æœ¬åœ° DNS è§£æå™¨å…ˆæŸ¥çœ‹çœ‹æœ¬åœ°çš„ç¼“å­˜æ˜¯å¦æœ‰è¿™ä¸ªè®°å½•ã€‚å¦‚æœæœ‰åˆ™ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºä¸Šé¢çš„è¿‡ç¨‹å¤ªå¤æ‚äº†ï¼Œå¦‚æœæ¯æ¬¡éƒ½è¦é€’å½’è§£æï¼Œå°±å¤ªéº»çƒ¦äº†ã€‚</li><li>å¦‚æœæœ¬åœ°æ— ç¼“å­˜ï¼Œåˆ™éœ€è¦è¯·æ±‚æœ¬åœ°çš„ DNS æœåŠ¡å™¨ã€‚</li><li>æœ¬åœ°çš„ DNS æœåŠ¡å™¨ä¸€èˆ¬éƒ¨ç½²åœ¨ä½ çš„æ•°æ®ä¸­å¿ƒæˆ–è€…ä½ æ‰€åœ¨çš„è¿è¥å•†çš„ç½‘ç»œä¸­ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨ä¹Ÿéœ€è¦çœ‹æœ¬åœ°æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå¦‚æœæœ‰åˆ™è¿”å›ï¼Œå› ä¸ºå®ƒä¹Ÿä¸æƒ³æŠŠä¸Šé¢çš„é€’å½’è¿‡ç¨‹å†èµ°ä¸€éã€‚</li><li>è‡³ 7. å¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œæœ¬åœ° DNS æ‰éœ€è¦é€’å½’åœ°ä»æ ¹ DNS æœåŠ¡å™¨ï¼ŒæŸ¥åˆ°.com çš„é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œæœ€ç»ˆæŸ¥åˆ° yourcompany.com çš„æƒå¨ DNS æœåŠ¡å™¨ï¼Œç»™æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œæƒå¨ DNS æœåŠ¡å™¨æŒ‰è¯´ä¼šè¿”å›çœŸå®è¦è®¿é—®çš„ IP åœ°å€ã€‚</li></ol><p>å¯¹äºä¸éœ€è¦è¿›è¡Œå…¨å±€è´Ÿè½½å‡è¡¡çš„ç®€å•åº”ç”¨æ¥è®²ï¼Œæƒå¨DNSæœåŠ¡å™¨å°±å¯ä»¥ç›´æ¥å°†åŸŸåè§£æä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªIPåœ°å€ï¼Œç„¶åå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡å¤šä¸ªIPåœ°å€è¿›è¡Œç®€å•çš„è½®è¯¢ï¼Œå®ç°ç®€å•çš„è´Ÿè½½å‡è¡¡ã€‚</p><p>ä½†æ˜¯å¯¹äºå¤æ‚çš„åº”ç”¨ï¼Œå°¤å…¶æ˜¯è·¨åœ°åŸŸè¿è¥å•†çš„å¤§å‹åº”ç”¨ï¼Œéœ€è¦ä¸“é—¨çš„è®¾å¤‡æˆ–è€…æœåŠ¡å™¨æ¥åšè¿™ä»¶äº‹æƒ…ï¼Œè¿™å°±æ˜¯å…¨å±€è´Ÿè½½å‡è¡¡å™¨ã€‚(GSLB, Global Server Load Balance)</p><p>åœ¨ yourcompany.com çš„ DNS æœåŠ¡å™¨ä¸­ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡é…ç½® CNAME çš„æ–¹å¼ï¼Œç»™ object.yourcompany.com èµ·ä¸€ä¸ªåˆ«åï¼Œä¾‹å¦‚ object.vip.yourcomany.comï¼Œç„¶åå‘Šè¯‰æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œè®©å®ƒè¯·æ±‚ GSLB è§£æè¿™ä¸ªåŸŸåï¼ŒGSLB å°±å¯ä»¥åœ¨è§£æè¿™ä¸ªåŸŸåçš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡è‡ªå·±çš„ç­–ç•¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p><ol><li>ç¬¬ä¸€å±‚ GSLBï¼Œé€šè¿‡æŸ¥çœ‹è¯·æ±‚å®ƒçš„æœ¬åœ° DNS æœåŠ¡å™¨æ‰€åœ¨çš„è¿è¥å•†ï¼Œå°±çŸ¥é“ç”¨æˆ·æ‰€åœ¨çš„è¿è¥å•†ã€‚å‡è®¾æ˜¯ç§»åŠ¨ï¼Œé€šè¿‡ CNAME çš„æ–¹å¼ï¼Œé€šè¿‡å¦ä¸€ä¸ªåˆ«å object.yd.yourcompany.comï¼Œå‘Šè¯‰æœ¬åœ° DNS æœåŠ¡å™¨å»è¯·æ±‚ç¬¬äºŒå±‚çš„ GSLBã€‚</li><li>ç¬¬äºŒå±‚ GSLBï¼Œé€šè¿‡æŸ¥çœ‹è¯·æ±‚å®ƒçš„æœ¬åœ° DNS æœåŠ¡å™¨æ‰€åœ¨çš„åœ°å€ï¼Œå°±çŸ¥é“ç”¨æˆ·æ‰€åœ¨çš„åœ°ç†ä½ç½®ï¼Œç„¶åå°†è·ç¦»ç”¨æˆ·ä½ç½®æ¯”è¾ƒè¿‘çš„ Region é‡Œé¢ï¼Œå…­ä¸ªå†…éƒ¨è´Ÿè½½å‡è¡¡çš„åœ°å€è¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å°†ç»“æœè¿”å›ç»™æœ¬åœ°DNSè§£æå™¨</li><li>æœ¬åœ°DNSè§£æå™¨å°†ç»“æœç¼“å­˜åï¼Œè¿”å›ç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯å¼€å§‹è®¿é—®å±äºç›¸åŒè¿è¥å•†çš„è·ç¦»è¾ƒè¿‘çš„ Region 1 ä¸­çš„å¯¹è±¡å­˜å‚¨ï¼Œå½“ç„¶å®¢æˆ·ç«¯å¾—åˆ°äº†å…­ä¸ª IP åœ°å€ï¼Œå®ƒå¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼ï¼Œéšæœºæˆ–è€…è½®è¯¢é€‰æ‹©ä¸€ä¸ªå¯ç”¨åŒºè¿›è¡Œè®¿é—®ã€‚å¯¹è±¡å­˜å‚¨ä¸€èˆ¬ä¼šæœ‰ä¸‰ä¸ªå¤‡ä»½ï¼Œä»è€Œå¯ä»¥å®ç°å¯¹å­˜å‚¨è¯»å†™çš„è´Ÿè½½å‡è¡¡ã€‚</li></ol><h2 id="3-4-DNSåŠŸèƒ½"><a href="#3-4-DNSåŠŸèƒ½" class="headerlink" title="3.4 DNSåŠŸèƒ½"></a>3.4 DNSåŠŸèƒ½</h2><ol><li>æ ¹æ®åç§°æ‰¾å…·ä½“åœ°å€</li><li>é’ˆå¯¹å¤šä¸ªåœ°å€åšè´Ÿè½½å‡è¡¡</li></ol><p>åœ¨å¤šä¸ªåœ°å€ä¸­é€‰æ‹©ä¸€ä¸ªè·ç¦»ä½ è¿‘çš„åœ°æ–¹è®¿é—®ã€‚</p><h2 id="3-5-ä¼ ç»ŸDNSçš„é—®é¢˜"><a href="#3-5-ä¼ ç»ŸDNSçš„é—®é¢˜" class="headerlink" title="3.5 ä¼ ç»ŸDNSçš„é—®é¢˜"></a>3.5 ä¼ ç»ŸDNSçš„é—®é¢˜</h2><h3 id="3-5-1-åŸŸåç¼“å­˜é—®é¢˜"><a href="#3-5-1-åŸŸåç¼“å­˜é—®é¢˜" class="headerlink" title="3.5.1 åŸŸåç¼“å­˜é—®é¢˜"></a>3.5.1 åŸŸåç¼“å­˜é—®é¢˜</h3><p>DNSä¼šå¯¹åŸŸååšç¼“å­˜ï¼Œåœ¨è®¿é—®è¿‡ä¸€æ¬¡ä»¥åä¼šæŠŠç»“æœç¼“å­˜åˆ°æœ¬åœ°ï¼Œå½“å…¶ä»–äººæ¥é—®çš„æ—¶å€™ï¼Œç›´æ¥å°±è¿”å›è¿™ä¸ªç¼“å­˜æ•°æ®ã€‚æŸäº›è¿è¥å•†ä¼šå°†é™æ€é¡µé¢ç¼“å­˜åˆ°æœ¬è¿è¥å•†çš„æœåŠ¡å™¨å†…ï¼Œè¿™æ ·ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¸ç”¨è·¨è¿è¥å•†è¿›è¡Œè®¿é—®äº†ã€‚æ—¢åŠ å¿«äº†é€Ÿåº¦ï¼Œä¹Ÿå‡å°‘äº†è¿è¥å•†ä¹‹é—´æµé‡è®¡ç®—çš„æˆæœ¬ã€‚ åœ¨åšåŸŸåè§£æçš„æ—¶å€™ï¼Œ<strong>ä¸ä¼šå°†ç”¨æˆ·å¯¼å‘çœŸæ­£çš„ç½‘å€ï¼Œè€Œæ˜¯æŒ‡å‘è¿™ä¸ªç¼“å­˜çš„æœåŠ¡å™¨ã€‚</strong></p><p>è¿˜æœ‰å°±æ˜¯æœ¬åœ°çš„ç¼“å­˜å¾€å¾€ä¼šä½¿å…¨å±€è´Ÿè½½å¤±è´¥ï¼Œå› ä¸ºä¸Šæ¬¡è¿›è¡Œç¼“å­˜çš„æ—¶å€™ï¼Œç¼“å­˜ä¸­çš„åœ°å€ä¸ä¸€å®šæ˜¯è¿™æ¬¡è®¿é—®ç¦»å®¢æˆ·æœ€è¿‘çš„åœ°æ–¹ã€‚</p><h3 id="3-5-2-åŸŸåè½¬å‘é—®é¢˜"><a href="#3-5-2-åŸŸåè½¬å‘é—®é¢˜" class="headerlink" title="3.5.2 åŸŸåè½¬å‘é—®é¢˜"></a>3.5.2 åŸŸåè½¬å‘é—®é¢˜</h3><p>è¿è¥å•†å¯èƒ½ä¸æ˜¯ç›´æ¥å’ŒDNSæœåŠ¡å™¨äº¤æµçš„ï¼Œå¯èƒ½ç”¨è½¬å‘ç»™äº†å…¶ä»–çš„åšè§£æï¼Œè‡ªå·±åªæ˜¯å¤–åŒ…äº†å‡ºå»ã€‚</p><h3 id="3-5-3-å‡ºå£NATé—®é¢˜"><a href="#3-5-3-å‡ºå£NATé—®é¢˜" class="headerlink" title="3.5.3 å‡ºå£NATé—®é¢˜"></a>3.5.3 å‡ºå£NATé—®é¢˜</h3><p>ç½‘ç»œåœ°å€è½¬æ¢ï¼Œä½¿å¾—ä»ç½‘å…³å‡ºå»çš„åŒ…éƒ½æ¢æˆäº†æ–°çš„IPåœ°å€ï¼Œå½“è¯·æ±‚è¿”å›çš„æ—¶å€™ï¼Œåœ¨è¿™ä¸ªç½‘å…³ï¼Œå†å°†IPåœ°å€è½¬æ¢å›å»ã€‚ä½†ä¸€æ—¦åšäº†ç½‘ç»œåœ°å€è½¬æ¢ï¼Œæƒå¨DNSæœåŠ¡å™¨å°±æ²¡æ³•é€šè¿‡è¿™ä¸ªåœ°å€æ¥åˆ¤æ–­å®¢æˆ·åˆ°åº•æ¥è‡ªå“ªä¸ªè¿è¥å•†ï¼Œææœ‰å¯èƒ½è¯¯åˆ¤è¿è¥å•†ï¼Œå¯¼è‡´è·¨è¿è¥å•†çš„è®¿é—®</p><h3 id="3-5-4-åŸŸåæ›´æ–°é—®é¢˜"><a href="#3-5-4-åŸŸåæ›´æ–°é—®é¢˜" class="headerlink" title="3.5.4 åŸŸåæ›´æ–°é—®é¢˜"></a>3.5.4 åŸŸåæ›´æ–°é—®é¢˜</h3><p>æœ¬åœ° DNS æœåŠ¡å™¨æ˜¯ç”±ä¸åŒåœ°åŒºã€ä¸åŒè¿è¥å•†ç‹¬ç«‹éƒ¨ç½²çš„ã€‚å¯¹åŸŸåè§£æç¼“å­˜çš„å¤„ç†ä¸Šï¼Œå®ç°ç­–ç•¥ä¹Ÿæœ‰åŒºåˆ«ï¼Œæœ‰çš„ä¼šå·æ‡’ï¼Œå¿½ç•¥åŸŸåè§£æç»“æœçš„ TTL æ—¶é—´é™åˆ¶ï¼Œåœ¨æƒå¨ DNS æœåŠ¡å™¨è§£æå˜æ›´çš„æ—¶å€™ï¼Œè§£æç»“æœåœ¨å…¨ç½‘ç”Ÿæ•ˆçš„å‘¨æœŸéå¸¸æ¼«é•¿ã€‚ä½†æ˜¯æœ‰çš„æ—¶å€™ï¼Œåœ¨ DNS çš„åˆ‡æ¢ä¸­ï¼Œåœºæ™¯å¯¹ç”Ÿæ•ˆæ—¶é—´è¦æ±‚æ¯”è¾ƒé«˜ã€‚</p><p>ä¾‹å¦‚åŒæœºæˆ¿éƒ¨ç½²çš„æ—¶å€™ï¼Œè·¨æœºæˆ¿çš„è´Ÿè½½å‡è¡¡å’Œå®¹ç¾å¤šä½¿ç”¨ DNS æ¥åšã€‚å½“ä¸€ä¸ªæœºæˆ¿å‡ºé—®é¢˜ä¹‹åï¼Œéœ€è¦ä¿®æ”¹æƒå¨ DNSï¼Œå°†åŸŸåæŒ‡å‘æ–°çš„ IP åœ°å€ï¼Œä½†æ˜¯å¦‚æœæ›´æ–°å¤ªæ…¢ï¼Œé‚£å¾ˆå¤šç”¨æˆ·éƒ½ä¼šå‡ºç°è®¿é—®å¼‚å¸¸ã€‚</p><h2 id="3-6-HTTPDNS"><a href="#3-6-HTTPDNS" class="headerlink" title="3.6 HTTPDNS"></a>3.6 HTTPDNS</h2><p>HTTPDNSå°±æ˜¯ä¸èµ°ä¼ ç»Ÿçš„DNSè§£æï¼Œè€Œæ˜¯è‡ªå·±æ­å»ºåŸºäºHTTPåè®®çš„DNSæœåŠ¡å™¨é›†ç¾¤ï¼Œåˆ†å¸ƒåœ¨å¤šä¸ªåœ°ç‚¹å’Œå¤šä¸ªè¿è¥å•†ã€‚å½“å®¢æˆ·ç«¯éœ€è¦DNSè§£æçš„æ—¶å€™ï¼Œç›´æ¥é€šè¿‡HTTPåè®®è¿›è¡Œè¯·æ±‚è¿™ä¸ªæœåŠ¡å™¨é›†ç¾¤ï¼Œå¾—åˆ°å°±è¿‘çš„åœ°å€ã€‚å¤§éƒ¨åˆ†åº”ç”¨åœ¨æ‰‹æœºä¸­ï¼Œåœ¨æ‰‹æœºç«¯åµŒå…¥æ”¯æŒHTTPDNSçš„å®¢æˆ·ç«¯SDKæ¥è¿›è¡Œä½¿ç”¨ã€‚ </p><h1 id="4-CDN"><a href="#4-CDN" class="headerlink" title="4. CDN"></a>4. CDN</h1><p>å½“ä¸€ä¸ªç”¨æˆ·æƒ³è®¿é—®ä¸€ä¸ªç½‘å€çš„æ—¶å€™ï¼ŒæŒ‡å®šè¿™ä¸ªç½‘ç«™çš„åŸŸåï¼ŒDNSå°±ä¼šå°†è¿™ä¸ªåŸŸåè§£æä¸ºåœ°å€ï¼Œç„¶åç”¨æˆ·è¯·æ±‚è¿™ä¸ªåœ°å€ï¼Œè¿”å›ä¸€ä¸ªç½‘é¡µã€‚</p><p>ä½†æ˜¯è¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼š </p><p>å€Ÿé‰´å¿«é€’çš„å°±è¿‘é…é€çš„åŸåˆ™/æ€è·¯ï¼Œåœ¨æ•°æ®ä¸­å¿ƒé‡Œéƒ¨ç½²å‡ å°æœºå™¨ï¼Œå½¢æˆä¸€ä¸ªç¼“å­˜çš„é›†ç¾¤æ¥ç¼“å­˜éƒ¨åˆ†æ•°æ®ã€‚ </p><p>è¿™äº›åˆ†å¸ƒåœ¨å„ä¸ªåœ°æ–¹çš„å„ä¸ªæ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹ï¼Œç§°ä¸ºè¾¹ç¼˜èŠ‚ç‚¹ã€‚</p><p>ç”±äºè¾¹ç¼˜èŠ‚ç‚¹æ•°ç›®æ¯”è¾ƒå¤šï¼Œä½†æ˜¯æ¯ä¸ªé›†ç¾¤è§„æ¨¡æ¯”è¾ƒå°ï¼Œä¸å¯èƒ½ç¼“å­˜ä¸‹æ¥æ‰€æœ‰ä¸œè¥¿ï¼Œå› è€Œå¯èƒ½æ— æ³•å‘½ä¸­ï¼Œè¿™æ ·å°±ä¼šåœ¨è¾¹ç¼˜èŠ‚ç‚¹ä¹‹ä¸Šã€‚æœ‰åŒºåŸŸèŠ‚ç‚¹ï¼Œè§„æ¨¡å°±è¦æ›´å¤§ï¼Œç¼“å­˜çš„æ•°æ®ä¼šæ›´å¤šï¼Œå‘½ä¸­çš„æ¦‚ç‡ä¹Ÿå°±æ›´å¤§ã€‚åœ¨åŒºåŸŸèŠ‚ç‚¹ä¹‹ä¸Šæ˜¯ä¸­å¿ƒèŠ‚ç‚¹ï¼Œè§„æ¨¡æ›´å¤§ï¼Œç¼“å­˜æ•°æ®æ›´å¤šã€‚å¦‚æœè¿˜ä¸å‘½ä¸­ï¼Œå°±åªå¥½å›æºç½‘ç«™è®¿é—®äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/71hNwRIfryiuJHb.jpg" alt="fig15.jpg"></p><p>åœ¨æ²¡æœ‰CDNçš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å‘æµè§ˆå™¨è¾“å…¥ <a href="http://www.web.com" target="_blank" rel="noopener">www.web.com</a> è¿™ä¸ªåŸŸåï¼Œå®¢æˆ·ç«¯è®¿é—®æœ¬åœ° DNS æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå¦‚æœæœ¬åœ° DNS æœåŠ¡å™¨æœ‰ç¼“å­˜ï¼Œåˆ™è¿”å›ç½‘ç«™çš„åœ°å€ï¼›å¦‚æœæ²¡æœ‰ï¼Œé€’å½’æŸ¥è¯¢åˆ°ç½‘ç«™çš„æƒå¨ DNS æœåŠ¡å™¨ï¼Œè¿™ä¸ªæƒå¨ DNS æœåŠ¡å™¨æ˜¯è´Ÿè´£ web.com çš„ï¼Œå®ƒä¼šè¿”å›ç½‘ç«™çš„ IP åœ°å€ã€‚æœ¬åœ° DNS æœåŠ¡å™¨ç¼“å­˜ä¸‹ IP åœ°å€ï¼Œå°† IP åœ°å€è¿”å›ï¼Œç„¶åå®¢æˆ·ç«¯ç›´æ¥è®¿é—®è¿™ä¸ª IP åœ°å€ï¼Œå°±è®¿é—®åˆ°äº†è¿™ä¸ªç½‘ç«™ã€‚</p><p>å½“CDNå­˜åœ¨çš„æ—¶å€™ï¼Œåœ¨web.comè¿™ä¸ªæƒå¨DNSæœåŠ¡å™¨ä¸Šï¼Œä¼šè®¾ç½®ä¸€ä¸ªCNAMEåˆ«åï¼ŒæŒ‡å‘å¦ä¸€ä¸ªåŸŸå <a href="http://www.web.cdn.com,å¹¶è¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨ã€‚" target="_blank" rel="noopener">www.web.cdn.com,å¹¶è¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨ã€‚</a></p><p><img src="https://i.loli.net/2020/02/02/KPOFwGSbZcgsqr9.jpg" alt="fig16.jpg"></p><p>å½“æœ¬åœ° DNS æœåŠ¡å™¨æ‹¿åˆ°è¿™ä¸ªæ–°çš„åŸŸåæ—¶ï¼Œéœ€è¦ç»§ç»­è§£æè¿™ä¸ªæ–°çš„åŸŸåã€‚è¿™ä¸ªæ—¶å€™ï¼Œå†è®¿é—®çš„å°±ä¸æ˜¯ web.com çš„æƒå¨ DNS æœåŠ¡å™¨äº†ï¼Œè€Œæ˜¯ web.cdn.com çš„æƒå¨ DNS æœåŠ¡å™¨ï¼Œè¿™æ˜¯ CDN è‡ªå·±çš„æƒå¨ DNS æœåŠ¡å™¨ã€‚åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¿˜æ˜¯ä¼šè®¾ç½®ä¸€ä¸ª CNAMEï¼ŒæŒ‡å‘å¦å¤–ä¸€ä¸ªåŸŸåï¼Œä¹Ÿå³ CDN ç½‘ç»œçš„å…¨å±€è´Ÿè½½å‡è¡¡å™¨ã€‚æ¥ä¸‹æ¥ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨å»è¯·æ±‚ CDN çš„å…¨å±€è´Ÿè½½å‡è¡¡å™¨è§£æåŸŸåï¼Œå…¨å±€è´Ÿè½½å‡è¡¡å™¨ä¼šä¸ºç”¨æˆ·é€‰æ‹©ä¸€å°åˆé€‚çš„ç¼“å­˜æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œé€‰æ‹©çš„ä¾æ®åŒ…æ‹¬ï¼š</p><ol><li>æ ¹æ®ç”¨æˆ· IP åœ°å€ï¼Œåˆ¤æ–­å“ªä¸€å°æœåŠ¡å™¨è·ç”¨æˆ·æœ€è¿‘ï¼›</li><li>ç”¨æˆ·æ‰€å¤„çš„è¿è¥å•†ï¼›</li><li>æ ¹æ®ç”¨æˆ·æ‰€è¯·æ±‚çš„ URL ä¸­æºå¸¦çš„å†…å®¹åç§°ï¼Œåˆ¤æ–­å“ªä¸€å°æœåŠ¡å™¨ä¸Šæœ‰ç”¨æˆ·æ‰€éœ€çš„å†…å®¹ï¼›</li><li>æŸ¥è¯¢å„ä¸ªæœåŠ¡å™¨å½“å‰çš„è´Ÿè½½æƒ…å†µï¼Œåˆ¤æ–­å“ªä¸€å°æœåŠ¡å™¨å°šæœ‰æœåŠ¡èƒ½åŠ›ã€‚</li></ol><p>åŸºäºä»¥ä¸Šè¿™äº›æ¡ä»¶ï¼Œè¿›è¡Œç»¼åˆåˆ†æä¹‹åï¼Œå…¨å±€è´Ÿè½½å‡è¡¡å™¨ä¼šè¿”å›ä¸€å°ç¼“å­˜æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</p><p>æœ¬åœ° DNS æœåŠ¡å™¨ç¼“å­˜è¿™ä¸ª IP åœ°å€ï¼Œç„¶åå°† IP è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å»è®¿é—®è¿™ä¸ªè¾¹ç¼˜èŠ‚ç‚¹ï¼Œä¸‹è½½èµ„æºã€‚ç¼“å­˜æœåŠ¡å™¨å“åº”ç”¨æˆ·è¯·æ±‚ï¼Œå°†ç”¨æˆ·æ‰€éœ€å†…å®¹ä¼ é€åˆ°ç”¨æˆ·ç»ˆç«¯ã€‚å¦‚æœè¿™å°ç¼“å­˜æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰ç”¨æˆ·æƒ³è¦çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿™å°æœåŠ¡å™¨å°±è¦å‘å®ƒçš„ä¸Šä¸€çº§ç¼“å­˜æœåŠ¡å™¨è¯·æ±‚å†…å®¹ï¼Œç›´è‡³è¿½æº¯åˆ°ç½‘ç«™çš„æºæœåŠ¡å™¨å°†å†…å®¹æ‹‰åˆ°æœ¬åœ°ã€‚</p><h2 id="4-1-CDNç¼“å­˜çš„å†…å®¹"><a href="#4-1-CDNç¼“å­˜çš„å†…å®¹" class="headerlink" title="4.1 CDNç¼“å­˜çš„å†…å®¹"></a>4.1 CDNç¼“å­˜çš„å†…å®¹</h2><p><img src="https://i.loli.net/2020/02/02/1dZ6rmyNulOwSbY.jpg" alt="fig17.jpg"></p><p>ä¼šä¿å­˜é™æ€é¡µé¢ï¼Œå›¾ç‰‡ç­‰ï¼Œå› ä¸ºè¿™äº›ä¸œè¥¿å˜åŒ–çš„å¯èƒ½æ€§ä¸é«˜ã€‚</p><p>åœ¨è¿›å…¥æ•°æ®ä¸­å¿ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ€å¤–å±‚æ¥å…¥å±‚çš„ç¼“å­˜ï¼Œå°†å¤§éƒ¨åˆ†é™æ€èµ„æºçš„è®¿é—®æ‹¦åœ¨è¾¹ç¼˜ã€‚è€ŒCDNåˆ™æ›´è¿›ä¸€æ­¥ï¼Œå°†è¿™äº›é™æ€èµ„æºç¼“å­˜åˆ°ç¦»ç”¨æˆ·æ›´è¿‘çš„æ•°æ®ä¸­å¿ƒå¤–ã€‚è¶Šæ¥è¿‘å®¢æˆ·ï¼Œè®¿é—®æ€§èƒ½è¶Šå¥½ï¼Œæ—¶å»¶è¶Šä½ã€‚</p><p>é™æ€èµ„æºä¸­ï¼Œæµåª’ä½“ä¹Ÿå¤§é‡ä½¿ç”¨äº†CDNæŠ€æœ¯ã€‚CDNæ”¯æŒæµåª’ä½“åè®®ï¼Œä¾‹å¦‚å‰é¢è®²è¿‡çš„ RTMP åè®®ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™ç›¸å½“äºä¸€ä¸ªä»£ç†ï¼Œä»ä¸Šä¸€çº§ç¼“å­˜è¯»å–å†…å®¹ï¼Œè½¬å‘ç»™ç”¨æˆ·ã€‚ç”±äºæµåª’ä½“å¾€å¾€æ˜¯è¿ç»­çš„ï¼Œå› è€Œå¯ä»¥è¿›è¡Œé¢„å…ˆç¼“å­˜çš„ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥é¢„å…ˆæ¨é€åˆ°ç”¨æˆ·çš„å®¢æˆ·ç«¯ã€‚</p><p>å¯¹äºé™æ€é¡µé¢æ¥è®²ï¼Œå†…å®¹çš„åˆ†å‘å¾€å¾€é‡‡å–æ‹‰å–çš„æ–¹å¼ï¼Œå³æœªå‘½ä¸­çš„æ—¶å€™ï¼Œå‘ä¸Šä¸€çº§è¿›è¡Œæ‹‰å–ï¼Œä½†æµåª’ä½“æ•°æ®é‡å¾ˆå¤§ï¼Œå¦‚æœå‡ºç°å›æºï¼Œå‹åŠ›ä¼šæ¯”è¾ƒå¤§ï¼Œå› æ­¤å¾€å¾€é‡‡å–ä¸»åŠ¨æ¨é€çš„æ¨¡å¼ï¼Œå°†çƒ­ç‚¹æ•°æ®ä¸»åŠ¨æ¨é€åˆ°è¾¹ç¼˜èŠ‚ç‚¹ã€‚</p><p>å¯¹äºæµåª’ä½“æ¥è®²ï¼Œå¾ˆå¤šCDNè¿˜æä¾›é¢„å¤„ç†æœåŠ¡ï¼Œå³åœ¨æ–‡ä»¶åˆ†å‘ä¹‹å‰ï¼Œç»è¿‡ä¸€å®šçš„å¤„ç†ã€‚ä¾‹å¦‚å°†è§†é¢‘è½¬æ¢ä¸ºä¸åŒçš„ç æµï¼Œä»¥é€‚åº”ä¸åŒçš„ç½‘ç»œå¸¦å®½çš„ç”¨æˆ·éœ€æ±‚ï¼›å†æ¯”å¦‚å¯¹è§†é¢‘è¿›è¡Œåˆ†ç‰‡ï¼Œé™ä½å­˜å‚¨å‹åŠ›ï¼Œä¹Ÿä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸åŒçš„ç ç‡åŠ è½½ä¸åŒçš„åˆ†ç‰‡ã€‚</p><h2 id="4-2-é˜²ç›—é“¾é—®é¢˜"><a href="#4-2-é˜²ç›—é“¾é—®é¢˜" class="headerlink" title="4.2 é˜²ç›—é“¾é—®é¢˜"></a>4.2 é˜²ç›—é“¾é—®é¢˜</h2><p>å¯¹äºæµåª’ä½“æ¥è¯´ï¼Œé˜²ç›—é“¾å¾ˆé‡è¦ï¼Œå³è§†é¢‘éƒ½æœ‰ç‰ˆæƒçš„ï¼Œåªèƒ½åœ¨è‡ªå·±çš„ç½‘ç«™é‡Œæ’­æ‰å¯ä»¥çš„ã€‚</p><h3 id="4-2-1-referæœºåˆ¶"><a href="#4-2-1-referæœºåˆ¶" class="headerlink" title="4.2.1 referæœºåˆ¶"></a>4.2.1 referæœºåˆ¶</h3><p>HTTPå¤´çš„referå­—æ®µï¼Œå‘Šè¯‰æœåŠ¡å™¨è¿™ä¸ªè¯·æ±‚ä»å“ªé‡Œæ¥çš„ï¼ŒæœåŠ¡å™¨åŸºäºæ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚å¦‚æœrefererçš„ä¿¡æ¯ä¸æ˜¯æ¥è‡ªæœ¬ç«™ï¼Œå°±é˜»æ­¢è®¿é—®æˆ–è€…è°ƒåˆ°å…¶å®ƒé“¾æ¥å½“ä¸­ã€‚</p><h3 id="4-2-2-æ—¶é—´æˆ³é˜²ç›—é“¾"><a href="#4-2-2-æ—¶é—´æˆ³é˜²ç›—é“¾" class="headerlink" title="4.2.2 æ—¶é—´æˆ³é˜²ç›—é“¾"></a>4.2.2 æ—¶é—´æˆ³é˜²ç›—é“¾</h3><p>ä½¿ç”¨ CDN çš„ç®¡ç†å‘˜å¯ä»¥åœ¨é…ç½®ç•Œé¢ä¸Šï¼Œå’Œ CDN å‚å•†çº¦å®šä¸€ä¸ªåŠ å¯†å­—ç¬¦ä¸²ã€‚å®¢æˆ·ç«¯å–å‡ºå½“å‰çš„æ—¶é—´æˆ³ï¼Œè¦è®¿é—®çš„èµ„æºåŠå…¶è·¯å¾„ï¼Œè¿åŒåŠ å¯†å­—ç¬¦ä¸²è¿›è¡Œç­¾åç®—æ³•å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼Œå¸¦ä¸Šè¿™ä¸ªç­¾åå­—ç¬¦ä¸²å’Œæˆªæ­¢æ—¶é—´æˆ³å»è®¿é—® CDNã€‚åœ¨ CDN æœåŠ¡ç«¯ï¼Œæ ¹æ®å–å‡ºè¿‡æœŸæ—¶é—´ï¼Œå’Œå½“å‰ CDN èŠ‚ç‚¹æ—¶é—´è¿›è¡Œæ¯”è¾ƒï¼Œç¡®è®¤è¯·æ±‚æ˜¯å¦è¿‡æœŸã€‚ç„¶å CDN æœåŠ¡ç«¯æœ‰äº†èµ„æºåŠè·¯å¾„ï¼Œæ—¶é—´æˆ³ï¼Œä»¥åŠçº¦å®šçš„åŠ å¯†å­—ç¬¦ä¸²ï¼Œæ ¹æ®ç›¸åŒçš„ç­¾åç®—æ³•è®¡ç®—ç­¾åï¼Œå¦‚æœåŒ¹é…åˆ™ä¸€è‡´ï¼Œè®¿é—®åˆæ³•ï¼Œæ‰ä¼šå°†èµ„æºè¿”å›ç»™å®¢æˆ·ã€‚</p><h2 id="4-3-åŠ¨æ€CDN"><a href="#4-3-åŠ¨æ€CDN" class="headerlink" title="4.3 åŠ¨æ€CDN"></a>4.3 åŠ¨æ€CDN</h2><h3 id="4-3-1-è¾¹ç¼˜è®¡ç®—æ¨¡å¼"><a href="#4-3-1-è¾¹ç¼˜è®¡ç®—æ¨¡å¼" class="headerlink" title="4.3.1 è¾¹ç¼˜è®¡ç®—æ¨¡å¼"></a>4.3.1 è¾¹ç¼˜è®¡ç®—æ¨¡å¼</h3><p>æ—¢ç„¶æ•°æ®æ—¶åŠ¨æ€ç”Ÿæˆçš„ï¼Œé‚£æ•°æ®çš„é€»è¾‘è®¡ç®—å’Œå­˜å‚¨ä¹Ÿåº”å½“ç›¸åº”çš„æ”¾åœ¨è¾¹ç¼˜èŠ‚ç‚¹ã€‚å…¶ä¸­å®šæ—¶ä»æºæ•°æ®å“ªé‡ŒåŒæ­¥å­˜å‚¨çš„æ•°æ®ï¼Œç„¶åå†è¾¹ç¼˜è¿›è¡Œè®¡ç®—å¾—åˆ°ç»“æœã€‚ </p><h3 id="4-3-2-è·¯å¾„ä¼˜åŒ–æ¨¡å¼"><a href="#4-3-2-è·¯å¾„ä¼˜åŒ–æ¨¡å¼" class="headerlink" title="4.3.2 è·¯å¾„ä¼˜åŒ–æ¨¡å¼"></a>4.3.2 è·¯å¾„ä¼˜åŒ–æ¨¡å¼</h3><p>æ•°æ®ä¸æ˜¯åœ¨è¾¹ç¼˜è®¡ç®—ç”Ÿæˆçš„ï¼Œè€Œæ˜¯åœ¨æºç«™ç”Ÿæˆçš„ï¼Œæ•°æ®çš„ä¸‹å‘åˆ™å¯ä»¥é€šè¿‡CDNç½‘ç»œï¼Œå¯¹è·¯å¾„è¿›è¡Œä¼˜åŒ–ã€‚å› ä¸ºCDNèŠ‚ç‚¹è¾ƒå¤šï¼Œèƒ½å¤Ÿæ‰¾åˆ°ç¦»æºç«™å¾ˆè¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œä¹Ÿèƒ½æ‰¾åˆ°ç¦»ç”¨æˆ·å¾ˆè¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹ã€‚ä¸­é—´çš„é“¾è·¯å®Œå…¨ç”±CDNè§„åˆ’ï¼Œé€‰æ‹©ä¸€ä¸ªæ›´åŠ å¯é çš„è·¯å¾„ï¼Œä½¿ç”¨ç±»ä¼¼ä¸“çº¿çš„æ–¹å¼è¿›è¡Œè®¿é—®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> CDN </tag>
            
            <tag> æµåª’ä½“åè®® </tag>
            
            <tag> P2P </tag>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(å…­)-åº”ç”¨å±‚</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%85%AD-%E5%BA%94%E7%94%A8%E5%B1%82/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%85%AD-%E5%BA%94%E7%94%A8%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="1-HTTPåè®®"><a href="#1-HTTPåè®®" class="headerlink" title="1. HTTPåè®®"></a>1. HTTPåè®®</h1><p>ä»¥è¾“å…¥ä¸€ä¸ªç½‘å€<a href="http://www.google.comä¸ºä¾‹ã€‚è¿™æ˜¯ä¸€ä¸ªURLï¼Œç§°ä¸ºç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚HTTPæ˜¯ä¸€ä¸ªåè®®ï¼Œwww.google.comæ˜¯ä¸€ä¸ªåŸŸåï¼Œè¡¨ç¤ºäº’è”ç½‘ä¸Šçš„ä¸€ä¸ªä½ç½®ã€‚å› ä¸ºæœ‰è§„èŒƒï¼Œæµè§ˆå™¨æ‰çŸ¥é“å¦‚ä½•ç»Ÿä¸€è¿›è¡Œå¤„ç†ã€‚" target="_blank" rel="noopener">http://www.google.comä¸ºä¾‹ã€‚è¿™æ˜¯ä¸€ä¸ªURLï¼Œç§°ä¸ºç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚HTTPæ˜¯ä¸€ä¸ªåè®®ï¼Œwww.google.comæ˜¯ä¸€ä¸ªåŸŸåï¼Œè¡¨ç¤ºäº’è”ç½‘ä¸Šçš„ä¸€ä¸ªä½ç½®ã€‚å› ä¸ºæœ‰è§„èŒƒï¼Œæµè§ˆå™¨æ‰çŸ¥é“å¦‚ä½•ç»Ÿä¸€è¿›è¡Œå¤„ç†ã€‚</a></p><h2 id="1-1-HTTPè¯·æ±‚çš„å‡†å¤‡"><a href="#1-1-HTTPè¯·æ±‚çš„å‡†å¤‡" class="headerlink" title="1.1 HTTPè¯·æ±‚çš„å‡†å¤‡"></a>1.1 HTTPè¯·æ±‚çš„å‡†å¤‡</h2><p>æµè§ˆå™¨ä¼šå°†åŸŸåå‘é€ç»™DNSæœåŠ¡å™¨ï¼Œå°†å…¶è§£æä¸ºIPåœ°å€ã€‚è€Œåå› ä¸ºHTTPæ˜¯åŸºäºTCPåè®®çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹TCPè¿æ¥ã€‚ç›®å‰ä½¿ç”¨çš„HTTPåè®®å¤§å¤šæ•°æ˜¯1.1ç‰ˆæœ¬çš„ï¼Œåœ¨1.1çš„åè®®å½“ä¸­ï¼Œé»˜è®¤å¼€å¯äº†Keep-aliveï¼Œè¿™æ„å‘³ç€å»ºç«‹çš„TCPè¿æ¥å¯ä»¥åœ¨å¤šæ¬¡è¯·æ±‚ä¸­å¤ç”¨ã€‚</p><h2 id="1-2-HTTPè¯·æ±‚çš„æ„å»º"><a href="#1-2-HTTPè¯·æ±‚çš„æ„å»º" class="headerlink" title="1.2 HTTPè¯·æ±‚çš„æ„å»º"></a>1.2 HTTPè¯·æ±‚çš„æ„å»º</h2><p>è¿æ¥å»ºç«‹ä»¥åï¼Œæµè§ˆå™¨å°±è¦å‘é€HTTPè¯·æ±‚ã€‚</p><p>è¯·æ±‚çš„æ ¼å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/9UN4fDEwdcCV8qZ.jpg" alt="fig1.jpg"></p><p>HTTPçš„è¯·æ±‚åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºè¯·æ±‚è¡Œï¼Œè¯·æ±‚çš„é¦–éƒ¨ï¼Œè¯·æ±‚çš„æ­£æ–‡å®ä½“ã€‚</p><h3 id="1-2-1-è¯·æ±‚è¡Œ"><a href="#1-2-1-è¯·æ±‚è¡Œ" class="headerlink" title="1.2.1 è¯·æ±‚è¡Œ"></a>1.2.1 è¯·æ±‚è¡Œ</h3><p>æ–¹æ³• + sp + URL + sp + ç‰ˆæœ¬ + cr + If</p><p>åœ¨è¯·æ±‚è¡Œä¸­ï¼ŒURLå°±æ˜¯<code>http://www.google.com</code>, ç‰ˆæœ¬æ˜¯HTTP1.1ã€‚</p><p>æ–¹æ³•æœ‰å‡ ä¸ªç±»å‹ï¼š</p><ol><li>GET</li></ol><p>GETå°±æ˜¯å»æœåŠ¡å™¨è·å–ä¸€äº›èµ„æºã€‚å¯¹äºè®¿é—®ç½‘é¡µæ¥è®²ï¼Œè¦è·å–çš„å¾€å¾€æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œä¹Ÿä¼šæœ‰å¾ˆå¤šå…¶ä»–çš„æ ¼å¼ï¼Œæ¯”å¦‚è¿”å›ä¸€ä¸ªJSONå­—ç¬¦ä¸²ç­‰ç­‰ã€‚è¿”å›çš„çŠ¶æ€æ˜¯ç”±æœåŠ¡å™¨çš„å®ç°æ¥å†³å®šçš„ã€‚</p><ol start="2"><li>POST</li></ol><p>ä¸»åŠ¨å‘Šè¯‰æœåŠ¡ç«¯ä¸€äº›ä¿¡æ¯ï¼Œè€Œéè·å–ã€‚ä¸€èˆ¬æ˜¯å°†è¿™äº›ä¿¡æ¯æ”¾åœ¨æ­£æ–‡å½“ä¸­ã€‚</p><ol start="3"><li>PUT</li></ol><p>å‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ æœ€æ–°çš„å†…å®¹ï¼Œä½†æ˜¯HTTPçš„æœåŠ¡å™¨å¾€å¾€ä¸å…è®¸ä¸Šä¼ æ–‡ä»¶ï¼Œæ‰€ä»¥PUTå’ŒPOSTå°±éƒ½å˜æˆäº†è¦ä¼ ç»™æœåŠ¡å™¨ä¸œè¥¿çš„æ–¹æ³•ã€‚POSTå¾€å¾€æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªèµ„æºçš„ï¼Œè€ŒPUTå¾€å¾€æ˜¯ç”¨æ¥ä¿®æ”¹ä¸€ä¸ªèµ„æºçš„ã€‚</p><ol start="4"><li>DELETE</li></ol><p>ç”¨æ¥åˆ é™¤èµ„æºçš„ã€‚</p><h3 id="1-2-2-é¦–éƒ¨å­—æ®µ"><a href="#1-2-2-é¦–éƒ¨å­—æ®µ" class="headerlink" title="1.2.2 é¦–éƒ¨å­—æ®µ"></a>1.2.2 é¦–éƒ¨å­—æ®µ</h3><p>é¦–éƒ¨å­—æ®µé¦–å…ˆæ˜¯key valueï¼Œé€šè¿‡å†’å·åˆ†éš”ã€‚è¿™é‡Œå¾€å¾€ä¿å­˜äº†ä¸€äº›éå¸¸é‡è¦çš„å­—æ®µï¼Œæ¯”å¦‚ï¼š</p><ul><li>Accept-Charsetï¼š è¿™é‡Œè¡¨ç¤ºå®¢æˆ·ç«¯å¯ä»¥æ¥å—çš„å­—ç¬¦é›†ï¼Œé˜²æ­¢ä¼ è¿‡æ¥çš„æ˜¯å¦å¤–çš„å­—ç¬¦é›†ï¼Œä»è€Œå¯¼è‡´å‡ºç°ä¹±ç ã€‚</li><li>Content-Type: æ­£æ–‡çš„æ ¼å¼ã€‚ä¾‹å¦‚å¦‚æœæ­£æ–‡æ˜¯JSONï¼Œé‚£è¿™é‡Œæˆ‘ä»¬å°±åº”è¯¥å°†å…¶è®¾ä¸ºJSONã€‚</li><li>ç¼“å­˜</li></ul><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜å‘¢ï¼Ÿå› ä¸ºä¸€ä¸ªå¤§çš„é¡µé¢ä¼šæœ‰å¾ˆå¤šçš„ä¸œè¥¿ã€‚å›¾ç‰‡å’Œå¤§æ®µçš„ä»‹ç»å†…å®¹å¾€å¾€æ˜¯ä¸ä¼šå¤ªç»å¸¸å‘ç”Ÿå˜åŒ–çš„ï¼Œå› æ­¤æˆ‘ä»¬æ¯æ¬¡æ›´æ–°é¡µé¢çš„æ—¶å€™ï¼Œä¸åº”è¯¥åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œå®Œå…¨çš„ä»æœåŠ¡å™¨é‡æ–°è·å–ä¸€éæ•°æ®ï¼Œåº”è¯¥åšå±€éƒ¨çš„åˆ·æ–°çš„ã€‚</p><p>å¯¹äºè¿™ç§é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç³»ç»Ÿï¼Œåœ¨çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ª<strong>æ¥å…¥å±‚</strong>ï¼Œå°†è¿™äº›é™æ€èµ„æºçš„è¯·æ±‚æ‹¦åœ¨æœ€å¤–é¢ã€‚æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/7BHNARp3Lg8Yuav.jpg" alt="fig2.jpg"></p><p>åŸºæœ¬ä¸Šæ˜¯å®¢æˆ·ç«¯å’ŒDNSè¿˜æœ‰CDNç›¸è¿ï¼Œå†è”ç³»è´Ÿè½½å‡è¡¡æ¨¡å— - nginxã€‚å°†èµ„æºåˆ’åˆ†ä¸ºåŠ¨æ€èµ„æºå’Œé™æ€èµ„æºï¼Œå¯¹äºé™æ€èµ„æºï¼Œä½¿ç”¨Varnishç¼“å­˜å±‚ï¼›å¯¹äºåŠ¨æ€èµ„æºï¼Œä½¿ç”¨Redisï¼ŒVarnishå’ŒRediséƒ½å’ŒTomcatåº”ç”¨é›†ç¾¤ç›¸è¿ï¼Œè¿™æ„å‘³ç€å¦‚æœæ— æ³•ä»ç¼“å­˜ä¸­æ‹¿åˆ°æ•°æ®ï¼Œé‚£å°±è®¿é—®æœåŠ¡å™¨ï¼Œè°ƒå–æ•°æ®ã€‚</p><p>åœ¨HTTPå¤´é‡Œé¢ï¼ŒCache-controlæ˜¯ç”¨æ¥æ§åˆ¶ç¼“å­˜çš„ï¼Œå½“å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­åŒ…å«max-ageæŒ‡ä»¤æ—¶ï¼Œå¦‚æœåˆ¤å®šç¼“å­˜å±‚ä¸­èµ„æºçš„ç¼“å­˜æ—¶é—´æ•°å€¼æ¯”æŒ‡å®šæ—¶é—´çš„æ•°å€¼å°ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥æ¥å—ç¼“å­˜çš„èµ„æºï¼›å½“æŒ‡å®šmax-ageå€¼ä¸º0ï¼Œé‚£ä¹ˆç¼“å­˜å±‚é€šå¸¸éœ€è¦å°†è¯·æ±‚è½¬å‘ç»™åº”ç”¨é›†ç¾¤ã€‚</p><ul><li>If-Modified-Since</li></ul><p>å¦‚æœæœåŠ¡å™¨çš„èµ„æºåœ¨æŸä¸ªæ—¶é—´ä¹‹åæ›´æ–°äº†ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±åº”è¯¥ä¸‹è½½æœ€æ–°çš„èµ„æºï¼›å¦‚æœæ²¡æœ‰æ›´æ–°ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›â€304 Not Modifiedâ€çš„å“åº”ï¼Œé‚£å®¢æˆ·ç«¯å°±ä¸ç”¨ä¸‹è½½äº†ï¼Œä¹Ÿä¼šèŠ‚çœå¸¦å®½ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æœ‰äº†HTTPè¯·æ±‚çš„æŠ¥æ–‡æ ¼å¼ï¼Œæ¥ä¸‹æ¥ï¼Œæµè§ˆå™¨ä¼šé€šè¿‡Socketå°†å…¶äº¤ç»™ä¼ è¾“å±‚ã€‚</p><h3 id="1-2-3-HTTPè¯·æ±‚çš„å‘é€"><a href="#1-2-3-HTTPè¯·æ±‚çš„å‘é€" class="headerlink" title="1.2.3 HTTPè¯·æ±‚çš„å‘é€"></a>1.2.3 HTTPè¯·æ±‚çš„å‘é€</h3><p>HTTPåè®®æ˜¯åŸºäºTCPåè®®çš„ã€‚ä½¿ç”¨é¢å‘è¿æ¥çš„æ–¹å¼å‘é€è¯·æ±‚ï¼Œé€šè¿‡streamäºŒè¿›åˆ¶æµçš„æ–¹å¼ä¼ ç»™å¯¹æ–¹ã€‚åˆ°äº†TCPå±‚ï¼Œå®ƒä¼šæŠŠäºŒè¿›åˆ¶æµå˜æˆä¸€ä¸ªæŠ¥æ–‡æ®µå‘é€ç»™æœåŠ¡å™¨ã€‚</p><p>åœ¨å‘é€æ¯ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ—¶å€™ï¼Œéƒ½éœ€è¦å¯¹æ–¹å›åº”ä¸€ä¸ªACKï¼Œæ¥ä¿è¯æŠ¥æ–‡å¯é åœ°åˆ°è¾¾å¯¹æ–¹ã€‚å¦‚æœæ²¡æœ‰å›åº”ï¼Œé‚£ä¹ˆTCPè¿™ä¸€å±‚ä¼šé‡æ–°ä¼ è¾“ï¼Œç›´åˆ°å¯ä»¥åˆ°è¾¾ã€‚</p><p>TCP å±‚å‘é€æ¯ä¸€ä¸ªæŠ¥æ–‡çš„æ—¶å€™ï¼Œéƒ½éœ€è¦åŠ ä¸Šè‡ªå·±çš„åœ°å€ï¼ˆå³æºåœ°å€ï¼‰å’Œå®ƒæƒ³è¦å»çš„åœ°æ–¹ï¼ˆå³ç›®æ ‡åœ°å€ï¼‰ï¼Œå°†è¿™ä¸¤ä¸ªä¿¡æ¯æ”¾åˆ° IP å¤´é‡Œé¢ï¼Œäº¤ç»™ IP å±‚è¿›è¡Œä¼ è¾“ã€‚</p><p>IP å±‚éœ€è¦æŸ¥çœ‹ç›®æ ‡åœ°å€å’Œè‡ªå·±æ˜¯å¦æ˜¯åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ã€‚å¦‚æœæ˜¯ï¼Œå°±å‘é€ ARP åè®®æ¥è¯·æ±‚è¿™ä¸ªç›®æ ‡åœ°å€å¯¹åº”çš„ MAC åœ°å€ï¼Œç„¶åå°†æº MAC å’Œç›®æ ‡ MAC æ”¾å…¥ MAC å¤´ï¼Œå‘é€å‡ºå»å³å¯ï¼›å¦‚æœä¸åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œå°±éœ€è¦å‘é€åˆ°ç½‘å…³ï¼Œè¿˜è¦éœ€è¦å‘é€ ARP åè®®ï¼Œæ¥è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œç„¶åå°†æº MAC å’Œç½‘å…³ MAC æ”¾å…¥ MAC å¤´ï¼Œå‘é€å‡ºå»ã€‚</p><p>ç½‘å…³æ”¶åˆ°åŒ…å‘ç° MAC ç¬¦åˆï¼Œå–å‡ºç›®æ ‡ IP åœ°å€ï¼Œæ ¹æ®è·¯ç”±åè®®æ‰¾åˆ°ä¸‹ä¸€è·³çš„è·¯ç”±å™¨ï¼Œè·å–ä¸‹ä¸€è·³è·¯ç”±å™¨çš„ MAC åœ°å€ï¼Œå°†åŒ…å‘ç»™ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚è¿™æ ·è·¯ç”±å™¨ä¸€è·³ä¸€è·³ç»ˆäºåˆ°è¾¾ç›®æ ‡çš„å±€åŸŸç½‘ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæœ€åä¸€è·³çš„è·¯ç”±å™¨èƒ½å¤Ÿå‘ç°ï¼Œç›®æ ‡åœ°å€å°±åœ¨è‡ªå·±çš„æŸä¸€ä¸ªå‡ºå£çš„å±€åŸŸç½‘ä¸Šã€‚äºæ˜¯ï¼Œåœ¨è¿™ä¸ªå±€åŸŸç½‘ä¸Šå‘é€ ARPï¼Œè·å¾—è¿™ä¸ªç›®æ ‡åœ°å€çš„ MAC åœ°å€ï¼Œå°†åŒ…å‘å‡ºå»ã€‚</p><p>ç›®æ ‡çš„æœºå™¨å‘ç° MAC åœ°å€ç¬¦åˆï¼Œå°±å°†åŒ…æ”¶èµ·æ¥ï¼›å‘ç° IP åœ°å€ç¬¦åˆï¼Œæ ¹æ® IP å¤´ä¸­åè®®é¡¹ï¼ŒçŸ¥é“è‡ªå·±ä¸Šä¸€å±‚æ˜¯ TCP åè®®ï¼Œäºæ˜¯è§£æ TCP çš„å¤´ï¼Œé‡Œé¢æœ‰åºåˆ—å·ï¼Œéœ€è¦çœ‹ä¸€çœ‹è¿™ä¸ªåºåˆ—åŒ…æ˜¯ä¸æ˜¯æˆ‘è¦çš„ï¼Œå¦‚æœæ˜¯å°±æ”¾å…¥ç¼“å­˜ä¸­ç„¶åè¿”å›ä¸€ä¸ª ACKï¼Œå¦‚æœä¸æ˜¯å°±ä¸¢å¼ƒã€‚</p><p>TCP å¤´é‡Œé¢è¿˜æœ‰ç«¯å£å·ï¼ŒHTTP çš„æœåŠ¡å™¨æ­£åœ¨ç›‘å¬è¿™ä¸ªç«¯å£å·ã€‚äºæ˜¯ï¼Œç›®æ ‡æœºå™¨è‡ªç„¶çŸ¥é“æ˜¯ HTTP æœåŠ¡å™¨è¿™ä¸ªè¿›ç¨‹æƒ³è¦è¿™ä¸ªåŒ…ï¼Œäºæ˜¯å°†åŒ…å‘ç»™ HTTP æœåŠ¡å™¨ã€‚HTTP æœåŠ¡å™¨çš„è¿›ç¨‹çœ‹åˆ°ï¼ŒåŸæ¥è¿™ä¸ªè¯·æ±‚æ˜¯è¦è®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œäºæ˜¯å°±æŠŠè¿™ä¸ªç½‘é¡µå‘ç»™å®¢æˆ·ç«¯ã€‚</p><h3 id="1-2-4-HTTPè¿”å›çš„æ„å»º"><a href="#1-2-4-HTTPè¿”å›çš„æ„å»º" class="headerlink" title="1.2.4 HTTPè¿”å›çš„æ„å»º"></a>1.2.4 HTTPè¿”å›çš„æ„å»º</h3><p>åŸºäºHTTP/1.1çš„è¿”å›æŠ¥æ–‡ï¼š</p><p><img src="https://i.loli.net/2020/02/02/2nmbaI9hzYTKUr1.jpg" alt="fig3.jpg"></p><p>çŠ¶æ€ç ä¼šè¿”å›HTTPè¯·æ±‚çš„ç»“æœã€‚</p><p>è€Œåæ˜¯è¿”å›é¦–éƒ¨çš„key valueã€‚ </p><ul><li>Retry-Afterè¡¨ç¤ºå‘Šè¯‰å®¢æˆ·ç«¯åº”è¯¥åœ¨å¤šé•¿æ—¶é—´ä»¥åå†æ¬¡å°è¯•ä¸€ä¸‹ã€‚</li><li>Content-Type: è¡¨ç¤ºè¿”å›çš„æ˜¯HTMLï¼Œè¿˜æ˜¯JSONã€‚</li></ul><p>æ„é€ å¥½äº†è¿”å›çš„HTTPæŠ¥æ–‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŠŠè¿™ä¸ªæŠ¥æ–‡å‘é€å‡ºå»ã€‚äº¤ç»™Socketå»å‘é€ï¼Œäº¤ç»™TCPå±‚ï¼Œè®©TCPå±‚å°†è¿”å›çš„HTMLåˆ†æˆä¸€ä¸ªä¸ªå°æ®µï¼Œå¹¶ä¸”ä¿è¯æ¯ä¸ªæ®µéƒ½å¯é åˆ°è¾¾ã€‚è¿™äº›æ®µåŠ ä¸ŠTCPå¤´åä¼šäº¤ç»™IPå±‚ï¼Œç„¶åå°†åˆšæ‰çš„å‘é€è¿‡ç¨‹åæ–¹å‘æ¥ä¸€éã€‚ä¸¤æ¬¡çš„é€»è¾‘åŸºæœ¬ç›¸åŒï¼Œä¸€ç›´åˆ°è¾¾å®¢æˆ·ç«¯ã€‚</p><p>å®¢æˆ·ç«¯å‘ç° MAC åœ°å€ç¬¦åˆã€IP åœ°å€ç¬¦åˆï¼Œäºæ˜¯å°±ä¼šäº¤ç»™ TCP å±‚ã€‚æ ¹æ®åºåˆ—å·çœ‹æ˜¯ä¸æ˜¯è‡ªå·±è¦çš„æŠ¥æ–‡æ®µï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¼šæ ¹æ® TCP å¤´ä¸­çš„ç«¯å£å·ï¼Œå‘ç»™ç›¸åº”çš„è¿›ç¨‹ã€‚è¿™ä¸ªè¿›ç¨‹å°±æ˜¯æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä½œä¸ºå®¢æˆ·ç«¯ä¹Ÿåœ¨ç›‘å¬æŸä¸ªç«¯å£ã€‚</p><p>å½“æµè§ˆå™¨æ‹¿åˆ°äº† HTTP çš„æŠ¥æ–‡ã€‚å‘ç°è¿”å›â€œ200â€ï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œäºæ˜¯å°±ä»æ­£æ–‡ä¸­å°† HTML æ‹¿å‡ºæ¥ã€‚HTML æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ç½‘é¡µæ ¼å¼ã€‚æµè§ˆå™¨åªè¦æ ¹æ®è¿™ä¸ªæ ¼å¼ï¼Œå±•ç¤ºå‡ºä¸€ä¸ªç»šä¸½å¤šå½©çš„ç½‘é¡µã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„HTTPè¯·æ±‚å’Œè¿”å›çš„å®Œæ•´è¿‡ç¨‹ã€‚</p><h2 id="1-3-HTTP-2-0"><a href="#1-3-HTTP-2-0" class="headerlink" title="1.3 HTTP 2.0"></a>1.3 HTTP 2.0</h2><p>HTTP 1.1 åœ¨åº”ç”¨å±‚ä»¥çº¯æ–‡æœ¬çš„å½¢å¼è¿›è¡Œé€šä¿¡ã€‚æ¯æ¬¡é€šä¿¡éƒ½è¦å¸¦å®Œæ•´çš„ HTTP çš„å¤´ï¼Œè€Œä¸”ä¸è€ƒè™‘ pipeline æ¨¡å¼çš„è¯ï¼Œæ¯æ¬¡çš„è¿‡ç¨‹æ€»æ˜¯åƒä¸Šé¢æè¿°çš„é‚£æ ·ä¸€å»ä¸€å›ã€‚è¿™æ ·åœ¨å®æ—¶æ€§ã€å¹¶å‘æ€§ä¸Šéƒ½å­˜åœ¨é—®é¢˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒHTTP 2.0 ä¼šå¯¹ HTTP çš„å¤´è¿›è¡Œä¸€å®šçš„å‹ç¼©ï¼Œå°†åŸæ¥æ¯æ¬¡éƒ½è¦æºå¸¦çš„å¤§é‡ key  value åœ¨ä¸¤ç«¯å»ºç«‹ä¸€ä¸ªç´¢å¼•è¡¨ï¼Œå¯¹ç›¸åŒçš„å¤´åªå‘é€ç´¢å¼•è¡¨ä¸­çš„ç´¢å¼•ã€‚</p><p>å¦å¤–ï¼ŒHTTP 2.0 åè®®å°†ä¸€ä¸ª TCP çš„è¿æ¥ä¸­ï¼Œåˆ‡åˆ†æˆå¤šä¸ªæµï¼Œæ¯ä¸ªæµéƒ½æœ‰è‡ªå·±çš„ IDï¼Œè€Œä¸”æµå¯ä»¥æ˜¯å®¢æˆ·ç«¯å‘å¾€æœåŠ¡ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡ç«¯å‘å¾€å®¢æˆ·ç«¯ã€‚å®ƒå…¶å®åªæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„é€šé“ã€‚æµæ˜¯æœ‰ä¼˜å…ˆçº§çš„ã€‚</p><p>HTTP 2.0 è¿˜å°†æ‰€æœ‰çš„ä¼ è¾“ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶å¯¹å®ƒä»¬é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ç¼–ç ã€‚å¸¸è§çš„å¸§æœ‰Headerå¸§ï¼Œç”¨äºä¼ è¾“Headerå†…å®¹ï¼Œå¹¶ä¸”ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„æµã€‚å†å°±æ˜¯Dataå¸§ï¼Œç”¨æ¥ä¼ è¾“æ­£æ–‡å®ä½“ã€‚å¤šä¸ªå¸§å±äºåŒä¸€ä¸ªæµã€‚</p><p>é€šè¿‡è¿™ä¸¤ç§æœºåˆ¶ï¼ŒHTTP 2.0 çš„å®¢æˆ·ç«¯å¯ä»¥å°†å¤šä¸ªè¯·æ±‚åˆ†åˆ°ä¸åŒçš„æµä¸­ï¼Œç„¶åå°†è¯·æ±‚å†…å®¹æ‹†æˆå¸§ï¼Œè¿›è¡ŒäºŒè¿›åˆ¶ä¼ è¾“ã€‚è¿™äº›å¸§å¯ä»¥æ‰“æ•£ä¹±åºå‘é€ï¼Œ ç„¶åæ ¹æ®æ¯ä¸ªå¸§é¦–éƒ¨çš„æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ä¼˜å…ˆçº§ï¼Œå†³å®šä¼˜å…ˆå¤„ç†å“ªä¸ªæµçš„æ•°æ®ã€‚</p><p>æˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬çš„ä¸€ä¸ªé¡µé¢è¦å‘é€ä¸‰ä¸ªç‹¬ç«‹çš„è¯·æ±‚ï¼Œä¸€ä¸ªè·å– cssï¼Œä¸€ä¸ªè·å– jsï¼Œä¸€ä¸ªè·å–å›¾ç‰‡ jpgã€‚å¦‚æœä½¿ç”¨ HTTP 1.1 å°±æ˜¯ä¸²è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ HTTP 2.0ï¼Œå°±å¯ä»¥åœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œè€Œä¸”ä¸ç”¨æŒ‰ç…§é¡ºåºä¸€å¯¹ä¸€å¯¹åº”ã€‚</p><p><img src="https://i.loli.net/2020/02/02/eyvpNZfrz3ClsnT.jpg" alt="fig4.jpg"></p><p>HTTP2.0å®é™…ä¸Šæ˜¯å°†ä¸‰ä¸ªè¯·æ±‚å˜æˆä¸‰ä¸ªæµï¼Œå°†æ•°æ®åˆ†æˆå¸§ï¼Œä¹±åºå‘é€åˆ°ä¸€ä¸ªTCPè¿æ¥å½“ä¸­ã€‚</p><p><img src="https://i.loli.net/2020/02/02/ymohztOPXklU84f.jpg" alt="fig5.jpg"></p><p>HTTP 2.0 æˆåŠŸè§£å†³äº† HTTP 1.1 çš„é˜Ÿé¦–é˜»å¡é—®é¢˜ï¼ŒåŒæ—¶ï¼Œä¹Ÿä¸éœ€è¦é€šè¿‡ HTTP 1.x çš„ pipeline æœºåˆ¶ç”¨å¤šæ¡ TCP è¿æ¥æ¥å®ç°å¹¶è¡Œè¯·æ±‚ä¸å“åº”ï¼›å‡å°‘äº† TCP è¿æ¥æ•°å¯¹æœåŠ¡å™¨æ€§èƒ½çš„å½±å“ï¼ŒåŒæ—¶å°†é¡µé¢çš„å¤šä¸ªæ•°æ® cssã€jsã€ jpg ç­‰é€šè¿‡ä¸€ä¸ªæ•°æ®é“¾æ¥è¿›è¡Œä¼ è¾“ï¼Œèƒ½å¤ŸåŠ å¿«é¡µé¢ç»„ä»¶çš„ä¼ è¾“é€Ÿåº¦ã€‚</p><p>HTTP2.0è™½ç„¶å¤§å¤§å¢åŠ äº†å¹¶å‘æ€§ï¼Œä½†æ˜¯è¿˜å­˜åœ¨é—®é¢˜ï¼Œå› ä¸ºHTTP2.0è¿˜æ˜¯åŸºäºTCPåè®®çš„ï¼ŒTCPåè®®åœ¨å¤„ç†åŒ…æ—¶æ˜¯æœ‰ä¸¥æ ¼é¡ºåºçš„ã€‚å½“å…¶ä¸­ä¸€ä¸ªæ•°æ®åŒ…é‡åˆ°é—®é¢˜ï¼ŒTCPè¿æ¥éœ€è¦ç­‰å¾…è¿™ä¸ªåŒ…å®Œæˆé‡ä¼ ä¹‹åæ‰èƒ½ç»§ç»­è¿›è¡Œã€‚å› æ­¤Googleå¼•å…¥QUICåè®®æ¥åŠ é€Ÿæ•´ä¸ªè¿‡ç¨‹ã€‚</p><h2 id="1-4-QUICåè®®"><a href="#1-4-QUICåè®®" class="headerlink" title="1.4 QUICåè®®"></a>1.4 QUICåè®®</h2><p>ä»TCPåˆ‡æ¢åˆ°äº†UDPï¼</p><h3 id="1-4-1-è‡ªå®šä¹‰è¿æ¥æœºåˆ¶"><a href="#1-4-1-è‡ªå®šä¹‰è¿æ¥æœºåˆ¶" class="headerlink" title="1.4.1 è‡ªå®šä¹‰è¿æ¥æœºåˆ¶"></a>1.4.1 è‡ªå®šä¹‰è¿æ¥æœºåˆ¶</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€æ¡ TCP è¿æ¥æ˜¯ç”±å››å…ƒç»„æ ‡è¯†çš„ï¼Œåˆ†åˆ«æ˜¯æº IPã€æºç«¯å£ã€ç›®çš„ IPã€ç›®çš„ç«¯å£ã€‚ä¸€æ—¦ä¸€ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±éœ€è¦æ–­å¼€é‡è¿ï¼Œé‡æ–°è¿æ¥ã€‚åœ¨ç§»åŠ¨äº’è”æƒ…å†µä¸‹ï¼Œå½“æ‰‹æœºä¿¡å·ä¸ç¨³å®šæˆ–è€…åœ¨ WIFI å’Œ ç§»åŠ¨ç½‘ç»œåˆ‡æ¢æ—¶ï¼Œéƒ½ä¼šå¯¼è‡´é‡è¿ï¼Œä»è€Œè¿›è¡Œå†æ¬¡çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¯¼è‡´ä¸€å®šçš„æ—¶å»¶ã€‚</p><p>è¿™åœ¨ TCP æ˜¯æ²¡æœ‰åŠæ³•çš„ï¼Œä½†æ˜¯åŸºäº UDPï¼Œå°±å¯ä»¥åœ¨ QUIC è‡ªå·±çš„é€»è¾‘é‡Œé¢ç»´æŠ¤è¿æ¥çš„æœºåˆ¶ï¼Œä¸å†ä»¥å››å…ƒç»„æ ‡è¯†ï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ä½œä¸º ID æ¥æ ‡è¯†ï¼Œè€Œä¸” UDP æ˜¯æ— è¿æ¥çš„ï¼Œæ‰€ä»¥å½“ IP æˆ–è€…ç«¯å£å˜åŒ–çš„æ—¶å€™ï¼Œåªè¦ ID ä¸å˜ï¼Œå°±ä¸éœ€è¦é‡æ–°å»ºç«‹è¿æ¥ã€‚</p><h3 id="1-4-2-è‡ªå®šä¹‰é‡ä¼ æœºåˆ¶"><a href="#1-4-2-è‡ªå®šä¹‰é‡ä¼ æœºåˆ¶" class="headerlink" title="1.4.2 è‡ªå®šä¹‰é‡ä¼ æœºåˆ¶"></a>1.4.2 è‡ªå®šä¹‰é‡ä¼ æœºåˆ¶</h3><p>TCPä½¿ç”¨åºå·å’Œåº”ç­”æœºåˆ¶æ¥è§£å†³é¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜ã€‚ä»»ä½•ä¸€ä¸ªåºå·çš„åŒ…å‘è¿‡å»ï¼Œéƒ½è¦åœ¨ä¸€å®šçš„æ—¶é—´å†…å¾—åˆ°åº”ç­”ï¼Œå¦åˆ™ä¸€æ—¦è¶…æ—¶ï¼Œå°±ä¼šé‡å‘è¿™ä¸ªåºå·çš„åŒ…ã€‚é‚£æ€ä¹ˆæ ·æ‰ç®—è¶…æ—¶å‘¢ï¼Ÿé€šè¿‡ä½¿ç”¨è‡ªé€‚åº”é‡ä¼ ç®—æ³•ï¼Œé€šè¿‡é‡‡æ ·å¾€è¿”æ—¶é—´RTTä¸æ–­è°ƒæ•´ã€‚</p><p>å…¶å®ï¼Œåœ¨ TCP é‡Œé¢è¶…æ—¶çš„é‡‡æ ·å­˜åœ¨ä¸å‡†ç¡®çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå‘é€ä¸€ä¸ªåŒ…ï¼Œåºå·ä¸º 100ï¼Œå‘ç°æ²¡æœ‰è¿”å›ï¼Œäºæ˜¯å†å‘é€ä¸€ä¸ª 100ï¼Œè¿‡ä¸€é˜µè¿”å›ä¸€ä¸ª ACK101ã€‚è¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯çŸ¥é“è¿™ä¸ªåŒ…è‚¯å®šæ”¶åˆ°äº†ï¼Œä½†æ˜¯å¾€è¿”æ—¶é—´æ˜¯å¤šå°‘å‘¢ï¼Ÿæ˜¯ ACK åˆ°è¾¾çš„æ—¶é—´å‡å»åä¸€ä¸ª 100 å‘é€çš„æ—¶é—´ï¼Œè¿˜æ˜¯å‡å»å‰ä¸€ä¸ª 100 å‘é€çš„æ—¶é—´å‘¢ï¼Ÿäº‹å®æ˜¯ï¼Œç¬¬ä¸€ç§ç®—æ³•æŠŠæ—¶é—´ç®—çŸ­äº†ï¼Œç¬¬äºŒç§ç®—æ³•æŠŠæ—¶é—´ç®—é•¿äº†ã€‚</p><p>QUIC ä¹Ÿæœ‰ä¸ªåºåˆ—å·ï¼Œæ˜¯é€’å¢çš„ã€‚ä»»ä½•ä¸€ä¸ªåºåˆ—å·çš„åŒ…åªå‘é€ä¸€æ¬¡ï¼Œä¸‹æ¬¡å°±è¦åŠ ä¸€äº†ã€‚ä¾‹å¦‚ï¼Œå‘é€ä¸€ä¸ªåŒ…ï¼Œåºå·æ˜¯ 100ï¼Œå‘ç°æ²¡æœ‰è¿”å›ï¼›å†æ¬¡å‘é€çš„æ—¶å€™ï¼Œåºå·å°±æ˜¯ 101 äº†ï¼›å¦‚æœè¿”å›çš„ ACK  100ï¼Œå°±æ˜¯å¯¹ç¬¬ä¸€ä¸ªåŒ…çš„å“åº”ã€‚å¦‚æœè¿”å› ACK  101 å°±æ˜¯å¯¹ç¬¬äºŒä¸ªåŒ…çš„å“åº”ï¼ŒRTT è®¡ç®—ç›¸å¯¹å‡†ç¡®ã€‚</p><p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ€ä¹ˆçŸ¥é“åŒ… 100 å’ŒåŒ… 101 å‘é€çš„æ˜¯åŒæ ·çš„å†…å®¹å‘¢ï¼ŸQUIC å®šä¹‰äº†ä¸€ä¸ª offset æ¦‚å¿µã€‚QUIC æ—¢ç„¶æ˜¯é¢å‘è¿æ¥çš„ï¼Œä¹Ÿå°±åƒ TCP ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œå‘é€çš„æ•°æ®åœ¨è¿™ä¸ªæ•°æ®æµé‡Œé¢æœ‰ä¸ªåç§»é‡ offsetï¼Œå¯ä»¥é€šè¿‡ offset æŸ¥çœ‹æ•°æ®å‘é€åˆ°äº†å“ªé‡Œï¼Œè¿™æ ·åªè¦è¿™ä¸ª offset çš„åŒ…æ²¡æœ‰æ¥ï¼Œå°±è¦é‡å‘ï¼›å¦‚æœæ¥äº†ï¼ŒæŒ‰ç…§ offset æ‹¼æ¥ï¼Œè¿˜æ˜¯èƒ½å¤Ÿæ‹¼æˆä¸€ä¸ªæµã€‚</p><p><img src="https://i.loli.net/2020/02/02/p2nxwzvTsV1toX9.jpg" alt="fig6.jpg"></p><h3 id="1-4-3-æ— é˜»å¡çš„å¤šè·¯å¤ç”¨"><a href="#1-4-3-æ— é˜»å¡çš„å¤šè·¯å¤ç”¨" class="headerlink" title="1.4.3 æ— é˜»å¡çš„å¤šè·¯å¤ç”¨"></a>1.4.3 æ— é˜»å¡çš„å¤šè·¯å¤ç”¨</h3><p>æœ‰äº†è‡ªå®šä¹‰çš„è¿æ¥å’Œé‡ä¼ æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è§£å†³HTTP2.0çš„å¤šè·¯å¤ç”¨é—®é¢˜ã€‚åŒ HTTP 2.0 ä¸€æ ·ï¼ŒåŒä¸€æ¡ QUIC è¿æ¥ä¸Šå¯ä»¥åˆ›å»ºå¤šä¸ª streamï¼Œæ¥å‘é€å¤šä¸ª HTTP è¯·æ±‚ã€‚ä½†æ˜¯ï¼ŒQUIC æ˜¯åŸºäº UDP çš„ï¼Œä¸€ä¸ªè¿æ¥ä¸Šçš„å¤šä¸ª stream ä¹‹é—´æ²¡æœ‰ä¾èµ–ã€‚è¿™æ ·ï¼Œå‡å¦‚ stream2 ä¸¢äº†ä¸€ä¸ª UDP åŒ…ï¼Œåé¢è·Ÿç€ stream3 çš„ä¸€ä¸ª UDP åŒ…ï¼Œè™½ç„¶ stream2 çš„é‚£ä¸ªåŒ…éœ€è¦é‡ä¼ ï¼Œä½†æ˜¯ stream3 çš„åŒ…æ— éœ€ç­‰å¾…ï¼Œå°±å¯ä»¥å‘ç»™ç”¨æˆ·ã€‚</p><h3 id="1-4-4-è‡ªå®šä¹‰æµé‡æ§åˆ¶"><a href="#1-4-4-è‡ªå®šä¹‰æµé‡æ§åˆ¶" class="headerlink" title="1.4.4 è‡ªå®šä¹‰æµé‡æ§åˆ¶"></a>1.4.4 è‡ªå®šä¹‰æµé‡æ§åˆ¶</h3><p>TCPçš„æµé‡æ§åˆ¶æ˜¯é€šè¿‡æ»‘åŠ¨çª—å£åè®®ã€‚QUICçš„æµé‡æ§åˆ¶æ˜¯é€šè¿‡window_updateï¼Œæ¥å‘Šè¯‰å¯¹æ–¹å®ƒå¯ä»¥æ¥æ”¶çš„å­—èŠ‚æ•°ã€‚ä½†æ˜¯QUICçš„çª—å£æ˜¯é€‚åº”è‡ªå·±çš„å¤šè·¯å¤ç”¨æœºåˆ¶çš„ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªè¿æ¥ä¸­çš„æ¯ä¸€ä¸ªstreamæ§åˆ¶çª—å£å¤§å°ã€‚</p><p>åœ¨ TCP åè®®ä¸­ï¼Œæ¥æ”¶ç«¯çš„çª—å£çš„èµ·å§‹ç‚¹æ˜¯ä¸‹ä¸€ä¸ªè¦æ¥æ”¶å¹¶ä¸” ACK çš„åŒ…ï¼Œå³ä¾¿åæ¥çš„åŒ…éƒ½åˆ°äº†ï¼Œæ”¾åœ¨ç¼“å­˜é‡Œé¢ï¼Œçª—å£ä¹Ÿä¸èƒ½å³ç§»ï¼Œå› ä¸º TCP çš„ ACK æœºåˆ¶æ˜¯åŸºäºåºåˆ—å·çš„ç´¯è®¡åº”ç­”ï¼Œä¸€æ—¦ ACK äº†ä¸€ä¸ªç³»åˆ—å·ï¼Œå°±è¯´æ˜å‰é¢çš„éƒ½åˆ°äº†ï¼Œæ‰€ä»¥åªè¦å‰é¢çš„æ²¡åˆ°ï¼Œåé¢çš„åˆ°äº†ä¹Ÿä¸èƒ½ ACKï¼Œå°±ä¼šå¯¼è‡´åé¢çš„åˆ°äº†ï¼Œä¹Ÿæœ‰å¯èƒ½è¶…æ—¶é‡ä¼ ï¼Œæµªè´¹å¸¦å®½ã€‚</p><p>QUIC çš„ ACK æ˜¯åŸºäº offset çš„ï¼Œæ¯ä¸ª offset çš„åŒ…æ¥äº†ï¼Œè¿›äº†ç¼“å­˜ï¼Œå°±å¯ä»¥åº”ç­”ï¼Œåº”ç­”åå°±ä¸ä¼šé‡å‘ï¼Œä¸­é—´çš„ç©ºæŒ¡ä¼šç­‰å¾…åˆ°æ¥æˆ–è€…é‡å‘å³å¯ï¼Œè€Œçª—å£çš„èµ·å§‹ä½ç½®ä¸ºå½“å‰æ”¶åˆ°çš„æœ€å¤§ offsetï¼Œä»è¿™ä¸ª offset åˆ°å½“å‰çš„ stream æ‰€èƒ½å®¹çº³çš„æœ€å¤§ç¼“å­˜ï¼Œæ˜¯çœŸæ­£çš„çª—å£å¤§å°ã€‚æ˜¾ç„¶ï¼Œè¿™æ ·æ›´åŠ å‡†ç¡®ã€‚</p><p><img src="https://i.loli.net/2020/02/02/k4weK82tcO7yfuq.jpg" alt="fig7.jpg"></p><h1 id="2-HTTPS-åè®®"><a href="#2-HTTPS-åè®®" class="headerlink" title="2.HTTPS åè®®"></a>2.HTTPS åè®®</h1><p>HTTPSåè®®çš„é€‚ç”¨åœºæ™¯ï¼šæˆ‘ä»¬å¯ä»¥ç”¨HTTPåè®®æ¥çœ‹æ–°é—»ï¼Œä½†æ˜¯æ”¾åˆ°ä¸‹å•æ”¯ä»˜çš„åº”ç”¨åœºæ™¯ä¸­ä¼šå­˜åœ¨å¾ˆå¤šçš„é£é™©ã€‚å¦‚æœé€‚ç”¨HTTPï¼Œå‡è®¾ç‚¹å¤–å–æ”¯ä»˜ï¼Œç½‘ç»œåŒ…è¢«æˆªè·äº†ï¼Œäºæ˜¯åœ¨æœåŠ¡å™¨å›å¤ä½ ä¹‹å‰ï¼Œé»‘å®¢å‡è£…æ˜¯å¤–å–ç½‘ç«™ï¼Œç„¶åç»™ä½ å›å¤ä¸€ä¸ªå‡æ¶ˆæ¯è®©ä½ å‘é€é“¶è¡Œå¡å·å’Œå¯†ç ã€‚</p><p>ä¸ºäº†è§£å†³åœ¨è¿™ç§åº”ç”¨åœºæ™¯ä¸‹çš„å®‰å…¨é—®é¢˜ï¼Œéœ€è¦è¿›è¡ŒåŠ å¯†ï¼Œåˆ†ä¸ºå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤ç§ï¼š</p><h2 id="2-1-åŠ å¯†æ–¹å¼"><a href="#2-1-åŠ å¯†æ–¹å¼" class="headerlink" title="2.1 åŠ å¯†æ–¹å¼"></a>2.1 åŠ å¯†æ–¹å¼</h2><h3 id="2-1-1-å¯¹ç§°åŠ å¯†"><a href="#2-1-1-å¯¹ç§°åŠ å¯†" class="headerlink" title="2.1.1 å¯¹ç§°åŠ å¯†"></a>2.1.1 å¯¹ç§°åŠ å¯†</h3><p>åœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„å¯†é’¥æ˜¯ç›¸åŒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†é’¥ã€‚å› æ­¤ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•è¦ä¿è¯å®‰å…¨æ€§çš„è¯ï¼Œå¯†é’¥è¦åšå¥½ä¿å¯†ã€‚åªèƒ½è®©ä½¿ç”¨çš„äººçŸ¥é“ï¼Œä¸èƒ½å¯¹å¤–å…¬å¼€ã€‚</p><p>åœ¨ä¸Šè¿°åœºæ™¯å½“ä¸­çš„é—®é¢˜å˜æˆäº†ï¼šå¦‚ä½•è®©ç”¨æˆ·å’Œé“¶è¡Œä¹‹é—´è¿›è¡Œäº¤æµï¼Œæ¥ä¼ é€’å…¬é’¥ï¼Œå¯¹ç§°åŠ å¯†ä¸‹è¿™ç§äº¤æµéå¸¸çš„å›°éš¾ã€‚</p><h3 id="2-1-2-éå¯¹ç§°åŠ å¯†"><a href="#2-1-2-éå¯¹ç§°åŠ å¯†" class="headerlink" title="2.1.2 éå¯¹ç§°åŠ å¯†"></a>2.1.2 éå¯¹ç§°åŠ å¯†</h3><p>åœ¨éå¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼ŒåŠ å¯†ä½¿ç”¨çš„å¯†é’¥å’Œè§£å¯†ä½¿ç”¨çš„å¯†é’¥æ˜¯ä¸ç›¸åŒçš„ã€‚ä¸€æŠŠæ˜¯ä½œä¸ºå…¬å¼€çš„å…¬é’¥ï¼Œå¦ä¸€æŠŠæ˜¯ä½œä¸ºè°éƒ½ä¸èƒ½ç»™çš„ç§é’¥ã€‚å…¬é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œåªæœ‰ç§é’¥æ‰èƒ½è§£å¯†ã€‚ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œåªæœ‰å…¬é’¥æ‰èƒ½è§£å¯†ã€‚</p><p>ä¾æ—§ä»¥ä¸Šè¿°ä¸ºä¾‹ï¼Œéå¯¹ç§°åŠ å¯†çš„ç§é’¥æ”¾åœ¨é“¶è¡Œç½‘ç«™ä¸Šï¼Œä¸åœ¨äº’è”ç½‘ä¸Šä¼ æ’­ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ç§é’¥çš„ç§å¯†æ€§ï¼›é“¶è¡Œç½‘ç«™ä¼ æ’­å¯¹åº”ç§é’¥çš„å…¬é’¥ã€‚</p><p>è¿™æ ·ï¼Œå®¢æˆ·ç«¯ç»™å¤–å–ç½‘ç«™å‘é€çš„æ—¶å€™ï¼Œç”¨å¤–å–ç½‘ç«™çš„å…¬é’¥åŠ å¯†ã€‚è€Œå¤–å–ç½‘ç«™ç»™å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œä½¿ç”¨å®¢æˆ·ç«¯çš„å…¬é’¥ã€‚è¿™æ ·å°±ç®—æœ‰é»‘å®¢ä¼å›¾æ¨¡æ‹Ÿå®¢æˆ·ç«¯è·å–ä¸€äº›ä¿¡æ¯ï¼Œæˆ–è€…åŠè·¯æˆªè·å›å¤ä¿¡æ¯ï¼Œä½†æ˜¯ç”±äºå®ƒæ²¡æœ‰ç§é’¥ï¼Œè¿™äº›ä¿¡æ¯å®ƒè¿˜æ˜¯æ‰“ä¸å¼€ã€‚</p><p>éå¯¹ç§°åŠ å¯†çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å°†å…¬é’¥ç»™å¯¹æ–¹ï¼š </p><ol><li>æ”¾åœ¨ä¸€ä¸ªå…¬ç½‘çš„åœ°å€ä¸Šï¼Œä¾›ä¸‹è½½ä½¿ç”¨</li><li>åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œä¼ ç»™å¯¹æ–¹</li></ol><p>éœ€è¦æƒå¨éƒ¨é—¨çš„è®¤è¯æ¥è¯æ˜æˆ‘çš„å…¬é’¥æ˜¯å®˜æ–¹çš„ï¼Œéœ€è¦è¯ä¹¦ã€‚è¯ä¹¦é‡Œé¢åŒ…å«å…¬é’¥è¿˜æœ‰è¯ä¹¦çš„æ‰€æœ‰è€…ã€‚æ³¨æ„æƒå¨éƒ¨é—¨æ˜¯åˆ†å±‚çº§çš„ï¼Œé€šè¿‡å±‚å±‚æˆä¿¡èƒŒä¹¦çš„æ–¹å¼ï¼Œæ¥ä¿è¯éå¯¹ç§°åŠ å¯†æ¨¡å¼çš„æ­£å¸¸è¿è½¬ã€‚</p><h2 id="2-2-HTTPSçš„å·¥ä½œæ¨¡å¼"><a href="#2-2-HTTPSçš„å·¥ä½œæ¨¡å¼" class="headerlink" title="2.2 HTTPSçš„å·¥ä½œæ¨¡å¼"></a>2.2 HTTPSçš„å·¥ä½œæ¨¡å¼</h2><p>åˆ©ç”¨éå¯¹ç§°åŠ å¯†æ¥ä¼ è¾“å¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œè€ŒçœŸæ­£çš„åŒæ–¹å¤§æ•°æ®é‡çš„é€šä¿¡éƒ½æ˜¯é€šè¿‡å¯¹ç§°åŠ å¯†æ¥è¿›è¡Œçš„ã€‚ </p><p><img src="https://i.loli.net/2020/02/02/9o2gqFN1pmkKSte.jpg" alt="fig8.jpg"></p><p>å½“ä½ ç™»å½•ä¸€ä¸ªå¤–å–ç½‘ç«™çš„æ—¶å€™ï¼Œç”±äºæ˜¯ HTTPSï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ Client Hello æ¶ˆæ¯åˆ°æœåŠ¡å™¨ï¼Œä»¥æ˜æ–‡ä¼ è¾“ TLS ç‰ˆæœ¬ä¿¡æ¯ã€åŠ å¯†å¥—ä»¶å€™é€‰åˆ—è¡¨ã€å‹ç¼©ç®—æ³•å€™é€‰åˆ—è¡¨ç­‰ä¿¡æ¯ã€‚å¦å¤–ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªéšæœºæ•°ï¼Œåœ¨åå•†å¯¹ç§°å¯†é’¥çš„æ—¶å€™ä½¿ç”¨ã€‚</p><p>ç„¶åï¼Œå¤–å–ç½‘ç«™è¿”å› Server Hello æ¶ˆæ¯, å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨é€‰æ‹©ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ã€åŠ å¯†å¥—ä»¶ã€å‹ç¼©ç®—æ³•ç­‰ï¼Œè¿˜æœ‰ä¸€ä¸ªéšæœºæ•°ï¼Œç”¨äºåç»­çš„å¯†é’¥åå•†ã€‚</p><p>ç„¶åï¼Œå¤–å–ç½‘ç«™ä¼šç»™ä½ ä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„è¯ä¹¦ï¼Œç„¶åè¯´ï¼šâ€œServer Hello Doneï¼Œæˆ‘è¿™é‡Œå°±è¿™äº›ä¿¡æ¯äº†ã€‚â€</p><p>ä½ å½“ç„¶ä¸ç›¸ä¿¡è¿™ä¸ªè¯ä¹¦ï¼Œäºæ˜¯ä½ ä»è‡ªå·±ä¿¡ä»»çš„ CA ä»“åº“ä¸­ï¼Œæ‹¿ CA çš„è¯ä¹¦é‡Œé¢çš„å…¬é’¥å»è§£å¯†å¤–å–ç½‘ç«™çš„è¯ä¹¦ã€‚å¦‚æœèƒ½å¤ŸæˆåŠŸï¼Œåˆ™è¯´æ˜å¤–å–ç½‘ç«™æ˜¯å¯ä¿¡çš„ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½ä¼šä¸æ–­å¾€ä¸Šè¿½æº¯ CAã€CA çš„ CAã€CA çš„ CA çš„ CAï¼Œåæ­£ç›´åˆ°ä¸€ä¸ªæˆä¿¡çš„ CAï¼Œå°±å¯ä»¥äº†ã€‚</p><p>è¯ä¹¦éªŒè¯å®Œæ¯•ä¹‹åï¼Œè§‰å¾—è¿™ä¸ªå¤–å–ç½‘ç«™å¯ä¿¡ï¼Œäºæ˜¯å®¢æˆ·ç«¯è®¡ç®—äº§ç”Ÿéšæœºæ•°å­— Pre-masterï¼Œå‘é€ Client Key Exchangeï¼Œç”¨è¯ä¹¦ä¸­çš„å…¬é’¥åŠ å¯†ï¼Œå†å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¯ä»¥é€šè¿‡ç§é’¥è§£å¯†å‡ºæ¥ã€‚</p><p>æ­¤æ—¶æ— è®ºæ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨éƒ½æœ‰ä¸‰ä¸ªéšæœºæ•°ï¼šè‡ªå·±çš„ï¼Œå¯¹ç«¯çš„ï¼Œä»¥åŠåˆšç”Ÿæˆçš„Pre-Masteréšæœºæ•°ã€‚é€šè¿‡è¿™ä¸‰ä¸ªéšæœºæ•°ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº§ç”Ÿç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚</p><p>å®¢æˆ·ç«¯Change Cipher Spec, å¼€å§‹é‡‡ç”¨åå•†çš„é€šä¿¡å¯†é’¥å’ŒåŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡äº†ã€‚ç„¶åå‘é€ä¸€ä¸ª Encrypted Handshake Messageï¼Œå°†å·²ç»å•†å®šå¥½çš„å‚æ•°ç­‰ï¼Œé‡‡ç”¨åå•†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œå‘é€ç»™æœåŠ¡å™¨ç”¨äºæ•°æ®ä¸æ¡æ‰‹éªŒè¯ã€‚</p><h1 id="3-RTMPåè®®"><a href="#3-RTMPåè®®" class="headerlink" title="3. RTMPåè®®"></a>3. RTMPåè®®</h1><p>Real Time Messaging </p><p>RTMPåè®®æ˜¯åº”ç”¨å±‚åè®®ï¼Œæ˜¯è¦é åº•å±‚å¯é çš„ä¼ è¾“å±‚åè®®ï¼ˆé€šå¸¸æ˜¯TCPï¼‰æ¥ä¿è¯ä¿¡æ¯ä¼ è¾“çš„å¯é æ€§çš„ã€‚åœ¨åŸºäºä¼ è¾“å±‚åè®®çš„é“¾æ¥å»ºç«‹å®Œæˆåï¼ŒRTMPåè®®ä¹Ÿè¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šè¿‡â€œæ¡æ‰‹â€æ¥å»ºç«‹åŸºäºä¼ è¾“å±‚é“¾æ¥ä¹‹ä¸Šçš„RTMP Connectioné“¾æ¥ï¼Œåœ¨Connectioné“¾æ¥ä¸Šä¼šä¼ è¾“ä¸€äº›æ§åˆ¶ä¿¡æ¯ï¼Œå¦‚SetChunkSize,SetACKWindowSizeã€‚å…¶ä¸­CreateStreamå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªStreamé“¾æ¥ï¼Œç”¨äºä¼ è¾“å…·ä½“çš„éŸ³è§†é¢‘æ•°æ®å’Œæ§åˆ¶è¿™äº›ä¿¡æ¯ä¼ è¾“çš„å‘½ä»¤ä¿¡æ¯ã€‚RTMPåè®®ä¼ è¾“æ—¶ä¼šå¯¹æ•°æ®åšè‡ªå·±çš„æ ¼å¼åŒ–ï¼Œè¿™ç§æ ¼å¼çš„æ¶ˆæ¯æˆ‘ä»¬ç§°ä¹‹ä¸ºRTMP Messageï¼Œè€Œå®é™…ä¼ è¾“çš„æ—¶å€™ä¸ºäº†æ›´å¥½åœ°å®ç°å¤šè·¯å¤ç”¨ã€åˆ†åŒ…å’Œä¿¡æ¯çš„å…¬å¹³æ€§ï¼Œå‘é€ç«¯ä¼šæŠŠMessageåˆ’åˆ†ä¸ºå¸¦æœ‰Message IDçš„Chunkï¼Œæ¯ä¸ªChunkå¯èƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„Messageï¼Œä¹Ÿå¯èƒ½æ˜¯Messageçš„ä¸€éƒ¨åˆ†ï¼Œåœ¨æ¥å—ç«¯ä¼šæ ¹æ®chunkä¸­åŒ…å«çš„dataçš„é•¿åº¦ï¼Œmessage idå’Œmessageçš„é•¿åº¦æŠŠchunkè¿˜åŸæˆå®Œæ•´çš„Messageï¼Œä»è€Œå®ç°ä¿¡æ¯çš„æ”¶å‘ã€‚</p><p>è¯¦ç»†åº”ç”¨è§<a href="https://www.llchen60.com/2019/01/06/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%83-%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE-%E7%BD%91%E7%BB%9C%E7%9B%B4%E6%92%AD%E5%BD%93%E4%B8%AD%E7%9A%84%E8%A7%86%E9%A2%91%E5%8E%8B%E7%BC%A9%E4%B8%8E%E4%BC%A0%E6%92%AD%E9%97%AE%E9%A2%98/">ç½‘ç»œåè®®-ä¸ƒ-æµåª’ä½“åè®®-ç½‘ç»œç›´æ’­å½“ä¸­çš„è§†é¢‘å‹ç¼©ä¸ä¼ æ’­é—®é¢˜</a></p><h1 id="4-HTTPçš„å†å²"><a href="#4-HTTPçš„å†å²" class="headerlink" title="4. HTTPçš„å†å²"></a>4. HTTPçš„å†å²</h1><h2 id="4-1-HTTP-0-9-1-0"><a href="#4-1-HTTP-0-9-1-0" class="headerlink" title="4.1 HTTP 0.9/ 1.0"></a>4.1 HTTP 0.9/ 1.0</h2><ul><li>0.9åè®®ååˆ†ç®€å•<ul><li>ä¸æ”¯æŒè¯·æ±‚å¤´</li><li>åªæ”¯æŒGETæ–¹æ³•</li></ul></li><li>1.0 æ‰©å±•äº†0.9<ul><li>è¯·æ±‚ä¸­åŠ å…¥äº†HTTPç‰ˆæœ¬å·</li><li>æœ‰Headerï¼Œä¸ç®¡æ˜¯requestè¿˜æ˜¯responseéƒ½æœ‰header<ul><li>å°†å…ƒæ•°æ®å’Œä¸šåŠ¡æ•°æ®è§£è€¦ï¼Œä¹Ÿå¯ä»¥æˆä¸ºä¸šåŠ¡é€»è¾‘å’Œæ§åˆ¶é€»è¾‘çš„åˆ†ç¦» </li></ul></li><li>å¢åŠ äº†HTTP status codeæ ‡è¯†ç›¸å…³çš„çŠ¶æ€ç </li><li>content-typeå¯ä»¥ä¼ è¾“å…¶å®ƒæ–‡ä»¶äº†</li><li>ç¼ºç‚¹æ˜¯<ul><li>æ¯è¯·æ±‚ä¸€ä¸ªèµ„æºå°±è¦æ–°å»ºä¸€ä¸ªTCPè¿æ¥ï¼Œè€Œä¸”æ˜¯ä¸²è¡Œè¯·æ±‚çš„</li></ul></li></ul></li></ul><h2 id="4-2-HTTP-1-1"><a href="#4-2-HTTP-1-1" class="headerlink" title="4.2 HTTP/1.1"></a>4.2 HTTP/1.1</h2><p>ä¸»è¦ç›®çš„åœ¨äºè§£å†³HTTP1.0çš„ç½‘ç»œæ€§èƒ½é—®é¢˜ï¼Œä»¥åŠï¼š</p><ul><li>å¢åŠ <code>keepalive</code>æ¥è®©HTTPé‡ç”¨TCPè¿æ¥ï¼Œé‡ç”¨TCPè¿æ¥å¯ä»¥çœå»æ¯æ¬¡å»ºç«‹è¿æ¥æ—¶éœ€è¦çš„TCPä¸‰æ¬¡æ¡æ‰‹çš„å¼€é”€ â€“ åˆå HTTPé•¿è¿æ¥ - HTTP Persistent Connection </li><li>æ”¯æŒpipelineç½‘ç»œä¼ è¾“<ul><li>åªè¦ç¬¬ä¸€ä¸ªè¯·æ±‚å‘å‡ºï¼Œä¸ç”¨ç­‰åˆ°æ‹¿åˆ°å“åº”å°±å¯ä»¥å‘å‡ºç¬¬äºŒä¸ªè¯·æ±‚äº†</li></ul></li><li>æ”¯æŒ Chunked Responses åœ¨responseçš„æ—¶å€™ä¸å¿…è¯´æ˜Context-lengthã€‚è¿™æ ·å®¢æˆ·ç«¯å°±ç›´åˆ°æ”¶åˆ°æœåŠ¡ç«¯çš„EOFæ ‡è¯†æ‰å¯ä»¥æ–­è¿æ¥äº†ã€‚</li><li>å¢åŠ äº†cache controlæœºåˆ¶</li><li>åè®®å¤´å¢åŠ äº†language, encoding, typeç­‰ç­‰ï¼Œè®©å®¢æˆ·ç«¯å¯ä»¥è·ŸæœåŠ¡å™¨ç«¯è¿›è¡Œæ›´å¤šçš„åå•†</li><li>åŠ äº†<code>Host</code> å¤´ï¼Œè¿™æ ·å­æœåŠ¡å™¨å°±å¯ä»¥ç›´åˆ°ä½ è¦è¯·æ±‚çš„ç½‘ç«™äº†</li></ul><h2 id="4-3-HTTP-2"><a href="#4-3-HTTP-2" class="headerlink" title="4.3 HTTP/2"></a>4.3 HTTP/2</h2><p>HTTP/1.1è™½ç„¶è¯´å¯ä»¥é‡ç”¨TCPè¿æ¥ï¼Œä½†æ˜¯è¯·æ±‚ä¾æ—§ä¸²è¡Œçš„ï¼Œéœ€è¦ä¿è¯å…¶é¡ºåºã€‚ç„¶è€Œï¼Œå¤§é‡çš„ç½‘é¡µè¯·æ±‚ä¸­éƒ½æ˜¯äº›èµ„æºç±»çš„ä¸œè¥¿ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¹¶è¡Œè¿™ç±»è¯·æ±‚ï¼Œé‚£å°±ä¼šå¤§å¤§å¢åŠ ç½‘ç»œååé‡å’Œæ€§èƒ½ã€‚</p><p>å¦å¤–1.1æ˜¯ä»¥æ–‡æœ¬çš„æ–¹å¼æ¥ä¼ è¾“æ•°æ®ï¼Œç„¶ååšzipå‹ç¼©å‡å°‘ç½‘ç»œå¸¦å®½ï¼Œä½†æ˜¯è¿™æ ·åšå°±ä¼šæ¶ˆè€—å‰ç«¯å’Œåç«¯çš„CPUäº†ã€‚HTTP/2å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°çš„æ€§èƒ½é—®é¢˜çš„ã€‚</p><ul><li>äºŒè¿›åˆ¶åè®®ï¼Œå¢åŠ æ•°æ®ä¼ è¾“çš„æ•ˆç‡</li><li>å¯ä»¥åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸­å¹¶å‘è¯·æ±‚å¤šä¸ªHTTPè¯·æ±‚</li><li>å‹ç¼©å¤´ï¼Œå¦‚æœåŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»–ä»¬çš„å¤´æ˜¯ä¸€æ ·çš„æˆ–è€…æ˜¯ç±»ä¼¼çš„ï¼Œé‚£ä¹ˆåè®®å°±ä¼šå¸®åŠ©ä½ æ¶ˆé™¤é‡å¤çš„éƒ¨åˆ†</li><li>å…è®¸æœåŠ¡ç«¯åœ¨å®¢æˆ·ç«¯æ”¾cacheï¼Œåˆå«åšæœåŠ¡ç«¯pushã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ²¡æœ‰è¯·æ±‚çš„ä¸œè¥¿ï¼Œæˆ‘æœåŠ¡ç«¯å¯ä»¥å…ˆé€ç»™ä½ æ”¾åœ¨æœ¬åœ°çš„ç¼“å­˜å½“ä¸­ã€‚</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://coolshell.cn/articles/19840.html" target="_blank" rel="noopener">https://coolshell.cn/articles/19840.html</a> </p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> HTTP 2.0 </tag>
            
            <tag> QUIC </tag>
            
            <tag> HTTPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(äº”)-ä¼ è¾“å±‚</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%94-%E4%BC%A0%E8%BE%93%E5%B1%82/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%94-%E4%BC%A0%E8%BE%93%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="1-UDPåè®®"><a href="#1-UDPåè®®" class="headerlink" title="1. UDPåè®®"></a>1. UDPåè®®</h1><h2 id="1-1-UDPå’ŒTCPåè®®çš„åŒºåˆ«"><a href="#1-1-UDPå’ŒTCPåè®®çš„åŒºåˆ«" class="headerlink" title="1.1 UDPå’ŒTCPåè®®çš„åŒºåˆ«"></a>1.1 UDPå’ŒTCPåè®®çš„åŒºåˆ«</h2><table><thead><tr><th>ç±»å‹</th><th>æ˜¯å¦é¢å‘è¿æ¥</th><th>ä¼ è¾“å¯é æ€§</th><th>ä¼ è¾“å½¢å¼</th><th>ä¼ è¾“æ•ˆç‡</th><th>æ‰€éœ€èµ„æº</th><th>åº”ç”¨åœºæ™¯</th><th>é¦–éƒ¨å­—èŠ‚</th></tr></thead><tbody><tr><td>TCP</td><td>é¢å‘è¿æ¥</td><td>å¯é </td><td>å­—èŠ‚æµ</td><td>æ…¢</td><td>å¤š</td><td>è¦æ±‚é€šä¿¡æ•°æ®å¯é ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰</td><td>20-60</td></tr><tr><td>UDP</td><td>æ— è¿æ¥</td><td>ä¸å¯é </td><td>æ•°æ®æŠ¥æ–‡æ®µ</td><td>å¿«</td><td>å°‘</td><td>è¦æ±‚é€šä¿¡é€Ÿåº¦é«˜ï¼ˆè§†é¢‘ç›´æ’­ï¼‰</td><td>8å­—èŠ‚</td></tr></tbody></table><p>TCPæ˜¯é¢å‘è¿æ¥çš„ï¼ŒUDPæ— è¿æ¥ã€‚</p><p>é¢å‘è¿æ¥æŒ‡ï¼Œåœ¨äº’é€šä¹‹å‰ï¼Œå…ˆå»ºç«‹è¿æ¥ï¼Œæ¯”å¦‚TCPä¸‰æ¬¡æ¡æ‰‹ï¼Œè€ŒUDPä¸ä¼šã€‚å»ºç«‹è¿æ¥æ˜¯ä¸ºäº†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç»´æŠ¤è¿æ¥ï¼Œè€Œå»ºç«‹ä¸€å®šçš„æ•°æ®ç»“æ„æ¥ä¿è¯æ‰€è°“çš„é¢å‘è¿æ¥çš„ç‰¹æ€§ã€‚</p><p>TCPæä¾›å¯é æ”¯ä»˜ï¼ŒUDPä¸ä¿è¯ä¸ä¸¢å¤±ï¼Œä¸ä¿è¯æŒ‰é¡ºåºåˆ°è¾¾</p><p>TCPé¢å‘å­—èŠ‚æµï¼Œå‘é€çš„æ—¶å€™å‘ä¸€ä¸ªæµã€‚è¿™æ˜¯é TCPè‡ªèº«çš„çŠ¶æ€ç»´æŠ¤åšçš„äº‹æƒ…ã€‚</p><p>UDPç»§æ‰¿äº†IPåŒ…çš„ç‰¹æ€§ï¼Œä¸ä¿è¯ä¸ä¸¢å¤±ï¼Œä¸ä¿è¯æŒ‰é¡ºåºåˆ°è¾¾ã€‚</p><p>TCPå…·æœ‰æ‹¥å¡æ§åˆ¶ï¼Œæ„è¯†åˆ°ä¸¢åŒ…æˆ–è€…ç½‘ç»œç¯å¢ƒä¸å¥½ï¼Œä¼šè°ƒæ•´æ•´ä¸ªå‘é€çš„é€Ÿåº¦çš„ã€‚UDPä¸åšè°ƒæ•´ã€‚</p><p>TCPæœ‰çŠ¶æ€æœåŠ¡ï¼Œç²¾ç¡®è®°å½•äº†å‘é€äº†æ²¡æœ‰ï¼Œæ¥æ”¶äº†æ²¡æœ‰ï¼Œä»¥åŠè¯¥æ¥æ”¶å“ªä¸€ä¸ªäº†è¿™æ ·çš„ä¿¡æ¯ã€‚</p><p>å¦‚æœMACå±‚å®šä¹‰äº†æœ¬åœ°å±€åŸŸç½‘çš„ä¼ è¾“è¡Œä¸ºï¼ŒIPå±‚å®šä¹‰äº†æ•´ä¸ªç½‘ç»œç«¯åˆ°ç«¯çš„ä¼ è¾“è¡Œä¸ºï¼Œè¿™ä¸¤å±‚åŸºæœ¬å®šä¹‰äº†ï¼šç½‘ç»œä¼ è¾“æ˜¯ä»¥åŒ…ä¸ºå•ä½çš„ï¼›äºŒå±‚å«å¸§ï¼Œç½‘ç»œå±‚å«åŒ…ï¼Œä¼ è¾“å±‚å«æ®µã€‚åŒ…å•ç‹¬ä¼ è¾“ï¼Œè‡ªè¡Œé€‰æ®µï¼Œåœ¨ä¸åŒçš„è®¾å¤‡å°è£…è§£å°è£…ï¼Œä¸ä¿è¯åˆ°è¾¾ã€‚ </p><h2 id="1-2-UDP-åŒ…å¤´"><a href="#1-2-UDP-åŒ…å¤´" class="headerlink" title="1.2 UDP åŒ…å¤´"></a>1.2 UDP åŒ…å¤´</h2><p>æ¥æ”¶çš„æœºå™¨é€šè¿‡çœ‹IPå¤´é‡Œé¢çš„8ä½åè®®ä½æ¥ç¡®å®šæ•°æ®åˆ°åº•æ˜¯é€šè¿‡TCPè¿˜æ˜¯UDPæ¥ä¼ çš„ã€‚</p><p>æ— è®ºåº”ç”¨ç¨‹åºå†™çš„æ˜¯ç”¨TCPä¼ æ•°æ®è¿˜æ˜¯UDPä¼ æ•°æ®ï¼Œéƒ½è¦ç›‘å¬ä¸€ä¸ªç«¯å£ã€‚æ­£æ˜¯è¿™ä¸ªç«¯å£ç”¨æ¥åŒºåˆ†åº”ç”¨ç¨‹åºï¼Œæ— è®ºæ˜¯TCPè¿˜æ˜¯UDPéƒ½æœ‰ç«¯å£å·ï¼Œæ ¹æ®ç«¯å£å·æ¥å°†æ•°æ®äº¤ç»™ç›¸åº”çš„åº”ç”¨ç¨‹åºã€‚</p><p><img src="https://i.loli.net/2020/02/02/KRSsZMkCaTFN8Vt.jpg" alt="fig1.jpg"></p><h2 id="1-3-UDP-ä½¿ç”¨åœºæ™¯"><a href="#1-3-UDP-ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.3 UDP ä½¿ç”¨åœºæ™¯"></a>1.3 UDP ä½¿ç”¨åœºæ™¯</h2><ol><li><p>éœ€è¦èµ„æºå°‘ï¼Œåœ¨ç½‘ç»œæƒ…å†µæ¯”è¾ƒå¥½çš„å†…ç½‘ï¼Œæˆ–è€…å¯¹äºä¸¢åŒ…ä¸æ•æ„Ÿçš„åº”ç”¨</p><p>DHCP å°±æ˜¯åŸºäº UDP åè®®çš„ã€‚ä¸€èˆ¬çš„è·å– IP åœ°å€éƒ½æ˜¯å†…ç½‘è¯·æ±‚ï¼Œè€Œä¸”ä¸€æ¬¡è·å–ä¸åˆ° IP åˆæ²¡äº‹ï¼Œè¿‡ä¸€ä¼šå„¿è¿˜æœ‰æœºä¼šã€‚æˆ‘ä»¬è®²è¿‡ PXE å¯ä»¥åœ¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨å®‰è£…æ“ä½œç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿé•œåƒçš„ä¸‹è½½ä½¿ç”¨çš„ TFTPï¼Œè¿™ä¸ªä¹Ÿæ˜¯åŸºäº UDP åè®®çš„ã€‚åœ¨è¿˜æ²¡æœ‰æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯æ‹¥æœ‰çš„èµ„æºå¾ˆå°‘ï¼Œä¸é€‚åˆç»´æŠ¤ä¸€ä¸ªå¤æ‚çš„çŠ¶æ€æœºï¼Œè€Œæ˜¯å› ä¸ºæ˜¯å†…ç½‘ï¼Œä¸€èˆ¬ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚</p><ol start="2"><li>ä¸éœ€è¦ä¸€å¯¹ä¸€æ²Ÿé€šï¼Œå»ºç«‹è¿æ¥ï¼Œè€Œæ˜¯å¯ä»¥å¹¿æ’­çš„åº”ç”¨</li></ol></li></ol><p>UDP çš„ä¸é¢å‘è¿æ¥çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿å¾—å¯ä»¥æ‰¿è½½å¹¿æ’­æˆ–è€…å¤šæ’­çš„åè®®ã€‚DHCP å°±æ˜¯ä¸€ç§å¹¿æ’­çš„å½¢å¼ï¼Œå°±æ˜¯åŸºäº UDP åè®®çš„ï¼Œè€Œå¹¿æ’­åŒ…çš„æ ¼å¼å‰é¢è¯´è¿‡äº†ã€‚</p><p>å¯¹äºå¤šæ’­ï¼Œæˆ‘ä»¬åœ¨è®² IP åœ°å€çš„æ—¶å€™ï¼Œè®²è¿‡ä¸€ä¸ª D ç±»åœ°å€ï¼Œä¹Ÿå³ç»„æ’­åœ°å€ï¼Œä½¿ç”¨è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥å°†åŒ…ç»„æ’­ç»™ä¸€æ‰¹æœºå™¨ã€‚å½“ä¸€å°æœºå™¨ä¸Šçš„æŸä¸ªè¿›ç¨‹æƒ³ç›‘å¬æŸä¸ªç»„æ’­åœ°å€çš„æ—¶å€™ï¼Œéœ€è¦å‘é€ IGMP åŒ…ï¼Œæ‰€åœ¨ç½‘ç»œçš„è·¯ç”±å™¨å°±èƒ½æ”¶åˆ°è¿™ä¸ªåŒ…ï¼ŒçŸ¥é“æœ‰ä¸ªæœºå™¨ä¸Šæœ‰ä¸ªè¿›ç¨‹åœ¨ç›‘å¬è¿™ä¸ªç»„æ’­åœ°å€ã€‚å½“è·¯ç”±å™¨æ”¶åˆ°è¿™ä¸ªç»„æ’­åœ°å€çš„æ—¶å€™ï¼Œä¼šå°†åŒ…è½¬å‘ç»™è¿™å°æœºå™¨ï¼Œè¿™æ ·å°±å®ç°äº†è·¨è·¯ç”±å™¨çš„ç»„æ’­ã€‚</p><ol start="3"><li>éœ€è¦å¤„ç†é€Ÿåº¦å¿«ï¼Œæ—¶å»¶ä½ï¼Œå¯ä»¥å®¹å¿å°‘æ•°ä¸¢åŒ…ï¼Œä½†æ˜¯è¦æ±‚å³ä¾¿ç½‘ç»œæ‹¥å¡ï¼Œä¹Ÿæ¯«ä¸é€€ç¼©ï¼Œä¸€å¾€æ— å‰çš„æ—¶å€™</li></ol><p>åŒç†ï¼ŒUDP ç®€å•ã€å¤„ç†é€Ÿåº¦å¿«ï¼Œä¸åƒ TCP é‚£æ ·ï¼Œæ“è¿™ä¹ˆå¤šçš„å¿ƒï¼Œå„ç§é‡ä¼ å•Šï¼Œä¿è¯é¡ºåºå•Šï¼Œå‰é¢çš„ä¸æ”¶åˆ°ï¼Œåé¢çš„æ²¡æ³•å¤„ç†å•Šã€‚ä¸ç„¶ç­‰è¿™äº›äº‹æƒ…åšå®Œäº†ï¼Œæ—¶å»¶æ—©å°±ä¸Šå»äº†ã€‚è€Œ TCP åœ¨ç½‘ç»œä¸å¥½å‡ºç°ä¸¢åŒ…çš„æ—¶å€™ï¼Œæ‹¥å¡æ§åˆ¶ç­–ç•¥ä¼šä¸»åŠ¨çš„é€€ç¼©ï¼Œé™ä½å‘é€é€Ÿåº¦ï¼Œè¿™å°±ç›¸å½“äºæœ¬æ¥ç¯å¢ƒå°±å·®ï¼Œè¿˜è‡ªæ–­è‡‚è†€ï¼Œç”¨æˆ·æœ¬æ¥å°±å¡ï¼Œè¿™ä¸‹æ›´å¡äº†ã€‚</p><p>å½“å‰å¾ˆå¤šåº”ç”¨éƒ½æ˜¯è¦æ±‚ä½æ—¶å»¶çš„ï¼Œå®ƒä»¬å¯ä¸æƒ³ç”¨ TCP å¦‚æ­¤å¤æ‚çš„æœºåˆ¶ï¼Œè€Œæ˜¯æƒ³æ ¹æ®è‡ªå·±çš„åœºæ™¯ï¼Œå®ç°è‡ªå·±çš„å¯é å’Œè¿æ¥ä¿è¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨è‡ªå·±è§‰å¾—ï¼Œæœ‰çš„åŒ…ä¸¢äº†å°±ä¸¢äº†ï¼Œæ²¡å¿…è¦é‡ä¼ äº†ï¼Œå°±å¯ä»¥ç®—äº†ï¼Œæœ‰çš„æ¯”è¾ƒé‡è¦ï¼Œåˆ™åº”ç”¨è‡ªå·±é‡ä¼ ï¼Œè€Œä¸ä¾èµ–äº TCPã€‚æœ‰çš„å‰é¢çš„åŒ…æ²¡åˆ°ï¼Œåé¢çš„åŒ…åˆ°äº†ï¼Œé‚£å°±å…ˆç»™å®¢æˆ·å±•ç¤ºåé¢çš„å˜›ï¼Œå¹²å˜›éå¾—ç­‰åˆ°é½äº†å‘¢ï¼Ÿå¦‚æœç½‘ç»œä¸å¥½ï¼Œä¸¢äº†åŒ…ï¼Œé‚£ä¸èƒ½é€€ç¼©å•Šï¼Œè¦å°½å¿«ä¼ å•Šï¼Œé€Ÿåº¦ä¸èƒ½é™ä¸‹æ¥å•Šï¼Œè¦æŒ¤å å¸¦å®½ï¼ŒæŠ¢åœ¨å®¢æˆ·å¤±å»è€å¿ƒä¹‹å‰åˆ°è¾¾ã€‚</p><h2 id="1-4-UDPçš„åº”ç”¨å®ä¾‹"><a href="#1-4-UDPçš„åº”ç”¨å®ä¾‹" class="headerlink" title="1.4 UDPçš„åº”ç”¨å®ä¾‹"></a>1.4 UDPçš„åº”ç”¨å®ä¾‹</h2><h3 id="1-4-1-ç½‘é¡µæˆ–è€…APPçš„è®¿é—®"><a href="#1-4-1-ç½‘é¡µæˆ–è€…APPçš„è®¿é—®" class="headerlink" title="1.4.1 ç½‘é¡µæˆ–è€…APPçš„è®¿é—®"></a>1.4.1 ç½‘é¡µæˆ–è€…APPçš„è®¿é—®</h3><p>åŸæ¥è®¿é—®ç½‘é¡µå’Œæ‰‹æœº APP éƒ½æ˜¯åŸºäº HTTP åè®®çš„ã€‚HTTP åè®®æ˜¯åŸºäº TCP çš„ï¼Œå»ºç«‹è¿æ¥éƒ½éœ€è¦å¤šæ¬¡äº¤äº’ï¼Œå¯¹äºæ—¶å»¶æ¯”è¾ƒå¤§çš„ç›®å‰ä¸»æµçš„ç§»åŠ¨äº’è”ç½‘æ¥è®²ï¼Œå»ºç«‹ä¸€æ¬¡è¿æ¥éœ€è¦çš„æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œç„¶è€Œæ—¢ç„¶æ˜¯ç§»åŠ¨ä¸­ï¼ŒTCP å¯èƒ½è¿˜ä¼šæ–­äº†é‡è¿ï¼Œä¹Ÿæ˜¯å¾ˆè€—æ—¶çš„ã€‚è€Œä¸”ç›®å‰çš„ HTTP åè®®ï¼Œå¾€å¾€é‡‡å–å¤šä¸ªæ•°æ®é€šé“å…±äº«ä¸€ä¸ªè¿æ¥çš„æƒ…å†µï¼Œè¿™æ ·æœ¬æ¥ä¸ºäº†åŠ å¿«ä¼ è¾“é€Ÿåº¦ï¼Œ<strong>ä½†æ˜¯ TCP çš„ä¸¥æ ¼é¡ºåºç­–ç•¥ä½¿å¾—å“ªæ€•å…±äº«é€šé“ï¼Œå‰ä¸€ä¸ªä¸æ¥ï¼Œåä¸€ä¸ªå’Œå‰ä¸€ä¸ªå³ä¾¿æ²¡å…³ç³»ï¼Œä¹Ÿè¦ç­‰ç€ï¼Œæ—¶å»¶ä¹Ÿä¼šåŠ å¤§ã€‚</strong></p><p>è€ŒQUIC (Quick UDP Internet Connections)æ˜¯è°·æ­Œæå‡ºçš„ä¸€ç§åŸºäºUDPæ”¹è¿›çš„é€šä¿¡åè®®ï¼ŒQUIC åœ¨åº”ç”¨å±‚ä¸Šï¼Œä¼šè‡ªå·±å®ç°å¿«é€Ÿè¿æ¥å»ºç«‹ã€å‡å°‘é‡ä¼ æ—¶å»¶ï¼Œè‡ªé€‚åº”æ‹¥å¡æ§åˆ¶ï¼Œæ˜¯åº”ç”¨å±‚â€œåŸä¼šç©â€çš„ä»£è¡¨ã€‚è¿™ä¸€èŠ‚ä¸»è¦æ˜¯è®² UDPï¼ŒQUIC æˆ‘ä»¬æ”¾åˆ°åº”ç”¨å±‚å»è®²ã€‚</p><h3 id="1-4-2-æµåª’ä½“çš„åè®®"><a href="#1-4-2-æµåª’ä½“çš„åè®®" class="headerlink" title="1.4.2 æµåª’ä½“çš„åè®®"></a>1.4.2 æµåª’ä½“çš„åè®®</h3><p>ç°åœ¨ç›´æ’­æ¯”è¾ƒç«ï¼Œç›´æ’­åè®®å¤šä½¿ç”¨ RTMPï¼Œè¿™ä¸ªåè®®æˆ‘ä»¬åé¢çš„ç« èŠ‚ä¹Ÿä¼šè®²ï¼Œè€Œè¿™ä¸ª RTMP åè®®ä¹Ÿæ˜¯åŸºäº TCP çš„ã€‚TCP çš„ä¸¥æ ¼é¡ºåºä¼ è¾“è¦ä¿è¯å‰ä¸€ä¸ªæ”¶åˆ°äº†ï¼Œä¸‹ä¸€ä¸ªæ‰èƒ½ç¡®è®¤ï¼Œå¦‚æœå‰ä¸€ä¸ªæ”¶ä¸åˆ°ï¼Œä¸‹ä¸€ä¸ªå°±ç®—åŒ…å·²ç»æ”¶åˆ°äº†ï¼Œåœ¨ç¼“å­˜é‡Œé¢ï¼Œä¹Ÿéœ€è¦ç­‰ç€ã€‚å¯¹äºç›´æ’­æ¥è®²ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ï¼Œå› ä¸ºè€çš„è§†é¢‘å¸§ä¸¢äº†å…¶å®ä¹Ÿå°±ä¸¢äº†ï¼Œå°±ç®—å†ä¼ è¿‡æ¥ç”¨æˆ·ä¹Ÿä¸åœ¨æ„äº†ï¼Œä»–ä»¬è¦çœ‹æ–°çš„äº†ï¼Œå¦‚æœè€æ˜¯æ²¡æ¥å°±ç­‰ç€ï¼Œå¡é¡¿äº†ï¼Œæ–°çš„ä¹Ÿçœ‹ä¸äº†ï¼Œé‚£å°±ä¼šä¸¢å¤±å®¢æˆ·ï¼Œæ‰€ä»¥ç›´æ’­ï¼Œå®æ—¶æ€§æ¯”è¾ƒæ¯”è¾ƒé‡è¦ï¼Œå®å¯ä¸¢åŒ…ï¼Œä¹Ÿä¸è¦å¡é¡¿çš„ã€‚</p><p>å¦å¤–ï¼Œå¯¹äºä¸¢åŒ…ï¼Œå…¶å®å¯¹äºè§†é¢‘æ’­æ”¾æ¥è®²ï¼Œæœ‰çš„åŒ…å¯ä»¥ä¸¢ï¼Œæœ‰çš„åŒ…ä¸èƒ½ä¸¢ï¼Œå› ä¸ºè§†é¢‘çš„è¿ç»­å¸§é‡Œé¢ï¼Œæœ‰çš„å¸§é‡è¦ï¼Œæœ‰çš„ä¸é‡è¦ï¼Œå¦‚æœå¿…é¡»è¦ä¸¢åŒ…ï¼Œéš”å‡ ä¸ªå¸§ä¸¢ä¸€ä¸ªï¼Œå…¶å®çœ‹è§†é¢‘çš„äººä¸ä¼šæ„ŸçŸ¥ï¼Œä½†æ˜¯å¦‚æœè¿ç»­ä¸¢å¸§ï¼Œå°±ä¼šæ„ŸçŸ¥äº†ï¼Œå› è€Œåœ¨ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨å¸Œæœ›é€‰æ‹©æ€§çš„ä¸¢å¸§ã€‚</p><p>è¿˜æœ‰å°±æ˜¯å½“ç½‘ç»œä¸å¥½çš„æ—¶å€™ï¼ŒTCP åè®®ä¼šä¸»åŠ¨é™ä½å‘é€é€Ÿåº¦ï¼Œè¿™å¯¹æœ¬æ¥å½“æ—¶å°±å¡çš„çœ‹è§†é¢‘æ¥è®²æ˜¯è¦å‘½çš„ï¼Œåº”è¯¥åº”ç”¨å±‚é©¬ä¸Šé‡ä¼ ï¼Œè€Œä¸æ˜¯ä¸»åŠ¨è®©æ­¥ã€‚å› è€Œï¼Œå¾ˆå¤šç›´æ’­åº”ç”¨ï¼Œéƒ½åŸºäº UDP å®ç°äº†è‡ªå·±çš„è§†é¢‘ä¼ è¾“åè®®ã€‚</p><h3 id="1-4-3-å®æ—¶æ¸¸æˆ"><a href="#1-4-3-å®æ—¶æ¸¸æˆ" class="headerlink" title="1.4.3 å®æ—¶æ¸¸æˆ"></a>1.4.3 å®æ—¶æ¸¸æˆ</h3><p>æ¸¸æˆæœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®æ—¶æ€§æ¯”è¾ƒé«˜ã€‚å¿«ä¸€ç§’ä½ å¹²æ‰åˆ«äººï¼Œæ…¢ä¸€ç§’ä½ è¢«åˆ«äººçˆ†å¤´ï¼Œæ‰€ä»¥å¾ˆå¤šèŒä¸šç©å®¶ä¼šä¹°éå¸¸ä¸“ä¸šçš„é¼ æ ‡å’Œé”®ç›˜ï¼Œäº‰åˆ†å¤ºç§’ã€‚</p><p>å› è€Œï¼Œå®æ—¶æ¸¸æˆä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¦å»ºç«‹é•¿è¿æ¥ï¼Œæ¥ä¿è¯å®æ—¶ä¼ è¾“ã€‚ä½†æ˜¯æ¸¸æˆç©å®¶å¾ˆå¤šï¼ŒæœåŠ¡å™¨å´ä¸å¤šã€‚ç”±äºç»´æŠ¤ TCP è¿æ¥éœ€è¦åœ¨å†…æ ¸ç»´æŠ¤ä¸€äº›æ•°æ®ç»“æ„ï¼Œå› è€Œä¸€å°æœºå™¨èƒ½å¤Ÿæ”¯æ’‘çš„ TCP è¿æ¥æ•°ç›®æ˜¯æœ‰é™çš„ï¼Œç„¶å UDP ç”±äºæ˜¯æ²¡æœ‰è¿æ¥çš„ï¼Œåœ¨å¼‚æ­¥ IO æœºåˆ¶å¼•å…¥ä¹‹å‰ï¼Œå¸¸å¸¸æ˜¯åº”å¯¹æµ·é‡å®¢æˆ·ç«¯è¿æ¥çš„ç­–ç•¥ã€‚</p><p>å¦å¤–è¿˜æ˜¯ TCP çš„å¼ºé¡ºåºé—®é¢˜ï¼Œå¯¹æˆ˜çš„æ¸¸æˆï¼Œå¯¹ç½‘ç»œçš„è¦æ±‚å¾ˆç®€å•ï¼Œç©å®¶é€šè¿‡å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨é¼ æ ‡å’Œé”®ç›˜è¡Œèµ°çš„ä½ç½®ï¼ŒæœåŠ¡å™¨ä¼šå¤„ç†æ¯ä¸ªç”¨æˆ·å‘é€è¿‡æ¥çš„æ‰€æœ‰åœºæ™¯ï¼Œå¤„ç†å®Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è§£æå“åº”ï¼Œæ¸²æŸ“æœ€æ–°çš„åœºæ™¯å±•ç¤ºç»™ç©å®¶ã€‚</p><p>å¦‚æœå‡ºç°ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œæ‰€æœ‰äº‹æƒ…éƒ½éœ€è¦åœä¸‹æ¥ç­‰å¾…è¿™ä¸ªæ•°æ®åŒ…é‡å‘ã€‚å®¢æˆ·ç«¯ä¼šå‡ºç°ç­‰å¾…æ¥æ”¶æ•°æ®ï¼Œç„¶è€Œç©å®¶å¹¶ä¸å…³å¿ƒè¿‡æœŸçš„æ•°æ®ï¼Œæ¿€æˆ˜ä¸­å¡ 1 ç§’ï¼Œç­‰èƒ½åŠ¨äº†éƒ½å·²ç»æ­»äº†ã€‚æ¸¸æˆå¯¹å®æ—¶è¦æ±‚è¾ƒä¸ºä¸¥æ ¼çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨è‡ªå®šä¹‰çš„å¯é  UDP åè®®ï¼Œè‡ªå®šä¹‰é‡ä¼ ç­–ç•¥ï¼Œèƒ½å¤ŸæŠŠä¸¢åŒ…äº§ç”Ÿçš„å»¶è¿Ÿé™åˆ°æœ€ä½ï¼Œå°½é‡å‡å°‘ç½‘ç»œé—®é¢˜å¯¹æ¸¸æˆæ€§é€ æˆçš„å½±å“ã€‚</p><h3 id="1-4-4-ç‰©è”ç½‘"><a href="#1-4-4-ç‰©è”ç½‘" class="headerlink" title="1.4.4 ç‰©è”ç½‘"></a>1.4.4 ç‰©è”ç½‘</h3><p>ä¸€æ–¹é¢ï¼Œç‰©è”ç½‘é¢†åŸŸç»ˆç«¯èµ„æºå°‘ï¼Œå¾ˆå¯èƒ½åªæ˜¯ä¸ªå†…å­˜éå¸¸å°çš„åµŒå…¥å¼ç³»ç»Ÿï¼Œè€Œç»´æŠ¤ TCP åè®®ä»£ä»·å¤ªå¤§ï¼›å¦ä¸€æ–¹é¢ï¼Œç‰©è”ç½‘å¯¹å®æ—¶æ€§è¦æ±‚ä¹Ÿå¾ˆé«˜ï¼Œè€Œ TCP è¿˜æ˜¯å› ä¸ºä¸Šé¢çš„é‚£äº›åŸå› å¯¼è‡´æ—¶å»¶å¤§ã€‚Google æ——ä¸‹çš„ Nest å»ºç«‹ Thread Groupï¼Œæ¨å‡ºäº†ç‰©è”ç½‘é€šä¿¡åè®® Threadï¼Œå°±æ˜¯åŸºäº UDP åè®®çš„ã€‚</p><h3 id="1-4-5-ç§»åŠ¨é€šä¿¡é¢†åŸŸ"><a href="#1-4-5-ç§»åŠ¨é€šä¿¡é¢†åŸŸ" class="headerlink" title="1.4.5 ç§»åŠ¨é€šä¿¡é¢†åŸŸ"></a>1.4.5 ç§»åŠ¨é€šä¿¡é¢†åŸŸ</h3><p>4Gç½‘ç»œä¸­ç§»åŠ¨æµé‡ä¸Šç½‘çš„æ•°æ®é¢å¯¹çš„åè®®GTP-Uå°±æ˜¯åŸºäºUDPçš„ã€‚</p><h1 id="2-TCPåè®®"><a href="#2-TCPåè®®" class="headerlink" title="2. TCPåè®®"></a>2. TCPåè®®</h1><p>æ›´å€¾å‘äºç½‘ç»œç¯å¢ƒæ˜¯æ¶åŠ£çš„ï¼Œä¸¢åŒ…ï¼Œä¹±åºï¼Œé‡ä¼ ï¼Œæ‹¥å¡éƒ½æ˜¯å¸¸æœ‰çš„äº‹æƒ…ï¼Œå¾ˆæœ‰å¯èƒ½é€è¾¾ä¸äº†ï¼Œæ‰€ä»¥è¦ä»ç®—æ³•å±‚é¢æ¥ä¿è¯å¯é æ€§ã€‚</p><h1 id="2-1-TCPåŒ…å¤´æ ¼å¼"><a href="#2-1-TCPåŒ…å¤´æ ¼å¼" class="headerlink" title="2.1 TCPåŒ…å¤´æ ¼å¼"></a>2.1 TCPåŒ…å¤´æ ¼å¼</h1><p><img src="https://i.loli.net/2020/02/02/C5bnKw2gUVLj9Ap.jpg" alt="fig2.jpg"></p><ul><li>æºç«¯å£å·-16</li><li>ç›®çš„ç«¯å£å·-16</li></ul><p>æºç«¯å£å·å’Œç›®æ ‡ç«¯å£å·ï¼Œæ¥ç¡®å®šä»å“ªå‘é€ï¼Œè¦å‘é€åˆ°å“ªé‡Œå»ã€‚</p><ul><li>åºå·-32</li></ul><p>ç»™åŒ…ç¼–åºå·ï¼Œè§£å†³åŒ…çš„ä¹±åºé—®é¢˜</p><ul><li>ç¡®è®¤åºå·-32</li></ul><p>å‘å‡ºå»çš„åŒ…è¦æœ‰ç¡®è®¤ï¼Œæ¥ç¡®è®¤å¯¹æ–¹æ”¶åˆ°äº†ã€‚å¦‚æœæ²¡æœ‰æ”¶åˆ°å°±éœ€è¦é‡å‘ï¼Œç›´åˆ°é€è¾¾ä¸ºæ­¢</p><ul><li>é¦–éƒ¨é•¿åº¦-4</li><li>ä¿ç•™ä½-6</li></ul><p>ä¸‹è¿°çš„çŠ¶æ€ä½çš„å­˜åœ¨æ˜¯å› ä¸ºTCPæ˜¯é¢å‘è¿æ¥çš„ï¼ŒåŒæ–¹è¦ç»´æŠ¤è¿æ¥çš„çŠ¶æ€ï¼Œè¿™äº›å¸¦çŠ¶æ€ä½çš„åŒ…çš„å‘é€ï¼Œä¼šå¼•èµ·åŒæ–¹çš„çŠ¶æ€å˜æ›´ã€‚</p><ul><li>URG</li><li>ACK</li></ul><p>å›å¤</p><ul><li>PSH</li><li>RST</li></ul><p>é‡æ–°è¿æ¥</p><ul><li>SYN</li></ul><p>å‘èµ·ä¸€ä¸ªè¿æ¥</p><ul><li>FIN</li></ul><p>ç»“æŸè¿æ¥</p><ul><li>çª—å£å¤§å°-16</li></ul><p>TCPè¦åšæµé‡æ§åˆ¶ï¼Œé€šä¿¡åŒæ–¹å„å£°æ˜ä¸€ä¸ªçª—å£ï¼Œæ ‡è¯†è‡ªå·±å½“å‰çš„å¤„ç†èƒ½åŠ›ï¼Œä¿æŒæ¥æ”¶å’Œå¤„ç†çš„é€Ÿåº¦é€‚å®œã€‚</p><ul><li>æ ¡éªŒå’Œ-16</li><li>ç´§æ€¥æŒ‡é’ˆ-16</li><li>é€‰é¡¹</li><li>æ•°æ®</li></ul><h2 id="2-2-TCPä¸‰æ¬¡æ¡æ‰‹"><a href="#2-2-TCPä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="2.2 TCPä¸‰æ¬¡æ¡æ‰‹"></a>2.2 TCPä¸‰æ¬¡æ¡æ‰‹</h2><p>å®¢æˆ·ç«¯â€“å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„æ•°æ®åŒ…â€“ä¸€æ¬¡æ¡æ‰‹â€“æœåŠ¡ç«¯<br>æœåŠ¡ç«¯â€“å‘é€å¸¦æœ‰ SYN/ACK æ ‡å¿—çš„æ•°æ®åŒ…â€“äºŒæ¬¡æ¡æ‰‹â€“å®¢æˆ·ç«¯<br>ä¼ å›SYNçš„åŸå› ï¼Œç¡®ä¿å°±æ˜¯ä¼ è¿‡æ¥çš„é‚£ä¸ªä¿¡æ¯</p><p>å®¢æˆ·ç«¯â€“å‘é€å¸¦æœ‰å¸¦æœ‰ ACK æ ‡å¿—çš„æ•°æ®åŒ…â€“ä¸‰æ¬¡æ¡æ‰‹â€“æœåŠ¡ç«¯</p><p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šClient ä»€ä¹ˆéƒ½ä¸èƒ½ç¡®è®¤ï¼›Server ç¡®è®¤äº†å¯¹æ–¹å‘é€æ­£å¸¸<br>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šClient ç¡®è®¤äº†ï¼šè‡ªå·±å‘é€ã€æ¥æ”¶æ­£å¸¸ï¼Œå¯¹æ–¹å‘é€ã€æ¥æ”¶æ­£å¸¸ï¼›Server ç¡®è®¤äº†ï¼šè‡ªå·±æ¥æ”¶æ­£å¸¸ï¼Œå¯¹æ–¹å‘é€æ­£å¸¸<br>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šClient ç¡®è®¤äº†ï¼šè‡ªå·±å‘é€ã€æ¥æ”¶æ­£å¸¸ï¼Œå¯¹æ–¹å‘é€ã€æ¥æ”¶æ­£å¸¸ï¼›Server ç¡®è®¤äº†ï¼šè‡ªå·±å‘é€ã€æ¥æ”¶æ­£å¸¸ï¼Œå¯¹æ–¹å‘é€æ¥æ”¶æ­£å¸¸</p><p>ä¸‰æ¬¡æ¡æ‰‹é™¤äº†å»ºç«‹åŒæ–¹çš„è¿æ¥ä»¥å¤–ï¼Œè¿˜è¦è§£å†³TCPåŒ…çš„åºå·é—®é¢˜ã€‚æ¯ä¸ªè¿æ¥éƒ½è¦æœ‰ä¸åŒçš„åºå·ï¼Œè¿™ä¸ªåºå·é˜Ÿåˆ—çš„èµ·å§‹åºå·æ˜¯éšç€æ—¶é—´å˜åŒ–çš„ï¼Œè¿™æ ·å­å¯ä»¥é¿å…æœ‰ä¸€ä¸ªåŒ…åˆ°çš„æœ‰ä¸€ç‚¹æ™šçš„é—®é¢˜ã€‚</p><p>æˆ‘ä»¬åœ¨åšè®¾è®¡çš„æ—¶å€™ï¼Œä¼šå¼€å¯keepaliveæœºåˆ¶ï¼Œå³ä½¿æ²¡æœ‰çœŸå®çš„æ•°æ®åŒ…ï¼Œä¹Ÿä¼šæœ‰æ¢æ´»åŒ…æ¥ä¿è¯è¿æ¥çš„ä¿æŒã€‚</p><p><img src="https://i.loli.net/2020/02/02/n3gk8OYMdvoNHVI.jpg" alt="fig3.jpg"></p><p>ä¸€å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº CLOSED çŠ¶æ€ã€‚å…ˆæ˜¯æœåŠ¡ç«¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº LISTEN çŠ¶æ€ã€‚ç„¶åå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥ SYNï¼Œä¹‹åå¤„äº SYN-SENT çŠ¶æ€ã€‚æœåŠ¡ç«¯æ”¶åˆ°å‘èµ·çš„è¿æ¥ï¼Œè¿”å› SYNï¼Œå¹¶ä¸” ACK å®¢æˆ·ç«¯çš„ SYNï¼Œä¹‹åå¤„äº SYN-RCVD çŠ¶æ€ã€‚å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯å‘é€çš„ SYN å’Œ ACK ä¹‹åï¼Œå‘é€ ACK çš„ ACKï¼Œä¹‹åå¤„äº ESTABLISHED çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¸€å‘ä¸€æ”¶æˆåŠŸäº†ã€‚æœåŠ¡ç«¯æ”¶åˆ° ACK çš„ ACK ä¹‹åï¼Œå¤„äº ESTABLISHED çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¹Ÿä¸€å‘ä¸€æ”¶äº†ã€‚</p><h2 id="2-3-TCPå››æ¬¡æŒ¥æ‰‹"><a href="#2-3-TCPå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="2.3 TCPå››æ¬¡æŒ¥æ‰‹"></a>2.3 TCPå››æ¬¡æŒ¥æ‰‹</h2><p>ä»¥ä¸‹æ˜¯å››æ¬¡æŒ¥æ‰‹çš„çŠ¶æ€æ—¶åºå›¾</p><p><img src="https://i.loli.net/2020/02/02/hLMrV2E5fA67nsw.jpg" alt="fig4.jpg"></p><p>æ–­å¼€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ A è¯´â€œä¸ç©äº†â€ï¼Œå°±è¿›å…¥ FIN_WAIT_1 çš„çŠ¶æ€ï¼ŒB æ”¶åˆ°â€œA ä¸ç©â€çš„æ¶ˆæ¯åï¼Œå‘é€çŸ¥é“äº†ï¼Œå°±è¿›å…¥ CLOSE_WAIT çš„çŠ¶æ€ã€‚</p><p>A æ”¶åˆ°â€œB è¯´çŸ¥é“äº†â€ï¼Œå°±è¿›å…¥ FIN_WAIT_2 çš„çŠ¶æ€ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ B ç›´æ¥è·‘è·¯ï¼Œåˆ™ A å°†æ°¸è¿œåœ¨è¿™ä¸ªçŠ¶æ€ã€‚TCP åè®®é‡Œé¢å¹¶æ²¡æœ‰å¯¹è¿™ä¸ªçŠ¶æ€çš„å¤„ç†ï¼Œä½†æ˜¯ Linux æœ‰ï¼Œå¯ä»¥è°ƒæ•´ tcp_fin_timeout è¿™ä¸ªå‚æ•°ï¼Œè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚</p><p>å¦‚æœ B æ²¡æœ‰è·‘è·¯ï¼Œå‘é€äº†â€œB ä¹Ÿä¸ç©äº†â€çš„è¯·æ±‚åˆ°è¾¾ A æ—¶ï¼ŒA å‘é€â€œçŸ¥é“ B ä¹Ÿä¸ç©äº†â€çš„ ACK åï¼Œä» FIN_WAIT_2 çŠ¶æ€ç»“æŸï¼ŒæŒ‰è¯´ A å¯ä»¥è·‘è·¯äº†ï¼Œä½†æ˜¯æœ€åçš„è¿™ä¸ª ACK ä¸‡ä¸€ B æ”¶ä¸åˆ°å‘¢ï¼Ÿåˆ™ B ä¼šé‡æ–°å‘ä¸€ä¸ªâ€œB ä¸ç©äº†â€ï¼Œè¿™ä¸ªæ—¶å€™ A å·²ç»è·‘è·¯äº†çš„è¯ï¼ŒB å°±å†ä¹Ÿæ”¶ä¸åˆ° ACK äº†ï¼Œå› è€Œ TCP åè®®è¦æ±‚ A æœ€åç­‰å¾…ä¸€æ®µæ—¶é—´ TIME_WAITï¼Œè¿™ä¸ªæ—¶é—´è¦è¶³å¤Ÿé•¿ï¼Œé•¿åˆ°å¦‚æœ B æ²¡æ”¶åˆ° ACK çš„è¯ï¼Œâ€œB è¯´ä¸ç©äº†â€ä¼šé‡å‘çš„ï¼ŒA ä¼šé‡æ–°å‘ä¸€ä¸ª ACK å¹¶ä¸”è¶³å¤Ÿæ—¶é—´åˆ°è¾¾ Bã€‚</p><p>A ç›´æ¥è·‘è·¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒA çš„ç«¯å£å°±ç›´æ¥ç©ºå‡ºæ¥äº†ï¼Œä½†æ˜¯ B ä¸çŸ¥é“ï¼ŒB åŸæ¥å‘è¿‡çš„å¾ˆå¤šåŒ…å¾ˆå¯èƒ½è¿˜åœ¨è·¯ä¸Šï¼Œå¦‚æœ A çš„ç«¯å£è¢«ä¸€ä¸ªæ–°çš„åº”ç”¨å ç”¨äº†ï¼Œè¿™ä¸ªæ–°çš„åº”ç”¨ä¼šæ”¶åˆ°ä¸Šä¸ªè¿æ¥ä¸­ B å‘è¿‡æ¥çš„åŒ…ï¼Œè™½ç„¶åºåˆ—å·æ˜¯é‡æ–°ç”Ÿæˆçš„ï¼Œä½†æ˜¯è¿™é‡Œè¦ä¸Šä¸€ä¸ªåŒä¿é™©ï¼Œé˜²æ­¢äº§ç”Ÿæ··ä¹±ï¼Œå› è€Œä¹Ÿéœ€è¦ç­‰è¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œç­‰åˆ°åŸæ¥ B å‘é€çš„æ‰€æœ‰çš„åŒ…éƒ½æ­»ç¿˜ç¿˜ï¼Œå†ç©ºå‡ºç«¯å£æ¥ã€‚</p><p>ç­‰å¾…çš„æ—¶é—´è®¾ä¸º 2MSLï¼ŒMSLæ˜¯Maximum Segment Lifetime, æŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ã€‚ï¼Œå®ƒæ˜¯ä»»ä½•æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šå­˜åœ¨çš„æœ€é•¿æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æŠ¥æ–‡å°†è¢«ä¸¢å¼ƒã€‚å› ä¸º TCP æŠ¥æ–‡åŸºäºæ˜¯ IP åè®®çš„ï¼Œè€Œ IP å¤´ä¸­æœ‰ä¸€ä¸ª TTL åŸŸï¼Œæ˜¯ IP æ•°æ®æŠ¥å¯ä»¥ç»è¿‡çš„æœ€å¤§è·¯ç”±æ•°ï¼Œæ¯ç»è¿‡ä¸€ä¸ªå¤„ç†ä»–çš„è·¯ç”±å™¨æ­¤å€¼å°±å‡ 1ï¼Œå½“æ­¤å€¼ä¸º 0 åˆ™æ•°æ®æŠ¥å°†è¢«ä¸¢å¼ƒï¼ŒåŒæ—¶å‘é€ ICMP æŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚åè®®è§„å®š MSL ä¸º 2 åˆ†é’Ÿï¼Œå®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„æ˜¯ 30 ç§’ï¼Œ1 åˆ†é’Ÿå’Œ 2 åˆ†é’Ÿç­‰ã€‚</p><h2 id="2-4-TCPçŠ¶æ€æœº"><a href="#2-4-TCPçŠ¶æ€æœº" class="headerlink" title="2.4 TCPçŠ¶æ€æœº"></a>2.4 TCPçŠ¶æ€æœº</h2><p><img src="https://i.loli.net/2020/02/02/uEPq9i54UK2Ya8m.jpg" alt="fig5.jpg"></p><h2 id="2-5-é‡ä¼ ç­–ç•¥"><a href="#2-5-é‡ä¼ ç­–ç•¥" class="headerlink" title="2.5 é‡ä¼ ç­–ç•¥"></a>2.5 é‡ä¼ ç­–ç•¥</h2><p>TCPä¼ è¾“çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ªIDã€‚åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œä¼šå•†å®šèµ·å§‹çš„IDæ˜¯ä»€ä¹ˆï¼Œç„¶åæŒ‰ç…§IDä¸€ä¸ªä¸ªå‘é€ã€‚ä¸ºäº†ä¿è¯ä¸ä¸¢åŒ…ï¼Œå¯¹äºå‘é€çš„åŒ…éƒ½è¦è¿›è¡Œåº”ç­”ï¼Œä½†è¿™ä¸ªåº”ç­”å¹¶ä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥çš„ï¼Œè€Œæ˜¯ä¼šåº”ç­”æŸä¸ªä¹‹å‰çš„IDï¼Œè¡¨ç¤ºéƒ½æ”¶åˆ°äº†ï¼Œè¿™ç§æ¨¡å¼ç§°ä¸º<strong><em>ç´¯è®¡ç¡®è®¤</em></strong> æˆ–è€…<strong><em>ç´¯è®¡åº”ç­”</em></strong>ã€‚</p><h3 id="2-5-1-å‘é€ç«¯ç¼“å­˜ç»“æ„"><a href="#2-5-1-å‘é€ç«¯ç¼“å­˜ç»“æ„" class="headerlink" title="2.5.1 å‘é€ç«¯ç¼“å­˜ç»“æ„"></a>2.5.1 å‘é€ç«¯ç¼“å­˜ç»“æ„</h3><p>ä¸ºäº†è®°å½•æ‰€æœ‰å‘é€çš„åŒ…å’Œæ¥æ”¶çš„åŒ…ï¼ŒTCP ä¹Ÿéœ€è¦å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆ†åˆ«éƒ½æœ‰ç¼“å­˜æ¥ä¿å­˜è¿™äº›è®°å½•ã€‚å‘é€ç«¯çš„ç¼“å­˜é‡Œæ˜¯æŒ‰ç…§åŒ…çš„ ID ä¸€ä¸ªä¸ªæ’åˆ—ï¼Œæ ¹æ®å¤„ç†çš„æƒ…å†µåˆ†æˆå››ä¸ªéƒ¨åˆ†ã€‚</p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šå‘é€äº†å¹¶ä¸”å·²ç»ç¡®è®¤çš„ã€‚è¿™éƒ¨åˆ†å°±æ˜¯ä½ äº¤ä»£ä¸‹å±çš„ï¼Œå¹¶ä¸”ä¹Ÿåšå®Œäº†çš„ï¼Œåº”è¯¥åˆ’æ‰çš„ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ï¼šå‘é€äº†å¹¶ä¸”å°šæœªç¡®è®¤çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ äº¤ä»£ä¸‹å±çš„ï¼Œä½†æ˜¯è¿˜æ²¡åšå®Œçš„ï¼Œéœ€è¦ç­‰å¾…åšå®Œçš„å›å¤ä¹‹åï¼Œæ‰èƒ½åˆ’æ‰ã€‚</p><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ²¡æœ‰å‘é€ï¼Œä½†æ˜¯å·²ç»ç­‰å¾…å‘é€çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ è¿˜æ²¡æœ‰äº¤ä»£ç»™ä¸‹å±ï¼Œä½†æ˜¯é©¬ä¸Šå°±è¦äº¤ä»£çš„ã€‚</p><p>ç¬¬å››éƒ¨åˆ†ï¼šæ²¡æœ‰å‘é€ï¼Œå¹¶ä¸”æš‚æ—¶è¿˜ä¸ä¼šå‘é€çš„ã€‚è¿™éƒ¨åˆ†æ˜¯ä½ è¿˜æ²¡æœ‰äº¤ä»£ç»™ä¸‹å±ï¼Œè€Œä¸”æš‚æ—¶è¿˜ä¸ä¼šäº¤ä»£ç»™ä¸‹å±çš„ã€‚</p><p>åŒºåˆ†ç¬¬ä¸‰ç¬¬å››éƒ¨åˆ†çš„åŸå› æ˜¯ä¸ºäº†è¿›è¡Œæµé‡æ§åˆ¶ - çª—å£å¤§å°ã€‚åœ¨TCPé‡Œï¼Œæ¥æ”¶ç«¯ä¼šç»™å‘é€ç«¯æŠ¥ä¸€ä¸ªçª—å£çš„å¤§å°ï¼Œå«åšAdvertised Window. è¿™ä¸ªçª—å£çš„å¤§å°åº”è¯¥ç­‰äºä¸Šé¢çš„ç¬¬äºŒéƒ¨åˆ†åŠ ä¸Šç¬¬ä¸‰éƒ¨åˆ†ï¼Œè¶…è¿‡äº†è¿™ä¸ªå¤§å°çš„æ¥æ”¶ç«¯æ²¡æ³•æ¥æ”¶ã€‚</p><p>å› æ­¤å‘é€ç«¯éœ€è¦ä¿æŒä»¥ä¸‹çš„æ•°æ®ç»“æ„ï¼š</p><p><img src="https://i.loli.net/2020/02/02/TbYHfF2AS8XNKoR.jpg" alt="fig6.jpg"></p><ul><li>LastByteAckedï¼šç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿</li><li>LastByteSentï¼šç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿</li><li>LastByteAcked + AdvertisedWindowï¼šç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†çš„åˆ†ç•Œçº¿</li></ul><h3 id="2-5-2-æ¥æ”¶ç«¯ç¼“å­˜ç»“æ„"><a href="#2-5-2-æ¥æ”¶ç«¯ç¼“å­˜ç»“æ„" class="headerlink" title="2.5.2 æ¥æ”¶ç«¯ç¼“å­˜ç»“æ„"></a>2.5.2 æ¥æ”¶ç«¯ç¼“å­˜ç»“æ„</h3><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¥å—å¹¶ä¸”ç¡®è®¤è¿‡çš„ã€‚ä¹Ÿå°±æ˜¯æˆ‘é¢†å¯¼äº¤ä»£ç»™æˆ‘ï¼Œå¹¶ä¸”æˆ‘åšå®Œçš„ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ï¼šè¿˜æ²¡æ¥æ”¶ï¼Œä½†æ˜¯é©¬ä¸Šå°±èƒ½æ¥æ”¶çš„ã€‚ä¹Ÿå³æ˜¯æˆ‘è‡ªå·±çš„èƒ½å¤Ÿæ¥å—çš„æœ€å¤§å·¥ä½œé‡ã€‚</p><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¿˜æ²¡æ¥æ”¶ï¼Œä¹Ÿæ²¡æ³•æ¥æ”¶çš„ã€‚ä¹Ÿå³è¶…è¿‡å·¥ä½œé‡çš„éƒ¨åˆ†ï¼Œå®åœ¨åšä¸å®Œã€‚</p><p><img src="https://i.loli.net/2020/02/02/gnSOQJytzlDp2EF.jpg" alt="fig7.jpg"></p><ul><li>MaxRcvBufferï¼šæœ€å¤§ç¼“å­˜çš„é‡ï¼›</li><li>LastByteRead ä¹‹åæ˜¯å·²ç»æ¥æ”¶äº†ï¼Œä½†æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„ï¼›</li><li>NextByteExpected æ˜¯ç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿ã€‚</li></ul><p>ç¬¬äºŒéƒ¨åˆ†çš„çª—å£æœ‰å¤šå¤§å‘¢ï¼Ÿ</p><p>NextByteExpected å’Œ LastByteRead çš„å·®å…¶å®æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„éƒ¨åˆ†å ç”¨æ‰çš„ MaxRcvBuffer çš„é‡ï¼Œæˆ‘ä»¬å®šä¹‰ä¸º Aã€‚AdvertisedWindow å…¶å®æ˜¯ MaxRcvBuffer å‡å» Aã€‚ä¹Ÿå°±æ˜¯ï¼šAdvertisedWindow=MaxRcvBuffer-((NextByteExpected-1)-LastByteRead)ã€‚é‚£ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿åœ¨å“ªé‡Œå‘¢ï¼ŸNextByteExpected åŠ  AdvertisedWindow å°±æ˜¯ç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ LastByteRead åŠ ä¸Š MaxRcvBufferã€‚å…¶ä¸­ç¬¬äºŒéƒ¨åˆ†é‡Œé¢ï¼Œç”±äºå—åˆ°çš„åŒ…å¯èƒ½ä¸æ˜¯é¡ºåºçš„ï¼Œä¼šå‡ºç°ç©ºæŒ¡ï¼Œåªæœ‰å’Œç¬¬ä¸€éƒ¨åˆ†è¿ç»­çš„ï¼Œå¯ä»¥é©¬ä¸Šè¿›è¡Œå›å¤ï¼Œä¸­é—´ç©ºç€çš„éƒ¨åˆ†éœ€è¦ç­‰å¾…ï¼Œå“ªæ€•åé¢çš„å·²ç»æ¥äº†ã€‚</p><h3 id="2-5-3-é¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜"><a href="#2-5-3-é¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜" class="headerlink" title="2.5.3 é¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜"></a>2.5.3 é¡ºåºé—®é¢˜å’Œä¸¢åŒ…é—®é¢˜</h3><p><strong>è¶…æ—¶é‡è¯•</strong>ï¼š å¯¹äºæ¯ä¸€ä¸ªå‘é€äº†ä½†æ˜¯æ²¡æœ‰ACKçš„åŒ…ï¼Œéƒ½è®¾å®šä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¶…è¿‡äº†ä¸€å®šæ—¶é—´å°±é‡æ–°å°è¯•ã€‚è¿™æ˜¯æ—¶é—´ä¸å®œå¤ªçŸ­ï¼Œæ—¶é—´å¿…é¡»å¤§äºå¾€è¿”æ—¶é—´RTT(Round trip time)ï¼Œå¦åˆ™ä¼šå¼•èµ·ä¸å¿…è¦çš„é‡ä¼ ã€‚</p><p>ä¼°è®¡å¾€è¿”æ—¶é—´ï¼Œéœ€è¦ TCP é€šè¿‡é‡‡æ · RTT çš„æ—¶é—´ï¼Œç„¶åè¿›è¡ŒåŠ æƒå¹³å‡ï¼Œç®—å‡ºä¸€ä¸ªå€¼ï¼Œè€Œä¸”è¿™ä¸ªå€¼è¿˜æ˜¯è¦ä¸æ–­å˜åŒ–çš„ï¼Œå› ä¸ºç½‘ç»œçŠ¶å†µä¸æ–­çš„å˜åŒ–ã€‚é™¤äº†é‡‡æ · RTTï¼Œè¿˜è¦é‡‡æ · RTT çš„æ³¢åŠ¨èŒƒå›´ï¼Œè®¡ç®—å‡ºä¸€ä¸ªä¼°è®¡çš„è¶…æ—¶æ—¶é—´ã€‚ç”±äºé‡ä¼ æ—¶é—´æ˜¯ä¸æ–­å˜åŒ–çš„ï¼Œæˆ‘ä»¬ç§°ä¸º<strong><em>è‡ªé€‚åº”é‡ä¼ ç®—æ³•</em></strong></p><p><strong>è¶…æ—¶é—´éš”åŠ å€</strong>ï¼šæ¯å½“é‡åˆ°ä¸€æ¬¡è¶…æ—¶é‡ä¼ çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†ä¸‹ä¸€æ¬¡è¶…æ—¶æ—¶é—´é—´éš”è®¾ä¸ºå…ˆå‰å€¼çš„ä¸¤å€ã€‚ä¸¤æ¬¡è¶…æ—¶ï¼Œå°±è¯´æ˜ç½‘ç»œç¯å¢ƒå·®ï¼Œä¸å®œé¢‘ç¹åå¤å‘é€ã€‚</p><p><strong>å¿«é€Ÿé‡ä¼ æœºåˆ¶</strong>ï¼šæœ‰ä¸€ä¸ªå¯ä»¥å¿«é€Ÿé‡ä¼ çš„æœºåˆ¶ï¼Œå½“æ¥æ”¶æ–¹æ”¶åˆ°ä¸€ä¸ªåºå·å¤§äºä¸‹ä¸€ä¸ªæ‰€æœŸæœ›çš„æŠ¥æ–‡æ®µæ—¶ï¼Œå°±æ£€æµ‹åˆ°äº†æ•°æ®æµä¸­çš„ä¸€ä¸ªé—´æ ¼ï¼Œäºæ˜¯å‘é€ä¸‰ä¸ªå†—ä½™çš„ ACKï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åï¼Œå°±åœ¨å®šæ—¶å™¨è¿‡æœŸä¹‹å‰ï¼Œé‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡æ®µã€‚</p><p>å¦å¤–ä¸€ç§æ–¹å¼æˆä¸º<strong>Selective Acknowledgment(SACK)</strong>, ï¼‰ã€‚è¿™ç§æ–¹å¼éœ€è¦åœ¨ TCP å¤´é‡ŒåŠ ä¸€ä¸ª SACK çš„ä¸œè¥¿ï¼Œå¯ä»¥å°†ç¼“å­˜çš„åœ°å›¾å‘é€ç»™å‘é€æ–¹ã€‚ä¾‹å¦‚å¯ä»¥å‘é€ ACK6ã€SACK8ã€SACK9ï¼Œæœ‰äº†åœ°å›¾ï¼Œå‘é€æ–¹ä¸€ä¸‹å­å°±èƒ½çœ‹å‡ºæ¥æ˜¯ 7 ä¸¢äº†ã€‚</p><h3 id="2-5-4-æµé‡æ§åˆ¶é—®é¢˜"><a href="#2-5-4-æµé‡æ§åˆ¶é—®é¢˜" class="headerlink" title="2.5.4 æµé‡æ§åˆ¶é—®é¢˜"></a>2.5.4 æµé‡æ§åˆ¶é—®é¢˜</h3><p>åœ¨å¯¹äºåŒ…çš„ç¡®è®¤ä¸­ï¼Œä¼šæºå¸¦ä¸€ä¸ªçª—å£çš„å¤§å°ã€‚</p><p>æˆ‘ä»¬å…ˆå‡è®¾çª—å£ä¸å˜çš„æƒ…å†µï¼Œçª—å£å§‹ç»ˆä¸º 9ã€‚4 çš„ç¡®è®¤æ¥çš„æ—¶å€™ï¼Œä¼šå³ç§»ä¸€ä¸ªï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ 13 ä¸ªåŒ…ä¹Ÿå¯ä»¥å‘é€äº†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/hNHO7CLUzQqfwmt.jpg" alt="fig8.jpg"></p><p>è¿™ä¸ªæ—¶å€™ï¼Œå‡è®¾å‘é€ç«¯å‘é€è¿‡çŒ›ï¼Œä¼šå°†ç¬¬ä¸‰éƒ¨åˆ†çš„ 10ã€11ã€12ã€13 å…¨éƒ¨å‘é€å®Œæ¯•ï¼Œä¹‹åå°±åœæ­¢å‘é€äº†ï¼Œæœªå‘é€å¯å‘é€éƒ¨åˆ†ä¸º 0ã€‚</p><p><img src="https://i.loli.net/2020/02/02/XaQ4KcUZe7vCNPn.jpg" alt="fig9.jpg"></p><p>å½“å¯¹äºåŒ… 5 çš„ç¡®è®¤åˆ°è¾¾çš„æ—¶å€™ï¼Œåœ¨å®¢æˆ·ç«¯ç›¸å½“äºçª—å£å†æ»‘åŠ¨äº†ä¸€æ ¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ‰å¯ä»¥æœ‰æ›´å¤šçš„åŒ…å¯ä»¥å‘é€äº†ï¼Œä¾‹å¦‚ç¬¬ 14 ä¸ªåŒ…æ‰å¯ä»¥å‘é€ã€‚</p><p><img src="https://i.loli.net/2020/02/02/v3BKa6imlSHhXRd.jpg" alt="fig10.jpg"></p><p>å¦‚æœæ¥æ”¶æ–¹å®åœ¨å¤„ç†çš„å¤ªæ…¢ï¼Œå¯¼è‡´ç¼“å­˜ä¸­æ²¡æœ‰ç©ºé—´äº†ï¼Œå¯ä»¥é€šè¿‡ç¡®è®¤ä¿¡æ¯ä¿®æ”¹çª—å£çš„å¤§å°ï¼Œç”šè‡³å¯ä»¥è®¾ç½®ä¸º 0ï¼Œåˆ™å‘é€æ–¹å°†æš‚æ—¶åœæ­¢å‘é€ã€‚</p><p>æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæç«¯æƒ…å†µï¼Œæ¥æ”¶ç«¯çš„åº”ç”¨ä¸€ç›´ä¸è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œå½“æ•°æ®åŒ… 6 ç¡®è®¤åï¼Œçª—å£å¤§å°å°±ä¸èƒ½å†æ˜¯ 9 äº†ï¼Œå°±è¦ç¼©å°ä¸€ä¸ªå˜ä¸º 8ã€‚</p><p><img src="https://i.loli.net/2020/02/02/Sdia3Akts1cKGnD.jpg" alt="fig11.jpg"></p><p>è¿™ä¸ªæ–°çš„çª—å£ 8 é€šè¿‡ 6 çš„ç¡®è®¤æ¶ˆæ¯åˆ°è¾¾å‘é€ç«¯çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°çª—å£æ²¡æœ‰å¹³è¡Œå³ç§»ï¼Œè€Œæ˜¯ä»…ä»…å·¦é¢çš„è¾¹å³ç§»äº†ï¼Œçª—å£çš„å¤§å°ä» 9 æ”¹æˆäº† 8ã€‚</p><p><img src="https://i.loli.net/2020/02/02/MpGW7ZkgRBuwQxq.jpg" alt="fig12.jpg"></p><p>å¦‚æœæ¥æ”¶ç«¯è¿˜æ˜¯ä¸€ç›´ä¸å¤„ç†æ•°æ®ï¼Œåˆ™éšç€ç¡®è®¤çš„åŒ…è¶Šæ¥è¶Šå¤šï¼Œçª—å£è¶Šæ¥è¶Šå°ï¼Œç›´åˆ°ä¸º 0ã€‚</p><p><img src="https://i.loli.net/2020/02/02/oI1u3nGxDOyfe4q.jpg" alt="fig13.jpg"></p><p>å½“è¿™ä¸ªçª—å£é€šè¿‡åŒ… 14 çš„ç¡®è®¤åˆ°è¾¾å‘é€ç«¯çš„æ—¶å€™ï¼Œå‘é€ç«¯çš„çª—å£ä¹Ÿè°ƒæ•´ä¸º 0ï¼Œåœæ­¢å‘é€ã€‚</p><p><img src="https://i.loli.net/2020/02/02/lqjmcvphQ6wZoNU.jpg" alt="fig14.jpg"></p><p>å¦‚æœè¿™æ ·çš„è¯ï¼Œå‘é€æ–¹ä¼šå®šæ—¶å‘é€çª—å£æ¢æµ‹æ•°æ®åŒ…ï¼Œçœ‹æ˜¯å¦æœ‰æœºä¼šè°ƒæ•´çª—å£çš„å¤§å°ã€‚å½“æ¥æ”¶æ–¹æ¯”è¾ƒæ…¢çš„æ—¶å€™ï¼Œè¦é˜²æ­¢ä½èƒ½çª—å£ç»¼åˆå¾ï¼Œåˆ«ç©ºå‡ºä¸€ä¸ªå­—èŠ‚æ¥å°±èµ¶å¿«å‘Šè¯‰å‘é€æ–¹ï¼Œç„¶åé©¬ä¸Šåˆå¡«æ»¡äº†ï¼Œå¯ä»¥å½“çª—å£å¤ªå°çš„æ—¶å€™ï¼Œä¸æ›´æ–°çª—å£ï¼Œç›´åˆ°è¾¾åˆ°ä¸€å®šå¤§å°ï¼Œæˆ–è€…ç¼“å†²åŒºä¸€åŠä¸ºç©ºï¼Œæ‰æ›´æ–°çª—å£ã€‚</p><h3 id="2-5-5-æ‹¥å¡æ§åˆ¶"><a href="#2-5-5-æ‹¥å¡æ§åˆ¶" class="headerlink" title="2.5.5 æ‹¥å¡æ§åˆ¶"></a>2.5.5 æ‹¥å¡æ§åˆ¶</h3><p>é€šè¿‡æ§åˆ¶çª—å£çš„å¤§å°æ¥æ§åˆ¶ï¼Œæ‹¥å¡çª—å£æ˜¯é˜²æ­¢å°†ç½‘ç»œå¡æ»¡ã€‚ç±»æ¯”æ°´ç®¡ï¼š æ°´ç®¡é‡Œé¢çš„æ°´é‡ = æ°´ç®¡ç²—ç»† x æ°´ç®¡é•¿åº¦ã€‚ åŒç†ï¼Œç½‘ç»œé€šé“çš„å®¹é‡ = å¸¦å®½ x å¾€è¿”å»¶è¿Ÿã€‚å¦‚æœæˆ‘ä»¬è®¾ç½®å‘é€çª—å£ï¼Œä½¿å¾—å‘é€ä½†æœªç¡®è®¤çš„åŒ…ä¸ºé€šé“çš„å®¹é‡ï¼Œå°±èƒ½å¤Ÿæ’‘æ»¡æ•´ä¸ªç®¡é“ã€‚</p><p><img src="https://i.loli.net/2020/02/02/WLgk5KJ8i4vMOlP.jpg" alt="fig15.jpg"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå‡è®¾å¾€è¿”æ—¶é—´ä¸º 8sï¼Œå» 4sï¼Œå› 4sï¼Œæ¯ç§’å‘é€ä¸€ä¸ªåŒ…ï¼Œæ¯ä¸ªåŒ… 1024byteã€‚å·²ç»è¿‡å»äº† 8sï¼Œåˆ™ 8 ä¸ªåŒ…éƒ½å‘å‡ºå»äº†ï¼Œå…¶ä¸­å‰ 4 ä¸ªåŒ…å·²ç»åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œä½†æ˜¯ ACK è¿˜æ²¡æœ‰è¿”å›ï¼Œä¸èƒ½ç®—å‘é€æˆåŠŸã€‚5-8 åå››ä¸ªåŒ…è¿˜åœ¨è·¯ä¸Šï¼Œè¿˜æ²¡è¢«æ¥æ”¶ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ•´ä¸ªç®¡é“æ­£å¥½æ’‘æ»¡ï¼Œåœ¨å‘é€ç«¯ï¼Œå·²å‘é€æœªç¡®è®¤çš„ä¸º 8 ä¸ªåŒ…ï¼Œæ­£å¥½ç­‰äºå¸¦å®½ï¼Œä¹Ÿå³æ¯ç§’å‘é€ 1 ä¸ªåŒ…ï¼Œä¹˜ä»¥æ¥å›æ—¶é—´ 8sã€‚</p><p>å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå†è°ƒå¤§çª—å£ï¼Œä½¿å¾—å•ä½æ—¶é—´å†…æ›´å¤šçš„åŒ…å¯ä»¥å‘é€ï¼Œä¼šå‡ºç°ä»€ä¹ˆç°è±¡å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ¥æƒ³ï¼ŒåŸæ¥å‘é€ä¸€ä¸ªåŒ…ï¼Œä»ä¸€ç«¯åˆ°è¾¾å¦ä¸€ç«¯ï¼Œå‡è®¾ä¸€å…±ç»è¿‡å››ä¸ªè®¾å¤‡ï¼Œæ¯ä¸ªè®¾å¤‡å¤„ç†ä¸€ä¸ªåŒ…æ—¶é—´è€—è´¹ 1sï¼Œæ‰€ä»¥åˆ°è¾¾å¦ä¸€ç«¯éœ€è¦è€—è´¹ 4sï¼Œå¦‚æœå‘é€çš„æ›´åŠ å¿«é€Ÿï¼Œåˆ™å•ä½æ—¶é—´å†…ï¼Œä¼šæœ‰æ›´å¤šçš„åŒ…åˆ°è¾¾è¿™äº›ä¸­é—´è®¾å¤‡ï¼Œè¿™äº›è®¾å¤‡è¿˜æ˜¯åªèƒ½æ¯ç§’å¤„ç†ä¸€ä¸ªåŒ…çš„è¯ï¼Œå¤šå‡ºæ¥çš„åŒ…å°±ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³å…¶ä»–çš„åŠæ³•ï¼Œä¾‹å¦‚è¿™ä¸ªå››ä¸ªè®¾å¤‡æœ¬æ¥æ¯ç§’å¤„ç†ä¸€ä¸ªåŒ…ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿™äº›è®¾å¤‡ä¸ŠåŠ ç¼“å­˜ï¼Œå¤„ç†ä¸è¿‡æ¥çš„åœ¨é˜Ÿåˆ—é‡Œé¢æ’ç€ï¼Œè¿™æ ·åŒ…å°±ä¸ä¼šä¸¢å¤±ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯ä¼šå¢åŠ æ—¶å»¶ï¼Œè¿™ä¸ªç¼“å­˜çš„åŒ…ï¼Œ4s è‚¯å®šåˆ°è¾¾ä¸äº†æ¥æ”¶ç«¯äº†ï¼Œå¦‚æœæ—¶å»¶è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼Œå°±ä¼šè¶…æ—¶é‡ä¼ ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ã€‚</p><p>äºæ˜¯ TCP çš„æ‹¥å¡æ§åˆ¶ä¸»è¦æ¥é¿å…ä¸¤ç§ç°è±¡ï¼ŒåŒ…ä¸¢å¤±ä»¥åŠè¶…æ—¶é‡ä¼ ã€‚ä¸€æ—¦å‘ç”Ÿäº†è¿™ç§ç°è±¡ï¼Œå°±è¯´æ˜å‘é€é€Ÿåº¦å¤ªå¿«äº†ï¼ŒTCPé‡‡ç”¨æ…¢å¯åŠ¨æ¥é¿å…å‘é€é€Ÿåº¦å¤ªå¿«çš„ç°è±¡ã€‚</p><p>ä¸€æ¡ TCP è¿æ¥å¼€å§‹ï¼Œcwnd è®¾ç½®ä¸ºä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œä¸€æ¬¡åªèƒ½å‘é€ä¸€ä¸ªï¼›å½“æ”¶åˆ°è¿™ä¸€ä¸ªç¡®è®¤çš„æ—¶å€™ï¼Œcwnd åŠ ä¸€ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€ä¸¤ä¸ªï¼›å½“è¿™ä¸¤ä¸ªçš„ç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤ cwnd åŠ ä¸€ï¼Œä¸¤ä¸ªç¡®è®¤ cwnd åŠ äºŒï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€å››ä¸ªï¼›å½“è¿™å››ä¸ªçš„ç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤ cwnd åŠ ä¸€ï¼Œå››ä¸ªç¡®è®¤ cwnd åŠ å››ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€å…«ä¸ªã€‚å¯ä»¥çœ‹å‡ºè¿™æ˜¯å‘ˆæŒ‡æ•°æ€§å¢é•¿çš„ã€‚</p><p>åœ¨å¢é•¿åˆ°ssthreshå€¼-65535å­—èŠ‚çš„æ—¶å€™ï¼Œä¼šå‡é€Ÿå˜æˆçº¿æ€§å¢é•¿ã€‚</p><p>æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤åï¼Œcwnd å¢åŠ  1/cwndï¼Œæˆ‘ä»¬æ¥ç€ä¸Šé¢çš„è¿‡ç¨‹æ¥ï¼Œä¸€æ¬¡å‘é€å…«ä¸ªï¼Œå½“å…«ä¸ªç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤å¢åŠ  1/8ï¼Œå…«ä¸ªç¡®è®¤ä¸€å…± cwnd å¢åŠ  1ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€ä¹ä¸ªï¼Œå˜æˆäº†çº¿æ€§å¢é•¿ã€‚</p><p>é‡‡ç”¨å¿«é€Ÿé‡ä¼ ç®—æ³•è§£å†³ä¸¢åŒ…é—®é¢˜ï¼Œå½“æ¥æ”¶ç«¯å‘ç°ä¸¢äº†ä¸€ä¸ªä¸­é—´åŒ…çš„æ—¶å€™ï¼Œå‘é€ä¸‰æ¬¡å‰ä¸€ä¸ªåŒ…çš„ ACKï¼Œäºæ˜¯å‘é€ç«¯å°±ä¼šå¿«é€Ÿçš„é‡ä¼ ï¼Œä¸å¿…ç­‰å¾…è¶…æ—¶å†é‡ä¼ ã€‚TCP è®¤ä¸ºè¿™ç§æƒ…å†µä¸ä¸¥é‡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ²¡ä¸¢ï¼Œåªä¸¢äº†ä¸€å°éƒ¨åˆ†ï¼Œcwnd å‡åŠä¸º cwnd/2ï¼Œç„¶å sshthresh = cwndï¼Œå½“ä¸‰ä¸ªåŒ…è¿”å›çš„æ—¶å€™ï¼Œcwnd = sshthresh + 3ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¸€å¤œå›åˆ°è§£æ”¾å‰ï¼Œè€Œæ˜¯è¿˜åœ¨æ¯”è¾ƒé«˜çš„å€¼ï¼Œå‘ˆçº¿æ€§å¢é•¿ã€‚</p><p>ä½†æ˜¯TCPçš„æ‹¥å¡æ§åˆ¶å­˜åœ¨é—®é¢˜ï¼š</p><ol><li>ä¸¢åŒ…å¹¶ä¸ä»£è¡¨ç€é€šé“æ»¡äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ç®¡å­æœ¬æ¥å°±æ¼æ°´ã€‚ä¾‹å¦‚å…¬ç½‘ä¸Šå¸¦å®½ä¸æ»¡ä¹Ÿä¼šä¸¢åŒ…ï¼Œè¿™ä¸ªæ—¶å€™å°±è®¤ä¸ºæ‹¥å¡äº†ï¼Œé€€ç¼©äº†ï¼Œå…¶å®æ˜¯ä¸å¯¹çš„ã€‚</li><li>TCP çš„æ‹¥å¡æ§åˆ¶è¦ç­‰åˆ°å°†ä¸­é—´è®¾å¤‡éƒ½å¡«å……æ»¡äº†ï¼Œæ‰å‘ç”Ÿä¸¢åŒ…ï¼Œä»è€Œé™ä½é€Ÿåº¦ï¼Œè¿™æ—¶å€™å·²ç»æ™šäº†ã€‚å…¶å® TCP åªè¦å¡«æ»¡ç®¡é“å°±å¯ä»¥äº†ï¼Œä¸åº”è¯¥æ¥ç€å¡«ï¼Œç›´åˆ°è¿ç¼“å­˜ä¹Ÿå¡«æ»¡ã€‚</li></ol><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±æœ‰äº†TCP BBRæ‹¥å¡ç®—æ³•ï¼Œä¼å›¾æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œé€šè¿‡ä¸æ–­åŠ å¿«å‘é€é€Ÿåº¦ï¼Œå°†ç®¡é“å¡«æ»¡ï¼Œä½†æ˜¯ä¸å¡«æ»¡ä¸­é—´è®¾å¤‡çš„ç¼“å­˜ï¼Œå› ä¸ºè¿™æ ·æ—¶å»¶ä¼šå¢åŠ ï¼Œåœ¨è¿™ä¸ªå¹³è¡¡ç‚¹å¯ä»¥è¾¾åˆ°é«˜å¸¦å®½å’Œä½æ—¶å»¶çš„å¹³è¡¡ã€‚</p><p><img src="https://i.loli.net/2020/02/02/ApmJWIycxjXfNaq.jpg" alt="fig16.jpg"></p><h1 id="3-å¥—æ¥å­—Socket"><a href="#3-å¥—æ¥å­—Socket" class="headerlink" title="3. å¥—æ¥å­—Socket"></a>3. å¥—æ¥å­—Socket</h1><p>Socketç¼–ç¨‹æ˜¯åŸºäºTCPå’ŒUDPåè®®çš„ã€‚Socketç¼–ç¨‹è¿›è¡Œçš„æ˜¯ç«¯åˆ°ç«¯çš„é€šä¿¡ï¼Œå¾€å¾€æ„è¯†ä¸åˆ°ä¸­é—´ç»è¿‡äº†å¤šå°‘å±€åŸŸç½‘ã€è·¯ç”±å™¨ï¼Œå› è€Œèƒ½å¤Ÿè®¾ç½®çš„å‚æ•°æ˜¯åœ¨ç«¯åˆ°ç«¯åè®®æ™ºå•†çš„ç½‘ç»œå±‚å’Œä¼ è¾“å±‚ä¸Šã€‚</p><p>ç½‘ç»œå±‚ï¼š æŒ‡å®šæ˜¯IPV4(AF_INET)è¿˜æ˜¯IPV6(AF_INET6). </p><p>ä¼ è¾“å±‚ï¼š æŒ‡å®šæ˜¯TCP(SOCK_STREAM)è¿˜æ˜¯UDP(SOCK_DGRAM)ã€‚</p><h2 id="3-1-åŸºäºTCPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹"><a href="#3-1-åŸºäºTCPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹" class="headerlink" title="3.1 åŸºäºTCPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹"></a>3.1 åŸºäºTCPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹</h2><p>é¦–å…ˆæ˜¯ä¸¤ç«¯è¦åˆ›å»ºSocketï¼Œè¿™ä¹‹å<br>TCP çš„æœåŠ¡ç«¯è¦å…ˆç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œä¸€èˆ¬æ˜¯å…ˆè°ƒç”¨ bind å‡½æ•°ï¼Œç»™è¿™ä¸ª Socket èµ‹äºˆä¸€ä¸ª IP åœ°å€å’Œç«¯å£ã€‚ä¸ºä»€ä¹ˆéœ€è¦ç«¯å£å‘¢ï¼Ÿè¦çŸ¥é“ï¼Œä½ å†™çš„æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå½“ä¸€ä¸ªç½‘ç»œåŒ…æ¥çš„æ—¶å€™ï¼Œå†…æ ¸è¦é€šè¿‡ TCP å¤´é‡Œé¢çš„è¿™ä¸ªç«¯å£ï¼Œæ¥æ‰¾åˆ°ä½ è¿™ä¸ªåº”ç”¨ç¨‹åºï¼ŒæŠŠåŒ…ç»™ä½ ã€‚ä¸ºä»€ä¹ˆè¦ IP åœ°å€å‘¢ï¼Ÿæœ‰æ—¶å€™ï¼Œä¸€å°æœºå™¨ä¼šæœ‰å¤šä¸ªç½‘å¡ï¼Œä¹Ÿå°±ä¼šæœ‰å¤šä¸ª IP åœ°å€ï¼Œä½ å¯ä»¥é€‰æ‹©ç›‘å¬æ‰€æœ‰çš„ç½‘å¡ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç›‘å¬ä¸€ä¸ªç½‘å¡ï¼Œè¿™æ ·ï¼Œåªæœ‰å‘ç»™è¿™ä¸ªç½‘å¡çš„åŒ…ï¼Œæ‰ä¼šç»™ä½ ã€‚</p><p>å½“æœåŠ¡ç«¯æœ‰äº† IP å’Œç«¯å£å·ï¼Œå°±å¯ä»¥è°ƒç”¨ listen å‡½æ•°è¿›è¡Œç›‘å¬ã€‚åœ¨ TCP çš„çŠ¶æ€å›¾é‡Œé¢ï¼Œæœ‰ä¸€ä¸ª listen çŠ¶æ€ï¼Œå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹åï¼ŒæœåŠ¡ç«¯å°±è¿›å…¥äº†è¿™ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯å°±å¯ä»¥å‘èµ·è¿æ¥äº†ã€‚</p><p>åœ¨å†…æ ¸ä¸­ï¼Œä¸ºæ¯ä¸ª Socket ç»´æŠ¤ä¸¤ä¸ªé˜Ÿåˆ—ã€‚ä¸€ä¸ªæ˜¯å·²ç»å»ºç«‹äº†è¿æ¥çš„é˜Ÿåˆ—ï¼Œè¿™æ—¶å€™è¿æ¥ä¸‰æ¬¡æ¡æ‰‹å·²ç»å®Œæ¯•ï¼Œå¤„äº established çŠ¶æ€ï¼›ä¸€ä¸ªæ˜¯è¿˜æ²¡æœ‰å®Œå…¨å»ºç«‹è¿æ¥çš„é˜Ÿåˆ—ï¼Œè¿™ä¸ªæ—¶å€™ä¸‰æ¬¡æ¡æ‰‹è¿˜æ²¡å®Œæˆï¼Œå¤„äº syn_rcvd çš„çŠ¶æ€ã€‚</p><p>æ¥ä¸‹æ¥ï¼ŒæœåŠ¡ç«¯è°ƒç”¨Acceptå‡½æ•°ï¼Œæ‹¿å‡ºä¸€ä¸ªå·²ç»å®Œæˆçš„è¿æ¥è¿›è¡Œå¤„ç†ã€‚å¦‚æœè¿˜æ²¡æœ‰å®Œæˆï¼Œå°±è¦ç­‰ç€ã€‚ </p><p>åœ¨æœåŠ¡ç«¯ç­‰å¾…çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ connect å‡½æ•°å‘èµ·è¿æ¥ã€‚å…ˆåœ¨å‚æ•°ä¸­æŒ‡æ˜è¦è¿æ¥çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œç„¶åå¼€å§‹å‘èµ·ä¸‰æ¬¡æ¡æ‰‹ã€‚å†…æ ¸ä¼šç»™å®¢æˆ·ç«¯åˆ†é…ä¸€ä¸ªä¸´æ—¶çš„ç«¯å£ã€‚ä¸€æ—¦æ¡æ‰‹æˆåŠŸï¼ŒæœåŠ¡ç«¯çš„ accept å°±ä¼šè¿”å›å¦ä¸€ä¸ª Socketã€‚æ³¨æ„**ç›‘å¬çš„socketå’ŒçœŸæ­£ç”¨æ¥ä¼ æ•°æ®çš„Socketæ˜¯ä¸¤ä¸ªï¼Œä¸€ä¸ªå«åšç›‘å¬Socketï¼Œä¸€ä¸ªå«åšå·²è¿æ¥Socketã€‚ </p><p>è¿æ¥å»ºç«‹æˆåŠŸä¹‹åï¼ŒåŒæ–¹å¼€å§‹é€šè¿‡readå’Œwriteå‡½æ•°æ¥è¯»å†™æ•°æ®ï¼Œå°±åƒå¾€ä¸€ä¸ªæ–‡ä»¶æµé‡Œé¢å†™ä¸œè¥¿ä¸€æ ·ã€‚</p><p>ä¸‹å›¾æ˜¯åŸºäºTCPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹ã€‚</p><p><img src="https://i.loli.net/2020/02/02/tLb6hp47lYN3yZu.jpg" alt="fig17.jpg"></p><p>è¯´ TCP çš„ Socket å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æµï¼Œæ˜¯éå¸¸å‡†ç¡®çš„ã€‚å› ä¸ºï¼ŒSocket åœ¨ Linux ä¸­å°±æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨æ–‡ä»¶æè¿°ç¬¦ã€‚å†™å…¥å’Œè¯»å‡ºï¼Œä¹Ÿæ˜¯é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ã€‚</p><p>åœ¨å†…æ ¸ä¸­ï¼ŒSocket æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£å¯¹åº”å°±æœ‰æ–‡ä»¶æè¿°ç¬¦ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„ task_structï¼Œé‡Œé¢æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ•°ç»„ï¼Œæ¥åˆ—å‡ºè¿™ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ˜¯è¿™ä¸ªæ•°ç»„çš„ä¸‹æ ‡ã€‚</p><p>è¿™ä¸ªæ•°ç»„ä¸­çš„å†…å®¹æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å†…æ ¸ä¸­æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶çš„åˆ—è¡¨ã€‚æ—¢ç„¶æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæœ‰ä¸€ä¸ª inodeï¼Œåªä¸è¿‡ Socket å¯¹åº”çš„ inode ä¸åƒçœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œä¿å­˜åœ¨ç¡¬ç›˜ä¸Šçš„ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­çš„ã€‚åœ¨è¿™ä¸ª inode ä¸­ï¼ŒæŒ‡å‘äº† Socket åœ¨å†…æ ¸ä¸­çš„ Socket ç»“æ„ã€‚</p><p>åœ¨è¿™ä¸ªç»“æ„é‡Œé¢ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å‘é€é˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯æ¥æ”¶é˜Ÿåˆ—ã€‚åœ¨è¿™ä¸¤ä¸ªé˜Ÿåˆ—é‡Œé¢ä¿å­˜çš„æ˜¯ä¸€ä¸ªç¼“å­˜sk_buff.è¿™ä¸ªç¼“å­˜é‡Œé¢èƒ½å¤Ÿçœ‹åˆ°å®Œæ•´çš„åŒ…çš„ç»“æ„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/Ag5IO6YfPbZ3SUQ.jpg" alt="fig18.jpg"></p><h2 id="3-2-åŸºäºUDPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹"><a href="#3-2-åŸºäºUDPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹" class="headerlink" title="3.2 åŸºäºUDPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹"></a>3.2 åŸºäºUDPåè®®çš„Socketç¨‹åºå‡½æ•°è°ƒç”¨è¿‡ç¨‹</h2><p>å’ŒTCPåè®®çš„Socketç¼–ç¨‹ç›¸æ¯”ï¼Œä¸åŒåœ¨äºUDPæ˜¯æ— è¿æ¥çš„ï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¹Ÿä¸éœ€è¦è°ƒç”¨listenå’Œconnectï¼Œä½†æ˜¯UDPçš„äº¤äº’ä»ç„¶éœ€è¦IPå’Œç«¯å£å·ï¼Œå› æ­¤ä¹Ÿéœ€è¦bindã€‚UDPæ˜¯æ²¡æœ‰ç»´æŠ¤è¿æ¥çŠ¶æ€çš„ï¼Œå› ä¸ºä¸éœ€è¦æ¯å¯¹è¿æ¥å»ºç«‹ä¸€ç»„socketï¼Œè€Œæ˜¯åªè¦æœ‰ä¸€ä¸ªsocketï¼Œå°±èƒ½å¤Ÿå’Œå¤šä¸ªå®¢æˆ·ç«¯é€šä¿¡ã€‚ä¹Ÿæ­£æ˜¯å› ä¸ºæ²¡æœ‰è¿æ¥çŠ¶æ€ï¼Œæ¯æ¬¡é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è°ƒç”¨sendtoå’Œrecvfromï¼Œéƒ½å¯ä»¥ä¼ å…¥IPåœ°å€å’Œç«¯å£ã€‚</p><p><img src="https://i.loli.net/2020/02/02/5XzPcB4R9Mrpf1b.jpg" alt="fig19.jpg"></p><h2 id="3-3-æœåŠ¡å™¨æœ€å¤§è¿æ¥æ•°"><a href="#3-3-æœåŠ¡å™¨æœ€å¤§è¿æ¥æ•°" class="headerlink" title="3.3 æœåŠ¡å™¨æœ€å¤§è¿æ¥æ•°"></a>3.3 æœåŠ¡å™¨æœ€å¤§è¿æ¥æ•°</h2><pre><code>{æœ¬æœº IP, æœ¬æœºç«¯å£, å¯¹ç«¯ IP, å¯¹ç«¯ç«¯å£}</code></pre><p>æœåŠ¡å™¨é€šå¸¸å›ºå®šåœ¨æŸä¸ªæœ¬åœ°ç«¯å£ä¸Šç›‘å¬ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚å› æ­¤ï¼ŒæœåŠ¡ç«¯ç«¯ TCP è¿æ¥å››å…ƒç»„ä¸­åªæœ‰å¯¹ç«¯ IP, ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯çš„ IP å’Œå¯¹ç«¯çš„ç«¯å£ï¼Œä¹Ÿå³å®¢æˆ·ç«¯çš„ç«¯å£æ˜¯å¯å˜çš„ï¼Œå› æ­¤ï¼Œæœ€å¤§ TCP è¿æ¥æ•° = å®¢æˆ·ç«¯ IP æ•°Ã—å®¢æˆ·ç«¯ç«¯å£æ•°ã€‚å¯¹ IPv4ï¼Œå®¢æˆ·ç«¯çš„ IP æ•°æœ€å¤šä¸º 2 çš„ 32 æ¬¡æ–¹ï¼Œå®¢æˆ·ç«¯çš„ç«¯å£æ•°æœ€å¤šä¸º 2 çš„ 16 æ¬¡æ–¹ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å•æœºæœ€å¤§ TCP è¿æ¥æ•°ï¼Œçº¦ä¸º 2 çš„ 48 æ¬¡æ–¹ã€‚</p><p>å½“ç„¶ï¼ŒæœåŠ¡ç«¯æœ€å¤§å¹¶å‘ TCP è¿æ¥æ•°è¿œä¸èƒ½è¾¾åˆ°ç†è®ºä¸Šé™ã€‚é¦–å…ˆä¸»è¦æ˜¯æ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶ï¼Œï¼ŒæŒ‰ç…§ä¸Šé¢çš„åŸç†ï¼ŒSocket éƒ½æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥é¦–å…ˆè¦é€šè¿‡ ulimit é…ç½®æ–‡ä»¶æè¿°ç¬¦çš„æ•°ç›®ï¼›å¦ä¸€ä¸ªé™åˆ¶æ˜¯å†…å­˜ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªTCPè¿æ¥éƒ½è¦å ç”¨ä¸€å®šçš„å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿæ˜¯æœ‰é™çš„ã€‚</p><p>å› æ­¤éœ€è¦å¯»æ‰¾æ–¹æ³•å»é™ä½æ¯ä¸ªé¡¹ç›®æ¶ˆè€—çš„èµ„æºæ•°ç›®</p><h3 id="3-3-1-å¤šè¿›ç¨‹æ–¹å¼"><a href="#3-3-1-å¤šè¿›ç¨‹æ–¹å¼" class="headerlink" title="3.3.1 å¤šè¿›ç¨‹æ–¹å¼"></a>3.3.1 å¤šè¿›ç¨‹æ–¹å¼</h3><p>è¿™å°±ç›¸å½“äºä½ æ˜¯ä¸€ä¸ªä»£ç†ï¼Œåœ¨é‚£é‡Œç›‘å¬æ¥çš„è¯·æ±‚ã€‚ä¸€æ—¦å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå·²è¿æ¥ Socketï¼Œè¿™æ—¶å€™ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åå°†åŸºäºå·²è¿æ¥ Socket çš„äº¤äº’äº¤ç»™è¿™ä¸ªæ–°çš„å­è¿›ç¨‹æ¥åšã€‚å°±åƒæ¥äº†ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œä½†æ˜¯é¡¹ç›®ä¸ä¸€å®šæ˜¯ä½ è‡ªå·±åšï¼Œå¯ä»¥å†æ³¨å†Œä¸€å®¶å­å…¬å¸ï¼Œæ‹›ç‚¹äººï¼Œç„¶åæŠŠé¡¹ç›®è½¬åŒ…ç»™è¿™å®¶å­å…¬å¸åšï¼Œä»¥åå¯¹æ¥å°±äº¤ç»™è¿™å®¶å­å…¬å¸äº†ï¼Œä½ åˆå¯ä»¥å»æ¥æ–°çš„é¡¹ç›®äº†ã€‚</p><p>åœ¨linuxä¸­ä½¿ç”¨forkæ¥åšçš„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/9MOWKfI7kzEdD6V.jpg" alt="fig20.jpg"></p><p>å› ä¸ºå¤åˆ¶äº†æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨ï¼Œè€Œæ–‡ä»¶æè¿°ç¬¦éƒ½æ˜¯æŒ‡å‘æ•´ä¸ªå†…æ ¸ç»Ÿä¸€çš„æ‰“å¼€æ–‡ä»¶åˆ—è¡¨çš„ï¼Œå› è€Œçˆ¶è¿›ç¨‹åˆšæ‰å› ä¸º accept åˆ›å»ºçš„å·²è¿æ¥ Socket ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ŒåŒæ ·ä¹Ÿä¼šè¢«å­è¿›ç¨‹è·å¾—ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå­è¿›ç¨‹å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå·²è¿æ¥ Socket å’Œå®¢æˆ·ç«¯è¿›è¡Œäº’é€šäº†ï¼Œå½“é€šä¿¡å®Œæ¯•ä¹‹åï¼Œå°±å¯ä»¥é€€å‡ºè¿›ç¨‹ï¼Œé‚£çˆ¶è¿›ç¨‹å¦‚ä½•çŸ¥é“å­è¿›ç¨‹å¹²å®Œäº†é¡¹ç›®ï¼Œè¦é€€å‡ºå‘¢ï¼Ÿè¿˜è®°å¾— fork è¿”å›çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯æ•´æ•°å°±æ˜¯çˆ¶è¿›ç¨‹å—ï¼Ÿè¿™ä¸ªæ•´æ•°å°±æ˜¯å­è¿›ç¨‹çš„ IDï¼Œçˆ¶è¿›ç¨‹å¯ä»¥é€šè¿‡è¿™ä¸ª ID æŸ¥çœ‹å­è¿›ç¨‹æ˜¯å¦å®Œæˆé¡¹ç›®ï¼Œæ˜¯å¦éœ€è¦é€€å‡ºã€‚</p><h3 id="3-3-2-å¤šçº¿ç¨‹æ–¹å¼"><a href="#3-3-2-å¤šçº¿ç¨‹æ–¹å¼" class="headerlink" title="3.3.2 å¤šçº¿ç¨‹æ–¹å¼"></a>3.3.2 å¤šçº¿ç¨‹æ–¹å¼</h3><p>ç›¸å½“äºä¸æˆç«‹å­å…¬å¸äº†ï¼Œè€Œæ˜¯åœ¨å…¬å¸é‡Œæˆç«‹æ–°çš„é¡¹ç›®ç»„ã€‚åœ¨ Linux ä¸‹ï¼Œé€šè¿‡ pthread_create åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿæ˜¯è°ƒç”¨ do_forkã€‚ä¸åŒçš„æ˜¯ï¼Œè™½ç„¶æ–°çš„çº¿ç¨‹åœ¨ task åˆ—è¡¨ä¼šæ–°åˆ›å»ºä¸€é¡¹ï¼Œä½†æ˜¯å¾ˆå¤šèµ„æºï¼Œä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨ã€è¿›ç¨‹ç©ºé—´ï¼Œè¿˜æ˜¯å…±äº«çš„ï¼Œåªä¸è¿‡å¤šäº†ä¸€ä¸ªå¼•ç”¨è€Œå·²ã€‚</p><p><img src="https://i.loli.net/2020/02/02/a8SoUfLwyzp5Ze3.jpg" alt="fig21.jpg"></p><p>ä¸Šé¢åŸºäºè¿›ç¨‹æˆ–è€…çº¿ç¨‹æ¨¡å‹çš„ï¼Œå…¶å®è¿˜æ˜¯æœ‰é—®é¢˜çš„ã€‚æ–°åˆ°æ¥ä¸€ä¸ª TCP è¿æ¥ï¼Œå°±éœ€è¦åˆ†é…ä¸€ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹ã€‚ä¸€å°æœºå™¨æ— æ³•åˆ›å»ºå¾ˆå¤šè¿›ç¨‹æˆ–è€…çº¿ç¨‹ã€‚æœ‰ä¸ªC10k. ï¼Œå®ƒçš„æ„æ€æ˜¯ä¸€å°æœºå™¨è¦ç»´æŠ¤ 1 ä¸‡ä¸ªè¿æ¥ï¼Œå°±è¦åˆ›å»º 1 ä¸‡ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿæ˜¯æ— æ³•æ‰¿å—çš„ã€‚å¦‚æœç»´æŒ 1 äº¿ç”¨æˆ·åœ¨çº¿éœ€è¦ 10 ä¸‡å°æœåŠ¡å™¨ï¼Œæˆæœ¬ä¹Ÿå¤ªé«˜äº†ã€‚</p><h3 id="3-3-3-IOå¤šè·¯å¤ç”¨ï¼Œä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤å¤šä¸ªSocket"><a href="#3-3-3-IOå¤šè·¯å¤ç”¨ï¼Œä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤å¤šä¸ªSocket" class="headerlink" title="3.3.3 IOå¤šè·¯å¤ç”¨ï¼Œä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤å¤šä¸ªSocket"></a>3.3.3 IOå¤šè·¯å¤ç”¨ï¼Œä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤å¤šä¸ªSocket</h3><p>å³ä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤å¤šä¸ªSocketã€‚ ç”±äº Socket æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œå› è€ŒæŸä¸ªçº¿ç¨‹ç›¯çš„æ‰€æœ‰çš„ Socketï¼Œéƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦é›†åˆ fd_set ä¸­ï¼Œè¿™å°±æ˜¯é¡¹ç›®è¿›åº¦å¢™ã€‚ï¼Œç„¶åè°ƒç”¨ select å‡½æ•°æ¥ç›‘å¬æ–‡ä»¶æè¿°ç¬¦é›†åˆæ˜¯å¦æœ‰å˜åŒ–ã€‚ä¸€æ—¦æœ‰å˜åŒ–ï¼Œå°±ä¼šä¾æ¬¡æŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚é‚£äº›å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶æè¿°ç¬¦åœ¨ fd_set å¯¹åº”çš„ä½éƒ½è®¾ä¸º 1ï¼Œè¡¨ç¤º Socket å¯è¯»æˆ–è€…å¯å†™ï¼Œä»è€Œå¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œç„¶åå†è°ƒç”¨ selectï¼Œæ¥ç€ç›¯ç€ä¸‹ä¸€è½®çš„å˜åŒ–ã€‚ã€‚</p><h3 id="3-3-4-IOå¤šè·¯å¤ç”¨ï¼Œsubscribe-publishæ¨¡å¼"><a href="#3-3-4-IOå¤šè·¯å¤ç”¨ï¼Œsubscribe-publishæ¨¡å¼" class="headerlink" title="3.3.4 IOå¤šè·¯å¤ç”¨ï¼Œsubscribe/publishæ¨¡å¼"></a>3.3.4 IOå¤šè·¯å¤ç”¨ï¼Œsubscribe/publishæ¨¡å¼</h3><p>ä¸Šé¢ select å‡½æ•°è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºæ¯æ¬¡ Socket æ‰€åœ¨çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆä¸­æœ‰ Socket å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œéƒ½éœ€è¦é€šè¿‡è½®è¯¢çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å°†å…¨éƒ¨é¡¹ç›®éƒ½è¿‡ä¸€éçš„æ–¹å¼æ¥æŸ¥çœ‹è¿›åº¦ï¼Œè¿™å¤§å¤§å½±å“äº†ä¸€ä¸ªé¡¹ç›®ç»„èƒ½å¤Ÿæ”¯æ’‘çš„æœ€å¤§çš„é¡¹ç›®æ•°é‡ã€‚å› è€Œä½¿ç”¨ selectï¼Œèƒ½å¤ŸåŒæ—¶ç›¯çš„é¡¹ç›®æ•°é‡ç”± FD_SETSIZE é™åˆ¶ã€‚</p><p>å¦‚æœæ”¹æˆäº‹ä»¶é€šçŸ¥çš„æ–¹å¼ï¼Œæƒ…å†µå°±ä¼šå¥½å¾ˆå¤šï¼Œé¡¹ç›®ç»„ä¸éœ€è¦é€šè¿‡è½®è¯¢æŒ¨ä¸ªç›¯ç€è¿™äº›é¡¹ç›®ï¼Œè€Œæ˜¯å½“é¡¹ç›®è¿›åº¦å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¸»åŠ¨é€šçŸ¥é¡¹ç›®ç»„ï¼Œç„¶åé¡¹ç›®ç»„å†æ ¹æ®é¡¹ç›®è¿›å±•æƒ…å†µåšç›¸åº”çš„æ“ä½œã€‚</p><p>èƒ½å®Œæˆè¿™ä»¶äº‹æƒ…çš„å‡½æ•°å« epollï¼Œå®ƒåœ¨å†…æ ¸ä¸­çš„å®ç°ä¸æ˜¯é€šè¿‡è½®è¯¢çš„æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡æ³¨å†Œ callback å‡½æ•°çš„æ–¹å¼ï¼Œå½“æŸä¸ªæ–‡ä»¶æè¿°ç¬¦å‘é€å˜åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šä¸»åŠ¨é€šçŸ¥ã€‚</p><p><img src="https://i.loli.net/2020/02/02/MqYfXpClu6AGvQs.jpg" alt="fig22.jpg"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå‡è®¾è¿›ç¨‹æ‰“å¼€äº† Socket m, n, x ç­‰å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç°åœ¨éœ€è¦é€šè¿‡ epoll æ¥ç›‘å¬æ˜¯å¦è¿™äº› Socket éƒ½æœ‰äº‹ä»¶å‘ç”Ÿã€‚å…¶ä¸­ epoll_create åˆ›å»ºä¸€ä¸ª epoll å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯¹åº”ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ŒåŒæ ·ä¹Ÿå¯¹åº”ç€æ‰“å¼€æ–‡ä»¶åˆ—è¡¨ä¸­çš„ä¸€é¡¹ã€‚åœ¨è¿™é¡¹é‡Œé¢æœ‰ä¸€ä¸ªçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘é‡Œï¼Œè¦ä¿å­˜è¿™ä¸ª epoll è¦ç›‘å¬çš„æ‰€æœ‰ Socketã€‚</p><p>å½“ epoll_ctl æ·»åŠ ä¸€ä¸ª Socket çš„æ—¶å€™ï¼Œå…¶å®æ˜¯åŠ å…¥è¿™ä¸ªçº¢é»‘æ ‘ï¼ŒåŒæ—¶çº¢é»‘æ ‘é‡Œé¢çš„èŠ‚ç‚¹æŒ‡å‘ä¸€ä¸ªç»“æ„ï¼Œå°†è¿™ä¸ªç»“æ„æŒ‚åœ¨è¢«ç›‘å¬çš„ Socket çš„äº‹ä»¶åˆ—è¡¨ä¸­ã€‚å½“ä¸€ä¸ª Socket æ¥äº†ä¸€ä¸ªäº‹ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥ä»è¿™ä¸ªåˆ—è¡¨ä¸­å¾—åˆ° epoll å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ call  back é€šçŸ¥å®ƒã€‚</p><p>è¿™ç§é€šçŸ¥æ–¹å¼ä½¿å¾—ç›‘å¬çš„ Socket æ•°æ®å¢åŠ çš„æ—¶å€™ï¼Œæ•ˆç‡ä¸ä¼šå¤§å¹…åº¦é™ä½ï¼Œèƒ½å¤ŸåŒæ—¶ç›‘å¬çš„ Socket çš„æ•°ç›®ä¹Ÿéå¸¸çš„å¤šäº†ã€‚ä¸Šé™å°±ä¸ºç³»ç»Ÿå®šä¹‰çš„ã€è¿›ç¨‹æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦ä¸ªæ•°ã€‚å› è€Œï¼Œepoll è¢«ç§°ä¸ºè§£å†³ C10K é—®é¢˜çš„åˆ©å™¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> UDP </tag>
            
            <tag> TCP </tag>
            
            <tag> Socket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(å››)-ç½‘ç»œå±‚</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%9B%9B-%E7%BD%91%E7%BB%9C%E5%B1%82/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%9B%9B-%E7%BD%91%E7%BB%9C%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="1-IPåè®®"><a href="#1-IPåè®®" class="headerlink" title="1. IPåè®®"></a>1. IPåè®®</h1><pre><code>root@test:~# ip addr1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default     link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet 127.0.0.1/8 scope host lo       valid_lft forever preferred_lft forever    inet6 ::1/128 scope host        valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000    link/ether fa:16:3e:c7:79:75 brd ff:ff:ff:ff:ff:ff    inet 10.100.122.2/24 brd 10.100.122.255 scope global eth0       valid_lft forever preferred_lft forever    inet6 fe80::f816:3eff:fec7:7975/64 scope link        valid_lft forever preferred_lft forever</code></pre><p>10.100.122.2æ˜¯ä¸€ä¸ªIPåœ°å€ï¼Œinet6 fe80::f816:3eff:fec7:7975/64æ˜¯IPv6åœ°å€ã€‚IPåœ°å€åˆ†ä¸ºäº”ç±»ï¼š </p><p><img src="https://i.loli.net/2020/02/02/D9CGtkc5s1TKfN4.jpg" alt="fig1.jpg"></p><p>Dç±»æ˜¯ç»„æ’­åœ°å€ï¼Œä½¿ç”¨è¿™ä¸€ç±»åœ°å€ï¼Œå±äºæŸä¸ªç»„çš„æœºå™¨éƒ½èƒ½æ”¶åˆ°ã€‚</p><p>ä¸‹é¢è¿™ä¸ªè¡¨å±•ç¤ºäº†ABCä¸‰ç±»åœ°å€æ‰€èƒ½åŒ…å«çš„ä¸»æœºçš„æ•°é‡ï¼š</p><p><img src="https://i.loli.net/2020/02/02/ztmCUuYxdwejnfS.jpg" alt="fig2.jpg"></p><p>Cç±»åœ°å€åªèƒ½åŒ…å«254çš„ä¸»æœºï¼Œè€ŒBç±»åœ°å€åˆå¤ªå¤§äº†ï¼Œèƒ½åŒ…å«65534ä¸ªä¸»æœºï¼Œå› æ­¤é‡‡ç”¨äº†CIDRæ–¹å¼è¿›è¡Œä¼˜åŒ–</p><h2 id="1-1-CIDR-æ— ç±»å‹åŸŸé—´é€‰è·¯"><a href="#1-1-CIDR-æ— ç±»å‹åŸŸé—´é€‰è·¯" class="headerlink" title="1.1 CIDR æ— ç±»å‹åŸŸé—´é€‰è·¯"></a>1.1 CIDR æ— ç±»å‹åŸŸé—´é€‰è·¯</h2><h3 id="1-1-1-CIDRçš„æ–œæ†-æ•°å­—çš„è¡¨ç¤ºæ–¹å¼"><a href="#1-1-1-CIDRçš„æ–œæ†-æ•°å­—çš„è¡¨ç¤ºæ–¹å¼" class="headerlink" title="1.1.1 CIDRçš„æ–œæ†+æ•°å­—çš„è¡¨ç¤ºæ–¹å¼"></a>1.1.1 CIDRçš„æ–œæ†+æ•°å­—çš„è¡¨ç¤ºæ–¹å¼</h3><p>è¿™ç§æ–¹å¼æ‰“ç ´äº†ä¸Šè¿°çš„åˆ†æˆå‡ ç±»åœ°å€çš„æ–¹å¼ï¼Œå°†32ä½åœ°å€ä¸€åˆ†ä¸ºäºŒï¼Œå‰é¢æ˜¯ç½‘ç»œå·ï¼Œåé¢æ˜¯ä¸»æœºå·ï¼Œä¾‹å¦‚ï¼š</p><pre><code>10.100.122.2/24</code></pre><p>æ–œæ å’Œ24è¡¨ç¤ºå¯¹äºè¿™ä¸ª32ä½åœ°å€è€Œè¨€ï¼Œå‰24ä½æ˜¯å…¶ç½‘ç»œå·ï¼Œå8ä½æ˜¯å…¶ä¸»æœºå·ã€‚</p><h3 id="1-1-2-å¹¿æ’­åœ°å€"><a href="#1-1-2-å¹¿æ’­åœ°å€" class="headerlink" title="1.1.2 å¹¿æ’­åœ°å€"></a>1.1.2 å¹¿æ’­åœ°å€</h3><p>ç»§ç»­ä»¥ä¸Šè¿°çš„åœ°å€ä¸ºä¾‹ï¼Œå…¶å¹¿æ’­åœ°å€ä¸º</p><pre><code>10.100.122.255</code></pre><p>å¦‚æœå‘é€è¿™ä¸ªåœ°å€ï¼Œæ‰€æœ‰10.100.122ç½‘ç»œé‡Œçš„æœºå™¨éƒ½å¯ä»¥æ”¶åˆ°</p><h3 id="1-1-3-å­ç½‘æ©ç "><a href="#1-1-3-å­ç½‘æ©ç " class="headerlink" title="1.1.3 å­ç½‘æ©ç "></a>1.1.3 å­ç½‘æ©ç </h3><p>ç»§ç»­ä»¥ä¸Šè¿°çš„åœ°å€ä¸ºä¾‹ï¼Œå…¶å­ç½‘æ©ç ä¸º</p><pre><code>255.255.255.0</code></pre><p>ä¸IPåœ°å€æŒ‰ä½ä¸ï¼Œå°±å¯ä»¥å¾—åˆ°ç½‘ç»œå·</p><h2 id="1-2-å…¬æœ‰IPåœ°å€å’Œç§æœ‰IPåœ°å€"><a href="#1-2-å…¬æœ‰IPåœ°å€å’Œç§æœ‰IPåœ°å€" class="headerlink" title="1.2 å…¬æœ‰IPåœ°å€å’Œç§æœ‰IPåœ°å€"></a>1.2 å…¬æœ‰IPåœ°å€å’Œç§æœ‰IPåœ°å€</h2><p>è¿™æ˜¯æŒ‰ç±»å¯¹IPåœ°å€è¿›è¡Œåˆ’åˆ†çš„æ—¶å€™çš„æ¦‚å¿µï¼Œç§æœ‰åœ°å€ï¼Œå³å…è®¸ç»„ç»‡å†…éƒ¨çš„ITäººå‘˜è‡ªå·±è¿›è¡Œç®¡ç†åˆ†é…çš„åœ°å€ã€‚å…¬æœ‰IPçš„èµ„æºæœ‰ç»„ç»‡ç»Ÿä¸€åˆ†é…çš„ï¼Œéœ€è¦å»ä¹°ã€‚</p><p><img src="https://i.loli.net/2020/02/02/KF8xGTD7mnwOBob.jpg" alt="fig3.jpg"></p><p>è¡¨æ ¼ä¸­å°±æœ‰æˆ‘ä»¬å¾ˆå¸¸è§çš„<code>192.168.0.0</code>,ä¸€èˆ¬æ¥è¯´ï¼Œæ•´ä¸ªç½‘ç»œçš„ç¬¬ä¸€ä¸ªåœ°å€<code>192.168.0.1</code>å°±æ˜¯ä½ è¿™ä¸ªç§æœ‰ç½‘ç»œçš„å‡ºå£åœ°å€ï¼Œæ¯”å¦‚ä½ å®¶çš„è·¯ç”±å™¨åœ°å€å°±æ˜¯è¿™ä¸ªï¼›è€Œ<code>192.1678.0.255</code>å°±æ˜¯å¹¿æ’­åœ°å€ã€‚</p><h2 id="1-3-åŠ¨æ€ä¸»æœºé…ç½®åè®®-DHCP"><a href="#1-3-åŠ¨æ€ä¸»æœºé…ç½®åè®®-DHCP" class="headerlink" title="1.3 åŠ¨æ€ä¸»æœºé…ç½®åè®®(DHCP)"></a>1.3 åŠ¨æ€ä¸»æœºé…ç½®åè®®(DHCP)</h2><p>ç½‘ç»œç®¡ç†å‘˜éœ€è¦åšçš„æ˜¯ï¼Œé…ç½®ä¸€æ®µå…±äº«çš„IPåœ°å€ï¼Œæ¯ä¸€å°æ–°æ¥å…¥çš„æœºå™¨éƒ½ä¼šé€šè¿‡DHCPåè®®ï¼Œæ¥è¿™ä¸ªå…±äº«çš„IPåœ°å€é‡Œç”³è¯·ï¼Œç„¶åè‡ªåŠ¨é…ç½®å¥½ã€‚</p><h3 id="1-3-1-DHCPçš„å·¥ä½œæ–¹å¼"><a href="#1-3-1-DHCPçš„å·¥ä½œæ–¹å¼" class="headerlink" title="1.3.1 DHCPçš„å·¥ä½œæ–¹å¼"></a>1.3.1 DHCPçš„å·¥ä½œæ–¹å¼</h3><ol><li>æ–°æœºå™¨åŠ å…¥è¿›ç½‘ç»œ â€“ DHCP discover</li></ol><p>æ–°æœºå™¨ä½¿ç”¨IPåœ°å€<code>0.0.0.0</code>å‘é€ä¸€ä¸ªå¹¿æ’­åŒ…ï¼Œç›®çš„IPåœ°å€æ˜¯<code>255.255.255.255</code>. å¹¿æ’­åŒ…å°è£…äº†UDPï¼Œ UDPå°è£…äº†BOOTPï¼ŒDHCPæ˜¯BOOTPçš„å¢å¼ºç‰ˆã€‚</p><p>åœ¨è¿™ä¸ªå¹¿æ’­åŒ…é‡Œï¼Œæ–°æœºå™¨ä¼šè¯´æˆ‘æ˜¯æ–°æ¥çš„(Boot Request), æˆ‘çš„MACåœ°å€æ˜¯blablaï¼Œæˆ‘è¿˜æ²¡æœ‰IPåœ°å€ï¼Œéœ€è¦ç§Ÿä¸€ä¸ªï¼</p><p><img src="https://i.loli.net/2020/02/02/8U3bkmHJVsXzfgu.jpg" alt="fig4.jpg"></p><ol start="2"><li>DHCP offer</li></ol><p>DHCP server ä¸ºå®¢æˆ·ä¿ç•™ä¸€ä¸ªIPåœ°å€ï¼Œä¸ä¼šå†ç»™åˆ«çš„å®¢æˆ·ç”¨è¿™ä¸ªIPåœ°å€äº†ã€‚DHCPçš„offerçš„æ ¼å¼å¦‚ä¸‹ï¼Œé‡Œé¢æœ‰ç»™æ–°äººåˆ†é…çš„åœ°å€ï¼š</p><p><img src="https://i.loli.net/2020/02/02/JgBRu5WK9QvYFdG.jpg" alt="fig5.jpg"></p><p>è¿™ä¸ªæ—¶å€™ä»ç„¶ä½¿ç”¨å¹¿æ’­IPä½œä¸ºç›®çš„åœ°å€ï¼Œå› ä¸ºæ­¤æ—¶æ–°æœºå™¨è¿˜æ²¡æœ‰IPåœ°å€å‘¢ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ‰å¯èƒ½åœ¨é…ç½®çš„æ—¶å€™ä¼šæœ‰å¤šä¸ªDHCP serverï¼Œè¿™ä¸ªæ–°æœºå™¨å¯èƒ½æ”¶åˆ°å¤šä¸ªDHCP Offerï¼Œæ–°æœºå™¨ä¼šé€‰æ‹©ä¸€èˆ¬æ˜¯æœ€è¿‘çš„ä¸€ä¸ªï¼Œç„¶åå‘ç½‘ç»œå‘é€ä¸€ä¸ªå‘ŠçŸ¥ä¿¡æ¯çš„ä¿¡æ¯åŒ…ï¼Œæˆä¸ºDHCP request</p><ol start="3"><li>DHCP request</li></ol><p>è¿™ä¸ªå¹¿æ’­æ•°æ®åŒ…é‡Œé¢åŒ…å«å®¢æˆ·ç«¯çš„MACåœ°å€ï¼Œæ¥å—çš„ç§Ÿçº¦ä¸­çš„IPåœ°å€ï¼Œæä¾›æ­¤ç§Ÿçº¦çš„DHCPæœåŠ¡å™¨åœ°å€ç­‰ä¿¡æ¯ã€‚</p><p><img src="https://i.loli.net/2020/02/02/nzURpgrOsjeIJmd.jpg" alt="fig6.jpg"></p><p>æ³¨æ„è¿™ä¸ªæ—¶å€™æ–°æœºå™¨çš„IPè¿˜æ²¡æœ‰å¾—åˆ°ç¡®è®¤ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ä»ç„¶ä½¿ç”¨0.0.0.0ä½œä¸ºæºåœ°å€</p><ol start="4"><li>DHCP ACK</li></ol><p>å½“DHCP serveræ¥æ”¶åˆ°å®¢æˆ·æœºçš„DHCP requestä¹‹åï¼Œä¼šå¹¿æ’­è¿”å›ç»™å®¢æˆ·æœºä¸€ä¸ªDHCP ACKæ¶ˆæ¯ï¼Œè¡¨ç¤ºå·²ç»æ¥å—å®¢æˆ·æœºçš„é€‰æ‹©</p><p><img src="https://i.loli.net/2020/02/02/fYRICBnTgHGqF6c.jpg" alt="fig7.jpg"></p><h3 id="1-3-2-IPåœ°å€çš„æ”¶å›å’Œç»­ç§Ÿ"><a href="#1-3-2-IPåœ°å€çš„æ”¶å›å’Œç»­ç§Ÿ" class="headerlink" title="1.3.2 IPåœ°å€çš„æ”¶å›å’Œç»­ç§Ÿ"></a>1.3.2 IPåœ°å€çš„æ”¶å›å’Œç»­ç§Ÿ</h3><p>å®¢æˆ·æœºä¼šåœ¨ç§ŸæœŸè¿‡å» 50% çš„æ—¶å€™ï¼Œç›´æ¥å‘ä¸ºå…¶æä¾› IP åœ°å€çš„ DHCP Server å‘é€ DHCP request æ¶ˆæ¯åŒ…ã€‚å®¢æˆ·æœºæ¥æ”¶åˆ°è¯¥æœåŠ¡å™¨å›åº”çš„ DHCP ACK æ¶ˆæ¯åŒ…ï¼Œä¼šæ ¹æ®åŒ…ä¸­æ‰€æä¾›çš„æ–°çš„ç§ŸæœŸä»¥åŠå…¶ä»–å·²ç»æ›´æ–°çš„ TCP/IP å‚æ•°ï¼Œæ›´æ–°è‡ªå·±çš„é…ç½®ã€‚è¿™æ ·ï¼ŒIP ç§Ÿç”¨æ›´æ–°å°±å®Œæˆäº†ã€‚</p><h3 id="1-3-3-DHCPåè®®-è‡ªåŠ¨å®‰è£…æ“ä½œç³»ç»Ÿ-PXE-é¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒ"><a href="#1-3-3-DHCPåè®®-è‡ªåŠ¨å®‰è£…æ“ä½œç³»ç»Ÿ-PXE-é¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒ" class="headerlink" title="1.3.3 DHCPåè®®- è‡ªåŠ¨å®‰è£…æ“ä½œç³»ç»Ÿ - PXE(é¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒ)"></a>1.3.3 DHCPåè®®- è‡ªåŠ¨å®‰è£…æ“ä½œç³»ç»Ÿ - PXE(é¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒ)</h3><p>å…¶å®ï¼Œè¿™ä¸ªè¿‡ç¨‹å’Œæ“ä½œç³»ç»Ÿå¯åŠ¨çš„è¿‡ç¨‹æœ‰ç‚¹å„¿åƒã€‚é¦–å…ˆï¼Œå¯åŠ¨ BIOSã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹åˆ«å°çš„å°ç³»ç»Ÿï¼Œåªèƒ½å¹²ç‰¹åˆ«å°çš„ä¸€ä»¶äº‹æƒ…ã€‚å…¶å®å°±æ˜¯è¯»å–ç¡¬ç›˜çš„ MBR å¯åŠ¨æ‰‡åŒºï¼Œå°† GRUB å¯åŠ¨èµ·æ¥ï¼›ç„¶åå°†æƒåŠ›äº¤ç»™ GRUBï¼ŒGRUB åŠ è½½å†…æ ¸ã€åŠ è½½ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿçš„ initramfs æ–‡ä»¶ï¼›ç„¶åå°†æƒåŠ›äº¤ç»™å†…æ ¸ï¼›æœ€åå†…æ ¸å¯åŠ¨ï¼Œåˆå§‹åŒ–æ•´ä¸ªæ“ä½œç³»ç»Ÿã€‚é‚£æˆ‘ä»¬å®‰è£…æ“ä½œç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œåªèƒ½æ’åœ¨ BIOS å¯åŠ¨ä¹‹åäº†ã€‚å› ä¸ºæ²¡å®‰è£…ç³»ç»Ÿä¹‹å‰ï¼Œè¿å¯åŠ¨æ‰‡åŒºéƒ½æ²¡æœ‰ã€‚å› è€Œè¿™ä¸ªè¿‡ç¨‹å«åš<strong>é¢„å¯åŠ¨æ‰§è¡Œç¯å¢ƒï¼ˆPre-boot Execution Environmentï¼‰</strong></p><p>PXEåè®®ä¼šå…ˆæŠŠå®¢æˆ·ç«¯æ”¾åˆ°BIOSé‡Œé¢ï¼Œå½“è®¡ç®—æœºå¯åŠ¨çš„æ—¶å€™ï¼ŒBIOSæŠŠPXEå®¢æˆ·ç«¯è°ƒå…¥å†…å­˜é‡Œé¢ï¼Œå°±å¯ä»¥è¿æ¥åˆ°æœåŠ¡ç«¯åšä¸€äº›æ“ä½œäº†ã€‚</p><p>é¦–å…ˆï¼ŒPXE å®¢æˆ·ç«¯è‡ªå·±ä¹Ÿéœ€è¦æœ‰ä¸ª IP åœ°å€ã€‚å› ä¸º PXE çš„å®¢æˆ·ç«¯å¯åŠ¨èµ·æ¥ï¼Œå°±å¯ä»¥å‘é€ä¸€ä¸ª DHCP çš„è¯·æ±‚ï¼Œè®© DHCP Server ç»™å®ƒåˆ†é…ä¸€ä¸ªåœ°å€ã€‚PXE å®¢æˆ·ç«¯æœ‰äº†è‡ªå·±çš„åœ°å€ï¼Œé‚£å®ƒæ€ä¹ˆçŸ¥é“ PXE æœåŠ¡å™¨åœ¨å“ªé‡Œå‘¢ï¼Ÿå¯¹äºå…¶ä»–çš„åè®®ï¼Œéƒ½å¥½åŠï¼Œè¦ä¹ˆäººå‘Šè¯‰ä»–ã€‚ä¾‹å¦‚ï¼Œå‘Šè¯‰æµè§ˆå™¨è¦è®¿é—®çš„ IP åœ°å€ï¼Œæˆ–è€…åœ¨é…ç½®ä¸­å‘Šè¯‰å®ƒï¼›ä¾‹å¦‚ï¼Œå¾®æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ã€‚</p><p>ä½†æ˜¯ PXE å®¢æˆ·ç«¯å¯åŠ¨çš„æ—¶å€™ï¼Œå•¥éƒ½æ²¡æœ‰ã€‚å¥½åœ¨ DHCP Server é™¤äº†åˆ†é… IP åœ°å€ä»¥å¤–ï¼Œè¿˜å¯ä»¥åšä¸€äº›å…¶ä»–çš„äº‹æƒ…ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª DHCP Server çš„ä¸€ä¸ªæ ·ä¾‹é…ç½®ï¼š</p><pre><code>ddns-update-style interim;ignore client-updates;allow booting;allow bootp;subnet 192.168.1.0 netmask 255.255.255.0{option routers 192.168.1.1;option subnet-mask 255.255.255.0;option time-offset -18000;default-lease-time 21600;max-lease-time 43200;range dynamic-bootp 192.168.1.240 192.168.1.250;filename &quot;pxelinux.0&quot;;next-server 192.168.1.180;}</code></pre><p>æŒ‰ç…§ä¸Šé¢çš„åŸç†ï¼Œé»˜è®¤çš„ DHCP Server æ˜¯éœ€è¦é…ç½®çš„ï¼Œæ— éæ˜¯æˆ‘ä»¬é…ç½® IP çš„æ—¶å€™æ‰€éœ€è¦çš„ IP åœ°å€æ®µã€å­ç½‘æ©ç ã€ç½‘å…³åœ°å€ã€ç§ŸæœŸç­‰ã€‚å¦‚æœæƒ³ä½¿ç”¨ PXEï¼Œåˆ™éœ€è¦é…ç½® next-serverï¼ŒæŒ‡å‘ PXE æœåŠ¡å™¨çš„åœ°å€ï¼Œå¦å¤–è¦é…ç½®åˆå§‹å¯åŠ¨æ–‡ä»¶ filenameã€‚</p><p><img src="https://i.loli.net/2020/02/02/jzfUBDdHvXFOorq.jpg" alt="fig8.jpg"></p><h1 id="2-ICMPåè®®"><a href="#2-ICMPåè®®" class="headerlink" title="2. ICMPåè®®"></a>2. ICMPåè®®</h1><p>pingçš„å·¥ä½œåŸç†ï¼Œpingæ˜¯åŸºäºICMPåè®®æ¥å·¥ä½œçš„ï¼ŒICMPå…¨ç§°ä¸º: Internet Control Message Protocolï¼Œå°±æ˜¯äº’è”ç½‘æ§åˆ¶æŠ¥æ–‡åè®®ã€‚</p><p>ICMPæŠ¥æ–‡æ˜¯å°è£…åœ¨IPåŒ…é‡Œé¢çš„ã€‚å¦‚å›¾æ‰€ç¤º</p><p><img src="https://i.loli.net/2020/02/02/msIXOvPpSal59h3.jpg" alt="fig9.jpg"></p><h2 id="2-1-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹"><a href="#2-1-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹" class="headerlink" title="2.1 æŸ¥è¯¢æŠ¥æ–‡ç±»å‹"></a>2.1 æŸ¥è¯¢æŠ¥æ–‡ç±»å‹</h2><p>ICMPä¸»åŠ¨å‘èµ·çš„ï¼Œå¯¹äºpingçš„ä¸»åŠ¨è¯·æ±‚ï¼Œè¿›è¡Œç½‘ç»œæŠ“åŒ…ï¼Œç§°ä¸ºICMP ECHO REQUEST. åŒç†ä¸»åŠ¨è¯·æ±‚çš„å›å¤ç§°ä¸ºICMP ECHO REPLY. æ¯”èµ·åŸç”Ÿçš„ICMPå¤šäº†æ ‡è¯†ç¬¦å’Œåºå·ä¸¤ä¸ªå­—æ®µã€‚</p><h2 id="2-2-å·®é”™æŠ¥æ–‡ç±»å‹"><a href="#2-2-å·®é”™æŠ¥æ–‡ç±»å‹" class="headerlink" title="2.2 å·®é”™æŠ¥æ–‡ç±»å‹"></a>2.2 å·®é”™æŠ¥æ–‡ç±»å‹</h2><ol><li>ç»ˆç‚¹ä¸å¯è¾¾ 3</li></ol><ul><li>ç½‘ç»œä¸å¯è¾¾ 0</li><li>ä¸»æœºä¸å¯è¾¾ 1</li><li>åè®®ä¸å¯è¾¾ 2</li><li>ç«¯å£ä¸å¯è¾¾ 3</li><li>éœ€è¦è¿›è¡Œåˆ†ç‰‡ä½†è®¾ç½®äº†ä¸åˆ†ç‰‡</li></ul><ol start="2"><li>æºæŠ‘åˆ¶ 4</li></ol><p>æºç«™æ”¾æ…¢äº†é€Ÿåº¦</p><ol start="3"><li>è¶…æ—¶ 11</li></ol><p>è¶…è¿‡äº†ç½‘ç»œåŒ…çš„ç”Ÿå­˜æ—¶é—´ï¼Œä½†æ˜¯è¿˜æ²¡åˆ°</p><ol start="4"><li>é‡å®šå‘ 5</li></ol><p>æ¢ä¸‹æ¬¡å‘é€ä½¿ç”¨çš„è·¯ç”±å™¨</p><h2 id="2-3-Pingçš„ä½¿ç”¨-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"><a href="#2-3-Pingçš„ä½¿ç”¨-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨" class="headerlink" title="2.3 Pingçš„ä½¿ç”¨ æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"></a>2.3 Pingçš„ä½¿ç”¨ æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨</h2><p>ä¸‹å›¾æè¿°äº†pingçš„æ•´ä¸ªå‘é€å’Œæ¥æ”¶è¿‡ç¨‹ã€‚<br><img src="https://i.loli.net/2020/02/02/myJlI8dY1rju3sw.jpg" alt="fig10.jpg"></p><p>å‡å®šä¸»æœº A çš„ IP åœ°å€æ˜¯ 192.168.1.1ï¼Œä¸»æœº B çš„ IP åœ°å€æ˜¯ 192.168.1.2ï¼Œå®ƒä»¬éƒ½åœ¨åŒä¸€ä¸ªå­ç½‘ã€‚é‚£å½“ä½ åœ¨ä¸»æœº A ä¸Šè¿è¡Œâ€œping 192.168.1.2â€åï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?</p><p>ping å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œæºä¸»æœºé¦–å…ˆä¼šæ„å»ºä¸€ä¸ª ICMP è¯·æ±‚æ•°æ®åŒ…ï¼ŒICMP æ•°æ®åŒ…å†…åŒ…å«å¤šä¸ªå­—æ®µã€‚æœ€é‡è¦çš„æ˜¯ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯ç±»å‹å­—æ®µï¼Œå¯¹äºè¯·æ±‚æ•°æ®åŒ…è€Œè¨€è¯¥å­—æ®µä¸º 8ï¼›å¦å¤–ä¸€ä¸ªæ˜¯é¡ºåºå·ï¼Œä¸»è¦ç”¨äºåŒºåˆ†è¿ç»­ ping çš„æ—¶å€™å‘å‡ºçš„å¤šä¸ªæ•°æ®åŒ…ã€‚æ¯å‘å‡ºä¸€ä¸ªè¯·æ±‚æ•°æ®åŒ…ï¼Œé¡ºåºå·ä¼šè‡ªåŠ¨åŠ  1ã€‚ä¸ºäº†èƒ½å¤Ÿè®¡ç®—å¾€è¿”æ—¶é—´ RTTï¼Œå®ƒä¼šåœ¨æŠ¥æ–‡çš„æ•°æ®éƒ¨åˆ†æ’å…¥å‘é€æ—¶é—´ã€‚</p><p>ç„¶åï¼Œç”± ICMP åè®®å°†è¿™ä¸ªæ•°æ®åŒ…è¿åŒåœ°å€ 192.168.1.2 ä¸€èµ·äº¤ç»™ IP å±‚ã€‚IP å±‚å°†ä»¥ 192.168.1.2 ä½œä¸ºç›®çš„åœ°å€ï¼Œæœ¬æœº IP åœ°å€ä½œä¸ºæºåœ°å€ï¼ŒåŠ ä¸Šä¸€äº›å…¶ä»–æ§åˆ¶ä¿¡æ¯ï¼Œæ„å»ºä¸€ä¸ª IP æ•°æ®åŒ…ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œéœ€è¦åŠ å…¥ MAC å¤´ã€‚å¦‚æœåœ¨æœ¬èŠ‚ ARP æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾å‡º IP åœ°å€ 192.168.1.2 æ‰€å¯¹åº”çš„ MAC åœ°å€ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™éœ€è¦å‘é€ ARP åè®®æŸ¥è¯¢ MAC åœ°å€ï¼Œè·å¾— MAC åœ°å€åï¼Œç”±æ•°æ®é“¾è·¯å±‚æ„å»ºä¸€ä¸ªæ•°æ®å¸§ï¼Œç›®çš„åœ°å€æ˜¯ IP å±‚ä¼ è¿‡æ¥çš„ MAC åœ°å€ï¼Œæºåœ°å€åˆ™æ˜¯æœ¬æœºçš„ MAC åœ°å€ï¼›è¿˜è¦é™„åŠ ä¸Šä¸€äº›æ§åˆ¶ä¿¡æ¯ï¼Œä¾æ®ä»¥å¤ªç½‘çš„ä»‹è´¨è®¿é—®è§„åˆ™ï¼Œå°†å®ƒä»¬ä¼ é€å‡ºå»ã€‚</p><p>ä¸»æœº B æ”¶åˆ°è¿™ä¸ªæ•°æ®å¸§åï¼Œå…ˆæ£€æŸ¥å®ƒçš„ç›®çš„ MAC åœ°å€ï¼Œå¹¶å’Œæœ¬æœºçš„ MAC åœ°å€å¯¹æ¯”ï¼Œå¦‚ç¬¦åˆï¼Œåˆ™æ¥æ”¶ï¼Œå¦åˆ™å°±ä¸¢å¼ƒã€‚æ¥æ”¶åæ£€æŸ¥è¯¥æ•°æ®å¸§ï¼Œå°† IP æ•°æ®åŒ…ä»å¸§ä¸­æå–å‡ºæ¥ï¼Œäº¤ç»™æœ¬æœºçš„ IP å±‚ã€‚åŒæ ·ï¼ŒIP å±‚æ£€æŸ¥åï¼Œå°†æœ‰ç”¨çš„ä¿¡æ¯æå–åäº¤ç»™ ICMP åè®®ã€‚</p><p>ä¸»æœº B ä¼šæ„å»ºä¸€ä¸ª ICMP åº”ç­”åŒ…ï¼Œåº”ç­”æ•°æ®åŒ…çš„ç±»å‹å­—æ®µä¸º 0ï¼Œé¡ºåºå·ä¸ºæ¥æ”¶åˆ°çš„è¯·æ±‚æ•°æ®åŒ…ä¸­çš„é¡ºåºå·ï¼Œç„¶åå†å‘é€å‡ºå»ç»™ä¸»æœº Aã€‚</p><p>åœ¨è§„å®šçš„æ—¶å€™é—´å†…ï¼Œæºä¸»æœºå¦‚æœæ²¡æœ‰æ¥åˆ° ICMP çš„åº”ç­”åŒ…ï¼Œåˆ™è¯´æ˜ç›®æ ‡ä¸»æœºä¸å¯è¾¾ï¼›å¦‚æœæ¥æ”¶åˆ°äº† ICMP åº”ç­”åŒ…ï¼Œåˆ™è¯´æ˜ç›®æ ‡ä¸»æœºå¯è¾¾ã€‚æ­¤æ—¶ï¼Œæºä¸»æœºä¼šæ£€æŸ¥ï¼Œç”¨å½“å‰æ—¶åˆ»å‡å»è¯¥æ•°æ®åŒ…æœ€åˆä»æºä¸»æœºä¸Šå‘å‡ºçš„æ—¶åˆ»ï¼Œå°±æ˜¯ ICMP æ•°æ®åŒ…çš„æ—¶é—´å»¶è¿Ÿã€‚</p><h2 id="2-4-traceroute-å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"><a href="#2-4-traceroute-å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨" class="headerlink" title="2.4 traceroute å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"></a>2.4 traceroute å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨</h2><p>tracerouteä¼šæ•…æ„è®¾ç½®ç‰¹æ®Šçš„TTLï¼Œæ¥è¿½è¸ªå»å¾€ç›®çš„åœ°æ²¿é€”ç»è¿‡çš„è·¯ç”±å™¨ã€‚Traceroute çš„å‚æ•°æŒ‡å‘æŸä¸ªç›®çš„ IP åœ°å€ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª UDP çš„æ•°æ®åŒ…ã€‚å°† TTL è®¾ç½®æˆ 1ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦é‡åˆ°ä¸€ä¸ªè·¯ç”±å™¨æˆ–è€…ä¸€ä¸ªå…³å¡ï¼Œå°±è¡¨ç¤ºå®ƒâ€œç‰ºç‰²â€äº†ã€‚</p><p>å¦‚æœä¸­é—´çš„è·¯ç”±å™¨ä¸æ­¢ä¸€ä¸ªï¼Œå½“ç„¶ç¢°åˆ°ç¬¬ä¸€ä¸ªå°±â€œç‰ºç‰²â€ã€‚äºæ˜¯ï¼Œè¿”å›ä¸€ä¸ª ICMP åŒ…ï¼Œä¹Ÿå°±æ˜¯ç½‘ç»œå·®é”™åŒ…ï¼Œç±»å‹æ˜¯æ—¶é—´è¶…æ—¶ã€‚é‚£å¤§å†›å‰è¡Œå°±å¸¦ä¸€é¡¿é¥­ï¼Œè¯•ä¸€è¯•èµ°å¤šè¿œä¼šè¢«é¥¿æ­»ï¼Œç„¶åæ‰¾ä¸ªå“¨æ¢å›æ¥æŠ¥å‘Šï¼Œé‚£æˆ‘å°±çŸ¥é“å¤§å†›åªå¸¦ä¸€é¡¿é¥­èƒ½èµ°å¤šè¿œäº†ã€‚æ¥ä¸‹æ¥ï¼Œå°† TTL è®¾ç½®ä¸º 2ã€‚ç¬¬ä¸€å…³è¿‡äº†ï¼Œç¬¬äºŒå…³å°±â€œç‰ºç‰²â€äº†ï¼Œé‚£æˆ‘å°±çŸ¥é“ç¬¬äºŒå…³æœ‰å¤šè¿œã€‚å¦‚æ­¤åå¤ï¼Œç›´åˆ°åˆ°è¾¾ç›®çš„ä¸»æœºã€‚è¿™æ ·ï¼ŒTraceroute å°±æ‹¿åˆ°äº†æ‰€æœ‰çš„è·¯ç”±å™¨ IPã€‚å½“ç„¶ï¼Œæœ‰çš„è·¯ç”±å™¨å‹æ ¹ä¸ä¼šå›è¿™ä¸ª ICMPã€‚è¿™ä¹Ÿæ˜¯ Traceroute ä¸€ä¸ªå…¬ç½‘çš„åœ°å€ï¼Œçœ‹ä¸åˆ°ä¸­é—´è·¯ç”±çš„åŸå› ã€‚</p><p>æ€ä¹ˆçŸ¥é“ UDP æœ‰æ²¡æœ‰åˆ°è¾¾ç›®çš„ä¸»æœºå‘¢ï¼ŸTraceroute ç¨‹åºä¼šå‘é€ä¸€ä»½ UDP æ•°æ®æŠ¥ç»™ç›®çš„ä¸»æœºï¼Œä½†å®ƒä¼šé€‰æ‹©ä¸€ä¸ªä¸å¯èƒ½çš„å€¼ä½œä¸º UDP ç«¯å£å·ï¼ˆå¤§äº 30000ï¼‰ã€‚å½“è¯¥æ•°æ®æŠ¥åˆ°è¾¾æ—¶ï¼Œå°†ä½¿ç›®çš„ä¸»æœºçš„ UDP æ¨¡å—äº§ç”Ÿä¸€ä»½â€œç«¯å£ä¸å¯è¾¾â€é”™è¯¯ ICMP æŠ¥æ–‡ã€‚å¦‚æœæ•°æ®æŠ¥æ²¡æœ‰åˆ°è¾¾ï¼Œåˆ™å¯èƒ½æ˜¯è¶…æ—¶ã€‚</p><p>Traceroute è¿˜æœ‰ä¸€ä¸ªä½œç”¨æ˜¯æ•…æ„è®¾ç½®ä¸åˆ†ç‰‡ï¼Œä»è€Œç¡®å®šè·¯å¾„çš„ MTUã€‚</p><p>è¦åšçš„å·¥ä½œé¦–å…ˆæ˜¯å‘é€åˆ†ç»„ï¼Œå¹¶è®¾ç½®â€œä¸åˆ†ç‰‡â€æ ‡å¿—ã€‚å‘é€çš„ç¬¬ä¸€ä¸ªåˆ†ç»„çš„é•¿åº¦æ­£å¥½ä¸å‡ºå£ MTU ç›¸ç­‰ã€‚å¦‚æœä¸­é—´é‡åˆ°çª„çš„å…³å£ä¼šè¢«å¡ä½ï¼Œä¼šå‘é€ ICMP ç½‘ç»œå·®é”™åŒ…ï¼Œç±»å‹ä¸ºâ€œéœ€è¦è¿›è¡Œåˆ†ç‰‡ä½†è®¾ç½®äº†ä¸åˆ†ç‰‡ä½â€ã€‚å…¶å®ï¼Œè¿™æ˜¯äººå®¶æ•…æ„çš„å¥½å§ï¼Œæ¯æ¬¡æ”¶åˆ° ICMPâ€œä¸èƒ½åˆ†ç‰‡â€å·®é”™æ—¶å°±å‡å°åˆ†ç»„çš„é•¿åº¦ï¼Œç›´åˆ°åˆ°è¾¾ç›®æ ‡ä¸»æœºã€‚</p><h1 id="3-è·¨ç½‘å…³è®¿é—®"><a href="#3-è·¨ç½‘å…³è®¿é—®" class="headerlink" title="3. è·¨ç½‘å…³è®¿é—®"></a>3. è·¨ç½‘å…³è®¿é—®</h1><p><img src="https://i.loli.net/2020/02/02/RY9W3aixfpqEtOc.jpg" alt="fig16.jpg"><br>ä¸€æ—¦é…ç½®äº†IPåœ°å€å’Œç½‘å…³ï¼Œå¾€å¾€å°±èƒ½å¤ŸæŒ‡å®šç›®æ ‡åœ°å€è¿›è¡Œè®¿é—®äº†ã€‚åœ¨è·¨ç½‘å…³è®¿é—®çš„æ—¶å€™ï¼Œä¼šç‰µæ‰¯åˆ°MACåœ°å€å’ŒIPåœ°å€çš„å˜åŒ–ã€‚</p><p>åœ¨ MAC å¤´é‡Œé¢ï¼Œå…ˆæ˜¯ç›®æ ‡ MAC åœ°å€ï¼Œç„¶åæ˜¯æº MAC åœ°å€ï¼Œç„¶åæœ‰ä¸€ä¸ªåè®®ç±»å‹ï¼Œç”¨æ¥è¯´æ˜é‡Œé¢æ˜¯ IP åè®®ã€‚IP å¤´é‡Œé¢çš„ç‰ˆæœ¬å·ï¼Œç›®å‰ä¸»æµçš„è¿˜æ˜¯ IPv4ï¼ŒæœåŠ¡ç±»å‹ TOS åœ¨ç¬¬ä¸‰èŠ‚è®² ip addr å‘½ä»¤çš„æ—¶å€™è®²è¿‡ï¼ŒTTL åœ¨ç¬¬ 7 èŠ‚è®² ICMP åè®®çš„æ—¶å€™è®²è¿‡ã€‚å¦å¤–ï¼Œè¿˜æœ‰ 8 ä½æ ‡è¯†åè®®ã€‚è¿™é‡Œåˆ°äº†ä¸‹ä¸€å±‚çš„åè®®ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ˜¯ TCP è¿˜æ˜¯ UDPã€‚æœ€é‡è¦çš„å°±æ˜¯æº IP å’Œç›®æ ‡ IPã€‚å…ˆæ˜¯æº IP åœ°å€ï¼Œç„¶åæ˜¯ç›®æ ‡ IP åœ°å€ã€‚</p><p>åœ¨ä»»ä½•ä¸€å°æœºå™¨ä¸Šï¼Œå½“è¦è®¿é—®å¦å¤–ä¸€ä¸ªIPåœ°å€çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆåˆ¤æ–­è¿™ä¸ªç›®æ ‡åœ°å€å’Œå½“å‰æœºå™¨çš„IPåœ°å€æ˜¯å¦åœ¨åŒä¸€ä¸ªç½‘æ®µå½“ä¸­ã€‚ä½¿ç”¨CIDRå’Œå­ç½‘æ©ç æ¥è¿›è¡Œåˆ¤æ–­ã€‚</p><p>å¦‚æœä¸æ˜¯åŒä¸€ä¸ªç½‘æ®µçš„ï¼Œå°±éœ€è¦å°†è¯·æ±‚å‘å¾€é»˜è®¤ç½‘å…³gateway. Gatewayçš„åœ°å€ä¸€å®šå’ŒæºIPåœ°å€æ˜¯ä¸€ä¸ªç½‘æ®µçš„ã€‚ä¾‹å¦‚192.168.1.0/24è¿™ä¸ªç½‘æ®µï¼ŒGatewayå¾€å¾€æ˜¯192.168.1.1/24æˆ–è€…192.168.1.2/24 </p><p>å¦‚ä½•å‘å¾€é»˜è®¤ç½‘å…³å‘¢ï¼Ÿç½‘å…³ä¸æ˜¯å’Œæº IP åœ°å€æ˜¯ä¸€ä¸ªç½‘æ®µçš„ä¹ˆï¼Ÿè¿™ä¸ªè¿‡ç¨‹å°±å’Œå‘å¾€åŒä¸€ä¸ªç½‘æ®µçš„å…¶ä»–æœºå™¨æ˜¯ä¸€æ ·çš„ï¼šå°†æºåœ°å€å’Œç›®æ ‡ IP åœ°å€æ”¾å…¥ IP å¤´ä¸­ï¼Œé€šè¿‡ ARP è·å¾—ç½‘å…³çš„ MAC åœ°å€ï¼Œå°†æº MAC å’Œç½‘å…³çš„ MAC æ”¾å…¥ MAC å¤´ä¸­ï¼Œå‘é€å‡ºå»ã€‚ç½‘å…³æ‰€åœ¨çš„ç«¯å£ï¼Œä¾‹å¦‚ 192.168.1.1/24 å°†ç½‘ç»œåŒ…æ”¶è¿›æ¥ï¼Œç„¶åæ¥ä¸‹æ¥æ€ä¹ˆåšï¼Œå°±å®Œå…¨çœ‹ç½‘å…³çš„äº†ã€‚</p><p>ç½‘å…³å¾€å¾€æ˜¯ä¸€ä¸ª<strong><em>è·¯ç”±å™¨</em></strong>ï¼Œæ˜¯ä¸ªä¸‰å±‚è½¬å‘è®¾å¤‡ï¼ˆ<strong><em>å°±æ˜¯æŠŠMACå¤´å’ŒIPå¤´éƒ½å–ä¸‹æ¥ï¼Œç„¶åæ ¹æ®é‡Œé¢çš„å†…å®¹ï¼Œçœ‹çœ‹æ¥ä¸‹æ¥æŠŠåŒ…å¾€å“ªé‡Œè½¬å‘çš„è®¾å¤‡</em></strong>ï¼‰</p><h2 id="3-1-é™æ€è·¯ç”±"><a href="#3-1-é™æ€è·¯ç”±" class="headerlink" title="3.1 é™æ€è·¯ç”±"></a>3.1 é™æ€è·¯ç”±</h2><p>åœ¨è·¯ç”±å™¨ä¸Šé…ç½®ä¸€æ¡æ¡è§„åˆ™ï¼Œé€šè¿‡ç½‘å…³è¿›è¡Œè½¬å‘</p><h3 id="3-1-1-è½¬å‘ç½‘å…³"><a href="#3-1-1-è½¬å‘ç½‘å…³" class="headerlink" title="3.1.1 è½¬å‘ç½‘å…³"></a>3.1.1 è½¬å‘ç½‘å…³</h3><p>åªæ”¹å˜MACåœ°å€ï¼Œä¸æ”¹å˜IPçš„ç½‘å…³</p><p><img src="https://i.loli.net/2020/02/02/QJE7CzFcOVjDuTp.jpg" alt="fig11.jpg"></p><p>æœåŠ¡å™¨ A è¦è®¿é—®æœåŠ¡å™¨ Bã€‚é¦–å…ˆï¼ŒæœåŠ¡å™¨ A ä¼šæ€è€ƒï¼Œ192.168.4.101 å’Œæˆ‘ä¸æ˜¯ä¸€ä¸ªç½‘æ®µçš„ï¼Œå› è€Œéœ€è¦å…ˆå‘ç»™ç½‘å…³ã€‚é‚£ç½‘å…³æ˜¯è°å‘¢ï¼Ÿå·²ç»é™æ€é…ç½®å¥½äº†ï¼Œç½‘å…³æ˜¯ 192.168.1.1ã€‚ç½‘å…³çš„ MAC åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿå‘é€ ARP è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œç„¶åå‘é€åŒ…ã€‚åŒ…çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æºMAC: server A MAC addr</li><li>ç›®æ ‡MAC: 192.168.1.1 è¿™ä¸ªç½‘å£çš„MAC</li><li>æºIPï¼š 192.168.1.101</li><li>ç›®æ ‡IP: 192.168.4.101 </li></ul><p>åŒ…åˆ°è¾¾ 192.168.1.1 è¿™ä¸ªç½‘å£ï¼Œå‘ç° MAC ä¸€è‡´ï¼Œå°†åŒ…æ”¶è¿›æ¥ï¼Œå¼€å§‹æ€è€ƒå¾€å“ªé‡Œè½¬å‘ã€‚åœ¨è·¯ç”±å™¨ A ä¸­é…ç½®äº†é™æ€è·¯ç”±ä¹‹åï¼Œè¦æƒ³è®¿é—® 192.168.4.0/24ï¼Œè¦ä» 192.168.56.1 è¿™ä¸ªå£å‡ºå»ï¼Œä¸‹ä¸€è·³ä¸º 192.168.56.2ã€‚</p><p>äºæ˜¯ï¼Œè·¯ç”±å™¨ A æ€è€ƒçš„æ—¶å€™ï¼ŒåŒ¹é…ä¸Šäº†è¿™æ¡è·¯ç”±ï¼Œè¦ä» 192.168.56.1 è¿™ä¸ªå£å‘å‡ºå»ï¼Œå‘ç»™ 192.168.56.2ï¼Œé‚£ 192.168.56.2 çš„ MAC åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿè·¯ç”±å™¨ A å‘é€ ARP è·å– 192.168.56.2 çš„ MAC åœ°å€ï¼Œç„¶åå‘é€åŒ…ã€‚åŒ…çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æºMAC: 192.168.56.1 MAC addr</li><li>ç›®æ ‡MAC: 192.168.56.2 è¿™ä¸ªç½‘å£çš„MAC</li><li>æºIPï¼š 192.168.1.101</li><li>ç›®æ ‡IP: 192.168.4.101 </li></ul><p>åŒ…åˆ°è¾¾ 192.168.56.2 è¿™ä¸ªç½‘å£ï¼Œå‘ç° MAC ä¸€è‡´ï¼Œå°†åŒ…æ”¶è¿›æ¥ï¼Œå¼€å§‹æ€è€ƒå¾€å“ªé‡Œè½¬å‘ã€‚åœ¨è·¯ç”±å™¨ B ä¸­é…ç½®äº†é™æ€è·¯ç”±ï¼Œè¦æƒ³è®¿é—® 192.168.4.0/24ï¼Œè¦ä» 192.168.4.1 è¿™ä¸ªå£å‡ºå»ï¼Œæ²¡æœ‰ä¸‹ä¸€è·³äº†ã€‚</p><p>äºæ˜¯ï¼Œè·¯ç”±å™¨ B æ€è€ƒçš„æ—¶å€™ï¼ŒåŒ¹é…ä¸Šäº†è¿™æ¡è·¯ç”±ï¼Œè¦ä» 192.168.4.1 è¿™ä¸ªå£å‘å‡ºå»ï¼Œå‘ç»™ 192.168.4.101ã€‚é‚£ 192.168.4.101 çš„ MAC åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿè·¯ç”±å™¨ B å‘é€ ARP è·å– 192.168.4.101 çš„ MAC åœ°å€ï¼Œç„¶åå‘é€åŒ…ã€‚åŒ…çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æºMAC: 192.168.4.1 MAC addr</li><li>ç›®æ ‡MAC: 192.168.4.101 è¿™ä¸ªç½‘å£çš„MAC</li><li>æºIPï¼š 192.168.1.101</li><li>ç›®æ ‡IP: 192.168.4.101 </li></ul><p>åŒ…åˆ°è¾¾æœåŠ¡å™¨Bï¼Œç”±ä¸Šè¿°è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼ŒMACåœ°å€ä¸€ç›´éƒ½æ˜¯å˜çš„ï¼Œè€ŒIPåœ°å€ä¸€ç›´éƒ½ä¸ä¼šå˜ã€‚</p><h3 id="3-1-2-NATç½‘å…³-Network-Address-Translation"><a href="#3-1-2-NATç½‘å…³-Network-Address-Translation" class="headerlink" title="3.1.2 NATç½‘å…³ (Network Address Translation)"></a>3.1.2 NATç½‘å…³ (Network Address Translation)</h3><p>NATç½‘å…³å‡ºç°çš„åŸå› æ˜¯IPå†²çªï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå„ä¸ªå±€åŸŸç½‘åœ¨è®¾å€¼çš„æ—¶å€™IPæ˜¯ä¸€æ ·çš„æƒ…å†µã€‚</p><p><img src="https://i.loli.net/2020/02/02/tymIY6pk3iwNz1a.jpg" alt="fig12.jpg"></p><p>è¿™é‡Œé‡è§çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå±€åŸŸç½‘ä¹‹é—´æ²¡æœ‰å•†é‡è¿‡ï¼Œå„å®šå„çš„ç½‘æ®µï¼Œå› è€Œ IP æ®µå†²çªäº†ã€‚æœ€å·¦é¢æºåœ°å€æ˜¯ 192.168.1.101ï¼Œæœ€å³é¢ç›®æ ‡åœ°å€ä¹Ÿæ˜¯ 192.168.1.101ï¼Œå¦‚æœå•ä» IP åœ°å€ä¸Šçœ‹ï¼Œç®€ç›´æ˜¯è‡ªå·±è®¿é—®è‡ªå·±ï¼Œå…¶å®æ˜¯æºçš„ 192.168.1.101 è¦è®¿é—®ç›®æ ‡çš„ 192.168.1.101ã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨ä¸­é—´çš„å±€åŸŸç½‘ä¸­ä½¿ç”¨å¦å¤–çš„åœ°å€ï¼Œæ¥è¿›è¡ŒåŒºåˆ†ã€‚æœ‰ç‚¹åƒèº«ä»½è¯å’ŒæŠ¤ç…§çš„å…³ç³»ã€‚</p><p>é¦–å…ˆï¼Œç›®æ ‡æœåŠ¡å™¨ B åœ¨å›½é™…ä¸Šè¦æœ‰ä¸€ä¸ªå›½é™…çš„èº«ä»½ï¼Œæˆ‘ä»¬ç»™å®ƒä¸€ä¸ª 192.168.56.2ã€‚åœ¨ç½‘å…³ B ä¸Šï¼Œæˆ‘ä»¬è®°ä¸‹æ¥ï¼Œå›½é™…èº«ä»½ 192.168.56.2 å¯¹åº”å›½å†…èº«ä»½ 192.168.1.101ã€‚å‡¡æ˜¯è¦è®¿é—® 192.168.56.2ï¼Œéƒ½è½¬æˆ 192.168.1.101ã€‚</p><p>äºæ˜¯ï¼ŒæºæœåŠ¡å™¨ A è¦è®¿é—®ç›®æ ‡æœåŠ¡å™¨ Bï¼Œè¦æŒ‡å®šçš„ç›®æ ‡åœ°å€ä¸º 192.168.56.2ã€‚è¿™æ˜¯å®ƒçš„å›½é™…èº«ä»½ã€‚æœåŠ¡å™¨ A æƒ³ï¼Œ192.168.56.2 å’Œæˆ‘ä¸æ˜¯ä¸€ä¸ªç½‘æ®µçš„ï¼Œå› è€Œéœ€è¦å‘ç»™ç½‘å…³ï¼Œç½‘å…³æ˜¯è°ï¼Ÿå·²ç»é™æ€é…ç½®å¥½äº†ï¼Œç½‘å…³æ˜¯ 192.168.1.1ï¼Œç½‘å…³çš„ MAC åœ°å€æ˜¯å¤šå°‘ï¼Ÿå‘é€ ARP è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œç„¶åå‘é€åŒ…ã€‚åŒ…çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æºMAC: æœåŠ¡å™¨A çš„ MAC addr</li><li>ç›®æ ‡MAC: 192.168.1.1 è¿™ä¸ªç½‘å£çš„MAC</li><li>æºIPï¼š 192.168.1.101</li><li>ç›®æ ‡IP: 192.168.56.2</li></ul><p>åŒ…åˆ°è¾¾ 192.168.1.1 è¿™ä¸ªç½‘å£ï¼Œå‘ç° MAC ä¸€è‡´ï¼Œå°†åŒ…æ”¶è¿›æ¥ï¼Œå¼€å§‹æ€è€ƒå¾€å“ªé‡Œè½¬å‘ã€‚</p><p>åœ¨è·¯ç”±å™¨ A ä¸­é…ç½®äº†é™æ€è·¯ç”±ï¼šè¦æƒ³è®¿é—® 192.168.56.2/24ï¼Œè¦ä» 192.168.56.1 è¿™ä¸ªå£å‡ºå»ï¼Œæ²¡æœ‰ä¸‹ä¸€è·³äº†ã€‚</p><p>äºæ˜¯ï¼Œè·¯ç”±å™¨ A æ€è€ƒçš„æ—¶å€™ï¼ŒåŒ¹é…ä¸Šäº†è¿™æ¡è·¯ç”±ï¼Œè¦ä» 192.168.56.1 è¿™ä¸ªå£å‘å‡ºå»ï¼Œå‘ç»™ 192.168.56.2ã€‚é‚£ 192.168.56.2 çš„ MAC åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿè·¯ç”±å™¨ A å‘é€ ARP è·å– 192.168.56.2 çš„ MAC åœ°å€ã€‚</p><p>å½“ç½‘ç»œåŒ…å‘é€åˆ°ä¸­é—´çš„å±€åŸŸç½‘çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ A ä¹Ÿéœ€è¦æœ‰ä¸ªå›½é™…èº«ä»½ï¼Œå› è€Œåœ¨å›½é™…ä¸Šï¼Œæº IP åœ°å€ä¹Ÿä¸èƒ½ç”¨ 192.168.1.101ï¼Œéœ€è¦æ”¹æˆ 192.168.56.1ã€‚å‘é€åŒ…çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æºMAC: 192.168.1.1 MAC addr</li><li>ç›®æ ‡MAC: 192.168.1.101 è¿™ä¸ªç½‘å£çš„MAC</li><li>æºIPï¼š 192.168.56.1</li><li>ç›®æ ‡IP: 192.168.1.101</li></ul><p>ä»æœåŠ¡å™¨Bæ¥æ”¶çš„åŒ…å¯ä»¥çœ‹å‡ºï¼ŒæºIPæ˜¯æœåŠ¡å™¨Açš„å›½é™…èº«ä»½ï¼Œå‘é€åŒ…å›å»çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å‘ç»™è¿™ä¸ªå›½é™…èº«ä»½ï¼Œç”±è·¯ç”±å™¨AåšNATï¼Œè½¬æ¢ä¸ºå›½å†…èº«ä»½ã€‚</p><h2 id="3-2-åŠ¨æ€è·¯ç”±"><a href="#3-2-åŠ¨æ€è·¯ç”±" class="headerlink" title="3.2 åŠ¨æ€è·¯ç”±"></a>3.2 åŠ¨æ€è·¯ç”±</h2><h3 id="3-2-1-è·¯ç”±è¡¨"><a href="#3-2-1-è·¯ç”±è¡¨" class="headerlink" title="3.2.1 è·¯ç”±è¡¨"></a>3.2.1 è·¯ç”±è¡¨</h3><p>è·¯ç”±å™¨æ˜¯ä¸€å°ç½‘ç»œè®¾å¤‡ï¼Œæœ‰å¤šå¼ ç½‘å¡ï¼Œå½“ä¸€ä¸ªå…¥å£çš„ç½‘ç»œåŒ…é€åˆ°è·¯ç”±å™¨æ—¶ï¼Œå®ƒä¼šæ ¹æ®ä¸€ä¸ªæœ¬åœ°çš„è½¬å‘ä¿¡æ¯åº“ï¼Œæ¥å†³å®šå¦‚ä½•æ­£ç¡®åœ°è½¬å‘æµé‡ã€‚è¿™ä¸ªè½¬å‘ä¿¡æ¯åº“é€šå¸¸è¢«ç§°ä¸ºè·¯ç”±è¡¨ã€‚</p><p>ä¸€å¼ è·¯ç”±è¡¨ä¼šæœ‰å¤šä¸ªè·¯ç”±è§„åˆ™ï¼Œæ¯ä¸€å¤©è§„åˆ™è‡³å°‘åŒ…å«è¿™ä¸‰é¡¹ä¿¡æ¯ï¼š </p><ul><li>ç›®çš„ç½‘ç»œ</li><li>å‡ºå£è®¾å¤‡</li><li>ä¸‹ä¸€è·³ç½‘å…³</li></ul><h3 id="3-2-2-ç­–ç•¥è·¯ç”±"><a href="#3-2-2-ç­–ç•¥è·¯ç”±" class="headerlink" title="3.2.2 ç­–ç•¥è·¯ç”±"></a>3.2.2 ç­–ç•¥è·¯ç”±</h3><p>æ ¹æ®å¤šä¸ªå‚æ•°æ¥é…ç½®è·¯ç”±ï¼Œè¿™æ ·æ¥ä½¿å¾—ä¸åŒæ¥æºçš„åŒ…èµ°ä¸åŒçš„è·¯ç”±ã€‚</p><p>å®¶é‡Œçš„ç½‘ç»œå‘¢ï¼Œå°±æ˜¯æ™®é€šçš„å®¶ç”¨ç½‘æ®µ 192.168.1.x/24ã€‚å®¶é‡Œæœ‰ä¸¤ä¸ªç§Ÿæˆ·ï¼Œåˆ†åˆ«æŠŠçº¿è¿åˆ°è·¯ç”±å™¨ä¸Šã€‚IP åœ°å€ä¸º 192.168.1.101/24 å’Œ 192.168.1.102/24ï¼Œç½‘å…³éƒ½æ˜¯ 192.168.1.1/24ï¼Œç½‘å…³åœ¨è·¯ç”±å™¨ä¸Šã€‚ä¸¤ä¸ªè¿è¥å•†éƒ½è¦ä¸ºè¿™ä¸ªç½‘å…³é…ç½®ä¸€ä¸ªå…¬ç½‘çš„ IP åœ°å€ã€‚å¦‚æœä½ å»æŸ¥çœ‹ä½ ä»¬å®¶è·¯ç”±å™¨é‡Œçš„ç½‘æ®µï¼ŒåŸºæœ¬å°±æ˜¯æˆ‘å›¾ä¸­ç”»çš„æ ·å­ã€‚</p><p><img src="https://i.loli.net/2020/02/02/ZCbyHwg8prBSIz2.jpg" alt="fig13.jpg"></p><p>è¿è¡Œå•†é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª IP åœ°å€ï¼Œåœ¨è¿è¥å•†ç½‘ç»œé‡Œé¢çš„ç½‘å…³ã€‚ä¸åŒçš„è¿è¥å•†æ–¹æ³•ä¸ä¸€æ ·ï¼Œæœ‰çš„æ˜¯ /32 çš„ï¼Œä¹Ÿå³ä¸€ä¸ªä¸€å¯¹ä¸€è¿æ¥ã€‚ä¾‹å¦‚ï¼Œè¿è¥å•† 1 ç»™è·¯ç”±å™¨åˆ†é…çš„åœ°å€æ˜¯ 183.134.189.34/32ï¼Œè€Œè¿è¥å•†ç½‘ç»œé‡Œé¢çš„ç½‘å…³æ˜¯ 183.134.188.1/32ã€‚æœ‰çš„æ˜¯ /30 çš„ï¼Œä¹Ÿå°±æ˜¯åˆ†äº†ä¸€ä¸ªç‰¹åˆ«å°çš„ç½‘æ®µã€‚è¿è¥å•† 2 ç»™è·¯ç”±å™¨åˆ†é…çš„åœ°å€æ˜¯ 60.190.27.190/30ï¼Œè¿è¥å•†ç½‘ç»œé‡Œé¢çš„ç½‘å…³æ˜¯ 60.190.27.189/30ã€‚</p><pre><code>$ ip route list table main 60.190.27.189/30 dev eth3  proto kernel  scope link  src 60.190.27.190183.134.188.1 dev eth2  proto kernel  scope link  src 183.134.189.34192.168.1.0/24 dev eth1  proto kernel  scope link  src 192.168.1.1127.0.0.0/8 dev lo  scope linkdefault via 183.134.188.1 dev eth2</code></pre><ul><li>å¦‚æœå»è¿è¥å•†äºŒï¼Œå°±èµ° eth3ï¼›</li><li>å¦‚æœå»è¿è¥å•†ä¸€å‘¢ï¼Œå°±èµ° eth2ï¼›</li><li>å¦‚æœè®¿é—®å†…ç½‘ï¼Œå°±èµ° eth1ï¼›</li><li>å¦‚æœæ‰€æœ‰çš„è§„åˆ™éƒ½åŒ¹é…ä¸ä¸Šï¼Œé»˜è®¤èµ°è¿è¥å•†ä¸€ï¼Œä¹Ÿå³èµ°å¿«çš„ç½‘ç»œã€‚</li></ul><p>å¦‚ä½•è®©IPé»˜è®¤èµ°è¿è¥å•†2ï¼Ÿ</p><p>æ·»åŠ ä¸€ä¸ªæ–°çš„tableï¼Œ chao</p><pre><code># echo 200 chao &gt;&gt; /etc/iproute2/rt_tables</code></pre><p>æ·»åŠ ä¸€æ¡è§„åˆ™ï¼š</p><pre><code># ip rule add from 192.168.1.101 table chao# ip rule ls0:    from all lookup local 32765:    from 10.0.0.10 lookup chao32766:    from all lookup main 32767:    from all lookup default</code></pre><p>è®¾å®šè§„åˆ™ä¸ºï¼šä» 192.168.1.101 æ¥çš„åŒ…éƒ½æŸ¥çœ‹ä¸ª chao è¿™ä¸ªæ–°çš„è·¯ç”±è¡¨ã€‚<br>åœ¨chaoè·¯ç”±è¡¨ä¸­æ·»åŠ è§„åˆ™ï¼š </p><pre><code># ip route add default via 60.190.27.189 dev eth3 table chao# ip route flush cache</code></pre><h3 id="3-2-3-åŠ¨æ€è·¯ç”±ç®—æ³•"><a href="#3-2-3-åŠ¨æ€è·¯ç”±ç®—æ³•" class="headerlink" title="3.2.3 åŠ¨æ€è·¯ç”±ç®—æ³•"></a>3.2.3 åŠ¨æ€è·¯ç”±ç®—æ³•</h3><p>å¯»æ‰¾æœ€çŸ­è·¯å¾„ï¼Œä¸»è¦ä½¿ç”¨Bellman-Fordç®—æ³•å’ŒDijkstraç®—æ³•ã€‚</p><ol><li>è·ç¦»çŸ¢é‡è·¯ç”±ç®—æ³•</li></ol><p>è¿™ç§ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯ï¼Œæ¯ä¸ªè·¯ç”±å™¨éƒ½ä¿å­˜ä¸€ä¸ªè·¯ç”±è¡¨ï¼ŒåŒ…å«å¤šè¡Œï¼Œæ¯è¡Œå¯¹åº”ç½‘ç»œä¸­çš„ä¸€ä¸ªè·¯ç”±å™¨ï¼Œæ¯ä¸€è¡ŒåŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯è¦åˆ°ç›®æ ‡è·¯ç”±å™¨ï¼Œä»é‚£æ¡çº¿å‡ºå»ï¼Œå¦ä¸€ä¸ªæ˜¯åˆ°ç›®æ ‡è·¯ç”±å™¨çš„è·ç¦»ã€‚</p><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªè·¯ç”±å™¨éƒ½æ˜¯çŸ¥é“å…¨å±€ä¿¡æ¯çš„ã€‚é‚£è¿™ä¸ªä¿¡æ¯å¦‚ä½•æ›´æ–°å‘¢ï¼Ÿæ¯ä¸ªè·¯ç”±å™¨éƒ½çŸ¥é“è‡ªå·±å’Œé‚»å±…ä¹‹é—´çš„è·ç¦»ï¼Œæ¯è¿‡å‡ ç§’ï¼Œæ¯ä¸ªè·¯ç”±å™¨éƒ½å°†è‡ªå·±æ‰€çŸ¥çš„åˆ°è¾¾æ‰€æœ‰çš„è·¯ç”±å™¨çš„è·ç¦»å‘ŠçŸ¥é‚»å±…ï¼Œæ¯ä¸ªè·¯ç”±å™¨ä¹Ÿèƒ½ä»é‚»å±…é‚£é‡Œå¾—åˆ°ç›¸ä¼¼çš„ä¿¡æ¯ã€‚</p><p>æ¯ä¸ªè·¯ç”±å™¨æ ¹æ®æ–°æ”¶é›†çš„ä¿¡æ¯ï¼Œè®¡ç®—å’Œå…¶ä»–è·¯ç”±å™¨çš„è·ç¦»ï¼Œæ¯”å¦‚è‡ªå·±çš„ä¸€ä¸ªé‚»å±…è·ç¦»ç›®æ ‡è·¯ç”±å™¨çš„è·ç¦»æ˜¯ Mï¼Œè€Œè‡ªå·±è·ç¦»é‚»å±…æ˜¯ xï¼Œåˆ™è‡ªå·±è·ç¦»ç›®æ ‡è·¯ç”±å™¨æ˜¯ x+Mã€‚</p><p>å­˜åœ¨çš„é—®é¢˜1ï¼š <strong><em>å¥½æ¶ˆæ¯ä¼ å¾—å¿«ï¼Œåæ¶ˆæ¯ä¼ å¾—æ…¢</em></strong> å¦‚æœæœ‰ä¸ªè·¯ç”±å™¨åŠ å…¥äº†è¿™ä¸ªç½‘ç»œï¼Œå®ƒçš„é‚»å±…å°±èƒ½å¾ˆå¿«å‘ç°å®ƒï¼Œç„¶åå°†æ¶ˆæ¯å¹¿æ’­å‡ºå»ã€‚è¦ä¸äº†å¤šä¹…ï¼Œæ•´ä¸ªç½‘ç»œå°±éƒ½çŸ¥é“äº†ã€‚ä½†æ˜¯ä¸€æ—¦ä¸€ä¸ªè·¯ç”±å™¨æŒ‚äº†ï¼ŒæŒ‚çš„æ¶ˆæ¯æ˜¯æ²¡æœ‰å¹¿æ’­çš„ã€‚å½“æ¯ä¸ªè·¯ç”±å™¨å‘ç°åŸæ¥çš„é“è·¯åˆ°ä¸äº†è¿™ä¸ªè·¯ç”±å™¨çš„æ—¶å€™ï¼Œæ„Ÿè§‰ä¸åˆ°å®ƒå·²ç»æŒ‚äº†ï¼Œè€Œæ˜¯è¯•å›¾é€šè¿‡å…¶ä»–çš„è·¯å¾„è®¿é—®ï¼Œç›´åˆ°è¯•è¿‡äº†æ‰€æœ‰çš„è·¯å¾„ï¼Œæ‰å‘ç°è¿™ä¸ªè·¯ç”±å™¨æ˜¯çœŸçš„æŒ‚äº†ã€‚</p><p>åŸæ¥çš„ç½‘ç»œåŒ…æ‹¬ä¸¤ä¸ªèŠ‚ç‚¹ï¼ŒB å’Œ Cã€‚A åŠ å…¥äº†ç½‘ç»œï¼Œå®ƒçš„é‚»å±… B å¾ˆå¿«å°±å‘ç° A å¯åŠ¨èµ·æ¥äº†ã€‚äºæ˜¯å®ƒå°†è‡ªå·±å’Œ A çš„è·ç¦»è®¾ä¸º 1ï¼ŒåŒæ · C ä¹Ÿå‘ç° A èµ·æ¥äº†ï¼Œå°†è‡ªå·±å’Œ A çš„è·ç¦»è®¾ç½®ä¸º 2ã€‚ä½†æ˜¯å¦‚æœ A æŒ‚æ‰ï¼Œæƒ…å†µå°±ä¸å¦™äº†ã€‚B æœ¬æ¥å’Œ A æ˜¯é‚»å±…ï¼Œå‘ç°è¿ä¸ä¸Š A äº†ï¼Œä½†æ˜¯ C è¿˜æ˜¯èƒ½å¤Ÿè¿ä¸Šï¼Œåªä¸è¿‡è·ç¦»è¿œäº†ç‚¹ï¼Œæ˜¯ 2ï¼Œäºæ˜¯å°†è‡ªå·±çš„è·ç¦»è®¾ç½®ä¸º 3ã€‚æ®Šä¸çŸ¥ C çš„è·ç¦» 2 å…¶å®æ˜¯åŸºäºåŸæ¥è‡ªå·±çš„è·ç¦»ä¸º 1 è®¡ç®—å‡ºæ¥çš„ã€‚C å‘ç°è‡ªå·±ä¹Ÿè¿ä¸ä¸Š Aï¼Œå¹¶ä¸”å‘ç° B è®¾ç½®ä¸º 3ï¼Œäºæ˜¯è‡ªå·±æ”¹æˆè·ç¦» 4ã€‚ä¾æ¬¡ç±»æ¨ï¼Œæ•°è¶Šæ¥è¶Šå¤§ï¼Œç›´åˆ°è¶…è¿‡ä¸€ä¸ªé˜ˆå€¼ï¼Œæˆ‘ä»¬æ‰èƒ½åˆ¤å®š A çœŸçš„æŒ‚äº†ã€‚</p><p>å­˜åœ¨çš„é—®é¢˜2ï¼š <strong><em>æ¯æ¬¡å‘é€çš„æ—¶å€™ï¼Œè¦å‘é€æ•´ä¸ªå…¨å±€è·¯ç”±è¡¨</em></strong> </p><p>å½“ç½‘ç»œè§„æ¨¡æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œå…¨å±€è·¯ç”±è¡¨æ¯”è¾ƒå°ï¼ˆ15è·³ä»¥å†…ï¼‰ï¼›å¦‚æœç½‘ç»œè§„æ¨¡æ¯”è¾ƒå¤§ï¼Œå°±ä¸é€‚ç”¨äº†ã€‚</p><p>(ä¸ç›¸å…³çš„åˆ†å‰²çº¿ï¼š æ„Ÿè§‰å¾ˆåƒåŒºå—é“¾åœ¨åšçš„äº‹æƒ…ï¼Œè¡Œä¸ºä¸Šçš„ç±»ä¼¼ï¼Œç›®çš„ä¸Šçš„ä¸åŒ)</p><ol start="2"><li>é“¾è·¯çŠ¶æ€è·¯ç”±ç®—æ³•</li></ol><p>Link state routing </p><p>è¿™ç§ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯ï¼šå½“ä¸€ä¸ªè·¯ç”±å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œé¦–å…ˆæ˜¯å‘ç°é‚»å±…ï¼Œå‘é‚»å±… say helloï¼Œé‚»å±…éƒ½å›å¤ã€‚ç„¶åè®¡ç®—å’Œé‚»å±…çš„è·ç¦»ï¼Œå‘é€ä¸€ä¸ª echoï¼Œè¦æ±‚é©¬ä¸Šè¿”å›ï¼Œé™¤ä»¥äºŒå°±æ˜¯è·ç¦»ã€‚ç„¶åå°†è‡ªå·±å’Œé‚»å±…ä¹‹é—´çš„é“¾è·¯çŠ¶æ€åŒ…å¹¿æ’­å‡ºå»ï¼Œå‘é€åˆ°æ•´ä¸ªç½‘ç»œçš„æ¯ä¸ªè·¯ç”±å™¨ã€‚è¿™æ ·æ¯ä¸ªè·¯ç”±å™¨éƒ½èƒ½å¤Ÿæ”¶åˆ°å®ƒå’Œé‚»å±…ä¹‹é—´çš„å…³ç³»çš„ä¿¡æ¯ã€‚å› è€Œï¼Œæ¯ä¸ªè·¯ç”±å™¨éƒ½èƒ½åœ¨è‡ªå·±æœ¬åœ°æ„å»ºä¸€ä¸ªå®Œæ•´çš„å›¾ï¼Œç„¶åé’ˆå¯¹è¿™ä¸ªå›¾ä½¿ç”¨ Dijkstra ç®—æ³•ï¼Œæ‰¾åˆ°ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚</p><p>ä¸åƒè·ç¦»è·ç¦»çŸ¢é‡è·¯ç”±åè®®é‚£æ ·ï¼Œæ›´æ–°æ—¶å‘é€æ•´ä¸ªè·¯ç”±è¡¨ã€‚é“¾è·¯çŠ¶æ€è·¯ç”±åè®®åªå¹¿æ’­æ›´æ–°çš„æˆ–æ”¹å˜çš„ç½‘ç»œæ‹“æ‰‘ï¼Œè¿™ä½¿å¾—æ›´æ–°ä¿¡æ¯æ›´å°ï¼ŒèŠ‚çœäº†å¸¦å®½å’Œ CPU åˆ©ç”¨ç‡ã€‚è€Œä¸”ä¸€æ—¦ä¸€ä¸ªè·¯ç”±å™¨æŒ‚äº†ï¼Œå®ƒçš„é‚»å±…éƒ½ä¼šå¹¿æ’­è¿™ä¸ªæ¶ˆæ¯ï¼Œå¯ä»¥ä½¿å¾—åæ¶ˆæ¯è¿…é€Ÿæ”¶æ•›ã€‚</p><h3 id="3-2-4-åŠ¨æ€è·¯ç”±åè®®"><a href="#3-2-4-åŠ¨æ€è·¯ç”±åè®®" class="headerlink" title="3.2.4 åŠ¨æ€è·¯ç”±åè®®"></a>3.2.4 åŠ¨æ€è·¯ç”±åè®®</h3><ol><li>åŸºäºé“¾è·¯çŠ¶æ€è·¯ç”±ç®—æ³•çš„OSPF</li></ol><p>OSPF - Open Shortest Path First å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰å°±æ˜¯åŸºäºé“¾è·¯çŠ¶æ€è·¯ç”±åè®®ï¼Œå¹¿æ³›åº”ç”¨åœ¨æ•°æ®ä¸­å¿ƒä¸­çš„åè®®ã€‚ç”±äºä¸»è¦ç”¨åœ¨æ•°æ®ä¸­å¿ƒå†…éƒ¨ï¼Œç”¨äºè·¯ç”±å†³ç­–ï¼Œå› è€Œç§°ä¸ºå†…éƒ¨ç½‘å…³åè®®Interior Gateway Protocol </p><p>å†…éƒ¨ç½‘å…³åè®®çš„é‡ç‚¹å°±æ˜¯æ‰¾åˆ°æœ€çŸ­çš„è·¯å¾„ã€‚åœ¨ä¸€ä¸ªç»„ç»‡å†…éƒ¨ï¼Œè·¯å¾„æœ€çŸ­å¾€å¾€æœ€ä¼˜ã€‚å½“ç„¶æœ‰æ—¶å€™ OSPF å¯ä»¥å‘ç°å¤šä¸ªæœ€çŸ­çš„è·¯å¾„ï¼Œå¯ä»¥åœ¨è¿™å¤šä¸ªè·¯å¾„ä¸­è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œè¿™å¸¸å¸¸è¢«ç§°ä¸ºç­‰ä»·è·¯ç”±ã€‚</p><p><img src="https://i.loli.net/2020/02/02/tbrWjqNz2swxkVY.jpg" alt="fig14.jpg"></p><ol start="2"><li>åŸºäºè·ç¦»çŸ¢é‡è·¯ç”±ç®—æ³•çš„BGP(Border Gateway Protocol)</li></ol><p>å¤–éƒ¨æ”¿ç­–çš„é—®é¢˜ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½ä¼šè®¾å€¼è‡ªå·±çš„Policyï¼š</p><ul><li>å“ªäº›å¤–éƒ¨IPå¯ä»¥è®©å†…éƒ¨çŸ¥é“</li><li>å“ªäº›å†…éƒ¨IPå¯ä»¥è®©å¤–éƒ¨çŸ¥é“</li></ul><p>æ¯ä¸ªéƒ½ä¸ºä¸€ä¸ªè‡ªæ²»ç³»ç»ŸAS, Autonomous System,è‡ªæ²»ç³»ç»Ÿåˆ†ä¸ºå‡ ç§ç±»å‹ï¼š</p><ul><li>Stub ASï¼šå¯¹å¤–åªæœ‰ä¸€ä¸ªè¿æ¥ã€‚è¿™ç±» AS ä¸ä¼šä¼ è¾“å…¶ä»– AS çš„åŒ…ã€‚ä¾‹å¦‚ï¼Œä¸ªäººæˆ–è€…å°å…¬å¸çš„ç½‘ç»œã€‚</li><li>Multihomed ASï¼šå¯èƒ½æœ‰å¤šä¸ªè¿æ¥è¿åˆ°å…¶ä»–çš„ ASï¼Œä½†æ˜¯å¤§å¤šæ‹’ç»å¸®å…¶ä»–çš„ AS ä¼ è¾“åŒ…ã€‚ä¾‹å¦‚ä¸€äº›å¤§å…¬å¸çš„ç½‘ç»œã€‚</li><li>Transit ASï¼šæœ‰å¤šä¸ªè¿æ¥è¿åˆ°å…¶ä»–çš„ ASï¼Œå¹¶ä¸”å¯ä»¥å¸®åŠ©å…¶ä»–çš„ AS ä¼ è¾“åŒ…ã€‚ä¾‹å¦‚ä¸»å¹²ç½‘ã€‚</li></ul><p>æ¯ä¸ªè‡ªæ²»ç³»ç»Ÿéƒ½æœ‰<strong>* è¾¹ç•Œè·¯ç”±å™¨*</strong>ï¼Œæ¥å’Œå¤–ç•Œè¿›è¡Œè”ç³»ã€‚</p><p><img src="https://i.loli.net/2020/02/02/2CgFAUMGohak7OJ.jpg" alt="fig15.jpg"></p><p>BGPåè®®ä½¿ç”¨çš„æ˜¯è·¯å¾„çŸ¢é‡è·¯ç”±åè®®ï¼Œï¼ˆpath-vector protocolï¼‰ã€‚å®ƒæ˜¯è·ç¦»çŸ¢é‡è·¯ç”±åè®®çš„å‡çº§ç‰ˆã€‚</p><p>å‰é¢è¯´äº†è·ç¦»çŸ¢é‡è·¯ç”±åè®®çš„ç¼ºç‚¹ã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯æ”¶æ•›æ…¢ã€‚åœ¨ BGP é‡Œé¢ï¼Œé™¤äº†ä¸‹ä¸€è·³ hop ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬äº†è‡ªæ²»ç³»ç»Ÿ AS çš„è·¯å¾„ï¼Œä»è€Œå¯ä»¥é¿å…åæ¶ˆæ¯ä¼ çš„æ…¢çš„é—®é¢˜ï¼Œä¹Ÿå³ä¸Šé¢æ‰€æè¿°çš„ï¼ŒB çŸ¥é“ C åŸæ¥èƒ½å¤Ÿåˆ°è¾¾ Aï¼Œæ˜¯å› ä¸ºé€šè¿‡è‡ªå·±ï¼Œä¸€æ—¦è‡ªå·±éƒ½åˆ°è¾¾ä¸äº† A äº†ï¼Œå°±ä¸ç”¨å‡è®¾ C è¿˜èƒ½åˆ°è¾¾ A äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> IP Protocol </tag>
            
            <tag> CIDR </tag>
            
            <tag> DHCP </tag>
            
            <tag> ICMP </tag>
            
            <tag> Router </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(ä¸‰)-é“¾è·¯å±‚</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%89-%E9%93%BE%E8%B7%AF%E5%B1%82/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%89-%E9%93%BE%E8%B7%AF%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<p>MACå±‚æ˜¯ç”¨æ¥è§£å†³å¤šè·¯è®¿é—®çš„å µè½¦é—®é¢˜çš„ï¼ŒARPé€šè¿‡åœ¨å±€åŸŸç½‘å¤§å¼ä¸€å£°çš„æ–¹å¼æ¥å¯»æ‰¾ç›®æ ‡MACåœ°å€ã€‚äº¤æ¢æœºæœ‰MACåœ°å€å­¦ä¹ èƒ½åŠ›ã€‚ </p><h1 id="1-MACå±‚"><a href="#1-MACå±‚" class="headerlink" title="1. MACå±‚"></a>1. MACå±‚</h1><p>åœ¨ç‰©ç†å±‚ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†Hubï¼Œé›†çº¿å™¨ï¼Œè¿™ç§è®¾å¤‡å¯ä»¥å°†å¤šä¸ªç»ˆç«¯è¿èµ·æ¥ï¼Œä½†æ˜¯å®ƒä¼šæŠŠæ‰€æœ‰è‡ªå·±æ”¶åˆ°çš„ä¿¡æ¯éƒ½å¤åˆ¶åˆ°å…¶ä»–ç«¯å£å½“ä¸­ã€‚</p><p>éœ€è¦åœ¨æ•°æ®é“¾è·¯å±‚è§£å†³çš„é—®é¢˜æœ‰ï¼š</p><ol><li>åŒ…çš„å‘é€æ–¹å’Œæ¥æ”¶æ–¹</li><li>å¤šä¸ªåŒ…å‘é€çš„æ—¶å€™çš„å…ˆåé¡ºåºçš„é—®é¢˜</li><li>å‘ç”Ÿé”™è¯¯äº†æ€ä¹ˆåŠ</li></ol><p>è¿™äº›é—®é¢˜éƒ½æ˜¯åœ¨æ•°æ®é“¾è·¯å±‚ï¼Œä¹Ÿå³MACå±‚(Medium Access Control)ï¼Œè¦è§£å†³çš„é—®é¢˜.</p><p>åšåª’ä½“è®¿é—®æ§åˆ¶ï¼Œæ§åˆ¶åœ¨å¾€åª’ä½“ä¸Šå‘æ•°æ®çš„æ—¶å€™ï¼Œè°å…ˆå‘è°åå‘çš„é—®é¢˜ï¼Œé˜²æ­¢å‘ç”Ÿæ··ä¹±ã€‚â€”â€” å¤šè·¯è®¿é—®è§„åˆ™</p><p>ä¸‹é¢é’ˆå¯¹ä¸‰ä¸ªé—®é¢˜çš„è§£å†³è¿›è¡Œè¯¦ç»†åˆ†æ</p><h2 id="1-1-åŒ…çš„å‘é€æ–¹æ¥æ”¶æ–¹çš„ç¡®è®¤"><a href="#1-1-åŒ…çš„å‘é€æ–¹æ¥æ”¶æ–¹çš„ç¡®è®¤" class="headerlink" title="1.1 åŒ…çš„å‘é€æ–¹æ¥æ”¶æ–¹çš„ç¡®è®¤"></a>1.1 åŒ…çš„å‘é€æ–¹æ¥æ”¶æ–¹çš„ç¡®è®¤</h2><h3 id="1-1-1-çŸ¥é“ç›®æ ‡å’ŒæºMACåœ°å€æ—¶"><a href="#1-1-1-çŸ¥é“ç›®æ ‡å’ŒæºMACåœ°å€æ—¶" class="headerlink" title="1.1.1 çŸ¥é“ç›®æ ‡å’ŒæºMACåœ°å€æ—¶"></a>1.1.1 çŸ¥é“ç›®æ ‡å’ŒæºMACåœ°å€æ—¶</h3><p>ç”¨ç‰©ç†åœ°å€ï¼Œâ€”â€”é“¾è·¯å±‚åœ°å€ï¼Œå¸¸è¢«ç§°ä¸ºMACåœ°å€</p><p><img src="https://i.loli.net/2020/02/02/apAPTkyrFx6vczW.jpg" alt="fig1.jpg"></p><h3 id="1-1-2-åªçŸ¥é“ç›®æ ‡IPåœ°å€æ—¶-â€”â€”-ARPåè®®"><a href="#1-1-2-åªçŸ¥é“ç›®æ ‡IPåœ°å€æ—¶-â€”â€”-ARPåè®®" class="headerlink" title="1.1.2 åªçŸ¥é“ç›®æ ‡IPåœ°å€æ—¶ â€”â€” ARPåè®®"></a>1.1.2 åªçŸ¥é“ç›®æ ‡IPåœ°å€æ—¶ â€”â€” ARPåè®®</h3><p>ARPåè®®ï¼Œæ˜¯å·²çŸ¥IPåœ°å€ï¼Œæ±‚MACåœ°å€çš„åè®®ã€‚</p><p>åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼ŒçŸ¥é“IPï¼Œæƒ³è·å¾—å¯¹åº”çš„MACï¼Œå°±æ˜¯åœ¨å±€åŸŸç½‘ä¸­å¤§å¼ä¸€å£°ï¼Œ çœ‹å›åº”ï¼Œhhhh</p><p><img src="https://i.loli.net/2020/02/02/pS2vUbZIw638hGg.jpg" alt="fig2.jpg"></p><p>å…·ä½“è¯¢é—®å’Œå›ç­”çš„æŠ¥æ–‡å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/02/TvSIZwFQf1tRWsy.jpg" alt="fig3.jpg"></p><h2 id="1-2-å¤šè·¯è®¿é—®åŸåˆ™"><a href="#1-2-å¤šè·¯è®¿é—®åŸåˆ™" class="headerlink" title="1.2 å¤šè·¯è®¿é—®åŸåˆ™"></a>1.2 å¤šè·¯è®¿é—®åŸåˆ™</h2><ol><li>ä¿¡é“åˆ’åˆ†ï¼šåˆ†æˆå¤šä¸ªè½¦é“ï¼Œå„èµ°å„çš„</li><li>è½®æµåè®®ï¼šå•åŒå·é™è¡Œ</li><li>éšæœºæ¥å…¥åè®®ï¼šé”™å³°</li></ol><h2 id="1-3-é”™è¯¯å¤„ç†-â€”â€”-å¾ªç¯å†—ä½™æ£€æµ‹"><a href="#1-3-é”™è¯¯å¤„ç†-â€”â€”-å¾ªç¯å†—ä½™æ£€æµ‹" class="headerlink" title="1.3 é”™è¯¯å¤„ç† â€”â€” å¾ªç¯å†—ä½™æ£€æµ‹"></a>1.3 é”™è¯¯å¤„ç† â€”â€” å¾ªç¯å†—ä½™æ£€æµ‹</h2><p>çœ‹å›¾1ï¼Œæ•´ä¸ªæ•°æ®åŒ…çš„æœ€åå››å­—èŠ‚å«åšCRCï¼Œè¿™é‡Œæ˜¯é€šè¿‡XORç®—æ³•è®¡ç®—æ•´ä¸ªåŒ…æ˜¯å¦åœ¨å‘é€çš„è¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯</p><h1 id="2-äº¤æ¢æœº"><a href="#2-äº¤æ¢æœº" class="headerlink" title="2.äº¤æ¢æœº"></a>2.äº¤æ¢æœº</h1><p>äº¤æ¢æœºæ¯”èµ·é›†çº¿å™¨ï¼Œæœ‰äº†è®°å¿†åŠŸèƒ½ã€‚é€šè¿‡å­¦ä¹ å¾—åˆ°å¯¹åº”çš„MACåœ°å€ã€‚</p><p>ä¸€å° MAC1 ç”µè„‘å°†ä¸€ä¸ªåŒ…å‘é€ç»™å¦ä¸€å° MAC2 ç”µè„‘ï¼Œå½“è¿™ä¸ªåŒ…åˆ°è¾¾äº¤æ¢æœºçš„æ—¶å€™ï¼Œä¸€å¼€å§‹äº¤æ¢æœºä¹Ÿä¸çŸ¥é“ MAC2 çš„ç”µè„‘åœ¨å“ªä¸ªå£ï¼Œæ‰€ä»¥æ²¡åŠæ³•ï¼Œå®ƒåªèƒ½å°†åŒ…è½¬å‘ç»™é™¤äº†æ¥çš„é‚£ä¸ªå£ä¹‹å¤–çš„å…¶ä»–æ‰€æœ‰çš„å£ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œäº¤æ¢æœºä¼šå¹²ä¸€ä»¶éå¸¸èªæ˜çš„äº‹æƒ…ï¼Œå°±æ˜¯äº¤æ¢æœºä¼šè®°ä½ï¼ŒMAC1 æ˜¯æ¥è‡ªä¸€ä¸ªæ˜ç¡®çš„å£ã€‚ä»¥åæœ‰åŒ…çš„ç›®çš„åœ°å€æ˜¯ MAC1 çš„ï¼Œç›´æ¥å‘é€åˆ°è¿™ä¸ªå£å°±å¯ä»¥äº†ã€‚</p><p>å½“äº¤æ¢æœºä½œä¸ºä¸€ä¸ªå…³å¡ä¸€æ ·ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå°±æœ‰äº†æ•´ä¸ªç½‘ç»œçš„ä¸€ä¸ªç»“æ„äº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒåŸºæœ¬ä¸Šä¸ç”¨å¹¿æ’­äº†ï¼Œå…¨éƒ¨å¯ä»¥å‡†ç¡®è½¬å‘ã€‚å½“ç„¶ï¼Œæ¯ä¸ªæœºå™¨çš„ IP åœ°å€ä¼šå˜ï¼Œæ‰€åœ¨çš„å£ä¹Ÿä¼šå˜ï¼Œå› è€Œäº¤æ¢æœºä¸Šçš„å­¦ä¹ çš„ç»“æœï¼Œæˆ‘ä»¬ç§°ä¸ºè½¬å‘è¡¨ã€‚è½¬å‘è¡¨æ˜¯æœ‰è¿‡æœŸæ—¶é—´çš„ã€‚</p><h2 id="2-1-åŠå…¬å®¤åœºæ™¯ä¸‹çš„äº¤æ¢æœºä½¿ç”¨"><a href="#2-1-åŠå…¬å®¤åœºæ™¯ä¸‹çš„äº¤æ¢æœºä½¿ç”¨" class="headerlink" title="2.1 åŠå…¬å®¤åœºæ™¯ä¸‹çš„äº¤æ¢æœºä½¿ç”¨"></a>2.1 åŠå…¬å®¤åœºæ™¯ä¸‹çš„äº¤æ¢æœºä½¿ç”¨</h2><p>å¯èƒ½æœ‰ä¸Šç™¾ä¸ªç½‘å£éœ€è¦è”ç½‘ï¼Œå› æ­¤éœ€è¦å¤šä¸ªäº¤æ¢æœºï¼Œå½¢æˆäº†ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€äº›çš„æ‹“æ‰‘ç»“æ„ã€‚</p><p><img src="https://i.loli.net/2020/02/02/A7OaPtoZLYSs8wi.jpg" alt="fig4.jpg"></p><p>å…ˆçœ‹çœ‹ä¸¤å°äº¤æ¢æœºçš„æƒ…å½¢ã€‚ä¸¤å°äº¤æ¢æœºè¿æ¥ç€ä¸‰ä¸ªå±€åŸŸç½‘ï¼Œæ¯ä¸ªå±€åŸŸç½‘ä¸Šéƒ½æœ‰å¤šå°æœºå™¨ã€‚å¦‚æœæœºå™¨ 1 åªçŸ¥é“æœºå™¨ 4 çš„ IP åœ°å€ï¼Œå½“å®ƒæƒ³è¦è®¿é—®æœºå™¨ 4ï¼ŒæŠŠåŒ…å‘å‡ºå»çš„æ—¶å€™ï¼Œå®ƒå¿…é¡»è¦çŸ¥é“æœºå™¨ 4 çš„ MAC åœ°å€ã€‚</p><p>äºæ˜¯æœºå™¨ 1 å‘èµ·å¹¿æ’­ï¼Œæœºå™¨ 2 æ”¶åˆ°è¿™ä¸ªå¹¿æ’­ï¼Œä½†æ˜¯è¿™ä¸æ˜¯æ‰¾å®ƒçš„ï¼Œæ‰€ä»¥æ²¡å®ƒä»€ä¹ˆäº‹ã€‚äº¤æ¢æœº A ä¸€å¼€å§‹æ˜¯ä¸çŸ¥é“ä»»ä½•æ‹“æ‰‘ä¿¡æ¯çš„ï¼Œåœ¨å®ƒæ”¶åˆ°è¿™ä¸ªå¹¿æ’­åï¼Œé‡‡å–çš„ç­–ç•¥æ˜¯ï¼Œ<strong>é™¤äº†å¹¿æ’­åŒ…æ¥çš„æ–¹å‘å¤–ï¼Œå®ƒè¿˜è¦è½¬å‘ç»™å…¶ä»–æ‰€æœ‰çš„ç½‘å£</strong>ã€‚äºæ˜¯æœºå™¨ 3 ä¹Ÿæ”¶åˆ°å¹¿æ’­ä¿¡æ¯äº†ï¼Œä½†æ˜¯è¿™å’Œå®ƒä¹Ÿæ²¡ä»€ä¹ˆå…³ç³»ã€‚</p><p>å½“ç„¶ï¼Œäº¤æ¢æœº B ä¹Ÿæ˜¯èƒ½å¤Ÿæ”¶åˆ°å¹¿æ’­ä¿¡æ¯çš„ï¼Œä½†æ˜¯è¿™æ—¶å€™å®ƒä¹Ÿæ˜¯ä¸çŸ¥é“ä»»ä½•æ‹“æ‰‘ä¿¡æ¯çš„ï¼Œå› è€Œä¹Ÿæ˜¯è¿›è¡Œå¹¿æ’­çš„ç­–ç•¥ï¼Œå°†åŒ…è½¬å‘åˆ°å±€åŸŸç½‘ä¸‰ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæœºå™¨ 4 å’Œæœºå™¨ 5 éƒ½æ”¶åˆ°äº†å¹¿æ’­ä¿¡æ¯ã€‚æœºå™¨ 4 ä¸»åŠ¨å“åº”è¯´ï¼Œè¿™æ˜¯æ‰¾æˆ‘çš„ï¼Œè¿™æ˜¯æˆ‘çš„ MAC åœ°å€ã€‚äºæ˜¯ä¸€ä¸ª ARP è¯·æ±‚å°±æˆåŠŸå®Œæˆäº†ã€‚</p><p>åœ¨ä¸Šé¢çš„è¿‡ç¨‹ä¸­ï¼Œäº¤æ¢æœº A å’Œäº¤æ¢æœº B éƒ½æ˜¯èƒ½å¤Ÿå­¦ä¹ åˆ°è¿™æ ·çš„ä¿¡æ¯ï¼šæœºå™¨ 1 æ˜¯åœ¨å·¦è¾¹è¿™ä¸ªç½‘å£çš„ã€‚å½“äº†è§£åˆ°è¿™äº›æ‹“æ‰‘ä¿¡æ¯ä¹‹åï¼Œæƒ…å†µå°±å¥½è½¬èµ·æ¥ã€‚å½“æœºå™¨ 2 è¦è®¿é—®æœºå™¨ 1 çš„æ—¶å€™ï¼Œæœºå™¨ 2 å¹¶ä¸çŸ¥é“æœºå™¨ 1 çš„ MAC åœ°å€ï¼Œæ‰€ä»¥æœºå™¨ 2 ä¼šå‘èµ·ä¸€ä¸ª ARP è¯·æ±‚ã€‚è¿™ä¸ªå¹¿æ’­æ¶ˆæ¯ä¼šåˆ°è¾¾æœºå™¨ 1ï¼Œä¹ŸåŒæ—¶ä¼šåˆ°è¾¾äº¤æ¢æœº Aã€‚è¿™ä¸ªæ—¶å€™äº¤æ¢æœº A å·²ç»çŸ¥é“æœºå™¨ 1 æ˜¯ä¸å¯èƒ½åœ¨å³è¾¹çš„ç½‘å£çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå¹¿æ’­ä¿¡æ¯å°±ä¸ä¼šå¹¿æ’­åˆ°å±€åŸŸç½‘äºŒå’Œå±€åŸŸç½‘ä¸‰ã€‚</p><p>å½“æœºå™¨ 3 è¦è®¿é—®æœºå™¨ 1 çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦å‘èµ·ä¸€ä¸ªå¹¿æ’­çš„ ARP è¯·æ±‚ã€‚è¿™ä¸ªæ—¶å€™äº¤æ¢æœº A å’Œäº¤æ¢æœº B éƒ½èƒ½å¤Ÿæ”¶åˆ°è¿™ä¸ªå¹¿æ’­è¯·æ±‚ã€‚äº¤æ¢æœº A å½“ç„¶çŸ¥é“ä¸»æœº A æ˜¯åœ¨å·¦è¾¹è¿™ä¸ªç½‘å£çš„ï¼Œæ‰€ä»¥ä¼šæŠŠå¹¿æ’­æ¶ˆæ¯è½¬å‘åˆ°å±€åŸŸç½‘ä¸€ã€‚åŒæ—¶ï¼Œäº¤æ¢æœº B æ”¶åˆ°è¿™ä¸ªå¹¿æ’­æ¶ˆæ¯ä¹‹åï¼Œç”±äºå®ƒçŸ¥é“æœºå™¨ 1 æ˜¯ä¸åœ¨å³è¾¹è¿™ä¸ªç½‘å£çš„ï¼Œæ‰€ä»¥ä¸ä¼šå°†æ¶ˆæ¯å¹¿æ’­åˆ°å±€åŸŸç½‘ä¸‰ã€‚</p><h3 id="2-1-1-ç¯è·¯é—®é¢˜"><a href="#2-1-1-ç¯è·¯é—®é¢˜" class="headerlink" title="2.1.1 ç¯è·¯é—®é¢˜"></a>2.1.1 ç¯è·¯é—®é¢˜</h3><p>å½“æ•´ä¸ªæ‹“æ‰‘ç»“æ„å˜å¤æ‚äº†ä»¥åï¼Œå¯èƒ½å®¹æ˜“å‡ºç°ç¯è·¯é—®é¢˜ï¼š</p><p><img src="https://i.loli.net/2020/02/02/OeXKUsIzw7J41Qa.jpg" alt="fig5.jpg"></p><p>æˆ‘ä»¬æ¥æƒ³è±¡ä¸€ä¸‹æœºå™¨ 1 è®¿é—®æœºå™¨ 2 çš„è¿‡ç¨‹ã€‚ä¸€å¼€å§‹ï¼Œæœºå™¨ 1 å¹¶ä¸çŸ¥é“æœºå™¨ 2 çš„ MAC åœ°å€ï¼Œæ‰€ä»¥å®ƒéœ€è¦å‘èµ·ä¸€ä¸ª ARP çš„å¹¿æ’­ã€‚å¹¿æ’­åˆ°è¾¾æœºå™¨ 2ï¼Œæœºå™¨ 2 ä¼šæŠŠ MAC åœ°å€è¿”å›æ¥ï¼Œçœ‹èµ·æ¥æ²¡æœ‰è¿™ä¸¤ä¸ªäº¤æ¢æœºä»€ä¹ˆäº‹æƒ…ã€‚</p><p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œè¿™ä¸¤ä¸ªäº¤æ¢æœºè¿˜æ˜¯éƒ½èƒ½å¤Ÿæ”¶åˆ°å¹¿æ’­åŒ…çš„ã€‚äº¤æ¢æœº A ä¸€å¼€å§‹æ˜¯ä¸çŸ¥é“æœºå™¨ 2 åœ¨å“ªä¸ªå±€åŸŸç½‘çš„ï¼Œæ‰€ä»¥å®ƒä¼šæŠŠå¹¿æ’­æ¶ˆæ¯æ”¾åˆ°å±€åŸŸç½‘äºŒï¼Œåœ¨å±€åŸŸç½‘äºŒå¹¿æ’­çš„æ—¶å€™ï¼Œäº¤æ¢æœº B å³è¾¹è¿™ä¸ªç½‘å£ä¹Ÿæ˜¯èƒ½å¤Ÿæ”¶åˆ°å¹¿æ’­æ¶ˆæ¯çš„ã€‚äº¤æ¢æœº B ä¼šå°†è¿™ä¸ªå¹¿æ’­æ¯ä¿¡æ¯å‘é€åˆ°å±€åŸŸç½‘ä¸€ã€‚å±€åŸŸç½‘ä¸€çš„è¿™ä¸ªå¹¿æ’­æ¶ˆæ¯ï¼Œåˆä¼šåˆ°è¾¾äº¤æ¢æœº A å·¦è¾¹çš„è¿™ä¸ªæ¥å£ã€‚äº¤æ¢æœº A è¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä¸çŸ¥é“æœºå™¨ 2 åœ¨å“ªä¸ªå±€åŸŸç½‘ï¼Œäºæ˜¯å°†å¹¿æ’­åŒ…åˆè½¬å‘åˆ°å±€åŸŸç½‘äºŒã€‚å·¦è½¬å·¦è½¬å·¦è½¬ï¼Œå¥½åƒæ˜¯ä¸ªåœˆå“¦ã€‚ </p><p>å¯èƒ½æœ‰äººä¼šè¯´ï¼Œå½“ä¸¤å°äº¤æ¢æœºéƒ½èƒ½å¤Ÿé€æ¸å­¦ä¹ åˆ°æ‹“æ‰‘ç»“æ„ä¹‹åï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Ÿ</p><p>ç„¶è€Œå½“å¹¿æ’­åŒ…ä»å·¦è¾¹çš„å±€åŸŸç½‘ä¸€å¹¿æ’­çš„æ—¶å€™ï¼Œä¸¤ä¸ªäº¤æ¢æœºå†æ¬¡åˆ·æ–°ä¸‰è§‚ï¼ŒåŸæ¥æœºå™¨ 1 æ˜¯åœ¨å·¦è¾¹çš„ï¼Œè¿‡ä¸€ä¼šå„¿ï¼Œåˆå‘ç°ä¸å¯¹ï¼Œæ˜¯åœ¨å³è¾¹çš„ï¼Œè¿‡ä¸€ä¼šï¼Œåˆå‘ç°ä¸å¯¹ï¼Œæ˜¯åœ¨å·¦è¾¹çš„ã€‚</p><p>åœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œç”¨æœ€å°ç”Ÿæˆæ ‘ç®—æ³•æ¥è§£å†³äº¤æ¢æœºç”Ÿæˆç¯çš„é—®é¢˜ã€‚ç®€è€Œè¨€ä¹‹ï¼Œé€šè¿‡æ¯”è¾ƒäº¤æ¢æœºä¹‹é—´çš„èƒ½åŠ›ï¼Œç»™ä»–ä»¬åˆ†ä¸åŒç­‰çº§ï¼Œåˆ’åˆ†å‡ºä¸€æ£µæ ‘ã€‚</p><h3 id="2-1-2-å¦‚ä½•è§£å†³å¹¿æ’­é—®é¢˜å’Œå®‰å…¨é—®é¢˜ï¼Ÿ"><a href="#2-1-2-å¦‚ä½•è§£å†³å¹¿æ’­é—®é¢˜å’Œå®‰å…¨é—®é¢˜ï¼Ÿ" class="headerlink" title="2.1.2 å¦‚ä½•è§£å†³å¹¿æ’­é—®é¢˜å’Œå®‰å…¨é—®é¢˜ï¼Ÿ"></a>2.1.2 å¦‚ä½•è§£å†³å¹¿æ’­é—®é¢˜å’Œå®‰å…¨é—®é¢˜ï¼Ÿ</h3><ol><li>ç‰©ç†éš”ç¦»</li></ol><p>æ¯ä¸ªéƒ¨é—¨æœ‰è‡ªå·±çš„äº¤æ¢æœºï¼Œé…ç½®å•ç‹¬çš„å­ç½‘</p><ol start="2"><li>è™šæ‹Ÿéš”ç¦»</li></ol><p>VLANï¼Œè™šæ‹Ÿå±€åŸŸç½‘ï¼Œä¸€ä¸ªäº¤æ¢æœºä¸Šä¼šè¿å±äºå¤šä¸ªå±€åŸŸç½‘çš„æœºå™¨ã€‚è§£å†³æ–¹æ¡ˆæ˜¯åœ¨åŸæ¥çš„äºŒå±‚çš„å¤´ä¸ŠåŠ ä¸€ä¸ªTAGï¼Œé‡Œé¢æœ‰ä¸€ä¸ªVLAN IDï¼Œä¸€å…±12ä½ï¼Œå¯ä»¥åˆ’åˆ†å‡º4096ä¸ªVLAN</p><p><img src="https://i.loli.net/2020/02/02/WtnOa3ToZG9FkpL.jpg" alt="fig6.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(äºŒ)-ç‰©ç†å±‚</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%8C-%E7%89%A9%E7%90%86%E5%B1%82/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%8C-%E7%89%A9%E7%90%86%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ç‰©ç†å±‚å®ç°å¤šä¸ªç»ˆç«¯çš„äº¤æµ"><a href="#1-ç‰©ç†å±‚å®ç°å¤šä¸ªç»ˆç«¯çš„äº¤æµ" class="headerlink" title="1. ç‰©ç†å±‚å®ç°å¤šä¸ªç»ˆç«¯çš„äº¤æµ"></a>1. ç‰©ç†å±‚å®ç°å¤šä¸ªç»ˆç«¯çš„äº¤æµ</h1><p>ç½‘çº¿çš„1-3, 2-6äº¤å‰æ¥æ³•ï¼Œ12ï¼Œ36è„šåˆ†åˆ«èµ·åˆ°æ”¶å‘ä¿¡å·çš„ä½œç”¨ã€‚IPå±‚å°è£…äº†MACå±‚ï¼Œç„¶åç»„æˆäº†å‡ ä¸ªå±€åŸŸç½‘ï¼ŒLAN</p><p>HUBåœ¨ç‰©ç†å±‚å·¥ä½œï¼Œä¼šå°†è‡ªå·±æ”¶åˆ°çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œéƒ½å¤åˆ¶åˆ°å…¶ä»–ç«¯å£ä¸Šå»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®(ä¸€) -- æ¡†æ¶</title>
      <link href="/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%80-%E6%A1%86%E6%9E%B6/"/>
      <url>/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%80-%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åè®®"><a href="#1-åè®®" class="headerlink" title="1. åè®®"></a>1. åè®®</h1><p>åè®®æ˜¯ç”±è¯­æ³•ï¼Œè¯­ä¹‰ï¼Œé¡ºåºä¸‰éƒ¨åˆ†æ„æˆã€‚å†…å®¹è¦ç¬¦åˆä¸€å®šçš„è§„åˆ™å’Œæ ¼å¼ã€‚å†…å®¹è¦ä»£è¡¨æŸç§æ„ä¹‰ï¼Œè¦æœ‰å…ˆåšå†åšçš„å…ˆåé¡ºåºã€‚</p><h1 id="2-æ¡†æ¶"><a href="#2-æ¡†æ¶" class="headerlink" title="2.æ¡†æ¶"></a>2.æ¡†æ¶</h1><h2 id="2-1-åº”ç”¨å±‚"><a href="#2-1-åº”ç”¨å±‚" class="headerlink" title="2.1 åº”ç”¨å±‚"></a>2.1 åº”ç”¨å±‚</h2><p>DHCP HTTP HTTPS RTMP P2P DNS GTP RPC </p><h2 id="2-2-ä¼ è¾“å±‚"><a href="#2-2-ä¼ è¾“å±‚" class="headerlink" title="2.2 ä¼ è¾“å±‚"></a>2.2 ä¼ è¾“å±‚</h2><p>UDP TCP</p><h2 id="2-3-ç½‘ç»œå±‚"><a href="#2-3-ç½‘ç»œå±‚" class="headerlink" title="2.3 ç½‘ç»œå±‚"></a>2.3 ç½‘ç»œå±‚</h2><p>ICMP IP OSPF BGP IPSec GRE</p><h2 id="2-4-é“¾è·¯å±‚"><a href="#2-4-é“¾è·¯å±‚" class="headerlink" title="2.4 é“¾è·¯å±‚"></a>2.4 é“¾è·¯å±‚</h2><p>ARP VLAN STP</p><h2 id="2-5-ç‰©ç†å±‚"><a href="#2-5-ç‰©ç†å±‚" class="headerlink" title="2.5 ç‰©ç†å±‚"></a>2.5 ç‰©ç†å±‚</h2><p>ç½‘ç»œè·³çº¿</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - è¿æ¥å™¨</title>
      <link href="/Tomcat-%E8%BF%9E%E6%8E%A5%E5%99%A8/"/>
      <url>/Tomcat-%E8%BF%9E%E6%8E%A5%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>Unixç³»ç»Ÿä¸‹çš„I/Oæ¨¡å‹å…±æœ‰5ç§: </p><ul><li>åŒæ­¥é˜»å¡I/O </li><li>åŒæ­¥éé˜»å¡I/O</li><li>I/Oå¤šè·¯å¤ç”¨</li><li>ä¿¡å·é©±åŠ¨I/O</li><li>å¼‚æ­¥I/O</li></ul><p>å…³äºè¿æ¥å™¨ï¼Œæˆ‘ä»¬å°†ä¸»è¦ä»Tomcatå¦‚ä½•å®ç°å‡ ç§I/Oæ‰‹æ®µæ¥å…¥æ‰‹è¿›è¡Œè¯¦è§£ã€‚</p><h1 id="1-Java-I-O-æ¨¡å‹"><a href="#1-Java-I-O-æ¨¡å‹" class="headerlink" title="1. Java I/O æ¨¡å‹"></a>1. Java I/O æ¨¡å‹</h1><p>I/Oæ˜¯æŒ‡è®¡ç®—æœºå†…å­˜ä¸å¤–éƒ¨è®¾å¤‡ä¹‹é—´æ‹·è´æ•°æ®çš„è¿‡ç¨‹ã€‚CPUæ˜¯å…ˆæŠŠå¤–éƒ¨è®¾å¤‡çš„æ•°æ®è¯»åˆ°å†…å­˜é‡Œï¼Œç„¶åå†è¿›è¡Œå¤„ç†çš„ã€‚</p><p>Java I/Oæ¨¡å‹ä¹‹é—´çš„ä¸åŒä¹‹å¤„åœ¨äºåœ¨æ•°æ®ä»å¤–éƒ¨è®¾å¤‡æ‹·è´åˆ°å†…å­˜çš„è¿‡ç¨‹å½“ä¸­ï¼ŒCPUé—²ç½®ï¼Œæ˜¯ç»§ç»­ç»™å½“å‰è¿›ç¨‹ä½¿ç”¨ï¼Œè¿˜æ˜¯æŠŠCPUç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨å‘¢ã€‚</p><p>åœ¨Java I/Oæ¨¡å‹å½“ä¸­ï¼Œç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªå¯¹è±¡ï¼š</p><ul><li>è°ƒç”¨è¯¥I/Oæ“ä½œçš„ç”¨æˆ·çº¿ç¨‹<ul><li>ç”¨æˆ·çº¿ç¨‹ç­‰å¾…å†…æ ¸å°†æ•°æ®ä»ç½‘å¡æ‹·è´åˆ°å†…æ ¸ç©ºé—´</li><li>å†…æ ¸å°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</li></ul></li><li>æ“ä½œç³»ç»Ÿå†…æ ¸</li></ul><p>å„ä¸ªI/Oæ¨¡å‹å®ç°è¿™ä¸¤ä¸ªæ­¥éª¤çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h2 id="1-1-åŒæ­¥é˜»å¡I-O"><a href="#1-1-åŒæ­¥é˜»å¡I-O" class="headerlink" title="1.1 åŒæ­¥é˜»å¡I/O"></a>1.1 åŒæ­¥é˜»å¡I/O</h2><p>ç”¨æˆ·çº¿ç¨‹å‘èµ·readè°ƒç”¨å¼å°±é˜»å¡äº†ï¼Œè®©å‡ºCPUã€‚å†…æ ¸ç­‰å¾…ç½‘å¡æ•°æ®åˆ°æ¥ï¼ŒæŠŠæ•°æ®ä»ç½‘å¡æ‹·è´åˆ°å†…æ ¸ç©ºé—´ï¼Œæ¥ç€æŠŠæ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå†æŠŠç”¨æˆ·çº¿ç¨‹å«é†’ã€‚</p><p><img src="https://i.loli.net/2020/02/02/nPOsYLSymTGZKBf.jpg" alt="fig1.jpg"></p><h2 id="1-2-åŒæ­¥éé˜»å¡I-O"><a href="#1-2-åŒæ­¥éé˜»å¡I-O" class="headerlink" title="1.2 åŒæ­¥éé˜»å¡I/O"></a>1.2 åŒæ­¥éé˜»å¡I/O</h2><p>ç”¨æˆ·çº¿ç¨‹ä¸æ–­å‘èµ·readè°ƒç”¨ï¼Œæ•°æ®æ²¡åˆ°å†…æ ¸ç©ºé—´æ—¶ï¼Œæ¯æ¬¡éƒ½è¿”å›å¤±è´¥ï¼Œç›´åˆ°æ•°æ®åˆ°äº†å†…æ ¸ç©ºé—´ï¼Œè¿™ä¸€æ¬¡readè°ƒç”¨åï¼Œåœ¨ç­‰å¾…æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´è¿™æ®µæ—¶é—´ï¼Œçº¿ç¨‹è¿˜æ˜¯é˜»å¡çš„ï¼Œç­‰æ•°æ®åˆ°äº†ç”¨æˆ·ç©ºé—´å†æŠŠçº¿ç¨‹å«é†’ã€‚ </p><p><img src="https://i.loli.net/2020/02/02/8eqioQx14zkZWjK.jpg" alt="fig2.jpg"></p><h2 id="1-3-I-Oå¤šè·¯å¤ç”¨"><a href="#1-3-I-Oå¤šè·¯å¤ç”¨" class="headerlink" title="1.3 I/Oå¤šè·¯å¤ç”¨"></a>1.3 I/Oå¤šè·¯å¤ç”¨</h2><p>ç”¨æˆ·çº¿ç¨‹çš„è¯»å–æ“ä½œåˆ†ä¸ºä¸¤æ­¥ï¼Œçº¿ç¨‹é¦–å…ˆå‘èµ·selectè°ƒç”¨ï¼Œç›®çš„æ˜¯é—®å†…æ ¸æ•°æ®å‡†å¤‡å¥½äº†æ²¡æœ‰ï¼Œç­‰å†…æ ¸æŠŠæ•°æ®å‡†å¤‡å¥½ï¼Œç”¨æˆ·çº¿ç¨‹å†å‘èµ·readè°ƒç”¨ã€‚åœ¨ç­‰å¾…æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´çš„è¿™æ®µæ—¶é—´é‡Œï¼Œçº¿ç¨‹è¿˜æ˜¯é˜»å¡çš„ã€‚</p><p>å¤šè·¯å¤ç”¨çš„æ„æ€æ˜¯ä¸€æ¬¡selectè°ƒç”¨ä¼šå‘å†…æ ¸æŸ¥å¤šä¸ªæ•°æ®é€šé“çš„çŠ¶æ€ï¼Œå› æ­¤å«åšå¤šè·¯å¤ç”¨ã€‚</p><p><img src="https://i.loli.net/2020/02/02/I3GH1PBRrwnfE9Q.jpg" alt="fig3.jpg"></p><h2 id="1-4-å¼‚æ­¥I-O"><a href="#1-4-å¼‚æ­¥I-O" class="headerlink" title="1.4 å¼‚æ­¥I/O"></a>1.4 å¼‚æ­¥I/O</h2><p>ç”¨æˆ·çº¿ç¨‹å‘èµ·readè°ƒç”¨çš„åŒæ—¶æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œreadç«‹å³è¿”å›ï¼Œç­‰å†…æ ¸å°†æ•°æ®å‡†å¤‡å¥½ä»¥åï¼Œå†è°ƒç”¨æŒ‡å®šçš„å›è°ƒå‡½æ•°å®Œæˆå¤„ç†ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·çº¿ç¨‹ä¸€ç›´æ²¡æœ‰é˜»å¡ã€‚</p><h1 id="2-NioEndpointç»„ä»¶"><a href="#2-NioEndpointç»„ä»¶" class="headerlink" title="2. NioEndpointç»„ä»¶"></a>2. NioEndpointç»„ä»¶</h1><p>Tomcatçš„NioEndpointç»„ä»¶å®ç°äº†I/Oå¤šè·¯å¤ç”¨æ¨¡å‹ã€‚</p><h2 id="2-1-æ€»ä½“å·¥ä½œæµç¨‹"><a href="#2-1-æ€»ä½“å·¥ä½œæµç¨‹" class="headerlink" title="2.1 æ€»ä½“å·¥ä½œæµç¨‹"></a>2.1 æ€»ä½“å·¥ä½œæµç¨‹</h2><ul><li>åˆ›å»ºä¸€ä¸ªselectorï¼Œæ³¨å†Œå„ç§äº‹ä»¶ï¼Œç„¶åè°ƒç”¨selectæ–¹æ³•ï¼Œç­‰å¾…æ„Ÿå…´è¶£çš„äº‹æƒ…å‘ç”Ÿ</li><li>æ„Ÿå…´è¶£çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ä»Channelä¸­è¯»å–æ•°æ®ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/02/8caQkFDGKJinjgy.jpg" alt="fig4.jpg"></p><p>NioEndpointå…±æœ‰5ä¸ªç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>LimitLatch</p><ul><li>è¿æ¥æ§åˆ¶å™¨<ul><li>è´Ÿè´£æ§åˆ¶æœ€å¤§è¿æ¥æ•°</li><li>ä¸€èˆ¬è®¾å®šä¸º10000</li></ul></li></ul></li><li><p>Acceptor</p><ul><li>è·‘åœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹å½“ä¸­</li><li>åœ¨ä¸€ä¸ªæ­»å¾ªç¯é‡Œè°ƒç”¨acceptæ–¹æ³•æ¥æ¥æ”¶æ–°è¿æ¥ï¼Œä¸€æ—¦æœ‰æ–°çš„è¿æ¥è¯·æ±‚åˆ°æ¥ï¼Œacceptæ–¹æ³•è¿”å›ä¸€ä¸ªChannelå¯¹è±¡ï¼Œæ¥ç€æŠŠChannelå¯¹è±¡äº¤ç»™Pollerå»å¤„ç†</li></ul></li><li><p>Poller</p><ul><li>Polleræœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªselector, ä¹Ÿè·‘åœ¨å•ç‹¬çº¿ç¨‹é‡Œã€‚Polleråœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªChannelæ•°ç»„ï¼Œåœ¨ä¸€ä¸ªæ­»å¾ªç¯é‡Œä¸æ–­æ£€æµ‹Channelçš„æ•°æ®å°±ç»ªçŠ¶æ€ï¼Œä¸€æ—¦æœ‰Channelå¯è¯»ï¼Œå°±ç”Ÿæˆä¸€ä¸ªSocketProcessorä»»åŠ¡å¯¹è±¡æ‰”ç»™Executorå»å¤„ç† </li></ul></li><li><p>SocketProcessor</p><ul><li>runæ–¹æ³•ä¼šè°ƒç”¨Http11Processoræ¥è¯»å–å’Œè§£æè¯·æ±‚æ•°æ® </li></ul></li><li><p>Executor </p><ul><li>çº¿ç¨‹æ± </li><li>è´Ÿè´£è¿è¡ŒSocketProcessorä»»åŠ¡ç±»</li></ul></li></ul><h2 id="2-2-LimitLatch"><a href="#2-2-LimitLatch" class="headerlink" title="2.2 LimitLatch"></a>2.2 LimitLatch</h2><p>ç”¨æ¥æ§åˆ¶è¿æ¥ä¸ªæ•°ï¼Œå½“è¿æ¥æ•°åˆ°è¾¾æœ€å¤§æ—¶é˜»å¡çº¿ç¨‹ï¼Œç›´åˆ°åç»­ç»„ä»¶å¤„ç†å®Œä¸€ä¸ªè¿æ¥åæ‰å°†è¿æ¥æ•°å‡1.åˆ°è¾¾æœ€å¤§è¿æ¥æ•°ä»¥åæ“ä½œç³»ç»Ÿåº•å±‚è¿˜æ˜¯ä¼šæ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œä½†ç”¨æˆ·å±‚å·²ç»ä¸å†æ¥æ”¶äº†ã€‚</p><pre><code>public class LimitLatch {// AbstractQueuedSynchronizeråœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€å’Œä¸€ä¸ªçº¿ç¨‹é˜Ÿåˆ—// ç”¨æ¥æ§åˆ¶çº¿ç¨‹ä»€ä¹ˆæ—¶å€™æŒ‚èµ·ï¼Œä»€ä¹ˆæ—¶å€™å”¤é†’    private class Sync extends AbstractQueuedSynchronizer {        @Override        protected int tryAcquireShared() {            long newCount = count.incrementAndGet();            if (newCount &gt; limit) {                count.decrementAndGet();                return -1;            } else {                return 1;            }        }        // å®šä¹‰åˆé€‚å”¤é†’è¢«é˜»å¡çš„ç”¨æˆ·çº¿ç¨‹        @Override        protected boolean tryReleaseShared(int arg) {            count.decrementAndGet();            return true;        }    }    private final Sync sync;    private final AtomicLong count;    private volatile long limit;    // çº¿ç¨‹è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è·å¾—æ¥æ”¶æ–°è¿æ¥çš„è®¸å¯ï¼Œçº¿ç¨‹å¯èƒ½è¢«é˜»å¡     // AQSçŸ¥é“æ˜¯å¦éœ€è¦é˜»å¡çš„é€»è¾‘åœ¨tryAcquireSharedæ–¹æ³•å½“ä¸­å®šä¹‰äº†    public void countUpOrAwait() throws InterruptedException {      sync.acquireSharedInterruptibly(1);    }    // è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥è®¸å¯ï¼Œé‚£ä¹ˆå‰é¢é˜»å¡çš„çº¿ç¨‹å¯èƒ½è¢«å”¤é†’    //     public long countDown() {      sync.releaseShared(0);      long result = getCount();      return result;   }}</code></pre><h2 id="2-3-Acceptor"><a href="#2-3-Acceptor" class="headerlink" title="2.3 Acceptor"></a>2.3 Acceptor</h2><p>Acceptorå®ç°äº†Runnableæ¥å£ï¼Œä¸€ä¸ªç«¯å£å·åªèƒ½å¯¹åº”ä¸€ä¸ªServerSocketChannelï¼Œæ•…è€Œè¿™ä¸ªChannelæ˜¯åœ¨å¤šä¸ªAcceptorçº¿ç¨‹ä¹‹é—´å…±äº«çš„ã€‚</p><pre><code>serverSock = ServerSocketChannel.open();serverSock.socket().bind(addr,getAcceptCount());serverSock.configureBlocking(true);</code></pre><ul><li>bind æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ“ä½œç³»ç»Ÿçš„ç­‰å¾…é˜Ÿåˆ—é•¿åº¦ï¼Œæˆ‘åœ¨ä¸Šé¢æåˆ°ï¼Œå½“åº”ç”¨å±‚é¢çš„è¿æ¥æ•°åˆ°è¾¾æœ€å¤§å€¼æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ç»§ç»­æ¥æ”¶è¿æ¥ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿèƒ½ç»§ç»­æ¥æ”¶çš„æœ€å¤§è¿æ¥æ•°å°±æ˜¯è¿™ä¸ªé˜Ÿåˆ—é•¿åº¦ï¼Œå¯ä»¥é€šè¿‡ acceptCount å‚æ•°é…ç½®ï¼Œé»˜è®¤æ˜¯ 100ã€‚</li><li>ServerSocketChannel è¢«è®¾ç½®æˆé˜»å¡æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä»¥é˜»å¡çš„æ–¹å¼æ¥æ”¶è¿æ¥çš„ã€‚</li></ul><p>ServerSocketChannelé€šè¿‡accept()æ¥å—æ–°çš„è¿æ¥ï¼Œaccept()æ–¹æ³•è¿”å›è·å¾—SocketChannelå¯¹è±¡ï¼Œç„¶åå°†SocketChannelå¯¹è±¡å°è£…åœ¨ä¸€ä¸ªPollerEventå¯¹è±¡å½“ä¸­ï¼Œå¹¶å°†PollerEventå¯¹è±¡å‹å…¥Pollerçš„Queueå½“ä¸­ã€‚</p><h2 id="2-4-Poller"><a href="#2-4-Poller" class="headerlink" title="2.4 Poller"></a>2.4 Poller</h2><p>æœ¬è´¨æ˜¯ä¸€ä¸ªSelectorï¼Œå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªQueue </p><pre><code>private final SynchronizedQueue&lt;PollerEvent&gt; events = new SynchronizedQueue&lt;&gt;();</code></pre><p>ä½¿ç”¨synchronizedå…³é”®å­—æ¥ä¿è¯åœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªAcceptorçº¿ç¨‹å¯¹Queueè¿›è¡Œè¯»å†™ã€‚</p><p>Pollerä¸æ–­é€šè¿‡å†…éƒ¨çš„selectorå¯¹è±¡å‘å†…æ ¸æŸ¥è¯¢Channelçš„çŠ¶æ€ï¼Œä¸€æ—¦å¯è¯»å°±ç”Ÿæˆä»»åŠ¡ç±»SocketProcessoräº¤ç»™Executorå»å¤„ç†ã€‚Pollerçš„å¦ä¸€ä¸ªé‡è¦ä»»åŠ¡æ˜¯å¾ªç¯éå†æ£€æŸ¥è‡ªå·±æ‰€ç®¡ç†çš„SocketChannelæ˜¯å¦å·²ç»è¶…æ—¶ï¼Œè‹¥è¶…æ—¶å°±å…³é—­è¿™ä¸ªChannelã€‚</p><h2 id="2-5-SocketProcessor"><a href="#2-5-SocketProcessor" class="headerlink" title="2.5 SocketProcessor"></a>2.5 SocketProcessor</h2><p>SocketProcessorä»»åŠ¡ç±»ä¼šè¢«äº¤ç»™çº¿ç¨‹æ± å»å¤„ç†ï¼Œprocessorå†…ä¸»è¦æ˜¯è°ƒç”¨Http11Processorç»„ä»¶æ¥å¤„ç†è¯·æ±‚ï¼Œhttp11Processorè¯»å–Channelçš„æ•°æ®æ¥ç”ŸæˆServletRequestå¯¹è±¡</p><h2 id="2-6-NioEndpointçš„é«˜å¹¶å‘æ€è·¯"><a href="#2-6-NioEndpointçš„é«˜å¹¶å‘æ€è·¯" class="headerlink" title="2.6 NioEndpointçš„é«˜å¹¶å‘æ€è·¯"></a>2.6 NioEndpointçš„é«˜å¹¶å‘æ€è·¯</h2><p>å¯¹äºä¸‰å¤§æ–¹é¢çš„äº‹æƒ…å„è‡ªæœ‰ä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œå¯ä»¥é…ç½®çº¿ç¨‹æ•°é‡ã€‚</p><ul><li>æ¥å—è¿æ¥      Acceptor </li><li>æ£€æµ‹I/Oäº‹ä»¶   Poller</li><li>å¤„ç†è¯·æ±‚      Executor </li></ul>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - Servletè§„èŒƒå’ŒServletå®¹å™¨</title>
      <link href="/Tomcat-Servlet%E8%A7%84%E8%8C%83%E5%92%8CServlet%E5%AE%B9%E5%99%A8/"/>
      <url>/Tomcat-Servlet%E8%A7%84%E8%8C%83%E5%92%8CServlet%E5%AE%B9%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Servletè§„èŒƒ"><a href="#1-Servletè§„èŒƒ" class="headerlink" title="1. Servletè§„èŒƒ"></a>1. Servletè§„èŒƒ</h1><p>æµè§ˆå™¨ç»™æœåŠ¡ç«¯ä¸€ä¸ªHTTPæ ¼å¼çš„è¯·æ±‚ï¼ŒHTTPæœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œéœ€è¦è°ƒç”¨æœåŠ¡ç«¯ç¨‹åºæ¥åšå¤„ç†ã€‚</p><p>ä¸ºäº†è§£å†³è€¦åˆé—®é¢˜ -&gt; é‡‡ç”¨é¢å‘æ¥å£ç¼–ç¨‹ï¼Œå°±å®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼Œå„ç§ä¸šåŠ¡ç±»éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ï¼Œè¿™ä¸ªæ¥å£å°±å«Servletæ¥å£ã€‚</p><p>ä¸ºäº†å®ä¾‹åŒ–Servletï¼Œå‡ºç°äº†Servletå®¹å™¨ï¼ŒServletå®¹å™¨ç”¨æ¥åŠ è½½å’Œç®¡ç†ä¸šåŠ¡ç±»ã€‚</p><p>HTTPæœåŠ¡å™¨å¹¶ä¸ç›´æ¥è·Ÿä¸šåŠ¡ç±»æ‰“äº¤é“ï¼Œè€Œæ˜¯å°†è¯·æ±‚äº¤ç»™Servletå®¹å™¨å»å¤„ç†ï¼ŒServletå®¹å™¨ä¼šå°†è¯·æ±‚è½¬å‘åˆ°å…·ä½“çš„Servletï¼Œå¦‚æœè¿™ä¸ªServletè¿˜æ²¡æœ‰åˆ›å»ºï¼Œå°±å»åŠ è½½å¹¶ä¸”å®ä¾‹åŒ–è¿™ä¸ªServletï¼Œç„¶åè°ƒç”¨è¿™ä¸ªServletçš„æ¥å£æ–¹æ³•ã€‚</p><p>Servletæ¥å£å…¶å®æ˜¯Servletå®¹å™¨è·Ÿå…·ä½“ä¸šåŠ¡ç±»ä¹‹é—´çš„æ¥å£ã€‚</p><p><img src="https://i.loli.net/2020/02/02/Gfnmrp9AFldWq1s.jpg" alt="fig1.jpg"></p><p>Servletæ¥å£å’ŒServletå®¹å™¨è¿™ä¸€æ•´å¥—è§„èŒƒå°±å«åšServletè§„èŒƒã€‚ Tomcatå’ŒJettyéƒ½æŒ‰ç…§Servletè§„èŒƒçš„è¦æ±‚å®ç°äº†Servletå®¹å™¨ï¼ŒåŒæ—¶å®ƒä»¬ä¹Ÿå…·æœ‰HTTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚</p><p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°ä¸€ä¸ªServletï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°å®¹å™¨å½“ä¸­ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±äº¤ç”±Tomcatæ¥å¸®åŠ©æˆ‘ä»¬è§£å†³äº†ã€‚</p><h1 id="2-Servletæ¥å£"><a href="#2-Servletæ¥å£" class="headerlink" title="2. Servletæ¥å£"></a>2. Servletæ¥å£</h1><p>Servletæ¥å£å®šä¹‰äº†ä»¥ä¸‹çš„æ–¹æ³•ï¼š</p><pre><code>public interface Servlet {    void init(ServletConfig config) throws ServletException;    ServletConfig getServletConfig();    void service(ServletRequest req, ServletResponse resï¼‰throws ServletException, IOException;    String getServletInfo();    void destroy();}</code></pre><p>æœ€é‡è¦çš„æ˜¯Serviceæ–¹æ³•ï¼Œå…·ä½“ä¸šåŠ¡ç±»åœ¨è¿™ä¸ªæ–¹æ³•é‡Œå®ç°å¤„ç†é€»è¾‘ã€‚</p><ul><li>å‚æ•° - æœ¬è´¨ä¸Šè¿™ä¸¤ä¸ªå‚æ•°æ˜¯å¯¹é€šä¿¡åè®®çš„å°è£…<ul><li>ServletRequest <ul><li>å°è£…è¯·æ±‚ä¿¡æ¯ </li><li>å…¶ä¸­åŒ…å«æ‰€æœ‰è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯<ul><li>è¯·æ±‚è·¯å¾„</li><li>Cookie</li><li>HTTPå¤´</li><li>è¯·æ±‚å‚æ•°</li><li>Session</li></ul></li></ul></li><li>ServletResponse<ul><li>å°è£…å“åº”ä¿¡æ¯ </li></ul></li></ul></li><li>Servletå®¹å™¨åœ¨åŠ è½½Servletç±»çš„æ—¶å€™ä¼šè°ƒç”¨initæ–¹æ³•ï¼Œå¸è½½çš„æ—¶å€™ä¼šè°ƒç”¨destroyæ–¹æ³•ã€‚</li><li>ServletConfigçš„ä½œç”¨æ˜¯å°è£…Servletçš„åˆå§‹åŒ–å‚æ•°ï¼Œå¯ä»¥åœ¨web.xmlä¸­ç»™Servleté…ç½®å‚æ•°ï¼Œå¹¶åœ¨ç¨‹åºé‡Œé€šè¿‡getServletConfigæ–¹æ³•æ‹¿åˆ°è¿™äº›å‚æ•°</li></ul><h1 id="3-Servletå®¹å™¨"><a href="#3-Servletå®¹å™¨" class="headerlink" title="3. Servletå®¹å™¨"></a>3. Servletå®¹å™¨</h1><h2 id="3-1-Servletå®¹å™¨å·¥ä½œæµç¨‹"><a href="#3-1-Servletå®¹å™¨å·¥ä½œæµç¨‹" class="headerlink" title="3.1 Servletå®¹å™¨å·¥ä½œæµç¨‹"></a>3.1 Servletå®¹å™¨å·¥ä½œæµç¨‹</h2><ul><li>å®¢æˆ·è¯·æ±‚æŸä¸ªèµ„æºçš„æ—¶å€™ï¼Œ</li><li>HTTPæœåŠ¡å™¨ä¼šç”¨ä¸€ä¸ªServletRequestå¯¹è±¡å°†å®¢æˆ·çš„è¯·æ±‚ä¿¡æ¯å°è£…èµ·æ¥</li><li>è°ƒç”¨Servletå®¹å™¨çš„Serviceæ–¹æ³•</li><li>Servletå®¹å™¨æ¥åˆ°è¯·æ±‚</li><li>æ ¹æ®è¯·æ±‚çš„URLå’ŒServletçš„æ˜ å°„å…³ç³»ï¼Œæ‰¾åˆ°å“åº”çš„Servlet</li><li>å¦‚æœServletè¿˜æ²¡æœ‰è¢«åŠ è½½ï¼Œå°±ç”¨åå°„æœºåˆ¶åˆ›å»ºè¿™ä¸ªServletï¼Œå¹¶è°ƒç”¨Servletçš„initæ–¹æ³•æ¥å®Œæˆåˆå§‹åŒ–ï¼Œæ¥ç€è°ƒç”¨Servletçš„serviceæ–¹æ³•å¤„ç†è¯·æ±‚</li><li>å°†ServletResponseå¯¹è±¡è¿”å›ç»™HTTPæœåŠ¡å™¨</li><li>HTTPæœåŠ¡å™¨å°†å“åº”å‘é€ç»™å®¢æˆ·ç«¯</li></ul><p><img src="https://i.loli.net/2020/02/02/jvc2pThotnA8J59.jpg" alt="fig2.jpg"></p><h2 id="3-2-Webåº”ç”¨çš„ç›®å½•æ ¼å¼"><a href="#3-2-Webåº”ç”¨çš„ç›®å½•æ ¼å¼" class="headerlink" title="3.2 Webåº”ç”¨çš„ç›®å½•æ ¼å¼"></a>3.2 Webåº”ç”¨çš„ç›®å½•æ ¼å¼</h2><p>Servletæ˜¯ä»¥Webåº”ç”¨ç¨‹å¼çš„æ–¹å¼æ¥è¿›è¡Œéƒ¨ç½²çš„ï¼Œè€Œæ ¹æ®Servletè§„èŒƒï¼ŒWEBåº”ç”¨ç¨‹åºéœ€è¦æœ‰ä¸€å®šçš„ç›®å½•ç»“æ„ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹æ”¾ç½®äº†ï¼š</p><ul><li><p>Servletçš„ç±»æ–‡ä»¶</p></li><li><p>é…ç½®æ–‡ä»¶</p></li><li><p>é™æ€èµ„æº</p><p>  | -  MyWebApp</p><pre><code>    | -  WEB-INF/web.xml        -- é…ç½®æ–‡ä»¶ï¼Œç”¨æ¥é…ç½® Servlet ç­‰    | -  WEB-INF/lib/           -- å­˜æ”¾ Web åº”ç”¨æ‰€éœ€å„ç§ JAR åŒ…    | -  WEB-INF/classes/       -- å­˜æ”¾ä½ çš„åº”ç”¨ç±»ï¼Œæ¯”å¦‚ Servlet ç±»    | -  META-INF/              -- ç›®å½•å­˜æ”¾å·¥ç¨‹çš„ä¸€äº›ä¿¡æ¯</code></pre></li></ul><p>Servletå®¹å™¨é€šè¿‡è¯»å–é…ç½®æ–‡ä»¶ï¼Œå°±èƒ½æ‰¾åˆ°å¹¶åŠ è½½Servletã€‚</p><p>ServletContextè¿™ä¸ªæ¥å£ç”¨æ¥å¯¹åº”ä¸€ä¸ªWebåº”ç”¨ï¼Œwebåº”ç”¨éƒ¨ç½²å¥½ä¹‹åï¼ŒServletå®¹å™¨åœ¨å¯åŠ¨æ—¶ä¼šåŠ è½½webåº”ç”¨ï¼Œå¹¶ä¸ºæ¯ä¸ªWebåº”ç”¨åˆ›å»ºå”¯ä¸€çš„ServletContextå¯¹è±¡ã€‚</p><p>ServletContextæ˜¯ä¸ªå…¨å±€å¯¹è±¡ï¼Œä¸€ä¸ªWebåº”ç”¨å¯èƒ½æœ‰å¤šä¸ªServletï¼Œè¿™äº›Servletå¯ä»¥é€šè¿‡å…¨å±€çš„ServletContextæ¥å…±äº«æ•°æ®ï¼ŒåŒ…æ‹¬Webåº”ç”¨çš„åˆå§‹åŒ–å‚æ•°ï¼Œåº”ç”¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ„æºç­‰</p><h2 id="3-3-å¦‚ä½•æ‰©å±•å’Œå®šåˆ¶åŒ–Servletå®¹å™¨çš„åŠŸèƒ½"><a href="#3-3-å¦‚ä½•æ‰©å±•å’Œå®šåˆ¶åŒ–Servletå®¹å™¨çš„åŠŸèƒ½" class="headerlink" title="3.3 å¦‚ä½•æ‰©å±•å’Œå®šåˆ¶åŒ–Servletå®¹å™¨çš„åŠŸèƒ½"></a>3.3 å¦‚ä½•æ‰©å±•å’Œå®šåˆ¶åŒ–Servletå®¹å™¨çš„åŠŸèƒ½</h2><p>Servletè§„èŒƒæä¾›äº†ä¸¤ä¸­æ‰©å±•æœºåˆ¶ï¼ŒFilter and Listener</p><h3 id="3-3-1-Filter"><a href="#3-3-1-Filter" class="headerlink" title="3.3.1 Filter"></a>3.3.1 Filter</h3><p>Filterå¹²é¢„è¿‡ç¨‹ï¼Œæ˜¯è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯åŸºäºè¿‡ç¨‹æ¥è¢«è§¦å‘çš„</p><p>è¿‡æ»¤å™¨ã€‚å…è®¸ä½ å¯¹è¯·æ±‚å’Œå“åº”åšä¸€äº›ç»Ÿä¸€çš„å®šåˆ¶åŒ–å¤„ç†ï¼Œæ¯”å¦‚ä½ å¯ä»¥æ ¹æ®è¯·æ±‚çš„é¢‘ç‡é™åˆ¶è®¿é—®ï¼Œæˆ–è€…æ ¹æ®ä¸åŒå›½å®¶ä¿®æ”¹å“åº”å†…å®¹ã€‚</p><ul><li>WEBåº”ç”¨å®Œæˆéƒ¨ç½²</li><li>Servletå®¹å™¨å®ä¾‹åŒ–Filter</li><li>Filterä¼šè¢«é“¾æ¥æˆä¸€ä¸ªFilterChain</li><li>å½“è¯·æ±‚è¿›æ¥ï¼Œè·å–ç¬¬ä¸€ä¸ªFilterå¹¶è°ƒç”¨doFilteræ–¹æ³•</li><li>doFilteræ–¹æ³•è´Ÿè´£è°ƒç”¨è¿™ä¸ªFilterChainä¸­çš„ä¸‹ä¸€ä¸ªFilter</li></ul><h3 id="3-3-2-Listener"><a href="#3-3-2-Listener" class="headerlink" title="3.3.2 Listener"></a>3.3.2 Listener</h3><p>Listeneræ˜¯åŸºäºçŠ¶æ€çš„ï¼Œä»»ä½•è¡Œä¸ºæ”¹å˜åŒä¸€ä¸ªçŠ¶æ€ï¼Œè§¦å‘çš„äº‹ä»¶æ˜¯ä¸€è‡´çš„ã€‚</p><ul><li>Servletå®¹å™¨æä¾›ä¸€äº›é»˜è®¤çš„ç›‘å¬å™¨æ¥ç›‘å¬äº‹ä»¶<ul><li>webåº”ç”¨çš„å¯åŠ¨åœæ­¢</li><li>ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ç­‰</li></ul></li><li>äº‹ä»¶å‘ç”Ÿï¼ŒServletè°ƒåŠ¨ç›‘å¬å™¨çš„æ–¹æ³•</li><li>å¯ä»¥å®šä¹‰è‡ªå·±çš„ç›‘å¬å™¨å»ç›‘å¬ä½ æ„Ÿå…´è¶£çš„äº‹ä»¶</li><li>å°†ç›‘å¬å™¨é…ç½®åœ¨web.xmlä¸­</li></ul>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - ä»€ä¹ˆæ˜¯Webå®¹å™¨, cookie &amp; session</title>
      <link href="/Tomcat-%E4%BB%80%E4%B9%88%E6%98%AFWeb%E5%AE%B9%E5%99%A8-cookie-session/"/>
      <url>/Tomcat-%E4%BB%80%E4%B9%88%E6%98%AFWeb%E5%AE%B9%E5%99%A8-cookie-session/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯Webå®¹å™¨"><a href="#1-ä»€ä¹ˆæ˜¯Webå®¹å™¨" class="headerlink" title="1. ä»€ä¹ˆæ˜¯Webå®¹å™¨"></a>1. ä»€ä¹ˆæ˜¯Webå®¹å™¨</h1><p>æ—©æœŸçš„Webåº”ç”¨ä¸»è¦ç”¨äºæµè§ˆæ–°é—»ç­‰é™æ€é¡µé¢ï¼ŒHTTPæœåŠ¡å™¨(æ¯”å¦‚Apacheã€Nginx)å‘æµè§ˆå™¨è¿”å›é™æ€HTMLï¼Œæµè§ˆå™¨è´Ÿè´£è§£æHTMLï¼Œå°†ç»“æœå‘ˆç°ç»™ç”¨æˆ·ã€‚ </p><p>è€Œåæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨é¡µé¢ä¸Šæœ‰ä¸€äº›äº¤äº’æ“ä½œï¼Œè·å–åŠ¨æ€çš„ç»“æœï¼Œå› æ­¤å°±éœ€è¦ä¸€äº›æ‰©å±•æœºåˆ¶æ¥ä½¿å¾—HTTPæœåŠ¡å™¨èƒ½å¤Ÿè°ƒç”¨æœåŠ¡ç«¯çš„ç¨‹åºã€‚äºæ˜¯Sunå…¬å¸æ¨å‡ºäº†ServletæŠ€æœ¯ï¼Œå…¶æ²¡æœ‰mainæ–¹æ³•ï¼Œéœ€è¦è¢«éƒ¨ç½²åˆ°Servletå®¹å™¨å½“ä¸­ï¼Œç”±å®¹å™¨æ¥å®ä¾‹åŒ–å¹¶è°ƒç”¨Servletã€‚</p><p>Tomcatå’ŒJettyå°±æ˜¯HTTPæœåŠ¡å™¨ + Servletå®¹å™¨ï¼Œåˆç§°ä¸ºWebå®¹å™¨ã€‚</p><h1 id="2-Cookie-amp-Session"><a href="#2-Cookie-amp-Session" class="headerlink" title="2. Cookie &amp; Session"></a>2. Cookie &amp; Session</h1><p>æµè§ˆå™¨å°†è¯·æ±‚æ‰“åŒ…æˆHTTPåè®®æ ¼å¼ï¼Œå½“è¿™ä¸ªè¯·æ±‚åˆ°è¾¾æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œä¼šè¢«Tomcatå°†HTTPè¯·æ±‚æ•°æ®å­—èŠ‚æµè§£ææˆä¸€ä¸ªRequestå¯¹è±¡ï¼Œè¿™ä¸ªRequestå¯¹è±¡å°è£…äº†HTTPæ‰€æœ‰çš„è¯·æ±‚ä¿¡æ¯ï¼Œæ¥ç€Tomcatå°†è¿™ä¸ªè¯·æ±‚äº¤ç»™Webåº”ç”¨å»å¤„ç†ï¼Œå¤„ç†å®Œä»¥åå¾—åˆ°ä¸€ä¸ªResponseå¯¹è±¡ï¼ŒTomcatå°±ä¼šæŠŠè¿™ä¸ªResponseå¯¹è±¡è½¬æˆHTTPæ ¼å¼çš„ç›¸åº”æ•°æ®å¹¶å‘é€ç»™æµè§ˆå™¨ã€‚</p><p>HTTPåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œè¯·æ±‚ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œä¸ºäº†è®©è¯·æ±‚ä¹‹é—´å»ºç«‹è”ç³»ï¼Œè®¾è®¡å‡ºäº†Cookieè¿˜æœ‰SessionæŠ€æœ¯ã€‚</p><h2 id="2-1-CookieæŠ€æœ¯"><a href="#2-1-CookieæŠ€æœ¯" class="headerlink" title="2.1 CookieæŠ€æœ¯"></a>2.1 CookieæŠ€æœ¯</h2><p>Cookieæ˜¯HTTPæŠ¥æ–‡çš„è¯·æ±‚å¤´ï¼ŒWebåº”ç”¨å¯ä»¥å°†ç”¨æˆ·çš„æ ‡è¯†ä¿¡æ¯æˆ–è€…å…¶ä»–ä¸€äº›ä¿¡æ¯å­˜å‚¨åœ¨Cookieä¸­ã€‚ç”¨æˆ·é€šè¿‡éªŒè¯ä¹‹åï¼Œæ¯æ¬¡HTTPè¯·æ±‚æŠ¥æ–‡ä¸­éƒ½åŒ…å«Cookieï¼Œè¿™ä¸ªæœåŠ¡å™¨è¯»å–è¿™ä¸ªCookieè¯·æ±‚å¤´å°±çŸ¥é“ç”¨æˆ·æ˜¯è°äº†ã€‚</p><p>å…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä»½å­˜å‚¨åœ¨ç”¨æˆ·æœ¬åœ°çš„æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†æ¯æ¬¡è¯·æ±‚ä¸­éƒ½éœ€è¦ä¼ é€’çš„ä¿¡æ¯ã€‚</p><h2 id="2-2-SessionæŠ€æœ¯"><a href="#2-2-SessionæŠ€æœ¯" class="headerlink" title="2.2 SessionæŠ€æœ¯"></a>2.2 SessionæŠ€æœ¯</h2><p>Cookieä»¥æ˜æ–‡çš„æ–¹å¼å­˜å‚¨åœ¨æœ¬åœ°ï¼Œè€ŒCookieä¸­å¾€å¾€å¸¦æœ‰ç”¨æˆ·ä¿¡æ¯ï¼ŒSessionå°±ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ˜¯åœ¨æœåŠ¡ç«¯å¼€è¾Ÿçš„å­˜å‚¨ç©ºé—´ï¼Œé‡Œé¢ä¿å­˜äº†ç”¨æˆ·çš„çŠ¶æ€ã€‚</p><p>ç”¨æˆ·ä¿¡æ¯ä»¥Sessionçš„å½¢å¼å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œå½“ç”¨æˆ·è¯·æ±‚åˆ°æ¥æ—¶ï¼ŒæœåŠ¡ç«¯å¯ä»¥æŠŠç”¨æˆ·çš„è¯·æ±‚å’Œç”¨æˆ·çš„Sessionå¯¹åº”èµ·æ¥ã€‚</p><ul><li>æœåŠ¡å™¨åˆ›å»ºSessionçš„æ—¶å€™ï¼Œç”ŸæˆSession ID</li><li>å½“æµè§ˆå™¨å†æ¬¡å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨Cookieé‡Œä¼šå¸¦ä¸ŠSession ID</li><li>æœåŠ¡å™¨æ ¹æ®SessionIDæ‰¾åˆ°å¯¹åº”çš„Sessionï¼Œå¹¶åœ¨Sessionå½“ä¸­è·å–æˆ–è€…æ·»åŠ å†…å®¹</li></ul>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - ä¼˜åŒ–Tomcatå¯åŠ¨é€Ÿåº¦</title>
      <link href="/Tomcat-%E4%BC%98%E5%8C%96Tomcat%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6/"/>
      <url>/Tomcat-%E4%BC%98%E5%8C%96Tomcat%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p>ä¼˜åŒ–tomcatçš„å¯åŠ¨é€Ÿåº¦ï¼Œå¯ä»¥ä½¿å¾—å½“ä½ çš„service downæ‰ï¼Œä½ åšå‡ºä¿®æ”¹çš„æ—¶å€™ï¼Œèƒ½å¤Ÿæ›´å¿«çš„ä¸Šçº¿ï¼Œè¿™æ˜¯ä¸ªå¾ˆå¯å–ï¼Œä¹Ÿå¾ˆéœ€è¦ä¼˜åŒ–çš„æ–¹é¢äº†ã€‚</p><h1 id="1-æ¸…ç†Tomcat"><a href="#1-æ¸…ç†Tomcat" class="headerlink" title="1. æ¸…ç†Tomcat"></a>1. æ¸…ç†Tomcat</h1><h2 id="1-1-æ¸…ç†ä¸å¿…è¦çš„webåº”ç”¨"><a href="#1-1-æ¸…ç†ä¸å¿…è¦çš„webåº”ç”¨" class="headerlink" title="1.1 æ¸…ç†ä¸å¿…è¦çš„webåº”ç”¨"></a>1.1 æ¸…ç†ä¸å¿…è¦çš„webåº”ç”¨</h2><p>åˆ é™¤æ‰webappsæ–‡ä»¶å¤¹ä¸‹ä¸éœ€è¦çš„å·¥ç¨‹ï¼š</p><ul><li>host-manager </li><li>example</li><li>doc</li></ul><h2 id="1-2-æ¸…ç†XMLé…ç½®æ–‡ä»¶"><a href="#1-2-æ¸…ç†XMLé…ç½®æ–‡ä»¶" class="headerlink" title="1.2 æ¸…ç†XMLé…ç½®æ–‡ä»¶"></a>1.2 æ¸…ç†XMLé…ç½®æ–‡ä»¶</h2><p>Tomcatåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šè§£ææ‰€æœ‰çš„XMLé…ç½®æ–‡ä»¶ï¼Œä½†XMLçš„è§£æçš„ä»£ä»·å¹¶ä¸å°ï¼Œå°½é‡ä¿æŒXMLé…ç½®æ–‡ä»¶çš„ç®€æ´ã€‚</p><h2 id="1-3-æ¸…ç†JARæ–‡ä»¶"><a href="#1-3-æ¸…ç†JARæ–‡ä»¶" class="headerlink" title="1.3 æ¸…ç†JARæ–‡ä»¶"></a>1.3 æ¸…ç†JARæ–‡ä»¶</h2><p>å¯ä»¥åˆ é™¤æ‰€æœ‰ä¸éœ€è¦çš„JARæ–‡ä»¶ã€‚JVMçš„ç±»åŠ è½½å™¨åœ¨åŠ è½½ç±»æ—¶ï¼Œéœ€è¦æŸ¥æ‰¾æ¯ä¸€ä¸ªJARæ–‡ä»¶æ¥æ‰¾åˆ°æ‰€éœ€è¦çš„ç±»ï¼Œåˆ é™¤ä¸éœ€è¦çš„JARæ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿å¾—æŸ¥æ‰¾çš„é€Ÿåº¦å˜å¿«ä¸€äº›ã€‚</p><p>Webåº”ç”¨å½“ä¸­çš„libç›®å½•ä¸‹ä¸åº”è¯¥å‡ºç°Servlet APIæˆ–è€…Tomcatè‡ªèº«çš„JARï¼Œè¿™äº›æ˜¯ç”±Tomcatè´Ÿè´£æä¾›çš„ã€‚</p><h2 id="1-4-æ¸…ç†å…¶ä»–æ–‡ä»¶"><a href="#1-4-æ¸…ç†å…¶ä»–æ–‡ä»¶" class="headerlink" title="1.4 æ¸…ç†å…¶ä»–æ–‡ä»¶"></a>1.4 æ¸…ç†å…¶ä»–æ–‡ä»¶</h2><p>åŠæ—¶æ¸…ç†æ—¥å¿—ï¼Œåˆ é™¤æ‰logsæ–‡ä»¶å¤¹ä¸‹ä¸éœ€è¦çš„æ—¥å¿—æ–‡ä»¶ã€‚Catalinaæ–‡ä»¶å¤¹æ˜¯Tomcatå°†JSPè½¬æ¢æˆClassæ–‡ä»¶çš„å·¥ä½œç›®å½•ã€‚æ¯æ¬¡å¯åŠ¨ä¼šé‡æ–°ç”Ÿæˆçš„ã€‚</p><h1 id="2-ç¦æ­¢Tomcat-TLDæ‰«æ"><a href="#2-ç¦æ­¢Tomcat-TLDæ‰«æ" class="headerlink" title="2. ç¦æ­¢Tomcat TLDæ‰«æ"></a>2. ç¦æ­¢Tomcat TLDæ‰«æ</h1><p>TLDæ˜¯å¯¹äºæ ‡ç­¾åº“çš„å®šä¹‰ï¼Œç”¨æ¥æ”¯æŒJSPçš„ï¼Œå¦‚æœä½ æ²¡æœ‰å®šä¹‰çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¾ç½®ä¸å»æ‰«æè¿™ä¸ªJARåŒ… </p><ul><li>å¦‚æœå®Œå…¨æ²¡æœ‰ä½¿ç”¨JSPä½œä¸ºé¡µé¢æ¨¡æ¿ï¼Œå¯ä»¥å°†TLDæ‰«æç¦æ‰</li></ul><pre><code>&lt;Context&gt;    &lt;JarScanner&gt;        &lt;JarScanFilter defaultTldScan = &quot;false&quot;/&gt;    &lt;/JarScanner&gt;&lt;/Context&gt;</code></pre><ul><li>å¦‚æœä½¿ç”¨JSPä½œä¸ºæ¨¡æ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å‘Šè¯‰Tomcatåªæ‰«æé‚£äº›åŒ…æ‹¬TLDæ–‡ä»¶çš„JARåŒ…ã€‚æ‰¾åˆ°<code>conf/</code>ä¸‹çš„   <code>catalina.properties</code>æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œçš„jarsToSkipé…ç½®é¡¹å½“ä¸­ï¼ŒåŠ å…¥JARåŒ…</li></ul><pre><code>tomcat.util.scan.StandardJarScanFilter.jarsToSkip=xxx.jar</code></pre><h1 id="3-å…³é—­WebSocketçš„æ”¯æŒ"><a href="#3-å…³é—­WebSocketçš„æ”¯æŒ" class="headerlink" title="3. å…³é—­WebSocketçš„æ”¯æŒ"></a>3. å…³é—­WebSocketçš„æ”¯æŒ</h1><p>Tomcat ä¼šæ‰«æ WebSocket æ³¨è§£çš„ API å®ç°ï¼Œæ¯”å¦‚@ServerEndpointæ³¨è§£çš„ç±»ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ³¨è§£æ‰«æä¸€èˆ¬æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œå¦‚æœä¸éœ€è¦ä½¿ç”¨ WebSockets å°±å¯ä»¥å…³é—­å®ƒã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼Œæ‰¾åˆ° Tomcat çš„conf/ç›®å½•ä¸‹çš„context.xmlæ–‡ä»¶ï¼Œç»™ Context æ ‡ç­¾åŠ ä¸€ä¸ªcontainerSciFilterçš„å±æ€§ã€‚</p><pre><code>&lt;Context containerSciFilter=&quot;org.apache.jasper.servlet.JasperInitializer&quot;&gt;&lt;/Context&gt; </code></pre><h1 id="4-ç¦æ­¢Servletæ³¨è§£çš„æ‰«æ"><a href="#4-ç¦æ­¢Servletæ³¨è§£çš„æ‰«æ" class="headerlink" title="4. ç¦æ­¢Servletæ³¨è§£çš„æ‰«æ"></a>4. ç¦æ­¢Servletæ³¨è§£çš„æ‰«æ</h1><p>Tomcatä¼šåœ¨webåº”ç”¨å¯åŠ¨æ—¶æ‰«æä½ çš„ç±»æ–‡ä»¶ï¼Œå¦‚æœä½ æ²¡æœ‰ä½¿ç”¨servlet æ³¨è§£ï¼Œå¯ä»¥å‘Šè¯‰Tomcatä¸è¦å»æ‰«æã€‚å…·ä½“é…ç½®æ–¹æ³•ï¼šåœ¨ä½ çš„ Web åº”ç”¨çš„<code>web.xml</code>æ–‡ä»¶ä¸­ï¼Œè®¾ç½®å…ƒç´ çš„å±æ€§<code>metadata-complete=&quot;true&quot;</code></p><h1 id="5-éšæœºæ•°ç†µæºä¼˜åŒ–"><a href="#5-éšæœºæ•°ç†µæºä¼˜åŒ–" class="headerlink" title="5. éšæœºæ•°ç†µæºä¼˜åŒ–"></a>5. éšæœºæ•°ç†µæºä¼˜åŒ–</h1><p>Tomcat7ä»¥ä¸Šç‰ˆæœ¬ä¾èµ–Javaçš„SecureRandomç±»æ¥ç”Ÿæˆéšæœºæ•°ï¼Œæ¯”å¦‚SessionID, JVMé»˜è®¤ä½¿ç”¨é˜»å¡å¼ç†µæº(<code>/dev/random</code>), æŸäº›æƒ…å†µä¸‹ä¼šå¯¼è‡´tomcatå¯åŠ¨å˜æ…¢ã€‚</p><p>å¯ä»¥é€šè¿‡è®¾ç½®ï¼Œè®©JVMä½¿ç”¨éé˜»å¡å¼çš„ç†µæºã€‚</p><pre><code> -Djava.security.egd=file:/dev/./urandom</code></pre><h1 id="6-å¹¶è¡Œå¯åŠ¨å¤šä¸ªWebåº”ç”¨"><a href="#6-å¹¶è¡Œå¯åŠ¨å¤šä¸ªWebåº”ç”¨" class="headerlink" title="6. å¹¶è¡Œå¯åŠ¨å¤šä¸ªWebåº”ç”¨"></a>6. å¹¶è¡Œå¯åŠ¨å¤šä¸ªWebåº”ç”¨</h1><p>Tomcatå¯åŠ¨çš„æ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹Webåº”ç”¨æ—¶ä¸€ä¸ªä¸€ä¸ªå¯åŠ¨çš„ï¼Œç­‰æ‰€æœ‰Web åº”ç”¨å¯åŠ¨å®ŒæˆTomcatæ‰ç®—å¯åŠ¨å®Œæˆã€‚å¦‚æœåœ¨ä¸€ä¸ªTomcatä¸‹æˆ‘ä»¬æœ‰å¤šä¸ªwebåº”ç”¨ï¼Œå¯ä»¥é…ç½®å¤šä¸ªåº”ç”¨å¹¶è¡Œå¯åŠ¨ï¼Œé€šè¿‡ä¿®æ”¹server.xmlæ–‡ä»¶å½“ä¸­çš„hostå…ƒç´ çš„startStopThreadså±æ€§æ¥å®Œæˆã€‚startStopThreads çš„å€¼è¡¨ç¤ºä½ æƒ³ç”¨å¤šå°‘ä¸ªçº¿ç¨‹æ¥å¯åŠ¨ä½ çš„ Web åº”ç”¨ï¼Œå¦‚æœè®¾æˆ 0 è¡¨ç¤ºä½ è¦å¹¶è¡Œå¯åŠ¨ Web åº”ç”¨ã€‚</p><pre><code>&lt;Engine startStopThreads=&quot;0&quot;&gt;    &lt;Host startStopThreads=&quot;0&quot;&gt;    ...    &lt;/Host&gt;&lt;/Engine&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - è¿è¡Œç¬¬ä¸€ä¸ª Servlet</title>
      <link href="/Tomcat-%E8%BF%90%E8%A1%8C%E7%AC%AC%E4%B8%80%E4%B8%AA-Servlet/"/>
      <url>/Tomcat-%E8%BF%90%E8%A1%8C%E7%AC%AC%E4%B8%80%E4%B8%AA-Servlet/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¼šå¸¦ç€å¤§å®¶ä»ä¸‹è½½å®‰è£…Tomcatå¼€å§‹ï¼Œç¼–å†™è‡ªå·±çš„servletï¼Œå¹¶ä¸”å°†å…¶åœ¨Tomcat ï¼ˆServlet å®¹å™¨ï¼‰å½“ä¸­è¿›è¡Œè¿è¡Œï¼Œå±•ç°è¿™æ•´ä¸ªè¿‡ç¨‹ã€‚</p><h1 id="1-å®‰è£…Tomcat"><a href="#1-å®‰è£…Tomcat" class="headerlink" title="1. å®‰è£…Tomcat"></a>1. å®‰è£…Tomcat</h1><p> <a href="https://tomcat.apache.org/download-90.cgi" target="_blank" rel="noopener">å®˜ç½‘é“¾æ¥</a></p><p> è§£å‹ä»¥åçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><ul><li>bin<ul><li>å­˜æ”¾åœ¨å„ä¸ªå¹³å°ä¸Šå¯åŠ¨å’Œå…³é—­Tomcatçš„è„šæœ¬æ–‡ä»¶ </li></ul></li><li>conf<ul><li>å­˜æ”¾Tomcatçš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯server.xml  </li></ul></li><li>lib<ul><li>å­˜æ”¾Tomcatä»¥åŠæ‰€æœ‰Webåº”ç”¨éƒ½å¯ä»¥è®¿é—®çš„JARæ–‡ä»¶ </li></ul></li><li>logs<ul><li>å­˜æ”¾Tomcatæ‰§è¡Œæ—¶äº§ç”Ÿçš„æ—¥å¿—æ–‡ä»¶ </li></ul></li><li>work<ul><li>å­˜æ”¾JSPç¼–è¯‘åäº§ç”Ÿçš„Classæ–‡ä»¶ </li></ul></li><li>webapps<ul><li>Tomcatçš„webåº”ç”¨ç›®å½•ï¼Œé»˜è®¤æƒ…å†µä¸‹æŠŠWebåº”ç”¨æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ </li></ul></li></ul><h1 id="2-Servletç±»ç¼–å†™"><a href="#2-Servletç±»ç¼–å†™" class="headerlink" title="2. Servletç±»ç¼–å†™"></a>2. Servletç±»ç¼–å†™</h1><pre><code>import java.io.IOException;import java.io.PrintWriter;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;public class MyServlet extends HttpServlet {    @Override    protected void doGet(HttpServletRequest request, HttpServletResponse response)            throws ServletException, IOException {        System.out.println(&quot;MyServlet åœ¨å¤„ç† getï¼ˆï¼‰è¯·æ±‚...&quot;);        PrintWriter out = response.getWriter();        response.setContentType(&quot;text/html;charset=utf-8&quot;);        out.println(&quot;&lt;strong&gt;My Servlet!&lt;/strong&gt;&lt;br&gt;&quot;);    }    @Override    protected void doPost(HttpServletRequest request, HttpServletResponse response)            throws ServletException, IOException {        System.out.println(&quot;MyServlet åœ¨å¤„ç† postï¼ˆï¼‰è¯·æ±‚...&quot;);        PrintWriter out = response.getWriter();        response.setContentType(&quot;text/html;charset=utf-8&quot;);        out.println(&quot;&lt;strong&gt;My Servlet!&lt;/strong&gt;&lt;br&gt;&quot;);    }}</code></pre><p>å°†ç¼–å†™å¥½çš„ç±»ç¼–è¯‘æˆ.classæ–‡ä»¶</p><pre><code>javac -cp ./servlet-api.jar MyServlet.java</code></pre><h1 id="3-å»ºç«‹Webåº”ç”¨ç›®å½•ç»“æ„"><a href="#3-å»ºç«‹Webåº”ç”¨ç›®å½•ç»“æ„" class="headerlink" title="3. å»ºç«‹Webåº”ç”¨ç›®å½•ç»“æ„"></a>3. å»ºç«‹Webåº”ç”¨ç›®å½•ç»“æ„</h1><pre><code>WebApp/WEB-INF/web.xmlWebApp/WEB-INF/classes/MyServlet.class</code></pre><p>ç„¶ååœ¨web.xmlé‡Œé¢é…ç½®Servlet</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee  http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;  version=&quot;4.0&quot;  metadata-complete=&quot;true&quot;&gt;    &lt;description&gt; Servlet Example. &lt;/description&gt;    &lt;display-name&gt; MyServlet Example &lt;/display-name&gt;    &lt;request-character-encoding&gt;UTF-8&lt;/request-character-encoding&gt;    &lt;servlet&gt;      &lt;servlet-name&gt;myServlet&lt;/servlet-name&gt;      &lt;servlet-class&gt;MyServlet&lt;/servlet-class&gt;    &lt;/servlet&gt;    &lt;servlet-mapping&gt;      &lt;servlet-name&gt;myServlet&lt;/servlet-name&gt;      &lt;url-pattern&gt;/myservlet&lt;/url-pattern&gt;    &lt;/servlet-mapping&gt;&lt;/web-app&gt;</code></pre><h1 id="4-è¿è¡Œ"><a href="#4-è¿è¡Œ" class="headerlink" title="4. è¿è¡Œ"></a>4. è¿è¡Œ</h1><p>å°†WebAppæ”¾åˆ°Tomcatçš„å®‰è£…ç›®å½•ä¸‹çš„webappsç›®å½•é‡Œ</p><p>åœ¨binç›®å½•ä¸‹ï¼Œå¯åŠ¨è„šæœ¬ </p><ul><li>mac/ linux<ul><li>startup.sh</li></ul></li><li>windows<ul><li>startup.bat</li></ul></li></ul><p>è€Œåæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨çœ‹åˆ°ç»“æœ</p><pre><code>http://localhost:8080/WebApp/myServlet</code></pre><h1 id="5-æŸ¥çœ‹æ—¥å¿—"><a href="#5-æŸ¥çœ‹æ—¥å¿—" class="headerlink" title="5. æŸ¥çœ‹æ—¥å¿—"></a>5. æŸ¥çœ‹æ—¥å¿—</h1><ul><li>catalina.***.log<ul><li>ä¸»è¦è®°å½•Tomcatçš„å¯åŠ¨è¿‡ç¨‹</li><li>å¯ä»¥çœ‹åˆ°å¯åŠ¨çš„JVMå‚æ•°ä»¥åŠæ“ä½œç³»ç»Ÿç­‰æ—¥å¿—ä¿¡æ¯</li></ul></li><li>catalina.out<ul><li>æ˜¯Tomcatçš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯</li></ul></li><li>localhost.***.log<ul><li>ä¸»è¦è®°å½•Webåº”ç”¨åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­é‡åˆ°çš„æœªå¤„ç†çš„å¼‚å¸¸ï¼Œä¼šè¢«Tomcatæ•è·è€Œè¾“å‡ºåˆ°è¿™ä¸ªæ—¥å¿—æ–‡ä»¶å½“ä¸­</li></ul></li><li>localhost_access_log.***.txt<ul><li>å­˜æ”¾è®¿é—®Tomcat è¯·æ±‚çš„æ—¥å¿—</li><li>åŒ…æ‹¬<ul><li>IPåœ°å€</li><li>è¯·æ±‚è·¯å¾„</li><li>è¯·æ±‚æ—¶é—´</li><li>è¯·æ±‚åè®®</li><li>çŠ¶æ€ç </li></ul></li></ul></li><li>manager.<strong><em>.log/host-manager.</em></strong>.log<ul><li>å­˜æ”¾Tomcatè‡ªå¸¦çš„Manageré¡¹ç›®çš„æ—¥å¿—ä¿¡æ¯ </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tomcat - æ•´ä½“æ¶æ„</title>
      <link href="/Tomcat-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/"/>
      <url>/Tomcat-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ•´ä½“æ¶æ„"><a href="#1-æ•´ä½“æ¶æ„" class="headerlink" title="1. æ•´ä½“æ¶æ„"></a>1. æ•´ä½“æ¶æ„</h1><ul><li>Tomcatçš„æ ¸å¿ƒåŠŸèƒ½<ul><li>å¤„ç†Socketè¿æ¥ï¼Œè´Ÿè´£ç½‘ç»œå­—èŠ‚æµä¸Requestï¼ŒResponseå¯¹è±¡çš„è½¬åŒ–</li><li>åŠ è½½å’Œç®¡ç†Servletï¼Œä»¥åŠå…·ä½“çš„å¤„ç†Requestè¯·æ±‚</li></ul></li><li>socket <ul><li>è¿æ¥å™¨ Connector </li><li>æ”¯æŒå¤§é‡ä¸åŒçš„I/Oæ¨¡å‹<ul><li>NIO<ul><li>éé˜»å¡I/O</li></ul></li><li>NIO.2<ul><li>å¼‚æ­¥I/O </li></ul></li><li>APR<ul><li>é‡‡ç”¨Apacheå¯ç§»æ¤è¿è¡Œåº“æ•°æ˜¾ </li></ul></li></ul></li><li>æ”¯æŒä¸åŒçš„åº”ç”¨å±‚åè®®<ul><li>HTTP/1.1</li><li>AJP<ul><li>ç”¨äºå’ŒWebæœåŠ¡å™¨é›†æˆ </li></ul></li><li>HTTP/2</li></ul></li></ul></li><li>servletç®¡ç†<ul><li>å®¹å™¨ Container  <ul><li>ä¸€ä¸ªå®¹å™¨å¯èƒ½å¯¹æ¥å¤šä¸ªè¿æ¥å™¨  â€“ ä¸ºäº†å®ç°å¯¹äºå¤šç§I/Oå’Œåº”ç”¨å±‚åè®®çš„æ”¯æŒ</li><li>è¿æ¥å™¨å’Œå®¹å™¨çš„ç»„åˆå«åšServiceç»„ä»¶</li><li>Tomcatå†…å¯èƒ½æœ‰å¤šä¸ªServiceï¼Œé€šè¿‡è¿™ç§é…ç½®ï¼Œå¯ä»¥å®ç°é€šè¿‡ä¸åŒçš„ç«¯å£å·æ¥è®¿é—®åŒä¸€ä¸ªæœºå™¨ä¸Šéƒ¨ç½²çš„ä¸åŒåº”ç”¨ã€‚</li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2020/02/02/DQSx67LbjXzVANW.jpg" alt="fig1.jpg"></p><h1 id="2-è¿æ¥å™¨"><a href="#2-è¿æ¥å™¨" class="headerlink" title="2. è¿æ¥å™¨"></a>2. è¿æ¥å™¨</h1><p>è¿æ¥å™¨å¯¹Servletå®¹å™¨å±è”½äº†åè®®ä»¥åŠI/Oæ¨¡å‹ï¼Œæ— è®ºæ˜¯ä½•ç§åè®®ï¼Œåœ¨å®¹å™¨ä¸­è·å–çš„éƒ½æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ServletRequestå¯¹è±¡ã€‚</p><p>ç»†åŒ–è¿æ¥å™¨çš„åŠŸèƒ½ï¼š</p><ul><li>ç›‘å¬ç½‘ç»œç«¯å£</li><li>æ¥æ”¶ç½‘ç»œè¿æ¥è¯·æ±‚</li><li>è¯»å–ç½‘ç»œè¯·æ±‚å­—èŠ‚æµ</li><li>æ ¹æ®åº”ç”¨å±‚åè®®ï¼Œè§£æå­—èŠ‚æµï¼Œç”Ÿæˆç»Ÿä¸€çš„Tomcat Requestå¯¹è±¡</li><li>å°†Tomcat Requestå¯¹è±¡è½¬æˆæ ‡å‡†çš„ServletRequest</li><li>è°ƒç”¨Servletå®¹å™¨ï¼Œå¾—åˆ°ServletResponse</li><li>å°†ServletResponseè½¬æˆTomcat Responseå¯¹è±¡</li><li>å°†Tomcat Responseè½¬æˆç½‘ç»œå­—èŠ‚æµ</li><li>å°†ç›¸åº”å­—èŠ‚æµå†™å›æµè§ˆå™¨</li></ul><p>ä¸ºäº†å®ç°ä¸€ä¸ªé«˜å†…èšä½è€¦åˆçš„ç³»ç»Ÿï¼Œè¿æ¥å™¨éœ€è¦åœ¨å‡ ä¸ªæ–¹é¢åšé’ˆå¯¹æ€§çš„è®¾ç½®</p><ul><li>ç½‘ç»œé€šä¿¡</li><li>åº”ç”¨å±‚åè®®è§£æ</li><li>Tomcat Request/ Response ä¸ ServletRequest/ Responseçš„è½¬åŒ–</li></ul><p><img src="https://i.loli.net/2020/02/02/9aqpn2lF5UZs184.jpg" alt="fig2.jpg"></p><h2 id="2-1-Endpoint-part-of-protocal-handler"><a href="#2-1-Endpoint-part-of-protocal-handler" class="headerlink" title="2.1 Endpoint (part of protocal handler)"></a>2.1 Endpoint (part of protocal handler)</h2><p>ProtocalHandleræ˜¯ç”¨æ¥å¤„ç†ç½‘ç»œè¿æ¥å’Œåº”ç”¨å±‚åè®®çš„</p><p>æä¾›å­—èŠ‚æµç»™Processor</p><p>Endpointæ˜¯é€šä¿¡ç«¯ç‚¹ï¼Œå³é€šä¿¡ç›‘å¬çš„æ¥å£ï¼Œæ˜¯å…·ä½“çš„Socketæ¥æ”¶å’Œå‘é€çš„å¤„ç†å™¨ï¼Œæ˜¯å¯¹ä¼ è¾“å±‚çš„æŠ½è±¡ï¼Œå› æ­¤Endpointæ˜¯ç”¨æ¥å®ç°TCP/IPåè®®çš„ã€‚</p><p>Endpointæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¯¹åº”çš„æŠ½è±¡å®ç°ç±»æ˜¯AbstractEndpoint</p><ul><li>AbstractEndpoint <ul><li>Acceptor <ul><li>ç”¨äºç›‘å¬Socketè¿æ¥è¯·æ±‚ </li></ul></li><li>SocketProcessor<ul><li>ç”¨äºå¤„ç†æ¥æ”¶åˆ°çš„Socketè¯·æ±‚ï¼Œå®ç°Runnableæ¥å£ï¼Œåœ¨runæ–¹æ³•é‡Œè°ƒç”¨åè®®å¤„ç†ç»„ä»¶Processorè¿›è¡Œå¤„ç† </li></ul></li></ul></li></ul><h2 id="2-2-Processor-part-of-protocal-handler"><a href="#2-2-Processor-part-of-protocal-handler" class="headerlink" title="2.2 Processor (part of protocal handler)"></a>2.2 Processor (part of protocal handler)</h2><p>æä¾›Tomcat Requestå¯¹è±¡ç»™Adapterï¼Œåœ¨è¿™é‡ŒProcessoræ¥æ”¶æ¥è‡ªEndpointçš„Socketï¼Œè¯»å–å­—èŠ‚æµè§£ææˆTomcat Requestå’ŒResponseå¯¹è±¡ï¼Œå¹¶é€šè¿‡Adapterå°†å…¶æäº¤åˆ°å®¹å™¨å¤„ç†ï¼ŒProcessoræ˜¯å¯¹åº”ç”¨å±‚åè®®çš„æŠ½è±¡ã€‚</p><p>ä¸€ä¸ªå®šä¹‰äº†è¯·æ±‚çš„å¤„ç†æ–¹æ³•çš„æ¥å£ï¼Œå…¶æŠ½è±¡å®ç°ç±»AbstractProcessorå¯¹åè®®å…±æœ‰çš„å±æ€§è¿›è¡Œå°è£…ï¼Œæ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡Œå®ç°ã€‚è¿™äº›å…·ä½“çš„å®ç°æœ‰AjpProcessor  Http11Processorç­‰ï¼Œå…·ä½“çš„å®ç°ç±»å®ç°äº†ç‰¹å®šåè®®çš„è§£ææ–¹æ³•å’Œè¯·æ±‚å¤„ç†æ–¹å¼ã€‚</p><p><img src="https://i.loli.net/2020/02/02/QuqNCEvhrJInGSL.jpg" alt="fig3.jpg"></p><p>Endpointæ¥æ”¶Socketè¿æ¥ï¼Œç”Ÿæˆä¸€ä¸ªSocketProcessorä»»åŠ¡ï¼Œæäº¤åˆ°çº¿ç¨‹æ± å»å¤„ç†ï¼ŒSocketProcessorçš„runæ–¹æ³•ä¼šè°ƒç”¨Processorç»„ä»¶å»è§£æåº”ç”¨å±‚åè®®ï¼ŒProcessoré€šè¿‡è§£æç”Ÿæˆrequestå¯¹è±¡ä¹‹åï¼Œä¼šè°ƒç”¨Adapterçš„Serviceæ–¹æ³•ã€‚</p><h2 id="2-3-Adapter"><a href="#2-3-Adapter" class="headerlink" title="2.3 Adapter"></a>2.3 Adapter</h2><p>ç”±äºåè®®ä¸åŒï¼Œå®¢æˆ·ç«¯å‘è¿‡æ¥çš„è¯·æ±‚ä¿¡æ¯ä¹Ÿä¸å°½ç›¸åŒï¼ŒTomcatå®šä¹‰äº†è‡ªå·±çš„Requestç±»æ¥å­˜æ”¾è¿™äº›è¯·æ±‚ä¿¡æ¯ã€‚ProtocolHandleræ¥å£è´Ÿè´£è§£æè¯·æ±‚å¹¶ç”ŸæˆTomcatRequestç±»ã€‚å°†ä¼ å…¥çš„Tomcat Requestå¯¹è±¡è½¬æˆServletRequestï¼Œå†è°ƒç”¨å®¹å™¨çš„serviceæ–¹æ³•ã€‚</p><p>Adapterè´Ÿè´£æä¾›ServletRequestå¯¹è±¡ç»™å®¹å™¨</p><h1 id="3-å®¹å™¨"><a href="#3-å®¹å™¨" class="headerlink" title="3. å®¹å™¨"></a>3. å®¹å™¨</h1><p>Tomcatå½“ä¸­ï¼Œå®¹å™¨æ˜¯ç”¨æ¥è£…è½½Servletçš„ã€‚</p><h2 id="3-1-å®¹å™¨çš„å±‚æ¬¡ç»“æ„"><a href="#3-1-å®¹å™¨çš„å±‚æ¬¡ç»“æ„" class="headerlink" title="3.1 å®¹å™¨çš„å±‚æ¬¡ç»“æ„"></a>3.1 å®¹å™¨çš„å±‚æ¬¡ç»“æ„</h2><p>Tomcatè®¾è®¡äº†4ç§å®¹å™¨ï¼Œåˆ†åˆ«æ˜¯Engine, Host, Context, Wrapperã€‚é€šè¿‡è¿™ç§åˆ†å±‚çš„æ¶æ„æ¥å¢åŠ Servletå®¹å™¨çš„çµæ´»æ€§ã€‚</p><p><img src="https://i.loli.net/2020/02/02/nopbJmwXEx2KM5a.jpg" alt="fig4.jpg"></p><ul><li>Engine<ul><li>è¡¨ç¤ºå¼•æ“</li><li>ç”¨æ¥ç®¡ç†å¤šä¸ªè™šæ‹Ÿç«™ç‚¹</li><li>ä¸€ä¸ªServiceæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªEngine</li></ul></li><li>Host<ul><li>è™šæ‹Ÿä¸»æœº - ç«™ç‚¹</li><li>ç»™Tomcaté…ç½®å¤šä¸ªè™šæ‹Ÿä¸»æœºåœ°å€</li><li>ä¸€ä¸ªè™šæ‹Ÿä¸»æœºå•Šä¸‹åˆå¯ä»¥éƒ¨ç½²å¤šä¸ªWebåº”ç”¨ç¨‹åº</li></ul></li><li>Context <ul><li>è¡¨ç¤ºä¸€ä¸ªWebåº”ç”¨ç¨‹åº </li><li>ä¸€ä¸ªContext(Webåº”ç”¨ç¨‹åº)é‡Œå¯ä»¥æœ‰å¤šä¸ªServlet</li></ul></li><li>Wrapper <ul><li>è¡¨ç¤ºä¸€ä¸ªServlet </li></ul></li></ul><p>Tomcatçš„server.xmlé…ç½®æ–‡ä»¶<br><img src="https://i.loli.net/2020/02/02/ED2SiGWfKzevJ7c.jpg" alt="fig5.jpg"></p><p>Tomcaté€šè¿‡ç»„åˆæ¨¡å¼æ¥ç®¡ç†è¿™äº›å®¹å™¨ï¼Œæ‰€æœ‰å®¹å™¨ç»„ä»¶éƒ½ä¼šå®ç°Containeræ¥å£ï¼Œå› æ­¤ç»„åˆæ¨¡å¼å¯ä»¥ä½¿å¾—ç”¨æˆ·å¯¹ä½†å®¹å™¨å¯¹è±¡å’Œç»„åˆå®¹å™¨å¯¹è±¡çš„ä½¿ç”¨å…·æœ‰é«˜åº¦ä¸€è‡´æ€§ã€‚</p><pre><code>public interface Container extends Lifecycle {    public void setName(String name);    public Container getParent();    public void setParent(Container container);    public void addChild(Container child);    public void removeChild(Container child);    public Container findChild(String name);}</code></pre><h2 id="3-2-è¯·æ±‚æ˜¯å¦‚ä½•å®šä½Servletçš„-Mapper"><a href="#3-2-è¯·æ±‚æ˜¯å¦‚ä½•å®šä½Servletçš„-Mapper" class="headerlink" title="3.2 è¯·æ±‚æ˜¯å¦‚ä½•å®šä½Servletçš„ - Mapper"></a>3.2 è¯·æ±‚æ˜¯å¦‚ä½•å®šä½Servletçš„ - Mapper</h2><p>Tomcatä½¿ç”¨Mapperç»„ä»¶æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚</p><ul><li>MapperåŠŸèƒ½<ul><li>å°†ç”¨æˆ·è¯·æ±‚çš„URLå®šä½åˆ°ä¸€ä¸ªServlet</li></ul></li><li>Mapperå·¥ä½œåŸç†<ul><li>Mapperç»„ä»¶ä¿å­˜webåº”ç”¨çš„é…ç½®ä¿¡æ¯ - å®¹å™¨ç»„ä»¶ä¸è®¿é—®è·¯å¾„çš„æ˜ å°„å…³ç³»<ul><li>hostå®¹å™¨é‡Œé…ç½®çš„åŸŸå</li><li>Contextå®¹å™¨é‡Œçš„Webåº”ç”¨è·¯å¾„</li><li>Wrapperå®¹å™¨é‡ŒServletæ˜ å°„çš„è·¯å¾„</li></ul></li></ul></li><li>Mapperå·¥ä½œè¿‡ç¨‹<ul><li>è¯·æ±‚åˆ°æ¥</li><li>Mapperç»„ä»¶è§£æè¯·æ±‚URLé‡Œçš„åŸŸåå’Œè·¯å¾„</li><li>åˆ°è‡ªå·±ä¿å­˜çš„Mapé‡Œé¢å»æŸ¥æ‰¾</li><li>å®šä½åˆ°ä¸€ä¸ªServlet</li><li>ä¸€ä¸ªURLæœ€ç»ˆåªä¼šå®šä½åˆ°ä¸€ä¸ªWrapperå®¹å™¨ï¼Œå³ä¸€ä¸ªServlet</li></ul></li></ul><ul><li>E.g<ul><li>èƒŒæ™¯<ul><li>ç½‘è´­ç³»ç»Ÿ<ul><li>åå°ç®¡ç†ç³»ç»Ÿ</li><li>åœ¨çº¿è´­ç‰©ç³»ç»Ÿ</li></ul></li><li>ä¸¤ä¸ªç³»ç»Ÿåœ¨åŒä¸€ä¸ªTomcatä¸Šï¼Œä¸ºäº†éš”ç¦»å…¶è®¿é—®åŸŸåï¼Œé…ç½®è™šæ‹ŸåŸŸå</li></ul></li><li>Tomcatçš„åŠŸèƒ½<ul><li>åˆ›å»ºä¸€ä¸ªServiceç»„ä»¶å’Œä¸€ä¸ªEngineå®¹å™¨ç»„ä»¶</li><li>åœ¨Engineå®¹å™¨ä¸‹åˆ›å»ºä¸¤ä¸ªHostå­å®¹å™¨</li><li>æ¯ä¸ªHostä¸‹åˆ›å»ºå¤šä¸ªContextå­å®¹å™¨</li></ul></li></ul></li></ul><p><img src="https://i.loli.net/2020/02/02/yo2IVCkzvsY5gjw.jpg" alt="fig6.jpg"></p><p>æ¥ç€ä¸Šé¢çš„ä¾‹å­ï¼Œå½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªURLï¼Œæ¯”å¦‚ <code>user.shopping.com:8080/order/buy</code>ï¼ŒTomcatå°†è¿™ä¸ªURLå®šä½åˆ°ä¸€ä¸ªServletçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>æ ¹æ®åè®®å’Œç«¯å£å·é€‰å®šServiceå’ŒEngine<ul><li>HTTPæˆ–è€…AJPè¿æ¥å™¨éƒ½æ˜¯ç”±è‡ªå·±çš„é»˜è®¤ç«¯å£å·çš„</li></ul></li><li>æ ¹æ®åŸŸåé€‰å®šHost<ul><li>Mapperç»„ä»¶é€šè¿‡URLä¸­çš„åŸŸåå»æŸ¥æ‰¾å“åº”çš„Hostå®¹å™¨</li></ul></li><li>æ ¹æ®URLè·¯å¾„æ‰¾åˆ°Contextç»„ä»¶<ul><li>æ ¹æ®URLçš„è·¯å¾„æ¥åŒ¹é…ç›¸åº”çš„Webåº”ç”¨çš„è·¯å¾„</li></ul></li><li>æ ¹æ®URLè·¯å¾„æ‰¾åˆ°Wrapper - Servlet<ul><li>Contextç¡®å®šåï¼ŒMapperå†æ ¹æ®web.xmlä¸­é…ç½®çš„Servletæ˜ å°„è·¯å¾„æ¥æ‰¾åˆ°å…·ä½“çš„Wrapperå’ŒServlet</li></ul></li></ul><h2 id="3-3-Pipeline-valve"><a href="#3-3-Pipeline-valve" class="headerlink" title="3.3 Pipeline - valve"></a>3.3 Pipeline - valve</h2><p>è¿™æ•´ä¸ªå±‚å±‚é€’è¿›çš„è°ƒç”¨è¿‡ç¨‹ä½¿ç”¨çš„æ˜¯Pipeline-Valueç®¡é“ã€‚</p><ul><li>Pipeline-valve<ul><li>è´£ä»»é“¾æ¨¡å¼</li><li>åœ¨è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šå¤„ç†è€…ä¾æ¬¡å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œæ¯ä¸ªå¤„ç†ç€è´Ÿè´£åšè‡ªå·±çš„ç›¸åº”çš„å¤„ç†ï¼Œç„¶åä¸€ä¸ªä¸ªä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†è€…</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/02/IMyaJTVZlbgmWEc.jpg" alt="fig7.jpg"></p><pre><code>public interface Valve {  public Valve getNext();  public void setNext(Valve valve);  public void invoke(Request request, Response response)}public interface Pipeline extends Container {  public void addValve(Valve valve);  public Valve getBasic();  public void setBasic(Valve valve);  public Valve getFirst();}</code></pre><p>Pipelinä¸­ç»´æŠ¤äº†Valveçš„é“¾è¡¨ï¼Œæ•´ä¸ªè°ƒç”¨é“¾çš„æ‰§è¡Œæ˜¯è¢«valveæ¥å®Œæˆçš„ï¼Œvalveå®Œæˆè‡ªå·±çš„å¤„ç†ä»¥åï¼Œå°±ä¼šè°ƒç”¨getNext.invokeæ¥è§¦å‘ä¸‹ä¸€ä¸ªValveè°ƒç”¨</p><p>ä¸åŒçš„å®¹å™¨çš„pipelineä¹‹é—´çš„è§¦å‘ï¼Œä¸Šä¸€å±‚çš„æœ€åä¸€ä¸ªvalveè´Ÿè´£è°ƒç”¨ä¸‹ä¸€å±‚çš„ç¬¬ä¸€ä¸ªvalveï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š</p><p>Wrapperå®¹å™¨çš„æœ€åä¸€ä¸ªValveä¼šåˆ›å»ºä¸€ä¸ªFilteré“¾ï¼Œå¹¶è°ƒç”¨doFilteræ–¹æ³•ï¼Œæœ€ç»ˆä¼šè°ƒç”¨Servletçš„serviceæ–¹æ³•ã€‚</p><ul><li>Valveå’ŒFilter<ul><li>valveæ˜¯tomcatçš„ç§æœ‰æœºåˆ¶</li><li>Filteræ˜¯åœ¨servletçº§åˆ«çš„ï¼Œæ˜¯å…¬æœ‰æ ‡å‡†</li><li>valveå·¥ä½œåœ¨webå®¹å™¨çº§åˆ«ï¼Œæ‹¦æˆªæ‰€æœ‰åº”ç”¨çš„è¯·æ±‚</li><li>Servlet Filterå·¥ä½œåœ¨åº”ç”¨çº§åˆ«ï¼Œåªèƒ½æ‹¦æˆªæŸä¸ªWebåº”ç”¨çš„æ‰€æœ‰è¯·æ±‚ã€‚</li></ul></li></ul><h1 id="4-Tomcatä¸€é”®å¯åœ"><a href="#4-Tomcatä¸€é”®å¯åœ" class="headerlink" title="4. Tomcatä¸€é”®å¯åœ"></a>4. Tomcatä¸€é”®å¯åœ</h1><p>é¦–å…ˆå¤ä¹ ä¸‹Tomcatå„ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»ã€‚</p><p><img src="https://i.loli.net/2020/02/02/qaU4DIjHgezVodv.png" alt="fig8.png"></p><ul><li>ä¸ºäº†ä½¿å¾—ä¸€ä¸ªç³»ç»Ÿèƒ½å¤Ÿå¯¹å¤–æä¾›æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºã€ç»„è£…å¹¶å¯åŠ¨è¿™äº›ç»„ä»¶</li><li>åœ¨æœåŠ¡åœæ­¢çš„æ—¶å€™ï¼Œè¿˜éœ€è¦é‡Šæ”¾èµ„æºï¼Œé”€æ¯è¿™äº›ç»„ä»¶</li><li>Tomcatéœ€è¦åŠ¨æ€åœ°ç®¡ç†è¿™äº›ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</li></ul><ul><li>å¤§ç»„ä»¶ç®¡ç†å°ç»„ä»¶<ul><li>éœ€è¦å…ˆå¯åŠ¨å­ç»„ä»¶ï¼Œå†å¯åŠ¨çˆ¶ç»„ä»¶ï¼Œå­ç»„ä»¶éœ€è¦è¢«æ³¨å…¥åˆ°çˆ¶ç»„ä»¶å½“ä¸­å»</li></ul></li><li>è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±å¤–å±‚ç»„ä»¶æ¥é©±åŠ¨çš„<ul><li>å…ˆåˆ›å»ºå†…å±‚ç»„ä»¶ï¼Œå†åˆ›å»ºå¤–å±‚ç»„ä»¶ï¼Œå†…å±‚ç»„ä»¶éœ€è¦è¢«æ³¨å…¥åˆ°å¤–å±‚ç»„ä»¶å½“ä¸­</li></ul></li></ul><h2 id="4-1-LifeCycleæ¥å£"><a href="#4-1-LifeCycleæ¥å£" class="headerlink" title="4.1 LifeCycleæ¥å£"></a>4.1 LifeCycleæ¥å£</h2><ul><li>ä¸å˜çš„ç‚¹<ul><li>æ¯ä¸ªç»„ä»¶éƒ½è¦ç»å†åˆ›å»ºã€åˆå§‹åŒ–ã€å¯åŠ¨è¿™å‡ ä¸ªè¿‡ç¨‹</li><li>åˆ›å»ºLifecycleæ¥å£<ul><li>init</li><li>start </li><li>stop</li><li>destroy</li></ul></li></ul></li><li>å˜åŒ–çš„ç‚¹<ul><li>æ¯ä¸ªå…·ä½“ç»„ä»¶çš„åˆå§‹åŒ–æ–¹æ³• </li><li>addLifecycleListener</li><li>removeLifecycleListner</li></ul></li></ul><p><img src="https://i.loli.net/2020/02/02/hBfJx9GELY1NWgq.png" alt="fig9.png"></p><ul><li>å°†å…¬æœ‰é€»è¾‘æŠ½è±¡å‡ºæ¥ï¼Œæ”¾åˆ°æŠ½è±¡ç±»å½“ä¸­ï¼Œæ‰€ä»¥UMLå›¾å°±å˜æˆäº†å›¾10çš„æ ·å­</li></ul><p><img src="https://i.loli.net/2020/02/02/vMpFBLw6mrQASa5.png" alt="fig10.png"></p><p>åŸºç±»çš„å…·ä½“å®ç°å¦‚ä¸‹: </p><pre><code>@Overridepublic final synchronized void init() throws LifecycleException {    //1. çŠ¶æ€æ£€æŸ¥    if (!state.equals(LifecycleState.NEW)) {        invalidTransition(Lifecycle.BEFORE_INIT_EVENT);    }    try {        //2. è§¦å‘ INITIALIZING äº‹ä»¶çš„ç›‘å¬å™¨        setStateInternal(LifecycleState.INITIALIZING, null, false);        //3. è°ƒç”¨å…·ä½“å­ç±»çš„åˆå§‹åŒ–æ–¹æ³•        initInternal();        //4. è§¦å‘ INITIALIZED äº‹ä»¶çš„ç›‘å¬å™¨        setStateInternal(LifecycleState.INITIALIZED, null, false);    } catch (Throwable t) {      ...    }}</code></pre><h2 id="4-2-ç”Ÿå‘½å‘¨æœŸç®¡ç†æ€»ä½“ç±»å›¾"><a href="#4-2-ç”Ÿå‘½å‘¨æœŸç®¡ç†æ€»ä½“ç±»å›¾" class="headerlink" title="4.2 ç”Ÿå‘½å‘¨æœŸç®¡ç†æ€»ä½“ç±»å›¾"></a>4.2 ç”Ÿå‘½å‘¨æœŸç®¡ç†æ€»ä½“ç±»å›¾</h2><p><img src="https://i.loli.net/2020/02/02/4r7yVeiPqAzhYFI.png" alt="fig11.png"></p><h1 id="5-Tomcatè¿è¡Œè¿‡ç¨‹"><a href="#5-Tomcatè¿è¡Œè¿‡ç¨‹" class="headerlink" title="5. Tomcatè¿è¡Œè¿‡ç¨‹"></a>5. Tomcatè¿è¡Œè¿‡ç¨‹</h1><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡Tomcatçš„/binç›®å½•ä¸‹çš„è„šæœ¬startup.shæ¥å¯åŠ¨Tomcatï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹: </p><p><img src="https://i.loli.net/2020/02/02/Par89z2MyQj7KYH.png" alt="fig12.png"></p><ul><li>å¯åŠ¨JVMï¼Œè¿è¡ŒTomcatå¯åŠ¨ç±»Bootstrap</li><li>Bootstrapç±»ä¼šåˆå§‹åŒ–Tomcatçš„ç±»åŠ è½½å™¨ï¼Œå¹¶ä¸”åˆ›å»ºCatalina</li><li>Catalinaæ˜¯ä¸€ä¸ªå¯åŠ¨ç±»ï¼Œé€šè¿‡è§£æserver.xmlï¼Œä¼šåˆ›å»ºç›¸åº”çš„ç»„ä»¶ï¼Œå¹¶è°ƒç”¨Serverçš„startæ–¹æ³•</li><li>serverç»„ä»¶è¢«ç”¨æ¥ç®¡ç†Serviceç»„ä»¶ï¼Œä¼šè´Ÿè´£è°ƒç”¨Serviceçš„startæ–¹æ³•</li><li>Serviceç»„ä»¶è¢«ç”¨æ¥ç®¡ç†è¿æ¥å™¨å’Œé¡¶å±‚å®¹å™¨Engineï¼Œå› æ­¤å…¶ä¼šè°ƒç”¨è¿æ¥å™¨å’ŒEngineçš„startæ–¹æ³•</li></ul><h2 id="5-1-Catalina"><a href="#5-1-Catalina" class="headerlink" title="5.1 Catalina"></a>5.1 Catalina</h2><p>ä¸»è¦ä»»åŠ¡æ˜¯åˆ›å»ºServerï¼Œé€šè¿‡è§£æserver.xmlæ–‡ä»¶ï¼Œå°†server.xmlé‡Œé…ç½®çš„å„ç§ç»„ä»¶ä¸€ä¸€åˆ›å»ºå‡ºæ¥ï¼Œæ¥ç€è°ƒç”¨Serverç»„ä»¶çš„initæ–¹æ³•å’Œstartæ–¹æ³•ï¼Œä»¥æ­¤å¯åŠ¨æ•´ä¸ªTomcatã€‚</p><p>Tomcatè¿˜éœ€è¦å¤„ç†å„ç§å¼‚å¸¸æƒ…å†µï¼Œæ¯”å¦‚å¼ºåˆ¶å…³é—­çš„å¤„ç†ï¼ŒCatalinaåœ¨JVMå½“ä¸­æ³¨å†Œäº†ä¸€ä¸ªå…³é—­é’©å­ã€‚</p><pre><code>public void start() {    //1. å¦‚æœæŒæœ‰çš„ Server å®ä¾‹ä¸ºç©ºï¼Œå°±è§£æ server.xml åˆ›å»ºå‡ºæ¥    if (getServer() == null) {        load();    }    //2. å¦‚æœåˆ›å»ºå¤±è´¥ï¼ŒæŠ¥é”™é€€å‡º    if (getServer() == null) {        log.fatal(sm.getString(&quot;catalina.noServer&quot;));        return;    }    //3. å¯åŠ¨ Server    try {        getServer().start();    } catch (LifecycleException e) {        return;    }    // åˆ›å»ºå¹¶æ³¨å†Œå…³é—­é’©å­    if (useShutdownHook) {        if (shutdownHook == null) {            shutdownHook = new CatalinaShutdownHook();        }        Runtime.getRuntime().addShutdownHook(shutdownHook);    }    // ç”¨ await æ–¹æ³•ç›‘å¬åœæ­¢è¯·æ±‚    if (await) {        await();        stop();    }}// catalinaçš„å…³é—­é’©å­æ‰§è¡Œäº†Serverçš„stopæ–¹æ³•ï¼Œä¼šé‡Šæ”¾å’Œæ¸…ç†æ‰€æœ‰çš„èµ„æºã€‚protected class CatalinaShutdownHook extends Thread {    @Override    public void run() {        try {            if (getServer() != null) {                Catalina.this.stop();            }        } catch (Throwable ex) {           ...        }    }}</code></pre><h2 id="5-2-Serverç»„ä»¶"><a href="#5-2-Serverç»„ä»¶" class="headerlink" title="5.2 Serverç»„ä»¶"></a>5.2 Serverç»„ä»¶</h2><p>å…¶å…·ä½“å®ç°ç±»æ˜¯StandardServerï¼Œç»§æ‰¿äº†LifecycleBaseï¼Œç”Ÿå‘½å‘¨æœŸè¢«ç»Ÿä¸€ç®¡ç†ï¼Œå­ç»„ä»¶æ˜¯Serviceï¼Œå› æ­¤è¿˜éœ€è¦ç®¡ç†Serviceçš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨å¯åŠ¨æ—¶è°ƒç”¨Serviceç»„ä»¶çš„å¯åŠ¨æ–¹æ³•ï¼Œåœ¨åœæ­¢æ—¶è°ƒç”¨å…¶åœæ­¢æ–¹æ³•</p><p>Serverç»´æŠ¤å¤šä¸ªServiceç»„ä»¶ï¼Œä»¥æ•°ç»„æ¥ä¿å­˜</p><pre><code>@Overridepublic void addService(Service service) {    service.setServer(this);    synchronized (servicesLock) {        // åˆ›å»ºä¸€ä¸ªé•¿åº¦ +1 çš„æ–°æ•°ç»„        Service results[] = new Service[services.length + 1];        // å°†è€çš„æ•°æ®å¤åˆ¶è¿‡å»        System.arraycopy(services, 0, results, 0, services.length);        results[services.length] = service;        services = results;        // å¯åŠ¨ Service ç»„ä»¶        if (getState().isAvailable()) {            try {                service.start();            } catch (LifecycleException e) {                // Ignore            }        }        // è§¦å‘ç›‘å¬äº‹ä»¶        support.firePropertyChange(&quot;service&quot;, null, service);    }}</code></pre><p>èŠ‚çœå†…å­˜ç©ºé—´çš„ä¸€ç§æ–¹å¼</p><p>Serverç»„ä»¶ä¼šå¯åŠ¨ä¸€ä¸ªSocketæ¥ç›‘å¬åœæ­¢ç«¯å£ï¼Œåœ¨Catalinaå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨Serverçš„awaitæ–¹æ³•ï¼Œè¿™ä¸ªåœ°æ–¹å®é™…ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªSocketæ¥ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå¹¶åœ¨è¿™ä¸ªæ­»å¾ªç¯é‡Œæ¥æ”¶Socketçš„è¿æ¥è¯·æ±‚ï¼Œå¦‚æœæœ‰æ–°çš„è¿æ¥åˆ°æ¥å°±å»ºç«‹è¿æ¥ï¼Œç„¶åä»Socketä¸­è¯»å–æ•°æ®ï¼›å¦‚æœè¯»åˆ°çš„æ•°æ®æ˜¯åœæ­¢å‘½ä»¤SHUTDOWNï¼Œå°±é€€å‡ºå¾ªç¯ï¼Œè¿›å…¥stopæµç¨‹</p><h2 id="5-3-Serviceç»„ä»¶"><a href="#5-3-Serviceç»„ä»¶" class="headerlink" title="5.3 Serviceç»„ä»¶"></a>5.3 Serviceç»„ä»¶</h2><p>å…·ä½“å®ç°ç±»æ˜¯StandardService</p><pre><code>public class StandardService extends LifecycleBase implements Service {    // åå­—    private String name = null;    //Server å®ä¾‹    private Server server = null;    // è¿æ¥å™¨æ•°ç»„    protected Connector connectors[] = new Connector[0];    private final Object connectorsLock = new Object();    // å¯¹åº”çš„ Engine å®¹å™¨    private Engine engine = null;    // æ˜ å°„å™¨åŠå…¶ç›‘å¬å™¨    protected final Mapper mapper = new Mapper();    protected final MapperListener mapperListener = new MapperListener(this);</code></pre><p>MapperListener æ˜¯ä¸ºäº†æ”¯æŒçƒ­éƒ¨ç½²ï¼Œå½“Webåº”ç”¨çš„éƒ¨ç½²å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒMapperä¸­çš„æ˜ å°„ä¿¡æ¯ä¹Ÿè¦è·Ÿç€å˜åŒ–ï¼ŒMapperListeneræ˜¯ä¸€ä¸ªç›‘å¬å™¨ï¼Œå®ƒç›‘å¬å®¹å™¨çš„å˜åŒ–ï¼Œå¹¶å°†ä¿¡æ¯æ›´æ–°åˆ°Mapperå½“ä¸­ã€‚</p><pre><code>protected void startInternal() throws LifecycleException {    //1. è§¦å‘å¯åŠ¨ç›‘å¬å™¨    setState(LifecycleState.STARTING);    //2. å…ˆå¯åŠ¨ Engineï¼ŒEngine ä¼šå¯åŠ¨å®ƒå­å®¹å™¨    if (engine != null) {        synchronized (engine) {            engine.start();        }    }    //3. å†å¯åŠ¨ Mapper ç›‘å¬å™¨    mapperListener.start();    //4. æœ€åå¯åŠ¨è¿æ¥å™¨ï¼Œè¿æ¥å™¨ä¼šå¯åŠ¨å®ƒå­ç»„ä»¶ï¼Œæ¯”å¦‚ Endpoint    synchronized (connectorsLock) {        for (Connector connector: connectors) {            if (connector.getState() != LifecycleState.FAILED) {                connector.start();            }        }    }}</code></pre><h2 id="5-4-Engine"><a href="#5-4-Engine" class="headerlink" title="5.4 Engine"></a>5.4 Engine</h2><pre><code>public class StandardEngine extends ContainerBase implements Engine {}</code></pre><p>Engineå­å®¹å™¨æ˜¯Hostï¼Œå…¶æŒæœ‰ä¸€ä¸ªHostå®¹å™¨æ•°ç»„</p><pre><code>protected final HashMap&lt;String, Container&gt; children = new HashMap&lt;&gt;();</code></pre><p>ContainerBaseç”¨HashMapä¿å­˜äº†å®ƒçš„å­å®¹å™¨ï¼Œå¹¶ä¸”ContainerBaseè¿˜å®ç°äº†å­å®¹å™¨çš„å¢åˆ æ”¹æŸ¥</p><pre><code>for (int i = 0; i &lt; children.length; i++) {   results.add(startStopExecutor.submit(new StartChild(children[i])));}</code></pre><p>Engineé€šè¿‡å°†è¯·æ±‚è½¬å‘ç»™æŸä¸€ä¸ªHostå­å®¹å™¨æ¥å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼ŒEngineçš„åŸºç¡€é˜€å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>final class StandardEngineValve extends ValveBase {    public final void invoke(Request request, Response response)      throws IOException, ServletException {      // æ‹¿åˆ°è¯·æ±‚ä¸­çš„ Host å®¹å™¨      Host host = request.getHost();      if (host == null) {          return;      }      // è°ƒç”¨ Host å®¹å™¨ä¸­çš„ Pipeline ä¸­çš„ç¬¬ä¸€ä¸ª Valve      host.getPipeline().getFirst().invoke(request, response);  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web æµè§ˆå™¨æ˜¯å¦‚ä½•æ„æˆçš„(å››)</title>
      <link href="/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E5%9B%9B/"/>
      <url>/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬ä¸€èµ·ç ”ç©¶äº†æ¸²æŸ“è¿‡ç¨‹ï¼Œå¹¶ä¸”åˆæ­¥æ¥è§¦äº†æ’ç‰ˆå™¨ã€‚æœ¬ç¯‡æ–‡ç« å½“ä¸­ï¼Œæˆ‘ä»¬ä¼šä¸€èµ·ç ”ç©¶ä¸‹æ’ç‰ˆå™¨(Compositor)æ˜¯å¦‚ä½•å®ç°å½“ç”¨æˆ·è¾“å…¥å†…å®¹æ—¶é¡ºæ»‘çš„è¿›è¡Œäº¤äº’çš„ã€‚</p><h1 id="1-ä»æµè§ˆå™¨çš„è§’åº¦çœ‹è¾“å…¥äº‹ä»¶"><a href="#1-ä»æµè§ˆå™¨çš„è§’åº¦çœ‹è¾“å…¥äº‹ä»¶" class="headerlink" title="1. ä»æµè§ˆå™¨çš„è§’åº¦çœ‹è¾“å…¥äº‹ä»¶"></a>1. ä»æµè§ˆå™¨çš„è§’åº¦çœ‹è¾“å…¥äº‹ä»¶</h1><p>å½“ä½ å¬åˆ°è¾“å…¥äº‹ä»¶çš„æ—¶å€™ï¼Œä½ å¯èƒ½åªæƒ³åˆ°åœ¨textboxé‡Œé¢è¾“å…¥æˆ–è€…é¼ æ ‡çš„ç‚¹å‡»ï¼Œä½†æ˜¯ä»æµè§ˆå™¨çš„è§’åº¦æ¥è¯´ï¼Œè¾“å…¥ä»£è¡¨çš„æ˜¯ç”¨æˆ·ä»»ä½•è¡Œä¸ºã€‚æ»šåŠ¨é¼ æ ‡æ»‘è½®æ˜¯ä¸ªè¾“å…¥äº‹ä»¶ï¼Œç¢°è§¦æˆ–è€…å°†é¼ æ ‡æ‚¬åœ¨æŸä¸ªäº‹ä»¶ä¸Šé¢ä¹Ÿæ˜¯ä¸€ä¸ªè¾“å…¥äº‹ä»¶ã€‚</p><p>å½“ç”¨æˆ·çš„æŸç§è¡Œä¸ºå‘ç”Ÿçš„æ—¶å€™ï¼Œæµè§ˆå™¨è¿›ç¨‹æ˜¯ç¬¬ä¸€ä¸ªæ”¶åˆ°è¿™è¡Œä¸ºçš„ã€‚ä½†æ˜¯æµè§ˆå™¨è¿›ç¨‹åªæ˜¯è·å–è¿™ä¸ªåŠ¨ä½œï¼Œè€ŒçœŸæ­£çš„å¤„ç†è¿˜æ˜¯äº¤ç”±æ¸²æŸ“è¿›ç¨‹æ¥åšçš„ã€‚å› æ­¤æµè§ˆå™¨è¿›ç¨‹ä¼šå°†äº‹ä»¶ç±»å‹ä»¥åŠå…¶åæ ‡å‘é€ç»™æ¸²æŸ“è¿›ç¨‹ã€‚æ¸²æŸ“è¿›ç¨‹ä¼šé€šè¿‡æ‰¾åˆ°äº‹ä»¶ç›®æ ‡ï¼Œè¿è¡Œå…¶ç›¸åº”çš„ç›‘å¬è€…æ¥å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚</p><h1 id="2-ç†è§£non-fast-scrollable-åŒºåŸŸ"><a href="#2-ç†è§£non-fast-scrollable-åŒºåŸŸ" class="headerlink" title="2. ç†è§£non-fast scrollable åŒºåŸŸ"></a>2. ç†è§£non-fast scrollable åŒºåŸŸ</h1><p>è¿è¡ŒJavaScriptæ˜¯ä¸»çº¿ç¨‹çš„ä»»åŠ¡ï¼Œå½“å¯¹ä¸€ä¸ªé¡µé¢è¿›è¡Œæ‹¼è£…çš„æ—¶å€™ï¼Œæ‹¼è£…çº¿ç¨‹æ ‡æ³¨é¡µé¢çš„æœ‰äº‹ä»¶ç›‘å¬å™¨çš„éƒ¨åˆ†ï¼Œæ ‡æ³¨ä¸ºNon-fast scrollable region. é€šè¿‡è¿™ç§æ ‡æ³¨æ¥ç¡®ä¿å…šäº‹ä»¶åœ¨è¯¥åŒºåŸŸå‘ç”Ÿçš„æ—¶å€™ï¼Œæ‹¼è£…çº¿ç¨‹å¯ä»¥å°†è¿™ä¸ªæ—¶é—´å‘é€ç»™ä¸»çº¿ç¨‹ã€‚å¦‚æœè¾“å…¥äº‹ä»¶æ¥è‡ªä¸åŒçš„åœ°æ–¹ï¼Œé‚£ä¹ˆæ‹¼è£…çº¿ç¨‹å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„frameæ¥è£…é…è¿™å—åŒºåŸŸï¼Œè€Œä¸ä¼šç­‰å¾…ä¸»çº¿ç¨‹äº†ã€‚</p><h1 id="3-Tips-å…³äºå†™event-handlers"><a href="#3-Tips-å…³äºå†™event-handlers" class="headerlink" title="3. Tips å…³äºå†™event handlers"></a>3. Tips å…³äºå†™event handlers</h1><p>ä¸€èˆ¬å†™event handlingçš„patternæ˜¯äº‹ä»¶ä»£ç†ã€‚å½“äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ï¼Œä½ å¯ä»¥åœ¨æœ€é¡¶å±‚çš„ç»„ä»¶ä¸ŠåŠ ä¸€ä¸ªevent handler ç„¶åæ ¹æ®å…·ä½“çš„äº‹ä»¶ç›®æ ‡æ¥åˆ†é…ä»»åŠ¡ã€‚ä»£ç å¯èƒ½ä¼šåƒä¸‹é¢è¿™æ ·å­: </p><pre><code>document.body.addEventListener(&#39;touchstart&#39;, event =&gt; {    if (event.target === area) {        event.preventDefault();    }});</code></pre><p>ä»å¼€å‘è€…çš„è§’åº¦å½“æ—¶æ˜¯ä¸ªå¥½äº‹æƒ…ï¼Œä½ åªéœ€è¦å†™ä¸€ä¸ªevent handlerå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ä»æµè§ˆå™¨çš„è§’åº¦æ„å‘³ç€æ•´ä¸ªé¡µé¢éƒ½è¢«æ ‡æ³¨æˆnon-fast scrollable regionäº†ï¼Œè¿™æ„å‘³ç€å³ä½¿æ•´ä¸ªé¡µé¢ä¸åœ¨æ„é¡µé¢æŸä¸ªéƒ¨åˆ†çš„è¾“å…¥ï¼Œæ‹¼è£…çº¿ç¨‹ä»ç„¶éœ€è¦å’Œä¸»çº¿ç¨‹æ²Ÿé€šï¼Œå¹¶ä¸”æ¯æ¬¡æœ‰è¾“å…¥çš„æ—¶å€™å°±è¦ç­‰åœ¨é‚£é‡Œã€‚å› æ­¤ï¼Œæ‹¼è£…çº¿ç¨‹çš„è½®è½¬èƒ½åŠ›å°±å¤±æ•ˆäº†ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥åŠ ä¸Š<code>passive:true</code>é€‰é¡¹åœ¨ä½ çš„äº‹ä»¶ç›‘å¬å™¨å½“ä¸­ã€‚è¿™æç¤ºäº†æµè§ˆå™¨ä½ ä»ç„¶æƒ³å¬ä¸»çº¿ç¨‹çš„äº‹ä»¶ï¼Œä½†æ˜¯compositor, å³æ‹¼è£…çº¿ç¨‹å¯ä»¥è‡ªå·±åšè‡ªå·±çš„äº‹æƒ…ï¼Œç„¶åç”Ÿæˆæ–°çš„frame. ä¸€ç¯‡å¾ˆæ£’çš„è®²<code>passive</code>çš„<a href="https://medium.com/@devlucky/about-passive-event-listeners-224ff620e68c" target="_blank" rel="noopener">æ–‡ç« </a>. </p><h1 id="4-æ£€æŸ¥ä¸€ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯cancelable"><a href="#4-æ£€æŸ¥ä¸€ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯cancelable" class="headerlink" title="4. æ£€æŸ¥ä¸€ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯cancelable"></a>4. æ£€æŸ¥ä¸€ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯cancelable</h1><p>å‡å®šä½ ç°åœ¨åœ¨é¡µé¢ä¸­æœ‰ä¸ªboxï¼Œä½ æƒ³é™åˆ¶å…¶æ»šåŠ¨æ–¹å‘ï¼Œåªèƒ½æ¨ªå‘çš„æ»šåŠ¨ã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½¿ç”¨<code>passive:true</code>åªæ˜¯ä¿è¯é¡µé¢çš„æ»šåŠ¨å¯ä»¥è¶³å¤Ÿé¡ºæ»‘ï¼Œä½†æ˜¯ä½ è¿˜éœ€è¦ä½¿ç”¨<code>preventDefault</code>æ¥é™åˆ¶æ»šåŠ¨çš„æ–¹å‘ã€‚</p><pre><code>document.body.addEventListener(&#39;pointermove&#39;, event =&gt; {    if (event.cancelable) {        event.preventDefault(); // block the native scroll        /*        *  do what you want the application to do here        */    }}, {passive: true});</code></pre><h1 id="5-å‡å°‘æ´¾é€åˆ°ä¸»çº¿ç¨‹çš„äº‹ä»¶"><a href="#5-å‡å°‘æ´¾é€åˆ°ä¸»çº¿ç¨‹çš„äº‹ä»¶" class="headerlink" title="5. å‡å°‘æ´¾é€åˆ°ä¸»çº¿ç¨‹çš„äº‹ä»¶"></a>5. å‡å°‘æ´¾é€åˆ°ä¸»çº¿ç¨‹çš„äº‹ä»¶</h1><p>å¯¹äºè¾“å…¥æ¥è¯´ï¼Œä¸€ä¸ªè§¦å±è®¾å¤‡å¯ä»¥æ¯ç§’é’Ÿå‘å¸ƒ60-120æ¬¡ç¢°è§¦äº‹ä»¶ï¼Œè€Œé¼ æ ‡çš„ç§»åŠ¨å¯ä»¥æ¯ç§’è§¦å‘100æ¬¡ã€‚å¦‚æœåƒè§¦ç¢°çš„ç§»åŠ¨è¿™ç§äº‹ä»¶æ¯ç§’å‘ç»™ä¸»çº¿ç¨‹120æ¬¡ï¼Œé‚£ä¹ˆä»–ä¼šå†è§¦å‘å¤§é‡çš„ç‚¹å‡»æµ‹è¯•å’Œjsçš„æ‰§è¡Œï¼Œè¿™æ ·å­ä¼šå¯¼è‡´æ•´ä¸ªé¡µé¢çš„æ›´æ–°éå¸¸æ…¢ã€‚</p><p>Chromeåˆå¹¶äº†è¿ç»­æ—¶é—´ï¼Œæ¯”å¦‚æ»šåŠ¨ï¼Œé¼ æ ‡çš„æ»‘åŠ¨ï¼Œå…‰æ ‡ç§»åŠ¨ç­‰ï¼Œç„¶åå»¶è¿Ÿåˆ†å‘çŸ¥é“ä¸‹ä¸€æ¬¡è¯·æ±‚æ¸²æŸ“çš„æ—¶å€™ã€‚</p><p>å¦‚æœæƒ³çŸ¥é“è½¨è¿¹çš„è¿™ç§ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨<code>getCoalescedEvents</code>æ¥è·å–</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part1" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part1</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part2" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part2</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part3" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part3</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part4" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part4</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web æµè§ˆå™¨æ˜¯å¦‚ä½•æ„æˆçš„(ä¸‰)</title>
      <link href="/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%B8%89/"/>
      <url>/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<p>åœ¨å‰é¢çš„ä¸¤ç¯‡æ–‡ç« å½“ä¸­ï¼Œæˆ‘ä»¬è¦†ç›–äº†æœ¨å¶è¿›ç¨‹çš„æ¶æ„ä»¥åŠç‚¹å‡»è¾“å…¥æ¡†ä»¥åå‘ç”Ÿçš„äº‹æƒ…ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šæ·±å…¥å»çœ‹çœ‹æ¸²æŸ“è¿›ç¨‹å½“ä¸­å‘ç”Ÿäº†ä¸€äº›ä»€ä¹ˆã€‚</p><p>æ¸²æŸ“è¿›ç¨‹å½±å“ç½‘ç»œè¡¨ç°çš„å¾ˆå¤šæ–¹é¢ã€‚æœ¬æ–‡è¿˜æ˜¯èµ·åˆ°ç»™ä¸€ä¸ªå¤§è‡´è„‰ç»œçš„ä½œç”¨ï¼Œå¦‚æœæƒ³æ›´æ·±å…¥äº†è§£ï¼Œå¯ä»¥çœ‹ <a href="https://developers.google.com/web/fundamentals/performance/why-performance-matters/" target="_blank" rel="noopener">Performance Section</a>.</p><h1 id="1-æ¸²æŸ“è¿›ç¨‹å¤„ç†webå†…å®¹"><a href="#1-æ¸²æŸ“è¿›ç¨‹å¤„ç†webå†…å®¹" class="headerlink" title="1. æ¸²æŸ“è¿›ç¨‹å¤„ç†webå†…å®¹"></a>1. æ¸²æŸ“è¿›ç¨‹å¤„ç†webå†…å®¹</h1><p>æ¸²æŸ“è¿›ç¨‹è´Ÿè´£å‘ç”Ÿåœ¨tabå½“ä¸­çš„æ‰€æœ‰äº‹æƒ…ï¼Œä¸»çº¿ç¨‹ä¼šå¤„ç†ä½ å‘é€ç»™ç”¨æˆ·çš„å¤§éƒ¨åˆ†ä»£ç ã€‚ä¸€äº›æ—¶å€™ä¸€éƒ¨åˆ†ä½ çš„jsä»£ç ä¼šè¢«workerçº¿ç¨‹æ¥å¤„ç†(å¦‚æœä½ ä½¿ç”¨web workeræˆ–è€…service workerçš„è¯)ã€‚Compositor å’Œ rasterçº¿ç¨‹ä¹Ÿæ˜¯åœ¨æ¸²æŸ“è¿›ç¨‹å½“ä¸­è¿è¡Œï¼Œä½¿å¾—æ•´ä¸ªæ¸²æŸ“è¿‡ç¨‹æ›´åŠ é«˜æ•ˆé¡ºæ»‘ã€‚</p><p>æ¸²æŸ“è¿›ç¨‹çš„æ ¸å¿ƒå·¥ä½œå°±æ˜¯å°†HTMLï¼ŒCSSä»¥åŠJavaScriptè½¬æ¢æˆç”¨æˆ·å¯ä»¥è¿›è¡Œäº¤äº’çš„é¡µé¢ã€‚</p><h1 id="2-Parsing"><a href="#2-Parsing" class="headerlink" title="2. Parsing"></a>2. Parsing</h1><h2 id="2-1-DOMçš„æ„å»º"><a href="#2-1-DOMçš„æ„å»º" class="headerlink" title="2.1 DOMçš„æ„å»º"></a>2.1 DOMçš„æ„å»º</h2><p>å½“æ¸²æŸ“è¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªcommitä¿¡æ¯ï¼Œå¼€å§‹æ¥å—HTMLçš„æ•°æ®çš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹å°±å¼€å§‹parseHTMLï¼Œå¹¶ä¸”å°†å…¶è½¬åŒ–æˆDocument Object Modeläº†(DOM). </p><p>DOMæ˜¯æµè§ˆå™¨å†…éƒ¨çš„å¯¹ä¸€ä¸ªé¡µé¢ï¼Œæ•°æ®ç»“æ„ä»¥åŠJSæ„æˆçš„APIçš„è¡¨ç¤ºã€‚parseçš„è§„åˆ™åˆ™æ˜¯ç”±<a href="https://html.spec.whatwg.org/" target="_blank" rel="noopener">HTML Standard</a>æ¥è¿›è¡Œå®šä¹‰çš„ã€‚Parseræœ‰å¾ˆå¼ºçš„é²æ£’æ€§ï¼Œå› ä¸ºä»–åŸºæœ¬ä¸Šå¯ä»¥å¤„ç†ç»å¤§éƒ¨åˆ†htmlæœ¬èº«å†™å¾—æ—¶å€™çš„é—®é¢˜ï¼Œæ¯”å¦‚å¿˜è®°<code>&lt;/b&gt;</code>ã€‚éƒ½å¯ä»¥å¾ˆä¼˜é›…çš„è¿›è¡Œè§£å†³ã€‚<a href="https://html.spec.whatwg.org/multipage/parsing.html#an-introduction-to-error-handling-and-strange-cases-in-the-parser" target="_blank" rel="noopener">Introduction to error handling</a></p><h2 id="2-2-å­èµ„æºçš„åŠ è½½"><a href="#2-2-å­èµ„æºçš„åŠ è½½" class="headerlink" title="2.2 å­èµ„æºçš„åŠ è½½"></a>2.2 å­èµ„æºçš„åŠ è½½</h2><p>ä¸€ä¸ªç½‘ç«™ç»å¸¸ä¼šä½¿ç”¨å¤–éƒ¨èµ„æºæ¯”å¦‚å›¾åƒï¼ŒCSSè¿˜æœ‰JavaScript. è¿™äº›æ–‡ä»¶éœ€è¦ä»ç½‘ç»œæˆ–è€…Cacheé‡Œé¢åŠ è½½å‡ºæ¥ã€‚ä¸»çº¿ç¨‹å¯ä»¥åœ¨æ„å»ºDOMæ ‘çš„æ—¶å€™ä¾æ¬¡å»è¯·æ±‚ä»–ä»¬ï¼Œä½†æ˜¯ä¸ºäº†åŠ å¿«æ•´ä¸ªè¿‡ç¨‹ï¼Œpreload scanner ä¼šåŒæ­¥è¿è¡Œè¿™ç§åŠ è½½ä»»åŠ¡ã€‚</p><p>å¦‚æœé‡åˆ°åƒ<code>&lt;img&gt; &lt;link&gt;</code>è¿™ç§tagï¼Œpreload scannerå°±ä¼šçœ‹ä¸€ä¸‹HTML parserè½¬åŒ–æ¥çš„tikenï¼Œç„¶åå‘æµè§ˆå™¨è¿›ç¨‹é‡Œçš„ç½‘ç»œçº¿ç¨‹æäº¤è¯·æ±‚ã€‚  </p><p>å½“HTML parserå‘ç°ä¸€ä¸ª<code>&lt;script&gt;</code>tagçš„æ—¶å€™ï¼Œå®ƒä¼šåœæ­¢å¯¹äºHTMLæ–‡ä»¶çš„è½¬è¯‘ï¼Œç„¶åå¿…é¡»è¦å…ˆå»åŠ è½½è½¬è¯‘æ‰§è¡Œjavascriptä»£ç ã€‚è¿™æ ·åšçš„åŸå› æ˜¯JavaScriptæ˜¯å¯ä»¥å»æ”¹å˜æ•´ä¸ªDOMæ ‘çš„ç»“æ„çš„ã€‚éœ€è¦å…ˆç­‰å…¶æ‰§è¡Œå®Œä»¥åå†ç»§ç»­å‘ä¸‹è¿›è¡Œã€‚</p><h2 id="3-è‡ªå®šä¹‰åŠ è½½èµ„æºçš„æ–¹å¼"><a href="#3-è‡ªå®šä¹‰åŠ è½½èµ„æºçš„æ–¹å¼" class="headerlink" title="3. è‡ªå®šä¹‰åŠ è½½èµ„æºçš„æ–¹å¼"></a>3. è‡ªå®šä¹‰åŠ è½½èµ„æºçš„æ–¹å¼</h2><ul><li>å¦‚æœä½ çš„JSæ–‡ä»¶ä¸åŒ…å«document.write()è¿™ç±»æŒ‡ä»¤ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥åœ¨script tagå½“ä¸­åŠ ä¸Š<code>async</code> or <code>defer</code> å±æ€§ã€‚é€šè¿‡è¿™ç§æç¤ºï¼Œæµè§ˆå™¨åœ¨è¿›è¡Œè½¬è¯‘çš„æ—¶å€™å°±ä¼šå¼‚æ­¥æ‰§è¡Œjsä»£ç ï¼Œä¸ä¼šé˜»æ­¢parsingçš„ç»§ç»­è¿›è¡Œäº†ã€‚</li><li><code>&lt;link rel=&quot;preload&quot;&gt;</code>ä¼šå‘ŠçŸ¥æµè§ˆå™¨è¿™ä¸ªèµ„æºå¯¹äºå½“å‰çš„é¡µé¢å¯¼è§ˆæ˜¯å¿…éœ€çš„ï¼Œæµè§ˆå™¨éœ€è¦å°½å¿«å°†å…¶ä¸‹è½½ä¸‹æ¥ã€‚</li></ul><h2 id="4-æ ·å¼çš„å¤„ç†"><a href="#4-æ ·å¼çš„å¤„ç†" class="headerlink" title="4. æ ·å¼çš„å¤„ç†"></a>4. æ ·å¼çš„å¤„ç†</h2><p>åªæœ‰DOMæ˜¯è¿œè¿œä¸å¤Ÿæè¿°é¡µé¢ä¼šæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨CSSæ¥å¤„ç†é¡µé¢çš„å„éƒ¨åˆ†çš„æ ·å¼ã€‚ä¸»çº¿ç¨‹ä¼šè½¬è¯‘CSSæ–‡ä»¶ï¼Œå¹¶ä¸”å†³å®šè®¡ç®—è¿‡å¾—å„ä¸ªDOMèŠ‚ç‚¹çš„æ ·å¼ã€‚è¿™ç§åˆ¤æ–­å–å†³äºCSSé€‰æ‹©å™¨ç»™å‡ºçš„å„éƒ¨åˆ†éœ€è¦çš„æ ·å¼ã€‚</p><p>è€Œä¸”å³ä¾¿ä½ æ²¡æœ‰æä¾›ä»»ä½•çš„CSSï¼Œæ¯ä¸ªDOMèŠ‚ç‚¹éƒ½ä¼šæœ‰ä¸€ä¸ªè®¡ç®—è¿‡çš„æœ¬èº«çš„æ ·å¼ã€‚<a href="https://cs.chromium.org/chromium/src/third_party/blink/renderer/core/html/resources/html.css" target="_blank" rel="noopener">Chromeé»˜è®¤æ ·å¼æ–‡ä»¶</a></p><h1 id="5-å¸ƒå±€"><a href="#5-å¸ƒå±€" class="headerlink" title="5. å¸ƒå±€"></a>5. å¸ƒå±€</h1><p>å½“å‰çš„æ¸²æŸ“è¿›ç¨‹å·²ç»çŸ¥é“äº†æ•´ä¸ªæ–‡ä»¶çš„ç»“æ„ï¼Œä»¥åŠæ¯ä¸ªèŠ‚ç‚¹çš„æ ·å¼äº†ã€‚ä½†æ˜¯å¾ˆå¯èƒ½è¿™è¿˜ä¸è¶³ä»¥å»æ¸²æŸ“ä¸€ä¸ªé¡µé¢ã€‚å› ä¸ºé™¤äº†å„éƒ¨åˆ†çš„åˆ†åˆ«çš„å¤§å°ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“ä»–ä»¬çš„ç›¸å¯¹ä½ç½®ï¼Œæ˜¯å¦‚ä½•å¸ƒå±€ï¼Œæœ€ç»ˆæ„æˆæ•´ä¸ªé¡µé¢çš„ã€‚</p><p>ä¸»çº¿ç¨‹ä¼šéè§ˆDOMæ ‘å’Œè®¡ç®—è¿‡çš„æ ·å¼ï¼Œç„¶ååˆ›å»ºå¸ƒå±€æ ·å¼æ ‘ï¼ŒåŒ…å«äº†x,yåæ ‡ä¿¡æ¯å’ŒåŒ…å›´çš„boxçš„å¤§å°ã€‚æ³¨æ„å¸ƒå±€æ ‘å’ŒDOMæ ‘éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯å¯¹äº<code>display:none</code>å…·æœ‰è¿™ç§å±æ€§çš„èŠ‚ç‚¹ï¼Œå°±å®Œå…¨ä¸ä¼šåœ¨å¸ƒå±€æ ‘é‡Œå‡ºç°äº†ã€‚ç„¶è€Œï¼Œ<code>visibility:hidden</code>ä¾ç„¶ä¼šå‡ºç°åœ¨å¸ƒå±€æ ‘å½“ä¸­ã€‚</p><h1 id="6-ä¸Šè‰²"><a href="#6-ä¸Šè‰²" class="headerlink" title="6. ä¸Šè‰²"></a>6. ä¸Šè‰²</h1><p>ä¸»çº¿ç¨‹ä¼šéå†æ ·å¼æ ‘ï¼Œå»åˆ›å»ºä¸Šè‰²è®°å½•ã€‚è¿™ä¸ªè®°å½•é‡Œé¢åŒ…å«äº†æ•´ä¸ªä¸Šè‰²æ‰€éœ€çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚å…ˆèƒŒæ™¯ï¼Œå†æ–‡å­—ï¼Œblabla </p><h1 id="7-æ›´æ–°æ¸²æŸ“çš„ç®¡é“æ¶ˆè€—å¾ˆå¤§"><a href="#7-æ›´æ–°æ¸²æŸ“çš„ç®¡é“æ¶ˆè€—å¾ˆå¤§" class="headerlink" title="7. æ›´æ–°æ¸²æŸ“çš„ç®¡é“æ¶ˆè€—å¾ˆå¤§"></a>7. æ›´æ–°æ¸²æŸ“çš„ç®¡é“æ¶ˆè€—å¾ˆå¤§</h1><p>åœ¨å‰é¢æ‰€å™è¿°çš„è¿‡ç¨‹å½“ä¸­ï¼Œä½ ä¼šå‘ç°ä¸Šä¸€æ­¥çš„ç»“æœä¼šæˆä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥ã€‚æ¢å¥è¯è¯´ï¼Œå‡è®¾ä½ ç°åœ¨åœ¨htmlé‡Œé¢åŠ äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹åŸºæœ¬ä¸Šå°±è¦å®Œå…¨é‡æ¥ä¸€éäº†ã€‚å¼ºçƒˆå»ºè®®è®¿é—®<a href="https://developers.google.com/web/updates/2018/09/inside-browser-part3#updating_rendering_pipeline_is_costly" target="_blank" rel="noopener">link</a>ï¼Œé‡Œé¢æœ‰æ•´ä¸ªè¿‡ç¨‹çš„åŠ¨å›¾ï¼Œå¾ˆæœ‰åŠ©äºç†è§£ã€‚</p><h1 id="8-æ‹¼åˆ-Compositing"><a href="#8-æ‹¼åˆ-Compositing" class="headerlink" title="8. æ‹¼åˆ (Compositing)"></a>8. æ‹¼åˆ (Compositing)</h1><p>ç°åœ¨æµè§ˆå™¨è·å¾—äº†æ•´ä¸ªæ–‡ä»¶çš„ç»“æ„ï¼Œæ¯ä¸ªæˆåˆ†çš„æ ·å¼ï¼Œæ•´ä¸ªé¡µé¢çš„å¸ƒå±€ï¼Œä¸Šè‰²çš„é¡ºåºã€‚æ¥ä¸‹æ¥å°±æ˜¯æ‹¼æ¥é¢è¿‡ç¨‹äº†ï¼Œè¿™ä¸ªå°†ä¿¡æ¯è½¬åŒ–æˆåƒç´ çš„è¿‡ç¨‹å«åšrasterizing </p><p>æœ€æœ€å¼€å§‹çš„æ—¶å€™é‡‡å–çš„æ‹¼æ¥æ–¹æ¡ˆå°±æ˜¯éšç€ä¸‹æ»‘ä¸€ç‚¹ç‚¹æ¥æ¸²æŸ“çš„ï¼Œä½†æ˜¯ç°åœ¨æ–¹æ¡ˆå˜å¾—è¶Šæ¥è¶Šå¤æ‚äº†ã€‚</p><p>é¦–å…ˆä¼šå¯¹æ•´ä¸ªé¡µé¢åšåˆ†å±‚å¤„ç†ï¼Œç„¶ååˆ†åˆ«å¯¹å…¶è¿›è¡Œæ¸²æŸ“ï¼Œåƒç´ åŒ–ã€‚<a href="https://blog.logrocket.com/eliminate-content-repaints-with-the-new-layers-panel-in-chrome-e2c306d4d752/?gi=cd6271834cea" target="_blank" rel="noopener">Layer è¯¦è§£</a></p><p>ä¸ºäº†çŸ¥é“æ¯ä¸ªæˆåˆ†éƒ½åœ¨å“ªä¸€å±‚ï¼Œä¸»çº¿ç¨‹ä¼šéå†å¸ƒå±€æ ‘ï¼Œå»åˆ›å»ºä¸€ä¸ªå±‚çº§æ ‘ã€‚</p><p>ä¸€æ—¦å±‚çº§æ ‘è¢«åˆ›å»ºå‡ºæ¥ï¼Œä¸»çº¿ç¨‹ä¼šå°†è¿™äº›ä¿¡æ¯äº¤ç»™æ‹¼æ¥çº¿ç¨‹ã€‚æ‹¼æ¥çº¿ç¨‹æ¥ä¸‹æ¥å°±ä¼šå¯¹æ¯ä¸€å±‚åšåƒç´ åŒ–çš„å¤„ç†ã€‚æ¯ä¸€å±‚å¯èƒ½éƒ½å’Œæ•´ä¸ªé¡µé¢ä¸€æ ·å¤§ï¼Œç›¸äº’ä¹‹é—´æ˜¯æœ‰é‡å çš„ï¼Œæ¥ä¸‹æ¥æ‹¼æ¥çº¿ç¨‹å°±ä¼šå°†ä»–ä»¬åˆ†å¼€ï¼Œç„¶åäº¤ç»™ä¸åŒçš„åƒç´ åŒ–çº¿ç¨‹ã€‚åƒç´ åŒ–çº¿ç¨‹æ˜¯åœ¨GPUä¸‹æ‰§è¡Œçš„ï¼Œæ‹¼æ¥çº¿ç¨‹ä¼šå¯¹åƒç´ èƒ¡çº¿ç¨‹è¿›è¡Œä¼˜åŒ–ï¼Œè®©ç›¸è¿‘çš„éƒ¨åˆ†å…ˆä¸€èµ·åƒç´ åŒ–å®Œã€‚</p><p>ä¸€æ—¦åƒç´ åŒ–å®Œï¼Œæ‹¼æ¥çº¿ç¨‹å°±ä¼šèšé›†è¿™ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œå»åˆ›å»ºæ‹¼æ¥ç‰‡ã€‚æ‹¼æ¥ç‰‡ä¸­åŒ…å«äº†å†…å­˜åœ°å€ï¼Œè¿˜æœ‰åœ¨æ•´ä¸ªé¡µé¢å½“ä¸­åº”å¤„çš„ä½ç½®ã€‚</p><p>æ‹¼æ¥ç‰‡ç„¶åä¼šé€šè¿‡IPCè¢«æäº¤åˆ°æµè§ˆå™¨è¿›ç¨‹å½“ä¸­ã€‚ç”¨æ‹¼åˆçº¿ç¨‹çš„å¥½å¤„æ˜¯ä¸»çº¿ç¨‹ä¸ç”¨å‚ä¸ï¼Œè¿™æ ·çš„è¯åœ¨ä¸»çº¿ç¨‹ç»§ç»­è®¡ç®—æ ·å¼ï¼Œæ‰§è¡Œjavascriptçš„æ—¶å€™æ‹¼æ¥çº¿ç¨‹å·²ç»å¯ä»¥å¼€å§‹å·¥ä½œäº†ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part1" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part1</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part2" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part2</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part3" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part3</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part4" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part4</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web æµè§ˆå™¨æ˜¯å¦‚ä½•æ„æˆçš„(äºŒ)</title>
      <link href="/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%BA%8C/"/>
      <url>/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬ä¸€ä¸ªçœ‹äº†è¿›ç¨‹ä»¥åŠçº¿ç¨‹æ˜¯å¦‚ä½•æ¥å¤„ç†ä¸€ä¸ªæµè§ˆå™¨çš„ä¸åŒéƒ¨åˆ†çš„ï¼Œåœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šä¸€èµ·ç ”ç©¶ä¸‹è¿›ç¨‹ä¸çº¿ç¨‹ä¹‹é—´æ˜¯æ€ä¹ˆè¿›è¡Œäº¤æµï¼Œæ¥æœ€ç»ˆå±•ç¤ºå‡ºé¡µé¢çš„ã€‚</p><p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬å°†èšç„¦äºä¸€ä¸ªç®€å•çš„åº”ç”¨åœºæ™¯:å³ç”¨æˆ·åœ¨æµè§ˆå™¨çš„è¾“å…¥æ¡†è¾“å…¥ç½‘å€ï¼Œå›è½¦ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æµè§ˆå™¨æ˜¯å¦‚ä½•ä»äº’è”ç½‘ä¸­æ‹¿å‡ºæ•°æ®ï¼Œæ¸²æŸ“é¡µé¢ï¼Œæœ€ç»ˆå±•ç¤ºå‡ºæ•´ä¸ªç½‘é¡µçš„ã€‚</p><p>æ­£å¦‚ç¬¬ä¸€è®²ä¸­æ‰€è¯´çš„é‚£æ ·ï¼Œæ‰€æœ‰åœ¨tabä¹‹å¤–çš„å†…å®¹éƒ½æ˜¯è¢«æµè§ˆå™¨è¿›ç¨‹æ¥è¿›è¡Œå¤„ç†çš„ã€‚æµè§ˆå™¨è¿›ç¨‹æœ‰å¤šä¸ªçº¿ç¨‹æ¥å¤„ç†ä¸åŒçš„äº‹åŠ¡:</p><ul><li>UIçº¿ç¨‹<ul><li>ç»˜åˆ¶æ‰€æœ‰çš„æŒ‰é’®</li><li>è¾“å…¥æ¡†</li></ul></li><li>ç½‘ç»œçº¿ç¨‹<ul><li>è§£å†³ç½‘ç»œé€šä¿¡é—®é¢˜</li></ul></li><li>å­˜å‚¨çº¿ç¨‹<ul><li>æ§åˆ¶å¯¹æ–‡ä»¶çš„è®¿é—®</li></ul></li></ul><p>å› æ­¤ï¼Œå½“ä½ åœ¨è¾“å…¥æ¡†è¾“å…¥ç½‘å€çš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šè¢«æµè§ˆå™¨è¿›ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><h1 id="1-å¤„ç†è¯·æ±‚"><a href="#1-å¤„ç†è¯·æ±‚" class="headerlink" title="1. å¤„ç†è¯·æ±‚"></a>1. å¤„ç†è¯·æ±‚</h1><p>é¦–å…ˆæµè§ˆå™¨è¦åˆ¤æ–­ä½ è¾“å…¥çš„æ˜¯ä¸ªqueryè¿˜æ˜¯ä¸ªç½‘å€ã€‚å› ä¸ºåœ¨Chromeå½“ä¸­ï¼Œè¾“å…¥æ¡†æ—¢å¯ä»¥ç”¨æ¥ç›´æ¥è¿›è¡Œæœç´¢ï¼Œä¹Ÿå¯ä»¥å»åˆ°å„ä¸ªç½‘ç«™ã€‚å› æ­¤UI çº¿ç¨‹å°±éœ€è¦åšparsingï¼Œç„¶ååˆ¤æ–­è¾“å…¥çš„å±æ€§ query/ urlï¼Œç„¶åå°†ä½ é€åˆ°æœç´¢å¼•æ“è¿˜æ˜¯åˆ°ç½‘å€ã€‚</p><h1 id="2-å¼€å¯å¯¼è§ˆ-navigation"><a href="#2-å¼€å¯å¯¼è§ˆ-navigation" class="headerlink" title="2. å¼€å¯å¯¼è§ˆ navigation"></a>2. å¼€å¯å¯¼è§ˆ navigation</h1><p>å½“ä½ æ•²å‡»Enterä»¥åï¼ŒUI çº¿ç¨‹å°±ä¼šå¼€å§‹ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå»æ‹¿ç½‘ç«™çš„å†…å®¹ï¼Œç½‘ç»œçº¿ç¨‹å°±ä¼šç»ç”±å„ç§åè®®ï¼ŒDNSæœå¯»ï¼Œåˆ›å»ºTLSè¿æ¥ç­‰ã€‚ä¸€äº›æ—¶å€™ï¼Œç½‘ç»œçº¿ç¨‹ä¼šå—åˆ°æœåŠ¡å™¨çš„é‡å®šå‘headerï¼Œæ¯”å¦‚HTTP301ã€‚è¿™ä¸ªæ—¶å€™ç½‘ç»œçº¿ç¨‹å°±ä¼šé€šçŸ¥UIçº¿ç¨‹è¯·æ±‚é‡å®šå‘ï¼Œç„¶åå¦å¤–ä¸€ä¸ªURLè¯·æ±‚ä¼šè¢«åˆ›å»ºå‡ºæ¥ã€‚å…³äºè¾“å…¥urlä»¥åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå†™è¿‡ä¸€ç¯‡åšï¼Œæ¯”è¾ƒè¯¦ç»† - <a href="https://llchen60.com/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BE%93%E5%85%A5url%E4%BB%A5%E5%90%8E%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/" target="_blank" rel="noopener">æµè§ˆå™¨è¾“å…¥urlä»¥åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆ</a></p><h1 id="3-è¯»å–Response"><a href="#3-è¯»å–Response" class="headerlink" title="3. è¯»å–Response"></a>3. è¯»å–Response</h1><p>ä¸€æ—¦å¾—åˆ°è¿”å›ç»“æœçš„ä¸»ä½“(body)ï¼Œç½‘ç»œçº¿ç¨‹å°±ä¼šçœ‹å­—èŠ‚æµçš„å‰å‡ ä¸ªå­—èŠ‚ã€‚Content-Type headerä¼šåŒ…å«è¿”å›çš„æ•°æ®ç±»å‹çš„ä¿¡æ¯ã€‚è€Œåéœ€è¦çœ‹è¿”å›çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼Œå¦‚æœæ˜¯htmlï¼Œé‚£ä¹ˆå°±äº¤ç»™renderè¿›ç¨‹å»è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚æœæ˜¯zipç­‰æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¿™æ˜¯ä¸ªä¸‹è½½è¯·æ±‚ï¼Œå› æ­¤éœ€è¦å°†è¿™ä¸ªè¯·æ±‚è½¬åˆ°ä¸‹è½½ç®¡ç†å™¨å¤„ã€‚</p><h1 id="4-å¯»æ‰¾ä¸€ä¸ªæ¸²æŸ“çš„è¿›ç¨‹"><a href="#4-å¯»æ‰¾ä¸€ä¸ªæ¸²æŸ“çš„è¿›ç¨‹" class="headerlink" title="4. å¯»æ‰¾ä¸€ä¸ªæ¸²æŸ“çš„è¿›ç¨‹"></a>4. å¯»æ‰¾ä¸€ä¸ªæ¸²æŸ“çš„è¿›ç¨‹</h1><p>åœ¨åšè¿‡å„ç§å®‰å…¨æ£€æŸ¥ä»¥åï¼Œç½‘ç»œçº¿ç¨‹ä¼šé€šçŸ¥UIçº¿ç¨‹æ•°æ®ä¼ è¾“å®Œæ¯•ï¼ŒUIçº¿ç¨‹ä¼šå»æ‰¾ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹æ¥å¯¹é¡µé¢åšæ¸²æŸ“ã€‚</p><p>è¿™é‡Œåšçš„ä¸€ä¸ªå°ä¼˜åŒ–æ˜¯åœ¨å‘èµ·è¯·æ±‚è·å–è¦æ¸²æŸ“çš„é¡µé¢çš„åŒæ—¶ï¼ŒUIçº¿ç¨‹ä¼šå°è¯•ç€æå‰å»æ‰¾ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹å¾…å‘½ã€‚</p><h1 id="5-æ¸²æŸ“é¡µé¢"><a href="#5-æ¸²æŸ“é¡µé¢" class="headerlink" title="5. æ¸²æŸ“é¡µé¢"></a>5. æ¸²æŸ“é¡µé¢</h1><p>ç°åœ¨æ•°æ®å’Œæ¸²æŸ“è¿›ç¨‹éƒ½å·²ç»å‡†å¤‡å¥½äº†ï¼Œä¸€ä¸ªè¿›ç¨‹é—´çš„é€šä¿¡ä¿¡æ¯(IPC)å°±ä¼šä»æµè§ˆå™¨è¿›ç¨‹å‘é€åˆ°æ¸²æŸ“è¿›ç¨‹ï¼Œå‘ŠçŸ¥å…¶å¯ä»¥å¼€å§‹æ¸²æŸ“äº†ã€‚åŒæ—¶å®ƒä¹Ÿä¼šé€šè¿‡æ•°æ®æµæ¥ä¼ é€’æ•°æ®ï¼Œè¿™æ ·æ¸²æŸ“è¿›ç¨‹å°±å¯ä»¥æŒç»­å¾—åˆ°æ•°æ®äº†ã€‚è¿™ä¸ªæ—¶å€™å°±å¼€å§‹é€æ¸åŠ è½½é¡µé¢ã€‚</p><p>ä¸æ­¤åŒæ—¶çš„ï¼Œåœ°å€æ ä¼šå¾—åˆ°æ›´æ–°ï¼Œå®‰å…¨æç¤ºï¼Œå’Œç½‘ç«™è®¾ç½®UIç­‰éƒ½ä¼šå¾—åˆ°æ›´æ–°ã€‚Sessionçš„ä¿¡æ¯ï¼Œä¹Ÿä¼šæ›´æ–°ã€‚</p><h1 id="6-æ¸²æŸ“ç»“æŸ"><a href="#6-æ¸²æŸ“ç»“æŸ" class="headerlink" title="6. æ¸²æŸ“ç»“æŸ"></a>6. æ¸²æŸ“ç»“æŸ</h1><p>æ¸²æŸ“ç»“æŸä»¥åï¼Œæ¸²æŸ“è¿›ç¨‹ä¼šé€ä¸€ä¸ªIPCå›åˆ°æµè§ˆå™¨è¿›ç¨‹ã€‚è¿™ä¸ªæ—¶å€™UI<br>çº¿ç¨‹å°±ä¼šåœæ­¢æ˜¾ç¤ºtabä¸Šé‚£ä¸ªè¡¨ç¤ºåŠ è½½çš„æ—‹è½¬å°åœˆåœˆã€‚</p><h1 id="7-è·³è½¬åˆ°ä¸åŒç½‘ç«™"><a href="#7-è·³è½¬åˆ°ä¸åŒç½‘ç«™" class="headerlink" title="7. è·³è½¬åˆ°ä¸åŒç½‘ç«™"></a>7. è·³è½¬åˆ°ä¸åŒç½‘ç«™</h1><p>å¾ˆç±»ä¼¼äºå‰é¢æ‰€å™è¿°çš„è¿‡ç¨‹ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯åœ¨ç¦»å¼€å½“å‰é¡µé¢ä¹‹å‰ï¼Œå¦‚æœå¼€å‘è€…æ¸²æŸ“äº†beforeunloadäº‹ä»¶ï¼Œé‚£ä¹ˆä¼šå…ˆæ‰§è¡Œä»–ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯åƒé‚£ç§â€œä½ ç¡®å®šè¦ç¦»å¼€å½“å‰é¡µé¢â€ä¹‹ç±»çš„ä¿¡æ¯ã€‚ä½¿ç”¨è¿™ä¸ªäº‹ä»¶è¿˜æ˜¯éœ€è¦è°¨æ…äº›çš„ï¼Œé¦–å…ˆæŠ€æœ¯è§’åº¦ä¸Šä¼šè®©æ•´ä¸ªè¿è¡Œå˜æ…¢ï¼Œå› ä¸ºè¿™ä¸ªäº‹ä»¶çš„è¿è¡Œå’ŒåŠ è½½æ–°é¡µé¢éœ€è¦çº¿æ€§æ‰§è¡Œï¼›ä»äº§å“è§’åº¦ä¸Šæ¥è¯´ï¼Œè¿™æ ·çš„åšæ³•å¯¹äºç•™å­˜ç‡çš„æå‡è¡¨ç°çš„ä½œç”¨ä¹Ÿæ˜¯æœ‰é™çš„â€¦ </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part1" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part1</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part2" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part2</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part3" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part3</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part4" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part4</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web æµè§ˆå™¨æ˜¯å¦‚ä½•æ„æˆçš„(ä¸€)</title>
      <link href="/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%B8%80/"/>
      <url>/Web-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E6%9E%84%E6%88%90%E7%9A%84-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ä¸ªå°ç³»åˆ—æ˜¯çœ‹åˆ°äº†developers.google.comä¸Šçš„ä¸€ç³»åˆ—è®²inside look of modern web browserçš„æ–‡ç« ï¼Œè§‰å¾—å†™å¾—å¾ˆæœ‰æ„æ€ï¼Œé‡Œé¢å™è¿°äº†æµè§ˆå™¨æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥å°†ä½ çš„ä»£ç è¿›è¡Œæ¸²æŸ“çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå¹¶ä¸”æåŠäº†å„ç§è¯­è¨€åœ¨æµè§ˆå™¨å½“ä¸­è¡¨ç°ä¸åŒçš„åŸå› ã€‚å°±åœ¨è¿™é‡Œç¿»è¯‘ä¸‹ï¼Œå’Œå¤§å®¶ä¸€èµ·åˆ†äº«ã€‚</p><h1 id="1-CPU-GPU"><a href="#1-CPU-GPU" class="headerlink" title="1. CPU, GPU"></a>1. CPU, GPU</h1><p>é¦–å…ˆæ˜¯CPUä¸GPUçš„è¯´æ˜ï¼š</p><ul><li>CPU<ul><li>ä¸­å¤®å¤„ç†å•å…ƒ</li><li>è®¡ç®—æœºå¤§è„‘</li><li>å¯ä»¥å¤„ç†å¤šç§ä¸åŒçš„ä»»åŠ¡</li></ul></li><li>GPU<ul><li>å›¾åƒå¤„ç†å•å…ƒ</li><li>æ“…é•¿è§£å†³ç®€å•çš„ä»»åŠ¡ï¼Œä½†æ˜¯éœ€è¦è·¨å¤šæ ¸å¿ƒæ¥è¿›è¡Œå¤„ç†</li></ul></li></ul><p>å½“ä½ åœ¨ç”µè„‘æˆ–è€…æµè§ˆå™¨å½“ä¸­è¿è¡Œä¸€ä¸ªåº”ç”¨çš„æ—¶å€™ï¼ŒCPUæˆ–è€…GPUå°±æ˜¯å®é™…è¿è¡Œç¨‹åºçš„ä¸œè¥¿ï¼Œè€Œå¦‚ä½•è¿è¡Œ - è¿™ç§æœºåˆ¶æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥å®šä¹‰çš„ã€‚</p><h1 id="2-è¿›ç¨‹ä¸çº¿ç¨‹ï¼Œ-å¤šè¿›ç¨‹æ¶æ„"><a href="#2-è¿›ç¨‹ä¸çº¿ç¨‹ï¼Œ-å¤šè¿›ç¨‹æ¶æ„" class="headerlink" title="2. è¿›ç¨‹ä¸çº¿ç¨‹ï¼Œ å¤šè¿›ç¨‹æ¶æ„"></a>2. è¿›ç¨‹ä¸çº¿ç¨‹ï¼Œ å¤šè¿›ç¨‹æ¶æ„</h1><p>è¿›ç¨‹å¯ä»¥æˆä¸ºä¸€ä¸ªåº”ç”¨çš„æ‰§è¡Œç¨‹åºï¼Œä¸€ä¸ªçº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰§è¡Œè¿›ç¨‹ç¨‹åºçš„ä»»æ„ä¸€éƒ¨åˆ†ã€‚</p><p><img src="https://i.loli.net/2020/02/02/nBacm7IHfkLe6MQ.png" alt="fig1.png"></p><p>å½“ä½ æ‰“å¼€ä¸€ä¸ªåº”ç”¨ï¼Œä¸€ä¸ªè¿›ç¨‹å°±è¢«åˆ›å»ºäº†å‡ºæ¥ã€‚ç¨‹åºæœ‰å¯èƒ½ä¼šå»ºç«‹å¤šä¸ªçº¿ç¨‹æ¥å¸®åŠ©è¿›ç¨‹è¿›è¡Œå·¥ä½œï¼ˆå¯é€‰æ‹©çš„ï¼‰ã€‚æ“ä½œç³»ç»Ÿç»™è¿›ç¨‹ä¸€éƒ¨åˆ†çš„å†…å­˜ç©ºé—´ä½¿ç”¨ï¼Œæ‰€ç”¨çš„åº”ç”¨å†…çš„çŠ¶æ€éƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸€éƒ¨åˆ†ç§äººçš„å†…å­˜ç©ºé—´å½“ä¸­ã€‚å½“ä½ å…³é—­åº”ç”¨ï¼Œè¿›ç¨‹å°±ä¼šç»“æŸï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šå°†å†…å­˜ç©ºé—´é‡Šæ”¾æ‰ã€‚</p><p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¦æ±‚æ“ä½œç³»ç»Ÿå»å¼€å¦å¤–ä¸€ä¸ªè¿›ç¨‹æ¥è·‘å…¶ä»–çš„ä¸€äº›ä»»åŠ¡ã€‚å½“è¿™å‘ç”Ÿæ—¶ï¼Œå¦å¤–çš„ä¸€éƒ¨åˆ†å†…å­˜å°±ä¼šè¢«åˆ†é…ç»™æ–°çš„è¿›ç¨‹ä½¿ç”¨ã€‚ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´å¯ä»¥è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ã€‚ä½¿ç”¨è¿›ç¨‹é—´é€šä¿¡çš„å¥½å¤„æ˜¯å¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸å·¥ä½œäº†ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿåªéœ€è¦é‡å¯è¿™ä¸ªè¿›ç¨‹å°±å¥½ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„è¿›ç¨‹ã€‚</p><h1 id="3-æµè§ˆå™¨æ¶æ„"><a href="#3-æµè§ˆå™¨æ¶æ„" class="headerlink" title="3. æµè§ˆå™¨æ¶æ„"></a>3. æµè§ˆå™¨æ¶æ„</h1><p>æµè§ˆå™¨æ˜¯å¦‚ä½•ä½¿ç”¨è¿›ç¨‹å’Œçº¿ç¨‹çš„å‘¢ï¼Ÿ ä¸¤ç§æ–¹å¼ï¼Œä½†å¹¶æ— å¥½åä¹‹åˆ†ï¼Œå®Œå…¨æ˜¯ä¸åŒçš„æµè§ˆå™¨å†…æ ¸é€‰æ‹©äº†ä¸åŒçš„å®ç°æ–¹å¼ã€‚</p><ul><li>ä¸€ä¸ªè¿›ç¨‹ï¼Œå†…å«å¤šä¸ªçº¿ç¨‹</li><li>å¤šä¸ªè¿›ç¨‹ï¼Œå°‘é‡çº¿ç¨‹è´Ÿè´£è¿›ç¨‹é—´çš„é€šä¿¡</li></ul><p><img src="https://i.loli.net/2020/02/02/1TRsOX2fBFN3DEg.png" alt="fig2.png"></p><h2 id="3-1-Chromeçš„æ¶æ„"><a href="#3-1-Chromeçš„æ¶æ„" class="headerlink" title="3.1 Chromeçš„æ¶æ„"></a>3.1 Chromeçš„æ¶æ„</h2><p><img src="https://i.loli.net/2020/02/02/Z6f4QiHO1FJCjeL.png" alt="fig3.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæœ€ä¸Šå±‚æ˜¯æµè§ˆå™¨è¿›ç¨‹å’Œå…¶ä»–è¿›ç¨‹åˆä½œæ¥ç®¡ç†åº”ç”¨çš„ä¸åŒéƒ¨åˆ†ã€‚å¯¹äºæ¸²æŸ“è¿›ç¨‹ï¼Œå¤šä¸ªè¿›ç¨‹ä¼šè¢«åˆ›å»ºï¼Œå¹¶åˆ†é…ç»™æ¯ä¸ªtabã€‚</p><h2 id="3-2-è¿›ç¨‹æ§åˆ¶ä½“ç³»"><a href="#3-2-è¿›ç¨‹æ§åˆ¶ä½“ç³»" class="headerlink" title="3.2 è¿›ç¨‹æ§åˆ¶ä½“ç³»"></a>3.2 è¿›ç¨‹æ§åˆ¶ä½“ç³»</h2><ul><li>æµè§ˆå™¨è¿›ç¨‹<ul><li>æ§åˆ¶æµè§ˆå™¨æœ¬èº«çš„ä¸€äº›åŠŸèƒ½<ul><li>ä¹¦ç­¾ï¼Œæ”¶è—</li><li>å‰è¿›ï¼Œåé€€</li></ul></li><li>å¤„ç†çœ‹ä¸åˆ°çš„æƒé™å¤„ç†ï¼Œç½‘ç»œè¯·æ±‚çš„éƒ¨åˆ†</li></ul></li><li>Renderer<ul><li>å¤„ç†tabä»¥å†…çš„ç½‘å€å±•ç¤ºçš„éƒ¨åˆ†</li></ul></li><li>Plugin<ul><li>æ§åˆ¶plugins</li></ul></li><li>GPU<ul><li>ä¸“é—¨ç”¨æ¥è§£å†³GPUç›¸å…³çš„ä»»åŠ¡ï¼Œå’Œå…¶ä»–çš„è¿›ç¨‹åˆ†å¼€ã€‚è¿™æ ·åšæ˜¯å› ä¸ºGPUæ˜¯å°†ä»ä¸åŒappæ¥çš„è¯·æ±‚æ”¾åˆ°ä¸€å—è¿›è¡Œå¤„ç†çš„ï¼Œç„¶åæ”¾åœ¨ä¸€ä¸ªç•Œé¢ä¸Šã€‚ </li></ul></li></ul><p><img src="https://i.loli.net/2020/02/02/1BkHY7NX85uPhyI.png" alt="fig4.png"></p><h2 id="3-3-å¤šè¿›ç¨‹æ¶æ„çš„ä¼˜åŠ¿åŠ£åŠ¿"><a href="#3-3-å¤šè¿›ç¨‹æ¶æ„çš„ä¼˜åŠ¿åŠ£åŠ¿" class="headerlink" title="3.3 å¤šè¿›ç¨‹æ¶æ„çš„ä¼˜åŠ¿åŠ£åŠ¿"></a>3.3 å¤šè¿›ç¨‹æ¶æ„çš„ä¼˜åŠ¿åŠ£åŠ¿</h2><ul><li>äº’ä¸å½±å“ï¼Œå¯ä»¥åªå´©ä¸€ä¸ªtabï¼Œä½†æ˜¯å¦‚æœæ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œæ‰€æœ‰tabå°±éƒ½å´©æ‰äº†</li><li>å®‰å…¨ï¼Œæ²™ç›’  å¯ä»¥å®ç°tab/ processçº§åˆ«çš„æ§åˆ¶</li><li>å› ä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥chromeä¼šä½¿ç”¨æ›´å¤šçš„å†…å­˜(ç›¸æ¯”äºå‹å•†ä»¬). ä½†æ˜¯å½“chromeåˆ°è¾¾é™åˆ¶ä»¥åï¼Œå…¶ä¼šè®©å¤šä¸ªtabä½¿ç”¨åŒä¸€ä¸ªè¿›ç¨‹æ¥ç¼“è§£è¿™ä¸ªé—®é¢˜çš„ã€‚</li><li>Chromeå½“å‰æ­£åœ¨åšçš„æ˜¯ï¼Œé€šè¿‡æ£€æµ‹ç¡¬ä»¶çš„çŠ¶æ€æ¥å†³å®šæ˜¯å¦å°†æ¯ä¸ªå¾®æœåŠ¡æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ä¸Šæ¥è¿è¡Œï¼Œæˆ–è€…å…¨æ”¾åˆ°ä¸€å—ã€‚</li></ul><h2 id="3-4-ç»„ä»¶éš”ç¦»-site-isolation"><a href="#3-4-ç»„ä»¶éš”ç¦»-site-isolation" class="headerlink" title="3.4 ç»„ä»¶éš”ç¦» (site isolation)"></a>3.4 ç»„ä»¶éš”ç¦» (site isolation)</h2><p>Chromeä¼šè¿è¡Œä¸€ä¸ªå•ç‹¬çš„æ¸²æŸ“è¿›ç¨‹å¯¹äºæ¥è‡ªä¸åŒçš„ç½‘ç«™çš„è¯·æ±‚ï¼ˆå¯¹äºç»„ä»¶çš„æ¸²æŸ“ï¼‰ã€‚ä¸€ä¸ªtabä¸€ä¸ªè¿›ç¨‹çš„æ–¹å¼å¯èƒ½ä¼šä½¿å¾—åŒä¸€ä¸ªé¡µé¢å†…æ¥è‡ªä¸åŒçš„ç½‘å€çš„ç»„ä»¶åœ¨åŒä¸€ä¸ªè¿›ç¨‹å†…åˆ†äº«åŒä¸€ä¸ªå†…å­˜ç©ºé—´ä¸­çš„ä¸œè¥¿ï¼Œè¿™æ˜¯å¾ˆä¸å®‰å…¨çš„ã€‚æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸€ä¸ªç½‘ç«™ä¸å¯ä»¥ä¸ç»è¿‡åŒæ„å°±å»è®¿é—®å¦å¤–ä¸€ä¸ªç½‘ç«™æºå¸¦/è·å–çš„æ•°æ®ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part1" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part1</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part2" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part2</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part3" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part3</a></li><li><a href="https://developers.google.com/web/updates/2018/09/inside-browser-part4" target="_blank" rel="noopener">https://developers.google.com/web/updates/2018/09/inside-browser-part4</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº5G</title>
      <link href="/%E5%85%B3%E4%BA%8E5G/"/>
      <url>/%E5%85%B3%E4%BA%8E5G/</url>
      
        <content type="html"><![CDATA[<p>å…³äº5Gæœ¬èº«ï¼Œæ— é¡»èµ˜è¿°ï¼Œæœ‰å¤ªå¤šå¤ªå¤šæ–‡ç« oråšå®¢è¯¦ç»†è¯´äº†å®ƒçš„ç‰¹å¾ä¸æ”¹å˜ï¼Œ20GB/sçš„ä¸‹è½½é€Ÿåº¦ï¼Œ10GB/sçš„ä¸Šä¼ é€Ÿåº¦ï¼Œ ä½è‡³4msçš„å»¶æ—¶, etc. å³é«˜é€Ÿï¼Œæä½å»¶æ—¶ã€‚</p><p>ä¹ä¸€å¬è¿™ä¸ªæ¦‚å¿µï¼Œå¾ˆéš¾æƒ³è±¡æœ‰ä»€ä¹ˆåº”ç”¨åœºæ™¯æ˜¯éä»–ä¸å¯çš„ï¼ˆå‘åçœ‹ï¼‰ï¼Œåˆæœ‰ä»€ä¹ˆæ–°çš„åº”ç”¨åœºæ™¯æ˜¯å› ä¸º5Gçš„å…´ç››å°†é€æ¸é“ºå±•å¼€æ¥çš„ï¼ˆå‘å‰çœ‹ï¼‰ã€‚</p><p>BrainStorm  -&gt; ä»€ä¹ˆåœ°æ–¹å¾ˆéœ€è¦é«˜é€Ÿï¼Ÿ ä½å»¶æ—¶ï¼Ÿ é«˜å¸¦å®½ï¼Ÿ -&gt; è®²æ±‚å®æ—¶æ€§çš„åº”ç”¨åœºæ™¯ -&gt; è‡ªåŠ¨é©¾é©¶ï¼Œç‰©è”ç½‘ï¼ŒVRè™šæ‹Ÿç°å®ã€‚</p><p>ç–¯ç‹‚ç•…æƒ³ä¸€ä¸‹ï¼Œå½“5GçœŸçš„æ™®åŠä»¥åï¼Œæ•´ä¸ªç¤¾ä¼šä¼šå˜æˆçš„æ ·å­ã€‚</p><h1 id="1-ç»ˆç«¯çš„é…ç½®è¿˜é‡è¦ä¹ˆï¼Ÿ"><a href="#1-ç»ˆç«¯çš„é…ç½®è¿˜é‡è¦ä¹ˆï¼Ÿ" class="headerlink" title="1. ç»ˆç«¯çš„é…ç½®è¿˜é‡è¦ä¹ˆï¼Ÿ"></a>1. ç»ˆç«¯çš„é…ç½®è¿˜é‡è¦ä¹ˆï¼Ÿ</h1><p>åœ¨3Gï¼Œ 4Gæ—¶ä»£æˆ‘ä»¬å¯¹äºç»ˆç«¯çš„è¦æ±‚éå¸¸é«˜ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸­å­˜å‚¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„appï¼Œè·å–æˆ‘ä»¬æƒ³è¦è·å–çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä½†æ˜¯å¦‚æœæœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬ç›´æ¥ä»äº‘ç«¯è¿è¡Œæ¸¸æˆå’Œæœ¬æœºä¸Šæœ‰å‡ ä¹ä¸€æ ·çš„ä½“éªŒçš„æ—¶å€™ï¼Œä½ è¿˜éœ€è¦å¾ˆé«˜çš„é…ç½®ä¹ˆï¼Ÿ </p><p>æˆ‘ä»¬ç°åœ¨æ‰€ä½¿ç”¨çš„æ‰‹æœºï¼Œå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªå·¨å¤§çš„ç¼“å­˜å±‚ï¼Œéœ€è¦ä»–æ˜¯å› ä¸ºå’ŒæœåŠ¡å™¨çš„äº¤äº’æœ‰æ¯”è¾ƒé«˜çš„å»¶æ—¶ï¼Œæˆ‘ä»¬åœ¨ç”¨å„ç§æ–¹å¼å»é™åˆ¶å’ŒæœåŠ¡å™¨äº¤æµçš„æ¬¡æ•°ï¼Œè¿˜æœ‰æ¯æ¬¡äº¤æµçš„å¤§å°ï¼›ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œè¿˜æŠŠå¾ˆå¤šä¸œè¥¿éƒ½å­˜åˆ°äº†æœ¬åœ°ã€‚</p><p>é‚£ä¹ˆï¼Œå½“5Gæˆç†Ÿçš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬å’ŒæœåŠ¡å™¨çš„äº¤äº’çš„å»¶æ—¶å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ç»ˆç«¯è¿˜éœ€è¦é‚£ä¹ˆå¤§çš„å­˜å‚¨ï¼Œé‚£ä¹ˆå¼ºçš„æ€§èƒ½å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦å°†appæå‰å®‰è£…åœ¨è‡ªå·±çš„ç»ˆç«¯å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™å¯èƒ½å˜æˆï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå±å¹•ï¼Œä¸€ä¸ªç½‘å¡ï¼Œå¯¹äºé…ç½®çš„è¦æ±‚å‡ ä¹ä¸ºé›¶ï¼Œå°±å¯ä»¥å®Œæˆæˆ‘ä»¬ç°åœ¨æ­£åœ¨åšéœ€è¦åšçš„æ‰€æœ‰äº‹æƒ…äº†ã€‚</p><p>ç»§ç»­å»¶ä¼¸ï¼Œå¦‚æœç»ˆç«¯æŸç§ç¨‹åº¦ä¸Šæ¼”åŒ–ä¸ºåªéœ€è¦ä¸€å—å±å¹•ï¼Œé‚£ä¹ˆå…¶æˆæœ¬è¦æ¯”ç°åœ¨ä½éå¸¸å¤šï¼Œè€Œ5Gç½‘ç»œæœ¬èº«çš„æˆæœ¬(åŸºç«™ï¼Œè¿ç»´)ï¼Œå…¶è¾¹é™…æˆæœ¬å‡ ä¹ä¸ºé›¶ã€‚é‚£ä¹ˆä¼šä¸ä¼šæœ‰ä¸€å¤©çœŸçš„èƒ½å®ç°ç”µå½±é‡Œæè¿°çš„é‚£ç§ï¼Œèº«è¾¹å…¨æ˜¯å±å¹•ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½å¯ä»¥è¿›è¡Œç‚¹å‡»ï¼Œå¯ä»¥éå¸¸è¿…æ·çš„å®Œæˆå„ç§æ“ä½œå‘¢ï¼Ÿ </p><h1 id="2-ç‰©è”ç½‘ï¼Ÿæ™ºèƒ½å®¶å±…ï¼Ÿ"><a href="#2-ç‰©è”ç½‘ï¼Ÿæ™ºèƒ½å®¶å±…ï¼Ÿ" class="headerlink" title="2. ç‰©è”ç½‘ï¼Ÿæ™ºèƒ½å®¶å±…ï¼Ÿ"></a>2. ç‰©è”ç½‘ï¼Ÿæ™ºèƒ½å®¶å±…ï¼Ÿ</h1><p>å¦‚æœæœ‰å»è¿‡ä»€ä¹ˆæ¼”å”±ä¼šï¼Œç°åœºçƒèµ›ä¹‹ç±»çš„ï¼Œé‚£ä½ ä¸€å®šä¼šå¯Ÿè§‰åˆ°ç°åœºç½‘é€Ÿéå¸¸æ…¢â€¦ å¯ä»¥è¿™æ ·ç®€åŒ–ä¸‹ï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸ªéƒ¨ç½²çš„åŸºç«™æœ‰ç€æœ€å¤§å¯ä»¥æä¾›æœåŠ¡çš„è¿æ¥æ•°çš„é™åˆ¶ï¼Œå› æ­¤å½“äººå¤šäº†ä»¥åï¼Œè¿æ¥æ•°å¤ªå¤§ï¼Œäº’ç›¸ä¹‹é—´å°±ä¼šå¼€å§‹æŠ¢å æœ‰é™çš„èµ„æºï¼Œå¯¼è‡´é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ã€‚</p><p>è¿™ä¹Ÿæ˜¯åœ¨3G, 4Gæ—¶ä»£ï¼Œè™½ç„¶æˆ‘ä»¬å–Šäº†é‚£ä¹ˆå¤šå¹´çš„ç‰©è”ç½‘ï¼Œä¸‡ç‰©äº’è”ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰å¤ªå‘å±•èµ·æ¥çš„åŸå› ã€‚è€Œ5Gï¼Œèƒ½å¤Ÿæ”¯æŒåŒæ—¶æ¥å…¥æ›´å¤šçš„è®¾å¤‡ã€‚è¿™ä¹Ÿæ‰«é™¤äº†ç‰©è”ç½‘å‘å±•çš„ä¸€å¤§éšœç¢ã€‚</p><h1 id="3-æ— äººé©¾é©¶ï¼Ÿ-æ— äººæœºï¼Ÿ"><a href="#3-æ— äººé©¾é©¶ï¼Ÿ-æ— äººæœºï¼Ÿ" class="headerlink" title="3. æ— äººé©¾é©¶ï¼Ÿ æ— äººæœºï¼Ÿ"></a>3. æ— äººé©¾é©¶ï¼Ÿ æ— äººæœºï¼Ÿ</h1><p>ç°åœ¨çš„æ— äººé©¾é©¶æ–¹æ¡ˆéƒ½æ˜¯åœ¨æ±½è½¦ä¸Šéƒ¨ç½²å¤§é‡ä¼ æ„Ÿå™¨å’Œé«˜æ€§èƒ½è®¡ç®—æœºï¼Œä¼ æ„Ÿå™¨ä¼ è¾“ä¿¡æ¯ï¼Œé«˜æ€§èƒ½è®¡ç®—æœºå®æ—¶è¿›è¡Œåˆ†æå’Œåé¦ˆã€‚è¿™å¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼Œé¦–å…ˆæ˜¯è¿ç®—èƒ½åŠ›çš„ä¸è¶³ï¼Œå³åœ¨æœ‰é™çš„ç©ºé—´å’Œä¸ç¨³å®šçš„ç¯å¢ƒ(æ¸©åº¦ï¼Œéœ‡åŠ¨ç­‰)éœ€è¦æœ‰ç¨³å®šçš„è®¡ç®—é€Ÿåº¦ï¼›ç›¸å¯¹è¾ƒé«˜çš„æˆæœ¬ï¼Œæ¯è¾†è½¦éƒ½éœ€è¦è£…é«˜æ€§èƒ½è®¡ç®—æœºï¼Œç»™åæœŸçš„è¿ç»´ä¹Ÿé€ æˆäº†ä¸å°çš„å›°éš¾ã€‚è€Œå½“å»¶æ—¶é™ä½åˆ°å¯ä»¥å¿½ç•¥ä¸è®¡çš„ç¨‹åº¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®å®æ—¶å‘é€å›äº‘ç«¯ï¼Œæ•°æ®å¤„ç†å®Œä»¥åå†å®æ—¶ä¼ é€å›æ¥ã€‚äº‘ç«¯æœåŠ¡å™¨å¾€å¾€æœ‰æ›´å¥½çš„æ€§èƒ½ï¼ŒåæœŸç»´æŠ¤æˆæœ¬ä¹Ÿä¼šä½éå¸¸å¤šã€‚åŒç†å¯¹æ— äººæœºä¹Ÿé€‚ç”¨ã€‚ </p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> 5G </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API-é‡æ–°è®¤è¯†RESTFUL</title>
      <link href="/API-%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86RESTFUL/"/>
      <url>/API-%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86RESTFUL/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦è®²å¦‚ä½•å¯¹æ¥å£è¿›è¡Œè®¾è®¡ï¼Œè®©URLæ›´ä¸ºåˆç†ï¼ŒæŒ‡å®šåˆç†çš„æ•°æ®æ ¼å¼ï¼Œå¤„ç†é”™è¯¯ç çš„æ–¹å¼</p><h1 id="1-API-æ¦‚å¿µ"><a href="#1-API-æ¦‚å¿µ" class="headerlink" title="1. API æ¦‚å¿µ"></a>1. API æ¦‚å¿µ</h1><p>å¹¿ä¹‰çš„APIï¼ˆApplication Programming Interfaceï¼‰æ˜¯æŒ‡åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ŒåŒ…æ‹¬åœ¨æ“ä½œç³»ç»Ÿä¸­çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ä¾‹å¦‚dll\soï¼Œæˆ–è€…åŸºäºTCPå±‚çš„socketè¿æ¥ï¼Œç”¨æ¥æä¾›é¢„å®šä¹‰çš„æ–¹æ³•å’Œå‡½æ•°ï¼Œè°ƒç”¨è€…æ— éœ€è®¿é—®æºç å’Œç†è§£å†…éƒ¨åŸç†ä¾¿å¯å®ç°ç›¸åº”åŠŸèƒ½ã€‚è€Œå½“å‰é€šå¸¸æŒ‡é€šè¿‡<strong>HTTPåè®®ä¼ è¾“çš„web serviceæŠ€æœ¯</strong>ã€‚</p><p>APIå’Œè¯­è¨€æ— å…³ï¼Œç†è®ºä¸Šå…·æœ‰ç½‘ç»œæ“ä½œèƒ½åŠ›çš„ç¼–ç¨‹è¯­è¨€éƒ½å¯ä»¥é€šè¿‡ç›¸åº”HTTPè¯·æ±‚å¹¶æ„é€ HTTPåŒ…æ¥å®ŒæˆAPIçš„æ¶æ„ã€‚APIå’ŒJsonï¼Œxmlç­‰åª’ä½“ç±»å‹æ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œå®ƒä»¬çŸ¥è¯†ä¸€ç§ä¼ è¾“æˆ–åª’ä½“çš„æ ¼å¼ï¼Œä¾¿äºè®¡ç®—æœºè§£æå’Œè¯»å–æ•°æ®ã€‚</p><blockquote><p>åŸºäºä»¥ä¸Šï¼ŒAPIè®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†è®©ç¨‹åºå¯è¯»ï¼Œåº”å½“éµä»ç®€å•ã€æ˜“ç”¨ã€æ— çŠ¶æ€ç­‰ç‰¹æ€§ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆRestfulé£æ ¼æµè¡Œçš„åŸå› ã€‚</p></blockquote><h1 id="2-Restful-API"><a href="#2-Restful-API" class="headerlink" title="2. Restful API"></a>2. Restful API</h1><blockquote><p>Restful = æœ‰æ„ä¹‰çš„URL + åˆé€‚çš„HTTPåŠ¨è¯</p></blockquote><p><img src="https://i.loli.net/2020/02/01/1q85H4orvdW9KBG.png" alt="fig1.png"></p><p>RESTï¼ˆè‹±æ–‡ï¼šRepresentational State Transferï¼Œç®€ç§°RESTï¼‰ï¼ŒRESTfulæ˜¯ä¸€ç§å¯¹åŸºäºHTTPçš„åº”ç”¨è®¾è®¡é£æ ¼ï¼Œåªæ˜¯æä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ç§æ ‡å‡†ã€‚ç½‘ç»œä¸Šæœ‰å¤§é‡å¯¹RESTfulé£æ ¼çš„è§£è¯»ï¼Œç®€å•æ¥è¯´Restfulå®šä¹‰URIå’ŒHTTPçŠ¶æ€ç ï¼Œè®©ä½ çš„APIè®¾è®¡å˜å¾—æ›´ç®€æ´ã€æ¸…æ™°å’Œå¯Œæœ‰å±‚æ¬¡ï¼Œå¯¹ç¼“å­˜ç­‰å®ç°æ›´æœ‰å¸®åŠ©ã€‚</p><p>HTTPåŒ…å¤„äºç½‘ç»œåº”ç”¨å±‚ï¼Œå› æ­¤HTTPåŒ…ä¸ºå¹³å°æ— å…³çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œå¦‚æœå°½å¯èƒ½çš„ä½¿ç”¨HTTPçš„åŒ…ç‰¹å¾è€Œä¸æ˜¯å¤§é‡åœ¨bodyå®šä¹‰è‡ªå·±çš„è§„åˆ™ï¼Œå¯ä»¥ç”¨æ›´ç®€æ´ã€æ¸…æ™°ã€é«˜æ•ˆçš„æ–¹å¼å®ç°åŒæ ·çš„éœ€æ±‚ã€‚</p><p><img src="https://i.loli.net/2020/02/01/lCmurw9Z3hVDH8G.png" alt="fig2.png"></p><p>ä¾‹å­ä¸­ä½¿ç”¨è·¯å¾„å‚æ•°æ„å»ºURLå’ŒHTTPåŠ¨è¯æ¥åŒºåˆ†æˆ‘ä»¬éœ€è¦å¯¹æœåŠ¡æ‰€åšå‡ºçš„æ“ä½œï¼Œè€Œä¸æ˜¯ä½¿ç”¨URLä¸Šçš„æ¥å£åç§°ï¼Œä¾‹å¦‚ getProductsç­‰ï¼›ä½¿ç”¨HTTPçŠ¶æ€ç ï¼Œè€Œä¸æ˜¯åœ¨bodyä¸­è‡ªå®šä¹‰ä¸€ä¸ªçŠ¶æ€ç å­—æ®µï¼›URLéœ€è¦æœ‰å±‚æ¬¡çš„è®¾è®¡ï¼Œä¾‹å¦‚/catetory/{category_id}/products ä¾¿äºè·å–pathå‚æ•°ï¼Œåœ¨ä»¥åä¾‹å¦‚<strong>è´Ÿè½½å‡è¡¡å’Œç¼“å­˜çš„è·¯ç”±</strong>éå¸¸æœ‰å¥½å¤„ã€‚</p><p>RESTfulçš„æœ¬è´¨æ˜¯åŸºäºHTTPåè®®å¯¹èµ„æºçš„å¢åˆ æ”¹æŸ¥æ“ä½œåšå‡ºå®šä¹‰ã€‚ç†è§£HTTPåè®®éå¸¸ç®€å•ï¼ŒHTTPæ˜¯é€šè¿‡ç½‘ç»œsocketå‘é€ä¸€æ®µå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”±é”®å€¼å¯¹ç»„æˆçš„headeréƒ¨åˆ†å’Œçº¯æ–‡æœ¬çš„bodyéƒ¨åˆ†ç»„æˆã€‚Urlã€Cookieã€Methodéƒ½åœ¨headerä¸­ã€‚</p><h1 id="3-JSON-API"><a href="#3-JSON-API" class="headerlink" title="3. JSON API"></a>3. JSON API</h1><p>å› ä¸ºRESTFULé£æ ¼ä»…ä»…è§„å®šäº†URLå’ŒHTTP Methodçš„ä½¿ç”¨ï¼Œå¹¶æ²¡æœ‰å®šä¹‰bodyä¸­æ•°æ®çš„æ ¼å¼ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š</p><blockquote><p>å¦‚ä½•å®šä¹‰è¯·æ±‚æˆ–è€…è¿”å›å¯¹è±¡çš„ç»“æ„ï¼Œè¯¥å¦‚ä½•é’ˆå¯¹ä¸åŒçš„æƒ…å†µè¿”å›ä¸åŒçš„HTTPçŠ¶æ€ç å‘¢ï¼Ÿ </p></blockquote><p>JSONå·²ç»æ˜¯æœ€ä¸»æµçš„ç½‘ç»œä¼ è¾“æ ¼å¼ï¼Œå› æ­¤æœ¬æ–‡é»˜è®¤JSONä½œä¸ºä¼ è¾“æ ¼å¼æ¥è®¨è®ºåé¢çš„è¯é¢˜ã€‚JSONAPIå°è¯•å»æä¾›ä¸€ä¸ªéå¸¸é€šç”¨çš„æè¿°æ•°æ®èµ„æºçš„æ ¼å¼ï¼Œå…³äºè®°å½•çš„åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ï¼Œå› æ­¤è¦æ±‚åœ¨å‰åç«¯å‡å®¹æ˜“å®ç°ï¼Œå¹¶åŒ…å«äº†åŸºæœ¬çš„å…³ç³»ç±»å‹ã€‚</p><h2 id="3-1-MIMEç±»å‹"><a href="#3-1-MIMEç±»å‹" class="headerlink" title="3.1 MIMEç±»å‹"></a>3.1 MIMEç±»å‹</h2><p>JSON APIæ•°æ®æ ¼å¼å·²ç»è¢«IANAæœºæ„æ¥å—äº†æ³¨å†Œï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨<strong>application/vnd.api+json</strong>ç±»å‹ã€‚å®¢æˆ·ç«¯è¯·æ±‚å¤´ä¸­Content-Typeåº”è¯¥ä¸º<strong>application/vnd.api+json</strong>ï¼Œå¹¶ä¸”åœ¨Acceptä¸­ä¹Ÿå¿…é¡»åŒ…å«<strong>application/vnd.api+json</strong>ã€‚å¦‚æœæŒ‡å®šé”™è¯¯æœåŠ¡å™¨åº”è¯¥è¿”å›415æˆ–406çŠ¶æ€ç ã€‚</p><h2 id="3-2-JSONæ–‡æ¡£ç»“æ„"><a href="#3-2-JSONæ–‡æ¡£ç»“æ„" class="headerlink" title="3.2 JSONæ–‡æ¡£ç»“æ„"></a>3.2 JSONæ–‡æ¡£ç»“æ„</h2><p>åœ¨é¡¶çº§èŠ‚ç‚¹ä½¿ç”¨dataã€errorsã€metaï¼Œæ¥æè¿°æ•°æ®ã€é”™è¯¯ä¿¡æ¯ã€å…ƒä¿¡æ¯ï¼Œ<strong>æ³¨æ„dataå’Œerrorsåº”è¯¥äº’æ–¥</strong>ï¼Œä¸èƒ½å†ä¸€ä¸ªæ–‡æ¡£ä¸­åŒæ—¶å­˜åœ¨ï¼Œmetaåœ¨é¡¹ç›®å®é™…ä¸Šç”¨çš„å¾ˆå°‘ï¼Œåªæœ‰ç‰¹åˆ«æƒ…å†µæ‰éœ€è¦ç”¨åˆ°ï¼Œæ¯”å¦‚è¿”å›æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯ã€‚</p><p><img src="https://i.loli.net/2020/02/01/qAyxgkXnQfeELjS.png" alt="fig3.png"></p><h3 id="3-2-1-data-å±æ€§"><a href="#3-2-1-data-å±æ€§" class="headerlink" title="3.2.1 data å±æ€§"></a>3.2.1 data å±æ€§</h3><p>ä¸€ä¸ªå…¸å‹çš„dataå¯¹è±¡æ ¼å¼ï¼Œæˆ‘ä»¬çš„æœ‰æ•ˆä¿¡æ¯ä¸€èˆ¬éƒ½æ”¾åœ¨attributeså½“ä¸­ã€‚</p><p><img src="https://i.loli.net/2020/02/01/DbLVQE2Gy184MqK.png" alt="fig4.png"></p><h3 id="3-2-2-errorså±æ€§"><a href="#3-2-2-errorså±æ€§" class="headerlink" title="3.2.2 errorså±æ€§"></a>3.2.2 errorså±æ€§</h3><p>è¿™é‡Œçš„errorså’Œdataæœ‰ä¸€ç‚¹ä¸åŒï¼Œä¸€èˆ¬æ¥è¯´è¿”å›å€¼ä¸­errorsä½œä¸ºåˆ—è¡¨å­˜åœ¨ï¼Œå› ä¸ºé’ˆå¯¹æ¯ä¸ªèµ„æºå¯èƒ½å‡ºç°å¤šä¸ªé”™è¯¯ä¿¡æ¯ã€‚æœ€å…¸å‹çš„ä¾‹å­ä¸ºï¼Œæˆ‘ä»¬è¯·æ±‚çš„å¯¹è±¡ä¸­æŸäº›å­—æ®µä¸ç¬¦åˆéªŒè¯è¦æ±‚ï¼Œè¿™é‡Œéœ€è¦è¿”å›éªŒè¯ä¿¡æ¯ï¼Œä½†æ˜¯HTTPçŠ¶æ€ç ä¼šä½¿ç”¨ä¸€ä¸ªé€šç”¨çš„401ï¼Œç„¶åæŠŠå…·ä½“çš„éªŒè¯ä¿¡æ¯åœ¨errorsç»™å‡ºæ¥ã€‚</p><p><img src="https://i.loli.net/2020/02/01/wiKpC8Q9ngItRJr.png" alt="fig5.png"></p><h1 id="4-å¸¸ç”¨è¿”å›ç "><a href="#4-å¸¸ç”¨è¿”å›ç " class="headerlink" title="4. å¸¸ç”¨è¿”å›ç "></a>4. å¸¸ç”¨è¿”å›ç </h1><ul><li>200 OK</li><li>201 created </li></ul><p>å¦‚æœå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œåœ¨RESTfuléƒ¨åˆ†æˆ‘ä»¬æåˆ°ï¼ŒPOSTä¸ºåˆ›å»ºèµ„æºï¼Œå¦‚æœæœåŠ¡å™¨å¤„ç†æˆåŠŸåº”è¯¥è¿”å›ä¸€ä¸ªåˆ›å»ºæˆåŠŸçš„æ ‡å¿—ï¼Œåœ¨HTTPåè®®ä¸­ï¼Œ201ä¸ºæ–°å»ºæˆåŠŸçš„çŠ¶æ€ã€‚æ–‡æ¡£è§„å®šï¼ŒæœåŠ¡å™¨å¿…é¡»åœ¨dataä¸­è¿”å›idå’Œtypeã€‚</p><ul><li>401 Unauthorized</li></ul><p>å¦‚æœæœåŠ¡å™¨åœ¨æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°ä¸èƒ½æ»¡è¶³æ¡ä»¶ï¼ŒæœåŠ¡å™¨å¯ä»¥ç»™å‡º401é”™è¯¯ï¼Œæ ‡è®°å®¢æˆ·ç«¯é”™è¯¯ï¼Œéœ€è¦å®¢æˆ·ç«¯è‡ªæŸ¥ã€‚</p><ul><li>415 Unsupported Media Type</li></ul><p>å½“æœåŠ¡å™¨åª’ä½“ç±»å‹Content-Typeå’ŒAcceptæŒ‡å®šé”™è¯¯çš„æ—¶å€™ï¼Œåº”è¯¥è¿”å›415ã€‚</p><ul><li>403 Forbidden </li></ul><p>å½“å®¢æˆ·ç«¯è®¿é—®æœªæˆæƒçš„èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨è¿”å›403è¦æ±‚ç”¨æˆ·æˆæƒä¿¡æ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RESTFul </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thoughts on web accessibility(ä¿¡æ¯æ— éšœç¢)</title>
      <link href="/Thoughts-on-web-accessibility-%E4%BF%A1%E6%81%AF%E6%97%A0%E9%9A%9C%E7%A2%8D/"/>
      <url>/Thoughts-on-web-accessibility-%E4%BF%A1%E6%81%AF%E6%97%A0%E9%9A%9C%E7%A2%8D/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬åœ¨åšå‰ç«¯çš„æ—¶å€™ï¼Œå®è´¨ä¸Šä¿¡æ¯æ— éšœç¢æ˜¯å¾ˆå¤šå·¥ç¨‹å¸ˆå¾ˆå®¹æ˜“å¿½è§†ä½†åˆç€å®å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œè¦çŸ¥é“åœ¨è¿™ä¸ªä¸–ç•Œä¸Šæ˜¯æœ‰å¾ˆå¤šäººå› ä¸ºä¸€äº›åŸå› æ— æ³•åƒæ­£å¸¸äººä¸€æ ·å»æµè§ˆç½‘é¡µçš„ï¼Œè¯¸å¦‚è‰²ç›²ï¼Œç›²äººï¼Œè€èŠ±ç­‰ç­‰ï¼Œæˆ‘ä»¬éœ€è¦é€‚é…è®¾è®¡çš„ç½‘é¡µï¼Œä½¿å…¶å°½é‡å¯¹äºå„ç§äººéƒ½æ˜¯ä¿¡æ¯æ— éšœç¢çš„ã€‚æ€»è§‰å¾—è¿™æ˜¯ä»¶å¤§éƒ¨åˆ†äººéƒ½æ²¡æœ‰æƒ³åˆ°çš„äº‹æƒ…ï¼Œä½†æ˜¯ä¸€æ—¦æƒ³åˆ°äº†ï¼Œé‚£ä¹ˆå°±åº”è¯¥åšç‚¹ä»€ä¹ˆï¼Œæ¥ä½¿è¿™éƒ¨åˆ†ç›¸å¯¹è¾¹ç¼˜çš„äººä¹Ÿå¯ä»¥æ­£å¸¸çš„å»çœ‹æˆ‘ä»¬è®¾è®¡çš„ç½‘é¡µã€‚</p><p>ä»¥ä¸‹æ˜¯Wikiç»™å‡ºçš„å®šä¹‰: </p><blockquote><p>â€œ Web accessibility refers to the inclusive practice of removing barriers that prevent interaction with, or access to websites, by people with disabilities. When sites are correctly designed, developed and edited, all users have equal access to information and functionality.â€</p></blockquote><h1 id="1-Accessibility-æ ‡å‡†"><a href="#1-Accessibility-æ ‡å‡†" class="headerlink" title="1. Accessibility æ ‡å‡†"></a>1. Accessibility æ ‡å‡†</h1><ul><li>å¯æ„ŸçŸ¥<ul><li>å¦‚æœåªæä¾›å‡­å€Ÿä¸€ç§æ„Ÿå®˜æ‰èƒ½è®©ç”¨æˆ·æ„ŸçŸ¥åˆ°å†…å®¹ï¼Œæ— å½¢ä¸­ä¼šå¤±å»å¾ˆå¤šç”¨æˆ·</li></ul></li><li>å¯æ“ä½œ<ul><li>èƒ½å¦æ­£å¸¸ä½¿ç”¨æ¯ä¸€ä¸ªç»„ä»¶çš„åŠŸèƒ½<ul><li>E.G ä¸‹æ‹‰èœå•ï¼Œå¾ˆå¤šç½‘ç«™è®¾è®¡çš„æ—¶å€™hover overçš„æ—¶å€™å°±æœ‰ä¸‹æ‹‰æ•ˆæœï¼Œä½†æ˜¯æ— æ³•ç‚¹å‡»ã€‚ å¦‚æœæˆ‘ä»¬çš„ç”¨æˆ·æ— æ³•çœ‹åˆ°è¿™äº›ä¸œè¥¿ï¼Œé‚£å¾ˆå¯èƒ½å°±æ— æ³•ç»§ç»­äº¤äº’ä¸‹å»äº†ã€‚</li></ul></li></ul></li><li>å¯ç†è§£<ul><li>ç”¨æˆ·èƒ½å¦å¾ˆå¥½åœ°ç†è§£å‘¢ï¼Ÿ<ul><li>éœ€è¦è€ƒè™‘è¯»å±è½¯ä»¶çš„é€‚ç”¨æ€§</li></ul></li></ul></li><li>å¼ºå¥æ€§<ul><li>èƒ½å¦è¢«å¤šç§User Agentä½¿ç”¨<ul><li>å±å¹•é˜…è¯»å™¨</li><li>IE</li></ul></li></ul></li></ul><p>WebAIM (web accessibility in mind) <a href="https://webaim.org/standards/wcag/checklist" target="_blank" rel="noopener">Checklist</a> </p><h1 id="2-Tips-ä¸€äº›æˆ‘ä»¬å¯ä»¥followçš„ä¸œè¥¿"><a href="#2-Tips-ä¸€äº›æˆ‘ä»¬å¯ä»¥followçš„ä¸œè¥¿" class="headerlink" title="2. Tips ä¸€äº›æˆ‘ä»¬å¯ä»¥followçš„ä¸œè¥¿"></a>2. Tips ä¸€äº›æˆ‘ä»¬å¯ä»¥followçš„ä¸œè¥¿</h1><ul><li>æ ‡é¢˜ æ®µè½ åˆ—è¡¨ ä¿æŒè‰¯å¥½çš„ç»“æ„<ul><li>å±å¹•é˜…è¯»å™¨åœ¨è¯»åˆ°ç»“æ„ç›¸å¯¹è‰¯å¥½çš„æ ‡ç­¾çš„æ—¶å€™ï¼Œä¼šå¸®åŠ©ç”¨æˆ·æ›´å®¹æ˜“ç†è§£æˆ‘ä»¬ç½‘ç«™çš„å†…å®¹</li></ul></li><li>å°½å¯èƒ½ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾<ul><li>æµè§ˆå™¨çš„è°ƒè¯•å·¥å…·å½“ä¸­æœ‰<strong>Accessibility tree</strong>,æµè§ˆå™¨ä¼šè·å–DOMæ ‘ï¼Œæµè§ˆå™¨ä¼šè·å–DOMæ ‘ï¼Œç„¶åå°†å…¶ä¿®æ”¹æˆé€‚ç”¨äºè¾…åŠ©æŠ€æœ¯çš„å½¢å¼(æ— éšœç¢æ ‘)ï¼Œæ‰€ä»¥è‰¯å¥½çš„ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾ï¼Œèƒ½è®©è¾…åŠ©è®¾å¤‡æ›´åˆç†åœ°å°†æˆ‘ä»¬ç½‘ç«™çš„å†…å®¹è½¬åŒ–æˆAccessibility treeï¼Œä»è€Œè§£è¯»ç»™ç”¨æˆ·ï¼Œç¡®ä¿é¡µé¢ä¸­çš„é‡è¦çš„å…ƒç´ æœ‰æ­£ç¡®çš„æ— éšœç¢è§’è‰²ã€çŠ¶æ€å’Œå±æ€§ã€‚</li></ul></li><li>ä¸ºæ‰€æœ‰éæ–‡æœ¬å†…å®¹æä¾›æ–‡æœ¬æ›¿ä»£é¡¹<ul><li>æ‰€æœ‰çš„å›¾ç‰‡éƒ½åº”å½“æœ‰altå±æ€§ï¼Œé‡è¦çš„å›¾ç‰‡åº”ä½¿ç”¨æè¿°æ€§æ›¿ä»£æ–‡æœ¬ç®€æ´è¯´æ˜å›¾åƒå†…å®¹ã€‚</li></ul></li><li>DOMé¡ºåºä¸Tabé”®é¡ºåºä¿æŒä¸€è‡´</li><li>ä¸è¦åš<code>a {outline: none}</code>è¿™ç§æ“ä½œï¼Œå› ä¸ºè¿™æ ·çš„è¯è¿™ä¸ªå°ç»„ä»¶å°±æ˜¯Unfocusableçš„äº†ï¼Œå¯¹äºä¸æ‡‚çš„äººå®Œå…¨æ²¡æ³•ç»§ç»­æäº†</li><li>å¯¹æ¯”åº¦ æœ€ä½è¦æ±‚ 4.5:1 </li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨chromeæµè§ˆå™¨çš„Auditsæ‰¾åˆ°è‡ªå·±çš„ç½‘ç«™å­˜åœ¨çš„æ‰€æœ‰æ— éšœç¢é—®é¢˜ï¼Œç„¶åé’ˆå¯¹æ€§çš„è¿›è¡Œä¿®æ”¹</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://insights.thoughtworks.cn/about-web-accessibility/" target="_blank" rel="noopener">https://insights.thoughtworks.cn/about-web-accessibility/</a></li><li><a href="https://webaim.org/standards/wcag/checklist" target="_blank" rel="noopener">https://webaim.org/standards/wcag/checklist</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> Web Accessibility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPCåè®®</title>
      <link href="/RPC%E5%8D%8F%E8%AE%AE/"/>
      <url>/RPC%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨"><a href="#1-ä»€ä¹ˆæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨" class="headerlink" title="1. ä»€ä¹ˆæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨"></a>1. ä»€ä¹ˆæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</h1><p>RPCæ˜¯æŒ‡è®¡ç®—æœºAä¸Šçš„è¿›ç¨‹ï¼Œè°ƒç”¨å¦å¤–ä¸€å°è®¡ç®—æœºBä¸Šçš„è¿›ç¨‹ï¼Œå…¶ä¸­Aä¸Šçš„è°ƒç”¨è¿›ç¨‹è¢«æŒ‚èµ·ï¼Œè€ŒBä¸Šçš„è¢«è°ƒç”¨è¿›ç¨‹å¼€å§‹æ‰§è¡Œï¼Œå½“å€¼è¿”å›ç»™Aæ—¶ï¼ŒAè¿›ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p><p>æ³¨æ„è¿™ä¸­é—´ï¼ŒABéƒ½ç»å†äº†å†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„è½¬å˜ã€‚</p><p>æ•´ä¸ªæµç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/02/01/tqlp2wST4KBcgyn.jpg" alt="fig1.jpg"></p><h1 id="2-ç—›ç‚¹"><a href="#2-ç—›ç‚¹" class="headerlink" title="2. ç—›ç‚¹"></a>2. ç—›ç‚¹</h1><p>é‚£è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åˆ°åº•è§£å†³äº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><p>ç”±äºå„æœåŠ¡éƒ¨ç½²åœ¨ä¸åŒæœºå™¨ä¸Šï¼Œè¦æƒ³å†æœåŠ¡é—´è¿›è¡Œè¿œç¨‹è°ƒç”¨å…ä¸äº†ç½‘ç»œé€šä¿¡è¿‡ç¨‹ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹æ¯è°ƒç”¨ä¸€ä¸ªæœåŠ¡éƒ½è¦å†™å¤§é‡å’Œç½‘ç»œé€šä¿¡ç›¸å…³çš„ä»£ç ï¼ŒRPCæ¡†æ¶å®é™…ä¸Šå®Œæˆäº†å¯¹ç½‘ç»œé€šä¿¡çš„ç»†èŠ‚çš„å°è£…ï¼Œè®©æ¶ˆè´¹æ–¹èƒ½å¤Ÿåƒè°ƒç”¨æœ¬åœ°æœåŠ¡ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡ã€‚</p><h1 id="3-RPCæ¡†æ¶å…¥é—¨"><a href="#3-RPCæ¡†æ¶å…¥é—¨" class="headerlink" title="3. RPCæ¡†æ¶å…¥é—¨"></a>3. RPCæ¡†æ¶å…¥é—¨</h1><p>RPCæ¡†æ¶ä¸­ä¸»è¦æœ‰ä¸‰ä¸ªè§’è‰²ï¼Œ</p><ul><li>Provider æœåŠ¡æä¾›æ–¹</li><li>Consumer æœåŠ¡æ¶ˆè´¹æ–¹</li><li>Registry æœåŠ¡æ³¨å†Œä¸­å¿ƒ</li></ul><p>ä½¿ç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åŸå› æ˜¯ï¼Œåœ¨SOAæ¡†æ¶ä¸­ï¼Œå¾€å¾€Providerå’ŒConsumerçš„æ•°é‡ä¸å”¯ä¸€ï¼Œé€šè¿‡æ³¨å†Œä¸­å¿ƒæ³¨å†ŒæœåŠ¡ï¼Œå¯ä»¥åšè´Ÿè½½å‡è¡¡ã€‚</p><p><img src="https://i.loli.net/2020/02/01/mYIbBUGoSEPTvu5.jpg" alt="fig2.jpg"></p><p><img src="https://i.loli.net/2020/02/01/HqPaDVrWStugIf6.jpg" alt="fig3.jpg"></p><p>æœåŠ¡æä¾›è€…å¯åŠ¨åä¸»åŠ¨å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œæœºå™¨ip, portä»¥åŠæä¾›çš„æœåŠ¡åˆ—è¡¨ï¼›æœåŠ¡æ¶ˆè´¹è€…å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æä¾›æ–¹åœ°å€åˆ—è¡¨ï¼Œå¯å®ç°è½¯è´Ÿè½½å‡è¡¡å’ŒFailover.<br>RPCæ¡†æ¶å½“ä¸­éœ€è¦ä½¿ç”¨å¾ˆå¤šæŠ€æœ¯ï¼Œä»¥ä¸‹åˆ—å‡ºæ¥ä¸»è¦çš„ä¸€éƒ¨åˆ†ï¼š (do match internal amazon c***** framework!)</p><h2 id="3-1-åŠ¨æ€ä»£ç†"><a href="#3-1-åŠ¨æ€ä»£ç†" class="headerlink" title="3.1 åŠ¨æ€ä»£ç†"></a>3.1 åŠ¨æ€ä»£ç†</h2><h2 id="3-2-åºåˆ—åŒ–"><a href="#3-2-åºåˆ—åŒ–" class="headerlink" title="3.2 åºåˆ—åŒ–"></a>3.2 åºåˆ—åŒ–</h2><p>ä¸ºäº†èƒ½åœ¨ç½‘ç»œä¸Šä¼ è¾“å’Œæ¥æ”¶Javaå¯¹è±¡ï¼Œéœ€è¦è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ“ä½œ</p><h2 id="3-3-NIO"><a href="#3-3-NIO" class="headerlink" title="3.3 NIO"></a>3.3 NIO</h2><p>åŸºäºNettyè¿™ä¸€IOé€šä¿¡æ¡†æ¶</p><p><a href="https://blog.csdn.net/suifeng3051/article/details/23348587" target="_blank" rel="noopener">Netty4è¯¦è§£</a></p><h2 id="3-4-æœåŠ¡æ³¨å†Œä¸­å¿ƒ"><a href="#3-4-æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="3.4 æœåŠ¡æ³¨å†Œä¸­å¿ƒ"></a>3.4 æœåŠ¡æ³¨å†Œä¸­å¿ƒ</h2><p>Redis/ ZooKeeper/ Consul/ Etcd</p><h1 id="4-RPC-vs-REST"><a href="#4-RPC-vs-REST" class="headerlink" title="4. RPC vs REST"></a>4. RPC vs REST</h1><p>æ˜¯ç†å¿µçš„ä¸åŒï¼ŒRESTæ˜¯ä¸€ç§è®¾è®¡é£æ ¼ï¼ŒRESTçš„URLä¸»ä½“æ˜¯èµ„æºï¼Œæ˜¯åè¯ï¼Œè€Œä¸”ä¹Ÿä»…æ”¯æŒHTTPåè®®ï¼Œè§„å®šäº†ä½¿ç”¨HTTP Methodæ¥è¡¨è¾¾æœ¬æ¬¡è¦åšçš„åŠ¨ä½œï¼Œç±»å‹ä¸ªä½æ•°â€¦ è¿™äº›åŠ¨ä½œè¡¨è¾¾äº†å¯¹èµ„æºä»…æœ‰çš„å‡ ç§è½¬æ¢æ–¹å¼ã€‚</p><p>è€ŒRPCçš„æ€æƒ³ï¼Œæ˜¯æŠŠæœ¬åœ°å‡½æ•°æ˜ å°„åˆ°APIï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªAPIå¯¹åº”çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæœ¬åœ°æœ‰ä»€ä¹ˆå‡½æ•°ï¼Œè¿œç¨‹ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼›æ˜¯å»ºç«‹åœ¨é‡‡ç”¨çš„åè®®ä¹‹ä¸Šçš„ã€‚</p><p>å¯ä»¥å‚è€ƒ<a href="https://www.zhihu.com/question/28570307" target="_blank" rel="noopener">WEBå¼€å‘ä¸­ï¼Œä½¿ç”¨JSON-RPCå¥½ï¼Œè¿˜æ˜¯RESTful APIå¥½ï¼Ÿ</a>è·å–æ›´å¤šç»†èŠ‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> RPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RESTful vs RPC</title>
      <link href="/RESTful-vs-RPC/"/>
      <url>/RESTful-vs-RPC/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æƒ³åˆ†æäºŒè€…çš„ä¸åŒï¼Œä»¥åŠä¸ºä»€ä¹ˆè¦é‡‡ç”¨RPCè¿œç¨‹è°ƒç”¨çš„æ–¹å¼ï¼Œå…³äºRPCåè®®æœ¬èº«ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« <a href="https://www.llchen60.com/2018/12/15/RPC%E5%8D%8F%E8%AE%AE/">RPCåè®®</a></p><h1 id="1-RESTè¯¦è§£"><a href="#1-RESTè¯¦è§£" class="headerlink" title="1. RESTè¯¦è§£"></a>1. RESTè¯¦è§£</h1><p>REST ä»£è¡¨ representational state transfer, å³è¡¨ç°å±‚çŠ¶æ€è½¬ç§»ï¼Œåˆ’é‡ç‚¹ï¼ŒçŠ¶æ€çš„è½¬ç§»ã€‚ RESTæœ¬èº«æ˜¯ä¸åŒ…å«åŠ¨ä½œçš„ï¼Œç”¨ä¸€ä¸ªä¸ªåè¯æ¥åˆ’å®šèµ„æºï¼Œå†é€šè¿‡å®šä¹‰çš„Get/Post/Put/deleteç­‰æ“ä½œæ¥åšèµ„æºçš„äº¤æ¢ã€‚ç”¨Roy Fieldingåœ¨å…¶è®ºæ–‡é‡Œçš„è¯æ¥è¯´ï¼š <strong>REST is all about a client-server relationship, where server-side data are made available through representations of data in simple formats, often JSON and XML.</strong><br>RESTæ˜¯æ¥è®ºè¿°clientå’Œserverä¹‹é—´çš„å…³ç³»çš„ï¼Œå…¶ä¸­serverç«¯çš„æ•°æ®æ˜¯é€šè¿‡ç®€å•ç±»å‹çš„æ•°æ®(representation of data)æ¥è¿›è¡Œè¡¨ç¤ºçš„ï¼Œé€šå¸¸æ˜¯JSONå’ŒXML.</p><p>è¿™ç§æ•°æ®çš„è¡¨ç°æ˜¯å¯ä»¥è¿›è¡Œä¿®æ”¹çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•ä»¥åŠå¤šåª’ä½“(é“¾æ¥)æ¥èµ‹äºˆåŠ¨ä½œå’Œå…³ç³»ï¼Œç„¶åè¿›è¡Œå„ä¸ªçŠ¶æ€çš„è½¬ç§»ã€‚ç›¸å½“äºè¯´ï¼Œé“¾æ¥ä»¥åŠæ–¹æ³•ç»™äºˆäº†çŠ¶æ€è½¬ç§»çš„æ¸ é“å’Œæ–¹å¼ã€‚</p><p>RESTè‡ªèº«æœ‰ä¸€äº›é™åˆ¶ï¼š</p><ul><li>RESTæ˜¯æ— çŠ¶æ€çš„ï¼Œè¯·æ±‚ä¹‹é—´æ²¡æœ‰æŒä¹…çš„ä¼šè¯ä¿¡æ¯</li><li>å“åº”éœ€è¦å£°æ˜æˆå¯ç¼“å­˜çš„</li><li>RESTå…³æ³¨ä¸€è‡´æ€§ï¼Œå¦‚æœä½¿ç”¨HTTPï¼Œéœ€è¦å°½å¯èƒ½ä½¿ç”¨HTTPçš„ç‰¹æ€§ï¼Œè€Œä¸æ˜¯å»å‘æ˜æ–°çš„å…¬çº¦</li></ul><p>RESTä¹‹ç¾ä½“ç°åœ¨ä»ä»»ä½•çŠ¶æ€å‘ä»»ä½•çŠ¶æ€è½¬ç§»çš„åˆæ³•çš„è¡Œä¸ºæ€»æ˜¯è¢«serveræ‰€æ§åˆ¶çš„ï¼Œä¸clientçš„å…³ç³»æ¯”è¾ƒå°ï¼›clientæ˜¯è¿è¡Œæ—¶å€™å‘å‡ºçš„è¯·æ±‚ã€‚è€Œå¯¹äºRPCè€Œè¨€ï¼Œå®ƒçš„è¡Œä¸ºä¼šæ›´åŠ å›ºå®šä¸€äº›ã€‚å¯¹æ¯”äºŒè€…ä¹‹é—´çš„åŒºåˆ«ï¼Œä½ å¯ä»¥æƒ³è±¡ä½ é€šè¿‡ä¸åœç‚¹å‡»é“¾æ¥ä»æ·˜å®é¦–é¡µæœ€ç»ˆè½¬åˆ°äº§å“è¯¦æƒ…é¡µçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå’Œè¾“å…¥ä¸€ä¸ªåè¯ï¼Œé€šè¿‡ä¸€ä¸ªAPI callç›´æ¥åˆ°è¯¦æƒ…é¡µçš„è¿‡ç¨‹ã€‚</p><p>åœ¨ä¸Šè¿°ç¬¬ä¸€ä¸ªä¾‹å­é‡Œï¼Œåªè¦å¯¹serverç«¯çš„urlé“¾æ¥åšå„ç§å˜åŒ–å°±å¯ä»¥äº†ï¼Œè®©ä»–èƒ½æ¥å—å„ç§å‚æ•°ï¼›ä½†æ˜¯å¯¹äºç¬¬äºŒç§æƒ…å†µè€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨clientç«¯å®ç°è¿™ä¸ªAPI callï¼Œç„¶åä»clientå‘serverå‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œæ˜¯éœ€è¦åœ¨clientå’Œserverç«¯éƒ½è¿›è¡Œä¿®æ”¹çš„ã€‚</p><p>å…¶å®è¿™é‡Œå¯ä»¥ç¨å¾®åŠ ä¸€ç‚¹å’ŒRPCç›¸æ¯”çš„â€œä¼˜åŠ¿â€ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒRPCç»™å·¥ç¨‹å¸ˆæ›´å¤šçš„æ“ä½œç©ºé—´ï¼Œå³ä½ å¯ä»¥å†™å‡ºæœ‰ç€è¶…å¼ºé™å®šçš„APIï¼Œä½†è¿™æ ·å¾€å¾€é€‚ç”¨æ€§ä¼šå¾ˆä½ï¼Œç„¶åéšç€æ—¶é—´ï¼Œä¼šå‡ºç°Nå¤šAPI callï¼Œè¿™å¯¹äºåæœŸçš„ç»´æŠ¤ï¼Œå¼€å‘éƒ½ä¼šé€ æˆä¸å¤ªå¥½çš„å½±å“ã€‚</p><h1 id="2-Whatâ€™s-RPC"><a href="#2-Whatâ€™s-RPC" class="headerlink" title="2. Whatâ€™s RPC"></a>2. Whatâ€™s RPC</h1><p>RPCï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œå‰é¢å†™è¿‡ä¸€ç¯‡åšæ–‡æ¥è®²å®ƒï¼Œå¤§å®¶å¯ä»¥<a href="https://www.llchen60.com/2018/12/15/RPC%E5%8D%8F%E8%AE%AE/">ç‚¹å‡»</a>å»çœ‹è¯¦æƒ…ã€‚è¿™é‡Œè¯´è¯´å®ƒçš„å‘å±•çš„è¿‡ç¨‹ï¼Œèµ·å…ˆçš„æ—¶å€™å¤§å®¶éƒ½ç”¨XML-RPCï¼Œå¥ˆä½•ä¸æ€ä¹ˆå¥½ç”¨å•Šâ€¦å› ä¸ºXMLå¯¹äºå„ç§ç±»å‹çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œå¤§éƒ¨åˆ†éƒ½åªèƒ½å½“æˆStringå¤„ç†ï¼Œè¿™å°±å°´å°¬äº†ï¼Œä½ åªèƒ½å†é™„ä¸Šmetadataå‘Šè¯‰åˆ«äººè¿™ä¸ªåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹çš„ã€‚åé¢æœ‰äº†Jsonå°±å¥½ä¸€äº›äº†ã€‚ </p><p>é‡‡ç”¨RPCæ¯”è¾ƒéš¾æçš„è¿˜æ˜¯ä½ çš„APIçš„ç²¾ç»†åº¦ï¼Œè§£é‡Šä¸€ä¸‹ï¼Œç”¨RESTçš„æ—¶å€™ä½ å¯ä»¥é€šè¿‡queryæ¥è¯¢é—®ä¸åŒçš„ä¸œè¥¿ï¼Œè¿™ä¸ªæ—¶å€™å®é™…ä¸Šéƒ½æ˜¯é¢å¯¹ä¸€ä¸ªAPIçš„å˜›ï¼Œä½†æ˜¯å¯¹äº<br>RPCè€Œè¨€ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦æ„å»ºä¸€ä¸ªAPIä¸“é—¨æ¥è§£å†³ä¸€ä¸ªé—®é¢˜çš„ã€‚éœ€è¦å¯¹å…¶ç²¾ç»†åº¦ï¼ˆç»†åŒ–ç¨‹åº¦ï¼‰åšè€ƒé‡çš„ã€‚</p><h1 id="3-å¯¹æ¯”"><a href="#3-å¯¹æ¯”" class="headerlink" title="3. å¯¹æ¯”"></a>3. å¯¹æ¯”</h1><p>å…¶å®äºŒè€…æ²¡æœ‰å­°ä¼˜å­°åŠ£ï¼Œç”šè‡³æŸç§ç¨‹åº¦ä¸Šè¿™ç§æ¯”è¾ƒæ˜¯æœ‰ç‚¹ç¥å¥‡çš„ã€‚å› ä¸ºå®è´¨ä¸Šä»–ä»¬æ˜¯å¯ä»¥ç›¸å¥—çš„ï¼Œæ¯”å¦‚ä»clientçœ‹æ˜¯ä¸ªRESTçš„APIï¼Œä½†æ˜¯ä»Serveræ¥çœ‹ï¼Œåœ¨è¿™ä¸ªURLä¹‹ä¸‹ï¼Œå®é™…ä¸Šæ˜¯ç”¨äº†RPCåè®®ï¼Œä»è¿œç¨‹è°ƒç”¨äº†å¦å¤–ä¸€ä¸ªæœåŠ¡çš„æŸä¸ªAPIï¼Œæ¥ä½¿ç”¨ã€‚</p><p>RESTæ›´å¤šçš„æ˜¯é¢å‘çŠ¶æ€ï¼Œå¦‚æœå…¨éƒ½ç”¨RESTæ¥å†™APIçš„è¯ï¼Œä½ ä¼šå‘ç°ä»–ç»™å‡ºçš„å‡ ç§é¢„åˆ¶çš„è¡Œä¸ºæœ‰äº›æ—¶å€™æ˜¯æ— æ³•å¾ˆåˆ‡å®çš„æè¿°å‡ºè¿™ä¸ªåŠ¨ä½œçš„ï¼›è€ŒRPCåˆ™å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸€ç‚¹ï¼Œå…¶ä¸»ä½“å°±æ˜¯ä¸ªåŠ¨ä½œã€‚</p><p>[1]. <a href="https://etherealbits.com/2012/12/debunking-the-myths-of-rpc-rest/" target="_blank" rel="noopener">https://etherealbits.com/2012/12/debunking-the-myths-of-rpc-rest/</a></p><p>[2] Roy Fieldingâ€™s dissertation <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm" target="_blank" rel="noopener">https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm</a> </p><p>[3]. <a href="https://www.smashingmagazine.com/2016/09/understanding-rest-and-rpc-for-http-apis/" target="_blank" rel="noopener">https://www.smashingmagazine.com/2016/09/understanding-rest-and-rpc-for-http-apis/</a></p><p>[4]. <a href="https://zhuanlan.zhihu.com/p/34440779" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/34440779</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RESTFul </tag>
            
            <tag> RPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LDAP Intro</title>
      <link href="/LDAP-Intro/"/>
      <url>/LDAP-Intro/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Whatâ€™s-LDAP"><a href="#1-Whatâ€™s-LDAP" class="headerlink" title="1. Whatâ€™s LDAP?"></a>1. Whatâ€™s LDAP?</h1><p>LDAP stands for <strong><em>Lightweight Directory Access Protocol</em></strong>. It is a lightweight client-server protocol for accessing directory services. It runs over <strong>TCP/IP or other connection oriented transfer services</strong>. </p><h1 id="2-Whatâ€™s-directory"><a href="#2-Whatâ€™s-directory" class="headerlink" title="2. Whatâ€™s directory?"></a>2. Whatâ€™s directory?</h1><p>Similar to database, but contain more <strong>descriptive, attribute-based information</strong>. It has some features:</p><ol><li>Read much more often than it is written. </li><li>Directories are tuned to give quick response to high volume look up or search operations.</li><li>Have the ability to replicate information widely in order to increase availability and reliability</li></ol><h1 id="3-How-does-LDAP-work"><a href="#3-How-does-LDAP-work" class="headerlink" title="3. How does LDAP work?"></a>3. How does LDAP work?</h1><p>LDAP directory serve base on a client-server model. One or more LDAP servers contain the data making up the LDAP directory tree or LDAP backend database. An LDAP client connects to an LDAP server and asks it a question. The server responds with the answer, or with a pointer to where the client can get more information (typically, another LDAP server). No matter what LDAP server a client connects to, it sees the same view of the directory; a name presented to one LDAP server references the same entry it would at another LDAP server. This is an important feature of a global directory service, like LDAP.</p><h1 id="4-Directory-Structure"><a href="#4-Directory-Structure" class="headerlink" title="4. Directory Structure"></a>4. Directory Structure</h1><p>The protocol provides an interface with directories that follow the x.500 model:</p><ul><li><p>An entry consists of a set of attributes</p></li><li><p>An attribute has a name(an attribute type or attribute description) and one or more values. Attrs are defined in a schema. </p></li><li><p>Each entry has a unique identifier - distinguished Name(DN).This consists of its Relative Distinguished Name (RDN), constructed from some attribute(s) in the entry, followed by the parent entryâ€™s DN.</p><p>   dn: cn=John Doe,dc=example,dc=com<br>   cn: John Doe<br>   givenName: John<br>   sn: Doe<br>   telephoneNumber: +1 888 555 6789<br>   telephoneNumber: +1 888 555 1232<br>   mail: <a href="mailto:john@example.com">john@example.com</a><br>   manager: cn=Barbara Doe,dc=example,dc=com<br>   objectClass: inetOrgPerson<br>   objectClass: organizationalPerson<br>   objectClass: person<br>   objectClass: top</p></li></ul><p><code>&quot;dn&quot;</code> is the distinguished name of the entry; it is neither an attribute nor a part of the entry. <code>&quot;cn=John Doe&quot;</code> is the entryâ€™s RDN (Relative Distinguished Name), and <code>&quot;dc=example,dc=com&quot;</code> is the DN of the parent entry, where <code>&quot;dc&quot;</code> denotes <code>&#39;Domain Component&#39;</code>. The other lines show the attributes in the entry. Attribute names are typically mnemonic strings, like <code>&quot;cn&quot;</code> for common name, <code>&quot;dc&quot;</code> for domain component, <code>&quot;mail&quot;</code> for e-mail address, and <code>&quot;sn&quot;</code> for surname.</p><p>A server holds a subtree starting from a specific entry, e.g. <code>&quot;dc=example,dc=com&quot;</code> and its children. Servers may also hold references to other servers, so an attempt to access <code>&quot;ou=department,dc=example,dc=com&quot;</code> could return a referral or continuation reference to a server that holds that part of the directory tree. The client can then contact the other server. Some servers also support chaining, which means the server contacts the other server and returns the results to the client.</p><p>LDAP rarely defines any ordering: The server may return the values of an attribute, the attributes in an entry, and the entries found by a search operation in any order. This follows from the formal definitions - an entry is defined as a set of attributes, and an attribute is a set of values, and sets need not be ordered. </p><h1 id="5-Reference"><a href="#5-Reference" class="headerlink" title="5. Reference"></a>5. Reference</h1><p>1.<a href="https://segmentfault.com/a/1190000002607140" target="_blank" rel="noopener">LDAPæœåŠ¡å™¨çš„æ¦‚å¿µå’ŒåŸç†ç®€å•ä»‹ç»</a><br>2.<a href="https://www.tldp.org/HOWTO/LDAP-HOWTO/whatisldap.html" target="_blank" rel="noopener">Whatâ€™s LDAP</a><br>3.<a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_blank" rel="noopener">Wiki: Lightweight_Directory_Access_Protocol</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> LDAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(ä¸ƒ) - OAuth 2.0</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%83-OAuth-2-0/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%83-OAuth-2-0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>åœ¨å‰é¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»Digest Accessï¼Œ åˆ°AppID+HMACï¼Œå†åˆ°JWTï¼Œå†åˆ°OAuth 1.0ï¼Œè¿™äº›ä¸ªAPIè®¤è¯éƒ½æ˜¯è¦å‘Clientå‘ä¸€ä¸ªå¯†é’¥ï¼ˆæˆ–æ˜¯ç”¨å¯†ç ï¼‰ç„¶åç”¨HASHæˆ–æ˜¯RSAæ¥ç­¾HTTPçš„è¯·æ±‚ï¼Œè¿™å…¶ä¸­æœ‰ä¸ªä¸»è¦çš„åŸå› æ˜¯ï¼Œä»¥å‰çš„HTTPæ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ‰€ä»¥ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“è¢«ç¯¡æ”¹ï¼Œäºæ˜¯æ‰æå‡ºæ¥ä¸€å¥—çš„å®‰å…¨ç­¾åæœºåˆ¶ï¼Œæ‰€ä»¥ï¼Œè¿™äº›è®¤è¯æ–¹æ³•éƒ½æ˜¯å¯ä»¥åœ¨HTTPæ˜æ–‡åè®®ä¸‹ä½¿ç”¨çš„ã€‚</p><p>è¿™ç§ä½¿ç”¨ç­¾åæ–¹å¼å¤§å®¶å¯ä»¥çœ‹åˆ°æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæ‰€ä»¥ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œä¹Ÿæ˜¯å¾ˆä¸å‹å¥½çš„ï¼Œåœ¨ç»„ç»‡ç­¾åçš„é‚£äº›HTTPæŠ¥æ–‡çš„æ—¶å€™ï¼Œå„ç§ï¼ŒURLEncodeå’ŒBase64ï¼Œè¿˜è¦å¯¹Queryçš„å‚æ•°è¿›è¡Œæ’åºï¼Œç„¶åæœ‰çš„æ–¹æ³•è¿˜è¦å±‚å±‚ç­¾åï¼Œéå¸¸å®¹æ˜“å‡ºé”™ï¼Œå¦å¤–ï¼Œè¿™ç§è®¤è¯çš„å®‰å…¨ç²’åº¦æ¯”è¾ƒç²—ï¼Œæˆæƒä¹Ÿæ¯”è¾ƒå•ä¸€ï¼Œå¯¹äºæœ‰ç»ˆç«¯ç”¨æˆ·å‚ä¸çš„ç§»åŠ¨ç«¯æ¥è¯´ä¹Ÿæœ‰ç‚¹ä¸å¤Ÿã€‚æ‰€ä»¥ï¼Œåœ¨2012å¹´çš„æ—¶å€™ï¼ŒOAuth 2.0 çš„ RFC 6749 æ­£å¼æ”¾å‡ºã€‚</p><p>OAuth 2.0ä¾èµ–äºTLS/SSLçš„é“¾è·¯åŠ å¯†æŠ€æœ¯ï¼ˆHTTPSï¼‰ï¼Œå®Œå…¨æ”¾å¼ƒäº†ç­¾åçš„æ–¹å¼ï¼Œè®¤è¯æœåŠ¡å™¨å†ä¹Ÿä¸è¿”å›ä»€ä¹ˆ token secret çš„å¯†é’¥äº†ï¼Œæ‰€ä»¥ï¼ŒOAuth 2.0æ˜¯å®Œå…¨ä¸åŒäº1.0 çš„ï¼Œä¹Ÿæ˜¯ä¸å…¼å®¹çš„ã€‚</p><p>ä¸¤ä¸ªä¸»è¦Flow</p><ul><li>Authorization Code Flow </li><li>Client Credential Flow </li></ul><h1 id="2-æµç¨‹"><a href="#2-æµç¨‹" class="headerlink" title="2. æµç¨‹"></a>2. æµç¨‹</h1><h2 id="2-1-åè¯å®šä¹‰"><a href="#2-1-åè¯å®šä¹‰" class="headerlink" title="2.1 åè¯å®šä¹‰"></a>2.1 åè¯å®šä¹‰</h2><ul><li>Third party application: ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åº</li><li>HTTP Service: HTTPæœåŠ¡æä¾›å•†</li><li>Resource Owner: èµ„æºæ‰€æœ‰è€…</li><li>User Agent: ç”¨æˆ·ä»£ç†</li><li>Authorization server: è®¤è¯æœåŠ¡å™¨</li><li>Resource server: èµ„æºæœåŠ¡å™¨ </li></ul><h2 id="2-2-general-idea"><a href="#2-2-general-idea" class="headerlink" title="2.2 general idea"></a>2.2 general idea</h2><p>åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡æä¾›å•†ä¹‹é—´è®¾ç½®ä¸€ä¸ªæˆæƒå±‚ï¼Œå®¢æˆ·ç«¯åªèƒ½é€šè¿‡æˆæƒå±‚æ¥åˆ°æœåŠ¡æä¾›å•†é‚£é‡Œè·å–ä¿¡æ¯ã€‚æ•´ä¸ªæµç¨‹å˜æˆç”¨æˆ·ç”¨ç”¨æˆ·åå¯†ç ç™»å½•å®¢æˆ·ç«¯ï¼Œç”¨æˆ·ç»™å®¢æˆ·ç«¯å¸¦æœ‰ç‰¹å®šæƒé™çš„tokenã€‚å®¢æˆ·ç«¯ç™»å½•æˆæƒå±‚ä»¥åï¼ŒæœåŠ¡æä¾›å•†æ ¹æ®tokençš„æƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸï¼Œå‘å®¢æˆ·ç«¯å¼€æ”¾ç”¨æˆ·å­˜å‚¨çš„èµ„æ–™ã€‚</p><h2 id="2-3-è¿è¡Œæµç¨‹"><a href="#2-3-è¿è¡Œæµç¨‹" class="headerlink" title="2.3 è¿è¡Œæµç¨‹"></a>2.3 è¿è¡Œæµç¨‹</h2><p><img src="https://i.loli.net/2020/02/01/Wdat63GcDsKT9mf.png" alt="fig1.png"></p><ul><li>A: ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯ä»¥åï¼Œå®¢æˆ·ç«¯è¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒ</li><li>B: ç”¨æˆ·åŒæ„ç»™å®¢æˆ·ç«¯æˆæƒ</li><li>C: å®¢æˆ·ç«¯ä½¿ç”¨å¾—åˆ°çš„æˆæƒï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œ</li><li>D: è®¤è¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ä»¥åï¼Œç¡®è®¤æ— è¯¯ï¼ŒåŒæ„å‘æ”¾ä»¤ç‰Œ</li><li>E: å®¢æˆ·ç«¯ä½¿ç”¨ä»¤ç‰Œï¼Œå‘èµ„æºæœåŠ¡å™¨ç”³è¯·è·å–èµ„æº</li><li>F: èµ„æºæœåŠ¡å™¨ç¡®è®¤ä»¤ç‰Œæ— è¯¯ï¼ŒåŒæ„å‘å®¢æˆ·ç«¯å¼€æ”¾èµ„æº</li></ul><h1 id="3-å®¢æˆ·ç«¯æˆæƒæ¨¡å¼"><a href="#3-å®¢æˆ·ç«¯æˆæƒæ¨¡å¼" class="headerlink" title="3 å®¢æˆ·ç«¯æˆæƒæ¨¡å¼"></a>3 å®¢æˆ·ç«¯æˆæƒæ¨¡å¼</h1><p>å®¢æˆ·ç«¯å¿…é¡»è¦è·å¾—ç”¨æˆ·çš„æˆæƒæ‰èƒ½è·å¾—ä»¤ç‰Œï¼Œæˆæƒæ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>æˆæƒç æ¨¡å¼ (authorization code)</li><li>ç®€åŒ–æ¨¡å¼ (implicit)</li><li>å¯†ç æ¨¡å¼ (resource owner password credentials)</li><li>å®¢æˆ·ç«¯æ¨¡å¼ (client credentials)</li></ul><h2 id="3-1-æˆæƒç æ¨¡å¼"><a href="#3-1-æˆæƒç æ¨¡å¼" class="headerlink" title="3.1 æˆæƒç æ¨¡å¼"></a>3.1 æˆæƒç æ¨¡å¼</h2><p>é€šè¿‡å®¢æˆ·ç«¯çš„åå°æœåŠ¡å™¨ï¼Œä¸æœåŠ¡æä¾›å•†çš„è®¤è¯æœåŠ¡å™¨è¿›è¡Œäº¤æµã€‚</p><p><img src="https://i.loli.net/2020/02/01/BTpKrmRWw9Ju2aE.png" alt="fig2.png"></p><ul><li>A: ç”¨æˆ·è®¿é—®å®¢æˆ·ç«¯ï¼Œåè€…å°†å‰è€…å¯¼å‘è®¤è¯æœåŠ¡å™¨</li><li>B: ç”¨æˆ·é€‰æ‹©æ˜¯å¦ç»™äºˆå®¢æˆ·ç«¯æˆæƒ</li><li>C: å‡è®¾ç”¨æˆ·ç»™äºˆæˆæƒï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯äº‹å…ˆæŒ‡å®šçš„â€é‡å®šå‘URIâ€ï¼ˆredirection URIï¼‰ï¼ŒåŒæ—¶é™„ä¸Šä¸€ä¸ªæˆæƒç ã€‚</li><li>D: å®¢æˆ·ç«¯æ”¶åˆ°æˆæƒç ï¼Œé™„ä¸Šæ—©å…ˆçš„â€é‡å®šå‘URIâ€ï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚è¿™ä¸€æ­¥æ˜¯åœ¨å®¢æˆ·ç«¯çš„åå°çš„æœåŠ¡å™¨ä¸Šå®Œæˆçš„ï¼Œå¯¹ç”¨æˆ·ä¸å¯è§ã€‚</li><li>E: è®¤è¯æœåŠ¡å™¨æ ¸å¯¹äº†æˆæƒç å’Œé‡å®šå‘URIï¼Œç¡®è®¤æ— è¯¯åï¼Œå‘å®¢æˆ·ç«¯å‘é€è®¿é—®ä»¤ç‰Œï¼ˆaccess tokenï¼‰å’Œæ›´æ–°ä»¤ç‰Œï¼ˆrefresh tokenï¼‰</li></ul><p>Aæ­¥éª¤ï¼Œå®¢æˆ·ç«¯ç”³è¯·è®¤è¯çš„URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p><ul><li>response_type: è¡¨ç¤ºæˆæƒç±»å‹ å€¼å›ºå®šä¸ºcode</li><li>client_id</li><li>redirect_uri</li><li>scope</li><li>state</li></ul><pre><code>GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz        &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1Host: server.example.com</code></pre><p>Cæ­¥éª¤ï¼ŒæœåŠ¡å™¨å›åº”å®¢æˆ·ç«¯çš„URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°</p><ul><li>code: æˆæƒç  ä¸€èˆ¬è®¾ä¸º10åˆ†é’Ÿçš„æœ‰æ•ˆæ—¶é—´ ä¸”åªèƒ½ä½¿ç”¨ä¸€æ¬¡</li><li>state: å¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªå‚æ•°ï¼Œè®¤è¯æœåŠ¡å™¨çš„å›åº”ä¹Ÿéœ€è¦åŒ…å«åŒæ ·çš„</li></ul><pre><code>HTTP/1.1 302 FoundLocation: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA          &amp;state=xyz</code></pre><p>Dæ­¥éª¤ï¼Œå®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œçš„HTTPè¯·æ±‚å½“ä¸­ï¼ŒåŒ…å«å¦‚ä¸‹å‚æ•°ï¼š</p><ul><li>grant_type: ä½¿ç”¨çš„æˆæƒæ¨¡å¼ authrization_code</li><li>code: ä¸Šä¸€æ­¥è·å¾—çš„æˆæƒç </li><li>redirect_uri: é‡å®šå‘URIï¼Œä¸Aä¸­å‚æ•°éœ€ä¸€è‡´</li><li>client_id: è¡¨ç¤ºå®¢æˆ·ç«¯ID</li></ul><pre><code>POST /token HTTP/1.1Host: server.example.comAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JWContent-Type: application/x-www-form-urlencodedgrant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb</code></pre><p>Eæ­¥éª¤: è®¤è¯æœåŠ¡å™¨å‘é€çš„HTTPå›å¤ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°</p><ul><li>access_token: è¡¨ç¤ºè®¿é—®ä»¤ç‰Œ</li><li>token_type: ä»¤ç‰Œç±»å‹</li><li>expires_in: è¡¨ç¤ºè¿‡æœŸæ—¶é—´</li><li>refresh_token: è¡¨ç¤ºæ›´æ–°ä»¤ç‰Œï¼Œç”¨æ¥è·å–ä¸‹ä¸€æ¬¡çš„è®¿é—®ä»¤ç‰Œ</li><li>scope: æƒé™èŒƒå›´</li></ul><pre><code> HTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache {   &quot;access_token&quot;:&quot;2YotnFZFEjr1zCsicMWpAA&quot;,   &quot;token_type&quot;:&quot;example&quot;,   &quot;expires_in&quot;:3600,   &quot;refresh_token&quot;:&quot;tGzv3JOkF0XG5Qx2TlKWIA&quot;,   &quot;example_parameter&quot;:&quot;example_value&quot; }</code></pre><h2 id="3-2-ç®€åŒ–æ¨¡å¼"><a href="#3-2-ç®€åŒ–æ¨¡å¼" class="headerlink" title="3.2 ç®€åŒ–æ¨¡å¼"></a>3.2 ç®€åŒ–æ¨¡å¼</h2><p>ä¸é€šè¿‡ç¬¬ä¸‰æ–¹çš„åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ï¼Œç›´æ¥åœ¨æµè§ˆå™¨å½“ä¸­å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œï¼Œè·³è¿‡æˆæƒç è¿™ä¸ªæ­¥éª¤ã€‚æ‰€æœ‰æ­¥éª¤åœ¨æµè§ˆå™¨å½“ä¸­å®Œæˆï¼Œä»¤ç‰Œå¯¹è®¿é—®è€…å¯è§ï¼Œä¸”å®¢æˆ·ç«¯ä¸éœ€è¦è®¤è¯ã€‚</p><p><img src="https://i.loli.net/2020/02/01/6zt3Sjg4iMYoQn8.png" alt="fig3.png"></p><p>ï¼ˆAï¼‰å®¢æˆ·ç«¯å°†ç”¨æˆ·å¯¼å‘è®¤è¯æœåŠ¡å™¨ã€‚</p><p>ï¼ˆBï¼‰ç”¨æˆ·å†³å®šæ˜¯å¦ç»™äºå®¢æˆ·ç«¯æˆæƒã€‚</p><p>ï¼ˆCï¼‰å‡è®¾ç”¨æˆ·ç»™äºˆæˆæƒï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯æŒ‡å®šçš„â€é‡å®šå‘URIâ€ï¼Œå¹¶åœ¨URIçš„Hashéƒ¨åˆ†åŒ…å«äº†è®¿é—®ä»¤ç‰Œã€‚</p><p>ï¼ˆDï¼‰æµè§ˆå™¨å‘èµ„æºæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå…¶ä¸­ä¸åŒ…æ‹¬ä¸Šä¸€æ­¥æ”¶åˆ°çš„Hashå€¼ã€‚</p><p>ï¼ˆEï¼‰èµ„æºæœåŠ¡å™¨è¿”å›ä¸€ä¸ªç½‘é¡µï¼Œå…¶ä¸­åŒ…å«çš„ä»£ç å¯ä»¥è·å–Hashå€¼ä¸­çš„ä»¤ç‰Œã€‚</p><p>ï¼ˆFï¼‰æµè§ˆå™¨æ‰§è¡Œä¸Šä¸€æ­¥è·å¾—çš„è„šæœ¬ï¼Œæå–å‡ºä»¤ç‰Œã€‚</p><p>ï¼ˆGï¼‰æµè§ˆå™¨å°†ä»¤ç‰Œå‘ç»™å®¢æˆ·ç«¯ã€‚</p><p>Aæ­¥éª¤ï¼Œå®¢æˆ·ç«¯å‘å‡ºHTTPè¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°: </p><ul><li>response_typeï¼šè¡¨ç¤ºæˆæƒç±»å‹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸ºâ€tokenâ€ï¼Œå¿…é€‰é¡¹ã€‚</li><li>client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„IDï¼Œå¿…é€‰é¡¹ã€‚</li><li>redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘çš„URIï¼Œå¯é€‰é¡¹ã€‚</li><li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹ã€‚</li><li>stateï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„å½“å‰çŠ¶æ€ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œè®¤è¯æœåŠ¡å™¨ä¼šåŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå€¼</li></ul><pre><code>GET /authorize?response_type=token&amp;client_id=s6BhdRkqt3&amp;state=xyz    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1Host: server.example.com</code></pre><p>Cæ­¥éª¤ï¼Œè®¤è¯æœåŠ¡å™¨å›åº”å®¢æˆ·ç«¯çš„URLï¼ŒåŒ…å«ï¼š</p><ul><li>access_token </li><li>token_type</li><li>expires_in</li><li>scope</li><li>state</li></ul><pre><code>HTTP/1.1 302 Found Location: http://example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA           &amp;state=xyz&amp;token_type=example&amp;expires_in=3600</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(å…­) - OAuth 1.0</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E5%85%AD-OAuth-1-0/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E5%85%AD-OAuth-1-0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>APIè®¤è¯åè®®ï¼Œä¸»è¦æ˜¯ä¸ºäº†åšå§”æ‰˜æˆæƒçš„ã€‚åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·æƒ³ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡å•†æ¥æ‰“å°ç…§ç‰‡ï¼Œè®¿é—®å…¶äº‘å­˜å‚¨ï¼Œä½†æ˜¯ä¸æƒ³æŠŠç”¨æˆ·åå¯†ç ç»™è¿™å®¶ç¬¬ä¸‰æ–¹å…¬å¸ã€‚</p><p>åœ¨è¿™ä¸ªæ¨¡å‹å½“ä¸­ï¼Œclientå¯ä»¥ä»£è¡¨èµ„æºçš„æ‹¥æœ‰è€…å»åšä¸€äº›äº‹æƒ…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒOAuthéœ€è¦ä¸ä»…èƒ½å¤Ÿç¡®è®¤è¯å®èµ„æºæ‹¥æœ‰è€…å¾—åˆ°æˆæƒè®¤è¯ï¼Œå¹¶ä¸”éœ€è¦èƒ½å¤Ÿè¯†åˆ«å‡ºæå‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯çš„èº«ä»½ã€‚</p><p>ä¸ºäº†è®©å®¢æˆ·ç«¯å»è®¿é—®èµ„æºï¼š</p><ol><li>å¾—åˆ°èµ„æºæ‹¥æœ‰è€…çš„è®¸å¯ - ç»ˆç«¯ç”¨æˆ·æˆæƒç»™å®¢æˆ·ç«¯å»è®¿é—®æœåŠ¡å™¨èµ„æºçš„æµç¨‹ </li><li>å»æœåŠ¡å™¨è®¿é—®èµ„æº - åˆ©ç”¨ä¸¤ä¸ªè¯ä¹¦ï¼ˆç”¨äºè¯†åˆ«å®¢æˆ·ç«¯ç”Ÿæˆçš„è¯·æ±‚å’Œç”¨äºè¯†åˆ«è¯·æ±‚æ‰€ä»£è¡¨çš„èµ„æºæ‹¥æœ‰è€…ï¼‰æ¥ç”Ÿæˆå·²è®¤è¯çš„Httpè¯·æ±‚ã€‚</li></ol><p>ä¸‰ä¸ªè§’è‰²</p><ul><li>User  ç…§ç‰‡æ‰€æœ‰è€… - ç”¨æˆ·</li><li>Consumer ç¬¬ä¸‰æ–¹ç…§ç‰‡æ‰“å°æœåŠ¡</li><li>Service Provider ç…§ç‰‡å­˜å‚¨æœåŠ¡</li></ul><p>åè®®çš„ä¸‰ä¸ªé˜¶æ®µ</p><ul><li>Consumer è·å–Request Token</li><li>Service Providerè®¤è¯ç”¨æˆ·å¹¶ä¸”æˆæƒConsumer</li><li>Consumerè·å–Access Tokenè°ƒç”¨APIè®¿é—®ç”¨æˆ·çš„ç…§ç‰‡</li></ul><p>æ•´ä¸ªæˆæƒæµç¨‹ï¼š </p><ul><li>Consumerï¼ˆç¬¬ä¸‰æ–¹ç…§ç‰‡æ‰“å°æœåŠ¡ï¼‰éœ€è¦å…ˆä¸ŠService Providerè·å¾—å¼€å‘çš„ Consumer Key å’Œ Consumer Secret</li><li>å½“ User è®¿é—® Consumer æ—¶ï¼ŒConsumer å‘ Service Provider å‘èµ·è¯·æ±‚è¯·æ±‚Request Token ï¼ˆéœ€è¦å¯¹HTTPè¯·æ±‚ç­¾åï¼‰</li><li>Service Provider éªŒæ˜ Consumer æ˜¯æ³¨å†Œè¿‡çš„ç¬¬ä¸‰æ–¹æœåŠ¡å•†åï¼Œè¿”å› Request Tokenï¼ˆoauth_tokenï¼‰å’Œ Request Token Secret ï¼ˆoauth_token_secretï¼‰</li><li>Consumer æ”¶åˆ° Request Token åï¼Œä½¿ç”¨HTTP GET è¯·æ±‚æŠŠ User åˆ‡åˆ° Service Provider çš„è®¤è¯é¡µä¸Šï¼ˆå…¶ä¸­å¸¦ä¸ŠRequest Tokenï¼‰ï¼Œè®©ç”¨æˆ·è¾“å…¥ä»–çš„ç”¨æˆ·å’Œå£ä»¤ã€‚</li><li>Service Provider è®¤è¯ User æˆåŠŸåï¼Œè·³å› Consumerï¼Œå¹¶è¿”å› Request Token ï¼ˆoauth_tokenï¼‰å’Œ Verification Codeï¼ˆoauth_verifierï¼‰</li><li>æ¥ä¸‹æ¥å°±æ˜¯ç­¾åè¯·æ±‚ï¼Œç”¨Request Token å’Œ Verification Code æ¢å– Access Token ï¼ˆoauth_tokenï¼‰å’Œ Access Token Secret (oauth_token_secret)</li><li>æœ€åä½¿ç”¨Access Tokenè®¿é—®ç”¨æˆ·æˆæƒè®¿é—®çš„èµ„æº</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.csdn.net/turkeyzhou/article/details/7628399" target="_blank" rel="noopener">https://blog.csdn.net/turkeyzhou/article/details/7628399</a></li><li><a href="https://oauth.net/1/" target="_blank" rel="noopener">https://oauth.net/1/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(äº”) - JWT</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%BA%94-JWT/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%BA%94-JWT/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸ºä»€ä¹ˆé€‰æ‹©JWTï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆé€‰æ‹©JWTï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆé€‰æ‹©JWTï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆé€‰æ‹©JWTï¼Ÿ</h1><p>JWTä¹Ÿæ˜¯ä¸€ç§Message Authentication Codeçš„æ–¹æ³•ï¼Œé€‰æ‹©ä½¿ç”¨JWTçš„å¥½å¤„æ˜¯å®ƒå¯ä»¥å°†è®¤è¯çš„é€»è¾‘äº¤ç»™ç¬¬ä¸‰æ–¹çš„æœåŠ¡å™¨ã€‚è€Œè®¤è¯æœåŠ¡å™¨å’Œåº”ç”¨æœåŠ¡å™¨ä¹‹é—´ä¹Ÿä¸éœ€è¦æœ‰ä»»ä½•çš„ç›´æ¥è¿æ¥ã€‚è¿™æ ·å­åšçš„å¥½å¤„å°±æ˜¯åº”ç”¨æœåŠ¡å™¨å¯ä»¥å˜æˆå®Œå…¨æ— çŠ¶æ€çš„æœåŠ¡å™¨äº†ï¼Œä¸éœ€è¦å»å­˜å‚¨tokenã€‚</p><h1 id="2-æ­¥éª¤"><a href="#2-æ­¥éª¤" class="headerlink" title="2. æ­¥éª¤"></a>2. æ­¥éª¤</h1><ol><li>ç”¨æˆ·ä½¿ç”¨ç”¨æˆ·åå’Œå£ä»¤åˆ°è®¤è¯æœåŠ¡å™¨è¯·æ±‚è®¤è¯</li><li>è®¤è¯æœåŠ¡å™¨éªŒè¯ä»¥åï¼Œä»¥æœåŠ¡å™¨ç«¯ç”ŸæˆJWT Token</li></ol><ul><li>è®¤è¯æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªSecret Key</li><li>å¯¹JWT Headerå’ŒJWT Payloadåˆ†åˆ«æ±‚Base64</li><li>ç”¨ç§˜é’¥å¯¹JWTç­¾å</li></ul><ol start="3"><li>å°†base64(header).base64(payload).signatureä½œä¸ºJWT tokenè¿”å›å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯ä½¿ç”¨JWT Tokenå‘åº”ç”¨æœåŠ¡å™¨å‘é€ç›¸å…³çš„è¯·æ±‚ã€‚è¿™ä¸ªJWT Tokenå°±åƒä¸€ä¸ªä¸´æ—¶ç”¨æˆ·æƒè¯ä¸€æ ·ã€‚</li></ol><p>å½“åº”ç”¨æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åï¼š</p><ol><li>æ£€æŸ¥JWT Token, ç¡®è®¤ç­¾åæ­£ç¡®</li><li>å› ä¸ºåªæœ‰è®¤è¯æœåŠ¡å™¨æœ‰è¿™ä¸ªç”¨æˆ·çš„Secret Keyï¼Œæ‰€ä»¥åº”ç”¨æœåŠ¡å™¨è¦å°†å…¶ä¼ ç»™è®¤è¯æœåŠ¡å™¨</li><li>è®¤è¯æœåŠ¡å™¨é€šè¿‡JWT Payloadè§£å‡ºç”¨æˆ·çš„æŠ½è±¡IDï¼Œç„¶åé€šè¿‡æŠ½è±¡IDæŸ¥åˆ°ç™»å½•æ—¶ç”Ÿæˆçš„Secret Keyï¼Œç„¶åå†æ£€æŸ¥ç­¾å</li><li>è®¤è¯æœåŠ¡å™¨æ£€æŸ¥é€šè¿‡åï¼Œåº”ç”¨æœåŠ¡å°±å¯ä»¥è®¤ä¸ºè¿™æ˜¯åˆæ³•è¯·æ±‚äº†</li></ol><p>æˆ‘ä»¬å¯ä»¥çœ‹ä»¥ï¼Œä¸Šé¢çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œæ˜¯åœ¨è®¤è¯æœåŠ¡å™¨ä¸Šä¸ºç”¨æˆ·åŠ¨æ€ç”Ÿæˆ Secret Keyçš„ï¼Œåº”ç”¨æœåŠ¡åœ¨éªŒç­¾çš„æ—¶å€™ï¼Œéœ€è¦åˆ°è®¤è¯æœåŠ¡å™¨ä¸Šå»ç­¾ï¼Œè¿™ä¸ªè¿‡ç¨‹å¢åŠ äº†ä¸€äº›ç½‘ç»œè°ƒç”¨ï¼Œæ‰€ä»¥ï¼ŒJWTé™¤äº†æ”¯æŒHMAC-SHA256çš„ç®—æ³•å¤–ï¼Œè¿˜æ”¯æŒRSAçš„éå¯¹ç§°åŠ å¯†çš„ç®—æ³•ã€‚</p><p>ä½¿ç”¨RSAéå¯¹ç§°ç®—æ³•ï¼Œåœ¨è®¤è¯æœåŠ¡å™¨è¿™è¾¹æ”¾ä¸€ä¸ªç§é’¥ï¼Œåœ¨åº”ç”¨æœåŠ¡å™¨é‚£è¾¹æ”¾ä¸€ä¸ªå…¬é’¥ï¼Œè®¤è¯æœåŠ¡å™¨ä½¿ç”¨ç§é’¥åŠ å¯†ï¼Œåº”ç”¨æœåŠ¡å™¨ä½¿ç”¨å…¬é’¥è§£å¯†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±ä¸éœ€è¦åº”ç”¨æœåŠ¡å™¨å‘è®¤è¯æœåŠ¡å™¨è¯·æ±‚äº†ï¼Œä½†æ˜¯ï¼ŒRSAæ˜¯ä¸€ä¸ªå¾ˆæ…¢çš„ç®—æ³•ï¼Œæ‰€ä»¥ï¼Œè™½ç„¶ä½ çœäº†ç½‘ç»œè°ƒç”¨ï¼Œä½†æ˜¯å´è´¹äº†CPUï¼Œå°¤å…¶æ˜¯Headerå’ŒPayloadæ¯”è¾ƒé•¿çš„æ—¶å€™ã€‚æ‰€ä»¥ï¼Œä¸€ç§æ¯”è¾ƒå¥½çš„ç©æ³•æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŠŠheader å’Œ payloadç®€å•åœ°åšSHA256ï¼Œè¿™ä¼šå¾ˆå¿«ï¼Œç„¶åï¼Œæˆ‘ä»¬ç”¨RSAåŠ å¯†è¿™ä¸ªSHA256å‡ºæ¥çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒRSAç®—æ³•å°±æ¯”è¾ƒå¿«äº†ï¼Œè€Œæˆ‘ä»¬ä¹Ÿåšåˆ°äº†ä½¿ç”¨RSAç­¾åçš„ç›®çš„ã€‚</p><h1 id="3-æŠ€æœ¯ç»†èŠ‚"><a href="#3-æŠ€æœ¯ç»†èŠ‚" class="headerlink" title="3. æŠ€æœ¯ç»†èŠ‚"></a>3. æŠ€æœ¯ç»†èŠ‚</h1><h2 id="3-1-æ„æˆ"><a href="#3-1-æ„æˆ" class="headerlink" title="3.1 æ„æˆ"></a>3.1 æ„æˆ</h2><p>JWTæœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>header</li><li>payload</li><li>signature</li></ul><h3 id="3-1-1-payload"><a href="#3-1-1-payload" class="headerlink" title="3.1.1 payload"></a>3.1.1 payload</h3><p>payloadé‡Œå¯ä»¥åŒ…å«ä»»ä½•ä¿¡æ¯çš„ï¼Œæ²¡æœ‰ç»™ä»»ä½•é™åˆ¶ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯tokenå¹¶æ²¡æœ‰è¿›è¡Œç¼–ç ï¼Œæ‰€ä»¥å½“tokenè¢«æ‹¦æˆªçš„æ—¶å€™ï¼Œé‡Œé¢çš„ä¿¡æ¯æ˜¯å¯ä»¥è¢«çœ‹åˆ°çš„</p><h3 id="3-1-2-header"><a href="#3-1-2-header" class="headerlink" title="3.1.2 header"></a>3.1.2 header</h3><p>payloadçš„å†…å®¹åœ¨æ¥æ”¶æ–¹æ˜¯é€šè¿‡æ£€æŸ¥ç­¾åæ¥è¿›è¡ŒéªŒè¯çš„ï¼Œè€Œç­¾åä¼šæœ‰å¾ˆå¤šç§ã€‚headeré‡Œé¢å°±æºå¸¦æœ‰ä¸åŒç­¾åçš„å…ƒæ•°æ®(metadata).</p><h3 id="3-1-3-ç­¾å"><a href="#3-1-3-ç­¾å" class="headerlink" title="3.1.3 ç­¾å"></a>3.1.3 ç­¾å</h3><p>è¿™ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªMessage Authentication Code, JWTçš„ç­¾ååªæœ‰åœ¨è·å–äº†payload, header,è¿˜æœ‰è¢«ç»™äºˆç§˜é’¥ä»¥åæ‰å¯ä»¥ç”Ÿæˆã€‚æ˜¯ä¸‰è€…çš„ç»„åˆã€‚</p><p>ç­¾åæœ‰å¾ˆå¤šç§ç±»ï¼Œæ¯”å¦‚HS256ï¼Œä»¥åŠRS256. </p><h4 id="3-1-3-1-HS256"><a href="#3-1-3-1-HS256" class="headerlink" title="3.1.3.1 HS256"></a>3.1.3.1 HS256</h4><p>ä½¿ç”¨HS256ï¼Œ æˆ‘ä»¬ä¼šç”¨åˆ°Headerï¼Œ payloadä»¥åŠå¯†ç ï¼Œ ç„¶åæˆ‘ä»¬å°†å…¶ç»„åˆèµ·æ¥åšå“ˆå¸Œã€‚æƒ³è¦ç”ŸæˆåŒæ ·çš„å“ˆå¸Œå€¼ï¼Œä½ å¿…é¡»ä¿è¯ä¸‰ä¸ªä¿¡æ¯ä½ éƒ½æœ‰æ‰å¯ä»¥çš„(header, payload, password)ï¼Œå¦åˆ™ä¸å¯èƒ½å¾—åˆ°ï¼Œè€Œä¸”ä¹Ÿæ— æ³•é€šè¿‡ç¢°æ’é€æ¸è¶‹è¿‘ç»“æœï¼Œå› ä¸ºhs256å¯ä»¥ä¿è¯å“ªæ€•ä»…ä»…æ”¹å˜äº†ä¸€ä¸ªæ•°å­—ï¼Œæœ€ç»ˆå‡ºæ¥çš„ç»“æœä¹Ÿä¼šæœ‰å°†è¿‘ä¸€åŠæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h4 id="3-1-3-1-RS256"><a href="#3-1-3-1-RS256" class="headerlink" title="3.1.3.1 RS256"></a>3.1.3.1 RS256</h4><p>ä½¿ç”¨RS256æ¯”ä½¿ç”¨HS256æ•ˆç‡é«˜å¾ˆå¤šï¼Œè¿™æ˜¯å› ä¸ºï¼š</p><ol><li>HS256å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œå¦‚æœè¾“å…¥çš„ç§˜é’¥å¾ˆç®€å•</li><li>å…¶éœ€è¦serverå’Œclientç«¯æœ‰æå‰æ²Ÿé€šå¥½çš„ä¸€æ ·çš„å¯†ç ã€‚è¿™å°±æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¦æ¢å¯†ç ï¼Œæˆ‘ä»¬å°±è¦æå‰ä¼ è¾“åˆ°æ¯ä¸ªç½‘ç»œèŠ‚ç‚¹å½“ä¸­ä¾›å…¶ä½¿ç”¨ã€‚</li></ol><p>è€Œä½¿ç”¨RS256ï¼Œæˆ‘ä»¬ä»è¦ç”Ÿæˆä¸€ä¸ªMACç ï¼Œç›®æ ‡ä»ç„¶æ˜¯åˆ›å»ºä¸€ä¸ªæ•°å­—ç­¾åæ¥è¯æ˜JWTæ˜¯æœ‰æ•ˆçš„ã€‚åœ¨è¿™ç§ç­¾åå½“ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå°†åˆ›å»ºtokenå’ŒéªŒè¯tokençš„èƒ½åŠ›åˆ†å¼€ã€‚</p><p>å®ç°è¿™ç§ç›®çš„çš„æ–¹å¼å°±æ˜¯åˆ›å»ºä¸¤ä¸ªkeyè€Œä¸æ˜¯ä¸€ä¸ªã€‚</p><ul><li>ä¸€ä¸ªç§é’¥ï¼Œåªè¢«è®¤è¯æœåŠ¡å™¨æ‹¥æœ‰ï¼Œåªè¢«ç”¨æ¥ç”ŸæˆJWT</li><li>ç§é’¥åªèƒ½ç”¨æ¥ç”Ÿæˆï¼Œä¸èƒ½ç”¨æ¥è¯æ˜</li><li>å…¬é’¥ï¼Œç”¨åœ¨åº”ç”¨æœåŠ¡å™¨ç«¯ï¼Œæ¥è®¤è¯JWTçš„</li><li>å…¬é’¥ä¸éœ€è¦å½“æˆéšç§ã€‚å¯ä»¥éšæ„è®©äººä½¿ç”¨çš„</li></ul><p>ä½¿ç”¨RSAç®—æ³•ï¼ŒRSAä½¿ç”¨RSA keysã€‚RSAç®—æ³•å¯ä»¥ç”¨ä¸€ä¸ªkeyæ¥åŠ å¯†ï¼Œå¦ä¸€ä¸ªkeyæ¥è§£å¯†ã€‚ä½†æ˜¯RSAç®—æ³•æœ‰ä¸ªé—®é¢˜å°±æ˜¯è¿è¡Œçš„æ¯”è¾ƒæ…¢ã€‚</p><p>è¿™é‡Œé‡‡ç”¨çš„æ–¹æ³•å°±æ˜¯å…ˆæŠŠheaderå’Œpayloadæ‹¿è¿‡æ¥ä¸€èµ·åšä¸€ä¸ªhashï¼Œç„¶åæˆ‘ä»¬ç”¨ç§é’¥æ¥å¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å°±èƒ½å¤Ÿå¾—åˆ°RS256 çš„signatureã€‚</p><p>åˆ°äº†æ¥æ”¶ç«¯ï¼Œåšçš„äº‹æƒ…å°±æ˜¯ï¼š</p><ol><li>æ‹¿åˆ°headerå’Œpayloadï¼Œç„¶åç”¨SHA-256åšå“ˆå¸Œï¼Œæ‹¿åˆ°çœŸå®æ•°æ®</li><li>ç”¨å…¬é’¥è¿›è¡Œè§£ç ï¼Œå¹¶ä¸”æ‹¿åˆ°ç­¾åçš„signature</li><li>ç„¶åæ¥æ”¶ç«¯æ¯”è¾ƒä¸¤ä¸ªå“ˆå¸Œå€¼ï¼Œçœ‹æ˜¯å¦ç›¸åŒ</li></ol><h2 id="3-2-ä¸ºä»€ä¹ˆä½¿ç”¨JWTï¼Ÿ-ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜è€Œåˆ›å»ºï¼Ÿ"><a href="#3-2-ä¸ºä»€ä¹ˆä½¿ç”¨JWTï¼Ÿ-ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜è€Œåˆ›å»ºï¼Ÿ" class="headerlink" title="3.2 ä¸ºä»€ä¹ˆä½¿ç”¨JWTï¼Ÿ ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜è€Œåˆ›å»ºï¼Ÿ"></a>3.2 ä¸ºä»€ä¹ˆä½¿ç”¨JWTï¼Ÿ ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜è€Œåˆ›å»ºï¼Ÿ</h2><p>JWTä½¿å¾—è®¤è¯æœåŠ¡å™¨å’Œåº”ç”¨æœåŠ¡å™¨å¯ä»¥æˆä¸ºä¸¤ä¸ªä¸åŒçš„æœåŠ¡å™¨ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ä½¿å¾—åº”ç”¨æœåŠ¡å™¨å¯ä»¥è¿è¡Œçš„æ›´å¿«ï¼Œè®¤è¯çš„åŠŸèƒ½éƒ½å¯ä»¥é›†ä¸­åˆ°è®¤è¯æœåŠ¡å™¨å½“ä¸­ï¼Œç„¶åå†æ•´ä¸ªåº”ç”¨é‡Œé¢å»å¤ç”¨ã€‚</p><h2 id="3-3-JWT-å®ä¾‹"><a href="#3-3-JWT-å®ä¾‹" class="headerlink" title="3.3 JWT å®ä¾‹"></a>3.3 JWT å®ä¾‹</h2><pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</code></pre><p>åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯JWT Header:</p><pre><code>JWT Header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</code></pre><p>ç¬¬äºŒéƒ¨åˆ†æ˜¯JWT Payload:</p><pre><code>JWT Payload: eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</code></pre><p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯JWT Signature:</p><pre><code>JWT Signature: TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</code></pre><p>è¿™é‡Œæˆ‘ä»¬åšäº†Base64ç¼–ç ï¼ŒåŸå› æ˜¯å„ä¸ªç”µè„‘å¯¹äºStringæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚UTF-8, ISO 8859-1ç­‰ç­‰ã€‚ä½¿ç”¨Base64ç¼–ç å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p>Base64å’ŒBase64urlåŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼ŒBase64urlæ¯”èµ·Base64ï¼Œå¯¹åœ¨urlä¸­çš„å±•ç¤ºåšäº†ä¸€äº›ä¼˜åŒ–ã€‚</p><h2 id="3-4-JWTçš„ç”¨æˆ·Sessionç®¡ç†"><a href="#3-4-JWTçš„ç”¨æˆ·Sessionç®¡ç†" class="headerlink" title="3.4 JWTçš„ç”¨æˆ·Sessionç®¡ç†"></a>3.4 JWTçš„ç”¨æˆ·Sessionç®¡ç†</h2><p>ä¸€èˆ¬å¸¸ç”¨çš„payloadæœ‰</p><ul><li><p>user identification </p></li><li><p>session expiration</p><p>  {</p><pre><code>  // ç»™å‡ºJWTçš„å®ä½“- è¿™é‡Œæ˜¯æˆ‘ä»¬çš„è®¤è¯æœåŠ¡å™¨  &quot;iss&quot;: &quot;Identifier of our Authentication Server&quot;,  // JWTçš„åˆ›å»ºæ—¶é—´çš„æ—¶é—´æˆ³  &quot;iat&quot;: 1504699136,   // ç”¨æˆ·çš„id  &quot;sub&quot;: &quot;github|353454354354353453&quot;,  // token expiration  &quot;exp&quot;: 1504699256</code></pre><p>  }</p></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://blog.angular-university.io/angular-jwt/" target="_blank" rel="noopener">https://blog.angular-university.io/angular-jwt/</a></li><li><a href="https://coolshell.cn/articles/19395.html" target="_blank" rel="noopener">https://coolshell.cn/articles/19395.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(å››) - App Secret Key, HMAC</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E5%9B%9B-App-Secret-Key-HMAC/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E5%9B%9B-App-Secret-Key-HMAC/</url>
      
        <content type="html"><![CDATA[<h1 id="1-HMAC"><a href="#1-HMAC" class="headerlink" title="1. HMAC"></a>1. HMAC</h1><p>HMAC,æŒ‡Hash based message authentication codeã€‚ç”¨å“ˆå¸Œç»™æ¶ˆæ¯æ¥è¿›è¡Œç­¾åï¼Œå› ä¸ºæˆ‘ä»¬æ€•æ¶ˆæ¯åœ¨ä¼ é€’çš„è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹æ¶ˆæ¯è¿›è¡Œä¸€ä¸ªMACç®—æ³•ï¼Œå¾—åˆ°ä¸€ä¸ªæ‘˜è¦å­—ä¸²ï¼›æ¥æ”¶æ–¹åœ¨æ”¶åˆ°äº†ä¿¡æ¯ä»¥åï¼Œä¼šè¿›è¡ŒåŒæ ·çš„è¿ç®—ï¼Œç„¶åæ¥æ¯”è¾ƒè¿™ä¸ªMACå­—ç¬¦ä¸²ã€‚å¦‚æœä¸€è‡´ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</p><p><img src="https://i.loli.net/2020/02/01/8ewgJ24qbQYjT7I.png" alt="fig1.png"></p><h1 id="2-App-Id-amp-App-Secret-Key"><a href="#2-App-Id-amp-App-Secret-Key" class="headerlink" title="2. App Id &amp; App Secret Key"></a>2. App Id &amp; App Secret Key</h1><p>App IDå’ŒéªŒè¯æ— å…³ï¼Œåªæ˜¯ç”¨æ¥åŒºåˆ†ï¼Œæ˜¯è°æ¥è°ƒç”¨APIçš„ï¼Œå°±åƒæˆ‘ä»¬æ¯ä¸ªäººçš„èº«ä»½è¯ä¸€æ ·ï¼Œåªæ˜¯ç”¨æ¥æ ‡æ³¨ä¸åŒçš„äººï¼Œä¸æ˜¯ç”¨æ¥åšèº«ä»½è®¤è¯çš„ã€‚ä¸å‰é¢çš„ä¸åŒä¹‹å¤„æ˜¯ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç”¨App ID æ¥æ˜ å°„ä¸€ä¸ªç”¨äºåŠ å¯†çš„å¯†é’¥ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œç›¸å…³çš„ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆè‹¥å¹²ä¸ªå¯†é’¥å¯¹ï¼ˆAppID, AppSecretï¼‰ï¼Œå¹¶å¯ä»¥æœ‰æ›´ç»†ç²’åº¦çš„æ“ä½œæƒé™ç®¡ç†ã€‚</p><h2 id="2-1-S3-API-è¯·æ±‚èŒƒä¾‹"><a href="#2-1-S3-API-è¯·æ±‚èŒƒä¾‹" class="headerlink" title="2.1 S3 API è¯·æ±‚èŒƒä¾‹"></a>2.1 S3 API è¯·æ±‚èŒƒä¾‹</h2><ol><li>æŠŠHTTPçš„è¯·æ±‚ï¼ˆæ–¹æ³•ã€URIã€æŸ¥è¯¢å­—ä¸²ã€å¤´ã€ç­¾åå¤´ï¼Œbodyï¼‰æ‰“ä¸ªåŒ…å« CanonicalRequestï¼Œä½œä¸ªSHA-256çš„ç­¾åï¼Œç„¶åå†åšä¸€ä¸ªbase16çš„ç¼–ç </li><li>æŠŠä¸Šé¢çš„è¿™ä¸ªç­¾åå’Œç­¾åç®—æ³• AWS4-HMAC-SHA256ã€æ—¶é—´æˆ³ã€Scopï¼Œå†æ‰“ä¸€ä¸ªåŒ…ï¼Œå« StringToSignã€‚</li><li>å‡†å¤‡ç­¾åï¼Œç”¨ AWSSecretAccessKeyæ¥å¯¹æ—¥æœŸç­¾ä¸€ä¸ª DataKeyï¼Œå†ç”¨ DataKey å¯¹è¦æ“ä½œçš„Regionç­¾ä¸€ä¸ª DataRegionKey ï¼Œå†å¯¹ç›¸å…³çš„æœåŠ¡ç­¾ä¸€ä¸ªDataRegionServiceKey ï¼Œæœ€åå¾—åˆ° SigningKey.</li><li>ç”¨ç¬¬ä¸‰æ­¥çš„ SigningKeyæ¥å¯¹ç¬¬äºŒæ­¥çš„ StringToSign ç­¾åã€‚</li></ol><p><img src="https://i.loli.net/2020/02/01/5I6qCO1NBF9aQm3.png" alt="fig2.png"></p><p>è¿™ç§è®¤è¯çš„æ–¹å¼å¥½å¤„åœ¨äºï¼ŒAppIDå’ŒAppSecretKeyï¼Œæ˜¯ç”±æœåŠ¡å™¨çš„ç³»ç»Ÿå¼€å‡ºçš„ï¼Œæ‰€ä»¥ï¼Œæ˜¯å¯ä»¥è¢«ç®¡ç†çš„ï¼ŒAWSçš„IAMå°±æ˜¯ç›¸å…³çš„ç®¡ç†ï¼Œå…¶ç®¡ç†äº†ç”¨æˆ·ã€æƒé™å’Œå…¶å¯¹åº”çš„AppIDå’ŒAppSecretKeyã€‚ä½†æ˜¯ä¸å¥½çš„åœ°æ–¹åœ¨äºï¼Œè¿™ä¸ªä¸œè¥¿æ²¡æœ‰æ ‡å‡† ï¼Œæ‰€ä»¥ï¼Œå„å®¶çš„å®ç°å¾ˆä¸ä¸€è‡´ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://en.wikipedia.org/wiki/HMAC" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/HMAC</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(ä¸‰) - Digest Access</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%89-Digest-Access/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%89-Digest-Access/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>HTTP æ‘˜è¦è®¤è¯.è¿™ç§æ–¹å¼å¯ä»¥åœ¨å‘é€å„ç§æ•æ„Ÿä¿¡æ¯ä¹‹å‰å…ˆç¡®è®¤ç”¨æˆ·çš„èº«ä»½ã€‚å…¶ä¼šå…ˆç»™ç”¨æˆ·åå¯†ç åŠ ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼›è€ŒHTTP basicæ–¹å¼ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ç›´æ¥ä½¿ç”¨äº†ç®€å•å¯é€†çš„Base64ç¼–ç æŠ€æœ¯è€Œä¸æ˜¯ä»»ä½•åŠ å¯†æŠ€æœ¯ï¼Œä½¿å¾—æ•´ä¸ªè¿‡ç¨‹éå¸¸ä¸å®‰å…¨ï¼Œé™¤éæ˜¯åœ¨HTTPSçš„æ¡ä»¶ä¸‹ã€‚ (Transport Layer Security)</p><p>åˆ’é‡ç‚¹: </p><ul><li>MD5 åŠ å¯†å“ˆå¸Œ</li><li>ä½¿ç”¨nonce(éšæœºæ•°) é¿å…é‡å¤æ”»å‡»</li></ul><h1 id="2-æµç¨‹"><a href="#2-æµç¨‹" class="headerlink" title="2. æµç¨‹"></a>2. æµç¨‹</h1><ul><li>è¯·æ±‚æ–¹å°†ç”¨æˆ·åå£ä»¤å’ŒåŸŸåšä¸€ä¸ªMD5å“ˆå¸Œ<code>MD5(username:realm:password)</code> ç„¶åå‘ç»™æœåŠ¡å™¨</li><li>é—®é¢˜æ˜¯ç”¨æˆ·åå£ä»¤ä¸æ€ä¹ˆå˜çš„è¯é‚£è¿™ä¸ªå­—ç¬¦ä¸²ä¹Ÿä¼šä¸æ”¹å˜</li><li>å› æ­¤åœ¨è®¤è¯è¿‡ç¨‹å½“ä¸­åŠ å…¥äº†nonceå’Œqop</li></ul><h2 id="2-1-Clientå‘èµ·è¯·æ±‚-æ— è®¤è¯"><a href="#2-1-Clientå‘èµ·è¯·æ±‚-æ— è®¤è¯" class="headerlink" title="2.1 Clientå‘èµ·è¯·æ±‚(æ— è®¤è¯)"></a>2.1 Clientå‘èµ·è¯·æ±‚(æ— è®¤è¯)</h2><p>å‘ç”Ÿåœ¨Clientç›´æ¥è¿›å…¥ä¸€ä¸ªéœ€è¦è®¤è¯çš„ç½‘é¡µï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰æºå¸¦ç”¨æˆ·åå’Œå¯†ç çš„ä¿¡æ¯</p><pre><code>GET /dir/index.html HTTP/1.0Host: localhost</code></pre><h2 id="2-2-Serverè¿”å›é”™è¯¯ä¿¡æ¯401"><a href="#2-2-Serverè¿”å›é”™è¯¯ä¿¡æ¯401" class="headerlink" title="2.2 Serverè¿”å›é”™è¯¯ä¿¡æ¯401"></a>2.2 Serverè¿”å›é”™è¯¯ä¿¡æ¯401</h2><p>401ä»£è¡¨çš„æ˜¯æœªè®¤è¯ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›401ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨Response Headeré‡Œæºå¸¦<code>WWW-Authenticate</code>åŸŸ,å«æœ‰è®¤è¯çš„realmçš„ä¿¡æ¯ï¼Œä»¥åŠä¸€ä¸ªéšæœºç”Ÿæˆçš„nonce</p><pre><code>HTTP/1.0 401 UnauthorizedServer: HTTPd/0.9Date: Sun, 10 Apr 2014 20:26:47 GMTWWW-Authenticate: Digest realm=&quot;testrealm@host.com&quot;,                        qop=&quot;auth,auth-int&quot;,                        nonce=&quot;dcd98b7102dd2f0e8b11d0f600bfb0c093&quot;,                        opaque=&quot;5ccc069c403ebaf9f0171e9517f40e41&quot;Content-Type: text/htmlContent-Length: 153&lt;!DOCTYPE html&gt;&lt;html&gt;  &lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot; /&gt;    &lt;title&gt;Error&lt;/title&gt;  &lt;/head&gt;  &lt;body&gt;    &lt;h1&gt;401 Unauthorized.&lt;/h1&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="2-3-Clientè¾“å…¥ä¿¡æ¯ï¼Œå‘é€æ–°è¯·æ±‚"><a href="#2-3-Clientè¾“å…¥ä¿¡æ¯ï¼Œå‘é€æ–°è¯·æ±‚" class="headerlink" title="2.3 Clientè¾“å…¥ä¿¡æ¯ï¼Œå‘é€æ–°è¯·æ±‚"></a>2.3 Clientè¾“å…¥ä¿¡æ¯ï¼Œå‘é€æ–°è¯·æ±‚</h2><pre><code>GET /dir/index.html HTTP/1.0Host: localhostAuthorization: Digest username=&quot;Mufasa&quot;,                     realm=&quot;testrealm@host.com&quot;,                     nonce=&quot;dcd98b7102dd2f0e8b11d0f600bfb0c093&quot;,                     uri=&quot;/dir/index.html&quot;,                     qop=auth,                     nc=00000001,                     cnonce=&quot;0a4f113b&quot;,                     response=&quot;6629fae49393a05397450978507c4ef1&quot;,                     opaque=&quot;5ccc069c403ebaf9f0171e9517f40e41&quot;</code></pre><p>è¿™é‡Œçš„è®¡ç®—æ–¹å¼å¦‚ä¸‹:</p><pre><code>HA1 = MD5(username:realm:password)HA2 = MD5(method:digestURI)// è¿™ä¸€æ­¥å¯ä»¥æœ‰æ›´å¤šçš„å€¼ä¸€èµ·åšhashï¼Œæ¯”å¦‚ server nonce, request counter, client nonce, qop (quality of protection code)response = MD5(HA1:nonce:HA2)</code></pre><p>å€¼å¾—æ³¨æ„çš„æ˜¯nonceéœ€è¦éš”ä¸€æ®µæ—¶é—´å°±å¤±æ•ˆï¼Œrequest counterè¦ç´¯åŠ ï¼Œä»¥æ­¤å°½é‡ä½¿å…¶æ›´åŠ å®‰å…¨</p><h2 id="2-4-Serverè¿”å›è®¤è¯æˆåŠŸçš„ä¿¡æ¯"><a href="#2-4-Serverè¿”å›è®¤è¯æˆåŠŸçš„ä¿¡æ¯" class="headerlink" title="2.4 Serverè¿”å›è®¤è¯æˆåŠŸçš„ä¿¡æ¯"></a>2.4 Serverè¿”å›è®¤è¯æˆåŠŸçš„ä¿¡æ¯</h2><pre><code>HTTP/1.0 200 OKServer: HTTPd/0.9Date: Sun, 10 Apr 2005 20:27:03 GMTContent-Type: text/htmlContent-Length: 7984</code></pre><h1 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a>3. æ€»ç»“</h1><p>æ‘˜è¦è®¤è¯è¿™ä¸ªæ–¹å¼ä¼šæ¯”ä¹‹å‰çš„æ–¹å¼è¦å¥½ä¸€äº›ï¼Œå› ä¸ºæ²¡æœ‰åœ¨ç½‘ä¸Šä¼ é€’ç”¨æˆ·çš„å¯†ç ï¼Œè€Œåªæ˜¯æŠŠå¯†ç çš„MD5ä¼ é€è¿‡å»ï¼Œç›¸å¯¹ä¼šæ¯”è¾ƒå®‰å…¨ï¼Œè€Œä¸”ï¼Œå…¶å¹¶ä¸éœ€è¦æ˜¯å¦TLS/SSLçš„å®‰å…¨é“¾æ¥ã€‚ä½†æ˜¯ï¼Œåˆ«çœ‹è¿™ä¸ªç®—æ³•è¿™ä¹ˆå¤æ‚ï¼Œæœ€åä½ å¯ä»¥å‘ç°ï¼Œæ•´ä¸ªè¿‡ç¨‹å…¶å®å…³é”®æ˜¯ç”¨æˆ·çš„passwordï¼Œè¿™ä¸ªpasswordå¦‚æœä¸å¤Ÿå¾—æ‚ï¼Œå…¶å®æ˜¯å¯ä»¥è¢«æš´åŠ›ç ´è§£çš„ï¼Œè€Œä¸”ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯éå¸¸å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»â€”â€”æ¯”å¦‚ä¸€ä¸ªä¸­é—´äººå‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦ä¸€ä¸ªã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://en.wikipedia.org/wiki/Digest_access_authentication" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Digest_access_authentication</a></li><li><a href="https://tools.ietf.org/html/rfc2617" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc2617</a></li><li><a href="https://tools.ietf.org/html/rfc2069" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc2069</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(äºŒ) - HTTP Basic</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%BA%8C-HTTP-Basic/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%BA%8C-HTTP-Basic/</url>
      
        <content type="html"><![CDATA[<h1 id="1-HTTP-Basic-Intro"><a href="#1-HTTP-Basic-Intro" class="headerlink" title="1. HTTP Basic Intro"></a>1. HTTP Basic Intro</h1><p>ä¼ ç»Ÿçš„APIè®¤è¯æŠ€æœ¯ï¼Œä½¿ç”¨usernameå’Œpasswordæ¥è¿›è¡Œç™»å½•ã€‚</p><p>æ•´ä¸ªæµç¨‹æ˜¯ï¼š</p><ul><li>ç”¨æˆ·å‘é€ä¸€ä¸ªä¸å¸¦è®¤è¯ä¿¡æ¯çš„è¯·æ±‚</li><li>æœåŠ¡å™¨è¿”å›401(unauthorized)çŠ¶æ€ï¼Œç„¶åä¼šåœ¨headeré‡Œé¢åŒ…å«ä¸€ä¸ª<code>WWW-authenticate</code>åŸŸ</li><li>ç”¨æˆ·å¦‚æœæƒ³è®¤è¯è‡ªå·±ï¼Œå°±éœ€è¦å‘ä¸€ä¸ªæºå¸¦æœ‰è®¤è¯è¯·æ±‚headerçš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«äº†credentialsçš„ä¿¡æ¯ã€‚</li><li>é€šå¸¸ä¼šè®©ç”¨æˆ·è¾“å…¥å¯†ç ï¼Œç„¶åå°†è¿™äº›ä¿¡æ¯æ”¾åˆ°Authorizationçš„headerå½“ä¸­å»</li></ul><p><img src="https://i.loli.net/2020/02/01/NE6ihK9GQpjrw7P.png" alt="fig1.png"></p><p>åœ¨ä¸Šè¿°çš„æ•´ä¸ªæµç¨‹å½“ä¸­ï¼Œå› ä¸ºç›¸å½“äºæ˜æ–‡ä¼ è¾“äº†ï¼Œæ‰€ä»¥è¿™æ•´ä¸ªè¿‡ç¨‹å¿…é¡»å‘ç”Ÿåœ¨HTTPS(TLS)è¿æ¥å½“ä¸­ã€‚</p><h1 id="2-æŠ€æœ¯åŸç†"><a href="#2-æŠ€æœ¯åŸç†" class="headerlink" title="2.æŠ€æœ¯åŸç†"></a>2.æŠ€æœ¯åŸç†</h1><ul><li>è¿›è¡ŒBase64ç¼–ç <ul><li>Base64ç¼–ç æ˜¯ä¸ºäº†å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼Œæ–¹ä¾¿åœ¨ä¸åŒå¹³å°ç”¨ä¸åŒæ–¹å¼è¿›è¡Œä¼ é€’çš„ï¼Œå…¶ç¼–ç æ–¹å¼æ˜¯å¯é€†çš„ï¼Œå³å¯ä»¥å¾ˆé¡ºç•…åœ°è¢«ç ´è§£æ‰ã€‚ </li></ul></li><li>å°†ç¼–ç åçš„å­—æ®µæ”¾åˆ°HTTPå¤´çš„Authorizationå­—æ®µä¸­ï¼Œå‘åˆ°æœåŠ¡ç«¯</li><li>æœåŠ¡ç«¯è¿›è¡Œè®¤è¯ï¼ŒæˆåŠŸåˆ™è¿”å›200ï¼›å¤±è´¥åˆ™è¿”å›401æŠ¥é”™</li></ul><p>ä½¿ç”¨Base64æ˜¯ä¸ºäº†æ¶ˆé™¤ç‰¹æ®Šå­—ç¬¦å¸¦æ¥çš„å½±å“ï¼Œè¿™ç§ä¼ é€’æ–¹å¼æœ€å¤§çš„é—®é¢˜æ˜¯å°†ç”¨æˆ·åå’Œå£ä»¤æ”¾åˆ°äº†ç½‘ç»œä¸Šè¿›è¡Œä¼ é€’ï¼Œå› æ­¤ä¸€èˆ¬éœ€è¦é…åˆTLS/ SSLçš„å®‰å…¨åŠ å¯†æ¥ä½¿ç”¨ã€‚è¿™ç§åŒæ—¶å°†ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œæ˜æ–‡ä¼ è¾“çš„åè®®å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œå°½ç®¡æœ‰HTTPSä½œä¸ºå®‰å…¨ä¿æŠ¤ï¼Œä½†è¿˜æ˜¯å¾ˆæœ‰é£é™©çš„ã€‚ </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://en.wikipedia.org/wiki/Basic_access_authentication" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Basic_access_authentication</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP APIè®¤è¯ä¸æˆæƒ(ä¸€) - general</title>
      <link href="/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%80-general/"/>
      <url>/HTTP-API%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83-%E4%B8%80-general/</url>
      
        <content type="html"><![CDATA[<p>HTTPæœ¬èº«æ˜¯æ— çŠ¶æ€çš„ï¼Œä½†æˆ‘ä»¬å¸¸å¸¸éœ€è¦æ£€æŸ¥ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼ŒæœåŠ¡å™¨ä¼šå‘ä¸€ä¸ªç™»å½•å‡­è¯(Token)ã€‚åœ¨è®¡ç®—æœºçš„ä¸–ç•Œå½“ä¸­ï¼Œè¿™ä¸ªTokençš„ç›¸å…³æ•°æ®ä¼šæ”¾åˆ°ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªåœ¨ç”¨æˆ·ç«¯ï¼Œä»¥Cookieçš„æ–¹å¼ï¼Œå¦ä¸€ä¸ªæ˜¯æ”¾åœ¨æœåŠ¡å™¨ç«¯ï¼Œä»¥Sessionçš„æ–¹å¼ã€‚</p><p>ç°å®ä¸–ç•Œä¸­éªŒè¯ç™»å½•ä¼šæ›´ä¸ºå¤æ‚ä¸€äº›ï¼Œå› ä¸ºé™¤äº†ç”¨æˆ·è®¿é—®ï¼Œè¿˜æœ‰ç”¨æˆ·å§”æ‰˜çš„ç¬¬ä¸‰æ–¹çš„åº”ç”¨ï¼Œè¿˜æœ‰ä¼ä¸šä¹‹é—´çš„è°ƒç”¨ã€‚</p><p>å¾ˆå¤šå¾ˆæœ‰æ„æ€çš„é—®é¢˜ï¼š </p><ul><li>è®¤è¯ä¸æˆæƒå„è‡ªæŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ </li><li>åœ¨æˆ‘ä»¬æ²¡æœ‰TLS/ SSLçš„æ—¶å€™æˆ‘ä»¬æ˜¯å¦‚ä½•å®ç°ç™»å½•éªŒè¯ï¼Œå¹¶ä¸”å¯¹åœ¨ç½‘ç»œä¸­ä¼ é€’çš„ä¿¡æ¯è¿›è¡ŒåŠ å¯†çš„å‘¢ï¼Ÿ </li><li>HTTPSç»™æ•´ä¸ªè®¤è¯ä¸æˆæƒçš„è¿‡ç¨‹å¸¦æ¥äº†æ€æ ·çš„æ”¹å˜ï¼Ÿ </li><li>æˆ‘ä»¬å¸¸çœ‹åˆ°çš„é€šè¿‡å¾®ä¿¡/ google/ facebook/ amazonç™»å½•æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ<br>è¿™ä¸€ç³»åˆ—çš„åšå®¢ä¼šä¾æ¬¡é€ä¸ªè§£å†³ä¸Šé¢æè¿°çš„é—®é¢˜ï¼Œinspired by <a href="https://coolshell.cn/articles/19395.html" target="_blank" rel="noopener">CoolShell-HTTP API è®¤è¯æˆæƒæœ¯</a>. æ˜¯å¯¹è¿™ç¯‡åšå®¢çš„é’ˆå¯¹è‡ªå·±ç°æœ‰è®¤çŸ¥æ°´å¹³ï¼ˆå•¥éƒ½ä¸æ‡‚ï¼‰çš„æœ‰æ•ˆæ‰©å……ï¼Œå¸Œæœ›é€šè¿‡è¿™ä¸€ç³»åˆ—çš„æ•´ç†å½»åº•ææ‡‚æ•´ä¸ªAPIè®¤è¯ä¸æˆæƒçš„æœºåˆ¶ï¼Œæ•æ„Ÿä¿¡æ¯åœ¨clientå’Œserverä¹‹é—´çš„ä¼ é€’ã€‚</li></ul><p>æœ¬ç³»åˆ—çš„åšå®¢ä¼šå¤§è‡´ä¸Šåˆ†ä¸º6éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li>HTTP Basic </li><li>Digest Access</li><li>App Secret Key + HMAC</li><li>JWT</li><li>OAuth 1.0</li><li>OAuth 2.0 </li></ul><p>å¸Œæœ›èƒ½å¯¹å¤§å®¶æœ‰æ‰€è£¨ç›Šã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://coolshell.cn/articles/19395.html" target="_blank" rel="noopener">https://coolshell.cn/articles/19395.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> è®¤è¯æˆæƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œçŸ¥è¯†å¿…çŸ¥å¿…ä¼š</title>
      <link href="/%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
      <url>/%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œå¸Œæœ›å°†å¤§éƒ¨åˆ†ç½‘ç»œçŸ¥è¯†åšä¸ªæ€»ç»“ï¼Œredirectåˆ°å„ç¯‡åšæ–‡å½“ä¸­å»ã€‚</p><p>é¦–å…ˆå½“æˆ‘ä»¬è°ˆåŠæ•´ä¸ªç½‘ç»œçš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¨è®ºçš„åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘æƒ³å¤§å®¶æƒ³è¦äº†è§£ç½‘ç»œçŸ¥è¯†å¾€å¾€å¼€å§‹äºé‡åˆ°Server, Clientç«¯çš„äº¤äº’é—®é¢˜ï¼Œé‡åˆ°Tomcat, Socketç¼–ç¨‹è¿™ç±»ä¸œè¥¿ã€‚å…³äºå¦‚ä½•äº†è§£ç½‘ç»œå­¦ä¹ ç½‘ç»œçŸ¥è¯†ï¼ŒåŠ¿å¿…éœ€è¦å…ˆæœ‰ä¸ªå®è§‚çš„viewï¼Œè€Œåå†åˆ†åˆ°å„ä¸ªéƒ¨åˆ†å»äº†è§£æ›´å¤šçš„ç»†èŠ‚ã€‚æ•´ä¸ªä½“ç³»åº”è¯¥å°±æ˜¯è¿™æ ·æ…¢æ…¢å»ºç«‹èµ·æ¥çš„ï¼Œè¿™é‡Œåšä¸ªç´¢å¼•ï¼Œå¸¦ä¸€äº›æˆ‘è®¤ä¸ºæœ€æœ€å…³é”®çš„çŸ¥è¯†ç‚¹ä»¬ã€‚</p><h1 id="1-ç½‘ç»œå±‚çº§æ¨¡å‹"><a href="#1-ç½‘ç»œå±‚çº§æ¨¡å‹" class="headerlink" title="1. ç½‘ç»œå±‚çº§æ¨¡å‹"></a>1. ç½‘ç»œå±‚çº§æ¨¡å‹</h1><ul><li><a href="https://llchen60.com/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%8C-%E7%89%A9%E7%90%86%E5%B1%82/" target="_blank" rel="noopener">ç‰©ç†å±‚</a><ul><li>LAN, WAN </li></ul></li><li><a href="https://llchen60.com/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%B8%89-%E9%93%BE%E8%B7%AF%E5%B1%82/" target="_blank" rel="noopener">é“¾è·¯å±‚</a><ul><li>MAC - Medium Access Control  </li><li>ARPåè®® - å·²çŸ¥ç›®æ ‡IPåœ°å€ï¼Œå¯»æ±‚MACåœ°å€ </li><li>äº¤æ¢æœº - å¸¦æœ‰è®°å¿†åŠŸèƒ½çš„é›†çº¿å™¨ - è®°å½•MACåœ°å€<ul><li>è½¬å‘è¡¨ - è¿‡æœŸæ—¶é—´ </li></ul></li></ul></li><li><a href="https://llchen60.com/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%9B%9B-%E7%BD%91%E7%BB%9C%E5%B1%82/" target="_blank" rel="noopener">ç½‘ç»œå±‚</a><ul><li>IPåè®®<ul><li>CIDRæ— ç±»å‹åŸŸé—´é€‰è·¯   <ul><li>ç½‘ç»œå· + ä¸»æœºå· </li></ul></li><li>DHCPåŠ¨æ€ä¸»æœºé…ç½®åè®®</li></ul></li><li>ICMPåè®® Inernet Control Message Protocol<ul><li>äº’è”ç½‘æ§åˆ¶æŠ¥æ–‡åè®®</li></ul></li><li>è·¨ç½‘å…³è®¿é—® </li></ul></li><li><a href="https://llchen60.com/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E4%BA%94-%E4%BC%A0%E8%BE%93%E5%B1%82/" target="_blank" rel="noopener">ä¼ è¾“å±‚</a><ul><li>UDPåè®®</li><li>TCPåè®®</li><li>å¥—æ¥å­—Socket</li></ul></li><li><a href="https://llchen60.com/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE-%E5%85%AD-%E5%BA%94%E7%94%A8%E5%B1%82/" target="_blank" rel="noopener">åº”ç”¨å±‚</a><ul><li>HTTPåè®® </li><li>HTTPS</li><li>QUIC</li></ul></li></ul><h1 id="2-ç½‘ç»œç›¸å…³çš„åº”ç”¨"><a href="#2-ç½‘ç»œç›¸å…³çš„åº”ç”¨" class="headerlink" title="2. ç½‘ç»œç›¸å…³çš„åº”ç”¨"></a>2. ç½‘ç»œç›¸å…³çš„åº”ç”¨</h1><ul><li>æµåª’ä½“åè®®</li><li>æ•°æ®ä¸­å¿ƒ</li><li>VPN</li><li>ç§»åŠ¨ç½‘ç»œ</li><li>äº‘</li><li>RPC SOAP RESTFul</li></ul>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><p>Composed of simple characters, or a combination of simple and special characters. </p><h1 id="2-Using-simple-patterns"><a href="#2-Using-simple-patterns" class="headerlink" title="2. Using simple patterns"></a>2. Using simple patterns</h1><p>constructed of characters for which you want to find a <strong><em>direct match</em></strong>. For example, the pattern /abc/ matches character combinations in strings only when exactly the characters â€˜abcâ€™ occur together and in that order. Such a match would succeed in the strings â€œHi, do you know your abcâ€™s?â€ and â€œThe latest airplane designs evolved from slabcraft.â€ In both cases the match is with the substring â€˜abcâ€™. There is no match in the string â€˜Grab crabâ€™ because while it contains the substring â€˜ab câ€™, it does not contain the exact substring â€˜abcâ€™.</p><h1 id="3-Using-special-characters"><a href="#3-Using-special-characters" class="headerlink" title="3. Using special characters"></a>3. Using special characters</h1><p>Whne your search need more than a direct match. Now detailing special characters in regular expressions: </p><h2 id="3-1-â€“-gt-Indicate-next-character-is-special"><a href="#3-1-â€“-gt-Indicate-next-character-is-special" class="headerlink" title="3.1 \  â€“&gt; Indicate next character is special"></a>3.1 \  â€“&gt; Indicate next character is special</h2><ol><li>A backslash that precedes a non-special character indicates that <strong>the next character is special</strong> and <strong>is not to be interpreted literally</strong>.</li></ol><h2 id="3-2-â€“-gt-Matches-beginning-of-input"><a href="#3-2-â€“-gt-Matches-beginning-of-input" class="headerlink" title="3.2 ^  â€“&gt; Matches beginning of input"></a>3.2 ^  â€“&gt; Matches beginning of input</h2><p>For example, <code>/^A/</code> does not match the â€˜Aâ€™ in â€œan Aâ€, but does match the â€˜Aâ€™ in â€œAn Eâ€.</p><h2 id="3-3-â€“-gt-matches-end-of-input"><a href="#3-3-â€“-gt-matches-end-of-input" class="headerlink" title="3.3 $ â€“&gt; matches end of input"></a>3.3 $ â€“&gt; matches end of input</h2><p>For example, <code>/t$/</code> does not match the â€˜tâ€™ in â€œeaterâ€, but does match it in â€œeatâ€.</p><h2 id="3-4-â€“-gt-matches-the-preceding-expression-0-or-more-times-Equal-to-0"><a href="#3-4-â€“-gt-matches-the-preceding-expression-0-or-more-times-Equal-to-0" class="headerlink" title="3.4 * â€“&gt; matches the preceding expression 0 or more times. Equal to {0,}"></a>3.4 * â€“&gt; matches the preceding expression 0 or more times. Equal to {0,}</h2><p>For example, /bo*/ matches â€˜booooâ€™ in â€œA ghost booooedâ€ and â€˜bâ€™ in â€œA bird warbledâ€ but nothing in â€œA goat gruntedâ€.</p><h2 id="3-5-â€“-gt-matches-the-preceding-expression-1-or-more-times-Equals-t0-1"><a href="#3-5-â€“-gt-matches-the-preceding-expression-1-or-more-times-Equals-t0-1" class="headerlink" title="3.5 + â€“&gt; matches the preceding expression 1 or more times. Equals t0 {1,}"></a>3.5 + â€“&gt; matches the preceding expression 1 or more times. Equals t0 {1,}</h2><p>For example, <code>/a+/</code> matches the â€˜aâ€™ in â€œcandyâ€ and all the aâ€™s in â€œcaaaaaaandyâ€, but nothing in â€œcndyâ€.</p><h2 id="3-6-â€“-gt-matches-the-preceding-expression-0-or-1-time-Equivalent-to-0-1"><a href="#3-6-â€“-gt-matches-the-preceding-expression-0-or-1-time-Equivalent-to-0-1" class="headerlink" title="3.6 ? â€“&gt; matches the preceding expression 0 or 1 time. Equivalent to {0,1}"></a>3.6 ? â€“&gt; matches the preceding expression 0 or 1 time. Equivalent to {0,1}</h2><p>For example, /e?le?/ matches the â€˜elâ€™ in â€œangelâ€ and the â€˜leâ€™ in â€œangleâ€ and also the â€˜lâ€™ in â€œosloâ€.</p><p>If used immediately after any of the quantifiers <em>, +, ?, or {}, makes the quantifier *</em>non-greedy** (matching the fewest possible characters), as opposed to the default, which is greedy (matching as many characters as possible). For example, applying /\d+/ to â€œ123abcâ€ matches â€œ123â€. But applying /\d+?/ to that same string matches only the â€œ1â€.</p><h2 id="3-7-â€“-gt-matches-any-single-character-except-the-newline-character"><a href="#3-7-â€“-gt-matches-any-single-character-except-the-newline-character" class="headerlink" title="3.7 . â€“&gt; matches any single character except the newline character"></a>3.7 . â€“&gt; matches any single character except the newline character</h2><p>For example, /.n/ matches â€˜anâ€™ and â€˜onâ€™ in â€œnay, an apple is on the treeâ€, but not â€˜nayâ€™.</p><h2 id="3-8-x-â€“-gt-Matches-â€˜xâ€™-and-remembers-the-match-as-the-following-example-shows"><a href="#3-8-x-â€“-gt-Matches-â€˜xâ€™-and-remembers-the-match-as-the-following-example-shows" class="headerlink" title="3.8 (x) â€“&gt; Matches â€˜xâ€™ and remembers the match, as the following example shows."></a>3.8 (x) â€“&gt; Matches â€˜xâ€™ and remembers the match, as the following example shows.</h2><p>The parentheses are called capturing parentheses. </p><p>The â€˜(foo)â€™ and â€˜(bar)â€™ in the pattern /(foo) (bar) \1 \2/ match and remember the first two words in the string â€œfoo bar foo barâ€. The \1 and \2  denote the first and second parenthesized substring matches - foo and bar, matching the stringâ€™s last two words. Note that \1, \2, â€¦, \n are used in the matching part of the regex, for more information, see \n below. In the replacement part of a regex the syntax $1, $2, â€¦, $n must be used, e.g.: â€˜bar fooâ€™.replace(/(â€¦) (â€¦)/, â€˜$2 $1â€™).  $&amp; means the whole matched string.</p><h2 id="3-9-x-â€“-gt-Matches-â€˜xâ€™-but-does-not-remember-the-match"><a href="#3-9-x-â€“-gt-Matches-â€˜xâ€™-but-does-not-remember-the-match" class="headerlink" title="!!! 3.9 (?:x) â€“&gt; Matches â€˜xâ€™ but does not remember the match"></a>!!! 3.9 (?:x) â€“&gt; Matches â€˜xâ€™ but does not remember the match</h2><p>The parentheses are called non-capturing parentheses, and let you define subexpressions for regular expression operators to work with. </p><p>Matches â€˜xâ€™ but does not remember the match. The parentheses are called non-capturing parentheses, and let you define subexpressions for regular expression operators to work with. Consider the sample expression /(?:foo){1,2}/. If the expression was /foo{1,2}/, the {1,2} characters would apply only to the last â€˜oâ€™ in â€˜fooâ€™. With the non-capturing parentheses, the {1,2} applies to the entire word â€˜fooâ€™.</p><h2 id="3-10-x-y-â€“-gt-matches-â€˜xâ€™-only-id-â€˜xâ€™-is-followed-by-â€˜yâ€™"><a href="#3-10-x-y-â€“-gt-matches-â€˜xâ€™-only-id-â€˜xâ€™-is-followed-by-â€˜yâ€™" class="headerlink" title="3.10 x(?=y) â€“&gt; matches â€˜xâ€™ only id â€˜xâ€™ is followed by â€˜yâ€™"></a>3.10 x(?=y) â€“&gt; matches â€˜xâ€™ only id â€˜xâ€™ is followed by â€˜yâ€™</h2><p>For example, /Jack(?=Sprat)/ matches â€˜Jackâ€™ only if it is followed by â€˜Spratâ€™. /Jack(?=Sprat|Frost)/ matches â€˜Jackâ€™ only if it is followed by â€˜Spratâ€™ or â€˜Frostâ€™. However, neither â€˜Spratâ€™ nor â€˜Frostâ€™ is part of the match results.</p><h2 id="3-11-x-y-â€“-gt-matches-â€˜xâ€™-only-if-â€˜xâ€™-is-not-followed-by-â€˜yâ€™"><a href="#3-11-x-y-â€“-gt-matches-â€˜xâ€™-only-if-â€˜xâ€™-is-not-followed-by-â€˜yâ€™" class="headerlink" title="3.11  x(?!y) â€“&gt; matches â€˜xâ€™ only if â€˜xâ€™ is not followed by â€˜yâ€™"></a>3.11  x(?!y) â€“&gt; matches â€˜xâ€™ only if â€˜xâ€™ is not followed by â€˜yâ€™</h2><p>For example, <code>/\d+(?!\.)/</code> matches a number only if it is not followed by a decimal point. The regular expression <code>/\d+(?!\.)/.exec(&quot;3.141&quot;)</code> matches â€˜141â€™ but not â€˜3.141â€™.</p><h2 id="3-12-x-y-â€“-gt-matches-x-or-y-if-there-is-no-match-for-â€˜xâ€™"><a href="#3-12-x-y-â€“-gt-matches-x-or-y-if-there-is-no-match-for-â€˜xâ€™" class="headerlink" title="3.12 x|y â€“&gt; matches x or y(if there is no match for â€˜xâ€™)"></a>3.12 x|y â€“&gt; matches x or y(if there is no match for â€˜xâ€™)</h2><p>For example, /green|red/ matches â€˜greenâ€™ in â€œgreen appleâ€ and â€˜redâ€™ in â€œred apple.â€ The order of â€˜xâ€™ and â€˜yâ€™ matters. For example a<em>|b matches the empty string in â€œbâ€, but b|a</em> matches â€œbâ€ in the same string.</p><h2 id="3-13-n-â€“-gt-matches-exactly-n-occurences-of-the-preceding-expression"><a href="#3-13-n-â€“-gt-matches-exactly-n-occurences-of-the-preceding-expression" class="headerlink" title="3.13 {n} â€“&gt; matches exactly n occurences of the preceding expression."></a>3.13 {n} â€“&gt; matches exactly n occurences of the preceding expression.</h2><p>For example, /a{2}/ doesnâ€™t match the â€˜aâ€™ in â€œcandy,â€ but it does match all of the aâ€™s in â€œcaandy,â€ and the first two aâ€™s in â€œcaaandy.â€</p><h2 id="3-14-n-â€“-gt-matches-at-least-n-occurrences-of-the-preceding-expression"><a href="#3-14-n-â€“-gt-matches-at-least-n-occurrences-of-the-preceding-expression" class="headerlink" title="3.14 {n,} â€“&gt; matches at least n occurrences of the preceding expression."></a>3.14 {n,} â€“&gt; matches at least n occurrences of the preceding expression.</h2><p>For example, /a{2,}/ will match â€œaaâ€, â€œaaaaâ€ and â€œaaaaaâ€ but not â€œaâ€</p><h2 id="3-15-n-m-â€“-gt-matches-at-least-n-and-at-more-m-occurrences-of-the-preceding-expression"><a href="#3-15-n-m-â€“-gt-matches-at-least-n-and-at-more-m-occurrences-of-the-preceding-expression" class="headerlink" title="3.15 {n,m} â€“&gt; matches at least n and at more m occurrences of the preceding expression."></a>3.15 {n,m} â€“&gt; matches at least n and at more m occurrences of the preceding expression.</h2><p>For example, /a{1,3}/ matches nothing in â€œcndyâ€, the â€˜aâ€™ in â€œcandy,â€ the first two aâ€™s in â€œcaandy,â€ and the first three aâ€™s in â€œcaaaaaaandyâ€. Notice that when matching â€œcaaaaaaandyâ€, the match is â€œaaaâ€, even though the original string had more aâ€™s in it.</p><h2 id="3-16-xyz-â€“-gt-matches-any-one-of-the-characters-in-the-brackets"><a href="#3-16-xyz-â€“-gt-matches-any-one-of-the-characters-in-the-brackets" class="headerlink" title="3.16 [xyz] â€“&gt; matches any one of the characters in the brackets"></a>3.16 [xyz] â€“&gt; matches any one of the characters in the brackets</h2><p>The pattern [a-d], which performs the same match as [abcd], matches the â€˜bâ€™ in â€œbrisketâ€ and the â€˜câ€™ in â€œcityâ€. The patterns /[a-z.]+/ and /[\w.]+/ match the entire string â€œtest.i.ngâ€.</p><h2 id="3-17-xyz-â€“-gt-matches-anything-that-is-not-enclosed-in-the-brackets"><a href="#3-17-xyz-â€“-gt-matches-anything-that-is-not-enclosed-in-the-brackets" class="headerlink" title="3.17 [^xyz] â€“&gt; matches anything that is not enclosed in the brackets"></a>3.17 [^xyz] â€“&gt; matches anything that is not enclosed in the brackets</h2><p>For example, [^abc] is the same as [^a-c]. They initially match â€˜râ€™ in â€œbrisketâ€ and â€˜hâ€™ in â€œchop.â€</p><h2 id="3-18-b-â€“-gt-matches-a-backspace"><a href="#3-18-b-â€“-gt-matches-a-backspace" class="headerlink" title="3.18 [\b] â€“&gt; matches a backspace"></a>3.18 [\b] â€“&gt; matches a backspace</h2><p>You need to use square brackets if you want to match a literal backspace character. (Not to be confused with \b.)</p><h2 id="3-19-b-â€“-gt-matches-a-word-boundary"><a href="#3-19-b-â€“-gt-matches-a-word-boundary" class="headerlink" title="3.19 \b â€“&gt; matches a word boundary"></a>3.19 \b â€“&gt; matches a word boundary</h2><p><strong><em>A word boundary matches the position between a word character followed by a non-word character</em></strong></p><p>Examples using the input string â€œmoonâ€:<br>/\bm/ matches, because the <code>\b</code> is at the beginning of the string;<br>the â€˜\bâ€™ in /oo\b/ does not match, because the â€˜\bâ€™ is both preceded and followed by word characters;<br>the â€˜\bâ€™ in /oon\b/ matches, because it appears at the end of the string;<br>the â€˜\b\ in /\w\b\w/ will never match anything, because it is both preceded and followed by a word character..</p><h2 id="3-20-B-â€“-gt-matches-a-non-word-boundary"><a href="#3-20-B-â€“-gt-matches-a-non-word-boundary" class="headerlink" title="3.20 \B â€“&gt; matches a non-word boundary"></a>3.20 \B â€“&gt; matches a non-word boundary</h2><p>matches the following case: </p><ul><li>Before the first character of the string.</li><li>After the last character of the string,.</li><li>Between two word characters</li><li>Between two non-word characters</li><li>The empty string</li></ul><h2 id="3-21-d-â€“-gt-matches-a-digit-chracter"><a href="#3-21-d-â€“-gt-matches-a-digit-chracter" class="headerlink" title="3.21 \d â€“&gt; matches a digit chracter"></a>3.21 \d â€“&gt; matches a digit chracter</h2><p>Equal to [0-9]</p><p>For example, /\d/ or /[0-9]/ matches â€˜2â€™ in â€œB2 is the suite number.â€</p><h2 id="3-22-D-â€“-gt-matches-a-non-digit-character"><a href="#3-22-D-â€“-gt-matches-a-non-digit-character" class="headerlink" title="3.22 \D â€“&gt; matches a non digit character"></a>3.22 \D â€“&gt; matches a non digit character</h2><p>Equivalent to [^0-9].</p><p>For example, /\D/ or /[^0-9]/ matches â€˜Bâ€™ in â€œB2 is the suite number.â€</p><h2 id="3-23-s-â€“-gt-matches-a-white-space-chracter"><a href="#3-23-s-â€“-gt-matches-a-white-space-chracter" class="headerlink" title="3.23 \s â€“&gt; matches a white space chracter"></a>3.23 \s â€“&gt; matches a white space chracter</h2><p>can be space, tab, form feed, line feed </p><h2 id="3-24-S-â€“-gt-matches-a-character-other-than-white-space"><a href="#3-24-S-â€“-gt-matches-a-character-other-than-white-space" class="headerlink" title="3.24 \S â€“&gt; matches a character other than white space"></a>3.24 \S â€“&gt; matches a character other than white space</h2><h2 id="3-25-w-â€“-gt-matches-any-apphanumeric-character-including-the-underscore"><a href="#3-25-w-â€“-gt-matches-any-apphanumeric-character-including-the-underscore" class="headerlink" title="3.25 \w â€“&gt; matches any apphanumeric character including the underscore"></a>3.25 \w â€“&gt; matches any apphanumeric character including the underscore</h2><p>Equivalent to <code>[A-Za-z0-9_]</code></p><p>For example, /\w/ matches â€˜aâ€™ in â€œapple,â€ â€˜5â€™ in â€œ$5.28,â€ and â€˜3â€™ in â€œ3D.â€</p><h2 id="3-26-W-matches-any-non-word-character"><a href="#3-26-W-matches-any-non-word-character" class="headerlink" title="3.26 \W matches any non word character"></a>3.26 \W matches any non word character</h2><p>Equivalent to [^A-Za-z0-9_].</p><p>For example, /\W/ or /[^A-Za-z0-9_]/ matches â€˜%â€™ in â€œ50%.â€</p><h2 id="3-27-n-â€“-gt-Where-n-is-a-positive-integer-a-back-reference-to-the-last-substring-matching-the-n-parenthetical-in-the-regular-expression-counting-left-parentheses"><a href="#3-27-n-â€“-gt-Where-n-is-a-positive-integer-a-back-reference-to-the-last-substring-matching-the-n-parenthetical-in-the-regular-expression-counting-left-parentheses" class="headerlink" title="3.27 \n â€“&gt; Where n is a positive integer, a back reference to the last substring matching the n parenthetical in the regular expression (counting left parentheses)."></a>3.27 \n â€“&gt; Where n is a positive integer, a back reference to the last substring matching the n parenthetical in the regular expression (counting left parentheses).</h2><p>For example, /apple(,)\sorange\1/ matches â€˜apple, orange,â€™ in â€œapple, orange, cherry, peach.â€</p><h1 id="4-Rethink-for-some-cool-things"><a href="#4-Rethink-for-some-cool-things" class="headerlink" title="4. Rethink for some cool things"></a>4. Rethink for some cool things</h1><h2 id="4-1-n"><a href="#4-1-n" class="headerlink" title="4.1 \n"></a>4.1 \n</h2><p>é€‰æ‹©å™¨<br>(a|b)\1  â€”&gt; aa or bb</p><p>(1|2)(3|4)\1\2 â€“&gt; 1313  or 1414 or 2323  or 2424 </p><h2 id="4-2-x"><a href="#4-2-x" class="headerlink" title="4.2 (x)"></a>4.2 (x)</h2><p>ç»™åˆ†ç»„ç”¨çš„ï¼Œç„¶åç”¨$0, $1, $2 æ¥è¿›è¡Œåˆ†åˆ«çš„è¡¨ç¤º</p><h1 id="5-Reference"><a href="#5-Reference" class="headerlink" title="5. Reference"></a>5. Reference</h1><p>1.<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener">Regular Expressions</a></p><p>2.<a href="https://juejin.im/post/5b5db5b8e51d4519155720d2" target="_blank" rel="noopener">æ˜é‡‘æ­£åˆ™æ€»ç»“</a></p><p>3.<a href="https://stackoverflow.com/questions/8624345/whats-the-meaning-of-a-number-after-a-backslash-in-a-regular-expression" target="_blank" rel="noopener">Stackoverflow: whatâ€™s the meaning of a number after a backslash in a regular expression?</a></p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> Regex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scaling webapps</title>
      <link href="/Scaling-webapps/"/>
      <url>/Scaling-webapps/</url>
      
        <content type="html"><![CDATA[<h1 id="1-How-scaling-works"><a href="#1-How-scaling-works" class="headerlink" title="1. How scaling works"></a>1. How scaling works</h1><h2 id="1-1-Vertical-scaling"><a href="#1-1-Vertical-scaling" class="headerlink" title="1.1 Vertical scaling"></a>1.1 Vertical scaling</h2><p>Run same things on a more powerful computer</p><h2 id="1-2-Horizontal-scaling"><a href="#1-2-Horizontal-scaling" class="headerlink" title="1.2 Horizontal scaling"></a>1.2 Horizontal scaling</h2><p>Means run many processes in parallel. </p><p>Nowadays, mostly we use horizontal scaling, since every computer internally have multi processors, we could do parallel programming to make whole thing work faster by nature.</p><h1 id="2-Scaling-process"><a href="#2-Scaling-process" class="headerlink" title="2. Scaling process"></a>2. Scaling process</h1><h2 id="2-1-Initialization-single-server-and-database"><a href="#2-1-Initialization-single-server-and-database" class="headerlink" title="2.1 Initialization: single server and database"></a>2.1 Initialization: single server and database</h2><p><img src="https://i.loli.net/2020/01/31/klA2HgITCiwtRPc.png" alt="fig1.png"></p><h2 id="2-2-Reverse-proxy"><a href="#2-2-Reverse-proxy" class="headerlink" title="2.2 Reverse proxy"></a>2.2 Reverse proxy</h2><p><img src="https://i.loli.net/2020/01/31/CgBvyKAW938H1Un.png" alt="fig2.png"></p><ul><li>Check if guests are allowed to enter </li><li>A proxy is a process that receives and forwards requests </li><li>Reverse means reqeust comes from teh internet and needs to be routed to our server </li></ul><p>Reverse proxy does following tasks: </p><ul><li>health check<ul><li>make sure actual server is still up and running </li></ul></li><li>routing <ul><li>forward a request to the right endpoint </li></ul></li><li>authentication <ul><li>make sure that a user is actually permitted to access the server </li></ul></li><li>firewall<ul><li>ensure users only have access to the parts they are allowed to use </li></ul></li></ul><h2 id="2-3-Load-balancer"><a href="#2-3-Load-balancer" class="headerlink" title="2.3 Load balancer"></a>2.3 Load balancer</h2><p><img src="https://i.loli.net/2020/01/31/YR6kcGwTFC8JQf3.png" alt="fig3.png"></p><p>Most reverse proxy can also act as load balancers. Load balancerâ€™s job is to split incoming requests among those servers</p><h2 id="2-4-Grow-database"><a href="#2-4-Grow-database" class="headerlink" title="2.4 Grow database"></a>2.4 Grow database</h2><p><img src="https://i.loli.net/2020/01/31/LVqBUhFscRAgt9w.png" alt="fig4.png"></p><ul><li>Scaling database needs to deal with consistency </li><li>Master - slace setup or write with read-replicas <ul><li>one part is exclusively responsible for receiving data and storing it </li><li>all other parts are responsible for retrieving the stored data </li></ul></li></ul><h2 id="2-5-Microservices"><a href="#2-5-Microservices" class="headerlink" title="2.5 Microservices"></a>2.5 Microservices</h2><p><img src="https://i.loli.net/2020/01/31/Qj5ibmHAzLSWeqJ.png" alt="fig5.png"></p><ul><li><p>why we need microservices? </p><ul><li>different part use server to different extends </li><li>development - might have more overlaps in singe service </li></ul></li><li><p>break server down into functional units and deploy them as individual, inter connected mini servers </p></li></ul><h2 id="2-6-Caching-amp-Content-Delivery-Networks"><a href="#2-6-Caching-amp-Content-Delivery-Networks" class="headerlink" title="2.6 Caching &amp; Content Delivery Networks"></a>2.6 Caching &amp; Content Delivery Networks</h2><p><img src="https://i.loli.net/2020/01/31/NRO6oguPe8JHMWb.png" alt="fig6.png"></p><ul><li>Large portion of our web app consists of static assets - almost never change <ul><li>use cache to speed it up </li></ul></li></ul><h2 id="2-7-Message-Queues"><a href="#2-7-Message-Queues" class="headerlink" title="2.7 Message Queues"></a>2.7 Message Queues</h2><p><img src="https://i.loli.net/2020/01/31/yXA4rKHbvw7cfuF.png" alt="fig7.png"></p><ul><li>deal with the waiting E.G fackbook deal with uploaded images <ul><li>store the raw, unprocessed image </li><li>confirm the upload to users </li><li>add to queue to process in the near future (async)</li></ul></li><li>benefits <ul><li>decouple tasks and processors </li><li>scale on demand </li></ul></li></ul><h2 id="2-8-sharding"><a href="#2-8-sharding" class="headerlink" title="2.8 sharding"></a>2.8 sharding</h2><p><img src="https://i.loli.net/2020/01/31/dXanh3b217s4Miq.png" alt="fig8.png"></p><ul><li>A technique of parallelizing an applicationâ€™s stacks by separating them into multiple units, each responsible for a certain key or namespace </li><li>shard based on location, use frequency and so on</li></ul><h2 id="2-9-load-balancer"><a href="#2-9-load-balancer" class="headerlink" title="2.9 load balancer"></a>2.9 load balancer</h2><p><img src="https://i.loli.net/2020/01/31/4FblrsEOeP6982U.png" alt="fig9.png"></p><p>Load balancer has hard limit of how many requests they can handle</p><ul><li>DNS<ul><li>free load balancers </li><li>registry allows you to specify multiple IPs per domain name, each leading to a different load balancer </li></ul></li></ul><h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1><p><a href="https://arcentry.com/blog/scaling-webapps-for-newbs-and-non-techies/" target="_blank" rel="noopener">https://arcentry.com/blog/scaling-webapps-for-newbs-and-non-techies/</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Scalibility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React - capture click outside component</title>
      <link href="/React-capture-click-outside-component/"/>
      <url>/React-capture-click-outside-component/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Use-case"><a href="#1-Use-case" class="headerlink" title="1. Use case"></a>1. Use case</h1><p>Suppose you create your own pop up modal, or you invent your own dropdown, you will need to deal/ capture with click outside of the component. This blog will illustrate how to do so. </p><h1 id="2-Handy-instructions"><a href="#2-Handy-instructions" class="headerlink" title="2. Handy instructions"></a>2. Handy instructions</h1><h2 id="2-1-Create-a-ref-to-div"><a href="#2-1-Create-a-ref-to-div" class="headerlink" title="2.1 Create a ref to div"></a>2.1 Create a ref to div</h2><pre><code>render() {    return (        &lt;div ref = {node =&gt; this.node = node}&gt; &lt;/div&gt;    );}</code></pre><h2 id="2-2-Add-event-listener"><a href="#2-2-Add-event-listener" class="headerlink" title="2.2 Add event listener"></a>2.2 Add event listener</h2><pre><code>componentWillMount() {    document.addEventListener(&#39;mousedown&#39;, this.handleClick, false);}componentWillUnmount() {    document.removeEventListener(&#39;mousedown&#39;, this.handleClick, false);}handleClick = (e) =&gt; {    if (this.node.contains(e.target)) {        // inside this component, do whatever you want        return;    }    // handle outside click    this.handleOutsideClick();}</code></pre>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Run your first Puppeteer with recorder</title>
      <link href="/Run-your-first-Puppeteer-with-recorder/"/>
      <url>/Run-your-first-Puppeteer-with-recorder/</url>
      
        <content type="html"><![CDATA[<p>This blog wanna give you some introduction on how to write and run your first puppeteer script. </p><p>I love puppeteer over selenium cause it could use js to interact with browser in almost all ways. Itâ€™s super easy to write some scripts to free you from repetive browser work (click, save, blablaâ€¦). I learnt this merely cause I donâ€™t want to waste too much of my time on ops work. I believe you guys have the thought with me :) </p><h1 id="1-Install-puppeteer"><a href="#1-Install-puppeteer" class="headerlink" title="1. Install puppeteer"></a>1. Install puppeteer</h1><p>In your command line tool, run </p><pre><code>npm i puppeteer </code></pre><p>It will show you if you have succeeded install puppeteer there. </p><h1 id="2-Write-some-basic-script"><a href="#2-Write-some-basic-script" class="headerlink" title="2. Write some basic script"></a>2. Write some basic script</h1><p>Letâ€™s write some basic code to interact with one page: </p><pre><code>&gt; vim firstPuppeteer.js// in the js file, input // Require the node module, our pre installed puppeteer const puppeteer = require(&#39;puppeteer&#39;);(async () =&gt; {  // launch a browser   const browser = await puppeteer.launch();  // launch a page   const page = await browser.newPage();  // Go to some link you wanna go  await page.goto(&#39;https://www.llchen60.com&#39;);  // Get the &quot;viewport&quot; of the page, as reported by the page.  const dimensions = await page.evaluate(() =&gt; {    return {      width: document.documentElement.clientWidth,      height: document.documentElement.clientHeight,      deviceScaleFactor: window.devicePixelRatio    };  });  console.log(&#39;Dimensions:&#39;, dimensions);  await browser.close();})();</code></pre><p>Well, this start script could get the dimension of the page you want. To execute it, run command <code>node firstPuppeteer.js</code></p><p>The output would be : <code>Dimensions: { width: 800, height: 600, deviceScaleFactor: 1 }</code></p><h1 id="3-Write-your-own-interaction-with-Puppeteer-Recorder"><a href="#3-Write-your-own-interaction-with-Puppeteer-Recorder" class="headerlink" title="3. Write your own interaction with Puppeteer Recorder"></a>3. Write your own interaction with Puppeteer Recorder</h1><p>Here, I wanna introduce you a chrome extension named: <strong>Puppeteer Recorder</strong>. Basically, you could start your interaction with browser and this extension can record all your behavior. </p><ul><li>It uses ES6 syntax to await for your selected component to be available</li><li>With recorder, it comes to be super easy to write puppeteer scripts, no more need to inspect all elements in browser and tracing down one by one! </li></ul><p>Still using my blog as an example, I start record when Iâ€™m at the home page, and look around, click on the puppeteer turorial link and then try to leave some comments there, the auto generated script are shown below: </p><pre><code>const puppeteer = require(&#39;puppeteer&#39;);(async () =&gt; {  const browser = await puppeteer.launch()  const page = await browser.newPage()  let frames = await page.frames()  const frame_35 = frames.find(f =&gt; f.url() === &#39;https://disqus.com/embed/comments/?base=default&amp;f=leilei-blog&amp;t_u=https%3A%2F%2Fwww.llchen60.com%2FPupperteer-Tutorial%2F&amp;t_d=Pupperteer%20Tutorial%20-%20Leilei%20%7C%20%E7%A3%8A%E7%A3%8A%E7%9A%84%E5%8D%9A%E5%AE%A2&amp;t_t=Pupperteer%20Tutorial%20-%20Leilei%20%7C%20%E7%A3%8A%E7%A3%8A%E7%9A%84%E5%8D%9A%E5%AE%A2&amp;s_o=default#version=50739766d3d12616cb0b6361b7b2fd85&#39;)  const navigationPromise = page.waitForNavigation()  await page.goto(&#39;https://llchen60.com/&#39;)  await page.setViewport({ width: 1080, height: 1809 })  await page.waitForSelector(&#39;.row &gt; .col-lg-8 &gt; .post-preview:nth-child(17) &gt; a &gt; .post-title&#39;)  await page.click(&#39;.row &gt; .col-lg-8 &gt; .post-preview:nth-child(17) &gt; a &gt; .post-title&#39;)  await navigationPromise  await frame_35.waitForSelector(&#39;.postbox &gt; .textarea-outer-wrapper &gt; .textarea-wrapper &gt; div &gt; .placeholder&#39;)  await frame_35.click(&#39;.postbox &gt; .textarea-outer-wrapper &gt; .textarea-wrapper &gt; div &gt; .placeholder&#39;)  await frame_35.waitForSelector(&#39;div #view27_display_name&#39;)  await frame_35.click(&#39;div #view27_display_name&#39;)  await browser.close()})();</code></pre><p>As you see, it auto generates the code we need, usually we could some modifications and put it on our existing scripts. </p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://llchen60.com/Pupperteer-Tutorial/" target="_blank" rel="noopener">https://llchen60.com/Pupperteer-Tutorial/</a></li><li><a href="https://chrome.google.com/webstore/search/puppeteer?hl=en-US" target="_blank" rel="noopener">https://chrome.google.com/webstore/search/puppeteer?hl=en-US</a></li><li><a href="https://github.com/GoogleChrome/puppeteer" target="_blank" rel="noopener">https://github.com/GoogleChrome/puppeteer</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> UI Test </tag>
            
            <tag> Puppeteer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Advanced(4)</title>
      <link href="/React-Advanced-4/"/>
      <url>/React-Advanced-4/</url>
      
        <content type="html"><![CDATA[<h1 id="1-The-component-lifecycle"><a href="#1-The-component-lifecycle" class="headerlink" title="1. The component lifecycle"></a>1. The component lifecycle</h1><p>Each component has several lifecycle methods that you can override to run code at perticular times in the process. </p><h2 id="1-1-Mounting"><a href="#1-1-Mounting" class="headerlink" title="1.1 Mounting"></a>1.1 Mounting</h2><p>Methods are called <strong>in this order</strong> when an instance of a component is being created and inserted into the DOM. </p><ol><li>constructor()</li><li>static getDerivedStateFromProps(): exists for use cases where the state depends on changes in props over time </li><li>render()</li><li>componentDidMount()</li></ol><h2 id="1-2-Updating"><a href="#1-2-Updating" class="headerlink" title="1.2 Updating"></a>1.2 Updating</h2><ol><li>static getDerivedStateFromProps()</li><li>shouldComponentUpdate(): judge if a componentâ€™s output is not affected by the current change in state or props</li><li>render()</li><li>getSnapshotBeforeUpdate()</li><li>componentDidUpdate() </li></ol><h2 id="1-3-Unmounting"><a href="#1-3-Unmounting" class="headerlink" title="1.3 Unmounting"></a>1.3 Unmounting</h2><ol><li>ComponentWillUnmount()</li></ol><h2 id="1-4-Error-Handling"><a href="#1-4-Error-Handling" class="headerlink" title="1.4 Error Handling"></a>1.4 Error Handling</h2><ol><li>static getDerivedStateFromError()</li><li>componentDidCatch() </li></ol><h1 id="2-JSX-in-Depth"><a href="#2-JSX-in-Depth" class="headerlink" title="2. JSX in Depth"></a>2. JSX in Depth</h1><h2 id="2-1-Specifying-the-react-element-type"><a href="#2-1-Specifying-the-react-element-type" class="headerlink" title="2.1 Specifying the react element type"></a>2.1 Specifying the react element type</h2><p>Capitalized types indicate that the JSX tag is <strong>referring to a React component</strong>. These tages get compiled into a direct reference to the named variable, so if you use the JSX <code>&lt;Foo/&gt;</code> expression, Foo must be in scope. </p><p>E.G Here: </p><pre><code>import React from &#39;react&#39;;import CustomButton from &#39;./CustomButton&#39;;function WarningButton() {  // return React.createElement(CustomButton, {color: &#39;red&#39;}, null);  return &lt;CustomButton color=&quot;red&quot; /&gt;;}</code></pre><p>Need to import those things before truly use it in function scope. </p><h2 id="2-2-User-defined-components-must-be-capitalized"><a href="#2-2-User-defined-components-must-be-capitalized" class="headerlink" title="2.2 User defined components must be capitalized"></a>2.2 User defined components must be capitalized</h2><p>When an element type starts with a lowercase letter, it refers to a build-in component like <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> passed to React.createElement.  </p><p>***Types that start with a capital letter like <code>&lt;Foo/&gt;</code> compile to React.createElement(Foo) and correspond to a component defined or imported in your js file. </p><h2 id="2-3-Spread-Attributes"><a href="#2-3-Spread-Attributes" class="headerlink" title="2.3 Spread Attributes"></a>2.3 Spread Attributes</h2><p>If you already have props as an object, and you want to pass it in JSX, you can use <code>...</code> as a spread operator to pass the whole props object. </p><p>Equivalent expressions: </p><pre><code>function App1() {  return &lt;Greeting firstName=&quot;Ben&quot; lastName=&quot;Hector&quot; /&gt;;}function App2() {  const props = {firstName: &#39;Ben&#39;, lastName: &#39;Hector&#39;};  return &lt;Greeting {...props} /&gt;;}</code></pre><h2 id="2-4-Children-in-JSX"><a href="#2-4-Children-in-JSX" class="headerlink" title="2.4 Children in JSX"></a>2.4 Children in JSX</h2><p>In JSX expressions that contain both an opening tag and a closing tag, the content between those tags is passed as a special prop: <code>props.children</code>. Several different ways to pass children: </p><ol><li>String literals </li></ol><p><code>&lt;div&gt;Hello World!&lt;/div&gt;</code></p><ol start="2"><li><p>JSX children</p></li><li><p>JS Expressions as Children</p></li></ol><p>Wrap it within <code>{}</code></p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Advanced(3)</title>
      <link href="/React-Advanced-3/"/>
      <url>/React-Advanced-3/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Error-Boundaries"><a href="#1-Error-Boundaries" class="headerlink" title="1. Error Boundaries"></a>1. Error Boundaries</h1><h2 id="1-1-Why-need-error-boundaries"><a href="#1-1-Why-need-error-boundaries" class="headerlink" title="1.1 Why need error boundaries"></a>1.1 Why need error boundaries</h2><p>In the past, JavaScript errors inside components used to corrupt Reactâ€™s internal state and cause it to emit cryptic errors on next renders. These errors were always caused by an earlier error in the application code,** but React did not provide a way to handle them gracefully in components, and could not recover from them**.</p><h2 id="1-2-Intro"><a href="#1-2-Intro" class="headerlink" title="1.2 Intro"></a>1.2 Intro</h2><p>A js error in a part of the UI shouldnâ€™t break the whole app. </p><blockquote><p>Error boundaries are React components that catch JS errors anywhere in their child component tree,log these errors, and display a fallback UI instead of the component tree, log those errors, and display a fallback UI instead of the component tree that crashed. </p></blockquote><p>Notice: Error boundaries do not catch errors for: </p><ol><li>Event handler</li><li>Asynchrounous code </li><li>server side rendering </li><li>errors thrown in the error boundary itself </li></ol><p>A class component becomes an error boundary if it defines either (or both) of the lifecycle methods <code>static getDerivedStateFromError()</code> or <code>componentDidCatch()</code>. Use <code>static getDerivedStateFromError()</code> to render a fallback UI after an error has been thrown. Use <code>componentDidCatch()</code> to log error information.</p><pre><code>class ErrorBoundary extends React.Component {  constructor(props) {    super(props);    this.state = { hasError: false };  }  static getDerivedStateFromError(error) {    // Update state so the next render will show the fallback UI.    return { hasError: true };  }  componentDidCatch(error, info) {    // You can also log the error to an error reporting service    logErrorToMyService(error, info);  }  render() {    if (this.state.hasError) {      // You can render any custom fallback UI      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;    }    return this.props.children;   }}</code></pre><p>We can use it as a regular component: </p><pre><code>&lt;ErrorBoundary&gt;  &lt;MyWidget /&gt;&lt;/ErrorBoundary&gt;</code></pre><h2 id="1-3-Notifications"><a href="#1-3-Notifications" class="headerlink" title="1.3 Notifications"></a>1.3 Notifications</h2><ol><li>Error boundaries work like a JS <code>catch {}</code> block, but for components. </li><li>Only calss components can be error boundaries.</li><li>Error boundaries only catch errors in the components below them in the tree. </li><li>It cannot catch an error within itself.</li></ol><h1 id="2-Forwarding-Refs"><a href="#2-Forwarding-Refs" class="headerlink" title="2. Forwarding Refs"></a>2. Forwarding Refs</h1><p>Ref forwarding is a tech for <strong><em>automatically passing a ref through a component to one of its children</em></strong></p><h2 id="2-1-Forwarding-Refs-to-DOM-components"><a href="#2-1-Forwarding-Refs-to-DOM-components" class="headerlink" title="2.1 Forwarding Refs to DOM components"></a>2.1 Forwarding Refs to DOM components</h2><pre><code>function FancyButton(props) {  return (    &lt;button className=&quot;FancyButton&quot;&gt;      {props.children}    &lt;/button&gt;  );}</code></pre><p>In this example, FancyButton wrap a button, and we can reuse in our dev work. But the problem is FancyButton is expected to be used in a similar manner as a regular DOM button. We might need to access their DOM nodes for <strong><em>managing focus, selection, or animations</em></strong>.</p><blockquote><p>Ref forwarding is an opt-in feature that lets some components take a ref they receive, and pass it further down to a child. </p></blockquote><pre><code>const FancyButton = React.forwardRef((props, ref) =&gt; (  &lt;button ref={ref} className=&quot;FancyButton&quot;&gt;    {props.children}  &lt;/button&gt;));// You can now get a ref directly to the DOM button:const ref = React.createRef();&lt;FancyButton ref={ref}&gt;Click me!&lt;/FancyButton&gt;;</code></pre><p>Here, use <code>React.forwardRef()</code> to obtain the ref passed to it, and then forward it to the DOM button that it renders. </p><p>Here is a step-by-step explanation of what happens in the above example:</p><ol><li>We create a React ref by calling <code>React.createRef</code> and assign it to a ref variable.</li><li>We pass our ref down to <code>&lt;FancyButton ref={ref}&gt;</code> by specifying it as a JSX attribute.</li><li>React passes the ref to the <code>(props, ref) =&gt; ...</code> function inside forwardRef as a second argument.</li><li>We forward this ref argument down to <code>&lt;button ref={ref}&gt;</code> by specifying it as a JSX attribute.</li><li>When the ref is attached, <code>ref.current</code> will point to the <button> DOM node.</li></ol><h1 id="3-Higher-Order-Components-KEY-FACTOR"><a href="#3-Higher-Order-Components-KEY-FACTOR" class="headerlink" title="3. Higher-Order Components (KEY FACTOR)"></a>3. Higher-Order Components (KEY FACTOR)</h1><blockquote><p>A higher order component(HOC) is an advanced technique in React for reusing component logic. Itâ€™s a pattern that emerges from Reactâ€™s compositional nature. </p></blockquote><blockquote><p>Concretely, <strong><em>a higher order component is a function that takes a component and returns a new component</em></strong></p></blockquote><p>Whereas a component transforms props into UI, a higher-order component transforms a component into another component.</p><h2 id="3-1-Use-HOCs-For-cross-cutting-concerns"><a href="#3-1-Use-HOCs-For-cross-cutting-concerns" class="headerlink" title="3.1 Use HOCs For cross cutting concerns"></a>3.1 Use HOCs For cross cutting concerns</h2><p>CommentList component that subscribes to an external data source to render a list of comments: </p><pre><code>class CommentList extends React.Component {  constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);    this.state = {      // &quot;DataSource&quot; is some global data source      comments: DataSource.getComments()    };  }  componentDidMount() {    // Subscribe to changes    DataSource.addChangeListener(this.handleChange);  }  componentWillUnmount() {    // Clean up listener    DataSource.removeChangeListener(this.handleChange);  }  handleChange() {    // Update component state whenever the data source changes    this.setState({      comments: DataSource.getComments()    });  }  render() {    return (      &lt;div&gt;        {this.state.comments.map((comment) =&gt; (          &lt;Comment comment={comment} key={comment.id} /&gt;        ))}      &lt;/div&gt;    );  }}</code></pre><p>A component for subscribing to a single blog post:</p><pre><code>class BlogPost extends React.Component {  constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);    this.state = {      blogPost: DataSource.getBlogPost(props.id)    };  }  componentDidMount() {    DataSource.addChangeListener(this.handleChange);  }  componentWillUnmount() {    DataSource.removeChangeListener(this.handleChange);  }  handleChange() {    this.setState({      blogPost: DataSource.getBlogPost(this.props.id)    });  }  render() {    return &lt;TextBlock text={this.state.blogPost} /&gt;;  }}</code></pre><p>Much of those two component are similar, need an abstraction that allows us to define the logic in a single place and share it across many components.</p><p>Write a function that creates components, like CommentList and BlogList, that subscribe to DataSourse. </p><pre><code>const CommentListWithSubscription = withSubscription(  CommentList,  (DataSource) =&gt; DataSource.getComments());const BlogPostWithSubscription = withSubscription(  BlogPost,  (DataSource, props) =&gt; DataSource.getBlogPost(props.id));</code></pre><p>When CommentListWithSubscription and BlogPostWithSubscription are rendered, <strong>CommentList and BlogPost will be passed a data prop with the most current data retrieved from DataSource</strong>:</p><pre><code>// This function takes a component...function withSubscription(WrappedComponent, selectData) {  // ...and returns another component...  return class extends React.Component {    constructor(props) {      super(props);      this.handleChange = this.handleChange.bind(this);      this.state = {        data: selectData(DataSource, props)      };    }    componentDidMount() {      // ... that takes care of the subscription...      DataSource.addChangeListener(this.handleChange);    }    componentWillUnmount() {      DataSource.removeChangeListener(this.handleChange);    }    handleChange() {      this.setState({        data: selectData(DataSource, this.props)      });    }    render() {      // ... and renders the wrapped component with the fresh data!      // Notice that we pass through any additional props      return &lt;WrappedComponent data={this.state.data} {...this.props} /&gt;;    }  };}</code></pre><p>Note that a HOC doesnâ€™t modify the input component, nor does it use inheritance to copy its behavior. Rather, a HOC composes the original component by wrapping it in a container component. A HOC is a pure function with zero side-effects.</p><p>The wrapped component receives all the props of the container, along with a new prop, data, which it uses to render its output. The HOC isnâ€™t concerned with how or why the data is used, and the wrapped component isnâ€™t concerned with where the data came from. </p><h1 id="4-Fragments"><a href="#4-Fragments" class="headerlink" title="4. Fragments"></a>4. Fragments</h1><p>Fragments let you group a list of children without adding extra nodes to the DOM. </p><pre><code>render() {  return (    &lt;React.Fragment&gt;      &lt;ChildA /&gt;      &lt;ChildB /&gt;      &lt;ChildC /&gt;    &lt;/React.Fragment&gt;  );}</code></pre><h2 id="4-1-Why-introduce-Fragments"><a href="#4-1-Why-introduce-Fragments" class="headerlink" title="4.1 Why introduce Fragments"></a>4.1 Why introduce <code>Fragments</code></h2><pre><code>&lt;table&gt;  &lt;tr&gt;    &lt;div&gt;      &lt;td&gt;Hello&lt;/td&gt;      &lt;td&gt;World&lt;/td&gt;    &lt;/div&gt;  &lt;/tr&gt;&lt;/table&gt;</code></pre><p>In this example, if there are two components, and we want to seperate it, and make <code>&lt;div&gt;</code> doesnâ€™t work(group elements inside, but keep table format works), we can modify it to: </p><pre><code>class Columns extends React.Component {  render() {    return (      &lt;React.Fragment&gt;        &lt;td&gt;Hello&lt;/td&gt;        &lt;td&gt;World&lt;/td&gt;      &lt;/React.Fragment&gt;    );  }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Advanced(2)</title>
      <link href="/React-Advanced-2/"/>
      <url>/React-Advanced-2/</url>
      
        <content type="html"><![CDATA[<p>In this part, dive deeper into React. In the previous post, found a lot of new things. Though I can write some jsx code, but I have to admit itâ€™s really uglyâ€¦wihout reuse, with some useless states for no reasons, duplicate, boring. Thatâ€™s why try to write some articles following authoritive docs. There are some of my thoughts inside, hope it can help you. :) </p><h1 id="1-Accessibility"><a href="#1-Accessibility" class="headerlink" title="1. Accessibility"></a>1. Accessibility</h1><p>Also known as a11y, is the design and creation of websites that can be used by everyone. </p><h2 id="1-1-Semantic-HTML"><a href="#1-1-Semantic-HTML" class="headerlink" title="1.1 Semantic HTML"></a>1.1 Semantic HTML</h2><p>Sometimes, we break HTML sementics when we add <code>&lt;div&gt;</code> elements to our JSX to make our React code work, especially working with lists and table. In these case, we should use <strong><em>React Fragments</em></strong> to group together multiple elements. </p><pre><code>import React, { Fragment } from &#39;react&#39;;function ListItem({ item }) {  return (    &lt;Fragment&gt;      &lt;dt&gt;{item.term}&lt;/dt&gt;      &lt;dd&gt;{item.description}&lt;/dd&gt;    &lt;/Fragment&gt;  );}function Glossary(props) {  return (    &lt;dl&gt;      {props.items.map(item =&gt; (        &lt;ListItem item={item} key={item.id} /&gt;      ))}    &lt;/dl&gt;  );}</code></pre><p>Map a collection of items to an array of fragments as you would any other type of elements as well: </p><pre><code>function Glossary(props) {  return (    &lt;dl&gt;      {props.items.map(item =&gt; (        // Fragments should also have a `key` prop when mapping collections        &lt;Fragment key={item.id}&gt;          &lt;dt&gt;{item.term}&lt;/dt&gt;          &lt;dd&gt;{item.description}&lt;/dd&gt;        &lt;/Fragment&gt;      ))}    &lt;/dl&gt;  );}</code></pre><h1 id="2-Refs-and-the-DOM"><a href="#2-Refs-and-the-DOM" class="headerlink" title="2 Refs and the DOM"></a>2 Refs and the DOM</h1><blockquote><p>Refs provide a way to access DOM nodes or React elements created in the render method. </p></blockquote><p>Refs offer another way to change a child outside of the typical dataflow - use props from parent to child. <strong>The child to be modified could be an instance of a React Component, or it could be a DOM element.</strong> </p><h2 id="2-1-When-to-use-Refs"><a href="#2-1-When-to-use-Refs" class="headerlink" title="2.1 When to use Refs"></a>2.1 When to use Refs</h2><ol><li>Managing focus, text selection, media playback </li><li>triggering imperative animations</li><li>integrating with third party DOM libraries </li></ol><h2 id="2-2-How-to-use-Refs"><a href="#2-2-How-to-use-Refs" class="headerlink" title="2.2 How to use Refs"></a>2.2 How to use Refs</h2><p>Use by <code>React.createRef()</code>, to create a ref</p><pre><code>class MyComponent extends React.Component {  constructor(props) {    super(props);    this.myRef = React.createRef();  }  render() {    return &lt;div ref={this.myRef} /&gt;;  }}</code></pre><p>When a ref is passed to an element in render, a reference to the node becomes accessible at the <strong><em>current</em></strong> attribute of the ref</p><pre><code>const node = this.myRef.current;</code></pre><h2 id="2-3-Value-of-the-ref"><a href="#2-3-Value-of-the-ref" class="headerlink" title="2.3 Value of the ref"></a>2.3 Value of the ref</h2><ol><li><p>When the ref attribute is used on an HTML element, the ref created in the constructor with React.createRef() receives the underlying DOM element as its current property.</p></li><li><p>When the ref attribute is used on a custom class component, the ref object receives the mounted instance of the component as its current.</p><p> class CustomTextInput extends React.Component {<br>   constructor(props) {</p><pre><code> super(props); // create a ref to store the textInput DOM element this.textInput = React.createRef(); this.focusTextInput = this.focusTextInput.bind(this);</code></pre><p>   }</p><p>   focusTextInput() {</p><pre><code> // Explicitly focus the text input using the raw DOM API // Note: we&#39;re accessing &quot;current&quot; to get the DOM node this.textInput.current.focus();</code></pre><p>   }</p><p>   render() {</p><pre><code> // tell React that we want to associate the &lt;input&gt; ref // with the `textInput` that we created in the constructor return (   &lt;div&gt;     &lt;input       type=&quot;text&quot;       ref={this.textInput} /&gt;     &lt;input       type=&quot;button&quot;       value=&quot;Focus the text input&quot;       onClick={this.focusTextInput}     /&gt;   &lt;/div&gt; );</code></pre><p>   }<br> }</p></li></ol><p>Here, React will assign the current property with the DOM element when the component mounts, and assign it back to null when it unmounts. Ref updates happen before componentDidMount or componentDidUpdate lifecycle methods. </p><p><strong>*!!! We cannot use ref attribute on function componnets because they donâ€™t have instances. *</strong></p><h1 id="3-Code-Splitting"><a href="#3-Code-Splitting" class="headerlink" title="3. Code Splitting"></a>3. Code Splitting</h1><h2 id="3-1-Bundling"><a href="#3-1-Bundling" class="headerlink" title="3.1 Bundling"></a>3.1 Bundling</h2><p>Most React Apps will have their files bundles using tools like webpack or browserify. Bundling is the process of following imported files and merging them into a single file. This file can then be included on a webpage to load an entire app at once. </p><h2 id="3-2-Code-splitting"><a href="#3-2-Code-splitting" class="headerlink" title="3.2 Code splitting"></a>3.2 Code splitting</h2><p>Bundling is great, but as your app grows, bundle will grow too. Especially if you are including large third party libraries. </p><p>To void winding up with a large bundle, itâ€™s good to get ahead of the problkem and start splitting your bundle. </p><p>Code-splitting your app can help you â€œlazy-loadâ€ just the things that are currently needed by the user, which can dramatically improve the performance of your app. While you havenâ€™t reduced the overall amount of code in your app, youâ€™ve avoided loading code that the user may never need, and reduced the amount of code needed during the initial load.</p><h2 id="3-3-Dynamic-import"><a href="#3-3-Dynamic-import" class="headerlink" title="3.3 Dynamic import()"></a>3.3 Dynamic <code>import()</code></h2><p>The beast way to introduce code-splitting into app is through the dynamic import() syntax. </p><pre><code>import { add } from &#39;./math&#39;;console.log(add(16, 26));</code></pre><p>Before, now with dynamic import: </p><pre><code>import(&quot;./math&quot;).then(math =&gt; {  console.log(math.add(16, 26));});</code></pre><h2 id="3-4-React-lazy"><a href="#3-4-React-lazy" class="headerlink" title="3.4 React.lazy"></a>3.4 React.lazy</h2><p>lets you render a dynamic import as a regular component. </p><pre><code>import OtherComponent from &#39;./OtherComponent&#39;;function MyComponent() {  return (    &lt;div&gt;      &lt;OtherComponent /&gt;    &lt;/div&gt;  );}</code></pre><p>Switch to: </p><pre><code>const OtherComponent = React.lazy(() =&gt; import(&#39;./OtherComponent&#39;));function MyComponent() {  return (    &lt;div&gt;      &lt;OtherComponent /&gt;    &lt;/div&gt;  );}</code></pre><h2 id="3-5-Suspense"><a href="#3-5-Suspense" class="headerlink" title="3.5 Suspense"></a>3.5 Suspense</h2><p>If the modile containing other component is not yet loaded by the time current one renders, we must <strong>show some fallback content</strong> while we are waiting for it to load. </p><pre><code>const OtherComponent = React.lazy(() =&gt; import(&#39;./OtherComponent&#39;));function MyComponent() {  return (    &lt;div&gt;      &lt;Suspense fallback={&lt;div&gt;Loading...&lt;/div&gt;}&gt;        &lt;OtherComponent /&gt;      &lt;/Suspense&gt;    &lt;/div&gt;  );}</code></pre><p>The fallback prop accepts any React elements that you want to render while waiting for the component to load. </p><h1 id="4-Context"><a href="#4-Context" class="headerlink" title="4. Context"></a>4. Context</h1><p>Context provides a way to pass data through the component tree without having to pass props down manually at every level. </p><p>some props, like locale preference, UI theme, that are required by many components within an application. <strong>Context provides a way to share values like these between components without having to explicitly pass a prop throught every level of the tree.</strong></p><h2 id="4-1-When-to-use-Context"><a href="#4-1-When-to-use-Context" class="headerlink" title="4.1 When to use Context"></a>4.1 When to use Context</h2><pre><code>class App extends React.Component {  render() {    return &lt;Toolbar theme=&quot;dark&quot; /&gt;;  }}function Toolbar(props) {  // The Toolbar component must take an extra &quot;theme&quot; prop  // and pass it to the ThemedButton. This can become painful  // if every single button in the app needs to know the theme  // because it would have to be passed through all components.  return (    &lt;div&gt;      &lt;ThemedButton theme={props.theme} /&gt;    &lt;/div&gt;  );}class ThemedButton extends React.Component {  render() {    return &lt;Button theme={this.props.theme} /&gt;;  }}</code></pre><p>With context, we can avoid passing props through intermidiate elements: </p><pre><code>// Context lets us pass a value deep into the component tree// without explicitly threading it through every component.// Create a context for the current theme (with &quot;light&quot; as the default).const ThemeContext = React.createContext(&#39;light&#39;);class App extends React.Component {  render() {    // Use a Provider to pass the current theme to the tree below.    // Any component can read it, no matter how deep it is.    // In this example, we&#39;re passing &quot;dark&quot; as the current value.    return (      &lt;ThemeContext.Provider value=&quot;dark&quot;&gt;        &lt;Toolbar /&gt;      &lt;/ThemeContext.Provider&gt;    );  }}// A component in the middle doesn&#39;t have to// pass the theme down explicitly anymore.function Toolbar(props) {  return (    &lt;div&gt;      &lt;ThemedButton /&gt;    &lt;/div&gt;  );}class ThemedButton extends React.Component {  // Assign a contextType to read the current theme context.  // React will find the closest theme Provider above and use its value.  // In this example, the current theme is &quot;dark&quot;.  static contextType = ThemeContext;  render() {    return &lt;Button theme={this.context} /&gt;;  }}</code></pre><p>Notice: </p><ol><li><code>contextType</code></li><li><code>context.provider</code></li></ol><h2 id="4-2-Before-using-context"><a href="#4-2-Before-using-context" class="headerlink" title="4.2 Before using context"></a>4.2 Before using context</h2><p>Context is primarily used when some data needs to be accessible by many components at different nesting levels. </p><p>Multiple other choices can be used to resolve similar problems. </p><ol><li>Pass down the combined component itself </li></ol><pre><code>&lt;Page user={user} avatarSize={avatarSize} /&gt;// ... which renders ...&lt;PageLayout user={user} avatarSize={avatarSize} /&gt;// ... which renders ...&lt;NavigationBar user={user} avatarSize={avatarSize} /&gt;// ... which renders ...&lt;Link href={user.permalink}&gt;  &lt;Avatar user={user} size={avatarSize} /&gt;&lt;/Link&gt;function Page(props) {  const user = props.user;  const userLink = (    &lt;Link href={user.permalink}&gt;      &lt;Avatar user={user} size={props.avatarSize} /&gt;    &lt;/Link&gt;  );  return &lt;PageLayout userLink={userLink} /&gt;;}// Now, we have:&lt;Page user={user} /&gt;// ... which renders ...&lt;PageLayout userLink={...} /&gt;// ... which renders ...&lt;NavigationBar userLink={...} /&gt;// ... which renders ...{props.userLink}</code></pre><h2 id="4-3-API"><a href="#4-3-API" class="headerlink" title="4.3 API"></a>4.3 API</h2><ol><li><p><code>React.createContext</code></p><p> const MyContext = React.createContext(defaultValue);</p></li></ol><p>Create a context object. When React renders a component that subscribes to this Context object it will read the current context value from the closest matching Provider above it in the tree. <strong>Read context value from provider!</strong></p><p>The defaultValue argument is only used when a component does not have a matching Provider above it in the tree. This can be helpful for testing components in isolation without wrapping them.</p><ol start="2"><li><p><code>Context.Provider</code></p><p> &lt;MyContext.Provider value={/* some value */}&gt;</p></li></ol><p>Every Context object comes with a Provider React Component that allows consuming components to subscribe to context changes. One Provider can be connected to many consumers. Providers can be nested to override values deeper within the tree. All consumers that are descendants of a Provider will re-render whenever the Providerâ€™s value prop changes. The propagation from Provider to its descendant consumers is not subject to the shouldComponentUpdate method, so the consumer is updated even when an ancestor component bails out of the update.</p><ol start="3"><li><code>Class.contextType</code></li></ol><p>contextType property on a class can be assigned a context object created by <code>React.createContext()</code>. This lets you consume the nearest current value of that Context type using this.context. You can reference this in any of the lifecycle methods including the render function.</p><ol start="4"><li><code>Context.consumer</code></li></ol><pre><code>&lt;MyContext.Consumer&gt;  {value =&gt; /* render something based on the context value */}&lt;/MyContext.Consumer&gt;</code></pre><p>A react component that subscribes to context changes. This lets you subscribe to a context within a function component.</p><h2 id="4-4-Example"><a href="#4-4-Example" class="headerlink" title="4.4 Example"></a>4.4 Example</h2><p>theme-context.js </p><pre><code>export const themes = {  light: {    foreground: &#39;#000000&#39;,    background: &#39;#eeeeee&#39;,  },  dark: {    foreground: &#39;#ffffff&#39;,    background: &#39;#222222&#39;,  },};export const ThemeContext = React.createContext(  themes.dark // default value);</code></pre><p>theme-button.js</p><pre><code>import {ThemeContext} from &#39;./theme-context&#39;;class ThemedButton extends React.Component {  render() {    let props = this.props;    let theme = this.context;    return (      &lt;button        {...props}        style={{backgroundColor: theme.background}}      /&gt;    );  }}ThemedButton.contextType = ThemeContext;export default ThemedButton;</code></pre><p>app.js</p><pre><code>import {ThemeContext, themes} from &#39;./theme-context&#39;;import ThemedButton from &#39;./themed-button&#39;;// An intermediate component that uses the ThemedButtonfunction Toolbar(props) {  return (    &lt;ThemedButton onClick={props.changeTheme}&gt;      Change Theme    &lt;/ThemedButton&gt;  );}class App extends React.Component {  constructor(props) {    super(props);    this.state = {      theme: themes.light,    };    this.toggleTheme = () =&gt; {      this.setState(state =&gt; ({        theme:          state.theme === themes.dark            ? themes.light            : themes.dark,      }));    };  }  render() {    // The ThemedButton button inside the ThemeProvider    // uses the theme from state while the one outside uses    // the default dark theme    return (      &lt;Page&gt;        &lt;ThemeContext.Provider value={this.state.theme}&gt;          &lt;Toolbar changeTheme={this.toggleTheme} /&gt;        &lt;/ThemeContext.Provider&gt;        &lt;Section&gt;          &lt;ThemedButton /&gt;        &lt;/Section&gt;      &lt;/Page&gt;    );  }}ReactDOM.render(&lt;App /&gt;, document.root);</code></pre><h1 id="5-Reference"><a href="#5-Reference" class="headerlink" title="5. Reference"></a>5. Reference</h1><ol><li><a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener">React Doc</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Advanced(1)</title>
      <link href="/React-Advanced-1/"/>
      <url>/React-Advanced-1/</url>
      
        <content type="html"><![CDATA[<p>For this part, aim to know all the necessary react knowledge to better do the development work. Start from the very beginning, and try to grab all the basic and advanced knowledge follow the authoritive doc. </p><h1 id="1-Main-Concepts"><a href="#1-Main-Concepts" class="headerlink" title="1. Main Concepts"></a>1. Main Concepts</h1><h2 id="1-1-JSX"><a href="#1-1-JSX" class="headerlink" title="1.1 JSX"></a>1.1 JSX</h2><pre><code>const element = &lt;h1&gt;Hello World!&lt;/h1&gt;</code></pre><p>JSX, syntax extension to JS. JSX produces <strong>React Elements</strong>. And then we try to render them to the DOM. </p><p>JSX out logic and markup together, react separates concerns with loosely coupled units called components that contain both. </p><h3 id="1-1-1-Embedding-expressions-in-JSX"><a href="#1-1-1-Embedding-expressions-in-JSX" class="headerlink" title="1.1.1 Embedding expressions in JSX"></a>1.1.1 Embedding expressions in JSX</h3><pre><code>const name = &#39;Josh Perez&#39;;const element = &lt;h1&gt;Hello, {name}&lt;/h1&gt;;ReactDOM.render(  element,  document.getElementById(&#39;root&#39;));</code></pre><p>Here, by wrapping name in curly braces, we call a variable. </p><blockquote><p>Inside the curly brace, we can put any valid <strong><em>JS expression</em></strong>.  </p></blockquote><h3 id="1-1-2-JSX-is-an-Expression"><a href="#1-1-2-JSX-is-an-Expression" class="headerlink" title="1.1.2 JSX is an Expression"></a>1.1.2 JSX is an Expression</h3><p>After compilation, JSX expressions become regular <strong>JS function calls</strong> and evaluate to <strong>JS objects</strong>. React DOM uses camelCase property naming convention </p><p>JSX represents Object, Babel will help JSX to compile to React.createElement() call. </p><h2 id="1-2-Rendering-Elements"><a href="#1-2-Rendering-Elements" class="headerlink" title="1.2 Rendering Elements"></a>1.2 Rendering Elements</h2><h3 id="1-2-1-Element"><a href="#1-2-1-Element" class="headerlink" title="1.2.1 Element"></a>1.2.1 Element</h3><p>An element describes what you want to see on the screen. </p><pre><code>const element = &lt;h1&gt;Hello world!&lt;/h1&gt;</code></pre><p>Components are made of elements. </p><blockquote><p>Applications built with React usually have a <strong><em>single root DOM node</em></strong>. If you are integrating React into an existing app, you may have as many isolated root DOM nodes as you like. </p></blockquote><h3 id="1-2-2-Updating-the-rendered-element"><a href="#1-2-2-Updating-the-rendered-element" class="headerlink" title="1.2.2 Updating the rendered element"></a>1.2.2 Updating the rendered element</h3><blockquote><p><strong><em>React elements are immutable</em></strong></p></blockquote><p>Once you create an element, you cannot change its children or attributes</p><h3 id="1-2-3-Only-updates-whatâ€™s-necessary"><a href="#1-2-3-Only-updates-whatâ€™s-necessary" class="headerlink" title="1.2.3 Only updates whatâ€™s necessary"></a>1.2.3 Only updates whatâ€™s necessary</h3><p>React DOM compares the element and its children to the previous one, and only applies the DOM updates necessary to bring the DOM to the desired state. </p><blockquote><p>In this way, we can spend more time thinking how the UI should look like rather than how to change it over time eliminates a whole class of bugs. </p></blockquote><h2 id="1-3-Components-and-Props"><a href="#1-3-Components-and-Props" class="headerlink" title="1.3 Components and Props"></a>1.3 Components and Props</h2><h3 id="1-3-1-Components"><a href="#1-3-1-Components" class="headerlink" title="1.3.1 Components"></a>1.3.1 Components</h3><p>Components let you split the UI into independent, reusable pieces, and think about each piece in isolation. They accept arbitrary inputs(named props) and return React elements describing what should appear on the screen. </p><p>When React sees an element representing a user-defined component, it <strong>passes JSX attributes to this component</strong> as a single object. We call this object â€œpropsâ€.</p><pre><code>function Welcome(props) {  return &lt;h1&gt;Hello, {props.name}&lt;/h1&gt;;}const element = &lt;Welcome name=&quot;Sara&quot; /&gt;;ReactDOM.render(  element,  document.getElementById(&#39;root&#39;));</code></pre><h3 id="1-3-2-Extract-Components"><a href="#1-3-2-Extract-Components" class="headerlink" title="1.3.2 Extract Components"></a>1.3.2 Extract Components</h3><p>To make them better reusable. </p><h3 id="1-3-3-Props-are-Read-only"><a href="#1-3-3-Props-are-Read-only" class="headerlink" title="1.3.3 Props are Read only"></a>1.3.3 Props are <strong><em>Read only</em></strong></h3><p>All React Components must act like pure functions with respect to their props. </p><h2 id="1-4-State-and-Lifecycle"><a href="#1-4-State-and-Lifecycle" class="headerlink" title="1.4 State and Lifecycle"></a>1.4 State and Lifecycle</h2><h3 id="1-4-1-State"><a href="#1-4-1-State" class="headerlink" title="1.4.1 State"></a>1.4.1 State</h3><p>State is private, and fully controlled by the component. </p><h3 id="1-4-2-Adding-lifecycle-methods-to-a-Class"><a href="#1-4-2-Adding-lifecycle-methods-to-a-Class" class="headerlink" title="1.4.2 Adding lifecycle methods to a Class"></a>1.4.2 Adding lifecycle methods to a Class</h3><p>In applications with many components, itâ€™s very important to free up resources taken by the components when they are destroyed. </p><ol><li><p>componentDidMount()<br>It runs after the component output has been rendered to the DOM</p></li><li><p>componentWillUnmount() </p></li><li><p>Runs when the DOM need to be removed </p></li></ol><h3 id="1-4-3-State-Using-tips"><a href="#1-4-3-State-Using-tips" class="headerlink" title="1.4.3 State Using tips"></a>1.4.3 State Using tips</h3><ol><li>Do not modify state directly, instead, use setState</li><li>state updates may be asynchronous , props and state may be updated asynchronously, should not rely on their values for calculating the next state. </li></ol><pre><code>// Correctthis.setState((state, props) =&gt; ({  counter: state.counter + props.increment}));</code></pre><p>In this way, That function will receive the previous state as the first argument, and the props at the time the update is applied as the second argument</p><ol start="3"><li>State updates are merged </li></ol><h3 id="1-4-4-The-data-flow-down"><a href="#1-4-4-The-data-flow-down" class="headerlink" title="1.4.4 The data flow down"></a>1.4.4 The data flow down</h3><p>This is commonly called a â€œtop-downâ€ or â€œunidirectionalâ€ data flow. Any state is always owned by some specific component, and any data or UI derived from that state can only affect components â€œbelowâ€ them in the tree.</p><blockquote><p>If you imagine a component tree as a waterfall of props, each componentâ€™s state is like an additional water source that joins it at an arbitrary point but also flows down.</p></blockquote><h2 id="1-5-Handling-Events"><a href="#1-5-Handling-Events" class="headerlink" title="1.5 Handling Events"></a>1.5 Handling Events</h2><p>Quite similar to handling methods in DOM, some differences: </p><ol><li><p>Syntax: </p> <button onClick={activateLasers}>   Activate Lasers </button></li></ol><p>Use {}, <code>activateLasers</code> here means a function name</p><ol start="2"><li>use <code>e.preventDefault()</code> to block the default behavior</li><li>when using React, you should generally not need to call <code>addEventListener</code> to add listeners to a DOM element after it is created. Instead, just provide a listener when the element is initially rendered. </li></ol><pre><code>class Toggle extends React.Component {  constructor(props) {    super(props);    this.state = {isToggleOn: true};    // This binding is necessary to make `this` work in the callback    this.handleClick = this.handleClick.bind(this);  }  handleClick() {    this.setState(state =&gt; ({      isToggleOn: !state.isToggleOn    }));  }  render() {    return (      &lt;button onClick={this.handleClick}&gt;        {this.state.isToggleOn ? &#39;ON&#39; : &#39;OFF&#39;}      &lt;/button&gt;    );  }}ReactDOM.render(  &lt;Toggle /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><blockquote><p> Be careful of <code>this</code>, since class methods are not bound by default. Need to bind this.handleClick. </p></blockquote><ol start="4"><li>You can try to not bind this if you declare the method in such way!</li></ol><pre><code>class LoggingButton extends React.Component {  // This syntax ensures `this` is bound within handleClick.  // Warning: this is *experimental* syntax.  handleClick = () =&gt; {    console.log(&#39;this is:&#39;, this);  }  render() {    return (      &lt;button onClick={this.handleClick}&gt;        Click me      &lt;/button&gt;    );  }}</code></pre><p>Letâ€™s figure out whatâ€™s <code>() =&gt; {}</code> means here: </p><p><strong><em>() contains some variables, used in an arrow function to return an object</em></strong></p><p><strong><em>{} contains some statement, actually, itâ€™s a special syntax in JSX. It contains a JS expression, can be a variable</em></strong></p><h2 id="1-6-Conditional-Rendering"><a href="#1-6-Conditional-Rendering" class="headerlink" title="1.6  Conditional Rendering"></a>1.6  Conditional Rendering</h2><p>User can create distinct components that encapsulate behavior you need, ANd we can <strong>render only some of them</strong>. </p><ol><li>Using if to do conditional rendering</li><li>Inline if with Logical &amp;&amp; Operator </li></ol><pre><code>function Mailbox(props) {  const unreadMessages = props.unreadMessages;  return (    &lt;div&gt;      &lt;h1&gt;Hello!&lt;/h1&gt;      {unreadMessages.length &gt; 0 &amp;&amp;        &lt;h2&gt;          You have {unreadMessages.length} unread messages.        &lt;/h2&gt;      }    &lt;/div&gt;  );}const messages = [&#39;React&#39;, &#39;Re: React&#39;, &#39;Re:Re: React&#39;];ReactDOM.render(  &lt;Mailbox unreadMessages={messages} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><p>It works because in JS, <code>true &amp;&amp; expression</code> always evaluateds to <code>expression</code>, and <code>false &amp;&amp; expression</code> always evaluates to <code>false</code>. </p><ol start="3"><li><p>Inline if-else with conditional operator </p><p> <code>condition ? true : false</code></p></li><li><p>Return null will prevent a component from render, but it will not affect the componentâ€™s lifecycle methods. </p></li></ol><h2 id="1-7-Lists-and-Keys"><a href="#1-7-Lists-and-Keys" class="headerlink" title="1.7 Lists and Keys"></a>1.7 Lists and Keys</h2><h3 id="1-7-1-Rendering-Multiple-Components"><a href="#1-7-1-Rendering-Multiple-Components" class="headerlink" title="1.7.1 Rendering Multiple Components"></a>1.7.1 Rendering Multiple Components</h3><pre><code>const numbers = [1, 2, 3, 4, 5];const listItems = numbers.map((number) =&gt;  &lt;li&gt;{number}&lt;/li&gt;);// warning will be shown indicating you need provide key     function NumberList(props) {  const numbers = props.numbers;  const listItems = numbers.map((number) =&gt;    &lt;li&gt;{number}&lt;/li&gt;  );  return (    &lt;ul&gt;{listItems}&lt;/ul&gt;  );}const numbers = [1, 2, 3, 4, 5];ReactDOM.render(  &lt;NumberList numbers={numbers} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><p>A â€œkeyâ€ is a special string attribute you need to include when creating lists of elements. </p><pre><code>function NumberList(props) {  const numbers = props.numbers;  const listItems = numbers.map((number) =&gt;    &lt;li key={number.toString()}&gt;      {number}    &lt;/li&gt;  );  return (    &lt;ul&gt;{listItems}&lt;/ul&gt;  );}const numbers = [1, 2, 3, 4, 5];ReactDOM.render(  &lt;NumberList numbers={numbers} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h2 id="1-7-2-Keys"><a href="#1-7-2-Keys" class="headerlink" title="1.7.2 Keys"></a>1.7.2 Keys</h2><p>It helps React identify which items have changed, are added, or are removed. Keys should be given to the elements inside the array to give the elements a stable identity. </p><pre><code>const todoItems = todos.map((todo, index) =&gt;  // Only do this if items have no stable IDs  &lt;li key={index}&gt;    {todo.text}  &lt;/li&gt;);</code></pre><p>Using index as key might have some negative influence, thus weâ€™d better find some other specific string as the key. </p><p>!!! Keys only make sense in the context of the surrounding array. </p><pre><code>function ListItem(props) {  const value = props.value;  return (    // Wrong! There is no need to specify the key here:    &lt;li key={value.toString()}&gt;      {value}    &lt;/li&gt;  );}function NumberList(props) {  const numbers = props.numbers;  const listItems = numbers.map((number) =&gt;    // Wrong! The key should have been specified here:    &lt;ListItem value={number} /&gt;  );  return (    &lt;ul&gt;      {listItems}    &lt;/ul&gt;  );}const numbers = [1, 2, 3, 4, 5];ReactDOM.render(  &lt;NumberList numbers={numbers} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><p>Correct Version: </p><pre><code>function ListItem(props) {  // Correct! There is no need to specify the key here:  return &lt;li&gt;{props.value}&lt;/li&gt;;}function NumberList(props) {  const numbers = props.numbers;  const listItems = numbers.map((number) =&gt;    // Correct! Key should be specified inside the array.    &lt;ListItem key={number.toString()}              value={number} /&gt;  );  return (    &lt;ul&gt;      {listItems}    &lt;/ul&gt;  );}const numbers = [1, 2, 3, 4, 5];ReactDOM.render(  &lt;NumberList numbers={numbers} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h2 id="1-7-3-Embedding-map-in-JSX"><a href="#1-7-3-Embedding-map-in-JSX" class="headerlink" title="1.7.3 Embedding map() in JSX"></a>1.7.3 Embedding map() in JSX</h2><pre><code>function NumberList(props) {  const numbers = props.numbers;  const listItems = numbers.map((number) =&gt;    &lt;ListItem key={number.toString()}              value={number} /&gt;  );  return (    &lt;ul&gt;      {listItems}    &lt;/ul&gt;  );}</code></pre><p>After map:</p><pre><code>    function NumberList(props) {  const numbers = props.numbers;  return (    &lt;ul&gt;      {numbers.map((number) =&gt;        &lt;ListItem key={number.toString()}                  value={number} /&gt;      )}    &lt;/ul&gt;  );}</code></pre><h2 id="1-8-Forms"><a href="#1-8-Forms" class="headerlink" title="1.8 Forms"></a>1.8 Forms</h2><p>Form elements natuarlly keep some internal state.</p><pre><code>&lt;form&gt;  &lt;label&gt;    Name:    &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;  &lt;/label&gt;  &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/form&gt;</code></pre><p>React can use controlled components to achieve this. </p><h3 id="1-8-1-Controlled-Components-â€“-Form"><a href="#1-8-1-Controlled-Components-â€“-Form" class="headerlink" title="1.8.1 Controlled Components â€“ Form"></a>1.8.1 Controlled Components â€“ Form</h3><p>In HTML, input, textaream select typically <strong>maintain their own state and update it based on user input</strong>. In React, mutable state is typically kept in the state property of components, and only updated with <code>setState()</code>.</p><pre><code>class NameForm extends React.Component {  constructor(props) {    super(props);    this.state = {value: &#39;&#39;};    this.handleChange = this.handleChange.bind(this);    this.handleSubmit = this.handleSubmit.bind(this);  }  handleChange(event) {    this.setState({value: event.target.value});  }  handleSubmit(event) {    alert(&#39;A name was submitted: &#39; + this.state.value);    event.preventDefault();  }  render() {    return (      &lt;form onSubmit={this.handleSubmit}&gt;        &lt;label&gt;          Name:          &lt;input type=&quot;text&quot; value={this.state.value} onChange={this.handleChange} /&gt;        &lt;/label&gt;        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;      &lt;/form&gt;    );  }}</code></pre><p>Controlled Component, in this way, use <code>state</code> in React to control the change of text. With a controlled component, <strong><em>every state mutaion will have an associated handler function</em></strong>, This makes it straightforward to modify or validate user input. </p><h3 id="1-8-2-Controlled-Components-â€“-textarea"><a href="#1-8-2-Controlled-Components-â€“-textarea" class="headerlink" title="1.8.2 Controlled Components â€“ textarea"></a>1.8.2 Controlled Components â€“ textarea</h3><pre><code>class EssayForm extends React.Component {  constructor(props) {    super(props);    this.state = {      value: &#39;Please write an essay about your favorite DOM element.&#39;    };    this.handleChange = this.handleChange.bind(this);    this.handleSubmit = this.handleSubmit.bind(this);  }  handleChange(event) {    this.setState({value: event.target.value});  }  handleSubmit(event) {    alert(&#39;An essay was submitted: &#39; + this.state.value);    event.preventDefault();  }  render() {    return (      &lt;form onSubmit={this.handleSubmit}&gt;        &lt;label&gt;          Essay:          &lt;textarea value={this.state.value} onChange={this.handleChange} /&gt;        &lt;/label&gt;        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;      &lt;/form&gt;    );  }}</code></pre><p>Have the value property, and associate it with state. change it by handler function, and deal with it with a chain of handlers. </p><h3 id="1-8-3-Controlled-Components-â€“-select"><a href="#1-8-3-Controlled-Components-â€“-select" class="headerlink" title="1.8.3 Controlled Components â€“ select"></a>1.8.3 Controlled Components â€“ select</h3><pre><code>&lt;select&gt;  &lt;option value=&quot;grapefruit&quot;&gt;Grapefruit&lt;/option&gt;  &lt;option value=&quot;lime&quot;&gt;Lime&lt;/option&gt;  &lt;option selected value=&quot;coconut&quot;&gt;Coconut&lt;/option&gt;  &lt;option value=&quot;mango&quot;&gt;Mango&lt;/option&gt;&lt;/select&gt;</code></pre><p>coconut has been selected with the selected property </p><pre><code>class FlavorForm extends React.Component {  constructor(props) {    super(props);    this.state = {value: &#39;coconut&#39;};    this.handleChange = this.handleChange.bind(this);    this.handleSubmit = this.handleSubmit.bind(this);  }  handleChange(event) {    this.setState({value: event.target.value});  }  handleSubmit(event) {    alert(&#39;Your favorite flavor is: &#39; + this.state.value);    event.preventDefault();  }  render() {    return (      &lt;form onSubmit={this.handleSubmit}&gt;        &lt;label&gt;          Pick your favorite flavor:          &lt;select value={this.state.value} onChange={this.handleChange}&gt;            &lt;option value=&quot;grapefruit&quot;&gt;Grapefruit&lt;/option&gt;            &lt;option value=&quot;lime&quot;&gt;Lime&lt;/option&gt;            &lt;option value=&quot;coconut&quot;&gt;Coconut&lt;/option&gt;            &lt;option value=&quot;mango&quot;&gt;Mango&lt;/option&gt;          &lt;/select&gt;        &lt;/label&gt;        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;      &lt;/form&gt;    );  }}</code></pre><p>By setting the start state as cconut, we realize the same function as you see in the HTML part. But come to be more extenable since when we want to change its states, we only need to change this componentâ€™s state. </p><h3 id="1-8-4-Handling-multiple-inputs"><a href="#1-8-4-Handling-multiple-inputs" class="headerlink" title="1.8.4 Handling multiple inputs"></a>1.8.4 Handling multiple inputs</h3><p>when need to handle multiple controlled input elements, you can add a name attribute to each element and let the handler function choose what to do based on the value of <code>event.target.name</code>.</p><pre><code>class Reservation extends React.Component {  constructor(props) {    super(props);    this.state = {      isGoing: true,      numberOfGuests: 2    };    this.handleInputChange = this.handleInputChange.bind(this);  }  handleInputChange(event) {    const target = event.target;    const value = target.type === &#39;checkbox&#39; ? target.checked : target.value;    const name = target.name;    this.setState({      [name]: value    });  }  render() {    return (      &lt;form&gt;        &lt;label&gt;          Is going:          &lt;input            name=&quot;isGoing&quot;            type=&quot;checkbox&quot;            checked={this.state.isGoing}            onChange={this.handleInputChange} /&gt;        &lt;/label&gt;        &lt;br /&gt;        &lt;label&gt;          Number of guests:          &lt;input            name=&quot;numberOfGuests&quot;            type=&quot;number&quot;            value={this.state.numberOfGuests}            onChange={this.handleInputChange} /&gt;        &lt;/label&gt;      &lt;/form&gt;    );  }}</code></pre><p><code>handleInputChange</code> here controls two input, one is a checkbox, another is a scrolled banner. Thatâ€™s the reason we need to judge target type in function. However, I do think there is no need to combine those two sub component, and use one handler function, at least in this example. </p><blockquote><p>Notice: in <code>setState</code>, we use <code>[name] : value</code>. Itâ€™s because <strong><em>name is a computed property, [] means need to compute here</em></strong>. </p></blockquote><h2 id="1-9-Lifting-state-up"><a href="#1-9-Lifting-state-up" class="headerlink" title="1.9 Lifting state up"></a>1.9 Lifting state up</h2><p>Happen when several components need to reflext the same changing data. Need to lifting the shared state up to their closest common ancestor. </p><pre><code>const scaleNames = {  c: &#39;Celsius&#39;,  f: &#39;Fahrenheit&#39;};function toCelsius(fahrenheit) {  return (fahrenheit - 32) * 5 / 9;}function toFahrenheit(celsius) {  return (celsius * 9 / 5) + 32;}function tryConvert(temperature, convert) {  const input = parseFloat(temperature);  if (Number.isNaN(input)) {    return &#39;&#39;;  }  const output = convert(input);  const rounded = Math.round(output * 1000) / 1000;  return rounded.toString();}function BoilingVerdict(props) {  if (props.celsius &gt;= 100) {    return &lt;p&gt;The water would boil.&lt;/p&gt;;  }  return &lt;p&gt;The water would not boil.&lt;/p&gt;;}class TemperatureInput extends React.Component {  constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);  }  handleChange(e) {    this.props.onTemperatureChange(e.target.value);  }  render() {    const temperature = this.props.temperature;    const scale = this.props.scale;    return (      &lt;fieldset&gt;        &lt;legend&gt;Enter temperature in {scaleNames[scale]}:&lt;/legend&gt;        &lt;input value={temperature}               onChange={this.handleChange} /&gt;      &lt;/fieldset&gt;    );  }}class Calculator extends React.Component {  constructor(props) {    super(props);    this.handleCelsiusChange = this.handleCelsiusChange.bind(this);    this.handleFahrenheitChange = this.handleFahrenheitChange.bind(this);    this.state = {temperature: &#39;&#39;, scale: &#39;c&#39;};  }  handleCelsiusChange(temperature) {    this.setState({scale: &#39;c&#39;, temperature});  }  handleFahrenheitChange(temperature) {    this.setState({scale: &#39;f&#39;, temperature});  }  render() {    const scale = this.state.scale;    const temperature = this.state.temperature;    const celsius = scale === &#39;f&#39; ? tryConvert(temperature, toCelsius) : temperature;    const fahrenheit = scale === &#39;c&#39; ? tryConvert(temperature, toFahrenheit) : temperature;    return (      &lt;div&gt;        &lt;TemperatureInput          scale=&quot;c&quot;          temperature={celsius}          onTemperatureChange={this.handleCelsiusChange} /&gt;        &lt;TemperatureInput          scale=&quot;f&quot;          temperature={fahrenheit}          onTemperatureChange={this.handleFahrenheitChange} /&gt;        &lt;BoilingVerdict          celsius={parseFloat(celsius)} /&gt;      &lt;/div&gt;    );  }}ReactDOM.render(  &lt;Calculator /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><ol><li>Lifting state, React calls the function specified as onChange on the DOM <input>. In our case, this is the handleChange method in the TemperatureInput component.</li><li>The handleChange method in the TemperatureInput component calls <strong>this.props.onTemperatureChange()</strong> with the new desired value. Its props, including onTemperatureChange, were provided by its parent component, the Calculator.</li><li>When it previously rendered, the Calculator has specified that onTemperatureChange of the Celsius TemperatureInput is the Calculatorâ€™s handleCelsiusChange method, and onTemperatureChange of the Fahrenheit TemperatureInput is the Calculatorâ€™s handleFahrenheitChange method. So either of these two Calculator methods gets called depending on which input we edited.</li><li>Inside these methods, the Calculator component asks React to re-render itself by calling this.setState() with the new input value and the current scale of the input we just edited.</li><li>React calls the Calculator componentâ€™s render method to learn what the UI should look like. The values of both inputs are recomputed based on the current temperature and the active scale. The temperature conversion is performed here.</li><li>React calls the render methods of the individual TemperatureInput components with their new props specified by the Calculator. It learns what their UI should look like.</li><li>React calls the render method of the BoilingVerdict component, passing the temperature in Celsius as its props.</li><li>React DOM updates the DOM with the boiling verdict and to match the desired input values. The input we just edited receives its current value, and the other input is updated to the temperature after conversion.</li></ol><p>Usually, the state is first added to the component that needs it for rendering, Then it other components also need it, you can lift it up to their closest common ancestor. </p><h2 id="1-10-Compisition-vs-Inheritance"><a href="#1-10-Compisition-vs-Inheritance" class="headerlink" title="1.10 Compisition vs Inheritance"></a>1.10 Compisition vs Inheritance</h2><p>React has a powerful composition model, and we recommend <strong>using composition</strong> instead of inheritance to <strong>reuse code</strong> between components. </p><h3 id="1-10-1-Containment"><a href="#1-10-1-Containment" class="headerlink" title="1.10.1 Containment"></a>1.10.1 Containment</h3><p>Some component donâ€™t know their children ahead of time. This is especially common for components like SideBar or Dialog that represent generic boxes. </p><p>We can use <code>children</code> props to pass children elements derectly into their output. </p><pre><code>function FancyBorder(props) {  return (    &lt;div className={&#39;FancyBorder FancyBorder-&#39; + props.color}&gt;      {props.children}    &lt;/div&gt;  );}function WelcomeDialog() {  return (    &lt;FancyBorder color=&quot;blue&quot;&gt;      &lt;h1 className=&quot;Dialog-title&quot;&gt;        Welcome      &lt;/h1&gt;      &lt;p className=&quot;Dialog-message&quot;&gt;        Thank you for visiting our spacecraft!      &lt;/p&gt;    &lt;/FancyBorder&gt;  );}</code></pre><p>Anything inside the <code>&lt;FancyBorder&gt;</code> JSX tag gets passed into the FancyBorder component as a children prop. Since FancyBorder renders <code>{props.children}</code> inside a <code>&lt;div&gt;</code>, then passed elements appear in the final output. </p><p>And also, we can use your own props and pass it inside. </p><pre><code>function SplitPane(props) {  return (    &lt;div className=&quot;SplitPane&quot;&gt;      &lt;div className=&quot;SplitPane-left&quot;&gt;        {props.left}      &lt;/div&gt;      &lt;div className=&quot;SplitPane-right&quot;&gt;        {props.right}      &lt;/div&gt;    &lt;/div&gt;  );}function App() {  return (    &lt;SplitPane      left={        &lt;Contacts /&gt;      }      right={        &lt;Chat /&gt;      } /&gt;  );}</code></pre><h3 id="1-10-2-Specialization"><a href="#1-10-2-Specialization" class="headerlink" title="1.10.2 Specialization"></a>1.10.2 Specialization</h3><p>A more specific component renders a more generic one and configures it with props: </p><pre><code>function Dialog(props) {  return (    &lt;FancyBorder color=&quot;blue&quot;&gt;      &lt;h1 className=&quot;Dialog-title&quot;&gt;        {props.title}      &lt;/h1&gt;      &lt;p className=&quot;Dialog-message&quot;&gt;        {props.message}      &lt;/p&gt;    &lt;/FancyBorder&gt;  );}function WelcomeDialog() {  return (    &lt;Dialog      title=&quot;Welcome&quot;      message=&quot;Thank you for visiting our spacecraft!&quot; /&gt;  );</code></pre><h3 id="1-10-3-Example"><a href="#1-10-3-Example" class="headerlink" title="1.10.3 Example"></a>1.10.3 Example</h3><pre><code>function Dialog(props) {  return (    &lt;FancyBorder color=&quot;blue&quot;&gt;      &lt;h1 className=&quot;Dialog-title&quot;&gt;        {props.title}      &lt;/h1&gt;      &lt;p className=&quot;Dialog-message&quot;&gt;        {props.message}      &lt;/p&gt;      {props.children}    &lt;/FancyBorder&gt;  );}class SignUpDialog extends React.Component {  constructor(props) {    super(props);    this.handleChange = this.handleChange.bind(this);    this.handleSignUp = this.handleSignUp.bind(this);        this.state = {login: &#39;&#39;};      }      render() {        return (          &lt;Dialog title=&quot;Mars Exploration Program&quot;                  message=&quot;How should we refer to you?&quot;&gt;            &lt;input value={this.state.login}                   onChange={this.handleChange} /&gt;            &lt;button onClick={this.handleSignUp}&gt;              Sign Me Up!            &lt;/button&gt;          &lt;/Dialog&gt;        );      }      handleChange(e) {        this.setState({login: e.target.value});      }      handleSignUp() {        alert(`Welcome aboard, ${this.state.login}!`);      }    }</code></pre><h1 id="2-Thinking-How-to-build-an-product-from-scratch"><a href="#2-Thinking-How-to-build-an-product-from-scratch" class="headerlink" title="2. Thinking - How to build an product from scratch"></a>2. Thinking - How to build an product from scratch</h1><ol><li><p>Start with a mock: UI + Json API</p></li><li><p>Break the UI into a Component Hierarchy </p></li><li><p>Separate to different components, following <strong><em>single responsibility principle</em></strong>. A component should ideally only do one thing. </p></li><li><p>Build a static version in react </p><ul><li>decouple styling and interactivity </li><li>static version always use props, since state is reserved only for interactivity </li><li>Larger project, easier bottom up. </li><li>Donâ€™t repeat yourself</li></ul></li><li><p>Identify the minimal representation of UI state</p><ul><li>Is it passed in from a parent via props? If so, it probably isnâ€™t state.</li><li>Does it remain unchanged over time? If so, it probably isnâ€™t state.</li><li>Can you compute it based on any other state or props in your component? If so, it isnâ€™t state.</li></ul></li><li><p>Idenfify where your state should live </p></li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://reactjs.org/docs/hello-world.html" target="_blank" rel="noopener">REACT DOC</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pupperteer Tutorial</title>
      <link href="/Pupperteer-Tutorial/"/>
      <url>/Pupperteer-Tutorial/</url>
      
        <content type="html"><![CDATA[<p>This post is merely some notes when I learnt pupperteer, basically contain similar info from google developer webpage. Try to organize those info in a personal understandable way here. </p><h1 id="1-What-is-Pupperteer"><a href="#1-What-is-Pupperteer" class="headerlink" title="1. What is Pupperteer"></a>1. What is Pupperteer</h1><p>Most thins you can do manually in the browser now can be done with puppeteer. </p><h1 id="2-Usage"><a href="#2-Usage" class="headerlink" title="2. Usage"></a>2. Usage</h1><h2 id="2-1-General"><a href="#2-1-General" class="headerlink" title="2.1 General"></a>2.1 General</h2><ul><li>Create an instance of Browser </li><li>Open pages </li><li>manipulate them with Puppeteerâ€™s API </li></ul><h1 id="3-Learn-by-doing"><a href="#3-Learn-by-doing" class="headerlink" title="3. Learn by doing"></a>3. Learn by doing</h1><h2 id="3-1-See-an-example-to-learn-how-the-thing-works"><a href="#3-1-See-an-example-to-learn-how-the-thing-works" class="headerlink" title="3.1 See an example to learn how the thing works"></a>3.1 See an example to learn how the thing works</h2><pre><code>/** * Copyright 2018 Google Inc. All rights reserved. * * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * *     http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. * * @author ebidel@ (Eric Bidelman) *//** * Takes a screenshot of the latest tweet in a user&#39;s timeline and creates a * PDF of it. Shows how to use Puppeteer to: * *   1. screenshot a DOM element *   2. craft an HTML page on-the-fly *   3. produce an image of the element and PDF of the page with the image embedded * * Usage: *   node element-to-pdf.js *   USERNAME=ChromiumDev node element-to-pdf.js * *   --searchable makes &quot;find in page&quot; work: *   node element-to-pdf.js --searchable * * Output: *   tweet.png and tweet.pdf */// Include modules that exist in separate files, basically it reads a js file, executes the // file and then proceed to return the exports object const puppeteer = require(&#39;puppeteer&#39;);// process.env is a global variable, injected by node at runtime // represent the state of the system environment application // it will try to get from process env, if cannot get there, will fallback to default// here, means fallback to &#39;ebidel&#39;const username = process.env.USERNAME || &#39;ebidel&#39;;const searchable = process.argv.includes(&#39;--searchable&#39;);(async() =&gt; {// launch a chromium instance const browser = await puppeteer.launch();// launch a new page const page = await browser.newPage();// set a screen size await page.setViewport({width: 1200, height: 800, deviceScaleFactor: 2});await page.goto(`https://twitter.com/${username}`);// Can&#39;t use elementHandle.click() because it clicks the center of the element// with the mouse. On tweets like https://twitter.com/ebidel/status/915996563234631680// there is an embedded card link to another tweet that it clicks.// find the component, and do some function thereawait page.$eval(`.tweet[data-screen-name=&quot;${username}&quot;]`, tweet =&gt; tweet.click());// wait for it to be availableawait page.waitForSelector(&#39;.tweet.permalink-tweet&#39;, {visible: true});// run document.querySelector within the page. If no element matches the selector, return // value will be resolved to nullconst overlay = await page.$(&#39;.tweet.permalink-tweet&#39;);const screenshot = await overlay.screenshot({path: &#39;tweet.png&#39;});if (searchable) {  await page.evaluate(tweet =&gt; {    const width = getComputedStyle(tweet).width;    tweet = tweet.cloneNode(true);    tweet.style.width = width;    document.body.innerHTML = `      &lt;div style=&quot;display:flex;justify-content:center;align-items:center;height:100vh;&quot;&gt;;        ${tweet.outerHTML}      &lt;/div&gt;    `;  }, overlay);} else {  await page.setContent(`    &lt;!DOCTYPE html&gt;    &lt;html&gt;      &lt;head&gt;        &lt;style&gt;          html, body {            height: 100vh;            margin: 0;            display: flex;            justify-content: center;            align-items: center;            background: #fafafa;          }          img {            max-width: 60%;            box-shadow: 3px 3px 6px #eee;            border-radius: 6px;          }        &lt;/style&gt;      &lt;/head&gt;      &lt;body&gt;        &lt;img src=&quot;data:img/png;base64,${screenshot.toString(&#39;base64&#39;)}&quot;&gt;      &lt;/body&gt;    &lt;/html&gt;  `);}await page.pdf({path: &#39;tweet.pdf&#39;, printBackground: true});await browser.close();})();</code></pre><h2 id="3-2-crawlsite-js"><a href="#3-2-crawlsite-js" class="headerlink" title="3.2 crawlsite.js"></a>3.2 crawlsite.js</h2><pre><code>/** * Copyright 2018 Google Inc. All rights reserved. * * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * *     http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. * * @author ebidel@ (Eric Bidelman) */ /**  * Discovers all the pages in site or single page app (SPA) and creates  * a tree of the result in ./output/&lt;site slug/crawl.json. Optionally  * takes screenshots of each page as it is visited.  *  * Usage:  *   node crawlsite.js  *   URL=https://yourspa.com node crawlsite.js  *   URL=https://yourspa.com node crawlsite.js --screenshots  *  * Then open the visualizer in a browser:  *   http://localhost:8080/html/d3tree.html  *   http://localhost:8080/html/d3tree.html?url=../output/https___yourspa.com/crawl.json  *  *Start Server:  *   node server.js  *  */// provides an API for interacting with the file system const fs = require(&#39;fs&#39;);// delete files const del = require(&#39;del&#39;);// nodeJS util moduleconst util = require(&#39;util&#39;);const puppeteer = require(&#39;puppeteer&#39;);// high performance Node.js image proccessing, fastest module to resize JPEG, PNG, etc. const sharp = require(&#39;sharp&#39;);const URL = process.env.URL || &#39;https://news.polymer-project.org/&#39;;const SCREENSHOTS = process.argv.includes(&#39;--screenshots&#39;);const DEPTH = parseInt(process.env.DEPTH) || 2;const VIEWPORT = SCREENSHOTS ? {width: 1028, height: 800, deviceScaleFactor: 2} : null;const OUT_DIR = process.env.OUTDIR || `output/${slugify(URL)}`;const crawledPages = new Map();const maxDepth = DEPTH; // Subpage depth to crawl site.function slugify(str) {  return str.replace(/[\/:]/g, &#39;_&#39;);}function mkdirSync(dirPath) {  try {    dirPath.split(&#39;/&#39;).reduce((parentPath, dirName) =&gt; {      const currentPath = parentPath + dirName;      if (!fs.existsSync(currentPath)) {        fs.mkdirSync(currentPath);      }      return currentPath + &#39;/&#39;;    }, &#39;&#39;);  } catch (err) {    if (err.code !== &#39;EEXIST&#39;) {      throw err;    }  }}/** * Finds all anchors on the page, inclusive of those within shadow roots. * Note: Intended to be run in the context of the page. * @param {boolean=} sameOrigin When true, only considers links from the same origin as the app. * @return {!Array&lt;string&gt;} List of anchor hrefs. */function collectAllSameOriginAnchorsDeep(sameOrigin = true) {  const allElements = [];  const findAllElements = function(nodes) {    for (let i = 0, el; el = nodes[i]; ++i) {      allElements.push(el);      // If the element has a shadow root, dig deeper.      if (el.shadowRoot) {        findAllElements(el.shadowRoot.querySelectorAll(&#39;*&#39;));      }    }  };  findAllElements(document.querySelectorAll(&#39;*&#39;));  const filtered = allElements    .filter(el =&gt; el.localName === &#39;a&#39; &amp;&amp; el.href) // element is an anchor with an href.    .filter(el =&gt; el.href !== location.href) // link doesn&#39;t point to page&#39;s own URL.    .filter(el =&gt; {      if (sameOrigin) {        return new URL(location).origin === new URL(el.href).origin;      }      return true;    })    .map(a =&gt; a.href);  return Array.from(new Set(filtered));}/** * Crawls a URL by visiting an url, then recursively visiting any child subpages. * @param {!Browser} browser * @param {{url: string, title: string, img?: string, children: !Array<!Object>}} page Current page. * @param {number=} depth Current subtree depth of crawl. */async function crawl(browser, page, depth = 0) {  if (depth &gt; maxDepth) {    return;  }  // If we&#39;ve already crawled the URL, we know its children.  if (crawledPages.has(page.url)) {    console.log(`Reusing route: ${page.url}`);    const item = crawledPages.get(page.url);    page.title = item.title;    page.img = item.img;    page.children = item.children;    // Fill in the children with details (if they already exist).    page.children.forEach(c =&gt; {      const item = crawledPages.get(c.url);      c.title = item ? item.title : &#39;&#39;;      c.img = item ? item.img : null;    });    return;  } else {    console.log(`Loading: ${page.url}`);    const newPage = await browser.newPage();    await newPage.goto(page.url, {waitUntil: &#39;networkidle2&#39;});    let anchors = await newPage.evaluate(collectAllSameOriginAnchorsDeep);    anchors = anchors.filter(a =&gt; a !== URL) // link doesn&#39;t point to start url of crawl.    page.title = await newPage.evaluate(&#39;document.title&#39;);    page.children = anchors.map(url =&gt; ({url}));    if (SCREENSHOTS) {      const path = `./${OUT_DIR}/${slugify(page.url)}.png`;      let imgBuff = await newPage.screenshot({fullPage: false});      imgBuff = await sharp(imgBuff).resize(null, 150).toBuffer(); // resize image to 150 x auto.      util.promisify(fs.writeFile)(path, imgBuff); // async      page.img = `data:img/png;base64,${imgBuff.toString(&#39;base64&#39;)}`;    }    crawledPages.set(page.url, page); // cache it.    await newPage.close();  }  // Crawl subpages.  for (const childPage of page.children) {    await crawl(browser, childPage, depth + 1);  }}(async() =&gt; {mkdirSync(OUT_DIR); // create output dir if it doesn&#39;t exist.await del([`${OUT_DIR}/*`]); // cleanup after last run.const browser = await puppeteer.launch();const page = await browser.newPage();if (VIEWPORT) {  await page.setViewport(VIEWPORT);}const root = {url: URL};await crawl(browser, root);await util.promisify(fs.writeFile)(`./${OUT_DIR}/crawl.json`, JSON.stringify(root, null, &#39; &#39;));await browser.close();})();</code></pre>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> UI Test </tag>
            
            <tag> Puppeteer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NightWatch JavaScript Tutorial</title>
      <link href="/NightWatch-JavaScript-Tutorial/"/>
      <url>/NightWatch-JavaScript-Tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><ul><li>Complete end-to-end testing solition </li><li>written in nodejs and using the WebDriver </li><li>WebDriver <ul><li>Library for automating web browsers  </li><li>A remote control interface that enables intrpspection and controls of user agents. Provides a platform and a restful HTTP api as a way for web browsers to be remotely controlled. </li></ul></li></ul><h1 id="2-How-to-use"><a href="#2-How-to-use" class="headerlink" title="2. How to use"></a>2. How to use</h1><h2 id="2-1-Writing-tests-in-general-way"><a href="#2-1-Writing-tests-in-general-way" class="headerlink" title="2.1 Writing tests in general way"></a>2.1 Writing tests in general way</h2><ul><li>use the preferred CSS selector model to locate elements on a page</li><li>create a separate folder for tests in the project </li></ul><p>E.G we could set couple different steps to interact with the page in multiple ways. </p><pre><code>module.exports = {  &#39;step 1&#39; : function (browser) {    browser      .url(&#39;https://www.google.com&#39;)      .waitForElementVisible(&#39;body&#39;)      .setValue(&#39;input[type=text]&#39;, &#39;nightwatch&#39;)      .waitForElementVisible(&#39;input[name=btnK]&#39;)      .click(&#39;input[name=btnK]&#39;)      .pause(1000)      .assert.containsText(&#39;#main&#39;, &#39;Night Watch&#39;)      .end();  },       &#39;step 2&#39; : function (browser) {        browser          .click(&#39;input[name=btnK]&#39;)          .pause(1000)          .assert.containsText(&#39;#main&#39;, &#39;Night Watch&#39;)          .end();      }};</code></pre><h2 id="2-2-Writing-tests-in-ES6-with-async-await"><a href="#2-2-Writing-tests-in-ES6-with-async-await" class="headerlink" title="2.2 Writing tests in ES6 with async/ await"></a>2.2 Writing tests in ES6 with async/ await</h2><ul><li>improves the readability and ease of writing of tests</li><li>no longer be available to chain the API commands when using an async function </li></ul><pre><code>module.exports = {  &#39;demo test async&#39;: async function (browser) {    // get the available window handles    const result = await browser.windowHandles();    console.log(&#39;result&#39;, result);    // switch to the second window    // await is not necessary here since we&#39;re not interested in the result    browser.switchWindow(result.value[1]);  }};</code></pre><h2 id="2-3-Expect-Assertions"><a href="#2-3-Expect-Assertions" class="headerlink" title="2.3 Expect Assertions"></a>2.3 Expect Assertions</h2><pre><code>module.exports = {  &#39;Demo test Google&#39; : function (browser) {    browser      .url(&#39;https://google.no&#39;)      .pause(1000);    // expect element &lt;body&gt; to be present in 1000ms    browser.expect.element(&#39;body&#39;).to.be.present.before(1000);    // expect element &lt;#lst-ib&gt; to have css property &#39;display&#39;    browser.expect.element(&#39;#lst-ib&#39;).to.have.css(&#39;display&#39;);    // expect element &lt;body&gt; to have attribute &#39;class&#39; which contains text &#39;vasq&#39;    browser.expect.element(&#39;body&#39;).to.have.attribute(&#39;class&#39;).which.contains(&#39;vasq&#39;);    // expect element &lt;#lst-ib&gt; to be an input tag    browser.expect.element(&#39;#lst-ib&#39;).to.be.an(&#39;input&#39;);    // expect element &lt;#lst-ib&gt; to be visible    browser.expect.element(&#39;#lst-ib&#39;).to.be.visible;    browser.end();  }};</code></pre><h2 id="2-4-before-after-beforeEach-afterEach"><a href="#2-4-before-after-beforeEach-afterEach" class="headerlink" title="2.4 before, after, beforeEach, afterEach"></a>2.4 before, after, beforeEach, afterEach</h2><ul><li>standard hook </li><li>before and after will run before and after the test suite</li><li>beforeEach and afterEach will run before and after each test case </li></ul><pre><code>module.exports = {  before : function(browser) {    console.log(&#39;Setting up...&#39;);  },  after : function(browser) {    console.log(&#39;Closing down...&#39;);  },  beforeEach : function(browser) {  },  afterEach : function(browser) {  },  &#39;step one&#39; : function (browser) {    browser     // ...  },  &#39;step two&#39; : function (browser) {    browser    // ...      .end();  }};</code></pre><h2 id="2-5-Controlling-the-done-invocation-timeout"><a href="#2-5-Controlling-the-done-invocation-timeout" class="headerlink" title="2.5 Controlling the done invocation timeout"></a>2.5 Controlling the done invocation timeout</h2><p>Increase the timeout by defining an <code>ayncHootTimeout</code> property in the external globals file. We should set a global module somewhere for all to use </p><p><a href="https://github.com/nightwatchjs/nightwatch/blob/master/examples/globalsModule.js#L20" target="_blank" rel="noopener">globalModule</a></p><h2 id="2-6-Test-Env"><a href="#2-6-Test-Env" class="headerlink" title="2.6 Test Env"></a>2.6 Test Env</h2><ul><li>we could define multiple sections of test settings so you could overwrite specific values per env. </li></ul><pre><code>{  ...  &quot;test_settings&quot; : {    &quot;default&quot; : {      &quot;launch_url&quot; : &quot;http://localhost&quot;,      &quot;globals&quot; : {        &quot;myGlobalVar&quot; : &quot;some value&quot;,        &quot;otherGlobal&quot; : &quot;some other value&quot;      }    },    &quot;integration&quot; : {      &quot;launch_url&quot; : &quot;http://staging.host&quot;,      &quot;globals&quot; : {        &quot;myGlobalVar&quot; : &quot;other value&quot;      }    }  }}</code></pre><h2 id="2-7-Test-Groups"><a href="#2-7-Test-Groups" class="headerlink" title="2.7 Test Groups"></a>2.7 Test Groups</h2><ul><li>we could organize test into groups and run tem as needed.</li><li>just place them in sub-folders if you want to run them together.</li></ul><h2 id="2-8-Using-Page-Objects"><a href="#2-8-Using-Page-Objects" class="headerlink" title="2.8 Using Page Objects"></a>2.8 Using Page Objects</h2><ul><li>Wrap the pages or page fragments of a web app into objects. </li><li>Allow a software client to do anything and see anything that a human can be abstracting away the underlying html actions needed to access and manipulate the page </li><li>page objects are read from the folder specified in the <code>page_objects_path</code> configuration property</li></ul><h2 id="2-9-Define-Elements"><a href="#2-9-Define-Elements" class="headerlink" title="2.9 Define Elements"></a>2.9 Define Elements</h2><pre><code>module.exports = {  elements: {    searchBar: {      selector: &#39;input[type=text]&#39;    },    submit: {      selector: &#39;//[@name=&quot;q&quot;]&#39;,      locateStrategy: &#39;xpath&#39;    }  }};</code></pre><ul><li>allow you to refer to the element by its name with an â€œ@â€ prefix, rather than selector</li></ul><h3 id="2-9-1-Element-Properties"><a href="#2-9-1-Element-Properties" class="headerlink" title="2.9.1 Element Properties"></a>2.9.1 Element Properties</h3><p>An element can be specified as an object with <code>selector</code> property</p><ul><li>selector  </li><li>localeStrategy  â€˜cssâ€™</li><li>index <ul><li>used to target a specific element in a query that results in multiple elements returned</li></ul></li><li>abortOnFailure</li><li>timeout </li><li>retryInterval </li><li>suppressNotFoundErrors </li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://nightwatchjs.org/api/#expect-api" target="_blank" rel="noopener">https://nightwatchjs.org/api/#expect-api</a></li><li><a href="https://nightwatchjs.org/guide" target="_blank" rel="noopener">https://nightwatchjs.org/guide</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
            <tag> NightWatch </tag>
            
            <tag> UI Test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typescript Tutorial</title>
      <link href="/Typescript-Tutorial/"/>
      <url>/Typescript-Tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><ul><li>A typed superset of JavaScript that compiles to plain JavaScript</li><li>Pure object oriented with classes, interfaces </li><li>for application scale development </li><li>benefits<ul><li>provides the error checking feature </li><li>will compile the code and generate compilation errors </li><li>strong static typing </li><li>supports type definitions for existing JS libraries<ul><li>TS definition file (with <code>.d.ts</code> extension) provides definition for external JS libraries</li></ul></li></ul></li><li>components<ul><li>language <ul><li>comprises of <ul><li>syntax</li><li>keywords</li><li>type annotations</li></ul></li></ul></li><li>the typeScript Compiler <ul><li>The TypeScript Comiler converts the instructions written in TypeScript to its JavaScript equivalent </li></ul></li><li>the typeScript Language Service<ul><li>expose an additional layer around the core compiler pipeline that are editor-like applications</li><li>language service supports <ul><li>statement completions</li><li>signature help</li><li>code formatting and outlining</li><li>colorization </li></ul></li></ul></li></ul></li><li>declaration files <ul><li>declaration file <ul><li>interface to the components in the compiled javaScript</li><li>analogous to the header files </li></ul></li></ul></li></ul><h1 id="2-Basic-Syntax"><a href="#2-Basic-Syntax" class="headerlink" title="2. Basic Syntax"></a>2. Basic Syntax</h1><ul><li>composed of <ul><li>module </li><li>fucntions </li><li>variables</li><li>statements and expressions</li><li>comments</li></ul></li><li>tsc will translate ts file to js </li><li>ts and oop<ul><li>object <ul><li>state </li><li>behavior </li><li>identity </li></ul></li><li>class</li><li>method</li></ul></li></ul><pre><code>class Greeting {    greet():void {       console.log(&quot;Hello World!!!&quot;)    } } var obj = new Greeting(); obj.greet();</code></pre><h2 id="2-1-Types"><a href="#2-1-Types" class="headerlink" title="2.1 Types"></a>2.1 Types</h2><p>Represents the different types of values supported by the language, The type system checks the validity of the supplied values, before they are stored or manipulated by the program. </p><p>The type system further allows for <strong>richer code hinting</strong> and <strong>automated documentation</strong> too. </p><ul><li>any type<ul><li>super type of all types in TS </li><li>denotes a dynamic type </li><li>use the any type is equivalent to opting out of type checking for a variable </li></ul></li><li>built-in types<ul><li>Number <ul><li>double precision 64 bit floating point values </li></ul></li><li>String <ul><li>a sequence of Unicode characters </li></ul></li><li>Boolean <ul><li>logical values </li></ul></li><li>Void <ul><li>used on function return types to represent non-returning functions </li></ul></li><li>Null <ul><li>represents an intentional absense of an object value </li></ul></li><li>Undefined <ul><li>denotes value given to all uninitialized variables </li></ul></li></ul></li></ul><h2 id="2-2-Variables"><a href="#2-2-Variables" class="headerlink" title="2.2 Variables"></a>2.2 Variables</h2><ul><li>Variable - name space in the memory that stores values.</li><li>acts as a container for values in a program </li><li>use the <code>var</code> keyword to declare variables </li></ul><pre><code>var [identifier] : [type-annotation] = value;</code></pre><h3 id="2-2-1-Type-assertion"><a href="#2-2-1-Type-assertion" class="headerlink" title="2.2.1 Type assertion"></a>2.2.1 Type assertion</h3><ul><li>to change a variable from one type to another </li></ul><pre><code>var str = &#39;1&#39;;var str:number = &lt;number&gt; str;</code></pre><ul><li>if you doesnâ€™t add type for variables, ts will determine the type of the variable on the basis of the value assigned to it</li></ul><h3 id="2-2-2-Variable-Scope"><a href="#2-2-2-Variable-Scope" class="headerlink" title="2.2.2 Variable Scope"></a>2.2.2 Variable Scope</h3><ul><li>global scope<ul><li>declare outside the programming constructs</li><li>can be accessed from anywhere within code</li></ul></li><li>class scope<ul><li>called fields </li><li>are declared within the class but outside the methods </li><li>can be accessed using the object of the class </li></ul></li></ul><pre><code>var global_num = 12          //global variable class Numbers {    num_val = 13;             //class variable    static sval = 10;         //static field    storeNum():void {       var local_num = 14;    //local variable    } } console.log(&quot;Global num: &quot;+global_num)  console.log(Numbers.sval)   //static variable  var obj = new Numbers(); console.log(&quot;Global num: &quot;+obj.num_val) </code></pre><h2 id="2-3-Operators"><a href="#2-3-Operators" class="headerlink" title="2.3 Operators"></a>2.3 Operators</h2><ul><li>Defines some function that will be performed on the data <ul><li>arithmetic operators </li><li>relational operators </li><li>logical operators </li><li>bitwise operators </li><li>assignment operators </li><li>type operators<ul><li>typeof <ul><li>return the type of variable</li></ul></li><li>instance of <ul><li>return the class of an object  </li></ul></li></ul></li></ul></li></ul><h2 id="2-4-Functions"><a href="#2-4-Functions" class="headerlink" title="2.4 Functions"></a>2.4 Functions</h2><ul><li>building blocks of readable, maintainable and reusable code </li><li>organize the program into logical blocks of code </li><li>function declaration tells the compiler about a functionâ€™s name, return type, and parameters </li></ul><h3 id="2-4-1-Optional-Parameters"><a href="#2-4-1-Optional-Parameters" class="headerlink" title="2.4.1 Optional Parameters"></a>2.4.1 Optional Parameters</h3><ul><li>Add a question mark to its name indicating as optional </li><li>should be set as the last argument in a function </li></ul><pre><code>function disp_details(id:number,name:string,mail_id?:string) {    console.log(&quot;ID:&quot;, id);    console.log(&quot;Name&quot;,name);    if(mail_id!=undefined)     console.log(&quot;Email Id&quot;,mail_id); }disp_details(123,&quot;John&quot;);disp_details(111,&quot;mary&quot;,&quot;mary@xyz.com&quot;);</code></pre><h3 id="2-4-2-Rest-Parameters"><a href="#2-4-2-Rest-Parameters" class="headerlink" title="2.4.2 Rest Parameters"></a>2.4.2 Rest Parameters</h3><ul><li>not restrict the number of values that you can pass to a function </li><li>values passed in mush be the same type </li><li>parameter is prefixed with three periods , non rest parameters should come before the rest parameter </li><li>a function can have at most one rest parameter </li></ul><pre><code>function addNumbers(...nums:number[]) {    var i;    var sum:number = 0;    for (i = 0; i &lt; nums.length; i++) {        sum += nums[i];    }    console.log(&quot;sum of numbers&quot;, sum);}</code></pre><h3 id="2-4-3-Default-Parameters"><a href="#2-4-3-Default-Parameters" class="headerlink" title="2.4.3 Default Parameters"></a>2.4.3 Default Parameters</h3><ul><li>you could assign paramters with default values  </li></ul><pre><code>function calculate_discount(price:number,rate:number = 0.50) {    var discount = price * rate;    console.log(&quot;Discount Amount: &quot;,discount); } calculate_discount(1000) calculate_discount(1000,0.30)</code></pre><h3 id="2-4-4-Function-Overloads"><a href="#2-4-4-Function-Overloads" class="headerlink" title="2.4.4 Function Overloads"></a>2.4.4 Function Overloads</h3><ul><li>have different data type </li><li>have different number of parameters </li></ul><pre><code>function disp(string):void; function disp(number):void;function disp(n1:number):void; function disp(x:number,y:number):void;function disp(n1:number,s1:string):void; function disp(s:string,n:number):void;</code></pre><h2 id="2-5-Numbers"><a href="#2-5-Numbers" class="headerlink" title="2.5 Numbers"></a>2.5 Numbers</h2><ul><li>Number class acts as a wrapper and enables manipulation of numeric literals as they are objects </li><li><code>var var_name = new Number(value)</code></li><li>property <ul><li>MAX_VALUE</li><li>MIN_VALUE</li><li>NaN</li><li>NEGATIVE_INFINITY</li><li>POSITIVE_INFINITY</li><li>prototype <ul><li>a static property of the Number object </li><li>use the prototype property to assign new properties and methods to the Number object in the current document </li></ul></li><li>constructor <ul><li>returns the function that created this objectâ€™s instance</li></ul></li></ul></li><li>method <ul><li>toExponential()</li><li>toFixed()<ul><li>formats a number with a specific number of digits to the right of the decimal </li></ul></li><li>toLocaleString()</li><li>toPrecision()</li><li>toString()</li><li>valueOf() </li></ul></li></ul><h2 id="2-6-Strings"><a href="#2-6-Strings" class="headerlink" title="2.6 Strings"></a>2.6 Strings</h2><ul><li>String objects lets you work with a series of characters.</li><li>Wraps the string primitive data type with a number of helper methods </li><li><code>var var_name = new String(string)</code></li><li>property <ul><li>constructor </li><li>length</li><li>prototype <ul><li>allow you to add properties and methods to an object </li></ul></li></ul></li><li>method<ul><li>charAt()</li><li>charCodeAt()</li><li>concat()</li><li>indexOf()</li><li>lastIndexOf()</li><li>localeCompare()</li><li>match()<ul><li>use to match a regular expression against a string </li></ul></li><li>replace()</li><li>search()</li><li>slice()</li><li>split()</li><li>substr()</li><li>substring()</li><li>toLocaleLowerCase()</li><li>toLocaleUpperCase()</li><li>toString()</li><li>toUpperCase()</li><li>valueOf()</li></ul></li></ul><h2 id="2-7-Arrays"><a href="#2-7-Arrays" class="headerlink" title="2.7 Arrays"></a>2.7 Arrays</h2><ul><li>array is a collection of values of the <strong>same</strong> data type </li><li>features <ul><li>allocates sequential memory blocks </li><li>arrays are static, once initialized cannot be resized </li><li>each memory block represents an array element </li><li>array elements are identified by a unique integer called as the subscript/ index of the element </li><li>should be declared before they are used with <code>var</code></li><li>array element values can be updated or modified but cannot be deleted </li></ul></li></ul><pre><code>var arr_name:number[] = [2,4,6];var arr_name:number[] = new Array(4);</code></pre><ul><li><p>methods</p><ul><li>concat() </li><li>every()<ul><li>return true if every element in this array satisfies the provided testing function </li></ul></li><li>filter()</li><li>forEach()</li><li>indexOf()</li><li>join()</li><li>lastIndexOf()</li><li>map()</li><li>pop()</li><li>push()</li><li>reduce()<ul><li>apply a function simultaneously against two values of the array as to reduce it to a single value - from left to right</li></ul></li><li>reduceRight()<ul><li>from right to left</li></ul></li><li>reverse()</li><li>shift()<ul><li>removes the first element from an array and returns the element </li></ul></li><li>slice()</li><li>some()<ul><li>Returns true if at least one element in this array satisfies the provided testing function </li></ul></li><li>sort()</li><li>splice()<ul><li>add or remove elements from an array </li></ul></li><li>toString()</li><li>unshift()<h2 id="2-8-Tuples"><a href="#2-8-Tuples" class="headerlink" title="2.8 Tuples"></a>2.8 Tuples</h2></li></ul></li><li><p>To store a collection of values of varied types </p></li><li><p>represents a heterogeneous collection of values </p></li></ul><pre><code>// accessing var tuple1 = [10, &quot;hello&quot;];</code></pre><h2 id="2-9-Union"><a href="#2-9-Union" class="headerlink" title="2.9 Union"></a>2.9 Union</h2><ul><li>Give program the ability to combine one or two types </li><li>Union can be used to express a value that can be one of the several types </li><li>two or more types are combined with <code>|</code></li></ul><h1 id="3-OOP-related"><a href="#3-OOP-related" class="headerlink" title="3. OOP related"></a>3. OOP related</h1><h2 id="3-1-Interfaces"><a href="#3-1-Interfaces" class="headerlink" title="3.1 Interfaces"></a>3.1 Interfaces</h2><p>An interface defines the syntex that any entity must adhere to.</p><ul><li>Interface define properties, methods and events</li><li>only contain the decalration of the members </li><li>responsibility of the deriving class to define the members </li></ul><pre><code>interface IPerson {    firstName:string,    lastName:string,    sayHi: ()=&gt;string } var customer:IPerson = {    firstName:&quot;Tom&quot;,   lastName:&quot;Hanks&quot;,    sayHi: ():string =&gt;{return &quot;Hi there&quot;} } console.log(&quot;Customer Object &quot;) console.log(customer.firstName) console.log(customer.lastName) console.log(customer.sayHi())  var employee:IPerson = {    firstName:&quot;Jim&quot;,   lastName:&quot;Blakes&quot;,    sayHi: ():string =&gt;{return &quot;Hello!!!&quot;} } console.log(&quot;Employee  Object &quot;) console.log(employee.firstName);console.log(employee.lastName);</code></pre><ul><li>An interface can be extended by other interfaces </li><li>an interface can inherit from other interface </li></ul><pre><code>interface Person {    age:number } interface Musician extends Person {    instrument:string } var drummer = &lt;Musician&gt;{}; drummer.age = 27 drummer.instrument = &quot;Drums&quot; console.log(&quot;Age:  &quot;+drummer.age) console.log(&quot;Instrument:  &quot;+drummer.instrument)</code></pre><h2 id="3-2-Classes"><a href="#3-2-Classes" class="headerlink" title="3.2 Classes"></a>3.2 Classes</h2><ul><li>Object oriented JavaScript </li><li>class can contain<ul><li>fields</li><li>constructors </li><li>functions </li></ul></li><li>class Inheritance <ul><li>create new class from an existing one </li><li>the class that is extended to create newer classes is called the parent class/ super class </li><li>child class inherit all properties and methods except private members and constructors from the parent class </li></ul></li><li>data hiding <ul><li>public </li><li>private <ul><li>only accessible within the class that defines these members  </li></ul></li><li>protected <ul><li>A protected data member is accessible by the members within the same class as that of the former and also by the members of the child classes.</li></ul></li></ul></li></ul><h2 id="3-3-Objects"><a href="#3-3-Objects" class="headerlink" title="3.3 Objects"></a>3.3 Objects</h2><ul><li>Object is an instance which contains set of key value pairs</li><li>the values can be scalar values or functions or even array of other objects </li></ul><h2 id="3-4-namespace"><a href="#3-4-namespace" class="headerlink" title="3.4 namespace"></a>3.4 namespace</h2><ul><li>a way to logically group related code </li><li>resolve the possibility of overwriting or miscontrucing the same variables </li></ul><pre><code>namespace SomeNameSpaceName {    export interface ISomeInterfaceName {      }     export class SomeClassName {      }  } </code></pre><ul><li>marked classes or interfaces with keyword export to indicate they should be accessed outside the namespace </li></ul><h2 id="3-5-Modules"><a href="#3-5-Modules" class="headerlink" title="3.5 Modules"></a>3.5 Modules</h2><p>Module is designed to organize code written in typeScript. Divided into Internal Modules and External Modules. </p><ul><li>Internal Modules<ul><li>logically group classes, interfaces, functions into one unit and can be exported in another module </li><li>now it names namespace in new version of ts</li></ul></li><li>External Module <ul><li>exist to specify and load dependencies between multiple external js files  </li></ul></li></ul><h3 id="3-5-1-Selecting-a-Module-Loader"><a href="#3-5-1-Selecting-a-Module-Loader" class="headerlink" title="3.5.1 Selecting a Module Loader"></a>3.5.1 Selecting a Module Loader</h3><ul><li>for browser <ul><li>RequireJS <ul><li>an implementation of AMD (asynchronous module definition) specification </li><li>AMD can load js files all separately </li></ul></li></ul></li></ul><h3 id="3-5-2-Defining-external-Module"><a href="#3-5-2-Defining-external-Module" class="headerlink" title="3.5.2 Defining external Module"></a>3.5.2 Defining external Module</h3><p>syntax for declaring an external module is using keyword export and import </p><h2 id="3-6-Ambient"><a href="#3-6-Ambient" class="headerlink" title="3.6 Ambient"></a>3.6 Ambient</h2><ul><li>tell the TS compiler that the actual source code exists elsewhere </li><li>kept in extension <code>d.ts</code></li><li>When you are consuming a bunch of third party js libraries like jquery/angularjs/nodejs you canâ€™t rewrite it in TypeScript.</li></ul>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript æ•™ç¨‹ - part 3</title>
      <link href="/JavaScript-%E6%95%99%E7%A8%8B-part-3/"/>
      <url>/JavaScript-%E6%95%99%E7%A8%8B-part-3/</url>
      
        <content type="html"><![CDATA[<h1 id="1-äº‹ä»¶"><a href="#1-äº‹ä»¶" class="headerlink" title="1. äº‹ä»¶"></a>1. äº‹ä»¶</h1><h2 id="1-1-EventTarget-æ¥å£"><a href="#1-1-EventTarget-æ¥å£" class="headerlink" title="1.1 EventTarget æ¥å£"></a>1.1 EventTarget æ¥å£</h2><p>äº‹ä»¶æœ¬è´¨æ˜¯ç¨‹åºå„ä¸ªç»„æˆéƒ¨åˆ†ä¹‹é—´çš„ä¸€ç§é€šä¿¡æ–¹å¼ã€‚DOMçš„äº‹ä»¶è§¦å‘éƒ½å®šä¹‰åœ¨EventTargetæ¥å£å½“ä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹å¯¹è±¡éƒ½éƒ¨ç½²äº†è¿™ä¸ªæ¥å£ </p><p>è¯¥æ¥å£ä¸»è¦æä¾›äº†ä¸‰ä¸ªå®ä¾‹æ–¹æ³•: </p><ul><li>addEventListener  ç»‘å®šäº‹ä»¶çš„ç›‘å¬å‡½æ•°</li><li>removeEventListener ç§»é™¤äº‹ä»¶çš„ç›‘å¬å‡½æ•°</li><li>dispatchEvent  è§¦å‘äº‹ä»¶</li></ul><h3 id="1-1-1-EventTarget-addEventListener"><a href="#1-1-1-EventTarget-addEventListener" class="headerlink" title="1.1.1 EventTarget.addEventListener()"></a>1.1.1 EventTarget.addEventListener()</h3><ul><li>ç”¨äºåœ¨å½“å‰èŠ‚ç‚¹æˆ–å¯¹è±¡ä¸Šï¼Œå®šä¹‰ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´çš„ç›‘å¬å‡½æ•°ï¼Œä¸€æ—¦è¿™ä¸ªäº‹ä»¶å‘ç”Ÿï¼Œå°±ä¼šæ‰§è¡Œç›‘å¬å‡½æ•°</li><li>æ²¡æœ‰è¿”å›å€¼</li><li><code>target.addEventListener(type, listener, [useCapture])</code><ul><li>type äº‹ä»¶åç§°</li><li>listener  ç›‘å¬å‡½æ•°  äº‹ä»¶å‘ç”Ÿï¼Œå°±è°ƒç”¨è¿™ä¸ªç›‘å¬å‡½æ•°</li><li>useCapture  è¡¨ç¤ºç›‘å¬å‡½æ•°æ˜¯å¦åœ¨æ•è·é˜¶æ®µè§¦å‘ï¼Œé»˜è®¤ä¸ºfalse (åªåœ¨å†’æ³¡é˜¶æ®µè¢«è§¦å‘)<ul><li>æ•è·æŒ‡çš„æ˜¯äº‹ä»¶ä»æœ€å¤–å±‚å¼€å§‹å‘ç”Ÿï¼Œç›´åˆ°æœ€å…·ä½“çš„å…ƒç´ </li><li>å†’æ³¡æŒ‡ä»æœ€å†…å±‚å¼€å§‹å‘ç”Ÿ</li></ul></li><li>ç¬¬ä¸‰ä¸ªå‚æ•° â€“ æ˜¯ä¸ªå±æ€§é…ç½®å¯¹è±¡ï¼Œå³é™¤äº†useCapture ä½ è¿˜å¯ä»¥é…ç½®å¾ˆå¤šå…¶ä»–å±æ€§çš„<ul><li>capture  æ˜¯å¦åœ¨æ•è·é˜¶æ®µè§¦å‘ç›‘å¬å‡½æ•°</li><li>once  æ˜¯å¦åªè§¦å‘ä¸€æ¬¡ï¼Œç„¶åå°±è‡ªåŠ¨ç§»é™¤</li><li>passive  è¡¨ç¤ºç›‘å¬å‡½æ•°ä¸ä¼šè°ƒç”¨äº‹ä»¶çš„preventDefaultæ–¹æ³•ï¼Œå¦‚æœç›‘å¬å‡½æ•°è°ƒç”¨äº†ï¼Œæµè§ˆå™¨å°±ä¼šå¿½ç•¥è¿™ä¸ªè¦æ±‚ï¼Œå¹¶åœ¨ç›‘æ§å°ä¸Šè¾“å‡ºä¸€è¡Œè­¦å‘Š</li></ul></li></ul></li></ul><pre><code>function hello() {  console.log(&#39;Hello world&#39;);}var button = document.getElementById(&#39;btn&#39;);button.addEventListener(&#39;click&#39;, hello, false);</code></pre><h3 id="1-1-2-EventTarget-removeEventListener"><a href="#1-1-2-EventTarget-removeEventListener" class="headerlink" title="1.1.2 EventTarget.removeEventListener()"></a>1.1.2 EventTarget.removeEventListener()</h3><p>ç”¨æ¥ç§»é™¤addEventListeneræ–¹æ³•æ·»åŠ çš„äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œè¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚</p><ul><li>removeEnventListeneræ–¹æ³•ç§»é™¤çš„ç›‘å¬å‡½æ•°å¿…é¡»æ˜¯addEventListeneræ–¹æ³•å·²ç»æ·»åŠ è¿‡å¾—ï¼Œè€Œä¸”å¿…é¡»åœ¨åŒä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ä¸Šï¼Œå¦åˆ™æ— æ•ˆ</li></ul><h3 id="1-1-3-EventTarget-dispatchEvent"><a href="#1-1-3-EventTarget-dispatchEvent" class="headerlink" title="1.1.3 EventTarget.dispatchEvent()"></a>1.1.3 EventTarget.dispatchEvent()</h3><ul><li>åœ¨å½“å‰èŠ‚ç‚¹è§¦å‘æŒ‡å®šäº‹ä»¶ï¼Œä»è€Œè§¦å‘ç›‘å¬å‡½æ•°çš„æ‰§è¡Œ  è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼</li><li>åªè¦æœ‰ä¸€ä¸ªç›‘å¬å‡½æ•°è°ƒç”¨äº†<code>Event.preventDefault()</code>,è¿”å›å€¼ä¸ºfalseï¼Œå¦åˆ™ä¸ºtrue</li></ul><pre><code>para.addEventListener(&#39;click&#39;, hello, false);var event = new Event(&#39;click&#39;);para.dispatchEvent(event);</code></pre><h2 id="1-2-äº‹ä»¶æ¨¡å‹"><a href="#1-2-äº‹ä»¶æ¨¡å‹" class="headerlink" title="1.2 äº‹ä»¶æ¨¡å‹"></a>1.2 äº‹ä»¶æ¨¡å‹</h2><p>è¿™ä¸€éƒ¨åˆ†æƒ³è¦è§£å†³çš„é—®é¢˜æ˜¯JSä½œä¸ºä½¿ç”¨äº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ¨¡å¼(event-driven)çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ˜¯æ€ä¹ˆæ ·ç»™äº‹ä»¶ç»‘å®šç›‘å¬å‡½æ•°çš„ã€‚</p><h3 id="1-2-1-ç»‘å®šç›‘å¬å‡½æ•°"><a href="#1-2-1-ç»‘å®šç›‘å¬å‡½æ•°" class="headerlink" title="1.2.1 ç»‘å®šç›‘å¬å‡½æ•°"></a>1.2.1 ç»‘å®šç›‘å¬å‡½æ•°</h3><h4 id="1-2-1-1-ä½¿ç”¨html-onå±æ€§"><a href="#1-2-1-1-ä½¿ç”¨html-onå±æ€§" class="headerlink" title="1.2.1.1 ä½¿ç”¨html onå±æ€§"></a>1.2.1.1 ä½¿ç”¨html onå±æ€§</h4><p>HTMLå…è®¸åœ¨å…ƒç´ å±æ€§å½“ä¸­ï¼Œç›´æ¥å®šä¹‰æŸäº›äº‹ä»¶çš„ç›‘å¬ä»£ç </p><pre><code>&lt;body onload=&quot;doSomething()&quot;&gt;</code></pre><ul><li>å…ƒç´ çš„ç›‘å¬å±æ€§ï¼Œéƒ½æ˜¯onåŠ ä¸Šäº‹ä»¶å</li><li>å±æ€§çš„å€¼ä¸ºå°†è¦æ‰§è¡Œçš„ä»£ç ï¼Œå•å•å‡½æ•°åæ˜¯ä¸è¢«å…è®¸çš„</li><li>è¯¥ç§æ–¹å¼çš„ç›‘å¬ä»£ç ï¼Œåªä¼šåœ¨<strong>å†’æ³¡é˜¶æ®µè¢«è§¦å‘</strong></li></ul><pre><code>// å…ˆè¾“å‡º1 å†è¾“å‡º2&lt;div onClick=&quot;console.log(2)&quot;&gt;  &lt;button onClick=&quot;console.log(1)&quot;&gt;ç‚¹å‡»&lt;/button&gt;&lt;/div&gt;</code></pre><h4 id="1-2-1-2-ä½¿ç”¨å…ƒç´ èŠ‚ç‚¹çš„äº‹ä»¶å±æ€§"><a href="#1-2-1-2-ä½¿ç”¨å…ƒç´ èŠ‚ç‚¹çš„äº‹ä»¶å±æ€§" class="headerlink" title="1.2.1.2 ä½¿ç”¨å…ƒç´ èŠ‚ç‚¹çš„äº‹ä»¶å±æ€§"></a>1.2.1.2 ä½¿ç”¨å…ƒç´ èŠ‚ç‚¹çš„äº‹ä»¶å±æ€§</h4><ul><li>ä¹Ÿæ˜¯åªå¯ä»¥åœ¨å†’æ³¡é˜¶æ®µè¿›è¡Œè§¦å‘</li></ul><pre><code>window.onload = doSomething;div.onclick = function (event) {  console.log(&#39;è§¦å‘äº‹ä»¶&#39;);};</code></pre><h4 id="1-2-1-3-ä½¿ç”¨addEventListener"><a href="#1-2-1-3-ä½¿ç”¨addEventListener" class="headerlink" title="1.2.1.3 ä½¿ç”¨addEventListener()"></a>1.2.1.3 ä½¿ç”¨addEventListener()</h4><p>ç”¨æ¥ä¸ºè¯¥èŠ‚ç‚¹å®šä¹‰äº‹ä»¶çš„ç›‘å¬å‡½æ•°</p><h3 id="1-2-2-äº‹ä»¶çš„ä¼ æ’­"><a href="#1-2-2-äº‹ä»¶çš„ä¼ æ’­" class="headerlink" title="1.2.2 äº‹ä»¶çš„ä¼ æ’­"></a>1.2.2 äº‹ä»¶çš„ä¼ æ’­</h3><p>äº‹ä»¶å‘ç”Ÿåï¼Œä¼šåœ¨å­å…ƒç´ å’Œçˆ¶å…ƒç´ ä¹‹é—´è¿›è¡Œä¼ æ’­ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µ:</p><ol><li>ä»windowå¯¹è±¡ä¼ å¯¼åˆ°ç›®æ ‡èŠ‚ç‚¹(ä¸Šå±‚ä¼ åˆ°åº•å±‚)ï¼Œæˆä¸ºæ•è·é˜¶æ®µ(capture phase)</li><li>åœ¨ç›®æ ‡èŠ‚ç‚¹ä¸Šè§¦å‘ï¼Œç§°ä¸ºç›®æ ‡é˜¶æ®µ</li><li>ä»ç›®æ ‡èŠ‚ç‚¹ä¼ å¯¼ä¼šwindowå¯¹è±¡ï¼Œç§°ä¸ºå†’æ³¡é˜¶æ®µ - bubbling phase</li></ol><p>è¿™ç§ä¸‰é˜¶æ®µçš„ä¼ æ’­æ¨¡å‹ï¼Œä½¿å¾—åŒä¸€ä¸ªäº‹ä»¶ä¼šåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šè§¦å‘ã€‚</p><pre><code>&lt;div&gt;  &lt;p&gt;ç‚¹å‡»&lt;/p&gt;&lt;/div&gt;var phases = {  1: &#39;capture&#39;,  2: &#39;target&#39;,  3: &#39;bubble&#39;};var div = document.querySelector(&#39;div&#39;);var p = document.querySelector(&#39;p&#39;);div.addEventListener(&#39;click&#39;, callback, true);p.addEventListener(&#39;click&#39;, callback, true);div.addEventListener(&#39;click&#39;, callback, false);p.addEventListener(&#39;click&#39;, callback, false);function callback(event) {  var tag = event.currentTarget.tagName;  var phase = phases[event.eventPhase];  console.log(&quot;Tag: &#39;&quot; + tag + &quot;&#39;. EventPhase: &#39;&quot; + phase + &quot;&#39;&quot;);}// ç‚¹å‡»ä»¥åçš„ç»“æœ// Tag: &#39;DIV&#39;. EventPhase: &#39;capture&#39;// Tag: &#39;P&#39;. EventPhase: &#39;target&#39;// Tag: &#39;P&#39;. EventPhase: &#39;target&#39;// Tag: &#39;DIV&#39;. EventPhase: &#39;bubble&#39;</code></pre><h3 id="1-2-3-äº‹ä»¶çš„ä»£ç†"><a href="#1-2-3-äº‹ä»¶çš„ä»£ç†" class="headerlink" title="1.2.3 äº‹ä»¶çš„ä»£ç†"></a>1.2.3 äº‹ä»¶çš„ä»£ç†</h3><p>å› ä¸ºäº‹ä»¶ä¼šåœ¨å†’æ³¡é˜¶æ®µå‘ä¸Šä¼ æ’­åˆ°çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥å°†å­èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°å®šä¹‰åœ¨çˆ¶èŠ‚ç‚¹ä¸Šï¼Œç”±çˆ¶èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°ç»Ÿä¸€å¤„ç†å¤šä¸ªå­å…ƒç´ çš„äº‹ä»¶ï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºäº‹ä»¶çš„ä»£ç†</p><pre><code>var ul = document.querySelector(&#39;ul&#39;);ul.addEventListener(&#39;click&#39;, function (event) {  if (event.target.tagName.toLowerCase() === &#39;li&#39;) {    // some code  }});</code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œclickäº‹ä»¶çš„ç›‘å¬å‡½æ•°å®šä¹‰åœ¨<code>&lt;ul&gt;</code>èŠ‚ç‚¹ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒå¤„ç†çš„æ˜¯å­èŠ‚ç‚¹<code>&lt;li&gt;</code>çš„clickäº‹ä»¶ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåªè¦å®šä¹‰ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œå°±èƒ½å¤„ç†å¤šä¸ªå­èŠ‚ç‚¹çš„äº‹ä»¶ï¼Œè€Œä¸ç”¨åœ¨æ¯ä¸ª<code>&lt;li&gt;</code>èŠ‚ç‚¹ä¸Šå®šä¹‰ç›‘å¬å‡½æ•°ã€‚è€Œä¸”ä»¥åå†æ·»åŠ å­èŠ‚ç‚¹ï¼Œç›‘å¬å‡½æ•°ä¾ç„¶æœ‰æ•ˆã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>stopPorpagation</code>æ–¹æ³•æ¥ä½¿äº‹ä»¶ä¼ æ’­åˆ°æŸä¸ªèŠ‚ç‚¹å°±åœä¸‹æ¥ï¼Œä¸å†ä¼ æ’­</p><pre><code>// stopPropagationä¸ä¼šåœæ­¢åœ¨åŒä¸€ä¸ªelementä¸Šçš„å…¶ä»–äº‹ä»¶çš„æ‰§è¡Œp.addEventListener(&#39;click&#39;, function (event) {  event.stopPropagation();  console.log(1);});p.addEventListener(&#39;click&#39;, function(event) {  // ä¼šè§¦å‘  console.log(2);});</code></pre><ul><li>å¦‚æœæˆ‘ä»¬æƒ³ä¸è§¦å‘åŒä¸€ä¸ªelementä¸Šçš„å…¶ä»–ç›‘å¬å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>stopImmediatePropogation()</code>æ–¹æ³•</li></ul><h2 id="1-3-äº‹ä»¶å¯¹è±¡"><a href="#1-3-äº‹ä»¶å¯¹è±¡" class="headerlink" title="1.3 äº‹ä»¶å¯¹è±¡"></a>1.3 äº‹ä»¶å¯¹è±¡</h2><p>äº‹ä»¶å‘ç”Ÿä»¥åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ä¼ ç»™ç›‘å¬å‡½æ•°ã€‚æµè§ˆå™¨åŸç”Ÿæä¾›ä¸€ä¸ªEventå¯¹è±¡ï¼Œæ‰€æœ‰äº‹ä»¶éƒ½æ˜¯è¿™ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå³ç»§æ‰¿äº†Event.prototype</p><ul><li>Eventæ„é€ å‡½æ•°: <code>event = new Event(type, option);</code><ul><li>type ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶çš„åç§°</li><li>options ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºäº‹ä»¶å¯¹è±¡çš„é…ç½®<ul><li>bubbles  boolean  <ul><li>default to false</li><li>è¡¨ç¤ºå¯¹è±¡æ˜¯å¦å†’æ³¡</li></ul></li><li>cancelable boolean <ul><li>default to false</li><li>è¡¨ç¤ºäº‹æƒ…èƒ½å¦è¢«å–æ¶ˆï¼Œå³èƒ½å¦ç”¨event.preventDefault()å–æ¶ˆè¿™ä¸ªæ—¶é—´</li></ul></li></ul></li></ul></li></ul><h3 id="1-3-1-å®ä¾‹å±æ€§"><a href="#1-3-1-å®ä¾‹å±æ€§" class="headerlink" title="1.3.1 å®ä¾‹å±æ€§"></a>1.3.1 å®ä¾‹å±æ€§</h3><ul><li>Event.bubbles <ul><li>boolean</li><li>è¡¨ç¤ºå½“å‰äº‹ä»¶æ˜¯å¦ä¼šå†’æ³¡</li><li>åªè¯»å±æ€§ï¼Œç”¨äºäº†è§£Eventå®ä¾‹æ˜¯å¦å¯ä»¥å†’æ³¡</li></ul></li><li>Event.eventPhase <ul><li>è¿”å›å½“å‰äº‹ä»¶æ‰€å¤„çš„é˜¶æ®µï¼Œè¯¥å±æ€§åªè¯»<ul><li>0 è¿˜æ²¡æœ‰å‘ç”Ÿ</li><li>1 æ•è·é˜¶æ®µ  å¤„äºä»ç¥–å…ˆèŠ‚ç‚¹å‘ç›®æ ‡èŠ‚ç‚¹çš„ä¼ æ’­è¿‡ç¨‹å½“ä¸­</li><li>2 äº‹ä»¶åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹</li><li>3 äº‹ä»¶å¤„äºå†’æ³¡é˜¶æ®µ</li></ul></li></ul></li><li>Event.currentTarget<ul><li>æ­£åœ¨é€šè¿‡çš„èŠ‚ç‚¹</li></ul></li><li>Event.target <ul><li>äº‹ä»¶çš„åŸå§‹è§¦å‘èŠ‚ç‚¹</li></ul></li><li>Event.timeStamp</li><li>Event.isTrusted<ul><li>è¡¨ç¤ºè¯¥äº‹ä»¶æ˜¯å¦ç”±ä¸€ä¸ªçœŸå®çš„ç”¨æˆ·è¡Œä¸ºäº§ç”Ÿ</li></ul></li><li>Event.detail<ul><li>åªæœ‰æµè§ˆå™¨çš„UIäº‹ä»¶æ‰å…·æœ‰</li><li>è¿”å›ä¸€ä¸ªæ•°å€¼è¡¨ç¤ºäº‹ä»¶çš„æŸç§ä¿¡æ¯</li><li>å…·ä½“å«ä¹‰ä¸äº‹ä»¶ç±»å‹ç›¸å…³<ul><li>ç‚¹å‡» æ¬¡æ•°</li><li>é¼ æ ‡æ»šè½® è·ç¦»</li></ul></li></ul></li></ul><h3 id="1-3-2-å®ä¾‹æ–¹æ³•"><a href="#1-3-2-å®ä¾‹æ–¹æ³•" class="headerlink" title="1.3.2 å®ä¾‹æ–¹æ³•"></a>1.3.2 å®ä¾‹æ–¹æ³•</h3><ul><li>event.preventDefault()<ul><li>å–æ¶ˆæµè§ˆå™¨å¯¹å½“å‰äº‹ä»¶çš„é»˜è®¤è¡Œä¸º</li><li>ç”Ÿæ•ˆçš„å‰ææ˜¯äº‹ä»¶å¯¹è±¡çš„cancelableå±æ€§ä¸ºtrue</li></ul></li></ul><pre><code>// HTML ä»£ç ä¸º// &lt;input type=&quot;text&quot; id=&quot;my-input&quot; /&gt;// å®ç°åªæ¥å—å°å†™çš„åŠŸèƒ½var input = document.getElementById(&#39;my-input&#39;);input.addEventListener(&#39;keypress&#39;, checkName, false);function checkName(e) {  if (e.charCode &lt; 97 || e.charCode &gt; 122) {    e.preventDefault();  }}</code></pre><ul><li>event.stopPropagation()<ul><li>é˜»æ­¢äº‹ä»¶åœ¨DOMä¸­ç»§ç»­ä¼ æ’­ï¼Œé˜²æ­¢å†è§¦å‘å®šä¹‰åœ¨åˆ«çš„èŠ‚ç‚¹ä¸Šçš„ç›‘å¬å‡½æ•°ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬åœ¨å½“å‰èŠ‚ç‚¹ä¸Šå…¶ä»–çš„äº‹ä»¶ç›‘å¬å‡½æ•°</li></ul></li><li>event.stopImmediatePropogation()<ul><li>é˜»æ­¢åŒä¸€ä¸ªäº‹ä»¶çš„å…¶ä»–ç›‘å¬å‡½æ•°è¢«è°ƒç”¨</li><li>æ›´å½»åº•çš„é˜»æ­¢äº‹ä»¶çš„ä¼ æ’­</li></ul></li><li>event.composedPath() <ul><li>è¿”å›ä¸€ä¸ªæ•°ç»„</li><li>æˆå‘˜æ˜¯äº‹ä»¶çš„æœ€åº•å±‚èŠ‚ç‚¹å’Œä¾æ¬¡å†’æ³¡ç»è¿‡çš„æ‰€æœ‰ä¸Šå±‚èŠ‚ç‚¹</li></ul></li></ul><pre><code>// HTML ä»£ç å¦‚ä¸‹// &lt;div&gt;//   &lt;p&gt;Hello&lt;/p&gt;// &lt;/div&gt;var div = document.querySelector(&#39;div&#39;);var p = document.querySelector(&#39;p&#39;);div.addEventListener(&#39;click&#39;, function (e) {  console.log(e.composedPath());}, false);// [p, div, body, html, document, Window]</code></pre><h2 id="1-4-å„ç±»äº‹ä»¶çš„æè¿°"><a href="#1-4-å„ç±»äº‹ä»¶çš„æè¿°" class="headerlink" title="1.4 å„ç±»äº‹ä»¶çš„æè¿°"></a>1.4 å„ç±»äº‹ä»¶çš„æè¿°</h2><h3 id="1-4-1-é¼ æ ‡äº‹ä»¶"><a href="#1-4-1-é¼ æ ‡äº‹ä»¶" class="headerlink" title="1.4.1 é¼ æ ‡äº‹ä»¶"></a>1.4.1 <a href="https://wangdoc.com/javascript/events/mouse.html" target="_blank" rel="noopener">é¼ æ ‡äº‹ä»¶</a></h3><ul><li>ç»§æ‰¿MouseEventæ¥å£<ul><li>click<ul><li>mouseDown + mouseUp </li></ul></li><li>dblclick åœ¨ç”¨ä¸€ä¸ªå…ƒç´ ä¸ŠåŒå‡»é¼ æ ‡æ—¶è§¦å‘<ul><li>mouseDown + mouseUp + click  </li></ul></li><li>mousedown æŒ‰ä¸‹é¼ æ ‡é”®æ—¶è§¦å‘</li><li>mouseup é‡Šæ”¾æŒ‰ä¸‹çš„é¼ æ ‡é”®çš„æ—¶å€™è§¦å‘</li><li>mousemove <ul><li>å½“é¼ æ ‡åœ¨ä¸€ä¸ªç»“ç‚¹å†…éƒ¨ç§»åŠ¨çš„æ—¶å€™è§¦å‘</li><li>å½“é¼ æ ‡æŒç»­ç§»åŠ¨æ—¶ï¼Œå°±ä¼šæŒç»­è§¦å‘</li><li>åº”å½“å¯¹è¯¥äº‹ä»¶çš„ç›‘å¬å‡½æ•°åšä¸€äº›é™å®šï¼Œæ¯”å¦‚ä¸€å®šæ—¶é—´å†…åªèƒ½è¿è¡Œä¸€æ¬¡</li></ul></li><li>mouseenter <ul><li>è¿›å…¥ä¸€ä¸ªèŠ‚ç‚¹æ—¶è§¦å‘</li></ul></li><li>mouseover<ul><li>é¼ æ ‡è¿›å…¥ä¸€ä¸ªèŠ‚ç‚¹æ—¶è§¦å‘ï¼Œè¿›å…¥å­èŠ‚ç‚¹ä¼šå†ä¸€æ¬¡è§¦å‘è¿™ä¸ªäº‹ä»¶</li></ul></li><li>mouseout<ul><li>é¼ æ ‡ç¦»å¼€ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™è§¦å‘ï¼Œç¦»å¼€çˆ¶èŠ‚ç‚¹ä¹Ÿä¼šè§¦å‘</li></ul></li><li>mouseleave<ul><li>é¼ æ ‡ç¦»å¼€ä¸€ä¸ªèŠ‚ç‚¹æ—¶è§¦å‘ï¼Œç¦»å¼€çˆ¶èŠ‚ç‚¹ä¸ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ </li></ul></li><li>contextmenu<ul><li>æŒ‰ä¸‹é¼ æ ‡å³é”®æ—¶è§¦å‘çš„</li></ul></li><li>wheel<ul><li>æ»šåŠ¨é¼ æ ‡çš„æ»šè½®æ—¶è§¦å‘çš„ï¼Œè¯¥äº‹ä»¶ç»§æ‰¿çš„æ˜¯WheelEventæ¥å£ </li></ul></li></ul></li><li>mouseEvent<ul><li>æµè§ˆå™¨æä¾›ä¸€ä¸ªMouseEventæ„é€ å‡½æ•°ï¼Œç”¨äºæ–°å»ºä¸€ä¸ªMouseEventå®ä¾‹</li><li><code>var event = new MouseEvent(type, options);</code></li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶åç§°</li><li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªäº‹ä»¶é…ç½®å¯¹è±¡ï¼Œå¯ä»¥é…ä¸€äº›ä¸åŒçš„å±æ€§<ul><li>screenX</li><li>screenY</li><li>clientX<ul><li>ç›¸å¯¹äºç¨‹åºçª—å£çš„æ°´å¹³ä½ç½®</li></ul></li><li>clientY<ul><li>ç›¸å¯¹äºç¨‹åºçª—å£çš„å‚ç›´ä½ç½®</li></ul></li><li>ctrlKey</li><li>shiftKey</li><li>altKey</li><li>metaKey </li><li>button <ul><li>0 æŒ‰ä¸‹ä¸»é”®</li><li>1 æŒ‰ä¸‹è¾…åŠ©é”®</li><li>2 æŒ‰ä¸‹æ¬¡è¦é”®</li></ul></li><li>buttons</li></ul></li></ul></li></ul><h3 id="1-4-2-é”®ç›˜äº‹ä»¶"><a href="#1-4-2-é”®ç›˜äº‹ä»¶" class="headerlink" title="1.4.2 é”®ç›˜äº‹ä»¶"></a>1.4.2 é”®ç›˜äº‹ä»¶</h3><ul><li><p>é”®ç›˜äº‹ä»¶çš„ç§ç±»</p><ul><li><p>keydown</p><ul><li>æŒ‰ä¸‹é”®ç›˜çš„æ—¶å€™è§¦å‘</li></ul></li><li><p>keypress</p><ul><li>æŒ‰ä¸‹æœ‰å€¼çš„é”®å†è§¦å‘ï¼Œå³æŒ‰ä¸‹Ctrl, Alt, Shift, Metaè¿™æ ·çš„æ— å€¼çš„é”®ä¸ä¼šè§¦å‘ </li><li>å¯¹äºæœ‰å€¼çš„é”®ï¼Œè¿˜æ˜¯ä¼šå…ˆè§¦å‘keydownäº‹ä»¶ï¼Œå†è§¦å‘è¿™ä¸ªäº‹ä»¶</li></ul></li><li><p>keyup</p><ul><li>æ¾å¼€é”®ç›˜çš„æ—¶å€™è§¦å‘è¯¥äº‹ä»¶</li><li>å¦‚æœä¸€ç›´ä¸æ¾å¼€æŒ‰é”®ï¼Œé‚£ä¹ˆå°±ä¼šè¿ç»­è§¦å‘é”®ç›˜äº‹ä»¶<ul><li>è§¦å‘é¡ºåºï¼š<ul><li>keydown</li><li>keypress</li><li>keydown</li><li>keypress</li><li>â€¦.</li><li>æ”¾å¼€ -&gt; keyup</li></ul></li></ul></li></ul></li></ul></li><li><p>KeyboardEvent æ¥å£æ¦‚è¿°</p><ul><li>æè¿°ç”¨æˆ·ä¸é”®ç›˜çš„äº’åŠ¨</li><li>ç»§æ‰¿äº†Eventæ¥å£ï¼Œå¹¶ä¸”å®šä¹‰äº†è‡ªå·±çš„å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</li><li>æµè§ˆå™¨åŸç”Ÿæä¾›KeyboardEventæ„é€ å‡½æ•°ï¼Œç”¨æ¥æ–°å»ºé”®ç›˜äº‹ä»¶çš„å®ä¾‹</li><li><code>new KeyboardEvent(type, options)</code></li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶ç±»å‹</li><li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªäº‹ä»¶é…ç½®å¯¹è±¡ï¼Œå‚æ•°å¯é€‰<ul><li>key</li><li>code<ul><li>0-9   digital0-digital9</li><li>A-Z   KeyA - KeyZ</li><li>F1 - F12</li><li>æ–¹å‘é”®<ul><li>ArrowDown</li><li>ArrowUp</li><li>ArrowLeft</li><li>ArrowRight</li></ul></li><li>Alt<ul><li>AltLeft/ AltRight</li><li>similar to shift, ctrl</li></ul></li></ul></li><li>location<ul><li>è¿”å›é”®ç›˜çš„åŒºåŸŸ </li></ul></li><li>ctrlKey</li><li>shiftKey</li><li>altKey</li><li>metaKey</li><li>repeat <ul><li>çœ‹è¯¥æ¡ˆä»¶æ˜¯å¦è¢«æŒ‰ç€ä¸æ”¾ï¼Œä»¥ä¾¿åˆ¤æ–­æ˜¯å¦é‡å¤è¿™ä¸ªé”®</li></ul></li></ul></li></ul></li><li><p>KeyboardEventå®ä¾‹æ–¹æ³•</p><ul><li>getModifierState() <ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æŒ‰ä¸‹æˆ–æ¿€æ´»æŒ‡å®šçš„åŠŸèƒ½é”®<ul><li>alt</li><li>capslock</li><li>control</li><li>meta</li><li>numlock</li><li>shift</li></ul></li></ul></li></ul></li></ul><h3 id="1-4-3-è¿›åº¦äº‹ä»¶"><a href="#1-4-3-è¿›åº¦äº‹ä»¶" class="headerlink" title="1.4.3 è¿›åº¦äº‹ä»¶"></a>1.4.3 è¿›åº¦äº‹ä»¶</h3><p>ç”¨æ¥æè¿°èµ„æºåŠ è½½çš„è¿›åº¦ï¼Œä¸»è¦ç”±:</p><ul><li>AJAXè¯·æ±‚</li><li><code>&lt;img&gt;</code></li><li><code>&lt;audio&gt;</code></li><li><code>&lt;video&gt;</code></li><li><code>&lt;style&gt;</code></li><li><code>&lt;link&gt;</code></li></ul><p>è¯¥ç±»å¤–éƒ¨èµ„æºçš„åŠ è½½è§¦å‘ï¼Œç»§æ‰¿äº†ProgressEventæ¥å£ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§äº‹ä»¶ï¼š</p><ul><li>abort  å¤–éƒ¨èµ„æºä¸­æ­¢åŠ è½½æ—¶è¢«è§¦å‘</li><li>error  ç”±äºé”™è¯¯å¯¼è‡´å¤–éƒ¨èµ„æºæ— æ³•åŠ è½½æ—¶è§¦å‘</li><li>load   å¤–éƒ¨èµ„æºåŠ è½½æˆåŠŸæ—¶è§¦å‘</li><li>loadstart  å¤–éƒ¨èµ„æºå¼€å§‹åŠ è½½æ—¶è§¦å‘</li><li>loadend  å¤–éƒ¨èµ„æºåœæ­¢åŠ è½½æ—¶è§¦å‘</li><li>progress  å¤–éƒ¨èµ„æºåŠ è½½è¿‡ç¨‹ä¸­ä¸æ–­è§¦å‘</li><li>timeout  åŠ è½½è¶…æ—¶æ—¶è§¦å‘</li></ul><ul><li><p>ProgressEventæ¥å£</p><ul><li>ç”¨æ¥æè¿°å¤–éƒ¨èµ„æºåŠ è½½çš„è¿›åº¦</li><li><code>new ProgressEvent(type, options)</code><ul><li>types äº‹ä»¶ç±»å‹</li><li>options - é…ç½®å¯¹è±¡<ul><li>lengthComputable å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåŠ è½½çš„æ€»é‡æ˜¯å¦å¯ä»¥è®¡ç®—ï¼Œé»˜è®¤ä¸ºfalse</li><li>loaded è¡¨ç¤ºå·²ç»åŠ è½½çš„é‡</li><li>total è¡¨ç¤ºéœ€è¦åŠ è½½çš„é‡<h3 id="1-4-4-è¡¨å•äº‹ä»¶"><a href="#1-4-4-è¡¨å•äº‹ä»¶" class="headerlink" title="1.4.4 è¡¨å•äº‹ä»¶"></a>1.4.4 è¡¨å•äº‹ä»¶</h3></li></ul></li></ul></li></ul></li><li><p>è¡¨å•äº‹ä»¶çš„ç§ç±»</p><ul><li>input<ul><li>å½“<code>&lt;input&gt;, &lt;select&gt;, &lt;textarea&gt;</code>çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘</li><li>inputäº‹ä»¶ä¼šè¿ç»­è§¦å‘ï¼Œæ¯æŒ‰ä¸‹ä¸€ä¸ªé”®ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡inputäº‹ä»¶çš„</li></ul></li><li>select<ul><li>æ˜¯åœ¨<code>&lt;input&gt; &lt;select&gt; &lt;textarea&gt;</code>é‡Œé¢çš„å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è§¦å‘ </li></ul></li><li>change<ul><li>åœ¨å…ƒç´ å¤±å»ç„¦ç‚¹æ—¶å‘ç”Ÿ</li><li>å³å½“æœ‰è¿ç»­å˜åŒ–çš„æ—¶å€™ï¼Œinputäº‹ä»¶ä¼šè¢«è§¦å‘å¾ˆå¤šæ¬¡ï¼Œè€Œchangeäº‹ä»¶åªåœ¨å¤±å»ç„¦ç‚¹çš„æ—¶å€™è¢«è§¦å‘ä¸€æ¬¡ã€‚</li><li>æ¢ä¸ªè§’åº¦çœ‹ï¼Œinputäº‹ä»¶æ˜¯ä¸€å®šä¼´éšç€changeäº‹ä»¶çš„ï¼Œå…·ä½“åˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µ<ul><li>æ¿€æ´»å•é€‰æ¡†æˆ–å¤é€‰æ¡†æ—¶è§¦å‘</li><li>ç”¨æˆ·æäº¤æ—¶è§¦å‘</li><li>å½“æ–‡æœ¬æ¡†æˆ–textareaå…ƒç´ çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸”å¤±å»ç„¦ç‚¹çš„æ—¶å€™è§¦å‘</li></ul></li></ul></li><li>invalid<ul><li>ç”¨æˆ·æäº¤è¡¨å•ï¼Œå½“è¡¨å•å…ƒç´ çš„å€¼ä¸æ»¡è¶³æ ¡éªŒæ¡ä»¶ï¼Œå°±ä¼šè§¦å‘invalidäº‹ä»¶ </li></ul></li><li>reset<ul><li>å‘ç”Ÿåœ¨è¡¨å•å¯¹è±¡ä¸Š</li><li>è¡¨ç¤ºè¡¨å•é‡ç½®æ—¶é”è§¦å‘çš„äº‹ä»¶</li></ul></li><li>submit<ul><li>å½“è¡¨å•æ•°æ®å‘æœåŠ¡å™¨æäº¤æ—¶è§¦å‘</li></ul></li></ul></li><li><p>inputEventæ¥å£</p><ul><li><code>new InputEvent(type, options)</code></li><li>type å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶åç§°</li><li>options é…ç½®å¯¹è±¡<ul><li>inputType</li><li>data  è¡¨ç¤ºæ’å…¥çš„å­—ç¬¦ä¸²</li><li>dataTransfer </li></ul></li></ul></li></ul><h3 id="1-4-5-è§¦æ‘¸äº‹ä»¶"><a href="#1-4-5-è§¦æ‘¸äº‹ä»¶" class="headerlink" title="1.4.5 è§¦æ‘¸äº‹ä»¶"></a>1.4.5 è§¦æ‘¸äº‹ä»¶</h3><ul><li><p>è§¦æ‘¸æ“ä½œ</p><ul><li>touch  ä¸€ä¸ªè§¦æ‘¸ç‚¹<ul><li>ä½ç½®</li><li>å¤§å°</li><li>å½¢çŠ¶</li><li>å‹åŠ›</li><li>ç›®æ ‡å…ƒç´ </li></ul></li><li>touchList  å¤šä¸ªè§¦æ‘¸ç‚¹çš„é›†åˆ<ul><li>æˆå‘˜ä¸ºTouchçš„å®ä¾‹å¯¹è±¡</li><li>å±æ€§<ul><li>length  è¡¨ç¤ºè§¦æ‘¸ç‚¹çš„æ•°é‡</li><li>item() è¿”å›æŒ‡å®šçš„æˆå‘˜</li></ul></li></ul></li><li>touchEvent  è§¦æ‘¸å¼•å‘çš„äº‹ä»¶å®ä¾‹</li></ul></li><li><p>Touch æ¥å£æ¦‚è¿°</p><ul><li><code>var touch = new Touch(touchOptions)</code> </li><li>touchOptions<ul><li>identifier <ul><li>è§¦æ‘¸ç‚¹çš„å”¯ä¸€ID</li></ul></li><li>target</li><li>clientX</li><li>clientY</li><li>screenX</li><li>screenY</li><li>pageX</li><li>pageY</li><li>radiusX </li><li>radiusY</li><li>rotationAngle</li><li>force <ul><li>0 -1 èŒƒå›´</li><li>è¡¨ç¤ºè§¦æ‘¸å‹åŠ›</li></ul></li></ul></li></ul></li><li><p>è§¦æ‘¸äº‹ä»¶çš„ç§ç±»</p><ul><li>touchstart</li><li>touchend</li><li>touchmove</li><li>touchcancel <h3 id="1-4-6-æ‹–æ‹‰äº‹ä»¶"><a href="#1-4-6-æ‹–æ‹‰äº‹ä»¶" class="headerlink" title="1.4.6 æ‹–æ‹‰äº‹ä»¶"></a>1.4.6 æ‹–æ‹‰äº‹ä»¶</h3></li></ul></li><li><p>æ‹–æ‹‰å®šä¹‰</p><ul><li>ç”¨æˆ·åœ¨æŸä¸ªå¯¹è±¡ä¸ŠæŒ‰ä¸‹é¼ æ ‡é”®ä¸æ”¾ï¼Œæ‹–åŠ¨å®ƒåˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œç„¶åé‡Šæ”¾é¼ æ ‡é”®ï¼Œå°†è¯¥å¯¹è±¡æ”¾åœ¨é‚£é‡Œ</li></ul></li><li><p>æ‹–æ‹‰çš„å¯¹è±¡</p><ul><li>å…ƒç´ èŠ‚ç‚¹</li><li>å›¾ç‰‡</li><li>é“¾æ¥</li><li>é€‰ä¸­çš„æ–‡å­—</li></ul></li></ul><h3 id="1-4-7-å…¶ä»–å¸¸è§äº‹ä»¶"><a href="#1-4-7-å…¶ä»–å¸¸è§äº‹ä»¶" class="headerlink" title="1.4.7 å…¶ä»–å¸¸è§äº‹ä»¶"></a>1.4.7 å…¶ä»–å¸¸è§äº‹ä»¶</h3><ul><li>èµ„æºäº‹ä»¶<ul><li>beforeunload <ul><li>åœ¨çª—å£ï¼Œæ–‡æ¡£ï¼Œå„ç§èµ„æºå°†è¦å¸è½½å‰è§¦å‘</li><li>ç”¨äºé˜²æ­¢ç”¨æˆ·ä¸å°å¿ƒå¸è½½èµ„æº</li></ul></li><li>unload<ul><li>åœ¨çª—å£å…³é—­æˆ–è€…documentå¯¹è±¡å°†è¦å¸è½½æ—¶è§¦å‘</li><li>è§¦å‘é¡ºåºæ’åœ¨beforeunload, pagehideäº‹ä»¶åé¢</li></ul></li><li>load<ul><li>åœ¨é¡µé¢æˆ–è€…æŸä¸ªèµ„æºåŠ è½½æˆåŠŸæ—¶è§¦å‘</li><li>é¡µé¢æˆ–è€…èµ„æºä»æµè§ˆå™¨ç¼“å­˜åŠ è½½ï¼Œå¹¶ä¸ä¼šè§¦å‘loadäº‹ä»¶</li></ul></li></ul></li><li>sessionå†å²äº‹ä»¶<ul><li>pageshow<ul><li>é¡µé¢åŠ è½½æ—¶è§¦å‘ï¼Œå¦‚æœè¦æŒ‡å®šé¡µé¢æ¯æ¬¡åŠ è½½æ—¶éƒ½è¿è¡Œçš„æ‰“å­—å—ï¼Œå¯ä»¥æ”¾åœ¨è¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°å½“ä¸­ </li></ul></li><li>pagehide</li><li>popstate<ul><li>åœ¨æµè§ˆå™¨çš„historyå¯¹è±¡çš„å½“å‰è®°å½•å‘ç”Ÿæ˜¾å¼åˆ‡æ¢æ—¶è§¦å‘</li></ul></li><li>hashchange<ul><li>URLçš„hashéƒ¨åˆ†å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è§¦å‘ </li></ul></li></ul></li><li>ç½‘é¡µçŠ¶æ€äº‹ä»¶ <ul><li>DOMContentLoaded äº‹ä»¶<ul><li>ç½‘é¡µä¸‹è½½å¹¶è§£æå®Œæˆä»¥ååœ¨documentå¯¹è±¡ä¸Šè§¦å‘è¯¥äº‹ä»¶  </li></ul></li></ul></li><li>çª—å£äº‹ä»¶<ul><li>scroll <ul><li>ç”¨æˆ·æ‹–åŠ¨æ»šåŠ¨æ¡</li></ul></li><li>resize</li><li>fullscreenchange</li><li>fullscreenerror </li></ul></li><li>ç„¦ç‚¹äº‹ä»¶<ul><li>focus è·å¾—ç„¦ç‚¹ä»¥åè§¦å‘</li><li>blur  å¤±å»ç„¦ç‚¹ä»¥åè§¦å‘</li><li>focusin  å°†è¦è·å¾—ç„¦ç‚¹æ—¶è§¦å‘</li><li>focusout å°†è¦å¤±å»ç„¦ç‚¹æ—¶è§¦å‘</li></ul></li></ul><h1 id="2-æµè§ˆå™¨æ¨¡å‹"><a href="#2-æµè§ˆå™¨æ¨¡å‹" class="headerlink" title="2. æµè§ˆå™¨æ¨¡å‹"></a>2. æµè§ˆå™¨æ¨¡å‹</h1><p>ä¸»è¦æ¥ä»‹ç»æµè§ˆå™¨æä¾›çš„å„ç§JSæ¥å£</p><h2 id="2-1-æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°"><a href="#2-1-æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°" class="headerlink" title="2.1 æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°"></a>2.1 æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°</h2><ul><li>ä»£ç åµŒå…¥ç½‘é¡µæ–¹æ³•<ul><li><script> ç›´æ¥åµŒå…¥ä»£ç   + typeå±æ€§  ç”¨æ¥æŒ‡å®šè„šæœ¬ç±»å‹      + text/javascript      + application/javascript</li><li><script> æ ‡ç­¾åŠ è½½å¤–éƒ¨è„šæœ¬  + ä¸ºäº†é˜²æ­¢æ”»å‡»è€…ç¯¡æ”¹å¤–éƒ¨è„šæœ¬ï¼Œscriptæ ‡ç­¾å…è®¸è®¾ç½®ä¸€ä¸ª`integrity`å±æ€§ï¼Œå†™å…¥å¤–éƒ¨è„šæœ¬çš„Hashç­¾åï¼Œç”¨æ¥éªŒè¯è„šæœ¬çš„ä¸€è‡´æ€§ </li><li>äº‹ä»¶å±æ€§<ul><li>ç½‘é¡µå…ƒç´ çš„äº‹ä»¶  æ¯”å¦‚onclick  onmouseover å¯ä»¥å†™å…¥JSä»£ç  </li></ul></li><li>URLåè®®<ul><li>åœ¨URLçš„ä½ç½®å†™å…¥ä»£ç ï¼Œä½¿ç”¨è¿™ä¸ªURLçš„æ—¶å€™å°±ä¼šæ‰§è¡ŒJSä»£ç äº† </li></ul></li></ul></li></ul><pre><code>&lt;script src=&quot;/assets/application.js&quot;  integrity=&quot;sha256-TvVUHzSfftWg1rcfL6TIJ0XKEGrgLyEq6lEpcmrG9qs=&quot;&gt;&lt;/script&gt;&lt;a href=&quot;javascript:console.log(&#39;Hello&#39;)&quot;&gt;ç‚¹å‡»&lt;/a&gt;</code></pre><h3 id="2-1-1-scriptå·¥ä½œåŸç†"><a href="#2-1-1-scriptå·¥ä½œåŸç†" class="headerlink" title="2.1.1 scriptå·¥ä½œåŸç†"></a>2.1.1 scriptå·¥ä½œåŸç†</h3><ul><li>ç½‘é¡µåŠ è½½æµç¨‹<ul><li>æµè§ˆå™¨ä¸€è¾¹ä¸‹è½½HTMLç½‘é¡µï¼Œä¸€è¾¹å¼€å§‹è§£æ </li><li>å½“å‘ç°<code>&lt;script&gt;</code>å…ƒç´ çš„æ—¶å€™ï¼Œå°±æš‚åœè§£æï¼Œå°†ç½‘é¡µæ¸²æŸ“çš„æ§åˆ¶æƒäº¤ç»™JavaScriptå¼•æ“</li><li>å¦‚æœ<code>&lt;script&gt;</code>å…ƒç´ å¼•ç”¨äº†å¤–éƒ¨è„šæœ¬ï¼Œå°±ä¸‹è½½è¯¥è„šæœ¬å†æ‰§è¡Œï¼Œå¦åˆ™å°±ç›´æ¥æ‰§è¡Œä»£ç </li><li>JSå¼•æ“æ‰§è¡Œå®Œæ¯•ï¼Œæ§åˆ¶æƒäº¤è¿˜ç»™æ¸²æŸ“å¼•æ“ï¼Œæ¢å¤å¾€ä¸‹è§£æHTMLç½‘é¡µ</li></ul></li><li>ä¸ºä»€ä¹ˆåŠ è½½è„šæœ¬çš„æ—¶å€™ä¼šåœæ­¢é¡µé¢æ¸²æŸ“ï¼Ÿ<ul><li>å› ä¸ºJSä»£ç å¯ä»¥ä¿®æ”¹DOMï¼Œæ‰€ä»¥éœ€è¦å°†DOMæ§åˆ¶æƒç»™å®ƒï¼Œå¦åˆ™ä¼šå‡ºç°çº¿ç¨‹ç«äº‰çš„é—®é¢˜</li><li>é—®é¢˜ç‚¹åœ¨äºå¦‚æœå¤–éƒ¨è„šæœ¬åŠ è½½æ—¶é—´éå¸¸é•¿ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šä¸€ç›´ç­‰å¾…è„šæœ¬ä¸‹è½½å®Œæˆï¼Œé€ æˆç½‘é¡µé•¿æ—¶é—´å¤±å»å“åº”ï¼Œæµè§ˆå™¨å°±ä¼šå‘ˆç°å‡ºå‡æ­»çŠ¶æ€ï¼Œç§°ä¸ºé˜»å¡æ•ˆåº”ã€‚</li><li>å› ä¸ºç›¸å¯¹è¾ƒå¥½çš„åšæ³•æ˜¯å°†Scriptæ ‡ç­¾æ”¾åœ¨é¡µé¢åº•éƒ¨ï¼Œè¿™æ ·å³ä½¿é‡åˆ°è„šæœ¬å¤±å»å“åº”ï¼Œç½‘é¡µä¸»ä½“çš„æ¸²æŸ“å·²ç»å®Œæˆï¼Œç”¨æˆ·å°±å¯ä»¥çœ‹åˆ°å†…å®¹çš„ã€‚</li></ul></li><li>è„šæœ¬æ˜¯æœ‰æ‰§è¡Œé¡ºåºçš„<ul><li>æ‰§è¡Œé¡ºåºç”±åœ¨é¡µé¢ä¸­å‡ºç°çš„é¡ºåºå†³å®šï¼Œä¸ºäº†ä¿è¯è„šæœ¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸å—åˆ°ç ´å</li><li>åŠ è½½è„šæœ¬éƒ½ä¼šäº§ç”Ÿé˜»å¡æ•ˆåº”ï¼Œéœ€è¦ç­‰ä»–ä»¬éƒ½åŠ è½½å®Œæˆæµè§ˆå™¨æ‰èƒ½ç»§ç»­é¡µé¢æ¸²æŸ“</li></ul></li><li>æ­¤å¤–ï¼Œå¯¹äºæ¥è‡ª<strong>åŒä¸€ä¸ªåŸŸåçš„èµ„æº</strong>ï¼Œæ¯”å¦‚è„šæœ¬æ–‡ä»¶ã€æ ·å¼è¡¨æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ç­‰ï¼Œæµè§ˆå™¨ä¸€èˆ¬æœ‰é™åˆ¶ï¼ŒåŒæ—¶æœ€å¤šä¸‹è½½6ï½20ä¸ªèµ„æºï¼Œå³æœ€å¤šåŒæ—¶æ‰“å¼€çš„ TCP è¿æ¥æœ‰é™åˆ¶ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å¯¹æœåŠ¡å™¨é€ æˆå¤ªå¤§å‹åŠ›ã€‚å¦‚æœæ˜¯æ¥è‡ªä¸åŒåŸŸåçš„èµ„æºï¼Œå°±æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚æ‰€ä»¥ï¼Œé€šå¸¸æŠŠé™æ€æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„åŸŸåä¹‹ä¸‹ï¼Œä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦ã€‚<h3 id="2-1-2-deferå±æ€§"><a href="#2-1-2-deferå±æ€§" class="headerlink" title="2.1.2 deferå±æ€§"></a>2.1.2 deferå±æ€§</h3></li><li>ä¸ºäº†è§£å†³è„šæœ¬æ–‡ä»¶ä¸‹è½½é˜»å¡ç½‘é¡µæ¸²æŸ“çš„é—®é¢˜</li><li>åœ¨<code>&lt;script&gt;</code>å½“ä¸­åŠ å…¥deferå±æ€§ï¼Œä½œç”¨æ˜¯å»¶è¿Ÿè„šæœ¬çš„æ‰§è¡Œï¼Œç­‰åˆ°DOMåŠ è½½ç”Ÿæˆåï¼Œå†æ‰§è¡Œè„šæœ¬ </li><li>è¿è¡Œæµç¨‹<ul><li>æµè§ˆå™¨å¼€å§‹è§£æHTMLç½‘é¡µ</li><li>å‘ç°å¸¦æœ‰deferå±æ€§çš„scriptæ ‡ç­¾</li><li>ç»§ç»­å¾€ä¸‹è§£æHTMLç½‘é¡µï¼Œå¹¶ä¸”å¹¶è¡Œä¸‹è½½scriptå…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬</li><li>å®Œæˆè§£æHTMLç½‘é¡µï¼Œå›å¤´å†æ‰§è¡Œå·²ç»ä¸‹è½½äº†çš„è„šæœ¬</li></ul></li></ul><h3 id="2-1-3-asyncå±æ€§"><a href="#2-1-3-asyncå±æ€§" class="headerlink" title="2.1.3 asyncå±æ€§"></a>2.1.3 asyncå±æ€§</h3><p>asyncå±æ€§çš„ä½œç”¨åœ¨äºä½¿ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸‹è½½è„šæœ¬ï¼Œä¸‹è½½æ—¶ä¸ä¼šé˜»å¡æ¸²æŸ“</p><ul><li>æµè§ˆå™¨å¼€å§‹è§£æHTMLç½‘é¡µ</li><li>è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¸¦æœ‰asyncå±æ€§çš„scriptæ ‡ç­¾</li><li>ç»§ç»­å‘ä¸‹è§£æï¼ŒåŒæ—¶å¹¶è¡Œä¸‹è½½scriptæ ‡ç­¾å½“ä¸­çš„å¤–éƒ¨è„šæœ¬</li><li>è„šæœ¬ä¸‹è½½å®Œæˆï¼Œæµè§ˆå™¨æš‚åœè§£æHTMLç½‘é¡µï¼Œå¼€å§‹æ‰§è¡Œä¸‹è½½çš„è„šæœ¬</li><li>è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œæµè§ˆå™¨æ¢å¤è§£æHTMLç½‘é¡µ</li></ul><p>ayncå±æ€§å¯ä»¥ä¿è¯è„šæœ¬ä¸‹è½½çš„åŒæ—¶ï¼Œæµè§ˆå™¨ç»§ç»­æ¸²æŸ“ã€‚  æ³¨æ„: ä¸€æ—¦é‡‡ç”¨ï¼Œè„šæœ¬æ‰§è¡Œé¡ºåºå°±æ— æ³•ç¡®å®šäº†</p><h3 id="2-1-4-è„šæœ¬åŠ¨æ€åŠ è½½"><a href="#2-1-4-è„šæœ¬åŠ¨æ€åŠ è½½" class="headerlink" title="2.1.4 è„šæœ¬åŠ¨æ€åŠ è½½"></a>2.1.4 è„šæœ¬åŠ¨æ€åŠ è½½</h3><p>scriptå…ƒç´ å¯ä»¥åŠ¨æ€ç”Ÿæˆï¼Œå†æ’å…¥é¡µé¢ï¼Œä»è€Œå®ç°è„šæœ¬çš„åŠ¨æ€åŠ è½½ã€‚</p><pre><code>[&#39;a.js&#39;, &#39;b.js&#39;].forEach(function(src) {  var script = document.createElement(&#39;script&#39;);  script.src = src;  document.head.appendChild(script);});</code></pre><p>åŠ¨æ€ç”Ÿæˆçš„scriptæ ‡ç­¾ä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œä¹Ÿå°±ä¸ä¼šé€ æˆæµè§ˆå™¨å‡æ­»ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œè¿™ç§æ–¹æ³•æ— æ³•ä¿è¯è„šæœ¬çš„æ‰§è¡Œé¡ºåºï¼Œå“ªä¸ªè„šæœ¬æ–‡ä»¶å…ˆä¸‹è½½å®Œæˆï¼Œå°±å…ˆæ‰§è¡Œå“ªä¸ª</p><ul><li><p>å¦å¤–æˆ‘ä»¬å¯ä»¥æŒ‡å®šæˆ‘ä»¬éœ€è¦åŠ è½½çš„åè®®ï¼Œå¯ä»¥ä½¿ç”¨HTTPæˆ–è€…HTTPSã€‚é»˜è®¤æ˜¯HTTPçš„ï¼Œå¦‚æœæƒ³ä½¿ç”¨HTTPSï¼Œéœ€è¦åšæŒ‡å®š â€“ <code>&lt;script src=&quot;https://example.js&quot;&gt;&lt;/script&gt;</code></p><h3 id="2-1-5-æµè§ˆå™¨ç»„æˆ"><a href="#2-1-5-æµè§ˆå™¨ç»„æˆ" class="headerlink" title="2.1.5 æµè§ˆå™¨ç»„æˆ"></a>2.1.5 æµè§ˆå™¨ç»„æˆ</h3></li><li><p>æ¸²æŸ“å¼•æ“</p><ul><li>å°†ç½‘é¡µä»£ç æ¸²æŸ“ä¸ºç”¨æˆ·è§†è§‰å¯ä»¥æ„ŸçŸ¥çš„å¹³é¢æ–‡æ¡£</li><li>æ¸²æŸ“çš„æ­¥éª¤<ul><li>è§£æä»£ç <ul><li>å°†HTMLä»£ç è§£æä¸ºDOMï¼ŒCSSè§£æä¸ºCSSOM (CSS Object Model)</li></ul></li><li>å¯¹è±¡åˆæˆ<ul><li>å°†DOMå’ŒCSSOMåˆæˆä¸€æ£µæ¸²æŸ“æ ‘ (render tree)</li></ul></li><li>å¸ƒå±€<ul><li>è®¡ç®—å‡ºæ¸²æŸ“æ ‘çš„å¸ƒå±€</li></ul></li><li>ç»˜åˆ¶<ul><li>å°†æ¸²æŸ“æ ‘ç»˜åˆ¶åˆ°å±å¹•ä¸Š</li></ul></li></ul></li></ul></li><li><p>é‡æµ vs é‡ç»˜</p><ul><li>é‡æµå¿…ç„¶å¯¼è‡´é‡ç»˜</li><li>é‡ç»˜ä¸ä¸€å®šå¯¼è‡´é‡æµ</li><li>å°½é‡å‡å°‘é‡æµ</li><li>ä¼˜åŒ–æŠ€å·§<ul><li>DOMå°½é‡å†™åœ¨ä¸€èµ·ï¼Œä¸è¦è¯»å–ä¸€ä¸ªèŠ‚ç‚¹å°±å†™å…¥ä¸€ä¸ª</li><li>ç¼“å­˜DOMä¿¡æ¯</li><li>åŠ¨ç”»ä½¿ç”¨absoluteå®šä½æˆ–è€…fixedå®šä½ï¼Œå¯ä»¥å‡å°‘å¯¹å…¶ä»–å…ƒç´ çš„å½±å“</li><li>åªæœ‰å¿…è¦æ—¶æ‰æ˜¾ç¤ºéšè—å…ƒç´ </li></ul></li></ul></li><li><p>JavaScriptè§£é‡Šå™¨</p><ul><li>è¯»å–ç½‘é¡µä¸­çš„JSä»£ç ï¼Œå¤„ç†åè¿è¡Œ</li><li>jsä¸éœ€è¦ç¼–è¯‘ï¼Œç”±è§£é‡Šå™¨å®æ—¶è¿è¡Œ  è¿™æ ·çš„å¥½å¤„æ˜¯è¿è¡Œå’Œä¿®æ”¹éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œåˆ·æ–°é¡µé¢å°±å¯ä»¥é‡æ–°è§£é‡Šï¼›ç¼ºç‚¹æ˜¯æ¯æ¬¡è¿è¡Œéƒ½è¦è°ƒç”¨è§£é‡Šå™¨ï¼Œç³»ç»Ÿå¼€é”€è¾ƒå¤§ï¼Œè¿è¡Œé€Ÿåº¦æ…¢äºç¼–è¯‘å‹è¯­è¨€</li><li>ä¸ºåŠ å¿«é€Ÿåº¦ï¼Œæµè§ˆå™¨ä¸€èˆ¬ä¼šè¿›è¡Œé¢„ç¼–è¯‘ï¼Œç”Ÿæˆç±»ä¼¼å­—èŠ‚ç çš„ä¸­é—´ä»£ç </li><li>å³æ—¶ç¼–è¯‘  Just in time ç¼–è¯‘å™¨ç›´æ¥æŠŠæºç ç¼–è¯‘æˆæœºå™¨ç æ¥è¿è¡Œ <ul><li>å­—èŠ‚ç åªåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œç”¨åˆ°å“ªä¸€è¡Œå°±ç¼–è¯‘å“ªä¸€è¡Œï¼Œç„¶åæŠŠç¼–è¯‘ç»“æœç¼“å­˜ </li></ul></li></ul></li></ul><h2 id="2-2-Windowå¯¹è±¡"><a href="#2-2-Windowå¯¹è±¡" class="headerlink" title="2.2 Windowå¯¹è±¡"></a>2.2 Windowå¯¹è±¡</h2><h3 id="2-2-1-å±æ€§"><a href="#2-2-1-å±æ€§" class="headerlink" title="2.2.1 å±æ€§"></a>2.2.1 å±æ€§</h3><p>windowæŒ‡å½“å‰çš„æµè§ˆå™¨çª—å£ï¼Œæ˜¯å½“å‰é¡µé¢çš„é¡¶å±‚å¯¹è±¡ï¼Œæ‰€æœ‰çš„å…¶ä»–å¯¹è±¡éƒ½æ˜¯å…¶ä¸‹å±ã€‚å¦‚æœä¸€ä¸ªå˜é‡æœªå£°æ˜ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚</p><pre><code>a = 1;window.a // 1</code></pre><ul><li><p>window.name  </p><ul><li>è¡¨ç¤ºå½“å‰çª—å£çš„åå­—</li></ul></li><li><p>window.closed </p><ul><li>æ£€æŸ¥å½“å‰çª—å£æ˜¯å¦å…³é—­</li></ul></li><li><p>window.opener </p><ul><li>è¡¨ç¤ºæ‰“å¼€å½“å‰çª—å£çš„çˆ¶çª—å£ </li></ul></li><li><p>window.window   window.window</p><ul><li>æŒ‡å‘çª—å£æœ¬èº«ï¼Œè¿™ä¸¤ä¸ªå±æ€§éƒ½åªè¯»</li></ul></li><li><p>window.frames  window,length </p><ul><li>framesè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜ä¸ºé¡µé¢å†…æ‰€æœ‰æ¡†æ¶çª—å£</li></ul></li><li><p>window.screenX window.screenY</p></li><li><p>window.innerHeight  window.innerWidth </p><ul><li>å¯è§éƒ¨åˆ†çš„é«˜åº¦å®½åº¦</li></ul></li><li><p>window.outerHeight  window.outerWidth </p></li><li><p>window.scrollX  window.scrollY</p></li><li><p>ç»„ä»¶å±æ€§</p><ul><li>window.locationbar  åœ°å€æ å¯¹è±¡</li><li>window.menubar  èœå•æ å¯¹è±¡</li><li>window.scrollbars çª—å£çš„æ»šåŠ¨æ¡å¯¹è±¡</li><li>window.toolbar å·¥å…·æ å¯¹è±¡</li><li>window.statusbar çŠ¶æ€æ å¯¹è±¡</li><li>window.personalbar ä¸ªäººå®‰è£…çš„å·¥å…·æ å¯¹è±¡</li></ul></li><li><p>å…¨å±€å¯¹è±¡å±æ€§</p><ul><li>document </li><li>location </li><li>navigator </li><li>history</li><li>localStorage </li><li>sessionStorage </li><li>console </li><li>screen </li></ul></li><li><p>å¸¸ç”¨æ–¹æ³•</p><ul><li><p>window.open(url, windowName, [windowFeatures])</p><ul><li>æ‰“å¼€ä¸€ä¸ªæ–°çš„æµè§ˆå™¨çª—å£</li></ul></li><li><p>window.close()</p></li><li><p>window.stop()</p><ul><li>ç›¸å½“äºç‚¹å‡»æµè§ˆå™¨çš„åœæ­¢æŒ‰é’®ï¼Œä¼šåœæ­¢åŠ è½½å›¾åƒç­‰æ­£åœ¨åŠ è½½çš„å¯¹è±¡</li></ul></li><li><p>window.focus()  è·å¾—ç„¦ç‚¹</p></li><li><p>window.blur()  å¤±å»ç„¦ç‚¹</p></li><li><p>window.getSelection()   è¡¨ç¤ºç”¨æˆ·ç°åœ¨é€‰ä¸­çš„æ–‡æœ¬</p><p>var popup = window.open(<br>â€˜somepage.htmlâ€™,<br>â€˜DefinitionsWindowsâ€™,<br>â€˜height=200,width=200,location=no,status=yes,resizable=yes,scrollbars=yesâ€™<br>);</p></li></ul></li><li><p>äº‹ä»¶</p><ul><li>load onload</li><li>error  onerror </li></ul></li></ul><h2 id="2-3-Navigatorå¯¹è±¡"><a href="#2-3-Navigatorå¯¹è±¡" class="headerlink" title="2.3 Navigatorå¯¹è±¡"></a>2.3 Navigatorå¯¹è±¡</h2><p><a href="https://wangdoc.com/javascript/bom/navigator.html" target="_blank" rel="noopener">https://wangdoc.com/javascript/bom/navigator.html</a></p><h2 id="2-4-Cookieå¯¹è±¡"><a href="#2-4-Cookieå¯¹è±¡" class="headerlink" title="2.4 Cookieå¯¹è±¡"></a>2.4 Cookieå¯¹è±¡</h2><h3 id="2-4-1-æ¦‚è¿°"><a href="#2-4-1-æ¦‚è¿°" class="headerlink" title="2.4.1 æ¦‚è¿°"></a>2.4.1 æ¦‚è¿°</h3><p>Cookieæ˜¯æœåŠ¡å™¨ä¿å­˜åœ¨æµè§ˆå™¨çš„ä¸€å°æ®µæ–‡æœ¬ä¿¡æ¯ï¼Œæµè§ˆå™¨æ¯æ¬¡å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨é™„ä¸Šè¿™æ®µä¿¡æ¯</p><ul><li>ç”¨é€”<ul><li>session å¯¹è¯ç®¡ç†ï¼Œä¿å­˜ç™»å½•ï¼Œè´­ç‰©è½¦ç­‰ç­‰éœ€è¦è®°å½•çš„ä¿¡æ¯</li><li>ä¸ªæ€§åŒ–ä¿¡æ¯  ç”¨æˆ·åå¥½ç­‰</li><li>è¿½è¸ªç”¨æˆ·  è®°å½•å’Œåˆ†æç”¨æˆ·çš„è¡Œä¸º</li></ul></li><li>å…ƒæ•°æ®<ul><li>cookieåå­—</li><li>cookieå€¼</li><li>åˆ°æœŸæ—¶é—´</li><li>æ‰€å±åŸŸå</li><li>ç”Ÿæ•ˆè·¯å¾„<h2 id="2-5-Locationå¯¹è±¡"><a href="#2-5-Locationå¯¹è±¡" class="headerlink" title="2.5 Locationå¯¹è±¡"></a>2.5 Locationå¯¹è±¡</h2></li></ul></li></ul><h3 id="2-5-1-Locationå¯¹è±¡"><a href="#2-5-1-Locationå¯¹è±¡" class="headerlink" title="2.5.1 Locationå¯¹è±¡"></a>2.5.1 Locationå¯¹è±¡</h3><ul><li><code>window.location</code> or <code>document.location</code>å»æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡</li><li>å±æ€§<ul><li>Location.href  æ•´ä¸ªURL</li><li>Location.protocol  å½“å‰URLçš„åè®®ï¼ŒåŒ…æ‹¬å†’å·</li><li>Location.host ä¸»æœº  </li><li>Location.hostname  ä¸»æœº  ä¸åŒ…æ‹¬ç«¯å£å·</li><li>Location.port  ç«¯å£å·</li><li>Location.pathname  URLçš„è·¯å¾„éƒ¨åˆ†ï¼Œä»æ ¹ç›®å½•çš„<code>/</code>å¼€å§‹</li><li>Location.search  æŸ¥è¯¢å­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œä»é—®å·?å¼€å§‹</li><li>Location.hash ç‰‡æ®µå­—ç¬¦ä¸²éƒ¨åˆ†  ä»#å¼€å§‹</li><li>Location.username </li><li>Location.password </li><li>Location.origin  URLçš„åè®®ï¼Œä¸»æœºåå’Œç«¯å£</li></ul></li></ul><pre><code>// å½“å‰ç½‘å€ä¸º// http://user:passwd@www.example.com:4097/path/a.html?x=111#part1document.location.href// &quot;http://user:passwd@www.example.com:4097/path/a.html?x=111#part1&quot;document.location.protocol// &quot;http:&quot;document.location.host// &quot;www.example.com:4097&quot;document.location.hostname// &quot;www.example.com&quot;document.location.port// &quot;4097&quot;document.location.pathname// &quot;/path/a.html&quot;document.location.search// &quot;?x=111&quot;document.location.hash// &quot;#part1&quot;document.location.username// &quot;user&quot;document.location.password// &quot;passwd&quot;document.location.origin// &quot;http://user:passwd@www.example.com:4097&quot;</code></pre><p>Location.hrefå±æ€§æ˜¯æµè§ˆå™¨å”¯ä¸€å…è®¸è·¨åŸŸå†™å…¥çš„å±æ€§ï¼Œå³éåŒæºçš„çª—å£å¯ä»¥æ”¹å†™å¦ä¸€ä¸ªçª—å£çš„location.hrefå±æ€§ï¼Œå¯¼è‡´åè€…çš„ç½‘å€è·³è½¬ã€‚locationçš„å…¶ä»–å±æ€§éƒ½ä¸å…è®¸è·¨åŸŸå†™å…¥çš„ã€‚</p><h3 id="2-5-2-æ–¹æ³•"><a href="#2-5-2-æ–¹æ³•" class="headerlink" title="2.5.2 æ–¹æ³•"></a>2.5.2 æ–¹æ³•</h3><ul><li>location.assgin() <ul><li>æ¥å—ä¸€ä¸ªURLå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½¿å¾—æµè§ˆå™¨ç«‹åˆ»è·³è½¬åˆ°æ–°çš„URLã€‚å¦‚æœå‚æ•°ä¸æ˜¯æœ‰æ•ˆçš„URLï¼Œåˆ™ä¼šæŠ¥é”™</li></ul></li><li>location.replace()<ul><li>æ¥å—ä¸€ä¸ªURLå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½¿å¾—æµè§ˆå™¨ç«‹åˆ»è·³è½¬åˆ°æ–°çš„URL</li><li>ä¸assignçš„ä¸åŒåœ¨äºä¼šåœ¨æµè§ˆå†å²é‡Œåˆ é™¤æ‰å½“å‰ç½‘å€</li><li>ä¸€ä¸ªåº”ç”¨åœ¨äºå½“è„šæœ¬å‘ç°å½“å‰æ˜¯ç§»åŠ¨è®¾å¤‡æ—¶ï¼Œå°±ç«‹åˆ»è·³è½¬åˆ°ç§»åŠ¨ç‰ˆç½‘é¡µå½“ä¸­</li></ul></li><li>location.reload()<ul><li>ä¸€ä¸ªå¸ƒå°”å€¼çš„å‚æ•°</li><li>true - å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚è¿™ä¸ªç½‘é¡µï¼Œé‡æ–°åŠ è½½åï¼Œç½‘é¡µå°†æ»šåŠ¨åˆ°å¤´éƒ¨</li><li>false - ä»æœ¬åœ°ç¼“å­˜é‡æ–°åŠ è½½è¯¥é¡µé¢ï¼Œå¹¶ä¸”é‡æ–°åŠ è½½åï¼Œç½‘é¡µçš„ä½ç½®æ˜¯é‡æ–°åŠ è½½å‰çš„ä½ç½®</li></ul></li><li>location.toString()<ul><li>è¿”å›æ•´ä¸ªURLå­—ç¬¦ä¸² </li></ul></li></ul><h3 id="2-5-3-URLçš„ç¼–ç å’Œè§£ç "><a href="#2-5-3-URLçš„ç¼–ç å’Œè§£ç " class="headerlink" title="2.5.3 URLçš„ç¼–ç å’Œè§£ç "></a>2.5.3 URLçš„ç¼–ç å’Œè§£ç </h3><p>é™¤å»URLå…ƒå­—ç¬¦å’Œè¯­ä¹‰å­—ç¬¦ä»¥å¤–çš„å…¶ä»–å­—ç¬¦æ˜¯éœ€è¦è½¬ä¹‰çš„ï¼Œæ¯”å¦‚ä¸­æ–‡éƒ½éœ€è¦è¿›è¡Œè½¬ä¹‰ï¼Œè½¬ä¹‰çš„æ—¶å€™åœ¨æ¯ä¸ªå­—èŠ‚å‰é¢éƒ½ä¼šåŠ ä¸Šç™¾åˆ†å·ï¼Œè¿™å°±æ„æˆäº†URLçš„ç¼–ç /è§£ç è¯­æ³•ã€‚</p><ul><li>encodeURI()<ul><li>è½¬ç æ•´ä¸ªURL </li><li>å‚æ•°ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ•´ä¸ªURL </li><li>ä¼šå°†å…ƒå­—ç¬¦å’Œè¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„å­—ç¬¦éƒ½è¿›è¡Œè½¬ä¹‰</li></ul></li><li>encodeURIComponent()<ul><li>ç”¨äºè½¬ç URLçš„ç»„æˆéƒ¨åˆ†ï¼Œä¼šè½¬ç é™¤äº†è¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼Œå³å…ƒå­—ç¬¦ä¹Ÿä¼šè¢«è½¬ç </li></ul></li><li>decodeURI()<ul><li>è§£ç æ•´ä¸ªURL </li></ul></li><li>decodeURIComponent()<ul><li>è§£ç ç‰‡æ®µ</li></ul></li></ul><pre><code>encodeURI(&#39;http://www.example.com/q=æ˜¥èŠ‚&#39;)// &quot;http://www.example.com/q=%E6%98%A5%E8%8A%82&quot;encodeURIComponent(&#39;æ˜¥èŠ‚&#39;)// &quot;%E6%98%A5%E8%8A%82&quot;encodeURIComponent(&#39;http://www.example.com/q=æ˜¥èŠ‚&#39;)// &quot;http%3A%2F%2Fwww.example.com%2Fq%3D%E6%98%A5%E8%8A%82&quot;decodeURI(&#39;http://www.example.com/q=%E6%98%A5%E8%8A%82&#39;)// &quot;http://www.example.com/q=æ˜¥èŠ‚&quot;decodeURIComponent(&#39;%E6%98%A5%E8%8A%82&#39;)// &quot;æ˜¥èŠ‚&quot;</code></pre><h3 id="2-5-4-æ¥å£"><a href="#2-5-4-æ¥å£" class="headerlink" title="2.5.4 æ¥å£"></a>2.5.4 æ¥å£</h3><ul><li><code>var url = new URL(&#39;http://www.example.com/index.html&#39;);</code></li><li>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºç›¸å¯¹è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºç»å¯¹è·¯å¾„</li></ul><pre><code>var url1 = new URL(&#39;index.html&#39;, &#39;http://example.com&#39;);url1.href// &quot;http://example.com/index.html&quot;var url2 = new URL(&#39;page2.html&#39;, &#39;http://example.com/page1.html&#39;);url2.href// &quot;http://example.com/page2.html&quot;var url3 = new URL(&#39;..&#39;, &#39;http://example.com/a/b.html&#39;)url3.href// &quot;http://example.com/&quot;</code></pre><ul><li>æ–¹æ³•<ul><li>url.createObjectURL() <ul><li>ç”¨æ¥ä¸ºä¸Šä¼ ä¸‹è½½æ–‡ä»¶ï¼Œæµåª’ä½“æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªURLå­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²ä»£è¡¨äº†FIleå¯¹è±¡æˆ–Blobå¯¹è±¡çš„URL</li></ul></li><li>url.revokeObjectURL() </li></ul></li></ul><h3 id="2-5-5-URLSearchParamså¯¹è±¡"><a href="#2-5-5-URLSearchParamså¯¹è±¡" class="headerlink" title="2.5.5 URLSearchParamså¯¹è±¡"></a>2.5.5 URLSearchParamså¯¹è±¡</h3><ul><li>ç”¨æ¥æ„é€ ï¼Œè§£æï¼Œå¤„ç†URLçš„æŸ¥è¯¢å­—ç¬¦ä¸² </li></ul><pre><code>var params = new URLSearchParams(&#39;?foo=1&amp;bar=2&#39;);// ç­‰åŒäºvar params = new URLSearchParams(document.location.search);// æ–¹æ³•äºŒï¼šä¼ å…¥æ•°ç»„var params = new URLSearchParams([[&#39;foo&#39;, 1], [&#39;bar&#39;, 2]]);// æ–¹æ³•ä¸‰ï¼šä¼ å…¥å¯¹è±¡var params = new URLSearchParams({&#39;foo&#39; : 1 , &#39;bar&#39; : 2});</code></pre><h2 id="2-6-Blobå¯¹è±¡"><a href="#2-6-Blobå¯¹è±¡" class="headerlink" title="2.6 Blobå¯¹è±¡"></a>2.6 Blobå¯¹è±¡</h2><p>ArrayBufferå¯¹è±¡è¡¨ç¤ºä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨æ¥æ¨¡æ‹Ÿå†…å­˜é‡Œçš„æ•°æ®</p><p>Blobå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æ•°æ®å†…å®¹ï¼Œ- Binary Large Object.Blobç”¨äºæ“ä½œäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><ul><li>Blobæ„é€ å‡½æ•°<ul><li><code>new Blob(array [, options])</code></li><li>ç¬¬ä¸€ä¸ªå‚æ•° æ•°ç»„ æˆå‘˜æ˜¯å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶å¯¹è±¡ï¼Œè¡¨ç¤ºæ–°ç”Ÿæˆçš„Blobå®ä¾‹å¯¹è±¡çš„å†…å®¹</li><li>ç¬¬äºŒä¸ªå‚æ•°  é…ç½®å¯¹è±¡<ul><li>type è¡¨ç¤ºæ•°æ®çš„MIMEç±»å‹ï¼Œé»˜è®¤æ˜¯ç©ºå­—ç¬¦ä¸²</li></ul></li></ul></li></ul><pre><code>var htmlFragment = [&#39;&lt;a id=&quot;a&quot;&gt;&lt;b id=&quot;b&quot;&gt;hey!&lt;/b&gt;&lt;/a&gt;&#39;];var myBlob = new Blob(htmlFragment, {type : &#39;text/html&#39;});var obj = { hello: &#39;world&#39; };var blob = new Blob([ JSON.stringify(obj) ], {type : &#39;application/json&#39;});</code></pre><h3 id="2-6-1-å®ä¾‹å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•"><a href="#2-6-1-å®ä¾‹å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•" class="headerlink" title="2.6.1 å®ä¾‹å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•"></a>2.6.1 å®ä¾‹å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•</h3><ul><li>size<ul><li>æ•°æ®å¤§å°</li></ul></li><li>type<ul><li>æ•°æ®ç±»å‹<ul><li>text/html </li></ul></li></ul></li><li>slice(start, end, contentType)<ul><li>ç”¨æ¥æ‹·è´åŸæ¥çš„æ•°æ®ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªBlobå®ä¾‹ </li><li>èµ·å§‹çš„å­—èŠ‚ä½ç½®ï¼Œç»“æŸçš„å­—èŠ‚ä½ç½®ï¼Œæ–°å®ä¾‹çš„æ•°æ®ç±»å‹</li></ul></li></ul><h3 id="2-6-2-è·å–æ–‡ä»¶ä¿¡æ¯"><a href="#2-6-2-è·å–æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="2.6.2 è·å–æ–‡ä»¶ä¿¡æ¯"></a>2.6.2 è·å–æ–‡ä»¶ä¿¡æ¯</h3><ul><li>æ–‡ä»¶é€‰æ‹©å™¨ <code>&lt;input type=&quot;file&quot;&gt;</code>ç”¨æ¥è®©ç”¨æˆ·é€‰å–æ–‡ä»¶</li><li>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¸å…è®¸è„šæœ¬è‡ªè¡Œè®¾ç½®å…¶valueå±æ€§ï¼Œå¿…é¡»æ‰‹åŠ¨é€‰å–</li><li>æ–‡ä»¶é€‰æ‹©å™¨è¿”å›ä¸€ä¸ªFileListå¯¹è±¡ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªFileå®ä¾‹å¯¹è±¡ã€‚å…¶ä¸ºä¸€ä¸ªç‰¹æ®Šçš„Blobå®ä¾‹ï¼Œå¢åŠ äº†nameå’ŒlastModifiedDateå±æ€§ã€‚</li></ul><h3 id="2-6-3-ä¸‹è½½æ–‡ä»¶"><a href="#2-6-3-ä¸‹è½½æ–‡ä»¶" class="headerlink" title="2.6.3 ä¸‹è½½æ–‡ä»¶"></a>2.6.3 ä¸‹è½½æ–‡ä»¶</h3><p>AJAX è¯·æ±‚æ—¶ï¼Œå¦‚æœæŒ‡å®šresponseTypeå±æ€§ä¸ºblobï¼Œä¸‹è½½ä¸‹æ¥çš„å°±æ˜¯ä¸€ä¸ª Blob å¯¹è±¡ã€‚</p><pre><code>function getBlob(url, callback) {  var xhr = new XMLHttpRequest();  xhr.open(&#39;GET&#39;, url);  xhr.responseType = &#39;blob&#39;;  xhr.onload = function () {    callback(xhr.response);  }  xhr.send(null);}</code></pre><h3 id="2-6-4-ç”ŸæˆURL"><a href="#2-6-4-ç”ŸæˆURL" class="headerlink" title="2.6.4 ç”ŸæˆURL"></a>2.6.4 ç”ŸæˆURL</h3><ul><li>å¯ä»¥é€šè¿‡ä½¿ç”¨<code>URL.createObjectURL()</code>æ–¹æ³•ï¼Œé’ˆå¯¹Blobå¯¹è±¡ç”Ÿæˆä¸€ä¸ªä¸´æ—¶URLï¼Œä»¥ä¾¿äºæŸäº›APIä½¿ç”¨</li><li>URLä»¥<code>Blob://</code>å¼€å¤´ï¼Œè¡¨æ˜å¯¹åº”ä¸€ä¸ªBlobå¯¹è±¡ï¼Œåè®®å¤´åé¢æ˜¯ä¸€ä¸ªè¯†åˆ«ç¬¦ï¼Œç”¨æ¥å”¯ä¸€å¯¹åº”å†…å­˜çš„Blobå¯¹è±¡</li></ul><pre><code>var droptarget = document.getElementById(&#39;droptarget&#39;);droptarget.ondrop = function (e) {  var files = e.dataTransfer.files;  for (var i = 0; i &lt; files.length; i++) {    var type = files[i].type;    if (type.substring(0,6) !== &#39;image/&#39;)      continue;    var img = document.createElement(&#39;img&#39;);    img.src = URL.createObjectURL(files[i]);    img.onload = function () {      this.width = 100;      document.body.appendChild(this);      URL.revokeObjectURL(this.src);    }  }}</code></pre><p>è¯¥æ®µä»£ç é€šè¿‡ä¸ºæ‹–æ”¾çš„å›¾ç‰‡æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªURLï¼Œäº§ç”Ÿä»–ä»¬çš„ç¼©ç•¥å›¾ï¼Œä»è€Œä½¿å¾—ç”¨æˆ·å¯ä»¥é¢„è§ˆé€‰æ‹©çš„æ–‡ä»¶ã€‚</p><h3 id="2-6-5-è¯»å–æ–‡ä»¶"><a href="#2-6-5-è¯»å–æ–‡ä»¶" class="headerlink" title="2.6.5 è¯»å–æ–‡ä»¶"></a>2.6.5 è¯»å–æ–‡ä»¶</h3><p>è·å–Blobå¯¹è±¡ä»¥åï¼Œé€šè¿‡FileReaderå¯¹è±¡ï¼Œè¯»å–Blobå¯¹è±¡çš„å†…å®¹ã€‚Blobå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥FilreReaderæä¾›çš„å¤„ç†æ–¹æ³•å½“ä¸­ï¼Œç„¶åä»¥æŒ‡å®šçš„æ ¼å¼è¿”å›</p><ul><li>FileReader.readAsText()   è¿”å›æ–‡æœ¬ï¼Œéœ€è¦æŒ‡å®šæ–‡æœ¬ç¼–ç </li><li>FileReader.readAsArrayBuffer()   è¿”å›ArrayBufferå¯¹è±¡</li><li>FileReader.readAsDataURL()  è¿”å›Data URL</li><li>FileReader.readAsBinaryString()  è¿”å›åŸå§‹çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</li></ul><h2 id="2-7-è¡¨å•-FormDataå¯¹è±¡"><a href="#2-7-è¡¨å•-FormDataå¯¹è±¡" class="headerlink" title="2.7 è¡¨å• FormDataå¯¹è±¡"></a>2.7 è¡¨å• FormDataå¯¹è±¡</h2><h3 id="2-7-1-General"><a href="#2-7-1-General" class="headerlink" title="2.7.1 General"></a>2.7.1 General</h3><p>è¡¨å•å¯¹è±¡ç”¨æ¥æ”¶é›†ç”¨æˆ·æäº¤çš„æ•°æ®ï¼Œå‘é€åˆ°æœåŠ¡å™¨ã€‚</p><pre><code>&lt;form action=&quot;/handling-page&quot; method=&quot;post&quot;&gt;  &lt;div&gt;    &lt;label for=&quot;name&quot;&gt;ç”¨æˆ·åï¼š&lt;/label&gt;    &lt;input type=&quot;text&quot; id=&quot;name&quot; name=&quot;user_name&quot; /&gt;  &lt;/div&gt;  &lt;div&gt;    &lt;label for=&quot;passwd&quot;&gt;å¯†ç ï¼š&lt;/label&gt;    &lt;input type=&quot;password&quot; id=&quot;passwd&quot; name=&quot;user_passwd&quot; /&gt;  &lt;/div&gt;  &lt;div&gt;    &lt;input type=&quot;submit&quot; id=&quot;submit&quot; name=&quot;submit_button&quot; value=&quot;æäº¤&quot; /&gt;  &lt;/div&gt;&lt;/form&gt;</code></pre><p>é”®å€¼å¯¹ä¼šæé«˜åˆ°æœåŠ¡å™¨å½“ä¸­ï¼Œæäº¤çš„æ•°æ®æ ¼å¼è·Ÿformå…ƒç´ çš„methodå±æ€§æœ‰å…³ï¼Œè¯¥å±æ€§æŒ‡å®šäº†æäº¤æ•°æ®çš„HTTPæ–¹æ³•ã€‚å¦‚æœæ˜¯GETæ–¹æ³•ï¼Œæ‰€æœ‰é”®å€¼å¯¹ä¼šä»¥URLçš„æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼ï¼Œæäº¤åˆ°æœåŠ¡å™¨å½“ä¸­ã€‚</p><p>å¦‚æœæ˜¯postè¯·æ±‚ï¼Œæ‰€æœ‰é”®å€¼å¯¹ä¼šè¿æ¥æˆä¸€è¡Œï¼Œä½œä¸ºHTTPè¯·æ±‚çš„æ•°æ®ä½“å‘é€åˆ°æœåŠ¡å™¨</p><pre><code>GET /handling-page?user_name=å¼ ä¸‰&amp;user_passwd=123&amp;submit_button=æäº¤Host: example.comPOST /handling-page HTTP/1.1Host: example.comContent-Type: application/x-www-form-urlencodedContent-Length: 74user_name=å¼ ä¸‰&amp;user_passwd=123&amp;submit_button=æäº¤</code></pre><p>æ³¨æ„å¦‚æœæäº¤çš„æ—¶å€™ï¼Œå¦‚æœé”®å€¼ä¸æ˜¯URLçš„åˆæ³•å­—ç¬¦ï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å¯¹å…¶è¿›è¡Œç¼–ç ã€‚</p><p>ç‚¹å‡»submitæ§ä»¶å°±å¯ä»¥æäº¤è¡¨å•äº†ã€‚</p><h3 id="2-7-2-FormDataå¯¹è±¡"><a href="#2-7-2-FormDataå¯¹è±¡" class="headerlink" title="2.7.2 FormDataå¯¹è±¡"></a>2.7.2 FormDataå¯¹è±¡</h3><p>é€šè¿‡è„šæœ¬å®Œæˆå¯¹äºè¡¨å•é”®å€¼å¯¹çš„æ„å»ºï¼Œç„¶åé€šè¿‡<code>XMLHttpRequest.send()</code>æ–¹å¼æ¥è¿›è¡Œå‘é€ï¼Œæµè§ˆå™¨åŸç”Ÿæä¾›äº†FormDataå¯¹è±¡æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p><ul><li>FormData() æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªè¡¨å•å…ƒç´ ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¦‚æœçœç•¥å‚æ•°ï¼Œå°±è¡¨ç¤ºä¸€ä¸ªç©ºçš„è¡¨å•ï¼Œå¦åˆ™å°±ä¼šå¤„ç†è¡¨å•å…ƒç´ é‡Œé¢çš„é”®å€¼å¯¹ã€‚</li></ul><pre><code>&lt;form id=&quot;myForm&quot; name=&quot;myForm&quot;&gt;  &lt;div&gt;    &lt;label for=&quot;username&quot;&gt;ç”¨æˆ·åï¼š&lt;/label&gt;    &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot;&gt;  &lt;/div&gt;  &lt;div&gt;    &lt;label for=&quot;useracc&quot;&gt;è´¦å·ï¼š&lt;/label&gt;    &lt;input type=&quot;text&quot; id=&quot;useracc&quot; name=&quot;useracc&quot;&gt;  &lt;/div&gt;  &lt;div&gt;    &lt;label for=&quot;userfile&quot;&gt;ä¸Šä¼ æ–‡ä»¶ï¼š&lt;/label&gt;    &lt;input type=&quot;file&quot; id=&quot;userfile&quot; name=&quot;userfile&quot;&gt;  &lt;/div&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit!&quot;&gt;&lt;/form&gt;var myForm = document.getElementById(&#39;myForm&#39;);var formData = new FormData(myForm);// è·å–æŸä¸ªæ§ä»¶çš„å€¼formData.get(&#39;username&#39;) // &quot;&quot;// è®¾ç½®æŸä¸ªæ§ä»¶çš„å€¼formData.set(&#39;username&#39;, &#39;å¼ ä¸‰&#39;);formData.get(&#39;username&#39;) // &quot;å¼ ä¸‰&quot;</code></pre><ul><li>FormData.get(key)</li><li>FormData.getAll(key)</li><li>FormData.set(key, value)</li><li>FormData.delete(key)</li><li>FormData.append(key, value)</li><li>FormData.has(key)</li><li>FormData.keys()  </li><li>FormData.values()</li><li>FormData.entries() </li></ul><h3 id="2-7-3-è¡¨å•çš„å†…ç½®éªŒè¯"><a href="#2-7-3-è¡¨å•çš„å†…ç½®éªŒè¯" class="headerlink" title="2.7.3 è¡¨å•çš„å†…ç½®éªŒè¯"></a>2.7.3 è¡¨å•çš„å†…ç½®éªŒè¯</h3><ul><li>è‡ªåŠ¨æ ¡éªŒ<ul><li>å¯ä»¥åœ¨è¡¨å•æäº¤çš„æ—¶å€™æŒ‡å®šä¸€äº›æ¡ä»¶ï¼Œæ¥è‡ªåŠ¨éªŒè¯å„ä¸ªè¡¨å•æ§ä»¶çš„å€¼æ˜¯å¦ç¬¦åˆæ¡ä»¶</li></ul></li></ul><pre><code>&lt;!-- å¿…å¡« --&gt;&lt;input required&gt;&lt;!-- å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ --&gt;&lt;input pattern=&quot;banana|cherry&quot;&gt;&lt;!-- å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º6ä¸ªå­—ç¬¦ --&gt;&lt;input minlength=&quot;6&quot; maxlength=&quot;6&quot;&gt;&lt;!-- æ•°å€¼å¿…é¡»åœ¨1åˆ°10ä¹‹é—´ --&gt;&lt;input type=&quot;number&quot; min=&quot;1&quot; max=&quot;10&quot;&gt;&lt;!-- å¿…é¡»å¡«å…¥ Email åœ°å€ --&gt;&lt;input type=&quot;email&quot;&gt;&lt;!-- å¿…é¡»å¡«å…¥ URL --&gt;&lt;input type=&quot;URL&quot;&gt;// é€šè¿‡CSSä¼ªç±»æ¥æ§åˆ¶æ•´ä¸ªinput:invalid {  border-color: red;}input,input:valid {  border-color: #ccc;}</code></pre><ul><li>checkValidity() <ul><li>ç”¨äºæ‰‹åŠ¨è§¦å‘è¡¨å•çš„æ ¡éªŒ</li><li>è¡¨å•å…ƒç´ å’Œè¡¨å•æ§ä»¶éƒ½æœ‰checkValidity()æ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨è§¦å‘æ ¡éªŒ</li></ul></li></ul><pre><code>function submitForm(action) {  var form = document.getElementById(&#39;form&#39;);  form.action = action;  if (form.checkValidity()) {    form.submit();  }}</code></pre><ul><li>validationMessage å±æ€§<ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ§ä»¶ä¸æ»¡è¶³æ ¡éªŒæ¡ä»¶æ—¶ï¼Œæµè§ˆå™¨æ˜¾ç¤ºçš„æç¤ºæ–‡æœ¬</li></ul></li></ul><pre><code>var myInput = document.getElementById(&#39;myinput&#39;);if (!myInput.checkValidity()) {  document.getElementById(&#39;prompt&#39;).innerHTML = myInput.validationMessage;}</code></pre><ul><li><p>validityå±æ€§</p><ul><li>è¿”å›ä¸€ä¸ªvalidityStateå¯¹è±¡ï¼ŒåŒ…å«å½“å‰æ ¡éªŒçŠ¶æ€çš„ä¿¡æ¯</li><li>å±æ€§<ul><li>validityState.badInput</li><li>validityState.customError </li><li>validityState.patternMismatch</li><li>validityState.rangeOverflow </li><li>validityState.rangeUnderflow </li><li>validityState.stepMismatch </li><li>validityState.tooLong</li><li>validityState.tooShort </li><li>validityState.typeMismatch </li><li>validityState.valid</li><li>valitityState.valueMising </li></ul></li></ul></li><li><p>è¡¨å•novalideå±æ€§</p><ul><li>å¯ä»¥å…³é—­æµè§ˆå™¨çš„è‡ªåŠ¨æ ¡éªŒ</li></ul></li></ul><h3 id="2-7-4-enctypeå±æ€§"><a href="#2-7-4-enctypeå±æ€§" class="headerlink" title="2.7.4 enctypeå±æ€§"></a>2.7.4 enctypeå±æ€§</h3><ul><li>GET - URLæŸ¥è¯¢å­—ç¬¦ä¸²<ul><li>enctypeå±æ€§æ— æ•ˆ </li></ul></li><li>POST - <code>application/x-www-form-yrlencoded</code><ul><li>å½“çœç•¥enctypeå±æ€§çš„æ—¶å€™ï¼Œæ•°æ®ä¼šä»¥é»˜è®¤çš„<code>application/x-www-form-urlencoded</code>æ ¼å¼è¿›è¡Œå‘é€ </li></ul></li><li>POST - <code>text/plain</code></li></ul><pre><code>&lt;form  action=&quot;register.php&quot;  method=&quot;post&quot;  enctype=&quot;text/plain&quot;  onsubmit=&quot;AJAXSubmit(this); return false;&quot;&gt;&lt;/form&gt;</code></pre><ul><li>POST - <code>multipart/form-data</code><ul><li>æ•°æ®ä»¥æ··åˆçš„æ–¹å¼æ¥å‘é€å‡ºå»</li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://wangdoc.com/javascript/events/index.html" target="_blank" rel="noopener">https://wangdoc.com/javascript/events/index.html</a> </li><li><a href="https://segmentfault.com/a/1190000008227026" target="_blank" rel="noopener">https://segmentfault.com/a/1190000008227026</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript æ•™ç¨‹ - part 2</title>
      <link href="/JavaScript-%E6%95%99%E7%A8%8B-part-2/"/>
      <url>/JavaScript-%E6%95%99%E7%A8%8B-part-2/</url>
      
        <content type="html"><![CDATA[<h1 id="1-é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#1-é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="1. é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>1. é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><h2 id="1-1-å®ä¾‹å¯¹è±¡ä¸Newå‘½ä»¤"><a href="#1-1-å®ä¾‹å¯¹è±¡ä¸Newå‘½ä»¤" class="headerlink" title="1.1 å®ä¾‹å¯¹è±¡ä¸Newå‘½ä»¤"></a>1.1 å®ä¾‹å¯¹è±¡ä¸Newå‘½ä»¤</h2><ul><li><p>å¯¹è±¡</p><ul><li>å¯¹ä¸–ç•Œå„ç§å¤æ‚å…³ç³»çš„æŠ½è±¡</li><li>æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå°è£…äº†å±æ€§å’Œæ–¹æ³•</li></ul></li><li><p>æ„é€ å‡½æ•°</p><ul><li>java c++æ˜¯é€šè¿‡ç±»çš„æ¦‚å¿µæ¥ä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ï¼Œè€Œå¯¹è±¡å°±æ˜¯ç±»çš„å®ä¾‹</li><li>è€Œåœ¨jså½“ä¸­ï¼Œå¯¹è±¡ä½“ç³»æ˜¯åŸºäºæ„é€ å‡½æ•°å’ŒåŸå‹é“¾çš„<h3 id="1-1-1-æ„é€ å‡½æ•°"><a href="#1-1-1-æ„é€ å‡½æ•°" class="headerlink" title="1.1.1 æ„é€ å‡½æ•°"></a>1.1.1 æ„é€ å‡½æ•°</h3>æ„é€ å‡½æ•°æ˜¯ç”¨æ¥ä¸“é—¨ç”Ÿæˆå®ä¾‹å¯¹è±¡çš„å‡½æ•°ï¼Œå®ƒå°±æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œæè¿°äº†å¯¹è±¡çš„åŸºæœ¬ç»“æ„ã€‚</li></ul></li><li><p>æ„é€ å‡½æ•°çš„ç‰¹ç‚¹ï¼š</p><ul><li>å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨<strong>thiså…³é”®å­—</strong>ï¼Œä»£è¡¨äº†æ‰€è¦ç”Ÿæˆçš„å¯¹è±¡å®ä¾‹</li><li>ç”Ÿæˆå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»ä½¿ç”¨newå‘½ä»¤</li></ul></li></ul><pre><code>var Vehicle = function () {  this.price = 1000;};</code></pre><h3 id="1-1-2-New"><a href="#1-1-2-New" class="headerlink" title="1.1.2 New"></a>1.1.2 New</h3><ul><li>newå‘½ä»¤çš„ä½œç”¨å°±æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡</li><li>newæŒ‡ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œæ„é€ å‡½æ•°å†…éƒ¨çš„thiså°±ä»£è¡¨äº†æ–°ç”Ÿæˆçš„å®ä¾‹å¯¹è±¡</li><li>newæŒ‡ä»¤çš„åŸç†<ul><li>æ„å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½œä¸ºè¦è¿”å›çš„å¯¹è±¡çš„å®ä¾‹</li><li>å°†è¿™ä¸ªç©ºå¯¹è±¡çš„åŸå‹ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„prototypeå±æ€§</li><li>å°†è¿™ä¸ªç©ºå¯¹è±¡èµ‹å€¼ç»™å‡½æ•°å†…éƒ¨çš„thiså…³é”®å­—</li><li>å¼€å§‹æ‰§è¡Œæ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç </li></ul></li></ul><pre><code>var Vehicle = function () {  this.price = 1000;};var v = new Vehicle();v.price // 1000</code></pre><ul><li>new.target<ul><li>ä½¿ç”¨new.targetå…³é”®å­—</li><li>å¦‚æœå½“å‰å‡½æ•°å¼newå‘½ä»¤è°ƒç”¨çš„ï¼ŒæŒ‡å‘å½“å‰å‡½æ•°ï¼Œå¦åˆ™ä¸ºundefined</li></ul></li><li><code>Object.create()</code>åˆ›å»ºå®ä¾‹å¯¹è±¡<ul><li>æ„é€ å‡½æ•°ä½œä¸ºæ¨¡æ¿ï¼Œå¯ä»¥ç”Ÿæˆå®ä¾‹å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æ‹¿ä¸åˆ°æ„é€ å‡½æ•°ï¼Œåªèƒ½æ‹¿åˆ°ä¸€ä¸ªç°æœ‰çš„å¯¹è±¡ã€‚æˆ‘ä»¬å¸Œæœ›ä»¥è¿™ä¸ªç°æœ‰çš„å¯¹è±¡ä½œä¸ºæ¨¡æ¿ï¼Œç”Ÿæˆæ–°çš„å®ä¾‹å¯¹è±¡ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨Object.create()æ–¹æ³•ã€‚</li></ul></li></ul><pre><code>var person1 = {  name: &#39;å¼ ä¸‰&#39;,  age: 38,  greeting: function() {    console.log(&#39;Hi! I\&#39;m &#39; + this.name + &#39;.&#39;);  }};var person2 = Object.create(person1);person2.name // å¼ ä¸‰person2.greeting() // Hi! I&#39;m å¼ ä¸‰.</code></pre><h2 id="1-2-thiså…³é”®å­—"><a href="#1-2-thiså…³é”®å­—" class="headerlink" title="1.2 thiså…³é”®å­—"></a>1.2 thiså…³é”®å­—</h2><p>thisæ˜¯å±æ€§æˆ–è€…æ–¹æ³•å½“å‰æ‰€åœ¨çš„å¯¹è±¡ã€‚</p><p>å¯¹è±¡çš„å±æ€§å¯ä»¥èµ‹ç»™å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å±æ€§æ‰€åœ¨çš„å½“å‰å¯¹è±¡æ˜¯å¯å˜çš„ï¼Œthisçš„æŒ‡å‘æ˜¯å¯å˜çš„</p><pre><code>function f() {  return &#39;å§“åï¼š&#39;+ this.name;}var A = {  name: &#39;å¼ ä¸‰&#39;,  describe: f};var B = {  name: &#39;æå››&#39;,  describe: f};A.describe() // &quot;å§“åï¼šå¼ ä¸‰&quot;B.describe() // &quot;å§“åï¼šæå››&quot;&lt;input type=&quot;text&quot; name=&quot;age&quot; size=3 onChange=&quot;validate(this, 18, 99);&quot;&gt;&lt;script&gt;function validate(obj, lowval, hival){  if ((obj.value &lt; lowval) || (obj.value &gt; hival))    console.log(&#39;Invalid Value!&#39;);}&lt;/script&gt;</code></pre><ul><li>JSå½“ä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œè¿è¡Œç¯å¢ƒä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°æ€»å½’æ˜¯åœ¨æŸä¸ªå¯¹è±¡ä¹‹ä¸­è¿è¡Œçš„ï¼Œthiså°±æ˜¯å‡½æ•°è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡</li><li>thisä¸ºçš„æ˜¯åœ¨å‡½æ•°ä½“å†…å¯ä»¥è·å¾—å‡½æ•°çš„å½“å‰è¿è¡Œç¯å¢ƒçš„ç›¸å…³ä¿¡æ¯</li></ul><h3 id="1-2-1-thiså®è´¨"><a href="#1-2-1-thiså®è´¨" class="headerlink" title="1.2.1 thiså®è´¨"></a>1.2.1 thiså®è´¨</h3><ul><li>é¦–å…ˆéœ€è¦çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ•°æ®å­˜å‚¨çš„<ul><li><code>var obj = { foo: 5}</code>;<ul><li>å°†ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™å˜é‡obj</li><li>JSå¼•æ“ä¼šå…ˆåœ¨å†…å­˜é‡Œé¢ç”Ÿæˆä¸€ä¸ªå¯¹è±¡</li><li>å°†è¿™ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€èµ‹å€¼ç»™å˜é‡obj</li><li>â€”-&gt; å˜é‡objæ˜¯ä¸€ä¸ªåœ°å€ referenceã€‚åé¢å¦‚æœè¦è¯»å–obj.fooï¼Œ å¼•æ“å…ˆä»objæ‹¿åˆ°å†…å­˜åœ°å€ï¼Œç„¶åå†ä»è¯¥åœ°å€è¯»å‡ºåŸå§‹å¯¹è±¡ï¼Œè¿”å›å…¶fooå±æ€§</li></ul></li><li>åŸå§‹çš„å¯¹è±¡ä»¥å­—å…¸ç»“æ„å­˜å‚¨ï¼Œæ¯ä¸€ä¸ªå±æ€§åéƒ½å¯¹åº”ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡<ul><li>å¦‚æœå¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¯</li><li>JSå¼•æ“ä¼šå°†å‡½æ•°å•ç‹¬ä¿å­˜åœ¨å†…å­˜å½“ä¸­ï¼Œç„¶åå°†å‡½æ•°çš„åœ°å€èµ‹å€¼ç»™fooçš„valueå±æ€§</li><li>å› ä¸º<strong>å‡½æ•°æ˜¯ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼Œæ‰€ä»¥å®ƒå¯ä»¥åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡å»æ‰§è¡Œ</strong></li></ul></li><li>thisçš„æƒ³æ³•ï¼Œæˆ–è€…è¯´ç›®çš„å°±æ˜¯åœ¨å‡½æ•°ä½“å†…éƒ¨ï¼ŒæŒ‡ä»£å‡½æ•°å½“å‰çš„è¿è¡Œç¯å¢ƒ</li></ul></li></ul><pre><code>// å¯¹è±¡çš„å®é™…ä¿å­˜å½¢å¼{  foo: {    [[value]]: 5    [[writable]]: true    [[enumerable]]: true    [[configurable]]: true  }}var f = function () {    console.log(this.x);}</code></pre><h3 id="1-2-2-ä½¿ç”¨åœºåˆ"><a href="#1-2-2-ä½¿ç”¨åœºåˆ" class="headerlink" title="1.2.2 ä½¿ç”¨åœºåˆ"></a>1.2.2 ä½¿ç”¨åœºåˆ</h3><ul><li>å…¨å±€ç¯å¢ƒ<ul><li>æŒ‡é¡¶å±‚å¯¹è±¡window</li></ul></li><li>æ„é€ å‡½æ•°<ul><li>æŒ‡å®ä¾‹å¯¹è±¡ </li><li>åœ¨æ„é€ å‡½æ•°å½“ä¸­ä½¿ç”¨thisï¼Œå®šä¹‰äº†å±æ€§ï¼Œé‚£å°±æ„å‘³ç€å®šä¹‰äº†å®ä¾‹å¯¹è±¡æœ‰ä¸€ä¸ªpå±æ€§</li></ul></li></ul><pre><code>// thisæŒ‡å®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™ä¸ºå®ä¾‹å¯¹è±¡å®šä¹‰äº†på±æ€§var Obj = function(p) {    this.p = p;};</code></pre><ul><li>å¯¹è±¡æ–¹æ³•<ul><li>thisæŒ‡å‘æ˜¯æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè¯¥æ–¹æ³•èµ‹å€¼ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šæ”¹å˜thisçš„æŒ‡å‘</li><li>è¿™æ˜¯å› ä¸ºobj.fooå°±æ˜¯ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼çœŸæ­£è°ƒç”¨çš„æ—¶å€™ï¼Œè¿è¡Œç¯å¢ƒå·²ç»ä¸æ˜¯objäº†ï¼Œè€Œæ˜¯å…¨å±€ç¯å¢ƒï¼Œæ‰€ä»¥thisä¸å†æŒ‡å‘obj</li></ul></li></ul><pre><code>// æŒ‡å‘objvar obj ={  foo: function () {    console.log(this);  }};obj.foo() // obj// ä»¥ä¸‹æƒ…å†µéƒ½ä¼šæ”¹å˜thisçš„æŒ‡å‘// æƒ…å†µä¸€(obj.foo = obj.foo)() // window// æƒ…å†µäºŒ(false || obj.foo)() // window// æƒ…å†µä¸‰(1, obj.foo)() // window</code></pre><h3 id="1-2-3-Tips"><a href="#1-2-3-Tips" class="headerlink" title="1.2.3 Tips"></a>1.2.3 Tips</h3><ul><li>é¿å…å¤šå±‚this<ul><li>å› ä¸ºthisçš„æŒ‡å‘æ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨å‡½æ•°å½“ä¸­åŒ…å«å¤šå±‚çš„this</li><li>å¦‚æœæ˜¯å¤šå±‚çš„è¯ï¼Œå¯ä»¥åœ¨ç¬¬äºŒå±‚å¢åŠ ä¸€ä¸ªæŒ‡å‘å¤–å±‚thisçš„å˜é‡æ¥åš</li></ul></li></ul><pre><code>var o = {  f1: function () {    console.log(this);    var f2 = function () {      console.log(this);    }();  }}o.f1()// Object// Windowvar o = {  f1: function() {    console.log(this);    var that = this;    var f2 = function() {      console.log(that);    }();  }}o.f1()// Object// Object</code></pre><ul><li>æ•°ç»„å¤„ç†æ–¹æ³•å½“ä¸­çš„this<ul><li>è¿˜æ˜¯éœ€è¦ä½¿ç”¨ä¸­é—´å˜é‡æ¥å›ºå®šä½this </li></ul></li></ul><h3 id="1-2-4-ç»‘å®šthisçš„æ–¹æ³•"><a href="#1-2-4-ç»‘å®šthisçš„æ–¹æ³•" class="headerlink" title="1.2.4 ç»‘å®šthisçš„æ–¹æ³•"></a>1.2.4 ç»‘å®šthisçš„æ–¹æ³•</h3><p>thisçš„åŠ¨æ€åˆ‡æ¢ï¼Œå¯ä»¥ä¸ºJSæä¾›çµæ´»æ€§ï¼Œä½†ä¹Ÿä½¿å¾—ç¼–ç¨‹å˜å¾—å›°éš¾å’Œæ¨¡ç³Šï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†thiså›ºå®šä¸‹æ¥ï¼Œé¿å…å‡ºç°æ„æƒ³ä¸åˆ°çš„æƒ…å†µã€‚JSæä¾›äº†call, apply, bindä¸‰ä¸ªæ–¹æ³•ï¼Œæ¥åˆ‡æ¢å’Œå›ºå®šthisçš„æŒ‡å‘</p><ul><li><code>Function.prototype.call()</code><ul><li>callæ–¹æ³•å¯ä»¥æŒ‡å®šå‡½æ•°å†…éƒ¨çš„thisçš„æŒ‡å‘ï¼Œ(å‡½æ•°æ‰§è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸ)ï¼Œç„¶ååœ¨æ‰€æŒ‡å®šçš„ä½œç”¨åŸŸå½“ä¸­ï¼Œè°ƒç”¨è¯¥å‡½æ•°</li><li>callå¯ä»¥æ¥å—å¤šä¸ªå‚æ•° <code>func.call(thisValue, arg1, arg2)</code> </li><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯thisæ‰€è¦æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼Œåé¢çš„å‚æ•°åˆ™æ˜¯å‡½æ•°è°ƒç”¨æ—¶æ‰€éœ€çš„å‚æ•°</li></ul></li></ul><pre><code>var obj = {};var f = function () {  return this;};f() === window // true// callå¯ä»¥å¸¦ä¸ªå¯¹è±¡ï¼Œç„¶åè¿™ä¸ªæ—¶å€™å°±å°†thisçš„æŒ‡å‘å›ºå®šä¸‹æ¥äº†f.call(obj) === obj // true</code></pre><ul><li><code>Function.prototype.apply()</code><ul><li>applyæ¥æ”¶ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‡½æ•°æ‰§è¡Œæ—¶çš„å‚æ•°ï¼Œå…¶ä»–å’Œcallå‡½æ•°æ˜¯ä¸€è‡´çš„</li><li><code>func.apply(thisValue, [arg1, arg2, ...])</code></li></ul></li></ul><pre><code>function f(x, y){  console.log(x + y);}f.call(null, 1, 1) // 2f.apply(null, [1, 1]) // 2</code></pre><ul><li><code>Function.prototype.bind()</code><ul><li>bindæ–¹æ³•ç”¨äºå°†å‡½æ•°ä½“å†…çš„thisç»‘å®šåˆ°æŸä¸ªå¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°</li><li>bindæ–¹æ³•æ¯æ¬¡éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°å‡½æ•°</li></ul></li></ul><pre><code>// ä¸Šé¢ä»£ç ä¸­ï¼Œbindæ–¹æ³•å°†getTimeæ–¹æ³•å†…éƒ¨çš„thisç»‘å®šåˆ°då¯¹è±¡ï¼Œè¿™æ—¶å°±å¯ä»¥å®‰å…¨åœ°å°†è¿™ä¸ªæ–¹æ³•èµ‹å€¼ç»™å…¶ä»–å˜é‡äº†ã€‚var d = new Date();d.getTime() // 1481869925657var print = d.getTime;print() // Uncaught TypeError: this is not a Date object.var print = d.getTime.bind(d);print() // 1481869925657</code></pre><h2 id="1-3-å¯¹è±¡çš„ç»§æ‰¿"><a href="#1-3-å¯¹è±¡çš„ç»§æ‰¿" class="headerlink" title="1.3 å¯¹è±¡çš„ç»§æ‰¿"></a>1.3 å¯¹è±¡çš„ç»§æ‰¿</h2><p>Aå¯¹è±¡é€šè¿‡ç»§æ‰¿Bå¯¹è±¡ï¼Œå°±èƒ½ç›´æ¥æ‹¥æœ‰Bå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œè¿™å¯¹äºä»£ç çš„å¤ç”¨å¾ˆæœ‰å¸®åŠ©ã€‚JavaScripté€šè¿‡åŸå‹å¯¹è±¡(prototype)æ¥å®ç°ç»§æ‰¿å…³ç³»ã€‚</p><p>æ³¨æ„ES6å½“ä¸­å¼•å…¥äº†classè¯­æ³•ï¼Œå¯ä»¥åšåŸºäºclassçš„ç»§æ‰¿äº†</p><h3 id="1-3-1-åŸå‹å¯¹è±¡æ¦‚è¿°"><a href="#1-3-1-åŸå‹å¯¹è±¡æ¦‚è¿°" class="headerlink" title="1.3.1 åŸå‹å¯¹è±¡æ¦‚è¿°"></a>1.3.1 åŸå‹å¯¹è±¡æ¦‚è¿°</h3><ul><li><p>æ„é€ å‡½æ•°</p><ul><li><p>JSé€šè¿‡æ„é€ å‡½æ•°ç”Ÿæˆæ–°å¯¹è±¡ï¼Œå› æ­¤æ„é€ å‡½æ•°å¯ä»¥è§†ä¸ºå¯¹è±¡çš„æ¨¡æ¿</p></li><li><p>å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°çš„å†…éƒ¨</p></li><li><p>å±æ€§å®é™…ä¸Šæ˜¯å®šä¹‰åœ¨äº†å®ä¾‹å¯¹è±¡ä¸Šçš„ï¼Œä½†æ˜¯åŒä¸€ä¸ªæ„é€ å‡½æ•°çš„å¤šä¸ªå®ä¾‹ä¹‹é—´ï¼Œæ— æ³•å…±äº«å±æ€§ï¼Œä»è€Œé€ æˆäº†èµ„æºçš„æµªè´¹</p></li><li><p>JavaScriptä½¿ç”¨åŸå‹å¯¹è±¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜  â€“ prototype </p><ul><li>å…¶ä½œç”¨å°±æ˜¯å®šä¹‰æ‰€æœ‰å®ä¾‹å¯¹è±¡å…±äº«çš„å±æ€§å’Œæ–¹æ³• </li></ul><p>function Cat (name, color) {<br>this.name = name;<br>this.color = color;<br>}</p><p>var cat1 = new Cat(â€˜å¤§æ¯›â€™, â€˜ç™½è‰²â€™);</p><p>cat1.name // â€˜å¤§æ¯›â€™<br>cat1.color // â€˜ç™½è‰²â€™</p></li></ul></li><li><p>prototypeå±æ€§çš„ä½œç”¨</p><ul><li>åŸå‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½èƒ½è¢«å®ä¾‹å¯¹è±¡å…±äº«</li><li>å¦‚æœå±æ€§å’Œæ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Šï¼Œé‚£ä¹ˆæ‰€æœ‰å®ä¾‹å¯¹è±¡éƒ½èƒ½å…±äº«<ul><li>èŠ‚çœå†…å­˜</li><li>ä½“ç°å®ä¾‹å¯¹è±¡ä¹‹é—´çš„è”ç³»</li></ul></li><li>åŸå‹å¯¹è±¡çš„å±æ€§ä¸æ˜¯å®ä¾‹å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œåªè¦ä¿®æ”¹åŸå‹å¯¹è±¡ï¼Œå˜åŠ¨å°±ç«‹åˆ»ä¼šä½“ç°åœ¨æ‰€æœ‰å®ä¾‹å¯¹è±¡ä¸Š</li><li>å½“å®ä¾‹å¯¹è±¡æ²¡æœ‰æŸä¸ªå±æ€§æˆ–è€…æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¸åŸå‹å¯¹è±¡ä¸Šå»æ‰¾ï¼Œå¦‚æœæœ‰ï¼Œå°±ç”¨è‡ªå·±çš„</li></ul></li></ul><pre><code>function Animal(name) {  this.name = name;}Animal.prototype.color = &#39;white&#39;;var cat1 = new Animal(&#39;å¤§æ¯›&#39;);var cat2 = new Animal(&#39;äºŒæ¯›&#39;);cat1.color // &#39;white&#39;cat2.color // &#39;white&#39;cat1.color = &#39;black&#39;;cat1.color // &#39;black&#39;</code></pre><ul><li>åŸå‹é“¾<ul><li>JSè§„å®šæ‰€æœ‰å¯¹è±¡éƒ½æœ‰è‡ªå·±çš„åŸå‹å¯¹è±¡(prototype)</li><li>ä¸€å±‚å±‚å›æº¯ï¼Œæ‰€æœ‰å¯¹è±¡çš„åŸå‹æœ€ç»ˆä¸Šæº¯åˆ°Object.prototype,å³Objectæ„é€ å‡½æ•°çš„prototypeå±æ€§</li><li>è€ŒObject.prototypeçš„åŸå‹æ˜¯null</li><li>è¯»å–å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼Œå…ˆå¯»æ‰¾å¯¹è±¡æœ¬èº«çš„å±æ€§ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±å»åŸå‹æ‰¾ï¼Œå¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œå°±å»åŸå‹çš„åŸå‹ï¼Œä¸€å±‚å±‚æº¯æºã€‚ä¸€ç›´æ²¡æœ‰å°±è¿”å›undefined</li><li>å¦‚æœå¯¹è±¡è‡ªèº«å’Œå®ƒçš„åŸå‹<strong>éƒ½å®šä¹‰äº†åŒåå±æ€§ï¼Œé‚£ä¹ˆä¼˜å…ˆè¯»å–å¯¹è±¡è‡ªèº«çš„å±æ€§</strong>ï¼Œ â€“ overriding </li></ul></li></ul><pre><code>var MyArray = function () {};MyArray.prototype = new Array();MyArray.prototype.constructor = MyArray;// mineæ˜¯MyArrayçš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œç”±äºMyArray.protutypeæŒ‡å‘ä¸€ä¸ªæ•°ç»„å®ä¾‹ï¼Œä½¿å¾—mineå¯ä»¥è°ƒç”¨æ•°ç»„æ–¹æ³•var mine = new MyArray();mine.push(1, 2, 3);mine.length // 3mine instanceof Array // true</code></pre><ul><li><p>constructorå±æ€§</p><ul><li>prototypeå¯¹è±¡çš„constructorå±æ€§ï¼Œé»˜è®¤æŒ‡å‘prototypeå¯¹è±¡æ‰€åœ¨çš„æ„é€ å‡½æ•°</li><li>constructorå±æ€§çš„ä½œç”¨æ˜¯å¯ä»¥å¾—çŸ¥æŸä¸ªæ˜¯åŠ›åº¦å‘ï¼Œåˆ°åº•æ˜¯å“ªä¸€ä¸ªæ„é€ å‡½æ•°äº§ç”Ÿçš„</li></ul></li><li><p>instanceofè¿ç®—ç¬¦</p><ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å¦ä¸ºæŸä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ </li></ul></li><li><p>æ„é€ å‡½æ•°çš„ç»§æ‰¿</p><ul><li>è®©ä¸€ä¸ªæ„é€ å‡½æ•°ç»§æ‰¿å¦ä¸€ä¸ªæ„é€ å‡½æ•°<ul><li>åœ¨å­ç±»çš„æ„é€ å‡½æ•°å½“ä¸­ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</li><li>è®©å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»çš„åŸå‹ï¼Œä½¿å¾—å­ç±»ç»§æ‰¿çˆ¶ç±»çš„åŸå‹</li></ul></li></ul></li></ul><pre><code>// Subæ˜¯æ„é€ å‡½æ•°ï¼Œthisæ˜¯å­ç±»çš„å®ä¾‹// å­ç±»ä¸Šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°superï¼Œä½¿å¾—å­ç±»å®ä¾‹å…·æœ‰çˆ¶ç±»å®ä¾‹çš„å±æ€§function Sub(value) {  Super.call(this);  this.prop = value;}// è®©å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»çš„åŸå‹ï¼Œä½¿å¾—å­ç±»ç»§æ‰¿çˆ¶ç±»çš„åŸå‹// ä½¿ç”¨Object.createæ˜¯ä¸ºäº†ä¸å¯¹çˆ¶ç±»åŸå‹é€ æˆä¿®æ”¹Sub.prototype = Object.create(Super.prototype);Sub.prototype.constructor = Sub;Sub.prototype.method = &#39;...&#39;;</code></pre><p>ä¸€ä¸ªç»§æ‰¿çš„å®ä¾‹:</p><pre><code>function Shape() {  this.x = 0;  this.y = 0;}Shape.prototype.move = function (x, y) {  this.x += x;  this.y += y;  console.info(&#39;Shape moved.&#39;);};// ç¬¬ä¸€æ­¥ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹function Rectangle() {  Shape.call(this); // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°}// å¦ä¸€ç§å†™æ³•function Rectangle() {  this.base = Shape;  this.base();}// ç¬¬äºŒæ­¥ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»çš„åŸå‹Rectangle.prototype = Object.create(Shape.prototype);Rectangle.prototype.constructor = Rectangle;</code></pre><h2 id="1-4-Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•"><a href="#1-4-Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•" class="headerlink" title="1.4 Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•"></a>1.4 Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•</h2><ul><li>Object.getPrototypeOf()<ul><li>è¿”å›å‚æ•°å¯¹è±¡çš„åŸå‹</li></ul></li></ul><pre><code>// ç©ºå¯¹è±¡çš„åŸå‹æ˜¯ Object.prototypeObject.getPrototypeOf({}) === Object.prototype // true// Object.prototype çš„åŸå‹æ˜¯ nullObject.getPrototypeOf(Object.prototype) === null // true// å‡½æ•°çš„åŸå‹æ˜¯ Function.prototypefunction f() {}Object.getPrototypeOf(f) === Function.prototype // true</code></pre><ul><li>Object.setPrototypeOf() <ul><li>ä¸ºå‚æ•°å¯¹è±¡è®¾ç½®åŸå‹ï¼Œè¿”å›è¯¥å‚æ•°çš„å¯¹è±¡</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç°æœ‰å¯¹è±¡ï¼Œç¬¬äºŒä¸ªä¸ºåŸå‹å¯¹è±¡</li></ul></li></ul><pre><code>var a = {};var b = {x: 1};Object.setPrototypeOf(a, b);Object.getPrototypeOf(a) === b // truea.x // 1</code></pre><ul><li>Object.create()<ul><li>æ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åä»¥å®ƒä¸ºåŸå‹ï¼Œè¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚è¯¥å®ä¾‹å®Œå…¨ç»§æ‰¿åŸå‹å¯¹è±¡çš„å±æ€§</li></ul></li><li>Object.prototype.<strong>proto</strong><ul><li>å®ä¾‹å¯¹è±¡çš„è¯¥å±æ€§ï¼Œè¿”å›è¯¥å¯¹è±¡çš„åŸå‹ </li></ul></li></ul><h2 id="1-5-ä¸¥æ ¼æ¨¡å¼"><a href="#1-5-ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="1.5 ä¸¥æ ¼æ¨¡å¼"></a>1.5 ä¸¥æ ¼æ¨¡å¼</h2><p>è¯¥ç§æ¨¡å¼é‡‡ç”¨æ›´åŠ ä¸¥æ ¼çš„JavaScriptè¯­æ³•</p><ul><li>æ˜ç¡®æœºåˆ¶ä¸åˆç†ï¼Œä¸ä¸¥è°¨çš„è¯­æ³•</li><li>å¢åŠ æ›´å¤šçš„æŠ¥é”™åœºåˆï¼Œæ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç çš„è¿è¡Œå®‰å…¨</li><li>æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦</li></ul><p>å¼€å¯çš„è¯ï¼Œä½¿ç”¨<code>use strict</code></p><ul><li>use strictæ”¾åœ¨è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œæ•´ä¸ªè„šæœ¬éƒ½å°†ä»¥ä¸¥æ ¼æ¨¡å¼æ¥è¿è¡Œï¼Œå¦‚æœä¸åœ¨ç¬¬ä¸€è¡Œå°±æ— æ•ˆï¼Œä¼šä»¥æ­£å¸¸æ¨¡å¼è¿è¡Œ</li><li>æ˜¾å¼æŠ¥é”™<ul><li>åªè¯»å±æ€§ä¸å¯å†™</li><li>åªè®¾ç½®äº†getterçš„ä¸å¯å†™</li></ul></li><li>å®‰å…¨æªæ–½<ul><li>å…¨å±€å˜é‡æ˜¾å¼å£°æ˜</li><li>ç¦æ­¢thiså…³é”®å­—æŒ‡å‘å…¨å±€å¯¹è±¡</li></ul></li></ul><h1 id="2-å¼‚æ­¥æ“ä½œ"><a href="#2-å¼‚æ­¥æ“ä½œ" class="headerlink" title="2. å¼‚æ­¥æ“ä½œ"></a>2. å¼‚æ­¥æ“ä½œ</h1><h2 id="2-1-General"><a href="#2-1-General" class="headerlink" title="2.1 General"></a>2.1 General</h2><h3 id="2-1-1-å•çº¿ç¨‹æ¨¡å‹"><a href="#2-1-1-å•çº¿ç¨‹æ¨¡å‹" class="headerlink" title="2.1.1 å•çº¿ç¨‹æ¨¡å‹"></a>2.1.1 å•çº¿ç¨‹æ¨¡å‹</h3><p>JSåªåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œçš„  å•ä¸ªè„šæœ¬åªèƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œï¼Œå…¶ä»–çº¿ç¨‹éƒ½æ˜¯åœ¨åå°é…åˆçš„</p><p>å¥½åƒæ‰§è¡Œç®€å•ï¼Œåå¤„å°±æ˜¯æ…¢ï¼Œåªè¦ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œé‚£ä¹ˆåé¢çš„ä»»åŠ¡å°±éƒ½éœ€è¦æ’é˜Ÿç­‰ç€ï¼Œä¼šæ‹–å»¶æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œã€‚</p><p>JSæœ¬èº«ä¸æ…¢ï¼Œæ…¢çš„æ˜¯è¯»å†™å¤–éƒ¨æ•°æ®ï¼Œç­‰å¾…Ajaxè¯·æ±‚è¿”å›ç»“æœã€‚è¿™ä¸ªæ—¶å€™å¦‚æœå¯¹æ–¹æœåŠ¡å™¨ä¸€ç›´æ²¡æœ‰ååº”ï¼Œæˆ–è€…ç½‘ç»œä¸é€šç•…ï¼Œå°±ä¼šå¯¼è‡´è„šæœ¬çš„é•¿æ—¶é—´åœæ»ã€‚</p><p>å› ä¸ºå¾ˆå¤šæ—¶å€™æ…¢åœ¨IOæ“ä½œï¼Œè€ŒCPUå®é™…ä¸Šæ˜¯å¤„äºé—²ç½®çŠ¶æ€çš„ï¼Œå› æ­¤CPUè¿™ä¸ªæ—¶å€™å®Œå…¨å¯ä»¥ä¸ç®¡IOæ“ä½œï¼ŒæŒ‚èµ·å¤„äºç­‰å¾…ä¸­çš„ä»»åŠ¡ï¼Œå…ˆè¿è¡Œæ’åœ¨åé¢çš„ä»»åŠ¡ï¼Œç­‰åˆ°IOæ“ä½œè¿”å›ç»“æœï¼Œå†å›å¤´å°†æŒ‚èµ·çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œä¸‹å»</p><h3 id="2-1-2-åŒæ­¥ä»»åŠ¡ä¸å¼‚æ­¥ä»»åŠ¡"><a href="#2-1-2-åŒæ­¥ä»»åŠ¡ä¸å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="2.1.2 åŒæ­¥ä»»åŠ¡ä¸å¼‚æ­¥ä»»åŠ¡"></a>2.1.2 åŒæ­¥ä»»åŠ¡ä¸å¼‚æ­¥ä»»åŠ¡</h3><ul><li>åŒæ­¥ä»»åŠ¡<ul><li>æ²¡æœ‰è¢«å¼•æ“æŒ‚èµ·ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸Šæ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡</li><li>åªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œåä¸€ä¸ªä»»åŠ¡æ‰èƒ½å¼€å§‹æ‰§è¡Œ</li></ul></li><li>å¼‚æ­¥ä»»åŠ¡<ul><li>è¢«å¼•æ“æ”¾åœ¨ä¸€è¾¹ï¼Œä¸è¿›å…¥ä¸»çº¿ç¨‹ï¼Œè€Œè¿›å…¥ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡</li><li>åªæœ‰å¼•æ“è®¤ä¸ºæŸä¸ªå¼‚æ­¥ä»»åŠ¡å¯ä»¥æ‰§è¡Œäº†ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œ</li><li>æ’åœ¨å¼‚æ­¥ä»»åŠ¡åé¢çš„ä»£ç ã€‚ä¸ç”¨ç­‰å¾…å¼‚æ­¥ä»»åŠ¡ç»“æŸä¼šé©¬ä¸Šè¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¼‚æ­¥ä»»åŠ¡ä¸å…·æœ‰å µå¡æ•ˆåº”</li></ul></li></ul><h3 id="2-1-3-ä»»åŠ¡é˜Ÿåˆ—å’Œäº‹ä»¶å¾ªç¯"><a href="#2-1-3-ä»»åŠ¡é˜Ÿåˆ—å’Œäº‹ä»¶å¾ªç¯" class="headerlink" title="2.1.3 ä»»åŠ¡é˜Ÿåˆ—å’Œäº‹ä»¶å¾ªç¯"></a>2.1.3 ä»»åŠ¡é˜Ÿåˆ—å’Œäº‹ä»¶å¾ªç¯</h3><ul><li>ä»»åŠ¡é˜Ÿåˆ—<ul><li>å­˜å‚¨éœ€è¦å½“å‰ç¨‹åºå¤„ç†çš„å¼‚æ­¥ä»»åŠ¡</li><li>ä¸»çº¿ç¨‹ä¼šæ‰§è¡Œæ‰€æœ‰çš„åŒæ­¥ä»»åŠ¡ï¼Œç­‰åˆ°åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œä»¥åï¼Œå°±ä¼šå»çœ‹ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢çš„å¼‚æ­¥ä»»åŠ¡</li><li>å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå¼‚æ­¥ä»»åŠ¡å°±é‡æ–°è¿›å…¥ä¸»çº¿ç¨‹è¿›è¡Œæ‰§è¡Œï¼Œæ­¤æ—¶å˜æˆäº†åŒæ­¥ä»»åŠ¡äº†</li><li>å¼‚æ­¥ä»»åŠ¡çš„å†™æ³•å³å›è°ƒå‡½æ•°</li></ul></li><li>äº‹ä»¶å¾ªç¯<ul><li>ä¸»çº¿ç¨‹æ¥çœ‹å¼‚æ­¥ä»»åŠ¡æ˜¯å¦æœ‰ç»“æœçš„æ–¹å¼</li><li>å°±æ˜¯ä¸æ–­æ£€æŸ¥ï¼Œå»çœ‹æŒ‚èµ·æ¥çš„ä»»åŠ¡ä»¬æœ‰æ²¡æœ‰ç»“æœäº†</li></ul></li></ul><h1 id="2-1-4-å¼‚æ­¥æ“ä½œçš„æ¨¡å¼"><a href="#2-1-4-å¼‚æ­¥æ“ä½œçš„æ¨¡å¼" class="headerlink" title="2.1.4 å¼‚æ­¥æ“ä½œçš„æ¨¡å¼"></a>2.1.4 å¼‚æ­¥æ“ä½œçš„æ¨¡å¼</h1><ul><li>å›è°ƒå‡½æ•°</li></ul><pre><code>function f1(callback) {  // ...  callback();}function f2() {  // ...}f1(f2);</code></pre><ul><li>äº‹ä»¶ç›‘å¬<ul><li>å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œä¸å–å†³äºä»£ç çš„é¡ºåºï¼Œè€Œå–å†³äºæŸä¸ªäº‹ä»¶æ˜¯å¦å‘ç”Ÿ</li></ul></li></ul><pre><code>f1.on(&#39;done&#39;, f2);function f1() {  setTimeout(function () {    // ...    f1.trigger(&#39;done&#39;);  }, 1000);}</code></pre><ul><li>å‘å¸ƒè®¢é˜…<ul><li>æŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå‘ä¿¡å·ä¸­å¿ƒå‘å¸ƒä¸€ä¸ªä¿¡å·</li><li>å…¶ä»–ä»»åŠ¡å‘ä¿¡å·ä¸­å¿ƒè®¢é˜…è¿™ä¸ªä¿¡å·ï¼Œæ¥çŸ¥é“ä»€ä¹ˆæ—¶å€™è‡ªå·±å¯ä»¥å¼€å§‹æ‰§è¡Œ</li></ul></li></ul><pre><code>jQuery.subscribe(&#39;done&#39;, f2);function f1() {  setTimeout(function () {    // ...    jQuery.publish(&#39;done&#39;);  }, 1000);}</code></pre><h3 id="2-1-5-å¼‚æ­¥æ“ä½œçš„æµç¨‹æ§åˆ¶"><a href="#2-1-5-å¼‚æ­¥æ“ä½œçš„æµç¨‹æ§åˆ¶" class="headerlink" title="2.1.5 å¼‚æ­¥æ“ä½œçš„æµç¨‹æ§åˆ¶"></a>2.1.5 å¼‚æ­¥æ“ä½œçš„æµç¨‹æ§åˆ¶</h3><ul><li>ä¸²è¡Œæ‰§è¡Œ</li></ul><pre><code>var items = [ 1, 2, 3, 4, 5, 6 ];var results = [];function async(arg, callback) {  console.log(&#39;å‚æ•°ä¸º &#39; + arg +&#39; , 1ç§’åè¿”å›ç»“æœ&#39;);  setTimeout(function () { callback(arg * 2); }, 1000);}function final(value) {  console.log(&#39;å®Œæˆ: &#39;, value);}function series(item) {  if(item) {    async( item, function(result) {      results.push(result);      return series(items.shift());    });  } else {    return final(results[results.length - 1]);  }}series(items.shift());</code></pre><ul><li>å¹¶è¡Œæ‰§è¡Œ<ul><li>å¹¶è¡Œä¼šå¿«ï¼Œä½†æ˜¯å¦‚æœå¹¶è¡Œä»»åŠ¡å¤ªå¤šï¼Œå¾ˆå®¹æ˜“è€—å°½ç³»ç»Ÿçš„èµ„æºï¼Œæ‹–æ…¢è¿è¡Œé€Ÿåº¦ </li></ul></li></ul><pre><code>var items = [ 1, 2, 3, 4, 5, 6 ];var results = [];function async(arg, callback) {  console.log(&#39;å‚æ•°ä¸º &#39; + arg +&#39; , 1ç§’åè¿”å›ç»“æœ&#39;);  setTimeout(function () { callback(arg * 2); }, 1000);}function final(value) {  console.log(&#39;å®Œæˆ: &#39;, value);}items.forEach(function(item) {  async(item, function(result){    results.push(result);    if(results.length === items.length) {      final(results[results.length - 1]);    }  })});</code></pre><ul><li>å¹¶è¡Œä¸ä¸²è¡Œç›¸ç»“åˆ!!!!!<ul><li>è®¾ç½®ä¸€ä¸ªé—¨æ§›ï¼Œæ¯æ¬¡æœ€å¤šåªèƒ½å¹¶è¡Œæ‰§è¡Œnä¸ªå¼‚æ­¥ä»»åŠ¡</li></ul></li></ul><pre><code>var items = [ 1, 2, 3, 4, 5, 6 ];var results = [];var running = 0;var limit = 2;function async(arg, callback) {  console.log(&#39;å‚æ•°ä¸º &#39; + arg +&#39; , 1ç§’åè¿”å›ç»“æœ&#39;);  setTimeout(function () { callback(arg * 2); }, 1000);}function final(value) {  console.log(&#39;å®Œæˆ: &#39;, value);}function launcher() {  while(running &lt; limit &amp;&amp; items.length &gt; 0) {    var item = items.shift();    async(item, function(result) {      results.push(result);      running--;      if(items.length &gt; 0) {        launcher();      } else if(running == 0) {        final(results);      }    });    running++;  }}launcher();</code></pre><h2 id="2-2-å®šæ—¶å™¨"><a href="#2-2-å®šæ—¶å™¨" class="headerlink" title="2.2 å®šæ—¶å™¨"></a>2.2 å®šæ—¶å™¨</h2><p>JSæä¾›å®šæ—¶æ‰§è¡Œä»£ç çš„åŠŸèƒ½ï¼Œç”±setTimeout()ä»¥åŠsetInterval()ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆï¼Œå®ƒä»¬å¯ä»¥å‘ä»»åŠ¡é˜Ÿåˆ—æ·»åŠ å®šæ—¶ä»»åŠ¡ã€‚</p><ul><li>setTimeout()<ul><li>æŒ‡å®šæŸä¸ªå‡½æ•°æˆ–è€…æŸæ®µä»£ç ï¼Œåœ¨å¤šå°‘æ¯«ç§’ä¹‹åæ‰§è¡Œ</li><li>è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®šæ—¶å™¨çš„ç¼–å·</li><li><code>var timerId = setTimeout(func|code, delay)</code></li></ul></li></ul><pre><code>// 1,1æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°setTimeout(function (a,b) {  console.log(a + b);}, 1000, 1, 1);</code></pre><ul><li>setInterval()<ul><li>setIntervalæ˜¯è®¾ç½®æŸä¸ªä»»åŠ¡æ¯éš”ä¸€æ®µæ—¶é—´å°±æ‰§è¡Œä¸€æ¬¡ï¼Œä¸ºæ— é™æ¬¡çš„æ‰§è¡Œçš„</li><li>æŒ‡å®šçš„æ˜¯å¼€å§‹æ‰§è¡Œä¹‹é—´çš„é—´éš”ï¼Œæ²¡æœ‰è€ƒè™‘æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œæœ¬èº«æ‰€æ¶ˆè€—çš„æ—¶é—´</li><li>ä¸ºäº†ç¡®å®šä¸¤æ¬¡æ‰§è¡Œä¹‹é—´çš„å›ºå®šé—´éš”ï¼Œå¯ä»¥ä½¿ç”¨setTimeoutæ¥æŒ‡å®šä¸‹ä¸€æ¬¡æ‰§è¡Œçš„å…·ä½“æ—¶é—´</li></ul></li></ul><pre><code>var i = 1;var timer = setTimeout(function f() {  // ...  timer = setTimeout(f, 2000);}, 2000);</code></pre><ul><li>clearTimeout() clearInterval()<ul><li>ä¼ å…¥å¯¹åº”çš„è®¡æ•°å™¨ç¼–å·ï¼Œå°±å¯ä»¥å–æ¶ˆå¯¹åº”çš„å®šæ—¶å™¨äº†</li></ul></li></ul><h3 id="2-2-1-Debounce-å‡½æ•°"><a href="#2-2-1-Debounce-å‡½æ•°" class="headerlink" title="2.2.1 Debounce å‡½æ•°"></a>2.2.1 Debounce å‡½æ•°</h3><p>æƒ³è¦è§£å†³çš„é—®é¢˜ï¼šä¸å¸Œæœ›å›è°ƒå‡½æ•°è¢«é¢‘ç¹è°ƒç”¨ï¼Œå³å½“ç”¨æˆ·å¡«å…¥ç½‘é¡µè¾“å…¥æ¡†çš„å†…å®¹ä»¥åï¼Œç”¨æˆ·ä¼šç‚¹å‡»buttonå¸Œæœ›èƒ½ä¼ å›æ•°æ®ï¼Œä½†æ˜¯å¾ˆæœ‰å¯èƒ½æ˜¯åœ¨å¤šæ¬¡é‡å¤ç›¸åŒçš„ä¿¡æ¯çš„ã€‚</p><p>å› æ­¤æˆ‘ä»¬åº”è¯¥åŠ ä¸€ä¸ªé—¨æ§›ï¼Œè¡¨ç¤ºä¸¤æ¬¡Ajaxé€šä¿¡çš„æœ€å°é—´éš”æ—¶é—´ã€‚å¦‚æœåœ¨é—´éš”æ—¶é—´å†…å‘ç”Ÿäº†æ–°çš„keydownæ—¶é—´ï¼Œå°±ä¸è§¦å‘Ajaxé€šä¿¡ï¼Œå¹¶ä¸”å¼€å§‹é‡æ–°è®¡æ—¶ã€‚å¦‚æœè¿‡äº†æŒ‡å®šæ—¶é—´ï¼Œæ²¡æœ‰å‘ç”Ÿæ–°çš„keydownäº‹ä»¶ï¼Œå†å°†æ•°æ®å‘é€å‡ºå»ã€‚</p><pre><code>// åœ¨2.5ç§’å†…ï¼Œå½“ç”¨æˆ·å†æ¬¡æ•²å‡»çš„æ—¶å€™ï¼Œä¼šå–æ¶ˆä¸Šæ¬¡å®šæ—¶å™¨ï¼Œç„¶åå†æ–°å»ºä¸€ä¸ªå®šæ—¶å™¨$(&#39;textarea&#39;).on(&#39;keydown&#39;, debounce(ajaxAction, 2500));function debounce(fn, delay){  var timer = null; // å£°æ˜è®¡æ—¶å™¨  return function() {    var context = this;    var args = arguments;    clearTimeout(timer);    timer = setTimeout(function () {      fn.apply(context, args);    }, delay);  };}</code></pre><h3 id="2-2-2-è¿è¡Œæœºåˆ¶"><a href="#2-2-2-è¿è¡Œæœºåˆ¶" class="headerlink" title="2.2.2 è¿è¡Œæœºåˆ¶"></a>2.2.2 è¿è¡Œæœºåˆ¶</h3><p>setTimeoutå’ŒsetIntervaléƒ½æ˜¯å°†æŒ‡å®šçš„ä»£ç ç§»å‡ºæœ¬è½®äº‹ä»¶å¾ªç¯ï¼Œç­‰åˆ°ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯ï¼Œå†æ£€æŸ¥æ—¶é—´æ˜¯å¦åˆ°äº†æŒ‡å®šçš„æ—¶é—´ã€‚å¦‚æœåˆ°äº†ï¼Œå°±æ‰§è¡Œå¯¹åº”çš„ä»£ç ï¼Œå¦‚æœä¸åˆ°ï¼Œå°±ç»§ç»­ç­‰å¾…ã€‚</p><p>è¿™æ„å‘³ç€ï¼ŒsetTimeout å’Œ setIntervalæŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¿…é¡»ç­‰åˆ°<strong>æœ¬è½®äº‹ä»¶å¾ªç¯</strong>çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œ. ç”±äºå‰é¢çš„ä»»åŠ¡åˆ°åº•éœ€è¦å¤šå°‘æ—¶é—´æ‰§è¡Œå®Œï¼Œæ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯æ— æ³•ä¿è¯äºŒè€…æŒ‡å®šçš„ä»»åŠ¡ä¸€å®šä¼šæŒ‰ç…§é¢„å®šæ—¶é—´æ‰§è¡Œ</p><pre><code>setInterval(function () {  console.log(2);}, 1000);sleep(3000);function sleep(ms) {  var start = Date.now();  while ((Date.now() - start) &lt; ms) {  }}</code></pre><p>ä¸Šé¢ä¾‹å­ä¼šå…ˆsleep 3ç§’ç„¶åæ‰ä¼šè¾“å‡º2ï¼Œæ³¨æ„æ˜¯ä¸ç´¯è®¡çš„ï¼Œå³åªè¾“å‡ºä¸€ä¸ª2çš„</p><h3 id="2-2-3-setTimeout-f-0-åŠå…¶åº”ç”¨"><a href="#2-2-3-setTimeout-f-0-åŠå…¶åº”ç”¨" class="headerlink" title="2.2.3 setTimeout(f,0) åŠå…¶åº”ç”¨"></a>2.2.3 setTimeout(f,0) åŠå…¶åº”ç”¨</h3><p>setTimeout(f,0)ä¹Ÿä¸ä¼šç›´æ¥æ‰§è¡Œçš„ï¼Œå› ä¸ºå®ƒå¿…é¡»è¦ç­‰å¾…å½“å‰è„šæœ¬çš„åŒæ­¥ä»»åŠ¡å…¨éƒ¨å¤„ç†å®Œä»¥åï¼Œæ‰ä¼šæ‰§è¡ŒsetTimeoutæŒ‡å®šçš„å›è°ƒå‡½æ•°fï¼Œå³setTimeout(f,0)ä¼šåœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯å¼€å§‹çš„æ—¶å€™æ‰§è¡Œ</p><pre><code>setTimeout(function () {  console.log(1);}, 0);console.log(2);// 2// 1</code></pre><p><strong>setTimeoutçš„åº”ç”¨</strong></p><ul><li>è°ƒæ•´äº‹ä»¶çš„å‘ç”Ÿé¡ºåº</li><li>è°ƒæ•´ç”¨æˆ·è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•°å’Œæµè§ˆå™¨é»˜è®¤åŠ¨ä½œä¹‹é—´çš„æ‰§è¡Œé¡ºåº</li><li>setTimeout(f,0)æ„å‘³ç€å°†ä»»åŠ¡æ”¾åˆ°æµè§ˆå™¨æœ€æ—©å¯å¾—çš„ç©ºé—²æ—¶æ®µæ‰§è¡Œï¼Œæ‰€ä»¥é‚£äº›è®¡ç®—é‡å¤§ï¼Œè€—æ—¶é•¿çš„ä»»åŠ¡é€šå¸¸å¯ä»¥åˆ†æˆå‡ ä¸ªå°éƒ¨åˆ†åˆ†åˆ«æ–¹æ³•è¿™ä¸ªæ–¹æ³•å½“ä¸­å»</li></ul><pre><code>// HTML ä»£ç å¦‚ä¸‹// &lt;input type=&quot;button&quot; id=&quot;myButton&quot; value=&quot;click&quot;&gt;var input = document.getElementById(&#39;myButton&#39;);input.onclick = function A() {  setTimeout(function B() {    input.value +=&#39; input&#39;;  }, 0)};document.body.onclick = function C() {  input.value += &#39; body&#39;};// HTML ä»£ç å¦‚ä¸‹// &lt;input type=&quot;text&quot; id=&quot;input-box&quot;&gt;document.getElementById(&#39;input-box&#39;).onkeypress = function (event) {  this.value = this.value.toUpperCase();}document.getElementById(&#39;input-box&#39;).onkeypress = function() {  var self = this;  setTimeout(function() {    self.value = self.value.toUpperCase();  }, 0);}var div = document.getElementsByTagName(&#39;div&#39;)[0];// å†™æ³•ä¸€for (var i = 0xA00000; i &lt; 0xFFFFFF; i++) {  div.style.backgroundColor = &#39;#&#39; + i.toString(16);}// å†™æ³•äºŒvar timer;var i=0x100000;function func() {  timer = setTimeout(func, 0);  div.style.backgroundColor = &#39;#&#39; + i.toString(16);  if (i++ == 0xFFFFFF) clearTimeout(timer);}timer = setTimeout(func, 0);</code></pre><h2 id="2-3-Promiseå¯¹è±¡"><a href="#2-3-Promiseå¯¹è±¡" class="headerlink" title="2.3 Promiseå¯¹è±¡"></a>2.3 Promiseå¯¹è±¡</h2><p>JSçš„å¼‚æ­¥æ“ä½œè§£å†³æ–¹æ¡ˆï¼Œä¸ºå¼‚æ­¥æ“ä½œæä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œèµ·åˆ°ä»£ç†çš„ä½œç”¨ï¼Œå……å½“å¼‚æ­¥æ“ä½œä¸å›è°ƒå‡½æ•°ä¹‹é—´çš„ä¸­ä»‹ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œå…·å¤‡åŒæ­¥æ“ä½œçš„æ¥å£ã€‚Promiseå¯ä»¥è®©å¼‚æ­¥æ“ä½œå†™æ³•å’Œå†™åŒæ­¥æ“ä½œç›¸ä¼¼ï¼Œä¸å¿…ä¸€å±‚å±‚åœ°åµŒå¥—å›è°ƒå‡½æ•°</p><pre><code>function f1(resolve, reject) {    // å¼‚æ­¥ä»£ç }var p1 = new Promise(f1);</code></pre><p>ä¸Šè¿°ä¾‹å­å½“ä¸­æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°f1ä½œä¸ºå‚æ•°ï¼Œf1é‡Œé¢æ˜¯å¼‚æ­¥æ“ä½œçš„ä»£ç ï¼Œç„¶åè¿”å›p1ä¸ºä¸€ä¸ªPromiseå®ä¾‹ã€‚</p><p>æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡éƒ½è¿”å›ä¸€ä¸ªPromiseå®ä¾‹ï¼Œç„¶åé€šè¿‡è‡ªå¸¦çš„thenæ–¹æ³•ï¼Œæ¥æŒ‡å®šä¸‹ä¸€æ­¥çš„å›è°ƒå‡½æ•°ã€‚é€šè¿‡thençš„å†™æ³•ï¼Œæ¥å‡å°‘å‡½æ•°å’Œå‡½æ•°ä¹‹é—´çš„åµŒå¥—çš„å†™æ³•ã€‚</p><h3 id="2-3-1-Promiseå¯¹è±¡çš„çŠ¶æ€"><a href="#2-3-1-Promiseå¯¹è±¡çš„çŠ¶æ€" class="headerlink" title="2.3.1 Promiseå¯¹è±¡çš„çŠ¶æ€"></a>2.3.1 Promiseå¯¹è±¡çš„çŠ¶æ€</h3><ul><li>å¼‚æ­¥æ“ä½œæœªå®Œæˆ - pending</li><li>resolved<ul><li>å¼‚æ­¥æ“ä½œæˆåŠŸ - fulfilled</li><li>å¼‚æ­¥æ“ä½œå¤±è´¥ - rejected</li></ul></li></ul><p>ä¸€æ—¦çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¸ä¼šå†æœ‰æ–°çš„çŠ¶æ€å˜åŒ–äº†ï¼Œå³Promiseçš„å®ä¾‹çš„çŠ¶æ€å˜åŒ–åªå¯èƒ½å‘ç”Ÿä¸€æ¬¡</p><p>PromiseåŸç”Ÿæ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºresolveè¿˜æœ‰rejectã€‚</p><h3 id="2-3-2-Promise-prototype-then"><a href="#2-3-2-Promise-prototype-then" class="headerlink" title="2.3.2 Promise.prototype.then()"></a>2.3.2 Promise.prototype.then()</h3><ul><li>thenæ–¹æ³•ç”¨æ¥æ·»åŠ å›è°ƒå‡½æ•°<ul><li>ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯å¼‚æ­¥æ“ä½œæˆåŠŸç”¨çš„</li><li>ç¬¬äºŒä¸ªæ˜¯å¼‚æ­¥æ“ä½œå¤±è´¥ä½¿ç”¨</li></ul></li><li>Promiseçš„æŠ¥é”™å…·æœ‰ä¼ é€’æ€§</li></ul><pre><code>p1  .then(step1)  .then(step2)  .then(step3)  .then(    console.log,    console.error  );</code></pre><p>åœ¨ä¸Šè¿°çš„ä¾‹å­é‡Œé¢ï¼Œconsole.log åªæ˜¾ç¤ºstep3çš„å†…å®¹ï¼Œä½†æ˜¯console.errorä¼šæ˜¾ç¤ºå‡ºstep1ï¼Œ2ï¼Œ3å‡ºç°çš„ä»»æ„é”™è¯¯ã€‚Promiseå¯¹è±¡çš„æŠ¥é”™å…·æœ‰ä¼ é€’æ€§ </p><h1 id="3-DOM"><a href="#3-DOM" class="headerlink" title="3. DOM"></a>3. DOM</h1><h2 id="3-1-Intro"><a href="#3-1-Intro" class="headerlink" title="3.1 Intro"></a>3.1 Intro</h2><p>DOMæ˜¯JavaScriptæ“ä½œç½‘é¡µçš„æ¥å£ï¼Œå…¨ç§°ä¸ºæ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Object Model).å®ƒçš„ä½œç”¨æ˜¯å°†ç½‘é¡µè½¬ä¸ºä¸€ä¸ªJavaScriptå¯¹è±¡ï¼Œä»è€Œå¯ä»¥ç”¨è„šæœ¬è¿›è¡Œå„ç§æ“ä½œã€‚</p><p>æµè§ˆå™¨æ ¹æ®DOMæ¨¡å‹ï¼Œå°†ç»“æ„åŒ–æ–‡æ¡£è§£ææˆä¸€ç³»åˆ—çš„èŠ‚ç‚¹ï¼Œå†ç”±è¿™äº›èŠ‚ç‚¹ç»„æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ - DOM treeã€‚æ‰€æœ‰çš„èŠ‚ç‚¹å’Œæœ€ç»ˆçš„æ ‘çŠ¶æ¶æ„ï¼Œéƒ½æœ‰è§„èŒƒçš„å¯¹å¤–æ¥å£ã€‚</p><ul><li><p>èŠ‚ç‚¹  </p><ul><li>DOMçš„æœ€å°ç»„æˆå•ä½</li></ul></li><li><p>èŠ‚ç‚¹ç±»å‹</p><ul><li>Document æ–‡æ¡£æ ‘çš„é¡¶å±‚èŠ‚ç‚¹</li><li>DocumentType doctypeæ ‡ç­¾ï¼Œæ¯”å¦‚    <code>&lt;!DOCTYPE html&gt;</code></li><li>Element ç½‘é¡µçš„å„ç§HTMLæ ‡ç­¾</li><li>Attribute  ç½‘é¡µå…ƒç´ çš„å±æ€§</li><li>Text  æ ‡ç­¾ä¹‹é—´æˆ–æ ‡ç­¾åŒ…å«çš„æ–‡æœ¬</li><li>comment æ³¨é‡Š</li><li>DocumentFragment  æ–‡æ¡£ç‰‡æ®µ<h2 id="3-2-Nodeç®€è¿°"><a href="#3-2-Nodeç®€è¿°" class="headerlink" title="3.2 Nodeç®€è¿°"></a>3.2 Nodeç®€è¿°</h2><h3 id="3-2-1-Nodeæ¥å£"><a href="#3-2-1-Nodeæ¥å£" class="headerlink" title="3.2.1 Nodeæ¥å£"></a>3.2.1 Nodeæ¥å£</h3></li></ul></li><li><p>nodeType </p><ul><li>è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºèŠ‚ç‚¹çš„ç±»å‹<ul><li>document 9 </li><li>element  1</li><li>attr     2</li><li>text     3</li><li>documentFragment 11 </li><li>documentType     10</li><li>Comment          8</li></ul></li></ul></li><li><p>nodeName</p><ul><li>è¿”å›èŠ‚ç‚¹çš„åç§°</li></ul></li><li><p>nodeValue</p><ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹æœ¬èº«çš„æ–‡æœ¬å€¼ï¼Œè¯¥å±æ€§å¯è¯»å†™</li></ul></li></ul><pre><code>var div = document.getElementById(&#39;d1&#39;);div.nodeValue // nulldiv.firstChild.nodeValue // &quot;hello world&quot;</code></pre><ul><li>Node.prototype.textContent<ul><li>textContentå±æ€§è¿”å›å½“å‰èŠ‚ç‚¹å’Œå®ƒçš„æ‰€æœ‰åä»£èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹</li><li>è¯¥å±æ€§æ˜¯å¯è¯»å†™çš„ï¼Œè®¾ç½®è¯¥å±æ€§çš„å€¼ï¼Œä¼šç”¨ä¸€ä¸ªæ–°çš„æ–‡æœ¬èŠ‚ç‚¹ä»£æ›¿åŸæœ‰çš„å­èŠ‚ç‚¹</li><li>æ³¨æ„è½¬è¯‘çš„æ—¶å€™HTMLæ ‡ç­¾ä¼šè¢«å¿½ç•¥æ‰çš„</li></ul></li></ul><pre><code>document.getElementById(&#39;foo&#39;).textContent = &#39;&lt;p&gt;GoodBye!&lt;/p&gt;&#39;;</code></pre><ul><li>Node.prototype.baseURI<ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰ç½‘é¡µçš„ç»å¯¹è·¯å¾„</li><li>æµè§ˆå™¨ä¼šæ ¹æ®è¿™ä¸ªå±æ€§è®¡ç®—ç½‘é¡µä¸Šçš„ç›¸å¯¹è·¯å¾„çš„URL  </li><li>è¯¥å±æ€§ä¸ºåªè¯» </li></ul></li></ul><pre><code>document.baseURI// &quot;http://www.example.com/index.html&quot;</code></pre><ul><li><p>Node.prototype.ownerDocument </p><ul><li>è¿”å›å½“å‰èŠ‚ç‚¹æ‰€åœ¨çš„é¡¶å±‚æ–‡æ¡£å¯¹è±¡ï¼Œå³documentå¯¹è±¡</li></ul></li><li><p>Node.prototype.nextSibling </p><ul><li>è¿”å›ç´§è·Ÿåœ¨å½“å‰èŠ‚ç‚¹åé¢çš„ç¬¬ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ </li><li>å¦‚æœå½“å‰èŠ‚ç‚¹åé¢æ²¡æœ‰åŒçº§èŠ‚ç‚¹ï¼Œå°±è¿”å›null </li><li>è¯¥å±æ€§å¯ä»¥ç”¨æ¥éå†æ‰€æœ‰å­èŠ‚ç‚¹</li></ul></li></ul><pre><code>var d1 = document.getElementById(&#39;d1&#39;);var d2 = document.getElementById(&#39;d2&#39;);d1.nextSibling === d2 // true// éå†æ‰€æœ‰åŒçº§èŠ‚ç‚¹var el = document.getElementById(&#39;div1&#39;).firstChild;while (el !== null) {  console.log(el.nodeName);  el = el.nextSibling;}</code></pre><ul><li>Node.prototype.previousSibling <ul><li>è¿”å›å€©å€©èŠ‚ç‚¹å‰é¢çš„ï¼Œè·ç¦»æœ€è¿‘çš„ï¼ŒåŒçº§çš„èŠ‚ç‚¹</li><li>å¦‚æœæ²¡æœ‰åŒçº§èŠ‚ç‚¹ï¼Œå°±è¿”å›null </li></ul></li><li>Node.prototype.parentNode<ul><li>è¿”å›å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</li><li>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹æ¥è¯´ï¼Œå…¶çˆ¶èŠ‚ç‚¹å¯èƒ½ä¸ºï¼š<ul><li>element </li><li>document </li><li>documentFragment </li></ul></li></ul></li><li>Node.prototype.parentElement </li><li>Node.prototype.firstChild</li><li>Node.prototype.lastChild</li><li>Node.prototype.childNodes<ul><li>è¿”å›Nodelisté›†åˆï¼ŒåŒ…æ‹¬å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹</li></ul></li><li>Node.prototype.isConnected<ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹æ˜¯å¦åœ¨æ–‡æ¡£å½“ä¸­</li></ul></li></ul><h3 id="3-2-2-nodeæ–¹æ³•"><a href="#3-2-2-nodeæ–¹æ³•" class="headerlink" title="3.2.2 nodeæ–¹æ³•"></a>3.2.2 nodeæ–¹æ³•</h3><ul><li>appendChild()<ul><li>æ¥å—ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ’å…¥å½“å‰èŠ‚ç‚¹</li><li>å¦‚æœå‚æ•°èŠ‚ç‚¹æ˜¯DOMå·²ç»å­˜åœ¨çš„èŠ‚ç‚¹ï¼ŒappendChildæ–¹æ³•ä¼šå°†å…¶ä»åŸæ¥çš„ä½ç½®ç§»åŠ¨åˆ°æ–°ä½ç½®</li></ul></li><li>hasChildNodes()<ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å­èŠ‚ç‚¹</li></ul></li><li>cloneNode()<ul><li>å…‹éš†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¥å—ä¸€ä¸ªå¸ƒå°”å€¼ä½œä¸ºå‚æ•°ï¼Œ è¡¨ç¤ºæ˜¯å¦åŒæ—¶å…‹éš†å­èŠ‚ç‚¹</li><li>è¿”å›å€¼ä¸ºä¸€ä¸ªå…‹éš†å‡ºæ¥çš„æ–°èŠ‚ç‚¹</li></ul></li><li>insertBefore()<ul><li>ç”¨æ¥å°†æŸä¸ªèŠ‚ç‚¹æ’å…¥çˆ¶èŠ‚ç‚¹å†…éƒ¨çš„æŒ‡å®šä½ç½®</li><li><code>var insertedNode = parentNode.insertBefore(newNode, referenceNode);</code></li></ul></li><li>removeChild()<ul><li>æ¥å—ä¸€ä¸ªå­èŠ‚ç‚¹ä½œä¸ºå‚æ•°ï¼Œç”¨äºä»å½“å‰èŠ‚ç‚¹ç§»é™¤è¯¥å­èŠ‚ç‚¹</li></ul></li><li>replaceChild()<ul><li>ç”¨äºå°†ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ›¿æ¢å½“å‰èŠ‚ç‚¹çš„æŸä¸€ä¸ªå­èŠ‚ç‚¹</li></ul></li><li>contains()<ul><li>è¿”å›å¸ƒå°”å€¼ï¼Œçœ‹å‚æ•°èŠ‚ç‚¹æ˜¯å¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶<ul><li>å‚æ•°èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹</li><li>ä¸ºå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</li><li>ä¸ºå½“å‰èŠ‚ç‚¹çš„åä»£èŠ‚ç‚¹</li></ul></li></ul></li><li>getRootNode()<ul><li>è¿”å›å½“å‰èŠ‚ç‚¹æ‰€åœ¨æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹document,ä¸ownerDocumentå±æ€§çš„ä½œç”¨ç›¸åŒ </li></ul></li></ul><h2 id="3-3-DocumentèŠ‚ç‚¹"><a href="#3-3-DocumentèŠ‚ç‚¹" class="headerlink" title="3.3 DocumentèŠ‚ç‚¹"></a>3.3 DocumentèŠ‚ç‚¹</h2><p>documentèŠ‚ç‚¹å¯¹è±¡ä»£è¡¨æ•´ä¸ªæ–‡æ¡£ï¼Œæ¯ä¸ªç½‘é¡µéƒ½æœ‰è‡ªå·±çš„documentå¯¹è±¡ï¼Œ<code>window.document</code>å±æ€§å°±æŒ‡å‘è¿™ä¸ªå¯¹è±¡</p><ul><li>æ­£å¸¸ç½‘é¡µå¯ä»¥ç›´æ¥ä½¿ç”¨docuemnt è¿˜æœ‰window.document</li><li>iframeæ¡†æ¶é‡Œé¢çš„ç½‘é¡µï¼Œä½¿ç”¨iframeèŠ‚ç‚¹çš„contentDocumentå±æ€§</li><li>Ajaxæ“ä½œè¿”å›çš„æ–‡æ¡£ï¼Œä½¿ç”¨XMLHttpRequestå¯¹è±¡çš„responseXMLå±æ€§</li></ul><h3 id="3-3-1-å¿«æ·æ–¹å¼å±æ€§"><a href="#3-3-1-å¿«æ·æ–¹å¼å±æ€§" class="headerlink" title="3.3.1 å¿«æ·æ–¹å¼å±æ€§"></a>3.3.1 å¿«æ·æ–¹å¼å±æ€§</h3><ul><li>document.defaultView <ul><li>è¿”å›documentå¯¹è±¡æ‰€å±çš„windowå¯¹è±¡</li></ul></li><li>document.doctype</li></ul><pre><code>var doctype = document.doctype;doctype // &quot;&lt;!DOCTYPE html&gt;&quot;doctype.name // &quot;html&quot;</code></pre><ul><li>document.documentElement <ul><li>è¿”å›å½“å‰æ–‡æ¡£çš„æ ¹å…ƒç´ èŠ‚ç‚¹</li><li>é€šå¸¸ä¸ºdocumentèŠ‚ç‚¹çš„ç¬¬äºŒä¸ªå­èŠ‚ç‚¹ï¼Œç´§è·Ÿåœ¨document.doctypeèŠ‚ç‚¹åé¢</li></ul></li><li>document.body<ul><li>æŒ‡å‘bodyèŠ‚ç‚¹</li></ul></li><li>document.head<ul><li>æŒ‡å‘headèŠ‚ç‚¹</li></ul></li><li>document.scrollingElement <ul><li>è¿”å›æ–‡æ¡£çš„æ»šåŠ¨å…ƒç´ </li></ul></li><li>document.activeElement <ul><li>è¿”å›è·å¾—å½“å‰ç„¦ç‚¹çš„DOMå…ƒç´ </li><li>é€šå¸¸è¿™ä¸ªå±æ€§è¿”å›çš„æ˜¯<code>&lt;input&gt; &lt;textarea&gt; &lt;select&gt;</code>è¿™ç±»è¡¨å•å…ƒç´ </li></ul></li><li>document.fullscreenElement <ul><li>è¿”å›å½“å‰ä»¥å…¨å±çŠ¶æ€å±•ç¤ºçš„DOMå…ƒç´  </li></ul></li></ul><h3 id="3-3-2-èŠ‚ç‚¹é›†åˆå±æ€§"><a href="#3-3-2-èŠ‚ç‚¹é›†åˆå±æ€§" class="headerlink" title="3.3.2 èŠ‚ç‚¹é›†åˆå±æ€§"></a>3.3.2 èŠ‚ç‚¹é›†åˆå±æ€§</h3><p>è¿”å›ä¸€ä¸ªHTMLCollectionå®ä¾‹ï¼Œè¡¨ç¤ºæ–‡æ¡£å†…éƒ¨ç‰¹å®šå…ƒç´ çš„é›†åˆã€‚è¿™äº›é›†åˆæ˜¯åŠ¨æ€çš„ï¼ŒåŸèŠ‚ç‚¹æœ‰ä»»ä½•å˜åŒ–ï¼Œç«‹åˆ»ä¼šåæ˜ åœ¨é›†åˆå½“ä¸­ </p><ul><li>document.links </li><li>document.forms</li><li>document.images </li><li>document.embeds  / document.plugins <ul><li>è¿”å›æ‰€æœ‰<embed>èŠ‚ç‚¹</li></ul></li><li>document.scripts</li><li>document.styleSheets</li></ul><h3 id="3-3-3-æ–‡æ¡£é™æ€ä¿¡æ¯å±æ€§"><a href="#3-3-3-æ–‡æ¡£é™æ€ä¿¡æ¯å±æ€§" class="headerlink" title="3.3.3 æ–‡æ¡£é™æ€ä¿¡æ¯å±æ€§"></a>3.3.3 æ–‡æ¡£é™æ€ä¿¡æ¯å±æ€§</h3><ul><li>document.documentURI / document.URL<ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£çš„ç½‘å€</li><li>ä¸åŒä¹‹å¤„åœ¨äºä»–ä»¬ç»§æ‰¿è‡ªä¸åŒçš„æ¥å£</li><li>documentURI ç»§æ‰¿è‡ªDocumentæ¥å£ï¼Œå¯ç”¨äºæ‰€æœ‰æ–‡æ¡£</li><li>URL ç»§æ‰¿è‡ªHTMLDocumentæ¥å£ï¼Œåªå¯ç”¨äºHTMLæ–‡æ¡£</li></ul></li><li>document.domain<ul><li>è¿”å›å½“å‰æ–‡æ¡£çš„åŸŸå </li><li>æ¯”å¦‚ï¼Œç½‘é¡µçš„ç½‘å€æ˜¯<a href="http://www.example.com:80/hello.htmlï¼Œé‚£ä¹ˆdocument.domainå±æ€§å°±ç­‰äºwww.example.com" target="_blank" rel="noopener">http://www.example.com:80/hello.htmlï¼Œé‚£ä¹ˆdocument.domainå±æ€§å°±ç­‰äºwww.example.com</a></li></ul></li><li>document.location <ul><li>æµè§ˆå™¨åŸç”Ÿå¯¹è±¡ï¼Œæä¾›URLç›¸å…³çš„ä¿¡æ¯å’Œæ“ä½œæ–¹æ³•</li><li>é€šè¿‡window.location å’Œdocument.locationå±æ€§ï¼Œå¯ä»¥æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡</li></ul></li><li>document.lastModified <ul><li>è¿”å›å½“å‰æ–‡æ¡£çš„é—®å€™ä¿®æ”¹æ—¶é—´</li></ul></li><li>document.title </li><li>document.characterSet <ul><li>UTF-8</li><li>ISO-8859-1</li><li>etc.</li></ul></li><li>document.referrer <ul><li>è¿”å›å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£çš„è®¿é—®è€…æ¥çš„åœ°æ–¹</li></ul></li><li>document.dir <ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²<ul><li>rtl</li><li>ltr</li></ul></li></ul></li><li>document.compatMode<ul><li>è¿”å›æµè§ˆå™¨å¤„ç†æ–‡æ¡£çš„æ¨¡å¼ </li><li>BackCompat å‘åå…¼å®¹æ¨¡å¼</li><li>CSS1Compat ä¸¥æ ¼æ¨¡å¼</li></ul></li></ul><h3 id="3-3-4-æ–‡æ¡£çŠ¶æ€å±æ€§"><a href="#3-3-4-æ–‡æ¡£çŠ¶æ€å±æ€§" class="headerlink" title="3.3.4 æ–‡æ¡£çŠ¶æ€å±æ€§"></a>3.3.4 æ–‡æ¡£çŠ¶æ€å±æ€§</h3><ul><li>hidden<ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼</li></ul></li><li>visibilityState  è¿”å›å½“å‰æ–‡æ¡£çš„å¯è§çŠ¶æ€<ul><li>visible</li><li>hidden</li><li>prerender æ­£åœ¨æ¸²æŸ“çš„çŠ¶æ€ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè¿™ä¸ªé¡µé¢ä¸å¯è§</li><li>unloaded ä»å†…å­˜ä¸­å¸è½½äº†</li></ul></li><li>readyState  è¿”å›å½“å‰æ–‡æ¡£çš„çŠ¶æ€<ul><li>loading åŠ è½½HTMLä»£ç é˜¶æ®µ</li><li>interactive  åŠ è½½å¤–éƒ¨èµ„æºé˜¶æ®µ</li><li>complete  åŠ è½½å®Œæˆ</li></ul></li><li>cookie</li><li>designMode <ul><li>on/ off</li><li>å½“å¼€å¯ä»¥åï¼Œç”¨æˆ·å°±å¯ä»¥ç¼–è¾‘æ•´ä¸ªæ–‡æ¡£çš„å†…å®¹äº†</li></ul></li><li>implementation <ul><li>è¿”å›ä¸€ä¸ªDOMImplementationå¯¹è±¡ </li><li>DOMImplementation.createDocument()</li><li>DOMImplementation.createHTMLDocument()</li><li>DOMImplementation.createDocumentType() </li></ul></li></ul><h3 id="3-3-5-Documentç›¸å…³æ–¹æ³•"><a href="#3-3-5-Documentç›¸å…³æ–¹æ³•" class="headerlink" title="3.3.5 Documentç›¸å…³æ–¹æ³•"></a>3.3.5 Documentç›¸å…³æ–¹æ³•</h3><ul><li>document.open()  document.close() <ul><li>openç”¨æ¥æ¸…é™¤å½“å‰æ–‡æ¡£çš„æ‰€æœ‰å†…å®¹ï¼Œä½¿å¾—æ–‡æ¡£å¤„äºå¯å†™çŠ¶æ€</li><li>document.closeç”¨æ¥å…³é—­æ‰“å¼€çš„æ–‡æ¡£</li></ul></li><li>document.write()  document.writeln()<ul><li>writeç”¨äºå‘å½“å‰æ–‡æ¡£å†™å…¥å†…å®¹</li><li>å½“é¡µé¢å·²ç»è§£æå®Œæˆä»¥åï¼Œå†è°ƒç”¨writeä¼šå…ˆè°ƒç”¨openæ–¹æ³•ï¼Œè¿™æ ·æ‰€æœ‰æ–‡æ¡£çš„å†…å®¹å°±å·²ç»è¢«æ“¦é™¤äº†</li><li>åœ¨é¡µé¢æ¸²æŸ“è¿‡ç¨‹ä¸­çš„è°ƒç”¨writeæ–¹æ³•ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨openæ–¹æ³•</li><li>writelnæ˜¯åœ¨æœ«å°¾ä¼šæ·»åŠ æ¢è¡Œç¬¦</li></ul></li></ul><pre><code>document.addEventListener(&#39;DOMContentLoaded&#39;, function (event) {  document.write(&#39;&lt;p&gt;Hello World!&lt;/p&gt;&#39;);});// ç­‰åŒäºdocument.addEventListener(&#39;DOMContentLoaded&#39;, function (event) {  document.open();  document.write(&#39;&lt;p&gt;Hello World!&lt;/p&gt;&#39;);  document.close();});</code></pre><ul><li>document.querySelector()  document.querySelectorAll()<ul><li>æ¥å—ä¸€ä¸ªCSSé€‰æ‹©å™¨ä½œä¸ºå‚æ•°ï¼Œè¿”å›åŒ¹é…è¯¥é€‰æ‹©å™¨çš„å…ƒç´ èŠ‚ç‚¹ã€‚å¦‚æœå¤šä¸ªèŠ‚ç‚¹æ»¡è¶³åŒ¹é…æ¡ä»¶ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰å‘ç°åŒ¹é…çš„èŠ‚ç‚¹ï¼Œåˆ™è¿”å›null</li><li>querySelectorAllæ–¹æ³•ä¸querySelectorç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè¿”å›çš„æ˜¯NodeListå¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰åŒ¹é…ç»™å®šé€‰æ‹©å™¨çš„èŠ‚ç‚¹</li></ul></li></ul><pre><code>var el1 = document.querySelector(&#39;.myclass&#39;);var el2 = document.querySelector(&#39;#myParent &gt; [ng-click]&#39;);// é€‰ä¸­ data-foo-bar å±æ€§ç­‰äº someval çš„å…ƒç´ document.querySelectorAll(&#39;[data-foo-bar=&quot;someval&quot;]&#39;);// é€‰ä¸­ myForm è¡¨å•ä¸­æ‰€æœ‰ä¸é€šè¿‡éªŒè¯çš„å…ƒç´ document.querySelectorAll(&#39;#myForm :invalid&#39;);// é€‰ä¸­divå…ƒç´ ï¼Œé‚£äº› class å« ignore çš„é™¤å¤–document.querySelectorAll(&#39;DIV:not(.ignore)&#39;);// åŒæ—¶é€‰ä¸­ divï¼Œaï¼Œscript ä¸‰ç±»å…ƒç´ document.querySelectorAll(&#39;DIV, A, SCRIPT&#39;);</code></pre><ul><li>document.getElementsByTagName()<ul><li>æœç´¢HTMLæ ‡ç­¾åï¼Œè¿”å›ç¬¦åˆæ¡ä»¶çš„å…ƒç´ </li><li>è¿”å›çš„ä¸ºä¸€ä¸ªHTMLCollectionå¯¹è±¡</li><li>å¯ä»¥å®æ—¶åæ˜ HTMLæ–‡æ¡£çš„å˜åŒ–</li></ul></li><li>document.getElementsByClassName()<ul><li>è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬äº†æ‰€æœ‰classåå­—ç¬¦åˆæŒ‡å®šæ¡ä»¶çš„å…ƒç´ ï¼Œå…ƒç´ çš„å˜åŒ–å®æ—¶åæ˜ åœ¨è¿”å›ç»“æœå½“ä¸­</li></ul></li><li>document.getElementsByName()<ul><li>ç”¨äºé€‰æ‹©æ‹¥æœ‰nameå±æ€§çš„HTMLå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</li></ul></li><li>document.getElementById()<ul><li>è¿”å›åŒ¹é…æŒ‡å®šidå±æ€§çš„å…ƒç´ èŠ‚ç‚¹</li><li>å¦‚æœæ²¡æœ‰å‘ç°åŒ¹é…çš„èŠ‚ç‚¹ï¼Œåˆ™è¿”å›null</li></ul></li><li>document.elementFromPoint()  document.elementsFromPoint()<ul><li>è¿”å›ä½äºé¡µé¢æŒ‡å®šä½ç½®æœ€ä¸Šå±‚çš„å…ƒç´ èŠ‚ç‚¹ </li><li><code>var element = document.elementFromPoint(50, 50);</code></li><li>è¯¥ä»£ç å°±ä¼šé€‰ä¸­åœ¨è¿™ä¸ªåæ ‡ä¸Šçš„æœ€ä¸Šå±‚çš„HTMLå…ƒç´ </li><li>ä¸¤ä¸ªå‚æ•°æ˜¯ç›¸å¯¹äºå·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œå•ä½æ˜¯åƒç´ </li></ul></li><li>document.createElement()<ul><li>ç”¨æ¥ç”Ÿæˆå…ƒç´ èŠ‚ç‚¹ï¼Œå¹¶è¿”å›è¯¥èŠ‚ç‚¹</li><li>æ–¹æ³•çš„å‚æ•°ä¸ºå…ƒç´ çš„æ ‡ç­¾åï¼Œå³å…ƒç´ èŠ‚ç‚¹çš„tagNameå±æ€§</li></ul></li><li>document.createTextNode()<ul><li>ç”¨æ¥ç”Ÿæˆæ–‡æœ¬èŠ‚ç‚¹ï¼Œå¹¶è¿”å›è¯¥èŠ‚ç‚¹</li><li>å‚æ•°æ˜¯æ–‡æœ¬èŠ‚ç‚¹çš„å†…å®¹</li></ul></li></ul><pre><code>var newDiv = document.createElement(&#39;div&#39;);var newContent = document.createTextNode(&#39;Hello&#39;);newDiv.appendChild(newContent);</code></pre><ul><li>document.createAttribute() <ul><li>ç”Ÿæˆä¸€ä¸ªæ–°çš„å±æ€§èŠ‚ç‚¹</li></ul></li></ul><pre><code>var node = document.getElementById(&#39;div1&#39;);var a = document.createAttribute(&#39;my_attrib&#39;);a.value = &#39;newVal&#39;;node.setAttributeNode(a);// æˆ–è€…node.setAttribute(&#39;my_attrib&#39;, &#39;newVal&#39;);</code></pre><ul><li>document.createComment() </li><li>document.createDocumentFragment()<ul><li>ç”Ÿæˆä¸€ä¸ªç©ºçš„æ–‡æ¡£ç‰‡æ®µå¯¹è±¡ </li><li>æ˜¯å­˜äºå†…å­˜çš„DOMç‰‡æ®µï¼Œä¸å±äºå½“å‰æ–‡æ¡£ï¼Œå¸¸å¸¸ç”¨æ¥ç”Ÿæˆä¸€æ®µè¾ƒä¸ºå¤æ‚çš„DOMç»“æ„ï¼Œç„¶åå†æ’å…¥åˆ°æ–‡æ¡£å½“ä¸­</li><li>å› ä¸ºDocumentFragmentä¸å±äºå½“å‰æ–‡æ¡£ï¼Œå¯¹å…¶ä»»ä½•æ”¹åŠ¨éƒ½ä¸ä¼šå¼•å‘ç½‘é¡µçš„é‡æ–°æ¸²æŸ“ï¼Œæ¯”ç›´æ¥ä¿®æ”¹å½“å‰æ–‡æ¡£çš„DOMæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°</li></ul></li></ul><ul><li>document.createEvent() <ul><li>ç”Ÿæˆä¸€ä¸ªäº‹ä»¶å¯¹è±¡</li><li>å…¶å‚æ•°ä¸ºäº‹ä»¶ç±»å‹ï¼Œæ¯”å¦‚<ul><li>MouseEvents</li><li>MutationEvents</li><li>HTMLEvents </li></ul></li></ul></li></ul><pre><code>var event = document.createEvent(&#39;Event&#39;);event.initEvent(&#39;build&#39;, true, true);document.addEventListener(&#39;build&#39;, function (e) {  console.log(e.type); // &quot;build&quot;}, false);document.dispatchEvent(event);</code></pre><ul><li>document.addEventListener() <ul><li>æ·»åŠ äº‹ä»¶ç›‘å¬å‡½æ•° </li></ul></li><li>document.removeEventListner()<ul><li>ç§»é™¤äº‹ä»¶ç›‘å¬å‡½æ•° </li></ul></li><li>document.dispatchEvent()<ul><li>è§¦å‘äº‹ä»¶</li></ul></li><li>document.hasFocus()<ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£æ˜¯å¦æœ‰å…ƒç´ è¢«æ¿€æ´»æˆ–è€…è·å¾—äº†ç„¦ç‚¹</li></ul></li><li>document.adoptNode()<ul><li>document.adoptNodeæ–¹æ³•å°†æŸä¸ªèŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ï¼Œä»åŸæ¥æ‰€åœ¨çš„æ–‡æ¡£æˆ–DocumentFragmenté‡Œé¢ç§»é™¤ï¼Œå½’å±å½“å‰documentå¯¹è±¡ï¼Œè¿”å›æ’å…¥åçš„æ–°èŠ‚ç‚¹ã€‚æ’å…¥çš„èŠ‚ç‚¹å¯¹è±¡çš„ownerDocumentå±æ€§ï¼Œä¼šå˜æˆå½“å‰çš„documentå¯¹è±¡ï¼Œè€ŒparentNodeå±æ€§æ˜¯null</li></ul></li></ul><pre><code>var node = document.adoptNode(externalNode);document.appendChild(node);</code></pre><h2 id="3-4-Element-èŠ‚ç‚¹"><a href="#3-4-Element-èŠ‚ç‚¹" class="headerlink" title="3.4 Element èŠ‚ç‚¹"></a>3.4 Element èŠ‚ç‚¹</h2><p>Elementç»“ç‚¹å¯¹åº”ç½‘é¡µçš„HTMLå…ƒç´ ï¼Œæ¯ä¸ªHTMLåŸè‰²ï¼Œåœ¨DOMæ ‘ä¸Šéƒ½ä¼šè½¬åŒ–æˆä¸€ä¸ªELementèŠ‚ç‚¹å¯¹è±¡</p><h3 id="3-4-1-å®ä¾‹å±æ€§"><a href="#3-4-1-å®ä¾‹å±æ€§" class="headerlink" title="3.4.1 å®ä¾‹å±æ€§"></a>3.4.1 å®ä¾‹å±æ€§</h3><ul><li>Element.id</li><li>Element.tagName <ul><li>è¿”å›æŒ‡å®šå…ƒç´ çš„å¤§å†™æ ‡ç­¾å</li></ul></li><li>Element.dir<ul><li>ç”¨äºè¯»å†™å½“å‰å…ƒç´ çš„æ–‡å­—æ–¹å‘</li></ul></li><li>Element.accessKey<ul><li>ç”¨äºè¯»å†™åˆ†é…ç»™å½“å‰å…ƒç´ çš„å¿«æ·é”®</li></ul></li></ul><pre><code>// HTML ä»£ç ä¸º &lt;p id=&quot;foo&quot;&gt;var p = document.querySelector(&#39;p&#39;);p.id // &quot;foo&quot;// HTMLä»£ç ä¸º// &lt;span id=&quot;myspan&quot;&gt;Hello&lt;/span&gt;var span = document.getElementById(&#39;myspan&#39;);span.id // &quot;myspan&quot;span.tagName // &quot;SPAN&quot;// HTML ä»£ç å¦‚ä¸‹// &lt;button accesskey=&quot;h&quot; id=&quot;btn&quot;&gt;ç‚¹å‡»&lt;/button&gt;var btn = document.getElementById(&#39;btn&#39;);btn.accessKey // &quot;h&quot;</code></pre><ul><li><p>Element.draggable</p><ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ æ˜¯å¦å¯æ‹–åŠ¨ï¼Œè¯¥å±æ€§å¯è¯»å†™</li></ul></li><li><p>Element.lang</p><ul><li>è¿”å›å½“å‰å…ƒç´ çš„è¯­è¨€è®¾ç½® </li></ul></li><li><p>Element.tabIndex</p><ul><li>è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ åœ¨tabé”®éå†çš„æ—¶å€™çš„é¡ºåº</li><li>å¦‚æœä¸ºè´Ÿå€¼ï¼Œåœ¨tabä¸ä¼šéå†åˆ°è¿™ä¸ªåŸè‰²</li><li>å¯¹äºæ­£æ•´æ•°ï¼ŒæŒ‰ç…§é¡ºåºä»å°åˆ°å¤§è¿›è¡Œéå†</li></ul></li><li><p>Element.title</p><ul><li>ç”¨äºè¯»å†™å½“å‰å…ƒç´ HTMLå±æ€§çš„title </li><li>ç”¨äºæŒ‡å®šé¼ æ ‡æ‚¬æµ®æ—¶å¼¹å‡ºçš„æ–‡å­—æç¤ºæ¡†</li></ul></li><li><p>Element.hidden</p><ul><li>æ§åˆ¶å½“å‰å…ƒç´ æ˜¯å¦å¯è§</li><li>CSSçš„è®¾ç½®é«˜äºhidden  å³å¦‚æœcsså±‚è§„å®šäº†<code>display:none</code>æˆ–è€…<code>display:hidden</code> é‚£ä¹ˆelement.hiddenæ˜¯æ— æ³•æ”¹å˜å…¶å¯è§æ€§çš„</li></ul></li><li><p>Element.contentEditable  Element.isContentEditable </p></li><li><p>Element.attributes </p><ul><li>è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯å½“å‰å…ƒç´ èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§èŠ‚ç‚¹</li></ul></li><li><p>Element.className Element.classList</p><ul><li>ç”¨æ¥è¯»å†™å½“å‰åŸè‰²èŠ‚ç‚¹çš„classå±æ€§</li><li>å…¶å€¼ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªclassä¹‹é—´ç”¨ç©ºæ ¼æ¥åˆ†å‰²</li><li>st</li><li>è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</li></ul></li></ul><pre><code>// HTML ä»£ç  &lt;div class=&quot;one two three&quot; id=&quot;myDiv&quot;&gt;&lt;/div&gt;var div = document.getElementById(&#39;myDiv&#39;);div.className// &quot;one two three&quot;div.classList// {//   0: &quot;one&quot;//   1: &quot;two&quot;//   2: &quot;three&quot;//   length: 3// }</code></pre><ul><li>Element.innerHTML <ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç­‰åŒäºè¯¥å…ƒç´ åŒ…å«çš„æ‰€æœ‰HTMLä»£ç </li><li>å¯ä»¥è¯»å†™</li><li>ç”¨äºè®¾å®šæŸä¸ªèŠ‚ç‚¹çš„å†…å®¹</li><li>èƒ½å¤Ÿæ”¹å˜æ‰€æœ‰å…ƒç´ ç»“ç‚¹çš„å†…å®¹ï¼ŒåŒ…æ‹¬HTML bodyè¿™ç±»å…ƒç´ </li></ul></li></ul><pre><code>// HTMLä»£ç å¦‚ä¸‹ &lt;p id=&quot;para&quot;&gt; 5 &gt; 3 &lt;/p&gt;document.getElementById(&#39;para&#39;).innerHTML// 5 &amp;gt; 3</code></pre><ul><li>Element.outerHTML <ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ ç»“ç‚¹çš„æ‰€æœ‰HTMLä»£ç ï¼ŒåŒ…æ‹¬è¯¥å…ƒç´ æœ¬èº«å’Œæ‰€æœ‰å­å…ƒç´ </li></ul></li><li>Element.clientHeight Element.clientWidth<ul><li>è¿”å›ä¸€ä¸ªæ•´æ•°å€¼è¡¨ç¤ºå…ƒç´ èŠ‚ç‚¹çš„CSSé«˜åº¦å’Œå®½åº¦</li></ul></li></ul><h3 id="3-4-2-å®ä¾‹æ–¹æ³•"><a href="#3-4-2-å®ä¾‹æ–¹æ³•" class="headerlink" title="3.4.2 å®ä¾‹æ–¹æ³•"></a>3.4.2 å®ä¾‹æ–¹æ³•</h3><ul><li>getAttribute()</li><li>getAttributeNames() </li><li>setAttribute()</li><li>hasAttribute()</li><li>hasAttributes()</li><li>removeAttribute() </li></ul><h3 id="3-4-3-äº‹ä»¶ç›¸å…³æ–¹æ³•"><a href="#3-4-3-äº‹ä»¶ç›¸å…³æ–¹æ³•" class="headerlink" title="3.4.3 äº‹ä»¶ç›¸å…³æ–¹æ³•"></a>3.4.3 äº‹ä»¶ç›¸å…³æ–¹æ³•</h3><ul><li>Element.addEventListener()</li><li>Element.removeEventListener()</li><li>Element.dispatchEvent()</li></ul>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Object Oriented </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæ•™ç¨‹ Part 1</title>
      <link href="/JavaScript%E6%95%99%E7%A8%8B-Part-1/"/>
      <url>/JavaScript%E6%95%99%E7%A8%8B-Part-1/</url>
      
        <content type="html"><![CDATA[<p>å‘ç°å‰é¢çœ‹çš„JSè¿˜æ˜¯ä¸å¤ªæˆç³»ç»Ÿï¼Œé‡åˆ°çš„è¿™æ–¹é¢çš„é—®é¢˜è¶Šæ¥è¶Šå¤šï¼Œéœ€è¦å¥½å¥½çš„æ·±å…¥ç ”ç©¶ä¸‹è¿™å—å†…å®¹äº†ã€‚</p><h1 id="1-Basic"><a href="#1-Basic" class="headerlink" title="1. Basic"></a>1. Basic</h1><h2 id="1-1-æ¦‚è§ˆ"><a href="#1-1-æ¦‚è§ˆ" class="headerlink" title="1.1 æ¦‚è§ˆ"></a>1.1 æ¦‚è§ˆ</h2><ul><li>åµŒå…¥å¼è¯­è¨€</li><li>æœ¬èº«çš„æ ¸å¿ƒè¯­æ³•åªæœ‰æ•°å­¦é€»è¾‘è¿ç®—ç›¸å…³çš„</li><li>é å®¿ä¸»ç¯å¢ƒæä¾›å„ç§è¾“å…¥è¾“å‡ºç›¸å…³çš„API<ul><li>æµè§ˆå™¨</li><li>æœåŠ¡å™¨ç¯å¢ƒ - nodejs</li></ul></li><li>JSçš„æ ¸å¿ƒè¯­æ³•éƒ¨åˆ†<ul><li>åŸºæœ¬è¯­æ³•æ„é€ <ul><li>æ“ä½œç¬¦</li><li>æ§åˆ¶ç»“æ„</li><li>è¯­å¥</li></ul></li><li>æ ‡å‡†åº“<ul><li>Array</li><li>Date </li><li>Math</li><li>â€¦</li></ul></li></ul></li><li>é™¤æ­¤ä»¥å¤–ï¼Œä¾¿æ˜¯å…¶å®¿ä¸»ç¯å¢ƒæä¾›çš„å„ç§ä¸åŒçš„APIäº†</li><li>æµè§ˆå™¨<ul><li>æµè§ˆå™¨æ§åˆ¶ç±» </li><li>DOMç±»  html</li><li>Webç±»  ajax call</li></ul></li></ul><p>æœ¬æ–‡ä¼šä»åŸºæœ¬è¯­æ³•ï¼Œæ ‡å‡†åº“ï¼Œæµè§ˆå™¨APIä»¥åŠDOMå››ä¸ªå¤§æ–¹é¢æ¥è§£é‡Šæ•´ä¸ªjsçš„è¿è¡Œã€‚å¤§éƒ¨åˆ†å†…å®¹å‡ºè‡ªé˜®ä¸€å³°çš„ç”µå­ä¹¦ï¼Œå…¶ä¸­åŠ äº†ä¸€ä¸‹è‡ªå·±è®¤ä¸ºä¸é”™çš„ä¾‹å­ã€‚</p><ul><li>JSæ€§èƒ½<ul><li>JSåŸºæœ¬ä¸Šéƒ½æ˜¯ç¼–è¯‘è¿è¡Œï¼Œè¿è¡Œæ•ˆç‡å¾ˆé«˜</li><li>é‡‡å–äº‹ä»¶é©±åŠ¨ event-driven </li><li>éé˜»å¡å¼ non-blocking </li></ul></li></ul><h2 id="1-2-åŸºæœ¬è¯­æ³•"><a href="#1-2-åŸºæœ¬è¯­æ³•" class="headerlink" title="1.2 åŸºæœ¬è¯­æ³•"></a>1.2 åŸºæœ¬è¯­æ³•</h2><ul><li>å˜é‡æå‡<ul><li>JSå¼•æ“ä¼šå…ˆè§£æä»£ç ï¼Œè·å–æ‰€æœ‰è¢«å£°æ˜çš„å˜é‡ï¼Œç„¶åå†ä¸€è¡Œä¸€è¡Œçš„è¿è¡Œã€‚</li><li>å³æ‰€æœ‰çš„å˜é‡çš„å£°æ˜è¯­å¥éƒ½ä¼šè¢«æå‡åˆ°ä»£ç çš„å¤´éƒ¨ã€‚</li></ul></li><li>ä½¿ç”¨label<ul><li>å®šä½ç¬¦ï¼Œç”¨äºè·³è½¬åˆ°ç¨‹åºçš„ä»»æ„ä½ç½®</li><li>æ¯”è¾ƒå¸¸ç”¨çš„åœºæ™¯ï¼šå¯ä»¥è·³å‡ºåŒé‡å¾ªç¯ - ç›´æ¥</li></ul></li></ul><pre><code>outOfTwoLoops:    for (let i = 0; i &lt; 10; i ++) {        for (let j = 0; j &lt; 10; j ++) {            if (i*j &lt; 99) break outOfTwoLoops;        }    }</code></pre><h2 id="1-3-æ•°æ®ç±»å‹æ¦‚è¿°"><a href="#1-3-æ•°æ®ç±»å‹æ¦‚è¿°" class="headerlink" title="1.3 æ•°æ®ç±»å‹æ¦‚è¿°"></a>1.3 æ•°æ®ç±»å‹æ¦‚è¿°</h2><ul><li>åŸºæœ¬æ•°æ®ç±»å‹<ul><li>number</li><li>string</li><li>boolean</li><li>undefined<ul><li>nothing defined (value)</li><li>when switch to number, come to be NaN </li><li>è¡¨ç¤ºæœªå®šä¹‰</li></ul></li><li>null <ul><li>empty object </li><li>when switch to number, come to be 0</li><li>è¡¨ç¤ºä¸ºç©º</li></ul></li><li>object<ul><li>ç‹­ä¹‰çš„å¯¹è±¡</li><li>array</li><li>function</li></ul></li></ul></li></ul><p>JSé‡Œé¢å°†å‡½æ•°functionä¹Ÿä½œä¸ºä¸€ç§å¯¹è±¡æ¥è¿›è¡Œå¤„ç†ï¼Œå¥½å¤„æ˜¯å¯ä»¥åšå‡½æ•°å¼çš„ç¼–ç¨‹äº†ï¼Œå³å¯ä»¥å°†æ•´ä¸ªå‡½æ•°èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œè¿™å°±å¯ä»¥ä¸ºç¼–ç¨‹å¸¦æ¥éå¸¸å¤§çš„çµæ´»æ€§äº†ã€‚</p><ul><li><p>typeof</p><ul><li><code>function f() {}</code></li><li><code>typeof f // function</code></li><li><code>typeof d // undefined</code></li><li><code>typeof [] // object</code></li><li><code>typeof {} // object</code></li></ul></li><li><p>æ•°å€¼</p><ul><li>æ‰€æœ‰æ•°å­—éƒ½æ˜¯ä»¥64ä½æµ®ç‚¹æ•°å½¢å¼å‚¨å­˜çš„ï¼Œå³ä½¿æ•´æ•°ä¹Ÿæ˜¯å¦‚æ­¤</li><li>æµ®ç‚¹æ•°æœ¬èº«å°±æ˜¯ä¸ç²¾ç¡®çš„ï¼Œæ¶‰åŠå°æ•°çš„è¿ç®—éœ€è¦éå¸¸å°å¿ƒ</li><li>ç›¸å…³æ–¹æ³•</li></ul></li></ul><pre><code>// å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°parseInt(&#39;123&#39;)  // 123parseInt(&#39;123CannotProcessString&#39;)  // 123parseInt(&#39;12.343&#39;)  // 12parseInt(&#39;1.99&#39;)  // 1parseInt(&#39;hahah&#39;)  // NaN // parseIntç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¢«è§£æçš„å€¼å¾—è¿›åˆ¶ï¼Œè¿”å›çš„å€¼æ˜¯10è¿›åˆ¶çš„parseInt(&#39;1000&#39;, 2)  // 8// parseFloat same pattern with parseIntparseFloat(&#39;&#39;) // NaNparseFloat(&#39;123.45&#39;) // 123.45// åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºNaN, åªå¯¹æ•°å€¼æœ‰æ•ˆï¼Œå¯¹äºå…¶ä»–ç±»å‹ï¼Œé¦–å…ˆè½¬åŒ–ä¸ºæ•°å€¼çš„æ—¶å€™å°±å˜æˆNaNäº†isNaN(123)  // false</code></pre><ul><li><p>NaN</p><ul><li>not a number</li><li>ä¸»è¦å‡ºç°åœ¨å°†å­—ç¬¦ä¸²è§£ææˆæ•°ç»„å‡ºé”™çš„åœºåˆ</li><li><code>typeof NaN    // &#39;number&#39;</code></li></ul></li><li><p>å­—ç¬¦ä¸²</p><ul><li>é»˜è®¤åªèƒ½å†™åœ¨ä¸€è¡Œå½“ä¸­ï¼Œå¤šè¡Œä¼šæŠ¥é”™</li><li>å¦‚æœæƒ³åˆ†åœ¨å¤šè¡Œï¼Œéœ€è¦åœ¨æ¯ä¸€è¡Œçš„å°¾éƒ¨ä½¿ç”¨åæ–œæ  <code>\</code></li><li>è½¬ä¹‰ <ul><li>\0 nukk</li><li>\b åé€€</li><li>\f æ¢é¡µ</li><li>\n æ¢è¡Œ</li><li>\r å›è½¦</li><li>\t åˆ¶è¡¨</li><li>\v å‚ç›´åˆ¶è¡¨</li><li>&#39; å•å¼•å·</li><li>&quot; åŒå¼•å·</li><li>\ åæ–œæ </li></ul></li><li>å­—ç¬¦ä¸²ä¸æ•°ç»„<ul><li>å­—ç¬¦ä¸²å¯ä»¥è§†ä¸ºå­—ç¬¦æ•°ç»„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ‹¬å·è¿ç®—ç¬¦ï¼Œç”¨æ¥è¿”å›æŸä¸ªä½ç½®çš„å­—ç¬¦</li><li>ä½†æ˜¯å­—ç¬¦ä¸²é‡Œé¢çš„å•ä¸ªå­—ç¬¦æ— æ³•æ”¹å˜å’Œå¢åˆ çš„ï¼Œæ— æ³•é€šè¿‡æ•°ç»„çš„å½¢å¼æ¥åšè¿™ä¸ª</li><li><code>str.length</code>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</li></ul></li></ul></li></ul><pre><code>var s = &#39;hello&#39;;s[0] // &quot;h&quot;s[1] // &quot;e&quot;s[4] // &quot;o&quot;// ç›´æ¥å¯¹å­—ç¬¦ä¸²ä½¿ç”¨æ–¹æ‹¬å·è¿ç®—ç¬¦&#39;hello&#39;[1] // &quot;e&quot;</code></pre><ul><li>å­—ç¬¦é›† <ul><li>JSä½¿ç”¨Unicodeå­—ç¬¦é›†ï¼ŒJSå¼•æ“å†…éƒ¨æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ä½¿ç”¨Unicodeæ¥è¿›è¡Œè¡¨ç¤ºçš„ã€‚ </li><li>å› æ­¤å¯ä»¥ç›´æ¥å°†å­—ç¬¦å†™æˆ <code>\uxxxx</code>çš„å½¢å¼ï¼Œåå››ä½æ˜¯è¯¥å­—ç¬¦çš„Unicodeç ç‚¹</li></ul></li><li>Base64è½¬ç <ul><li>åšè½¬ç æ˜¯å› ä¸ºæ–‡æœ¬é‡Œé¢æœ‰æ—¶ä¼šæœ‰ä¸€äº›ä¸å¯æ‰“å°çš„ç¬¦å·ï¼Œä¸æ˜¯ä¸ºäº†åŠ å¯†ï¼Œå°±æ˜¯ä¸ºäº†ç®€åŒ–ç¨‹åºçš„å¤„ç†è¿‡ç¨‹</li><li>Base64å¯ä»¥å°†å…¶è½¬åŒ–æˆå¯ä»¥æ‰“å°çš„å­—ç¬¦</li><li>æœ‰æ—¶ä¹Ÿéœ€è¦ä»¥æ–‡æœ¬çš„æ ¼å¼ä¼ é€’äºŒè¿›åˆ¶æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Base64ç¼–ç </li><li>btoa() ä»»æ„å€¼è½¬åŒ–ä¸ºbase64ç¼–ç   binary to ASCII</li><li>atob() Base64ç¼–ç è½¬ä¸ºåŸæ¥çš„å€¼  ASCII to binary </li><li>å¯¹äºASCIIæ— æ³•è¡¨ç¤ºçš„å­—ç¬¦ï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªencodeURIComponentçš„æŒ‡ä»¤ï¼Œæ¥ç¼–ç Uniform Resource Identifierï¼ˆURIï¼‰</li></ul></li></ul><ul><li>å¯¹è±¡<ul><li>å¯¹è±¡æ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œæ˜¯ä¸€ç§æ— åºçš„å¤åˆæ•°æ®é›†åˆ</li><li>å¯¹è±¡çš„æ‰€æœ‰é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ä¸åŠ å¼•å·</li><li>å¯¹è±¡çš„æ¯ä¸€ä¸ªé”®åç§°ä¸ºä¸€ä¸ªå±æ€§ property <ul><li>å…¶é”®å€¼å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼Œå¦‚æœä¸€ä¸ªå±æ€§çš„å€¼ä¸ºå‡½æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†è¿™ä¸ªå±æ€§ç§°ä¸ºæ–¹æ³•ï¼Œå¯ä»¥åƒå‡½æ•°é‚£æ ·æ¥åšè°ƒç”¨ </li></ul></li><li>å±æ€§æ˜¯å¯ä»¥<strong>åŠ¨æ€åˆ›å»º</strong>çš„ï¼Œä¸å¿…åœ¨å¯¹è±¡å£°æ˜çš„æ—¶å€™å°±æŒ‡å®š</li><li>æŸ¥çœ‹å¯¹è±¡æœ¬èº«çš„å±æ€§ <code>Object.keys</code></li><li>åˆ é™¤å±æ€§  <code>delete obj.p</code>     </li><li>å±æ€§æ˜¯å¦å­˜åœ¨ - æ£€æŸ¥é”®å  <code>&#39;p&#39; in obj</code></li></ul></li></ul><pre><code>var obj = {    foo: &#39;hello&#39;,    bar: &#39;world&#39;};</code></pre><ul><li><p>è¡¨è¾¾å¼ or  è¯­å¥</p><ul><li><code>{foo: 123}</code></li><li>è¿™æ ·å­å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¯­å¥ï¼Œfooæ˜¯ä¸ªæ ‡ç­¾ï¼ŒæŒ‡å‘123.</li><li>JSå¼•æ“çš„åšæ³•æ˜¯ä¸€å¾‹è§£é‡Šä¸ºä»£ç å—</li><li>å› æ­¤å¦‚æœæƒ³è¦è¡¨ç¤ºæˆä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥åœ¨æƒ³è¦è¡¨è¾¾çš„ä¸œè¥¿çš„å¤–éƒ¨åŠ ä¸Šä¸€å¯¹å°æ‹¬å·ä»¥æ’‡æ¸…å…³ç³»</li><li>è¯­å¥ ç”¨åˆ†å·è¿›è¡Œåˆ†éš” åšæŸç§è¡Œä¸º</li><li>è¡¨è¾¾å¼ ç”±è¿ç®—ç¬¦æ„æˆï¼Œå¹¶è¿ç®—äº§ç”Ÿç»“æœçš„è¯­æ³•ç»“æ„ï¼Œç”¨é€—å·è¿›è¡Œåˆ†å‰² æ˜¯ä¼šç”Ÿæˆä¸€ä¸ªå€¼å¾—</li><li>å½“JSæœŸå¾…å¾—åˆ°ä¸€ä¸ªè¯­å¥çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¡¨è¾¾å¼è¯­å¥æ¥åšï¼›ä½†æ˜¯å½“JSæœŸå¾…ä¸€ä¸ªè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œä½ æ˜¯æ— æ³•å¸¦å…¥ä¸€ä¸ªè¯­å¥çš„ï¼Œæ¯”å¦‚if è¯­å¥å°±æ— æ³•ä½œä¸ºä¸€ä¸ªæ–¹æ³•çš„å‚æ•°</li></ul></li><li><p>å‡½æ•°</p><ul><li>å¯ä»¥åå¤è°ƒç”¨çš„ä»£ç å—</li><li>å¯ä»¥æ¥å—è¾“å…¥çš„å‚æ•°ï¼Œ</li><li>ä¸‰ç§å£°æ˜å‡½æ•°çš„æ–¹å¼ï¼š<ul><li>function </li><li>å‡½æ•°è¡¨è¾¾å¼<ul><li>å‡½æ•°è¡¨è¾¾å¼çš„ç­‰å·å³ä¾§æ˜¯å¯ä»¥æœ‰å‡½æ•°åçš„ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°ååªåœ¨è¿™ä¸ªå‡½æ•°ä½“å†…æœ‰æ•ˆï¼Œå…¶ä»–æ˜¯æ— æ•ˆçš„ </li></ul></li><li>functionæ„é€ å‡½æ•°</li></ul></li><li>å‡½æ•°é‡å¤å£°æ˜ï¼Œåå£°æ˜çš„ä¼šè¦†ç›–å‰é¢å£°æ˜çš„</li><li>è°ƒç”¨å‡½æ•°ï¼Œä½¿ç”¨åœ†æ‹¬å·</li><li>åœ¨JSä¸­ï¼Œå‡¡æ˜¯å¯ä»¥ä½¿ç”¨å€¼çš„åœ°æ–¹ï¼Œå°±å¯ä»¥ä½¿ç”¨å‡½æ•°</li><li>å› ä¸ºå°†å‡½æ•°åè§†ä¸ºå˜é‡åï¼Œæ‰€æœ‰é‡‡ç”¨functionå‘½ä»¤å£°æ˜å‡½æ•°æ—¶ï¼Œæ•´ä¸ªå‡½æ•°ä¼šåƒå˜é‡å£°æ˜ä¸€æ ·ï¼Œæå‡åˆ°ä»£ç çš„å¤´éƒ¨ã€‚</li><li>å‡½æ•°çš„å±æ€§ä¸æ–¹æ³•<ul><li>name<ul><li>æ ¹æ®å®šä¹‰çš„æ–¹æ³•çš„ä¸åŒï¼Œè¿”å›ä¸åŒå€¼<ul><li>å‡½æ•°å®šä¹‰  è¿”å›å‡½æ•°å</li><li>å‡½æ•°è¡¨è¾¾å¼å®šä¹‰  è¿”å›å˜é‡å</li></ul></li></ul></li><li>length<ul><li>è¿”å›å‡½æ•°å®šä¹‰ä¹‹ä¸­çš„å‚æ•°ä¸ªæ•°</li><li>lengthå±æ€§æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œæ¥åˆ¤æ–­å®šä¹‰çš„æ—¶å€™å’Œè°ƒç”¨å‚æ•°çš„å·®å¼‚ï¼Œä»¥ä¾¿å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ–¹æ³•é‡è½½</li></ul></li><li>toString()<ul><li>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯å‡½æ•°çš„æºç  </li></ul></li></ul></li><li>å‡½æ•°ä½œç”¨åŸŸ<ul><li>global variable</li><li>local variable</li><li>å‡½æ•°æ‰§è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œæ˜¯å®šä¹‰æ—¶çš„ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯è°ƒç”¨çš„æ—¶å€™æ‰€åœ¨çš„ä½œç”¨åŸŸ</li></ul></li><li>ä¼ é€’æ–¹å¼<ul><li>å¯¹äºåŸå§‹ç±»å‹æ¥è¯´ï¼Œæ˜¯å€¼ä¼ é€’çš„ (pass by value)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å‡½æ•°ä½“å†…ä¿®æ”¹å‚æ•°å€¼ï¼Œä¸ä¼šå½±å“åˆ°å‡½æ•°çš„å¤–éƒ¨ã€‚</li><li>å¦‚æœå‡½æ•°å‚æ•°æ˜¯å¤åˆç±»å‹çš„å€¼(æ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°),é‚£ä¹ˆä¼ é€’æ–¹å¼å°±æ˜¯ä¼ å€ä¼ é€’ (pass by reference)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ å…¥å‡½æ•°çš„åŸå§‹å€¼çš„åœ°å€ï¼Œå› æ­¤åœ¨å‡½æ•°å†…éƒ¨ä¿®æ”¹å‚æ•°ï¼Œå°†ä¼šå½±å“åˆ°åŸå§‹å€¼ã€‚</li></ul></li><li>argumentså¯¹è±¡<ul><li>å› ä¸ºJSå½“ä¸­å…è®¸å‡½æ•°æœ‰ä¸åŒæ•°ç›®çš„å‚æ•°ï¼Œå› æ­¤éœ€è¦æœ‰ä¸€ç§æœºåˆ¶èƒ½å¤Ÿåœ¨å‡½æ•°ä½“å†…éƒ¨è¯»å–æ‰€æœ‰çš„å‚æ•°ï¼Œå› æ­¤å®šä¹‰äº†argumentså¯¹è±¡æ¥åšè¿™ä»¶äº‹</li><li>argumentså¯¹è±¡åŒ…å«äº†å‡½æ•°è¿è¡Œæ—¶çš„æ‰€æœ‰å‚æ•°</li><li>è€Œä¸”æ³¨æ„argumentså¯¹è±¡ä¸å‡½æ•°å‚æ•°å¹¶ä¸å…·æœ‰è”åŠ¨å…³ç³»ã€‚</li><li>arguments.length è¿”å›å‡½æ•°å®é™…ä¼ å…¥çš„å‚æ•°çš„æ•°é‡</li></ul></li><li>é—­åŒ…<ul><li>JSçš„é“¾å¼ä½œç”¨åŸŸï¼Œå­å¯¹è±¡ä¼šé€çº§å‘ä¸Šå¯»æ‰¾æ‰€æœ‰çˆ¶å¯¹è±¡çš„å˜é‡ï¼Œå› æ­¤çˆ¶å¯¹è±¡çš„æ‰€æœ‰å˜é‡å¯¹å­å¯¹è±¡è€Œè¨€éƒ½æ˜¯å¯è§çš„ï¼Œåä¹‹ä¸æˆç«‹</li><li>é—­åŒ…å°±æ˜¯å‡½æ•°f2ï¼Œä¸ºçš„æ˜¯èƒ½è¯»å–å‡½æ•°å†…éƒ¨çš„å˜é‡ï¼Œå¹¶å°†å…¶ä¼ é€’å‡ºå»ã€‚</li><li>æ˜¯å°†å‡½æ•°å†…éƒ¨å’Œå‡½æ•°å¤–éƒ¨è¿æ¥èµ·æ¥çš„ä¸€åº§æ¡¥æ¢</li></ul></li></ul></li></ul><pre><code>function f1() {  var n = 999;  function f2() {    console.log(n);  }  return f2;}var result = f1();result(); // 999// functionfunction sayHello(var name) {    console.log(&quot;Hello&quot; + name);}// function expression var sayHello = function(var name) {    console.log(&quot;Hello&quot; + name);};// function constructor var add = new Function(    &#39;x&#39;,    &#39;y&#39;,    &#39;return x + y&#39;);// arguments var f = function(a,b) {    arguments[0] = 2;    arguments[1] = 10;    return a + b;}// f(1, 2) ----&gt; 12 </code></pre><ul><li>ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼(IIFE) - immediately invoked function expression<ul><li>åœ¨JSå½“ä¸­ï¼Œåœ†æ‹¬å·æœ¬èº«å°±æ˜¯è¿ç®—ç¬¦ï¼Œè·Ÿåœ¨å‡½æ•°åä¹‹åï¼Œè¡¨ç¤ºè°ƒç”¨äº†è¿™ä¸ªå‡½æ•°</li><li>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®šä¹‰å‡½æ•°ä¹‹åï¼Œç«‹å³è°ƒç”¨è¯¥å‡½æ•°ã€‚è¿™æ—¶ï¼Œä½ ä¸èƒ½åœ¨å‡½æ•°çš„å®šä¹‰ä¹‹ååŠ ä¸Šåœ†æ‹¬å·ï¼Œè¿™ä¼šäº§ç”Ÿè¯­æ³•é”™è¯¯ã€‚</li><li><code>function(){ /* code */ }(); // SyntaxError: Unexpected token</code></li><li>äº§ç”Ÿè¿™ä¸ªé”™è¯¯çš„åŸå› æ˜¯å› ä¸ºfunctionè¿™ä¸ªå…³é”®å­—æ—¢å¯ä»¥ä½œä¸ºè¯­å¥ä¹Ÿå¯ä»¥ä½œä¸ºè¡¨è¾¾å¼ï¼ŒJSå¼•æ“ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œå°±è§„å®šåªè¦functionå…³é”®å­—å‡ºç°åœ¨è¡Œé¦–ï¼Œå°±ä¸€å¾‹è§£é‡Šä¸ºè¯­å¥ã€‚</li><li><code>(function(){}());</code> é€šè¿‡è¿™ç§æ–¹å¼æ¥è¿›è¡Œç›´æ¥çš„è¿è¡Œ</li></ul></li><li>eval æŒ‡ä»¤<ul><li>ç”¨äºåœ¨å½“å‰ä½œç”¨åŸŸå½“ä¸­ï¼Œæ³¨å…¥ä»£ç </li><li>ä½†æ˜¯å› ä¸ºå®‰å…¨é£é™©å’Œä¸åˆ©äºJSå¼•æ“å»ä¼˜åŒ–æ‰§è¡Œé€Ÿåº¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸æ¨èä½¿ç”¨</li><li>æœ€å¸¸è§çš„åœºåˆæ˜¯è§£æJSONæ•°æ®çš„å­—ç¬¦ä¸²ï¼Œä½†ä¸€èˆ¬ç”¨JSON.parseä¼šæ›´åŠ åˆé€‚</li></ul></li><li>æ•°ç»„<ul><li>ä»»ä½•ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥æ”¾å…¥æ•°ç»„</li><li>æ•°ç»„æœ¬èº«æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡</li><li>length å±æ€§  = é”®åä¸­çš„æœ€å¤§æ•´æ•°åŠ ä¸Š1</li><li>æ•°ç»„çš„æ•°å­—é”®ä¸éœ€è¦è¿ç»­ï¼Œlengthå±æ€§çš„å€¼æ€»æ˜¯æ¯”æœ€å¤§çš„æ•´æ•°é”®å¤§1</li><li>å³æ•°ç»„æ˜¯ä¸€ä¸ªåŠ¨æ€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥éšæ—¶å¢å‡æ•°ç»„çš„æˆå‘˜</li><li>æ¸…ç©ºæ•°ç»„å¯ä»¥é€šè¿‡å°†æ•°ç»„çš„é•¿åº¦è®¾ä¸º0æ¥å®ç°çš„</li></ul></li></ul><pre><code>var arr = [&#39;a&#39;, &#39;b&#39;];arr.length // 2arr[2] = &#39;c&#39;;arr.length // 3arr[9] = &#39;d&#39;;arr.length // 10arr[1000] = &#39;e&#39;;arr.length // 1001</code></pre><h2 id="1-4-è¿ç®—ç¬¦"><a href="#1-4-è¿ç®—ç¬¦" class="headerlink" title="1.4 è¿ç®—ç¬¦"></a>1.4 è¿ç®—ç¬¦</h2><ul><li>ç®—æ•°è¿ç®—ç¬¦<ul><li>å¯¹è±¡çš„ç›¸åŠ <ul><li>å¯¹è±¡è½¬æˆåŸå§‹ç±»å‹çš„å€¼çš„è§„åˆ™ä¸ºï¼š</li><li>é¦–å…ˆè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„valueOfæ–¹æ³•ï¼Œä¸€èˆ¬ä¼šè¿”å›å¯¹è±¡æœ¬èº«</li><li>å†è‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„toStringæ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²</li></ul></li></ul></li></ul><pre><code>var obj = {p: 1}obj + 2 // [object Object]2  ----&gt; obj.valueOf().toString()//å¯ä»¥è‡ªå®šä¹‰valueOfæ–¹æ³•çš„var obj = {    valueOf: function() {        return 1;    }};obj + 2 // 3</code></pre><ul><li>æ¯”è¾ƒè¿ç®—ç¬¦</li><li>å¸ƒå°”è¿ç®—ç¬¦<ul><li>!</li><li>&amp;&amp; </li><li>|| </li><li>?:</li></ul></li><li>äºŒè¿›åˆ¶ä½è¿ç®—ç¬¦</li><li>å…¶ä»–è¿ç®—ç¬¦<ul><li>void<ul><li>ä½œç”¨æ˜¯æ‰§è¡Œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä½†æ˜¯ä¸è¿”å›ä»»ä½•å€¼(undefined)</li><li>ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†åœ¨è¶…çº§é“¾æ¥å½“ä¸­å¯ä»¥æ’å…¥ä»£ç ï¼Œä½†æ˜¯åˆä¸äº§ç”Ÿè·³è½¬</li></ul></li><li>é€—å·è¿ç®—ç¬¦<ul><li>ç”¨äºå¯¹ä¸¤ä¸ªè¡¨è¾¾å¼æ±‚å€¼ï¼Œå¹¶ä¸”è¿”å›åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ </li></ul></li></ul></li></ul><pre><code>// ä¸‹è¿°ä»£ç å› ä¸ºonclick return falseæ‰€ä»¥ä¸ä¼šäº§ç”Ÿè·³è½¬çš„&lt;script&gt;function f() {  console.log(&#39;Hello World&#39;);}&lt;/script&gt;&lt;a href=&quot;http://example.com&quot; onclick=&quot;f(); return false;&quot;&gt;ç‚¹å‡»&lt;/a&gt;// å¯ä»¥ç›´æ¥ç”¨void functionæ¥å–ä»£ return falseçš„æ“ä½œ  æ˜¾å¾—æ¸…æ™°ç®€æ´å¾ˆå¤šçš„&lt;a href=&quot;javascript: void(f())&quot;&gt;æ–‡å­—&lt;/a&gt;</code></pre><h1 id="2-å¸¸ç”¨è¯­æ³•"><a href="#2-å¸¸ç”¨è¯­æ³•" class="headerlink" title="2. å¸¸ç”¨è¯­æ³•"></a>2. å¸¸ç”¨è¯­æ³•</h1><h2 id="2-1-æ•°æ®ç±»å‹çš„è½¬æ¢"><a href="#2-1-æ•°æ®ç±»å‹çš„è½¬æ¢" class="headerlink" title="2.1 æ•°æ®ç±»å‹çš„è½¬æ¢"></a>2.1 æ•°æ®ç±»å‹çš„è½¬æ¢</h2><p>å˜é‡æ²¡æœ‰ç±»å‹é™åˆ¶ï¼Œe.g: <code>var x = y ? 1 : &#39;a&#39;</code></p><p>åœ¨ä¸Šè¿°çš„ä¾‹å­å½“ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™æ˜¯ä¸çŸ¥é“åˆ°åº•xæ˜¯ä¸ªæ•°å€¼è¿˜æ˜¯ä¸ªå­—ç¬¦çš„ï¼Œå¿…é¡»ç­‰åˆ°è¿è¡Œçš„æ—¶å€™æ‰å¯ä»¥æœ‰æ•°æ®ã€‚è€ŒJSå½“è¿›è¡Œè¿ç®—çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å®é™…çš„ç±»å‹å’ŒæœŸå¾…çš„ä¸ç›¸ç¬¦ï¼Œä¼šç›´æ¥å°†å…¶è½¬åŒ–ä¸ºæœŸå¾…çš„ç±»å‹çš„ã€‚</p><ul><li>å¼ºåˆ¶è½¬æ¢<ul><li><code>Number()</code><ul><li>å¯ä»¥å°†ä»»æ„ç±»å‹çš„å€¼è½¬åŒ–ä¸ºæ•°å€¼</li><li>Numberå‡½æ•°å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°å€¼ï¼Œè¦æ¯”<code>parseInt</code>ä¸¥æ ¼éå¸¸å¤šï¼Œåªè¦æœ‰ä¸€ä¸ªå­—ç¬¦æ— æ³•è½¬æˆæ•°å€¼ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²å°±åªèƒ½è¢«è½¬åŒ–ä¸ºNaNäº†</li><li>Numberè¿›è¡Œè½¬åŒ–çš„è§„åˆ™ä¸ºï¼š<ul><li>è°ƒç”¨å¯¹è±¡è‡ªèº«çš„valueOfï¼›å¦‚æœä¸ºåŸå§‹ç±»å‹ï¼Œç›´æ¥å¯¹è¯¥å€¼ä½¿ç”¨Numberå‡½æ•°</li><li>å¦‚æœvalueOfè¿”å›çš„è¿˜æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆæ”¹æˆè°ƒç”¨å¯¹è±¡çš„toStringæ–¹æ³•ï¼Œå¦‚æœtoStringæ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼Œå°±å¯¹è¯¥å€¼ä½¿ç”¨Numberå‡½æ•°ï¼Œä¸å†è¿›è¡Œåç»­æ“ä½œ</li><li>å¦‚æœtoStringæ–¹æ³•è¿”å›çš„æ˜¯å¯¹è±¡ï¼Œå°±æŠ¥é”™</li></ul></li></ul></li><li><code>String()</code><ul><li>åŸå§‹ç±»å‹å€¼<ul><li>undefined -&gt; â€œundefinedâ€</li><li>null -&gt; â€œnullâ€</li></ul></li><li>å¯¹è±¡<ul><li>å¯¹è±¡è¿”å›ç±»å‹å­—ç¬¦ä¸²   <code>String({a: 1}) // &quot;[object Object]&quot;</code></li><li>æ•°ç»„è¿”å›å…¶å­—ç¬¦ä¸²å½¢å¼ <code>String([1, 2, 3]) // &quot;1,2,3&quot;</code></li></ul></li></ul></li><li><code>Boolean()</code><ul><li>åªæœ‰ä»¥ä¸‹äº”ä¸ªå€¼çš„è½¬æ¢ç»“æœä¸ºfalse,å…¶ä½™å…¨éƒ¨ä¸ºtrue<ul><li>undefined </li><li>null</li><li>0</li><li>NaN</li><li>â€˜â€™</li></ul></li></ul></li></ul></li></ul><h2 id="2-2-é”™è¯¯å¤„ç†æœºåˆ¶"><a href="#2-2-é”™è¯¯å¤„ç†æœºåˆ¶" class="headerlink" title="2.2 é”™è¯¯å¤„ç†æœºåˆ¶"></a>2.2 é”™è¯¯å¤„ç†æœºåˆ¶</h2><h3 id="2-2-1-Errorå®ä¾‹å¯¹è±¡"><a href="#2-2-1-Errorå®ä¾‹å¯¹è±¡" class="headerlink" title="2.2.1 Errorå®ä¾‹å¯¹è±¡"></a>2.2.1 Errorå®ä¾‹å¯¹è±¡</h3><p>JSè§£ææˆ–è¿è¡Œæ—¶å‘ç”Ÿé”™è¯¯ï¼Œå¼•æ“å°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚JSåŸç”Ÿæä¾›Erroræ„é€ å‡½æ•°ï¼Œæ‰€æœ‰æŠ›å‡ºçš„é”™è¯¯éƒ½æ˜¯è¿™ä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ã€‚</p><pre><code>var error = new Error(&#39;Some error occur&#39;);error.message // &quot;Some error occur&quot;</code></pre><p>Erroræ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºé”™è¯¯æç¤ºï¼Œå¯ä»¥ä»å®ä¾‹çš„messageå±æ€§è¯»åˆ°è¿™ä¸ªå‚æ•°ã€‚æŠ›å‡ºErrorå®ä¾‹å¯¹è±¡ä»¥åï¼Œæ•´ä¸ªç¨‹åºå°±ä¸­æ–­åœ¨å‘ç”Ÿé”™è¯¯çš„åœ°æ–¹ï¼Œä¸å†å¾€ä¸‹æ‰§è¡Œã€‚</p><p>JSå½“ä¸­åªæœ‰Errorçš„messageå±æ€§æ˜¯å¿…å¸¦çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œè¿˜ä¼šæºå¸¦æœ‰<code>name</code>ä»¥åŠ<code>stack</code>çš„ä¿¡æ¯ï¼Œåˆ†åˆ«è¡¨ç¤ºé”™è¯¯çš„åç§°å’Œé”™è¯¯çš„å †æ ˆ</p><h3 id="2-2-2-åŸç”Ÿé”™è¯¯ç±»å‹"><a href="#2-2-2-åŸç”Ÿé”™è¯¯ç±»å‹" class="headerlink" title="2.2.2 åŸç”Ÿé”™è¯¯ç±»å‹"></a>2.2.2 åŸç”Ÿé”™è¯¯ç±»å‹</h3><p>ä¸‹è¿°é”™è¯¯ç±»å‹éƒ½æ˜¯æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒæ¥æ‰‹åŠ¨ç”Ÿæˆé”™è¯¯å¯¹è±¡ã€‚è¿™äº›æ„é€ å‡½æ•°éƒ½æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨é”™è¯¯æç¤ºä¿¡æ¯</p><ul><li>SyntaxError <ul><li>è§£æä»£ç æ—¶å‘ç”Ÿçš„è¯­æ³•é”™è¯¯</li></ul></li><li>ReferenceError<ul><li>å¼•ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡</li><li>æˆ–è€…å°†ä¸€ä¸ªå€¼åˆ†é…ç»™æ— æ³•åˆ†é…çš„å¯¹è±¡</li></ul></li><li>RangeError<ul><li>å€¼è¶…å‡ºæœ‰æ•ˆèŒƒå›´æ—¶å‘ç”Ÿçš„é”™è¯¯<ul><li>æ•°ç»„é•¿åº¦ä¸ºè´Ÿ</li><li>å¯¹è±¡æ–¹æ³•å‚æ•°è¶…å‡ºèŒƒå›´</li><li>å‡½æ•°å †æ ˆè¶…è¿‡æœ€å¤§å€¼</li></ul></li></ul></li><li>TypeError <ul><li>å˜é‡æˆ–è€…å‚æ•°ä¸æ˜¯é¢„æœŸç±»å‹æ—¶å‘ç”Ÿçš„é”™è¯¯ </li></ul></li><li>URIError<ul><li>æ˜¯URIç›¸å…³çš„å‡½æ•°çš„å‚æ•°ä¸æ­£ç¡®æ—¶æŠ›å‡ºçš„é”™è¯¯<ul><li>encodeURI()</li><li>decodeURI()</li><li>encodeURIComponent()</li><li>decodeURIComponent()</li><li>escape()</li><li>unescape() </li></ul></li></ul></li><li>EvalError<ul><li>evalå‡½æ•°æ²¡æœ‰è¢«æ­£ç¡®æ‰§è¡Œ </li></ul></li></ul><h3 id="2-2-3-è‡ªå®šä¹‰é”™è¯¯"><a href="#2-2-3-è‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="2.2.3 è‡ªå®šä¹‰é”™è¯¯"></a>2.2.3 è‡ªå®šä¹‰é”™è¯¯</h3><pre><code>function UserError(msg) {    this.message = msg;    this.name = &quot;UserError&quot;;}// ç»§æ‰¿äº†Errorå¯¹è±¡ï¼Œå£°æ˜å…¶æ„é€ å™¨UserError.prototype = new Error();UserError.prototype.constructor = UserError;</code></pre><p>è€Œåæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>throw</code> æŠ›å‡ºä»»ä½•æˆ‘ä»¬æƒ³æŠ›å‡ºçš„å€¼æˆ–è€…å¯¹è±¡ï¼Œç¨‹åºè¿è¡Œåˆ°throwè¿™é‡Œä¼šç»ˆæ­¢ã€‚</p><h3 id="2-2-4-try-catch-finally"><a href="#2-2-4-try-catch-finally" class="headerlink" title="2.2.4 try - catch - finally"></a>2.2.4 try - catch - finally</h3><p>è¿™é‡Œæ³¨æ„ä¸‰è€…ä¹‹é—´çš„æ‰§è¡Œé¡ºåº </p><p>å…ˆtryï¼Œæ•è·å¼‚å¸¸ï¼Œè€Œåfinallyä»£ç å—æ˜¯ä¸ç®¡æ˜¯å¦å‡ºç°é”™è¯¯ï¼Œéƒ½å¿…é¡»æœ€åè¿è¡Œçš„è¯­å¥</p><pre><code>function cleansUp() {  try {    throw new Error(&#39;å‡ºé”™äº†â€¦â€¦&#39;);    console.log(&#39;æ­¤è¡Œä¸ä¼šæ‰§è¡Œ&#39;);  } finally {    console.log(&#39;å®Œæˆæ¸…ç†å·¥ä½œ&#39;);  }}cleansUp()// å®Œæˆæ¸…ç†å·¥ä½œ// Uncaught Error: å‡ºé”™äº†â€¦â€¦//    at cleansUp (&lt;anonymous&gt;:3:11)//    at &lt;anonymous&gt;:10:1</code></pre><p>ä¸Šè¿°ä¾‹å­å½“ä¸­ï¼Œä¸­æ–­æ‰§è¡Œäº†ï¼Œä¼šå…ˆæ‰§è¡Œfinallyä»£ç å—ï¼Œå†å‘ç”¨æˆ·æç¤ºæŠ¥é”™ä¿¡æ¯ã€‚ä½†æ˜¯å®é™…ä¸Štryæ˜¯å·²ç»æ‰§è¡Œå®Œäº†çš„ï¼Œfinallyä»£ç å—çš„è¿è¡Œä¸èƒ½æ”¹å˜tryé‡Œé¢çš„è¾“å‡ºæˆ–è€…function </p><pre><code>var count = 0;function countUp() {  try {    return count;  } finally {    count++;  }}countUp()// 0count// 1</code></pre><p>ä¸Šè¿°ä¾‹å­è¯æ˜äº†tryå…ˆæ‰§è¡Œå®Œï¼Œæ‰è½®åˆ°finallyï¼Œä½†æ˜¯æ˜¯finallyå…ˆè¿›è¡Œè¾“å‡ºçš„ã€‚</p><p>finallyçš„ç»å…¸åº”ç”¨åœºæ™¯ä¸€èˆ¬è®¾è®¡æ–‡ä»¶æè¿°ç¬¦çš„å…³é—­ï¼š</p><pre><code>openFile();try {  writeFile(Data);} catch(e) {  handleError(e);} finally {  closeFile();}// try catch finally æ‰§è¡Œé¡ºåºçš„ååº”function f() {  try {    console.log(0);    throw &#39;bug&#39;;  } catch(e) {    console.log(1);    return true; // è¿™å¥åŸæœ¬ä¼šå»¶è¿Ÿåˆ° finally ä»£ç å—ç»“æŸå†æ‰§è¡Œ    console.log(2); // ä¸ä¼šè¿è¡Œ  } finally {    console.log(3);    return false; // è¿™å¥ä¼šè¦†ç›–æ‰å‰é¢é‚£å¥ return    console.log(4); // ä¸ä¼šè¿è¡Œ  }  console.log(5); // ä¸ä¼šè¿è¡Œ}var result = f();// 0// 1// 3result// false</code></pre><h2 id="2-3-ç¼–ç¨‹é£æ ¼"><a href="#2-3-ç¼–ç¨‹é£æ ¼" class="headerlink" title="2.3 ç¼–ç¨‹é£æ ¼"></a>2.3 ç¼–ç¨‹é£æ ¼</h2><p>å¯¹äºåŒºå—ï¼Œå¤§æ‹¬å·åº”è¯¥è·Ÿåœ¨è¿™ä¸€è¡Œé‡Œé¢ï¼Œä¸è¦å¦å¤–èµ·ä¸€è¡Œï¼Œå› ä¸ºJavaScriptä¼šè‡ªåŠ¨æ·»åŠ å¥æœ«çš„åˆ†å·ï¼Œå¯¼è‡´ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„é”™è¯¯ã€‚</p><ul><li>åˆ†å·çš„ä½¿ç”¨<ul><li>ä¸ä½¿ç”¨åˆ†å·çš„æƒ…å†µ<ul><li>for/ while</li><li>if/ switch/ try</li><li>å‡½æ•°çš„å£°æ˜è¯­å¥</li></ul></li><li>åˆ†å·çš„è‡ªåŠ¨æ·»åŠ <ul><li>jsä¼šè‡ªåŠ¨æ·»åŠ ï¼Œä½†æ˜¯è¿˜ä¼šçœ‹ä¸‹ä¸€è¡Œèƒ½å¦è¿æ¥èµ·æ¥æˆä¸€æ¡è¯­å¥ï¼Œæˆ–è€…è¡¨è¾¾å¼ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œä¼šç›´æ¥æ¥åšè¿æ¥çš„ </li><li>ä¸€è¡Œçš„èµ·é¦–ä¸ºè‡ªå¢æˆ–è€…è‡ªå‡è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå…¶å‰é¢ä¼šè‡ªåŠ¨æ·»åŠ åˆ†å·</li><li>continue, break, return, throwè¿™å‡ ä¸ªè¯­å¥åé¢å¦‚æœç›´æ¥è·Ÿäº†æ¢è¡Œç¬¦ï¼Œéƒ½æ˜¯ä¼šç›´æ¥æ·»åŠ åˆ†å·çš„</li></ul></li></ul></li><li>switch - case <ul><li>å¯ä»¥å°†å…¶é‡å†™æˆå¯¹è±¡çš„æ ¼å¼ï¼Œ<a href="https://medium.com/chrisburgin/rewriting-javascript-replacing-the-switch-statement-cfff707cf045" target="_blank" rel="noopener">mediumä¸Šçš„ä¾‹å­</a></li><li>switch case ä¸åˆ©äºæ ¼å¼ç»Ÿä¸€ï¼Œæœ‰ç‚¹å¤ªå†—é•¿ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¿˜è®°breakï¼Œç”¨å¯¹è±¡æ˜¯ä¸ªå¾ˆå¥½åœ°é€‰æ‹©å®é™…ä¸Š</li></ul></li></ul><pre><code>function doAction(action) {  switch (action) {    case &#39;hack&#39;:      return &#39;hack&#39;;    case &#39;slash&#39;:      return &#39;slash&#39;;    case &#39;run&#39;:      return &#39;run&#39;;    default:      throw new Error(&#39;Invalid action.&#39;);  }}function doAction(action) {  var actions = {    &#39;hack&#39;: function () {      return &#39;hack&#39;;    },    &#39;slash&#39;: function () {      return &#39;slash&#39;;    },    &#39;run&#39;: function () {      return &#39;run&#39;;    }  };  if (typeof actions[action] !== &#39;function&#39;) {    throw new Error(&#39;Invalid action.&#39;);  }  return actions[action]();}</code></pre><h2 id="2-4-consoleå¯¹è±¡ä¸æ§åˆ¶å°"><a href="#2-4-consoleå¯¹è±¡ä¸æ§åˆ¶å°" class="headerlink" title="2.4 consoleå¯¹è±¡ä¸æ§åˆ¶å°"></a>2.4 consoleå¯¹è±¡ä¸æ§åˆ¶å°</h2><ul><li>console<ul><li>JSçš„åŸç”Ÿå¯¹è±¡ï¼Œå¯ä»¥è¾“å‡ºå„ç§ä¿¡æ¯åˆ°æ§åˆ¶å°ï¼Œå¹¶æä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„è¾…åŠ©æ–¹æ³•</li><li>ç”¨äºè°ƒè¯•ç¨‹åºï¼Œæä¾›ç½‘é¡µä»£ç è¿è¡Œæ—¶çš„é”™è¯¯ä¿¡æ¯</li><li>æä¾›ä¸€ä¸ªå‘½ä»¤è¡Œæ¥å£ï¼Œç”¨æ¥å’Œç½‘é¡µä»£ç äº’åŠ¨</li><li>console.log()<ul><li>å ä½ç¬¦<ul><li>%s</li><li>%d</li><li>%i æ•´æ•°</li><li>%f</li><li>%o å¯¹è±¡çš„é“¾æ¥</li><li>%c cssæ ¼å¼çš„å­—ç¬¦ä¸²<ul><li>å¯¹åº”çš„å‚æ•°å¿…é¡»æ˜¯CSSä»£ç ï¼Œç”¨æ¥å¯¹è¾“å‡ºå†…å®¹è¿›è¡ŒCSSçš„æ¸²æŸ“</li></ul></li></ul></li></ul></li><li>console.table()<ul><li>è¾“å‡ºå¤åˆç±»å‹çš„æ•°æ®ï¼Œä»¥è¡¨æ ¼å½¢å¼è¿›è¡Œæ˜¾ç¤º</li></ul></li><li>console.count()<ul><li>è®°å½•è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡</li></ul></li><li>console.dir()<ul><li>å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ£€æŸ¥ï¼Œä»¥ä¾¿äºé˜…è¯»å’Œæ‰“å°çš„æ ¼å¼æ˜¾ç¤ºå‡ºæ¥</li></ul></li><li>console.dirxml()<ul><li>ç”¨äºä»¥ç›®å½•æ ‘çš„å½¢å¼ï¼Œæ˜¾ç¤ºä¸€ä¸ªDOMèŠ‚ç‚¹</li></ul></li><li>console.time()  console.timeEnd()<ul><li>ç”¨æ¥çœ‹ä¸€ä¸ªæ“ä½œæ‰€èŠ±è´¹çš„å‡†ç¡®æ—¶é—´ã€</li></ul></li><li>console.trace()<ul><li>æ˜¾ç¤ºå½“å‰æ‰§è¡Œçš„ä»£ç åœ¨å †æ ˆä¸­çš„è°ƒç”¨è·¯å¾„ <h1 id="3-æ ‡å‡†åº“"><a href="#3-æ ‡å‡†åº“" class="headerlink" title="3. æ ‡å‡†åº“"></a>3. æ ‡å‡†åº“</h1></li></ul></li></ul></li></ul><h2 id="3-1-Objectå¯¹è±¡"><a href="#3-1-Objectå¯¹è±¡" class="headerlink" title="3.1 Objectå¯¹è±¡"></a>3.1 Objectå¯¹è±¡</h2><pre><code>Object.prototype.print = function () {  console.log(this);};var obj = new Object();obj.print() // Object</code></pre><p>å‡¡æ˜¯å®šä¹‰åœ¨Object.prototypeå¯¹è±¡ä¸Šé¢çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°†è¢«æ‰€æœ‰å®ä¾‹å¯¹è±¡å…±äº«ã€‚<code>Object.prototype</code>å«åšåŸå‹å¯¹è±¡</p><h3 id="3-1-1-Objecté™æ€æ–¹æ³•"><a href="#3-1-1-Objecté™æ€æ–¹æ³•" class="headerlink" title="3.1.1 Objecté™æ€æ–¹æ³•"></a>3.1.1 Objecté™æ€æ–¹æ³•</h3><p>Objecté™æ€æ–¹æ³•æŒ‡çš„æ˜¯éƒ¨ç½²åœ¨Objectå¯¹è±¡è‡ªèº«çš„æ–¹æ³•ã€‚</p><ul><li>Object.keys<ul><li>æ–¹æ³•å‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡</li><li>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜éƒ½æ˜¯è¯¥å¯¹è±¡è‡ªèº«çš„(éç»§æ‰¿çš„)æ‰€æœ‰å±æ€§å</li></ul></li><li>Object.getOwnPropertyNames<ul><li>ä¸Object.keysä¸€æ ·çš„ç”¨æ³•</li><li>ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸ªä¹Ÿä¼šè¿”å›ä¸å¯æšä¸¾çš„å±æ€§å</li></ul></li><li>å¦‚ä½•è®¡ç®—å¯¹è±¡çš„å±æ€§ä¸ªæ•°ï¼Ÿ<ul><li>Object.keys(obj).length </li></ul></li><li>å¯¹è±¡å±æ€§æ¨¡å‹çš„ç›¸å…³æ–¹æ³•<ul><li>Object.getOwnPropertyDescriptor() <ul><li>è·å–æŸä¸ªå±æ€§çš„æè¿°å¯¹è±¡</li></ul></li><li>Object.defineProperty()<ul><li>é€šè¿‡æè¿°å¯¹è±¡ï¼Œå®šä¹‰æŸä¸ªå±æ€§ </li></ul></li><li>Object.defineProperties()</li></ul></li><li>æ§åˆ¶å¯¹è±¡çŠ¶æ€çš„æ–¹æ³•<ul><li>Object.preventExtensions()<ul><li>é˜²æ­¢å¯¹è±¡æ‰©å±•</li><li>ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— æ³•å†æ·»åŠ æ–°çš„å±æ€§</li></ul></li><li>Object.isExtensible()<ul><li>åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ‰©å±•</li></ul></li><li>Object.seal()<ul><li>ç¦æ­¢å¯¹è±¡çš„é…ç½®</li><li>æ— æ³•æ·»åŠ ä¹Ÿæ— æ³•åˆ é™¤å±æ€§</li></ul></li><li>Object.isSealed()</li><li>Object.freeze()<ul><li>å†»ç»“ä¸€ä¸ªå¯¹è±¡</li><li>æ— æ³•æ·»åŠ </li><li>æ— æ³•åˆ é™¤</li><li>æ— æ³•ä¿®æ”¹</li></ul></li><li>Object.isFrozen()<ul><li>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å†»ç»“</li></ul></li></ul></li><li>åŸå‹é“¾ç›¸å…³æ–¹æ³•<ul><li>Object.create()<ul><li>æŒ‡å®šåŸå‹å¯¹è±¡å’Œå±æ€§ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡</li></ul></li><li>Object.getPrototypeOf()<ul><li>è·å–å¯¹è±¡çš„prototypeå¯¹è±¡ </li></ul></li></ul></li></ul><pre><code>var obj = {  p1: 123,  p2: 456};Object.keys(obj) // [&quot;p1&quot;, &quot;p2&quot;]var a = [&#39;Hello&#39;, &#39;World&#39;];Object.keys(a) // [&quot;0&quot;, &quot;1&quot;]Object.getOwnPropertyNames(a) // [&quot;0&quot;, &quot;1&quot;, &quot;length&quot;]</code></pre><h3 id="3-1-2-Objectçš„å®ä¾‹æ–¹æ³•"><a href="#3-1-2-Objectçš„å®ä¾‹æ–¹æ³•" class="headerlink" title="3.1.2 Objectçš„å®ä¾‹æ–¹æ³•"></a>3.1.2 Objectçš„å®ä¾‹æ–¹æ³•</h3><p>æŒ‡çš„æ˜¯å®šä¹‰åœ¨Object.prototypeå¯¹è±¡çš„æ–¹æ³•ï¼Œç§°ä¸ºå®ä¾‹æ–¹æ³•ã€‚æ‰€æœ‰çš„Objectå¯¹è±¡éƒ½ç»§æ‰¿äº†è¿™å‡ ä¸ªæ–¹æ³•ã€‚</p><ul><li><code>Object.prototype.valueOf()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„å€¼ã€‚</li></ul><pre><code>// Object.prototype.valueOf()  è¿”å›å¯¹è±¡æœ¬èº«var obj = new Object();obj.valueOf() === obj; // true</code></pre><ul><li><code>Object.prototype.toString()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„å­—ç¬¦ä¸²å½¢å¼ã€‚<ul><li>toStringæœ¬èº«æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿”å›ç±»å‹å­—ç¬¦ä¸²</li><li>å½“å¯¹ä¸€ä¸ªå¯¹è±¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šè¿”å›å­—ç¬¦ä¸²<code>[object Object]</code></li><li>å¯ä»¥è‡ªå®šä¹‰æ–¹æ³•æ¥è¿”å›æ›´å¤šçš„æœ‰ç”¨ä¿¡æ¯</li><li>æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼Œå‡½æ•°ï¼ŒDateå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„è‡ªå®šä¹‰çš„tostringæ–¹æ³•çš„</li><li>æˆ‘ä»¬å¯ä»¥ç”¨è¿‡<code>Object.prototype.toString.call(value)</code>æ¥åˆ¤æ–­å‡ºä¸€ä¸ªå€¼åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹çš„</li></ul></li></ul><pre><code>var o1 = new Object();o1.toString() // &quot;[object Object]&quot;var o2 = {a:1};o2.toString() // &quot;[object Object]&quot;var obj = new Object();obj.toString = function () {    return &quot;hello, I rewrite the toString() function&quot;;}Object.prototype.toString.call(2) // &quot;[object Number]&quot;Object.prototype.toString.call(&#39;&#39;) // &quot;[object String]&quot;Object.prototype.toString.call(true) // &quot;[object Boolean]&quot;Object.prototype.toString.call(undefined) // &quot;[object Undefined]&quot;Object.prototype.toString.call(null) // &quot;[object Null]&quot;Object.prototype.toString.call(Math) // &quot;[object Math]&quot;Object.prototype.toString.call({}) // &quot;[object Object]&quot;Object.prototype.toString.call([]) // &quot;[object Array]&quot;</code></pre><ul><li><code>Object.prototype.toLocaleString()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„æœ¬åœ°å­—ç¬¦ä¸²å½¢å¼ã€‚<ul><li>ä¸ºçš„å°±æ˜¯ç•™å‡ºä¸€ä¸ªæ¥å£ï¼Œè®©å„ç§ä¸åŒçš„å¯¹è±¡å®ç°è‡ªå·±çš„ç‰ˆæœ¬çš„toLocaleString,ç”¨æ¥è¿”å›é’ˆå¯¹æŸäº›ç‰¹å®šåœ°åŸŸçš„ç‰¹å®šçš„å€¼ </li></ul></li><li><code>Object.prototype.hasOwnProperty()</code>ï¼šåˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦ä¸ºå½“å‰å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„å±æ€§ã€‚<ul><li>æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å®ä¾‹å¯¹è±¡è‡ªèº«æ˜¯å¦æœ‰è¯¥å±æ€§ </li></ul></li><li><code>Object.prototype.isPrototypeOf()</code>ï¼šåˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦ä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ã€‚</li><li><code>Object.prototype.propertyIsEnumerable()</code>ï¼šåˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦å¯æšä¸¾ã€‚ </li></ul><h3 id="3-1-3-Attributes-Object"><a href="#3-1-3-Attributes-Object" class="headerlink" title="3.1.3 Attributes Object"></a>3.1.3 Attributes Object</h3><p>å±æ€§æè¿°å¯¹è±¡ï¼Œæ§åˆ¶å…¶è¡Œä¸ºï¼Œæ¯”å¦‚è¯¥å±æ€§æ˜¯å¦å¯å†™ã€‚å¯éå†ç­‰ç­‰ã€‚</p><p>å±æ€§æè¿°å¯¹è±¡æä¾›äº†6ä¸ªå…ƒå±æ€§</p><ul><li>value </li><li>writable </li><li>enumerable å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å±æ€§æ˜¯å¦å¯éå†</li><li>configurable å¯é…ç½®æ€§ <ul><li>å¦‚æœè®¾ç½®ä¸ºfalse, å°†ç»„ç»‡æŸäº›æ“ä½œæ”¹å†™è¯¥å±æ€§ï¼Œæ¯”å¦‚æ— æ³•åˆ é™¤ï¼Œä¹Ÿä¸å¾—æ”¹å˜è¯¥å±æ€§çš„å±æ€§æè¿°å¯¹è±¡</li></ul></li><li>get<ul><li>å–å€¼å‡½æ•°</li></ul></li><li>set<ul><li>å­˜å€¼å‡½æ•°</li></ul></li></ul><p>å±æ€§å¯ä»¥é€šè¿‡å­˜å–å™¨æ¥è¿›è¡Œå®šä¹‰  </p><p>å­˜å€¼å‡½æ•°ç§°ä¸ºsetterï¼Œå–å€¼å‡½æ•°ç§°ä¸ºgetter </p><pre><code>var obj = Object.defineProperty({}, &#39;p&#39;, {  get: function () {    return &#39;getter&#39;;  },  set: function (value) {    console.log(&#39;setter: &#39; + value);  }});obj.p // &quot;getter&quot;obj.p = 123 // &quot;setter: 123&quot;</code></pre><h1 id="3-2-Arrayå¯¹è±¡"><a href="#3-2-Arrayå¯¹è±¡" class="headerlink" title="3.2 Arrayå¯¹è±¡"></a>3.2 Arrayå¯¹è±¡</h1><h3 id="3-2-1-æ„é€ å‡½æ•°ä¸é™æ€æ–¹æ³•"><a href="#3-2-1-æ„é€ å‡½æ•°ä¸é™æ€æ–¹æ³•" class="headerlink" title="3.2.1 æ„é€ å‡½æ•°ä¸é™æ€æ–¹æ³•"></a>3.2.1 æ„é€ å‡½æ•°ä¸é™æ€æ–¹æ³•</h3><p>Arrayæ˜¯JSçš„åŸç”Ÿå¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨å…¶ç›´æ¥ç”Ÿæˆæ–°çš„æ•°ç»„</p><pre><code>var arr = new Array(2);arr.length // 2</code></pre><ul><li>Array.isArray()<ul><li>åˆ¤æ–­ä¸€ä¸ªobjæ˜¯å¦ä¸ºæ•°ç»„</li><li>è¿™æ ·åšçš„åŸå› æ˜¯ä¸ºäº†å¼¥è¡¥<code>typeof</code>çš„ç¼ºé™·ï¼Œtypeofåªèƒ½è¿”å›æ˜¯å¦ä¸€ä¸ªobjectçš„è¿™ç§ä¿¡æ¯</li></ul></li></ul><h3 id="3-2-2-å®ä¾‹æ–¹æ³•"><a href="#3-2-2-å®ä¾‹æ–¹æ³•" class="headerlink" title="3.2.2  å®ä¾‹æ–¹æ³•"></a>3.2.2  å®ä¾‹æ–¹æ³•</h3><ul><li>valueOf()<ul><li>è¿”å›æ•°ç»„æœ¬èº« </li></ul></li><li>toString() <ul><li>è¿”å›æ•°ç»„çš„å­—ç¬¦ä¸²å½¢å¼</li></ul></li><li>push()<ul><li>åœ¨æ•°ç»„çš„æœ«ç«¯åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›æ·»åŠ æ–°å…ƒç´ ä»¥åçš„æ•°ç»„é•¿åº¦ </li></ul></li><li>pop()<ul><li>popæ–¹æ³•ç”¨äºåˆ é™¤æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ ã€‚æ³¨æ„ï¼Œè¯¥æ–¹æ³•ä¼šæ”¹å˜åŸæ•°ç»„ã€‚</li></ul></li><li>shift()<ul><li>ç”¨äºåˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ </li><li>å¯ä»¥ç”¨æ¥éå†å¹¶ä¸”æ¸…ç©ºä¸€ä¸ªæ•°ç»„</li></ul></li></ul><pre><code>var list = [1,2,3,4];var item;while (item = list.shift()) {    console.log(item);}</code></pre><ul><li>unshift()<ul><li>ç”¨äºåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ ï¼Œå¹¶ä¸”è¿”å›æ–°å…ƒç´ æ·»åŠ ä»¥åçš„æ•°ç»„é•¿åº¦</li></ul></li><li>join()<ul><li>ä»¥æŒ‡å®šå‚æ•°ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°†æ‰€æœ‰æ•°ç»„æˆå‘˜è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›</li><li>å¦‚æœæ•°ç»„æˆå‘˜æ˜¯undefined/ null/ blank, ä¼šè¢«è½¬æˆç©ºå­—ç¬¦ä¸²</li><li>joiné»˜è®¤æ˜¯ç”¨é€—å·æ¥è¿æ¥çš„</li></ul></li></ul><pre><code>var a = [1, 2, 3, 4];a.join(&#39; &#39;) // &#39;1 2 3 4&#39;a.join(&#39; | &#39;) // &quot;1 | 2 | 3 | 4&quot;a.join() // &quot;1,2,3,4&quot;</code></pre><ul><li>concat()<ul><li>ç”¨äºå¤šä¸ªæ•°ç»„çš„åˆå¹¶</li><li>å°†æ–°æ•°ç»„çš„æˆå‘˜ï¼Œæ·»åŠ åˆ°åŸæ•°ç»„æˆå‘˜çš„åé¢ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŸæ•°ç»„ä¸å˜</li></ul></li><li>reverse()</li><li>slice()<ul><li>ç”¨äºæå–ç›®æ ‡æ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŸæ•°ç»„å¹¶ä¸å‘ç”Ÿæ”¹å˜</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºèµ·å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç»ˆæ­¢ä½ç½®ï¼Œä½†æ˜¯è¿™ä¸ªä½ç½®å¹¶ä¸åŒ…å«åœ¨å†…</li><li>å¦‚æœç¬¬äºŒä¸ªå‚æ•°çœç•¥ï¼Œé‚£å°±ä¸€ç›´è¿”å›åˆ°åŸæ•°ç»„çš„æœ€åä¸€ä¸ªæˆå‘˜</li><li>sliceçš„ä¸€ä¸ªé‡è¦åº”ç”¨æ—¶å°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„</li></ul></li></ul><pre><code>Array.prototype.slice.call({ 0: &#39;a&#39;, 1: &#39;b&#39;, length: 2 })// [&#39;a&#39;, &#39;b&#39;]Array.prototype.slice.call(document.querySelectorAll(&quot;div&quot;));Array.prototype.slice.call(arguments);</code></pre><ul><li>splice()<ul><li>åˆ é™¤åŸæ•°ç»„çš„ä¸€éƒ¨åˆ†æˆå‘˜ï¼Œå¹¶å¯ä»¥åœ¨åˆ é™¤çš„ä½ç½®æ·»åŠ æ–°çš„æ•°ç»„æˆå‘˜ï¼Œè¿”å›å€¼æ˜¯è¢«åˆ é™¤çš„å…ƒç´ </li><li><code>arr.splice(start, count, addElement1, addElement2, ...);</code></li></ul></li><li>sort()</li><li>map()<ul><li>å°†æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ä¾æ¬¡ä¼ å…¥å‚æ•°å‡½æ•°ï¼Œç„¶åå°†æ¯ä¸€æ¬¡çš„æ‰§è¡Œç»“æœç»„æˆä¸€ä¸ªæ–°æ•°ç»„è¿”å›</li></ul></li></ul><pre><code>var numbers = [1, 2, 3];numbers.map(function (n) {  return n + 1;});// [2, 3, 4]numbers// [1, 2, 3]</code></pre><ul><li>forEach()<ul><li>ä¸mapæ–¹æ³•ç±»ä¼¼ï¼Œå¯¹æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ä¾æ¬¡æ‰§è¡Œå‚æ•°å‡½æ•°ã€‚ä½†æ˜¯forEachä¸è¿”å›å€¼ï¼Œåªç”¨æ¥æ“ä½œæ•°æ® </li><li>forEachæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ï¼Œç»‘å®šå‚æ•°å‡½æ•°çš„thiså˜é‡</li><li>forEacgæ–¹æ³•æ— æ³•ä¸­æ–­æ‰§è¡Œï¼Œæ€»æ˜¯ä¼šæŠŠæ‰€æœ‰æˆå‘˜éå†å®Œï¼Œå¦‚æœå¸Œæœ›ç¬¦åˆæŸç§æ¡ä»¶å°±ä¸­æ–­éå†ï¼Œé‚£éœ€è¦ä½¿ç”¨forå¾ªç¯</li></ul></li></ul><pre><code>var out = [];[1, 2, 3].forEach(function(elem) {  this.push(elem * elem);}, out);out // [1, 4, 9]</code></pre><ul><li>filter()<ul><li>ç”¨äºè¿‡æ»¤æ•°ç»„æˆå‘˜ï¼Œæ»¡è¶³æ¡ä»¶çš„æˆå‘˜ç»„æˆä¸€ä¸ªæ–°æ•°ç»„è¿”å› </li><li>å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ç»“æœä¸ºtrueçš„æˆå‘˜ç»„æˆä¸€ä¸ªæ–°æ•°ç»„è¿”å›</li></ul></li></ul><pre><code>// å½“å‰æˆå‘˜ï¼Œå½“å‰ä½ç½®ï¼Œæ•´ä¸ªæ•°ç»„[1, 2, 3, 4, 5].filter(function (elem, index, arr) {  return index % 2 === 0;});// [1, 3, 5]var obj = { MAX: 3 };var myFilter = function (item) {  if (item &gt; this.MAX) return true;};var arr = [2, 8, 3, 4, 1, 3, 2, 9];arr.filter(myFilter, obj) // [8, 4, 9]</code></pre><ul><li>some()<ul><li>æœ‰æ»¡è¶³æ¡ä»¶çš„å°±è¿”å›true </li></ul></li><li>every()<ul><li>å…¨éƒ½æ»¡è¶³æ¡ä»¶æ‰è¿”å›true</li></ul></li><li>reduce(), reduceRight()<ul><li>ä¾æ¬¡å¤„ç†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜ï¼Œæœ€ç»ˆç´¯è®¡ä¸ºä¸€ä¸ªå€¼</li><li>reduceä»å·¦åˆ°å³è¿›è¡Œå¤„ç†</li><li>reduceRightä»å³å‘å·¦è¿›è¡Œå¤„ç†</li><li>å››ä¸ªå‚æ•°<ul><li>ç´¯ç§¯å˜é‡</li><li>å½“å‰å˜é‡</li><li>å½“å‰ä½ç½®</li><li>åŸæ•°ç»„</li></ul></li></ul></li></ul><pre><code>function findLongest(entries) {  return entries.reduce(function (longest, entry) {    return entry.length &gt; longest.length ? entry : longest;  }, &#39;&#39;);}findLongest([&#39;aaa&#39;, &#39;bb&#39;, &#39;c&#39;]) // &quot;aaa&quot;</code></pre><ul><li>indexOf()<ul><li>è¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å‡ºç°å°±è¿”å›-1 </li></ul></li><li>lastIndexOf()<ul><li>è¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å‡ºç°å°±è¿”å›-1 </li></ul></li></ul><h2 id="3-3-åŒ…è£…å¯¹è±¡"><a href="#3-3-åŒ…è£…å¯¹è±¡" class="headerlink" title="3.3 åŒ…è£…å¯¹è±¡"></a>3.3 åŒ…è£…å¯¹è±¡</h2><p>ä¸‰ç§åŸå§‹ç±»å‹çš„å€¼ - æ•°å€¼ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼åœ¨ä¸€å®šæ¡ä»¶ä¸‹ä¹Ÿä¼šè‡ªåŠ¨è½¬ä¸ºå¯¹è±¡ï¼Œç§°ä¸ºåŸå§‹ç±»å‹çš„åŒ…è£…å¯¹è±¡ - wrapper</p><pre><code>var v1 = new Number(123);var v2 = new String(&#39;abc&#39;);var v3 = new Boolean(true);typeof v1 // &quot;object&quot;typeof v2 // &quot;object&quot;typeof v3 // &quot;object&quot;v1 === 123 // falsev2 === &#39;abc&#39; // falsev3 === true // false</code></pre><ul><li>valueOf()<ul><li>è¿”å›åŒ…è£…å¯¹è±¡å®ä¾‹å¯¹åº”çš„åŸå§‹ç±»å‹çš„å€¼</li></ul></li><li>toString()<ul><li>è¿”å›å¯¹åº”çš„å­—ç¬¦ä¸²å½¢å¼</li></ul></li><li>åŸå§‹ç±»å‹ä¸å®ä¾‹å¯¹è±¡çš„è‡ªåŠ¨è½¬æ¢<ul><li>ä¸€äº›æ—¶å€™æˆ‘ä»¬å°†åŸå§‹ç±»å‹çš„å€¼è‡ªåŠ¨å½“åšåŒ…è£…å¯¹è±¡æ¥è°ƒç”¨äº†ï¼Œè¿™æ—¶JSå¼•æ“ä¼šè‡ªåŠ¨å°†åŸå§‹ç±»å‹çš„å€¼è½¬ä¸ºåŒ…è£…å¯¹è±¡å®ä¾‹ï¼Œå¹¶åœ¨ä½¿ç”¨åç«‹åˆ»é”€æ¯å®ä¾‹ã€‚</li><li><code>&#39;abc&#39;.length // 3</code></li><li>abcæ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯jsç›´æ¥å°†å…¶è½¬åŒ–ä¸ºäº†å…¶åŒ…è£…å¯¹è±¡ï¼Œå¹¶åœ¨è°ƒç”¨ç»“æŸåï¼Œç›´æ¥é”€æ¯è¿™ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œä»¥æ­¤å®Œæˆæ•´ä¸ªè‡ªåŠ¨è½¬æ¢çš„è¿‡ç¨‹</li></ul></li></ul><h3 id="3-3-1-Booleanå¯¹è±¡"><a href="#3-3-1-Booleanå¯¹è±¡" class="headerlink" title="3.3.1 Booleanå¯¹è±¡"></a>3.3.1 Booleanå¯¹è±¡</h3><pre><code>Boolean(undefined) // falseBoolean(null) // falseBoolean(0) // falseBoolean(&#39;&#39;) // falseBoolean(NaN) // falseBoolean(1) // trueBoolean(&#39;false&#39;) // trueBoolean([]) // trueBoolean({}) // trueBoolean(function () {}) // trueBoolean(/foo/) // true</code></pre><h3 id="3-3-2-Numberå¯¹è±¡"><a href="#3-3-2-Numberå¯¹è±¡" class="headerlink" title="3.3.2 Numberå¯¹è±¡"></a>3.3.2 Numberå¯¹è±¡</h3><ul><li>é™æ€å±æ€§<ul><li>Number.POSITIVE_INFINITY</li><li>Number.NEGATIVE_INFINITY</li><li>Number.NaN</li><li>Number.MIN_VALUE</li><li>Number.MAX_SAFE_INTEGER</li><li>Number.MIN_SAFE_INTEGER</li></ul></li><li>å®ä¾‹æ–¹æ³•<ul><li>Number.prototype.toString()</li><li>Number.prototype.toFixed()<ul><li>å°†ä¸€ä¸ªæ•°è½¬ä¸ºæŒ‡å®šä½æ•°çš„å°æ•°ï¼Œç„¶åè¿”å›è¿™ä¸ªå°æ•°å¯¹åº”çš„å­—ç¬¦ä¸²</li><li><code>(10).toFixed(2) // &quot;10.00&quot;</code></li></ul></li><li>Number.prototype.toExponential()<ul><li><code>(10).toExponential()  // &quot;1e+1&quot;</code></li><li>å‚æ•°æ˜¯å°æ•°ç‚¹åæœ‰æ•ˆæ•°å­—çš„ä½æ•°</li></ul></li><li>Number.prototype.toPrecision()<ul><li><code>(12.34).toPrecision(2) // &quot;12&quot;</code></li><li>å°†æ•°å­—è½¬ä¸ºæŒ‡å®šä½æ•°çš„æœ‰æ•ˆæ•°å­—</li></ul></li></ul></li></ul><h3 id="3-3-3-Stringå¯¹è±¡"><a href="#3-3-3-Stringå¯¹è±¡" class="headerlink" title="3.3.3 Stringå¯¹è±¡"></a>3.3.3 Stringå¯¹è±¡</h3><p>ç”¨æ¥ç”Ÿæˆå­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¼šç”Ÿæˆä¸€ä¸ªéå¸¸ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</p><pre><code>new String(&#39;abc&#39;)// String {0: &quot;a&quot;, 1: &quot;b&quot;, 2: &quot;c&quot;, length: 3}</code></pre><ul><li>é™æ€æ–¹æ³•<ul><li>String.fromCharCode()<ul><li>æ•°å€¼ä»£è¡¨Unicodeç ç‚¹ï¼Œè¿”å›å€¼æ˜¯è¿™äº›ç ç‚¹ç»„æˆçš„å­—ç¬¦ä¸²</li></ul></li></ul></li><li>å®ä¾‹æ–¹æ³•<ul><li>String.prototype.charAt()</li><li>String.prototype.charCodeAt()<ul><li>è¿”å›çš„æ˜¯å­—ç¬¦ä¸²æŒ‡å®šä½ç½®çš„Unicodeç ç‚¹</li></ul></li><li>String.prototype.concat()<ul><li>ç”¨æ¥è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸æ”¹å˜åŸæ¥çš„å­—ç¬¦ä¸²</li><li><code>&#39;a&#39;.concat(&#39;b&#39;, &#39;c&#39;) // &quot;abc&quot;</code></li></ul></li><li>String.prototype.slice()<ul><li>ç”¨äºä»åŸå­—ç¬¦ä¸²å»é™¤å­å­—ç¬¦ä¸²å¹¶è¿”å›ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼ˆä¸å«è¯¥ä½ç½®ï¼‰ã€‚ </li></ul></li><li>String.prototype.substr()<ul><li>ä»åŸå­—ç¬¦ä¸²å–å‡ºå­å­—ç¬¦ä¸²å¹¶è¿”å›ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²çš„é•¿åº¦</li></ul></li><li>String.prototype.indexOf()ï¼ŒString.prototype.lastIndexOf()</li><li>String.prototype.trim()<ul><li>å»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºæ ¼ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²</li><li>è¿˜åŒ…æ‹¬ \t \v \n \r</li></ul></li><li>String.prototype.toLowerCase()ï¼ŒString.prototype.toUpperCase()</li><li>String.prototype.match()</li><li>String.prototype.search()<ul><li>è¿”å›å€¼ä¸ºåŒ¹é…çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…åˆ™è¿”å› -1</li></ul></li><li>String.prototype.replace()</li><li>String.prototype.split()<ul><li>æŒ‰ç…§ç»™å®šè§„åˆ™åˆ†å‰²å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªç”±åˆ†å‰²å‡ºæ¥çš„å­å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„</li></ul></li></ul></li></ul><pre><code>&#39;a|b|c&#39;.split(&#39;|&#39;) // [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]&#39;a||c&#39;.split(&#39;|&#39;) // [&#39;a&#39;, &#39;&#39;, &#39;c&#39;]&#39;a|b|c&#39;.split(&#39;|&#39;, 0) // []&#39;a|b|c&#39;.split(&#39;|&#39;, 1) // [&quot;a&quot;]&#39;a|b|c&#39;.split(&#39;|&#39;, 2) // [&quot;a&quot;, &quot;b&quot;]&#39;a|b|c&#39;.split(&#39;|&#39;, 3) // [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]&#39;a|b|c&#39;.split(&#39;|&#39;, 4) // [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</code></pre><h2 id="3-4-Mathå¯¹è±¡"><a href="#3-4-Mathå¯¹è±¡" class="headerlink" title="3.4 Mathå¯¹è±¡"></a>3.4 Mathå¯¹è±¡</h2><p>JSçš„åŸç”Ÿå¯¹è±¡ï¼Œä¸æ˜¯æ„é€ å‡½æ•°ï¼Œæ— æ³•ç”Ÿæˆå¯¹è±¡ï¼Œæ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½éœ€è¦åœ¨Mathå¯¹è±¡ä¸Šè¿›è¡Œè°ƒç”¨</p><ul><li>é™æ€å±æ€§<ul><li>Math.E</li><li>Math.LN2</li><li>Math.LN10</li><li>Math.LOG2E</li><li>Math.PI</li></ul></li><li>é™æ€æ–¹æ³•<ul><li>Math.abs()</li><li>Math.ceil()<ul><li>å‘ä¸Šå–æ•´ </li></ul></li><li>Math.floor()<ul><li>å‘ä¸‹å–æ•´</li></ul></li><li>Math.max()</li><li>Math.min()</li><li>Math.pow() æŒ‡æ•°è¿ç®—</li><li>Math.sqrt()</li><li>Math.log()</li><li>Math.exp() eçš„æŒ‡æ•°</li><li>Math.round() å››èˆäº”å…¥</li><li>Math.random() éšæœºæ•°</li></ul></li></ul><h2 id="3-5-Dateå¯¹è±¡"><a href="#3-5-Dateå¯¹è±¡" class="headerlink" title="3.5 Dateå¯¹è±¡"></a>3.5 Dateå¯¹è±¡</h2><p>ä»¥UTCæ—¶é—´1970å¹´1æœˆ1æ—¥00:00:00ä½œä¸ºæ—¶é—´å…ƒç‚¹ã€‚</p><ul><li>ç›´æ¥è°ƒç”¨Date() è¿”å›å½“å‰æ—¶é—´</li><li>æ„é€ å‡½æ•°<ul><li>å¦‚æœå¸¦å‚æ•°ï¼Œå°±è½¬åŒ–é‚£ä¸ªæ—¶é—´</li><li>ä¸å¸¦ï¼Œå°±æ˜¯å½“å‰æ—¶é—´</li></ul></li><li>é™æ€æ–¹æ³•<ul><li>Date.now() <ul><li>è¿”å›å½“å‰æ—¶é—´è·ç¦»æ—¶é—´é›¶ç‚¹çš„æ¯«ç§’æ•°</li></ul></li><li>Date.parse()<ul><li>è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼Œè¿”å›è¯¥æ—¶é—´è·ç¦»æ—¶é—´é›¶ç‚¹çš„æ¯«ç§’æ•°</li><li>æ—¥æœŸå­—ç¬¦ä¸²éœ€è¦ç¬¦åˆRFC 2822å’Œ ISO8061 ä¸¤ä¸ªæ ‡å‡†</li></ul></li><li>Date.UTC()<ul><li>æ¥æ”¶å¹´æœˆæ—¥ç­‰å˜é‡ä½œä¸ºå‚æ•°ï¼Œè¿”å›è¯¥æ—¶é—´è·ç¦»æ—¶é—´é›¶ç‚¹çš„æ¯«ç§’æ•° </li></ul></li></ul></li><li>to see doc <a href="https://wangdoc.com/javascript/stdlib/date.html" target="_blank" rel="noopener">https://wangdoc.com/javascript/stdlib/date.html</a></li><li>get see doc <a href="https://wangdoc.com/javascript/stdlib/date.html" target="_blank" rel="noopener">https://wangdoc.com/javascript/stdlib/date.html</a></li><li>set see doc <a href="https://wangdoc.com/javascript/stdlib/date.html" target="_blank" rel="noopener">https://wangdoc.com/javascript/stdlib/date.html</a> </li></ul><h2 id="3-6-RegExpå¯¹è±¡"><a href="#3-6-RegExpå¯¹è±¡" class="headerlink" title="3.6 RegExpå¯¹è±¡"></a>3.6 RegExpå¯¹è±¡</h2><p>æä¾›æ­£åˆ™è¡¨è¾¾å¼çš„åŠŸèƒ½ã€‚è¡¨è¾¾æ–‡æœ¬æ¨¡å¼çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å­—é¢é‡ï¼Œä»¥æ–œæ è¡¨ç¤ºå¼€å§‹å’Œç»“æŸï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨RegExpæ„é€ å‡½æ•°</p><pre><code>// å¼•æ“ç¼–è¯‘ä»£ç çš„æ—¶å€™ï¼Œå°±æ–°å»ºæ­£åˆ™è¡¨è¾¾å¼äº†var regex = /xyz/;// è¿è¡Œçš„æ—¶å€™å»ºç«‹var regex = new RegExp(&#39;xyz&#39;);</code></pre><h3 id="3-6-1-å®ä¾‹å±æ€§"><a href="#3-6-1-å®ä¾‹å±æ€§" class="headerlink" title="3.6.1 å®ä¾‹å±æ€§"></a>3.6.1 å®ä¾‹å±æ€§</h3><ul><li>RegExp.prototype.ignoreCaseï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†iä¿®é¥°ç¬¦ã€‚</li><li>RegExp.prototype.globalï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†gä¿®é¥°ç¬¦ã€‚</li><li>RegExp.prototype.multilineï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†mä¿®é¥°ç¬¦ã€‚</li><li>RegExp.prototype.flagsï¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†å·²ç»è®¾ç½®çš„æ‰€æœ‰ä¿®é¥°ç¬¦ï¼ŒæŒ‰å­—æ¯æ’åºã€‚</li></ul><h3 id="3-6-2-å®ä¾‹æ–¹æ³•"><a href="#3-6-2-å®ä¾‹æ–¹æ³•" class="headerlink" title="3.6.2 å®ä¾‹æ–¹æ³•"></a>3.6.2 å®ä¾‹æ–¹æ³•</h3><ul><li>RegExp.prototype.test()<ul><li>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰æ¨¡å¼æ˜¯å¦èƒ½åŒ¹é…å‚æ•°å­—ç¬¦ä¸²</li><li><code>/cat/.test(&#39;cats and dogs&#39;)  // true</code></li></ul></li><li>RegExp.prototype.exec()<ul><li>è¿”å›åŒ¹é…ç»“æœï¼Œå¦‚æœåŒ¹é…ï¼Œå°±è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯åŒ¹é…æˆåŠŸçš„å­å­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›null </li></ul></li><li>String.prototype.match()<ul><li>æ‰€æœ‰åŒ¹é…çš„å­å­—ç¬¦ä¸²</li></ul></li><li>String.prototype.search()<ul><li>æŒ‰ç…§ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæœç´¢ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåŒ¹é…å¼€å§‹çš„ä½ç½®</li></ul></li><li>String.prototype.replace()<ul><li>æŒ‰ç…§ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ›¿æ¢ï¼Œè¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²</li></ul></li><li>String.prototype.split()<ul><li>æŒ‰ç…§ç»™å®šè§„åˆ™è¿›è¡Œå­—ç¬¦ä¸²åˆ†å‰²ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åˆ†å‰²åçš„å„ä¸ªæˆå‘˜ã€‚</li></ul></li></ul><h3 id="3-6-3-å„ç§ç¬¦å·è¡¨ç¤º"><a href="#3-6-3-å„ç§ç¬¦å·è¡¨ç¤º" class="headerlink" title="3.6.3 å„ç§ç¬¦å·è¡¨ç¤º"></a>3.6.3 å„ç§ç¬¦å·è¡¨ç¤º</h3><ul><li>/g<ul><li>åŒ¹é…æ‰€æœ‰ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼ŒæˆåŠŸä¸€æ¬¡ä»¥åå°±åœæ­¢äº†</li></ul></li><li>å°æ‹¬å· </li></ul><pre><code>// å¦‚æœå¸¦æ‹¬å·ï¼Œæ‹¬å·æœ¬èº«çš„ä¹Ÿä¼šè¿”å›çš„&#39;aaa*a*&#39;.split(/(a*)/)// [ &#39;&#39;, &#39;aaa&#39;, &#39;*&#39;, &#39;a&#39;, &#39;*&#39; ]</code></pre><ul><li>å­—é¢é‡å­—ç¬¦<ul><li>å°±æ˜¯ä¸€å¯¹ä¸€çš„åŒ¹é…</li><li>æ¯”å¦‚ /dog/ åªåŒ¹é…åŒ…å«dogçš„</li></ul></li><li>å…ƒå­—ç¬¦<ul><li>ç‚¹å­—ç¬¦  åŒ¹é…ä¸€ä¸ª<ul><li>åŒ¹é…å‡ºäº†å›è½¦\r, æ¢è¡Œ\n, è¡Œåˆ†éš”ç¬¦ \u2028, æ®µåˆ†éš”ç¬¦\u2029ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦</li></ul></li><li>ä½ç½®å­—ç¬¦<ul><li>^<ul><li>è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½® </li></ul></li><li>$<ul><li>è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸçš„ä½ç½®</li></ul></li></ul></li><li>é€‰æ‹©ç¬¦ | <ul><li>è¡¨ç¤ºorçš„å…³ç³» </li><li>e.g <code>cat|dog</code>è¡¨ç¤ºcat or dogéƒ½åŒ¹é…</li></ul></li></ul></li><li>è½¬ä¹‰ç¬¦<ul><li>å¯¹äºæ­£åˆ™è¡¨è¾¾å¼å½“ä¸­æœ¬èº«å°±å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å…ƒå­—ç¬¦çš„å¤„ç†ï¼Œå½“éœ€è¦åŒ¹é…è‡ªèº«çš„æ—¶å€™ï¼Œåœ¨å®ƒä»¬çš„å‰é¢åŠ ä¸Šåæ–œæ  </li></ul></li><li>å­—ç¬¦ç±» <ul><li>è¡¨ç¤ºæœ‰ä¸€ç³»åˆ—å­—ç¬¦å¯ä¾›é€‰æ‹©ï¼Œåªè¦åŒ¹é…å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº† éƒ½æ”¾åˆ°æ–¹æ‹¬å·å½“ä¸­ <code>[]</code></li><li>è„±å­—ç¬¦ <code>^</code><ul><li>è‹¥æ–¹æ‹¬å·å†…ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯[^]ï¼Œåˆ™æ˜¯æ±‚åï¼Œå³é™¤äº†ä¸­æ‹¬å·ä¹‹å†…çš„å­—ç¬¦ä»¥å¤–éƒ½å¯ä»¥è¿›è¡ŒåŒ¹é…</li><li>å¦‚æœæ–¹æ‹¬å·å†…æ²¡æœ‰å…¶ä»–å­—ç¬¦ï¼Œå°±è¡¨ç¤ºåŒ¹é…ä¸€åˆ‡å­—ç¬¦äº†ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦</li><li>æ³¨æ„è„±å­—ç¬¦åªæœ‰åœ¨å­—ç¬¦ç±»çš„ç¬¬ä¸€ä¸ªä½ç½®æ‰æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå¦åˆ™å°±æ˜¯å­—é¢å«ä¹‰</li></ul></li><li>è¿å­—ç¬¦ <code>-</code><ul><li>å¯¹äºè¿ç»­åºåˆ—çš„å­—ç¬¦ï¼Œç”¨è¿å­—ç¬¦æ¥è¿›è¡Œç®€å†™ </li></ul></li></ul></li><li>é¢„å®šä¹‰æ¨¡å¼ - å¸¸è§æ¨¡å¼çš„ç®€å†™æ–¹å¼<ul><li><code>\d</code><ul><li>åŒ¹é… 0-9ä¹‹é—´çš„ä»»æ„æ•°å­—ï¼Œç›¸å½“äº<code>[0-9]</code> </li></ul></li><li><code>\D</code><ul><li>åŒ¹é…æ‰€æœ‰ 0-9ä¹‹å¤–çš„å­—ç¬¦ ç›¸å½“äº <code>[^0-9]</code> </li></ul></li><li><code>\w</code><ul><li>åŒ¹é…ä»»æ„çš„å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œ ç›¸å½“äº<code>[A-Za-z0-9]</code> </li></ul></li><li><code>\W</code><ul><li>åŒ¹é…é™¤äº†å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿ä»¥å¤–çš„å†…å®¹,  ç›¸å½“äº<code>[^A-Za-z0-9]</code> </li></ul></li><li><code>\s</code><ul><li>åŒ¹é…ç©ºæ ¼ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ï¼Œåˆ¶è¡¨ç¬¦ä»¥åŠç©ºæ ¼ç¬¦ï¼Œç›¸å½“äº<code>[\t\r\n\v\f]</code> </li></ul></li><li><code>\S</code><ul><li>åŒ¹é…éç©ºæ ¼çš„å­—ç¬¦ï¼Œç›¸å½“äº <code>[^\t\r\n\v\f]</code> </li></ul></li><li><code>\b</code><ul><li>åŒ¹é…è¯çš„è¾¹ç•Œ </li></ul></li><li><code>\B</code><ul><li>åŒ¹é…è¯çš„å†…éƒ¨ </li></ul></li></ul></li></ul><pre><code>// testå¿…é¡»å‡ºç°åœ¨å¼€å§‹ä½ç½®/^test/.test(&#39;test123&#39;) // true// testå¿…é¡»å‡ºç°åœ¨ç»“æŸä½ç½®/test$/.test(&#39;new test&#39;) // true// ä»å¼€å§‹ä½ç½®åˆ°ç»“æŸä½ç½®åªæœ‰test/^test$/.test(&#39;test&#39;) // true/^test$/.test(&#39;test test&#39;) // false/[abc]/.test(&#39;hello world&#39;) // false/[abc]/.test(&#39;apple&#39;) // truevar s = &#39;Please yes\nmake my day!&#39;;s.match(/yes.*day/) // nulls.match(/yes[^]*day/) // [ &#39;yes\nmake my day&#39;]// \s çš„ä¾‹å­/\s\w*/.exec(&#39;hello world&#39;) // [&quot; world&quot;]// \b çš„ä¾‹å­/\bworld/.test(&#39;hello world&#39;) // true/\bworld/.test(&#39;hello-world&#39;) // true/\bworld/.test(&#39;helloworld&#39;) // false// \B çš„ä¾‹å­/\Bworld/.test(&#39;hello-world&#39;) // false/\Bworld/.test(&#39;helloworld&#39;) // true</code></pre><ul><li>é‡å¤ç±» - <code>{}</code><ul><li>æ¨¡å¼çš„ç²¾å‡†æ¬¡æ•°åŒ¹é…ï¼Œä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤º</li><li><code>{n}</code> <ul><li>æ°å¥½é‡å¤næ¬¡ </li></ul></li><li><code>{n,}</code><ul><li>è‡³å°‘é‡å¤næ¬¡ </li></ul></li><li><code>{n,m}</code><ul><li>é‡å¤ä¸å°‘äºnæ¬¡ä¸å¤šäºmæ¬¡</li></ul></li></ul></li><li>é‡è¯ç¬¦ - ç”¨æ¥è®¾å®šæŸä¸ªæ¨¡å¼å‡ºç°çš„æ¬¡æ•°<ul><li><code>?</code><ul><li>å‡ºç°0æ¬¡æˆ–è€…1æ¬¡</li><li>{0,1}</li></ul></li><li><code>*</code><ul><li>å‡ºç°0æ¬¡æˆ–å¤šæ¬¡</li><li>{0,}</li></ul></li><li><code>+</code><ul><li>å‡ºç°1æ¬¡æˆ–å¤šæ¬¡</li><li>{1,}</li></ul></li></ul></li><li>è´ªå©ªæ¨¡å¼<ul><li>é€šè¿‡åœ¨é‡è¯ç¬¦åé¢åŠ é—®å·ï¼Œä»è´ªå©ªæ¨¡å¼è½¬åŒ–ä¸ºéè´ªå©ªæ¨¡å¼</li></ul></li></ul><pre><code>&#39;abb&#39;.match(/ab*b/) // [&quot;abb&quot;]&#39;abb&#39;.match(/ab*?b/) // [&quot;ab&quot;]&#39;abb&#39;.match(/ab?b/) // [&quot;abb&quot;]&#39;abb&#39;.match(/ab??b/) // [&quot;ab&quot;]</code></pre><ul><li>ä¿®é¥°ç¬¦<ul><li>è¡¨ç¤ºæ¨¡å¼çš„é™„åŠ è§„åˆ™ï¼Œæ”¾åœ¨æ­£åˆ™æ¨¡å¼çš„æœ€å°¾éƒ¨</li><li>ä¿®é¥°ç¬¦å¯ä»¥å•ä¸ªä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å¤šä¸ªä½¿ç”¨</li><li>gä¿®é¥°ç¬¦<ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸäº†ï¼Œé‚£ä¹ˆæ­£åˆ™å¯¹è±¡å°±ä¼šåœæ­¢å‘ä¸‹åŒ¹é…äº†</li><li>gä¿®é¥°ç¬¦ä»£è¡¨å…¨å±€åŒ¹é…ï¼ŒåŠ ä¸Šä»–ä¹‹åï¼Œæ­£åˆ™å¯¹è±¡å°†åŒ¹é…å…¨éƒ¨ç¬¦åˆæ¡ä»¶çš„ç»“æœï¼Œä¸»è¦ç”¨äºæœç´¢æ›¿æ¢</li></ul></li><li>iä¿®é¥°ç¬¦<ul><li>è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ </li></ul></li><li>mä¿®é¥°ç¬¦<ul><li>mä¿®é¥°ç¬¦è¡¨ç¤ºå¤šè¡Œæ¨¡å¼ï¼ˆmultilineï¼‰ï¼Œä¼šä¿®æ”¹^å’Œ$çš„è¡Œä¸ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ˆå³ä¸åŠ mä¿®é¥°ç¬¦æ—¶ï¼‰ï¼Œ^å’Œ$åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹å¤„å’Œç»“å°¾å¤„ï¼ŒåŠ ä¸Šmä¿®é¥°ç¬¦ä»¥åï¼Œ^å’Œ$è¿˜ä¼šåŒ¹é…è¡Œé¦–å’Œè¡Œå°¾ï¼Œå³^å’Œ$ä¼šè¯†åˆ«æ¢è¡Œç¬¦ï¼ˆ\nï¼‰ã€‚ </li></ul></li></ul></li></ul><pre><code>var regex = /b/g;var str = &#39;abba&#39;;regex.test(str); // trueregex.test(str); // trueregex.test(str); // false/abc/.test(&#39;ABC&#39;) // false/abc/i.test(&#39;ABC&#39;) // true/world$/.test(&#39;hello world\n&#39;) // false/world$/m.test(&#39;hello world\n&#39;) // true</code></pre><ul><li>ç»„åŒ¹é…<ul><li>æ‹¬å·è¡¨ç¤ºåˆ†ç»„åŒ¹é…ï¼Œæ‹¬å·ä¸­çš„æ¨¡å¼ç”¨æ¥åŒ¹é…åˆ†ç»„çš„å†…å®¹ + å¯ä»¥ç”¨\nè¡¨ç¤ºç¬¬nä¸ªæ‹¬å·é‡Œé¢çš„å†…å®¹</li><li>éæ•è·ç»„ <code>(?:x)</code><ul><li>è¡¨ç¤ºä¸è¿”å›è¯¥ç»„åŒ¹é…çš„å†…å®¹ </li></ul></li><li>å…ˆè¡Œæ–­è¨€ <code>x(?=y)</code><ul><li>è¡¨ç¤ºåªæœ‰xåœ¨yå‰é¢æ‰åŒ¹é…ï¼Œyä¸ä¼šè¢«è®¡å…¥è¿”å›ç»“æœ</li></ul></li><li>å…ˆè¡Œå¦å®šæ–­è¨€ <code>x(?!y)</code><ul><li>xåªæœ‰ä¸åœ¨yå‰é¢æ‰åŒ¹é…ï¼Œyä¸ä¼šè¢«è®¡å…¥è¿”å›ç»“æœ </li></ul></li></ul></li></ul><pre><code>var m = &#39;abcabc&#39;.match(/(.)b(.)/);m // [&#39;abc&#39;, &#39;a&#39;, &#39;c&#39;]/y(..)(.)\2\1/.test(&#39;yabccab&#39;) // truevar m = &#39;abc&#39;.match(/(?:.)b(.)/);m // [&quot;abc&quot;, &quot;c&quot;]</code></pre><h2 id="3-7-JSONå¯¹è±¡"><a href="#3-7-JSONå¯¹è±¡" class="headerlink" title="3.7 JSONå¯¹è±¡"></a>3.7 JSONå¯¹è±¡</h2><h3 id="3-7-1-JSONæ ¼å¼"><a href="#3-7-1-JSONæ ¼å¼" class="headerlink" title="3.7.1 JSONæ ¼å¼"></a>3.7.1 JSONæ ¼å¼</h3><ol><li>å¤åˆç±»å‹çš„å€¼åªèƒ½æ˜¯æ•°ç»„æˆ–å¯¹è±¡</li><li>åŸå§‹ç±»å‹åªæœ‰å››ç§ï¼šå­—ç¬¦ä¸²ï¼Œæ•°å€¼ï¼Œå¸ƒå°”å€¼å’Œnull</li><li>å­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨åŒå¼•å·è¡¨ç¤ºï¼Œä¸èƒ½ä½¿ç”¨å•å¼•å·</li><li>å¯¹è±¡çš„é”®åå¿…é¡»æ”¾åœ¨åŒå¼•å·é‡Œé¢</li><li>æ•°ç»„æˆ–å¯¹è±¡æœ€åä¸€ä¸ªæˆå‘˜çš„åé¢ï¼Œä¸å¯ä»¥åŠ é€—å·</li></ol><h3 id="3-7-2-JSONå¯¹è±¡"><a href="#3-7-2-JSONå¯¹è±¡" class="headerlink" title="3.7.2 JSONå¯¹è±¡"></a>3.7.2 JSONå¯¹è±¡</h3><ul><li>JSON.stringify()<ul><li>å°†ä¸€ä¸ªå€¼è½¬ä¸ºJSONå­—ç¬¦ä¸²</li><li>ä¼šå¿½ç•¥å¯¹è±¡çš„ä¸å¯éå†çš„å±æ€§</li></ul></li><li>JSON.parse()<ul><li>å°†JSONå­—ç¬¦ä¸²è½¬æˆå¯¹åº”çš„å€¼ </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li><a href="https://wangdoc.com/javascript/" target="_blank" rel="noopener">https://wangdoc.com/javascript/</a> </li><li>è¡¨è¾¾å¼å’Œè¯­å¥ <a href="https://www.cnblogs.com/ziyunfei/archive/2012/09/16/2687589.html" target="_blank" rel="noopener">https://www.cnblogs.com/ziyunfei/archive/2012/09/16/2687589.html</a> </li><li>statement and expressions <a href="https://2ality.com/2012/09/expressions-vs-statements.html" target="_blank" rel="noopener">https://2ality.com/2012/09/expressions-vs-statements.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript - callback function</title>
      <link href="/JavaScript-callback-function/"/>
      <url>/JavaScript-callback-function/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is"><a href="#1-What-is" class="headerlink" title="1. What is"></a>1. What is</h1><ul><li>A function that is to be executed after another function has finished executing â€“ hence the name call back </li><li>In JavaScript, functions are <strong>objects</strong>. Because of this, <strong>functions can take functions as arguments</strong>, and can be returned by other functions. Functions that do this are called <strong>higher-order functions</strong>. Any function that is passed as an argument is called a callback function.</li></ul><h1 id="2-Why-need"><a href="#2-Why-need" class="headerlink" title="2. Why need"></a>2. Why need</h1><p>JS is an event driven language, instead of waiting for a response before moving on, JS will keep executing while listening for other events. </p><pre><code>function first(){  // Simulate a code delay  setTimeout( function(){    console.log(1);  }, 500 );}function second(){  console.log(2);}first();second();// 2, 1</code></pre><p>The above example shows JS didnâ€™t wait for a response from first() before moving on to execute second() </p><h1 id="3-How-to"><a href="#3-How-to" class="headerlink" title="3. How to"></a>3. How to</h1><pre><code>function doHomework(subject, callback) {  alert(`Starting my ${subject} homework.`);  callback();}doHomework(&#39;math&#39;, function() {  alert(&#39;Finished my homework&#39;);});</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://developer.mozilla.org/en-US/docs/Glossary/Callback_function" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Glossary/Callback_function</a></p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Callback </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>i18next tutorial</title>
      <link href="/i18next-tutorial/"/>
      <url>/i18next-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="0-Lessons-SkipInterpolation-option-in-i18next-icu"><a href="#0-Lessons-SkipInterpolation-option-in-i18next-icu" class="headerlink" title="0. Lessons - SkipInterpolation option in i18next-icu"></a>0. Lessons - SkipInterpolation option in i18next-icu</h1><p>Overall it works fine for me, one issue I want to highlight is: currently the skipInterpolication option in i18next-icu is not working, insteand, you could leverage on getResource <a href="https://www.i18next.com/overview/api#getresource" target="_blank" rel="noopener">API</a> to get raw data, and define your own substitution logic with regex. <a href="https://github.com/i18next/i18next-icu/issues/11" target="_blank" rel="noopener">Related github issue</a></p><h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><ul><li>highlights<ul><li>both for front end and back end<ul><li>can be used in nodejs, PHP, IOS, Android, etc. </li></ul></li><li>thorough solution <ul><li>detect the user language </li><li>load the translation </li><li>optionally cache the translation </li><li>extension support <ul><li><a href="https://www.i18next.com/overview/configuration-options" target="_blank" rel="noopener">personalization</a></li></ul></li></ul></li><li>scalability <ul><li>we could separate translations into multiple files and load them on demand  </li></ul></li></ul></li></ul><h1 id="2-Starting-from-Scratch"><a href="#2-Starting-from-Scratch" class="headerlink" title="2. Starting from Scratch"></a>2. Starting from Scratch</h1><h2 id="2-1-Basic-Example"><a href="#2-1-Basic-Example" class="headerlink" title="2.1 Basic Example"></a>2.1 Basic Example</h2><pre><code>// with callback functionimport i18next from &#39;i18next&#39;;i18next.init({  lng: &#39;en&#39;,  debug: true,  resources: {    en: {      translation: {        &quot;key&quot;: &quot;hello world&quot;      }    }  }}, function(err, t) {  // initialized and ready to go!  document.getElementById(&#39;output&#39;).innerHTML = i18next.t(&#39;key&#39;);});// with promisei18next.init({  lng: &#39;en&#39;,  debug: true,  resources: {    en: {      translation: {        &quot;key&quot;: &quot;hello world&quot;      }    }  }}).then(function(t) {  // initialized and ready to go!  document.getElementById(&#39;output&#39;).innerHTML = i18next.t(&#39;key&#39;);});</code></pre><h2 id="2-2-Configuration"><a href="#2-2-Configuration" class="headerlink" title="2.2 Configuration"></a>2.2 Configuration</h2><p>Record options when calling <code>i18next.init(options, callback)</code></p><ul><li>resources </li><li>lng </li><li>fallbackLng<ul><li>language to use if translation in user language are not available </li></ul></li><li>whitelist<ul><li>array of allowed languages </li></ul></li><li>ns <ul><li>string or array of namespaces to load  </li></ul></li><li>detection <ul><li>options for language detection </li></ul></li><li>backend <ul><li>option for backend </li></ul></li><li>cache <ul><li>option for cache layer  </li></ul></li></ul><h1 id="3-API"><a href="#3-API" class="headerlink" title="3. API"></a>3. API</h1><h2 id="3-1-General"><a href="#3-1-General" class="headerlink" title="3.1 General"></a>3.1 General</h2><ul><li>init <ul><li><code>i18next.init(options, callback)</code></li><li>Initialize an i18next instance </li><li>callback will be called after all translations were loaded </li></ul></li><li>use <ul><li><code>i18next.use(module)</code></li><li>load additional plugins to i18next </li></ul></li><li>t <ul><li><code>i18next.t(keys, options)</code></li><li>do translation, we could either use one key as a string or multiple keys as an Array of String. </li></ul></li></ul><pre><code>i18next.t(&#39;my.key&#39;); // -&gt; will return value in set languagei18next.t([&#39;unknown.key&#39;, &#39;my.key&#39;]); // -&gt; will return value for &#39;my.key&#39; in set language</code></pre><ul><li>exists<ul><li><code>i18next.exists(key, options)</code></li><li>same resolve function as t function, return true if a key exists </li></ul></li><li>getFixedT <ul><li><code>i18next.getFixedT(lng, ns)</code></li><li>return a t function that defaults to given language or namespace </li></ul></li></ul><pre><code>// fix language to germanconst de = i18next.getFixedT(&#39;de&#39;);de(&#39;myKey&#39;);// or fix the namespace to anotherNamespaceconst anotherNamespace = i18next.getFixedT(null, &#39;anotherNamespace&#39;);anotherNamespace(&#39;anotherNamespaceKey&#39;); // no need to prefix ns i18n.t(&#39;anotherNamespace:anotherNamespaceKey&#39;);</code></pre><ul><li>changeLanguage <ul><li><code>i18next.changeLanguage(lng, callback)</code></li><li>change the language, the callback will be called as soon translation were loaded or an error occurs while loading </li></ul></li><li>languages <ul><li><code>i18next.languages</code></li><li>a set, that will be used to look up the translation value </li></ul></li><li>loadNamespaces<ul><li><code>i18next.loadNamespaces(ns, callback)</code></li><li>load additional namespaces not defined in init options </li></ul></li></ul><pre><code>i18next.loadNamespaces(&#39;myNamespace&#39;, (err) =&gt; { /* resources have been loaded */ });i18next.loadNamespaces([&#39;myNamespace1&#39;, &#39;myNamespace2&#39;], (err) =&gt; { /* resources have been loaded */ });// using Promisesi18next  .loadNamespaces([&#39;myNamespace1&#39;, &#39;myNamespace2&#39;])  .then(() =&gt; {});</code></pre><ul><li><p>loadLanguages</p><ul><li><code>i18next.loadLanguages(lngs, callbak)</code></li><li>load additional languages not defined in init options </li></ul></li><li><p>reloadResources </p></li><li><p>setDefaultNamespace </p><ul><li>change the default namespace </li></ul></li><li><p>dir </p><ul><li><code>i18next.dir(lng)</code></li><li>return rtl or ltr depending on languages read direction </li></ul></li><li><p>format </p><ul><li><code>i18next.format(data, format, lng)</code></li><li>interpolation.format function exposure on init </li></ul></li></ul><h2 id="3-2-Instance-Creation"><a href="#3-2-Instance-Creation" class="headerlink" title="3.2 Instance Creation"></a>3.2 Instance Creation</h2><ul><li>createInstance <ul><li><code>i18next.createInstance(options, callback)</code></li><li>return a new i18next instance </li></ul></li></ul><pre><code>const newInstance = i18next.createInstance({  fallbackLng: &#39;en&#39;,  ns: [&#39;file1&#39;, &#39;file2&#39;],  defaultNS: &#39;file1&#39;,  debug: true}, (err, t) =&gt; {  if (err) return console.log(&#39;something went wrong loading&#39;, err);  t(&#39;key&#39;); // -&gt; same as i18next.t}));// is the same asconst newInstance = i18next.createInstance();newInstance.init({  fallbackLng: &#39;en&#39;,  ns: [&#39;file1&#39;, &#39;file2&#39;],  defaultNS: &#39;file1&#39;,  debug: true}, (err, t) =&gt; {  if (err) return console.log(&#39;something went wrong loading&#39;, err);  t(&#39;key&#39;); // -&gt; same as i18next.t}));</code></pre><ul><li>cloneInstance <ul><li><code>i18next,cloneInstance(options)</code></li><li>create a clone of the current instance</li><li>share store, plugins, and initial configuration </li><li>can be used to create an instance sharing storage but being independent on set language or default namespaces </li></ul></li></ul><h2 id="3-3-Events"><a href="#3-3-Events" class="headerlink" title="3.3 Events"></a>3.3 Events</h2><ul><li>onInitialized <ul><li><code>i18next.on(&#39;initialized&#39;, function(options){})</code></li><li>get fired after initialization </li></ul></li><li>onLanguageChanged<ul><li><code>i18next.on(&#39;languageChanged&#39;, function(lng){}</code></li><li>get fired when changeLanguage got called </li></ul></li><li>onLoaded <ul><li><code>i18next.on(&#39;loaded&#39;, function(loaded) {})</code></li><li>get fired when loading resources</li></ul></li><li>onFailedLoading<ul><li><code>i18next.on(&#39;failedLoading&#39;, function(lng, ns, msg) {})</code> </li><li>get fired if loading resources failed </li></ul></li><li>onMissingKey<ul><li><code>i18next.on(&#39;missingKey&#39;, function(lngs, namespace, key, res) {})</code></li></ul></li></ul><h2 id="3-4-Store-Events"><a href="#3-4-Store-Events" class="headerlink" title="3.4 Store Events"></a>3.4 Store Events</h2><ul><li>onAdded<ul><li><code>i18next.store.on(&#39;added&#39;, function(lng, ns) {})</code> </li></ul></li><li>onRemoved<ul><li><code>i18next.store.on(&#39;removed&#39;, function(lng, ns) {})</code></li></ul></li></ul><h2 id="3-5-Resource-Handling"><a href="#3-5-Resource-Handling" class="headerlink" title="3.5 Resource Handling"></a>3.5 Resource Handling</h2><p>can be accessed on i18next or i18next.services.resourceStore </p><ul><li>getResource <ul><li><code>i18next.getResource(lng, ns, key, options)</code> </li></ul></li><li>addResource <ul><li><code>i18next.addResource(lng, ns, key, value, options)</code></li></ul></li><li>addResourceBundle<ul><li><code>i18next.addResourceBundle(lng, ns, resources, deep, overwrite)</code></li><li>add a complete bundle </li></ul></li><li>hasResourceBundle </li><li>getDataByLanguage</li><li>getResourceBundle</li><li>removeResourceBUndle </li></ul><h1 id="4-Translation-Function"><a href="#4-Translation-Function" class="headerlink" title="4. Translation Function"></a>4. Translation Function</h1><h2 id="4-1-Essentials"><a href="#4-1-Essentials" class="headerlink" title="4.1 Essentials"></a>4.1 Essentials</h2><h3 id="4-1-1-Accessing-Keys"><a href="#4-1-1-Accessing-Keys" class="headerlink" title="4.1.1 Accessing Keys"></a>4.1.1 Accessing Keys</h3><pre><code>{    &quot;key&quot;: &quot;value of key&quot;,    &quot;look&quot;: {        &quot;deep&quot;: &quot;value of look deep&quot;    }}// use key for translation, then return its valuei18next.t(&#39;key&#39;);// -&gt; &quot;value of key&quot;// key could have its own structure i18next.t(&#39;look.deep&#39;);// -&gt; &quot;value of look deep&quot;</code></pre><h3 id="4-1-2-Passing-default-value"><a href="#4-1-2-Passing-default-value" class="headerlink" title="4.1.2 Passing default value"></a>4.1.2 Passing default value</h3><pre><code>i18next.t(&#39;key&#39;, &#39;default value to show&#39;)</code></pre><h3 id="4-1-3-Accessing-keys-in-different-namespace"><a href="#4-1-3-Accessing-keys-in-different-namespace" class="headerlink" title="4.1.3 Accessing keys in different namespace"></a>4.1.3 Accessing keys in different namespace</h3><p>As mentioned in 5.1, namespace allow you to separate translations into multiple files </p><ul><li>init </li></ul><pre><code>i18next.init({  ns: [&#39;common&#39;, &#39;moduleA&#39;],  defaultNS: &#39;moduleA&#39;});{    &quot;name&quot;: &quot;Module A&quot;}{    &quot;button&quot;: {        &quot;save&quot;: &quot;save&quot;    }}i18next.t(&#39;name&#39;);// -&gt; &quot;Module A&quot;// as shown below, for not default ns, you have to specify the ns name i18next.t(&#39;common:button.save&#39;);// -&gt; &quot;save&quot;</code></pre><h3 id="4-1-4-Multiple-Fallback-Keys"><a href="#4-1-4-Multiple-Fallback-Keys" class="headerlink" title="4.1.4 Multiple Fallback Keys"></a>4.1.4 Multiple Fallback Keys</h3><p>we could call t with an array of key, enable translation with dynamic keys, for a non specific fallback value </p><pre><code>{  &quot;error&quot;: {    &quot;unspecific&quot;: &quot;Something went wrong.&quot;,    &quot;404&quot;: &quot;The page was not found.&quot;  }}// const error = &#39;404&#39;;i18next.t([`error.${error}`, &#39;error.unspecific&#39;]); // -&gt; &quot;The page was not found&quot;// const error = &#39;502&#39;;i18next.t([`error.${error}`, &#39;error.unspecific&#39;]); // -&gt; &quot;Something went wrong&quot;</code></pre><h3 id="4-1-5-Overview-Options"><a href="#4-1-5-Overview-Options" class="headerlink" title="4.1.5 Overview Options"></a>4.1.5 Overview Options</h3><h2 id="4-2-Interpolation"><a href="#4-2-Interpolation" class="headerlink" title="4.2 Interpolation"></a>4.2 Interpolation</h2><p>It enables you to integrate dynamic values into translation. </p><p>Interpolation values get escaped to save you from possible xss attacks</p><h3 id="4-2-1-Basic"><a href="#4-2-1-Basic" class="headerlink" title="4.2.1 Basic"></a>4.2.1 Basic</h3><p>Key by default are strings surrounded by curly brackets</p><pre><code>{    &quot;key&quot;: &quot;{{what}} is {{how}}&quot;}i18next.t(&#39;key&#39;, { what: &#39;i18next&#39;, how: &#39;great&#39; });// -&gt; &quot;i18next is great&quot;// Working with data models{    &quot;key&quot;: &quot;I am {{author.name}}&quot;}const author = {     name: &#39;Jan&#39;,    github: &#39;jamuhl&#39;};i18next.t(&#39;key&#39;, { author });// -&gt; &quot;I am Jan&quot;</code></pre><h3 id="4-2-2-Unescape"><a href="#4-2-2-Unescape" class="headerlink" title="4.2.2 Unescape"></a>4.2.2 Unescape</h3><p>Per default the values get escaped to save you from possible xss attacks, you could toggle excaping off, by either putting <code>-</code> beofre the key, or set the <code>escapeValue</code> option to <code>false</code> when requesting a translation. </p><pre><code>{    &quot;keyEscaped&quot;: &quot;no danger {{myVar}}&quot;,    &quot;keyUnescaped&quot;: &quot;dangerous {{- myVar}}&quot;}i18next.t(&#39;keyEscaped&#39;, { myVar: &#39;&lt;img /&gt;&#39; });// -&gt; &quot;no danger &amp;lt;img &amp;#x2F;&amp;gt;&quot;i18next.t(&#39;keyUnescaped&#39;, { myVar: &#39;&lt;img /&gt;&#39; });// -&gt; &quot;dangerous &lt;img /&gt;&quot;i18next.t(&#39;keyEscaped&#39;, { myVar: &#39;&lt;img /&gt;&#39;, interpolation: { escapeValue: false } });// -&gt; &quot;no danger &lt;img /&gt;&quot; (obviously could be dangerous)</code></pre><h3 id="4-2-3-Additional-Options"><a href="#4-2-3-Additional-Options" class="headerlink" title="4.2.3 Additional Options"></a>4.2.3 Additional Options</h3><p>Prefix/ suffix for interpolation and other options can be overridden in the init options or by passing additional options to the <code>t</code> function. </p><pre><code>i18next.init({    interpolation: { ... }});i18next.t(&#39;key&#39;, {    interpolation: { ... }});</code></pre><ul><li>format </li><li>formatSeparator <ul><li>used to separate format from interpolation value </li></ul></li><li>excape <ul><li><code>function excape(str) {return str;}</code></li></ul></li><li>escapeValue<ul><li>escape passed in values to avoid xss injection </li></ul></li><li>useRawValueToEscape <ul><li>if true, then value passed into escape function is not casted to string, use with custom escape function that does its own type check </li></ul></li><li>prefix </li><li>suffix </li><li>prefixEscaped  escaped prefix for interpolation (regexSafe)</li><li>suffixEscaped  escaped suffix for interpolation (regexSafe)</li><li>unexcapeSuffix</li><li>unescapePrefix</li><li>nestingPrefix</li><li>nestingSuffix</li><li>nestingPrefixEscaped </li><li>nestingSuffixEscaped</li><li>defaultVariables<ul><li>global variables to use in interpolation replacements </li></ul></li><li>maxReplaces<ul><li>after how many interpolation runs to break out before throwing a stack overflow  </li></ul></li></ul><h2 id="4-3-Formatting"><a href="#4-3-Formatting" class="headerlink" title="4.3 Formatting"></a>4.3 Formatting</h2><p>Format numbers/ dates and you can also use this function for custom formattings. </p><h3 id="4-3-1-Basic"><a href="#4-3-1-Basic" class="headerlink" title="4.3.1 Basic"></a>4.3.1 Basic</h3><pre><code>{    &quot;key&quot;: &quot;The current date is {{date, MM/DD/YYYY}}&quot;,    &quot;key2&quot;: &quot;{{text, uppercase}} just uppercased&quot;}i18next.init({    interpolation: {        format: function(value, format, lng) {            if (format === &#39;uppercase&#39;) return value.toUpperCase();            if(value instanceof Date) return moment(value).format(format);            return value;        }    }});i18next.t(&#39;key&#39;, { date: new Date() });// -&gt; &quot;The current date is 07/13/2016&quot;i18next.t(&#39;key2&#39;, { text: &#39;can you hear me&#39; });// =&gt; &quot;CAN YOU HEAR ME just uppercased&quot;i18next.on(&#39;languageChanged&#39;, function(lng) {  moment.locale(lng);});</code></pre><h3 id="4-3-2-Additional-Options"><a href="#4-3-2-Additional-Options" class="headerlink" title="4.3.2 Additional Options"></a>4.3.2 Additional Options</h3><ul><li>format function <ul><li><code>function format(value, format, lng){}</code> </li></ul></li><li>formatSeparator<ul><li>used to separate format from interpolation value </li></ul></li></ul><h2 id="4-4-Plurals"><a href="#4-4-Plurals" class="headerlink" title="4.4 Plurals"></a>4.4 Plurals</h2><p>i18next support plurals by default. </p><pre><code>{  &quot;key&quot;: &quot;item&quot;,  &quot;key_plural&quot;: &quot;items&quot;,  &quot;keyWithCount&quot;: &quot;{{count}} item&quot;,  &quot;keyWithCount_plural&quot;: &quot;{{count}} items&quot;}i18next.t(&#39;key&#39;, {count: 0}); // -&gt; &quot;items&quot;i18next.t(&#39;key&#39;, {count: 1}); // -&gt; &quot;item&quot;i18next.t(&#39;key&#39;, {count: 5}); // -&gt; &quot;items&quot;i18next.t(&#39;key&#39;, {count: 100}); // -&gt; &quot;items&quot;i18next.t(&#39;keyWithCount&#39;, {count: 0}); // -&gt; &quot;0 items&quot;i18next.t(&#39;keyWithCount&#39;, {count: 1}); // -&gt; &quot;1 item&quot;i18next.t(&#39;keyWithCount&#39;, {count: 5}); // -&gt; &quot;5 items&quot;i18next.t(&#39;keyWithCount&#39;, {count: 100}); // -&gt; &quot;100 items&quot;</code></pre><p>Usually the plural suffix could be key_plural directly, but you could find more accurate answer <a href="https://jsfiddle.net/sm9wgLze" target="_blank" rel="noopener">here</a></p><h3 id="4-4-1-Interval-Plurals"><a href="#4-4-1-Interval-Plurals" class="headerlink" title="4.4.1 Interval Plurals"></a>4.4.1 Interval Plurals</h3><p>We could define phrases expressing the number of items lies in a range in following ways </p><pre><code>// add a post processor import i18next from &#39;i18next&#39;;import intervalPlural from &#39;i18next-intervalplural-postprocessor&#39;;i18next  .use(intervalPlural)  .init(i18nextOptions); // define all the keys needed {  &quot;key1&quot;: &quot;{{count}} item&quot;,  &quot;key1_plural&quot;: &quot;{{count}} items&quot;,  &quot;key1_interval&quot;: &quot;(1){one item};(2-7){a few items};(7-inf){a lot of items};&quot;,  &quot;key2&quot;: &quot;{{count}} item&quot;,  &quot;key2_plural&quot;: &quot;{{count}} items&quot;,  &quot;key2_interval&quot;: &quot;(1){one item};(2-7){a few items};&quot;}// sample - running code i18next.t(&#39;key1_interval&#39;, {postProcess: &#39;interval&#39;, count: 1}); // -&gt; &quot;one item&quot;i18next.t(&#39;key1_interval&#39;, {postProcess: &#39;interval&#39;, count: 4}); // -&gt; &quot;a few items&quot;i18next.t(&#39;key1_interval&#39;, {postProcess: &#39;interval&#39;, count: 100}); // -&gt; &quot;a lot of items&quot;// not matching into a range it will fallback to// the regular plural formi18next.t(&#39;key2_interval&#39;, {postProcess: &#39;interval&#39;, count: 1}); // -&gt; &quot;one item&quot;i18next.t(&#39;key2_interval&#39;, {postProcess: &#39;interval&#39;, count: 4}); // -&gt; &quot;a few items&quot;i18next.t(&#39;key2_interval&#39;, {postProcess: &#39;interval&#39;, count: 100}); // -&gt; &quot;100 items&quot;</code></pre><h2 id="4-5-Nesting"><a href="#4-5-Nesting" class="headerlink" title="4.5 Nesting"></a>4.5 Nesting</h2><h3 id="4-5-1-Basic"><a href="#4-5-1-Basic" class="headerlink" title="4.5.1 Basic"></a>4.5.1 Basic</h3><p>Allow you to reference other keys in a translation, could be useful to build glossary terms. </p><pre><code>{    &quot;nesting1&quot;: &quot;1 $t(nesting2)&quot;,    &quot;nesting2&quot;: &quot;2 $t(nesting3)&quot;,    &quot;nesting3&quot;: &quot;3&quot;,}i18next.t(&#39;nesting1&#39;); // -&gt; &quot;1 2 3&quot;</code></pre><p>we could also reference keys from other namespaces by prepending the namespace</p><pre><code>&quot;nesting1&quot;: &quot;1 $t(common:nesting2)&quot;</code></pre><h3 id="4-5-2-Passing-Options-to-nestings"><a href="#4-5-2-Passing-Options-to-nestings" class="headerlink" title="4.5.2 Passing Options to nestings"></a>4.5.2 Passing Options to nestings</h3><pre><code>{      &quot;girlsAndBoys&quot;: &quot;$t(girls, {&#39;count&#39;: {{girls}} }) and {{count}} boy&quot;,      &quot;girlsAndBoys_plural&quot;: &quot;$t(girls, {&#39;count&#39;: {{girls}} }) and {{count}} boys&quot;,      &quot;girls&quot;: &quot;{{count}} girl&quot;,      &quot;girls_plural&quot;: &quot;{{count}} girls&quot;}i18next.t(&#39;girlsAndBoys&#39;, {count: 2, girls: 3});// -&gt; &quot;3 girls and 2 boys&quot;</code></pre><h3 id="4-5-3-Passing-nesting-to-interpolated"><a href="#4-5-3-Passing-nesting-to-interpolated" class="headerlink" title="4.5.3 Passing nesting to interpolated"></a>4.5.3 Passing nesting to interpolated</h3><pre><code>{      &quot;key1&quot;: &quot;hello world&quot;,      &quot;key2&quot;: &quot;say: {{val}}&quot;}i18next.t(&#39;key2&#39;, {val: &#39;$t(key1)&#39;});// -&gt; &quot;say: hello world&quot;</code></pre><h2 id="4-6-Context"><a href="#4-6-Context" class="headerlink" title="4.6 Context"></a>4.6 Context</h2><p>Differ translations by providing a context  â€“ useful to provide gender specific translations </p><pre><code>{      &quot;friend&quot;: &quot;A friend&quot;,      &quot;friend_male&quot;: &quot;A boyfriend&quot;,      &quot;friend_female&quot;: &quot;A girlfriend&quot;}i18next.t(&#39;friend&#39;); // -&gt; &quot;A friend&quot;i18next.t(&#39;friend&#39;, { context: &#39;male&#39; }); // -&gt; &quot;A boyfriend&quot;i18next.t(&#39;friend&#39;, { context: &#39;female&#39; }); // -&gt; &quot;A girlfriend&quot;{      &quot;friend_male&quot;: &quot;A boyfriend&quot;,      &quot;friend_female&quot;: &quot;A girlfriend&quot;,      &quot;friend_male_plural&quot;: &quot;{{count}} boyfriends&quot;,      &quot;friend_female_plural&quot;: &quot;{{count}} girlfriends&quot;}i18next.t(&#39;friend&#39;, {context: &#39;male&#39;, count: 1}); // -&gt; &quot;A boyfriend&quot;i18next.t(&#39;friend&#39;, {context: &#39;female&#39;, count: 1}); // -&gt; &quot;A girlfriend&quot;i18next.t(&#39;friend&#39;, {context: &#39;male&#39;, count: 100}); // -&gt; &quot;100 boyfriends&quot;i18next.t(&#39;friend&#39;, {context: &#39;female&#39;, count: 100}); // -&gt; &quot;100 girlfriends&quot;</code></pre><h2 id="4-7-Objects-and-Arrays"><a href="#4-7-Objects-and-Arrays" class="headerlink" title="4.7 Objects and Arrays"></a>4.7 Objects and Arrays</h2><p>You could return objects or arrays to be used by 3rd party modules localization</p><pre><code>{    &quot;tree&quot;: {        &quot;res&quot;: &quot;added {{something}}&quot;    },    &quot;array&quot;: [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]}i18next.t(&#39;tree&#39;, { returnObjects: true, something: &#39;gold&#39; });// -&gt; { res: &#39;added gold&#39; }i18next.t(&#39;array&#39;, { returnObjects: true });// -&gt; [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</code></pre><h1 id="5-Principles"><a href="#5-Principles" class="headerlink" title="5. Principles"></a>5. Principles</h1><h2 id="5-1-Namespace"><a href="#5-1-Namespace" class="headerlink" title="5.1 Namespace"></a>5.1 Namespace</h2><ul><li>allow you to separate translations thatget loaded into multiple files </li><li>separate files could benefits<ul><li>too many segments in a file make you lose the overview</li><li>not every translation needs to be loaded on the first page, speed up load time </li></ul></li><li>good practice<ul><li>namespace per view/ page</li><li>namespace per application section </li><li>namespace per module which gets lazy loaded </li></ul></li></ul><pre><code>i18next.init({  ns: [&#39;common&#39;, &#39;moduleA&#39;, &#39;moduleB&#39;],  defaultNS: &#39;moduleA&#39;}, (err, t) =&gt; {  i18next.t(&#39;myKey&#39;); // key in moduleA namespace (defined default)  i18next.t(&#39;common:myKey&#39;); // key in common namespace});// load additional namespaces after initializationi18next.loadNamespaces(&#39;anotherNamespace&#39;, (err, t) =&gt; { /* ... */ });</code></pre><h2 id="5-2-Translation-Resolution"><a href="#5-2-Translation-Resolution" class="headerlink" title="5.2 Translation Resolution"></a>5.2 Translation Resolution</h2><p>A overall process on how i18next attempts to translate your keys into the appropriate content for a given location. </p><h3 id="5-2-1-Concepts"><a href="#5-2-1-Concepts" class="headerlink" title="5.2.1 Concepts"></a>5.2.1 Concepts</h3><ul><li>Keys<ul><li>A key is a specific set to text than provides a corresponding value when look up </li></ul></li><li>Languages <ul><li>Language to be used for translating a key </li><li>If a key is not found, you could gracefully fall back to other languages </li></ul></li></ul><h3 id="5-2-2-Resolution-Order"><a href="#5-2-2-Resolution-Order" class="headerlink" title="5.2.2 Resolution Order"></a>5.2.2 Resolution Order</h3><p>When translating a key, i18next tries the first combination of <strong>namespace, language, and key</strong>.  If that doesnâ€™t work, i18next will try to match with a similar key, looking for a key that best fits the plural form, context and singular form in that order. </p><ul><li>similar keys <ul><li>If the specific key is not found, i18next tries to match the key you are looking for with a similar key, looking for a key that best fits the plural form, context, and singular form in that order.</li></ul></li><li>languages<ul><li>i18next will walk through the list of languages, which consists of the current language and the fallback languages.  </li></ul></li><li>namespaces<ul><li>walk through current namespaces and the fallback namespaces </li></ul></li><li>fallback keys <ul><li>if that key is still not found, i18n will walk through the process with the fallbak keys if specified  </li></ul></li><li>key not found <ul><li>will then return the key itself, that being the first key specified if you also specified fallback keys </li></ul></li></ul><h2 id="5-3-Fallback"><a href="#5-3-Fallback" class="headerlink" title="5.3 Fallback"></a>5.3 Fallback</h2><pre><code>{  &quot;error&quot;: {    &quot;unspecific&quot;: &quot;Something went wrong.&quot;,    &quot;404&quot;: &quot;The page was not found.&quot;  }}// const error = &#39;404&#39;;i18next.t([`error.${error}`, &#39;error.unspecific&#39;]) // -&gt; &quot;The page was not found&quot;// const error = &#39;502&#39;;i18next.t([`error.${error}`, &#39;error.unspecific&#39;]) // -&gt; &quot;Something went wrong&quot;</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.i18next.com/" target="_blank" rel="noopener">https://www.i18next.com/</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> JavaScript </tag>
            
            <tag> i18next </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS pseudo class selectors</title>
      <link href="/CSS-pseudo-class-selectors/"/>
      <url>/CSS-pseudo-class-selectors/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-pseudo-selectors"><a href="#1-What-is-pseudo-selectors" class="headerlink" title="1. What is pseudo selectors?"></a>1. What is pseudo selectors?</h1><blockquote><p>Used to style specified parts of an element: </p><ol><li>Style the first letter, or line of an element </li><li>Insert content before, or after the content of an element </li></ol></blockquote><h1 id="2-Why-you-wanna-use-it"><a href="#2-Why-you-wanna-use-it" class="headerlink" title="2. Why you wanna use it?"></a>2. Why you wanna use it?</h1><ul><li>Realize some fancy styling, like you want to highlight the first line or first character in an element </li><li>You want to insert some common element before/after each specific element</li></ul><h1 id="3-How-to-use-it"><a href="#3-How-to-use-it" class="headerlink" title="3. How to use it?"></a>3. How to use it?</h1><pre><code>p::first-line {  color: #ff0000;  font-variant: small-caps;}p::first-letter {  color: #ff0000;  font-size: xx-large;}// you insert gif before every h1h1::before {  content: url(smiley.gif);}h1::after {  content: url(smiley.gif);}::selection {  color: red;  background: yellow;}</code></pre><h1 id="4-Tips"><a href="#4-Tips" class="headerlink" title="4. Tips"></a>4. Tips</h1><h2 id="4-1-Double-colon-versus-single"><a href="#4-1-Double-colon-versus-single" class="headerlink" title="4.1 Double colon versus single"></a>4.1 Double colon versus single</h2><p>The double colon replaced the single-colon notation for pseudo-elements in CSS3. This was an attempt from W3C to distinguish between pseudo-classes and pseudo-elements.</p><p>The single-colon syntax was used for both pseudo-classes and pseudo-elements in CSS2 and CSS1.</p><p>For backward compatibility, the single-colon syntax is acceptable for CSS2 and CSS1 pseudo-elements.</p><p>*<em>Please try to use single instead of double thus it could support almost all browsers *</em></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.w3schools.com/css/css_pseudo_elements.asp" target="_blank" rel="noopener">https://www.w3schools.com/css/css_pseudo_elements.asp</a></li><li><a href="https://css-tricks.com/almanac/selectors/a/after-and-before/" target="_blank" rel="noopener">https://css-tricks.com/almanac/selectors/a/after-and-before/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ€§èƒ½ä¼˜åŒ–(4)-CPUä½¿ç”¨ç‡</title>
      <link href="/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-4-CPU%E4%BD%BF%E7%94%A8%E7%8E%87/"/>
      <url>/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-4-CPU%E4%BD%BF%E7%94%A8%E7%8E%87/</url>
      
        <content type="html"><![CDATA[<p>è¡¡é‡CPUçš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p><ul><li>å¹³å‡è´Ÿè½½</li><li>CPUä¸Šä¸‹æ–‡åˆ‡æ¢</li><li>CPUä½¿ç”¨ç‡</li></ul><h1 id="1-CPUä½¿ç”¨ç‡"><a href="#1-CPUä½¿ç”¨ç‡" class="headerlink" title="1. CPUä½¿ç”¨ç‡"></a>1. CPUä½¿ç”¨ç‡</h1><h2 id="1-1-æ¦‚å¿µ"><a href="#1-1-æ¦‚å¿µ" class="headerlink" title="1.1 æ¦‚å¿µ"></a>1.1 æ¦‚å¿µ</h2><p>Linuxä½œä¸ºä¸€ä¸ªå¤šä»»åŠ¡æ“ä½œç³»ç»Ÿï¼Œå°†æ¯ä¸ªCPUçš„æ—¶é—´åˆ’åˆ†ä¸ºå¾ˆçŸ­çš„æ—¶é—´ç‰‡ï¼Œå†é€šè¿‡è°ƒåº¦å™¨è½®æµåˆ†é…ç»™å„ä¸ªäººç‰©ä½¿ç”¨ï¼Œå› æ­¤é€ æˆå¤šä»»åŠ¡åŒæ—¶è¿è¡Œçš„é”™è§‰ã€‚</p><p>ä¸ºäº†ç»´æŠ¤CPUæ—¶é—´ï¼ŒLinuxé€šè¿‡äº‹å…ˆå®šä¹‰çš„èŠ‚æ‹ç‡ï¼Œè§¦å‘æ—¶é—´ä¸­æ–­ï¼Œå¹¶ä½¿ç”¨å…¨å±€å˜é‡Jiffiesè®°å½•äº†å¼€æœºä»¥æ¥çš„èŠ‚æ‹æ•°ï¼Œæ¯å‘ç”Ÿä¸€æ¬¡æ—¶é—´ä¸­æ–­ï¼ŒJiffiesçš„å€¼å°±åŠ 1.å¯ä»¥é€šè¿‡æŸ¥è¯¢<code>/boot/config</code>å†…æ ¸é€‰é¡¹æ¥æŸ¥çœ‹å…¶é…ç½®ï¼Œä¸€èˆ¬æ¥è¯´è®¾ç½®ä¸º100ï¼Œ250ï¼Œ 1000ç­‰æ•°å€¼ã€‚æ¯”å¦‚å¯¹äº100æ¥è¯´ï¼Œå°±æ˜¯æ¯ç§’è§¦å‘250æ¬¡æ—¶é—´ä¸­æ–­ã€‚</p><p>Linuxé€šè¿‡<code>/proc</code>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå‘ç”¨æˆ·ç©ºé—´æä¾›ç³»ç»Ÿå†…éƒ¨çŠ¶æ€çš„ä¿¡æ¯ï¼Œè€Œ<code>/proc/stat</code>æä¾›çš„å°±æ˜¯ç³»ç»Ÿçš„CPUå’Œä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯</p><ul><li>ä½¿ç”¨man proc æŸ¥è¯¢, éƒ½æ˜¯å’ŒCPUä½¿ç”¨ç‡ç›¸å…³çš„é‡è¦æŒ‡æ ‡<ul><li>user: ç”¨æˆ·æ€CPUæ—¶é—´</li><li>nice: ä½ä¼˜å…ˆçº§ç”¨æˆ·æ€æ—¶é—´</li><li>system: å†…æ ¸æ€CPUæ—¶é—´</li><li>idle: ç©ºé—²æ—¶é—´</li><li>iowait: ç­‰å¾…I/Oçš„CPUæ—¶é—´</li><li>irq: å¤„ç†ç¡¬ä¸­æ–­çš„CPUæ—¶é—´</li><li>softirq: å¤„ç†è½¯ä¸­æ–­çš„CPUæ—¶é—´</li><li>steal: è¿è¡Œåœ¨è™šæ‹Ÿæœºå½“ä¸­ï¼Œè¢«å…¶ä»–è™šæ‹Ÿæœºå ç”¨çš„CPUæ—¶é—´</li><li>guest: è¿è¡Œè™šæ‹Ÿæœºçš„CPUæ—¶é—´</li><li>guest_nice: ä»¥ä½ä¼˜å…ˆçº§è¿è¡Œè™šæ‹Ÿæœºçš„æ—¶é—´</li></ul></li></ul><p><img src="https://i.loli.net/2020/01/31/vbKiQhfYDls4XrH.png" alt="fig1.png"></p><h2 id="1-2-å¦‚ä½•æŸ¥çœ‹"><a href="#1-2-å¦‚ä½•æŸ¥çœ‹" class="headerlink" title="1.2 å¦‚ä½•æŸ¥çœ‹"></a>1.2 å¦‚ä½•æŸ¥çœ‹</h2><ul><li>top<ul><li>æ˜¾ç¤ºç³»ç»Ÿæ€»ä½“çš„CPUå’Œå†…å­˜ä½¿ç”¨çš„æƒ…å†µï¼Œä»¥åŠå„ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µ </li></ul></li><li>ps<ul><li>æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µ </li></ul></li><li>pidstat<ul><li>åˆ†ææ¯ä¸ªè¿›ç¨‹çš„CPUä½¿ç”¨ç‡ </li></ul></li></ul><h2 id="1-3-å¦‚ä½•åˆ†æ"><a href="#1-3-å¦‚ä½•åˆ†æ" class="headerlink" title="1.3 å¦‚ä½•åˆ†æ"></a>1.3 å¦‚ä½•åˆ†æ</h2><ul><li>ä½¿ç”¨Perf<ul><li>perf top<ul><li>æ˜¾ç¤ºå ç”¨CPUæ—¶é’Ÿæœ€å¤šçš„å‡½æ•°æˆ–è€…æŒ‡ä»¤ </li></ul></li><li>perf record<ul><li>å¯ä»¥ä¿å­˜æ•°æ® </li></ul></li><li>perf report</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> CPU Utilization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ€§èƒ½ä¼˜åŒ–(3)-CPU ä¸Šä¸‹æ–‡åˆ‡æ¢</title>
      <link href="/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-3-CPU-%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2/"/>
      <url>/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-3-CPU-%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>å¤šä¸ªè¿›ç¨‹ç«äº‰CPUä¼šå¯¼è‡´ç³»ç»Ÿçš„è´Ÿè½½å‡é«˜ï¼Œè¿™æ˜¯å› ä¸ºCPUä¼šè¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚Linuxæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡æ“ä½œç³»ç»Ÿï¼Œå®ƒå¯ä»¥æ”¯æŒè¿œå¤§äºCPUæ•°é‡çš„ä»»åŠ¡åŒæ—¶è¿›è¡Œï¼Œç„¶è€Œï¼Œå¹¶ä¸æ˜¯çœŸçš„åŒæ—¶è¿è¡Œï¼Œè€Œæ˜¯ç³»ç»Ÿåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ï¼Œå°†CPUè½®æµåˆ†é…ç»™å®ƒä»¬ï¼Œé€ æˆå¤šä»»åŠ¡åŒæ—¶è¿è¡Œçš„é”™è§‰ã€‚</p><p>è€Œåœ¨æ¯ä¸ªä»»åŠ¡è¿è¡Œä¹‹å‰ï¼ŒCPUéœ€è¦çŸ¥é“ä»»åŠ¡ä»å“ªé‡ŒåŠ è½½ï¼Œåˆä»å“ªé‡Œå¼€å§‹è¿è¡Œçš„ã€‚å³<strong><em>ç³»ç»Ÿéœ€è¦äº‹å…ˆè®¾ç½®å¥½CPUå¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨</em></strong>ã€‚</p><p>CPU å¯„å­˜å™¨ï¼Œæ˜¯ CPU å†…ç½®çš„å®¹é‡å°ã€ä½†é€Ÿåº¦æå¿«çš„å†…å­˜ã€‚è€Œç¨‹åºè®¡æ•°å™¨ï¼Œåˆ™æ˜¯ç”¨æ¥å­˜å‚¨ CPU æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ä½ç½®ã€æˆ–è€…å³å°†æ‰§è¡Œçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ä½ç½®ã€‚å®ƒä»¬éƒ½æ˜¯ CPU åœ¨è¿è¡Œä»»ä½•ä»»åŠ¡å‰ï¼Œå¿…é¡»çš„ä¾èµ–ç¯å¢ƒï¼Œå› æ­¤ä¹Ÿè¢«å«åš CPUä¸Šä¸‹æ–‡ã€‚</p><p><img src="https://i.loli.net/2020/01/31/3jaulkJAZwrsYBm.png" alt="fig1.png"></p><p>è€ŒCPUä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå°±æ˜¯å…ˆæŠŠå‰ä¸€ä¸ªä»»åŠ¡çš„CPUä¸Šä¸‹æ–‡ï¼Œ(CPUå¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨)ä¿å­˜èµ·æ¥,ç„¶ååŠ è½½æ–°ä»»åŠ¡çš„ä¸Šä¸‹æ–‡åˆ°è¿™äº›å¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨ï¼Œæœ€åå†è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨æ‰€æŒ‡çš„æ–°ä½ç½®ï¼Œè¿è¡Œæ–°ä»»åŠ¡ã€‚</p><p>è€Œè¿™äº›ä¿å­˜ä¸‹æ¥çš„ä¸Šä¸‹æ–‡ï¼Œä¼šå­˜å‚¨åœ¨ç³»ç»Ÿå†…æ ¸ä¸­ï¼Œå¹¶åœ¨ä»»åŠ¡é‡æ–°è°ƒåº¦æ‰§è¡Œæ—¶å†æ¬¡åŠ è½½è¿›æ¥ã€‚è¿™æ ·å°±èƒ½ä¿è¯ä»»åŠ¡åŸæ¥çš„çŠ¶æ€ä¸å—å½±å“ï¼Œè®©ä»»åŠ¡çœ‹èµ·æ¥è¿˜æ˜¯è¿ç»­è¿è¡Œã€‚</p><p>è€ŒCPUçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¯ä»¥åˆ†ä¸ºå‡ ä¸ªä¸åŒçš„åœºæ™¯ï¼Œè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä»¥åŠä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><h1 id="2-ç³»ç»Ÿè°ƒç”¨"><a href="#2-ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="2 ç³»ç»Ÿè°ƒç”¨"></a>2 ç³»ç»Ÿè°ƒç”¨</h1><p>Linux æŒ‰ç…§ç‰¹æƒç­‰çº§ï¼ŒæŠŠè¿›ç¨‹çš„è¿è¡Œç©ºé—´åˆ†ä¸ºå†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´ï¼Œåˆ†åˆ«å¯¹åº”ç€ä¸‹å›¾ä¸­ï¼Œ CPU ç‰¹æƒç­‰çº§çš„ Ring 0 å’Œ Ring 3ã€‚</p><p><img src="https://i.loli.net/2020/01/31/itzhDSE6eTcVOGP.png" alt="fig2.png"></p><ul><li>å†…æ ¸ç©ºé—´å…·æœ‰æœ€é«˜æƒé™ï¼Œå¯ä»¥ç›´æ¥è®¿é—®æ‰€æœ‰èµ„æº</li><li>ç”¨æˆ·ç©ºé—´åªèƒ½è®¿é—®å—é™èµ„æºï¼Œä¸èƒ½ç›´æ¥è®¿é—®å†…å­˜ç­‰ç¡¬ä»¶è®¾å¤‡ï¼Œå¿…é¡»é€šè¿‡ç³»ç»Ÿè°ƒç”¨é™·å…¥å†…æ ¸çŠ¶æ€ä¸­ï¼Œæ‰èƒ½è®¿é—®è¿™äº›ç‰¹æƒèµ„æºã€‚</li></ul><blockquote><p>è¿›ç¨‹æ—¢å¯ä»¥åœ¨ç”¨æˆ·ç©ºé—´è¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨å†…æ ¸ç©ºé—´ä¸­è¿è¡Œã€‚åˆ†åˆ«ç§°ä¸ºè¿›ç¨‹çš„ç”¨æˆ·æ€å’Œå†…æ ¸æ€ã€‚</p></blockquote><p>ä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„è½¬å˜ï¼Œéœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å®Œæˆã€‚è€Œè¿™å®é™…ä¸Šä¹Ÿå‘ç”Ÿäº†CPUçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒCPU å¯„å­˜å™¨é‡ŒåŸæ¥ç”¨æˆ·æ€çš„æŒ‡ä»¤ä½ç½®ï¼Œéœ€è¦å…ˆä¿å­˜èµ·æ¥ã€‚æ¥ç€ï¼Œä¸ºäº†æ‰§è¡Œå†…æ ¸æ€ä»£ç ï¼ŒCPU å¯„å­˜å™¨éœ€è¦æ›´æ–°ä¸ºå†…æ ¸æ€æŒ‡ä»¤çš„æ–°ä½ç½®ã€‚æœ€åæ‰æ˜¯è·³è½¬åˆ°å†…æ ¸æ€è¿è¡Œå†…æ ¸ä»»åŠ¡ã€‚</p><p>è€Œç³»ç»Ÿè°ƒç”¨ç»“æŸåï¼ŒCPU å¯„å­˜å™¨éœ€è¦æ¢å¤åŸæ¥ä¿å­˜çš„ç”¨æˆ·æ€ï¼Œç„¶åå†åˆ‡æ¢åˆ°ç”¨æˆ·ç©ºé—´ï¼Œç»§ç»­è¿è¡Œè¿›ç¨‹ã€‚æ‰€ä»¥ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šæ˜¯å‘ç”Ÿäº†ä¸¤æ¬¡CPUä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>ç³»ç»Ÿè°ƒç”¨è¿‡ç¨‹ï¼Œä¸ä¼šåˆ‡æ¢è¿›ç¨‹çš„ï¼Œä¸æ¶‰åŠåˆ°è™šæ‹Ÿå†…å­˜ç­‰è¿›ç¨‹ç”¨æˆ·æ€çš„èµ„æºï¼Œä¹Ÿä¸ä¼šåˆ‡æ¢è¿›ç¨‹ã€‚</p><ul><li>è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯æŒ‡ä»ä¸€ä¸ªè¿›ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹è¿è¡Œã€‚</li><li>ç³»ç»Ÿè°ƒç”¨è¿‡ç¨‹ä¸€ç›´åœ¨åŒä¸€ä¸ªè¿›ç¨‹å½“ä¸­</li></ul><h1 id="3-è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#3-è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="3. è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>3. è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢</h1><h2 id="3-1-è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç³»ç»Ÿè°ƒç”¨çš„åŒºåˆ«"><a href="#3-1-è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç³»ç»Ÿè°ƒç”¨çš„åŒºåˆ«" class="headerlink" title="3.1 è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç³»ç»Ÿè°ƒç”¨çš„åŒºåˆ«"></a>3.1 è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç³»ç»Ÿè°ƒç”¨çš„åŒºåˆ«</h2><ul><li>è¿›ç¨‹æ˜¯ç”±å†…æ ¸æ¥ç®¡ç†å’Œè°ƒåº¦çš„ï¼Œ<strong>è¿›ç¨‹çš„åˆ‡æ¢åªèƒ½å‘ç”Ÿåœ¨å†…æ ¸æ€</strong>ã€‚æ‰€ä»¥ï¼Œè¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸ä»…åŒ…æ‹¬äº†<strong>è™šæ‹Ÿå†…å­˜ã€æ ˆã€å…¨å±€å˜é‡</strong>ç­‰ç”¨æˆ·ç©ºé—´çš„èµ„æºï¼Œè¿˜åŒ…æ‹¬äº†<strong>å†…æ ¸å †æ ˆã€å¯„å­˜å™¨</strong>ç­‰å†…æ ¸ç©ºé—´çš„çŠ¶æ€ã€‚</li><li>å› æ­¤ï¼Œè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å°±æ¯”ç³»ç»Ÿè°ƒç”¨æ—¶å¤šäº†ä¸€æ­¥ï¼šåœ¨ä¿å­˜å½“å‰è¿›ç¨‹çš„å†…æ ¸çŠ¶æ€å’Œ CPU å¯„å­˜å™¨ä¹‹å‰ï¼Œéœ€è¦å…ˆæŠŠè¯¥è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ã€æ ˆç­‰ä¿å­˜ä¸‹æ¥ï¼›è€ŒåŠ è½½äº†ä¸‹ä¸€è¿›ç¨‹çš„å†…æ ¸æ€åï¼Œè¿˜éœ€è¦åˆ·æ–°è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜å’Œç”¨æˆ·æ ˆã€‚</li></ul><p><img src="https://i.loli.net/2020/01/31/qum5ICSpUbZcjyR.png" alt="fig3.png"></p><p>æ¯æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢éƒ½éœ€è¦å‡ åçº³ç§’åˆ°æ•°å¾®ç§’çš„ CPU æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´è¿˜æ˜¯ç›¸å½“å¯è§‚çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´ CPU å°†å¤§é‡æ—¶é—´è€—è´¹åœ¨å¯„å­˜å™¨ã€å†…æ ¸æ ˆä»¥åŠè™šæ‹Ÿå†…å­˜ç­‰èµ„æºçš„ä¿å­˜å’Œæ¢å¤ä¸Šï¼Œè¿›è€Œå¤§å¤§ç¼©çŸ­äº†çœŸæ­£è¿è¡Œè¿›ç¨‹çš„æ—¶é—´ã€‚è¿™ä¹Ÿæ­£æ˜¯ä¸Šä¸€èŠ‚ä¸­æˆ‘ä»¬æ‰€è®²çš„ï¼Œå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ <strong>Linux é€šè¿‡ TLBï¼ˆTranslation Lookaside Bufferï¼‰æ¥ç®¡ç†è™šæ‹Ÿå†…å­˜åˆ°ç‰©ç†å†…å­˜çš„æ˜ å°„å…³ç³»</strong>ã€‚å½“è™šæ‹Ÿå†…å­˜æ›´æ–°åï¼ŒTLB ä¹Ÿéœ€è¦åˆ·æ–°ï¼Œå†…å­˜çš„è®¿é—®ä¹Ÿä¼šéšä¹‹å˜æ…¢ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸Šï¼Œç¼“å­˜æ˜¯è¢«å¤šä¸ªå¤„ç†å™¨å…±äº«çš„ï¼Œåˆ·æ–°ç¼“å­˜ä¸ä»…ä¼šå½±å“å½“å‰å¤„ç†å™¨çš„è¿›ç¨‹ï¼Œè¿˜ä¼šå½±å“å…±äº«ç¼“å­˜çš„å…¶ä»–å¤„ç†å™¨çš„è¿›ç¨‹ã€‚</p><h2 id="3-2-ä½•æ—¶éœ€è¦è¿›ç¨‹åˆ‡æ¢"><a href="#3-2-ä½•æ—¶éœ€è¦è¿›ç¨‹åˆ‡æ¢" class="headerlink" title="3.2 ä½•æ—¶éœ€è¦è¿›ç¨‹åˆ‡æ¢"></a>3.2 ä½•æ—¶éœ€è¦è¿›ç¨‹åˆ‡æ¢</h2><p>è¿›ç¨‹è°ƒåº¦çš„æ—¶å€™ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§å’Œç­‰å¾…çš„æ—¶é—´è¿›è¡Œæ’åºï¼Œå¯¹CPUçš„ä½¿ç”¨è¿›è¡Œåˆ†é…ã€‚</p><ol><li>ä¸ºäº†ä¿è¯æ‰€æœ‰è¿›ç¨‹å¯ä»¥å¾—åˆ°å…¬å¹³è°ƒåº¦ï¼ŒCPU æ—¶é—´è¢«åˆ’åˆ†ä¸ºä¸€æ®µæ®µçš„æ—¶é—´ç‰‡ï¼Œè¿™äº›æ—¶é—´ç‰‡å†è¢«è½®æµåˆ†é…ç»™å„ä¸ªè¿›ç¨‹ã€‚è¿™æ ·ï¼Œå½“æŸä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡è€—å°½äº†ï¼Œå°±ä¼šè¢«ç³»ç»ŸæŒ‚èµ·ï¼Œåˆ‡æ¢åˆ°å…¶å®ƒæ­£åœ¨ç­‰å¾… CPU çš„è¿›ç¨‹è¿è¡Œã€‚</li><li><strong>è¿›ç¨‹åœ¨ç³»ç»Ÿèµ„æºä¸è¶³ï¼ˆæ¯”å¦‚å†…å­˜ä¸è¶³ï¼‰æ—¶ï¼Œè¦ç­‰åˆ°èµ„æºæ»¡è¶³åæ‰å¯ä»¥è¿è¡Œ</strong>ï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹ä¹Ÿä¼šè¢«æŒ‚èµ·ï¼Œå¹¶ç”±ç³»ç»Ÿè°ƒåº¦å…¶ä»–è¿›ç¨‹è¿è¡Œã€‚</li><li>å½“è¿›ç¨‹é€šè¿‡ç¡çœ å‡½æ•°  sleep è¿™æ ·çš„æ–¹æ³•å°†è‡ªå·±ä¸»åŠ¨æŒ‚èµ·æ—¶ï¼Œè‡ªç„¶ä¹Ÿä¼šé‡æ–°è°ƒåº¦ã€‚</li><li>å½“æœ‰ä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹è¿è¡Œæ—¶ï¼Œä¸ºäº†ä¿è¯é«˜ä¼˜å…ˆçº§è¿›ç¨‹çš„è¿è¡Œï¼Œå½“å‰è¿›ç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œç”±é«˜ä¼˜å…ˆçº§è¿›ç¨‹æ¥è¿è¡Œã€‚</li><li>å‘ç”Ÿ<strong>ç¡¬ä»¶ä¸­æ–­</strong>æ—¶ï¼ŒCPU ä¸Šçš„è¿›ç¨‹ä¼šè¢«ä¸­æ–­æŒ‚èµ·ï¼Œè½¬è€Œæ‰§è¡Œå†…æ ¸ä¸­çš„ä¸­æ–­æœåŠ¡ç¨‹åºã€‚</li></ol><h1 id="4-çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#4-çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="4. çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>4. çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢</h1><h2 id="4-1-çº¿ç¨‹-vs-è¿›ç¨‹"><a href="#4-1-çº¿ç¨‹-vs-è¿›ç¨‹" class="headerlink" title="4.1 çº¿ç¨‹ vs è¿›ç¨‹"></a>4.1 çº¿ç¨‹ vs è¿›ç¨‹</h2><blockquote><p>çº¿ç¨‹æ˜¯è°ƒåº¦çš„åŸºæœ¬å•æ¸©ï¼Œè€Œè¿›ç¨‹æ˜¯èµ„æºæ‹¥æœ‰çš„åŸºæœ¬å•ä½ã€‚</p></blockquote><ul><li>å†…æ ¸å½“ä¸­çš„ä»»åŠ¡è°ƒåº¦ï¼Œå®é™…ä¸Šçš„è°ƒç”¨å¯¹è±¡æ˜¯çº¿ç¨‹</li><li>è¿›ç¨‹åœ¨ä¸ºçº¿ç¨‹æä¾›è™šæ‹Ÿå†…å­˜ï¼Œå…¨å±€å˜é‡ç­‰èµ„æº</li><li>å½“è¿›ç¨‹æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œè¿™äº›çº¿ç¨‹ä¼šå…±äº«ç›¸åŒçš„è™šæ‹Ÿå†…å­˜å’Œå…¨å±€å˜é‡ç­‰èµ„æºï¼Œè¿™äº›èµ„æºåœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶å€™æ˜¯ä¸éœ€è¦ä¿®æ”¹çš„</li><li>çº¿ç¨‹è‡ªå·±çš„ç§æœ‰æ•°æ®æ¯”å¦‚æ ˆè¿˜æœ‰å¯„å­˜å™¨ï¼Œåœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶å€™æ˜¯éœ€è¦ä¿å­˜çš„</li></ul><h2 id="4-2-çº¿ç¨‹åˆ‡æ¢"><a href="#4-2-çº¿ç¨‹åˆ‡æ¢" class="headerlink" title="4.2 çº¿ç¨‹åˆ‡æ¢"></a>4.2 çº¿ç¨‹åˆ‡æ¢</h2><p>ä¸¤ç§æƒ…å†µï¼š</p><ul><li>ä¸¤ä¸ªçº¿ç¨‹å±äºä¸åŒè¿›ç¨‹ï¼Œå› ä¸ºèµ„æºä¸å…±äº«ï¼Œæ‰€ä»¥åˆ‡æ¢è¿‡ç¨‹è·Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ä¸€æ ·çš„</li><li>ä¸¤ä¸ªçº¿ç¨‹å±äºåŒä¸€ä¸ªè¿›ç¨‹ï¼Œè™šæ‹Ÿå†…å­˜æ˜¯å…±äº«çš„ï¼Œåœ¨åˆ‡æ¢çš„æ—¶å€™ï¼Œè™šæ‹Ÿå†…å­˜ç­‰èµ„æºä¿æŒä¸åŠ¨ï¼Œåªéœ€è¦åˆ‡æ¢çº¿ç¨‹çš„ç§æœ‰æ•°æ®ï¼Œå¯„å­˜å™¨ç­‰ä¸å…±äº«çš„æ•°æ®</li></ul><h1 id="5-ä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#5-ä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="5. ä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>5. ä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢</h1><p>å¿«é€Ÿå“åº”ç¡¬ä»¶æ—¶é—´çš„æ–¹å¼ï¼Œä¸­æ–­å¤„ç†ä¼šæ‰“æ–­è¿›ç¨‹çš„æ­£å¸¸è°ƒåº¦å’Œæ‰§è¡Œï¼Œè½¬è€Œè°ƒç”¨ä¸­æ–­å¤„ç†ç¨‹åºï¼Œå“åº”è®¾å¤‡äº‹ä»¶ã€‚è€Œåœ¨æ‰“æ–­å…¶ä»–è¿›ç¨‹æ—¶ï¼Œéœ€è¦å°†è¿›ç¨‹å½“å‰çš„çŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œè¿™æ ·åœ¨ä¸­æ–­ç»“æŸä»¥åï¼Œè¿›ç¨‹ä»å¯ä»¥ä»åŸæ¥çš„çŠ¶æ€æ¢å¤è¿è¡Œã€‚</p><p>è·Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡ä¸åŒï¼Œä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢å¹¶ä¸æ¶‰åŠåˆ°è¿›ç¨‹çš„ç”¨æˆ·æ€ã€‚æ‰€ä»¥ï¼Œå³ä¾¿ä¸­æ–­è¿‡ç¨‹æ‰“æ–­äº†ä¸€ä¸ªæ­£å¤„åœ¨ç”¨æˆ·æ€çš„è¿›ç¨‹ï¼Œä¹Ÿä¸éœ€è¦ä¿å­˜å’Œæ¢å¤è¿™ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ã€å…¨å±€å˜é‡ç­‰ç”¨æˆ·æ€èµ„æºã€‚ä¸­æ–­ä¸Šä¸‹æ–‡ï¼Œå…¶å®åªåŒ…æ‹¬å†…æ ¸æ€ä¸­æ–­æœåŠ¡ç¨‹åºæ‰§è¡Œæ‰€å¿…éœ€çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬ CPU å¯„å­˜å™¨ã€å†…æ ¸å †æ ˆã€ç¡¬ä»¶ä¸­æ–­å‚æ•°ç­‰ã€‚</p><p>å¯¹åŒä¸€ä¸ª CPU æ¥è¯´ï¼Œä¸­æ–­å¤„ç†æ¯”è¿›ç¨‹æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ï¼Œæ‰€ä»¥ä¸­æ–­ä¸Šä¸‹æ–‡åˆ‡æ¢å¹¶ä¸ä¼šä¸è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢åŒæ—¶å‘ç”Ÿã€‚åŒæ ·é“ç†ï¼Œç”±äºä¸­æ–­ä¼šæ‰“æ–­æ­£å¸¸è¿›ç¨‹çš„è°ƒåº¦å’Œæ‰§è¡Œï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†ä¸­æ–­å¤„ç†ç¨‹åºéƒ½çŸ­å°ç²¾æ‚ï¼Œä»¥ä¾¿å°½å¯èƒ½å¿«çš„æ‰§è¡Œç»“æŸã€‚</p><h1 id="5-å®è·µ"><a href="#5-å®è·µ" class="headerlink" title="5. å®è·µ"></a>5. å®è·µ</h1><h2 id="5-1-ä½¿ç”¨vmstatåˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µ"><a href="#5-1-ä½¿ç”¨vmstatåˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="5.1 ä½¿ç”¨vmstatåˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µ"></a>5.1 ä½¿ç”¨<code>vmstat</code>åˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µ</h2><pre><code># æ¯éš” 5 ç§’è¾“å‡º 1 ç»„æ•°æ®$ vmstat 5procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu----- r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st 0  0      0 7005360  91564 818900    0    0     0     0   25   33  0  0 100  0  0</code></pre><ul><li>cs: æ¯ç§’ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¬¡æ•°</li><li>in: æ¯ç§’ä¸­æ–­çš„æ¬¡æ•°</li><li>r (Running or Runnable): å°±ç»ªé˜Ÿåˆ—çš„é•¿åº¦ï¼Œå³æ­£åœ¨è¿è¡Œå’Œç­‰å¾…CPUçš„è¿›ç¨‹æ•°</li><li>b (Blocked) å¤„äºä¸å¯ä¸­æ–­ç¡çœ çŠ¶æ€çš„è¿›ç¨‹æ•°</li></ul><h2 id="5-2-ä½¿ç”¨pidstat-w-æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…å†µ"><a href="#5-2-ä½¿ç”¨pidstat-w-æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…å†µ" class="headerlink" title="5.2 ä½¿ç”¨pidstat -w æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…å†µ"></a>5.2 ä½¿ç”¨<code>pidstat -w</code> æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æƒ…å†µ</h2><pre><code># æ¯éš” 5 ç§’è¾“å‡º 1 ç»„æ•°æ®$ pidstat -w 5Linux 4.15.0 (ubuntu)  09/23/18  _x86_64_  (2 CPU)08:18:26      UID       PID   cswch/s nvcswch/s  Command08:18:31        0         1      0.20      0.00  systemd08:18:31        0         8      5.40      0.00  rcu_sched...</code></pre><ul><li>cswch: æ¯ç§’èµ„æºä¸Šä¸‹æ–‡åˆ‡æ¢<ul><li>æŒ‡è¿›ç¨‹æ— æ³•è·å–æ‰€éœ€çš„èµ„æºï¼Œå¯¼è‡´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul></li><li>nvcswch: æ¯ç§’éèµ„æºä¸Šä¸‹æ–‡åˆ‡æ¢<ul><li>æŒ‡è¿›ç¨‹ç”±äºæ—¶é—´ç‰‡å·²ç»åˆ°äº†ç­‰åŸå› ï¼Œè¢«ç³»ç»Ÿå¼ºåˆ¶è°ƒåº¦ï¼Œè¿›è€Œå‘ç”Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul></li></ul><h2 id="5-3-ä»-proc-interruptsè¯»å–ä¸­æ–­ä¿¡æ¯"><a href="#5-3-ä»-proc-interruptsè¯»å–ä¸­æ–­ä¿¡æ¯" class="headerlink" title="5.3 ä»/proc/interruptsè¯»å–ä¸­æ–­ä¿¡æ¯"></a>5.3 ä»<code>/proc/interrupts</code>è¯»å–ä¸­æ–­ä¿¡æ¯</h2><p>/procæ˜¯Linuxçš„ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºå†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´ä¹‹é—´çš„é€šä¿¡ã€‚/proc/interruptsæ˜¯è¿™ç§é€šä¿¡æœºåˆ¶çš„ä¸€éƒ¨åˆ†ï¼Œæä¾›äº†ä¸€ä¸ªåªè¯»çš„ä¸­æ–­ä½¿ç”¨æƒ…å†µã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Context Switch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ€§èƒ½ä¼˜åŒ–(2)-å¹³å‡è´Ÿè½½</title>
      <link href="/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-2-%E5%B9%B3%E5%9D%87%E8%B4%9F%E8%BD%BD/"/>
      <url>/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-2-%E5%B9%B3%E5%9D%87%E8%B4%9F%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¦‚ä½•ç†è§£å¹³å‡è´Ÿè½½"><a href="#1-å¦‚ä½•ç†è§£å¹³å‡è´Ÿè½½" class="headerlink" title="1. å¦‚ä½•ç†è§£å¹³å‡è´Ÿè½½"></a>1. å¦‚ä½•ç†è§£å¹³å‡è´Ÿè½½</h1><pre><code>$uptime14:35:36 up 62 days,  2:51,  2 users,  load average: 0.02, 0.70, 1.06</code></pre><p>å½“å‰æ—¶é—´ï¼Œç³»ç»Ÿè¿è¡Œæ—¶é—´ï¼Œæ­£åœ¨ç™»å½•ç”¨æˆ·æ•°</p><p>åé¢çš„ä¸‰ä¸ªæ•°å­—æ˜¯è¿‡å»1min, 5min, 15minçš„å¹³å‡è´Ÿè½½ã€‚</p><blockquote><p>å¹³å‡è´Ÿè½½æ—¶æŒ‡å•ä½æ—¶é—´å†…ï¼Œç³»ç»Ÿå¤„äºå¯è¿è¡ŒçŠ¶æ€å’Œä¸å¯ä¸­æ–­çŠ¶æ€çš„å¹³å‡è¿›ç¨‹æ•°ï¼Œä¹Ÿå°±æ˜¯å¹³å‡æ´»è·ƒè¿›ç¨‹æ•°ï¼Œå®ƒå’ŒCPUä½¿ç”¨ç‡æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚</p></blockquote><blockquote><p>å¯è¿è¡ŒçŠ¶æ€çš„è¿›ç¨‹ï¼šæŒ‡æ­£åœ¨ä½¿ç”¨CPUæˆ–è€…æ­£åœ¨ç­‰å¾…CPUçš„è¿›ç¨‹, ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨<code>ps</code>çœ‹åˆ°çš„å¤„äºRunning/ RunnableçŠ¶æ€çš„è¿›ç¨‹ã€‚</p></blockquote><blockquote><p>ä¸å¯ä¸­æ–­çŠ¶æ€çš„è¿›ç¨‹ï¼šæŒ‡æ­£å¤„äºå†…æ ¸æ€å…³é”®æµç¨‹ä¸­çš„è¿›ç¨‹ï¼Œå¹¶ä¸”è¿™äº›è¿›ç¨‹æ˜¯ä¸å¯ä»¥è¢«æ‰“æ–­çš„ã€‚æ¯”å¦‚ç­‰å¾…ç¡¬ä»¶è®¾å¤‡çš„I/Oå“åº”ï¼Œå³æˆ‘ä»¬åœ¨<code>ps</code>å‘½ä»¤ä¸‹çœ‹åˆ°çš„D(Uninerruptible Sleep/ Disk Sleep)çŠ¶æ€.</p></blockquote><p>ä¾‹å¦‚å½“ä¸€ä¸ªè¿›ç¨‹å‘ç£ç›˜è¯»å†™æ•°æ®æ—¶ï¼Œä¸ºäº†ä¸€è‡´ï¼Œåœ¨å¾—åˆ°ç£ç›˜å›å¤ä¹‹å‰ï¼Œæ˜¯ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹æˆ–è€…ä¸­æ–­æ‰“æ–­çš„ã€‚å¦åˆ™å®¹æ˜“å‡ºç°ç£ç›˜æ•°æ®ä¸è¿›ç¨‹æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p>ä¸å¯ä¸­æ–­çŠ¶æ€å®é™…ä¸Šæ˜¯ç³»ç»Ÿå¯¹è¿›ç¨‹å’Œç¡¬ä»¶è®¾å¤‡çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚</p><p>å¹³å‡è´Ÿè½½ -&gt; å¹³å‡æ´»è·ƒè¿›ç¨‹æ•° -&gt; å•ä½æ—¶é—´å†…çš„æ´»è·ƒè¿›ç¨‹æ•°.æœ€ç†æƒ³çš„æƒ…å†µå°±æ˜¯æ¯ä¸ªCPUéƒ½åˆšå¥½è¿è¡Œç€ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·æ¯ä¸€ä¸ªCPUéƒ½èƒ½å¾—åˆ°å……åˆ†çš„åˆ©ç”¨ã€‚</p><h1 id="2-å¹³å‡è´Ÿè½½ä¸ºå¤šå°‘æ—¶æ¯”è¾ƒåˆç†ï¼Ÿ"><a href="#2-å¹³å‡è´Ÿè½½ä¸ºå¤šå°‘æ—¶æ¯”è¾ƒåˆç†ï¼Ÿ" class="headerlink" title="2. å¹³å‡è´Ÿè½½ä¸ºå¤šå°‘æ—¶æ¯”è¾ƒåˆç†ï¼Ÿ"></a>2. å¹³å‡è´Ÿè½½ä¸ºå¤šå°‘æ—¶æ¯”è¾ƒåˆç†ï¼Ÿ</h1><p>é¦–å…ˆéœ€è¦çŸ¥é“ç³»ç»Ÿæœ‰å‡ ä¸ªCPUï¼Œå¯ä»¥é€šè¿‡topå‘½ä»¤æˆ–è€…ä»æ–‡ä»¶/proc/cpuinfoä¸­è¯»å–</p><pre><code>$grep &#39;model name&#39; /proc/cpuinfo | wc -l</code></pre><p>å½“å¹³å‡è´Ÿè½½é«˜äºCPUæ•°é‡70%çš„æ—¶å€™ï¼Œå°±åº”è¯¥åˆ†æå’Œæ’æŸ¥è´Ÿè½½é«˜çš„é—®é¢˜äº†ã€‚</p><h1 id="3-å¹³å‡è´Ÿè½½ä¸CPUä½¿ç”¨ç‡"><a href="#3-å¹³å‡è´Ÿè½½ä¸CPUä½¿ç”¨ç‡" class="headerlink" title="3. å¹³å‡è´Ÿè½½ä¸CPUä½¿ç”¨ç‡"></a>3. å¹³å‡è´Ÿè½½ä¸CPUä½¿ç”¨ç‡</h1><p>äºŒè€…ä¸ä¸€å®šä¼šå®Œå…¨ä¸€è‡´ï¼Œå› ä¸ºå¹³å‡è´Ÿè½½æŒ‡å•ä½æ—¶é—´å†…å¤„äºå¯è¿è¡ŒçŠ¶æ€å’Œä¸å¯ä¸­æ–­çŠ¶æ€çš„è¿›ç¨‹æ•°ï¼Œä¸ä»…åŒ…æ‹¬äº†<strong><em>æ­£åœ¨ä½¿ç”¨CPUçš„è¿›ç¨‹ï¼Œè¿˜åŒ…æ‹¬ç­‰å¾…CPUå’Œç­‰å¾…I/Oçš„è¿›ç¨‹</em></strong>ã€‚</p><p>è€ŒCPUä½¿ç”¨ç‡ï¼Œæ˜¯æ ¹æ®å•ä½æ—¶é—´å†…CPUçš„ç¹å¿™æƒ…å†µè¿›è¡Œç»Ÿè®¡çš„ï¼Œä¸¾ä¾‹ï¼š</p><ul><li>CPUå¯†é›†è¿›ç¨‹</li></ul><p>ä½¿ç”¨å¤§é‡CPUä½¿å¾—å¹³å‡è´Ÿè½½å‡é«˜ï¼Œæ­¤æ—¶äºŒè€…æ˜¯ä¸€è‡´çš„</p><ul><li>IOå¯†é›†å‹è¿›ç¨‹</li></ul><p>ç­‰å¾…I/Oä¹Ÿä¼šå¯¼è‡´å¹³å‡è´Ÿè½½å‡é«˜ï¼Œä½†CPUä½¿ç”¨ç‡ä¸ä¸€å®šä¼šå¾ˆé«˜</p><h1 id="4-æ¡ˆä¾‹åˆ†æ"><a href="#4-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="4. æ¡ˆä¾‹åˆ†æ"></a>4. æ¡ˆä¾‹åˆ†æ</h1><h2 id="4-1-ä½¿ç”¨å·¥å…·"><a href="#4-1-ä½¿ç”¨å·¥å…·" class="headerlink" title="4.1 ä½¿ç”¨å·¥å…·"></a>4.1 ä½¿ç”¨å·¥å…·</h2><h3 id="4-1-1-stress"><a href="#4-1-1-stress" class="headerlink" title="4.1.1 stress"></a>4.1.1 stress</h3><p>Linux ç³»ç»Ÿå‹åŠ›æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥ç”¨ä½œå¼‚å¸¸è¿›ç¨‹æ¨¡æ‹Ÿå¹³å‡è´Ÿè½½å‡é«˜çš„åœºæ™¯ã€‚</p><h3 id="4-1-2-sysstat"><a href="#4-1-2-sysstat" class="headerlink" title="4.1.2 sysstat"></a>4.1.2 sysstat</h3><p>åŒ…å«äº†å¸¸ç”¨çš„å¤šæ ¸CPUæ€§èƒ½åˆ†æå·¥å…·ï¼Œç”¨æ¥å®æ—¶æŸ¥çœ‹è¿›ç¨‹çš„CPUã€å†…å­˜ã€I/Oä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰æ€§èƒ½æŒ‡æ ‡ã€‚</p><h2 id="4-2-åœºæ™¯åˆ†æ-CPUå¯†é›†å‹è¿›ç¨‹"><a href="#4-2-åœºæ™¯åˆ†æ-CPUå¯†é›†å‹è¿›ç¨‹" class="headerlink" title="4.2 åœºæ™¯åˆ†æ-CPUå¯†é›†å‹è¿›ç¨‹"></a>4.2 åœºæ™¯åˆ†æ-CPUå¯†é›†å‹è¿›ç¨‹</h2><p>terminal 1: </p><pre><code>$ stress --cpu 1 --timeout 600</code></pre><p>terminal 2: </p><pre><code># -d å‚æ•°è¡¨ç¤ºé«˜äº®æ˜¾ç¤ºå˜åŒ–çš„åŒºåŸŸ$ watch -d uptime...,  load average: 1.00, 0.75, 0.39</code></pre><p>terminal 3: run mpstat to see CPU usage </p><pre><code># -P ALL è¡¨ç¤ºç›‘æ§æ‰€æœ‰ CPUï¼Œåé¢æ•°å­— 5 è¡¨ç¤ºé—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®$ mpstat -P ALL 5Linux 4.15.0 (ubuntu) 09/22/18 _x86_64_ (2 CPU)13:30:06     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle13:30:11     all   50.05    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   49.9513:30:11       0    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.0013:30:11       1  100.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00</code></pre><p>Use pidstat to see process usage </p><pre><code># é—´éš” 5 ç§’åè¾“å‡ºä¸€ç»„æ•°æ®$ pidstat -u 5 113:37:07      UID       PID    %usr %system  %guest   %wait    %CPU   CPU  Command13:37:12        0      2962  100.00    0.00    0.00    0.00  100.00     1  stress</code></pre><h1 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a>5. æ€»ç»“</h1><ol><li>mpstat -P ALL 5</li><li>pidstat -u 5 1</li></ol><ul><li>-u : cpu usage</li><li>-r : memory usage</li><li>-d : I/O usage</li><li>-p : specific process id </li></ul><ol start="3"><li>watch -d uptime </li></ol><p>watchå¯ä»¥å¸®ä½ æ£€æµ‹ä¸€ä¸ªå‘½ä»¤çš„è¿è¡Œç»“æœï¼Œåœ¨Linuxä¸‹ï¼Œwatchæ˜¯å‘¨æœŸæ€§çš„æ‰§è¡Œä¸‹ä¸ªç¨‹åºï¼Œå¹¶å…¨å±æ˜¾ç¤ºæ‰§è¡Œç»“æœã€‚ä½ å¯ä»¥æ‹¿ä»–æ¥ç›‘æµ‹ä½ æƒ³è¦çš„ä¸€åˆ‡å‘½ä»¤çš„ç»“æœå˜åŒ–ï¼Œæ¯”å¦‚ tail ä¸€ä¸ª log æ–‡ä»¶ï¼Œls ç›‘æµ‹æŸä¸ªæ–‡ä»¶çš„å¤§å°å˜åŒ–ã€‚</p><ul><li>-n : interval</li><li>-d : highlight </li><li>â€˜â€™ : command</li></ul><p>e.g : <code>watch -n 1 -d &#39;pstree|grep http&#39;</code></p><ol start="4"><li>uptime </li></ol><h1 id="6-Reference"><a href="#6-Reference" class="headerlink" title="6. Reference"></a>6. Reference</h1><ol><li><a href="https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858775.html" target="_blank" rel="noopener">Linux CPU å®æ—¶ç›‘æ§mpstatå‘½ä»¤è¯¦è§£</a></li><li><a href="http://www.cnblogs.com/peida/archive/2012/12/31/2840241.html" target="_blank" rel="noopener">watchå‘½ä»¤</a></li><li><a href="https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2858874.html" target="_blank" rel="noopener">Linuxè¿è¡Œè¿›ç¨‹å®æ—¶ç›‘æ§pidstatå‘½ä»¤è¯¦è§£</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> å¹³å‡è´Ÿè½½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxæ€§èƒ½ä¼˜åŒ–(1)-æ¦‚è¿°</title>
      <link href="/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-1-%E6%A6%82%E8%BF%B0/"/>
      <url>/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-1-%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ€§èƒ½é—®é¢˜"><a href="#1-æ€§èƒ½é—®é¢˜" class="headerlink" title="1. æ€§èƒ½é—®é¢˜"></a>1. æ€§èƒ½é—®é¢˜</h1><p>æ€§èƒ½è°ƒä¼˜çš„å›°éš¾ä¸»è¦åœ¨äºï¼šå…¶ä¸ç³»ç»ŸåŸç†ç›¸è”ç³»ï¼ŒæŠŠç³»ç»Ÿä»åº”ç”¨ç¨‹åºã€åº“å‡½æ•°ã€ç³»ç»Ÿè°ƒç”¨ã€å†åˆ°å†…æ ¸å’Œç¡¬ä»¶ç­‰ä¸åŒçš„å±‚çº§è´¯ç©¿èµ·æ¥ã€‚</p><p>è¿™ä¸ªç³»åˆ—ä¼šè®²Linuxæ€§èƒ½çš„åŸºæœ¬æŒ‡æ ‡ï¼Œå·¥å…·ï¼Œç›¸åº”çš„è§‚æµ‹ã€åˆ†æå’Œè°ƒä¼˜æ–¹æ³•ã€‚ä¸»è¦ç ”ç©¶CPUæ€§èƒ½ã€ç£ç›˜I/Oæ€§èƒ½ã€å†…å­˜æ€§èƒ½ä»¥åŠç½‘ç»œæ€§èƒ½å››ä¸ªæ–¹é¢çš„å†…å®¹ã€‚</p><p>å¯¹äºè‡ªå·±æ¥è¯´ï¼Œå…¶å®é‡åˆ°è¿‡ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜äº†ï¼Œä½†æ˜¯é¢‡æœ‰ç‚¹ä¸æ±‚ç”šè§£ï¼Œæœ‰stackoverflowè¿™ä¸ªå·¥å…·ä»¥åï¼Œå°±æœ‰ç‚¹éš¾è„±ç¦»è¿™ä¸ªè„šæ‰‹æ¶äº†ã€‚å­¦ä¹ æ–¹æ³•ä¸Šæœ‰é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æƒ³å†™è¿™ä¹ˆä¸ªç³»åˆ—ï¼Œå­¦ä¹ è¿™æ ·çš„è¯¾ç¨‹çš„åˆè¡·ã€‚éœ€è¦å»äº†è§£åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿçš„åŸºæœ¬åŸç†ï¼Œè¿›è¡Œå®æˆ˜ç»ƒä¹ ï¼Œå»ºç«‹ä¸€ä¸ªæ•´ä½“æ€§èƒ½çš„å…¨å±€è§‚ã€‚</p><p>æƒ³è¦è°ƒæ•´æ€§èƒ½ï¼Œå¯èƒ½ä¸éœ€è¦äº†è§£æ¯ä¸ªç»„ä»¶çš„æ‰€æœ‰å®ç°ç»†èŠ‚ï¼Œåªè¦èƒ½ç†è§£ä»–ä»¬æœ€åŸºæœ¬çš„å·¥ä½œåŸç†å’Œåä½œæ–¹å¼å°±å¯ä»¥äº†ã€‚</p><h1 id="2-æ€§èƒ½æŒ‡æ ‡"><a href="#2-æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="2. æ€§èƒ½æŒ‡æ ‡"></a>2. æ€§èƒ½æŒ‡æ ‡</h1><p>é«˜å¹¶å‘(åå)ï¼Œå“åº”å¿«(å»¶è¿Ÿ)ã€‚è¿™ä¸¤ä¸ªæŒ‡æ ‡æ˜¯ä»åº”ç”¨è´Ÿè½½çš„è§’åº¦æ¥è€ƒå¯Ÿæ€§èƒ½çš„ï¼Œä»ç³»ç»Ÿèµ„æºçš„è§†è§’å‡ºå‘çš„æŒ‡æ ‡ï¼Œå°±æ˜¯èµ„æºä½¿ç”¨ç‡ï¼Œé¥±å’Œåº¦ç­‰ã€‚</p><p><img src="https://i.loli.net/2020/01/31/rvfmJx3eMwdntlW.png" alt="1.png"></p><p>éšç€åº”ç”¨è´Ÿè½½çš„å¢åŠ ï¼Œç³»ç»Ÿèµ„æºçš„ä½¿ç”¨ä¹Ÿä¼šå‡é«˜ï¼Œç”šè‡³è¾¾åˆ°æé™ã€‚è€Œæ€§èƒ½é—®é¢˜çš„æœ¬è´¨ï¼Œå°±æ˜¯<strong>ç³»ç»Ÿèµ„æºå·²ç»è¾¾åˆ°ç“¶é¢ˆï¼Œä½†è¯·æ±‚çš„å¤„ç†è¿˜ä¸å¤Ÿå¿«ï¼Œæ— æ³•æ”¯æ’‘æ›´å¤šçš„è¯·æ±‚</strong>ã€‚</p><p>æ€§èƒ½åˆ†æï¼Œå°±æ˜¯æ‰¾å‡ºåº”ç”¨æˆ–è€…ç³»ç»Ÿçš„ç“¶é¢ˆï¼Œå¹¶è®¾æ³•å»é¿å…æˆ–è€…ç¼“è§£å®ƒä»¬ã€‚åŒ…å«ä¸€ç³»åˆ—æ­¥éª¤ï¼š</p><ol><li>é€‰æ‹©æŒ‡æ ‡è¯„ä¼°åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿçš„æ€§èƒ½</li><li>ä¸ºåº”ç”¨ç¨‹åºå’Œç³»ç»Ÿè®¾ç½®æ€§èƒ½ç›®æ ‡</li><li>è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•</li><li>æ€§èƒ½åˆ†æå®šä½ç“¶é¢ˆ</li><li>ä¼˜åŒ–ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åº</li><li>æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦</li></ol><h1 id="3-æ€§èƒ½å·¥å…·"><a href="#3-æ€§èƒ½å·¥å…·" class="headerlink" title="3. æ€§èƒ½å·¥å…·"></a>3. æ€§èƒ½å·¥å…·</h1><p><img src="https://i.loli.net/2020/01/31/5uRyNxQUhdpWAOY.png" alt="2.png"><br>Brendan Greffçš„æ€§èƒ½å·¥å…·å›¾è°±</p><p><img src="https://i.loli.net/2020/01/31/TtXop59L7BwxmFY.png" alt="3.png"><br>æ€§èƒ½ä¼˜åŒ–æ€ç»´å¯¼å›¾</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux å¸¸ç”¨æŒ‡ä»¤(3) - Inspired by THE ART OF COMMAND LINE</title>
      <link href="/Linux-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-3-Inspired-by-THE-ART-OF-COMMAND-LINE/"/>
      <url>/Linux-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-3-Inspired-by-THE-ART-OF-COMMAND-LINE/</url>
      
        <content type="html"><![CDATA[<h1 id="1-åŸºç¡€"><a href="#1-åŸºç¡€" class="headerlink" title="1. åŸºç¡€"></a>1. åŸºç¡€</h1><ul><li><code>apropos</code>æŸ¥æ‰¾æ–‡æ¡£</li><li><code>type [cmd]</code> çœ‹è¿™ä¸ªå‘½ä»¤æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€shellè¿˜æ˜¯åˆ«å</li><li>ä»»åŠ¡ç®¡ç†å·¥å…·ä»¬<ul><li>&amp;</li><li>ctrl + z</li><li>ctrl + c</li><li>jobs</li><li>fg</li><li>bg</li><li>kill</li></ul></li><li>æ–‡ä»¶ç®¡ç†å·¥å…·<ul><li>ls    ls -l</li><li>less </li><li>head</li><li>tail   tail -f</li><li>chown </li><li>chmod </li><li>du -hs*</li></ul></li><li>æ–‡ä»¶ç³»ç»Ÿç®¡ç†<ul><li>df</li><li>mount </li><li>fdisk</li><li>mkfs</li><li>lsblk</li></ul></li><li>ç½‘ç»œçŸ¥è¯†<ul><li>ip</li><li>ipconfig</li><li>dig</li></ul></li><li>grep<ul><li>-i</li><li>-o</li><li>-v</li><li>-A</li><li>-B</li><li>-C</li></ul></li></ul><h1 id="2-æ—¥å¸¸ä½¿ç”¨"><a href="#2-æ—¥å¸¸ä½¿ç”¨" class="headerlink" title="2. æ—¥å¸¸ä½¿ç”¨"></a>2. æ—¥å¸¸ä½¿ç”¨</h1><ul><li>è¡¥å…¨<ul><li>tab è‡ªåŠ¨è¡¥å…¨</li><li>ctrl-r æœç´¢å‘½ä»¤è¡Œå†å²è®°å½• <ul><li>enter æ‰§è¡Œ</li><li>é¼ æ ‡å³é”® edit</li></ul></li></ul></li><li>åˆ é™¤ &amp; ç§»åŠ¨<ul><li>ctrl-w åˆ é™¤é”®å…¥çš„æœ€åä¸€ä¸ªå•è¯</li><li>ctrl-u åˆ é™¤è¡Œå†…å…‰æ ‡æ‰€åœ¨ä½ç½®ä¹‹å‰çš„å†…å®¹</li><li>alt-b alt-fä»¥å•è¯ä¸ºå•ä½ç§»åŠ¨å…‰æ ‡</li><li>ctrl-a åˆ°è¡Œçš„å¼€å§‹</li><li>ctrl-e åˆ°è¡Œçš„ç»“å°¾</li></ul></li><li>xargs <ul><li>æ¥æ”¶pipelineçš„è¾“å…¥ï¼Œç„¶åç”¨è¿™ä¸ªè¾“å…¥ç»§ç»­åšæ“ä½œ</li></ul></li><li>pgrep, pkill <ul><li>é€šè¿‡åå­—æˆ–è€…å±æ€§æ¥æ‰¾åˆ°è¿›ç¨‹</li></ul></li><li>netstat -ltnp <ul><li>çœ‹ç°åœ¨å¤„åœ¨listening çŠ¶æ€ä¸‹çš„è¿›ç¨‹ä»¬ </li></ul></li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.quora.com/Linux/What-are-some-time-saving-tips-that-every-Linux-user-should-know#" target="_blank" rel="noopener">https://www.quora.com/Linux/What-are-some-time-saving-tips-that-every-Linux-user-should-know#</a></li><li><a href="https://coolshell.cn/articles/7829.html" target="_blank" rel="noopener">https://coolshell.cn/articles/7829.html</a></li><li><a href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md" target="_blank" rel="noopener">https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Cli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå¸¸ç”¨æŒ‡ä»¤(2)</title>
      <link href="/Linux%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-2/"/>
      <url>/Linux%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-2/</url>
      
        <content type="html"><![CDATA[<p>ç»§ç»­ä¸Šç¯‡æ¥ä»‹ç»ä¸€äº›åŸºæœ¬çš„æŒ‡ä»¤</p><h1 id="1-træŒ‡ä»¤"><a href="#1-træŒ‡ä»¤" class="headerlink" title="1. træŒ‡ä»¤"></a>1. træŒ‡ä»¤</h1><ul><li>træ˜¯ç”¨æ¥å¯¹ä»stdinè¿›å…¥çš„å­—ç¬¦è¿›è¡Œç›¸å…³çš„ç¿»è¯‘å’Œè½¬æ¢çš„ï¼Œå¹¶ä¸”å°†å…¶å‘ˆç°åœ¨stdoutå½“ä¸­</li><li>trä¼šæ¥æ”¶ä¸¤ä¸ªå­—ç¬¦setï¼Œç„¶åç”¨ç¬¬äºŒä¸ªseté‡Œé¢çš„å­—ç¬¦æ¥æ›¿æ¢ç¬¬ä¸€ä¸ªseté‡Œé¢çš„å­—ç¬¦</li><li>tré¢„å®šä¹‰äº†ä¸€äº›setsä¾›ç”¨æˆ·æ¥ç›´æ¥ä½¿ç”¨<ul><li>alnum: å­—æ¯æ•°å­—ç»„æˆçš„å­—ç¬¦é›†</li><li>alphaï¼šæŒ‰å­—æ¯é¡ºåºçš„å­—ç¬¦é›†</li><li>blank: ç©ºç™½å­—ç¬¦é›†</li><li>cntrl: æ§åˆ¶å­—ç¬¦é›†</li><li>digit: æ•°å­—å­—ç¬¦é›†</li><li>graph: å›¾åƒå­—ç¬¦é›†</li><li>lower: å°å†™å­—æ¯å­—ç¬¦é›†</li><li>print: å¯ä»¥å†™å‡ºçš„å­—ç¬¦é›†</li><li>punct: æ ‡ç‚¹ç¬¦å·å­—ç¬¦é›†</li><li>space: ç©ºæ ¼å­—ç¬¦é›†</li><li>upper: å¤§å†™å­—æ¯å­—ç¬¦é›†</li><li>xdigit: åå…­è¿›åˆ¶å­—ç¬¦é›†</li></ul></li><li>tr -d [blabla] åˆ é™¤[]é‡Œé¢å®šä¹‰çš„å­—ç¬¦</li></ul><h1 id="2-colrm-æŒ‡ä»¤"><a href="#2-colrm-æŒ‡ä»¤" class="headerlink" title="2. colrm æŒ‡ä»¤"></a>2. colrm æŒ‡ä»¤</h1><ul><li>ç”¨æ¥åˆ é™¤è¡Œçš„æŒ‡ä»¤</li></ul><pre><code>// åˆ é™¤ä»ç¬¬å››è¡Œå¼€å§‹åˆ°æœ«å°¾çš„æ‰€æœ‰$ cat grocery.list | colrm 4 </code></pre><h1 id="3-expand-å’Œ-unexpand-æŒ‡ä»¤"><a href="#3-expand-å’Œ-unexpand-æŒ‡ä»¤" class="headerlink" title="3. expand å’Œ unexpand æŒ‡ä»¤"></a>3. expand å’Œ unexpand æŒ‡ä»¤</h1><ul><li>expandæŒ‡ä»¤èƒ½å¤Ÿå°†tabså˜æˆç©ºæ ¼</li><li>unexpand æŒ‡ä»¤èƒ½å¤Ÿå°†ç©ºæ ¼å˜æˆtab</li></ul><h1 id="4-comm-cmpä»¥åŠdiffæŒ‡ä»¤"><a href="#4-comm-cmpä»¥åŠdiffæŒ‡ä»¤" class="headerlink" title="4. comm, cmpä»¥åŠdiffæŒ‡ä»¤"></a>4. comm, cmpä»¥åŠdiffæŒ‡ä»¤</h1><ul><li>diffæŒ‡ä»¤æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å‘ŠçŸ¥äºŒè€…ä¹‹é—´çš„ä¸åŒ<ul><li>-w å¿½è§†ç©ºæ ¼ä¸Šçš„ä¸åŒ</li><li>-i å¿½è§†å¤§å°å†™çš„ä¸åŒ</li></ul></li><li>comm ä¹Ÿæ˜¯æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯è¡Œä¸ºä¸å¤ªä¸€æ ·ã€‚ä¼šç”Ÿæˆä¸‰è¡Œè¾“å‡º<ul><li>åªåœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶å½“ä¸­å‡ºç°çš„è¡Œ</li><li>åªåœ¨ç¬¬äºŒä¸ªæ–‡ä»¶å½“ä¸­å‡ºç°çš„è¡Œ</li><li>åœ¨ä¸¤ä¸ªæ–‡ä»¶å½“ä¸­éƒ½å‡ºç°çš„è¡Œ</li></ul></li><li>cmp æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶<ul><li>æ˜¾ç¤ºå‡ºä¸¤ä¸ªæ–‡ä»¶ä¸åŒçš„byteå’Œè¡Œå· </li></ul></li></ul><h1 id="5-bcæŒ‡ä»¤"><a href="#5-bcæŒ‡ä»¤" class="headerlink" title="5. bcæŒ‡ä»¤"></a>5. bcæŒ‡ä»¤</h1><ul><li>ä½¿ç”¨bcæ¥åšåŸºç¡€è¿ç®— - basic calculator </li></ul><pre><code>$ echo 2+3 | bc </code></pre><h1 id="6-sed-æŒ‡ä»¤"><a href="#6-sed-æŒ‡ä»¤" class="headerlink" title="6. sed æŒ‡ä»¤"></a>6. sed æŒ‡ä»¤</h1><p><a href="https://coolshell.cn/articles/9104.html" target="_blank" rel="noopener">https://coolshell.cn/articles/9104.html</a></p><ul><li><p>sedæŒ‡ä»¤å¯ä»¥ç”¨æ¥å¯¹æ–‡ä»¶æˆ–è€…æ•°æ®æµè¿›è¡Œè½¬åŒ–</p><ul><li>ä¸€æ¬¡è¯»å–ä¸€è¡Œçš„æ•°æ®</li><li>å¯¹è¿™ä¸€è¡Œæ•°æ®å®è¡Œç‰¹å®šçš„æ“ä½œ</li><li>ä¸€èˆ¬æ¥è¯´è¾“å‡ºåˆ°stdout</li></ul></li><li><p>åŠŸèƒ½</p><ul><li>ä»bufferé‡Œé¢åˆ é™¤æ–‡å­—</li><li>åœ¨bufferé™„ä¸Šæ–‡æœ¬æˆ–è€…æ’å…¥æ–‡æœ¬</li><li>å†™å…¥æ–‡ä»¶</li><li>ç”¨regexå®šä¹‰çš„è§„åˆ™æ¥è½¬åŒ–æ–‡æœ¬</li></ul></li><li><p>-e: æŒ‡å®šè¡¨è¾¾å¼æˆ–è€…ç¼–è¾‘çš„è„šæœ¬   ç”¨æ¥åšæ›¿æ¢</p><ul><li>s è¡¨ç¤ºè¿™æ˜¯ä¸ªæ›¿æ¢å‘½ä»¤</li><li>ç”¨ / ä½œä¸ºåˆ†éš”ç¬¦ </li><li>å‰é¢æ˜¯å¾…æ›¿æ¢çš„æ–‡æœ¬ï¼Œåé¢æ˜¯æ›¿æ¢çš„æ–‡æœ¬</li><li>g ä¾¿æ˜¯è®©è¿™ä¸ªæ›¿æ¢åœ¨ç°åœ¨çš„æ•´ä¸ªbufferé‡Œéƒ½ç”Ÿæ•ˆ</li></ul></li></ul><pre><code>$ echo &quot;IBM 174.99&quot; |sed â€“e &#39;s/IBM/International Business Machines/g&#39; International Business Machines 174.99$ echo &quot;Oracle DB&quot;|sed -e &#39;s/Oracle/IBM/g&#39; -e &#39;s/DB/DB2/g&#39;IBM DB2$ echo &quot;C:\Program Files\PuTTY\putty.exe&quot;| sed -e &#39;s/\\/\//g&#39; -e &#39;s/ /_/g&#39; -e &#39;s/://g&#39;C/Program_Files/PuTTY/putty.exe</code></pre><ul><li>ç”¨æ¥åšæ¼æ–—<ul><li>d è¡¨ç¤ºè¦åˆ é™¤çš„ä¸œè¥¿</li><li>ç„¶åä¸­é—´è·Ÿç€çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ è¡¨ç¤ºçš„ä¸€ä¸ªstring pattern</li></ul></li></ul><pre><code>cat &lt;&lt; EOF &gt; dummy_sed.txt# top of file  # the next line here# Last Name, PhoneSmith, 555-1212Jones, 555-5555 # last numberEOF$ sed &#39;/^[[:space:]]*#/d&#39; dummy_sed.txtSmith, 555-1212Jones, 555-5555 # last number$ grep -v  ^[[:space:]]*# dummy_sed.txtSmith, 555-1212Jones, 555-5555 # last number</code></pre><h1 id="7-awkæŒ‡ä»¤"><a href="#7-awkæŒ‡ä»¤" class="headerlink" title="7. awkæŒ‡ä»¤"></a>7. awkæŒ‡ä»¤</h1><h2 id="7-1-æŒ‡ä»¤èŒƒå¼"><a href="#7-1-æŒ‡ä»¤èŒƒå¼" class="headerlink" title="7.1 æŒ‡ä»¤èŒƒå¼"></a>7.1 æŒ‡ä»¤èŒƒå¼</h2><pre><code>// $1 è¡¨ç¤ºç¬¬1åˆ—ï¼Œ$4è¡¨ç¤ºç¬¬4åˆ—  æ³¨æ„$0è¡¨ç¤ºæ•´è¡Œ$ awk &#39;{print $1, $4}&#39;  netstat.txt </code></pre><p><a href="https://coolshell.cn/tag/awk" target="_blank" rel="noopener">https://coolshell.cn/tag/awk</a> </p><ul><li>ç”¨æ¥åšè½¬æ¢ï¼Œæ¼æ–—ï¼Œæ ¼å¼åŒ–ç­‰</li><li>ä»stdinæ‹¿æ•°æ®ï¼Œç„¶åå±•ç¤ºåœ¨stdoutå½“ä¸­</li></ul><h2 id="7-2-æ ¼å¼åŒ–è¾“å‡º"><a href="#7-2-æ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="7.2 æ ¼å¼åŒ–è¾“å‡º"></a>7.2 æ ¼å¼åŒ–è¾“å‡º</h2><p>æ ¼å¼åŒ–è¾“å‡ºçš„æ ·å¼åŸºæœ¬ä¸Šå’Œcè¯­è¨€çš„ä¸€æ ·</p><pre><code>$ awk &#39;{printf &quot;%-8s %-8s %-8s %-18s %-22s %-15s\n&quot;,$1,$2,$3,$4,$5,$6}&#39; netstat.txt</code></pre><h2 id="7-3-è¿‡æ»¤è®°å½•çš„åŠŸèƒ½"><a href="#7-3-è¿‡æ»¤è®°å½•çš„åŠŸèƒ½" class="headerlink" title="7.3 è¿‡æ»¤è®°å½•çš„åŠŸèƒ½"></a>7.3 è¿‡æ»¤è®°å½•çš„åŠŸèƒ½</h2><pre><code>$ awk &#39;$3==0 &amp;&amp; $6==&quot;LISTEN&quot; &#39; netstat.txt// å†…å»ºå˜é‡NRæ¥å±•ç¤ºè¡¨å¤´$ awk &#39;$3==0 &amp;&amp; $6==&quot;LISTEN&quot; || NR==1 &#39; netstat.txt$ awk &#39;$3==0 &amp;&amp; $6==&quot;LISTEN&quot; || NR==1 {printf &quot;%-20s %-20s %s\n&quot;,$4,$5,$6}&#39; netstat.txt</code></pre><h2 id="7-4-awkçš„å†…å»ºå˜é‡"><a href="#7-4-awkçš„å†…å»ºå˜é‡" class="headerlink" title="7.4 awkçš„å†…å»ºå˜é‡"></a>7.4 awkçš„å†…å»ºå˜é‡</h2><ul><li>$0 å½“å‰è®°å½• </li><li>$1 - $n å½“å‰è®°å½•çš„ç¬¬nä¸ªå­—æ®µ</li><li>FS  è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼æˆ–è€…Tab</li><li>NF  å½“å‰è®°å½•å½“ä¸­çš„å­—æ®µä¸ªæ•°</li><li>NR  å·²ç»è¯»å‡ºçš„è®°å½•æ•°ï¼Œè¡Œå·</li><li>FNR å½“å‰è®°å½•æ•°ï¼Œä¸NRä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªå€¼ä¼šæ˜¯å„ä¸ªæ–‡ä»¶è‡ªå·±çš„è¡Œå·</li><li>RS  è¾“å…¥çš„è®°å½•åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºæ¢è¡Œç¬¦</li><li>OFS è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤ç©ºæ ¼</li><li>ORS è¾“å‡ºè®°å½•åˆ†éš”ç¬¦ï¼Œé»˜è®¤æ¢è¡Œç¬¦</li><li>FILENAME å½“å‰è¾“å…¥æ–‡ä»¶çš„åå­—</li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Cli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux å¸¸ç”¨æŒ‡ä»¤(1)</title>
      <link href="/Linux-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-1/"/>
      <url>/Linux-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4-1/</url>
      
        <content type="html"><![CDATA[<p>Unixçš„ä¸€å¤§å“²å­¦å°±æ˜¯åˆ›å»ºåªåšä¸€ä»¶äº‹æƒ…çš„ç¨‹åºå—ï¼Œå¹¶ä¸”å°†è¿™ä»¶äº‹æƒ…åšå¥½ã€‚åœ¨è¿™ç§å“²å­¦ä¸‹ï¼Œä»”ç»†æ€è€ƒéœ€è¦çš„æ¥å£ï¼Œå¹¶ä¸”ç”¨pipelineè”ç»“èµ·æ¥å¹¶æœ€ç»ˆäº§ç”Ÿäº†æœ‰ç”¨çš„ç»“æœå°±å˜æˆä¸€ä»¶å¾ˆé‡è¦çš„äº‹æƒ…äº†ã€‚æƒ³è±¡ä¸€ä¸‹æ•°æ®é€šè¿‡ç®¡é“åœ¨ä¸åŒçš„æŒ‡ä»¤ä¹‹é—´æµåŠ¨çš„è¿‡ç¨‹ï¼Œå¾ˆéš¾ä¸ç”¨ä¼˜ç¾æ¥å½¢å®¹ï¼Œå“ˆå“ˆã€‚æœ¬æ–‡æ€»ç»“ä¸€äº›åŸºæœ¬çš„æ–‡æœ¬å¤„ç†çš„å‘½ä»¤ï¼Œæ³¨æ„è¿™äº›å‘½ä»¤ä¸€èˆ¬æ¥è¯´ä¹Ÿæ˜¯å¯ä»¥ä¸²è”èµ·æ¥å®ç°ä¸€äº›ç›¸å¯¹å¤æ‚ä¸”å®Œæˆåº¦æ¯”è¾ƒé«˜çš„åŠŸèƒ½çš„ã€‚</p><p>ä¸‹é¢å°†é€ä¸ªä»‹ç»å„ä¸ªæŒ‡ä»¤ï¼š</p><h1 id="1-Cat"><a href="#1-Cat" class="headerlink" title="1. Cat"></a>1. Cat</h1><ul><li>ç”¨æ¥åˆ›å»ºï¼Œè¿æ¥ï¼Œå±•ç¤ºæ–‡ä»¶çš„</li></ul><pre><code>// åˆ›å»ºæ–°æ–‡ä»¶ï¼Œåœ¨æœ¬è¡Œå‘½ä»¤ä»¥åå°±å¯ä»¥è¾“å…¥æƒ³å­˜å‚¨çš„å†…å®¹äº†$ cat &gt; grocery.list// å°†æ–°è¾“å…¥çš„å†…å®¹é™„åœ¨åŸæ–‡ä»¶å°¾$ cat &gt;&gt; grocery.list // æŸ¥çœ‹æ–‡ä»¶å½“ä¸­çš„å†…å®¹$ cat grocery.list// æŸ¥çœ‹æ–‡ä»¶å½“ä¸­çš„å†…å®¹ï¼Œå¸¦è¡Œæ•°çš„$ cat -n grocery.list </code></pre><h1 id="2-nl"><a href="#2-nl" class="headerlink" title="2. nl"></a>2. nl</h1><p>nlå¯ä»¥ä»stdinæˆ–è€…æ–‡ä»¶é‡Œè¯»å–è¡Œã€‚è¾“å‡ºä¼šå†™åˆ°stdoutæˆ–è€…é‡æŒ‡å‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡ç®¡é“å°†å†…å®¹ä¼ è¾“åˆ°å…¶ä»–æŒ‡ä»¤å¤„ã€‚</p><ul><li><p>nl</p><ul><li><p>-b æŒ‡å®šè¦è®¡æ•°çš„è¡Œ</p><ul><li>a : æ‰€æœ‰è¡Œéƒ½ç®—</li><li>t : ä¸è®¡ç©ºè¡Œï¼Œæˆ–è€…åªæœ‰ç©ºæ ¼çš„è¡Œ</li><li>n : å…¨éƒ½ä¸è®¡</li><li>p : æ ¹æ®æŸç§ç‰¹å¾</li></ul></li><li><p>-s æŒ‡å®šè¡Œå·å’Œå…·ä½“å†…å®¹çš„åˆ†éš”ç¬¦</p><p>// nl ç±»ä¼¼äº cat -n<br>$ nl grocery.list </p><p>// æ ¹æ® på®šä¹‰çš„ç‰¹å¾ï¼šè¿™é‡Œæ˜¯åªè®°å½•èµ·å§‹å­—æ¯ä¸ºaæˆ–bçš„<br>$ nl -b p^[ba] grocery.list</p><p>// è®©è¡Œå·å’Œå…·ä½“å†…å®¹ä¹‹é—´çš„åˆ†éš”ç¬¦å˜æˆç­‰å·<br>$ nl -s= grocery.list </p></li></ul></li></ul><h1 id="3-wc"><a href="#3-wc" class="headerlink" title="3. wc"></a>3. wc</h1><p>wcæ˜¯wordcountçš„ç®€ç§°ï¼Œé¡¾åæ€ä¹‰ï¼Œç”¨æ¥ç»Ÿè®¡è¡Œæ•°ï¼Œè¯è¯­æ•°é‡ï¼Œæˆ–è€…æ˜¯å­—æ¯çš„æ•°é‡</p><ul><li>wc<ul><li>-l è¡Œæ•°</li><li>-w è¯è¯­æ•°</li><li>-c å­—æ¯æ•°</li></ul></li></ul><h1 id="4-grep"><a href="#4-grep" class="headerlink" title="4. grep"></a>4. grep</h1><p>ä¼šæœç´¢ç‰¹å®šçš„æ–‡ä»¶ï¼Œæˆ–è€…ä»stdiné‡Œï¼Œå»å¯»æ‰¾ç¬¦åˆå®šä¹‰çš„æŸç§ç‰¹å¾çš„è¡¨è¾¾</p><ul><li>grep<ul><li>-c ç»Ÿè®¡å‡ºç°äº†çš„è¡Œæ•°</li><li>-h æœç´¢å¤šä¸ªæ–‡ä»¶çš„æ—¶å€™ä¸å†æ˜¾ç¤ºå‡ºæ–‡ä»¶åå­—</li><li>-i å¿½ç•¥å¤§å°å†™çš„ä¸åŒ</li><li>-l åªæ‰“å°æ»¡è¶³æŒ‡å®šç‰¹å¾çš„æ–‡ä»¶å</li><li>-n æ‰“å°æ‰€åœ¨çš„è¡Œä½ç½®</li><li>-v è¾“å‡ºæ‰€æœ‰ä¸æ»¡è¶³ç‰¹å¾çš„è¡Œ</li><li>-w </li></ul></li></ul><h1 id="5-streams-pipes-redirects-tee"><a href="#5-streams-pipes-redirects-tee" class="headerlink" title="5. streams, pipes, redirects, tee"></a>5. streams, pipes, redirects, tee</h1><p>åœ¨Unixå½“ä¸­ï¼Œä¸€ä¸ªterminalå¸¸è§„æ˜¯åŒ…å«ä¸‰ä¸ªæµçš„ï¼Œä¸€ä¸ªä¸ºäº†è¾“å…¥ï¼Œä¸¤ä¸ªä¸ºäº†è¾“å‡ºã€‚è¾“å…¥æµï¼ŒæŒ‡çš„æ˜¯stdin,ä¸€èˆ¬æ¥è¯´æ˜¯æŒ‡å‘keyboardçš„ï¼›æ ‡å‡†è¾“å‡ºæµä¸€èˆ¬æŒ‡çš„æ˜¯stdoutï¼Œ ä¼šå°†ç»“æœè¾“å‡ºåˆ°terminalã€‚æ¯ä¸ªæµéƒ½æœ‰è‡ªå·±çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ¯ä¸€ä¸ªéƒ½å¯ä»¥åšç®¡é“åŒ–ï¼Œåˆ†å¼€æ¥åšé‡å®šå‘åˆ°å…¶ä»–å‘½ä»¤å½“ä¸­å»ã€‚ </p><ul><li>stdin 0  &lt; </li><li>stdout 1 &gt; </li><li>stderr 2 </li></ul><p>â€œ|â€ æŒ‡ä¸€ä¸ªç®¡é“ï¼Œä¼šå°†å‰ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥</p><pre><code>$ cat grocery.list | nl </code></pre><ul><li>&lt;&lt; <ul><li>å¯ä»¥è¿›è¡Œå¤šè¡Œçš„è¾“å…¥</li></ul></li></ul><h1 id="6-Using-head-and-tail"><a href="#6-Using-head-and-tail" class="headerlink" title="6. Using head and tail"></a>6. Using head and tail</h1><p>è¿™ä¸¤ä¸ªæŒ‡ä»¤æ˜¯ç”¨æ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å¤´éƒ¨æˆ–è€…å°¾éƒ¨çš„éƒ¨åˆ†</p><ul><li><p>-n</p><ul><li>ç”¨ä¸Šè¿°æŒ‡ä»¤åŠ æƒ³è¦æ˜¾ç¤ºçš„è¡Œæ•°</li></ul></li><li><p>-c</p><ul><li><p>æ˜¾ç¤ºçš„å­—ç¬¦çš„æ•°é‡ </p><p>//æ˜¾ç¤ºgroceryæ–‡ä»¶çš„å‰10è¡Œ<br>$ head -n10 grocery.list</p><p>//æ˜¾ç¤ºgroceryæ–‡ä»¶æœ€å12çš„ä¸ªå­—ç¬¦<br>$ tail -c12 grocery.list</p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Cli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Curl tutorial</title>
      <link href="/Curl-tutorial/"/>
      <url>/Curl-tutorial/</url>
      
        <content type="html"><![CDATA[<p>curl = client url, used to make requests to web server in client side. </p><h4 id="Send-GET-request-to-the-url"><a href="#Send-GET-request-to-the-url" class="headerlink" title="Send GET request to the url"></a>Send GET request to the url</h4><pre><code>curl https://www.google.com </code></pre><h4 id="A-Define-clientâ€™s-agent-header-â€”-User-Agent"><a href="#A-Define-clientâ€™s-agent-header-â€”-User-Agent" class="headerlink" title="-A Define clientâ€™s agent header â€”- User-Agent"></a>-A Define clientâ€™s agent header â€”- <code>User-Agent</code></h4><pre><code>curl -A &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#39; https://google.com</code></pre><h4 id="b-pass-cookie-to-server"><a href="#b-pass-cookie-to-server" class="headerlink" title="-b pass cookie to server"></a>-b pass cookie to server</h4><pre><code>curl -b &#39;foo=bar&#39; https://www.google.com</code></pre><h4 id="d-send-the-data-body-needed-when-sending-POST-request"><a href="#d-send-the-data-body-needed-when-sending-POST-request" class="headerlink" title="-d send the data body needed when sending POST request"></a>-d send the data body needed when sending POST request</h4><pre><code>curl -d &#39;login=leilei&amp;pwd=test&#39; -X POST https://www.google.com curl -d &#39;@data.txt&#39; -X POST https://www.google.com </code></pre><h4 id="e-set-headerâ€™s-Referer"><a href="#e-set-headerâ€™s-Referer" class="headerlink" title="-e set headerâ€™s Referer"></a>-e set headerâ€™s Referer</h4><pre><code>curl -e &#39;https://google.com?q=example&#39; https://www.example.com</code></pre><h4 id="â€“data-urlencode"><a href="#â€“data-urlencode" class="headerlink" title="â€“data-urlencode"></a>â€“data-urlencode</h4><p>similar to <code>-d</code>, the difference is <strong>it could do URL encode for sent data</strong></p><pre><code>curl --data-urlencode &#39;comment=hello world&#39; https://google.com/login</code></pre><h4 id="F-send-binary-file-to-server"><a href="#F-send-binary-file-to-server" class="headerlink" title="-F  send binary file to server"></a>-F  send binary file to server</h4><pre><code>curl -F &#39;file=@photo.png;type=image/png&#39; https://google.com/profile</code></pre><h4 id="G-create-the-search-string-needed"><a href="#G-create-the-search-string-needed" class="headerlink" title="-G create the search string needed"></a>-G create the search string needed</h4><pre><code>curl -G -d &#39;q=kitties&#39; -d &#39;count=20&#39; https://google.com/search</code></pre><h4 id="H-Add-HTTP-header"><a href="#H-Add-HTTP-header" class="headerlink" title="-H Add HTTP header"></a>-H Add HTTP header</h4><pre><code>curl -H &#39;Accept-Language: en-US&#39; https://google.com</code></pre><h4 id="â€“limit-reate"><a href="#â€“limit-reate" class="headerlink" title="â€“limit-reate"></a>â€“limit-reate</h4><p>Limit the speed, simulate env with low speed internet </p><pre><code>curl --limit-rate 200k https://google.com</code></pre><h4 id="u-set-username-and-pwd-for-server-authentication"><a href="#u-set-username-and-pwd-for-server-authentication" class="headerlink" title="-u set username and pwd for server authentication"></a>-u set username and pwd for server authentication</h4><pre><code>curl -u &#39;bob:12345&#39; https://google.com/login</code></pre><h4 id="X-method-for-make-request"><a href="#X-method-for-make-request" class="headerlink" title="-X method for make request"></a>-X method for make request</h4><pre><code>curl -X POST https://www.example.com</code></pre><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2019/09/curl-reference.html</a></li><li><a href="https://catonmat.net/cookbooks/curl" target="_blank" rel="noopener">https://catonmat.net/cookbooks/curl</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Curl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•æé«˜GPSç²¾åº¦</title>
      <link href="/%E5%A6%82%E4%BD%95%E6%8F%90%E9%AB%98GPS%E7%B2%BE%E5%BA%A6/"/>
      <url>/%E5%A6%82%E4%BD%95%E6%8F%90%E9%AB%98GPS%E7%B2%BE%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯Uber18å¹´æ›´çš„ä¸€ç¯‡æ–‡ç« ï¼Œé‡Œé¢è¯¦ç»†æè¿°äº†ä¼˜æ­¥çš„åšæ³•ï¼Œå¦‚ä½•ä»è½¯ä»¶è§’åº¦æ¥æé«˜GPSçš„ç²¾åº¦ã€‚</p><h1 id="1-æ¦‚è§ˆ"><a href="#1-æ¦‚è§ˆ" class="headerlink" title="1. æ¦‚è§ˆ"></a>1. æ¦‚è§ˆ</h1><p>å®šä½å’Œå¯¼èˆªæ‰€ä½¿ç”¨çš„å…¨çƒå®šä½ç³»ç»Ÿ(GPS)å·²ç„¶æ·±æ·±åµŒå…¥è¿›äº†æˆ‘ä»¬çš„ç”Ÿæ´»å½“ä¸­ï¼Œå¯¹äºUberå°¤å…¶é‡è¦ã€‚Uberéœ€è¦é€šè¿‡GPSç³»ç»ŸçŸ¥é“ä¹˜è½¦äººå’Œå¸æœºæ‰€åœ¨çš„ä½ç½®ï¼Œè¿˜è¦ç»™å‡ºå¦‚ä½•ä»å¸æœºæ‰€åœ¨çš„ä½ç½®åˆ°ä¹˜è½¦äººæ‰€åœ¨ä½ç½®çš„å¯¼èˆªï¼Œè·¯å¾„è§„åˆ’ã€‚ä¸ºäº†èƒ½å¤Ÿå¸¦æ¥æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé‚£ä¹ˆä½ç½®çš„ä¼°è®¡å°±éœ€è¦å°½å¯èƒ½çš„ç²¾ç¡®ã€‚</p><p>GPSä»å‡ºç°åˆ°ç°åœ¨å…¶å·¥ä½œåŸç†å¹¶æ²¡æœ‰å‡ºç°å¤ªå¤§çš„å˜åŒ–ï¼Œè¿™å¸¦æ¥äº†ä¸å°çš„è¡¨ç°ç“¶é¢ˆã€‚è€Œç›¸è¾ƒäº1973å¹´çš„æŠ€æœ¯æ¡ä»¶ï¼Œä»¥åŠå½“æ—¶åšå‡ºçš„æˆ‘ä»¬ä¼šä½•æ—¶ä½•åœ°ä½¿ç”¨GPSçš„å‡è®¾ï¼Œæˆ‘ä»¬æœ‰è¶³å¤Ÿç†ç”±å»è€ƒè™‘åŸºäºç°åœ¨çš„æŠ€æœ¯æ¡ä»¶å»æƒ³åŠæ³•æ”¹è¿›å…¶ç²¾åº¦ã€‚</p><p>å°½ç®¡GPSåœ¨ç›¸å¯¹ç©ºæ—·çš„åœ°æ–¹å·¥ä½œçš„éå¸¸ä¸é”™ï¼Œä½†æ˜¯åœ¨åŸå¸‚é‡Œï¼Œé¢å¯¹é«˜æ¥¼å¤§å¦ä»¥åŠé«˜å¯†åº¦çš„äººç¾¤ï¼Œå…¶è¯¯å·®å¯ä»¥é«˜è¾¾50ç±³ã€‚</p><p>Uberå¼€å‘äº†ä¸€ä¸ªè½¯ä»¶æ¥å‡çº§å®‰å“çš„GPSæ€§èƒ½ï¼Œé€šè¿‡ä½¿ç”¨client-serveræ¶æ„ï¼Œä½¿ç”¨3Dåœ°å›¾ï¼Œç»ç”±GNSS APIæ¥åšå¤æ‚çš„åŸºäºGPSæ•°æ®çš„æ¦‚ç‡è¿ç®—ã€‚</p><p>æœ¬æ–‡æˆ‘ä»¬ä¼šå…ˆè¯´æ˜ä¸‹ä¸ºä»€ä¹ˆGPSåœ¨ç°ä»£åŸå¸‚å½“ä¸­è¡¨ç°å¾ˆå·®ï¼Œè€Œåç»™å‡ºä¸€ä¸ªæ¦‚è§ˆ - æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡ä¿¡å·å¤„ç†ç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p><h1 id="2-GPS-GNSS-èƒŒæ™¯"><a href="#2-GPS-GNSS-èƒŒæ™¯" class="headerlink" title="2. GPS/ GNSS èƒŒæ™¯"></a>2. GPS/ GNSS èƒŒæ™¯</h1><p>GPSæ˜¯è¢«ç¾å›½æ”¿åºœæ‰€æ“ä½œçš„30é¢—å«æ˜Ÿï¼Œåœ¨è·ç¦»åœ°çƒå¤§çº¦2ä¸‡å…¬é‡Œçš„åœ°æ–¹ç¯ç»•åœ°çƒã€‚è¿™äº›å«æ˜Ÿä¼šå‘å‡ºä¿¡å·ï¼Œè€Œæˆ‘ä»¬çš„æ‰‹æœºä¼šä½œä¸ºæ¥æ”¶å™¨æ¥æ”¶åˆ°è¿™äº›ä¿¡å·,æ¯”è¾ƒé‡è¦çš„ä¸€ç‚¹ä¿¡æ¯æ˜¯è¿™äº›å«æ˜Ÿå‘å‡ºçš„ä¿¡å·é‡Œé¢ä¹ŸåŒ…å«äº†ä»–ä»¬çš„å‘é€æ—¶é—´ã€‚</p><p>è€Œæ¥æ”¶æ—¶é—´å’Œå‘å‡ºæ—¶é—´çš„å·®å€¼ä¹˜ä¸Šå…‰é€Ÿå°±æ˜¯å«æ˜Ÿå’Œæ¥å—è€…ä¹‹é—´çš„è·ç¦»ï¼Œæˆä¸ºpseudorange. å¦‚æœè¯´äºŒè€…æ—¶é—´æ˜¯åŒæ­¥çš„è¯ï¼Œä¿¡å·çš„ä¼ è¾“æ˜¯ç›´çº¿çš„è¯ï¼Œé‚£ä¹ˆè¿™å°±ä¼šæ˜¯äºŒè€…ä¹‹é—´çš„å®é™…ç›´çº¿è·ç¦»ã€‚ä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼ŒäºŒè€…çš„æ—¶é—´å¾€å¾€ä¸æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤æ¥å—è€…éœ€è¦è§£å†³å››ä¸ªunknownã€‚ä»–è‡ªå·±çš„3dåæ ‡ä»¥åŠæ—¶é—´å·®ã€‚å¯¹äºå››ä¸ªå˜é‡ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æœ‰å››ä¸ªå«æ˜Ÿå‘å‡ºçš„ä¿¡å·æ¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p>åœ¨å®é™…ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šç”¨æ›´å¤šçš„å«æ˜Ÿæ¥è®¡ç®—ï¼Œè¿™æ ·æ¥ä½¿ç»“æœæ›´é²æ£’ã€‚</p><h1 id="3-ä¸ºä»€ä¹ˆåœ¨åŸå¸‚ç¯å¢ƒä¸­å®šä½å˜å¾—ä¸å¤Ÿå‡†ç¡®ï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆåœ¨åŸå¸‚ç¯å¢ƒä¸­å®šä½å˜å¾—ä¸å¤Ÿå‡†ç¡®ï¼Ÿ" class="headerlink" title="3. ä¸ºä»€ä¹ˆåœ¨åŸå¸‚ç¯å¢ƒä¸­å®šä½å˜å¾—ä¸å¤Ÿå‡†ç¡®ï¼Ÿ"></a>3. ä¸ºä»€ä¹ˆåœ¨åŸå¸‚ç¯å¢ƒä¸­å®šä½å˜å¾—ä¸å¤Ÿå‡†ç¡®ï¼Ÿ</h1><p>åŸºäºGNSSå®šä½çš„ä¸€å¤§å‡è®¾å°±æ˜¯æ¥æ”¶äººæ˜¯å¯ä»¥ç›´é¢æ¯ä¸ªå«æ˜Ÿçš„ï¼Œå³æ˜¯ç›´çº¿ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ç›´çº¿æ¥æ¥æ”¶ä¿¡å·ï¼Œå¤„ç†ï¼Œåšå‡ºå®šä½ã€‚ä½†æ˜¯åœ¨åŸå¸‚å½“ä¸­ï¼Œå¾ˆå®¹æ˜“å› ä¸ºé•œé¢çš„åå°„ç­‰åŸå› ï¼Œæˆ‘ä»¬çš„æ‰‹æœºä¾æ—§èƒ½æ¥åˆ°å«æ˜Ÿå‘å‡ºçš„ä¿¡å·ï¼Œä½†æ˜¯æ˜¯ç»ç”±åå°„ï¼Œå› æ­¤æ—¶é—´å·®è¦æ¯”å®é™…çš„è¦å¤§ã€‚è¿™ç§ç°è±¡å¯¼è‡´äº†åœ¨åŸå¸‚åŒºåŸŸè¯¯å·®å¯èƒ½è¾¾åˆ°50ç±³çš„ç¨‹åº¦ã€‚</p><h1 id="4-ä¼˜åŒ–"><a href="#4-ä¼˜åŒ–" class="headerlink" title="4. ä¼˜åŒ–"></a>4. ä¼˜åŒ–</h1><p>æˆ‘ä»¬çš„æ–¹æ³•åˆ©ç”¨äº†GNSSä¿¡å·æ˜“è¢«é˜»ç¢çš„ç‰¹æ€§ã€‚å¯¹äºå®‰å“æ‰‹æœºæ¥è¯´ï¼ŒLocationManager APIä¸ä»…æä¾›äº†æ‰‹æœºä½ç½®çš„ä¼°è®¡ï¼Œä¹Ÿæä¾›äº†å¯¹äºæ¯ä¸ªå«æ˜Ÿé’ˆå¯¹å½“å‰ä½ç½®çš„ä¿¡å™ªæ¯”ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªä¿¡å·å¼ºåº¦çš„ä¿¡æ¯ï¼ŒåŠ å…¥åˆ°3Dåœ°å›¾å½“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°å¾ˆæœ‰ä»·å€¼çš„åœ°ç‚¹ä¿¡æ¯äº†ã€‚å¦‚æœä¿¡å™ªå€¼æ¯”è¾ƒä½ï¼Œé‚£å¾ˆæœ‰å¯èƒ½å½“å‰å«æ˜Ÿè¢«é˜»æŒ¡äº†ï¼›ç›¸åçš„ï¼Œå°±è¯æ˜å½“å‰ä½ç½®å°šä½³ã€‚è¿™æ˜¯åŸºæœ¬çš„åŸç†ï¼Œä½†æ˜¯è¿˜æœ‰äº›é—®é¢˜ï¼Œæ¯”å¦‚æœ‰äº›æ—¶å€™ï¼Œå³ä¾¿æ˜¯æ²¡æœ‰è¢«é«˜æ¥¼é˜»æŒ¡ï¼Œä½†æ˜¯ä½ ç«™åœ¨é®æŒ¡ç‰©ä¸‹è¾¹ï¼Œä¹Ÿä¼šå¯¹ä¿¡å·é€ æˆå½±å“ã€‚å¦å¤–ï¼Œ3Dåœ°å›¾æœ¬èº«çš„ç²¾ç¡®åº¦ä¹Ÿå­˜ç–‘ï¼Œæ›´åˆ«ææˆ‘ä»¬æ— æ³•è¾¨åˆ«å½“å‰æ•°æ®æ˜¯å¦å—åˆ°éšæœºçš„å¤§å‹ç§»åŠ¨ç‰©ä½“çš„å½±å“ã€‚è¿™ä¹Ÿç»™æ•´ä¸ªè¿‡ç¨‹å¢åŠ äº†ä¸ç¡®å®šæ€§ã€‚</p><p>ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼ŒUberä½¿ç”¨äº†æ¦‚ç‡æ¨¡å‹ï¼Œå¯¹äºæ¥æ”¶è€…å¯èƒ½åœ¨çš„ä»»ä½•ä½ç½®ï¼Œæˆ‘ä»¬ä¼šç”¨3Dåœ°å›¾æ¥æ£€æŸ¥ï¼Œæ˜¯å¦ä»æ¥æ”¶è€…åˆ°å«æ˜Ÿçš„ä¿¡å·ä¼šè¢«ç‰©ä½“é˜»æŒ¡ã€‚é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—åˆ°è·å¾—çš„ä¿¡å™ªæ¯”ä¿¡æ¯çš„å¯ä¿¡ç¨‹åº¦ã€‚ç„¶åé€šè¿‡ä¸€ç³»åˆ—åœ°ç‚¹çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å°±èƒ½è·å¾—ä¸€å¼ çƒ­åŠ›å›¾ï¼Œåæ˜ äº†ç”¨æˆ·æœ€å¯èƒ½åœ¨çš„åœ°æ–¹ã€‚</p><p>è¿™å¼ å±€éƒ¨çƒ­ç‚¹å›¾ç»å¸¸ä¼šæœ‰å¤šä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦å€ŸåŠ©æ‰‹æœºæœ¬èº«çš„åŸºäºwifiçš„å®šä½åŠŸèƒ½äº†ã€‚</p><p>åŸºæœ¬ä¸ŠUberå°±æ˜¯é€šè¿‡ä¸Šè¿°çš„æ–¹å¼æ¥åšä¼˜åŒ–ï¼Œä½¿ä¹‹èƒ½æ‹¿åˆ°æ›´å‡†ç¡®çš„å®šä½ç»“æœçš„ã€‚</p><p><a href="https://eng.uber.com/rethinking-gps/" target="_blank" rel="noopener">https://eng.uber.com/rethinking-gps/</a> </p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GPS </tag>
            
            <tag> Uber </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Googleæœç´¢æŠ€å·§</title>
      <link href="/Google%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"/>
      <url>/Google%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ä½¿ç”¨-tabs"><a href="#1-ä½¿ç”¨-tabs" class="headerlink" title="1. ä½¿ç”¨ tabs"></a>1. ä½¿ç”¨ tabs</h2><p>åœ¨googleçš„æœç´¢æ ä¸‹æ–¹æ˜¯æœ‰åˆ†ç±»çš„ï¼Œä½¿ç”¨ç‰¹å®šçš„åˆ†ç±»å¯ä»¥ç»™æˆ‘ä»¬æ›´å¥½çš„ç»“æœ</p><h2 id="2-ä½¿ç”¨åŒå¼•å·"><a href="#2-ä½¿ç”¨åŒå¼•å·" class="headerlink" title="2. ä½¿ç”¨åŒå¼•å·"></a>2. ä½¿ç”¨åŒå¼•å·</h2><p>åŒå¼•å·å†…çš„è¯è¯­ä¼šæˆä¸ºä¸€ä¸ªç‰¹å®šçš„æœç´¢è¯è¯­ï¼Œæ¯”å¦‚ä½ æœç´¢â€Hello Worldâ€ï¼Œ æ²¡æœ‰åŒå¼•å·çš„è¯gooleä¼šæœç´¢åŒ…å«è¿™ä¸¤ä¸ªè¯è¯­çš„linkï¼Œä½†æ˜¯æœ‰äº†åŒå¼•å·å°±ä¼šæœç´¢æŒ‰ç…§è¿™æ ·çš„é¡ºåºï¼Œå¹¶ä¸”æ˜¯è¿åœ¨ä¸€èµ·çš„å‡ºç°çš„linkã€‚</p><h2 id="3-ä½¿ç”¨è¿å­—ç¬¦å»æ’é™¤å…³é”®å­—"><a href="#3-ä½¿ç”¨è¿å­—ç¬¦å»æ’é™¤å…³é”®å­—" class="headerlink" title="3. ä½¿ç”¨è¿å­—ç¬¦å»æ’é™¤å…³é”®å­—"></a>3. ä½¿ç”¨è¿å­—ç¬¦å»æ’é™¤å…³é”®å­—</h2><p>æ¯”å¦‚æœç´¢mustang -cars è¡¨ç¤ºå¸Œæœ›æœçœŸçš„é©¬ï¼Œä¸èƒ½åŒ…æ‹¬è½¦è¿™ä¸ªå…³é”®å­—</p><h2 id="4-ä½¿ç”¨å†’å·å»æœç´¢ç‰¹å®šçš„ç½‘ç«™"><a href="#4-ä½¿ç”¨å†’å·å»æœç´¢ç‰¹å®šçš„ç½‘ç«™" class="headerlink" title="4. ä½¿ç”¨å†’å·å»æœç´¢ç‰¹å®šçš„ç½‘ç«™"></a>4. ä½¿ç”¨å†’å·å»æœç´¢ç‰¹å®šçš„ç½‘ç«™</h2><pre><code>leileichen site:llchen60.com</code></pre><p>è¡¨ç¤ºåªåœ¨llchen60.comè¿™ä¸ªç½‘å€æœç´¢leileichenè¿™ä¸ªå…³é”®å­—</p><h2 id="5-æ‰¾åˆ°ä¸€ä¸ªlinkåˆ°å…¶ä»–é¡µé¢çš„é¡µé¢"><a href="#5-æ‰¾åˆ°ä¸€ä¸ªlinkåˆ°å…¶ä»–é¡µé¢çš„é¡µé¢" class="headerlink" title="5. æ‰¾åˆ°ä¸€ä¸ªlinkåˆ°å…¶ä»–é¡µé¢çš„é¡µé¢"></a>5. æ‰¾åˆ°ä¸€ä¸ªlinkåˆ°å…¶ä»–é¡µé¢çš„é¡µé¢</h2><p>ç”¨æ¥æ‰¾åˆ°è°å¼•ç”¨äº†è¿™ä¸ªé¡µé¢</p><pre><code>link:llchen60.com</code></pre><p>æ¥æ‰¾åˆ°é‚£äº›å¼•ç”¨äº†è¿™ä¸ªç½‘å€çš„é¡µé¢ä»¬</p><h2 id="6-ä½¿ç”¨æ˜Ÿå·é€šé…ç¬¦"><a href="#6-ä½¿ç”¨æ˜Ÿå·é€šé…ç¬¦" class="headerlink" title="6. ä½¿ç”¨æ˜Ÿå·é€šé…ç¬¦"></a>6. ä½¿ç”¨æ˜Ÿå·é€šé…ç¬¦</h2><pre><code>æ¥è‡ª*çš„ä½ </code></pre><p>googleä¼šå¸®ä½ æ‰¾åˆ°ç¬¦åˆä¸Šè¿°é€šé…ç¬¦çš„è¯æ¡/ é¡µé¢ã€‚</p><h2 id="7-æ‰¾åˆ°ä¸ä¸€ä¸ªç½‘ç«™ç›¸ä¼¼çš„ç½‘ç«™"><a href="#7-æ‰¾åˆ°ä¸ä¸€ä¸ªç½‘ç«™ç›¸ä¼¼çš„ç½‘ç«™" class="headerlink" title="7. æ‰¾åˆ°ä¸ä¸€ä¸ªç½‘ç«™ç›¸ä¼¼çš„ç½‘ç«™"></a>7. æ‰¾åˆ°ä¸ä¸€ä¸ªç½‘ç«™ç›¸ä¼¼çš„ç½‘ç«™</h2><pre><code>related:llchen60.com</code></pre><p>æ‰¾åˆ°å’Œè¿™ä¸ªç½‘ç«™ç±»ä¼¼çš„ç½‘ç«™ä»¬ </p><h2 id="8-åŒæ—¶å¯»æ‰¾å¤šä¸ªå…³é”®è¯"><a href="#8-åŒæ—¶å¯»æ‰¾å¤šä¸ªå…³é”®è¯" class="headerlink" title="8. åŒæ—¶å¯»æ‰¾å¤šä¸ªå…³é”®è¯"></a>8. åŒæ—¶å¯»æ‰¾å¤šä¸ªå…³é”®è¯</h2><pre><code>â€œfirst word&quot; OR &quot;second word&quot;</code></pre><h2 id="9-æœç´¢ä¸€ç³»åˆ—çš„æ•°æ®"><a href="#9-æœç´¢ä¸€ç³»åˆ—çš„æ•°æ®" class="headerlink" title="9. æœç´¢ä¸€ç³»åˆ—çš„æ•°æ®"></a>9. æœç´¢ä¸€ç³»åˆ—çš„æ•°æ®</h2><pre><code>nba championship ..2008nba chanpionship 2006..2008</code></pre><p>ç¬¬ä¸€ä¸ªæ˜¯åªæœç´¢2008å¹´çš„nbaå† å†›ï¼Œç¬¬äºŒä¸ªæ˜¯æœç´¢2006åˆ°2008å¹´çš„nbaå† å†›</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.lifehack.org/articles/technology/20-tips-use-google-search-efficiently.html" target="_blank" rel="noopener">https://www.lifehack.org/articles/technology/20-tips-use-google-search-efficiently.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¡…è°·å¢é•¿é»‘å®¢å®æˆ˜ç¬”è®°</title>
      <link href="/%E7%A1%85%E8%B0%B7%E5%A2%9E%E9%95%BF%E9%BB%91%E5%AE%A2%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/"/>
      <url>/%E7%A1%85%E8%B0%B7%E5%A2%9E%E9%95%BF%E9%BB%91%E5%AE%A2%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¢é•¿é»‘å®¢çš„ç†å¿µ"><a href="#1-å¢é•¿é»‘å®¢çš„ç†å¿µ" class="headerlink" title="1. å¢é•¿é»‘å®¢çš„ç†å¿µ"></a>1. å¢é•¿é»‘å®¢çš„ç†å¿µ</h1><h2 id="1-1-åŸºæœ¬çš„å®šä¹‰"><a href="#1-1-åŸºæœ¬çš„å®šä¹‰" class="headerlink" title="1.1 åŸºæœ¬çš„å®šä¹‰"></a>1.1 åŸºæœ¬çš„å®šä¹‰</h2><p>éœ€æ±‚åœ¨äºï¼šéœ€è¦ä¸€ä¸ªæ–°çš„å¸‚åœºè¥é”€çš„è§’è‰²ï¼Œè¦æœ‰ä¼ä¸šå®¶çš„ç²¾ç¥ï¼Œæœ‰å¼ºå¤§çš„å†…åœ¨åŠ¨åŠ›èƒ½æŒ‘èµ·å¢é•¿çš„è´£ä»»ï¼Œè¿«ä¸åŠå¾…æƒ³å°†äº§å“æ¨å¹¿ç»™æ›´å¤šå®¢æˆ·ï¼›åˆ›é€ æ€§å°è¯•æ–°æ–¹æ³•ï¼Œå¯¹æ–°æŠ€æœ¯å……æ»¡å¥½å¥‡ï¼›åº”ç”¨æ•°æ®éœ€è¦å¾—å¿ƒåº”æ‰‹ï¼Œé€šè¿‡æ•°æ®åˆ†ææ¥å¯»æ‰¾å¥½çš„æƒ³æ³•ï¼Œå¹¶ä¸”æŒ‰ç…§ç§‘å­¦å®éªŒçš„æ–¹æ³•è®ºï¼Œå¯¹è¿™äº›æƒ³æ³•è¿›è¡Œæµ‹è¯•ã€‚</p><p>éœ€è¦å¢é•¿å›¢é˜Ÿï¼Œè®©ä¼ä¸šå¿«é€Ÿå¢é•¿ â€“ growth hacking </p><h2 id="1-2-What-does-a-growth-manager-do"><a href="#1-2-What-does-a-growth-manager-do" class="headerlink" title="1.2 What does a growth manager do?"></a>1.2 What does a growth manager do?</h2><p>è´Ÿè´£ï¼š</p><ul><li>æ­å»ºæ•°æ®åŸºç¡€è®¾æ–½</li><li>å®šä¹‰å¢é•¿ç›®æ ‡</li><li>æä¾›ç”¨æˆ·æ´å¯Ÿ</li><li>æ’åºå¢é•¿é¡¹ç›®</li><li>è®¾è®¡å¹¶ä¸Šçº¿å®éªŒ</li></ul><p>growth manageréœ€è¦å°†åŸå…ˆå„è‡ªä¸ºæ”¿çš„äº§å“å¼€å‘å’Œè¥é”€èŒèƒ½æœ‰æœºæ•´åˆèµ·æ¥ã€‚</p><p>ä¼ ç»Ÿçš„äº§å“ç»ç†è´Ÿè´£äº§å“çš„å¼€å‘æµç¨‹ï¼Œæ›´å¤šçš„æ˜¯ä»¥è§£å†³æ–¹æ¡ˆä¸ºå¯¼å‘ï¼›è€Œå¢é•¿äº§å“ç»ç†ï¼Œè™½ç„¶éµå¾ªç±»ä¼¼çš„æµç¨‹ï¼Œä½†æ˜¯å‡ºå‘ç‚¹æ˜¯å¢é•¿â€”-å³é€šè¿‡ç”¨æˆ·è¡Œä¸ºçš„æ”¹å˜ï¼Œæ¥æ¨åŠ¨æŸä¸ªä¸šåŠ¡æŒ‡æ ‡çš„å¢é•¿ã€‚</p><blockquote><p>å¢é•¿äº§å“ç»ç†ï¼Œå°±æ˜¯å¤„åœ¨äº§å“å’Œè¥é”€çš„äº¤ç•Œç‚¹ä¸Šï¼Œè´Ÿè´£ç”¨äº§å“çš„æ‰‹æ®µè¾¾åˆ°è¥é”€çš„ç›®çš„ã€‚ </p></blockquote><h2 id="1-3-Pirate-Metrics"><a href="#1-3-Pirate-Metrics" class="headerlink" title="1.3 Pirate Metrics"></a>1.3 Pirate Metrics</h2><ul><li>Acquisition: ç”¨æˆ·è·å–</li><li>Activation: ç”¨æˆ·æ¿€æ´»</li><li>Retention: ç”¨æˆ·ç•™å­˜</li><li>Refereal: ç”¨æˆ·æ¨è</li><li>Revenue: ç›ˆåˆ©</li><li>Resurrection: æŒ½å›æµå¤±å®¢æˆ·</li></ul><p>å¯ä»¥çœ‹å‡ºå¢é•¿é»‘å®¢åœ¨å…³æ³¨ä¸€ä¸ªç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªç¯èŠ‚ã€‚</p><h1 id="2-å¢é•¿æ–¹æ³•è®º"><a href="#2-å¢é•¿æ–¹æ³•è®º" class="headerlink" title="2. å¢é•¿æ–¹æ³•è®º"></a>2. å¢é•¿æ–¹æ³•è®º</h1><h2 id="2-1-å¢é•¿å®éªŒ"><a href="#2-1-å¢é•¿å®éªŒ" class="headerlink" title="2.1 å¢é•¿å®éªŒ"></a>2.1 å¢é•¿å®éªŒ</h2><p>å°±æ˜¯å®éªŒï¼Œé’ˆå¯¹ä¸€ä¸ªç›®æ ‡ï¼Œäº§ç”Ÿä¸€ä¸ªå®éªŒå‡è®¾ï¼Œè®¾è®¡å®éªŒï¼Œåˆ†æç»“æœï¼Œçœ‹çœ‹å‡è®¾æ˜¯å¯¹æ˜¯é”™ã€‚</p><p>å¢é•¿æ–¹æ³•è®ºçš„ç²¾é«“å°±æ˜¯<strong><em>æŒ‰ç…§ç§‘å­¦å®éªŒçš„åŸåˆ™ï¼Œå°½é‡å‡†ç¡®çš„è®¾è®¡å®éªŒå’Œæµ‹é‡ç»“æœï¼Œä»è€Œå»ºç«‹èµ·ä¸€ä¸ªâ€œå¼€å‘-æµ‹è¯•-å­¦ä¹ â€çš„åé¦ˆé—­ç¯</em></strong></p><blockquote><p>å‡è®¾ -&gt; å¼€å‘ -&gt; æµ‹è¯• -&gt; æµ‹é‡ -&gt; æ•°æ® -&gt; å­¦ä¹  -&gt; å‡è®¾</p></blockquote><p>è¿™é‡Œçš„å®éªŒæŒ‡çš„æ˜¯A/ Bæµ‹è¯•</p><p>è¦ä¸åœçš„åœ¨çº¿åšABæµ‹è¯•ï¼ŒçŸ¥é“ä»€ä¹ˆæ ·çš„æ–¹å¼ä¼šæ›´åŠ æœ‰åˆ©äºå…¬å¸çš„å‘å±•ã€‚</p><h2 id="2-2-å¢é•¿æµç¨‹"><a href="#2-2-å¢é•¿æµç¨‹" class="headerlink" title="2.2 å¢é•¿æµç¨‹"></a>2.2 å¢é•¿æµç¨‹</h2><p>å¢é•¿å…³æ³¨çš„èŒƒå›´å¾ˆå¹¿ï¼Œä½†åº”è¯¥æœ‰çš„æ”¾çŸ¢ï¼Œè¦æœ‰ç­–ç•¥æœ‰é‡ç‚¹åœ°æŒ‰æµç¨‹è¿›è¡Œã€‚</p><p>ç»™å‡ºå¢é•¿ç›®æ ‡ï¼Œèšç„¦å¢é•¿é¢†åŸŸï¼Œäº§ç”Ÿæƒ³æ³•ï¼Œæƒ³æ³•æ‰§è¡Œé¡ºåºï¼Œå®éªŒï¼Œç»“æœï¼Œåé¦ˆï¼Œè°ƒæ•´ä¸ä¼˜åŒ–ï¼Œäº§ç”Ÿè‰¯æ€§å¾ªç¯ã€‚</p><p>ä»»ä½•äº‹æƒ…éƒ½æ˜¯ä¸€ä¸ªå®éªŒï¼Œé€šè¿‡å®ƒï¼Œä½ æˆ–è€…å®ç°å¢é•¿ï¼Œæˆ–è€…å­¦åˆ°ç»éªŒã€‚</p><h2 id="2-3-é¢å¯¹çš„æŒ‘æˆ˜"><a href="#2-3-é¢å¯¹çš„æŒ‘æˆ˜" class="headerlink" title="2.3 é¢å¯¹çš„æŒ‘æˆ˜"></a>2.3 é¢å¯¹çš„æŒ‘æˆ˜</h2><ol><li>åœ¨ä½å‚çš„æœå®è¢«æ…¢æ…¢æ‘˜æ‰ä»¥åï¼Œå¦‚ä½•æŒç»­ä¿è¯äº§ç”Ÿå¥½çš„å®éªŒç»“æœï¼Œé©±åŠ¨å¢é•¿æŒ‡æ ‡å‘¢ï¼Ÿ</li><li>é¢å¯¹æ¿€çƒˆçš„ç«äº‰å’Œå˜åŒ–çš„ç¯å¢ƒï¼Œå¦‚ä½•ç¦»ç”¨æˆ·æ›´è¿‘ã€å¦‚ä½•æŒç»­åˆ›æ–°è®©å¢é•¿å®éªŒæˆä¸ºäº§å“çš„ç«äº‰ä¼˜åŠ¿ï¼Ÿ</li><li>å¦‚ä½•ä¿è¯å¢é•¿æµç¨‹é«˜æ•ˆè¿ä½œã€å¢é•¿å›¢é˜Ÿå†…éƒ¨ç´§å¯†åˆä½œï¼Œæœ‰ä¸»äººç¿çš„æ„Ÿè§‰ï¼Ÿ</li><li>å¦‚ä½•ç¡®ä¿å’Œå…¶ä»–å›¢é˜Ÿä»¥åŠç®¡ç†å±‚çš„è‰¯å¥½æ²Ÿé€šå’Œåˆä½œï¼Œå¾—åˆ°å¤§å®¶çš„æ”¯æŒï¼Œè¾¾æˆå…±èµ¢ï¼Ÿ </li><li>å¦‚ä½•è®©å¢é•¿å®éªŒå’Œæ•°æ®é©±åŠ¨æˆä¸ºå…¬å¸æ–‡åŒ–çš„ä¸€éƒ¨åˆ†å‘¢ï¼Ÿ </li></ol><h1 id="3-ç”¨æˆ·è·å–ï¼Œæ¨èï¼Œæ¿€æ´»ï¼Œç•™å­˜ç­‰ä¸åŒé˜¶æ®µçš„å¢é•¿æŠ€å·§"><a href="#3-ç”¨æˆ·è·å–ï¼Œæ¨èï¼Œæ¿€æ´»ï¼Œç•™å­˜ç­‰ä¸åŒé˜¶æ®µçš„å¢é•¿æŠ€å·§" class="headerlink" title="3. ç”¨æˆ·è·å–ï¼Œæ¨èï¼Œæ¿€æ´»ï¼Œç•™å­˜ç­‰ä¸åŒé˜¶æ®µçš„å¢é•¿æŠ€å·§"></a>3. ç”¨æˆ·è·å–ï¼Œæ¨èï¼Œæ¿€æ´»ï¼Œç•™å­˜ç­‰ä¸åŒé˜¶æ®µçš„å¢é•¿æŠ€å·§</h1><h2 id="3-1-ç”¨æˆ·è·å–"><a href="#3-1-ç”¨æˆ·è·å–" class="headerlink" title="3.1 ç”¨æˆ·è·å–"></a>3.1 ç”¨æˆ·è·å–</h2><p>Flikr å’Œ instagram -&gt; çœŸæ­£ç‹¬ç‰¹çš„ç‚¹å­æ˜¯å¾ˆå°‘è§çš„</p><p>å¦‚ä»Šä¸€æ¬¾äº§å“èƒ½å¦æˆåŠŸè¶Šæ¥è¶Šå°‘ä¾é è®©äººè€³ç›®ä¸€æ–°çš„åŠŸèƒ½ï¼Œè€Œæ˜¯è¶Šæ¥è¶Šå¤šåœ°ä¾é æˆåŠŸçš„å¢é•¿ç­–ç•¥ã€‚</p><h3 id="3-1-1-æ–°ç”¨æˆ·è·å–çš„æ°¸æ’å…¬å¼-LTV-gt-CAC"><a href="#3-1-1-æ–°ç”¨æˆ·è·å–çš„æ°¸æ’å…¬å¼-LTV-gt-CAC" class="headerlink" title="3.1.1 æ–°ç”¨æˆ·è·å–çš„æ°¸æ’å…¬å¼  LTV &gt; CAC"></a>3.1.1 æ–°ç”¨æˆ·è·å–çš„æ°¸æ’å…¬å¼  LTV &gt; CAC</h3><p>Life Time Value &gt; Customer Acquisition Cost ï¼ˆè·å–ç”¨æˆ·çš„æˆæœ¬ï¼‰</p><p>ä¸€èˆ¬æ¥è¯´å¸Œæœ›æ¯”ä¾‹èƒ½å¤Ÿå¤§äº3.</p><p>CAC = ï¼ˆè¥é”€æ€»è´¹ç”¨ + é”€å”®æ€»è´¹ç”¨ï¼‰ã€åŒæ—¶æœŸæ–°å¢ç”¨æˆ·æ•°</p><h3 id="3-1-2-ç”¨æˆ·è·å–è¿‡ç¨‹ä¸­çš„æœ¯è¯­"><a href="#3-1-2-ç”¨æˆ·è·å–è¿‡ç¨‹ä¸­çš„æœ¯è¯­" class="headerlink" title="3.1.2 ç”¨æˆ·è·å–è¿‡ç¨‹ä¸­çš„æœ¯è¯­"></a>3.1.2 ç”¨æˆ·è·å–è¿‡ç¨‹ä¸­çš„æœ¯è¯­</h3><ol><li>æ··åˆCAC(Blended CAC) - å°†ä»˜è´¹æ¸ é“å’Œå¤©ç„¶æ¸ é“æ··åœ¨ä¸€èµ·è®¡ç®—çš„CAC</li><li>ä»˜è´¹CAC - ä»˜è´¹æ¸ é“çš„å¹³å‡é¡¾å®¢è·å–æˆæœ¬  è¿™ä¸ªæ•°å€¼ä»£è¡¨äº†ä½ å¯ä»¥æ§åˆ¶çš„æ¸ é“æ•ˆç‡ï¼Œå¯ä»¥ç†è§£ä¸ºå¦‚æœé£é™©æŠ•èµ„ç»™ä½ é’±ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…å°±å¯ä»¥é€šè¿‡åŠ å¤§æŠ•å…¥è€ŒæŒç»­ä»¥è¿™ä¸ªæˆæœ¬è·å–æ–°ç”¨æˆ·ã€‚</li><li>æ»¡è½½CAC - åŠ ä¸Šæ‰€æœ‰å¸‚åœºå’Œé”€å”®ç›¸å…³äººå‘˜çš„è–ªé…¬ï¼Œå·¥å…·ï¼Œè®¾å¤‡ç­‰èŠ±è´¹è€Œè®¡ç®—å‡ºæ¥çš„ç”¨æˆ·è·å–æˆæœ¬ã€‚</li></ol><h3 id="3-1-3-å¦‚ä½•è®¡ç®—ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„ä»·å€¼"><a href="#3-1-3-å¦‚ä½•è®¡ç®—ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„ä»·å€¼" class="headerlink" title="3.1.3 å¦‚ä½•è®¡ç®—ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„ä»·å€¼"></a>3.1.3 å¦‚ä½•è®¡ç®—ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„ä»·å€¼</h3><p>åŸºæœ¬æ€è·¯ï¼š </p><ol><li>ç”¨æˆ·ä¼šä½¿ç”¨å¤šå°‘ä¸ªæœˆ</li><li>å¹³å‡æ¯ä¸ªæœˆä½ èƒ½ä»ç”¨æˆ·èº«ä¸Šèµšå¤šå°‘é’±</li></ol><p>å¯¹äºæœ‰é«˜LTVçš„äº§å“æ‰ä¼šå»è¯·é”€å”®å›¢é˜Ÿï¼Œå¯¹äºLTVå¾ˆå°çš„ï¼Œæ›´å¤šæ˜¯éœ€è¦è¿›è¡Œç—…æ¯’ä¼ æ’­è¿™æ ·å­ã€‚</p><p>ä¸€ä¸ªäº§å“æƒ³è¦åšå¤§ï¼Œä»…ä»…æœ‰äº§å“å¸‚åœºçš„å¥‘åˆæ˜¯ä¸å¤Ÿçš„ï¼Œè€Œæ˜¯éœ€è¦å¸‚åœºã€äº§å“ã€æ¨¡å‹ã€æ¸ é“å››è€…ä¹‹é—´çš„å¥‘åˆã€‚</p><ul><li>å¸‚åœº-äº§å“å¥‘åˆï¼š æœ‰ä¸€ä¸ªç›®æ ‡å®¢æˆ·ç¾¤å­˜åœ¨ï¼Œå¯¹è¿™æ ·ä¸€ä¸ªäº§å“æœ‰éœ€è¦ã€‚</li><li>äº§å“-æ¸ é“å¥‘åˆï¼š èƒ½å¤Ÿåœ¨ç‰¹å®šçš„æ¸ é“å•†æ‰¾åˆ°è¯¥äº§å“çš„ç›®æ ‡å®¢æˆ·ç¾¤</li><li>æ¸ é“-æ¨¡å‹å¥‘åˆï¼š äº§å“çš„ç›ˆåˆ©æ¨¡å‹å’Œç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼èƒ½å¤Ÿæ”¯æŒä½¿ç”¨è¿™äº›æ¸ é“çš„æˆæœ¬</li><li>æ¨¡å‹-å¸‚åœºå¥‘åˆï¼š ç›®æ ‡å®¢æˆ·ç¾¤æ„¿æ„ä¸ºè¿™ä¸ªäº§å“è‚¤æµ…ï¼Œæ”¯æŒäº§å“çš„ç›ˆåˆ©æ¨¡å‹ã€‚</li></ul><h2 id="3-2-å¦‚ä½•é€‰æ‹©ç”¨æˆ·è·å–æ¸ é“ï¼Ÿ"><a href="#3-2-å¦‚ä½•é€‰æ‹©ç”¨æˆ·è·å–æ¸ é“ï¼Ÿ" class="headerlink" title="3.2 å¦‚ä½•é€‰æ‹©ç”¨æˆ·è·å–æ¸ é“ï¼Ÿ"></a>3.2 å¦‚ä½•é€‰æ‹©ç”¨æˆ·è·å–æ¸ é“ï¼Ÿ</h2><h3 id="3-2-1-äº†è§£äº§å“ç‰¹ç‚¹"><a href="#3-2-1-äº†è§£äº§å“ç‰¹ç‚¹" class="headerlink" title="3.2.1 äº†è§£äº§å“ç‰¹ç‚¹"></a>3.2.1 äº†è§£äº§å“ç‰¹ç‚¹</h3><ul><li>é¢å‘å¯¹è±¡ï¼š æ¶ˆè´¹è€…ï¼Œä¸­å°å‹ä¼ä¸šï¼Œå¤§å‹ä¼ä¸š</li><li>äº§å“å½¢æ€ï¼š ç§»åŠ¨åº”ç”¨ï¼ŒSaaSè½¯ä»¶ï¼Œç¡¬ä»¶äº§å“</li><li>æ‰€åœ¨è¡Œä¸šï¼š ç¤¾äº¤ã€æ¸¸æˆã€ç¤¾ç¾¤ã€é‡‘è</li><li>ç›ˆåˆ©æ¨¡å¼ï¼š å…è´¹ã€å¹¿å‘Šã€æœˆè´¹ã€äº§å“å†…è´­ä¹°</li><li>å•ä½ç»æµå­¦ï¼š ç”¨æˆ·å¹³å‡ç”Ÿå‘½å‘¨æœŸä»·å€¼</li></ul><p>å¯¹äºå¤§éƒ¨åˆ†äº§å“æ¥è¯´ï¼ŒçœŸæ­£èƒ½åšå¤§çš„ä¸€èˆ¬æ˜¯ä¸€åˆ°ä¸¤ä¸ªæ¸ é“ï¼Œç—…æ¯’ä¼ æ’­å¹¶ä¸é€‚åˆæ‰€æœ‰çš„äº§å“ã€‚</p><p>æ¯”å¦‚å¾®ä¿¡ï¼Œæ²¡æœ‰ä½¿ç”¨é—¨æ§›ï¼Œå…è´¹ï¼Œæ²¡æœ‰ä½¿ç”¨é—¨æ§›ï¼Œç”¨æˆ·å¾ˆå¿«èƒ½å¾—åˆ°ä»·å€¼ï¼Œå¹¶ä¸”å¤§å®¶éƒ½éœ€è¦ã€‚æœ€é‡è¦çš„æ˜¯ç”¨æˆ·ä½¿ç”¨ä¹‹åï¼Œæœ‰åŠ¨åŠ›æ¥é‚€è¯·ä»–çš„äº²æœ‹å¥½å‹æ¥ä½¿ç”¨ï¼Œä½¿ç”¨çš„äººè¶Šå¤šï¼Œå¯¹äº§å“çš„ç”¨æˆ·ä½“éªŒæå‡è¶Šå¤šï¼Œè¿™å°±æ˜¯ç½‘ç»œæ•ˆåº”ã€‚</p><h3 id="3-2-2-äº†è§£ç”¨æˆ·ç¾¤ä½“"><a href="#3-2-2-äº†è§£ç”¨æˆ·ç¾¤ä½“" class="headerlink" title="3.2.2 äº†è§£ç”¨æˆ·ç¾¤ä½“"></a>3.2.2 äº†è§£ç”¨æˆ·ç¾¤ä½“</h3><ul><li>æ€ä¹ˆæ ·çš„äºº</li><li>ç”Ÿæ´»èŠ‚å¥</li><li>ä»€ä¹ˆæ—¶é—´åšä»€ä¹ˆæ ·çš„äº‹æƒ…</li><li>å–œæ¬¢ç”¨ä»€ä¹ˆäº§å“</li><li>å»ä»€ä¹ˆåœ°æ–¹æ¶ˆè´¹</li><li>æœ‰å“ªäº›å…´è¶£</li><li>å…³æ³¨å“ªäº›åäºº</li></ul><h3 id="3-2-3-åˆ—å‡ºå¯èƒ½çš„å¤‡é€‰æ¸ é“"><a href="#3-2-3-åˆ—å‡ºå¯èƒ½çš„å¤‡é€‰æ¸ é“" class="headerlink" title="3.2.3 åˆ—å‡ºå¯èƒ½çš„å¤‡é€‰æ¸ é“"></a>3.2.3 åˆ—å‡ºå¯èƒ½çš„å¤‡é€‰æ¸ é“</h3><ul><li>ä»˜è´¹æ¸ é“ï¼šé€šè¿‡ä»˜è´¹å¹¿å‘Šè·å–ç”¨æˆ·çš„æ¸ é“</li><li>æœ‰æœºæ¸ é“ï¼šä¸éœ€è¦ç›´æ¥èŠ±å¹¿å‘Šè´¹ç”¨çš„è·å®¢æ¸ é“</li><li>å…¶ä»–æ¸ é“</li></ul><p>åœ¨å½“ä¸‹çš„åŒ—ç¾ï¼Œèƒ½åšåˆ°å¤§ä½“é‡çš„æ¸ é“æœ‰ï¼š</p><ul><li>ä»˜è´¹å¢é•¿<ul><li>facebook</li><li>instagram</li><li>google adwordsè´­ä¹°å…³é”®å­—å¹¿å‘Š</li></ul></li><li>ç—…æ¯’ä¼ æ’­<ul><li>äº§å“æœ¬èº«æœ‰ç¤¾äº¤å±æ€§</li><li>åŠŸèƒ½æ¶‰åŠå¤šäººåˆä½œæˆ–å…±äº«çš„</li><li>hotmail/ dropbox/ slack</li></ul></li><li>æœç´¢å¼•æ“ä¼˜åŒ–<ul><li>äº§å“èƒ½åˆ›é€ å¾ˆå¤šå†…å®¹</li><li>å°†æœç´¢å¼•æ“ä¼˜åŒ–ä½œä¸ºä¸»è¦æ¸ é“</li></ul></li><li>é”€å”®<ul><li>äººå·¥å®£è®²ï¼Œå±•ç¤º</li><li>å»ºç«‹ä¸€ä¸ªé‡å¤çš„é”€å”®æµç¨‹</li><li>æ‹›å‹Ÿé”€å”®å›¢é˜Ÿå¹¶è®¾è®¡ä¸€å¥—ä½“ç³»</li></ul></li></ul><p>ä¸ºä»€ä¹ˆè¿™å‡ ä¸ªæ¸ é“èƒ½åšå¤§å‘¢ï¼Ÿ </p><ol><li>éƒ½æ˜¯åé¦ˆé—­ç¯ï¼Œå½“ä½ é€šè¿‡è¿™äº›æ¸ é“è·å–äº†ç”¨æˆ·ä»ç”¨æˆ·èº«ä¸Šèµšåˆ°é’±ï¼Œéƒ½å¯ä»¥å†è¿›è¡ŒæŠ•å…¥çš„ã€‚</li><li>ä½“é‡è¶³å¤Ÿå¤§ã€‚å„å¤§ç¤¾äº¤ç½‘ç»œå¯¹ç”¨æˆ·å…è´¹ï¼Œç”¨æˆ·åŸºæ•°å¾ˆå¤§</li></ol><h3 id="3-2-4-ç­›é€‰æœ€åˆçš„è·å–æ¸ é“"><a href="#3-2-4-ç­›é€‰æœ€åˆçš„è·å–æ¸ é“" class="headerlink" title="3.2.4 ç­›é€‰æœ€åˆçš„è·å–æ¸ é“"></a>3.2.4 ç­›é€‰æœ€åˆçš„è·å–æ¸ é“</h3><ul><li>å¤§ä½“é‡çš„æ¸ é“ä¼˜å…ˆ</li><li>å…è´¹æˆ–ä¾¿å®œçš„æ¸ é“ä¼˜å…ˆ</li><li>å¯è¿½è¸ªçš„æ¸ é“ä¼˜å…ˆ</li><li>å¯ä»¥ç²¾å‡†å®šä½ç›®æ ‡ç”¨æˆ·ç¾¤çš„æ¸ é“</li><li>å¯ä»¥éšæ—¶å¼€å§‹ã€éšæ—¶ç»“æŸçš„æ¸ é“ä¼˜å…ˆ</li></ul><p>éœ€è¦äº†è§£å„ä¸ªæ¸ é“çš„ç‰¹ç‚¹ï¼Œå¼€å§‹æœ€åˆæµ‹è¯•ï¼Œç„¶åè¿½è¸ªå’Œåˆ†æç»“æœï¼Œæµ‹è¯•æ—¶éœ€è¦è§‚å¯Ÿä»¥ä¸‹ä¸¤ä¸ªæŒ‡æ ‡ï¼š</p><ol><li>å“ªä¸ªæ¸ é“ç”¨æˆ·è·å–æˆæœ¬æœ€ä½</li><li>å“ªä¸ªæ¸ é“è·å–çš„ç”¨æˆ·ç•™å­˜æ—¶é—´æœ€é•¿ï¼ŒLTVæœ€é«˜</li></ol><p>å¯ä»¥é€šè¿‡æ¿€æ´»æ¯”ä¾‹å’Œä»˜è´¹æ¯”ä¾‹æ¥è¿›è¡Œæ¨¡æ‹Ÿ</p><h3 id="3-2-5-è¿è¥ã€ä¼˜åŒ–ã€æ‹“å±•ç”¨æˆ·è·å–æ¸ é“"><a href="#3-2-5-è¿è¥ã€ä¼˜åŒ–ã€æ‹“å±•ç”¨æˆ·è·å–æ¸ é“" class="headerlink" title="3.2.5 è¿è¥ã€ä¼˜åŒ–ã€æ‹“å±•ç”¨æˆ·è·å–æ¸ é“"></a>3.2.5 è¿è¥ã€ä¼˜åŒ–ã€æ‹“å±•ç”¨æˆ·è·å–æ¸ é“</h3><p>åœ¨æ‰¾åˆ°äº†æœ€åˆçš„ç”¨æˆ·è·å–æ¸ é“ä»¥åï¼Œéœ€è¦åšï¼š</p><ul><li>åˆ¶å®šæ–°ç”¨æˆ·è·å–ç›®æ ‡</li><li>å†³å®šå¸‚åœºé¢„ç®—çš„åˆ†é…å’Œè¿›è¡Œæ¸ é“çš„æ—¥å¸¸è¿è¥</li><li>é€šè¿‡å¹¿å‘Šè®¾è®¡æµ‹è¯•å’Œç”¨æˆ·å®šä½æµ‹è¯•ï¼Œä¼˜åŒ–å·²æœ‰æ¸ é“çš„è¡¨ç°</li><li>ä¸æ–­å‘ç°å’Œæ¢ç´¢æ–°çš„æ¸ é“</li></ul><p>éœ€è¦æŒç»­è¿½è¸ªå·²æœ‰æ¸ é“çš„æˆæœ¬ï¼Œä¸æ–­è°ƒæ•´ï¼Œæµ‹è¯•å¹¶åŠ å…¥æ–°çš„æ¸ é“</p><blockquote><p>è¿‡äºä¾èµ–æŸä¸ªå•ä¸€æ¸ é“æ˜¯æœ‰é£é™©çš„ï¼Œä¸€æ—¦å»ºç«‹äº†ä¸€ä¸¤ä¸ªæ ¸å¿ƒæ¸ é“ï¼Œè¿˜éœ€è¦ä¸»åŠ¨å°è¯•æ–°çš„æ¸ é“ã€‚</p></blockquote><h2 id="3-3-æœ€æ£’çš„è·å–æ¸ é“-ç”¨æˆ·æ¨è"><a href="#3-3-æœ€æ£’çš„è·å–æ¸ é“-ç”¨æˆ·æ¨è" class="headerlink" title="3.3 æœ€æ£’çš„è·å–æ¸ é“ - ç”¨æˆ·æ¨è"></a>3.3 æœ€æ£’çš„è·å–æ¸ é“ - ç”¨æˆ·æ¨è</h2><p>ç”¨æˆ·æ¨èè¿™ä¸ªæ¸ é“ååˆ†å—æ¬¢è¿ï¼ŒåŸå› ä¸ºï¼š</p><ol><li>è·å–æˆæœ¬ä½ï¼šè€ç”¨æˆ·å¸®ä½ å¸¦æ¥æ–°çš„ç”¨æˆ·</li><li>ç”¨æˆ·è´¨é‡å¥½ï¼šèƒŒæ™¯ä¼šå’Œå·²æœ‰ç”¨æˆ·ç±»ä¼¼ï¼Œå› æ­¤æ›´æœ‰å¯èƒ½æˆä¸ºä½ çš„äº§å“çš„ç›®æ ‡ç”¨æˆ·</li><li>è½¬åŒ–æ¯”ä¾‹é«˜ï¼š æœ‰å¥½å‹æ¨èçš„ä¿¡ç”¨èƒŒä¹¦</li></ol><h3 id="3-3-1-ç”¨æˆ·æ¨èçš„ä¸‰ä¸ªæ¦‚å¿µ"><a href="#3-3-1-ç”¨æˆ·æ¨èçš„ä¸‰ä¸ªæ¦‚å¿µ" class="headerlink" title="3.3.1 ç”¨æˆ·æ¨èçš„ä¸‰ä¸ªæ¦‚å¿µ"></a>3.3.1 ç”¨æˆ·æ¨èçš„ä¸‰ä¸ªæ¦‚å¿µ</h3><ul><li>ç”¨æˆ·æ¨è</li><li>ç—…æ¯’ä¼ æ’­</li><li>ç½‘ç»œæ•ˆåº” - è¶Šå¤šçš„ç”¨æˆ·ï¼Œäº§å“/æœåŠ¡æ›´åŠ å®Œå–„ï¼Œè€ç”¨æˆ·å¾—åˆ°çš„ä»·å€¼ä¹Ÿæå‡äº†</li></ul><h3 id="3-3-2-ç”¨æˆ·æ¨èçš„ç±»å‹"><a href="#3-3-2-ç”¨æˆ·æ¨èçš„ç±»å‹" class="headerlink" title="3.3.2 ç”¨æˆ·æ¨èçš„ç±»å‹"></a>3.3.2 ç”¨æˆ·æ¨èçš„ç±»å‹</h3><ul><li>å£å£ç›¸ä¼ </li><li>å±•ç¤ºç›¸ä¼ </li><li>è¡¥è´´æ¨è - åŒå‘è¡¥è´´æ¨è - é€äº§å“åŠŸèƒ½æ¯”é€é’±å¥½</li><li>ç¤¾äº¤ç½‘ç»œç”¨æˆ·æ¨è</li><li>ç—…æ¯’ä¼ æ’­  æœ‰è¶£æ–°é¢– å…·æœ‰è§†è§‰æ„ŸæŸ“åŠ› å®¹æ˜“åˆ†äº«çš„ä¸œè¥¿</li><li>äº§å“å†…ä¼ æ’­æœºåˆ¶<ul><li>äº§å“éœ€æ±‚ - åŠŸèƒ½æœ¬èº«æ˜¯å¦éœ€è¦ç”¨æˆ·é‚€è¯·å…¶ä»–ç”¨æˆ·</li><li>å†…å®¹åˆ†äº« - çŸ¥ä¹ï¼Œç½‘æ˜“äº‘éŸ³ä¹ï¼Œå–œé©¬æ‹‰é›…</li><li>äººä¸ºåˆ¶é€  </li><li>æ¬¢ä¹æ—¶åˆ»ï¼Œæœ€å—¨çš„æ—¶å€™è®©ç”¨æˆ·åˆ†äº«</li><li>é¡ºä¾¿æ¥è§¦ - åŠ æ°´å°ï¼ŒåŠ ä¸€å¥è¯ä¹‹ç±»çš„</li></ul></li></ul><p>æœ€æˆåŠŸçš„äº§å“ä¸æ˜¯åœ¨ä¸Šå¸‚ä¹‹åæ‰è€ƒè™‘å¢é•¿çš„ï¼Œè€Œæ˜¯åœ¨æ‰“ç£¨äº§å“çš„åŒæ—¶å°±å¼€å§‹è®¾è®¡å’Œå®éªŒäº§å“å†…ç—…æ¯’ä¼ æ’­ã€ç”¨æˆ·æ¨èå’Œç½‘ç»œæ•ˆåº”çš„ç§ç§æœºåˆ¶ã€‚</p><h3 id="3-3-3-è¡¡é‡ç”¨æˆ·æ¨èçš„å…¬å¼"><a href="#3-3-3-è¡¡é‡ç”¨æˆ·æ¨èçš„å…¬å¼" class="headerlink" title="3.3.3 è¡¡é‡ç”¨æˆ·æ¨èçš„å…¬å¼"></a>3.3.3 è¡¡é‡ç”¨æˆ·æ¨èçš„å…¬å¼</h3><p>Kå› å­ï¼Œå°±æ˜¯çœ‹å¹³å‡æ¯ä¸ªè€ç”¨æˆ·å¯ä»¥å¸¦æ¥å‡ ä¸ªæ–°ç”¨æˆ·ã€‚å¦‚æœKå› å­å¤§äº1ï¼Œé‚£ä¹ˆç†è®ºä¸Šè¿™ä¸ªäº§å“å°±ä¸éœ€è¦å†å»äººä¸ºæ¨åŠ¨å¢é•¿äº†ã€‚</p><p>ç”¨æˆ·æ¨èå…±è¯†</p><ul><li>é€šè¿‡é‚€è¯·åŠ å…¥çš„æ–°ç”¨æˆ·æ•° = <ul><li>æ½œåœ¨çš„æ¨èäººæ€»æ•° x<ul><li>æ€»æ´»è·ƒç”¨æˆ·åŸºæ•°</li><li>æ¥è§¦åˆ°é‚€è¯·æœºä¼šçš„æ¯”ä¾‹</li></ul></li><li>æ¨èäººè½¬åŒ–ç‡ x</li><li>åˆ†æ”¯å› å­ x</li><li>è¢«æ¨èäººè½¬åŒ–ç‡</li></ul></li></ul><p>æ–°ç”¨æˆ·æ€»æ•° = æ€»æ´»è·ƒç”¨æˆ·åŸºæ•° x æ¥è§¦åˆ°é‚€è¯·æœºä¼šçš„æ¯”ä¾‹ x é‚€è¯·æœºä¼šé¡µé¢çš„è½¬åŒ–ç‡ x å¹³å‡æ¯äººå‘å‡ºçš„é‚€è¯·æ•°é‡ x è¢«æ¨èäººæ¥å—é‚€è¯·çš„æ¯”ä¾‹ x æ¥å—é‚€è¯·åå®Œæˆæ³¨å†Œçš„æ¯”ä¾‹</p><p>è¿™é‡Œé¢æœ‰å¤šä¸ªè½¬åŒ–æ¼æ–—ï¼Œéœ€è¦åšé’ˆå¯¹æ€§çš„åˆ†æï¼Œçœ‹ç“¶é¢ˆåœ¨å“ªé‡Œã€‚</p><h2 id="3-4-ç”¨æˆ·æ¿€æ´»ï¼šå¢é•¿çš„å…³é”®è½¬åŒ–ç‚¹"><a href="#3-4-ç”¨æˆ·æ¿€æ´»ï¼šå¢é•¿çš„å…³é”®è½¬åŒ–ç‚¹" class="headerlink" title="3.4 ç”¨æˆ·æ¿€æ´»ï¼šå¢é•¿çš„å…³é”®è½¬åŒ–ç‚¹"></a>3.4 ç”¨æˆ·æ¿€æ´»ï¼šå¢é•¿çš„å…³é”®è½¬åŒ–ç‚¹</h2><p>ä¸€ä¸ªå…¬å¸åº”è¯¥èŠ±è‡³å°‘å’Œæ–°äº§å“å¼€å‘ä¸€æ ·å¤šçš„ç²¾åŠ›åœ¨æ–°ç”¨æˆ·ä½“éªŒä¸Šï¼Œç”šè‡³æ›´å¤šã€‚</p><p>æ–°ç”¨æˆ·æ¿€æ´»åŒ…å«ä»æ–°ç”¨æˆ·é¦–æ¬¡ç™»å½•ã€å®Œæˆè´¦æˆ·æ³¨å†Œå’Œå¿…è¦çš„è®¾ç½®åˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨äº§å“å…³é”®åŠŸèƒ½çš„è¿™æ®µè¿‡ç¨‹ã€‚å› ä¸ºå®ƒå¤„äºå¸‚åœºå’Œäº§å“ä¹‹é—´ï¼Œæœ‰ç‚¹åƒä¸¤ä¸ç®¡åœ°å¸¦ï¼Œå¾ˆå®¹æ˜“è¢«å¿½ç•¥æ‰ã€‚</p><p>æ•°æ®æ˜¾ç¤ºï¼Œå¤§éƒ¨åˆ†åº”ç”¨ä¼šåœ¨ä¸‰å¤©å†…æµå¤±æ‰è¶…è¿‡75%çš„ç”¨æˆ·ã€‚</p><h3 id="3-4-1-å¦‚ä½•å®šä¹‰ç”¨æˆ·æ¿€æ´»"><a href="#3-4-1-å¦‚ä½•å®šä¹‰ç”¨æˆ·æ¿€æ´»" class="headerlink" title="3.4.1 å¦‚ä½•å®šä¹‰ç”¨æˆ·æ¿€æ´»"></a>3.4.1 å¦‚ä½•å®šä¹‰ç”¨æˆ·æ¿€æ´»</h3><p>Ahaæ—¶åˆ»ï¼Œç”¨æˆ·è®¤è¯†åˆ°è¿™ä¸ªäº§å“çš„ä½œç”¨çš„é‚£ä¸€æ—¶åˆ»ï¼Œé€šè¿‡è®¤è¯†åˆ°ä½œç”¨æ‰ä¼šæœ‰å¯èƒ½ç•™å­˜ä¸‹æ¥çš„ã€‚æ²¡æœ‰ç»å†è¿™ç§æ—¶åˆ»çš„ç”¨æˆ·ï¼Œä¼šæµå¤±æ‰çš„ã€‚</p><p>å¯¹äºå…¬å¸æ¥è¯´ï¼Œå®šä¹‰ç”¨æˆ·æ¿€æ´»ï¼Œéœ€è¦è¿™æ ·å­æ¥è¿›è¡Œæè¿°ï¼š<strong><em>è°åœ¨å¤šé•¿æ—¶é—´å†…å®Œæˆäº†å¤šå°‘æ¬¡çš„ä»€ä¹ˆè¡Œä¸º</em></strong></p><ul><li>å®šä¹‰ä¸€ä¸ªå…³é”®è¡Œä¸º</li><li>è¦æ‰¾åˆ°è¿™ä¸ªå…³é”®è¡Œä¸ºçš„å®Œæˆè€…</li><li>æ—¶é—´é™åº¦ï¼Œä»¥åŠå®Œæˆæ¬¡æ•°çš„é™å®š</li></ul><h3 id="3-4-2-ç†è§£å…³é”®è¡Œä¸º"><a href="#3-4-2-ç†è§£å…³é”®è¡Œä¸º" class="headerlink" title="3.4.2 ç†è§£å…³é”®è¡Œä¸º"></a>3.4.2 ç†è§£å…³é”®è¡Œä¸º</h3><p>å…³é”®è¡Œä¸ºï¼šæŒ‡è®©æ–°ç”¨æˆ·é€šè¿‡é‡‡å–æŸä¸ªç‰¹å®šè¡Œä¸ºè¿…é€Ÿäº†è§£åˆ°äº§å“çš„ä»·å€¼æ‰€åœ¨ï¼Œåˆ°è¾¾Ahaæ—¶åˆ»ã€‚ </p><ul><li>åˆ—å‡ºå¯èƒ½çš„å…³é”®è¡Œä¸º</li><li>é€šè¿‡æ•°æ®åˆ†æç­›é€‰å…³é”®è¡Œä¸º<ul><li>æ‰¾åˆ°å’Œé•¿æœŸç”¨æˆ·å­˜åœ¨æ­£ç›¸å…³æœ€å¼ºçš„è¡Œä¸º</li></ul></li><li>é€šè¿‡å®šæ€§ç”¨æˆ·è°ƒç ”è¿›ä¸€æ­¥ç¡®å®šå…³é”®è¡Œä¸º</li></ul><h3 id="3-4-3-è¡¡é‡ç”¨æˆ·æ¿€æ´»çš„å¸¸ç”¨æŒ‡æ ‡å’Œå›¾è¡¨"><a href="#3-4-3-è¡¡é‡ç”¨æˆ·æ¿€æ´»çš„å¸¸ç”¨æŒ‡æ ‡å’Œå›¾è¡¨" class="headerlink" title="3.4.3 è¡¡é‡ç”¨æˆ·æ¿€æ´»çš„å¸¸ç”¨æŒ‡æ ‡å’Œå›¾è¡¨"></a>3.4.3 è¡¡é‡ç”¨æˆ·æ¿€æ´»çš„å¸¸ç”¨æŒ‡æ ‡å’Œå›¾è¡¨</h3><ol><li>æ¿€æ´»ç‡ - æ–°ç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´ä»¥å†…å®Œæˆæ¿€æ´»è¡Œä¸ºçš„æ¯”ä¾‹ã€‚</li><li>æ¿€æ´»æ¼æ–—è½¬åŒ–ç‡ - è¿½è¸ªæ–°ç”¨æˆ·æ³¨å†Œå’Œæ¿€æ´»çš„å…¨è¿‡ç¨‹ï¼Œçœ‹ç”¨æˆ·å®Œæˆæ¯ä¸€ä¸ªæ­¥éª¤å è¿›å…¥è¿™ä¸ªæ­¥éª¤æ€»äººæ•°çš„æ¯”ä¾‹ã€‚</li><li>æ–°ç”¨æˆ·ç•™å­˜æŒ‡æ ‡ - æ–°ç”¨æˆ·ç»è¿‡ä¸€ä¸ªæœˆä»¥åï¼Œè¿˜æ˜¯å¦æ˜¯æ´»è·ƒç”¨æˆ·</li></ol><h3 id="3-4-4-æ¿€åŠ¨æŒ‡æ•°æ¨¡å‹"><a href="#3-4-4-æ¿€åŠ¨æŒ‡æ•°æ¨¡å‹" class="headerlink" title="3.4.4 æ¿€åŠ¨æŒ‡æ•°æ¨¡å‹"></a>3.4.4 æ¿€åŠ¨æŒ‡æ•°æ¨¡å‹</h3><p>ä»£è¡¨ç”¨æˆ·æœ‰å¤šå¤§åŠ¨åŠ›åœ¨æŸä¸ªæ—¶åˆ»å®ŒæˆæŸä»¶äº‹æƒ…ã€‚æ–°ç”¨æˆ·æ¿€æ´»çš„è¿‡ç¨‹å°±æ˜¯åœ¨æ¿€åŠ¨æŒ‡æ•°é™ä¸º0ä¹‹å‰å®Œæˆæ•´ä¸ªè¿‡ç¨‹ï¼Œä½“ä¼šåˆ°äº§å“çš„ä»·å€¼ã€‚</p><ol><li>è¦æ˜ç¡®ç”¨æˆ·çš„åˆå§‹æ¿€åŠ¨æŒ‡æ•°  å¤§å…¬å¸orå°å…¬å¸ï¼Ÿ æ¸ é“ï¼Ÿ </li><li>äº†è§£å„ä¸ªå…ƒç´ å¯¹æ¿€åŠ¨æŒ‡æ•°çš„å½±å“</li></ol><h3 id="3-4-5-æ–°ç”¨æˆ·å¼•å¯¼çš„åŸåˆ™"><a href="#3-4-5-æ–°ç”¨æˆ·å¼•å¯¼çš„åŸåˆ™" class="headerlink" title="3.4.5 æ–°ç”¨æˆ·å¼•å¯¼çš„åŸåˆ™"></a>3.4.5 æ–°ç”¨æˆ·å¼•å¯¼çš„åŸåˆ™</h3><ul><li>å¢å¼ºåŠ¨åŠ›<ul><li>ä¿æŒå¤–éƒ¨å¹¿å‘Šå’Œæ–°ç”¨æˆ·æ¬¢è¿é¡µé¢çš„å‰åä¸€è‡´æ€§</li><li>å‘ç”¨æˆ·è§£é‡Šä¸ºä»€ä¹ˆè¦å„ç§æƒé™ï¼Œè€Œä¸æ˜¯ä¸Šæ¥ç›´æ¥å°±è¦</li><li>åˆ©ç”¨ç¤¾ä¼šä¿¡ä»»ï¼Œ</li><li>è®©ç”¨æˆ·å‚ä¸å…¶ä¸­ï¼Œå®Œæˆä¸€ä¸ªå¼•å¯¼äº’åŠ¨çš„æµç¨‹</li></ul></li><li>å‡å°‘éšœç¢<ul><li>æ¨è¿Ÿæ³¨å†Œæ­¥éª¤ï¼Œè®©ç”¨æˆ·å…ˆä½¿ç”¨äº§å“</li><li>ç§»é™¤å¤šä½™æ­¥éª¤ï¼Œéšè—è¿‡å¤šä¿¡æ¯</li><li>é¿å…å†·å¯åŠ¨ï¼Œé¢„åŠ è½½</li></ul></li><li>é€‚æ—¶åŠ©æ¨<ul><li>æ˜ç¡®æœºä¼šçª—å£  æ˜ç¡®åœ¨å“ªä¸ªé˜¶æ®µéœ€è¦ç»™åŠ©åŠ›</li><li>çµæ´»é‡‡ç”¨å„ç§UXæ¨¡å¼è¿›è¡Œç”¨æˆ·å¼•å¯¼</li><li>åˆ©ç”¨é‚®ä»¶æˆ–ç§»åŠ¨æ¨é€ç­‰å¤–éƒ¨å½¢å¼æé†’ç”¨æˆ·å®Œæˆäº†æ–°ç”¨æˆ·çš„æ¿€æ´»</li></ul></li><li>ç§äººè®¢åˆ¶<ul><li>è®©ç”¨æˆ·è‡ªå·±é€‰æ‹©å…´è¶£å’Œåå¥½</li><li>æ ¹æ®ç”¨æˆ·æ¶ˆè´¹å†å²æ¨è</li><li>æ ¹æ®ç”¨æˆ·ç›®çš„ç»™äºˆä¸åŒçš„å¼•å¯¼</li><li>æ ¹æ®ç”¨æˆ·ä¸åŒçš„ç¾¤ç»„ç»™äºˆä¸åŒçš„å¼•å¯¼</li></ul></li></ul><p>æ³¨æ„é¿å…ï¼š </p><ul><li>æ­¥éª¤å¤ªå¤šï¼Œæµç¨‹å¤ªé•¿</li><li>æ²¡æœ‰èšç„¦åˆ°å…³é”®è¡Œä¸ºï¼Œæƒ³è®©æ–°ç”¨æˆ·åšçš„äº‹æƒ…å¤ªå¤šäº†</li><li>èŠ±å¤ªå¤šæ—¶é—´æ•™ç”¨æˆ·å¦‚ä½•ç”¨ç•Œé¢ï¼Œè€Œæ²¡æœ‰è®©ç”¨æˆ·ä½¿ç”¨äº§å“</li><li>å¤ªå¿«å®Œæˆè®¾ç½®ï¼Œæ²¡æœ‰è¶³å¤Ÿæ•™è‚²</li><li>æ³¨å†Œå¤ªé¡ºåˆ©ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„éšœç¢ç­›é€‰æ‰ä¸åˆæ ¼çš„ç”¨æˆ·</li><li>å¯¹æ¯ä¸ªç”¨æˆ·éƒ½ç»Ÿä¸€å¯¹å¾…</li></ul><h3 id="3-4-6-æ–°ç”¨æˆ·æ¿€æ´»-ç³»ç»Ÿå·¥ç¨‹"><a href="#3-4-6-æ–°ç”¨æˆ·æ¿€æ´»-ç³»ç»Ÿå·¥ç¨‹" class="headerlink" title="3.4.6 æ–°ç”¨æˆ·æ¿€æ´» - ç³»ç»Ÿå·¥ç¨‹"></a>3.4.6 æ–°ç”¨æˆ·æ¿€æ´» - ç³»ç»Ÿå·¥ç¨‹</h3><p>æ–°ç”¨æˆ·æ¿€æ´»æ˜¯æ•´ä¸ªå¢é•¿è¿‡ç¨‹ä¸­éš¾åº¦æœ€å¤§çš„ï¼ŒæˆåŠŸçš„ç”¨æˆ·æ¿€æ´»éœ€è¦</p><ul><li>å¸®åŠ©ç”¨æˆ·å®ŒæˆåŸºæœ¬çš„è´¦æˆ·è®¾ç½®</li><li>è®©ç”¨æˆ·å¯¹äº§å“æœ‰ä¸€å®šçš„äº†è§£</li><li>è®©ç”¨æˆ·å®Œæˆå’Œé•¿æœŸç•™å­˜æ¯æ¯ç›¸å…³çš„å…³é”®è¡Œä¸º</li><li>ä»¤ç”¨æˆ·æ„Ÿå—åˆ°äº§å“çš„ä»·å€¼</li><li>éœ€è¦æ–°ç”¨æˆ·åœ¨æœ‰é™æ—¶é—´å†…ï¼Œåœ¨è®¤è¯†ã€ä½“éªŒã€è¡ŒåŠ¨å’Œæƒ…æ„Ÿå››ä¸ªæ–¹é¢éƒ½å®Œæˆä¸€æ¬¡å‡çº§ï¼Œå˜æˆäº§å“çš„ä½¿ç”¨è€…</li></ul><p>æ–°ç”¨æˆ·æ•´ä¸ªæ¿€æ´»è¿‡ç¨‹éœ€è¦ä¸“é—¨çš„å›¢é˜Ÿï¼Œåšä¸“é—¨çš„äº‹æƒ…ï¼š</p><ul><li>å¤šä¸ªå›¢é˜Ÿ<ul><li>äº§å“ï¼Œå¸‚åœºï¼Œå¢é•¿ï¼Œå®¢æˆ·æˆåŠŸï¼Œé”€å”®ï¼Œè®¾è®¡ï¼Œå·¥ç¨‹äººå‘˜</li></ul></li><li>æ–°ç”¨æˆ·æ¿€æ´»éœ€è¦å¤šä¸ªæ¸ é“é…åˆ<ul><li>å¹¿å‘Š</li><li>äº§å“å†…æ–°ç”¨æˆ·çš„å¼•å¯¼</li><li>é‚®ä»¶æ¨é€</li><li>ç¤¾äº¤ç½‘ç»œ</li><li>å…¬å…³</li><li>æ´»åŠ¨</li></ul></li><li>å»¶é•¿å®šä¹‰æ–°ç”¨æˆ·æ¿€æ´»çš„æ—¶é—´æ®µ</li></ul><h2 id="3-5-ç”¨æˆ·ç•™å­˜ï¼šå¢é•¿çš„åšå®æ ¹åŸº"><a href="#3-5-ç”¨æˆ·ç•™å­˜ï¼šå¢é•¿çš„åšå®æ ¹åŸº" class="headerlink" title="3.5 ç”¨æˆ·ç•™å­˜ï¼šå¢é•¿çš„åšå®æ ¹åŸº"></a>3.5 ç”¨æˆ·ç•™å­˜ï¼šå¢é•¿çš„åšå®æ ¹åŸº</h2><p>ç”¨æˆ·ç•™å­˜çš„å½±å“ï¼š</p><ul><li>å¥½ç•™å­˜ä¼šä½¿ç”¨æˆ·ä»˜è´¹å‘¨æœŸå˜é•¿ï¼Œç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼LTVå‡é«˜</li><li>å¥½ç•™å­˜å¯ä»¥ä½¿å›¢é˜Ÿæœ‰é¢„ç®—æµ‹è¯•æ›´å¤šï¼Œæ›´è´µçš„å¢é•¿æ¸ é“</li><li>å¥½ç•™å­˜èƒ½å¸¦æ¥æ›´å¤šå¿ å®çš„è€ç”¨æˆ·ï¼Œå¯ä»¥æ¨èæ›´å¤šæ–°ç”¨æˆ·</li><li>å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶å¤åˆ©æ•ˆåº”</li></ul><h3 id="3-5-1-å®šä¹‰ç•™å­˜"><a href="#3-5-1-å®šä¹‰ç•™å­˜" class="headerlink" title="3.5.1 å®šä¹‰ç•™å­˜"></a>3.5.1 å®šä¹‰ç•™å­˜</h3><p>å¦‚ä½•å®šä¹‰ç•™å­˜ï¼š</p><ul><li>è®¡ç®—åŒä¸€ç”¨æˆ·ç¾¤ä¸åŒæ—¶é—´çš„ç•™å­˜ç‡(retension rate)</li><li>æˆ–è€…å«åŒæœŸç¾¤åˆ†æ</li><li>å°†åŒä¸€æ—¶é—´åŠ å…¥çš„ç”¨æˆ·æ”¾åœ¨ä¸€èµ·ï¼Œæ¨ªå‘è¿½è¸ªåœ¨æ¥ä¸‹æ¥å‡ ä¸ªæœˆï¼Œä¸€å¹´çš„æ—¶é—´é‡Œï¼Œæ˜¯ä¸æ˜¯è¿˜æŒç»­ä½¿ç”¨è¿™ä¸ªäº§å“ï¼Œæµå¤±æ¯”ä¾‹</li></ul><h3 id="3-5-2-ç•™å­˜çš„å…³é”®è¡Œä¸º"><a href="#3-5-2-ç•™å­˜çš„å…³é”®è¡Œä¸º" class="headerlink" title="3.5.2 ç•™å­˜çš„å…³é”®è¡Œä¸º"></a>3.5.2 ç•™å­˜çš„å…³é”®è¡Œä¸º</h3><ul><li>ä¸€å®šæ—¶é—´ä»¥åè¿”å›ç½‘ç«™ï¼Ÿ <ul><li>åŸºäºç”¨æˆ·ç™»å½•è¡Œä¸º</li><li>è¦çœ‹äº§å“ç‰¹å¾ï¼Œæ¯”å¦‚å¯¹äºåœ¨çº¿æ¸¸æˆï¼Œå°±å¾ˆå¤Ÿï¼›å¯¹äºå…¶ä»–çš„ï¼Œå¯èƒ½ä¸å¤Ÿäº†</li></ul></li><li>ç”¨æˆ·ç•™å­˜åº”å½“å’Œç”¨æˆ·çš„å…³é”®è¡Œä¸ºæŒ‚é’©</li><li>æ‰¾åˆ°å±äºäº§å“çš„å¤©ç„¶ä½¿ç”¨å‘¨æœŸ<ul><li>ä¸Šç½‘æ‰¾è¿™ä¸ªåˆ†ç±»ä¸‹çš„æ‹³å¤´äº§å“çš„æŒ‡æ ‡</li></ul></li><li>è®°å½•æµç¨‹<ul><li>è®°å½•æ¯ä¸€å‘¨é¦–æ¬¡å®Œæˆå…³é”®è¡Œä¸ºçš„ç”¨æˆ·æ•°ï¼Œä¹Ÿå°±æ˜¯æ¿€æ´»ç”¨æˆ·æ•°</li><li>è¿½è¸ªè¿™äº›ç”¨æˆ·åœ¨æ¥ä¸‹æ¥çš„æ¯ä¸€å‘¨é‡Œç»§ç»­å®Œæˆå…³é”®è¡Œä¸ºçš„æ•°é‡</li><li>é€šè¿‡1ï¼Œ2æ­¥ï¼Œè®¡ç®—æ¯ä¸€å‘¨æœ‰å…³é”®è¡Œä¸ºçš„ç”¨æˆ·å é¦–å‘¨æ¿€æ´»ç”¨æˆ·æ•°çš„ç™¾åˆ†æ¯”</li></ul></li></ul><h3 id="3-5-3-åˆ†æç•™å­˜æ›²çº¿"><a href="#3-5-3-åˆ†æç•™å­˜æ›²çº¿" class="headerlink" title="3.5.3 åˆ†æç•™å­˜æ›²çº¿"></a>3.5.3 åˆ†æç•™å­˜æ›²çº¿</h3><p>ä»ç•™å­˜æ›²çº¿ä¸Šï¼Œå¯ä»¥çœ‹å‡ºï¼š</p><ul><li>ä»ä¸åŒæ—¶æœŸçš„èµ·å§‹åŒæœŸç¾¤çš„å¤§å°å¯ä»¥çœ‹åˆ°ç”¨æˆ·æ•°çš„å¢é•¿é€Ÿåº¦</li><li>ä»ç”¨æˆ·å®Œæˆå…³é”®è¡Œä¸ºçš„æ¯”ä¾‹å¯ä»¥çœ‹åˆ°ç”¨æˆ·å¯¹äº§å“çš„å‚ä¸åº¦</li><li>ä»ä¸åŒæ—¶æœŸçš„åŒæœŸç¾¤æ›²çº¿å¯ä»¥çœ‹åˆ°ç”¨æˆ·çš„ç•™å­˜ç‡æ˜¯å¦æœ‰æ”¹å–„</li></ul><h3 id="3-5-4-ç•™å­˜çš„ä¸åŒé˜¶æ®µ"><a href="#3-5-4-ç•™å­˜çš„ä¸åŒé˜¶æ®µ" class="headerlink" title="3.5.4 ç•™å­˜çš„ä¸åŒé˜¶æ®µ"></a>3.5.4 ç•™å­˜çš„ä¸åŒé˜¶æ®µ</h3><ul><li>æ–°ç”¨æˆ·æ¿€æ´»é˜¶æ®µ<ul><li>æ³¨å†Œ</li><li>æ¿€æ´»</li><li>æ•´ä½“æ–°ç”¨æˆ·ä½“éªŒ</li></ul></li><li>ä¸­æœŸç•™å­˜é˜¶æ®µ<ul><li>æŒ‡ç”¨æˆ·å®Œæˆäº†é¦–æ¬¡å…³é”®è¡Œä¸ºä¹‹åç»§ç»­ç†Ÿæ‚‰äº§å“ï¼Œå‘ç°æ›´å¤šä»·å€¼</li></ul></li><li>é•¿æœŸç•™å­˜é˜¶æ®µ<ul><li>ä¸»è¦ç›®æ ‡æ˜¯è®©ç”¨æˆ·ç»å¸¸å›æ¥ä½¿ç”¨äº§å“ï¼Œæ„Ÿå—åˆ°äº§å“çš„æ ¸å¿ƒä»·å€¼</li></ul></li><li>æµå¤±ç”¨æˆ·é˜¶æ®µ<ul><li>é’ˆå¯¹å·²ç»æµå¤±çš„ç”¨æˆ·ï¼Œè®©ç”¨æˆ·é‡æ–°å‘ç°äº§å“ä»·å€¼ï¼Œå”¤å›ç”¨æˆ·</li></ul></li></ul><h3 id="3-5-5-ç”¨æˆ·åˆ†ç»„"><a href="#3-5-5-ç”¨æˆ·åˆ†ç»„" class="headerlink" title="3.5.5 ç”¨æˆ·åˆ†ç»„"></a>3.5.5 ç”¨æˆ·åˆ†ç»„</h3><ul><li>åˆ†ç»„å¹¶å¯¹æ¯”ä¸åŒç¾¤ç»„çš„ç•™å­˜æ›²çº¿</li><li>æ¯”è¾ƒä¸åŒæµé‡æ¥æºçš„ç”¨æˆ·ç•™å­˜æ›²çº¿</li><li>æ¯”è¾ƒä¸åŒç”¨æˆ·ç‰¹å¾çš„ç”¨æˆ·ç•™å­˜æ›²çº¿</li><li>ä¸åŒäº§å“å®¢æˆ·ç«¯</li><li>æœ€å¥½æŒ‰ç…§è¡Œä¸ºæ¥è¿›è¡Œåˆ’åˆ†</li></ul><h3 id="3-5-6-ç•™å­˜ä¸é•¿æœŸç•™å­˜ï¼ˆç”¨æˆ·å‚ä¸ï¼‰"><a href="#3-5-6-ç•™å­˜ä¸é•¿æœŸç•™å­˜ï¼ˆç”¨æˆ·å‚ä¸ï¼‰" class="headerlink" title="3.5.6 ç•™å­˜ä¸é•¿æœŸç•™å­˜ï¼ˆç”¨æˆ·å‚ä¸ï¼‰"></a>3.5.6 ç•™å­˜ä¸é•¿æœŸç•™å­˜ï¼ˆç”¨æˆ·å‚ä¸ï¼‰</h3><ul><li>ç”¨æˆ·ç•™å­˜ç‡æŒ‡è¿‡äº†ä¸€å®šæ—¶é—´åï¼Œæœ‰å¤šå°‘ç”¨æˆ·ä»ç„¶åœ¨äº§å“å†…è¿›è¡Œå…³é”®è¡Œä¸º</li><li>ç”¨æˆ·å‚ä¸åº¦æŒ‡åœ¨ä¸€å®šæ—¶é—´å†…ï¼Œç”¨æˆ·å¹³å‡æœ‰å‡ ä¸ªå…³é”®è¡Œä¸ºå’Œæœ‰å¤šå°‘ç”¨æˆ·åŒæ—¶æœ‰è¶…è¿‡ä¸€ç§ä»¥ä¸Šçš„å…³é”®è¡Œä¸º</li></ul><ul><li><p>æŒ‰ç…§ç”¨æˆ·å‚ä¸åº¦å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç±»</p><ul><li>æ¶ˆæç”¨æˆ· 90%<ul><li>æ²¡æœ‰æŒ‰ç…§æœ€ç†æƒ³çš„æ–¹å¼ä½¿ç”¨äº§å“ï¼Œä½†ä¼šæŒ‰ç…§è‡ªå·±çš„æ–¹å¼ä»¥æ¯”è¾ƒæ­£å¸¸çš„é¢‘ç‡æŒç»­ä½¿ç”¨äº§å“</li></ul></li><li>æ ¸å¿ƒç”¨æˆ· 9%<ul><li>ä»¥æ¯”è¾ƒæ­£å¸¸çš„é¢‘ç‡å’Œæ­£ç¡®çš„æ–¹å¼ä½¿ç”¨äº§å“ï¼Œæ˜¯æ´»è·ƒç”¨æˆ·é‡Œçš„å¤§å¤šæ•°</li></ul></li><li>è¶…çº§ç”¨æˆ· 1%<ul><li>åŒ…æ‹¬å„ç§è¿›é˜¶åŠŸèƒ½ </li></ul></li></ul></li><li><p>ç•™å­˜æ¨¡å‹</p><ul><li>å¢åŠ å‚ä¸ç”¨æˆ·æ•°</li><li>é•¿æœŸç•™ä½ç”¨æˆ·</li><li>è‡ªæˆ‘æŒç»­</li></ul></li><li><p>å³è¦æœ‰å¥½äº§å“ç»™ç”¨æˆ·å¸¦æ¥ä»·å€¼</p></li><li><p>äº§å“è¦èƒ½å¯¹ç”¨æˆ·çš„è¡Œä¸ºäº§ç”Ÿå½±å“</p></li><li><p>åè¿‡æ¥ç”¨æˆ·çš„è¡Œä¸ºä¹Ÿæˆä¸ºäº§å“ä½“éªŒçš„ä¸€éƒ¨åˆ†</p></li></ul><h3 id="3-5-7-å®Œæˆå…³é”®è¡Œä¸ºï¼š-BJ-Foggçš„è¡Œä¸ºæ¨¡å‹"><a href="#3-5-7-å®Œæˆå…³é”®è¡Œä¸ºï¼š-BJ-Foggçš„è¡Œä¸ºæ¨¡å‹" class="headerlink" title="3.5.7 å®Œæˆå…³é”®è¡Œä¸ºï¼š BJ Foggçš„è¡Œä¸ºæ¨¡å‹"></a>3.5.7 å®Œæˆå…³é”®è¡Œä¸ºï¼š BJ Foggçš„è¡Œä¸ºæ¨¡å‹</h3><p>B = MAT </p><p>è¡Œä¸ºçš„å‘ç”Ÿä¸å¦å—åˆ°åŠ¨åŠ›ï¼Œèƒ½åŠ›ï¼Œå’Œè§¦å‘çš„ä¸‰ä¸ªå› ç´ çš„å½±å“ã€‚</p><ul><li>è¡Œä¸ºï¼š æƒ³è®©ç”¨æˆ·é‡‡å–çš„è¡ŒåŠ¨</li><li>åŠ¨åŠ›ï¼š ç”¨æˆ·æœ‰å¤šæƒ³å®Œæˆè¿™ä¸ªè¡Œä¸º</li><li>èƒ½åŠ›ï¼š è¿™ä¸ªè¡Œä¸ºå¯¹ç”¨æˆ·æ¥è¯´æœ‰å¤šå®¹æ˜“</li><li>è§¦å‘ï¼š æé†’ç”¨æˆ·é‡‡å–è¡ŒåŠ¨</li></ul><h3 id="3-5-8-è®©ç”¨æˆ·å…»æˆä¹ æƒ¯"><a href="#3-5-8-è®©ç”¨æˆ·å…»æˆä¹ æƒ¯" class="headerlink" title="3.5.8 è®©ç”¨æˆ·å…»æˆä¹ æƒ¯"></a>3.5.8 è®©ç”¨æˆ·å…»æˆä¹ æƒ¯</h3><p>â€”â€“&gt;  ã€Šä¸Šç˜¾ï¼šè®©ç”¨æˆ·å…»æˆä½¿ç”¨ä¹ æƒ¯çš„å››å¤§äº§å“é€»è¾‘ã€‹</p><ul><li>ç»™ç”¨æˆ·çš„å•æ¬¡è¡Œä¸ºæä¾›å¥–åŠ±ï¼Œå¹¶ä¸”è¿™ä¸ªå¥–åŠ±åº”å½“æ˜¯ä¸å›ºå®šçš„</li><li>è¦æ±‚ç”¨æˆ·åœ¨äº§å“å½“ä¸­æŠ•å…¥ä¸€ç‚¹åŠªåŠ›ï¼Œè€Œè¿™ä¸€ç‚¹åŠªåŠ›å¯ä»¥å¢åŠ ç”¨æˆ·åœ¨äº§å“é‡Œå‚¨è—çš„ä»·å€¼</li><li>è¦è®©å¤–åœ¨çš„è§¦å‘å’Œç”¨æˆ·çš„å†…åœ¨è§¦å‘ç›¸ç»“åˆ</li><li>æ‰“é€ ä¸€ä¸ªå‚ä¸é—­ç¯ï¼Œè®©ç”¨æˆ·çš„ä¸€ä¸ªè¡Œä¸ºå¯ä»¥å¸¦æ¥æ›´å¤šçš„è¡Œä¸º</li></ul><h3 id="3-5-9-å‚ä¸é—­ç¯ï¼šè®©è¡Œä¸ºå¸¦æ¥æ›´å¤šçš„è¡Œä¸º"><a href="#3-5-9-å‚ä¸é—­ç¯ï¼šè®©è¡Œä¸ºå¸¦æ¥æ›´å¤šçš„è¡Œä¸º" class="headerlink" title="3.5.9 å‚ä¸é—­ç¯ï¼šè®©è¡Œä¸ºå¸¦æ¥æ›´å¤šçš„è¡Œä¸º"></a>3.5.9 å‚ä¸é—­ç¯ï¼šè®©è¡Œä¸ºå¸¦æ¥æ›´å¤šçš„è¡Œä¸º</h3><ul><li>å‚ä¸é—­ç¯ï¼š èƒ½å¤Ÿå°†è¡Œä¸ºæ”¾å¤§çš„è‰¯æ€§å¾ªç¯ï¼Œä¸€ä¸ªè¡Œä¸ºå¯ä»¥å¸¦æ¥å¦å¤–ä¸€ä¸ªè¡Œä¸ºï¼Œä»è€Œä½¿å¾—æ¯ä¸ªè¡Œä¸ºçš„ä»·å€¼éƒ½å¾—åˆ°æå‡</li><li>é€šè¿‡äº§å“è®¾è®¡è®©ç”¨æˆ·å‚ä¸é—­ç¯ï¼Œè®©æ¯æ¬¡è¡Œä¸ºéƒ½è¢«æ”¾å¤§ï¼Œå¸¦æ¥æ›´å¤šçš„è¡Œä¸ºï¼Œä»è€ŒåŠ æ·±å¯¹äº§å“çš„å‚ä¸åº¦ã€‚</li><li>ä»äº§å“è§’åº¦æ¥è¯´ï¼Œè¦æ‰¾åˆ°æœ‰æ•ˆçš„é’©å­ï¼Œé€šè¿‡æœ‰æ•ˆè§¦å‘è®©ç”¨æˆ·å®Œæˆè¡Œä¸º </li><li>ä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œäº§å“çš„è®¾è®¡è¦å’Œç”¨æˆ·çš„å†…åœ¨åŠ¨åŠ›ç›¸ä¸€è‡´ï¼Œå¹¶åœ¨ç”¨æˆ·è¡ŒåŠ¨åç»™äºˆåé¦ˆå’Œå¥–åŠ±ï¼Œä»è€Œæ¿€åŠ±ç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚</li><li>è§¦å‘ -&gt; è¡ŒåŠ¨ -&gt; åé¦ˆ -&gt; åŠ¨åŠ›</li></ul><h3 id="3-5-10-æé«˜ç”¨æˆ·ç•™å­˜çš„8ç§æ­¦å™¨"><a href="#3-5-10-æé«˜ç”¨æˆ·ç•™å­˜çš„8ç§æ­¦å™¨" class="headerlink" title="3.5.10 æé«˜ç”¨æˆ·ç•™å­˜çš„8ç§æ­¦å™¨"></a>3.5.10 æé«˜ç”¨æˆ·ç•™å­˜çš„8ç§æ­¦å™¨</h3><ul><li>äº§å“æ”¹è¿›<ul><li>äº§å“å›¢é˜Ÿå¾€å¾€æ›´ä¸“æ³¨äºå¼€å‘å’Œä¸Šçº¿æ–°çš„åŠŸèƒ½ï¼Œå¾€å¾€ä¼šå¿½ç•¥å¦‚ä½•è®©æ›´å¤šçš„ç”¨æˆ·åœ¨äº§å“å·²æœ‰åŠŸèƒ½ä¸Šå¾—åˆ°æ›´å¤šçš„ä»·å€¼</li><li>å¢é•¿å›¢é˜Ÿçš„åŠªåŠ›æ–¹å‘<ul><li>ä¼˜åŒ–æ–°ç”¨æˆ·å¼•å¯¼</li><li>æ”¹å–„ç”¨æˆ·ä½¿ç”¨ä½“éªŒ</li><li>åŠ å…¥æŒç»­å¼•å¯¼æœºåˆ¶</li><li>å¸®åŠ©ç”¨æˆ·å½¢æˆä½¿ç”¨ä¹ æƒ¯</li></ul></li></ul></li><li>æ–°ç”¨æˆ·å¼•å¯¼å’Œæ•™è‚²</li><li>é‚®ä»¶</li><li>é€šçŸ¥<ul><li>äº§å“å†…ä¿¡æ¯çš„ä½¿ç”¨ï¼Œå¿Œä¿¡æ¯è½°ç‚¸<ul><li>æ¨å¹¿æ–°åŠŸèƒ½ï¼Œæ–°å†…å®¹æˆ–è€…æé«˜å·²æœ‰åŠŸèƒ½ä½¿ç”¨åº¦</li><li>å¯¹æ—¶é—´æ•æ„Ÿçš„ä¿¡æ¯</li><li>ç»™ç”¨æˆ·æä¾›ä¿¡æ¯ï¼Œå’Œç”¨æˆ·äº’åŠ¨ï¼Œå¯¹è¯</li></ul></li></ul></li><li>æ¨é€<ul><li>RRFæ¨¡å‹<ul><li>è¦†ç›–é¢ Reach<ul><li>ç”±ç§»åŠ¨æ¨é€çš„è§¦å‘æƒ…æ™¯å’Œé€‚ç”¨ç”¨æˆ·ç¾¤å†³å®š </li></ul></li><li>ç›¸å…³æ€§ Relevance<ul><li>ç§»åŠ¨æ¨é€åˆ°è¾¾çš„åŠæ—¶æ€§å’Œå†…å®¹çš„ä¸ªäººåŒ– </li></ul></li><li>é¢‘ç‡ Frequency <ul><li>è§¦å‘æ¨é€çš„æƒ…æ™¯çš„å‘ç”Ÿé¢‘ç‡</li></ul></li></ul></li><li>æµ‹è¯•è¿‡ç¨‹<ul><li>æ£€æµ‹è´Ÿé¢çš„å½±å“ï¼Œå¦‚ç”¨æˆ·å–æ¶ˆæ¨é€æƒé™çš„æ¯”ç‡å’Œåº”ç”¨å¸è½½ç‡</li><li>å°æ¯”ä¾‹ç”¨æˆ·æµ‹è¯•</li><li>åªæœ‰åœ¨æœ€ç´§æ€¥çš„æ—¶å€™é€‚ç”¨éœ‡åŠ¨</li><li>åœ¨è®¡åˆ’ç§»åŠ¨æ¨é€æ—¶ï¼Œè€ƒè™‘ç”¨æˆ·çš„æ—¥å¸¸ç”Ÿæ´»èŠ‚å¥</li><li>åœ¨æ–‡æ¡ˆä¸­é€‚ç”¨å¤šç§å¤šæ ·çš„ä¸ªæ€§åŒ–è¯­è¨€</li><li>é€šè¿‡æ·±åº¦é“¾æ¥è®©ç”¨æˆ·ç›´æ¥åˆ°è¾¾åº”ç”¨å†…æŒ‡å®šçš„é¡µé¢</li><li>ä¸æ–­æµ‹è¯•ï¼Œä¸æ–­ä¼˜åŒ–</li></ul></li></ul></li><li>å®¢æˆ·æœåŠ¡</li><li>ä¿ƒé”€</li><li>å¿ è¯šå®¢æˆ·è®¡åˆ’</li><li>æ–°äº§å“</li></ul><h1 id="4-å¢é•¿å›¢é˜Ÿä¸å¢é•¿æµç¨‹"><a href="#4-å¢é•¿å›¢é˜Ÿä¸å¢é•¿æµç¨‹" class="headerlink" title="4. å¢é•¿å›¢é˜Ÿä¸å¢é•¿æµç¨‹"></a>4. å¢é•¿å›¢é˜Ÿä¸å¢é•¿æµç¨‹</h1><p>åˆ°åº•å¦‚ä½•åšå¢é•¿ï¼Ÿå› ä¸ºå¢é•¿æ¶‰åŠçš„èŒƒå›´éå¸¸å¹¿æ³›ï¼Œå¯ä»¥å°è¯•çš„æ–¹å‘å’ŒæŠ€å·§æœ‰å¾ˆå¤šï¼Œåšå¢é•¿çš„æ—¶å€™å¾ˆå®¹æ˜“é™·å…¥æ‰”é£é•–çš„é™·é˜±å½“ä¸­å»ï¼Œå°±æ˜¯å¸Œæœ›æœ‰å‡ ä¸ªä¼šè¢«æ‰”åˆ°é¶å­ä¸Šæ²¡æ‰ä¸‹æ¥ã€‚ä½†æ˜¯â€”â€“äºŒå…«å®šå¾‹ï¼Œä»»ä½•ç»™å®šæ—¶åˆ»ï¼Œå¯¹å¢é•¿æ¨åŠ¨æœ€å¤§çš„äº‹æƒ…å¯èƒ½åªæœ‰é‚£ä¹ˆä¸€ä¸¤ä»¶ã€‚</p><blockquote><p>å¢é•¿æˆåŠŸçš„ç§˜è¯€ä¸åœ¨äºåŒæ—¶åšå¾ˆå¤šäº‹ï¼Œè€Œæ˜¯åœ¨äºèƒ½å¤Ÿæ‰¾åˆ°ç›®å‰å½±å“å¢é•¿ç‡æœ€å…³é”®çš„ä¸€ä¸¤ä»¶äº‹ã€‚</p></blockquote><h2 id="4-1-å¢é•¿ä½œæˆ˜è®¡åˆ’ä¹¦"><a href="#4-1-å¢é•¿ä½œæˆ˜è®¡åˆ’ä¹¦" class="headerlink" title="4.1 å¢é•¿ä½œæˆ˜è®¡åˆ’ä¹¦"></a>4.1 å¢é•¿ä½œæˆ˜è®¡åˆ’ä¹¦</h2><p>ä»¥è¿™ä¸ªè®¡åˆ’ä¹¦ä¸ºè“å›¾é—®é—®é¢˜ï¼Œåšå‡è®¾ï¼Œåšæµ‹è¯•ï¼Œå¾—å‡ºç»“è®ºï¼Œæ­¥æ­¥ä¸ºè¥ï¼Œä¸æ–­è°ƒæ•´å’Œä¿®æ­£ä½ çš„å‡è®¾ï¼Œæ­ç¤ºå¢é•¿çš„é—®é¢˜å’Œå…³é”®æ‰€åœ¨ï¼Œä»è€Œæœ€ç»ˆè¾¾åˆ°ç›®æ ‡ã€‚è¿™å¼ è®¡åˆ’ä¹¦éœ€è¦æœ‰ï¼š</p><h3 id="4-1-1-æ–¹å‘æ ‡ï¼šåŒ—ææ˜ŸæŒ‡æ ‡"><a href="#4-1-1-æ–¹å‘æ ‡ï¼šåŒ—ææ˜ŸæŒ‡æ ‡" class="headerlink" title="4.1.1 æ–¹å‘æ ‡ï¼šåŒ—ææ˜ŸæŒ‡æ ‡"></a>4.1.1 æ–¹å‘æ ‡ï¼šåŒ—ææ˜ŸæŒ‡æ ‡</h3><p>ç»™å‡ºå…³é”®æ€§çš„æŒ‡æ ‡ï¼Œe.g  facebook: æ´»è·ƒç”¨æˆ·æ•°é‡ vs MySpace æ³¨å†Œç”¨æˆ·æ•°é‡</p><p>è¿™ä¸ªæŒ‡æ ‡ä»£è¡¨äº†ç®¡ç†å±‚å¯¹ç”¨æˆ·ä»·å€¼å’Œå…¬å¸æˆåŠŸå…³ç³»ä¹‹é—´çš„ç†è§£ã€‚æ•¢ä¸æ•¢ç§€ç»™æŠ•èµ„è€…çœ‹ï¼Œæ•¢ä¸æ•¢ç›´é¢é—®é¢˜ï¼Œå¾ˆå…³é”®äº†ã€‚æ¯”å¦‚äº¬ä¸œçš„åˆ æ‰è‡ªè¥æ•°æ®ï¼Œå®Œå…¨çš„éª—è‡ªå·±ï¼›åŒ…æ‹¬è‹¹æœä¸å†å…¬å¸ƒæ‰‹æœºé”€å”®æ•°é‡â€¦ </p><p>å¦‚ä½•å®šä¹‰åŒ—ææ˜ŸæŒ‡æ ‡ï¼Ÿ</p><ul><li>ä½ çš„äº§å“çš„æ ¸å¿ƒä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸ªæŒ‡æ ‡èƒ½è®©ä½ çŸ¥é“ä½ çš„ç”¨æˆ·ä½“éªŒåˆ°äº†è¿™ç§ä»·å€¼ä¹ˆï¼Ÿ</li><li>è¿™ä¸ªæŒ‡æ ‡èƒ½å¤Ÿåæ˜ ç”¨æˆ·çš„æ´»è·ƒç¨‹åº¦ä¹ˆï¼Ÿ </li><li>å¦‚æœè¿™ä¸ªæŒ‡æ ‡å˜å¥½äº†ï¼Œæ˜¯ä¸æ˜¯èƒ½å¤Ÿè¯´æ˜æ•´ä¸ªå…¬å¸æ˜¯åœ¨å‘å¥½çš„æ–¹å‘å‘å±•ï¼Ÿ </li><li>è¿™ä¸ªæŒ‡æ ‡æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“è¢«æ•´ä¸ªå›¢é˜Ÿç†è§£å’Œäº¤æµå‘¢ï¼Ÿ </li><li>è¿™ä¸ªæŒ‡æ ‡æ˜¯ä¸€ä¸ªå…ˆå¯¼æŒ‡æ ‡è¿˜æ˜¯ä¸€ä¸ªæ»åæŒ‡æ ‡ï¼Ÿ</li></ul><p>æ»åæŒ‡æ ‡ï¼Œæ¯”å¦‚æŒ‰æœˆä»˜è´¹ï¼Œä½†æ˜¯å¯èƒ½æœ‰äº›ç”¨æˆ·å°±æ˜¯å¿˜äº†å–æ¶ˆäº†<br>å…ˆå¯¼æŒ‡æ ‡ï¼š æœˆæ´»è·ƒç”¨æˆ·æ•°</p><ul><li>è¿™ä¸ªæŒ‡æ ‡æ˜¯ä¸æ˜¯ä¸€ä¸ªå¯æ“ä½œçš„æŒ‡æ ‡ï¼Ÿ </li></ul><h3 id="4-1-2-è·¯çº¿å›¾ï¼š-å¢é•¿æ¨¡å‹"><a href="#4-1-2-è·¯çº¿å›¾ï¼š-å¢é•¿æ¨¡å‹" class="headerlink" title="4.1.2 è·¯çº¿å›¾ï¼š å¢é•¿æ¨¡å‹"></a>4.1.2 è·¯çº¿å›¾ï¼š å¢é•¿æ¨¡å‹</h3><p>å¢é•¿æ¨¡å‹ï¼Œç±»ä¼¼äºä¼ ç»Ÿçš„å•†ä¸šæ¨¡å‹ï¼Œä½†æ˜¯å…¶é‡ç‚¹åœ¨äºå¢é•¿ï¼Œç”¨æˆ·çš„å¢é•¿å’Œåˆ©æ¶¦çš„å¢é•¿ã€‚</p><p>å¢é•¿æ¨¡å‹çš„ç²¾é«“æ˜¯å°†ç”Ÿæ„æç‚¼å’Œæ€»ç»“æˆä¸€ä¸ªæ•°å­¦å…¬å¼ï¼Œä»è€Œå¸®åŠ©ä½ ç”¨å…¨é¢ã€ç®€å•å’Œç»“æ„åŒ–çš„æ–¹å¼å»æ€è€ƒå¢é•¿ã€‚</p><p><strong><em>èƒ½ç”¨ä¸€ä¸ªå…¬å¼æ¥æè¿°æˆ‘ä»¬éƒ¨é—¨çš„ç”Ÿæ„å—ï¼Ÿ</em></strong> </p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å¸®åŠ©å›¢é˜Ÿç†è§£è¿‡å»çš„ä¸€äº›äº§å“å†³ç­–ï¼Œå¹¶ä¸”ç¡®å®šäº§å“çš„ä¼˜åŠ£åŠ¿ï¼Œè¿˜å¯ä»¥æ­ç¤ºä¸€äº›æ›¾ç»æˆç«‹ä½†ç°åœ¨å·²ç»è¿‡æ—¶çš„å‡è®¾ã€‚</p><p>å½“å›¢é˜Ÿæˆå‘˜åœ¨æ¯å¤©å†³ç­–ä¸­ï¼Œéƒ½å¯ä»¥ç”¨åŒæ ·çš„å¢é•¿æ¨¡å‹ä½œä¸ºæ ‡å‡†çš„æ—¶å€™ï¼Œå›¢é˜Ÿçš„æ–¹å‘å’Œä¼˜å…ˆçº§å°±ä¼šå˜å¾—æ›´åŠ ä¸€è‡´ã€‚</p><p>æ‰“é€ å¢é•¿æ¨¡å‹çš„æ–¹å¼ï¼š </p><ol><li>æ•°å­¦æ¨¡å‹å½“ä¸­çš„è¾“å…¥å˜é‡ï¼Œæ–¹ç¨‹ï¼Œè¾“å‡ºå˜é‡(åŒ—ææ˜ŸæŒ‡æ ‡)</li><li>çœ‹user journey </li><li>ç»™ç”¨æˆ·æ—…ç¨‹çš„æ¯ä¸€æ­¥éƒ½æ‰¾åˆ°ä¸€ä¸ªç›¸åº”çš„æŒ‡æ ‡ï¼Œç„¶åè®¾ç½®è¿½è¸ªæ¥å¼¥è¡¥è¿™ä¸ªæ¼æ–—ï¼Œç”¨è¿™äº›æŒ‡æ ‡ä½œä¸ºå¢é•¿æ¨¡å‹çš„è¾“å…¥å˜é‡ã€‚åŒæ—¶ï¼Œæ³¨æ„å°†å„ä¸ªè¾“å…¥å˜é‡ä¸æ–­åˆ†è§£åˆ°æœ€å°ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±èƒ½æ­ç¤ºå‡ºæ‰€æœ‰å¯¹å¢é•¿æœ‰å½±å“çš„å•ä¸ªè¾“å…¥å˜é‡ï¼Œå¹¶ä¸”å°†æ•°æ®è®°å½•ä¸‹æ¥ </li></ol><p>å…¶å®æ‰“é€ æ•´ä¸ªå¢é•¿æ¨¡å‹çš„ç›®çš„å°±æ˜¯æ­ç¤ºæ‰€æœ‰å½±å“å¢é•¿çš„è¾“å…¥å˜é‡ï¼Œå¹¶ä¸”ç”¨é‡åŒ–çš„æ–¹å¼æ¥æŒ‡å¯¼å®éªŒã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<strong><em>å°†æŠ½è±¡çš„å¢é•¿åˆ†è§£æˆä¸€ä¸ªä¸ªå…·ä½“çš„å½±å“å¢é•¿çš„è¾“å…¥å˜é‡</em></strong>ã€‚å½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è¾“å…¥å˜é‡éƒ½åˆ—å‡ºæ¥ä»¥åï¼Œå°±ä¼šå‘ç°å¢é•¿çš„é©±åŠ¨åŠ›å¯ä»¥æ¥è‡ªäºç”¨æˆ·å£°æ˜å‘¨æœŸçš„å„ä¸ªé˜¶æ®µï¼Œè€Œä¸ä»…ä»…æ˜¯æ–°ç”¨æˆ·çš„è·å–äº†ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼å®šé‡é¢„æµ‹æœªæ¥çš„å¢é•¿è¶‹åŠ¿ã€‚</p><h3 id="4-1-3-ä»ªè¡¨ç›˜ï¼š-å…³é”®æŒ‡æ ‡çœ‹æ¿-dashboard"><a href="#4-1-3-ä»ªè¡¨ç›˜ï¼š-å…³é”®æŒ‡æ ‡çœ‹æ¿-dashboard" class="headerlink" title="4.1.3 ä»ªè¡¨ç›˜ï¼š å…³é”®æŒ‡æ ‡çœ‹æ¿(dashboard)"></a>4.1.3 ä»ªè¡¨ç›˜ï¼š å…³é”®æŒ‡æ ‡çœ‹æ¿(dashboard)</h3><p>å…³é”®è¡Œä¸ºæ¼æ–—ï¼Œä¸€èˆ¬äº’è”ç½‘å…¬å¸çš„æ•°æ®ä¸»è¦åˆ†ä¸ºæ¸ é“æ•°æ®ã€ç›ˆåˆ©æ•°æ®å’Œç”¨æˆ·è¡Œä¸ºæ•°æ®ã€‚ç”¨æˆ·è¡Œä¸ºæ•°æ®ç”±äºå…¶å¯æ“ä½œæ€§å¼ºï¼Œæ˜¯å¢é•¿å›¢é˜Ÿæ‰¾åˆ°æœºä¼šçš„é‡‘çŸ¿ã€‚</p><p>äº‹ä»¶Eventç”¨äºæè¿°ç”¨æˆ·çš„è¡Œä¸ºï¼Œä¸€èˆ¬æ˜¯åœ¨ç½‘ç«™ã€åº”ç”¨ç•Œé¢ä¸­å‘ç”Ÿçš„ã€‚</p><p>é‡‡å–åˆ†çº§åˆ†æ­¥çš„æ–¹æ³•ï¼Œå…ˆå®šä¹‰å‡ºæœ€é‡è¦çš„å°‘æ•°å‡ ä¸ªäº‹ä»¶è¿›è¡Œè¿½è¸ªã€‚ç„¶åå†åšå…¶æ¬¡é‡è¦çš„æ—¶é—´ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å¾ªåºæ¸è¿›ï¼Œå¾ˆå¿«å°±å¯ä»¥å¾—åˆ°æœ€é‡è¦çš„æ•°æ®ã€‚</p><p>å¦‚æœä»å¤´å»ºç«‹ç”¨æˆ·è¡Œä¸ºè¿½è¸ªè®¡åˆ’ï¼Œæ‰¾åˆ°ä¸‰ä¸ªæœ€é‡è¦çš„ä¸€çº§äº‹ä»¶ï¼Œåº”è¯¥è¦<strong><em>ä»£è¡¨ç”¨æˆ·ä»åˆæ¬¡æ¥è§¦äº§å“åˆ°æœ€ç»ˆæˆåŠŸä½¿ç”¨äº§å“çš„æœ€é‡è¦çš„é‡Œç¨‹ç¢‘</em></strong>ã€‚</p><p>è­¬å¦‚åœ¨é›¶å”®ç½‘ç«™ï¼Œé‚£ä¹ˆé‡è¦çš„é‡Œç¨‹ç¢‘å¼è¡Œä¸ºåº”è¯¥æœ‰ï¼š äº§å“é¡µé¢æµè§ˆï¼›äº§å“åŠ å…¥è´­ç‰©è½¦ï¼›äº§å“è´­ä¹°æˆåŠŸã€‚</p><p>æ„å»ºç”¨æˆ·è¡Œä¸ºæ¼æ–—ï¼ï¼ï¼</p><p>çœ‹æ¿æ•°æ®åº”åŒ…æ‹¬ï¼š</p><ul><li>åŒ—ææ˜ŸæŒ‡æ ‡ æ•°å€¼ï¼Œè¶‹åŠ¿</li><li>å¢é•¿æ¨¡å‹å…³é”®æŒ‡æ ‡ï¼šå¤´éƒ¨è®¿å®¢é‡ï¼Œæ–°ç”¨æˆ·æ¿€æ´»ç‡ï¼Œè€ç”¨æˆ·ç•™å­˜ç‡ï¼Œç›ˆåˆ©æƒ…å†µç­‰</li><li>å…³é”®ç»†åˆ†æŒ‡æ ‡ï¼šæ¯”å¦‚ä¸å…³é”®è¡Œä¸ºç›¸å…³çš„æŒ‡æ ‡ã€ä¸€äº›é‡è¦æµç¨‹çš„æ¼æ–—åˆ†è§£ç­‰</li><li>é‡è¦ç”¨æˆ·åˆ†ç»„ï¼šæŒ‰æ¸ é“åˆ†ï¼ŒæŒ‰æ–°è€ç”¨æˆ·åˆ†ï¼ŒæŒ‰äº§å“å¹³å°åˆ†ç­‰</li></ul><h3 id="4-1-4-å‚è€ƒä¹¦ï¼š-ç”¨æˆ·å¿ƒç†å†³ç­–åœ°å›¾-å®šå‹æ•°æ®"><a href="#4-1-4-å‚è€ƒä¹¦ï¼š-ç”¨æˆ·å¿ƒç†å†³ç­–åœ°å›¾-å®šå‹æ•°æ®" class="headerlink" title="4.1.4 å‚è€ƒä¹¦ï¼š ç”¨æˆ·å¿ƒç†å†³ç­–åœ°å›¾(å®šå‹æ•°æ®)"></a>4.1.4 å‚è€ƒä¹¦ï¼š ç”¨æˆ·å¿ƒç†å†³ç­–åœ°å›¾(å®šå‹æ•°æ®)</h3><p>åšå¢é•¿ï¼Œæ•°æ®æ˜¯éå¸¸æœ‰ç”¨çš„æ­¦å™¨ï¼Œä½†æ˜¯æœ‰æ—¶å€™å®¹æ˜“çŠ¯è¿™æ ·çš„é”™è¯¯ï¼šå³æ€»æ˜¯ä»æ•°æ®çš„è§’åº¦æƒ³é—®é¢˜ï¼Œå´å¿½ç•¥äº†æ¯ä¸ªç”¨æˆ·éƒ½æ˜¯å®å®åœ¨åœ¨çš„å¤§æ´»äººã€‚å…¶å®ï¼Œå¢é•¿å›¢é˜Ÿçš„æœ€é«˜å¢ƒç•Œå°±æ˜¯èƒ½ä»ç”¨æˆ·ç¬¬ä¸€äººç§°è§†è§’çœ‹é—®é¢˜ï¼Œå°†äº§å“ä»·å€¼è¿…é€Ÿä¸ºç”¨æˆ·å‘ˆä¸Šã€‚</p><p>å¢é•¿æ¨¡å‹ä»å…¬å¸çš„è§’åº¦æ¥çœ‹ï¼Œé‡åŒ–äº†å½±å“å¢é•¿çš„æ¯ä¸€æ­¥çš„å…³é”®æŒ‡æ ‡ï¼Œåªè¦è½¬åŒ–ç‡ä¸æ˜¯100%ï¼Œå°±ä»æœ‰ä¼˜åŒ–ç©ºé—´ã€‚ä½†æ˜¯ä»ç”¨æˆ·è§’åº¦æ¥çœ‹ï¼Œä¹Ÿä»£è¡¨äº†æ¯ä¸€ä¸ªç”¨æˆ·çš„å†³ç­–è¿‡ç¨‹ã€‚é€šè¿‡è½¬åŒ–ç‡çš„æ€»å’Œæ•°å­—ï¼Œæˆ‘ä»¬ä¹Ÿè¦è®¤è¯†åˆ°æ¯ä¸€ä¸ªç”¨æˆ·<strong>åŠ¨æœºä¸åŒï¼ŒèƒŒæ™¯ä¸åŒï¼Œæ‰€å¤„çŠ¶æ€ä¸åŒï¼Œæ€ç»´æ¨¡å¼ä¸åŒï¼Œå› æ­¤å†³ç­–çš„è¿‡ç¨‹</strong>ä¸åŒã€‚</p><p>éœ€è¦æ·±å…¥äº†è§£ç”¨æˆ·å¿ƒç†å­¦ï¼Œæ‰èƒ½æœ‰æ•ˆåœ°é©±åŠ¨å¢é•¿ã€‚</p><p>éœ€è¦äº†è§£ç”¨æˆ·åœ¨å†³ç­–çš„ä¸åŒé˜¶æ®µçš„å¿ƒç†å­¦ï¼š </p><ul><li>è®¿é—®é˜¶æ®µ</li></ul><p>è¦è§£å†³çš„é—®é¢˜ï¼šç”¨æˆ·ä¼šæ³¨æ„åˆ°è¿™ä¸ªäº§å“ä¹ˆï¼Ÿ </p><p>ç”±äºç”¨æˆ·ç»™äº§å“çš„æ³¨æ„åŠ›å¾ˆå°‘ï¼Œå¢é•¿å›¢é˜Ÿéœ€è¦åœ¨ç¨çºµå³é€çš„æœºä¼šé‡ŒæŠ“ä½ç”¨æˆ·çš„æ³¨æ„åŠ›å’Œæƒ…æ„Ÿï¼Œæ‰€ä»¥é‡ç‚¹åœ¨äºé€šè¿‡æœ‰å†²å‡»åŠ›çš„è®¾è®¡å’Œæ–‡æ¡ˆå¸å¼•ç”¨æˆ·çš„çœ¼çƒï¼Œå¼•èµ·ç”¨æˆ·çš„å…±é¸£ã€‚Keep - è‡ªå¾‹ç»™æˆ‘è‡ªç”±</p><ul><li>è½¬åŒ–é˜¶æ®µ</li></ul><p>éœ€è¦å¸®åŠ©ç”¨æˆ·åšå‡ºå°è¯•çš„å†³å®šã€‚è¿™ä¸ªæ—¶å€™æœºä¼šçª—å£å…¶å®è¿˜æ˜¯ç›¸å¯¹çŸ­æš‚çš„ï¼Œéœ€è¦ç”¨<strong><em>å¥½çš„è®¾è®¡å’Œæ•…äº‹</em></strong>å¼•èµ·ç”¨æˆ·çš„æƒ…æ„Ÿå…±é¸£ï¼Œé€šè¿‡æ¸…æ™°çš„æ–‡æ¡ˆæè¿°äº§å“çš„å¥½å¤„ï¼Œç»™ç”¨æˆ·æ¨èä¸ªæ€§åŒ–çš„å†…å®¹å’Œäº§å“ï¼Œä»¥åŠé€šè¿‡å„ç§å¿ƒç†å­¦çš„æ–¹å¼ï¼Œä¾‹å¦‚<strong><em>ç¨€ç¼ºæ€§ã€ç¤¾äº¤è¯æ®ã€ç´§è¿«æ„Ÿ</em></strong>ç­‰ï¼Œå¢å¼ºç”¨æˆ·å°è¯•çš„åŠ¨åŠ›</p><ul><li>æ¿€æ´»é˜¶æ®µ</li></ul><p>å¼•å¯¼ç”¨æˆ·å°½å¿«å®Œæˆå„ç§å¿…é¡»çš„æ­¥éª¤ï¼Œè¿›è¡Œå…³é”®åŠ¨ä½œï¼Œä½“éªŒäº§å“çš„æ ¸å¿ƒä»·å€¼ã€‚â€œæˆ‘è¯¥å¦‚ä½•ä½¿ç”¨è¿™ä¸ªäº§å“â€â€”-&gt; â€œæˆ‘å¾—åˆ°äº†æˆ‘æƒ³è¦çš„äº†ä¹ˆâ€</p><p>è¿™ä¸ªæ—¶å€™ç”¨æˆ·å¯¹äº§å“çš„å…³æ³¨åº¦è¾¾åˆ°äº†å³°å€¼ï¼Œåœ¨å†³ç­–çš„è¿‡ç¨‹ä¸­å¼€å§‹æ›´å¤šåœ°è¿ç”¨é€»è¾‘å­¦ä¹ æ–°äº§å“çš„ä½¿ç”¨ã€‚å¢é•¿å›¢é˜Ÿéœ€è¦å…³æ³¨çš„é‡ç‚¹æ˜¯ï¼šé€šè¿‡å„ç§æ–¹å¼å¼•å¯¼ï¼Œç®€åŒ–æµç¨‹ï¼Œå»é™¤é˜»ç¢è¡ŒåŠ¨çš„å£å’ï¼Œé€‚æ—¶æé†’æ²¡æœ‰è¡ŒåŠ¨çš„ç”¨æˆ·ï¼Œä»¥åŠå¸®åŠ©ç”¨æˆ·è®¾ç«‹ä¸€ä¸ªå‘é«˜çº§ç”¨æˆ·è¿›å‘çš„ç›®æ ‡å’Œè®¡åˆ’ã€‚</p><ul><li>ç•™å­˜é˜¶æ®µ</li></ul><p>å¸®åŠ©ç”¨æˆ·å½¢æˆä½¿ç”¨ä¹ æƒ¯ï¼Œå¼•å¯¼ç”¨æˆ·ç»§ç»­ä½¿ç”¨æ›´å¤šåŠŸèƒ½ï¼Œå¹¶æ„Ÿå—åˆ°è¿›å±•ã€‚</p><p>å¸®åŠ©è§£å†³çš„é—®é¢˜æ˜¯ï¼š</p><ol><li>ä¸ºä»€ä¹ˆè¦ç»§ç»­ä½¿ç”¨è¿™ä¸ªäº§å“ï¼Ÿ</li><li>è¯¥ä»€ä¹ˆåœºæ™¯ä¸‹ç»§ç»­ä½¿ç”¨å‘¢ï¼Ÿ</li><li>èƒ½ç»§ç»­å‘ç°æ–°çš„ä»·å€¼ä¹ˆï¼Ÿ</li></ol><p>é€šè¿‡å„ç§æœºåˆ¶ç•™ä½ç”¨æˆ·ï¼Œåº†ç¥è¿›å±•ï¼Œé‡Œç¨‹ç¢‘ï¼Œé€‚æ—¶çš„æé†’å’Œæ²Ÿé€šï¼Œå‘ç”¨æˆ·ä»‹ç»æ–°åŠŸèƒ½ç­‰ã€‚</p><ul><li>æ¨èé˜¶æ®µ</li></ul><p>å¸®åŠ©ç”¨æˆ·å›ç­” â€”- â€œæˆ‘ç°åœ¨è¦æŠŠè¿™ä¸ªä»‹ç»ç»™åˆ«äººå—ï¼Ÿâ€</p><p>æƒ…æ„Ÿå†³ç­–ï¼ˆå–œæ¬¢è¿™ä¸ªä¸œè¥¿ï¼‰è¿˜æ˜¯é€»è¾‘å†³ç­–ï¼ˆåˆ†äº«çš„å„ç§å¥–åŠ±ï¼‰</p><ul><li>å˜ç°é˜¶æ®µ</li></ul><p>å¸®åŠ©ç”¨æˆ·å›ç­” â€”- â€œæˆ‘æ„¿æ„ä¸ºä»–ä»˜é’±ä¹ˆï¼Ÿå€¼å¾—ä¹ˆï¼Ÿâ€ </p><h2 id="4-2-ç§»åŠ¨åº”ç”¨çš„å¢é•¿æ¡†æ¶"><a href="#4-2-ç§»åŠ¨åº”ç”¨çš„å¢é•¿æ¡†æ¶" class="headerlink" title="4.2 ç§»åŠ¨åº”ç”¨çš„å¢é•¿æ¡†æ¶"></a>4.2 ç§»åŠ¨åº”ç”¨çš„å¢é•¿æ¡†æ¶</h2><ol><li>æŠ€æœ¯æ˜¯æœ€åº•å±‚çš„åŸºç¡€</li><li>åˆ†æå’Œæ´å¯Ÿæ˜¯æŒ‡å¯¼å¢é•¿ç­–ç•¥çš„æ ¹æœ¬</li><li>ç”¨æˆ·è·å–ã€å‚ä¸å’Œç•™å­˜ï¼Œä»¥åŠå˜ç°æ˜¯ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªä¸»è¦é˜¶æ®µ</li><li>å…·ä½“æ¸ é“çš„è¿ç”¨è·¨è¶Šäº†ç”¨æˆ·çš„ä¸åŒç”Ÿå‘½å‘¨æœŸã€‚</li></ol><p><img src="%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%A2%9E%E9%95%BF%E6%A1%86%E6%9E%B6%E5%9B%BE.jpg" alt="ç§»åŠ¨åº”ç”¨å¢é•¿æ¡†æ¶å›¾"></p><h2 id="4-3-ç»„å»ºå¢é•¿å›¢é˜Ÿ"><a href="#4-3-ç»„å»ºå¢é•¿å›¢é˜Ÿ" class="headerlink" title="4.3 ç»„å»ºå¢é•¿å›¢é˜Ÿ"></a>4.3 ç»„å»ºå¢é•¿å›¢é˜Ÿ</h2><h3 id="4-3-1-æ¶æ„"><a href="#4-3-1-æ¶æ„" class="headerlink" title="4.3.1 æ¶æ„"></a>4.3.1 æ¶æ„</h3><ul><li>å›¢é˜Ÿè´Ÿè´£äººç›´æ¥æ±‡æŠ¥ç»™CEO</li><li>å°†è¿™ç§ç‹¬ç«‹å‹çš„å¢é•¿å›¢é˜Ÿæ¶æ„ä½œä¸ºå†…éƒ¨æœ€é‡è¦çš„ç›®æ ‡</li><li>ä¸“é—¨å›¢é˜Ÿç”¨å…¨éƒ¨æ—¶é—´è´Ÿè´£å¢é•¿</li><li>åˆ†å¼€çš„å°å¢é•¿å›¢é˜Ÿ<ul><li>æ–°ç”¨æˆ·è·å–</li><li>ç”¨æˆ·æ¿€æ´»</li><li>ç”¨æˆ·å‚ä¸åº¦æå‡</li><li>æµå¤±ç”¨æˆ·å”¤å›</li></ul></li><li>å›¢é˜Ÿäººå‘˜æ„æˆï¼Œå…¨æ‰éš¾æ±‚ï¼Œä½†æ˜¯å¢é•¿æ˜¯ä¸ªå¾ˆå¤åˆçš„è¿‡ç¨‹<ul><li>äº§å“ç»ç†</li><li>åˆ†æå¸ˆ</li><li>ç”¨æˆ·ç ”ç©¶å¸ˆ</li><li>è®¾è®¡å¸ˆ</li><li>å·¥ç¨‹å¸ˆ</li></ul></li><li>è¿ä½œæµç¨‹<ul><li>ç†è§£æ•°æ®</li><li>å‘ç°æœºä¼š</li><li>æ‰§è¡Œè®¡åˆ’</li></ul></li><li>å›¢é˜Ÿæ¯åŠå¹´å®šä¸€ä¸ªå¢é•¿ç›®æ ‡</li><li>æ¯8å‘¨ä½œä¸ºä¸€ä¸ªå¢é•¿å‘¨æœŸ<ul><li>2å‘¨ <ul><li>åˆ†æå·²æœ‰æ•°æ®å’Œå¤´è„‘é£æš´å†³å®šåšä»€ä¹ˆ</li><li>åˆ¶å®šå¢é•¿è§„åˆ’å›¾</li></ul></li><li>6å‘¨<ul><li>åšå¼€å‘å’Œæ‰§è¡Œ</li></ul></li><li>æ±‡æ€»åˆ†æç»“æœå¹¶å†³å®šä¸‹ä¸€æ­¥çš„è®¡åˆ’</li></ul></li></ul><h3 id="4-3-2-å¢é•¿ï¼Œäº§å“ï¼Œè¥é”€ï¼Œè¿è¥çš„åŒºåˆ«å’Œè”ç³»"><a href="#4-3-2-å¢é•¿ï¼Œäº§å“ï¼Œè¥é”€ï¼Œè¿è¥çš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="4.3.2 å¢é•¿ï¼Œäº§å“ï¼Œè¥é”€ï¼Œè¿è¥çš„åŒºåˆ«å’Œè”ç³»"></a>4.3.2 å¢é•¿ï¼Œäº§å“ï¼Œè¥é”€ï¼Œè¿è¥çš„åŒºåˆ«å’Œè”ç³»</h3><ul><li><p>å¢é•¿å›¢é˜Ÿæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä»¥ç”¨æˆ·å’Œåˆ©æ¶¦å¢é•¿ä¸ºç›®æ ‡çš„äº§å“å›¢é˜Ÿã€‚</p><ul><li>å¢é•¿å›¢é˜Ÿè¢«å…è®¸åœ¨äº§å“å†…éƒ¨è¿›è¡Œä¼˜åŒ–å’Œæ”¹åŠ¨</li><li>æœ‰å·¥ç¨‹å¸ˆèµ„æºæ”¯æŒèƒ½å¤Ÿè¾¾åˆ°è¿™ä¸ªç›®çš„</li></ul></li><li><p>å’Œäº§å“å›¢é˜Ÿçš„ä¸åŒ</p><ul><li>äº§å“å›¢é˜Ÿçš„æ—¥å¸¸æ´»åŠ¨å›´ç»•ç€äº§å“å’ŒåŠŸèƒ½çš„å¼€å‘å±•å¼€</li><li>å¢é•¿å›¢é˜Ÿçš„ç›®æ ‡æ˜¯å¢é•¿ï¼Œè¿½æ±‚çš„æ˜¯å½±å“åŠ›å’Œç»“æœ</li><li>äº§å“æ˜¯ä»·å€¼åˆ›é€ ï¼Œè€Œå¢é•¿æ˜¯åœ¨å‘æ›´å¤šçš„äººä¼ æ’­ä»·å€¼</li><li>å¢é•¿å›¢é˜Ÿæ›´åé‡æŒ‡æ ‡ä¸ºå¯¼å‘ï¼Œå…¶æ–¹æ³•è®ºæ›´åå‘æ•°æ®é©±åŠ¨ï¼Œæ›´æ³¨é‡å®éªŒï¼Œå¹¶ä¸”å¸¸è¦æ±‚å›¢é˜Ÿæ˜ç¡®åœ°åœ¨å•†ä¸šæŒ‡æ ‡å’Œç”¨æˆ·ä½“éªŒä¹‹é—´åšæƒè¡¡ã€‚</li></ul></li><li><p>å¢é•¿å’Œè¿è¥</p><ul><li>äº§å“å›¢é˜Ÿè´Ÿè´£ç•Œå®šå’Œæä¾›é•¿æœŸç”¨æˆ·ä»·å€¼</li><li>è¿è¥å›¢é˜Ÿè´Ÿè´£åˆ›é€ çŸ­æœŸç”¨æˆ·ä»·å€¼å’ŒååŠ©äº§å“å®Œå–„é•¿æœŸä»·å€¼<ul><li>å†…å®¹è¿è¥<ul><li>å…³æ³¨å†…å®¹çš„ä¼ æ’­æ•ˆæœ </li></ul></li><li>ç”¨æˆ·è¿è¥<ul><li>æ´»è·ƒç”¨æˆ·æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ç”¨æˆ·çš„æ–°å¢ã€ç•™å­˜ã€æ´»è·ƒã€ä¼ æ’­ä»¥åŠç”¨æˆ·ä¹‹é—´ä»·å€¼çš„è‰¯æ€§å¾ªç¯ </li></ul></li><li>æ´»åŠ¨è¿è¥<ul><li>å…³æ³¨æ´»åŠ¨çš„ç›®æ ‡è¾¾æˆåº¦å’Œæ•ˆæœ </li></ul></li><li>äº§å“è¿è¥<ul><li>é€šè¿‡å„ç§è¿è¥æ‰‹æ®µå»æ‹‰å‡æŸä¸ªäº§å“çš„ç‰¹å®šæ•°æ® </li></ul></li></ul></li></ul></li><li><p>å¢é•¿å›¢é˜Ÿçš„æ ¸å¿ƒè¦ç´ </p><ul><li>è·¨åŠŸèƒ½çš„å›¢é˜Ÿï¼š æ‰“ç ´äº§å“å’Œå¸‚åœºä¹‹é—´çš„éš”é˜‚</li><li>åˆ©ç”¨å®šæ€§å’Œå®šé‡çš„æ•°æ®åˆ†ææ·±å…¥äº†è§£ç”¨æˆ·çš„è¡Œä¸º</li><li>å¿«é€Ÿåšäº§å“è¿­ä»£å’Œæµ‹è¯•æ–°çš„æƒ³æ³•ï¼Œå¹¶ä½¿ç”¨æ·±å…¥çš„åˆ†ææ¥æŒ‡å¯¼è¡ŒåŠ¨</li></ul></li></ul><h3 id="4-3-3-å¢é•¿å›¢é˜Ÿçš„å¿…å¤‡å…ƒç´ "><a href="#4-3-3-å¢é•¿å›¢é˜Ÿçš„å¿…å¤‡å…ƒç´ " class="headerlink" title="4.3.3 å¢é•¿å›¢é˜Ÿçš„å¿…å¤‡å…ƒç´ "></a>4.3.3 å¢é•¿å›¢é˜Ÿçš„å¿…å¤‡å…ƒç´ </h3><ul><li>å‰ææ¡ä»¶ï¼š<ul><li>äº§å“ï¼šæ˜¯å¦å·²ç»å»ºç«‹äº†æ ¸å¿ƒä»·å€¼</li><li>æ–‡åŒ–ï¼šæ˜¯å¦èƒ½å¤Ÿå¾—åˆ°é¢†å¯¼å±‚çš„æ”¯æŒ<ul><li>æ˜¯èƒ½å¤Ÿè®©å¢é•¿å˜å¾—æ›´å¯é¢„æµ‹ï¼Œä½†æ˜¯æ— æ³•ä¿è¯çœŸçš„å¯ä»¥å¢é•¿ </li></ul></li><li>èµ„æºï¼š åˆç†çš„æƒ³è¦çš„èµ„æºå’Œå·¥å…·</li><li>æµç¨‹ï¼š å¢é•¿å›¢é˜Ÿçš„è¿ä½œæµç¨‹  å¼€å‘-è¡¡é‡-å­¦ä¹ </li><li>äººæ‰ï¼š åˆé€‚çš„äººæ‰</li></ul></li><li>éœ€è¦æ»¡è¶³ï¼š <ul><li>æ–‡åŒ–</li><li>äººå‘˜</li><li>æµç¨‹</li><li>å·¥å…·</li><li>èµ„æº</li></ul></li></ul><h3 id="4-3-4-å¦‚ä½•é…ç½®å¢é•¿å›¢é˜Ÿ"><a href="#4-3-4-å¦‚ä½•é…ç½®å¢é•¿å›¢é˜Ÿ" class="headerlink" title="4.3.4 å¦‚ä½•é…ç½®å¢é•¿å›¢é˜Ÿ"></a>4.3.4 å¦‚ä½•é…ç½®å¢é•¿å›¢é˜Ÿ</h3><ul><li>åŸºæœ¬é…ç½®<ul><li>å¢é•¿äº§å“ç»ç†<ul><li>æ•°æ®é©±åŠ¨ </li></ul></li><li>2-3 ç¨‹åºå‘˜<ul><li>å¢é•¿åŸºå› </li><li>A/Bæµ‹è¯•æŠ€æœ¯éš¾åº¦å…¶å®ä¸é«˜ï¼Œä¼šå–œæ¬¢ä¹ˆï¼Ÿ</li><li>å®éªŒä»£ç ä¼šè¢«æµªè´¹</li><li>æœ‰å•†ä¸šå’Œäº§å“æ€ç»´</li><li>æ²Ÿé€šèƒ½åŠ›å’Œé¡¹ç›®ç®¡ç†èƒ½åŠ›</li></ul></li><li>1 æ•°æ®åˆ†æå¸ˆ</li><li>1 è®¾è®¡å¸ˆ<ul><li>å¿«é€Ÿä¸Šçº¿ï¼Œä¸éœ€è¦ç‰¹åˆ«ç²¾ç›Šæ±‚ç²¾ </li></ul></li><li>0-1 å®šæ€§ç”¨æˆ·ç ”ç©¶<ul><li>æµ‹è¯•ç”¨æˆ·å¿ƒç†</li><li>å‘ç°äº¤äº’ç•Œé¢ä¸­çš„é—®é¢˜</li><li>ç»™å¢é•¿å®éªŒæä¾›æ–¹å‘ã€çº¿ç´¢å’Œåé¦ˆ</li></ul></li><li>å¸‚åœºæ¸ é“ä¸“å®¶<ul><li>æœç´¢å¼•æ“</li><li>ä»˜è´¹å¹¿å‘Š</li><li>ç—…æ¯’ä¼ æ’­</li><li>é‚®ä»¶</li></ul></li></ul></li><li>åœ¨è¾¾åˆ°äº§å“å’Œå¸‚åœºå¥‘åˆçš„æ—¶å€™ï¼Œå°±å¼€å§‹å»ºç«‹å¢é•¿å›¢é˜Ÿ</li></ul><h3 id="4-3-5-å¢é•¿å›¢é˜Ÿçš„ç»„ç»‡æ¶æ„"><a href="#4-3-5-å¢é•¿å›¢é˜Ÿçš„ç»„ç»‡æ¶æ„" class="headerlink" title="4.3.5 å¢é•¿å›¢é˜Ÿçš„ç»„ç»‡æ¶æ„"></a>4.3.5 å¢é•¿å›¢é˜Ÿçš„ç»„ç»‡æ¶æ„</h3><ul><li>ç‹¬ç«‹ç‰¹åŒºçš„æ¨¡å¼<ul><li>å¥½å¤„ä»å¤´å»ºç«‹è‡ªå·±çš„æµç¨‹</li><li>æœ‰è‡ªå·±çš„æ–‡åŒ–å’ŒåŸºå› </li><li>ç‹¬ç«‹çš„æ¨¡å¼èƒ½å¤Ÿä¿è¯å¢é•¿å›¢é˜Ÿèƒ½å¤ŸçœŸæ­£å»ºç«‹èµ·æ•°æ®å¯¼å‘ã€æ•°æ®é©±åŠ¨çš„è¿ä½œä½“ç³»ï¼Œè€Œä¸æ˜¯è¯•å›¾èå…¥å…¬å¸å›¢é˜Ÿå·²æœ‰çš„è¿ä½œæ¨¡å¼å½“ä¸­</li><li>å¼ºæœ‰åŠ›çš„æ”¯æŒ</li><li>å®¹æ˜“å„ä¸ªå›¢é˜Ÿä¹‹é—´äº§ç”ŸçŸ›ç›¾</li></ul></li><li>åŠŸèƒ½ä¸»å¯¼çš„æ¨¡å¼<ul><li>å½’å±äºå¦å¤–ä¸€ä¸ªå¤§çš„åŠŸèƒ½å›¢é˜Ÿï¼Œä»¥äº§å“å›¢é˜Ÿå±…å¤š </li></ul></li><li>å†…éƒ¨å’¨è¯¢å¸ˆçš„æ¨¡å¼<ul><li>åªè´Ÿè´£äº§å“çš„æŸéƒ¨åˆ†çš„åŠŸèƒ½ </li></ul></li></ul><h3 id="4-3-6-å¢é•¿å›¢é˜Ÿå·¥å…·ç®±"><a href="#4-3-6-å¢é•¿å›¢é˜Ÿå·¥å…·ç®±" class="headerlink" title="4.3.6 å¢é•¿å›¢é˜Ÿå·¥å…·ç®±"></a>4.3.6 å¢é•¿å›¢é˜Ÿå·¥å…·ç®±</h3><ul><li>æ•°æ®åˆ†æ</li><li>A/B æµ‹è¯•</li><li>æ¸ é“ç®¡ç†ä»¥åŠè¥é”€è‡ªåŠ¨åŒ–</li><li>é¡¹ç›®ç®¡ç†å’ŒçŸ¥è¯†åˆ†äº«<h1 id="5-èŒä¸šè·¯å¾„"><a href="#5-èŒä¸šè·¯å¾„" class="headerlink" title="5. èŒä¸šè·¯å¾„"></a>5. èŒä¸šè·¯å¾„</h1></li></ul><h1 id="6-å¢é•¿è®¡åˆ’"><a href="#6-å¢é•¿è®¡åˆ’" class="headerlink" title="6.å¢é•¿è®¡åˆ’"></a>6.å¢é•¿è®¡åˆ’</h1><h2 id="6-1-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€å‘¨"><a href="#6-1-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€å‘¨" class="headerlink" title="6.1 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€å‘¨"></a>6.1 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€å‘¨</h2><ul><li>äº†è§£å¢é•¿å·¥å…·ç®±</li></ul><p>è¿…é€Ÿç†Ÿæ‚‰å…¬å¸å†…éƒ¨ä½¿ç”¨çš„å„ç§å·¥å…·ï¼šä¾‹å¦‚æ¸ é“ç®¡ç†å·¥å…·ã€é‚®ä»¶ã€ç§»åŠ¨æ¨é€ç­‰CRM(å®¢æˆ·å…³ç³»)å·¥å…·ï¼Œç”¨æˆ·è¡Œä¸ºè¿½è¸ªï¼Œæ•°æ®å¯è§†åŒ–çœ‹æ¿ç­‰æ•°æ®åˆ†æå·¥å…·ï¼ŒA/Bæµ‹è¯•å·¥å…·ï¼Œä»¥åŠé¡¹ç›®ç®¡ç†å·¥å…·ã€‚è®°å½•ä¸‹æ¥ä»»ä½•éœ€è¦å¡«è¡¥çš„æ¼æ´</p><ul><li>æ·±å…¥ç ”ç©¶å†å²æ•°æ®</li></ul><p>å…¨é¢äº†è§£å†å²æ•°æ®ï¼Œæ¯”å¦‚å¯¹äºä¸€ä¸ªç§»åŠ¨åº”ç”¨æ¥è¯´ï¼Œçœ‹å®ƒçš„ä¸‹è½½é‡ï¼Œæ³¨å†Œæ¯”ä¾‹ï¼Œæ¿€æ´»ç”¨æˆ·æ¯”ä¾‹ï¼Œé•¿æœŸç•™å­˜ç‡ï¼Œè€ç”¨æˆ·æ¨èæ¯”ä¾‹ï¼Œç›ˆåˆ©æ¥æºç­‰ã€‚å¦‚æœæ²¡æœ‰ç°æˆçš„æ•°æ®çœ‹æ¿ï¼Œéœ€è¦ä»ä¸åŒçš„æºå¤´æ”¶é›†å„ç§æ•°æ®ï¼Œå°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·æ¥çœ‹ã€‚æ”¶é›†æ‰€æœ‰å…³é”®æ•°æ®ç‚¹ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»å¤§æ¡†æ¶ä¸Šäº†è§£ç°çŠ¶ã€å‘ç°é—®é¢˜</p><ul><li>å’Œç›´æ¥ç»ç†/ CEOä¼šè°ˆ</li></ul><p>åœ¨ä¼šè®®ä¸Šéœ€è¦ç¡®å®šä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>äº†è§£å·¥ä½œèƒŒæ™¯ä¿¡æ¯</li><li>æ²Ÿé€šåŒæ–¹çš„å·¥ä½œé£æ ¼</li><li>è®¨è®ºå¢é•¿çš„è®¡åˆ’å’Œä¼˜å…ˆçº§</li><li>äº†è§£å¦‚ä½•å’Œå·¥ç¨‹å¸ˆã€è®¾è®¡å¸ˆåˆä½œï¼Œä»¥ä¾¿ä¸Šçº¿å®éªŒ</li></ol><p>è®¨è®ºåº”è¯¥åœ¨å“ªä¸ªæ–¹é¢æ¥è¿›è¡Œå®éªŒ</p><ul><li>å’Œå›¢é˜ŸåŠåˆä½œè€…å¼€ä¼š</li></ul><p>å› ä¸ºå¢é•¿å¤©ç„¶éœ€è¦è·¨éƒ¨é—¨çš„åˆä½œï¼Œé™¤äº†å’Œè‡ªå·±çš„ä¸‹å±ä¼šè°ˆä¹‹å¤–ï¼Œä¹Ÿåº”è¯¥å®‰æ’æ—¶é—´æ¥è®¤è¯†åˆä½œå›¢é˜Ÿï¼Œäº†è§£äº‹æƒ…æ˜¯å¦‚ä½•è¿è½¬çš„ï¼Œå¤„ç†å¥½å’ŒåŒäº‹çš„å…³ç³»ã€‚å¦‚åŒæ–°ç”¨æˆ·æ¿€æ´»å¯¹äºç”¨æˆ·çš„å¢é•¿å¾ˆé‡è¦ä¸€æ ·ï¼Œç»™å¤§å®¶çš„ç¬¬ä¸€å°è±¡ä¹Ÿå¾ˆé‡è¦</p><ul><li>å€¾å¬ç”¨æˆ·çš„å£°éŸ³</li></ul><p>å€¾å¬ç”¨æˆ·çš„å£°éŸ³</p><h2 id="6-2-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€æœˆ"><a href="#6-2-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€æœˆ" class="headerlink" title="6.2 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€æœˆ"></a>6.2 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€æœˆ</h2><ul><li>ç¡®å®šå¢é•¿æŒ‡æ ‡</li></ul><p>å¹¶ä¸éœ€è¦å¿…é¡»æ˜¯æ—¥å‡æ´»è·ƒç”¨æˆ·ï¼Œè¿™ä¸ªåº”ç”¨æ˜¯æ¯å¤©éƒ½ä¼šä½¿ç”¨çš„ä¹ˆï¼Ÿ</p><p>å¦‚ä½•å®šä¹‰æ´»è·ƒï¼Ÿæ‰“å¼€ï¼Ÿè¿˜æ˜¯ä¸€äº›æ›´æœ‰ä»·å€¼çš„è¡Œä¸ºï¼Ÿ</p><p>ç•™å­˜ç‡çš„åŒ—ææ˜ŸæŒ‡æ ‡ï¼šNorth Star Metricï¼ˆOMTMï¼‰ï¼Œå°±æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œè¦å¯¹åº”ä½ çš„äº§å“ç»™ç”¨æˆ·ä¼ è¾“çš„ä»·å€¼ã€‚</p><ul><li>æ‰¾åˆ°ä¸€ä¸ªèšç„¦é¢†åŸŸ</li></ul><p>è¿ç”¨æ”¶é›†åˆ°çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ·±å…¥åˆ†æå„ç§æ•°æ®ï¼Œå¹¶ä¸”å’Œå›¢é˜Ÿè®¨è®ºï¼Œæˆ˜ç•¥æ€§åœ°é€‰æ‹©ç¬¬ä¸€ä¸ªèšç„¦é¢†åŸŸï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨è¿™ä¸ªé¢†åŸŸè¿›è¡Œå®éªŒåº”è¯¥æ˜¯æ½œåœ¨å½±å“åŠ›æœ€å¤§çš„ï¼Œèµ„æºè¦æ±‚å°‘ï¼ŒæˆåŠŸæ¦‚ç‡é«˜ã€‚</p><p>å…³äºæå‡ç•™å­˜ç‡ï¼Œä¸ä¸€å®šæ˜¯è¦é€šè¿‡é‚®ä»¶ç­‰æ–¹å¼æ‰¾å›æµå¼çš„ç”¨æˆ·ï¼Œä¹Ÿæœ‰å¯èƒ½ä»äº§å“ä¸­å¯»æ‰¾æœºä¼šï¼Œè®©ç”¨æˆ·æ›´æ„¿æ„å‘†åœ¨è¿™ä¸ªå¹³å°é‡Œé¢ã€‚</p><p>å¯»æ‰¾æ æ†ï¼šfinding leverage: éœ€è¦æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œç„¶åé’ˆå¯¹è¿™ä¸ªç›®æ ‡ï¼Œæ‰¾åˆ°æ‰€æœ‰é¢†åŸŸå½“ä¸­æ æ†æ•ˆåº”æœ€æ˜æ˜¾çš„åœ°æ–¹ï¼Œç„¶åé’ˆå¯¹è¿™ä¸ªåœ°æ–¹è¿›è¡Œè¯•éªŒæ”¹è¿›ã€‚æ‰€è°“çš„æ æ†æ•ˆåº”ï¼Œå°±æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„åœ°æ–¹ã€‚â€”â€“å¯¹äºæ”¹å–„ç•™å­˜ç‡è€Œè¨€ï¼Œæ æ†æ•ˆåº”æœ€å¤§çš„ç‚¹åº”è¯¥æ˜¯åœ¨äº§å“é¢†åŸŸçš„ã€‚</p><ul><li>ä¸Šçº¿å¢é•¿å®éªŒ</li></ul><p>åšæŒæ¨è¿›ç›´åˆ°ç¬¬ä¸€ä¸ªå®éªŒæˆåŠŸä¸Šçº¿ï¼Œå¸Œæœ›é€šè¿‡ä¹‹å‰çš„åˆ†æå’Œå‡†å¤‡å·¥ä½œï¼Œä½¿è¿™ä¸ªå®éªŒèƒ½å¸¦æ¥æ­£é¢çš„ç»“æœ</p><p>å¯èƒ½ä¸€äº›å°æ–‡æœ¬çš„æ”¹å˜ä¼šç»™è½¬åŒ–ç‡å¸¦æ¥å¾ˆå¤§çš„æé«˜ï¼š</p><ol><li>ä½ æ„¿æ„å¼€é€šæ¯å‘¨10ç¾å…ƒçš„å®šæœŸæŠ•èµ„ä¹ˆï¼Ÿ</li><li>å¦‚æœä½ æ¯å‘¨å­˜å…¥10ç¾å…ƒï¼Œ5å¹´åä»…æœ¬é‡‘å°±å¯ä»¥ç§¯ç´¯2600ç¾å…ƒã€‚ä»ä»Šå¤©å¼€å§‹æ¯å‘¨æŠ•èµ„10ç¾å…ƒå§ï¼ï¼ˆ+40%ï¼‰</li><li>ä½ çŸ¥é“å·²ç»æœ‰nç™¾ä¸‡ç”¨æˆ·ä½¿ç”¨å®šæœŸæŠ•èµ„åŠŸèƒ½äº†ä¹ˆï¼Ÿä»ä»Šå¤©å¼€å§‹æ¯å‘¨æŠ•èµ„10ç¾å…ƒå§ï¼ï¼ˆ+60%ï¼‰</li></ol><p>â€”â€“&gt; å°†å°çš„ç»“æœç§¯å°‘æˆå¤šå‘ˆç°å‡ºæ¥ï¼Œæˆ–è€…å¼ºè°ƒæœ‰å¾ˆå¤šå…¶ä»–äººåœ¨ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¯¹ç”¨æˆ·çš„å¿ƒç†æœ‰ç€å¼ºå¤§çš„å½±å“ã€‚</p><p>å¦‚ä½•è§£å†³ç¨‹åºå‘˜ä»¬çš„å›°æ‰°ï¼Ÿä¸æ„¿æ„åšï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>çªç„¶åŠŸèƒ½çš„å–æ¶ˆï¼›æ–‡æœ¬è‰²å½©çš„å˜åŒ–ï¼Œæ— èŠâ€¦</p><p>éœ€è¦å°½å¯èƒ½åœ°å°†ç¨‹åºå‘˜ä»ç¹ççš„æ–‡æœ¬æµ‹è¯•å’Œå°æ”¹åŠ¨ä¸­è§£æ”¾å‡ºæ¥ï¼Œè®©å®ƒä»¬å»åšæ›´å¤æ‚ã€æ›´æœ‰æŒ‘æˆ˜æ€§çš„å®éªŒã€‚é‡‡ç”¨æå‰åŸ‹ç‚¹çš„æ–¹æ³•æˆ–è€…ç¬¬ä¸‰æ–¹æµ‹è¯•å·¥å…·é‡Œé¢çš„é«˜çº§åŠŸèƒ½ï¼Œå…¶å®å¯ä»¥å¾ˆæœ‰æ•ˆçš„è§£å†³è¿™ä¸ªé—®é¢˜</p><p>ç¨‹åºå‘˜å–œæ¬¢çœ‹åˆ°è‡ªå·±çš„å·¥ä½œçš„å½±å“åŠ›ï¼Œè¦è°ƒåŠ¨å®ƒä»¬çš„ç§¯ææ€§ï¼Œéœ€è¦<strong>è®©ä»–ä»¬å‚ä¸åˆ°äº§ç”Ÿå®éªŒå‡è®¾å’Œå®éªŒè®¾è®¡çš„æ•´ä¸ªè¿‡ç¨‹ä¸­</strong>å»ï¼Œå¹¶ä¸”åŠæ—¶æŠŠç»“æœåé¦ˆç»™ä»–ä»¬</p><p>ä¸æ˜¯æ‰€æœ‰ç¨‹åºå‘˜éƒ½é€‚åˆåœ¨å¢é•¿å›¢é˜Ÿå½“ä¸­çš„ï¼Œå¦‚æœåªæ˜¯è¿½æ±‚æŠ€æœ¯æ·±åº¦ï¼Œåœ¨å¢é•¿å›¢é˜Ÿæ˜¾ç„¶ä¸æ˜¯æœ€åˆé€‚çš„ï¼Œä½†æ˜¯å¯¹äºæœ‰äº§å“æ€ç»´çš„ï¼Œå–œæ¬¢çœ‹åˆ°è‡ªå·±çš„å·¥ä½œå¯¹ç”¨æˆ·å’Œä¸šåŠ¡æœ‰å½±å“çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œå¢é•¿å›¢é˜Ÿçš„å·¥ä½œå…¶å®æ›´æœ‰å¸å¼•åŠ›ã€‚</p><ul><li>å®šæœŸä¸ç”¨æˆ·äº¤æµ</li></ul><p>å®šæœŸäº¤æµï¼Œå¾ˆå¤šé—®é¢˜æ˜¯A/Bæµ‹è¯•åšä¸äº†ï¼ŒéªŒè¯ä¸äº†çš„ã€‚ä¸ç®¡æ˜¯ç”¨æˆ·é—®å·è°ƒæŸ¥ï¼Œé¡¾å®¢å‘å±•ç”µè¯è¿˜æ˜¯ç”¨æˆ·ç¤¾ç¾¤ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å®šæœŸå’Œç”¨æˆ·å¯¹è¯çš„é€”å¾„ã€‚å¯¹ç”¨æˆ·äº†è§£å¾—è¶Šå¤šï¼Œå°±èƒ½è¶Šå¥½åœ°æ‰¾åˆ°ç”¨æˆ·çš„ç—›ç‚¹å’Œè®©ç”¨æˆ·æƒŠå–œçš„åŠæ³•ï¼Œå®éªŒæˆåŠŸç‡å°±ä¼šè¶Šé«˜ã€‚</p><p>è¿˜æœ‰ä¸å†…éƒ¨çš„äººå‘˜çš„äº¤æµï¼Œå› ä¸ºæ˜¯å•ç‹¬æˆç«‹äº†ä¸€ä¸ªå¢é•¿å›¢é˜Ÿï¼Œè€Œè¿™ä¸ªå›¢é˜Ÿå¾ˆå¤šæ—¶å€™éƒ½éœ€è¦è°ƒç”¨æ•´ä¸ªå…¬å¸å„ä¸ªéƒ¨é—¨çš„åŠ›é‡æ¥ä¸€èµ·åšä¸œè¥¿ã€‚æ¯å‘¨å®éªŒåˆ†äº«ä¼šï¼Œç–¯ç‹‚çš„A/Bæµ‹è¯•ï¼Œå‘Šè¯‰å¤§å®¶ç»“æœï¼Œè®©å„ä¸ªéƒ¨é—¨çš„äººéƒ½æ›´åŠ äº†è§£ä¸€äº›ã€‚</p><p>å¯¹åº”çš„email list,shareå®éªŒå¿ƒå¾—</p><p>å¤´è„‘é£æš´è®¨è®ºä¼š</p><ul><li>å¼¥è¡¥å·¥å…·ï¼Œæ•°æ®ï¼ŒåŸºç¡€è®¾æ–½çš„æ¼æ´</li></ul><p>åº”è¯¥æ˜ç¡®å‡ºç°äº†å“ªäº›é—®é¢˜ï¼Œå“ªäº›é—®é¢˜æ›´åŠ å…³é”®ï¼Œä»¥åŠå¦‚ä½•å»è§£å†³</p><h2 id="6-3-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€å­£åº¦"><a href="#6-3-å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š-ç¬¬ä¸€å­£åº¦" class="headerlink" title="6.3 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€å­£åº¦"></a>6.3 å¢é•¿é»‘å®¢çš„æœ€åˆ90å¤©è®¡åˆ’ï¼š ç¬¬ä¸€å­£åº¦</h2><ul><li>æ­å»ºå¢é•¿æ¨¡å‹</li></ul><p>ä»åŒäº‹å’Œå›¢é˜Ÿé‡Œï¼Œä»¥åŠä»æ•°æ®å’Œæµ‹è¯•å½“ä¸­ï¼Œå¯¹é©±åŠ¨å…¬å¸å¢é•¿çš„å› ç´ æœ‰äº†è¿›ä¸€æ­¥çš„äº†è§£ã€‚æ¥ä¸‹æ¥ï¼Œéœ€è¦åé€€ä¸€æ­¥ï¼Œè¯•ç€æŠŠæ‰€æœ‰çš„ä¿¡æ¯ç»„è£…åœ¨ä¸€èµ·ï¼Œæç‚¼æˆä¸€ä¸ªé«˜åº¦æ¦‚æ‹¬çš„å¢é•¿æ¨¡å‹ã€‚</p><p>å¢é•¿æ¨¡å‹æ˜¯ä¸€ä¸ªè§£é‡Šä¸šåŠ¡é‡Œä¸åŒçš„å˜é‡ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•äº’ç›¸å½±å“è½¬åŒ–æˆå¢é•¿çš„æ•°å­¦å…¬å¼ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°äº†è§£ä¸šåŠ¡ã€åè°ƒå›¢é˜Ÿã€è®¾è®¡å®éªŒå’Œè¡¡é‡ç»“æœã€‚</p><ul><li>è®¾ç«‹å¢é•¿å®éªŒæµç¨‹</li></ul><p>å½“ä¸Šçº¿äº†æœ€åˆçš„å‡ ä¸ªå®éªŒä¹‹åï¼Œåº”è¯¥å¼€å§‹å»ºç«‹ä¸€ä¸ªå¢é•¿å®éªŒæµç¨‹ï¼Œè¿™ä¸ªæµç¨‹åŒ…æ‹¬ä¸‹é¢ä¸¤ä¸ªé˜¶æ®µï¼š </p><ol><li>æˆ˜ç•¥åˆ¶å®šé˜¶æ®µï¼š</li></ol><p>é€šè¿‡å®¡è§†å¢é•¿æ¨¡å‹å’ŒæŒ‡æ ‡ï¼Œæ·±å…¥çš„æ•°æ®åˆ†æï¼Œæ‰¾åˆ°ä¸€ä¸ªèšç„¦é¢†åŸŸï¼Œ<br>2. æˆ˜æœ¯æ‰§è¡Œé˜¶æ®µï¼š</p><p>é’ˆå¯¹èšç„¦é¢†åŸŸï¼Œå¿«é€Ÿè¿›è¡Œ å¼€å‘-è¡¡é‡-å­¦ä¹ çš„è¿­ä»£æµç¨‹ï¼Œäº§ç”Ÿå¤‡é€‰å®éªŒæƒ³æ³•ï¼Œæ’åˆ—ä¼˜å…ˆçº§ï¼Œä¸Šçº¿å®éªŒï¼Œæ”¶é›†æ•°æ®è¿›è¡Œåˆ†æï¼Œç„¶ååº”ç”¨å®éªŒç»“æœï¼ŒæŠŠå¿ƒå¾—ç”¨åˆ°ä¸‹ä¸€ä¸ªå®éªŒå½“ä¸­ã€‚</p><ul><li>é€‰æ‹©å®éªŒè®°å½•ç³»ç»Ÿ</li></ul><p>å…±äº«çš„è¡¨æ ¼å’Œæ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¬å¸å†…éƒ¨çš„å·²æœ‰çš„é¡¹ç›®ç®¡ç†è½¯ä»¶</p><p>æ¯ä¸ªå®éªŒæƒ³æ³•éƒ½åº”è¯¥è®°å½•ä¸‹æ¥ï¼Œè®¾è®¡æ¯ä¸ªå®éªŒçš„æ—¶å€™éƒ½åº”è¯¥æœ‰æ¸…æ™°çš„å‡è®¾å’Œè®¡åˆ’ï¼Œæ¯ä¸ªç»“æœéƒ½åº”è¯¥æœ‰åˆ†æï¼Œå¹¶å­˜æ¡£ã€‚æ‰€æœ‰è¿™äº›ä¿¡æ¯éƒ½åº”è¯¥å­˜å‚¨åœ¨ä¸€ä¸ªå…±äº«çš„ç³»ç»Ÿå½“ä¸­ä½œä¸ºå†å²è®°å½•ï¼ŒåŒæ—¶ä¾›ç°åœ¨çš„å’Œæœªæ¥çš„å›¢é˜Ÿä½¿ç”¨å’Œå­¦ä¹ </p><ul><li>ç»„ç»‡å¢é•¿ä¼šè®®</li></ul><p>å¯ä»¥çœæ‰ä¸€äº›æ²Ÿé€šæˆæœ¬ï¼Œä½†æ˜¯å¿…è¦çš„ä¼šè®®ä¹Ÿæ˜¯éœ€è¦çš„ã€‚ä»æ¯å‘¨å¬å¼€å¢é•¿å›¢é˜Ÿä¾‹ä¼šå¼€å§‹ï¼Œå¸®åŠ©æ²Ÿé€šå¢é•¿ç›®æ ‡ï¼Œç®¡ç†å¢é•¿æµç¨‹ï¼Œä¿ƒè¿›å›¢é˜Ÿæˆå‘˜é—´çš„äº¤æµï¼Œå¢å¼ºä»–ä»¬çš„å‚ä¸æ„Ÿã€‚åœ¨è¿™ä¸ªä¼šè®®ä¸Šï¼Œå¯ä»¥ç›‘æµ‹æŒ‡æ ‡è¿›å±•ï¼Œå›é¡¾å¢é•¿å®éªŒçš„ä¸Šçº¿æƒ…å†µï¼Œåˆ†æè®¨è®ºç»“æœç­‰ã€‚å…¶ä»–å¯èƒ½æœ‰ç”¨çš„ä¼šè®®ï¼Œå¯ä»¥è§†ç»„é‡Œæƒ…å†µè¿›è¡Œå–èˆï¼š </p><ol><li>æ¯æ—¥å¢é•¿å›¢é˜Ÿç«™ç«‹ä¼šè®®</li><li>æ¯å‘¨å¢é•¿ç»†åˆ†å›¢é˜Ÿé—´å®éªŒç»“æœäº¤æµä¼šè®®</li><li>æ¯ä¸¤å‘¨ç®¡ç†å±‚äº¤æµä¼šè®®</li><li>æ¯æœˆå…¨å…¬å¸æƒ³æ³•æ”¶é›†åˆé¤ä¼š</li><li>ä¸å®šæœŸè®¾è®¡å†²åˆºä¼šè®®</li></ol><ul><li>å€¡å¯¼å¢é•¿æ–‡åŒ–</li></ul><p>å¢é•¿æ–‡åŒ–ï¼Œä»æœ€åŸºæœ¬çš„ä¸¤ä»¶äº‹å¼€å§‹åšèµ·ï¼š</p><ol><li>å°†å®éªŒçš„ç»“æœå’Œå¿ƒå¾—å‘å…¨å…¬å¸å…¬å¼€ï¼Œè®©æ¯ä¸ªäººéƒ½çŸ¥é“å¢é•¿å›¢é˜Ÿçš„è¿›å±•ï¼Œå¹¶ä¸”å¯ä»¥æŠŠè¿™äº›å¿ƒå¾—åº”ç”¨åœ¨è‡ªå·±çš„å·¥ä½œå½“ä¸­</li><li>é¼“åŠ±æ¯ä¸ªäººéƒ½æ¥è´¡çŒ®å®éªŒæƒ³æ³•ï¼Œå› ä¸ºå³ä½¿æ˜¯é’ˆå¯¹åŒä¸€ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªäººä¹Ÿéƒ½æ˜¯æœ‰è‡ªå·±çš„è§†è§’çš„ã€‚æ¯”å¦‚ï¼Œé”€å”®å›¢é˜Ÿå’Œå®¢æˆ·æœåŠ¡å›¢é˜Ÿç¦»ç”¨æˆ·æ›´è¿‘ï¼Œå·¥ç¨‹å¸ˆå›¢é˜Ÿå¯¹ç¨‹åºæ›´ç†Ÿæ‚‰ï¼Œå¾ˆå¤šæ—¶å€™ä»–ä»¬éƒ½ä¼šå¸¦æ¥å‡ºå…¶ä¸æ„çš„æƒ³æ³•çš„ã€‚</li></ol><h1 id="7-å¢é•¿æˆ˜ç•¥"><a href="#7-å¢é•¿æˆ˜ç•¥" class="headerlink" title="7. å¢é•¿æˆ˜ç•¥"></a>7. å¢é•¿æˆ˜ç•¥</h1><h2 id="7-1-è®¾å®šå¢é•¿ç›®æ ‡"><a href="#7-1-è®¾å®šå¢é•¿ç›®æ ‡" class="headerlink" title="7.1 è®¾å®šå¢é•¿ç›®æ ‡"></a>7.1 è®¾å®šå¢é•¿ç›®æ ‡</h2><ul><li>æ‰¾åˆ°æ­£ç¡®çš„å¢é•¿KPIå¹¶è®¾å®šä¸€ä¸ªæ¸…æ™°æ˜ç¡®çš„ç›®æ ‡ã€‚</li><li>åŒ—ææ˜ŸæŒ‡æ ‡å°±æ˜¯å…¬å¸çš„æ ¸å¿ƒå¢é•¿KPI</li><li>è´¹åŠ²ä½†æ˜¯ä¸æ˜¯å®Œå…¨æ²¡æœ‰å¯èƒ½</li></ul><h2 id="7-2-æŒ‡æ ‡åˆ†è§£"><a href="#7-2-æŒ‡æ ‡åˆ†è§£" class="headerlink" title="7.2 æŒ‡æ ‡åˆ†è§£"></a>7.2 æŒ‡æ ‡åˆ†è§£</h2><ul><li>æ¨ªå‘åˆ†è§£<ul><li>æŒ‰ç…§ç”¨æˆ·çš„ç¾¤ç»„ï¼ŒåŠ æ³•çš„æ–¹å¼æ¥åšåˆ†è§£</li></ul></li><li>çºµå‘åˆ†è§£<ul><li>æŒ‰ç…§ç”¨æˆ·çš„ç”Ÿå‘½æ—…ç¨‹ï¼Œé€šè¿‡ä¹˜æ³•çš„æ–¹å¼å°†å­ç›®æ ‡è¿›ä¸€æ­¥æ‹†è§£ä¸ºæ›´ç»†çš„æ¼æ–—æ­¥éª¤ã€‚</li></ul></li></ul><h2 id="7-3-æ‰¾åˆ°èšç„¦é¢†åŸŸ"><a href="#7-3-æ‰¾åˆ°èšç„¦é¢†åŸŸ" class="headerlink" title="7.3 æ‰¾åˆ°èšç„¦é¢†åŸŸ"></a>7.3 æ‰¾åˆ°èšç„¦é¢†åŸŸ</h2><ul><li>é€šè¿‡åˆ†æå’Œç ”ç©¶ï¼Œæ‰¾åˆ°æ€§ä»·æ¯”æœ€é«˜çš„èšç„¦é¢†åŸŸ</li></ul><h2 id="7-4-å¢é•¿æˆ˜æœ¯æ‰§è¡Œ"><a href="#7-4-å¢é•¿æˆ˜æœ¯æ‰§è¡Œ" class="headerlink" title="7.4 å¢é•¿æˆ˜æœ¯æ‰§è¡Œ"></a>7.4 å¢é•¿æˆ˜æœ¯æ‰§è¡Œ</h2><ul><li>å¢é•¿å†²åˆº<ul><li>äº§ç”Ÿå®éªŒæƒ³æ³•<ul><li>é’ˆå¯¹èšç„¦é¢†åŸŸï¼Œé€šè¿‡æ•°æ®åˆ†ææŒ‡å®šæ¢ç´¢æ–¹å‘ï¼Œäº§ç”Ÿå‡ºä¸€ç³»åˆ—çš„å¤‡é€‰è¯•éªŒæƒ³æ³•ï¼Œè®°å½•åœ¨å¢é•¿è§„åˆ’å›¾å½“ä¸­</li><li>å°†æ”¶é›†è¯•éªŒæƒ³æ³•å½“åšå¢é•¿æµç¨‹çš„å¸¸è§„ç»„æˆéƒ¨åˆ†</li></ul></li><li>å†³å®šä¼˜å…ˆçº§æ’åº<ul><li>å½±å“åŠ› - æˆåŠŸç‡ - å¼€å‘æˆæœ¬ </li></ul></li><li>è®¾è®¡å’Œå¼€å‘è¯•éªŒ<ul><li>è¦æœ‰ä¸€ä¸ªå¢é•¿è¯•éªŒæŠ¥å‘Š<ul><li>éƒ¨åˆ†åˆ’åˆ†<ul><li>è¯•éªŒå‡è®¾</li><li>è¯•éªŒè®¾è®¡</li><li>è¯•éªŒæŒ‡æ ‡</li><li>è¯•éªŒæ‰“åˆ†</li><li>è¯•éªŒç»“æœ</li><li>è¯•éªŒå¿ƒå¾—</li><li>åç»­è®¡åˆ’</li></ul></li></ul></li></ul></li><li>åˆ†ææ•°æ®<ul><li>ç¡®ä¿è¯•éªŒç»“æœå…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§</li><li>è®¡ç®—æ‰€éœ€çš„æ ·æœ¬é‡ â€“ æ ·æœ¬è®¡ç®—å™¨</li><li>è®¾ç½®å‚æ•°<ul><li>åŸºæœ¬çš„è½¬åŒ–ç‡</li><li>æœ€å°èƒ½ç›‘æµ‹åˆ°çš„æ”¹å˜å¹…åº¦</li><li>ç»Ÿè®¡æ˜¾è‘—å€¼</li></ul></li></ul></li><li>åº”ç”¨ç»“æœ<ul><li>åº”ç”¨ç»“æœ</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Thought </tag>
            
            <tag> Reading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“</title>
      <link href="/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/"/>
      <url>/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BF%AE%E7%82%BC%E4%B9%8B%E9%81%93/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æ³¨é‡å®æ•ˆæ–¹æ³•è®º"><a href="#1-æ³¨é‡å®æ•ˆæ–¹æ³•è®º" class="headerlink" title="1. æ³¨é‡å®æ•ˆæ–¹æ³•è®º"></a>1. æ³¨é‡å®æ•ˆæ–¹æ³•è®º</h1><h2 id="1-1-é«˜æ•ˆä¹ æƒ¯"><a href="#1-1-é«˜æ•ˆä¹ æƒ¯" class="headerlink" title="1.1 é«˜æ•ˆä¹ æƒ¯"></a>1.1 é«˜æ•ˆä¹ æƒ¯</h2><ul><li>ä¸è¦å®³æ€•å‘ç”Ÿé—®é¢˜ï¼Œä¸è¦æ¨å¸è´£ä»»</li><li>å¯¹äºä¸€ä¸ªäº‹æƒ…æ˜¯å¦èƒ½åšåˆ°ï¼Œæä¾›å„ç§é€‰æ‹©ï¼Œè€Œä¸æ˜¯å€Ÿå£</li><li>ä¸è¦ç•™ç€ç ´çª—æˆ·(ä½åŠ£çš„è®¾è®¡ï¼Œé”™è¯¯å†³ç­–ï¼Œç³Ÿç³•ä»£ç )ï¼Œå°†å‡ºé—®é¢˜çš„ä»£ç æ”¾å…¥æ³¨é‡Šæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</li><li>å‚ä¸æ­£åœ¨å‘ç”Ÿçš„æˆåŠŸè¦æ›´å®¹æ˜“äº›ï¼Œè®©ä»–ä»¬ç¥è§æœªæ¥ï¼Œä»–ä»¬å°±ä¼šèšé›†åœ¨ä½ çš„å‘¨å›´ã€‚</li></ul><h2 id="1-2-çŸ¥è¯†èµ„äº§"><a href="#1-2-çŸ¥è¯†èµ„äº§" class="headerlink" title="1.2 çŸ¥è¯†èµ„äº§"></a>1.2 çŸ¥è¯†èµ„äº§</h2><p>ç®¡ç†çŸ¥è¯†èµ„äº§å’Œç®¡ç†é‡‘èèµ„äº§éå¸¸ç›¸ä¼¼ï¼š</p><ul><li>ä¸¥è‚ƒçš„æŠ•èµ„è€…å®šæœŸæŠ•èµ„ â€”â€” ä½œä¸ºä¹ æƒ¯</li><li>å¤šå…ƒåŒ–æ˜¯é•¿æœŸæˆåŠŸçš„å…³é”®</li><li>èªæ˜çš„æŠ•èµ„è€…åœ¨ä¿å®ˆçš„æŠ•èµ„å’Œé«˜é£é™©ã€é«˜å›æŠ¥çš„æŠ•èµ„ä¹‹é—´å¹³è¡¡å…¶èµ„äº§</li><li>æŠ•èµ„è€…è®¾æ³•ä½ä¹°é«˜å–ï¼Œä»¥è·å–æœ€å¤§å›æŠ¥</li><li>åº”å½“å‘¨æœŸæ€§é‡æ–°è¯„ä¼°å’Œå¹³è¡¡èµ„äº§</li></ul><h2 id="1-3-äº¤æµ"><a href="#1-3-äº¤æµ" class="headerlink" title="1.3 äº¤æµ"></a>1.3 äº¤æµ</h2><ul><li>çŸ¥é“æƒ³è¯´ä»€ä¹ˆï¼Œæœ‰å¤§çº²</li><li>äº†è§£å¬ä¼—</li><li>è®©æ–‡æ¡£ç¾è§‚</li><li>è®©å¬ä¼—å‚ä¸</li></ul><h1 id="2-æ³¨é‡å®æ•ˆçš„é€”å¾„"><a href="#2-æ³¨é‡å®æ•ˆçš„é€”å¾„" class="headerlink" title="2. æ³¨é‡å®æ•ˆçš„é€”å¾„"></a>2. æ³¨é‡å®æ•ˆçš„é€”å¾„</h1><h2 id="2-1-é‡å¤"><a href="#2-1-é‡å¤" class="headerlink" title="2.1 é‡å¤"></a>2.1 é‡å¤</h2><blockquote><p>DRY - Donâ€™t repeat yourself!</p></blockquote><p>åœ¨ä¸åŒçš„åœ°æ–¹å†™ç›¸åŒçš„ä¸œè¥¿é‚£åœ¨ä¿®æ”¹çš„æ—¶å€™å°±ä¸èƒ½å¿˜è®°æ¯ä¸€å¤„çš„ä¿®æ”¹ï¼Œè¿™æ˜¯å¾ˆcrazyçš„åšæ³•äº†</p><h2 id="2-2-é‡å¤çš„å‘ç”Ÿ"><a href="#2-2-é‡å¤çš„å‘ç”Ÿ" class="headerlink" title="2.2 é‡å¤çš„å‘ç”Ÿ"></a>2.2 é‡å¤çš„å‘ç”Ÿ</h2><h2 id="2-2-1-å¼ºåŠ çš„é‡å¤-ä¼¼ä¹æ˜¯ç¯å¢ƒè¦æ±‚"><a href="#2-2-1-å¼ºåŠ çš„é‡å¤-ä¼¼ä¹æ˜¯ç¯å¢ƒè¦æ±‚" class="headerlink" title="2.2.1 å¼ºåŠ çš„é‡å¤ - ä¼¼ä¹æ˜¯ç¯å¢ƒè¦æ±‚"></a>2.2.1 å¼ºåŠ çš„é‡å¤ - ä¼¼ä¹æ˜¯ç¯å¢ƒè¦æ±‚</h2><h2 id="2-2-2-æ— æ„çš„é‡å¤-æ²¡æœ‰æ„è¯†åˆ°"><a href="#2-2-2-æ— æ„çš„é‡å¤-æ²¡æœ‰æ„è¯†åˆ°" class="headerlink" title="2.2.2 æ— æ„çš„é‡å¤ - æ²¡æœ‰æ„è¯†åˆ°"></a>2.2.2 æ— æ„çš„é‡å¤ - æ²¡æœ‰æ„è¯†åˆ°</h2><ul><li>æ³¨æ„æ•°æ®ä¹‹é—´çš„ç›¸äº’é‡å¤ï¼Œå¦‚æœæœ‰æŸä¸ªé‡å€¼æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–æ•°æ®è®¡ç®—å¾—å‡ºçš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ç”¨è®¡ç®—å¾—å‡ºçš„å€¼</li><li>è€Œç”±äºæ€§èƒ½åŸå› ï¼Œåšcacheå¼•èµ·çš„é‡å¤ï¼Œéœ€è¦å°†å½±å“å±€éƒ¨åŒ–ï¼Œä¸è¦å°†å…¶æš´éœ²ç»™å¤–ç•Œ</li><li>åƒJavaè¿™æ ·çš„é¢å‘å¯¹è±¡çš„è¯­è¨€åº”å½“æ€»æ˜¯ä½¿ç”¨è®¿é—®å™¨å‡½æ•°æ¥è¯»å†™å¯¹è±¡çš„å±æ€§</li></ul><h2 id="2-2-3-æ— è€æ€§çš„é‡å¤-å·æ‡’"><a href="#2-2-3-æ— è€æ€§çš„é‡å¤-å·æ‡’" class="headerlink" title="2.2.3 æ— è€æ€§çš„é‡å¤ - å·æ‡’"></a>2.2.3 æ— è€æ€§çš„é‡å¤ - å·æ‡’</h2><h2 id="2-2-4-å¼€å‘è€…ä¹‹é—´çš„é‡å¤-åŒä¸€å›¢é˜Ÿçš„å‡ ä¸ªäººé‡å¤äº†åŒæ ·çš„ä¿¡æ¯"><a href="#2-2-4-å¼€å‘è€…ä¹‹é—´çš„é‡å¤-åŒä¸€å›¢é˜Ÿçš„å‡ ä¸ªäººé‡å¤äº†åŒæ ·çš„ä¿¡æ¯" class="headerlink" title="2.2.4 å¼€å‘è€…ä¹‹é—´çš„é‡å¤ - åŒä¸€å›¢é˜Ÿçš„å‡ ä¸ªäººé‡å¤äº†åŒæ ·çš„ä¿¡æ¯"></a>2.2.4 å¼€å‘è€…ä¹‹é—´çš„é‡å¤ - åŒä¸€å›¢é˜Ÿçš„å‡ ä¸ªäººé‡å¤äº†åŒæ ·çš„ä¿¡æ¯</h2><ul><li>Make it easy to reuse </li></ul><h2 id="2-3-æ­£äº¤æ€§"><a href="#2-3-æ­£äº¤æ€§" class="headerlink" title="2.3 æ­£äº¤æ€§"></a>2.3 æ­£äº¤æ€§</h2><p>è¡¨ç¤ºä¸€ç§äº’ä¸ä¾èµ–ï¼Œè§£è€¦æ€§ã€‚æŒ‡å‡ ä¸ªå­ç³»ç»Ÿä¹‹é—´äº’ä¸ä¾èµ–ï¼Œä¾‹å¦‚æ•°æ®åº“ä»£ç ä¸ç”¨æˆ·ç•Œé¢ä»£ç åº”è¯¥ä¸ºæ­£äº¤çš„</p><blockquote><p>Eliminate effects between unrelatd things </p></blockquote><p>ä½¿åŸºç¡€çŸ¥è¯†å’Œåº”ç”¨åˆ†ç¦»ï¼Œæ¯ä¸ªä¸»è¦çš„åŸºç¡€è®¾æ–½ç»„ä»¶(æ•°æ®åº“ã€é€šä¿¡æ¥å£ã€ä¸­é—´ä»¶å±‚)æœ‰è‡ªå·±çš„å­å›¢é˜Ÿ</p><h2 id="2-4-è®¾è®¡"><a href="#2-4-è®¾è®¡" class="headerlink" title="2.4 è®¾è®¡"></a>2.4 è®¾è®¡</h2><p>åšä¸€ä¸ªæ­£äº¤ç³»ç»Ÿï¼Œå…³é”®æŒ‡æ ‡ï¼ </p><ul><li>æ¨¡å—åŒ–</li><li>åŸºäºç»„ä»¶</li><li>åˆ†å±‚</li></ul><p>ç³»ç»Ÿåº”è¯¥æ˜¯ç”±ä¸€ç»„ç›¸äº’åä½œçš„æ¨¡å—ç»„æˆï¼Œæ¯ä¸ªæ¨¡å—éƒ½å®ç°ä¸ä¾èµ–äºå…¶ä»–æ¨¡å—çš„åŠŸèƒ½ã€‚</p><p>é€šè¿‡åˆ†å±‚ä½¿å¾—æ¯å±‚éƒ½åªä½¿ç”¨åœ¨å…¶ä¸‹é¢çš„å±‚æ¬¡æä¾›çš„æŠ½è±¡ï¼Œåœ¨æ”¹åŠ¨åº•å±‚å®ç°ï¼Œè€Œåˆä¸å½±å“å…¶ä»–ä»£ç æ–¹é¢ï¼Œå°±ä¼šæœ‰æå¤§çš„çµæ´»æ€§äº†ã€‚</p><blockquote><p>å¯¹äºæ­£äº¤æ€§ç»„ä»¶çš„æµ‹è¯•æ–¹æ³• -&gt; å¦‚æœæˆ‘æ˜¾è‘—æ”¹å˜æŸä¸ªç‰¹å®šåŠŸèƒ½èƒŒåçš„éœ€æ±‚ï¼Œæœ‰å¤šå°‘æ¨¡å—ä¼šå—åˆ°å½±å“å‘¢ï¼Ÿ   éœ€è¦æ˜¯ä¸€ä¸ªï¼</p></blockquote><h2 id="2-5-ç¼–ç "><a href="#2-5-ç¼–ç " class="headerlink" title="2.5 ç¼–ç "></a>2.5 ç¼–ç </h2><ul><li>è®©ä»£ç ä¿æŒè§£è€¦<ul><li>ä¸ä¼šæ²¡å¿…è¦çš„æƒ³å…¶ä»–æ¨¡å—æš´éœ²ä»»ä½•å€Ÿå£</li></ul></li><li>é¿å…ä½¿ç”¨å…¨å±€æ•°æ®</li><li>é¿å…ä½¿ç”¨ç›¸ä¼¼çš„å‡½æ•°</li></ul><blockquote><p>There are no final decisions </p></blockquote><h2 id="2-6-åŸå‹ä¸ä¾¿ç­¾"><a href="#2-6-åŸå‹ä¸ä¾¿ç­¾" class="headerlink" title="2.6 åŸå‹ä¸ä¾¿ç­¾"></a>2.6 åŸå‹ä¸ä¾¿ç­¾</h2><p>åŸå‹ä¸éœ€è¦æ€»æ˜¯ä»¥ä»£ç ä¸ºåŸºç¡€ï¼Œè¦çœ‹éœ€æ±‚ã€‚æ¯”å¦‚ä¸º<strong>å·¥ä½œæµå’Œåº”ç”¨é€»è¾‘è¿™æ ·çš„åŠ¨æ€äº‹ç‰©åˆ¶ä½œåŸå‹ï¼Œä¾¿ç­¾</strong>å°±éå¸¸å¥½ã€‚ç”¨æˆ·ç•Œé¢çš„åŸå‹å¯ä»¥ä½¿ç™½æ¿ä¸Šçš„å›¾å½¢ï¼Œæˆ–è€…æ˜¯æ°¸è¾‰å›¾ç¨‹åºæˆ–è€…ç•Œé¢æ„å»ºå™¨ç»˜åˆ¶çš„æ— åŠŸèƒ½çš„æ¨¡å‹ã€‚</p><p>åŸå‹è®¾è®¡çš„ç›®çš„å°±æ˜¯ä¸ºäº†å»å›ç­”ä¸€äº›é—®é¢˜çš„ï¼Œä¸€äº›ä¸åœ¨æ„çš„æ–¹é¢å°±å¯ä»¥ä¸å»ç®¡å®ƒã€‚ </p><h3 id="2-6-1-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŸå‹"><a href="#2-6-1-ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŸå‹" class="headerlink" title="2.6.1 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŸå‹"></a>2.6.1 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŸå‹</h3><ul><li>åº”åˆ¶ä½œåŸå‹çš„äº‹ç‰©<ul><li>æ¶æ„</li><li>å·²æœ‰ç³»ç»Ÿä¸­çš„æ–°åŠŸèƒ½</li><li>å¤–éƒ¨æ•°æ®çš„ç»“æ„æˆ–å†…å®¹</li><li>ç¬¬ä¸‰æ–¹å·¥å…·æˆ–ç»„ä»¶</li><li>æ€§èƒ½é—®é¢˜</li><li>ç”¨æˆ·ç•Œé¢è®¾è®¡</li></ul></li></ul><h3 id="2-6-2-æ€æ ·ä½¿ç”¨åŸå‹"><a href="#2-6-2-æ€æ ·ä½¿ç”¨åŸå‹" class="headerlink" title="2.6.2 æ€æ ·ä½¿ç”¨åŸå‹"></a>2.6.2 æ€æ ·ä½¿ç”¨åŸå‹</h3><p>å¯ä»¥å¿½ç•¥ä¸€äº›ç»†èŠ‚</p><ul><li>æ­£ç¡®æ€§<ul><li>å¯ä»¥ä½¿ç”¨è™šè®¾çš„æ•°æ®</li></ul></li><li>å®Œæ•´æ€§<ul><li>åŸå‹ä¹Ÿè®¸åªèƒ½åœ¨éå¸¸æœ‰é™çš„æ„ä¹‰ä¸Šå·¥ä½œï¼Œä¹Ÿè®¸åªæœ‰ä¸€é¡¹é¢„å…ˆé€‰æ‹©çš„è¾“å…¥æ•°æ®å’Œèœå•é¡¹</li></ul></li><li>å¥å£®æ€§<ul><li>é”™è¯¯æ£€æŸ¥å¯èƒ½ä¼šéå¸¸ä¸å®Œæ•´ï¼Œæˆ–è€…å®Œå…¨æ²¡æœ‰</li></ul></li><li>é£æ ¼<ul><li>å¯èƒ½æ²¡æœ‰å¤šå°‘æ³¨é‡Šæˆ–è€…æ–‡æ¡£</li></ul></li></ul><h3 id="2-6-3-å¦‚ä½•åˆ¶ä½œæ¶æ„åŸå‹"><a href="#2-6-3-å¦‚ä½•åˆ¶ä½œæ¶æ„åŸå‹" class="headerlink" title="2.6.3 å¦‚ä½•åˆ¶ä½œæ¶æ„åŸå‹"></a>2.6.3 å¦‚ä½•åˆ¶ä½œæ¶æ„åŸå‹</h3><ul><li>åœ¨æ¶æ„åŸå‹ä¸­å¯»æ±‚è§£ç­”çš„ä¸€äº›é—®é¢˜<ul><li>ä¸»è¦ç»„ä»¶çš„è´£ä»»æ˜¯å¦å¾—åˆ°äº†è‰¯å¥½çš„å®šä¹‰ï¼Ÿ æ˜¯å¦é€‚å½“ï¼Ÿ </li><li>ä¸»è¦ç»„ä»¶ä¹‹é—´çš„åä½œæ˜¯å¦å¾—åˆ°è‰¯å¥½çš„å®šä¹‰ï¼Ÿ </li><li>è€¦åˆæ˜¯å¦å¾—ä»¥æœ€å°åŒ–ï¼Ÿ </li><li>æ˜¯å¦èƒ½ç¡®å®šé‡å¤çš„æ½œåœ¨æ¥æºï¼Ÿ </li><li>æ¥å£å®šä¹‰å’Œå„é¡¹çº¦æŸæ˜¯å¦å¯æ¥å—ï¼Ÿ </li><li>æ¯ä¸ªæ¨¡å—åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å¦èƒ½è®¿é—®åˆ°å…¶æ‰€éœ€çš„æ•°æ®ï¼Ÿ æ˜¯å¦èƒ½åœ¨éœ€è¦æ—¶è¿›è¡Œè®¿é—®ï¼Ÿ </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Thought </tag>
            
            <tag> Reading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯´è¯´æ—¥æœ¬</title>
      <link href="/%E8%AF%B4%E8%AF%B4%E6%97%A5%E6%9C%AC/"/>
      <url>/%E8%AF%B4%E8%AF%B4%E6%97%A5%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>ä¸€è¡£å¸¦æ°´çš„é‚»å›½ï¼Œçœ‹ä¸Šå»åƒå¯Œå£«å±±ä¸€æ ·ï¼Œæ¸©æ¶¦å¦‚ç‰ï¼Œæ®Šä¸çŸ¥æ˜¯åº§æ´»ç«å±±ï¼Œå¹³é™ä¸‹é…é…¿ç€é£æš´ã€‚è¿™æ˜¯ä¸ªå¾ˆç¥å¥‡çš„å­˜åœ¨å•Šã€‚æœ‰å…¨ä¸–ç•Œç‹¬ä¸€æ— äºŒçš„å®¡æ…ä¸ä¸¥è°¨ï¼Œä½†ä¹Ÿæœ‰æˆ˜æ–—åˆ°æ­»çš„ç™«ç‹‚ã€‚å°½é‡ä¸åœ¨è¿™ç¯‡æ–‡ç« é‡Œè¾“å‡ºè‡ªå·±çš„è§‚ç‚¹ï¼Œåªæƒ³è¯´è¯´å…³äºæ—¥æœ¬ï¼Œåœ¨è‡ªå·±äº†è§£ä»¥åï¼Œä¸€äº›ç¥å¥‡çš„ï¼Œä»¤äººæƒŠå¹çš„ç‚¹ã€‚</p><h1 id="1-å…³äºæ—¥æœ¬æœ¬èº«"><a href="#1-å…³äºæ—¥æœ¬æœ¬èº«" class="headerlink" title="1. å…³äºæ—¥æœ¬æœ¬èº«"></a>1. å…³äºæ—¥æœ¬æœ¬èº«</h1><h2 id="1-1-åœ°ç†ä½ç½®-åœ°ç†å†³å®šè®ºï¼Ÿæ—¥æœ¬æ°‘æ—æ€§æ ¼ï¼Ÿ"><a href="#1-1-åœ°ç†ä½ç½®-åœ°ç†å†³å®šè®ºï¼Ÿæ—¥æœ¬æ°‘æ—æ€§æ ¼ï¼Ÿ" class="headerlink" title="1.1 åœ°ç†ä½ç½®-åœ°ç†å†³å®šè®ºï¼Ÿæ—¥æœ¬æ°‘æ—æ€§æ ¼ï¼Ÿ"></a>1.1 åœ°ç†ä½ç½®-åœ°ç†å†³å®šè®ºï¼Ÿæ—¥æœ¬æ°‘æ—æ€§æ ¼ï¼Ÿ</h2><p>åƒå²›ä¹‹å›½ï¼Œæ—¥æœ¬å›½åœŸç”±6852ä¸ªå°å²›æ„æˆï¼Œå››ä¸ªæœ€å¤§çš„å²›å äº†æ•´ä¸ªå›½åœŸ97%çš„é¢ç§¯ï¼Œåˆ†åˆ«ä¸ºï¼š åŒ—æµ·é“ï¼Œæœ¬å·ï¼Œå››å›½ï¼Œä¹å·ã€‚73% æ£®æ—è¦†ç›–ç‡ï¼Œä¸–ç•Œé¡¶çº§ã€‚108 åº§æ´»ç«å±±ï¼Œåœ°éœ‡ï¼Œä»å¤è‡³ä»Šï¼Œä¸€ç›´éƒ½åœ¨ã€‚<br><a href="https://en.wikipedia.org/wiki/List_of_countries_by_natural_disaster_risk" target="_blank" rel="noopener">natural disaster risk rank</a> å› ä¸ºå¤„äºå¤ªå¹³æ´‹æ¿å—å’Œäºšæ¬§æ¿å—äº¤ç•Œå¤„çš„æ¶ˆäº¡è¾¹ç•Œï¼Œæ¯å¹´éƒ½æœ‰ä¸Šåƒæ¬¡åœ°éœ‡å‘ç”Ÿï¼Œå…¶ä¸­ä¸ä¹6çº§ä»¥ä¸Šçš„<a href="https://www.livescience.com/30312-japan-earthquakes-top-10-110408.html" target="_blank" rel="noopener">å¤§åœ°éœ‡</a>ã€‚è€Œå¦‚æœç»Ÿè®¡1çº§ä»¥ä¸Šçš„åœ°éœ‡æ•°é‡ï¼Œæ—¥æœ¬<a href="http://blog.sciencenet.cn/blog-2277-1063374.html" target="_blank" rel="noopener">2016å¹´è¾¾åˆ°äº†6566æ¬¡</a>ã€‚</p><h2 id="1-2-æ•™è‚²æ°´å¹³"><a href="#1-2-æ•™è‚²æ°´å¹³" class="headerlink" title="1.2 æ•™è‚²æ°´å¹³"></a>1.2 æ•™è‚²æ°´å¹³</h2><p>æ—¥æœ¬æ•™è‚²æ°´å¹³ä¸–ç•Œå‰åˆ—ï¼Œ<a href="https://www.zhihu.com/question/21303431/answer/543321578" target="_blank" rel="noopener">OECDæ•°æ®-çŸ¥ä¹</a></p><h2 id="1-3-å‘è¿¹å²"><a href="#1-3-å‘è¿¹å²" class="headerlink" title="1.3 å‘è¿¹å²"></a>1.3 å‘è¿¹å²</h2><h3 id="1-3-0-æ˜æ²»ç»´æ–°"><a href="#1-3-0-æ˜æ²»ç»´æ–°" class="headerlink" title="1.3.0 æ˜æ²»ç»´æ–°"></a>1.3.0 æ˜æ²»ç»´æ–°</h3><h3 id="1-3-1-First-Sino-Japanese-War-ç”²åˆæˆ˜äº‰"><a href="#1-3-1-First-Sino-Japanese-War-ç”²åˆæˆ˜äº‰" class="headerlink" title="1.3.1 First Sino-Japanese War - ç”²åˆæˆ˜äº‰"></a>1.3.1 First Sino-Japanese War - ç”²åˆæˆ˜äº‰</h3><p>æˆ‘å›½å‰²è®©äº†è¾½ä¸œåŠå²›ï¼ˆåˆ—å¼ºå¹²é¢„ï¼Œæœªèƒ½å¾—é€ï¼‰ï¼Œå°æ¹¾å²›ï¼Œæ¾æ¹–åˆ—å²›ã€‚å¢å¼€æ²™å¸‚ï¼Œé‡åº†ï¼Œè‹å·ï¼Œæ­å·ä¸ºå•†åŸ ï¼Œå¹¶å…è®¸æ—¥æœ¬åœ¨ä¸­å›½çš„é€šå•†å£å²¸æŠ•èµ„åŠå‚ã€‚</p><p>é¢˜å¤–ï¼ˆå¾…è¡¥å……ï¼‰ï¼šä¸ºä»€ä¹ˆä¼šé€‰æ‹©é—­å…³é”å›½ï¼ˆç¨³å®š+å¯è‡ªç»™è‡ªè¶³+å—ç¾ï¼Œå°¤å…¶ç§˜é²å¤§é‡å»‰ä»·é“¶å…ƒçš„å†²å‡»ï¼‰</p><ol start="2"><li>æˆ˜äº‰èµ”æ¬¾çš„ä½¿ç”¨</li></ol><ul><li>ä¸€åŠç”¨æ¥æ‰©å……é™†æµ·å†›å†›å¤‡</li><li>å¸å€¼æ”¹é©çš„å‡†å¤‡é‡‘ - ç¡®ç«‹é‡‘æœ¬ä½çš„è´§å¸åˆ¶åº¦ï¼Œèå…¥ä¸–ç•Œç»æµä½“ç³»</li><li>å†›èˆ°æ°´é›·è‰‡è¡¥å……åŸºé‡‘</li><li>ç¾å®³å‡†å¤‡åŸºé‡‘</li><li>æ•™è‚²åŸºé‡‘</li><li>å°æ¹¾ç»è¥è´¹ç”¨</li></ul><p>åæ§½ï¼š å®šè¿œèˆ°å»ºé€ èŠ±è´¹çº¦140ä¸‡ä¸¤ç™½é“¶ï¼Œæ…ˆç¦§60å¤§å¯¿èŠ±è´¹ç™½é“¶æ„ˆ1000ä¸‡ä¸¤ã€‚<a href="http://blog.sina.com.cn/s/blog_7765a8070101e7mt.html?tj=1" target="_blank" rel="noopener">å¯èƒ½ä¸å¤ªå‡†ç¡®çš„æ•°æ®æºï¼Œ(æ¬¢è¿æä¾›æ›´å‡†ç¡®çš„~)</a></p><h3 id="1-3-2-æ—¥ä¿„æˆ˜äº‰"><a href="#1-3-2-æ—¥ä¿„æˆ˜äº‰" class="headerlink" title="1.3.2 æ—¥ä¿„æˆ˜äº‰"></a>1.3.2 æ—¥ä¿„æˆ˜äº‰</h3><h3 id="1-3-3-ä¸€æˆ˜ä¸äºŒæˆ˜"><a href="#1-3-3-ä¸€æˆ˜ä¸äºŒæˆ˜" class="headerlink" title="1.3.3 ä¸€æˆ˜ä¸äºŒæˆ˜"></a>1.3.3 ä¸€æˆ˜ä¸äºŒæˆ˜</h3><p>è¯´è¿™æ–¹é¢çš„å¥½æ–‡ç« å¤ªå¤šï¼Œæä¸€ä¸ªæ—¥æœ¬æˆ˜è´¥åç­¾è®¢çš„è·³æœˆç»†æ–‡ï¼š<br><a href="https://en.wikipedia.org/wiki/Article_9_of_the_Japanese_Constitution" target="_blank" rel="noopener">æ—¥æœ¬æ”¾å¼ƒäº†å®£å¸ƒæˆ˜äº‰çš„æƒåˆ©- renounce the sovereign right of belligerency and aims at an international peace based on justice and order</a></p><h2 id="1-3-æ—¥æœ¬ç°åœ¨çš„é—®é¢˜"><a href="#1-3-æ—¥æœ¬ç°åœ¨çš„é—®é¢˜" class="headerlink" title="1.3 æ—¥æœ¬ç°åœ¨çš„é—®é¢˜"></a>1.3 æ—¥æœ¬ç°åœ¨çš„é—®é¢˜</h2><ol><li>äººå£è€é¾„åŒ–</li></ol><p>æ ¹æ®2014å¹´çš„ä¼°è®¡ï¼Œ33%çš„æ—¥æœ¬äººçš„å¹´é¾„åœ¨60å²ä»¥ä¸Šï¼Œ25.9%åœ¨65å²ä»¥ä¸Šï¼Œè€Œè¿™ç§è€é¾„åŒ–çš„è¶‹åŠ¿æ­£æ„ˆæ¼”æ„ˆçƒˆã€‚æ—¥æœ¬äººå£æ•´ä½“æ­£åœ¨è´Ÿå¢é•¿ä¸­ï¼Œ2014å¹´æ•°æ®ä¸º127Mï¼Œé¢„è®¡2040å¹´ä¼šå‡åˆ°107Mï¼Œ 2050å¹´ä¼šåˆ°97Mï¼Œä¸è¶³ä¸€äº¿ã€‚<a href="https://en.wikipedia.org/wiki/Aging_of_Japan" target="_blank" rel="noopener">(æ—¥æœ¬äººå£è€é¾„åŒ–)</a></p><ol start="2"><li>è‡ªæ€ç‡ â€“ related with 1.1?</li></ol><p>æ—¥æœ¬æ¯å¹´è‡ªæ€äººæ•°30000å·¦å³ï¼Œéå¸¸é«˜çš„<a href="https://en.wikipedia.org/wiki/Suicide_in_Japan" target="_blank" rel="noopener">è‡ªæ€ç‡</a>ã€‚</p><ol start="3"><li>ä¸§ä¸€ä»£çš„å¹´è½»äººï¼Ÿ</li></ol><p><a href="https://en.wikipedia.org/wiki/Hikikomori" target="_blank" rel="noopener">Hikikpomori</a> æ­»è‚¥å®…? å¤§æ¦‚åº”è¯¥è¿™ä¹ˆç¿»è¯‘å§</p><p>æ²‰æººäºè™šæ‹Ÿç”Ÿæ´»ï¼Œæ‘’å¼ƒä¸€åˆ‡ç¤¾äº¤æ´»åŠ¨ï¼Œæ´»åœ¨è‡ªå·±çš„ä¸–ç•Œé‡Œã€‚</p><p>å·¨å¤§çš„ç¤¾ä¼šå‹åŠ›ï¼Œ<strong>æœ‰ç¤¼ä¹ŸæŸäºç¤¼</strong>ã€‚ç­‰çº§æ£®ä¸¥ï¼ŒèŒè´£åˆ†æ˜ã€‚è§„åˆ™ä¸ç§©åºå¯¹äºäººçš„æŸäº›æ–¹é¢çš„æŸç¼šã€‚</p><p>æ—¥æœ¬<a href="http://ihl.cankaoxiaoxi.com/2016/1122/1450130.shtml" target="_blank" rel="noopener">ç½‘å§éš¾æ°‘</a>ï¼Œè¿™ç‚¹å¯ä»¥å’Œ<a href="https://zh.wikipedia.org/wiki/%E4%B8%89%E5%92%8C%E5%A4%A7%E7%A5%9E" target="_blank" rel="noopener">ä¸‰å’Œå¤§ç¥</a>å¯¹åº”å“~  </p><h2 id="1-4-æ—¥æœ¬æ–‡åŒ–çš„å®£æ‰¬-famous-for"><a href="#1-4-æ—¥æœ¬æ–‡åŒ–çš„å®£æ‰¬-famous-for" class="headerlink" title="1.4 æ—¥æœ¬æ–‡åŒ–çš„å®£æ‰¬/ famous for"></a>1.4 æ—¥æœ¬æ–‡åŒ–çš„å®£æ‰¬/ famous for</h2><ol><li>æµ®ä¸–ç»˜<br>å¾ˆæœ‰æ„æ€ï¼ŒJapan means a hard, dark, enamellike varnish containing asphalt, used to give a black gloss to metal objects.æ¼†å™¨ã€‚</li></ol><p>ä¸­å›½æ—¥æœ¬åœ¨19ä¸–çºªå¼€å§‹éƒ½ä¼šå¾€æ¬§æ´²å‡ºå£å¾ˆå¤šç“·å™¨ï¼Œè¿™é‡Œä½©æœä¸‹å¤ä»£å›½äººçš„æ™ºæ…§ï¼Œæˆ‘ä»¬æ’’é»„è±†æµ‡æ°´æ¥ä¿æŠ¤ç“·å™¨ï¼Œé»„è±†é‡æ°´å‘èŠ½ï¼Œä¸ç“·å™¨ç‰¢ç‰¢ç»“åˆèµ·æ¥ï¼›æ—¥æœ¬é€‰æ‹©ç”¨æŠ¥çº¸åŒ…è£¹ï¼Œæµ®ä¸–ç»˜ç”±æ­¤ä¼ å…¥æ¬§æ´²ï¼Œæ·±å—å–œçˆ±~ (åä¼ è¯´ï¼Œæ²¡æ‰¾åˆ°å²å®ï¼Œä½†å®åœ¨æ˜¯å¾ˆæœ‰æ„æ€å•Šï¼)</p><ol start="2"><li>åŠ¨æ¼«</li><li>éŸ³ä¹äº§ä¸š</li><li>ç”µå½±</li><li>é¥®é£Ÿ</li><li>ç°ä»£æŠ€æœ¯</li></ol><h1 id="2-ä¸ä¸­å›½çš„å…³ç³»"><a href="#2-ä¸ä¸­å›½çš„å…³ç³»" class="headerlink" title="2. ä¸ä¸­å›½çš„å…³ç³»"></a>2. ä¸ä¸­å›½çš„å…³ç³»</h1><h2 id="2-1-äºŒæˆ˜"><a href="#2-1-äºŒæˆ˜" class="headerlink" title="2.1 äºŒæˆ˜"></a>2.1 äºŒæˆ˜</h2><h2 id="2-2-å¯¹ä¸­æ´åŠ©"><a href="#2-2-å¯¹ä¸­æ´åŠ©" class="headerlink" title="2.2 å¯¹ä¸­æ´åŠ©"></a>2.2 å¯¹ä¸­æ´åŠ©</h2><p>æ—¥æœ¬åœ¨äºŒæˆ˜ä»¥åå¯¹ä¸­æœ‰å¤§é‡ç»æµæ´åŠ©ï¼Œå åˆ°äº†ä¸­å›½æ¥æ”¶çš„æ€»ç»æµæ´åŠ©çš„60%ä»¥ä¸Šã€‚</p><p>æ•´ä¸ªç»æµæ´åŠ©åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p><ol><li>æœ‰å¿èµ„é‡‘ååŠ›</li><li>æ— å¿èµ„é‡‘èµ ä¸</li><li>æŠ€æœ¯æŒ‡å¯¼åŸ¹è‚²ååŠ©</li></ol><p>æ•´ä¸ªç»æµæ´åŠ©ä»1979å¹´å¼€å§‹ï¼Œç›´åˆ°2007å¹´12æœˆç»“æŸã€‚38å¹´æ¥å¯¹ä¸­æ”¿åºœå¼€å‘æ´åŠ©çš„åˆçº¦æ€»é¢ä¸º3.64å…†å††ï¼ŒæŠ˜åˆ2852äº¿äººæ°‘å¸ã€‚å…¶ä¸­89.7%æ˜¯æœ‰å¿è´·æ¬¾ï¼Œè´·æ¬¾åˆ©ç‡æœ€é«˜3.5%,æœ€ä½ä»…ä¸º0.65%ï¼Œè´·æ¬¾å‘¨æœŸæ˜¯30~40å¹´ï¼Œå‰10å¹´å…è¿˜æœ¬é‡‘ã€‚æ—¥æœ¬çš„æ´åŠ©å åˆ°äº†ä¸­å›½æ”¿åºœæ¥å—æ€»ä½“å¤–æ´çš„67.2%ï¼Œä½å±…24ä¸ªå¸®åŠ©å›½å’Œæœºæ„ä¹‹é¦–ã€‚é«˜äºç¬¬äºŒåå¾·å›½33å€ä¹‹å¤šã€‚è€Œåœ¨æ—¥æœ¬å¯¹å¤–æ´åŠ©å›½å½“ä¸­ä¸­å›½åˆ™æ’åœ¨å°å°¼å’Œå°åº¦ä¹‹åç¬¬ä¸‰ä½ã€‚<a href="https://www.zhihu.com/question/40252945" target="_blank" rel="noopener">å¦‚ä½•çœ‹å¾…æ—¥æœ¬æ›¾æ˜¯ä¸­å›½çš„æœ€å¤§æ´åŠ©å›½ï¼Ÿ</a></p><p>è¿™ç‚¹å¾ˆæœ‰æ„æ€ï¼Œç¡®å®ï¼Œæˆ‘ä»¬å…é™¤äº†æ—¥æœ¬çš„æˆ˜äº‰èµ”æ¬¾ï¼Œä½†è¿™ä¸è¶³ä»¥æˆä¸ºæ—¥æœ¬ç»™äºˆå¦‚æ­¤å¤§é‡çš„æ´åŠ©çš„å…ˆå†³æ¡ä»¶ã€‚å°¤å…¶æ˜¯åœ¨æˆ‘ä»¬ä¸€ç©·äºŒç™½ï¼Œå®Œå…¨æ²¡æœ‰å¤–æ±‡å‚¨å¤‡ï¼Œè¿˜éœ€è¦å¯¹å¤–æ‹›å•†å¼•èµ„çš„å…³é”®æ—¶åˆ»ï¼Œè¿™ç¬”é’±ä¼šæå¤§å½±å“æˆ‘ä»¬çš„å‘å±•é€Ÿåº¦ã€‚</p><p>å› ä¸ºæ­‰æ„ï¼Ÿ </p><p>å› ä¸ºå…é™¤æˆ˜äº‰èµ”æ¬¾æå¤§ç¨‹åº¦ä¸Šç»´ç³»äº†å¤©çš‡çš„è£èª‰ï¼Ÿ</p><p>å› ä¸ºæŠ€æœ¯ä¸Šç»æµä¸Šçš„æ´åŠ©å¯ä»¥åŠ é€Ÿäº†è§£ä¸­å›½ï¼Ÿ</p><p>å› ä¸ºç»æµä¸Šçš„æ´åŠ©ï¼Œæœ‰æ¯è´·æ¬¾åŒæ ·ç»™æ—¥æœ¬å¸¦æ¥äº†å¾ˆå¤§çš„ç»æµåˆ©ç›Šï¼Ÿè¿™ç‚¹å®æ‰“å®çš„ï¼Œå¯¹æ—¥æœ¬ä»ä¸Šä¸–çºª80å¹´ä»£å¼€å§‹å°±å¼€æ”¾äº†å¸‚åœºã€‚</p><p>å› ä¸ºæ”¿æ²»ä¸Šæˆ‘ä»¬ä¸çŸ¥é“çš„è§’åŠ›ï¼Ÿ </p><h1 id="3-å°æ€»"><a href="#3-å°æ€»" class="headerlink" title="3. å°æ€»"></a>3. å°æ€»</h1><p>ä¸€ä¸ªå°šæ­¦ä¸”å–„æ­¦ï¼Œè‡ªåˆ¶ä¸”æç«¯ï¼Œæœ‰ç¤¼åˆæŸäºç¤¼ï¼Œå´‡å°šå¼ºè€…çš„æ°‘æ—ã€‚å†å²å½“é‰´ï¼Œæœªæ¥å·²æ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Thought </tag>
            
            <tag> Reading </tag>
            
            <tag> Japan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡æ„ç¬”è®°</title>
      <link href="/%E9%87%8D%E6%9E%84%E7%AC%94%E8%AE%B0/"/>
      <url>/%E9%87%8D%E6%9E%84%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ</h1><blockquote><p>åœ¨ä¸æ”¹å˜è½¯ä»¶å¯è§‚å¯Ÿè¡Œä¸ºçš„å‰æä¸‹æ”¹å–„å…¶å†…éƒ¨ç»“æ„ï¼Œæé«˜å…¶å¯ç†è§£æ€§ï¼Œé™ä½å…¶ä¿®æ”¹æˆæœ¬</p></blockquote><p>å½“é¢å¯¹å†å²é—ç•™é—®é¢˜çš„æ—¶å€™ï¼Œè§„æ¨¡å¾ˆå¤§ï¼Œå†å²è¶…ä¹…ï¼Œä½¿å¾—å¢åŠ å•å…ƒæµ‹è¯•æˆ–è€…ç†è§£é€»è¾‘æˆä¸ºä¸å¯èƒ½çš„ä»»åŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰çš„å·¥å…·å°±æ˜¯é‚£äº›å·²ç»è¢«è¯æ˜æ˜¯<strong>è¡Œä¸ºä¿æŒçš„é‡æ„æ‰‹æ³•</strong>ï¼Œæ•´ç†å‡ºå¯æµ‹è¯•çš„æ¥å£ï¼Œå¹¶æ·»åŠ æµ‹è¯•ï¼Œä»¥æ­¤ä½œä¸ºç»§ç»­é‡æ„çš„ç«‹è¶³ç‚¹ã€‚</p><h2 id="1-1-Tips"><a href="#1-1-Tips" class="headerlink" title="1.1 Tips"></a>1.1 Tips</h2><ol><li>ä»¥å¾®å°çš„æ­¥ä¼ä¿®æ”¹ç¨‹åºï¼Œä»¥æœŸæ›´å¥½çš„å‘ç°é”™è¯¯ã€‚</li><li>ä»£ç åº”è¯¥è¡¨ç°è‡ªå·±çš„ç›®çš„ï¼ï¼ï¼</li><li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‡½æ•°åº”è¯¥æ”¾åœ¨å®ƒæ‰€ä½¿ç”¨çš„æ•°æ®çš„æ‰€å±å¯¹è±¡å½“ä¸­</li><li>å°½é‡å»é™¤ä¸´æ—¶å˜é‡ï¼Œå› ä¸ºå…¶å¾ˆå®¹æ˜“äº§ç”Ÿé—®é¢˜ï¼Œå¯¼è‡´å¤§é‡å‚æ•°è¢«ä¼ æ¥ä¼ å»ã€‚  Replace Temp with Query </li><li>æ³¨æ„å°†å˜åŒ–çš„ä¸œè¥¿æ”¾åˆ°ä¸€å—å»ï¼Œä¸€å—æ¥è§£å†³</li></ol><h1 id="2-é‡æ„åŸåˆ™"><a href="#2-é‡æ„åŸåˆ™" class="headerlink" title="2. é‡æ„åŸåˆ™"></a>2. é‡æ„åŸåˆ™</h1><p>ä½¿ç”¨é‡æ„åŸåˆ™å¼€å‘è½¯ä»¶çš„æ—¶å€™ï¼Œå®è´¨ä¸Šæ˜¯å°†è‡ªå·±çš„æ—¶é—´åˆ†é…ç»™äº†ä¸¤ç§æˆªç„¶ä¸åŒçš„è¡Œä¸ºï¼šæ·»åŠ æ–°åŠŸèƒ½ä»¥åŠé‡æ„ã€‚æ·»åŠ æ–°åŠŸèƒ½çš„æ—¶å€™å°±ä¸ä¿®æ”¹æ—¢æœ‰ä»£ç ï¼›é‡æ„æ—¶ä¸æ·»åŠ æ–°åŠŸèƒ½ï¼Œåªç®¡æ”¹è¿›ç¨‹åºç»“æ„ã€‚</p><h2 id="2-1-ä¸ºä½•é‡æ„"><a href="#2-1-ä¸ºä½•é‡æ„" class="headerlink" title="2.1 ä¸ºä½•é‡æ„"></a>2.1 ä¸ºä½•é‡æ„</h2><ul><li>æ”¹è¿›è½¯ä»¶è®¾è®¡<ul><li>æ•´ç†ä»£ç ï¼Œè®©ä»£ç å›åˆ°åº”æœ‰çš„ä½ç½®ä¸Šå»</li><li>å‡å°‘ä»£ç é‡ï¼Œæ¶ˆé™¤é‡å¤ä»£ç </li></ul></li><li>ä½¿å¾—è½¯ä»¶æ›´å®¹æ˜“ç†è§£</li><li>æ›´å®¹æ˜“æ‰¾åˆ°Big</li><li>æé«˜ç¼–ç¨‹é€Ÿåº¦<ul><li>è‰¯å¥½çš„è®¾è®¡æ˜¯å¿«é€Ÿå¼€å‘çš„æ ¹æœ¬</li></ul></li></ul><blockquote><p>å½“é‡å¤åšä¸€ä»¶äº‹æƒ…ä¸‰æ¬¡çš„æ—¶å€™ï¼Œè¯·é‡æ„ã€‚</p></blockquote><ul><li>åœ¨æ·»åŠ åŠŸèƒ½çš„æ—¶å€™é‡æ„<ul><li>å¸®åŠ©ç†è§£éœ€è¦ä¿®æ”¹çš„ä»£ç </li></ul></li><li>ä¿®è¡¥é”™è¯¯æ—¶é‡æ„</li><li>ä¿®æ”¹æ¥å£<ul><li>å½“æ¥å£ä¸å¾—ä¸è¢«ä¿®æ”¹çš„æ—¶å€™</li><li>deprecateæ‰æ—§æ¥å£ï¼Œå¹¶ä¸”è®©æ—§æ¥å£Internallyè°ƒç”¨æ–°æ¥å£</li></ul></li></ul><h1 id="3-ä»£ç çš„åå‘³é“"><a href="#3-ä»£ç çš„åå‘³é“" class="headerlink" title="3. ä»£ç çš„åå‘³é“"></a>3. ä»£ç çš„åå‘³é“</h1><p>æœ¬ç« æ¯”è¾ƒå¤§æ¦‚ï¼Œä½†é‡Œé¢åˆæåŠäº†å¾ˆå¤šç»†èŠ‚æ€§çš„æ–¹æ³•ï¼Œå»ºè®®å…ˆå»äº†è§£è¿™äº›æ–¹æ³•ï¼Œå†æ¥çœ‹è¿™ä¸€ç« ï¼ </p><p>é‡åº¦è§„çŸ© vs è§è¯†å¹¿åšè€…çš„ç›´è§‰</p><h2 id="3-1-Duplicated-Code-é‡å¤ä»£ç "><a href="#3-1-Duplicated-Code-é‡å¤ä»£ç " class="headerlink" title="3.1 Duplicated Code é‡å¤ä»£ç "></a>3.1 Duplicated Code é‡å¤ä»£ç </h2><ul><li>åŒä¸€ä¸ªç±»çš„ä¸¤ä¸ªå‡½æ•°æœ‰ç›¸åŒè¡¨è¾¾å¼<ul><li>extract method</li></ul></li><li>ä¸¤ä¸ªäº’ä¸ºå…„å¼Ÿçš„å­ç±»å†…çš„ç›¸åŒè¡¨è¾¾å¼<ul><li>extract method to super class</li></ul></li><li>ä¸¤ä¸ªä¸ç›¸å…³çš„ç±»ï¼Œ duplicate code<ul><li>å¯¹å…¶ä¸­ä¸€ä¸ªä½¿ç”¨extract classï¼Œå°†é‡å¤ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹ç±»å½“ä¸­ </li></ul></li></ul><h2 id="3-2-Long-Method-è¿‡é•¿å‡½æ•°"><a href="#3-2-Long-Method-è¿‡é•¿å‡½æ•°" class="headerlink" title="3.2 Long Method (è¿‡é•¿å‡½æ•°)"></a>3.2 Long Method (è¿‡é•¿å‡½æ•°)</h2><p>é—´æ¥å±‚æ‰€èƒ½å¸¦æ¥çš„å…¨éƒ¨åˆ©ç›Š - è§£é‡Šèƒ½åŠ›ï¼Œå…±äº«èƒ½åŠ›ï¼Œé€‰æ‹©èƒ½åŠ›éƒ½æ˜¯ç”±å°å‹å‡½æ•°æ”¯æŒçš„</p><p>ç»™å‡½æ•°ä¸€ä¸ªå¥½åå­—ï¼Œè®©ä»£ç é˜…è¯»è€…å¯ä»¥å¾ˆè¿…é€Ÿåœ°äº†è§£åˆ°è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆçš„ã€‚</p><p>æ¯å½“æ„Ÿè§‰éœ€è¦ä»¥æ³¨é‡Šæ¥è¯´æ˜ç‚¹ä»€ä¹ˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠè¯´æ˜çš„ä¸œè¥¿å†™è¿›ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ã€‚</p><h2 id="3-3-Large-Class-è¿‡å¤§çš„ç±»"><a href="#3-3-Large-Class-è¿‡å¤§çš„ç±»" class="headerlink" title="3.3 Large Class (è¿‡å¤§çš„ç±»)"></a>3.3 Large Class (è¿‡å¤§çš„ç±»)</h2><p>å¦‚æœç”¨å•ä¸ªç±»åšå¤ªå¤šäº‹æƒ…ï¼Œå¾€å¾€ä¼šå‡ºç°å¤§é‡çš„å®ä¾‹å˜é‡ï¼Œä¸€æ—¦å¦‚æ­¤ï¼Œduplicated codeä¹Ÿå°±ä¼šæ¥è¸µè€Œè‡³äº†ã€‚</p><p>extract class or extract subclass </p><h2 id="3-4-Long-Parameter-List-è¿‡é•¿å‚æ•°åˆ—"><a href="#3-4-Long-Parameter-List-è¿‡é•¿å‚æ•°åˆ—" class="headerlink" title="3.4 Long Parameter List (è¿‡é•¿å‚æ•°åˆ—)"></a>3.4 Long Parameter List (è¿‡é•¿å‚æ•°åˆ—)</h2><p>replace parameter with method </p><p>introduce paramter object </p><h2 id="3-5-Divergent-Change-å‘æ•£å¼å˜åŒ–"><a href="#3-5-Divergent-Change-å‘æ•£å¼å˜åŒ–" class="headerlink" title="3.5 Divergent Change (å‘æ•£å¼å˜åŒ–)"></a>3.5 Divergent Change (å‘æ•£å¼å˜åŒ–)</h2><p>é’ˆå¯¹æŸä¸€å¤–ç•Œå˜åŒ–çš„æ‰€æœ‰çš„ç›¸åº”ä¿®æ”¹éƒ½åªåº”è¯¥å‘ç”Ÿåœ¨å•ä¸€ç±»å½“ä¸­ï¼Œå¹¶ä¸”æ–°ç±»å†…çš„æ‰€æœ‰å†…å®¹éƒ½åº”è¯¥ååº”æ­¤å˜åŒ–ã€‚åº”æ‰¾åˆ°å¯¼è‡´å˜åŒ–çš„åŸå› ï¼Œç„¶åè¿ç”¨Extact Classå°†å…¶æç‚¼åˆ°å¦ä¸€ä¸ªç±»å½“ä¸­ã€‚</p><h2 id="3-6-Shotgun-Surgery"><a href="#3-6-Shotgun-Surgery" class="headerlink" title="3.6 Shotgun Surgery"></a>3.6 Shotgun Surgery</h2><p>å¦‚æœæ¯é‡åˆ°æŸç§å˜åŒ–ï¼Œéƒ½å¿…é¡»åœ¨å¾ˆå¤šä¸åŒçš„ç±»å†…åšè®¸å¤šå°ä¿®æ”¹ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨move methodå’Œmove fieldæŠŠæ‰€æœ‰éœ€è¦çš„ä¿®æ”¹éƒ½æ”¾åˆ°ä¸€ä¸ªç±»é‡Œå»ã€‚åŠªåŠ›ä½¿å¤–ç•Œå˜åŒ–å’Œéœ€è¦ä¿®æ”¹çš„ç±»èƒ½å¤Ÿä¸€ä¸€å¯¹åº”ã€‚</p><h2 id="3-7-Feature-Envy"><a href="#3-7-Feature-Envy" class="headerlink" title="3.7 Feature Envy"></a>3.7 Feature Envy</h2><h2 id="3-8-Data-Clumps"><a href="#3-8-Data-Clumps" class="headerlink" title="3.8 Data Clumps"></a>3.8 Data Clumps</h2><p>å°†ç»å¸¸ç»‘åœ¨ä¸€èµ·å‡ºç°çš„æ•°æ®æ”¾åˆ°ä¸€èµ·ï¼Œåˆ›å»ºå±äºä»–ä»¬çš„å¯¹è±¡</p><h2 id="3-9-Primitive-Obsession"><a href="#3-9-Primitive-Obsession" class="headerlink" title="3.9 Primitive Obsession"></a>3.9 Primitive Obsession</h2><h2 id="3-10-switch"><a href="#3-10-switch" class="headerlink" title="3.10 switch"></a>3.10 switch</h2><p>å°‘ç”¨switchï¼Œåº”è¯¥è€ƒè™‘ç”¨å¤šæ€æ¥åšæ›¿æ¢</p><h2 id="3-11-Parallel-Inheritance-Hierarchies-å¹³è¡Œç»§æ‰¿å…³ç³»"><a href="#3-11-Parallel-Inheritance-Hierarchies-å¹³è¡Œç»§æ‰¿å…³ç³»" class="headerlink" title="3.11 Parallel Inheritance Hierarchies (å¹³è¡Œç»§æ‰¿å…³ç³»)"></a>3.11 Parallel Inheritance Hierarchies (å¹³è¡Œç»§æ‰¿å…³ç³»)</h2><h2 id="3-12-Lazy-Class"><a href="#3-12-Lazy-Class" class="headerlink" title="3.12 Lazy Class"></a>3.12 Lazy Class</h2><h2 id="3-13-Speculative-Generality"><a href="#3-13-Speculative-Generality" class="headerlink" title="3.13 Speculative Generality"></a>3.13 Speculative Generality</h2><h2 id="3-14-Temporary-Field"><a href="#3-14-Temporary-Field" class="headerlink" title="3.14 Temporary Field"></a>3.14 Temporary Field</h2><h2 id="3-15-Message-Chains"><a href="#3-15-Message-Chains" class="headerlink" title="3.15 Message Chains"></a>3.15 Message Chains</h2><h2 id="3-16-Middle-Man"><a href="#3-16-Middle-Man" class="headerlink" title="3.16 Middle Man"></a>3.16 Middle Man</h2><h2 id="3-17-Inappropriate-Intimacy"><a href="#3-17-Inappropriate-Intimacy" class="headerlink" title="3.17 Inappropriate Intimacy"></a>3.17 Inappropriate Intimacy</h2><h2 id="3-18-Alternative-Classes-with-Different-Interfaces"><a href="#3-18-Alternative-Classes-with-Different-Interfaces" class="headerlink" title="3.18 Alternative Classes with Different Interfaces"></a>3.18 Alternative Classes with Different Interfaces</h2><h2 id="3-19-Incomplete-Library-Class"><a href="#3-19-Incomplete-Library-Class" class="headerlink" title="3.19 Incomplete Library Class"></a>3.19 Incomplete Library Class</h2><h2 id="3-20-Data-Class"><a href="#3-20-Data-Class" class="headerlink" title="3.20 Data Class"></a>3.20 Data Class</h2><h2 id="3-21-Refused-Bequest"><a href="#3-21-Refused-Bequest" class="headerlink" title="3.21 Refused Bequest"></a>3.21 Refused Bequest</h2><h2 id="3-22-Comments"><a href="#3-22-Comments" class="headerlink" title="3.22 Comments"></a>3.22 Comments</h2><h1 id="4-æ„ç­‘æµ‹è¯•ä½“ç³»"><a href="#4-æ„ç­‘æµ‹è¯•ä½“ç³»" class="headerlink" title="4. æ„ç­‘æµ‹è¯•ä½“ç³»"></a>4. æ„ç­‘æµ‹è¯•ä½“ç³»</h1><p>å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œå†™ä»£ç çš„æ—¶é—´å®é™…ä¸Šå¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†æ—¶é—´æ˜¯ç”¨åœ¨äº†è°ƒè¯•ä»£ç ä¸Šã€‚å®é™…ä¸Šï¼Œæ¯ä¸ªç±»éƒ½åº”è¯¥æœ‰ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œå¹¶ä»¥å®ƒæ¥æµ‹è¯•è‡ªå·±ã€‚</p><p>å†™å¥½ä¸€ç‚¹åŠŸèƒ½å°±ç«‹å³å»è¿›è¡Œæµ‹è¯•ã€‚äº‹å®ä¸Šï¼Œæœ€å¥½èƒ½åœ¨æ·»åŠ ç‰¹æ€§ä¹‹å‰å…ˆå†™æµ‹è¯•ä»£ç ï¼Œä½¿å¾—å°†æ³¨æ„åŠ›é›†ä¸­äºæ¥å£è€Œéå®ç°ã€‚</p><p>ç¼–å†™ä»£ç æ—¶ï¼Œåº”è¯¥å…ˆè®©ä»£ç å¤±è´¥ï¼Œä»¥æ­¤è¯æ˜æµ‹è¯•æœºåˆ¶çš„ç¡®å¯ä»¥è¿è¡Œï¼Œå¹¶ä¸”æ­£ç¡®æµ‹è¯•äº†å…¶è¯¥æµ‹è¯•çš„ä¸œè¥¿ã€‚</p><p>è§‚å¯Ÿç±»è¯¥åšçš„æ‰€æœ‰äº‹æƒ…ï¼Œç„¶åé’ˆå¯¹ä»»ä½•ä¸€é¡¹åŠŸèƒ½çš„ä»»ä½•ä¸€ç§å¯èƒ½å¤±è´¥æƒ…å†µï¼Œè¿›è¡Œæµ‹è¯•ã€‚</p><h1 id="5-é‡æ„åˆ—è¡¨"><a href="#5-é‡æ„åˆ—è¡¨" class="headerlink" title="5. é‡æ„åˆ—è¡¨"></a>5. é‡æ„åˆ—è¡¨</h1><ul><li>æ–¹æ³•</li><li>åŠ¨æœº</li></ul><h1 id="6-é‡æ–°ç»„ç»‡å‡½æ•°"><a href="#6-é‡æ–°ç»„ç»‡å‡½æ•°" class="headerlink" title="6. é‡æ–°ç»„ç»‡å‡½æ•°"></a>6. é‡æ–°ç»„ç»‡å‡½æ•°</h1><p>é‡æ„æ‰‹æ³•å¤§éƒ¨åˆ†éƒ½é’ˆå¯¹å‡½æ•°ï¼Œè€Œé—®é¢˜å¾€å¾€æºè‡ªäºLong Methodsã€‚å› ä¸ºå…¶åŒ…å«äº†å¤ªå¤šä¿¡æ¯ã€‚</p><h2 id="6-1-Extract-Methods"><a href="#6-1-Extract-Methods" class="headerlink" title="6.1 Extract Methods"></a>6.1 Extract Methods</h2><ul><li>å°†ä¸€æ®µä»£ç æ”¾è¿›ä¸€ä¸ªç‹¬ç«‹å‡½æ•°å½“ä¸­ï¼Œå¹¶ä¸”ç”¨å‡½æ•°åç§°æ¥è§£é‡Šè¯¥å‡½æ•°çš„ç”¨é€”</li><li>åŠ¨æœº  <ul><li>å½“å‡½æ•°è¿‡é•¿ï¼Œæˆ–è€…éœ€è¦æ³¨é‡Šæ‰èƒ½è®©äººç†è§£ç”¨é€”ï¼Œå°±æ”¾åˆ°ç‹¬ç«‹å‡½æ•°å½“ä¸­</li><li>å‡½æ•°ç²’åº¦å°æ„å‘³ç€æ›´å®¹æ˜“è¿›è¡Œå¤ç”¨</li><li>ä½¿å¾—é«˜å±‚å‡½æ•°è¯»èµ·æ¥å°±åƒä¸€äº›åˆ—æ³¨é‡Š</li></ul></li><li>åšæ³•<ul><li>åˆ›é€ ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®è¿™ä¸ªå‡½æ•°çš„æ„å›¾æ¥å¯¹å…¶è¿›è¡Œå‘½åï¼Œä»¥åšä»€ä¹ˆè€Œä¸æ˜¯æ€ä¹ˆåšæ¥å‘½å</li></ul></li></ul><h2 id="6-2-Inline-Method-å†…è”å‡½æ•°"><a href="#6-2-Inline-Method-å†…è”å‡½æ•°" class="headerlink" title="6.2 Inline Method å†…è”å‡½æ•°"></a>6.2 Inline Method å†…è”å‡½æ•°</h2><ul><li>åœ¨å‡½æ•°è°ƒç”¨ç‚¹æ’å…¥å‡½æ•°æœ¬ä½“ï¼Œç„¶åç§»é™¤è¯¥å‡½æ•°</li><li>åŠ¨æœº<ul><li>ç§»é™¤æ²¡æœ‰å¤ªå¤§ä»·å€¼çš„é—´æ¥å±‚</li></ul></li></ul><h2 id="6-3-Inline-Temp-å†…è”ä¸´æ—¶å˜é‡"><a href="#6-3-Inline-Temp-å†…è”ä¸´æ—¶å˜é‡" class="headerlink" title="6.3 Inline Temp å†…è”ä¸´æ—¶å˜é‡"></a>6.3 Inline Temp å†…è”ä¸´æ—¶å˜é‡</h2><ul><li>ä½ æœ‰ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œåªè¢«ç®€å•è¡¨è¾¾å¼èµ‹å€¼ä¸€æ¬¡ï¼Œè€Œå®ƒå¦¨ç¢äº†å…¶ä»–é‡æ„æ‰‹æ³•</li><li>åŠ¨æœº<ul><li>ä¸€èˆ¬ä½œä¸ºReplace Temp with Queryçš„ä¸€éƒ¨åˆ†ä½¿ç”¨</li></ul></li></ul><h2 id="6-4-Replace-Temp-with-Query-ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡"><a href="#6-4-Replace-Temp-with-Query-ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡" class="headerlink" title="6.4 Replace Temp with Query  ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡"></a>6.4 Replace Temp with Query  ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡</h2><ul><li>ç°è±¡<ul><li>ä½ çš„ç¨‹åºä»¥ä¸€ä¸ªä¸´æ—¶å˜é‡ä¿å­˜æŸä¸€è¡¨è¾¾å¼çš„è¿ç®—ç»“æœ</li></ul></li><li>å°†è¿™ä¸ªè¡¨è¾¾å¼æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°å½“ä¸­ï¼Œå°†è¿™ä¸ªä¸´æ—¶å˜é‡çš„æ‰€æœ‰å¼•ç”¨ç‚¹æ›¿æ¢ä¸ºå¯¹æ–°å‡½æ•°çš„è°ƒç”¨ã€‚æ­¤åï¼Œæ–°å‡½æ•°å°±å¯ä»¥è¢«å…¶ä»–å‡½æ•°è°ƒç”¨äº†ã€‚</li><li>åŠ¨æœº<ul><li>ä¸´æ—¶å˜é‡çš„é—®é¢˜æ˜¯ä»–ä»¬æ˜¯æš‚æ—¶çš„ï¼Œå¾ˆå¯èƒ½ä½ éœ€è¦å†™å‡ºæ›´é•¿çš„å‡½æ•°æ¥è®¿é—®åˆ°éœ€è¦çš„ä¸´æ—¶å˜é‡ </li></ul></li></ul><h2 id="6-5-Introduce-Explaining-Variable-å¼•å…¥è§£é‡Šæ€§å˜é‡"><a href="#6-5-Introduce-Explaining-Variable-å¼•å…¥è§£é‡Šæ€§å˜é‡" class="headerlink" title="6.5 Introduce Explaining Variable å¼•å…¥è§£é‡Šæ€§å˜é‡"></a>6.5 Introduce Explaining Variable å¼•å…¥è§£é‡Šæ€§å˜é‡</h2><ul><li>å°†è¯¥å¤æ‚è¡¨è¾¾å¼(æˆ–å…¶ä¸­ä¸€éƒ¨åˆ†)çš„ç»“æœæ”¾è¿›ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä»¥æ­¤å˜é‡åç§°æ¥è§£é‡Šè¡¨è¾¾å¼ç”¨é€”ã€‚</li><li>åŠ¨æœº<ul><li>è¡¨è¾¾å¼æœ‰å¯èƒ½éå¸¸å¤æ‚ä¸”éš¾ä»¥é˜…è¯»ï¼Œä¸´æ—¶å˜é‡å¯ä»¥å¸®åŠ©ä½ å°†è¡¨è¾¾å¼åˆ†è§£ä¸ºæ¯”è¾ƒå®¹æ˜“ç®¡ç†çš„å½¢å¼</li><li>è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥è¿ç”¨ä¸´æ—¶å˜é‡æ¥è§£é‡Šæ¯ä¸€æ­¥çš„æ„ä¹‰ï¼Œåœ¨æ‰§è¡Œä¸€äº›æ¯”è¾ƒé•¿çš„åˆ¤æ–­é€»è¾‘çš„æ—¶å€™å¾ˆå…³é”®</li></ul></li><li>åšæ³•<ul><li>å’Œ extract method æœ‰å¯æ›¿æ¢çš„æ½œåœ¨éƒ¨åˆ†çš„</li><li>ä½¿ç”¨introduce explaining variableæ˜¯åœ¨extract methodéœ€è¦èŠ±è´¹æ›´å¤§å·¥ä½œé‡çš„æ—¶å€™</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
            <tag> rafactor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜æœæˆ·ç±åˆ¶åº¦</title>
      <link href="/%E6%98%8E%E6%9C%9D%E6%88%B7%E7%B1%8D%E5%88%B6%E5%BA%A6/"/>
      <url>/%E6%98%8E%E6%9C%9D%E6%88%B7%E7%B1%8D%E5%88%B6%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p>ä»å…ƒæœçš„ç™¾åºŸå¾…å…´åˆ°æ˜å¤ªç¥–çš„ä¼‘å…»ç”Ÿæ¯ï¼Œç”¨ä¸€ä¸ªä¸ªåˆ¶åº¦é€æ¸äº†è§£ç¨³å›ºè‡ªå·±ç»Ÿæ²»çš„å›½å®¶ï¼Œæˆ·å¸–åˆ¶ï¼Œé‡Œç”²åˆ¶ï¼Œé±¼é³å›¾å†Œï¼Œä¸‰ä½ä¸€ä½“ï¼Œå¥ å®šäº†ä¸€æœä¹‹åŸºã€‚ä¼¼ä¹å¤§å®¶æœ‰ç‚¹å°è§‘äº†æœ±å…ƒç’‹å•Šã€‚</p><h1 id="1-æˆ·ç±çš„é‡è¦æ€§"><a href="#1-æˆ·ç±çš„é‡è¦æ€§" class="headerlink" title="1. æˆ·ç±çš„é‡è¦æ€§"></a>1. æˆ·ç±çš„é‡è¦æ€§</h1><ul><li>å£®ä¸æ•°é‡<ul><li>èƒ½åŠ¨å‘˜çš„å£«å…µå’Œæ°‘å¤«æ•°é‡ </li></ul></li><li>ç‰²ç•œæ•°é‡<ul><li>è¿åŠ›çš„å¤šå¯¡ä¸åˆ†é…</li></ul></li><li>ä½œç‰©äº§é‡<ul><li>ç²®è‰å¾å‘</li></ul></li><li>åœ°å½¢å›¾å†Œ<ul><li>å†³å®šç”¨å…µæ–¹ç•¥</li></ul></li><li>èµ„æº<ul><li>è‰è¯</li><li>çŸ¿ç‰©</li><li>etc.</li></ul></li></ul><p>ç”°åœ°æ•°é‡å’Œäººå£æ•°é‡ï¼ŒæŒæ¡è¿™ä¸¤ä¸ªæ‰èƒ½ç¨³å®šæ”¿æƒã€‚</p><p><strong><em>æ”¶ç¨æœ‰æ®ï¼ŒæŸæ°‘æœ‰æ–¹</em></strong></p><h1 id="2-æˆ·å¸–æ³•"><a href="#2-æˆ·å¸–æ³•" class="headerlink" title="2. æˆ·å¸–æ³•"></a>2. æˆ·å¸–æ³•</h1><h2 id="2-1-æˆ·å¸–åˆ¶çš„æµç¨‹"><a href="#2-1-æˆ·å¸–åˆ¶çš„æµç¨‹" class="headerlink" title="2.1 æˆ·å¸–åˆ¶çš„æµç¨‹"></a>2.1 æˆ·å¸–åˆ¶çš„æµç¨‹</h2><ol><li>çš‡å¸ä¸‹å‘åœ£æ—¨åˆ°æˆ·éƒ¨</li><li>æˆ·éƒ¨è®¾è®¡å‡ºæ ‡å‡†æˆ·ç±æ ¼å¼å°ºå¯¸ï¼Œå«åšæˆ·å¸–å¼ã€‚ç”¨çº¸é•¿ä¸€å°ºä¸‰å¯¸ï¼Œå®½ä¸€å°ºä¸¤å¯¸ã€‚</li><li>æˆ·éƒ¨å°†è®¾è®¡å¥½çš„æˆ·å¸–å¼ä¸‹å‘ç»™å®˜åŠå°åŠï¼Œæ‰¹é‡å°åˆ·å¹¶åˆ†å‘</li><li>å„åœ°å·å¿æ¥åˆ°ç©ºç™½æˆ·å¸–çŸ¥ä¹ï¼Œå¿…é¡»ç”±æ­£å°å®˜å‘˜æ‹…ä»»æè°ƒå®˜ï¼Œè´Ÿè´£å¼ è´´æ–‡å‘Šï¼Œæ™“è°•ç™¾å§“</li><li>ä¸‹çº§å®˜åæ‰§è¡Œè½åœ°</li><li>ç™¾å§“å¤šæ•°ä¸è¯†å­—ï¼Œæ•…éœ€è¦å°åç°åœºå¡«å†™å„ç§èµ„æ–™ï¼Œå¹¶ç”±ç†Ÿæ‚‰å†…æƒ…çš„é‡Œæ­£å®¡æ ¸å¹¶ä½œä¿</li><li>æ‰€æœ‰å¡«å¥½çš„ç±è”ï¼Œåœ¨è¡™é—¨æ±‡æ€»ç»Ÿè®¡ï¼Œè¦ç®—æ˜æˆ·å£ï¼Œäººå£ï¼Œä¸å£ï¼Œç”°äº§å‡ é¡¹æ•°å­—çš„æ€»å’Œï¼Œè¿åŒåŸå§‹èµ„æ–™ä¸€èµ·ä¸Šäº¤</li><li>æœ±å…ƒç’‹åŠ¨å‘˜äº†å¤§æ‰¹å†›é˜Ÿç³»ç»Ÿçš„æ–‡ä¹¦äººå‘˜ï¼Œåˆ†æ•£åˆ°å„åœ°åŒºå®¡æ ¸æŠ½æŸ¥</li></ol><h2 id="2-2-æˆ·å¸–æ­£æ–‡æ ¼å¼"><a href="#2-2-æˆ·å¸–æ­£æ–‡æ ¼å¼" class="headerlink" title="2.2 æˆ·å¸–æ­£æ–‡æ ¼å¼"></a>2.2 æˆ·å¸–æ­£æ–‡æ ¼å¼</h2><ul><li>åˆ†ä¸ºå·¦ä¸­å³ä¸‰å—<ul><li>æœ€å³<ul><li>å°åˆ¶æ´ªæ­¦çš‡å¸çš„åœ£æ—¨</li></ul></li><li>ä¸­é—´<ul><li>è¯¥æˆ·çš„ä¹¡è´¯</li><li>ç”·å­ä¸å£</li><li>å¥³å­å£</li><li>åå²</li><li>ä¸æˆ·ä¸»å…³ç³»</li><li>æˆ·ç§</li><li>äº‹äº§</li><li>ä½å€</li></ul></li><li>æœ€å·¦<ul><li>æ¯ä¸€çº§ç»æ‰‹å®˜å‘˜çš„ç­¾æŠ¼</li></ul></li></ul></li><li>æ¯ä¸€ä»½æˆ·å¸–ï¼Œéƒ½è¦ä¸€å¼ä¸¤è”<ul><li>ç±è” ç»™å®˜åºœç•™åº•</li><li>æˆ·è” ç»™ç™¾å§“ç•™åº•</li><li>åœ¨äºŒè€…çš„éª‘ç¼å¤„ï¼Œè¦å°æœ‰å­—å·ä»¥ä½œä¸ºå ªå’Œä¹‹ç”¨</li><li>åŠ ç›–æˆ·éƒ¨éª‘ç¼ç« </li></ul></li></ul><h2 id="2-3-ç¼ºæ†¾ï¼Ÿ"><a href="#2-3-ç¼ºæ†¾ï¼Ÿ" class="headerlink" title="2.3 ç¼ºæ†¾ï¼Ÿ"></a>2.3 ç¼ºæ†¾ï¼Ÿ</h2><ul><li>åªè®°å½•äº†åœŸåœ°å¤šå°‘ï¼Œå´æ²¡æœ‰ç»Ÿè®¡ç”°åœ°çš„è´¨é‡<ul><li>ç¼ºèƒ½å¤Ÿå‡†ç¡®ä¸ˆé‡åœŸåœ°çš„äººæ‰</li><li>ä¸”ä¸æ¸…ä¸ˆåœŸåœ°ï¼Œç™¾å§“çš„æŠµè§¦æƒ…ç»ªå°±ä¼šå°å¾ˆå¤š</li><li>ï¼ï¼é¼“åŠ±å¦è’ï¼Œæ–°å¼€å‘çš„åœŸåœ°ä¸äºˆèµ·ç§‘</li></ul></li><li>èŒä¸šæˆ·åˆ¶ä¾æ—§<ul><li>ç»´ç¨³</li><li>å›½å®¶æ”¿ç­–çš„å»¶ç»­æ€§</li><li>å«æ‰€åˆ¶ï¼Œå†›é˜Ÿä¸å†é€€å½¹ï¼Œä¸–ä»£å†›äºº</li><li>ç²—ç•¥åˆ†ç±»<ul><li>æ°‘æˆ·</li><li>å†›æˆ·</li><li>åŒ æˆ·</li><li>ç¶æˆ·</li></ul></li></ul></li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¤ä»£çš„ä¸­å¤®æ”¿æƒä¸ºäº†å‡å°‘ç®¡ç†æˆæœ¬ï¼Œè¡Œæ”¿åŠ›é‡ä¸€èˆ¬åªä¼šå»¶ä¼¸åˆ°å¿ä¸€çº§ï¼Œå†å¾€ä¸‹ï¼Œå®˜åºœåªæ§åˆ¶åœ°æ–¹ä¸Šçš„è´¢ç¨ï¼Œå†›æƒï¼Œæ„è¯†å½¢æ€è§£è¯»æƒç­‰å¤§èŠ‚ï¼Œè€Œå°†ä¸€éƒ¨åˆ†çš„çç¢çš„äº‹åŠ¡ç®¡ç†æƒäº¤ç»™åœ°æ–¹ä¸Šè‡ªå·±è§£å†³  â€“ å³äº¤ç”±å½“åœ°çš„ä¹¡ç»…ï¼Œè±ªå¼ºä»¥åŠå®—æ—ã€‚</p><p>æˆ·å¸–åˆ¶åå¹´åçš„å†åº¦æ”¹é©ï¼ŒåŠ›æ±‚;</p><ol><li>å‡»ç ´æ¨ªäº˜åœ¨æœå»·å’ŒåŸºå±‚ä¹‹é—´çš„åˆ©ç›Šé›†å›¢ï¼Œæé«˜å¯¹åŸºå±‚çš„æŒæ§åŠ›</li><li>é¿å…é«˜æ˜‚çš„ç®¡ç†æˆæœ¬</li></ol><h1 id="3-é‡Œç”²åˆ¶-â€“-å°é»„å†Œ"><a href="#3-é‡Œç”²åˆ¶-â€“-å°é»„å†Œ" class="headerlink" title="3. é‡Œç”²åˆ¶ â€“ å°é»„å†Œ"></a>3. é‡Œç”²åˆ¶ â€“ å°é»„å†Œ</h1><p>æˆ·å¸–åˆ¶åˆšå¼€å§‹å°±åœ¨åšçš„è¯•ç‚¹å·¥ç¨‹â€¦</p><h2 id="3-1-æ„æˆ"><a href="#3-1-æ„æˆ" class="headerlink" title="3.1 æ„æˆ"></a>3.1 æ„æˆ</h2><ul><li>åŸºæœ¬è¡Œæ”¿å•ä½ å›¾<ul><li>å…±100æˆ·<ul><li>æ¯10æˆ·ç¼–æˆä¸€ç”²ï¼Œä»ä¸­é€‰å‡ºä¸€æˆ·ç”²é¦–æ¥ç®¡ç†</li><li>å…±10ç”²é¦–</li><li>é€‰å‡ºä¸€é‡Œé•¿ï¼Œè´Ÿè´£æŒç®¡åä¸ªç”²é¦–ï¼Œä¸ºä¸€å›¾çš„æœ€é«˜é•¿å®˜ï¼Œç›´æ¥å‘å¿çº§è¡™é—¨æ±‡æŠ¥</li></ul></li></ul></li><li>è§„åˆ™ï¼ï¼ï¼<ul><li>ç”²é¦– é‡Œé•¿ ä¸æ˜¯ç”±ä¸Šçº§å…¨æƒæŒ‡æ´¾ï¼Œä¹Ÿä¸æ˜¯åŸºå±‚é€‰å‡ºï¼Œè€Œæ˜¯â€”-è½®æ¢åˆ¶</li><li>100æˆ·ä¸­å‰10çš„å¯Œæˆ·è½®æµåšé‡Œé•¿</li><li>æ¯æˆ·ä»»æœŸ1å¹´</li><li>11-20ï¼Œæ‹…ä»»ç”²é¦–ï¼Œæ¯æˆ·åˆ†ç®¡9æˆ·ï¼Œä»»æœŸä¸€å¹´ï¼Œç”±ç”²å†…å…¶ä»–æˆ·æ¥åšæ›¿æ¢</li></ul></li><li>å¾­å½¹<ul><li>10ç”²æ’å®šæ¬¡åºï¼Œæ¯å¹´æ´¾å‡ºä¸€ç”²å»åº”å¾­å½¹</li></ul></li><li>è¿ååˆ¶</li></ul><h2 id="3-2-é‡Œé•¿-ç”²é¦–èŒè´£"><a href="#3-2-é‡Œé•¿-ç”²é¦–èŒè´£" class="headerlink" title="3.2 é‡Œé•¿ ç”²é¦–èŒè´£"></a>3.2 é‡Œé•¿ ç”²é¦–èŒè´£</h2><ul><li>ç®¡ç†è´£ä»»<ul><li>é‡Œé•¿éœ€è¦æŠŠèµ‹ç¨æé½</li></ul></li><li>è§£å†³é‚»é‡Œçº çº·</li><li>æ–‡ä¹¦ä½œä¿</li><li>æ²»å®‰å·¡æ£€</li><li>å¾­å½¹<ul><li>è´Ÿæ‹…å¾ˆé‡ï¼Œä¸‰é‡è´Ÿæ‹…<ul><li>è‡ªå¤‡å¹²ç²®</li><li>æŸå¤±åŠ³åŠ¨åŠ›ï¼Œå¯¼è‡´ç”°åœ°è’èŠœ</li><li>ç¨èµ‹ä¾æ—§</li></ul></li></ul></li></ul><h2 id="3-3-è¡¥ç¼º"><a href="#3-3-è¡¥ç¼º" class="headerlink" title="3.3 è¡¥ç¼º"></a>3.3 è¡¥ç¼º</h2><ul><li>è€äººåˆ¶<ul><li>é€‰å–å¹´é¾„å¤§ä¸”å¾·é«˜æœ›é‡çš„è€äººä½œä¸ºä¹¡é‡Œäº‰è®¼çš„è£å†³è€…</li></ul></li><li>hhhhhï¼Œé‡Œç”²å·¥ä½œæ‰‹å†Œ</li><li>ç²®é•¿èŒåŠ¡<ul><li>ç”±å½“åœ°ä¸ç²®å¤šçš„å¯Œæˆ·å……å½“</li><li>å»äº¬å¸ˆé¢†å–æ–‡ä¹¦ï¼Œè¿”å›è¾–åŒº</li><li>ç£ä¿ƒé‡Œé•¿ï¼Œç”²é¦–ç­¹ç²®</li></ul></li></ul><h2 id="3-4-é»„å†Œå†…å®¹"><a href="#3-4-é»„å†Œå†…å®¹" class="headerlink" title="3.4 é»„å†Œå†…å®¹"></a>3.4 é»„å†Œå†…å®¹</h2><ul><li>ç±»ä¼¼æˆ·å¸–çš„</li><li>ç™¾çœ¼å›¾/ ç¼–æ¬¡æ ¼çœ¼<ul><li>å¾­å½¹çš„æ’ç­è¡¨</li></ul></li><li>å››æŸ±å¼è®°å½•<ul><li>æ—§ç®¡</li><li>æ–°æ”¶</li><li>å¼€é™¤</li><li>å®åœ¨</li></ul></li><li>ç”°åœ°å¤§å°ä¸€ç›´æœ‰</li><li>ä½†æ˜¯è¿˜æœ‰ç¨èµ‹è®°å½•ï¼ <ul><li>å¤ç¨</li><li>ç§‹ç²®</li></ul></li></ul><h2 id="3-5-åˆ†æ"><a href="#3-5-åˆ†æ" class="headerlink" title="3.5 åˆ†æ"></a>3.5 åˆ†æ</h2><p>å°†æ”¿åºœè®©ç»™ç»…æƒå’Œæ—æƒçš„æƒåˆ©è¿›è¡Œè¿›ä¸€æ­¥çš„æˆä»½ï¼Œä¿è¯æ¯ä¸€æˆ·äººå®¶éƒ½æœ‰æœºä¼šæŒæ¡åŸºå±‚æƒåŠ›ã€‚çœ‹ä¼¼è®©åŸºå±‚æ›´åŠ åˆ†æ•£ï¼Œå®é™…ä¸Šè®©ä¸­å¤®çš„æƒå¨å›æ¥äº†ï¼</p><p>å¯¹å®˜åºœæ¥è¯´ï¼Œè¿˜ä¸ç”¨æ‰¿æ‹…ç®¡ç†äººå‘˜çš„æˆæœ¬äº†â€¦ </p><h1 id="4-é±¼é³å›¾å†Œ"><a href="#4-é±¼é³å›¾å†Œ" class="headerlink" title="4. é±¼é³å›¾å†Œ"></a>4. é±¼é³å›¾å†Œ</h1><p>åœ¨æœ‰äº†æˆ·å¸–åˆ¶ï¼Œé‡Œç”²åˆ¶ä¿é©¾æŠ¤èˆªä¹‹åï¼Œå¼€å§‹äº†å…¨å›½èŒƒå›´çš„ä¸ˆé‡åœŸåœ°çš„å·¥ä½œ</p><h1 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a>5. æ€»ç»“</h1><p>é»„å†Œå’Œé‡Œç”²åˆ¶é”ä½äº†äººå£ç›¸å…³çš„ç¨è´¹å’Œå¾­å½¹ï¼Œé±¼é³å›¾å†Œå’Œç²®é•¿æŒæ§äº†ç”°åœ°ç§Ÿèµ‹ï¼Œä¸‰ä¸ªåˆ¶åº¦ï¼Œä¸‰ä½ä¸€ä½“ï¼Œå°†ç™¾å§“ç‰¢ç‰¢é’‰åœ¨äº†åœŸåœ°ä¹‹ä¸Šï¼ŒåŒ–ä¸ºç¨³å›ºçš„ç¨åŸºï¼Œæºæºä¸æ–­ä¸ºæœå»·è¾“è¡€ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åšæ—¶é—´ç®¡ç†</title>
      <link href="/%E5%A6%82%E4%BD%95%E5%81%9A%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/"/>
      <url>/%E5%A6%82%E4%BD%95%E5%81%9A%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>é€æ¸å‘ç°æ—¶é—´å¼€å§‹ä¸å¤Ÿç”¨äº†ï¼Œè¦åšçš„followupæœ‰ç‚¹å¤šï¼Œä¸æƒ³æ¯å¤©ä»…ä»…å¿™å·¥ä½œä¸Šçš„äº‹æƒ…ï¼Œæ¯å¤©ä¼šæ‹¿å‡ºä¸€äº›æ—¶é—´å­¦æŠ€æœ¯ï¼Œçœ‹æ–‡ç« ï¼Œæ›´æ–°åšå®¢ï¼›ä¹Ÿä¼šæ‹¿å‡ºä¸€éƒ¨åˆ†æ—¶é—´æ¥çœ‹ä¹¦ï¼Œé˜…è¯»ï¼Œå¸Œæœ›èƒ½åœ¨ä¸“ä¸šé¢†åŸŸå’Œgenericçš„æ–¹é¢éƒ½ä¼šæœ‰ç‚¹ç‚¹æå‡ï¼Œä½†æ˜¯ï¼Œæ—¶é—´ä¸Šâ€¦ ç¡®å®è¶Šæ¥è¶Šä¸å¤Ÿç”¨äº†ã€‚</p><p>ä¸Šç½‘æœäº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰å‡ ä¸ªå°ç‚¹æ˜¯å¯ä»¥å°è¯•ç€å»å˜åŒ–ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ•´ä½“æœ‰æå‡çš„ã€‚</p><h1 id="1-æ—¶é—´å®‰æ’å‰ç§»"><a href="#1-æ—¶é—´å®‰æ’å‰ç§»" class="headerlink" title="1. æ—¶é—´å®‰æ’å‰ç§»"></a>1. æ—¶é—´å®‰æ’å‰ç§»</h1><p>æ—©æ™¨çš„æ—¶é—´çš„åˆ©ç”¨  </p><p>èµ·åºŠä»¥åä¸å¹²æ‚äº‹ï¼Œå…ˆè§£å†³è‡ªå·±æƒ³è¦ä¸“æ³¨ï¼Œä»Šå¤©å¿…é¡»è§£å†³çš„é—®é¢˜ã€‚</p><p>å³èµ·åºŠä»¥åå…ˆå»è§£å†³ä½ ä»Šå¤©éå¸¸æƒ³å¤„ç†çš„ï¼Œä½ è‡ªå·±ç»™è‡ªå·±å®‰æ’çš„äº‹æƒ…ã€‚é‚®ä»¶ï¼Œå¾®ä¿¡å®è´¨ä¸Šæ˜¯åˆ«äººç»™ä½ å®‰æ’çš„äº‹æƒ…ï¼Œè¿™äº›äº‹æƒ…çš„ä¼˜å…ˆçº§ä¸åº”è¯¥å‡Œé©¾äºä½ å¯¹äºè‡ªå·±çš„å®‰æ’ã€‚</p><h1 id="2-æ—¶é—´å®‰æ’"><a href="#2-æ—¶é—´å®‰æ’" class="headerlink" title="2. æ—¶é—´å®‰æ’"></a>2. æ—¶é—´å®‰æ’</h1><p>ä»æ—¶é—´ç»´åº¦å’Œäº‹åŠ¡ç»´åº¦ä¸¤ä¸ªç»´åº¦è·Ÿè¿›ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯timecamp + trelloï¼Œå®è´¨ä¸Šæ˜¯è®°å½•åœ¨æ¯ä¸ªé¡¹ç›®ä¸Šæ‰€èŠ±è´¹çš„æ—¶é—´ä»¥åŠä½ çš„å¾…åŠäº‹é¡¹(æŒ‰ç…§é¡¹ç›®æ¥è¿›è¡Œåˆ’åˆ†)ã€‚</p><h1 id="3-tips"><a href="#3-tips" class="headerlink" title="3. tips"></a>3. tips</h1><p>è¿›ç¨‹åˆ‡æ¢éå¸¸æ˜‚è´µï¼Œé¿å…å¤šä»»åŠ¡ï¼Œä¿æŒå•è¿›ç¨‹ </p><p>æ¯å¤©èƒ½ä¿è¯é«˜æ•ˆçš„æ—¶é—´æ˜¯æœ‰é™çš„ï¼Œé›†ä¸­æ³¨æ„åŠ›ï¼Œé«˜æ•ˆå·¥ä½œæ¯å¤©æœ€å¤š4å°æ—¶ã€‚</p><p>åˆ’åˆ†ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œä¸è¦æŠŠæ€¥åˆ‡å½“åšé‡è¦ã€‚ç´§æ€¥å’Œé‡è¦åˆ’åˆ†å¼€ï¼Œå››è±¡é™å·¥ä½œæ³•ï¼Œä»é‡è¦ç´§æ€¥åšèµ·ï¼Œä½†é‡è¦ä¸ç´§æ€¥ï¼Œåˆ°ä¸é‡è¦ä½†ç´§æ€¥ï¼Œåˆ°ä¸é‡è¦ä¸ç´§æ€¥ã€‚</p><p>èµ·åºŠä»¥åï¼Œä¸è¦æŸ¥çœ‹é‚®ä»¶å’Œå¾®ä¿¡ã€‚</p><p>æ—©èµ·ï¼Œå‡å¦‚4ç‚¹èµ·åºŠï¼Œé‚£ä¹ˆåˆ°äº†ä¸­åˆä½ å°±å®Œæˆäº†ä¸€å¤©çš„ä»»åŠ¡äº†ã€‚</p><p>ä½ æ²¡ç©ºæ—¶ä¸ä¼šåšçš„äº‹æƒ…ï¼Œæœ‰ç©ºäº†ä¹Ÿä¸ä¼šåšçš„ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.ruanyifeng.com/blog/2009/01/stuff_that_matters.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2009/01/stuff_that_matters.html</a></p><p><a href="https://www.ruanyifeng.com/blog/2016/05/time-management.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2016/05/time-management.html</a></p><p><a href="https://www.ruanyifeng.com/blog/2011/01/never_check_email_first_thing_in_the_morning" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2011/01/never_check_email_first_thing_in_the_morning</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thought </tag>
            
            <tag> time management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ è§‚ from Yjango</title>
      <link href="/%E5%AD%A6%E4%B9%A0%E8%A7%82-from-Yjango/"/>
      <url>/%E5%AD%A6%E4%B9%A0%E8%A7%82-from-Yjango/</url>
      
        <content type="html"><![CDATA[<p>æœºç¼˜å·§åˆï¼Œçœ‹åˆ°ä¸ªYjangoçš„å­¦ä¹ è§‚ç³»åˆ—è§†é¢‘ï¼ŒæŠŠå¦‚ä½•å­¦ä¹ ï¼Œæ€ä¹ˆå­¦ä¹ è®²å¾—éå¸¸é€å½»ï¼Œåœ¨è¿™é‡Œåšä¸‹æ•´ç†ï¼Œå¸Œæœ›èƒ½å¯¹å¤§å®¶éƒ½æœ‰æ‰€è£¨ç›Šã€‚</p><h1 id="1-ä»€ä¹ˆæ˜¯å­¦ä¹ ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å­¦ä¹ ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å­¦ä¹ ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯å­¦ä¹ ï¼Ÿ</h1><p>è®°å¿† vs å­¦ä¹ </p><p>å­¦ä¹ ï¼šä»æœ‰é™çš„ä¾‹å­å½“ä¸­å¾—åˆ°ä¸€èˆ¬æ€§çš„è§„å¾‹çš„è¿‡ç¨‹ï¼Œæ‰¾å‡ºçš„è§„å¾‹å«åšçŸ¥è¯†ã€‚</p><p>å­¦ä¹ æ˜¯åœ¨ç”¨çŸ¥è¯†æ¥å‹ç¼©ä¿¡æ¯çš„ï¼Œæˆ‘ä¸éœ€è¦è®°ä½æ— æ•°ç§æƒ…å†µï¼Œä½†æ˜¯æˆ‘éœ€è¦æ ¹æ®æ¯æ¬¡å‡ºç°çš„æƒ…å†µï¼Œæ ¹æ®æˆ‘çš„çŸ¥è¯†æ¥åšå‡ºç›¸åº”çš„åˆ¤æ–­ã€‚</p><h1 id="2-å¦‚ä½•å­¦ä¹ ï¼Ÿ"><a href="#2-å¦‚ä½•å­¦ä¹ ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•å­¦ä¹ ï¼Ÿ"></a>2. å¦‚ä½•å­¦ä¹ ï¼Ÿ</h1><p>åœ¨äººè„‘ä¸­ï¼Œå­¦ä¹ æ˜¯é€šè¿‡ä¾‹å­æ¥æ‰¾å‡ºé—®é¢˜å’Œç­”æ¡ˆä¹‹é—´çš„å…³ç³»ï¼Œè€Œåé‡å¡‘å¤§è„‘é“¾æ¥æ¥å®Œæˆçš„ã€‚</p><p><strong>ä¿¡æ¯æ˜¯å…·ä½“çš„æƒ…å†µï¼Œè€ŒçŸ¥è¯†ä¸æ˜¯å•çº¯çš„ä¿¡æ¯ï¼Œè€Œæ˜¯ä¿¡æ¯ä¸ä¿¡æ¯ä¹‹é—´çš„å…³ç³»</strong></p><p>å¯¹äºçŸ¥è¯†çš„æè¿°èƒ½å¯¹å­¦ä¹ èµ·åˆ°ä¹‹éŸ³çš„ä½œç”¨ï¼Œè€Œæœ€ç»ˆæƒ³è¦è¾¾åˆ°çš„ç›®çš„ä¸€å®šæ˜¯<strong>é€šè¿‡ä¾‹å­ç†æ¸…é—®é¢˜å’Œç­”æ¡ˆçš„å…³ç³»æ¥é‡å¡‘å¤§è„‘è¿æ¥</strong>ã€‚</p><p>å…ˆæŠŠä¹¦è¯»åšï¼Œå†æŠŠä¹¦è¯»è–„ã€‚<br>å°±æ˜¯è¯´ï¼šå°½å¯èƒ½çš„<strong>æœé›†æ›´å¤šçš„ä¾‹å­å¸®åŠ©ä½“ä¼šé—®é¢˜å’Œç­”æ¡ˆä¹‹é—´çš„å…³ç³»</strong>ï¼Œå½“ä½ çœŸæ­£å­¦ä¼šä¹‹åï¼Œè¿™äº›éƒ½ä¼šè¢«å‹ç¼©ä¸ºçŸ¥è¯†çš„ã€‚</p><h1 id="3-å­¦ä¹ è¯¯åŒº"><a href="#3-å­¦ä¹ è¯¯åŒº" class="headerlink" title="3. å­¦ä¹ è¯¯åŒº"></a>3. å­¦ä¹ è¯¯åŒº</h1><h2 id="3-1-é’ˆå¯¹çŸ¥è¯†çš„ç±»å‹åšå‡ºä¸åŒçš„å­¦ä¹ æ–¹æ¡ˆ-çŸ¥è¯†æ„å»ºæ–¹å¼"><a href="#3-1-é’ˆå¯¹çŸ¥è¯†çš„ç±»å‹åšå‡ºä¸åŒçš„å­¦ä¹ æ–¹æ¡ˆ-çŸ¥è¯†æ„å»ºæ–¹å¼" class="headerlink" title="3.1 é’ˆå¯¹çŸ¥è¯†çš„ç±»å‹åšå‡ºä¸åŒçš„å­¦ä¹ æ–¹æ¡ˆ - çŸ¥è¯†æ„å»ºæ–¹å¼"></a>3.1 é’ˆå¯¹çŸ¥è¯†çš„ç±»å‹åšå‡ºä¸åŒçš„å­¦ä¹ æ–¹æ¡ˆ - çŸ¥è¯†æ„å»ºæ–¹å¼</h2><p>é¦–å…ˆæˆ‘ä»¬çš„å­¦ä¹ å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ€è€ƒç±»å­¦ä¹ å’Œè¿åŠ¨ç±»å­¦ä¹ ã€‚</p><p>æ€è€ƒç±»ï¼šæ˜¯å¾ˆæ…¢çš„ï¼Œæ˜¯éœ€è¦æ˜¾ç¤ºçš„ç»è¿‡å¤§è„‘æ€è€ƒï¼Œç„¶ååšå‡ºåˆ¤æ–­ï¼Œç„¶åç»™å‡ºè¾“å‡ºçš„ã€‚æ“…é•¿è§£å†³æ¨æ–­é—®é¢˜ï¼Œä½†æ˜¯æ…¢ï¼Œæ— æ³•åº”å¯¹å¤šå› ç´ çš„é—®é¢˜ã€‚</p><p>è¿åŠ¨ç±»ï¼šå¾ˆå¿«ï¼Œå®Œå…¨ä¸ç»è¿‡æˆ‘ä»¬çš„æ„è¯†å¤„ç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹åº”çš„åšå‡ºååº”ã€‚éæ€è€ƒç±»ï¼Œéæ„è¯†èƒ½è§£å†³çš„é—®é¢˜ã€‚é¢å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡Œå¤§é‡è®­ç»ƒï¼Œè¡Œç¨‹è‚Œè‚‰è®°å¿†ã€‚è¿™ç±»è®­ç»ƒæœ€é‡è¦çš„æ˜¯è¦æœ‰æ­£ç¡®çš„è¾“å…¥è¾“å‡ºï¼Œæ²¡æœ‰æ­£ç¡®çš„åé¦ˆå°†æ°¸è¿œéƒ½å­¦ä¸ä¼šã€‚</p><p>æˆ‘ä»¬éœ€è¦å¯¹ä¸¤ç§ç±»å‹çš„å­¦ä¹ è¿›è¡ŒåŒºåˆ†ï¼Œè€Œååšå‡ºå¯¹åº”çš„å­¦ä¹ å¤„ç†ã€‚</p><h2 id="3-2-é”™è¯¯çš„è¾“å…¥è¾“å‡º"><a href="#3-2-é”™è¯¯çš„è¾“å…¥è¾“å‡º" class="headerlink" title="3.2 é”™è¯¯çš„è¾“å…¥è¾“å‡º"></a>3.2 é”™è¯¯çš„è¾“å…¥è¾“å‡º</h2><p>æ¯”å¦‚è¯´å¬è¯´è¯»å†™å­¦è‹±æ–‡ï¼Œæˆ‘ä»¬å°†åº”è¯¥ä½¿ç”¨è¿åŠ¨ç±»çš„æ–¹å¼è¿›è¡Œå­¦ä¹ çš„ä¸œè¥¿å½“æˆäº†æ€è€ƒç±»è¿›è¡Œå­¦ä¹ çš„ä¸œè¥¿ï¼Œäºæ˜¯æ–‡å­—è¾“å…¥å¹¶åšæ–‡å­—è¾“å‡ºï¼Œç»“æœå°±å¯¼è‡´äº†å­¦ä¹ å¾ˆé•¿æ—¶é—´ä½†æ˜¯å°±æ˜¯å­¦ä¸å¥½ä¸œè¥¿ã€‚</p><p>è€Œæ­£ç¡®çš„è§£å†³æ–¹å¼ï¼Œå¯¹äºå¬è¯´è¯»å†™æ¥è¯´ï¼Œç†åº”æ˜¯ï¼š</p><ul><li>å¬ï¼š å£°éŸ³ -&gt; æ„æ€ï¼Œ è¿åŠ¨ç±»</li><li>è¯´:  æƒ³æ³• -&gt; å‘å£°,  è¿åŠ¨ç±»</li><li>è¯»:  æ–‡å­— -&gt; æ„æ€,  è¿åŠ¨ç±»</li><li>å†™:  æƒ³æ³• -&gt; æ‰“å­—,  è¿åŠ¨ç±»</li></ul><h2 id="3-3-ä¸é€šè¿‡ä¾‹å­ï¼Œä»…è®°å¿†çŸ¥è¯†"><a href="#3-3-ä¸é€šè¿‡ä¾‹å­ï¼Œä»…è®°å¿†çŸ¥è¯†" class="headerlink" title="3.3 ä¸é€šè¿‡ä¾‹å­ï¼Œä»…è®°å¿†çŸ¥è¯†"></a>3.3 ä¸é€šè¿‡ä¾‹å­ï¼Œä»…è®°å¿†çŸ¥è¯†</h2><p>å¤§é‡ä¾‹å­ï¼Œæ¥æ„å»ºçŸ¥è¯†ä¹‹é—´çš„è”ç»“ </p><h1 id="4-åº”ç”¨è¯¯åŒº"><a href="#4-åº”ç”¨è¯¯åŒº" class="headerlink" title="4. åº”ç”¨è¯¯åŒº"></a>4. åº”ç”¨è¯¯åŒº</h1><p>è§£å†³subtaskï¼Œåˆ†è€Œæ²»ä¹‹ï¼Œå› ä¸ºäººçš„å¤§è„‘åœ¨è¿›è¡Œæ€è€ƒç±»çš„å­¦ä¹ æˆ–è€…è¯´è§£å†³é—®é¢˜çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•åŒæ—¶è§¦åŠå¤šä¸ªé¢†åŸŸçš„å†…å®¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸“æ³¨äºä¸€ä¸ªæ–¹é¢çš„ä¸œè¥¿ï¼Œæ·±å…¥ç ”ç©¶ï¼Œè§£å†³å®Œè¿™ä¸ªå°é—®é¢˜ä»¥åå†æ¥ä¸‹æ¥è§£å†³ä¸‹ä¸€ä¸ªå°é—®é¢˜ã€‚å°†åŸæ¥éœ€è¦<strong>æŒ‡æ•°çº§</strong>è§£å†³çš„é—®é¢˜è½¬åŒ–æˆäº†<strong>çº¿æ€§çº§</strong>å¯ä»¥è§£å†³çš„é—®é¢˜ã€‚</p><h1 id="5-æ€ç»´å¯¼å›¾"><a href="#5-æ€ç»´å¯¼å›¾" class="headerlink" title="5. æ€ç»´å¯¼å›¾"></a>5. æ€ç»´å¯¼å›¾</h1><p>ä¸ºä»€ä¹ˆç®€å•åˆå¼ºå¤§ï¼Ÿ</p><p>å¸®åŠ©å­¦ä¹ åº”ç”¨å½“ä¸­çš„è¯¯åŒº</p><ul><li><p>åˆ—å…³é”®è¯</p></li><li><p>éå†è”æƒ³</p></li><li><p>å‹ç¼©ä¿¡æ¯</p></li><li><p>åˆ†æå…±åŒè¾“å…¥è¾“å‡ºï¼Œæ‰¾å‡ºè§„å¾‹</p></li><li><p>è¿™ä¸ªå…³é”®è¯æ˜¯åœ¨ä»£è¡¨ç€å‡ è€…ä¹‹é—´çš„å…³ç³»çš„</p></li><li><p>æ€ç»´å¯¼å›¾çš„å…³é”®è¯  â€“ åŠ¨å®¾ç»“æ„ï¼Œæè¿°çš„æ˜¯è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å‡½æ•°å…³ç³»</p></li><li><p>å¯¹æ€ç»´çš„æ‹†åˆ†  æ‹†æˆå°çŸ¥è¯†çš„ç»„åˆ</p><ul><li>ç„¶åç”¨ä¾‹å­æ¥æ„å»º</li><li>çŸ¥è¯†çš„ç½‘ç»œçš„å¥½å¤„å°±åœ¨äºå…¶é‡ç”¨æ€§</li></ul></li><li><p>æ€ç»´å¯¼å›¾åœ¨æè¿°çš„æ˜¯äºŒé˜¶çŸ¥è¯†</p><ul><li>ä¸€èˆ¬çš„æ˜¯åœ¨æè¿°ä¿¡æ¯ä¸ä¿¡æ¯ä¹‹é—´çš„å…³ç³»</li><li>è€Œæ€ç»´å¯¼å›¾æ˜¯æƒ³æè¿°çŸ¥è¯†ä¸çŸ¥è¯†ä¹‹é—´çš„å…³ç³»</li></ul></li><li><p>å­¦ä¹ åŸåˆ™</p><ul><li>æ˜ç¡®ä»»åŠ¡è¾“å…¥è¾“å‡º</li><li>å°†ä¿¡æ¯å‹ç¼©æˆçŸ¥è¯†</li><li>ä¾‹å­é‡å¡‘å¤§è„‘è¿æ¥</li><li>äºŒé˜¶çŸ¥è¯†æ‹†åˆ†çŸ¥è¯†</li></ul></li></ul><h1 id="6-è´¹æ›¼æŠ€å·§"><a href="#6-è´¹æ›¼æŠ€å·§" class="headerlink" title="6. è´¹æ›¼æŠ€å·§"></a>6. è´¹æ›¼æŠ€å·§</h1><p>å­¦ä¹  + è§£é‡Š </p><p>è§£é‡Šçš„è¿‡ç¨‹è¾¾æˆçš„ç›®çš„ï¼š</p><ul><li>æå–å‹ç¼©</li><li>è½¬åŒ–ä¸ºè‡ªå·±çš„è¯­è¨€<ul><li>æ˜ç¡®ä»»åŠ¡</li><li>æ‹†åˆ†çŸ¥è¯†<ul><li>å­çŸ¥è¯†ä¹‹é—´çš„è¾“å…¥è¾“å‡ºï¼Œpipeline </li></ul></li></ul></li><li>æ˜¯åœ¨éªŒè¯è‡ªå·±å­¦ä¼šäº†  å³é‡åˆ°ä»æœªé‡åˆ°çš„æƒ…å†µçš„æ—¶å€™å¦‚ä½•å»è§£å†³</li><li>éœ€è¦æ–°ä¾‹å­ï¼Œæ–°è§’åº¦ </li><li>æ€ç»´å¯¼å›¾åœ¨æ‹†åˆ†çŸ¥è¯†ï¼Œè€Œè´¹æ›¼æŠ€å·§åˆ™æ˜¯åœ¨éªŒè¯çŸ¥è¯† </li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>è¶…æ™ºèƒ½ä½“ å…¬ä¼—å·-YJango</li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
            <tag> thought </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•æˆåŠŸ(From Sam Altman)</title>
      <link href="/%E5%A6%82%E4%BD%95%E6%88%90%E5%8A%9F-From-Sam-Altman/"/>
      <url>/%E5%A6%82%E4%BD%95%E6%88%90%E5%8A%9F-From-Sam-Altman/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘è§‚å¯Ÿäº†æ•°ä»¥åƒè®¡çš„åˆ›å§‹äººï¼Œå…³äºè¿™äº›äººæ˜¯æ€ä¹ˆèµšåˆ°é‚£ä¹ˆå¤šé’±ã€æ€ä¹ˆåˆ›é€ å‡ºé‡è¦ä¸œè¥¿çš„ï¼Œæˆ‘æ€è€ƒäº†å¾ˆå¤šå¾ˆå¤šã€‚é€šå¸¸ï¼Œä»–ä»¬ä¸€å¼€å§‹éå¸¸æƒ³èµšå¤§é’±ï¼Œåæ¥å˜æˆæƒ³è¦åˆ›é€ å‡ºé‡è¦çš„ä¸œè¥¿ã€‚æˆ‘æœ€ç»ˆæ€»ç»“äº†ä¸‹é¢çš„13æ¡ï¼Œå…³äºå¦‚ä½•åˆ›é€ å‡ºå¸¸äººæ— æ³•ä¼åŠçš„æˆå°±ã€‚</p><p>å¦‚æœä½ å·²ç»è¾¾åˆ°äº†ä¸€å®šçš„æˆåŠŸï¼ˆé€šè¿‡å¤©èµ‹æˆ–è€…åŠªåŠ›ï¼‰ï¼ŒåŒæ—¶æƒ³é€šè¿‡åŠªåŠ›æŠŠè¿™åŸºæœ¬çš„æˆåŠŸæ‹“å±•æˆå¸¸äººæ— æ³•ä¼åŠçš„æˆå°±ï¼Œä¸‹é¢çš„è¿™äº›å¯¹ä½ å°±ä¼šå®¹æ˜“å¾ˆå¤šã€‚ä½†å…¶ä¸­å¤§éƒ¨åˆ†é€‚ç”¨äºæ‰€æœ‰äººã€‚</p><h1 id="1-è®©è‡ªå·±åˆ©æ»šåˆ©-å¤åˆ©è‡ªèº«"><a href="#1-è®©è‡ªå·±åˆ©æ»šåˆ©-å¤åˆ©è‡ªèº«" class="headerlink" title="1.è®©è‡ªå·±åˆ©æ»šåˆ© - å¤åˆ©è‡ªèº«"></a>1.è®©è‡ªå·±åˆ©æ»šåˆ© - å¤åˆ©è‡ªèº«</h1><p>åˆ©æ»šåˆ©æ˜¯ä¸ªå¥‡è¿¹ã€‚ä½ éœ€è¦éšå¤„ç•™æ„å®ƒã€‚æŒ‡æ•°æ›²çº¿å¢é•¿æ˜¯åˆ›é€ è´¢å¯Œçš„å…³é”®ã€‚</p><p>æ¯å¹´å¢é•¿50ï¼…çš„ä¸­å‹ä¼ä¸šåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å°†ä¼šå˜å¾—å·¨å¤§ã€‚ä¸–ç•Œä¸Šå¾ˆå°‘æœ‰ä¼ä¸šå…·æœ‰çœŸæ­£çš„ç½‘ç»œæ•ˆåº”ï¼ˆnetwork effectï¼‰å’Œæé«˜çš„å¯æ‰©å±•æ€§ã€‚ä½†éšç€æŠ€æœ¯çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„ä¼ä¸šå°†ä¼šæœ‰è¿™ä¸ªå¯èƒ½ã€‚æ‰¾åˆ°å®ç°åˆ©æ»šåˆ©çš„ä¼ä¸šï¼Œç”šè‡³åˆ›å»ºå‡ºè¿™ç§ä¼ä¸šï¼Œæ˜¯å€¼å¾—èŠ±è´¹ç²¾åŠ›å»åšçš„ã€‚</p><p>ä½ è‡ªå·±ä¹Ÿè¦è¿½æ±‚æŒ‡æ•°é€Ÿåº¦å¢é•¿ - ä½ åº”è¯¥æŠŠä¸æ–­å¢é•¿çš„å‘ä¸Šå’Œå‘å³çš„è½¨è¿¹ä½œä¸ºä½ äººç”Ÿçš„ç›®æ ‡ã€‚é€‰æ‹©ä¸€ä¸ªå¯ä»¥å®ç°åˆ©æ»šåˆ©çš„èŒä¸šæ˜¯å¾ˆé‡è¦çš„ - å› ä¸ºå¤§å¤šæ•°èŒä¸šéƒ½æ˜¯çº¿æ€§å¢é•¿çš„ã€‚</p><p>ä½ ä¸åº”è¯¥è¿›å…¥ä¸€ä¸ªï¼Œé‚£äº›åšäº†ä¸¤å¹´çš„äººå¯ä»¥å’Œå·²ç»åšäº†äºŒåå¹´çš„äººä¸€æ ·çš„èŒä¸š â€“ ä½ åº”è¯¥ä¿æŒåœ¨ä¸€ä¸ªä¸€ç›´ä¸æ–­é«˜æ•ˆå­¦ä¹ çš„çŠ¶æ€ã€‚éšç€èŒä¸šå‘å±•ï¼Œä½ æ‰€å®Œæˆçš„æ¯ä¸ªå·¥ä½œå•å…ƒéƒ½åº”è¯¥äº§ç”Ÿæ¯”ä»¥å‰å¤šçš„æˆæœã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è·å¾—è¿™ç§æ æ†ä½œç”¨ï¼Œä¾‹å¦‚èµ„æœ¬ï¼ŒæŠ€æœ¯ï¼Œå“ç‰Œï¼Œç½‘ç»œæ•ˆåº”å’Œäººå‘˜ç®¡ç†ã€‚</p><p>ä¸ç®¡ä½ æ˜¯ç”¨ä½•ç§æ ‡å‡†æ¥è¡¡é‡æˆåŠŸ - é‡‘é’±ï¼Œåœ°ä½ï¼Œå¯¹ä¸–ç•Œçš„å½±å“æˆ–å…¶ä»–ä»»ä½•åŸºå‡†ï¼Œä½ éƒ½åº”è¯¥ä¸“æ³¨äºå¦‚ä½•å¯ä»¥æŠŠä½ è‡ªå·±å®šä¹‰çš„æˆåŠŸç¿»10å€ã€‚<strong>æˆ‘æ„¿æ„åœ¨é¡¹ç›®ä¹‹é—´ï¼ŒèŠ±è´¹å°½å¯èƒ½å¤šçš„æ—¶é—´æ¥å¯»æ‰¾ä¸‹ä¸€ä¸ªé¡¹ç›®</strong>ã€‚ä½†æˆ‘æ€»æ˜¯å¸Œæœ›å®ƒæˆä¸ºè¿™æ ·ä¸€ä¸ªé¡¹ç›®ï¼š<strong>å¦‚æœæˆåŠŸï¼Œå°†ä½¿æˆ‘èŒä¸šç”Ÿæ¶¯çš„å…¶ä½™éƒ¨åˆ†ä¸å€¼å¾—ä¸€æ</strong>ã€‚</p><p>å¤§å¤šæ•°äººä¼šé™·å…¥å¯»æ‰¾çº¿æ€§æœºä¼šã€‚ä¸“æ³¨äºæ½œåœ¨çš„å¯ä»¥è®©ä½ ä¸Šä¸€ä¸ªå°é˜¶çš„å˜åŒ–ï¼Œå³ä½¿è¿™æ„å‘³ç€å°æœºä¼šçš„æµå¤±ã€‚</p><p>æˆ‘è®¤ä¸ºï¼Œæ— è®ºæ˜¯å¯¹å…¬å¸è¿˜æ˜¯å¯¹ä¸ªäººçš„èŒä¸šç”Ÿæ¶¯è€Œè¨€ï¼Œæœ€å¤§çš„ç«äº‰ä¼˜åŠ¿æ˜¯ï¼Œ<strong>æ ¹æ®å…¨çƒä¸åŒç³»ç»Ÿå°†å¦‚ä½•èåˆåœ¨ä¸€èµ·ï¼Œåšå‡ºçš„é•¿è¿œå†³å®š</strong>ã€‚å…³äºå¤åˆ©å¢é•¿ï¼Œå€¼å¾—æ³¨æ„çš„ä¸€ä¸ªæ–¹é¢æ˜¯ï¼Œ<strong>æœ€è¿œçš„å°†æ¥ä¼šæ˜¯æœ€é‡è¦çš„</strong>ã€‚</p><p>åœ¨è¿™æ ·ä¸€ä¸ªå‡ ä¹æ²¡æœ‰äººçœŸæ­£çš„ç”¨é•¿è¿œçš„çœ¼å…‰æ¥çœ‹å¾…çš„ä¸–ç•Œé‡Œï¼Œå¸‚åœºä¼šç»™é‚£äº›è¿™ä¹ˆåšçš„äººå¸¦æ¥ä¸°åšçš„å›æŠ¥ã€‚ç›¸ä¿¡æŒ‡æ•°å¢é•¿ï¼Œè€å¿ƒç­‰å¾…ï¼ŒæƒŠå–œä¼šç­‰ç€ä½ ã€‚</p><h1 id="2-æåº¦è‡ªä¿¡"><a href="#2-æåº¦è‡ªä¿¡" class="headerlink" title="2. æåº¦è‡ªä¿¡"></a>2. æåº¦è‡ªä¿¡</h1><p>è‡ªä¿¡æ˜¯éå¸¸å¼ºå¤§çš„ã€‚æˆ‘è®¤è¯†çš„æœ€æˆåŠŸçš„äººå¯¹è‡ªå·±è‡ªä¿¡å¾—å‡ ä¹åˆ°äº†å¦„æƒ³çš„ç¨‹åº¦ã€‚</p><p>å°½æ—©åŸ¹å…»è‡ªä¿¡ã€‚<br>éšç€ä½ å¾—åˆ°æ›´å¤šå¯ä»¥è¯æ˜è‡ªå·±åˆ¤æ–­åŠ›ä¸Šä½³çš„æ•°æ®ç‚¹ï¼Œå¹¶ä¸”ä½ å¯ä»¥ä¸æ–­åœ°è¾¾åˆ°ç†æƒ³çš„ç»“æœï¼Œä½ ä¼šæ„ˆå‘åœ°ç›¸ä¿¡è‡ªå·±çš„ã€‚</p><p>å¦‚æœä½ ä¸ç›¸ä¿¡è‡ªå·±ï¼Œå¾ˆéš¾è®©è‡ªå·±å¯¹æœªæ¥æœ‰è·Ÿåˆ«äººä¸åŒçš„æƒ³æ³•ã€‚ä½†ä¸åˆ«äººæœ‰ä¸åŒçš„æƒ³æ³•æ˜¯åˆ›é€ ä»·å€¼çš„å…³é”®æ‰€åœ¨ã€‚</p><p>æˆ‘è®°å¾—å¤šå¹´å‰Elon Muskå¸¦æˆ‘å‚è§‚äº†SpaceXå·¥å‚ã€‚ä»–è¯¦ç»†è®²è¿°äº†åˆ¶é€ ç«ç®­çš„æ¯ä¸€éƒ¨åˆ†ï¼Œä½†è®©æˆ‘è®°å¿†æœ€æ·±åˆ»çš„äº‹æƒ…æ˜¯ä»–è°ˆåˆ°å‘ç«æ˜Ÿå‘å°„å¤§å‹ç«ç®­æ—¶è„¸ä¸Šçš„ç»å¯¹è‡ªä¿¡ã€‚æˆ‘ç¦»å¼€æ—¶æƒ³â€œå—¯ï¼Œæ‰€ä»¥è¿™å°±æ˜¯æ‹¥æœ‰ä¿¡å¿µçš„æ ‡æ†å§ã€‚â€</p><p>ç®¡ç†è‡ªå·±çš„å£«æ°” - ä»¥åŠå›¢é˜Ÿçš„å£«æ°” - æ˜¯å¤§å¤šæ•°åŠªåŠ›ä¸­æœ€å¤§çš„æŒ‘æˆ˜ä¹‹ä¸€ã€‚å¦‚æœæ²¡æœ‰å¾ˆå¤šçš„è‡ªä¿¡ï¼Œè¿™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä½ è¶Šé›„å¿ƒå‹ƒå‹ƒï¼Œä¸–ç•Œå°±è¶Šä¼šè¯•å›¾å‡»å®ä½ ã€‚</p><p>å¤§å¤šæ•°æä¸ºæˆåŠŸçš„äººï¼Œéƒ½åœ¨è¢«å¤§ä¼—è´¨ç–‘ä¹‹å‰ï¼Œå¯¹æœªæ¥æœ‰è‡³å°‘ä¸€æ¬¡éå¸¸æ­£ç¡®çš„é¢„æœŸã€‚ä»¥æ­¤æ¥åŠ©è‡ªå·±åšå®šä¿¡å¿µï¼Œåº¦è¿‡è¿™æ®µæ—¶é—´ï¼›å¦åˆ™ä¼šç»å†æ›´è‰°éš¾çš„ä¸€æ®µæ—¥å­ã€‚</p><p>è‡ªä¿¡éœ€è¦å’Œè‡ªçŸ¥ä¿æŒå¹³è¡¡ã€‚æˆ‘æ›¾ç»è®¨åŒä»»ä½•å½¢å¼çš„æ‰¹è¯„ï¼Œå¹¶ç§¯æåœ°é¿å…ä»–ä»¬ã€‚ç°åœ¨ï¼Œæˆ‘è¯•ç€åœ¨å‡è®¾è¿™äº›æ‰¹è¯„è¯´çš„æ˜¯çœŸçš„æƒ…å†µä¸‹ï¼Œç„¶åå†³å®šæˆ‘æ˜¯å¦è¦å¯¹å®ƒé‡‡å–è¡ŒåŠ¨ã€‚å¯»æ±‚çœŸç†ï¼Œå¾ˆéš¾å¹¶ç»å¸¸æ˜¯ç—›è‹¦çš„ï¼Œä½†è¿™æ˜¯å°†è‡ªä¿¡ä¸è‡ªæˆ‘æ¬ºéª—åˆ†å¼€çš„åŸå› ã€‚è¿™ç§å¹³è¡¡å¯ä»¥å¸®ä½ é¿å…å˜å¾—è‡ªå‚²å’Œä¸æ¥åœ°æ°”ã€‚</p><h1 id="3-å­¦ä¼šç‹¬ç«‹æ€è€ƒ"><a href="#3-å­¦ä¼šç‹¬ç«‹æ€è€ƒ" class="headerlink" title="3. å­¦ä¼šç‹¬ç«‹æ€è€ƒ"></a>3. å­¦ä¼šç‹¬ç«‹æ€è€ƒ</h1><p>åˆ›ä¸šå¾ˆéš¾æ•™ï¼Œå› ä¸ºåŸåˆ›æ€ç»´å¾ˆéš¾æ•™ã€‚å­¦æ ¡çš„è®¾ç«‹ä¸æ˜¯ä¸ºäº†æ•™è¿™ä¸ª - äº‹å®ä¸Šï¼Œå­¦æ ¡é€šå¸¸ä¼šå¥–åŠ±æ¨¡ä»¿ã€‚æ‰€ä»¥ä½ éœ€è¦è‡ªå·±å»åŸ¹å…»ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›ã€‚</p><p>ä»æœ¬è´¨å¼€å§‹æ€è€ƒå¹¶å°è¯•äº§ç”Ÿæ–°æƒ³æ³•å¾ˆæœ‰è¶£ï¼Œæ‰¾äººäº¤æµå®ƒä»¬å¯ä»¥è®©ä½ å˜å¾—æ›´æ“…é•¿è¿™ä»¶äº‹ã€‚ä¸‹ä¸€æ­¥éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°ç®€å•ï¼Œå¿«é€Ÿçš„æ–¹æ³•æ¥åœ¨ç°å®ä¸–ç•Œä¸­å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚</p><p>â€œæˆ‘ä¼šå¤±è´¥å¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯æˆ‘ä¼šæœ‰ä¸€æ¬¡æ­£ç¡®â€ï¼Œè¿™æ˜¯åˆ›ä¸šè€…çš„è¡Œä¸ºæ–¹å¼ã€‚ä½ å¿…é¡»ç»™è‡ªå·±å¾ˆå¤šæœºä¼šä»¥è·å¾—å¹¸è¿ã€‚ä½ éœ€è¦å­¦ä¹ çš„æœ€é‡è¦çš„ä¸€è¯¾æ˜¯ï¼Œ<strong>ä½ å¯ä»¥åœ¨è¿™ä¸ªé—®é¢˜ä¼¼ä¹æ— è§£çš„æƒ…å†µä¸‹å¼„æ¸…æ¥šè¯¥æ€ä¹ˆåš</strong>ã€‚ä½ è¿™æ ·åšçš„æ¬¡æ•°è¶Šå¤šï¼Œä½ å°±ä¼šè¶Šç›¸ä¿¡å®ƒã€‚ç›¸ä¿¡ä½ å¯ä»¥åœ¨çœ‹ä¼¼å±±ç©·æ°´å°½ï¼Œæ— è·¯å¯èµ°çš„æƒ…å†µä¸‹ï¼ŒæŸ³æš—èŠ±æ˜ï¼Œå¯»åˆ°æ‘åº„ã€‚ Gritï¼ˆå……æ»¡æ¿€æƒ…çš„æ¯…åŠ›ï¼‰æ¥è‡ªäºï¼Œä½ çŸ¥é“ä½ è¢«æ‰“å€’åå¯ä»¥é‡æ–°ç«™èµ·æ¥ã€‚</p><h1 id="4-æ“…é•¿â€œé”€å”®â€"><a href="#4-æ“…é•¿â€œé”€å”®â€" class="headerlink" title="4. æ“…é•¿â€œé”€å”®â€"></a>4. æ“…é•¿â€œé”€å”®â€</h1><p>ä»…é è‡ªä¿¡æ˜¯ä¸å¤Ÿçš„ - ä½ è¿˜å¿…é¡»èƒ½å¤Ÿè®©åˆ«äººç›¸ä¿¡ä½ æ‰€ç›¸ä¿¡çš„ä¸œè¥¿ã€‚</p><p>åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œæ‰€æœ‰æˆåŠŸçš„äº‹ä¸šæœ€åéƒ½æˆä¸ºé”€å”®å·¥ä½œã€‚ä½ å¿…é¡»å‘å®¢æˆ·ï¼Œæ½œåœ¨å‘˜å·¥ï¼Œåª’ä½“ï¼ŒæŠ•èµ„è€…ç­‰å®£ä¼ ä½ çš„è®¡åˆ’ã€‚è¿™éœ€è¦é¼“èˆäººå¿ƒçš„æ„¿æ™¯ã€å¼ºå¤§çš„æ²Ÿé€šæŠ€å·§ã€æŸç§ç¨‹åº¦çš„é­…åŠ›å’Œè¯æ˜æœ‰æ‰§è¡Œèƒ½åŠ›çš„è¯æ®ã€‚</p><p>å–„äºæ²Ÿé€š - ç‰¹åˆ«æ˜¯ä¹¦é¢æ²Ÿé€š - æ˜¯å€¼å¾—æŠ•èµ„çš„ã€‚æˆ‘å¯¹æ˜ç¡®æ²Ÿé€šçš„å»ºè®®æ˜¯,é¦–å…ˆç¡®ä¿ä½ çš„æ€è·¯æ¸…æ™°ï¼Œç„¶åä½¿ç”¨ç®€æ´æ˜äº†çš„è¯­è¨€ã€‚</p><p>æ“…é•¿é”€å”®çš„æœ€ä½³æ–¹å¼æ˜¯<strong>çœŸæ­£ç›¸ä¿¡ä½ æ‰€é”€å”®çš„äº§å“</strong>ã€‚å–ä½ çœŸæ­£ç›¸ä¿¡çš„ä¸œè¥¿æ„Ÿè§‰å¾ˆæ£’ï¼Œè¯•å›¾å–ä¸‡é‡‘æ²¹æ„Ÿè§‰å¾ˆç³Ÿç³•ã€‚</p><p>æé«˜é”€å”®æŠ€å·§å°±åƒæ”¹å–„ä»»ä½•å…¶ä»–æŠ€èƒ½ä¸€æ · - ä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡åˆ»æ„ç»ƒä¹ æ¥æ”¹å–„å®ƒã€‚ä½†å‡ºäºæŸç§åŸå› ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºå®ƒä»¤äººåæ„Ÿï¼Œè®¸å¤šäººè®¤ä¸ºé”€å”®æŠ€å·§æ˜¯å¤©ç”Ÿçš„ï¼Œæ— æ³•åå¤©å­¦ä¼šçš„ã€‚</p><h1 id="5-æŠŠé£é™©å˜çš„æ›´å®¹æ˜“æ‰¿æ‹…"><a href="#5-æŠŠé£é™©å˜çš„æ›´å®¹æ˜“æ‰¿æ‹…" class="headerlink" title="5. æŠŠé£é™©å˜çš„æ›´å®¹æ˜“æ‰¿æ‹…"></a>5. æŠŠé£é™©å˜çš„æ›´å®¹æ˜“æ‰¿æ‹…</h1><p>å¤§å¤šæ•°äººé«˜ä¼°é£é™©å¹¶ä½ä¼°å¥–åŠ±ã€‚å†’é™©å¾ˆé‡è¦ï¼Œå› ä¸ºä¸å¯èƒ½ä¸€ç›´éƒ½æ˜¯æ­£ç¡®çš„ - ä½ å¿…é¡»å°è¯•å¾ˆå¤šäº‹æƒ…å¹¶åœ¨ä½ å­¦åˆ°æ›´å¤šä¸œè¥¿æ—¶è¿…é€Ÿé€‚åº”ã€‚</p><p>åœ¨ä½ çš„èŒä¸šç”Ÿæ¶¯æ—©æœŸï¼Œå†’é™©å¾€å¾€æ›´å®¹æ˜“; ä½ æ²¡æœ‰å¤ªå¤šæŸå¤±ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰å¾ˆå¤šæ”¶è·ã€‚</p><p>ä¸€æ—¦ä½ è¾¾åˆ°äº†è¦æ‰¿æ‹…åŸºæœ¬ä¹‰åŠ¡çš„ç¨‹åº¦ï¼Œä½ å°±åº”è¯¥å°½é‡è®©å†’é™©çš„æŸå¤±å‡å°ã€‚å»å¯»æ‰¾å¦‚æœèµŒé”™äº†ä¼šå¤±å»1å€ï¼Œä½†æ˜¯å¦‚æœå®ƒæœ‰æ•ˆçš„è¯å¯ä»¥ç¿»100å€çš„å°èµŒæ³¨ã€‚ç„¶ååœ¨è·åˆ©åï¼Œåœ¨é‚£ä¸ªæ–¹å‘ä¸Šåšå‡ºæ›´å¤§çš„èµŒæ³¨ã€‚</p><p>ä½†æ˜¯ï¼Œä¸è¦å‚¨è“„å¤ªä¹…ã€‚åœ¨YCï¼Œæˆ‘ä»¬ç»å¸¸æ³¨æ„åˆ°åˆ›å§‹äººæœ‰è¿™æ ·çš„é—®é¢˜ï¼Œä»–ä»¬èŠ±äº†å¾ˆå¤šæ—¶é—´åœ¨è°·æ­Œæˆ–è„¸ä¹¦å·¥ä½œã€‚å½“äººä»¬ä¹ æƒ¯äº†èˆ’é€‚çš„ç”Ÿæ´»ï¼Œå¯é¢„æµ‹åˆ°æœªæ¥çš„å·¥ä½œï¼Œä»¥åŠåœ¨ä»–ä»¬åœ¨æ‰€åšçš„äº‹æƒ…ä¸Šå–å¾—æˆåŠŸçš„å£°èª‰æ—¶ï¼Œå°±å˜çš„éå¸¸éš¾å°†è¿™äº›æŠ›åœ¨èº«åï¼ˆè€Œä¸”ï¼Œç¥å¥‡çš„æ˜¯ï¼Œäººä»¬æ€»æ˜¯èƒ½å¤Ÿå°†ä»–ä»¬çš„ç”Ÿæ´»æ–¹å¼ä¸æ˜å¹´çš„è–ªæ°´ç›¸åŒ¹é…ï¼‰ã€‚å³ä½¿ä»–ä»¬ç¦»å¼€ï¼Œå›å½’çš„è¯±æƒ‘ä¹Ÿå¾ˆå¤§ã€‚å› ä¸ºäººæ€§ï¼Œ<strong>äººä»¬å¾€å¾€ä¼šå°†çŸ­æœŸçš„æ”¶ç›Šå’Œä¾¿åˆ©ä¼˜å…ˆäºé•¿æœŸçš„æˆå°±</strong>ã€‚</p><p>ä½†æ˜¯å½“ä½ ä¸åœ¨è·‘æ­¥æœºä¸Šè¢«å¸¦ç€è·‘æ—¶ï¼Œä½ å¯ä»¥è¿½éšä½ çš„çµæ„Ÿå¹¶èŠ±æ—¶é—´å»åšä¸€äº›å¯èƒ½ä¼šéå¸¸æœ‰è¶£çš„äº‹æƒ…ã€‚å°½å¯èƒ½é•¿æ—¶é—´åœ°ä¿æŒä½ çš„ç”Ÿæ´»ä½æˆæœ¬å’Œçµæ´»æ˜¯ä¸€ç§å¼ºæœ‰åŠ›çš„æ–¹æ³•ï¼Œä½†æ˜¾ç„¶ä¼šæœ‰å¾—å¤±ã€‚</p><h1 id="6-ä¸“æ³¨"><a href="#6-ä¸“æ³¨" class="headerlink" title="6.ä¸“æ³¨"></a>6.ä¸“æ³¨</h1><p>ä¸“æ³¨å¯ä»¥è®©ä½ äº‹åŠåŠŸå€ã€‚</p><p>å‡ ä¹æ‰€æœ‰æˆ‘è§è¿‡çš„äººï¼Œå¦‚æœä»–ä»¬èŠ±æ›´å¤šæ—¶é—´æ€è€ƒè¦ä¸“æ³¨åœ¨ä»€ä¹ˆäº‹æƒ…ä¸Šï¼Œéƒ½ä¼šæœ‰æ›´å¥½çš„ç»“æœã€‚</p><p>åšå¯¹çš„äº‹æ¯”èŠ±æ›´å¤šæ—¶é—´åšäº‹æ›´é‡è¦ã€‚å¤§å¤šæ•°äººæŠŠå¤§éƒ¨åˆ†æ—¶é—´æµªè´¹åœ¨æ— å…³ç´§è¦çš„äº‹æƒ…ä¸Šã€‚</p><p>ä¸€æ—¦ä½ å¼„æ¸…æ¥šè¦åšä»€ä¹ˆï¼Œå°±æŠ›å¼€ä¸€åˆ‡ï¼Œå¿«é€Ÿåœ°å®Œæˆé‚£äº›ä¼˜å…ˆçº§æœ€é«˜çš„ä»»åŠ¡ã€‚æˆ‘è¿˜æ²¡æœ‰é‡åˆ°ä¸€ä¸ªè¡ŒåŠ¨ç¼“æ…¢çš„äººéå¸¸æˆåŠŸã€‚</p><h1 id="7-åŠªåŠ›å·¥ä½œ"><a href="#7-åŠªåŠ›å·¥ä½œ" class="headerlink" title="7.åŠªåŠ›å·¥ä½œ"></a>7.åŠªåŠ›å·¥ä½œ</h1><p>é€šè¿‡èªæ˜æˆ–åŠªåŠ›å·¥ä½œï¼Œä½ å¯ä»¥è¶…è¿‡ä½ æ‰€åœ¨é¢†åŸŸçš„90%çš„äººï¼Œè¿™æ˜¯ä¸€é¡¹ä¼Ÿå¤§çš„æˆå°±ã€‚ä½†è¦è¶…è¿‡99%çš„äººï¼Œä½ ä¸¤ä¸ªéƒ½éœ€è¦ - ä½ çš„ç«äº‰å¯¹æ‰‹å°†æ˜¯éå¸¸æœ‰æ‰èƒ½çš„äººï¼Œä»–ä»¬æœ‰å¾ˆå¥½çš„æƒ³æ³•ï¼Œå¹¶æ„¿æ„ä»˜å‡ºå¾ˆå¤šåŠªåŠ›ã€‚</p><p>ä¸åŒå¯»å¸¸çš„äººå¾—åˆ°ä¸åŒå¯»å¸¸çš„ç»“æœã€‚å·¥ä½œæ—¶é—´å¾ˆé•¿ï¼Œæ„å‘³ç€å…³äºç”Ÿæ´»ä¸Šçš„å·¨å¤§çš„å–èˆï¼Œå†³å®šä¸è¿™æ ·åšæ˜¯å®Œå…¨ç†æ€§çš„ã€‚ä½†åŠ›è¡Œå·¥ä½œæœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿›æ­¥ä¼šç´¯ç§¯ï¼ŒæˆåŠŸä¼šå¸¦æ¥æ›´å¤šçš„æˆåŠŸã€‚</p><p>é€šå¸¸è¿™ä¸ªè¿‡ç¨‹è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ã€‚ç”Ÿæ´»ä¸­æœ€å¤§çš„ä¹è¶£ä¹‹ä¸€å°±æ˜¯æ‰¾åˆ°ä½ çš„ç›®æ ‡ï¼Œå¹¶åœ¨è¿™ä¸Šé¢åŠªåŠ›ï¼Œç„¶åå‘ç°ä½ å¯ä»¥å¸¦æ¥è¿œæ¯”è‡ªå·±æƒ³è±¡ä¸­æ›´å¤§çš„å½±å“ã€‚ä¸€ä½YCåˆ›å§‹äººåœ¨ç¦»å¼€ä¸€å®¶å¤§å…¬å¸åï¼Œå¯¹åŠ›æ±‚è·å¾—æœ€å¤§å½±å“çš„è¿‡ç¨‹æ„Ÿåˆ°çš„æ„‰å¿«å’Œæ»¡è¶³æ„Ÿååˆ†æƒŠè®¶ã€‚è¿½å¯»è‡ªå·±çš„ç›®æ ‡ï¼Œå¹¶ä¸ºä¹‹åŠªåŠ›ï¼Œæ˜¯æå…¶å€¼å¾—çš„ã€‚</p><p>æˆ‘ä¸å®Œå…¨æ¸…æ¥šä¸ºä»€ä¹ˆåŠªåŠ›å·¥ä½œåœ¨ç¾å›½çš„æŸäº›åœ°æ–¹å˜æˆäº†åäº‹ï¼Œä½†åœ¨ä¸–ç•Œå…¶ä»–åœ°æ–¹è‚¯å®šä¸æ˜¯è¿™æ · - ç¾å›½ä»¥å¤–çš„åˆ›ä¸šè€…æ‰€å±•ç¤ºçš„èƒ½é‡å’ŒåŠ¨åŠ›æ­£åœ¨å¾ˆå¿«æˆä¸ºæ–°çš„æ¦œæ ·ã€‚</p><p>ä½ å¿…é¡»å¼„æ¸…æ¥šå¦‚ä½•åŠªåŠ›å·¥ä½œè€Œä¸ä¼šé€æ”¯ã€‚ä¸åŒçš„äººæœ‰è‡ªå·±ä¸åŒçš„æ–¹æ³•ï¼Œä½†å‡ ä¹æ€»æ˜¯æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ï¼Œæ‰¾åˆ°ä½ å–œæ¬¢çš„å·¥ä½œï¼Œå’Œä½ æ„¿æ„é•¿æ—¶é—´ä¸€èµ·å·¥ä½œçš„äººã€‚</p><p>æˆ‘è®¤ä¸ºé‚£äº›ï¼Œå‡è£…æ²¡æœ‰æŠŠå¤§éƒ¨åˆ†æ—¶é—´èŠ±åœ¨å·¥ä½œä¸Šï¼Œä½†æ˜¯å¯ä»¥åœ¨ä»äº‹çš„é¢†åŸŸéå¸¸æˆåŠŸçš„äººï¼Œæ˜¯æœ‰å®³çš„ã€‚äº‹å®ä¸Šï¼ŒæŒä¹‹ä»¥æ’çš„å·¥ä½œï¼Œä»é•¿æœŸæ¥çœ‹å¯èƒ½æ˜¯å¯ä»¥æˆåŠŸçš„æœ€é‡è¦çš„åŸå› ä¹‹ä¸€ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå…³äºåŠªåŠ›å·¥ä½œçš„æƒ³æ³•ï¼šåœ¨ä½ çš„äº‹ä¸šåˆšå¼€å§‹æ—¶å°±è¦åŠªåŠ›å·¥ä½œã€‚åŠªåŠ›å·¥ä½œå°±åƒå¤åˆ©ï¼Œè¶Šæ—©åšï¼Œä½ å°±æœ‰è¶Šå¤šæ—¶é—´è·å–æ”¶ç›Šã€‚å½“ä½ æœ‰æ›´å°‘å…¶ä»–è´£ä»»æ—¶ï¼Œä¹Ÿæ›´å®¹æ˜“ä¸“æ³¨äºç”¨å¿ƒå·¥ä½œã€‚è€…å¾€å¾€å‘ç”Ÿåœ¨ä½ å¹´è½»çš„æ—¶å€™ã€‚</p><h1 id="8-å¤§èƒ†"><a href="#8-å¤§èƒ†" class="headerlink" title="8.å¤§èƒ†"></a>8.å¤§èƒ†</h1><p>æˆ‘è®¤ä¸ºåšä¸€ä¸ªéš¾çš„åˆ›ä¸šå…¬å¸æ¯”ç®€å•çš„åˆ›ä¸šå…¬å¸æ›´å®¹æ˜“ã€‚äººä»¬å¸Œæœ›æˆä¸ºä»¤äººå…´å¥‹çš„äº‹ç‰©çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶æ„Ÿå—åˆ°ä»–ä»¬çš„å·¥ä½œçš„é‡è¦æ€§ã€‚</p><p>å¦‚æœä½ åœ¨ä¸€ä¸ªé‡è¦é—®é¢˜ä¸Šå–å¾—è¿›å±•ï¼Œé‚£ä¹ˆå°†ä¸æ–­çš„ä¼šæœ‰äººæƒ³æ¥å¸®åŠ©ä½ ã€‚è®©è‡ªå·±å˜å¾—æ›´åŠ æœ‰é‡å¿ƒï¼Œä¸è¦å®³æ€•ä¸ºä½ çœŸæ­£æƒ³è¦çš„å·¥ä½œè€ŒåŠªåŠ›ã€‚</p><p>å¦‚æœå…¶ä»–äººéƒ½åœ¨åˆ›åŠäº’ç›¸æ¨¡ä»¿çš„å…¬å¸ï¼Œä½†æ˜¯ä½ æƒ³åˆ›åŠä¸€å®¶å®Œå…¨åˆ›æ–°çš„å…¬å¸ï¼Œé‚£ä¹ˆå°±è¿™æ ·åšï¼Œä¸è¦è¾—è½¬åä¾§ã€‚è·Ÿéšä½ çš„å¥½å¥‡å¿ƒã€‚çœ‹èµ·æ¥ä»¤ä½ å…´å¥‹çš„äº‹æƒ…å¯¹å…¶ä»–äººæ¥è¯´ä¹Ÿå¸¸å¸¸ä»¤äººå…´å¥‹ã€‚</p><h1 id="9-æ„å¿—åŠ›"><a href="#9-æ„å¿—åŠ›" class="headerlink" title="9. æ„å¿—åŠ›"></a>9. æ„å¿—åŠ›</h1><p>ä¸€ä¸ªå¾ˆå¤§çš„ç§˜å¯†å°±æ˜¯ï¼Œå¤§éƒ¨åˆ†æ—¶é—´ï¼Œè¿™ä¸ªä¸–ç•Œä¼šä»¥ä½ çš„æ„å¿—ä¸ºè½¬ç§» - å¤§å¤šæ•°äººç”šè‡³éƒ½ä¸ä¼šå°è¯•ï¼Œåªæ˜¯æ¥å—ç°åœ¨ä¸–ç•Œçš„è¿è¡Œæ–¹å¼ã€‚</p><p>äººä»¬æœ‰å·¨å¤§çš„èƒ½åŠ›æ¥å®ç°ç›®æ ‡ã€‚è‡ªæˆ‘æ€€ç–‘ï¼Œè¿‡æ—©æ”¾å¼ƒï¼Œå’Œæ²¡æœ‰å°½å…¨åŠ›æ¨åŠ¨ï¼Œç§ç§åŸå› çš„ç»“åˆï¼Œé˜»æ­¢äº†å¤§å¤šæ•°äººæŒ–æ˜å‡ºä»–ä»¬çš„æ‰€æœ‰æ½œåŠ›ã€‚</p><p><strong>é—®é—®ä½ è‡ªå·±æƒ³è¦ä»€ä¹ˆ</strong>ã€‚é€šå¸¸ä¸ä¼šå¦‚æ„ï¼Œè€Œä¸”è¿™ç§æ±‚è€Œä¸å¾—å¾€å¾€éå¸¸ç—›è‹¦çš„ã€‚ä½†æ˜¯å½“ä½ åŠªåŠ›æƒ³å»å®ç°è‡ªå·±çš„ç›®æ ‡ï¼Œå¾€å¾€ä½ èƒ½å¤Ÿå®ç°ã€‚</p><p>å‡ ä¹æ‰€æœ‰æ—¶å€™ï¼Œé‚£äº›è¯´â€œ<strong>æˆ‘å°†ç»§ç»­åšæŒç›´åˆ°æˆåŠŸï¼Œå¹¶ä¸”æ— è®ºé¢ä¸´ä»€ä¹ˆæŒ‘æˆ˜ï¼Œæˆ‘éƒ½è¦æå®š</strong>â€å¹¶ä¸”è®¤çœŸè¿™ä¹ˆè¯´çš„äººï¼Œéƒ½ä¼šå˜æˆåŠŸã€‚ä»–ä»¬çš„åšæŒä¸æ‡ˆæ€»ä¼šæœ‰ä¸€æ¬¡ç¢°åˆ°å¥½è¿çš„ã€‚</p><blockquote><p>I am going to keep going until this works, and no matter what the challenges are Iâ€™m going to figure them out. </p></blockquote><p>çˆ±å½¼è¿æ˜¯æˆ‘çš„æ ‡æ†ã€‚ä»–ä»¬å‘Šè¯‰æˆ‘äº†å¾ˆå¤šæ•…äº‹ï¼Œè™½ç„¶æˆ‘ä¸å»ºè®®å¤§å®¶æ¨¡ä»¿ï¼ˆåˆ·çˆ†å¾ˆå¤šä¿¡ç”¨å¡ï¼Œæ¯é¤åƒä¸€ç¾å…ƒå•†åº—çš„éº¦ç‰‡ï¼Œä¸æ–­çš„ä¸æ ¹æ·±è’‚å›ºçš„æ€ç»´åšæ–—äº‰ï¼Œç­‰ç­‰ï¼Œç­‰ç­‰ï¼‰ä½†ä»–ä»¬è®¾æ³•å­˜æ´»äº†è¶³å¤Ÿé•¿çš„æ—¶é—´ä»¥ä¾¿è¿æ°”æ‰¾åˆ°ä»–ä»¬ã€‚</p><p>è¦æœ‰æ¢¦æƒ³ï¼Œæœ‰æ„å¿—åŠ›ï¼Œä½ å¿…é¡»ä¿æŒä¹è§‚ - è¿™æ˜¯ä¸€ç§å¯ä»¥é€šè¿‡ç»ƒä¹ è€Œæ”¹å–„çš„äººæ ¼ç‰¹è´¨ã€‚æˆ‘ä»æœªè§è¿‡ä¸€ä¸ªéå¸¸æˆåŠŸçš„æ‚²è§‚ä¸»ä¹‰è€…ã€‚</p><h1 id="10-è®©åˆ«äººå¾ˆéš¾ä¸ä½ ç«äº‰"><a href="#10-è®©åˆ«äººå¾ˆéš¾ä¸ä½ ç«äº‰" class="headerlink" title="10. è®©åˆ«äººå¾ˆéš¾ä¸ä½ ç«äº‰"></a>10. è®©åˆ«äººå¾ˆéš¾ä¸ä½ ç«äº‰</h1><p>å¤§å¤šæ•°äººéƒ½æ˜ç™½ï¼Œå¦‚æœä¸€ä¸ªå…¬å¸åœ¨ä¸€ä¸ªé¢†åŸŸéš¾ä»¥åŒ¹æ•Œï¼Œé‚£ä¹ˆè¿™ä¸ªå…¬å¸å°±æ›´æœ‰ä»·å€¼ã€‚è¿™ç‚¹å¾ˆé‡è¦ï¼Œä¹Ÿå¾ˆæ˜æ˜¾ç€å®æ˜¯è¿™æ ·çš„ã€‚</p><p>ä½†è¿™å¯¹ä½ ä¸ªäººæ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœä½ åšçš„äº‹æƒ…å¯ä»¥ç”±å…¶ä»–äººå®Œæˆï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šå˜æˆè°è¦æ›´å°‘çš„é’±æ¥å®Œæˆã€‚ </p><p>å˜å¾—éš¾ä»¥ä¸ä¹‹ç«äº‰çš„æœ€ä½³æ–¹å¼æ˜¯<strong>å»ºç«‹è¯è¯­æƒ</strong>ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡å»ºç«‹<strong>å¼ºå¤§çš„ä¸ªäººå“ç‰Œ</strong>ï¼Œæˆ–é€šè¿‡<strong>æ“…é•¿å¤šä¸ªä¸åŒé¢†åŸŸçš„äº¤å‰</strong>æ¥å®ç°ä¸ªäººå…³ç³»ã€‚è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç­–ç•¥ï¼Œä½†ä½ å¿…é¡»æ‰¾åˆ°ä¸€äº›æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p>ç‰©ä»¥ç±»èšï¼Œäººä»¥ç¾¤åˆ†ã€‚å¤§éƒ¨åˆ†äººä¼šè¢«èº«è¾¹ç›¸å¤„çš„äººçš„è¡Œä¸ºæ–¹å¼æ‰€å½±å“ï¼Œè¿™ç§æ¨¡ä»¿/å½±å“è¡Œä¸ºé€šå¸¸æ˜¯ä¸€ä¸ªé”™è¯¯ - å¦‚æœä½ æ­£åœ¨åšå…¶ä»–äººæ­£åœ¨åšçš„äº‹æƒ…ï¼Œä¸ä½ ç«äº‰å°†ä¸ä¼šå¾ˆéš¾ã€‚</p><h1 id="11-å»ºç«‹äººè„‰"><a href="#11-å»ºç«‹äººè„‰" class="headerlink" title="11. å»ºç«‹äººè„‰"></a>11. å»ºç«‹äººè„‰</h1><p>å‡ºè‰²çš„å·¥ä½œéœ€è¦å›¢é˜Ÿã€‚å»ºç«‹ä¸€ä¸ªæœ‰æ‰èƒ½çš„äººæ‰ç½‘ç»œ - æœ‰æ—¶æ˜¯å¯†åˆ‡çš„ï¼Œæœ‰æ—¶æ˜¯æ¾æ•£çš„ - æ˜¯äº‹ä¸šæˆåŠŸçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ä½ è®¤è¯†çš„çœŸæ­£æœ‰æ‰åçš„äººçš„è§„æ¨¡é€šå¸¸ä¼šæˆä¸ºä½ å¯ä»¥å®ç°çš„ç›®æ ‡çš„é™åˆ¶å› ç´ ã€‚</p><p>å»ºç«‹äººè„‰çš„æœ‰æ•ˆæ–¹æ³•æ˜¯å°½å¯èƒ½å¤šåœ°å¸®åŠ©åˆ«äººã€‚é•¿æœŸçš„è¿™ä¹ˆåšï¼Œè®©æˆ‘è·å¾—äº†æˆ‘æœ€å¥½çš„èŒåœºæœºä¼šå’Œæˆ‘å››é¡¹æœ€ä½³æŠ•èµ„ä¸­çš„ä¸‰é¡¹ã€‚è®©æˆ‘ä¸æ–­æƒŠè®¶çš„æ˜¯ï¼Œå¾ˆå¤šå¥½äº‹å‘ç”Ÿåœ¨æˆ‘èº«ä¸Šï¼Œç«Ÿç„¶æ˜¯å› ä¸ºå¤šå¹´å‰æˆ‘å¸®åŠ©è¿‡ä¸€äº›åˆ›å§‹äººã€‚</p><p>å»ºç«‹äººè„‰çš„æœ€ä½³æ–¹å¼ä¹‹ä¸€æ˜¯ï¼Œå»ºç«‹ä¸€ä¸ªä¸ä½ åˆä½œçš„äºº<strong>éƒ½ä¸ä¼šè¢«äºå¾…çš„åå£°</strong>ã€‚<strong>æ…·æ…¨ç”šè‡³è¿‡åº¦çš„åˆ†äº«</strong>å¥½å¤„; å®ƒä¼šç»™ä½ å¸¦æ¥10å€çš„å›æŠ¥ã€‚æ­¤å¤–ï¼Œ++å­¦ä¹ å¦‚ä½•è¯„ä¼°äººä»¬çš„ä¼˜ç‚¹ï¼Œå¹¶è®©ä»–ä»¬åšè‡ªå·±æ“…é•¿çš„äº‹æƒ…++ã€‚ ï¼ˆè¿™æ˜¯æˆ‘å­¦åˆ°çš„å…³äºç®¡ç†çš„æœ€é‡è¦çš„äº‹æƒ…ï¼Œæˆ‘å¹¶æ²¡æœ‰è¯»è¿‡å¾ˆå¤šå…³äºè¿™æ–¹é¢çš„ä¹¦ã€‚ï¼‰<strong>ä½ æƒ³è¦æ¨åŠ¨å‘˜å·¥ï¼Œå¹¶ä½¿ä»–ä»¬è¾¾åˆ°çš„æˆå°±è¶…å‡ºä»–ä»¬çš„é¢„æœŸï¼Œä½†åŒæ—¶å¹¶ä¸ä¼šè®©å‘˜å·¥æ„Ÿåˆ°é€æ”¯</strong>ã€‚</p><p>æ¯ä¸ªäººéƒ½æœ‰æ¯”å…¶ä»–äººæ›´æ“…é•¿çš„äº‹æƒ…ã€‚ç”¨ä½ çš„ä¼˜åŠ¿è€Œä¸æ˜¯ä½ çš„å¼±ç‚¹æ¥å®šä¹‰è‡ªå·±ã€‚++æ‰¿è®¤ä½ çš„å¼±ç‚¹å¹¶å¼„æ¸…æ¥šå¦‚ä½•è§£å†³å®ƒä»¬++ï¼Œä½†ä¸è¦è®©å®ƒä»¬é˜»æ­¢ä½ å»åšä½ æƒ³åšçš„äº‹æƒ…ã€‚æˆ‘å¾ˆåƒæƒŠæˆ‘ç»å¸¸ä»åˆ›ä¸šè€…å£ä¸­å¬åˆ° â€œæˆ‘ä¸èƒ½åšAï¼Œå› ä¸ºæˆ‘ä¸æ“…é•¿Bâ€ï¼Œè¿™å‡ ä¹æ€»æ˜¯èƒ½åæ˜ å‡ºè¿™ä¸ªåˆ›ä¸šè€…ç¼ºä¹åˆ›é€ åŠ›ã€‚å¼¥è¡¥ä½ çš„å¼±ç‚¹çš„æœ€å¥½æ–¹æ³•æ˜¯è˜è¯·äº’è¡¥çš„å›¢é˜Ÿæˆå‘˜ï¼Œè€Œä¸æ˜¯é›‡ç”¨è·Ÿä½ æ“…é•¿åŒæ ·äº‹æƒ…çš„äººã€‚ </p><p>åœ¨å»ºç«‹äººè„‰ä¸­ï¼Œä¸€ä¸ªç‰¹åˆ«æœ‰ç”¨çš„æ–¹æ³•æ˜¯å–„äºå‘ç°æœªè¢«å‘æ˜çš„äººæ‰ã€‚é€šè¿‡ç»ƒä¹ ï¼Œå¿«é€Ÿå‘æ˜é«˜æ™ºå•†ï¼Œæœ‰åŠ¨åŠ›å’Œæœ‰åˆ›é€ åŠ›çš„äººæ‰ä¼šå˜å¾—è¶Šæ¥è¶Šå®¹æ˜“ã€‚æœ€ç®€å•çš„å­¦ä¹ æ–¹æ³•å°±æ˜¯ä¸å¾ˆå¤šäººè§é¢ï¼Œå¹¶æŒç»­è®°å½•è°è®©ä½ ä½©æœï¼Œå°è±¡æ·±åˆ»ï¼Œè°è®©ä½ è§‰å¾—ä¸ä¼šç•™ä¸‹ä»€ä¹ˆçš„å°è±¡ã€‚è®°ä½ï¼Œä½ çš„ç›®çš„æ˜¯<strong>å¯»æ‰¾è¿›æ­¥é€Ÿåº¦æœ€å¿«</strong>çš„äººï¼Œä¸è¦é«˜ä¼°ç»éªŒå’Œç›®å‰çš„æˆå°±ã€‚</p><p>å½“æˆ‘é‡åˆ°ä¸€ä¸ªæ–°çš„äººæ—¶ï¼Œæˆ‘æ€»æ˜¯ä¼šé—®è‡ªå·±â€œè¿™ä¸ªäººæœ‰å¼‚äºå¸¸äººçš„èƒ½åŠ›å—ï¼Ÿâ€è¿™å¯¹äºå¯»æ‰¾æœ‰å¯èƒ½å®Œæˆä¼Ÿå¤§äº‹ä¸šçš„äººæ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æ–¹æ³•ã€‚</p><p>å»ºç«‹äººè„‰çš„ä¸€ä¸ªç‰¹åˆ«çš„æ–¹å¼å°±æ˜¯ï¼Œæ‰¾åˆ°<strong>æ„¿æ„åœ¨ä½ èº«ä¸Šä¸‹èµŒæ³¨çš„äºº</strong>ï¼Œæœ€å¥½æ˜¯åœ¨ä½ èŒä¸šç”Ÿæ¶¯çš„æ—©æœŸã€‚æ¯«æ— ç–‘é—®ï¼Œåšåˆ°è¿™ä¸€ç‚¹çš„æœ€å¥½æ–¹æ³•å°±æ˜¯<strong>å°½å…¨åŠ›</strong>ã€‚ ï¼ˆå¹¶ä¸”è¯·è®°ä½ï¼Œä½ å¿…é¡»åœ¨ä»¥åçš„æŸä¸ªæ—¶å€™å›æŠ¥ï¼ï¼‰ æœ€åï¼Œè®°ä½è¦èŠ±æ—¶é—´ä¸æ”¯æŒä½ æŠ±è´Ÿçš„ç§¯æçš„äººåœ¨ä¸€èµ·ã€‚</p><h1 id="12-ä½ é€šè¿‡æ‹¥æœ‰ä¸œè¥¿æ¥è‡´å¯Œ"><a href="#12-ä½ é€šè¿‡æ‹¥æœ‰ä¸œè¥¿æ¥è‡´å¯Œ" class="headerlink" title="12 ä½ é€šè¿‡æ‹¥æœ‰ä¸œè¥¿æ¥è‡´å¯Œ"></a>12 ä½ é€šè¿‡æ‹¥æœ‰ä¸œè¥¿æ¥è‡´å¯Œ</h1><p>ç«¥å¹´æ—¶ä»£ï¼Œæˆ‘å¯¹ç»æµæœ€å¤§çš„è¯¯è§£æ˜¯ï¼Œäººä»¬åˆ©ç”¨é«˜è–ªæ¥è‡´å¯Œã€‚è™½ç„¶æœ‰ä¸€äº›ä¾‹å¤– - ä¾‹å¦‚è‰ºäºº - ä½†æ˜¯åœ¨ç¦å¸ƒæ–¯æ¦œå•çš„å†å²ä¸Šï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•äººæ˜¯é å·¥èµ„ä¸Šæ¦œçš„ã€‚</p><p><strong>é€šè¿‡æ‹¥æœ‰ä»·å€¼å¯ä»¥è¿…é€Ÿå¢é•¿çš„ä¸œè¥¿</strong>ï¼Œä½ å˜å¾—çœŸæ­£å¯Œè£•èµ·æ¥ã€‚ </p><p>è¿™å¯ä»¥æ˜¯ä¸€éƒ¨åˆ†ç”Ÿæ„ï¼Œæˆ¿åœ°äº§ï¼Œè‡ªç„¶èµ„æºï¼ŒçŸ¥è¯†äº§æƒæˆ–å…¶ä»–ç±»ä¼¼ä¸œè¥¿ã€‚ä½†ä¸ç®¡æ€æ ·ï¼Œä½ éœ€è¦æ‹¥æœ‰è¿™äº›ä¸œè¥¿çš„è‚¡ä»½ï¼Œè€Œä¸ä»…ä»…æ˜¯å–æ‰ä½ çš„æ—¶é—´ã€‚<strong>æ—¶é—´åªèƒ½çº¿æ€§å¢é•¿</strong>ã€‚ ä½¿ä¸œè¥¿ä»·å€¼è¿…é€Ÿå¢é•¿çš„æœ€å¥½æ–¹æ³•æ˜¯<strong>å¤§è§„æ¨¡åˆ›é€ äººä»¬æƒ³è¦çš„ä¸œè¥¿</strong>ã€‚</p><h1 id="13-è‡ªæˆ‘é©±åŠ¨"><a href="#13-è‡ªæˆ‘é©±åŠ¨" class="headerlink" title="13. è‡ªæˆ‘é©±åŠ¨"></a>13. è‡ªæˆ‘é©±åŠ¨</h1><p>å¤§å¤šæ•°äººæ˜¯ä¸»è¦é å¤–éƒ¨é©±åŠ¨çš„;ä»–ä»¬åšäº‹ï¼Œæ˜¯å› ä¸ºä»–ä»¬æƒ³è¦è®©åˆ«äººä½©æœã€‚è¿™ä¹ˆåšæœ‰å¾ˆå¤šä¸å¥½çš„åŸå› ï¼Œä½†è¿™æœ‰ä¸¤ä¸ªç‚¹æœ€é‡è¦ã€‚</p><p>é¦–å…ˆï¼Œä½ ä¼šå»åšå¤§å®¶è¾¾æˆå…±è¯†çš„æƒ³æ³•å’Œè¾¾æˆå…±è¯†çš„èŒä¸šã€‚ä½ ä¼šéå¸¸å…³å¿ƒ - è¿œæ¯”æ¯”ä½ æ„è¯†åˆ°çš„è¦å¤šå¾—å¤š - å…¶ä»–äººæ˜¯å¦è®¤ä¸ºä½ åšçš„æ˜¯æ­£ç¡®çš„äº‹æƒ…ã€‚è¿™å¯èƒ½ä¼šé˜»æ­¢ä½ åšä¸€äº›çœŸæ­£æœ‰è¶£çš„å·¥ä½œï¼Œå³ä½¿ä½ æœ€ç»ˆå†³å®šè¿™æ ·åšï¼Œå…¶ä»–äººä¹Ÿå¯èƒ½æ—©å·²è¿™æ ·åšäº†ã€‚</p><p>å…¶æ¬¡ï¼Œä½ é€šå¸¸ä¼šå¯¹é£é™©åˆ¤æ–­é”™è¯¯ã€‚ä½ ä¼šéå¸¸ä¸“æ³¨äºè·Ÿä¸Šå…¶ä»–äººï¼Œåœ¨å¯¹æŠ—ç«äº‰ä¸­ä¸è‡³äºè½åï¼Œç”šè‡³éš¾ä»¥å®¹å¿çŸ­æœŸæš‚æ—¶æ€§çš„è½åã€‚</p><p> èªæ˜çš„äººä¼¼ä¹ç‰¹åˆ«å®¹æ˜“å—åˆ°å¤–éƒ¨é©±åŠ¨è¡Œä¸ºçš„å½±å“ã€‚è¦æ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒè™½ç„¶æ˜¯æœ‰å¸®åŠ©çš„ï¼Œä½†æ˜¯æå…¶æœ‰é™ã€‚ä½ å¯èƒ½å¿…é¡»è¶…çº§åŠªåŠ›å·¥ä½œï¼Œæ‰èƒ½ä¸é™·å…¥æ¨¡ä»¿åˆ«äººçš„é™·é˜±ã€‚</p><p>æˆ‘è®¤è¯†çš„æœ€æˆåŠŸçš„äººä¸»è¦æ˜¯è‡ªæˆ‘é©±åŠ¨çš„ï¼›++<strong>ä»–ä»¬åšä»–ä»¬æ‰€åšçš„äº‹æƒ…ï¼Œæ¥è®©è‡ªå·±ä½©æœ(impress themselved)ï¼Œå› ä¸ºä»–ä»¬è§‰å¾—è‡ªå·±æœ‰ä½¿å‘½å»æ”¹å˜è¿™ä¸ªä¸–ç•Œã€‚</strong>++</p><p>å½“ä½ èµšåˆ°è¶³å¤Ÿçš„é’±ï¼Œå¯ä»¥æƒ³ä¹°ä»€ä¹ˆå°±ä¹°ä»€ä¹ˆï¼Œå¹¶è·å¾—è¶³å¤Ÿçš„ç¤¾ä¼šåœ°ä½åï¼Œæ‹¥æœ‰çš„æ›´å¤šå°±ä¸å†æœ‰è¶£äº†ã€‚</p><p>è‡ªæˆ‘é©±åŠ¨æ˜¯æˆ‘æ‰€çŸ¥é“çš„å”¯ä¸€èƒ½å¤ŸæŒç»­æ¨åŠ¨ä½ è¾¾åˆ°æ›´é«˜æ°´å¹³çš„åŠ›é‡ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€ä¸ªäººçš„åŠ¨æœºé—®é¢˜éå¸¸é‡è¦ã€‚è¿™æ˜¯æˆ‘å°è¯•äº†è§£ä¸€ä¸ªäººçš„ç¬¬ä¸€ä»¶äº‹ã€‚æ­£ç¡®çš„åŠ¨æœºå¾ˆéš¾ç”¨ä¸€å¥—è§„åˆ™æ¥å®šä¹‰ï¼Œä½†æ˜¯å½“ä½ è§åˆ°å®ƒæ—¶ï¼Œä½ å°±ä¼šçŸ¥é“ã€‚</p><p>åœ¨è¿™ä»¶äº‹ä¸Šï¼Œæ°è¥¿å¡Â·åˆ©æ–‡æ–¯é¡¿å’Œä¿ç½—Â·æ ¼é›·å„å§†æ˜¯æˆ‘çš„æ ‡æ†ã€‚ YCåœ¨æœ€åˆå‡ å¹´è¢«å¾ˆå¤šäººå˜²ç¬‘ï¼Œåœ¨ä»–ä»¬åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå‡ ä¹æ²¡æœ‰äººè®¤ä¸ºä»–ä»¬ä¼šå–å¾—æˆåŠŸã€‚ä½†æ˜¯ä»–ä»¬è®¤ä¸ºï¼Œå¦‚æœåšæˆäº†ï¼Œè¿™ä»¶äº‹ä¼šå¯¹ä¸–ç•Œå°†éå¸¸æœ‰å¥½å¤„ã€‚ä»–ä»¬å–œæ¬¢å¸®åŠ©äººä»¬ï¼Œä»–ä»¬ç›¸ä¿¡ä»–ä»¬çš„æ–°æ¨¡å¼æ¯”ç°æœ‰çš„æ¨¡å¼æ›´å¥½ã€‚</p><p>æœ€ç»ˆï¼Œä½ å¯¹æˆåŠŸçš„å®šä¹‰å°†ä¼šæ˜¯ï¼Œåœ¨å¯¹ä½ æ¥è¯´é‡è¦çš„é¢†åŸŸä¸­ï¼Œä½œå‡ºå‡ºè‰²çš„å·¥ä½œã€‚ä½ è¶Šæ—©å¼€å§‹æœè¿™ä¸ªæ–¹å‘åŠªåŠ›ï¼Œä½ å°±èƒ½èµ°çš„è¶Šè¿œã€‚å¦‚æœä½ åšçš„äº‹æƒ…ä¸è®©ä½ ç—´è¿·ï¼Œä½ å°†å¾ˆéš¾è·å¾—å·¨å¤§çš„æˆåŠŸã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="http://blog.samaltman.com/how-to-be-successful" target="_blank" rel="noopener">http://blog.samaltman.com/how-to-be-successful</a></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
            <tag> Sam Altman </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ›é€ ä¼°å€¼ä¸Šäº¿çš„å…¬å¸çš„æ–¹å¼ä»¬(share)</title>
      <link href="/%E5%88%9B%E9%80%A0%E4%BC%B0%E5%80%BC%E4%B8%8A%E4%BA%BF%E7%9A%84%E5%85%AC%E5%8F%B8%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BB%AC-share/"/>
      <url>/%E5%88%9B%E9%80%A0%E4%BC%B0%E5%80%BC%E4%B8%8A%E4%BA%BF%E7%9A%84%E5%85%AC%E5%8F%B8%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BB%AC-share/</url>
      
        <content type="html"><![CDATA[<p>çº¯åˆ†äº«ï¼Œåªæ˜¯è§‰å¾—è¿™å‡ ç¯‡æ–‡ç« å®åœ¨æ˜¯å¤ªæœ‰æ„æ€ï¼Œä½œè€…2014å¹´10æœˆä»½å†™äº†ç¬¬ä¸€ç¯‡ï¼Œ11æœˆå†™äº†ç¬¬äºŒç¯‡ï¼Œç„¶åå†2019å¹´åˆå†åº¦æ€è€ƒï¼Œçœ‹äº†ä¸‹è‡ªå·±çš„æ€è·¯æ˜¯å¦è¿˜æ˜¯æ­£ç¡®çš„ï¼Œæ•´ä¸ªè„‰ç»œè¶…çº§æ¸…æ™°ã€‚</p><p>æ¯ç¯‡æ–‡ç« åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨è‡ªå·±çš„æ›´ä¸ºæˆç†Ÿçš„è®¤çŸ¥çš„åŸºç¡€ä¸Šå¯¹äºè¿ä½œæ–¹å¼è¿›è¡Œæ›´ç»†çš„æ‹†åˆ†ï¼Œå‡è®¾æˆ‘ä»¬è¦åšä¸€ä¸ªæ¯å¹´æ”¶å…¥ä¸€äº¿ç¾å…ƒçš„å…¬å¸ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä½•ç§æ–¹å¼è¿›è¡Œç›ˆåˆ©å‘¢ï¼Ÿ </p><ul><li>1,000 ä¸ªä¼ä¸šç”¨æˆ·ï¼Œæ¯å®¶æ¯å¹´ä»˜ç»™ä½ 10ä¸‡ç¾å…ƒ</li><li>10,000ä¸ªä¸­ç­‰å¤§å°å…¬å¸ï¼Œæ¯å¹´ä»˜1ä¸‡ç¾å…ƒ</li><li>100,000ä¸ªå°å•†æˆ·ï¼Œæ¯å¹´ä»˜1000ç¾å…ƒ</li><li>1,000,000ä¸ªäººç”¨æˆ·ï¼Œæ¯å¹´æ¯äººä»˜100ç¾å…ƒ</li><li>10,000,000ä¸ªäººç”¨æˆ·ï¼Œé€šè¿‡å¹¿å‘Šä»æ¯äººè·å¾—10ç¾å…ƒ</li></ul><p>Open questions: å“ªä¸€ç§æ›´é€‚åˆè‡ªå·±å‘¢ï¼Ÿlol</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>ä¸æ–­æ›´æ–°ï¼Œå°¤å…¶æ˜¯äº”å¹´ä»¥åçš„æ›´æ–°å¾ˆå‘äººèº«çœå•Šï¼ </p><ol><li><p><a href="http://christophjanz.blogspot.com/2014/10/five-ways-to-build-100-million-business.html" target="_blank" rel="noopener">http://christophjanz.blogspot.com/2014/10/five-ways-to-build-100-million-business.html</a></p></li><li><p><a href="http://christophjanz.blogspot.com/2014/11/three-more-ways-to-build-100-million.html" target="_blank" rel="noopener">http://christophjanz.blogspot.com/2014/11/three-more-ways-to-build-100-million.html</a></p></li><li><p><a href="http://christophjanz.blogspot.com/2019/" target="_blank" rel="noopener">http://christophjanz.blogspot.com/2019/</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thought </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº2019</title>
      <link href="/%E5%85%B3%E4%BA%8E2019/"/>
      <url>/%E5%85%B3%E4%BA%8E2019/</url>
      
        <content type="html"><![CDATA[<p>å†™äº2018å¹´åº•</p><p>æŒ‰ç…§ä¸€èˆ¬çš„èŠ‚å¥ï¼Œæ¯å¹´å¹´æœ«æ€»ä¼šæœ‰å¯¹äºè¿™ä¸€å¹´çš„åæ€ï¼Œå“€å©‰/ åæ‚”/ å¹æ¯/ é—æ†¾ æˆ–è€…æ˜¯ å¯¹äºé—ªå…‰ç‚¹çš„æ¿€åŠ¨/ è‡ªè±ª/ å–œæ‚¦ã€‚ç„¶åè¡¨ä¸€æ³¢å†³å¿ƒï¼Œç«‹ä¸€å †flagï¼ŒæœŸç›¼åœ¨2019å¹´ä¸çŸ¥é“æ€ä¹ˆçš„è‡ªå·±å°±èƒ½å¤Ÿæœ‰ç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚ </p><p>è¿™æ¬¡å€’æ˜¯ä¸æƒ³è¿™ä¹ˆå†™äº†ï¼Œæ„Ÿè§‰ï¼Œæˆ‘ä»¬å¯¹äºæˆåŠŸæˆ–è€…å¤±è´¥çš„å½’å› å¾€å¾€æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„å½’å› ï¼Œå¾€å¾€å’Œæ—è§‚è€…çš„è®¤çŸ¥/ è§‚ç‚¹æœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚ä¹ æƒ¯æ€§åœ°è®¤ä¸ºæˆåŠŸæ˜¯å› ä¸ºåŠªåŠ›ï¼Œå¤±è´¥æ˜¯å› ä¸ºå®¢è§‚å› ç´ çš„ä¸å¯æŠ—ã€‚äº¦æˆ–è€…ï¼Œå½’çš„å› è¿˜æ˜¯æµ®äºè¡¨é¢ï¼Œæ‹¿ç€ä¸€ä¸ªæœå½“åšå› ï¼Œè‡ªç„¶æ— æ³•æ”¹å˜çœŸæ­£çš„æœäº†ã€‚é—®é¢˜æ¥äº†ï¼Œåˆ°åº•æ˜¯è‡ªä¸Šè€Œä¸‹ï¼Œä»ä½ å¸Œæœ›çš„å¤§ç›®æ ‡æ¥å¼€å§‹æƒ³è¿™äº›é—®é¢˜ï¼›è¿˜æ˜¯è‡ªä¸‹è€Œä¸Šï¼Œå°½åŠ›å»å‰–æè‡ªå·±æ¥çš„å®åœ¨ï¼Ÿ  </p><p>ç°åœ¨çš„è‡ªå·±ï¼Œè§‰å¾—æ˜¯ï¼Œè‡ªä¸‹è€Œä¸Š(è‡ªå·±)æ˜¯æºï¼Œè‡ªç„¶æ¥å¾—æ›´å®åœ¨ï¼Œèƒ½å¤Ÿçœ‹æ¸…è‡ªå·±è‡ªç„¶èƒ½æŠŠå¤§éƒ¨åˆ†é—®é¢˜éƒ½è§£å†³æ‰ï¼›åªæ˜¯å› ä¸ºç¼ºä¹è¿™ç§é¢å¯¹æœ¬æˆ‘çš„èƒ½åŠ›ï¼Œä¸å¾—ä¸é€‰æ‹©è‡ªä¸Šè€Œä¸‹çš„æ–¹å¼â€”â€”æ— æ³•ç›´æ¥çœ‹æ¸…æœ¬æˆ‘ï¼Œé‚£åªèƒ½é€šè¿‡é•œé¢éšéšçº¦çº¦çª¥æ¢ä¸‹è‡ªå·±åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„å§ã€‚  </p><p>æ‰€ä»¥ï¼Œåœ¨åŠªåŠ›äº†Næ¬¡å‰–æè‡ªå·±å¤±è´¥ä»¥åï¼Œé€‰æ‹©å†™è¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼Œæå‡ºè¿™æ ·ä¸€äº›é—®é¢˜ï¼Œæ˜ç™½è‡ªå·±å†…å¿ƒçš„æ¸´æœ›ï¼Œæ¯å‘¨éƒ½çœ‹ä¸€çœ‹ï¼Œæ˜¯å¦èµ°å¾—è¿‘ä¸€äº›äº†ã€‚ </p><p>HHHHHï¼Œè¿™é‡Œåªåˆ—é—®é¢˜ ğŸ˜‰ æ¬¢è¿çº¿ä¸‹ä¸€èµ·èŠå¤©ï¼Œä¸€èµ·æ¢ç´¢å“‡ï¼ å¾ˆå–œæ¬¢åˆ†äº«è¿™äº›çš„æ„Ÿè§‰~ (Email: <a href="mailto:stone2paul@gmail.com">stone2paul@gmail.com</a>) </p><p>é—®é¢˜ä¸»è¦åˆ†ä¸ºä¸ƒä¸ªéƒ¨åˆ†ï¼šèŒåœºã€äººé™…å…³ç³»ã€å¥åº·ã€è´¢åŠ¡ã€ä¸ªäººå‘å±•ã€ç¯å¢ƒå’Œç”Ÿæ´»æ–¹å¼ã€‚ </p><h1 id="1-èŒåœº"><a href="#1-èŒåœº" class="headerlink" title="1.èŒåœº"></a>1.èŒåœº</h1><h4 id="1-1-ä½ å°†å¦‚ä½•è°‹ç”Ÿï¼Ÿ"><a href="#1-1-ä½ å°†å¦‚ä½•è°‹ç”Ÿï¼Ÿ" class="headerlink" title="1.1 ä½ å°†å¦‚ä½•è°‹ç”Ÿï¼Ÿ"></a>1.1 ä½ å°†å¦‚ä½•è°‹ç”Ÿï¼Ÿ</h4><h4 id="1-2-åœ¨ä½ çš„èŒä¸šæˆ–äº‹ä¸šä¸­ï¼Œä½ è®¤ä¸ºè‡ªå·±å¤„äºä»€ä¹ˆæ°´å¹³ï¼Ÿ"><a href="#1-2-åœ¨ä½ çš„èŒä¸šæˆ–äº‹ä¸šä¸­ï¼Œä½ è®¤ä¸ºè‡ªå·±å¤„äºä»€ä¹ˆæ°´å¹³ï¼Ÿ" class="headerlink" title="1.2 åœ¨ä½ çš„èŒä¸šæˆ–äº‹ä¸šä¸­ï¼Œä½ è®¤ä¸ºè‡ªå·±å¤„äºä»€ä¹ˆæ°´å¹³ï¼Ÿ"></a>1.2 åœ¨ä½ çš„èŒä¸šæˆ–äº‹ä¸šä¸­ï¼Œä½ è®¤ä¸ºè‡ªå·±å¤„äºä»€ä¹ˆæ°´å¹³ï¼Ÿ</h4><h4 id="1-3-åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ ä¼šå–å¾—ä»€ä¹ˆæˆå°±æ¥è¯æ˜ä½ å¯¹è‡ªå·±æ°´å¹³çš„åˆ¤æ–­æ˜¯åˆç†çš„ï¼Ÿ"><a href="#1-3-åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ ä¼šå–å¾—ä»€ä¹ˆæˆå°±æ¥è¯æ˜ä½ å¯¹è‡ªå·±æ°´å¹³çš„åˆ¤æ–­æ˜¯åˆç†çš„ï¼Ÿ" class="headerlink" title="1.3 åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ ä¼šå–å¾—ä»€ä¹ˆæˆå°±æ¥è¯æ˜ä½ å¯¹è‡ªå·±æ°´å¹³çš„åˆ¤æ–­æ˜¯åˆç†çš„ï¼Ÿ"></a>1.3 åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ ä¼šå–å¾—ä»€ä¹ˆæˆå°±æ¥è¯æ˜ä½ å¯¹è‡ªå·±æ°´å¹³çš„åˆ¤æ–­æ˜¯åˆç†çš„ï¼Ÿ</h4><h4 id="1-4-ä½ å…‹æœäº†å“ªäº›éšœç¢ï¼Ÿ"><a href="#1-4-ä½ å…‹æœäº†å“ªäº›éšœç¢ï¼Ÿ" class="headerlink" title="1.4 ä½ å…‹æœäº†å“ªäº›éšœç¢ï¼Ÿ"></a>1.4 ä½ å…‹æœäº†å“ªäº›éšœç¢ï¼Ÿ</h4><h4 id="1-5-ä½ çš„èŒä¸šç†æƒ³ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³å®ç°ä»€ä¹ˆï¼Ÿ"><a href="#1-5-ä½ çš„èŒä¸šç†æƒ³ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³å®ç°ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.5 ä½ çš„èŒä¸šç†æƒ³ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³å®ç°ä»€ä¹ˆï¼Ÿ"></a>1.5 ä½ çš„èŒä¸šç†æƒ³ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³å®ç°ä»€ä¹ˆï¼Ÿ</h4><h1 id="2-äººé™…å…³ç³»"><a href="#2-äººé™…å…³ç³»" class="headerlink" title="2. äººé™…å…³ç³»"></a>2. äººé™…å…³ç³»</h1><h4 id="2-1-äº”å¹´åä½ çš„æ„Ÿæƒ…çŠ¶å†µå¦‚ä½•ï¼Ÿ"><a href="#2-1-äº”å¹´åä½ çš„æ„Ÿæƒ…çŠ¶å†µå¦‚ä½•ï¼Ÿ" class="headerlink" title="2.1 äº”å¹´åä½ çš„æ„Ÿæƒ…çŠ¶å†µå¦‚ä½•ï¼Ÿ"></a>2.1 äº”å¹´åä½ çš„æ„Ÿæƒ…çŠ¶å†µå¦‚ä½•ï¼Ÿ</h4><h4 id="2-2-ä»ç°åœ¨åˆ°äº”å¹´åä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜ä½ å¯¹æœªæ¥çš„é¢„æœŸæ˜¯åˆç†çš„ï¼Ÿ"><a href="#2-2-ä»ç°åœ¨åˆ°äº”å¹´åä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜ä½ å¯¹æœªæ¥çš„é¢„æœŸæ˜¯åˆç†çš„ï¼Ÿ" class="headerlink" title="2.2 ä»ç°åœ¨åˆ°äº”å¹´åä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜ä½ å¯¹æœªæ¥çš„é¢„æœŸæ˜¯åˆç†çš„ï¼Ÿ"></a>2.2 ä»ç°åœ¨åˆ°äº”å¹´åä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜ä½ å¯¹æœªæ¥çš„é¢„æœŸæ˜¯åˆç†çš„ï¼Ÿ</h4><h4 id="2-3-ä½ äº¤äº†å“ªäº›æ–°æœ‹å‹ï¼Ÿä»–ä»¬æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ˜¯ä»€ä¹ˆè®©ä½ æƒ³å’Œä»–ä»¬æˆä¸ºæœ‹å‹ï¼Ÿ"><a href="#2-3-ä½ äº¤äº†å“ªäº›æ–°æœ‹å‹ï¼Ÿä»–ä»¬æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ˜¯ä»€ä¹ˆè®©ä½ æƒ³å’Œä»–ä»¬æˆä¸ºæœ‹å‹ï¼Ÿ" class="headerlink" title="2.3 ä½ äº¤äº†å“ªäº›æ–°æœ‹å‹ï¼Ÿä»–ä»¬æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ˜¯ä»€ä¹ˆè®©ä½ æƒ³å’Œä»–ä»¬æˆä¸ºæœ‹å‹ï¼Ÿ"></a>2.3 ä½ äº¤äº†å“ªäº›æ–°æœ‹å‹ï¼Ÿä»–ä»¬æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ˜¯ä»€ä¹ˆè®©ä½ æƒ³å’Œä»–ä»¬æˆä¸ºæœ‹å‹ï¼Ÿ</h4><h4 id="2-4-ä½ å…‹æœäº†å“ªäº›äººé™…å…³ç³»ä¸Šçš„éšœç¢ï¼Ÿ"><a href="#2-4-ä½ å…‹æœäº†å“ªäº›äººé™…å…³ç³»ä¸Šçš„éšœç¢ï¼Ÿ" class="headerlink" title="2.4 ä½ å…‹æœäº†å“ªäº›äººé™…å…³ç³»ä¸Šçš„éšœç¢ï¼Ÿ"></a>2.4 ä½ å…‹æœäº†å“ªäº›äººé™…å…³ç³»ä¸Šçš„éšœç¢ï¼Ÿ</h4><h4 id="2-5-ä½ çš„å®¶åº­å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#2-5-ä½ çš„å®¶åº­å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="2.5 ä½ çš„å®¶åº­å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>2.5 ä½ çš„å®¶åº­å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h4><h4 id="2-6-ä½ çš„å„ç§å…³ç³»ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿ"><a href="#2-6-ä½ çš„å„ç§å…³ç³»ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.6 ä½ çš„å„ç§å…³ç³»ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿ"></a>2.6 ä½ çš„å„ç§å…³ç³»ä¸­è¿˜ç¼ºå°‘ä»€ä¹ˆï¼Ÿ</h4><h1 id="3-å¥åº·"><a href="#3-å¥åº·" class="headerlink" title="3. å¥åº·"></a>3. å¥åº·</h1><h4 id="3-1-ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦‚ä½•å®‰æ’è‡ªå·±çš„é¥®é£Ÿç»“æ„çš„ï¼Ÿ"><a href="#3-1-ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦‚ä½•å®‰æ’è‡ªå·±çš„é¥®é£Ÿç»“æ„çš„ï¼Ÿ" class="headerlink" title="3.1 ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦‚ä½•å®‰æ’è‡ªå·±çš„é¥®é£Ÿç»“æ„çš„ï¼Ÿ"></a>3.1 ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦‚ä½•å®‰æ’è‡ªå·±çš„é¥®é£Ÿç»“æ„çš„ï¼Ÿ</h4><h4 id="3-2-ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦è¿›è¡Œäº†é”»ç‚¼ï¼Ÿ"><a href="#3-2-ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦è¿›è¡Œäº†é”»ç‚¼ï¼Ÿ" class="headerlink" title="3.2 ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦è¿›è¡Œäº†é”»ç‚¼ï¼Ÿ"></a>3.2 ä¸ºäº†ä¿æŒæˆ–æ”¹å–„ä½ çš„å¥åº·ï¼Œä½ æ˜¯å¦è¿›è¡Œäº†é”»ç‚¼ï¼Ÿ</h4><h4 id="3-3-ä½ æ”¹å–„å¥åº·çš„æ„¿æœ›æ˜¯å¦‚ä½•å½±å“ä½ ç”Ÿæ´»ä¸­çš„é€‰æ‹©çš„ï¼Ÿ"><a href="#3-3-ä½ æ”¹å–„å¥åº·çš„æ„¿æœ›æ˜¯å¦‚ä½•å½±å“ä½ ç”Ÿæ´»ä¸­çš„é€‰æ‹©çš„ï¼Ÿ" class="headerlink" title="3.3 ä½ æ”¹å–„å¥åº·çš„æ„¿æœ›æ˜¯å¦‚ä½•å½±å“ä½ ç”Ÿæ´»ä¸­çš„é€‰æ‹©çš„ï¼Ÿ"></a>3.3 ä½ æ”¹å–„å¥åº·çš„æ„¿æœ›æ˜¯å¦‚ä½•å½±å“ä½ ç”Ÿæ´»ä¸­çš„é€‰æ‹©çš„ï¼Ÿ</h4><h4 id="3-4-ä½ å…‹æœäº†å“ªäº›ä¸»è¦éšœç¢ï¼Ÿ"><a href="#3-4-ä½ å…‹æœäº†å“ªäº›ä¸»è¦éšœç¢ï¼Ÿ" class="headerlink" title="3.4 ä½ å…‹æœäº†å“ªäº›ä¸»è¦éšœç¢ï¼Ÿ"></a>3.4 ä½ å…‹æœäº†å“ªäº›ä¸»è¦éšœç¢ï¼Ÿ</h4><h4 id="3-5-å°±ä½ çš„å¥åº·çŠ¶å†µè€Œè¨€ï¼Œä½ è¿˜éœ€è¦è¾¾åˆ°å“ªäº›ç›®æ ‡ï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³è¦å®ç°ä»€ä¹ˆï¼Ÿ"><a href="#3-5-å°±ä½ çš„å¥åº·çŠ¶å†µè€Œè¨€ï¼Œä½ è¿˜éœ€è¦è¾¾åˆ°å“ªäº›ç›®æ ‡ï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³è¦å®ç°ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3.5 å°±ä½ çš„å¥åº·çŠ¶å†µè€Œè¨€ï¼Œä½ è¿˜éœ€è¦è¾¾åˆ°å“ªäº›ç›®æ ‡ï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³è¦å®ç°ä»€ä¹ˆï¼Ÿ"></a>3.5 å°±ä½ çš„å¥åº·çŠ¶å†µè€Œè¨€ï¼Œä½ è¿˜éœ€è¦è¾¾åˆ°å“ªäº›ç›®æ ‡ï¼Ÿæˆ–è€…ï¼Œä½ ä¸‹ä¸€æ­¥æƒ³è¦å®ç°ä»€ä¹ˆï¼Ÿ</h4><h1 id="4-è´¢åŠ¡"><a href="#4-è´¢åŠ¡" class="headerlink" title="4. è´¢åŠ¡"></a>4. è´¢åŠ¡</h1><h4 id="4-1-ä½ çš„ä¸ªäººèµ„äº§çŠ¶å†µï¼ˆèµ„äº§ã€è´Ÿå€ºã€ç°é‡‘æµï¼‰æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#4-1-ä½ çš„ä¸ªäººèµ„äº§çŠ¶å†µï¼ˆèµ„äº§ã€è´Ÿå€ºã€ç°é‡‘æµï¼‰æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="4.1 ä½ çš„ä¸ªäººèµ„äº§çŠ¶å†µï¼ˆèµ„äº§ã€è´Ÿå€ºã€ç°é‡‘æµï¼‰æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>4.1 ä½ çš„ä¸ªäººèµ„äº§çŠ¶å†µï¼ˆèµ„äº§ã€è´Ÿå€ºã€ç°é‡‘æµï¼‰æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h4><h4 id="4-2-æ— è®ºä½ çš„è´¢åŠ¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼ˆæŒæœ‰ç°é‡‘ã€åº”æ€¥åŸºé‡‘ã€ä¸ºé€€ä¼‘åšå‡†å¤‡ã€ä¸ºå¤§å­¦æ”’å­¦è´¹ã€å†ä¹°ä¸€å¥—æˆ¿ç­‰ç­‰ï¼‰ï¼Œä½ éƒ½é‡‡å–äº†å“ªäº›æªæ–½ï¼Ÿ"><a href="#4-2-æ— è®ºä½ çš„è´¢åŠ¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼ˆæŒæœ‰ç°é‡‘ã€åº”æ€¥åŸºé‡‘ã€ä¸ºé€€ä¼‘åšå‡†å¤‡ã€ä¸ºå¤§å­¦æ”’å­¦è´¹ã€å†ä¹°ä¸€å¥—æˆ¿ç­‰ç­‰ï¼‰ï¼Œä½ éƒ½é‡‡å–äº†å“ªäº›æªæ–½ï¼Ÿ" class="headerlink" title="4.2 æ— è®ºä½ çš„è´¢åŠ¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼ˆæŒæœ‰ç°é‡‘ã€åº”æ€¥åŸºé‡‘ã€ä¸ºé€€ä¼‘åšå‡†å¤‡ã€ä¸ºå¤§å­¦æ”’å­¦è´¹ã€å†ä¹°ä¸€å¥—æˆ¿ç­‰ç­‰ï¼‰ï¼Œä½ éƒ½é‡‡å–äº†å“ªäº›æªæ–½ï¼Ÿ"></a>4.2 æ— è®ºä½ çš„è´¢åŠ¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼ˆæŒæœ‰ç°é‡‘ã€åº”æ€¥åŸºé‡‘ã€ä¸ºé€€ä¼‘åšå‡†å¤‡ã€ä¸ºå¤§å­¦æ”’å­¦è´¹ã€å†ä¹°ä¸€å¥—æˆ¿ç­‰ç­‰ï¼‰ï¼Œä½ éƒ½é‡‡å–äº†å“ªäº›æªæ–½ï¼Ÿ</h4><h4 id="4-3-ä½ æ¯ä¸ªæœˆèµšå¤šå°‘é’±ï¼Ÿ"><a href="#4-3-ä½ æ¯ä¸ªæœˆèµšå¤šå°‘é’±ï¼Ÿ" class="headerlink" title="4.3 ä½ æ¯ä¸ªæœˆèµšå¤šå°‘é’±ï¼Ÿ"></a>4.3 ä½ æ¯ä¸ªæœˆèµšå¤šå°‘é’±ï¼Ÿ</h4><h4 id="4-4-ä»ç°åœ¨åˆ°å°†æ¥ä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜è¿™äº›æ”¶å…¥æ˜¯åˆç†çš„ï¼Ÿ"><a href="#4-4-ä»ç°åœ¨åˆ°å°†æ¥ä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜è¿™äº›æ”¶å…¥æ˜¯åˆç†çš„ï¼Ÿ" class="headerlink" title="4.4 ä»ç°åœ¨åˆ°å°†æ¥ä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜è¿™äº›æ”¶å…¥æ˜¯åˆç†çš„ï¼Ÿ"></a>4.4 ä»ç°åœ¨åˆ°å°†æ¥ä¼šå‘ç”Ÿä»€ä¹ˆæ¥è¯æ˜è¿™äº›æ”¶å…¥æ˜¯åˆç†çš„ï¼Ÿ</h4><h4 id="4-5-ä»ç°åœ¨èµ·çš„äº”å¹´å†…ï¼Œä½ ä¼šè¾¾åˆ°å“ªäº›é‡è¦çš„è´¢åŠ¡é‡Œç¨‹ç¢‘ï¼Ÿ"><a href="#4-5-ä»ç°åœ¨èµ·çš„äº”å¹´å†…ï¼Œä½ ä¼šè¾¾åˆ°å“ªäº›é‡è¦çš„è´¢åŠ¡é‡Œç¨‹ç¢‘ï¼Ÿ" class="headerlink" title="4.5 ä»ç°åœ¨èµ·çš„äº”å¹´å†…ï¼Œä½ ä¼šè¾¾åˆ°å“ªäº›é‡è¦çš„è´¢åŠ¡é‡Œç¨‹ç¢‘ï¼Ÿ"></a>4.5 ä»ç°åœ¨èµ·çš„äº”å¹´å†…ï¼Œä½ ä¼šè¾¾åˆ°å“ªäº›é‡è¦çš„è´¢åŠ¡é‡Œç¨‹ç¢‘ï¼Ÿ</h4><h4 id="4-6-ä½ è¿˜æœ‰å“ªäº›è´¢åŠ¡ç›®æ ‡æœ‰å¾…å®ç°ï¼Ÿ"><a href="#4-6-ä½ è¿˜æœ‰å“ªäº›è´¢åŠ¡ç›®æ ‡æœ‰å¾…å®ç°ï¼Ÿ" class="headerlink" title="4.6 ä½ è¿˜æœ‰å“ªäº›è´¢åŠ¡ç›®æ ‡æœ‰å¾…å®ç°ï¼Ÿ"></a>4.6 ä½ è¿˜æœ‰å“ªäº›è´¢åŠ¡ç›®æ ‡æœ‰å¾…å®ç°ï¼Ÿ</h4><h1 id="5-ä¸ªäººå‘å±•"><a href="#5-ä¸ªäººå‘å±•" class="headerlink" title="5. ä¸ªäººå‘å±•"></a>5. ä¸ªäººå‘å±•</h1><h4 id="5-1-ä½ æ¯å¤©æˆ–æ¯å‘¨éƒ½ä¼šåšå“ªäº›ç²¾ç¥å®è·µï¼Ÿå®ƒä»¬æœ‰æ²¡æœ‰æˆä¸ºä½ ç”Ÿæ´»ä¸­çš„ä¸€éƒ¨åˆ†ï¼Ÿ"><a href="#5-1-ä½ æ¯å¤©æˆ–æ¯å‘¨éƒ½ä¼šåšå“ªäº›ç²¾ç¥å®è·µï¼Ÿå®ƒä»¬æœ‰æ²¡æœ‰æˆä¸ºä½ ç”Ÿæ´»ä¸­çš„ä¸€éƒ¨åˆ†ï¼Ÿ" class="headerlink" title="5.1 ä½ æ¯å¤©æˆ–æ¯å‘¨éƒ½ä¼šåšå“ªäº›ç²¾ç¥å®è·µï¼Ÿå®ƒä»¬æœ‰æ²¡æœ‰æˆä¸ºä½ ç”Ÿæ´»ä¸­çš„ä¸€éƒ¨åˆ†ï¼Ÿ"></a>5.1 ä½ æ¯å¤©æˆ–æ¯å‘¨éƒ½ä¼šåšå“ªäº›ç²¾ç¥å®è·µï¼Ÿå®ƒä»¬æœ‰æ²¡æœ‰æˆä¸ºä½ ç”Ÿæ´»ä¸­çš„ä¸€éƒ¨åˆ†ï¼Ÿ</h4><h4 id="5-2-ä½ è¿˜å­¦ä¹ äº†ä»€ä¹ˆæŠ€èƒ½ï¼Ÿ"><a href="#5-2-ä½ è¿˜å­¦ä¹ äº†ä»€ä¹ˆæŠ€èƒ½ï¼Ÿ" class="headerlink" title="5.2 ä½ è¿˜å­¦ä¹ äº†ä»€ä¹ˆæŠ€èƒ½ï¼Ÿ"></a>5.2 ä½ è¿˜å­¦ä¹ äº†ä»€ä¹ˆæŠ€èƒ½ï¼Ÿ</h4><h4 id="5-3-åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ æœ‰å“ªäº›å­¦ä¹ æœºä¼šï¼Ÿ"><a href="#5-3-åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ æœ‰å“ªäº›å­¦ä¹ æœºä¼šï¼Ÿ" class="headerlink" title="5.3 åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ æœ‰å“ªäº›å­¦ä¹ æœºä¼šï¼Ÿ"></a>5.3 åœ¨æœªæ¥çš„äº”å¹´é‡Œï¼Œä½ æœ‰å“ªäº›å­¦ä¹ æœºä¼šï¼Ÿ</h4><h4 id="5-4-ä½ å°è¯•è¿‡å“ªäº›ä¸ªäººå‘å±•å®è·µï¼Œä½†ä¸å–œæ¬¢ï¼Ÿ"><a href="#5-4-ä½ å°è¯•è¿‡å“ªäº›ä¸ªäººå‘å±•å®è·µï¼Œä½†ä¸å–œæ¬¢ï¼Ÿ" class="headerlink" title="5.4 ä½ å°è¯•è¿‡å“ªäº›ä¸ªäººå‘å±•å®è·µï¼Œä½†ä¸å–œæ¬¢ï¼Ÿ"></a>5.4 ä½ å°è¯•è¿‡å“ªäº›ä¸ªäººå‘å±•å®è·µï¼Œä½†ä¸å–œæ¬¢ï¼Ÿ</h4><h4 id="5-5-ä½ è¿›è¡Œä¸ªäººå‘å±•å®è·µçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-5-ä½ è¿›è¡Œä¸ªäººå‘å±•å®è·µçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5.5 ä½ è¿›è¡Œä¸ªäººå‘å±•å®è·µçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5.5 ä½ è¿›è¡Œä¸ªäººå‘å±•å®è·µçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="5-6-ä½ å¸Œæœ›åœ¨ä¸ªäººå‘å±•æ–¹é¢å–å¾—ä»€ä¹ˆæˆå°±ï¼Ÿ"><a href="#5-6-ä½ å¸Œæœ›åœ¨ä¸ªäººå‘å±•æ–¹é¢å–å¾—ä»€ä¹ˆæˆå°±ï¼Ÿ" class="headerlink" title="5.6 ä½ å¸Œæœ›åœ¨ä¸ªäººå‘å±•æ–¹é¢å–å¾—ä»€ä¹ˆæˆå°±ï¼Ÿ"></a>5.6 ä½ å¸Œæœ›åœ¨ä¸ªäººå‘å±•æ–¹é¢å–å¾—ä»€ä¹ˆæˆå°±ï¼Ÿ</h4><h1 id="6-ç¯å¢ƒ"><a href="#6-ç¯å¢ƒ" class="headerlink" title="6. ç¯å¢ƒ"></a>6. ç¯å¢ƒ</h1><h4 id="6-1-ä½ ä½åœ¨å“ªé‡Œï¼Ÿ"><a href="#6-1-ä½ ä½åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="6.1 ä½ ä½åœ¨å“ªé‡Œï¼Ÿ"></a>6.1 ä½ ä½åœ¨å“ªé‡Œï¼Ÿ</h4><h4 id="6-2-ä½ ä½çš„åœ°æ–¹æ°”å€™æ€ä¹ˆæ ·ï¼Ÿ"><a href="#6-2-ä½ ä½çš„åœ°æ–¹æ°”å€™æ€ä¹ˆæ ·ï¼Ÿ" class="headerlink" title="6.2 ä½ ä½çš„åœ°æ–¹æ°”å€™æ€ä¹ˆæ ·ï¼Ÿ"></a>6.2 ä½ ä½çš„åœ°æ–¹æ°”å€™æ€ä¹ˆæ ·ï¼Ÿ</h4><h4 id="6-3-æè¿°ä¸€ä¸‹ä½ çš„å®¶ã€‚æ˜¯æˆ¿å­è¿˜æ˜¯å…¬å¯“ï¼Ÿ"><a href="#6-3-æè¿°ä¸€ä¸‹ä½ çš„å®¶ã€‚æ˜¯æˆ¿å­è¿˜æ˜¯å…¬å¯“ï¼Ÿ" class="headerlink" title="6.3 æè¿°ä¸€ä¸‹ä½ çš„å®¶ã€‚æ˜¯æˆ¿å­è¿˜æ˜¯å…¬å¯“ï¼Ÿ"></a>6.3 æè¿°ä¸€ä¸‹ä½ çš„å®¶ã€‚æ˜¯æˆ¿å­è¿˜æ˜¯å…¬å¯“ï¼Ÿ</h4><h4 id="6-4-æˆ¿å­æ˜¯æ€ä¹ˆè£…ä¿®çš„ï¼Ÿ"><a href="#6-4-æˆ¿å­æ˜¯æ€ä¹ˆè£…ä¿®çš„ï¼Ÿ" class="headerlink" title="6.4 æˆ¿å­æ˜¯æ€ä¹ˆè£…ä¿®çš„ï¼Ÿ"></a>6.4 æˆ¿å­æ˜¯æ€ä¹ˆè£…ä¿®çš„ï¼Ÿ</h4><h4 id="6-5-å¦‚æœä½ ä¸€ç›´ä½åœ¨è¿™é—´æˆ¿å­é‡Œï¼Œä»æœªæ¬å®¶è¿‡ï¼Œä½ åé¢è¿˜åšäº†å“ªäº›è£…ä¿®ï¼Ÿ"><a href="#6-5-å¦‚æœä½ ä¸€ç›´ä½åœ¨è¿™é—´æˆ¿å­é‡Œï¼Œä»æœªæ¬å®¶è¿‡ï¼Œä½ åé¢è¿˜åšäº†å“ªäº›è£…ä¿®ï¼Ÿ" class="headerlink" title="6.5 å¦‚æœä½ ä¸€ç›´ä½åœ¨è¿™é—´æˆ¿å­é‡Œï¼Œä»æœªæ¬å®¶è¿‡ï¼Œä½ åé¢è¿˜åšäº†å“ªäº›è£…ä¿®ï¼Ÿ"></a>6.5 å¦‚æœä½ ä¸€ç›´ä½åœ¨è¿™é—´æˆ¿å­é‡Œï¼Œä»æœªæ¬å®¶è¿‡ï¼Œä½ åé¢è¿˜åšäº†å“ªäº›è£…ä¿®ï¼Ÿ</h4><h4 id="6-6-è°å’Œä½ ä½åœ¨ä¸€èµ·ï¼Ÿ"><a href="#6-6-è°å’Œä½ ä½åœ¨ä¸€èµ·ï¼Ÿ" class="headerlink" title="6.6 è°å’Œä½ ä½åœ¨ä¸€èµ·ï¼Ÿ"></a>6.6 è°å’Œä½ ä½åœ¨ä¸€èµ·ï¼Ÿ</h4><h1 id="7-ç”Ÿæ´»æ–¹å¼"><a href="#7-ç”Ÿæ´»æ–¹å¼" class="headerlink" title="7. ç”Ÿæ´»æ–¹å¼"></a>7. ç”Ÿæ´»æ–¹å¼</h1><h4 id="7-1-ä½ å‘¨æœ«ã€æ™šä¸Šã€ä¸‹ç­åéƒ½æœ‰ä»€ä¹ˆå¨±ä¹æˆ–è€…æ¶ˆé£æ´»åŠ¨ï¼Ÿ"><a href="#7-1-ä½ å‘¨æœ«ã€æ™šä¸Šã€ä¸‹ç­åéƒ½æœ‰ä»€ä¹ˆå¨±ä¹æˆ–è€…æ¶ˆé£æ´»åŠ¨ï¼Ÿ" class="headerlink" title="7.1 ä½ å‘¨æœ«ã€æ™šä¸Šã€ä¸‹ç­åéƒ½æœ‰ä»€ä¹ˆå¨±ä¹æˆ–è€…æ¶ˆé£æ´»åŠ¨ï¼Ÿ"></a>7.1 ä½ å‘¨æœ«ã€æ™šä¸Šã€ä¸‹ç­åéƒ½æœ‰ä»€ä¹ˆå¨±ä¹æˆ–è€…æ¶ˆé£æ´»åŠ¨ï¼Ÿ</h4><h4 id="7-2-ä½ æœ‰æ±½è½¦å—ï¼Ÿå“ªç§æ±½è½¦ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä½ æœ‰ä»€ä¹ˆæ‰“ç®—ï¼Ÿ"><a href="#7-2-ä½ æœ‰æ±½è½¦å—ï¼Ÿå“ªç§æ±½è½¦ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä½ æœ‰ä»€ä¹ˆæ‰“ç®—ï¼Ÿ" class="headerlink" title="7.2 ä½ æœ‰æ±½è½¦å—ï¼Ÿå“ªç§æ±½è½¦ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä½ æœ‰ä»€ä¹ˆæ‰“ç®—ï¼Ÿ"></a>7.2 ä½ æœ‰æ±½è½¦å—ï¼Ÿå“ªç§æ±½è½¦ï¼Ÿå¦‚æœæ²¡æœ‰ï¼Œä½ æœ‰ä»€ä¹ˆæ‰“ç®—ï¼Ÿ</h4><h4 id="7-3-ä½ å¹³æ—¶ä¸Šç­ã€ä¼‘æ¯æ—¥æˆ–å¤–å‡ºæ—¶çš„ç©¿è¡£æ‰“æ‰®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#7-3-ä½ å¹³æ—¶ä¸Šç­ã€ä¼‘æ¯æ—¥æˆ–å¤–å‡ºæ—¶çš„ç©¿è¡£æ‰“æ‰®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="7.3 ä½ å¹³æ—¶ä¸Šç­ã€ä¼‘æ¯æ—¥æˆ–å¤–å‡ºæ—¶çš„ç©¿è¡£æ‰“æ‰®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>7.3 ä½ å¹³æ—¶ä¸Šç­ã€ä¼‘æ¯æ—¥æˆ–å¤–å‡ºæ—¶çš„ç©¿è¡£æ‰“æ‰®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h4><h4 id="7-4-ä½ æœ€çè§†çš„ç‰©è´¨è´¢å¯Œæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#7-4-ä½ æœ€çè§†çš„ç‰©è´¨è´¢å¯Œæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="7.4 ä½ æœ€çè§†çš„ç‰©è´¨è´¢å¯Œæ˜¯ä»€ä¹ˆï¼Ÿ"></a>7.4 ä½ æœ€çè§†çš„ç‰©è´¨è´¢å¯Œæ˜¯ä»€ä¹ˆï¼Ÿ</h4><h4 id="7-5-ä½ å»å“ªé‡Œåº¦å‡äº†ï¼Ÿ"><a href="#7-5-ä½ å»å“ªé‡Œåº¦å‡äº†ï¼Ÿ" class="headerlink" title="7.5 ä½ å»å“ªé‡Œåº¦å‡äº†ï¼Ÿ"></a>7.5 ä½ å»å“ªé‡Œåº¦å‡äº†ï¼Ÿ</h4><h4 id="7-6-å¦‚æœä½ æœ‰å­©å­ï¼Œä½ ä¼šå’Œä»–ä»¬ä¸€èµ·åšä»€ä¹ˆæ´»åŠ¨ï¼Ÿ"><a href="#7-6-å¦‚æœä½ æœ‰å­©å­ï¼Œä½ ä¼šå’Œä»–ä»¬ä¸€èµ·åšä»€ä¹ˆæ´»åŠ¨ï¼Ÿ" class="headerlink" title="7.6 å¦‚æœä½ æœ‰å­©å­ï¼Œä½ ä¼šå’Œä»–ä»¬ä¸€èµ·åšä»€ä¹ˆæ´»åŠ¨ï¼Ÿ"></a>7.6 å¦‚æœä½ æœ‰å­©å­ï¼Œä½ ä¼šå’Œä»–ä»¬ä¸€èµ·åšä»€ä¹ˆæ´»åŠ¨ï¼Ÿ</h4><h4 id="7-7-ä½ å…»å® ç‰©äº†å—ï¼Ÿå¦‚æœå…»äº†ï¼Œæ˜¯ä»€ä¹ˆå® ç‰©ï¼Ÿ"><a href="#7-7-ä½ å…»å® ç‰©äº†å—ï¼Ÿå¦‚æœå…»äº†ï¼Œæ˜¯ä»€ä¹ˆå® ç‰©ï¼Ÿ" class="headerlink" title="7.7 ä½ å…»å® ç‰©äº†å—ï¼Ÿå¦‚æœå…»äº†ï¼Œæ˜¯ä»€ä¹ˆå® ç‰©ï¼Ÿ"></a>7.7 ä½ å…»å® ç‰©äº†å—ï¼Ÿå¦‚æœå…»äº†ï¼Œæ˜¯ä»€ä¹ˆå® ç‰©ï¼Ÿ</h4><h4 id="7-8-ä½ è¿˜æƒ³è¦ä»€ä¹ˆæ ·çš„ç”Ÿæ´»æ–¹å¼ï¼Ÿ"><a href="#7-8-ä½ è¿˜æƒ³è¦ä»€ä¹ˆæ ·çš„ç”Ÿæ´»æ–¹å¼ï¼Ÿ" class="headerlink" title="7.8 ä½ è¿˜æƒ³è¦ä»€ä¹ˆæ ·çš„ç”Ÿæ´»æ–¹å¼ï¼Ÿ"></a>7.8 ä½ è¿˜æƒ³è¦ä»€ä¹ˆæ ·çš„ç”Ÿæ´»æ–¹å¼ï¼Ÿ</h4><h1 id="8-å†™ä¸‹ä½ çš„æ•…äº‹"><a href="#8-å†™ä¸‹ä½ çš„æ•…äº‹" class="headerlink" title="8. å†™ä¸‹ä½ çš„æ•…äº‹"></a>8. å†™ä¸‹ä½ çš„æ•…äº‹</h1><p>è¿™ä¹ˆå¤šé—®é¢˜ï¼Œä½ å›ç­”çš„è¿˜å¼€å¿ƒå—ï¼Ÿæ¥ä¸‹æ¥æ‰æ˜¯è¶…çº§æœ‰è¶£çš„éƒ¨åˆ†â€”â€”æƒ³è±¡è‡ªå·±äº”å¹´åçš„æ ·å­ï¼Œç„¶åæŠŠå®ƒå†™ä¸‹æ¥ã€‚å‡è®¾ä»Šå¤©æ˜¯å‘¨äº”æ™šä¸Šâ€”â€”å‘¨äº”æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‡è®¾ï¼Œå› ä¸ºå®ƒèƒ½æœ‰æ•ˆåœ°ä½“ç°ç”Ÿæ´»æ–¹å¼ï¼Œè¿™ä¸€å¤©æ—¢åŒ…æ‹¬å·¥ä½œï¼Œä¹ŸåŒ…æ‹¬äº†å…¸å‹çš„ä¼‘é—²æ´»åŠ¨ã€‚<br>å†å‡è®¾ä½ åˆšé†’è¿‡æ¥ã€‚ä½ åœ¨å“ªé‡Œï¼Ÿä½ å¯ä»¥æè¿°è‡ªå·±å§å®¤çš„æƒ…å†µã€‚æˆ¿å­æ˜¯æ€ä¹ˆè£…ä¿®çš„ï¼Ÿæ¥ä¸‹æ¥æè¿°ä½ çš„ä¸€å¤©çš„æ—¶é—´è®°å¾—å¤šä¸€ç‚¹ç»†èŠ‚ã€‚æƒ³è±¡ä¸€ä¸‹ä½ å»æ´—æ‰‹é—´åˆ·ç‰™ï¼Œä¸‹æ¥¼å€’æ¯å’–å•¡çš„æƒ…æ™¯ï¼ˆä½ å¯èƒ½æ²¡è¿™ä¸ªä¹ æƒ¯ï¼Œä½†æˆ‘ç¡®å®æ¯å¤©éƒ½æ˜¯è¿™æ ·çš„ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªä½ å¦‚ä½•æ€è€ƒâ€œè¿‡ç¨‹â€çš„ä¾‹å­ã€‚ä¸€å®šè¦å†™ä¸€äº›å…³äºä½ çš„æ„Ÿå—çš„å°äº‹ã€‚ä¹Ÿè®¸ä¸¤å‘¨åä½ ä¼šæœ‰ä¸€ä¸ªå‡æœŸï¼Œä¹Ÿè®¸ä½ ä»Šå¤©å°±èƒ½æ‹¿åˆ°æŠ¥é…¬ã€‚æŠŠä½ çš„æƒ³æ³•å†™ä¸‹æ¥å¯ä»¥è®©ä½ æŠŠä¸€å¤©ä¸­ä¸ä¸€å®šä¼šå‘ç”Ÿçš„äº‹æƒ…è®°èµ·æ¥ã€‚<br>å†™ä¸‹ä½ å¦‚ä½•å»ä¸Šç­ï¼ˆé™¤éä½ åœ¨å®¶å·¥ä½œï¼‰ï¼Œå†™ä¸‹ä½ çš„æ¯å¤©å·¥ä½œçš„æƒ…å†µï¼ŒåŒ…æ‹¬ä¸ä½ æ‰“äº¤é“çš„äººçš„è½¶äº‹å’Œä»–ä»¬çš„å„ç§ç‰¹ç‚¹ã€‚è¿™äº›èŠ±è¾¹æ–°é—»è®©ä½ çš„æ•…äº‹æ„Ÿè§‰çœŸå®ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒå‰é¢é—®é¢˜çš„ç­”æ¡ˆã€‚ç¡®ä¿ä½ çš„æ•…äº‹é‡ŒåŒ…å«äº†æ‰€æœ‰7ä¸ªç±»åˆ«çš„ä¿¡æ¯ã€‚ä½ çš„æ•…äº‹è¦ä¸€ç›´å†™åˆ°ä½ ä¸€å¤©ç»“æŸçš„æ—¶å€™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thought </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»Šæ—¥ç®€å²-è‡´æ•¬å……æ»¡æœªçŸ¥çš„ä¸–ç•Œ</title>
      <link href="/%E4%BB%8A%E6%97%A5%E7%AE%80%E5%8F%B2-%E8%87%B4%E6%95%AC%E5%85%85%E6%BB%A1%E6%9C%AA%E7%9F%A5%E7%9A%84%E4%B8%96%E7%95%8C/"/>
      <url>/%E4%BB%8A%E6%97%A5%E7%AE%80%E5%8F%B2-%E8%87%B4%E6%95%AC%E5%85%85%E6%BB%A1%E6%9C%AA%E7%9F%A5%E7%9A%84%E4%B8%96%E7%95%8C/</url>
      
        <content type="html"><![CDATA[<p>ä½œè€…åœ¨è¿™æœ¬ä¹¦é‡Œæ¢è®¨äº†å¾ˆå¤šç°ä¸–çš„é—®é¢˜ï¼Œä¹Ÿç»™å‡ºä¸€äº›è‡ªå·±çš„æ¢çŸ¥è§‰å¯Ÿçš„æ–¹å¼ï¼Œå‡ ä¸ªéå¸¸æœ‰æ„æ€çš„é—®é¢˜ã€‚</p><h1 id="1-ç§‘æŠ€ä¼šå¦‚ä½•é¢ è¦†æ•´ä¸ªç¤¾ä¼šï¼Ÿ"><a href="#1-ç§‘æŠ€ä¼šå¦‚ä½•é¢ è¦†æ•´ä¸ªç¤¾ä¼šï¼Ÿ" class="headerlink" title="1. ç§‘æŠ€ä¼šå¦‚ä½•é¢ è¦†æ•´ä¸ªç¤¾ä¼šï¼Ÿ"></a>1. ç§‘æŠ€ä¼šå¦‚ä½•é¢ è¦†æ•´ä¸ªç¤¾ä¼šï¼Ÿ</h1><p>é€»è¾‘é“¾æ¡ï¼š </p><ol><li>äººå·¥æ™ºèƒ½çš„é£é€Ÿå‘å±•ï¼Œå¤§æ•°æ®å¯¹äºäººçš„ç²¾ç¡®åˆ†æ</li><li>è‡ªåŠ¨é©¾é©¶ - ä½¿é©¾é©¶å‘˜å¤±ä¸š</li><li>å¤§æ•°æ® - ç²¾ç¡®çš„ç”¨æˆ·ç”»åƒï¼Œä½¿ç®—æ³•æ¯”äººè‡ªå·±æ›´äº†è§£è‡ªå·±ã€‚ä¼ ç»Ÿçš„å¹¿å‘Šä¸šï¼ŒæŠ•èµ„è¡Œä¸šçš„è¿è¡Œæ–¹å¼ä¼šå‘ç”Ÿæ”¹å˜ï¼Œæƒå¨(å†³å®šæƒ)è½¬ç§»ç»™ç®—æ³•</li><li>å¤§é‡ä½æŠ€æœ¯å«é‡çš„èŒä¸šæ¶ˆå¤±ï¼Œå¤§é‡äººå¤±ä¸š</li><li>å½“æŠ€æœ¯å†ç»§ç»­å‘å±•ï¼Œä¼šä¸ä¼šæœ‰ä¸€å¤©å¯ä»¥æ¨è¡Œå‡ºæœ€é’ˆå¯¹ä¸ªäººçš„è®¾è®¡ï¼Ÿæœ€èƒ½åˆºæ¿€ä½ æŸç§æƒ…ç»ªçš„å‡ºç°çš„è§†é¢‘ï¼Œæ–‡ç« ï¼ŒéŸ³ä¹ï¼Œå›¾åƒï¼Ÿ </li><li>å¦‚æœ5æˆç«‹çš„è¯ï¼ŒæŸç§ç¨‹åº¦ä¸Šä½ å¤±å»äº†å¯¹è‡ªå·±çš„æ§åˆ¶ï¼Œå› ä¸ºä½ æ‰€æ„å»ºåˆ¤æ–­çš„æ‰€æœ‰ä¿¡æ¯æ˜¯è¢«ç­›é€‰å‡ºæ¥æœ‰ç‰¹å®šå¯¼å‘çš„ã€‚</li><li>è¢«æ§åˆ¶â€¦     å¾ˆåƒã€Šç¾ä¸½æ–°ä¸–ç•Œã€‹</li><li>æ”¿åºœå¦‚ä½•è§£å†³å®‰æŠšå¤§é‡å¤±ä¸šçš„äººå‘¢ï¼Ÿå‡é€ŸæŠ€æœ¯çš„é©æ–°ï¼Ÿç»™äºˆäººæœ€åŸºç¡€çš„ä¿éšœå’ŒæœåŠ¡ï¼ˆå…±äº§ä¸»ä¹‰ï¼‰ï¼Ÿæä¾›è¶³å¤Ÿå¤šçš„ä¿éšœåŸºæœ¬ç”Ÿæ´»çš„èµ„é‡‘ï¼Ÿï¼ˆèŠ¬å…°æ­£åœ¨åšè¿™æ ·çš„å®éªŒï¼‰</li><li>åŸºå› ç”Ÿç‰©æŠ€æœ¯çš„è¿…çŒ›å‘å±•ï¼Œä¼šä¸ä¼šç»™å°‘éƒ¨åˆ†äººæ”¹å˜è‡ªå·±çš„åŸºå› çš„æœºä¼šï¼Ÿæ”¹å˜åŸºå› ï¼Œæ”¹å˜æ€§çŠ¶ï¼Œæ¸æ¸å‡ºç°ä¸åŒçš„ç‰©ç§ï¼Œè¶…çº§äººå’Œä¸€èˆ¬äººï¼Ÿ </li></ol><p>ä¸Šè¿°ä¸€åˆ‡éƒ½æ˜¯æ¨è®ºï¼Œä½†æ˜¯ä¸èƒ½å¦è®¤ç¡®å®å­˜åœ¨è¿™ç§å¯èƒ½ï¼Œè€Œä¸”æŠ€æœ¯çš„è¿›æ­¥é€Ÿåº¦ç€å®å¾ˆå¿«ã€‚è°èƒ½åœ¨2009å¹´ç”¨ç€å‚»ç“œæœºçš„æ—¶ä»£æƒ³è±¡åˆ°ä»Šæ—¥æˆ‘ä»¬çš„æŠ€æœ¯æ°´å¹³å‘¢ï¼Ÿ</p><h1 id="2-äººå·¥æ™ºèƒ½æœ‰å¯èƒ½æ§åˆ¶äººç±»ä¹ˆï¼Ÿ"><a href="#2-äººå·¥æ™ºèƒ½æœ‰å¯èƒ½æ§åˆ¶äººç±»ä¹ˆï¼Ÿ" class="headerlink" title="2. äººå·¥æ™ºèƒ½æœ‰å¯èƒ½æ§åˆ¶äººç±»ä¹ˆï¼Ÿ"></a>2. äººå·¥æ™ºèƒ½æœ‰å¯èƒ½æ§åˆ¶äººç±»ä¹ˆï¼Ÿ</h1><p>è¿™é‡Œå…¶å®éœ€è¦å¯¹å¤§è„‘å’Œæ„è¯†åšä¸ªåŒºåˆ†ã€‚ç°åœ¨çš„æœºå™¨åšçš„äº‹æƒ…æ˜¯å¤§è„‘åšçš„äº‹æƒ…ï¼Œå³é€šè¿‡å„ç§ç¥ç»å…ƒçš„è¿æ¥ï¼Œå„ç§ç”µä¿¡å·çš„åˆºæ¿€ï¼Œæ ¹æ®è¾“å…¥çš„äº‹ç‰©çš„ç‰¹å¾ï¼Œç»™å‡ºé’ˆå¯¹æ€§çš„ååº”ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªå¾ˆæœ‰é€»è¾‘çš„è¿‡ç¨‹ã€‚</p><p>ä½†æ˜¯äººå·¥æ™ºèƒ½æ§åˆ¶äººç±»è¿™ä¸ªé—®é¢˜ï¼Œå®è´¨ä¸Šæ˜¯åœ¨é—®ï¼Œäººå·¥æ™ºèƒ½æœ‰å¯èƒ½äº§ç”Ÿè‡ªå·±çš„æ„è¯†ä¹ˆï¼Ÿ </p><p>ç­”æ¡ˆåœ¨ç›®å‰çœ‹ï¼Œæ˜¯ä¸çŸ¥é“â€¦ å› ä¸ºæˆ‘ä»¬ç°åœ¨ä¹Ÿå¹¶ä¸çŸ¥é“å¤§è„‘æ˜¯å¦‚ä½•äº§ç”Ÿå„ç§æƒ…ç»ªçš„ï¼Œä¸ºä»€ä¹ˆå¤§è„‘çš„è¿™ç§æ´»åŠ¨çƒ­ç‚¹åŒºåŸŸ(heatmap)èƒ½å¤Ÿå–œæ‚¦ï¼Œè€Œå¦å¤–ä¸€ç§èƒ½å¤Ÿç”Ÿæˆæ„¤æ€’ï¼Ÿ æˆ‘ä»¬ä¸çŸ¥é“ï¼ŒäºŒè€…ä¹‹é—´ç°åœ¨æ— æ³•è¯æ˜æœ‰ç€ä»»ä½•çš„å› æœå…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“æ„è¯†æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œåˆæ˜¯å¦‚ä½•äº§ç”Ÿä½œç”¨çš„ã€‚</p><p>ç°åœ¨ä¸ºæ•°ä¸å¤šçš„è§‚å¯Ÿæ„è¯†/å¿ƒæ™ºçš„æ–¹å¼å°±æ˜¯å†¥æƒ³ï¼Œä½†æ˜¯è¿™ä¹Ÿåªæ˜¯å°½é‡ç›´æ¥çš„è§‚å¯Ÿè‡ªå·±çš„æ„è¯†çš„ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è§‚å¯Ÿä»–äººå¿ƒæ™ºæ¥è¿›è¡Œç ”ç©¶ã€‚</p><p>æˆ‘ä»¬ç°åœ¨è®¤ä¸ºèº«è¾¹çš„äººæœ‰æ„è¯†æ›´å¤šæ˜¯ä¸€ç§æ¨å·±åŠäººï¼Œå› ä¸ºæˆ‘çŸ¥é“è‡ªå·±æœ‰æ„è¯†ï¼Œè€Œèº«æ—çš„äººå’Œæˆ‘æœ‰å¾ˆç±»ä¼¼çš„è¡Œä¸ºç‰¹å¾ï¼Œå› æ­¤æœ‰ç†ç”±è®¤ä¸ºå¤§å®¶éƒ½æœ‰æ„è¯†ã€‚ï¼ˆä½†æ˜¯æ˜¯ä¸æ˜¯ä¼šå¾ˆæ¥šé—¨çš„ä¸–ç•Œå‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼ï¼‰</p><h1 id="3-äººç”Ÿçš„æ„ä¹‰ï¼Ÿ"><a href="#3-äººç”Ÿçš„æ„ä¹‰ï¼Ÿ" class="headerlink" title="3. äººç”Ÿçš„æ„ä¹‰ï¼Ÿ"></a>3. äººç”Ÿçš„æ„ä¹‰ï¼Ÿ</h1><p>äººç”Ÿçš„æ„ä¹‰ï¼Ÿ æŸç§å¾ªç¯ï¼Œè€Œæˆ‘ä»¬çŸ¥è¯†åœ¨æ‰§è¡ŒæŸç§èµ‹äºˆæˆ‘ä»¬çš„è§’è‰²ï¼Œè®©è¿™ä¸ªå¾ªç¯ä¸€ç›´ç¨³å®šä¸‹å»ï¼Ÿ æˆ‘è§‰å¾—æ›´åº”è¯¥è¯´ä¸æ˜¯ä¸ªå¾ªç¯ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯èºæ—‹ä¸Šå‡çš„ï¼Œæ— è®ºæ˜¯äººçš„è®¤çŸ¥ï¼Œè¿˜æ˜¯æ•´ä¸ªç¤¾ä¼šçš„çŠ¶æ€ï¼Œç§‘æŠ€ç¯å¢ƒï¼Œè¿™ç§ä¸Šå‡æ˜¯ä¼šæŠŠæˆ‘ä»¬æ‰€å¤„çš„æ•´ä¸ªç¯å¢ƒä¸æ–­æ¨å‘æ–°çš„çŠ¶æ€çš„ï¼Œäººä¸äººä¹‹é—´çš„å…³ç³»ï¼Œé¾ƒé¾‰ï¼Œå‹å–„ï¼Œå€’æ˜¯æ²¡æœ‰å¤§çš„åŒºåˆ«ã€‚</p><p>å®—æ•™åœ¨èµ‹äºˆæ¯ä¸ªäººçš„äººç”Ÿç‰¹å®šçš„æ„ä¹‰ï¼Œæ˜¯çº¿æ€§çš„ç”Ÿæ´»/ä¸–ç•Œï¼Œè¿˜æ˜¯ä¸€ä¸ªå¾ªç¯çš„çŠ¶æ€ã€‚</p><p>ç”¨æ•…äº‹æ¥è¯‰è¯´è‡ªå·±çš„äººç”Ÿçš„æ„ä¹‰ï¼Œ</p><p>å¾ªç¯çš„ä¸Šä¸€ä¸–ä¸‹ä¸€ä¸–æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå¦‚æœæ²¡æœ‰å‰äººçš„è‚©è†€ï¼Œåªèƒ½ä¸€åˆ‡ä»å¤´å†æ¥â€¦ </p><p>é‚£å¦‚æœæˆ‘ä»¬ç»™è‡ªå·±çš„å®¶åº­èµ‹äºˆä¸€ä¸ªç‰¹å®šçš„æ„ä¹‰ï¼Œç”¨å„ç§æ–¹å¼æ¥éªŒè¯è¿™ä¸ªä¸–ç•Œæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œæ¥æ€è€ƒä¸–ç•Œå‘å±•çš„èµ°å‘ï¼Œç”¨å„ç§æ–¹å¼æ¥è¯æ˜ï¼Œé‚£ä¼šæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿ  </p><p>ç”¨å‡ ä»£äººçš„æ—¶é—´ï¼Œæ¥è¯¦ç»†çš„æè¿°æˆ‘ä»¬æ‰€ç»å†çš„æ—¶ä»£ï¼Œä»å„ä¸ªè§’åº¦å»ç ”ç©¶æ¢æ±‚æˆ‘ä»¬çš„ä¸–ç•Œä¼šå˜æˆä»€ä¹ˆæ ·å­ï¼Ÿ   â€”-&gt; æŠ€æœ¯ï¼Œå·¥ç¨‹ï¼ŒåŒ»å­¦ï¼Œè‰ºæœ¯â€¦. è¯¸å¦‚æ­¤ç±»ï¼Œåœ¨æ¯ä¸ªé¢†åŸŸéƒ½ç ”ç©¶çš„æ›´æ·±æ›´æ·±ä¸€äº›ï¼Œè¿™æ ·å­ä¼šå¥½ä¸€äº›ä¹ˆ</p><p>ç ”ç©¶äººæ€§çš„è¾¹ç•Œï¼Ÿ ç ”ç©¶äººç±»æœ€ç»ˆçš„å½’å®¿ï¼Ÿ ç ”ç©¶äººç±»å¦‚ä½•èƒ½å’ŒæŠ€æœ¯å’Œè°å…±å¤„åˆä¸è¢«æŠ€æœ¯æ§åˆ¶ï¼Ÿ </p><p>ä¸ºä»€ä¹ˆè¦æœ‰æ•…äº‹ï¼Œè¦è®©äººæ´»å¾—ä¸ç©ºè™šå•Šï¼Œä¸ºäº†è®©äººæœ‰ç›®æ ‡ï¼›å¦‚ä½•è®©äººç›¸ä¿¡æ•…äº‹å‘¢ï¼Ÿ é å„ç§ä»ªå¼ï¼Œå°†æŠ½è±¡å˜å¾—å…·ä½“ï¼Œå°†è™šæ„å˜å¾—çœŸå®</p><p>çŒ®ç¥­ä½¿ä¿¡æœï¼Œä»˜å‡ºä½¿ä¿¡æœã€‚ç‰ºç‰²  â€” æ²‰æ²¡æˆæœ¬ </p><p>å› ä¸ºäººä»¬ä»Šæ—¥ç›¸ä¿¡çš„ä»»ä½•ç¥ç¥—æˆ–äº‹åŠ¡ï¼Œä¸è®ºæ˜¯è€¶å’Œåï¼Œè¿˜æ˜¯å›½å®¶ï¼Œé©å‘½ï¼Œéƒ½å¹¶ä¸å®Œæ•´ï¼Œæœ‰å¾ˆå¤šé—®é¢˜è§£é‡Šä¸äº†ï¼Œå……æ»¡æ¼æ´ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œäººç±»å¾ˆå°‘æŠŠæ‰€æœ‰çš„ä¿¡å¿µéƒ½æŠ•æ³¨åˆ°å•ä¸€çš„æ•…äº‹ä¸Šï¼Œè€Œæ˜¯æœ‰ä¸ªä¿¡å¿µç»„åˆï¼Œé‡Œé¢æœ‰å‡ ä¸ªä¸åŒçš„æ•…äº‹ï¼Œå‡ ä¸ªä¸åŒçš„èº«ä»½è®¤åŒå¯ä»¥é…åˆéœ€æ±‚ä»»æ„åˆ‡æ¢ã€‚å‡ ä¹æ‰€æœ‰çš„ç¤¾ä¼šå’Œè¿åŠ¨ï¼Œéƒ½æœ‰è¿™ç§è®¤çŸ¥å¤±è°ƒçš„æƒ…å½¢ã€‚</p><p>è°¨æ…æ¬ºéª—ï¼Œå¦‚æœæ”¿å®¢çš„è¯è¯­å¼€å§‹æºæ‚ä¸€äº›ç¥ç§˜çš„è¯å¥ï¼Œå°±è¯¥æé«˜è­¦æƒ•ã€‚é¢å¯¹çœŸå®çš„ç—›è‹¦ï¼Œè¿™äº›äººå¯èƒ½ä¼šç”¨æŸäº›ç©ºæ³›éš¾è§£çš„è¡¨è¾¾æ¥åŠ ä»¥åŒ…è£…ï¼Œä½œä¸ºç”³è¾©ã€‚æ¯”å¦‚<strong><em>ç‰ºç‰²ã€æ°¸æ’ã€çº¯å‡€ã€æ¢å¤</em></strong>ã€‚</p><p>å¦‚æœçœŸæƒ³çŸ¥é“å®‡å®™çš„çœŸç›¸ï¼Œäººç”Ÿçš„æ„ä¹‰ï¼Œè‡ªå·±çš„èº«ä»½ï¼Œæœ€å¥½çš„å‡ºå‘ç‚¹æ˜¯å»è§‚å¯Ÿç—›è‹¦ï¼Œæ¢ç´¢ç—›è‹¦çš„æœ¬è´¨ã€‚ç­”æ¡ˆæ°¸è¿œä¸ä¼šæ˜¯ä¸€ä¸ªæ•…äº‹ã€‚</p><h1 id="4-ä¸€äº›æ‘˜å½•"><a href="#4-ä¸€äº›æ‘˜å½•" class="headerlink" title="4. ä¸€äº›æ‘˜å½•"></a>4. ä¸€äº›æ‘˜å½•</h1><p>å†¥æƒ³æ˜¯ä¸€ç§æ„Ÿå—è‡ªå·±çš„æ„è¯†çš„æ–¹å¼</p><p>é“å¾·çš„é‡ç‚¹å¹¶ä¸æ˜¯éµå®ˆç¥åœ£çš„è¯«å‘½ï¼Œè€Œæ˜¯è¦å‡å°‘ç—›è‹¦ã€‚ </p><p>ä¸ºä»€ä¹ˆäººä¼šå…³æ³¨ä»–äººçš„æ„Ÿå—ï¼Ÿæ˜¯å¦æ„‰å¿«å‘¢ï¼Ÿ</p><p>å› ä¸ºäººæ˜¯ç¤¾äº¤åŠ¨ç‰©ï¼Œè‡ªå·±çš„å¹¸ç¦ä¸å¦ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¸ä»–äººçš„å…³ç³»ã€‚æ²¡æœ‰çˆ±ï¼Œæ²¡æœ‰å‹è°Šï¼Œæ²¡æœ‰ç¾¤ä½“çš„æ”¯æŒï¼Œè°èƒ½å¿«ä¹å¾—èµ·æ¥å‘¢ï¼Ÿå¦‚æœè¿‡ç€å­¤ç‹¬ï¼Œä»¥è‡ªæˆ‘ä¸ºä¸­å¿ƒçš„ç”Ÿæ´»ï¼Œè‚¯å®šä¼šæ„Ÿåˆ°ç—›è‹¦ã€‚æ‰€ä»¥æƒ³è¦å¿«ä¹ä½ è‡³å°‘è¦å…³å¿ƒä½ çš„å®¶äººã€æœ‹å‹ï¼Œä»¥åŠæ‰€å±ç¤¾ç¾¤é‡Œçš„å…¶ä»–äººã€‚</p><p>ä¸–ä¸Šæ‰€æœ‰çš„æš´åŠ›è¡Œä¸ºï¼Œå¿…ç„¶å§‹äºä¸€ä¸ªäººå¿ƒä¸­çš„æš´åŠ›æ¬²æœ›ï¼Œè¿™ç§æ¬²æœ›æ—©åœ¨æ‰°ä¹±ä»–äººçš„å¹³å’Œå¹¸ç¦ä¹‹å‰ï¼Œå°±å·²ç»æ‰°ä¹±äº†è‡ªå·±çš„å¹³å’Œå’Œå¹¸ç¦äº†ã€‚</p><p>æˆ‘ä»¬çš„é“å¾·ä»å“ªé‡Œæ¥ï¼Ÿ æˆ‘ä»¬çš„ä¿¡ä»°ä»å“ªé‡Œæ¥ï¼Ÿ æˆ‘ä»¬çš„æ™ºæ…§ä»å“ªé‡Œæ¥ï¼Ÿ   æˆ‘ä»¬è§£é‡Šä¸äº†çš„ä¸œè¥¿åˆ°åº•æ˜¯ç¥åˆ›é€ çš„ï¼Œè¿˜æ˜¯è¯´ï¼Œå…¶å®åªæ˜¯å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å‘¢ï¼Ÿï¼Ÿ </p><p>åˆ°åº•æ˜¯å› ä¸ºç¥è¯´ä¸åº”è¯¥åšä»€ä¹ˆæˆ‘ä»¬æ‰ä¸åšä»€ä¹ˆï¼Ÿ è¿˜æ˜¯æˆ‘ä»¬è‡ªå·±å°±ä¸æƒ³é‚£ä¹ˆåšï¼Œæ°å¥½ç›¸ä¿¡ä¸€ä¸‹å‘¢ï¼Ÿ è­¬å¦‚æ€äººï¼Œä¸åšå› ä¸ºæˆ‘ä»¬çš„é“å¾·è¿˜æ˜¯ç¥è¯´ä¸åº”è¯¥æ€äººå‘¢ï¼Ÿ å¦‚æœæœ‰ä¸€å¤©ç¥çš„ç°ä¸–ä»£è¨€è€…è¯´ï¼Œæˆ‘ä»¬è¦æ€å…‰å¼‚æ•™å¾’ï¼Œä¿¡æ•™çš„äººä¼šåšå‡ºæ€æ ·çš„é€‰æ‹©å‘¢ï¼Ÿï¼Ÿ</p><p>å…¶å®ç«™åœ¨è¿™äº›ä¿¡æ•™çš„äººçš„è§’åº¦ï¼Œå¥½åƒå¹¶æ²¡æœ‰åšé”™ä»€ä¹ˆï¼Ÿåˆ°åº•å‰é¢æ²¡æœ‰å‡ºäº‹æƒ…æ˜¯å› ä¸ºæ°å·§é“å¾·å±‚é¢çš„è¦æ±‚å’Œä¿¡ä»°çš„è¦æ±‚ä¸€è‡´ï¼Œè¿˜æ˜¯æ˜¯åœ¨é€šè¿‡ä¿¡ä»°çš„æ–¹å¼è¿½æ±‚è‡ªå·±çš„é“å¾·å‘¢ï¼Ÿ     é¢‡æœ‰ç‚¹é“å¾·ä¿¡ä»°è°ä¸ºç¬¬ä¸€æ€§çš„æ„å‘³ã€‚</p><p>æ­£ä¹‰æ¥è‡ªç»å¯¹è´£ä»»ï¼Œè¿˜æ˜¯ç»“æœå¯¼å‘å‘¢ï¼Ÿ</p><p>å¯ä»¥ç”¨æ„å›¾é“å¾·æ¥å›é¿è¿™ä¸ªé—®é¢˜ï¼Œé‡è¦çš„æ˜¯æˆ‘çš„æ„å›¾ï¼Œè€Œä¸æ˜¯æˆ‘çš„å®é™…è¡ŒåŠ¨ä»¥åŠç»“æœã€‚ä½†æ˜¯åœ¨è¿™ä¸ªä¸€åˆ‡éƒ½ç´§å¯†è”ç³»çš„ä¸–ç•Œä¸­ï¼Œæœ€é‡è¦çš„é“å¾·ä¹‰åŠ¡å°±æ˜¯äººå¿…é¡»è¦çŸ¥é“å„ç§äº‹æƒ…ã€‚ç°ä»£å†å²ä¸­æœ€ä¸¥é‡çš„ç½ªè¡Œï¼Œä¸ä»…æºè‡ªäºä»‡æ¨å’Œè´ªå©ªï¼Œè¿˜æºè‡ªäºæ— çŸ¥å’Œå†·æ¼ ã€‚</p><p>ç»“æ„æ€§åè§ï¼Œæˆ‘ä»¬åªèƒ½å¬åˆ°ä¸€éƒ¨åˆ†äººçš„å£°éŸ³ï¼Œè€Œæ— æ³•å¬åˆ°å¦å¤–ä¸€éƒ¨åˆ†äººçš„ã€‚ </p><p>æ¯ä¸ªäººçš„çœ¼ä¸­å¼€å§‹æœ‰å…¶è‡ªå·±è®¤ä¸ºçš„çœŸç›¸ï¼Œè€Œæ— æ³•äº¤èã€‚</p><p>å…³äºå¦‚ä½•é˜²æ­¢è‡ªå·±è¢«æ´—è„‘çš„æ³•åˆ™ï¼š </p><ol><li>å¦‚æœä½ æƒ³å¾—åˆ°å¯é çš„æ¶ˆæ¯ï¼Œå¿…ç„¶è¦ä»˜å‡ºæ˜‚è´µçš„ä»£ä»·ã€‚å¦‚æœä½ æ€»æ˜¯å…è´¹å¾—åˆ°ä¿¡æ¯ï¼Œæœ‰å¯èƒ½ä½ æ‰æ˜¯æ•´ä¸ªå•†ä¸šä¸–ç•Œçš„äº§å“ã€‚</li><li>å¦‚æœè§‰å¾—æŸäº›é—®é¢˜ä¼¼ä¹å¯¹ä½ ç‰¹åˆ«é‡è¦ï¼Œå°±è¯¥çœŸæ­£åŠªåŠ›é˜…è¯»ç›¸å…³çš„ç§‘å­¦æ–‡çŒ®ã€‚æ‰€è°“çš„ç§‘å­¦æ–‡çŒ®ï¼ŒæŒ‡çš„æ˜¯ç»è¿‡åŒè¡Œè¯„å®¡çš„è®ºæ–‡ï¼Œç”±çŸ¥åå­¦æœ¯å‡ºç‰ˆç¤¾å‡ºç‰ˆçš„ä¹¦ç±ï¼Œä»¥åŠçŸ¥åæ•™æˆçš„è‘—ä½œã€‚</li></ol><p>ç¾ä¸½æ–°ä¸–ç•Œï¼šé»˜ç„¶å¿å—å‘½è¿çš„æš´è™çš„æ¯’ç®­ï¼Œæˆ–æ˜¯é¢å¯¹è‹¦æµ·ï¼Œæ‹¿åˆ€åšä¸ªä¸€äº†ç™¾äº†ã€‚ä½ ä»¬æ—¢ä¸æ˜¯é»˜ç„¶å¿å—ï¼Œä¹Ÿä¸æ˜¯ä¸€äº†ç™¾äº†ï¼Œè€Œåªæ˜¯å–æ¶ˆäº†å‘½è¿çš„æ¯’ç®­ï¼Œè¿™æ ·æœªå…å¤ªç®€å•åŒ–äº†ã€‚</p><p>å­¦æ ¡æˆ–è€…è¯´æ•™è‚²ï¼Œç°åœ¨æœ€ä¸åº”è¯¥æ•™çš„æ˜¯ä¿¡æ¯â€¦ å› ä¸ºè¿™ä¸ªä¸–ç•Œç°åœ¨çš„ä¿¡æ¯å®åœ¨å¤ªå¤šäº†ï¼Œ æ¯ä¸ªäººéƒ½åœ¨æ¥æ”¶ä¸åœçš„ä¿¡æ¯è½°ç‚¸ã€‚è¿™æ‰æ˜¯è¿™ä¸ªä¸–ç•Œç°åœ¨æœ€å¯æ€•çš„é—®é¢˜ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå¤±å»äº†æŒç»­å­¦ä¹ ï¼Œä¸“æ³¨å­¦ä¹ çš„èƒ½åŠ›ã€‚è¦çŸ¥é“æƒ³è¦æ·±å…¥å­¦ä¹ ä¸€æ ·ä¸œè¥¿ï¼Œæ˜¯éœ€è¦è¿›å…¥æ·±åº¦ä¸“æ³¨åœ°çŠ¶æ€çš„ï¼Œä¸æ˜¯æ‰‹æœºä¸€éœ‡åŠ¨å°±å»çœ‹ä¸€çœ¼ï¼Œé‡åˆ°ä¸ä¼šçš„å°±åˆ·åˆ·å¾®åšï¼Œçœ‹çœ‹æŠ–éŸ³å†ç»§ç»­çš„é‚£ç§çŠ¶æ€ã€‚</p><p>å­¦ç”Ÿï¼Œæˆ–è€…è¯´æ•™è‚²ï¼Œæ›´åº”è¯¥æ•™è‚²å­¦ç”Ÿå»åšçš„ï¼Œæ˜¯4Cã€‚</p><ul><li>æ‰¹åˆ¤æ€§æ€è€ƒ critical thinking </li><li>æ²Ÿé€š communication </li><li>åˆä½œ collaboration </li><li>åˆ›æ„ creativity </li></ul><p>å­¦æ ¡ä¸åº”è¯¥å¤ªçœ‹é‡ç‰¹å®šçš„å·¥ä½œæŠ€èƒ½ï¼Œè€Œè¦å¼ºè°ƒé€šç”¨çš„ç”Ÿæ´»æŠ€èƒ½ã€‚æœ€é‡è¦çš„æ˜¯<strong><em>èƒ½å¤Ÿéšæœºåº”å˜ï¼Œå­¦ä¹ æ–°äº‹ç‰©ï¼Œåœ¨ä¸ç†Ÿæ‚‰çš„ç¯å¢ƒé‡Œä»ç„¶èƒ½å¤Ÿä¿æŒå¿ƒæ™ºå¹³è¡¡</em></strong>ã€‚æƒ³è¦è·Ÿä¸Š2050å¹´çš„ä¸–ç•Œï¼Œäººç±»ä¸åªéœ€è¦å‘æ˜æ–°çš„æƒ³æ³•å’Œäº§å“ï¼Œæœ€é‡è¦çš„æ˜¯è¦ä¸€æ¬¡åˆä¸€æ¬¡åœ°é‡å¡‘è‡ªå·±ã€‚</p><p>All that is solid melts into air </p><p>è¿™å¿…å°†æ˜¯ä¸€ä¸ªéœ€è¦ä¸æ–­å­¦ä¹ çš„ç¤¾ä¼šäº†</p><p>å·¥ä¸šé©å‘½è®©æˆ‘ä»¬å¯¹äºæ•™è‚²çš„æƒ³æ³•å°±åƒæ˜¯ä¸€æ¡ç”Ÿäº§çº¿ã€‚åŸé•‡çš„ä¸­å¿ƒæœ‰ä¸€åº§å¤§å‹æ··å‡åœŸå»ºç­‘ï¼Œæ¯ä¸ªæˆ¿é—´éƒ½é…æœ‰å‡ æ’æ¡Œæ¤…ã€‚é“ƒå£°å“èµ·ï¼Œä½ å°±å’Œå¦å¤–30ä¸ªä¸€èˆ¬å¤§çš„å­©å­ä¸€èµ·èµ°è¿›æŸä¸ªæˆ¿é—´ã€‚æ¯ä¸ªå°æ—¶éƒ½ä¼šæœ‰ä¸€ä¸ªå¤§äººèµ°è¿›äº†è¯´è¯ï¼Œè€Œä¸”æ”¿åºœä»˜é’±å«ä»–ä»¬è¿™ä¹ˆåšçš„ã€‚</p><p>åˆ°åº•æ˜¯æˆ‘ä»¬åœ¨æ§åˆ¶æŠ€æœ¯ï¼Œè¿˜æ˜¯æŠ€æœ¯åœ¨æ§åˆ¶æˆ‘ä»¬å‘¢ï¼Ÿ </p><p>å¤§å¤šæ•°äººå…¶å®å¹¶ä¸äº†è§£è‡ªå·±ï¼Œæ‰“ç®—å€¾å¬è‡ªå·±å†…å¿ƒçš„å£°éŸ³æ—¶ï¼Œå¾ˆå®¹æ˜“é­åˆ°å¤–éƒ¨çš„æ“æ§ã€‚æˆ‘ä»¬å¤§è„‘ä¸­çš„é‚£äº›å£°éŸ³ç»å¯¹ä¸å€¼å¾—ä¿¡èµ–ï¼Œå› ä¸ºè¿™äº›å£°éŸ³ååº”çš„æ€»æ˜¯å›½å®¶çš„æ”¿æ²»å®£è¨€ã€æ„è¯†å½¢æ€çš„æ´—è„‘æ‰‹æ®µå’Œå•†ä¸šå¹¿å‘Šçš„æ®·æ®·å¬å”¤ï¼Œæ›´åˆ«æäººä½“ç”ŸåŒ–æœºåˆ¶æœ¬æ¥å°±æœ‰ç¼ºé™·ã€‚</p><p>å†¥æƒ³ä¸å†…è§‚ï¼Œå„ç§ç—›è‹¦æœ€æ·±å±‚çš„æ¥æºï¼Œå°±åœ¨äºè‡ªå·±çš„å¿ƒæ™ºã€‚å¦‚æœæœ‰ä»€ä¹ˆæ˜¯æˆ‘æƒ³å¾—åˆ°å´ä¸å¯å¾—ï¼Œå¿ƒæ™ºçš„ååº”å°±æ˜¯äº§ç”Ÿç—›è‹¦ã€‚ç—›è‹¦å¹¶éå¤–éƒ¨ä¸–ç•Œçš„å®¢è§‚åº†å¹¸ï¼Œè€Œæ˜¯è‡ªå·±å¿ƒæ™ºäº§ç”Ÿçš„å¿ƒç†ååº”ã€‚äº†è§£è¿™ä¸€ç‚¹å°±æ˜¯è·¨å‡ºäº†ç¬¬ä¸€æ­¥ï¼Œè®©äººä¸å†äº§ç”Ÿç—›è‹¦ã€‚</p><p>å¤§è„‘ä¸å¿ƒæ™ºçš„å¥¥ç§˜ã€‚å¤§è„‘æ˜¯ç”±ç¥ç»å…ƒã€çªè§¦å’Œç”ŸåŒ–ç‰©è´¨ç»„æˆçš„å®ä½“ç½‘ç»œç»„ç»‡ï¼Œå¿ƒæ™ºåˆ™æ˜¯ç—›è‹¦ã€æ„‰å¿«ã€çˆ±å’Œæ„¤æ€’ç­‰ä¸»è§‚ä½“éªŒçš„æµåŠ¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç ”ç©¶åˆ°å¤§è„‘æ´»åŠ¨ï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ç ”ç©¶ä»–äººçš„å¿ƒæ™ºï¼Œæˆ–è€…è¯´æ˜¯æ„è¯†ã€‚å¯¹äºæ„è¯†çš„ç ”ç©¶ï¼Œè¿˜æ˜¯ä¸€ä¸ªé»‘ç®±ã€‚ï¼ˆå…¶å®æŸç§ç¨‹åº¦ä¸Šï¼Œè¿™æ˜¯äººå·¥æ™ºèƒ½æ˜¯å¦èƒ½æœ‰æ„è¯†çš„å†³å®šæ€§å› ç´  â€“ å³æ„è¯†åœ¨äººçš„å¤§è„‘ä¸­æ˜¯å¦‚ä½•äº§ç”Ÿçš„)</p><p>å¦‚ä½•ç›´è§‚çš„è§‚å¯Ÿè‡ªå·±çš„å¿ƒæ™ºï¼Œä»¥åŠå¦‚ä½•ç›´è§‚çš„è§‚å¯Ÿä»–äººçš„å¿ƒæ™ºã€‚</p><p>å†¥æƒ³å®é™…ä¸Šæ˜¯ä¸€ç§ç›´æ¥è§‚å¯Ÿè‡ªå·±çš„å¿ƒæ™ºçš„ä¸€ç§æ–¹æ³•</p><p>æ‰€è°“çš„å®é™…ä¿®è¡Œï¼Œå°±æ˜¯è¦è¿ç”¨ç³»ç»ŸæŒç»­ä»¥åŠå®¢è§‚çš„æ–¹å¼ï¼Œè§‚å¯Ÿèº«ä½“çš„æ„Ÿè§‰ä»¥åŠå¿ƒæ™ºå¯¹è¿™äº›æ„Ÿè§‰çš„ååº”ï¼Œæ®æ­¤æ¥æ‰¾å‡ºå¿ƒæ™ºçš„åŸºæœ¬æ¨¡å¼ã€‚å†…è§‚ç¦…ä¿®è€…éƒ½ä¼šè¢«å‘Šè¯«ï¼Œä¸è¦æƒ³å»è¿½æ±‚ä»€ä¹ˆç‰¹æ®Šçš„ä½“éªŒï¼Œè€Œæ˜¯è¦ä¸“æ³¨äºäº†è§£è‡ªå·±çš„å¿ƒæ™ºçš„çœŸå®çŠ¶å†µï¼Œä¸è®ºè¿™ä¸ªçŠ¶å†µä¸ºä½•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
            <tag> society </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Food Rules</title>
      <link href="/Food-Rules/"/>
      <url>/Food-Rules/</url>
      
        <content type="html"><![CDATA[<p>Read a book recommended by Doctor, it tells about some food rules mainly focusing on what should we eat, how much should we eat, pretty funny, wanna share some rules here: </p><h1 id="1-What-should-I-eat"><a href="#1-What-should-I-eat" class="headerlink" title="1. What should I eat?"></a>1. What should I eat?</h1><ol><li>Eat food, not â€œedible foodlike sunstancesâ€. </li><li>Donâ€™t eat anything your great-grandmother wouldnâ€™t recognize as food. </li><li>Avoid food products containing ingredients that no ordinary human would keep in the pantry. </li><li>Avoid food products that contain high-fructose corn syrup. </li><li>Avoid foods that have some form of suger(or sweetener) listed among the top three ingredients. </li><li>Avoid food products that contain more than five ingredients. </li><li>Avoid food products containing ingredients that a third grader connot pronounce. </li><li>Avoid food products that make health claims.</li><li>Avoid food products with the wordoid or the terms low fat or non fat in their names.</li><li>Avoid foods that are pretending to be something they are not. </li><li>Avoid foods you see advertisement on tv. </li><li>Shop the peripheries of the supermarket and stay out of the middle. </li><li>Eat only foods that will eventually rot. </li><li>Eat foods made from ingredients that you can picture in their raw state or growing in nature. </li><li>Get out of the supermarket whenever you can. </li><li>Buy your snacks at the farmersâ€™ market.</li><li>Eat only foods that have been cooked by humans. </li><li>Donâ€™t ingest foods made in places where everyone is required to wear a surgical cap. </li><li>If it came from a plant, eat it; if it was made in a plant, donâ€™t. </li><li>Itâ€™s not food if it arrived through the window of your car. </li><li>Itâ€™s not food if itâ€™s called by the same name in every language. </li></ol><h1 id="2-What-kind-of-food-should-I-eat"><a href="#2-What-kind-of-food-should-I-eat" class="headerlink" title="2. What kind of food should I eat?"></a>2. What kind of food should I eat?</h1><ol start="22"><li>Eat mostly plants, especially leaves. </li><li>Treat meat as a flavoring or special occasion food. </li><li>Eating waht stands on one leg(mushrooms, plant foods) is better than eating what stands on two legs(fowl), which is better than eating waht stands on four legs. </li><li>Eat your colors. </li><li>Drink the spinach water. </li><li>Eat animals that have themselves eaten well. </li><li>Eat like an omnivore. </li><li>Eat well grown food from healthy soil. </li><li>Eat wild foods when you can. </li><li>Donâ€™t overlook the oily little fishes.</li><li>Eat some foods that have been predigested by bacteria or fungi. </li><li>Sweeten and salt your food yourself. </li><li>Eat sweet foods as you find them in nature. </li><li>Donâ€™t eat breakfast cereals that change the color of the milk. </li><li>The whiter the bread, the sooner youâ€™ll be dead. </li><li>Favor the kinds of oils and grains that have traditionally been stone ground. </li><li>Eat all the junk food you want as long as you cook it yourself. </li><li>Be the kind of person who takes supplements, then skip the supplements. </li><li>Regard nontraditional foods with skeptism.</li><li>Have a glass of win with dinner. </li></ol><h1 id="3-How-should-I-eat"><a href="#3-How-should-I-eat" class="headerlink" title="3. How should I eat?"></a>3. How should I eat?</h1><ol start="42"><li>Pay more, eat less </li><li>Stop eating before you are full. </li><li>Eat when you are hungry, not when you are bored. </li><li>Consult your gut. Eat slowly</li><li>The banquet is in the first bite. </li><li>Spend as much time enjoying the meal as it took to prepare it. </li><li>Buy smaller plates and glasses.</li><li>Serve a proper portion and donâ€™t go back for seconds. </li><li>Breakfast like a king, lunch like a prince, dinner like a pauper. </li><li>Eat meals. </li><li>Limit your snacks to unprocessed plant foods. </li><li>Donâ€™t get your fuel from the same place your car does. hhhhhh</li><li>Do all your eating at a table</li><li>Try not to eat alone. </li><li>Treat treats as treats. </li><li>Leave sth on your plate. </li></ol>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> food </tag>
            
            <tag> diet </tag>
            
            <tag> reading </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS essential(5) - Architecting</title>
      <link href="/AWS-essential-5-Architecting/"/>
      <url>/AWS-essential-5-Architecting/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Introduction-to-well-architected-framework"><a href="#1-Introduction-to-well-architected-framework" class="headerlink" title="1. Introduction to well-architected framework"></a>1. Introduction to well-architected framework</h1><ul><li>developed through reviewing customersâ€™ architectures on AWS </li><li>build and deploy faster </li><li>lower or mitigate risks </li><li>make informed decision </li><li>learn aws best practices </li></ul><h2 id="1-1-Five-Pillars"><a href="#1-1-Five-Pillars" class="headerlink" title="1.1 Five Pillars"></a>1.1 Five Pillars</h2><h3 id="1-1-1-Operational-Excellence"><a href="#1-1-1-Operational-Excellence" class="headerlink" title="1.1.1 Operational Excellence"></a>1.1.1 Operational Excellence</h3><ul><li>Run and monitor systems to deliver business value </li><li>continually improve supporting processes and procedures </li></ul><p>Disign Principles </p><ul><li>perform operations as code </li><li>annotate documentation </li><li>make frequent, small, reversible changes </li><li>refine operations procedures frequently </li><li>anticipate failure </li><li>learn from all operational failures </li></ul><h3 id="1-1-2-Security"><a href="#1-1-2-Security" class="headerlink" title="1.1.2 Security"></a>1.1.2 Security</h3><ul><li>protect information, systems, assets </li><li>do risk assessments and mitigation strategies </li></ul><p>Design Principles </p><ul><li>Implement a strong identity foundation </li><li>enable traceability </li><li>apply security best practices </li><li>automate security best practices </li><li>protect data in transit and at rest </li><li>prepare for security events</li></ul><h3 id="1-1-3-Reliability"><a href="#1-1-3-Reliability" class="headerlink" title="1.1.3 Reliability"></a>1.1.3 Reliability</h3><ul><li>recover from infrastructure or service disruptions </li><li>dynamically acquire computing resources to meet demand </li><li>mitigate disruptions </li></ul><p>Design Principles:</p><ul><li>test recovery procedures </li><li>automatically recover from failure</li><li>scale horizontally to increase aggregate system availability </li><li>stop guessing capacity </li><li>manage change in automation </li></ul><h3 id="1-1-4-Performance-Efficiency"><a href="#1-1-4-Performance-Efficiency" class="headerlink" title="1.1.4 Performance Efficiency"></a>1.1.4 Performance Efficiency</h3><ul><li>use computing resources efficiently </li><li>maintain efficiency as demand changes and technologies evolve </li></ul><p>Design Principles </p><ul><li>Democratize advanced technologies </li><li>Go global in minutes </li><li>use serverless architectures </li><li>Experiment more often </li><li>mechanical sympathy </li></ul><h3 id="1-1-5-Cost-Optimization"><a href="#1-1-5-Cost-Optimization" class="headerlink" title="1.1.5  Cost Optimization"></a>1.1.5  Cost Optimization</h3><ul><li><p>avoid or eliminate unneeded cost or suboptimal resources<br>Design Principles </p></li><li><p>adopt a consumption model </p></li><li><p>measure overall efficiency </p></li><li><p>stop spending money on data center operations </p></li><li><p>analyze and attribute expenditure </p></li><li><p>use managed services to reduce cost of ownership </p></li></ul><h1 id="2-Fault-tolerance-and-highly-available-architecture"><a href="#2-Fault-tolerance-and-highly-available-architecture" class="headerlink" title="2. Fault tolerance and highly available architecture"></a>2. Fault tolerance and highly available architecture</h1><h2 id="2-1-Fault-tolerance"><a href="#2-1-Fault-tolerance" class="headerlink" title="2.1 Fault tolerance"></a>2.1 Fault tolerance</h2><ul><li>remain operational even if components fail </li><li>build-in redundancy of an applicationâ€™s components</li></ul><h2 id="2-2-High-Availability"><a href="#2-2-High-Availability" class="headerlink" title="2.2 High Availability"></a>2.2 High Availability</h2><ul><li>always functioning and accessible </li><li>downtime is minimized </li><li>without human intervention </li></ul><h2 id="2-3-High-availability-tools"><a href="#2-3-High-availability-tools" class="headerlink" title="2.3 High availability tools"></a>2.3 High availability tools</h2><h3 id="2-3-1-elastic-load-balancers"><a href="#2-3-1-elastic-load-balancers" class="headerlink" title="2.3.1 elastic load balancers"></a>2.3.1 elastic load balancers</h3><p>elb - distribute income traffic to your hosts, also send metrics to cloudwatch </p><h3 id="2-3-2-elastic-IP-addresses"><a href="#2-3-2-elastic-IP-addresses" class="headerlink" title="2.3.2 elastic IP addresses"></a>2.3.2 elastic IP addresses</h3><p>static IP addresses designed for dynamic cloud computing, able to mask failures </p><p>applications still accessible </p><h3 id="2-3-3-amazon-route-53"><a href="#2-3-3-amazon-route-53" class="headerlink" title="2.3.3 amazon route 53"></a>2.3.3 amazon route 53</h3><p>Authorized DNS server, </p><h3 id="2-3-4-auto-scaling"><a href="#2-3-4-auto-scaling" class="headerlink" title="2.3.4 auto scaling"></a>2.3.4 auto scaling</h3><p>launches and terminates by specified conditions </p><p>can be adjusted/ modified </p><p>create new resources on demand </p><h3 id="2-3-5-amazon-cloudwatch"><a href="#2-3-5-amazon-cloudwatch" class="headerlink" title="2.3.5 amazon cloudwatch"></a>2.3.5 amazon cloudwatch</h3><p>collects and tracks infromations </p><h2 id="2-4-Fault-tolerant-tools"><a href="#2-4-Fault-tolerant-tools" class="headerlink" title="2.4 Fault tolerant tools"></a>2.4 Fault tolerant tools</h2><ol><li>Amazon simple queue service </li><li>Amazon simple storage service </li><li>Amazon simple DB </li><li>Amazon relational database service </li></ol><h1 id="3-Web-hosting"><a href="#3-Web-hosting" class="headerlink" title="3. Web hosting"></a>3. Web hosting</h1><h2 id="3-1-benefits"><a href="#3-1-benefits" class="headerlink" title="3.1 benefits"></a>3.1 benefits</h2><ul><li>cost effective<br>handle peak capacity </li></ul><p>do on demand provisioning </p><ul><li>scalable </li><li>on demand </li></ul><h2 id="3-2-Web-hosting-services"><a href="#3-2-Web-hosting-services" class="headerlink" title="3.2 Web hosting services"></a>3.2 Web hosting services</h2><p>Products to assist transition: </p><ol><li>Amazon Virtual Private Cloud </li><li>Amazon Route 53 </li><li>Amazon CloudFront </li><li>Elastic load balancing </li><li>Firewalls/ AWS shield</li><li>Auto scaling </li><li>App servers/ EC2 instances </li><li>Amazon ElasticCache </li><li>Amazon RDS/ Amazon DynamoDB </li></ol><h2 id="3-3-Key-Architectural-considerations"><a href="#3-3-Key-Architectural-considerations" class="headerlink" title="3.3 Key Architectural considerations"></a>3.3 Key Architectural considerations</h2><ol><li>No more physical network appliances </li><li>Firewalls everywhere </li><li>consider multiple data centers </li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS essential(4)-Security</title>
      <link href="/AWS-essential-4-Security/"/>
      <url>/AWS-essential-4-Security/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Introduction-to-AWS-security"><a href="#1-Introduction-to-AWS-security" class="headerlink" title="1. Introduction to AWS security"></a>1. Introduction to AWS security</h1><ul><li>Approach to security <ul><li>resilient infrastructure </li><li>high security </li><li>strong safeguards </li></ul></li><li>Controls </li><li>AWS products and features </li></ul><ul><li><p>Network Security </p><ul><li>build in firewalls </li><li>encryption in transit </li><li>private dedicated connections </li><li>ddos mitigation </li></ul></li><li><p>Data Encryption </p><ul><li>encrption capabilities for aws storage/ database </li><li>key management options </li><li>hardware based cryptographic key storage options </li></ul></li><li><p>Access Control and management </p><ul><li>Identity and access management </li><li>Multifactor authentication </li><li>integration and federation with corporate directories </li></ul></li><li><p>Monitoring and Logging </p><ul><li>deep visibility into API calls </li><li>log aggregation and options </li><li>alerts </li></ul></li></ul><h1 id="2-The-AWS-Shared-Responsibility-Model"><a href="#2-The-AWS-Shared-Responsibility-Model" class="headerlink" title="2. The AWS Shared Responsibility Model"></a>2. The AWS Shared Responsibility Model</h1><p>Share responsibility for securing data. </p><p>AWS responsible of â€” security of the cloud </p><ul><li>compute </li><li>storage </li><li>databse </li><li>networking </li></ul><p>Customer responsible of â€”- security in the cloud </p><ul><li>what to store </li><li>which aws services </li><li>location </li><li>content format </li></ul><h1 id="3-AWS-Access-Control-and-Management"><a href="#3-AWS-Access-Control-and-Management" class="headerlink" title="3. AWS Access Control and Management"></a>3. AWS Access Control and Management</h1><h2 id="3-1-IAM-overview"><a href="#3-1-IAM-overview" class="headerlink" title="3.1 IAM overview -"></a>3.1 IAM overview -</h2><h3 id="3-1-1-Functions"><a href="#3-1-1-Functions" class="headerlink" title="3.1.1 Functions"></a>3.1.1 Functions</h3><ul><li>Control access to AWS resources </li><li>authentication<ul><li>who can access resources</li><li>use AWS IAM policy </li></ul></li><li>Authorization <ul><li>how they can use resources </li></ul></li></ul><p>Manage accesses to: </p><ul><li>compute </li><li>storage </li><li>database </li><li>application services </li></ul><h3 id="3-1-2-Roles"><a href="#3-1-2-Roles" class="headerlink" title="3.1.2 Roles"></a>3.1.2 Roles</h3><ul><li>User</li><li>Group </li><li>Permissions </li><li>Role </li></ul><h3 id="3-1-3-Features"><a href="#3-1-3-Features" class="headerlink" title="3.1.3 Features"></a>3.1.3 Features</h3><ul><li>Shared access to your AWS account </li><li>Granular permissions </li></ul><p>You can grant different permissions to different people for different resources. </p><ul><li>secure access to AWS resources for applications that run on Amazon EC2 </li></ul><p>You can use IAM features to securely provide credentials for applications that run on EC2 instances. These credentials provide permissions for your application to access other AWS resources. </p><ul><li>Multi-factor authentication(MFA)</li><li>Identity federation </li></ul><p>You can allow users who already have passwords elsewhereâ€”for example, in your corporate network or with an internet identity providerâ€”to get temporary access to your AWS account.</p><h3 id="3-1-4-functionalities"><a href="#3-1-4-functionalities" class="headerlink" title="3.1.4 functionalities"></a>3.1.4 functionalities</h3><ul><li>manage users and their access </li><li>manage roles and their permissions </li><li>manage federated users and their permissions </li></ul><h2 id="3-2-How-IAM-works"><a href="#3-2-How-IAM-works" class="headerlink" title="3.2 How IAM works"></a>3.2 How IAM works</h2><h3 id="3-2-1-Elements-contained"><a href="#3-2-1-Elements-contained" class="headerlink" title="3.2.1 Elements contained"></a>3.2.1 Elements contained</h3><ul><li>Resources <ul><li>The user, role, group and policy objects that are stored in IAM. </li></ul></li><li>Identities <ul><li>The IAM resource objects taht are used to identofy and group.  </li></ul></li></ul><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html" target="_blank" rel="noopener">Understanding how IAM works</a></p>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS essentials(3) - Core Services</title>
      <link href="/AWS-essentials-3-Core-Services/"/>
      <url>/AWS-essentials-3-Core-Services/</url>
      
        <content type="html"><![CDATA[<h1 id="1-AWS-global-infrastructure"><a href="#1-AWS-global-infrastructure" class="headerlink" title="1. AWS global infrastructure"></a>1. AWS global infrastructure</h1><h2 id="1-1-Regions"><a href="#1-1-Regions" class="headerlink" title="1.1 Regions"></a>1.1 Regions</h2><p>AWS Regions provide multiple, physically separated and isolated Availability Zones which are connected with low latency, high throughput, and highly redundant networking. </p><p><a href="https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/?p=gi&l=emea" target="_blank" rel="noopener">Region table</a></p><h2 id="1-2-Availability-Zones"><a href="#1-2-Availability-Zones" class="headerlink" title="1.2 Availability Zones"></a>1.2 Availability Zones</h2><p>These Availability Zones offer AWS customers an easier and more effective way to design and operate applications and databases, making them more highly available, fault tolerant, and scalable than traditional single datacenter infrastructures or multi-datacenter infrastructures. </p><p>Collection of data centers within a region. </p><p>isolate - protect from failures </p><p>AZs are pyhsically and logically seperated within a region. Own their own: </p><ol><li>uninterruptible power supply </li><li>cooling equipment </li><li>networking connectivity </li><li>backup generators </li></ol><h2 id="1-3-Edge-Locations"><a href="#1-3-Edge-Locations" class="headerlink" title="1.3 Edge Locations"></a>1.3 Edge Locations</h2><p>Content Delivery Network  â€”- Amazon CloudFront </p><p>Deliver content to customers </p><p>When a user requests content that youâ€™re serving with CloudFront, the user is routed to the edge location that provides the lowest latency (time delay), so that content is delivered with the best possible performance.</p><p><a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Introduction.html" target="_blank" rel="noopener">CloudFront Developer Guide</a></p><h2 id="1-4-Local-Regions"><a href="#1-4-Local-Regions" class="headerlink" title="1.4 Local Regions"></a>1.4 Local Regions</h2><p>An AWS Local Region is a single datacenter designed to complement an existing AWS Region. Like all AWS Regions, AWS Local Regions are completely isolated from other AWS Regions. </p><h1 id="2-Virtual-Private-Cloud-VPC"><a href="#2-Virtual-Private-Cloud-VPC" class="headerlink" title="2. Virtual Private Cloud (VPC)"></a>2. Virtual Private Cloud (VPC)</h1><h2 id="2-1-Introduction"><a href="#2-1-Introduction" class="headerlink" title="2.1 Introduction"></a>2.1 Introduction</h2><p>Amazon VPC enables you to launch AWS resources into a virtual network that youâ€™ve defined. This virtual network closely resembles a traditional network that youâ€™d operate in your own data center, with the benefits of using the scalable infrastructure of AWS.Consists of such features: </p><ul><li>A private, virtual network in the AWS Cloud <ul><li>Uses same concepts as on premise networking </li></ul></li><li>Allows complete control of network configuration<ul><li>Ability to isolate and expose resources inside VPC </li></ul></li><li>Offers several layers of security controls <ul><li>Ability to allow and deny specific internet and internal traffic </li></ul></li><li>Other AWS services deploy into VPC <ul><li>Services inherent security built into network </li></ul></li></ul><h2 id="2-2-Features"><a href="#2-2-Features" class="headerlink" title="2.2 Features"></a>2.2 Features</h2><ul><li><p>Build upon high availabilty of AWS regions and availability zones </p><ul><li>Amazon VPC lives within a region </li><li>Multiple VPCs per account </li></ul></li><li><p>Subnets   </p><ul><li>Used to divide Amazon VPC </li><li>Allow Amazon VPC to span multiple Azs </li><li>seperate public and private network </li></ul></li><li><p>Route tables </p><ul><li>Control traffic going out of the subnets </li></ul></li><li><p>Internet Gateway (IGW)</p><ul><li>Allows private subnet resources to access internet </li></ul></li><li><p>Network Access Control Lists(NACL)</p><ul><li>Control access to subnets; stateless </li></ul></li></ul><p><img src="https://i.loli.net/2020/01/30/3r4S8k2WYVHFqtf.png" alt="fig1.png"></p><h2 id="2-3-Subnets"><a href="#2-3-Subnets" class="headerlink" title="2.3 Subnets"></a>2.3 Subnets</h2><p>A subnet is a range of IP addresses in your VPC. You can launch AWS resources into a specified subnet. Use a public subnet for resources that must be connected to the internet, and a private subnet for resources that wonâ€™t be connected to the internet. </p><h1 id="3-AWS-Security"><a href="#3-AWS-Security" class="headerlink" title="3. AWS Security"></a>3. AWS Security</h1><h2 id="3-1-AWS-security-groups"><a href="#3-1-AWS-security-groups" class="headerlink" title="3.1 AWS security groups"></a>3.1 AWS security groups</h2><p>Filter traffic to your instances </p><p><img src="https://i.loli.net/2020/01/30/nzFWc4MZ86HimgC.png" alt="fig2.png"></p><p>Can configure the security rules, have multi rules. Web tier - application tier - database tier. </p><p>A security group acts as a virtual firewall for instances to control inbound and outbound traffic. Security group act at the instance level , not the subnet level. For each security group, you add rules that control the inbound traffic to instances, and a separate set of riles that control the outbound traffic. </p><h1 id="4-Compute-Services"><a href="#4-Compute-Services" class="headerlink" title="4. Compute Services"></a>4. Compute Services</h1><h2 id="4-1-Amazon-EC2"><a href="#4-1-Amazon-EC2" class="headerlink" title="4.1 Amazon EC2"></a>4.1 Amazon EC2</h2><p>Flexible configuration and control </p><p>maintain complete control of envs </p><p>EC2 overview </p><h3 id="4-1-1-What-is-EC2"><a href="#4-1-1-What-is-EC2" class="headerlink" title="4.1.1 What is EC2"></a>4.1.1 What is EC2</h3><p>EC2: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html" target="_blank" rel="noopener">Elastic compute cloud</a> </p><p>Compute: different thing you can do with servers </p><ul><li>Application server </li><li>Web server </li><li>Database server </li><li>Game server </li><li>Mail server </li><li>Media server </li><li>Catalog server </li><li>File server </li><li>Computing server </li><li>Proxy server </li></ul><h3 id="4-1-2-Amazon-EC2-instances-instructions"><a href="#4-1-2-Amazon-EC2-instances-instructions" class="headerlink" title="4.1.2 Amazon EC2 instances instructions"></a>4.1.2 Amazon EC2 instances instructions</h3><p>need to select AMI(Amazon Machine Image), present for software choices </p><p>Select instance type(hard ware)</p><p>Configure network, storage, key pairs (Use key value pair to access the instance)</p><h3 id="4-1-3-Features-of-EC2"><a href="#4-1-3-Features-of-EC2" class="headerlink" title="4.1.3 Features of EC2"></a>4.1.3 Features of EC2</h3><ol><li>virtual computing env. known as instances </li><li>various comfigurations of CPU, memory, and networking capacity for your instances </li><li>secure login information for your instances using key pairs(AWS stores the public key, and you store the private key)</li><li>Sotrage volumes(temporory) and persistent storage volumes â€“ Amazon Elastic Block Store</li><li>Firewall that enables you to specify the protocols, ports and source IP ranges that can reach your instances using security groups </li><li>static IPv4 addresses for dynamic cloud computing, known as Elastic IP adddresses</li><li>metadata, known as tags, that you can create and assign to your Amazon EC2 resources </li><li>Virtual networks you can create that are logically isolated from the rest of the AWS cloud</li></ol><h3 id="4-1-4-Security-best-practices"><a href="#4-1-4-Security-best-practices" class="headerlink" title="4.1.4 Security best practices"></a>4.1.4 Security best practices</h3><ol><li>Use AWS identiry and access Management(IAM) to control access to AWS resources, including instances. You can create IAM users and groups under your AWS account, assign security credentials to each, and control the access that each has to resources and services in AWS. </li><li>Restrict access by only allowing trusted hosts or networks to access ports on your instance. For example, you can restrict SSH access by restricting incoming traffic on port 22.</li></ol><h3 id="4-1-5-Instance-types"><a href="#4-1-5-Instance-types" class="headerlink" title="4.1.5 Instance types"></a>4.1.5 Instance types</h3><p>Instance type you specify determines the hardware of the host computer used for your instance. Each instance is provided with a consistent and predictable amount of CPU capacity, memory, storage. </p><ul><li>general purpose </li><li>compute optimized </li><li>memory optimized </li><li>storage optimized </li><li>accelerated computing </li></ul><h2 id="4-2-Lambda"><a href="#4-2-Lambda" class="headerlink" title="4.2 Lambda"></a>4.2 Lambda</h2><h3 id="4-2-1-Overviews"><a href="#4-2-1-Overviews" class="headerlink" title="4.2.1 Overviews"></a>4.2.1 Overviews</h3><p>AWS Lambda is a compute service that lets you run code without provisioning or managing servers. Pay for the compute time you consume. AWS Lambda runs your code on a high-availability compute infrastructure and performs all of the administration of the compute resources, <strong>including server and operating system maintenance, capacity provisioning and automatic scaling</strong>, code monitoring and logging.</p><p>fully managed serverless compute </p><p>event driven execution, respond to event </p><p>sub second metering </p><h3 id="4-2-2-benefits"><a href="#4-2-2-benefits" class="headerlink" title="4.2.2 benefits :"></a>4.2.2 benefits :</h3><ol><li>Lambda manages the compute fleet that offers a balance of memory, CPU, network and other resources. </li></ol><h3 id="4-2-3-Use-cases"><a href="#4-2-3-Use-cases" class="headerlink" title="4.2.3 Use cases"></a>4.2.3 Use cases</h3><ol><li>Run code in response to events, such as changes to data in an Amazon S3 bucket or an DynamoDB table</li><li>Run code in response to HTTP requests using Amazon API gateway</li><li>Invoke code using API calls made using AWS SDKs </li><li>Build serverless applications composed of functions that are triggered by events and automatically deploy them using AWS CodePipeline and AWS CodeBuild. </li></ol><p><img src="https://i.loli.net/2020/01/30/FND9g628EpyeMfG.png" alt="fig3.png"><br><img src="https://i.loli.net/2020/01/30/KMJhXORqAIUNBt3.png" alt="fig4.png"><br><img src="https://i.loli.net/2020/01/30/8bv7jq5etdTKH1W.png" alt="fig5.png"></p><h3 id="4-2-4-Lambda-Applications"><a href="#4-2-4-Lambda-Applications" class="headerlink" title="4.2.4 Lambda Applications"></a>4.2.4 Lambda Applications</h3><p>An AWS Lambda application is a combination of Lambda functions, event sources, and other resources that work together to perform tasks. You can use AWS CloudFormation and other tools to collect your applicationâ€™s components into a single package that can be deployed and managed as one resource. </p><h3 id="4-2-5-Work-with-AWS-Lambda-Functions"><a href="#4-2-5-Work-with-AWS-Lambda-Functions" class="headerlink" title="4.2.5 Work with AWS Lambda Functions"></a>4.2.5 Work with AWS Lambda Functions</h3><ol><li><p><a href="https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html" target="_blank" rel="noopener">Working with AWS Lambda Functions</a></p></li><li><p><a href="https://docs.aws.amazon.com/lambda/latest/dg/limits.html" target="_blank" rel="noopener">AWS Lambda Limits</a></p></li></ol><ul><li>Concurrent Executions limit: 1000 </li><li>function timeout: 15 minutes </li><li>execution threads: 1024 </li></ul><ol start="3"><li>[Building Lambda Functions]</li></ol><ul><li>Lifecycle for an AWS lambda-based application<ul><li>authoring code<ul><li><a href="https://docs.aws.amazon.com/lambda/latest/dg/programming-model-v2.html" target="_blank" rel="noopener">programing model</a> - the format of the code    </li></ul></li><li>deploying code<ul><li>Package code and dependencies in a deployment package</li><li>upload the package to AWS Lambda to create Lambda function</li></ul></li><li>monitoring<ul><li>CloudWatch    </li></ul></li><li>troubleshooting</li></ul></li></ul><ol start="4"><li><a href="https://docs.aws.amazon.com/lambda/latest/dg/use-cases.html" target="_blank" rel="noopener">Using AWS Lambda With Other Services</a></li></ol><h3 id="4-2-6-Lambda-Concepts"><a href="#4-2-6-Lambda-Concepts" class="headerlink" title="4.2.6 Lambda Concepts"></a>4.2.6 Lambda Concepts</h3><ul><li>Function - A script or program that runs in AWS Lambda. Lambda passes invocation events to your function. The function processes an event and returns a response. </li><li>Runtimes â€“ Lambda runtimes allow functions in different languages to run in the same base execution environment. You configure your function to use a runtime that matches your programming language. The runtime sits in-between the Lambda service and your function code, relaying invocation events, context information, and responses between the two. You can use runtimes provided by Lambda, or build your own. </li><li>Layers â€“ Lambda layers are a distribution mechanism for libraries, custom runtimes, and other function dependencies. Layers let you manage your in-development function code independently from the unchanging code and resources that it uses. You can configure your function to use layers that you create, layers provided by AWS, or layers from other AWS customers.</li></ul><p>A <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html" target="_blank" rel="noopener">layer</a> is a ZIP archive that contains libraries, a custom runtime or other dependencies. With layers, you can use libraries in your function without needing to include them in your deployment package. Layers let you keep your deployment package small, which makes development easier. </p><ul><li>Event source â€“ An AWS service, such as Amazon SNS, or a custom service, that triggers your function and executes its logic.</li><li>Downstream resources â€“ An AWS service, such as DynamoDB tables or Amazon S3 buckets, that your Lambda function calls once it is triggered.</li><li>Log streams â€“ While Lambda automatically monitors your function invocations and reports metrics to CloudWatch, you can annotate your function code with custom logging statements that allow you to analyze the execution flow and performance of your Lambda function to ensure itâ€™s working properly.</li><li>AWS SAM â€“ A model to define serverless applications. AWS SAM is natively supported by AWS CloudFormation and defines simplified syntax for expressing serverless resources. </li></ul><h2 id="4-3-AWS-Elastic-Beanstalk"><a href="#4-3-AWS-Elastic-Beanstalk" class="headerlink" title="4.3 AWS Elastic Beanstalk"></a>4.3 AWS Elastic Beanstalk</h2><h3 id="4-3-1-Overview"><a href="#4-3-1-Overview" class="headerlink" title="4.3.1 Overview"></a>4.3.1 Overview</h3><p>Quick get application into the cloud </p><p>Platform as a service </p><p>You can simply upload your code and Elastic Beanstalk automatically handles the deployment, from capacity provisioning, load balancing, auto-scaling to application health monitoring. At the same time, you retain full control over the AWS resources powering your application and can access the underlying resources at any time.</p><p>Allow quick deployment of your applications </p><p>Elastic Beanstalk provides:</p><ul><li>Application service</li><li>HTTP service</li><li>Operating system</li><li>Language interpreter </li><li>Host </li></ul><h1 id="5-Application-Load-Balancer"><a href="#5-Application-Load-Balancer" class="headerlink" title="5 Application Load Balancer"></a>5 Application Load Balancer</h1><h2 id="5-1-Service-Introduction"><a href="#5-1-Service-Introduction" class="headerlink" title="5.1 Service Introduction"></a>5.1 Service Introduction</h2><p>A load balancerr serves as the single point of contact for clients. The load balancer distributes incoming application traffic across multiple targets, such as EC2 instances in multiple Availability Zones. </p><p>A listener checks for connection requests from clients, using the protocol and port that you configure, and forwards requests to one or more target groups, based on the rules that you define. Each rule specifies a target group, condition, and priority. When the condition is met, the traffic is forwarded to the target group. You must define a default rule for each listener, and you can add rules that specify different target groups based on the content of the request </p><p>Each target group routes requests to one or more registered targets, such as EC2 instances, using the protocol and port number that you specify. You can register a target with multiple target groups. You can configure health checks on a per target group basis. Health checks are performed on all targets registered to a target group that is specified in a listener rule for your load balancer.</p><p>An Application Load Balancer functions at the application layer, <strong>the seventh layer</strong> of the Open Systems Interconnection (OSI) model. After the load balancer receives a request, it evaluates the listener rules in priority order to determine which rule to apply, and then selects a target from the target group for the rule action. You can configure listener rules to route requests to different target groups based on the content of the application traffic. Routing is performed independently for each target group, even when a target is registered with multiple target groups.</p><p>Part of the elastic load balancer service. Add some important features<br><img src="https://i.loli.net/2020/01/30/sHi7LhOGeYvw3Er.png" alt="fig6.png"></p><ol><li>Support more protocols  HTTP HTTPS HTTP/2 </li><li>cloudWatch Metrics   </li><li>Access logs </li><li>Health Checks </li></ol><h2 id="5-2-Key-Concepts"><a href="#5-2-Key-Concepts" class="headerlink" title="5.2 Key Concepts"></a>5.2 Key Concepts</h2><ol><li>Listeners: a process that cehcks for connection requests, using the protocol and port that you configure. Rules that you define for a listener determine how the load balancer routes requests to the targets in one or more target groups. </li><li>Target: A target is a destination for traffic based on the established listener rules </li><li>Target group: each target group routes requests to one or more registered targets using the protocol and port number specified. </li></ol><p><img src="https://i.loli.net/2020/01/30/8TBYo7tIHValjig.png" alt="fig7.png"></p><h2 id="5-3-Benefits-of-using-Application-load-balancer-instead-of-classic-load-balancer"><a href="#5-3-Benefits-of-using-Application-load-balancer-instead-of-classic-load-balancer" class="headerlink" title="5.3 Benefits of using Application load balancer instead of classic load balancer"></a>5.3 Benefits of using Application load balancer instead of classic load balancer</h2><ul><li>Support for path-based routing. You can configure rules for your listener that forward requests based on the URL in the request. This enables you to structure your application as smaller services, and route requests to the correct service based on the content of the URL.</li><li>Support for host-based routing. You can configure rules for your listener that forward requests based on the host field in the HTTP header. This enables you to route requests to multiple domains using a single load balancer.</li><li>Support for routing requests to multiple applications on a single EC2 instance. You can register each instance or IP address with the same target group using multiple ports.</li><li>Support for redirecting requests from one URL to another </li></ul><h2 id="5-4-Use-Cases"><a href="#5-4-Use-Cases" class="headerlink" title="5.4 Use Cases"></a>5.4 Use Cases</h2><ol><li>route request to different ports within a single instance.<br><img src="https://i.loli.net/2020/01/30/8125hJRUbkD3cwi.png" alt="fig8.png"></li></ol><h1 id="6-Elastic-Load-Balancer-classic-load-balancer"><a href="#6-Elastic-Load-Balancer-classic-load-balancer" class="headerlink" title="6. Elastic Load Balancer - classic load balancer"></a>6. Elastic Load Balancer - classic load balancer</h1><h2 id="6-1-Overview"><a href="#6-1-Overview" class="headerlink" title="6.1 Overview"></a>6.1 Overview</h2><p>A load balancer distributes workloads across multiple compute resources, such as virtual servers. Using a load balancer increases the availability and fault tolerance of your applications. </p><p>You can add and remove compute resources from your load balancer as your needs change, without disrupting the overall flow of requests to your applications.</p><p>You can <strong>configure health checks</strong>, which are used to monitor the health of the compute resources so that the load balancer can send requests only to the healthy ones. You can also <strong>offload the work of encryption and decryption to your load balancer</strong> so that your compute resources can focus on their main work.</p><p>Mainly consists of there types of load balancer: </p><ol><li>Application Load Balancer </li><li>Network Load Balancer</li><li>Classic Load Balancer </li></ol><p><a href="https://aws.amazon.com/elasticloadbalancing/features/#compare" target="_blank" rel="noopener">The comparison among those three</a></p><h2 id="6-2-How-does-it-work"><a href="#6-2-How-does-it-work" class="headerlink" title="6.2 How does it work?"></a>6.2 How does it work?</h2><p>A load balancer accepts incoming traffic from clients and routes requests to its registered targets. It also monitors the health of its registered targets and ensures that it routes traffic tonly to healthy targets. You configure your load balancer to accept incoming traffic by specifying one or more listeners. A listener is a process that checks for connection requests. It is configured with a protocol and port number for connections from clients to the load balancer and a protocol and port number for connections from the load balancer to the targets.</p><h3 id="6-2-1-Cross-zone-load-balancing"><a href="#6-2-1-Cross-zone-load-balancing" class="headerlink" title="6.2.1 Cross zone load balancing"></a>6.2.1 Cross zone load balancing</h3><p>The nodes for your load balancer distribute requests from clients to registered targets. When cross-zone load balancing is enabled, each load balancer node distributes traffic across the registered targets in all enabled Availability Zones. When cross-zone load balancing is disabled, each load balancer node distributes traffic across the registered targets in its Availability Zone only.</p><h3 id="6-2-2-Request-Routing"><a href="#6-2-2-Request-Routing" class="headerlink" title="6.2.2 Request Routing"></a>6.2.2 Request Routing</h3><p>Before a client sends a request to your load balancer, it resolves the load balancerâ€™s domain name using a Domain Name System (DNS) server. The DNS entry is controlled by Amazon, because your load balancers are in the amazonaws.com domain. The Amazon DNS servers return one or more IP addresses to the client, which are the IP addresses of the load balancer nodes for your load balancer. With Network Load Balancers, Elastic Load Balancing creates a network interface for each Availability Zone you enable. Each load balancer node in the Availability Zone uses this network interface to get a static IP address. You can optionally associate one Elastic IP address with each network interface when you create the load balancer.</p><p>As traffic to your application changes over time, Elastic Load Balancing scales your load balancer and updates the DNS entry. Note that the DNS entry also specifies the time-to-live (TTL) as 60 seconds, which ensures that the IP addresses can be remapped quickly in response to changing traffic.</p><p><img src="https://i.loli.net/2020/01/30/GRXtJqMcZyYvkAs.png" alt="fig9.png"></p><p><img src="https://i.loli.net/2020/01/30/oG3uYZ6OExWiQS4.png" alt="fig10.png"></p><p>Internet facing load balancers:<br><img src="https://i.loli.net/2020/01/30/OYdKufMSazqIbDQ.png" alt="fig11.png"></p><p>Internal Load Balancers: have DNS name only resolve private nodes<br><img src="https://i.loli.net/2020/01/30/IO24SbGetLaMAfo.png" alt="fig12.png"></p><h3 id="6-2-3-HTTP-Connections"><a href="#6-2-3-HTTP-Connections" class="headerlink" title="6.2.3 HTTP Connections"></a>6.2.3 HTTP Connections</h3><p>Classic Load Balancers use <strong>pre-open connections</strong> but Application Load Balancers do not. Both Classic Load Balancers and Application Load Balancers use <strong>connection multiplexing</strong>. This means that <strong>requests from multiple clients on multiple front-end connections can be routed to a given target through a single back-end connection</strong>. Connection multiplexing improves latency and reduces the load on your applications. To prevent connection multiplexing, disable HTTP keep-alives by setting the Connection: close header in your HTTP responses.</p><h2 id="6-3-Use-cases"><a href="#6-3-Use-cases" class="headerlink" title="6.3 Use cases"></a>6.3 Use cases</h2><ol><li>Access through single point </li><li>Decouple appliation environment </li><li>Provide high availability and fault tolerance </li><li>Increase elasticity and scalability </li></ol><h1 id="7-Auto-Scaling"><a href="#7-Auto-Scaling" class="headerlink" title="7. Auto Scaling"></a>7. Auto Scaling</h1><h2 id="7-1-Service-Introduction"><a href="#7-1-Service-Introduction" class="headerlink" title="7.1 Service Introduction"></a>7.1 Service Introduction</h2><p>Auto scaling helps you ensure you have the correct number of EC2 instances available to handle the load for your application. </p><p>Using cloudWatch to monitor </p><h3 id="7-1-1-Scaling-out-and-scaling-in"><a href="#7-1-1-Scaling-out-and-scaling-in" class="headerlink" title="7.1.1 Scaling out and scaling in"></a>7.1.1 Scaling out and scaling in</h3><p><img src="https://i.loli.net/2020/01/30/cHXtoB9IOURiL52.png" alt="fig13.png"></p><ul><li>Auto scaling components<ul><li>launch configuration </li><li>auto scaling group <ul><li>VPC and subnets </li><li>load balancer</li><li>minimum instances </li><li>maximum instances </li><li>desired capacity </li></ul></li><li>auto scaling policy <ul><li>scheduled</li><li>on demand </li><li>scale out policy</li><li>scale in policy </li></ul></li></ul></li></ul><h3 id="7-1-2-Dynamic-auto-scaling"><a href="#7-1-2-Dynamic-auto-scaling" class="headerlink" title="7.1.2 Dynamic auto scaling"></a>7.1.2 Dynamic auto scaling</h3><p><img src="https://i.loli.net/2020/01/30/pKFL5YWvHVOtuJw.png" alt="fig14.png"></p><p>CloudWatch detect the metrics and trigger auto scaling events. </p><h1 id="8-Amazon-Elastic-Block-Store-EBS"><a href="#8-Amazon-Elastic-Block-Store-EBS" class="headerlink" title="8. Amazon Elastic Block Store(EBS)"></a>8. Amazon Elastic Block Store(EBS)</h1><p>Amazon Elastic Block Store (Amazon EBS) provides block level storage volumes for use with EC2 instances. EBS volumes are highly available and reliable storage volumes that can be attached to any running instance that is in the same Availability Zone. </p><p>Amazon EBS is recommended when data must be quickly accessible and requires long-term persistence. EBS volumes are particularly well-suited for use as the primary storage for file systems, databases, or for any applications that require fine granular updates and access to raw, unformatted, block-level storage. </p><p>you can launch your EBS volumes as encrypted volumes.</p><p>There are three types of volumes in Amazon EBS. To understand the difference, you need to know what IOPS is. <strong>â€œIOPSâ€ stands for input/output operations per second or, put it simply, the maximum amount of read/write operations you are able to perform per second.</strong> To <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html" target="_blank" rel="noopener">choose the right Amazon EBS volume type</a> you need to know IOPS requirements for your application.</p><h2 id="8-1-General-Purpose-Volumes"><a href="#8-1-General-Purpose-Volumes" class="headerlink" title="8.1 General Purpose Volumes"></a>8.1 General Purpose Volumes</h2><p>Designed for a broad range of tasks, General Purpose Volumes are backed with Solid State Drive (SSD). The baseline performance of 3 IOPS/GB and a possibility to burst up to 10,000 IOPS makes them a good fit for AWS databases that need a lot of read and write operations, like PostgreSQL, MS SQL or Oracle databases.</p><h2 id="8-2-Provisioned-IOPS-SSD-Volumes"><a href="#8-2-Provisioned-IOPS-SSD-Volumes" class="headerlink" title="8.2 Provisioned IOPS (SSD) Volumes"></a>8.2 Provisioned IOPS (SSD) Volumes</h2><p>By expanding the bandwidth bottleneck, Provisioned IOPS Volumes allow buying read/write operations on demand regardless of the volume capacity. This type of EBS volumes is backed with the same SSD but designed for heavy workloads from 30 IOPS/GB up to 20,000 IOPS. Multiple Provisioned IOPS volumes can be striped thus ensuring up to 48,000 IOPS or 800 MBps of throughput.</p><h2 id="8-3-Magnetic-Volumes"><a href="#8-3-Magnetic-Volumes" class="headerlink" title="8.3 Magnetic Volumes"></a>8.3 Magnetic Volumes</h2><p>The best way to think of the Magnetic Volumes type is as of a low-cost volume that can be used with testing and development environments on Amazon EC2. It can also be used with applications that donâ€™t require a lot of read/write operations. Instead of SSD, this type is based on magnetic HDD drives, thus the IOPS baseline is within the range of 100 up to hundreds of IOPS. Magnetic Volumes can also become a starting point in working with Amazon EC2 â€” once you understand your IOPS demands, you can select the type of volume that fits best.</p><h1 id="9-Amazon-Simple-Storage-Service"><a href="#9-Amazon-Simple-Storage-Service" class="headerlink" title="9. Amazon Simple Storage Service"></a>9. Amazon Simple Storage Service</h1><h2 id="9-1-Introduction"><a href="#9-1-Introduction" class="headerlink" title="9.1 Introduction"></a>9.1 Introduction</h2><p>No need to manage any infrastructure yourself. S3 help you manage your storage, it can store unlimited number of objects, access any time, from anywhere; rich security controls. </p><p>Amazon Simple Storage Service (Amazon S3) is storage for the Internet. You can use Amazon S3 to store and retrieve any amount of data at any time, from anywhere on the web. You can accomplish these tasks using the AWS Management Console, which is a simple and intuitive web interface. </p><h3 id="9-1-1-steps"><a href="#9-1-1-steps" class="headerlink" title="9.1.1 steps"></a>9.1.1 steps</h3><ol><li>create a bucket </li><li>add an object to a bucket </li><li>view an object </li><li>move an object </li><li>delete an object and bucket </li></ol><h3 id="9-1-2-bucket"><a href="#9-1-2-bucket" class="headerlink" title="9.1.2 bucket"></a>9.1.2 bucket</h3><p>S3 stores data as objects within buckets. An object consists of a file and optionally any metadata that describes the file. </p><p>To store an object in Amazon S3, you upload the file you want to store to a bucket. When you upload a file, you can <strong>set permissions</strong> on the object as well as any metadata.</p><p>Buckets are the <strong>containers</strong> for objects. You can have one or more buckets. For each bucket, you can control access to it (who can create, delete, and list objects in the bucket), view access logs for it and its objects, and choose the geographical region where Amazon S3 will store the bucket and its contents.</p><p>Need a bucket to hold the data </p><p>associate in region, will make duplicate  </p><p>disigned for seamless scaling </p><h2 id="9-2-Use-cases"><a href="#9-2-Use-cases" class="headerlink" title="9.2 Use cases"></a>9.2 Use cases</h2><ol><li>store application assets </li><li>static web hosting </li><li>backup and disaster recovery </li><li>staging area for big data </li></ol><h1 id="10-Amazon-Glacier"><a href="#10-Amazon-Glacier" class="headerlink" title="10. Amazon Glacier"></a>10. Amazon Glacier</h1><h2 id="10-1-Overview"><a href="#10-1-Overview" class="headerlink" title="10.1 Overview"></a>10.1 Overview</h2><p>Data archiving solition </p><p>long tern storage at low cost </p><p>access limited by vault polocies </p><p>for data not accessed frequently </p><p><img src="https://i.loli.net/2020/01/30/gPXGKzaIuQBSpoy.png" alt="fig15.png"></p><p>It can take a really long time to retrieve data from glacier. bulk, standard, expedited. </p><p>Amazon Simple Storage Service Glacier (Amazon S3 Glacier) is a storage service optimized for infrequently used data, or â€œcold data.â€ The service provides durable and extremely low-cost storage with security features for data archiving and backup. With Amazon S3 Glacier, you can store your data cost effectively for months, years, or even decades. Amazon S3 Glacier enables you to offload the administrative burdens of operating and scaling storage to AWS, so you donâ€™t have to worry about capacity planning, hardware provisioning, data replication, hardware failure detection and recovery, or time-consuming hardware migrations. </p><h2 id="10-2-Details"><a href="#10-2-Details" class="headerlink" title="10.2 Details"></a>10.2 Details</h2><h3 id="10-2-1-archive"><a href="#10-2-1-archive" class="headerlink" title="10.2.1 archive"></a>10.2.1 archive</h3><p>An archive can be any data such as a photo, video, or document and is a base unit of storage in glacier. </p><h3 id="10-2-2-vault"><a href="#10-2-2-vault" class="headerlink" title="10.2.2 vault"></a>10.2.2 vault</h3><p>Container to store archive. When creating a vault, you specify a name and choose an AWS region where you want to create the vault.  Within a Region, an account must use unique vault names. An AWS account can create same-named vaults in different Regions.</p><h3 id="10-2-3-access-policy"><a href="#10-2-3-access-policy" class="headerlink" title="10.2.3 access policy"></a>10.2.3 access policy</h3><p>who can access </p><h3 id="10-2-4-Job"><a href="#10-2-4-Job" class="headerlink" title="10.2.4 Job"></a>10.2.4 Job</h3><p>Glacier jobs can perform a select query on an archive, retrieve an archive, or get an inventory of a vault. When performing a query on an archive, you initiate a job providing a SQL query and list of Glacier archive objects. Glacier Select runs the query in place and writes the output results to Amazon S3.</p><h2 id="10-3-use-cases"><a href="#10-3-use-cases" class="headerlink" title="10.3 use cases"></a>10.3 use cases</h2><ol><li>archive database snapshots and log files </li><li>low cost enables more comprehensive backups </li><li>archive older documents, audio, video </li></ol><h1 id="11-Amazon-Relational-Database-Service-Amazon-RDS"><a href="#11-Amazon-Relational-Database-Service-Amazon-RDS" class="headerlink" title="11. Amazon Relational Database Service (Amazon RDS)"></a>11. Amazon Relational Database Service (Amazon RDS)</h1><h2 id="11-1-Overview"><a href="#11-1-Overview" class="headerlink" title="11.1 Overview"></a>11.1 Overview</h2><h3 id="11-1-1-Chanllenges-of-relational-databases"><a href="#11-1-1-Chanllenges-of-relational-databases" class="headerlink" title="11.1.1 Chanllenges of relational databases"></a>11.1.1 Chanllenges of relational databases</h3><ol><li>server maintenance and energy footprint </li><li>software install and patches </li><li>database backups and high availability </li><li>limits on scalability </li><li>data security </li><li>os install and patches </li></ol><h3 id="11-1-2-RDS-intro"><a href="#11-1-2-RDS-intro" class="headerlink" title="11.1.2 RDS intro"></a>11.1.2 RDS intro</h3><p>Amazon RDS is a managed service that sets up and operates a relational database in the cloud. </p><p>AWS help you manage: </p><ul><li>OS installation and patches </li><li>database software install and patches </li><li>database backups </li><li>high availability </li><li>scaling </li><li>power and rack &amp; stack </li><li>server maintenance </li></ul><p>It support mainstream relation databases: </p><p><img src="https://i.loli.net/2020/01/30/FZlbiXEhuYKSsJD.png" alt="fig16.png"></p><h2 id="11-2-Use-cases"><a href="#11-2-Use-cases" class="headerlink" title="11.2 Use cases"></a>11.2 Use cases</h2><p><img src="https://i.loli.net/2020/01/30/k1PfHQxg7EYmyNp.png" alt="fig17.png"></p><h1 id="12-Amazon-DynamoDB"><a href="#12-Amazon-DynamoDB" class="headerlink" title="12. Amazon DynamoDB"></a>12. Amazon DynamoDB</h1><h2 id="12-1-Overview"><a href="#12-1-Overview" class="headerlink" title="12.1 Overview"></a>12.1 Overview</h2><h3 id="12-1-1-Features"><a href="#12-1-1-Features" class="headerlink" title="12.1.1 Features"></a>12.1.1 Features</h3><ul><li>NoSQL databse tables as a service </li><li>store as many items as you want </li><li>items may have differing attributes </li><li>low latency queries </li><li>scalable read/ write throughput </li></ul><h3 id="12-1-2-Partitioning"><a href="#12-1-2-Partitioning" class="headerlink" title="12.1.2 Partitioning"></a>12.1.2 Partitioning</h3><p>as table grows, table partitioned by key </p><p>query by key to find items efficiently </p><p>scan to find items by any attribute, less efficient </p><h2 id="12-2-Use-cases"><a href="#12-2-Use-cases" class="headerlink" title="12.2 Use cases"></a>12.2 Use cases</h2><ul><li>web </li><li>mobile apps </li><li>internet of things </li><li>ad tech </li></ul><h1 id="13-Redshift"><a href="#13-Redshift" class="headerlink" title="13. Redshift"></a>13. Redshift</h1><h2 id="13-1-Redshift-introduction"><a href="#13-1-Redshift-introduction" class="headerlink" title="13.1 Redshift introduction"></a>13.1 Redshift introduction</h2><ul><li>data warehouse, to analyze the data with query. </li><li>parallel processing architecture </li></ul><p><img src="https://i.loli.net/2020/01/30/BJDCT718z9gPV3Q.png" alt="fig18.png"></p><p>Amazon Redshift is a fast, fully managed, petabyte-scale data warehouse service that makes it simple and cost-effective to efficiently analyze all your data using your existing business intelligence tools. It is optimized for datasets ranging from a few hundred gigabytes to a petabyte or more and costs less than $1,000 per terabyte per year, a tenth the cost of most traditional data warehousing solutions.</p><h2 id="13-2-Overview"><a href="#13-2-Overview" class="headerlink" title="13.2 Overview"></a>13.2 Overview</h2><h3 id="13-2-1-Cluster-management"><a href="#13-2-1-Cluster-management" class="headerlink" title="13.2.1 Cluster management"></a>13.2.1 Cluster management</h3><p>A cluster is a set of nodes, which consists of a leader node and one or more compute nodes, The type and number of compute nodes that you need depends on the size of your data, the number of queries you will execute, and the query execution performance that you need.</p><h2 id="13-3-use-cases"><a href="#13-3-use-cases" class="headerlink" title="13.3 use cases"></a>13.3 use cases</h2><ol><li><p>Enterprise Data Warehouse (EDW)</p></li><li><p>Big Data </p></li><li><p>Saas </p></li></ol><ul><li>scale the data warehouse capacity as demand grows </li><li>add analytic functionality to applications </li><li>reduce hardware and software costs by an order of magnitude </li></ul><h1 id="14-Amazon-Aurora"><a href="#14-Amazon-Aurora" class="headerlink" title="14. Amazon Aurora"></a>14. Amazon Aurora</h1><h2 id="14-1-Overview"><a href="#14-1-Overview" class="headerlink" title="14.1 Overview"></a>14.1 Overview</h2><p>mysql relational database </p><p>It is designed to deliver the speed and reliability of high-end commercial databases in a simple and cost-effective manner. Aurora is designed to be compatible with MySQL 5.6 and delivers five times the throughput of standard MySQL running on the same hardware. DBAs are able to save time on planning backup storage disks, as data is continuously backed up to AWS S3 in real time, with no performance impact to the end user. </p><h2 id="14-2-benefits"><a href="#14-2-benefits" class="headerlink" title="14.2 benefits"></a>14.2 benefits</h2><p><img src="https://i.loli.net/2020/01/30/FLU3aykfVqnptX8.png" alt="fig19.png"></p><p><img src="https://i.loli.net/2020/01/30/E6pSOTLwcXixBgP.png" alt="fig20.png"></p><h2 id="15-Trused-Advisor"><a href="#15-Trused-Advisor" class="headerlink" title="15. Trused Advisor"></a>15. Trused Advisor</h2><p>Used to keep track of aws resources. â€“ a dashboard for all the risks and warnings that you can take actions to save money </p><p>Detect your usage in four categories: </p><ol><li>cost optimization </li><li>performance </li><li>security </li><li>fault tolerance </li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS essentials(2) - Cloud Concepts</title>
      <link href="/AWS-essentials-2-Cloud-Concepts/"/>
      <url>/AWS-essentials-2-Cloud-Concepts/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Cloud-computing"><a href="#1-Cloud-computing" class="headerlink" title="1. Cloud computing"></a>1. Cloud computing</h1><p>Before cloud, bring a lot of waste. Cause you have to build your own server. </p><p>After aws, initiated within seconds; treat these as temprorary and disposable; free from the inflexibility and constraints. </p><h1 id="2-strengths-of-cloud"><a href="#2-strengths-of-cloud" class="headerlink" title="2. strengths of cloud"></a>2. strengths of cloud</h1><h2 id="2-1-Agility"><a href="#2-1-Agility" class="headerlink" title="2.1 Agility"></a>2.1 Agility</h2><h3 id="2-1-1-speed"><a href="#2-1-1-speed" class="headerlink" title="2.1.1 speed"></a>2.1.1 speed</h3><ol><li><p>Global reach </p></li><li><p>Dramatic increase in agility </p></li></ol><h3 id="2-1-2-experimentation"><a href="#2-1-2-experimentation" class="headerlink" title="2.1.2. experimentation"></a>2.1.2. experimentation</h3><ol><li><p>operations as code </p></li><li><p>safely experiment </p></li></ol><p>can spin up servers in minutes for experimenting; can return or re-purpose servers </p><ol start="3"><li>Testing using different configurations </li><li>AWS cloudFormation enables templated environments </li></ol><h3 id="2-1-3-culture-of-innovation"><a href="#2-1-3-culture-of-innovation" class="headerlink" title="2.1.3. culture of innovation"></a>2.1.3. culture of innovation</h3><ol><li>Experiment quickly with low cost/ risk </li></ol><h3 id="2-1-4-AWS-Infrastructure"><a href="#2-1-4-AWS-Infrastructure" class="headerlink" title="2.1.4 AWS Infrastructure"></a>2.1.4 AWS Infrastructure</h3><p>To realize elasticity, scalability and reliability of computing resources, aws is build around region and availability zones. </p><ul><li><p>region </p><ul><li>physical location in the world </li><li>contains multiple AZs</li></ul></li><li><p>availability zones </p><ul><li>one or more discrete data centers </li><li>redundant power/ networking/ connectivity </li><li>housed in separate facilities </li><li>fault tolerance <ul><li>applications operational during component failure </li><li>build-in redundancy of components </li></ul></li><li>High availability <ul><li>systems always functioning and accessible </li><li>downtime is minimized as much as possible </li><li>without human intervention </li></ul></li></ul></li></ul><h2 id="2-2-Elasticity-scalability-and-high-performance"><a href="#2-2-Elasticity-scalability-and-high-performance" class="headerlink" title="2.2 Elasticity, scalability and high performance"></a>2.2 Elasticity, scalability and high performance</h2><ol><li>Tools to run a wide range of applications </li><li>auto scaling and elastic load balancing, scale up/ down based on demand </li><li>deploy your system in multiple regions, low latency and better experience</li><li>innocative services and cutting-edge technology </li><li>virtually any workload </li></ol><h2 id="2-3-Security-and-Compliance"><a href="#2-3-Security-and-Compliance" class="headerlink" title="2.3 Security and Compliance"></a>2.3 Security and Compliance</h2><ol><li>Customer retains control over region where data located </li><li>Security auditing often periodic and manual </li><li>AWS cloud provides governance capabilities </li></ol><h2 id="2-4-Reliability"><a href="#2-4-Reliability" class="headerlink" title="2.4 Reliability"></a>2.4 Reliability</h2><ol><li>Ability to recover from failures </li><li>Dynamically acquire resources to meet demand and mitigate disruptions </li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Security </tag>
            
            <tag> Agility </tag>
            
            <tag> Elasticity </tag>
            
            <tag> Reliability </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS essentials(1) - introduction</title>
      <link href="/AWS-essentials-1-introduction/"/>
      <url>/AWS-essentials-1-introduction/</url>
      
        <content type="html"><![CDATA[<h1 id="1-AWS-Cloud-Concepts"><a href="#1-AWS-Cloud-Concepts" class="headerlink" title="1. AWS Cloud Concepts"></a>1. AWS Cloud Concepts</h1><ol><li>Introduction to cloud</li><li>Introduction to the AWS Cloud</li></ol><h1 id="2-AWS-Core-Services"><a href="#2-AWS-Core-Services" class="headerlink" title="2. AWS Core Services"></a>2. AWS Core Services</h1><ol><li>Overview of Services and Categories </li><li>Introduction to the AWS Global Infrastructure </li><li>Introduction to Amazon VPC </li><li>Introduction to Security Groups </li><li>Introduction to Amazon EC2</li><li>Introduction to Amazon Elastic Block Store </li><li>Introduction to Amazon S3</li><li>Introduction to AWS Database Solutions </li></ol><h1 id="3-AWS-Security"><a href="#3-AWS-Security" class="headerlink" title="3. AWS Security"></a>3. AWS Security</h1><ol><li>Introduction to AWS Security </li><li>The AWS Shared Responsibility Model </li><li>AWS Access Control and Management </li><li>AWS Security Compliance Programs </li><li>AWS Security Resources </li></ol><h1 id="4-AWS-architecting"><a href="#4-AWS-architecting" class="headerlink" title="4. AWS architecting"></a>4. AWS architecting</h1><ol><li>Introduction to the Well-Architected Framework </li><li>Reference Architecture: Fault Tolerance and High Availability </li><li>Reference Architecture: Web Hosting </li></ol><h1 id="5-AWS-Pricing-and-Support"><a href="#5-AWS-Pricing-and-Support" class="headerlink" title="5. AWS Pricing and Support"></a>5. AWS Pricing and Support</h1><ol><li>Fundamentals of Pricing </li><li>Pricing details for EC2, S3, EBS, RDS, CloudFront </li><li>TCO calculator Overview </li><li>AWS support Plans Overview </li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ECS - Elastic Container Service</title>
      <link href="/ECS-Elastic-Container-Service/"/>
      <url>/ECS-Elastic-Container-Service/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Intro"><a href="#1-Intro" class="headerlink" title="1. Intro"></a>1. Intro</h1><ul><li>Highly scalable, fast, container management service that makes it easy to run, stop and maange docker containers on a cluster. </li></ul><p><img src="https://i.loli.net/2020/01/30/bgWNQv1M27fEza3.png" alt="fig1.png"></p><h1 id="2-Concepts"><a href="#2-Concepts" class="headerlink" title="2. Concepts"></a>2. Concepts</h1><ul><li><p>Containers</p><ul><li>Application components must be architected to run in containers </li><li>a standardized unit of development </li><li>contain everything application needs<ul><li>code </li><li>runtime </li><li>system tools </li><li>libraries </li></ul></li></ul></li><li><p>Images</p><ul><li>containers are created here</li><li>A read only templates</li></ul></li><li><p>Registry</p><ul><li>used to store images  </li></ul></li><li><p>Task </p><ul><li>text file in JSON </li><li>describes 1-10 containers to form your application </li></ul></li><li><p>Cluster </p><ul><li>logical group of resources  </li></ul></li><li><p>ECS Task scheduler</p><ul><li>responsible for placing tasks within cluster  <h1 id="3-Features"><a href="#3-Features" class="headerlink" title="3. Features"></a>3. Features</h1></li></ul></li><li><p>Regional service </p></li></ul><h1 id="4-Steps-for-starting-with-Fargate"><a href="#4-Steps-for-starting-with-Fargate" class="headerlink" title="4. Steps for starting with Fargate"></a>4. Steps for starting with Fargate</h1><ul><li>Create a task definition </li><li>Configure the service <ul><li>a service launches and maintains a specified number of copies of the task definition in cluster   </li></ul></li><li>configure the cluster </li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> ECS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elasticsearch Overview</title>
      <link href="/Elasticsearch-Overview/"/>
      <url>/Elasticsearch-Overview/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-Intro"><a href="#1-1-Intro" class="headerlink" title="1.1 Intro"></a>1.1 Intro</h2><ul><li>Full-text search</li><li>Analytics engine </li><li>Can analyze big volumes of data in near real time </li><li>used as the underlying engine/ tech that powers applications that have complex search features and requirements. </li></ul><h2 id="1-2-Use-cases"><a href="#1-2-Use-cases" class="headerlink" title="1.2 Use cases"></a>1.2 Use cases</h2><ol><li>online web store - allow customers to search for products. - use Elasticsearch to store entire product catelog and inventory. Provide search and autocomplete suggestions for them. </li><li>collect log or transaction data - mine data to look for trends, statistics, summarizations, or anomalies </li><li>price alert platform - scrape vendor prices, push them into Elasticsearch and use its reverse-search (Percolator) capability to match price movements against customer queries and eventually push the alerts out to the customer once matches are found</li><li>analytics/business-intelligence needs and want to quickly investigate, analyze, visualize, and ask ad-hoc questions on a lot of data (think millions or billions of records). In this case, you can use Elasticsearch to store data and then use Kibana to build custom dashboards that can visualize aspects of data. Additionally, you can use the Elasticsearch aggregations functionality to perform complex business intelligence queries against your data.</li></ol><h2 id="1-3-Basic-concepts"><a href="#1-3-Basic-concepts" class="headerlink" title="1.3 Basic concepts"></a>1.3 Basic concepts</h2><h3 id="1-3-1-NRT"><a href="#1-3-1-NRT" class="headerlink" title="1.3.1 NRT"></a>1.3.1 NRT</h3><p>Near Realtime: it only has a slight latency from the time you index a document until the time it becomes searchable. </p><h3 id="1-3-2-Cluster"><a href="#1-3-2-Cluster" class="headerlink" title="1.3.2 Cluster"></a>1.3.2 Cluster</h3><p>A cluster is a collection of one or more nodes <strong>(servers)</strong> that together <strong>holds your entire data</strong> and provides <strong>federated indexing and search capabilities</strong> across all nodes.</p><h3 id="1-3-3-Node"><a href="#1-3-3-Node" class="headerlink" title="1.3.3 Node"></a>1.3.3 Node</h3><p>A node is a single server that is part of your cluster, stores your data, and participates in the clusterâ€™s indexing and search capabilities. </p><h3 id="1-3-4-Index"><a href="#1-3-4-Index" class="headerlink" title="1.3.4 Index"></a>1.3.4 Index</h3><p>An index is a collection of documents that have somewhat similar characteristics. For example, you can have an index for customer data, another index for a product catalog, and yet another index for order data. </p><p>An index is <strong>identified by a name</strong> (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.</p><h3 id="1-3-5-Document"><a href="#1-3-5-Document" class="headerlink" title="1.3.5 Document"></a>1.3.5 Document</h3><p>A document is a basic unit of information that can be indexed. For example, you can have a document for a single customer, another document for a single product, and yet another for a single order. This document is expressed in JSON (JavaScript Object Notation) which is a ubiquitous internet data interchange format.</p><p>Within an index/type, you can store as many documents as you want. Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.</p><h3 id="1-3-6-Shards-amp-Replicas"><a href="#1-3-6-Shards-amp-Replicas" class="headerlink" title="1.3.6 Shards &amp; Replicas"></a>1.3.6 Shards &amp; Replicas</h3><p>An index can potentially store a large amount of data that can exceed the hardware limits of a single node. For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.</p><p>To solve this problem, Elasticsearch provides the ability to <strong>subdivide your index into multiple pieces called shards.</strong> When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent â€œindexâ€ that can be hosted on any node in the cluster.</p><p>Sharding brings you several benefits: </p><ol><li>Allow you to horizontally <strong>split/ scale content volume</strong> </li><li>Allow you to <strong>distribute and parallelize</strong> operations across shards thus increasing performance/ throughput </li></ol><p>Mechanics of how a shard is distributed and how its documents are aggregated back into search reqeusts are completely managed by elasticSearch. </p><p>To summarize, each index can be split into multiple shards. An index can also be replicated zero (meaning no replicas) or more times. Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards).</p><h1 id="2-Benefits"><a href="#2-Benefits" class="headerlink" title="2. Benefits"></a>2. Benefits</h1><ol><li>search faster compared with database </li><li>During an indexing operation, Elasticsearch converts raw data such as log files or message files into internal documents and stores them in a basic data structure similar to a JSON object. Each document is a simple set of correlating keys and values: the keys are strings, and the values are one of numerous data typesâ€”strings, numbers, dates, or lists.</li></ol><h1 id="3-Where-do-the-Files-come-from"><a href="#3-Where-do-the-Files-come-from" class="headerlink" title="3. Where do the Files come from?"></a>3. Where do the Files come from?</h1><p>Elasticsearch uses Lucene under the hood to handle the indexing and querying on the shard level, the files in the data directory are written by both Elasticsearch and Lucene. </p><p>Lucene is responsible for writing and maintaining the L<strong>ucene index files while Elasticsearch writes metadata related to features on top of Lucene</strong>, such as field mappings, index settings and other cluster metadata â€“ end user and supporting features that do not exist in the low-level Lucene but are provided by Elasticsearch.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html</a> </li><li><a href="http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html</a> </li><li><a href="https://www.elastic.co/blog/found-dive-into-elasticsearch-storage" target="_blank" rel="noopener">https://www.elastic.co/blog/found-dive-into-elasticsearch-storage</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elastic Search </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS X-Ray Intro(Java)</title>
      <link href="/AWS-X-Ray-Intro-Java/"/>
      <url>/AWS-X-Ray-Intro-Java/</url>
      
        <content type="html"><![CDATA[<p>Fancy tech! You now can trace the performance not only for request and response, also about calls that your application makes to downstream AWS resources, microservices, databases and HTTP web APIs with AWS X-ray! </p><h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-What-does-X-ray-do"><a href="#1-1-What-does-X-ray-do" class="headerlink" title="1.1 What does X-ray do?"></a>1.1 What does X-ray do?</h2><ul><li>service that collects data about requests that your application serves</li><li>provide tools to view, filter, gain insights into that data </li><li>Can see detailed information not only about the request and response, but also about calls that your application makes to downstream AWS resources, microservices, databases and HTTP web APIs. </li></ul><h2 id="1-2-X-ray-SDK-provides"><a href="#1-2-X-ray-SDK-provides" class="headerlink" title="1.2 X-ray SDK provides"></a>1.2 X-ray SDK provides</h2><ul><li>Interceptors: add to your code to trace incoming HTTP requests </li><li>Client Handlers: instrument AWS SDK clients that your application uses to call other AWS services </li><li>An HTTP clinet to use to to instrument calls to other internal and external HTTP web services </li></ul><h2 id="1-3-Mechanism"><a href="#1-3-Mechanism" class="headerlink" title="1.3 Mechanism"></a>1.3 Mechanism</h2><p>SDK sends JSON segment documents to a daemon process listening for UDP traffic. <strong><em>The X-Ray daemon buffers segments in a queue and uploads them to X-Ray in batches</em></strong></p><p>X-Ray use the trace data to generate a detailed service graph, which shows the client, your front-end service, and backend services that your front-end service calls to process requests and persist data.</p><h1 id="2-Use-cases-and-requirement"><a href="#2-Use-cases-and-requirement" class="headerlink" title="2. Use cases and requirement"></a>2. Use cases and requirement</h1><ul><li><p>Use X-Ray SDK and AWS service integration to instrument requests to your applications that are running locally or on AWS compute services. </p></li><li><p>X-Ray SDK records data about <strong>incoming and outgoing requests</strong> and sends it to the X-Ray daemon(relays the data in batches to X-Ray)</p></li><li><p>When your application calls DDB to retrieve user information from a DDB table, the X-Ray SDK records data from both <strong>the client request and the downstream call</strong> to DynamoDB. </p></li><li><p>Service Integration </p><ul><li>Add tracing headers to incoming requests </li><li>send trace data to X-Ray </li><li>run the X-Ray daemon </li></ul></li><li><p>Java Integration </p><ul><li>Add a servlet filter </li></ul></li><li><p>Supported AWS services</p><ul><li>AWS lambda </li><li>Amazon API Gateway </li><li>Elastic Load Balancing </li><li>AWS Elastic ZBeanstalk </li></ul></li><li><p>Code and configuration changes </p><ul><li>Detailed tracing of front-end and downstream calls requires only <strong>minimal changes to build and deploy-time configuration</strong>.</li><li><strong>AWS resource configuration</strong>: Change AWS resource settings to <strong>instrument requests to a Lambda function</strong>. Run the X-Ray daemon on the instances in your Elastic Beanstalk environment by changing an option setting</li><li><strong>Build configuration</strong>: Take X-Ray SDK for Java submodules as a <strong>compile-time dependency</strong> to instrument all downstream requests to AWS services, and to resources such as Amazon DynamoDB tables, Amazon SQS queues, and Amazon S3 buckets.</li><li><strong>Application configuration</strong>: To instrument incoming HTTP requests, add a <strong>servlet filter</strong> to your Java application</li><li><strong>Class or object configuration</strong> â€“ To instrument outgoing HTTP calls in Java, import the X-Ray SDK for Java version of HttpClientBuilder instead of the Apache.org version.</li><li><strong>Functional Changes</strong>: Add a *<em>request handler *</em>to an AWS SDK client to instrument calls that it makes to AWS services. Create subsegments to group downstream calls, and add debug information to segments with annotations and metadata.</li></ul></li></ul><h1 id="3-Concepts"><a href="#3-Concepts" class="headerlink" title="3. Concepts"></a>3. Concepts</h1><h2 id="3-1-Segments"><a href="#3-1-Segments" class="headerlink" title="3.1 Segments"></a>3.1 Segments</h2><p>The compute resources running your application logic send data about their work as <strong>segments</strong>. A segment provides the resourceâ€™s name, details about the request, and details about the work done. For example, when an HTTP request reaches your application, it can record the following data about:</p><ul><li>Host </li><li>Request </li><li>Response </li><li>Work done<ul><li>start time </li><li>end time</li><li>subsegments </li></ul></li><li>issues that occur </li></ul><h2 id="3-2-Subsegments"><a href="#3-2-Subsegments" class="headerlink" title="3.2 Subsegments"></a>3.2 Subsegments</h2><p>A segment can break down the data about the work done into subsegments. Subsegments provide more granular timing information and details about downstream calls that your application made to fulfill the original request. A subsegment can contain additional details about a call to an AWS service, an external HTTP API, or an SQL database. You can even define arbitrary subsegments to instrument specific functions or lines of code in your application.</p><h2 id="3-3-Service-Graph"><a href="#3-3-Service-Graph" class="headerlink" title="3.3 Service Graph"></a>3.3 Service Graph</h2><p>X-Ray uses the data that your application sends to generate a service graph. Each AWS resource that sends data to X-Ray appears as a service in the graph. Edges connect the services that work together to serve requests. Edges connect clients to your application, and your application to the downstream services and resources that it uses.</p><p>A service graph is <strong>a JSON document</strong> that contains information about the services and resources that make up your application. The X-Ray console uses the service graph to generate a visualization or service map.</p><h2 id="3-4-Traces"><a href="#3-4-Traces" class="headerlink" title="3.4 Traces"></a>3.4 Traces</h2><p>A trace ID <strong>tracks the path of a request through whole application</strong>. A trace collects all the segments generated by a single request. That request is typically an HTTP GET or POST request that travels through a load balancer, hits your application code, and generates downstream calls to other AWS services or external web APIs. </p><p>The <strong>first supported service</strong> that the HTTP request interacts with adds a trace ID header to the request, and propagates it downstream to track the latency, disposition, and other request data.</p><h2 id="3-5-Sampling"><a href="#3-5-Sampling" class="headerlink" title="3.5 Sampling"></a>3.5 Sampling</h2><p>To ensure efficient tracing and provide a representative sample of the requests that your application serves, the X-Ray SDK applies a sampling algorithm to determine which requests get traced. By default, the X-Ray SDK records the <strong>first request</strong> each second, and <strong>five percent</strong> of any additional requests.</p><h2 id="3-6-Tracing-Header"><a href="#3-6-Tracing-Header" class="headerlink" title="3.6 Tracing Header"></a>3.6 Tracing Header</h2><p>All requests are traced, up to a configurable minimum. After reaching that minimum, a percentage of requests are traced to avoid unnecessary cost. The sampling decision and trace ID are <strong>added to HTTP requests in tracing headers named X-Amzn-Trace-Id</strong>.</p><h1 id="4-AWS-X-Ray-Daemon"><a href="#4-AWS-X-Ray-Daemon" class="headerlink" title="4. AWS X-Ray Daemon"></a>4. AWS X-Ray Daemon</h1><p>Daemon is a software application, listening for traffic on UDP port 2000, gather <strong>raw segment data</strong>, and relays it to the AWS X-ray API. </p><p>You need give Daemon enough permissions to send data to X-Ray. </p><h1 id="5-Working-with-Java"><a href="#5-Working-with-Java" class="headerlink" title="5. Working with Java"></a>5. Working with Java</h1><p>The X-Ray SDK for Java provides a class named <strong>AWSXRay</strong> that provides the global recorder, a <strong>TracingHandler</strong> that you can use to instrument your code. You can configure the global recorder to customize the <strong>AWSXRayServletFilter</strong> that creates segments for incoming HTTP calls.</p><h2 id="5-1-Sampling-Rules"><a href="#5-1-Sampling-Rules" class="headerlink" title="5.1 Sampling Rules"></a>5.1 Sampling Rules</h2><p>SDK uses the sampling rules deined in the X-Ray console to determine which requests to record. The default rule traces the first request each second, and five percent of any additional requests across all services sending trances to X-Ray. </p><h2 id="5-2-Tracing-Incoming-requests-with-the-X-Ray-SDK"><a href="#5-2-Tracing-Incoming-requests-with-the-X-Ray-SDK" class="headerlink" title="5.2 Tracing Incoming requests with the X-Ray SDK"></a>5.2 Tracing Incoming requests with the X-Ray SDK</h2><p>Use the X-Ray SDK to *<em>trace incoming HTTP requests *</em>that your application serves on an EC2 instance in Amazon EC2, AWS Elastic Beanstalk, or Amazon ECS. </p><p>Use a <strong>Filter</strong> to instrument incoming HTTP requests. When you add the X-Ray servlet filter to your application, the X-Ray SDK for Java <strong>creates a segment for each sampled request</strong>. This segment includes timing, method, and disposition of the HTTP request. Additional instrumentation creates subsegments on this segment.</p><p>Each segment has a name that identifies your application in the service map. The segment can be named statically, or you can configure the SDK to name it dynamically based on the host header in the incoming request. Dynamic naming lets you group <strong>traces based on the domain name in the request</strong></p><p>The message handler creates a segment for each incoming request with an http block that contains the following information:</p><ul><li>HTTP method</li><li>Client address </li><li>Response code </li><li>Timing </li><li>User agent </li><li>Content length </li></ul><h2 id="5-3-Tracing-AWS-SDK-calls-with-the-X-Ray-SDK-for-Java"><a href="#5-3-Tracing-AWS-SDK-calls-with-the-X-Ray-SDK-for-Java" class="headerlink" title="5.3 Tracing AWS SDK calls with the X-Ray SDK for Java"></a>5.3 Tracing AWS SDK calls with the X-Ray SDK for Java</h2><p>When your application <strong>makes calls to AWS services to store data</strong>, write to a queue, or send notifications, the X-Ray SDK for Java <strong>tracks the calls downstream in subsegments</strong>. Traced AWS services and resources that you access within those services (for example, an Amazon S3 bucket or Amazon SQS queue), appear as downstream nodes on the service map in the X-Ray console.</p><p>The X-Ray SDK for Java <strong>automatically instruments all AWS SDK clients when you include the aws-sdk and aws-sdk-instrumentor submodules in your build</strong>. If you donâ€™t include the Instrumentor submodule, you can choose to instrument some clients while excluding others.</p><p>E.G: instrument an AmazonDynamoDB client, pass a tracing handler to AmazonDynamoDBClientBuilder</p><pre><code>import com.amazonaws.xray.AWSXRay;import com.amazonaws.xray.handlers.TracingHandler;...public class MyModel {  private AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()        .withRegion(Regions.fromName(System.getenv(&quot;AWS_REGION&quot;)))        .withRequestHandlers(new TracingHandler(AWSXRay.getGlobalRecorder()))        .build();</code></pre><h2 id="5-4-Tracing-Calls-to-Downstream-HTTP-Web-Services-with-the-X-Ray-SDK-for-Java"><a href="#5-4-Tracing-Calls-to-Downstream-HTTP-Web-Services-with-the-X-Ray-SDK-for-Java" class="headerlink" title="5.4 Tracing Calls to Downstream HTTP Web Services with the X-Ray SDK for Java"></a>5.4 Tracing Calls to Downstream HTTP Web Services with the X-Ray SDK for Java</h2><p>When your application makes call to microservices or publis HTTP APIs, you can use the X-Ray SDK for javaâ€™s version of <strong>HTTPClient</strong> to instrument those calls and add the API to the service graph as a downstream service. ** Use the xray HttpClientBuilder **</p><h2 id="5-5-Custom-subsegments-with-the-X-Ray-SDK-for-Java"><a href="#5-5-Custom-subsegments-with-the-X-Ray-SDK-for-Java" class="headerlink" title="5.5 Custom subsegments with the X-Ray SDK for Java"></a>5.5 Custom subsegments with the X-Ray SDK for Java</h2><p>Subsegments extend a traceâ€™s segment with details about work done in order to serve a request. Each time you make a call with an instrumented client, the X-Ray SDK records the information generated in a subsegment. You can create additional subsegments to group other subsegments, to measure the performance of a section of code, or to record annotations and metadata.</p><p>To manage subsegments, use the beginSubsegment and endSubsegment methods.</p><pre><code>import com.amazonaws.xray.AWSXRay;...  public void saveGame(Game game) throws SessionNotFoundException {    // wrap in subsegment    Subsegment subsegment = AWSXRay.beginSubsegment(&quot;Save Game&quot;);    try {      // check session      String sessionId = game.getSession();      if (sessionModel.loadSession(sessionId) == null ) {        throw new SessionNotFoundException(sessionId);      }      mapper.save(game);    } catch (Exception e) {      subsegment.addException(e);      throw e;    } finally {      AWSXRay.endSubsegment();    }  }</code></pre><h2 id="5-6-Add-Annotations-and-Metadata-to-Segments-with-the-X-Ray-SDK-for-Java"><a href="#5-6-Add-Annotations-and-Metadata-to-Segments-with-the-X-Ray-SDK-for-Java" class="headerlink" title="5.6 Add Annotations and Metadata to Segments with the X-Ray SDK for Java"></a>5.6 Add Annotations and Metadata to Segments with the X-Ray SDK for Java</h2><p> You can add annotations and metadata to the segments that the X-Ray SDK creates, or to custom subsegments that you create.</p><p> Annotations are key-value pairs with string, number, or Boolean values. Annotations are indexed for use with filter expressions. Use annotations to record data that you <strong>want to use to group traces</strong> in the console, or when calling the GetTraceSummaries API.</p><p> Metadata are key-value pairs that can have values of any type, including objects and lists, but are not indexed for use with filter expressions. <strong>Use metadata to record additional data that you want stored in the trace but donâ€™t need to use with search</strong>.</p>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Distributed Tracing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS-VPC</title>
      <link href="/AWS-VPC/"/>
      <url>/AWS-VPC/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-a-VPC"><a href="#1-What-is-a-VPC" class="headerlink" title="1. What is a VPC?"></a>1. What is a VPC?</h1><p>A virtual private cloud (VPC) is a <strong>virtual network</strong> dedicated to your AWS account. It is logically isolated from other virtual networks in the AWS Cloud. Amazon Virtual Private Cloud (Amazon VPC) enables you to launch AWS resources into a virtual network that youâ€™ve defined. This virtual network closely resembles a traditional network that youâ€™d operate in your own data center, with the benefits of using the scalable infrastructure of AWS. </p><p><img src="https://i.loli.net/2020/01/30/iduxJISlrmp5h2s.jpg" alt="fig1.jpg"></p><p>It allows you to provision a <strong>logically isolated section</strong> of the AWS cloud, where you can launch AWS resources in a virtual network that you define. You have complete control over your virtual networking environment including: </p><ul><li>selection of your own IP address ranges</li><li>creation of subnets </li><li>configuration of route tables and network gateways </li><li>create a hardware Virtual Private Network(VPN) connection between your corporate datacenter and your VPC and leverage the AWS cloud as an extension of your corporate datacenter. </li></ul><p><img src="https://i.loli.net/2020/01/30/kjVFzSHfdcyUspB.jpg" alt="fig2.jpg"></p><h1 id="2-Protection-through-Security-Groups-and-Control-Lists"><a href="#2-Protection-through-Security-Groups-and-Control-Lists" class="headerlink" title="2. Protection through Security Groups and Control Lists"></a>2. Protection through Security Groups and Control Lists</h1><p>We can leverage multiple layers of security, including security groups and network access control lists, to help control access to Amazon EC2 instances in each subnet. <strong>Security groups</strong> act as a firewall for the Amazon EC2 instances controlling both inbound and outbound traffic <strong>at the instance level</strong>. <strong>Network Acess Control Lists</strong>(NACLâ€™s) act as a firewall for associated subnets controlling both inbound and outbound traffic <strong>at the subnet level</strong>. </p><table><thead><tr><th><strong>Security Group</strong></th><th><strong>Network ACL</strong></th></tr></thead><tbody><tr><td>Operates at the instance level (first layer of defense).</td><td>Operates at the subnet level (second layer of defense)</td></tr><tr><td>Is stateful. Return traffic is automatically allowed, regardless of any rules.</td><td>Is stateless. Return traffic must be explicitly allowed by rules.</td></tr><tr><td>Applies to an instance only if someone specifies the security group when launching the instance, or associates the security group with the instance later on.</td><td>Automatically applies to all instances in the subnets associated with it (backup layer of defense, so you donâ€™t have to rely on someone specifying the security group).</td></tr></tbody></table><h1 id="3-Primary-Components-needed-to-configure-networking-in-a-VPC"><a href="#3-Primary-Components-needed-to-configure-networking-in-a-VPC" class="headerlink" title="3. Primary Components needed to configure networking in a VPC"></a>3. Primary Components needed to configure networking in a VPC</h1><h2 id="3-1-Network-Interfaces"><a href="#3-1-Network-Interfaces" class="headerlink" title="3.1 Network Interfaces"></a>3.1 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_ElasticNetworkInterfaces.html" target="_blank" rel="noopener">Network Interfaces</a></h2><p>A logical networking component in a VPC that represents a virtual network card. Includes attributes as following: </p><ul><li><p>a primary private IPv4 address</p></li><li><p>one or more secondary private IPv4 addresses</p></li><li><p>one Elastic IP address per private IPv4 address</p></li><li><p>one public IPv4 address, which can be auto-assigned to the network interface for eth0 when you launch an instance</p></li><li><p>one or more IPv6 addresses</p></li><li><p>one or more security groups</p></li><li><p>a MAC address</p></li><li><p>a source/destination check flag</p></li><li><p>a description</p></li></ul><p>You can create a network interface, attach it to an instance, detach it from an instance, and attach it to another instance. A network interfaceâ€™s attributes follow it as it is attached or detached from an instance and reattached to another instance. When you move a network interface from one instance to another, network traffic is redirected to the new instance.</p><h2 id="3-2-Route-Tables"><a href="#3-2-Route-Tables" class="headerlink" title="3.2 Route Tables"></a>3.2 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html" target="_blank" rel="noopener">Route Tables</a></h2><p>A route table contains a set of rules, called routes, that are used to determine where network traffic is directed.</p><p>Each subnet in your VPC must be associated with a route table; the table controls the routing for the subnet. A subnet can only be associated with one route table at a time, but you can associate multiple subnets with the same route table.</p><h2 id="3-3-Internet-Gateway"><a href="#3-3-Internet-Gateway" class="headerlink" title="3.3 Internet Gateway"></a>3.3 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Internet_Gateway.html" target="_blank" rel="noopener">Internet Gateway</a></h2><p>A VPC component that allows communication between instances in your VPC and the Internet. In theory, it is what the traffic between your VPC and the public internet flows through.</p><h2 id="3-4-Egress-Only-Internet-Gateway"><a href="#3-4-Egress-Only-Internet-Gateway" class="headerlink" title="3.4 Egress-Only Internet Gateway"></a>3.4 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/egress-only-internet-gateway.html" target="_blank" rel="noopener">Egress-Only Internet Gateway</a></h2><p>An egress-only Internet gateway is a horizontally scaled, redundant, and highly available VPC component that allows outbound communication over IPv6 from instances in your VPC to the Internet, and prevents the Internet from initiating an IPv6 connection with your instances.</p><h2 id="3-5-DHCP-Options-Sets"><a href="#3-5-DHCP-Options-Sets" class="headerlink" title="3.5 DHCP Options Sets"></a>3.5 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_DHCP_Options.html" target="_blank" rel="noopener">DHCP Options Sets</a></h2><p>Dynamoc Host Configuration Protocol provides a standard for passing configuraion information to hosts on a TCP/IP network. The options field of a DHCP message contains the configuration parameters. Some of those parameters are the domain name, domain name server, and the netbios-node-type.</p><h2 id="3-6-Domain-Name-System"><a href="#3-6-Domain-Name-System" class="headerlink" title="3.6 Domain Name System"></a>3.6 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html" target="_blank" rel="noopener">Domain Name System</a></h2><p>Domain Name System (DNS) is a standard by which names used on the Internet are resolved to their corresponding IP addresses. A DNS hostname is a name that uniquely and absolutely names a computer; itâ€™s composed of a host name and a domain name. DNS servers resolve DNS hostnames to their corresponding IP addresses.</p><p>Public IPv4 addresses enable communication over the Internet, while private IPv4 addresses enable communication within the network of the instance (either EC2-Classic or a VPC).</p><h2 id="3-7-Elastic-IP-Addresses"><a href="#3-7-Elastic-IP-Addresses" class="headerlink" title="3.7 Elastic IP Addresses"></a>3.7 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-eips.html" target="_blank" rel="noopener">Elastic IP Addresses</a></h2><p>An Elastic IP address is a static public IPv4 address designed for dynamic cloud computing. You can associate an Elastic IP address with any instance or network interface for any VPC in your account. </p><p>With an Elastic IP address, <strong>you can mask the failure of an instance by rapidly remapping the address to another instance in your VPC.</strong> Note that the advantage of associating the Elastic IP address with the network interface instead of directly with the instance is that you can move all the attributes of the network interface from one instance to another in a single step.</p><h2 id="3-8-VPC-Endpoints"><a href="#3-8-VPC-Endpoints" class="headerlink" title="3.8 VPC Endpoints"></a>3.8 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html" target="_blank" rel="noopener">VPC Endpoints</a></h2><p>Enables private connectivity to services hosted in AWS, from within your VPC without using an Internet Gateway, VPN, Network Address Translation (NAT) devices, or firewall proxies.</p><h2 id="3-9-NAT-Gateways"><a href="#3-9-NAT-Gateways" class="headerlink" title="3.9 NAT Gateways"></a>3.9 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat.html" target="_blank" rel="noopener">NAT Gateways</a></h2><p>A highly available, managed Network Address Translation (NAT) service for your resources in a private subnet to access the Internet. A NAT device forwards traffic from the instances in the private subnet to the internet or other AWS services, and then sends the response back to the instances. When traffic goes to the internet, the source IPv4 address is replaced with the NAT deviceâ€™s address and similarly, when the response traffic goes to those instances, the NAT device translates the address back to those instancesâ€™ private IPv4 addresses.</p><h2 id="3-10-VPC-Peering"><a href="#3-10-VPC-Peering" class="headerlink" title="3.10 VPC Peering"></a>3.10 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-peering.html" target="_blank" rel="noopener">VPC Peering</a></h2><p>A peering connection enables you to route traffic via private IP addresses between two peered VPCs.</p><p>A VPC peering connection is a networking connection between two VPCs that enables you to route traffic between them privately. Instances in either VPC can communicate with each other as if they are within the same network. You can create a VPC peering connection between your own VPCs, with a VPC in another AWS account, or with a VPC in a different AWS Region.</p><h1 id="4-Securing-VPCs"><a href="#4-Securing-VPCs" class="headerlink" title="4. Securing VPCs"></a>4. Securing VPCs</h1><h2 id="4-1-Security-Groups"><a href="#4-1-Security-Groups" class="headerlink" title="4.1 Security Groups"></a>4.1 Security Groups</h2><p>A firewall for associated Amazon EC2 instances, controlling both inbound and outbound traffic at the instance level</p><h2 id="4-2-Network-Access-Control-Lists"><a href="#4-2-Network-Access-Control-Lists" class="headerlink" title="4.2 Network Access Control Lists"></a>4.2 Network Access Control Lists</h2><p>A firewall for associated subnets, controlling both inbound and outbound traffic at the subnet level.</p><h2 id="4-3-Flow-Logs"><a href="#4-3-Flow-Logs" class="headerlink" title="4.3 Flow Logs"></a>4.3 Flow Logs</h2><p>Capture information about the IP traffic going to and from network interfaces in your VPC.</p><h2 id="4-4-Route-Tables"><a href="#4-4-Route-Tables" class="headerlink" title="4.4 Route Tables"></a>4.4 Route Tables</h2><p>A set of rules, called routes, that are used to determine where network traffic is directed</p><p>The following diagram illustrates the layers of security provided by security groups and network ACLs. In this example, traffic from an Internet gateway is routed to the appropriate subnet using the routes in the routing table. The rules of the network ACL associated with the subnet control which traffic is allowed to the subnet. The rules of the security group associated with an instance control which traffic is allowed to the instance.</p><p><img src="https://i.loli.net/2020/01/30/aeb1wYkCq2c9QXr.png" alt="fig3.png"></p><h1 id="5-Default-VPC"><a href="#5-Default-VPC" class="headerlink" title="5. Default VPC"></a>5. Default VPC</h1><p>The default VPC is suitable for getting started quickly, and for launching public instances such as a blog or simple website. With a default VPC, you donâ€™t have to deal with VPC creation and configuration. You can immediately start launching Amazon EC2 instances into your default VPC. You can also use services such as Elastic Load Balancing, Amazon RDS, and Amazon EMR in your default VPC.</p><p>You can use a default VPC as you would use any other VPC by: </p><ul><li>Adding additional non-default subnets</li><li>Modifying the main route table </li><li>Adding additional route tables </li><li>Associating additional security groups </li><li>Updating the rules of the default security group</li><li>Adding VPN connections</li><li>Adding more IPv4 CIDR blocks </li></ul><p>The following figure illustrates the key components that we set up for a default VPC. </p><p><img src="https://i.loli.net/2020/01/30/ig6ZwzSrFmqojPk.png" alt="fig4.png"></p>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> VPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS Lambda</title>
      <link href="/AWS-Lambda/"/>
      <url>/AWS-Lambda/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>A compute service that lets you run code without provisioning or managing servers. It can executes your code thousands per second. You pay for the compute time you consume.</p><p>Lambda executes your code on a high-availability compute infrastructure and performs all of the administration of the compute resources, including server and operating system maintenance, capacity provisioning and automatic scaling, code monitoring and logging.</p><p>You can run AWS lambda to run your code in response to events, such as changes to data in an Amazon S3 bucket or an Amazon DynamoDB table; to run your code in response to HTTP requests using Amazon API gateway; or invoke your code using API calls made using AWS SDKs. </p><h1 id="2-Getting-started"><a href="#2-Getting-started" class="headerlink" title="2. Getting started"></a>2. Getting started</h1><h2 id="2-1-Configuration-on-console-page"><a href="#2-1-Configuration-on-console-page" class="headerlink" title="2.1 Configuration on console page"></a>2.1 Configuration on console page</h2><ul><li>environment variables: for Lambda functions enable you to dynamically pass settings to your function code and libraries, without making changes to your code.</li><li>Tags: are key-value pairs that you attach to AWS resources to better organize them. </li><li>Execution role: which allows you to administer security on your function, using defined roles and policies or creating new ones.</li><li>Basic settings: allows you to dictate the memory allocation and timeout limit for your Lambda function.</li><li>Network: allow you to select a VPC your function will access</li><li>Debugging and error handling: allow you to select a AWS <a href="https://docs.aws.amazon.com/lambda/latest/dg/dlq.html" target="_blank" rel="noopener">Lambda Function Dead Letter Queues</a> resource to analyze failed function invocation retries. </li><li>Concurrency: allows you to allocate a specific limit of concurrent executions allowed for this function</li><li>Auditing and compliance: logs function invocations for operational and risk auditing, governance and compliance. </li></ul><h2 id="2-2-Lambda-concept"><a href="#2-2-Lambda-concept" class="headerlink" title="2.2 Lambda concept"></a>2.2 Lambda concept</h2><p>Lambda can automatically scales up the number of instances of your function to handle high number of events. </p><ul><li>Function: A script or program that runs in AWS lambda. Lambda passes invocation events to your function. The function processes an event and returns a response</li><li>Runtimes: Lambda runtimes allow functions in different languages to run in the same base execution environment, you configure your function to use a runtime that matches your programming language. The runtime sits in between the Lambda service and your function code, relaying invocation events, context information and responses between the two. </li><li>Layers: Lambda layers are a distribution mechanism for libraries, custom runtimes and other function dependencies. Layers let you manage your in-development function code independently from the unchanging code and resources that it uses. You can configure your function to use layers that you create, layers provided by AWS, or layers from other AWS customers.</li><li>Event source: An AWS service that triggers your function and executes its logic. </li><li>Downstream resources: An AWS service that your lambda function calls once it is triggered</li><li>Log streams: While Lambda automatically monitors your function invocations and reports metrics to CloudWatch, you can annotate your function code with custom logging statements that allow you to analyze the execution flow and performance of your Lambda function to ensure itâ€™s working properly.</li></ul><h2 id="2-3-Programming-Model"><a href="#2-3-Programming-Model" class="headerlink" title="2.3 Programming Model"></a>2.3 Programming Model</h2><p>Regardless of the language you choose, there is a common pattern ti write code for a Lambda Function includes concepts as follow:</p><h3 id="2-3-1-Handler"><a href="#2-3-1-Handler" class="headerlink" title="2.3.1 Handler"></a>2.3.1 Handler</h3><p>The function AWS Lambda calls to start execution of your lambda function. When a Lambda function is invoked, Lambda starts executing your code by calling the handler function</p><h3 id="2-3-2-Context"><a href="#2-3-2-Context" class="headerlink" title="2.3.2 Context"></a>2.3.2 Context</h3><p>Lambda also passes a context object to the handler function, as the second parameter. Via this context object your code can interact with Lambda</p><h3 id="2-3-3-Logging"><a href="#2-3-3-Logging" class="headerlink" title="2.3.3 Logging"></a>2.3.3 Logging</h3><p>Function can contain logging statements, it writes these logs to cloudWatch logs. </p><h3 id="2-3-4-Exceptions"><a href="#2-3-4-Exceptions" class="headerlink" title="2.3.4 Exceptions"></a>2.3.4 Exceptions</h3><p>Function needs to communicate the result of the function execution to AWS Lambda. Many ways to end a request or to notify AWS Lambda an error occured during execution</p><h3 id="2-3-5-Concurrency"><a href="#2-3-5-Concurrency" class="headerlink" title="2.3.5 Concurrency"></a>2.3.5 Concurrency</h3><p>When your function is invoked more quickly than a single instance of your function can process events, Lambda scales by running additional instances. Each instance of your function handles only one request at a time, so you donâ€™t need to worry about synchronizing threads or processes. You can, however, use asynchronous language features to process batches of events in parallel, and save data to the /tmp directory for use in future invocations on the same instance. </p><h1 id="3-Building-Lambda-Functions-with-Java"><a href="#3-Building-Lambda-Functions-with-Java" class="headerlink" title="3. Building Lambda Functions with Java"></a>3. Building Lambda Functions with Java</h1><h2 id="3-1-Handler-Input-Output-Types"><a href="#3-1-Handler-Input-Output-Types" class="headerlink" title="3.1 Handler Input/ Output Types"></a>3.1 Handler Input/ Output Types</h2><p>When AWS lambda executes the Lambda function, it invokes the handler. First parameter is the input to the handler which can be event data (published by an event source) or custom input you provide such as a string or any custom data object. </p><p>AWS Lambda supports the following input/ output types for a handler: </p><ul><li><p>Simple Java types (AWS Lambda supports the String, Integer, Boolean, Map and List types )</p></li><li><p>POJO</p></li><li><p>stream type </p><h3 id="3-1-1-Handler-input-output-String-Type"><a href="#3-1-1-Handler-input-output-String-Type" class="headerlink" title="3.1.1 Handler input/ output: String Type"></a>3.1.1 Handler input/ output: String Type</h3><p>  package example;</p><p>  import com.amazonaws.services.lambda.runtime.Context; </p><p>  public class Hello {</p><pre><code>  public String myHandler(String name, Context context) {      return String.format(&quot;Hello %s.&quot;, name);  }</code></pre><p>  }</p></li></ul><p>When you invoke a Lambda function asynchronously, any return value by your Lambda function will be ignored. Therefore you might want to <strong><em>set the return type to void</em></strong> to make this clear in your code </p><h3 id="3-1-2-Handler-Input-Output-POJO"><a href="#3-1-2-Handler-Input-Output-POJO" class="headerlink" title="3.1.2 Handler Input/ Output: POJO"></a>3.1.2 Handler Input/ Output: POJO</h3><pre><code>package example;import com.amazonaws.services.lambda.runtime.Context; public class HelloPojo {    // Define two classes/POJOs for use with Lambda function.    public static class RequestClass {      ...    }    public static class ResponseClass {      ...    }    public static ResponseClass myHandler(RequestClass request, Context context) {        String greetingString = String.format(&quot;Hello %s, %s.&quot;, request.getFirstName(), request.getLastName());        return new ResponseClass(greetingString);    }}</code></pre><p>Suppose your application events generate data that includes first name and last name as shown:</p><pre><code>{ &quot;firstName&quot;: &quot;John&quot;, &quot;lastName&quot;: &quot;Doe&quot; }  </code></pre><p>For this example, the handler receives this JSON and returns the string â€œHello John Doeâ€.</p><pre><code>public static ResponseClass handleRequest(RequestClass request, Context context){        String greetingString = String.format(&quot;Hello %s, %s.&quot;, request.firstName, request.lastName);        return new ResponseClass(greetingString);}</code></pre><p>To create a Lambda function with this handler, you must provide implementation of the input and output types as shown in the following Java example. The HelloPojo class defines the handler method.</p><pre><code>package example;import com.amazonaws.services.lambda.runtime.Context; import com.amazonaws.services.lambda.runtime.RequestHandler;public class HelloPojo implements RequestHandler&lt;RequestClass, ResponseClass&gt;{       public ResponseClass handleRequest(RequestClass request, Context context){        String greetingString = String.format(&quot;Hello %s, %s.&quot;, request.firstName, request.lastName);        return new ResponseClass(greetingString);    }}</code></pre><p>In order to implement the input type, add the following code to a separate file and name it RequestClass.java. Place it next to the HelloPojo.java class in your directory structure:</p><pre><code>package example;     public class RequestClass {        String firstName;        String lastName;        public String getFirstName() {            return firstName;        }        public void setFirstName(String firstName) {            this.firstName = firstName;        }        public String getLastName() {            return lastName;        }        public void setLastName(String lastName) {            this.lastName = lastName;        }        public RequestClass(String firstName, String lastName) {            this.firstName = firstName;            this.lastName = lastName;        }        public RequestClass() {        }    }</code></pre><p>In order to implement the output type, add the following code to a separate file and name it ResponseClass.java. Place it next to the HelloPojo.java class in your directory structure:</p><pre><code>package example; public class ResponseClass {    String greetings;    public String getGreetings() {        return greetings;    }    public void setGreetings(String greetings) {        this.greetings = greetings;    }    public ResponseClass(String greetings) {        this.greetings = greetings;    }    public ResponseClass() {    }}</code></pre><h2 id="3-2-Context-Object-in-Java"><a href="#3-2-Context-Object-in-Java" class="headerlink" title="3.2 Context Object in Java"></a>3.2 Context Object in Java</h2><p>When Lambda runs your function, it passes a context object to the handler. The object provides methods and properties that provide information about the invocation, function and execution environment. </p><ul><li>getRemainingTimeInMillis()</li><li>getFunctionName()</li><li>getFunctionVersion()</li><li>getInvokedFunctionArn() - Returns the Amazon Resource Name(ARN) used to invoke the function. Indicates if the invoker specified a version number or alias. </li><li>getMemoryLimitInMB()</li><li>getAwsRequestId()</li><li>getLogGroupName()</li><li>getIdentity()</li><li>getClientContext()</li><li>getLogger() </li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Lambda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWS DynamoDBClient vs DynamoDBMapper</title>
      <link href="/AWS-DynamoDBClient-vs-DynamoDBMapper/"/>
      <url>/AWS-DynamoDBClient-vs-DynamoDBMapper/</url>
      
        <content type="html"><![CDATA[<p>Recently just did a project related with DynamoDB, use both DynamoDBClient and DynamoDBMapper in different circumstances. In this post, will compare those two, regarding with its convenience, latency, and their differences by nature. </p><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>DynamoDBClient is Service client for accessing DynamoDB; while DynamoDBMapper use ORM (Object relational mapping) for converting data between incompatible type systems using object-oriented programming languages. </p><h2 id="1-1-How-to-use-DDBClient"><a href="#1-1-How-to-use-DDBClient" class="headerlink" title="1.1 How to use DDBClient"></a>1.1 How to use DDBClient</h2><pre><code>// Create POJO@Datapublic class Whitelist {    private String id;    private String content;    private String status;}// Create DDBClientAmazonDynamoDB ddbCLient = AmazonDynamoDBClientBuilder.standard()    .withCredentials(new AWSCredentialsProvider(KEY))    .withRegion(&quot;aaabbb&quot;)    .build();// Convert whitelist into MapMap&lt;String, AttributeValue&gt; whitelistMap = new HashMap&lt;&gt;();whitelistMap.put(&quot;id&quot;, &quot;123&quot;);whitelistMap.put(&quot;content&quot;, &quot;hello world&quot;);whitelistMap.put(&quot;status&quot;, &quot;onSale&quot;);// UpdateItem RequestUpdateItemRequest request = new UpdateItemRequest()    .withTableName(&quot;WhitelistTable&quot;)    .withItem(whitelistMap);// Use updateItem operationddbClient.updateItem(request);</code></pre><p>As you can see here, we need to build a String, AttributeValue map, which is a bit annoying. </p><h2 id="1-2-How-to-use-DynamoDBMapper"><a href="#1-2-How-to-use-DynamoDBMapper" class="headerlink" title="1.2 How to use DynamoDBMapper"></a>1.2 How to use DynamoDBMapper</h2><p>We can define the table schema when we define the POJO using DynamoDBMapperâ€™s annotations. </p><pre><code>// Notice: lombok may not work well here, especially when you use GSI and LSI, it cannot retrive info correctly@DynamoDBTable(tableName = &quot;whitelistTable&quot;)public class Whitelist {    @DynamoDBHashKey    private String id;    @DynamoDBRangeKey    private String status;    @DynamoDBAttribute    private String content;}// Create DDBClientAmazonDynamoDB ddbCLient = AmazonDynamoDBClientBuilder.standard()    .withCredentials(new AWSCredentialsProvider(KEY))    .withRegion(&quot;aaabbb&quot;)    .build();//Create DDBMapperAmazonDynamoDBMapper ddbMapper = new AmazonDynamoDBMapper(ddbClient);// updateItemddbMapper.save(whitelistItem);</code></pre><p>Code looks much more succinct, isnâ€™t it! As you can see above, you can think DDBMapper wraps DDBCLient in some way, and help you implement the String-AttributeValue map for you. </p><h1 id="2-Comparision"><a href="#2-Comparision" class="headerlink" title="2. Comparision"></a>2. Comparision</h1><ul><li>DynamoDBMapper <ul><li>Benefits<ul><li>Code look better</li><li>less dev work</li></ul></li><li>weakness<ul><li>it runs slower than using DDBClient<ul><li>E.G when using DDBClient::getItem, the average latency is about 2ms; whereas it comes to be around 8ms in DDBMapper.  </li></ul></li></ul></li></ul></li><li>DynamoDBClient<ul><li>Benefits<ul><li>As said above, run much faster</li></ul></li><li>weakness<ul><li>verbose code</li><li>easier for mistakes, typos </li></ul></li></ul></li></ul><p>So how to choose from those two â€“ it depends. Suppose you have a daily job to put 100 millions items into one table and want to write faster, DDBClient should definitely be your choice in this situation. Otherwise, use DynamoDBMapper to save your life, lol. </p>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> DynamoDB </tag>
            
            <tag> Mapper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Distributed Tracing</title>
      <link href="/Distributed-Tracing/"/>
      <url>/Distributed-Tracing/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Why-we-need-it"><a href="#1-Why-we-need-it" class="headerlink" title="1. Why we need it?"></a>1. Why we need it?</h1><p>Short answer - due to disturbuted applications. </p><h2 id="1-1-Monolithis-software"><a href="#1-1-Monolithis-software" class="headerlink" title="1.1 Monolithis software"></a>1.1 Monolithis software</h2><p>Monolithis software is build upon a large and sprawling legacy code base that is often so tightly coupled that any changes in one small section often result in breaking one or several features that depend on it. In such app, high possibly itâ€™ll break and we need to use tech - tracing to <strong>follw the course of a request or system event</strong> from its source to its ultimate destination. </p><p>In this way, each trace comes to be a narrative that tells the requestâ€™s story as it travels through system. </p><h2 id="2-2-Distributed-System"><a href="#2-2-Distributed-System" class="headerlink" title="2.2 Distributed System"></a>2.2 Distributed System</h2><p>Use distributed tracing to profile and monitor microservice-based apps/ architectures, locate failures, and improve performance. </p><h1 id="2-Key-Concepts"><a href="#2-Key-Concepts" class="headerlink" title="2. Key Concepts"></a>2. Key Concepts</h1><p>In general, distributed tracing start with a single request - the entity or event being traced. As the request makes its journey, it <strong>generates traces that record complete processing operations</strong> performed on it by entities within a distributed system/ network infrastructure. </p><p>Each trace is assigned with its own unique ID and passes through a segment that indicates a given activity that a host system performs on the request. Every segments represents a single step within the reqeustâ€™s path and has a name, unique ID, and timestamp. A span(segment) can also carry additional metadata. </p><p>The idea is â€“ specific request inflexion points mush be identified within a system and instrumented. All of the trace data mush be coordinated and collated to provide a meaningflow view of a request. </p><p>Challenge would be processing the volume of the data generated from increasingly large scale systems. </p><h1 id="3-Implementation"><a href="#3-Implementation" class="headerlink" title="3. Implementation"></a>3. Implementation</h1><p>Google created Dapper in the past as a middleware that supports using different language within the system. As said, the value of tracing is only realised through: </p><ul><li>ubiquitous deployment, and no parts of the system under observation are not instrumented </li><li>continuous monitoring <ul><li>system mush be monitoring constantly </li></ul></li></ul><h1 id="4-Why-we-need-distributed-tracing"><a href="#4-Why-we-need-distributed-tracing" class="headerlink" title="4. Why we need distributed tracing"></a>4. Why we need distributed tracing</h1><p>Greg Linden commented in 2006 that experiments ran by Amazon.com demonstrated a <a href="http://glinden.blogspot.com/2006/11/marissa-mayer-at-web-20.html" target="_blank" rel="noopener">significant drop in revenue</a> was experienced when 100ms delay to page load was added. Although understanding the flow of a web request through a system can be challenging, there can be significant commercial gains if performance bottlenecks are identified and eliminated.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://epsagon.com/blog/introduction-to-distributed-tracing/" target="_blank" rel="noopener">https://epsagon.com/blog/introduction-to-distributed-tracing/</a></li><li><a href="https://www.infoq.com/articles/distributed-tracing-microservices/" target="_blank" rel="noopener">https://www.infoq.com/articles/distributed-tracing-microservices/</a></li><li><a href="https://www.javacodegeeks.com/microservices-distributed-tracing.html" target="_blank" rel="noopener">https://www.javacodegeeks.com/microservices-distributed-tracing.html</a></li><li><a href="https://ai.google/research/pubs/pub36356" target="_blank" rel="noopener">https://ai.google/research/pubs/pub36356</a> </li></ol>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Distributed Tracing </tag>
            
            <tag> System Design </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DynamoDB-Advanced</title>
      <link href="/DynamoDB-Advanced/"/>
      <url>/DynamoDB-Advanced/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><h2 id="1-1-Features"><a href="#1-1-Features" class="headerlink" title="1.1 Features"></a>1.1 Features</h2><ul><li>Fully managed NoSQL database service </li><li>offer encryption at rest </li><li>on-demand backup capability <ul><li>allows you to create full backups of your tables for long-term retention and archival for regulatory compliance needs</li></ul></li><li>point-in-time recovery<ul><li>restore the table to any point in time during last 35 days  </li></ul></li><li>TTL <ul><li>delete expired items from tables automatically to reduce storage usage</li></ul></li></ul><h2 id="1-2-High-availability-and-durability"><a href="#1-2-High-availability-and-durability" class="headerlink" title="1.2 High availability and durability"></a>1.2 High availability and durability</h2><p>DynamoDB automatically spreads the data and traffic for your tables over a <strong>sufficient number of servers</strong>to handle your throughput and storage requirements, while maintaining consistent and fast performance. All of your data is stored on solid state disks (SSDs) and <strong>automatically replicated across multiple Availability Zones</strong> in an AWS region, providing built-in high availability and data durability. You can use <strong>global tables to keep DynamoDB tables in sync across AWS Regions</strong>. For more information, see <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GlobalTables.html" target="_blank" rel="noopener">Global Tables</a>.</p><h1 id="2-How-it-works"><a href="#2-How-it-works" class="headerlink" title="2. How it works"></a>2. How it works</h1><h2 id="2-1-Core-Components"><a href="#2-1-Core-Components" class="headerlink" title="2.1 Core Components"></a>2.1 Core Components</h2><h3 id="2-1-1-Tables-Items-Attributes"><a href="#2-1-1-Tables-Items-Attributes" class="headerlink" title="2.1.1 Tables, Items, Attributes"></a>2.1.1 Tables, Items, Attributes</h3><blockquote><p>A table is a collection of items, each item is a collection of attributes.</p></blockquote><p>DynamoDB uses <strong>primary keys</strong> to uniquely identify each item in a table and <strong>secondary indexes</strong> to provide more querying flexibility. </p><p>Below is a diagram showing a table named People:</p><p><img src="https://i.loli.net/2020/01/29/jTZDz1AOoce26iq.png" alt="fig1.png"></p><p>Note about tables:</p><ul><li>Each item in the table has a unique identifier, or primary key, that distinguishes the item from all of the others in the table. In the People table, the primary key consists of one attribute (PersonID).</li><li>Other than the primary key, the People table is <strong>schemaless</strong>, which means that neither the attributes nor their data types need to be defined beforehand. Each item can have its own distinct attributes.</li><li>Some of the items have** a nested attribute **(Address). DynamoDB supports nested attributes up to 32 levels deep.</li></ul><h3 id="2-1-2-Primary-Key"><a href="#2-1-2-Primary-Key" class="headerlink" title="2.1.2 Primary Key"></a>2.1.2 Primary Key</h3><p>When creating tables, you must specify the primary key of the table. <strong><em>The primary key uniquely identifies each item in the table, so that no two items can have the same key</em></strong>. </p><p>DynamoDB supports two different kinds of primary keys: </p><ul><li>Partition Key </li></ul><p>DynamoDB uses the partition keyâ€™s value as input to an internal hash function. The output from the hash function determines the partition(Physical storage internal to DynamoDB) in which the item will be stored. </p><ul><li>Partition Key and sort key </li></ul><p>A composite primary key, composed of two attributes: partition key and sort key. </p><p>DynamoDB uses the partition key value as input to an internal hash function. The output from the hash function determines the partition (physical storage internal to DynamoDB) in which the item will be stored. All items with the same partition key value are stored together, in sorted order by sort key value.</p><p>In a table that has a partition key and a sort key, itâ€™s possible for two items to have the same partition key value. However, those two items must have different sort key values.</p><h3 id="2-1-3-Secondary-Indexes"><a href="#2-1-3-Secondary-Indexes" class="headerlink" title="2.1.3 Secondary Indexes"></a>2.1.3 Secondary Indexes</h3><p>A secondary index lets you query the data in the table using an alternate key, in addtion to queries against the primary key. </p><p>After you create a secondary index on a table, you can read data from the index in much the same way as you do from the table. </p><ul><li>Global Secondary Index</li></ul><p>An index with a partition key and sort key that can be different from those on the table </p><ul><li>Local Secondary Index</li></ul><p>An index that has the same partition key as the table, but a different sort key </p><h2 id="2-2-Limitations"><a href="#2-2-Limitations" class="headerlink" title="2.2 Limitations"></a>2.2 Limitations</h2><h3 id="2-2-1-Capacity-unit-sizes-For-Provisioned-tables"><a href="#2-2-1-Capacity-unit-sizes-For-Provisioned-tables" class="headerlink" title="2.2.1 Capacity unit sizes(For Provisioned tables)"></a>2.2.1 Capacity unit sizes(For Provisioned tables)</h3><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html" target="_blank" rel="noopener">Link is here: </a></p><p>One read capacity unit = one strongly consistent read per second, or two eventually consistent reads per second, for items up to 4 KB in size.</p><p>One write capacity unit = one write per second, for items up to 1 KB in size.</p><p>Transactional read requests require two read capacity units to perform one read per second for items up to 4 KB.</p><p>Transactional write requests require two write capacity units to perform one write per second for items up to 1 KB.</p><h3 id="2-2-2-Request-Unit-Sizes-For-On-Demand-tables"><a href="#2-2-2-Request-Unit-Sizes-For-On-Demand-tables" class="headerlink" title="2.2.2 Request Unit Sizes(For On-Demand tables)"></a>2.2.2 Request Unit Sizes(For On-Demand tables)</h3><p>One read request unit = one strongly consistent read, or two eventually consistent reads, for items up to 4 KB in size.</p><p>One write request unit = one write, for items up to 1 KB in size.</p><p>Transactional read requests require two read request units to perform one read for items up to 4 KB.</p><p>Transactional write requests require two write request units to perform one write for items up to 1 KB.</p><h3 id="2-2-3-Throughtput-Default-Limits"><a href="#2-2-3-Throughtput-Default-Limits" class="headerlink" title="2.2.3 Throughtput Default Limits"></a>2.2.3 Throughtput Default Limits</h3><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html" target="_blank" rel="noopener">See link here:</a></p><h3 id="2-2-4-Tables"><a href="#2-2-4-Tables" class="headerlink" title="2.2.4 Tables"></a>2.2.4 Tables</h3><p>Tables are unconstrained in terms of the number of items or the number of bytes. </p><p>For any AWS account, there is an initial limit of 256 tables per region.</p><p>You can define a maximum of 5 local secondary indexes.</p><p>There is an initial limit of 20 global secondary indexes per table.</p><h3 id="2-2-5-API-specific-Limits"><a href="#2-2-5-API-specific-Limits" class="headerlink" title="2.2.5 API specific Limits"></a>2.2.5 API specific Limits</h3><ul><li>CreateTable/UpdateTable/DeleteTable</li></ul><p>In general, you can have up to 50 CreateTable, UpdateTable, and DeleteTable requests running simultaneously (in any combination). In other words, the total number of tables in the CREATING, UPDATING or DELETING state cannot exceed 50.</p><ul><li>BatchGetItem</li></ul><p>A single BatchGetItem operation can retrieve a maximum of 100 items. The total size of all the items retrieved cannot exceed 16 MB.</p><ul><li>BatchWriteItem</li></ul><p>A single BatchWriteItem operation can contain up to 25 PutItem or DeleteItem requests. The total size of all the items written cannot exceed 16 MB.</p><ul><li>DescribeLimits</li></ul><p>DescribeLimits should only be called periodically. You can expect throttling errors if you call it more than once in a minute.</p><ul><li>Query</li></ul><p>The result set from a Query is limited to 1 MB per call. You can use the LastEvaluatedKey from the query response to retrieve more results.</p><ul><li>Scan</li></ul><p>The result set from a Scan is limited to 1 MB per call. You can use the LastEvaluatedKey from the scan response to retrieve more results.</p><h2 id="2-3-The-DynamoDB-API"><a href="#2-3-The-DynamoDB-API" class="headerlink" title="2.3 The DynamoDB API"></a>2.3 The DynamoDB API</h2><p>See Instructions <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.API.html" target="_blank" rel="noopener">here</a></p><h3 id="2-3-1-Control-Plane"><a href="#2-3-1-Control-Plane" class="headerlink" title="2.3.1 Control Plane"></a>2.3.1 Control Plane</h3><ul><li>CreateTable </li><li>DescribeTable </li><li>ListTables </li><li>UpdateTable </li><li>DeleteTable </li></ul><h3 id="2-3-2-Data-Plane"><a href="#2-3-2-Data-Plane" class="headerlink" title="2.3.2 Data Plane"></a>2.3.2 Data Plane</h3><ul><li>Creating Data <ul><li>PutItem </li><li>BatchWriteItem </li></ul></li><li>Reading Data <ul><li>GetItem </li><li>BatchGetItem </li><li>Query </li><li>Scan </li></ul></li><li>Updating Data <ul><li>UpdateItem </li></ul></li><li>Deleting Data <ul><li>DeleteItem </li><li>BatchWriteItem </li></ul></li><li>DynamoDB streams <ul><li>listStreams</li><li>DescribeStream </li><li>GetShardIterator: return a shard iterator, which is a data structure that your application uses to retrieve the records from the stream. </li><li>GetRecords</li></ul></li></ul><h2 id="2-4-Consistency-and-capacity"><a href="#2-4-Consistency-and-capacity" class="headerlink" title="2.4 Consistency and capacity"></a>2.4 Consistency and capacity</h2><p>Region - Availability Zones</p><p>When your application writes data to a DynamoDB table and receives an HTTP 200 response, the write has occured and is durable. The data is eventually consistent across all storage locations, usually within one second or less. </p><p>DDB supports <strong>eventually consistent and strongly consistent reads</strong>. </p><h3 id="2-4-1-Eventually-Consistent-Reads"><a href="#2-4-1-Eventually-Consistent-Reads" class="headerlink" title="2.4.1 Eventually Consistent Reads"></a>2.4.1 Eventually Consistent Reads</h3><p>When you read data from a DynamoDB table, the response might not reflect the results of a recently completed write operation. The response might include some stale data. If you repeat your read request after a short time, the response should return the latest data.</p><h3 id="2-4-2-Strongly-Consistent-Reads"><a href="#2-4-2-Strongly-Consistent-Reads" class="headerlink" title="2.4.2 Strongly Consistent Reads"></a>2.4.2 Strongly Consistent Reads</h3><p>When you request a strongly consistent read, DynamoDB returns a response with the most up-to-date data, reflecting the updates from all prior write operations that were successful. A strongly consistent read might not be available if there is a network delay or outage. Consistent reads are not supported on global secondary indexes (GSI).</p><h3 id="2-4-3-Read-Write-Capacity-Mode-on-demand"><a href="#2-4-3-Read-Write-Capacity-Mode-on-demand" class="headerlink" title="2.4.3 Read/ Write Capacity Mode - on demand"></a>2.4.3 Read/ Write Capacity Mode - on demand</h3><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadWriteCapacityMode.html" target="_blank" rel="noopener">See link here</a></p><p>When you choose on-demand mode, DynamoDB instantly accommodates your workloads as they ramp up or down to any previously reached traffic level. If a workloadâ€™s traffic level hits a new peak, DynamoDB adapts rapidly to accommodate the workload. Tables that use on-demand mode deliver the same single-digit millisecond latency, service-level agreement (SLA) commitment, and security that DynamoDB already offers. You can choose on-demand for both new and existing tables and you can continue using the existing DynamoDB APIs without changing code.</p><h3 id="2-4-4-Read-Write-Capacity-Mode-provisioned"><a href="#2-4-4-Read-Write-Capacity-Mode-provisioned" class="headerlink" title="2.4.4 Read/ Write Capacity Mode - provisioned"></a>2.4.4 Read/ Write Capacity Mode - provisioned</h3><p>If you choose provisioned mode, you specify the number of reads and writes per second that you require for your application. You can use auto scaling to adjust your tableâ€™s provisioned capacity automatically in response to traffic changes. This helps you govern your DynamoDB use to stay at or below a defined request rate in order to obtain cost predictability.</p><h3 id="2-4-5-Read-Write-request-units"><a href="#2-4-5-Read-Write-request-units" class="headerlink" title="2.4.5 Read/ Write request units"></a>2.4.5 Read/ Write request units</h3><p>For on-demand mode tables, you donâ€™t need to specify how much read and write throughput you expect your application to perform. DynamoDB charges you for the reads and writes that your application performs on your tables in terms of read request units and write request units.</p><p>One read request unit represents one strongly consistent read request, or two eventually consistent read requests, for an item up to 4 KB in size. Transactional read requests require 2 read request units to perform one read for items up to 4 KB. If you need to read an item that is larger than 4 KB, DynamoDB needs additional read request units. The total number of read request units required depends on the item size, and whether you want an eventually consistent or strongly consistent read. For example, if your item size is 8 KB, you require 2 read request units to sustain one strongly consistent read, 1 read request unit if you choose eventually consistent reads, or 4 read request units for a transactional read request.</p><p>One write request unit represents one write for an item up to 1 KB in size. If you need to write an item that is larger than 1 KB, DynamoDB needs to consume additional write request units. Transactional write requests require 2 write request units to perform one write for items up to 1 KB. The total number of write request units required depends on the item size. For example, if your item size is 2 KB, you require 2 write request units to sustain one write request or 4 read request units for a transactional write request.</p><h3 id="2-4-6-DynamoDB-Auto-Scaling"><a href="#2-4-6-DynamoDB-Auto-Scaling" class="headerlink" title="2.4.6 DynamoDB Auto Scaling"></a>2.4.6 DynamoDB Auto Scaling</h3><p>Manage throughput capacity for tables and global secondary indexes. With auto scaling, you define a range for read and write capacity units. You also define a target utilization percentage within that range. DynamoDB auto scaling seeks to maintain your target utilization, even as your application workload increases or decreases.</p><h2 id="2-5-Partitions-and-Data-Distribution"><a href="#2-5-Partitions-and-Data-Distribution" class="headerlink" title="2.5 Partitions and Data Distribution"></a>2.5 Partitions and Data Distribution</h2><p>A partition is an allocation of storage for a table, backed by solid-state drives (SSDs) and automatically replicated across multiple Availability Zones within an AWS Region. Partition management is handled entirely by DynamoDBâ€”you never have to manage partitions yourself.</p><p>DynamoDB allocates additional partitions to a table in the following situations:</p><ul><li>If you increase the tableâ€™s provisioned throughput settings beyond what the existing partitions can support.</li><li>If an existing partition fills to capacity and more storage space is required.</li></ul><p>Choose a partition key that can have a large number of distinct values relative to the number of items in the table. </p><h1 id="3-Java-Programming-with-DanamoDB"><a href="#3-Java-Programming-with-DanamoDB" class="headerlink" title="3. Java Programming with DanamoDB"></a>3. Java Programming with DanamoDB</h1><h2 id="3-1-Work-flow-using-Java"><a href="#3-1-Work-flow-using-Java" class="headerlink" title="3.1 Work flow using Java"></a>3.1 Work flow using Java</h2><h3 id="3-1-1-Create-a-table"><a href="#3-1-1-Create-a-table" class="headerlink" title="3.1.1 Create a table"></a>3.1.1 Create a table</h3><pre><code>public class MoviesCreateTable {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        String tableName = &quot;Movies&quot;;        try {            System.out.println(&quot;Attempting to create table; please wait...&quot;);            Table table = dynamoDB.createTable(tableName,                Arrays.asList(new KeySchemaElement(&quot;year&quot;, KeyType.HASH), // Partition                                                                          // key                    new KeySchemaElement(&quot;title&quot;, KeyType.RANGE)), // Sort key                Arrays.asList(new AttributeDefinition(&quot;year&quot;, ScalarAttributeType.N),                    new AttributeDefinition(&quot;title&quot;, ScalarAttributeType.S)),                new ProvisionedThroughput(10L, 10L));            table.waitForActive();            System.out.println(&quot;Success.  Table status: &quot; + table.getDescription().getTableStatus());        }        catch (Exception e) {            System.err.println(&quot;Unable to create table: &quot;);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-2-Load-data"><a href="#3-1-2-Load-data" class="headerlink" title="3.1.2 Load data"></a>3.1.2 Load data</h3><pre><code>public class MoviesLoadData {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        JsonParser parser = new JsonFactory().createParser(new File(&quot;moviedata.json&quot;));        JsonNode rootNode = new ObjectMapper().readTree(parser);        Iterator&lt;JsonNode&gt; iter = rootNode.iterator();        ObjectNode currentNode;        while (iter.hasNext()) {            currentNode = (ObjectNode) iter.next();            int year = currentNode.path(&quot;year&quot;).asInt();            String title = currentNode.path(&quot;title&quot;).asText();            try {                table.putItem(new Item().withPrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title).withJSON(&quot;info&quot;,                    currentNode.path(&quot;info&quot;).toString()));                System.out.println(&quot;PutItem succeeded: &quot; + year + &quot; &quot; + title);            }            catch (Exception e) {                System.err.println(&quot;Unable to add movie: &quot; + year + &quot; &quot; + title);                System.err.println(e.getMessage());                break;            }        }        parser.close();    }}</code></pre><h3 id="3-1-3-Create-a-new-item"><a href="#3-1-3-Create-a-new-item" class="headerlink" title="3.1.3 Create a new item"></a>3.1.3 Create a new item</h3><pre><code>public class MoviesItemOps01 {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        int year = 2015;        String title = &quot;The Big New Movie&quot;;        final Map&lt;String, Object&gt; infoMap = new HashMap&lt;String, Object&gt;();        infoMap.put(&quot;plot&quot;, &quot;Nothing happens at all.&quot;);        infoMap.put(&quot;rating&quot;, 0);        try {            System.out.println(&quot;Adding a new item...&quot;);            PutItemOutcome outcome = table                .putItem(new Item().withPrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title).withMap(&quot;info&quot;, infoMap));            System.out.println(&quot;PutItem succeeded:\n&quot; + outcome.getPutItemResult());        }        catch (Exception e) {            System.err.println(&quot;Unable to add item: &quot; + year + &quot; &quot; + title);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-4-Read-an-Item"><a href="#3-1-4-Read-an-Item" class="headerlink" title="3.1.4 Read an Item"></a>3.1.4 Read an Item</h3><pre><code>public class MoviesItemOps02 {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        int year = 2015;        String title = &quot;The Big New Movie&quot;;        GetItemSpec spec = new GetItemSpec().withPrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title);        try {            System.out.println(&quot;Attempting to read the item...&quot;);            Item outcome = table.getItem(spec);            System.out.println(&quot;GetItem succeeded: &quot; + outcome);        }        catch (Exception e) {            System.err.println(&quot;Unable to read item: &quot; + year + &quot; &quot; + title);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-5-Update-an-Item"><a href="#3-1-5-Update-an-Item" class="headerlink" title="3.1.5 Update an Item"></a>3.1.5 Update an Item</h3><pre><code>public class MoviesItemOps03 {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        int year = 2015;        String title = &quot;The Big New Movie&quot;;        UpdateItemSpec updateItemSpec = new UpdateItemSpec().withPrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title)            .withUpdateExpression(&quot;set info.rating = :r, info.plot=:p, info.actors=:a&quot;)            .withValueMap(new ValueMap().withNumber(&quot;:r&quot;, 5.5).withString(&quot;:p&quot;, &quot;Everything happens all at once.&quot;)                .withList(&quot;:a&quot;, Arrays.asList(&quot;Larry&quot;, &quot;Moe&quot;, &quot;Curly&quot;)))            .withReturnValues(ReturnValue.UPDATED_NEW);        try {            System.out.println(&quot;Updating the item...&quot;);            UpdateItemOutcome outcome = table.updateItem(updateItemSpec);            System.out.println(&quot;UpdateItem succeeded:\n&quot; + outcome.getItem().toJSONPretty());        }        catch (Exception e) {            System.err.println(&quot;Unable to update item: &quot; + year + &quot; &quot; + title);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-6-Update-an-Item-conditionally"><a href="#3-1-6-Update-an-Item-conditionally" class="headerlink" title="3.1.6 Update an Item conditionally"></a>3.1.6 Update an Item conditionally</h3><pre><code>public class MoviesItemOps05 {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        int year = 2015;        String title = &quot;The Big New Movie&quot;;        UpdateItemSpec updateItemSpec = new UpdateItemSpec()            .withPrimaryKey(new PrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title)).withUpdateExpression(&quot;remove info.actors[0]&quot;)            .withConditionExpression(&quot;size(info.actors) &gt; :num&quot;).withValueMap(new ValueMap().withNumber(&quot;:num&quot;, 3))            .withReturnValues(ReturnValue.UPDATED_NEW);        // Conditional update (we expect this to fail)        try {            System.out.println(&quot;Attempting a conditional update...&quot;);            UpdateItemOutcome outcome = table.updateItem(updateItemSpec);            System.out.println(&quot;UpdateItem succeeded:\n&quot; + outcome.getItem().toJSONPretty());        }        catch (Exception e) {            System.err.println(&quot;Unable to update item: &quot; + year + &quot; &quot; + title);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-7-Delete-an-Item"><a href="#3-1-7-Delete-an-Item" class="headerlink" title="3.1.7 Delete an Item"></a>3.1.7 Delete an Item</h3><pre><code>public class MoviesItemOps06 {    public static void main(String[] args) throws Exception {        AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()            .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))            .build();        DynamoDB dynamoDB = new DynamoDB(client);        Table table = dynamoDB.getTable(&quot;Movies&quot;);        int year = 2015;        String title = &quot;The Big New Movie&quot;;        DeleteItemSpec deleteItemSpec = new DeleteItemSpec()            .withPrimaryKey(new PrimaryKey(&quot;year&quot;, year, &quot;title&quot;, title)).withConditionExpression(&quot;info.rating &lt;= :val&quot;)            .withValueMap(new ValueMap().withNumber(&quot;:val&quot;, 5.0));        // Conditional delete (we expect this to fail)        try {            System.out.println(&quot;Attempting a conditional delete...&quot;);            table.deleteItem(deleteItemSpec);            System.out.println(&quot;DeleteItem succeeded&quot;);        }        catch (Exception e) {            System.err.println(&quot;Unable to delete item: &quot; + year + &quot; &quot; + title);            System.err.println(e.getMessage());        }    }}</code></pre><h3 id="3-1-8-Scan"><a href="#3-1-8-Scan" class="headerlink" title="3.1.8 Scan"></a>3.1.8 Scan</h3><p>The scan method reads every item in the entire table, and returns all the data in the table, you can provide an optional filter_expression so that only the items matching your criteria are returned. However, the filter is applied only after the entire table has been scanned. </p><pre><code>    public class MoviesScan {        public static void main(String[] args) throws Exception {            AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard()                .withEndpointConfiguration(new AwsClientBuilder.EndpointConfiguration(&quot;http://localhost:8000&quot;, &quot;us-west-2&quot;))                .build();            DynamoDB dynamoDB = new DynamoDB(client);            Table table = dynamoDB.getTable(&quot;Movies&quot;);            ScanSpec scanSpec = new ScanSpec().withProjectionExpression(&quot;#yr, title, info.rating&quot;)                .withFilterExpression(&quot;#yr between :start_yr and :end_yr&quot;).withNameMap(new NameMap().with(&quot;#yr&quot;, &quot;year&quot;))                .withValueMap(new ValueMap().withNumber(&quot;:start_yr&quot;, 1950).withNumber(&quot;:end_yr&quot;, 1959));            try {                ItemCollection&lt;ScanOutcome&gt; items = table.scan(scanSpec);                Iterator&lt;Item&gt; iter = items.iterator();                while (iter.hasNext()) {                    Item item = iter.next();                    System.out.println(item.toString());                }            }            catch (Exception e) {                System.err.println(&quot;Unable to scan the table:&quot;);                System.err.println(e.getMessage());            }        }    }</code></pre><h2 id="3-2-AWS-SDK-support"><a href="#3-2-AWS-SDK-support" class="headerlink" title="3.2 AWS SDK support"></a>3.2 AWS SDK support</h2><h3 id="3-2-1-AWS-SDK-support-workflow"><a href="#3-2-1-AWS-SDK-support-workflow" class="headerlink" title="3.2.1 AWS SDK support workflow"></a>3.2.1 AWS SDK support workflow</h3><p><img src="https://i.loli.net/2020/01/29/vTVb5WzqQkFaLYm.png" alt="fig2.png"></p><ol><li><p>You write an application using an AWS SDK for your programming language.</p></li><li><p>Each AWS SDK provides one or more programmatic interfaces for working with DynamoDB. The specific interfaces available depend on which programming language and AWS SDK you use.</p></li><li><p>The AWS SDK constructs HTTP(S) requests for use with the low-level DynamoDB API.</p></li><li><p>The AWS SDK sends the request to the DynamoDB endpoint.</p></li><li><p>DynamoDB executes the request. If the request is successful, DynamoDB returns an HTTP 200 response code (OK). If the request is unsuccessful, DynamoDB returns an HTTP error code and an error message.</p></li><li><p>The AWS SDK processes the response and propagates it back to your application.</p></li></ol><h3 id="3-2-2-Services-AWS-SDK-provides"><a href="#3-2-2-Services-AWS-SDK-provides" class="headerlink" title="3.2.2 Services AWS SDK provides"></a>3.2.2 Services AWS SDK provides</h3><ul><li>formatting HTTP(s) requests and serializing request parameters </li><li>generating a cryptographic signature for each request </li><li>forwarding request to a DynamoDB endpoint and receiving responses from DynamoDB </li><li>extracting the results from those responses </li><li>implementing basic retry logic in case of errors </li></ul><h3 id="3-2-3-Programmatic-Interfaces"><a href="#3-2-3-Programmatic-Interfaces" class="headerlink" title="3.2.3 Programmatic Interfaces"></a>3.2.3 Programmatic Interfaces</h3><ol><li>Low level interfaces<br>Need data type descriptors </li></ol><pre><code>result.getItem().getN() // get number </code></pre><ol start="2"><li>Document Interfaces</li></ol><p>Documnet interface, allowing to perform data plane operations(creat, read, update, delete) on tables and indexes. No need to specify the data type descriptors. Data types are implied by the semantics of the data itself. Also provide methods to easily convert JSON documents to and from native DDB data types. </p><ol start="3"><li>Object Persistence Interface </li></ol><p>Provid an object persistence interface where you do not directly perform data plane operations. Instead, you create objects that represent items in DynamoDB tables and indexes, and interact only with those objects. <strong><em>This allow you to write object-centric code, rather than database-centric code</em></strong>. </p><pre><code>@DynamoDBTable(tableName=&quot;Music&quot;)public class MusicItem {    private String artist;    private String songTitle;    private String albumTitle;    private int year;    @DynamoDBHashKey(attributeName=&quot;Artist&quot;)    public String getArtist() { return artist;}    public void setArtist(String artist) {this.artist = artist;}    @DynamoDBRangeKey(attributeName=&quot;SongTitle&quot;)    public String getSongTitle() { return songTitle;}    public void setSongTitle(String songTitle) {this.songTitle = songTitle;}    @DynamoDBAttribute(attributeName = &quot;AlbumTitle&quot;)    public String getAlbumTitle() { return albumTitle;}    public void setAlbumTitle(String albumTitle) {this.albumTitle = albumTitle;}    @DynamoDBAttribute(attributeName = &quot;Year&quot;)    public int getYear() { return year; }    public void setYear(int year) { this.year = year; }}</code></pre><h3 id="3-2-4-Low-level-API"><a href="#3-2-4-Low-level-API" class="headerlink" title="3.2.4 Low level API"></a>3.2.4 Low level API</h3><p>The DynamoDB low-level API is the protocol level interface for Amazon DynamoDB. At this level, every HTTP(s) request must be correctly formatted and carry a valid digital signature. </p><p>The low-level DynamoDB API uses JavaScript Object Notation (JSON) as a wire protocol format. JSON presents data in a hierarchy, so that both data values and data structure are conveyed simultaneously. Name-value pairs are defined in the format name:value. The data hierarchy is defined by nested brackets of name-value pairs.</p><p>DynamoDB uses JSON only as a transport protocol, not as a storage format. The AWS SDKs use JSON to send data to DynamoDB, and DynamoDB responds with JSON, but DynamoDB does not store data persistently in JSON format.</p><h4 id="3-2-4-1-Request-Format"><a href="#3-2-4-1-Request-Format" class="headerlink" title="3.2.4.1 Request Format"></a>3.2.4.1 Request Format</h4><p>The DynamoDB low-level API accepts HTTP(S) POST requests as input. The AWS SDKs construct these requests for you.</p><p>Suppose that you have a table named Pets, with a key schema consisting of AnimalType (partition key) and Name (sort key). Both of these attributes are of type string. To retrieve an item from Pets, the AWS SDK constructs a request as shown following:</p><pre><code>POST / HTTP/1.1Host: dynamodb.&lt;region&gt;.&lt;domain&gt;;Accept-Encoding: identityContent-Length: &lt;PayloadSizeBytes&gt;     User-Agent: &lt;UserAgentString&gt;Content-Type: application/x-amz-json-1.0Authorization: AWS4-HMAC-SHA256 Credential=&lt;Credential&gt;, SignedHeaders=&lt;Headers&gt;, Signature=&lt;Signature&gt;X-Amz-Date: &lt;Date&gt; X-Amz-Target: DynamoDB_20120810.GetItem{    &quot;TableName&quot;: &quot;Pets&quot;,    &quot;Key&quot;: {        &quot;AnimalType&quot;: {&quot;S&quot;: &quot;Dog&quot;},        &quot;Name&quot;: {&quot;S&quot;: &quot;Fido&quot;}    }}</code></pre><ul><li>The Authorization header contains information required for DynamoDB to authenticate the request.</li><li>The X-Amz-Target header contains the name of a DynamoDB operation: GetItem. (This is also accompanied by the low-level API version, in this case 20120810.)</li><li>The payload (body) of the request contains the parameters for the operation, in JSON format. For the GetItem operation, the parameters are TableName and Key.</li></ul><h4 id="3-2-4-2-Response-Format"><a href="#3-2-4-2-Response-Format" class="headerlink" title="3.2.4.2 Response Format"></a>3.2.4.2 Response Format</h4><p>Upon receipt of the request, DynamoDB processes it and returns a response. For the request shown above, the HTTP(S) response payload contains the results from the operation. </p><pre><code>HTTP/1.1 200 OKx-amzn-RequestId: &lt;RequestId&gt; x-amz-crc32: &lt;Checksum&gt;Content-Type: application/x-amz-json-1.0Content-Length: &lt;PayloadSizeBytes&gt;Date: &lt;Date&gt; {    &quot;Item&quot;: {        &quot;Age&quot;: {&quot;N&quot;: &quot;8&quot;},        &quot;Colors&quot;: {            &quot;L&quot;: [                {&quot;S&quot;: &quot;White&quot;},                {&quot;S&quot;: &quot;Brown&quot;},                {&quot;S&quot;: &quot;Black&quot;}            ]        },        &quot;Name&quot;: {&quot;S&quot;: &quot;Fido&quot;},        &quot;Vaccinations&quot;: {            &quot;M&quot;: {                &quot;Rabies&quot;: {                    &quot;L&quot;: [                        {&quot;S&quot;: &quot;2009-03-17&quot;},                        {&quot;S&quot;: &quot;2011-09-21&quot;},                        {&quot;S&quot;: &quot;2014-07-08&quot;}                    ]                },                &quot;Distemper&quot;: {&quot;S&quot;: &quot;2015-10-13&quot;}            }        },        &quot;Breed&quot;: {&quot;S&quot;: &quot;Beagle&quot;},        &quot;AnimalType&quot;: {&quot;S&quot;: &quot;Dog&quot;}    }}</code></pre><h4 id="3-2-4-3-Data-Type-Descriptors"><a href="#3-2-4-3-Data-Type-Descriptors" class="headerlink" title="3.2.4.3 Data Type Descriptors"></a>3.2.4.3 Data Type Descriptors</h4><p>The low-level DynamoDB API protocol requires each attribute to be accompanied by a data type descriptor. Data type descriptors are tokens that tell DynamoDB how to interpret each attribute.</p><p>The examples in Request Format and Response Format show examples of how data type descriptors are used. The GetItem request specifies S for the Pets key schema attributes (AnimalType and Name), which are of type string. The GetItem response contains a Pets item with attributes of type string (S), number (N), map (M), and list (L).</p><h2 id="3-3-Error-Handling"><a href="#3-3-Error-Handling" class="headerlink" title="3.3 Error Handling"></a>3.3 Error Handling</h2><h3 id="3-3-1-Error-Components"><a href="#3-3-1-Error-Components" class="headerlink" title="3.3.1 Error Components"></a>3.3.1 Error Components</h3><p>Unsuccessful: returns an error, which contains: </p><ul><li>An HTTP status code</li><li>An exception name</li><li>An error message</li></ul><p>The AWS SDK tale care of propagating errors to your application, so that you can take appropriate action. </p><h3 id="3-3-2-Error-Messages-and-Codes"><a href="#3-3-2-Error-Messages-and-Codes" class="headerlink" title="3.3.2 Error Messages and Codes"></a>3.3.2 Error Messages and Codes</h3><ul><li>HTTP status code 400<ul><li>AccessDeniedException <ul><li>The client did not correctly sign the request.</li></ul></li><li>ConditionalCheckFailedException<ul><li>You specified a condition that evaluated to false. </li></ul></li><li>IncompleteSignatureException <ul><li>The request signature did not include all of the required components.</li></ul></li><li>ItemCollectionSizeLimitExceededException<ul><li>For a table with a local secondary index, a group of items with the same partition key value has exceeded the maximum size limit of 10 GB. </li></ul></li><li>LimitExceededException<ul><li>There are too many concurrent control plane operations. The cumulative number of tables and indexes in the CREATING, DELETING, or UPDATING state cannot exceed 50.</li></ul></li><li>MissingAuthenticationTokenException<ul><li>The request did not include the required authorization header, or it was malformed. </li></ul></li><li>ProvisionedThroughputExceededException<ul><li>Your request rate is too high. The AWS SDKs for DynamoDB automatically retry requests that receive this exception. Your request is eventually successful, unless your retry queue is too large to finish. </li></ul></li><li>RequestLimitExceeded<ul><li>Throughput exceeds the current throughput limit for your account.</li></ul></li><li>ResourceInUseException<ul><li>The resource which you are attempting to change is in use.</li></ul></li></ul></li></ul><pre><code>Table table = dynamoDB.getTable(&quot;Movies&quot;);try {    Item item = table.getItem(&quot;year&quot;, 1978, &quot;title&quot;, &quot;Superman&quot;);    if (item != null) {        System.out.println(&quot;Result: &quot; + item);    } else {         //No such item exists in the table        System.out.println(&quot;Item not found&quot;);    }} catch (AmazonServiceException ase) {    System.err.println(&quot;Could not complete operation&quot;);    System.err.println(&quot;Error Message:  &quot; + ase.getMessage());    System.err.println(&quot;HTTP Status:    &quot; + ase.getStatusCode());    System.err.println(&quot;AWS Error Code: &quot; + ase.getErrorCode());    System.err.println(&quot;Error Type:     &quot; + ase.getErrorType());    System.err.println(&quot;Request ID:     &quot; + ase.getRequestId());} catch (AmazonClientException ace) {    System.err.println(&quot;Internal error occured communicating with DynamoDB&quot;);    System.out.println(&quot;Error Message:  &quot; + ace.getMessage());</code></pre><h3 id="3-3-3-Error-Retries-and-Expotential-Backoff"><a href="#3-3-3-Error-Retries-and-Expotential-Backoff" class="headerlink" title="3.3.3 Error Retries and Expotential Backoff"></a>3.3.3 Error Retries and Expotential Backoff</h3><p>Numerous components on a network, such as DNS servers, switches, load balancers, and others can generate errors anywhere in the life of a given request. The usual technique for dealing with these error responses in a networked environment is to implement retries in the client application. This technique increases the reliability of the application.</p><p>In addition to simple retries, each AWS SDK implements exponential backoff algorithm for better flow control. The concept behind exponential backoff is to use progressively longer waits between retries for consecutive error responses. For example, up to 50 milliseconds before the first retry, up to 100 milliseconds before the second, up to 200 milliseconds before third, and so on.</p><h3 id="3-3-4-Batch-Operations-and-Error-Handling"><a href="#3-3-4-Batch-Operations-and-Error-Handling" class="headerlink" title="3.3.4 Batch Operations and Error Handling"></a>3.3.4 Batch Operations and Error Handling</h3><p>The DynamoDB low-level API supports batch operations for reads and writes. BatchGetItem reads items from one or more tables, and BatchWriteItem puts or deletes items in one or more tables. These batch operations are implemented as wrappers around other non-batch DynamoDB operations. In other words, BatchGetItem invokes GetItem once for each item in the batch. Similarly,BatchWriteItem invokes DeleteItem or PutItem, as appropriate, for each item in the batch.</p><p>A batch operation can tolerate the failure of individual requests in the batch. For example, consider a BatchGetItem request to read five items. Even if some of the underlying GetItem requests fail, this does not cause the entire BatchGetItem operation to fail. On the other hand, if all of the five reads operations fail, then the entire BatchGetItem will fail.</p><p>The batch operations return information about individual requests that fail, so that you can diagnose the problem and retry the operation. For BatchGetItem, the tables and primary keys in question are returned in the UnprocessedKeys parameter of the request. For BatchWriteItem, similar information is returned in UnprocessedItems.</p><h1 id="4-High-level-programming-interfaces-for-DynamoDB-DynamoDBMapper"><a href="#4-High-level-programming-interfaces-for-DynamoDB-DynamoDBMapper" class="headerlink" title="4 High level programming interfaces for DynamoDB - DynamoDBMapper"></a>4 High level programming interfaces for DynamoDB - DynamoDBMapper</h1><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HigherLevelInterfaces.html" target="_blank" rel="noopener">DynamoDBMapper</a></p><h2 id="4-1-Mapper-class-implementation"><a href="#4-1-Mapper-class-implementation" class="headerlink" title="4.1 Mapper class implementation"></a>4.1 Mapper class implementation</h2><p>With a low level database interface, developers must write methods for reading or writing object data to database tables and vice versa. The amount of extra code required for each combination of object type and database table can seem overwhelming. </p><p>The higher-level interfaces for DynamoDB let you define the relationships between objects in your program and the database tables that store those objectsâ€™ data. After you define this mapping, you call simple object methods such as save, load, or delete, and the underlying low-level DynamoDB operations are automatically invoked on your behalf. This allows you to write object-centric code, rather than database-centric code.</p><p>AWS SDK provides a DynamoDBMapper class, allowing you to map your client side classes to DynamoDB tables. To use DynamoDBMapper, you define the relationship between items in a DynamoDB table and their corresponding object instances in your code. </p><pre><code>@DynamoDBTable(tableName=&quot;ProductCatalog&quot;)public class CatalogItem {    private Integer id;    private String title;    private String ISBN;    private Set&lt;String&gt; bookAuthors;    private String someProp;    @DynamoDBHashKey(attributeName=&quot;Id&quot;)      public Integer getId() { return id; }    public void setId(Integer id) {this.id = id; }    @DynamoDBAttribute(attributeName=&quot;Title&quot;)      public String getTitle() {return title; }    public void setTitle(String title) { this.title = title; }    @DynamoDBAttribute(attributeName=&quot;ISBN&quot;)      public String getISBN() { return ISBN; }    public void setISBN(String ISBN) { this.ISBN = ISBN; }    @DynamoDBAttribute(attributeName=&quot;Authors&quot;)    public Set&lt;String&gt; getBookAuthors() { return bookAuthors; }    public void setBookAuthors(Set&lt;String&gt; bookAuthors) { this.bookAuthors = bookAuthors; }    @DynamoDBIgnore    public String getSomeProp() { return someProp; }    public void setSomeProp(String someProp) { this.someProp = someProp; }}</code></pre><h3 id="4-1-1-DynamoDBTable"><a href="#4-1-1-DynamoDBTable" class="headerlink" title="4.1.1 @DynamoDBTable"></a>4.1.1 @DynamoDBTable</h3><p>Maps the class CatalogItem to table ProductCatalog. You can store individual class instances as items in the table.  </p><h3 id="4-1-2-DynamoDBHashKey"><a href="#4-1-2-DynamoDBHashKey" class="headerlink" title="4.1.2 @DynamoDBHashKey"></a>4.1.2 @DynamoDBHashKey</h3><p>Maps the Id property to the primary key </p><h3 id="4-1-3-DynamoDBAttribute"><a href="#4-1-3-DynamoDBAttribute" class="headerlink" title="4.1.3 @DynamoDBAttribute"></a>4.1.3 @DynamoDBAttribute</h3><p>This annotation is optional when the name of the DynamoDB attribute matches the name of the property declared in the class. When they differ, use this annotation with the attributeName() parameter to specify which DynamoDB attribute this property corresponds to. </p><h3 id="4-1-4-DynamoDBIgnore"><a href="#4-1-4-DynamoDBIgnore" class="headerlink" title="4.1.4  @DynamoDBIgnore"></a>4.1.4  @DynamoDBIgnore</h3><p>Those properties will not be mapped to any attributes in the table</p><h2 id="4-2-Use-DynamoDBMapper-Method"><a href="#4-2-Use-DynamoDBMapper-Method" class="headerlink" title="4.2 Use DynamoDBMapper Method"></a>4.2 Use DynamoDBMapper Method</h2><p>Use Mapper method to write an instance of that class to a corresponding item in the Catalog table. </p><pre><code>AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard().build();DynamoDBMapper mapper = new DynamoDBMapper(client);CatalogItem item = new CatalogItem();item.setId(102);item.setTitle(&quot;Book 102 Title&quot;);item.setISBN(&quot;222-2222222222&quot;);item.setBookAuthors(new HashSet&lt;String&gt;(Arrays.asList(&quot;Author 1&quot;, &quot;Author 2&quot;)));item.setSomeProp(&quot;Test&quot;);mapper.save(item);          </code></pre><p>Following code shows how to retrieve the item and access some of its attributes: </p><pre><code>CatalogItem partitionKey = new CatalogItem();partitionKey.setId(102);DynamoDBQueryExpression&lt;CatalogItem&gt; queryExpression = new DynamoDBQueryExpression&lt;CatalogItem&gt;()    .withHashKeyValues(partitionKey);List&lt;CatalogItem&gt; itemList = mapper.query(CatalogItem.class, queryExpression);for (int i = 0; i &lt; itemList.size(); i++) {    System.out.println(itemList.get(i).getTitle());    System.out.println(itemList.get(i).getBookAuthors());}</code></pre><h2 id="4-3-Java-Annotations-for-DynamoDB"><a href="#4-3-Java-Annotations-for-DynamoDB" class="headerlink" title="4.3 Java Annotations for DynamoDB"></a>4.3 Java Annotations for DynamoDB</h2><h3 id="4-3-1-DynamoDBAttribute"><a href="#4-3-1-DynamoDBAttribute" class="headerlink" title="4.3.1 DynamoDBAttribute"></a>4.3.1 DynamoDBAttribute</h3><ul><li>Maps a property to a table attribute. </li></ul><pre><code>@DynamoDBAttribute(attributeName = &quot;Authors&quot;)public List&lt;String&gt; getBookAuthors() { return BookAuthors; }public void setBookAuthors(List&lt;String&gt; BookAuthors) { this.BookAuthors = BookAuthors; }</code></pre><h3 id="4-3-2-DynamoDBAutoGeneratedKey"><a href="#4-3-2-DynamoDBAutoGeneratedKey" class="headerlink" title="4.3.2 DynamoDBAutoGeneratedKey"></a>4.3.2 DynamoDBAutoGeneratedKey</h3><ul><li>Marks a partition key or sort key property as being auto-generated. DynamoDBMapper will generate a random UUID when saving these attributes. Only String properties can be marked as auto-generated keys. </li></ul><pre><code>@DynamoDBTable(tableName=&quot;AutoGeneratedKeysExample&quot;)public class AutoGeneratedKeys {     private String id;    private String payload;    @DynamoDBHashKey(attributeName = &quot;Id&quot;)    @DynamoDBAutoGeneratedKey    public String getId() { return id; }    public void setId(String id) { this.id = id; }     @DynamoDBAttribute(attributeName=&quot;payload&quot;)    public String getPayload() { return this.payload; }    public void setPayload(String payload) { this.payload = payload; }        public static void saveItem() {        AutoGeneratedKeys obj = new AutoGeneratedKeys();        obj.setPayload(&quot;abc123&quot;);        // id field is null at this point               DynamoDBMapper mapper = new DynamoDBMapper(dynamoDBClient);        mapper.save(obj);        System.out.println(&quot;Object was saved with id &quot; + obj.getId());    }}</code></pre><h3 id="4-3-3-DynamoDBDocument"><a href="#4-3-3-DynamoDBDocument" class="headerlink" title="4.3.3 DynamoDBDocument"></a>4.3.3 DynamoDBDocument</h3><ul><li>indicates that a class can be serialized as a DynamoDB document </li></ul><p>For example, suppose you wanted to map a JSON document to a DynamoDB attribute of type Map (M). The following code snippet defines an item containing a nested attribute (Pictures) of type Map.</p><pre><code>public class ProductCatalogItem {    private Integer id;  //partition key    private Pictures pictures;    /* ...other attributes omitted... */    @DynamoDBHashKey(attributeName=&quot;Id&quot;)      public Integer getId() { return id;}    public void setId(Integer id) {this.id = id;}    @DynamoDBAttribute(attributeName=&quot;Pictures&quot;)      public Pictures getPictures() { return pictures;}    public void setPictures(Pictures pictures) {this.pictures = pictures;}    // Additional properties go here.     @DynamoDBDocument    public static class Pictures {        private String frontView;        private String rearView;        private String sideView;        @DynamoDBAttribute(attributeName = &quot;FrontView&quot;)        public String getFrontView() { return frontView; }        public void setFrontView(String frontView) { this.frontView = frontView; }        @DynamoDBAttribute(attributeName = &quot;RearView&quot;)        public String getRearView() { return rearView; }        public void setRearView(String rearView) { this.rearView = rearView; }        @DynamoDBAttribute(attributeName = &quot;SideView&quot;)        public String getSideView() { return sideView; }        public void setSideView(String sideView) { this.sideView = sideView; }     }}</code></pre><p>You could then save a new ProductCatalog item, with pictures, as shown in the following snippet: </p><pre><code>ProductCatalogItem item = new ProductCatalogItem();Pictures pix = new Pictures();pix.setFrontView(&quot;http://example.com/products/123_front.jpg&quot;);pix.setRearView(&quot;http://example.com/products/123_rear.jpg&quot;);pix.setSideView(&quot;http://example.com/products/123_left_side.jpg&quot;);item.setPictures(pix);item.setId(123);mapper.save(item); </code></pre><p>The resulting ProductCalalog item would look like this: </p><pre><code>{  &quot;Id&quot; : 123  &quot;Pictures&quot; : {    &quot;SideView&quot; : &quot;http://example.com/products/123_left_side.jpg&quot;,    &quot;RearView&quot; : &quot;http://example.com/products/123_rear.jpg&quot;,    &quot;FrontView&quot; : &quot;http://example.com/products/123_front.jpg&quot;  }} </code></pre><h3 id="4-3-4-DynamoDBHashKey"><a href="#4-3-4-DynamoDBHashKey" class="headerlink" title="4.3.4 DynamoDBHashKey"></a>4.3.4 DynamoDBHashKey</h3><ul><li>Maps a class property to the partition key of the table. The property must be one of the scalar string, number or binary types; it cannot be a collection type. </li></ul><pre><code>@DynamoDBTable(tableName=&quot;ProductCatalog&quot;) public class CatalogItem {     private Integer Id;      @DynamoDBHashKey(attributeName=&quot;Id&quot;)   public Integer getId() {        return Id;   }   public void setId(Integer Id) {        this.Id = Id;   }   // Additional properties go here. }</code></pre><h3 id="4-3-5-DynamoDBIgnore"><a href="#4-3-5-DynamoDBIgnore" class="headerlink" title="4.3.5 DynamoDBIgnore"></a>4.3.5 DynamoDBIgnore</h3><ul><li>Indicates to the DynamoDBMapper instance that the associated property should be ignored. When saving data to the table, the DynamoDBMapper does not save property to the table. </li></ul><h3 id="4-3-6-DynamoDBIndexHashKey"><a href="#4-3-6-DynamoDBIndexHashKey" class="headerlink" title="4.3.6 DynamoDBIndexHashKey"></a>4.3.6 DynamoDBIndexHashKey</h3><ul><li>Maps a class property to the partition key of a global secondary index. The property must be one of the scalar string, number or binary types; it cannot be a collection type.</li><li>Use this annotation if you need to Query a global secondary index. You must specify the index name (globalSecondaryIndexName). If the name of the class property is different from the index partition key, you must also specify the name of that index attribute (attributeName).</li><li>Global Secondary Indexes <ul><li>aims to speed up queries on non-key values </li></ul></li></ul><h3 id="4-3-7-DynamoDBRangeKey"><a href="#4-3-7-DynamoDBRangeKey" class="headerlink" title="4.3.7 DynamoDBRangeKey"></a>4.3.7 DynamoDBRangeKey</h3><ul><li>Maps a class property to the sort key of the table. The property mush be one of the scalar string, number or binary types; it cannot be a collection type. </li><li>If the primary key is composite (partition key and sort key), you can use this tag to map your class field to the sort key.</li></ul><pre><code>@DynamoDBTable(tableName=&quot;Reply&quot;)public class Reply {     private Integer id;    private String replyDateTime;    @DynamoDBHashKey(attributeName=&quot;Id&quot;)    public Integer getId() { return id; }    public void setId(Integer id) { this.id = id; }     @DynamoDBRangeKey(attributeName=&quot;ReplyDateTime&quot;)    public String getReplyDateTime() { return replyDateTime; }    public void setReplyDateTime(String replyDateTime) { this.replyDateTime = replyDateTime; }    // Additional properties go here. }</code></pre><h3 id="4-3-8-DynamoDBTable"><a href="#4-3-8-DynamoDBTable" class="headerlink" title="4.3.8 DynamoDBTable"></a>4.3.8 DynamoDBTable</h3><ul><li>Identifies the target table in DynamoDB. </li><li>The @DynamoDBTable annotation can be inherited. Any new class that inherits from the Developer class also maps to the People table. For example, assume that you create a Lead class that inherits from the Developer class. Because you mapped the Developer class to the People table, the Lead class objects are also stored in the same table.</li></ul><pre><code>@DynamoDBTable(tableName=&quot;People&quot;) public class Developer { ...} </code></pre><h3 id="4-3-9-DynamoDBTypeConverted"><a href="#4-3-9-DynamoDBTypeConverted" class="headerlink" title="4.3.9 DynamoDBTypeConverted"></a>4.3.9 DynamoDBTypeConverted</h3><pre><code>+ Annotation to mark a property as using a custom type-converter. + This interface lets you map your own arbitrary data types to a data type that is natively supported by DynamoDB</code></pre><h3 id="4-3-10-DynamoDBTyped"><a href="#4-3-10-DynamoDBTyped" class="headerlink" title="4.3.10 DynamoDBTyped"></a>4.3.10 DynamoDBTyped</h3><pre><code>+ Annotation to override the standard attribute type binding. Standard types do not require the annotation if applying the default attribute binding for that type. </code></pre><h3 id="4-3-11-DynamoDBVersionAttribute"><a href="#4-3-11-DynamoDBVersionAttribute" class="headerlink" title="4.3.11 DynamoDBVersionAttribute"></a>4.3.11 DynamoDBVersionAttribute</h3><ul><li>Identifies a class property for storing an optimistic locking version number. DynamoDBMapper assigns a version number to this property when it saves a new item, and increments it each time you update the item.  </li></ul><h2 id="4-4-The-DynamoDBMapper-Class"><a href="#4-4-The-DynamoDBMapper-Class" class="headerlink" title="4.4 The DynamoDBMapper Class"></a>4.4 The DynamoDBMapper Class</h2><p>The DynamoDBMapper class is the entry point to DynamoDB. It provides access to a DynamoDB endpoint and enables you to access data in various tables, perform various CRUD operations on items, and execute queries and scans against tables. </p><h3 id="4-4-1-save"><a href="#4-4-1-save" class="headerlink" title="4.4.1 save"></a>4.4.1 save</h3><p>Saves the specified object to the table. The object that you wish to save is the only required parameter for this method. You can provide optional configuration parameters using the <strong><em>DynamoDBMapperConfig</em></strong> object. </p><p>If an item that has the same primary key does not exist, this method creates a new item in the table. If an item that has the same primary key exists, it updates the existing item. If the partition key and sort key are of type String, and annotated with @DynamoDBAutoGeneratedKey, then they are given a random universally unique identifier (UUID) if left uninitialized. Version fields annotated with @DynamoDBVersionAttribute will be incremented by one. Additionally, if a version field is updated or a key generated, the object passed in is updated as a result of the operation.</p><p>By default, only attributes corresponding to mapped class properties are updated; any additional existing attributes on an item are unaffected. However, if you specify SaveBehavior.CLOBBER, you can force the item to be completely overwritten.</p><pre><code>mapper.save(obj, new DynamoDBMapperConfig(DynamoDBMapperConfig.SaveBehavior.CLOBBER));</code></pre><h3 id="4-4-2-load"><a href="#4-4-2-load" class="headerlink" title="4.4.2 load"></a>4.4.2 load</h3><p>Retrieves an item from a table. You must provide the primary key of the item that you wish to retrieve. You can provide optional configuration parameters using the DynamoDBMapperConfig object. </p><pre><code>CatalogItem item = mapper.load(CatalogItem.class, item.getId(),                 new DynamoDBMapperConfig(DynamoDBMapperConfig.ConsistentReads.CONSISTENT)); </code></pre><h3 id="4-4-3-delete"><a href="#4-4-3-delete" class="headerlink" title="4.4.3 delete"></a>4.4.3 delete</h3><p>Deletes an item from the table, must pass in an object instance of the mapped class. </p><h3 id="4-4-4-query"><a href="#4-4-4-query" class="headerlink" title="4.4.4 query"></a>4.4.4 query</h3><p>Queries a table or a secondary index. You can query a table or an index only if it has a composite primary key (partition key and sort key). This method requires you to provide a partition key value and a query filter that is applied on the sort key. A filter expression includes a condition and a value.</p><pre><code>String forumName = &quot;DynamoDB&quot;;String forumSubject = &quot;DynamoDB Thread 1&quot;;String partitionKey = forumName + &quot;#&quot; + forumSubject;long twoWeeksAgoMilli = (new Date()).getTime() - (14L*24L*60L*60L*1000L);Date twoWeeksAgo = new Date();twoWeeksAgo.setTime(twoWeeksAgoMilli);SimpleDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSS&#39;Z&#39;&quot;);String twoWeeksAgoStr = df.format(twoWeeksAgo);Map&lt;String, AttributeValue&gt; eav = new HashMap&lt;String, AttributeValue&gt;();eav.put(&quot;:v1&quot;, new AttributeValue().withS(partitionKey));eav.put(&quot;:v2&quot;,new AttributeValue().withS(twoWeeksAgoStr.toString()));DynamoDBQueryExpression&lt;Reply&gt; queryExpression = new DynamoDBQueryExpression&lt;Reply&gt;()     .withKeyConditionExpression(&quot;Id = :v1 and ReplyDateTime &gt; :v2&quot;)    .withExpressionAttributeValues(eav);List&lt;Reply&gt; latestReplies = mapper.query(Reply.class, queryExpression);</code></pre><p>By default, the query method returns a â€œ<strong>lazy-loaded</strong>â€œ collection. It initially returns only one page of results, and then makes a service call for the next page if needed. To obtain all the matching items, you only need to iterate over the latestReplies collection.</p><p>To query an index, you must first <strong><em>model the index as a mapper class</em></strong>, Suppose that the Reply table has a global secondary index named PostedBy-Message-Index. The partition key for this index is PostedBy, and the sort key is Message. The class definition for an item in the index would look like this:</p><pre><code>@DynamoDBTable(tableName=&quot;Reply&quot;)public class PostedByMessage {     private String postedBy;    private String message;    @DynamoDBIndexHashKey(globalSecondaryIndexName = &quot;PostedBy-Message-Index&quot;, attributeName = &quot;PostedBy&quot;)    public String getPostedBy() { return postedBy; }    public void setPostedBy(String postedBy) { this.postedBy = postedBy; }     @DynamoDBIndexRangeKey(globalSecondaryIndexName = &quot;PostedBy-Message-Index&quot;, attributeName = &quot;Message&quot;)    public String getMessage() { return message; }    public void setMessage(String message) { this.message = message; }    // Additional properties go here. }</code></pre><p>The @DynamoDBTable annotation indicates that this index is associated with the Reply table. The @DynamoDBIndexHashKey annotation denotes the partition key (PostedBy) of the index, and @DynamoDBIndexRangeKey denotes the sort key (Message) of the index.</p><p>Now you can use DynamoDBMapper to query the index, retrieving a subset of messages that were posted by a particular user. You must specify withIndexName so that DynamoDB knows which index to query. In the following code snippet, we are querying a global secondary index. Because global secondary indexes support eventually consistent reads, but not strongly consistent reads, we must specify withConsistentRead(false).</p><pre><code>HashMap&lt;String, AttributeValue&gt; eav = new HashMap&lt;String, AttributeValue&gt;();eav.put(&quot;:v1&quot;,  new AttributeValue().withS(&quot;User A&quot;));eav.put(&quot;:v2&quot;,  new AttributeValue().withS(&quot;DynamoDB&quot;));DynamoDBQueryExpression&lt;PostedByMessage&gt; queryExpression = new DynamoDBQueryExpression&lt;PostedByMessage&gt;()    .withIndexName(&quot;PostedBy-Message-Index&quot;)    .withConsistentRead(false)    .withKeyConditionExpression(&quot;PostedBy = :v1 and begins_with(Message, :v2)&quot;)    .withExpressionAttributeValues(eav);List&lt;PostedByMessage&gt; iList =  mapper.query(PostedByMessage.class, queryExpression);</code></pre><h2 id="4-5-Configuration-settings-for-DynamoDBMapper"><a href="#4-5-Configuration-settings-for-DynamoDBMapper" class="headerlink" title="4.5 Configuration settings for DynamoDBMapper"></a>4.5 Configuration settings for DynamoDBMapper</h2><p>When you create an instance of DynamoDBMapper, it has certain default behaviors; you can override these defaults by using the DynamoDBmapperConfig class. </p><pre><code>AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard().build();DynamoDBMapperConfig mapperConfig = new DynamoDBMapperConfig(    DynamoDBMapperConfig.SaveBehavior.CLOBBER,    DynamoDBMapperConfig.ConsistentReads.CONSISTENT,    null, //TableNameOverride - leaving this at default setting    DynamoDBMapperConfig.PaginationLoadingStrategy.EAGER_LOADING    );DynamoDBMapper mapper = new DynamoDBMapper(client, mapperConfig, cp);</code></pre><p><a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodbv2/datamodeling/DynamoDBMapperConfig.html" target="_blank" rel="noopener">API doc for DynamoDBMapperConfig</a></p><ul><li>DynamoDBMapperConfig.ConsistentReads<ul><li>EVENTUALâ€”the mapper instance uses an eventually consistent read request ++<strong>(default)</strong>++</li><li>CONSISTENTâ€”the mapper instance uses a strongly consistent read request. You can use this optional setting with load, query, or scan operations. Strongly consistent reads have implications for performance and billing; see the DynamoDB product detail page for more information</li></ul></li><li>DynamoDBMapperConfig.PaginationLoadingStrategy - controls how the mapper instance processes a paginated list of data, such as results from a query or scan <ul><li>LAZY_LOADINGâ€”the mapper instance loads data when possible, and keeps all loaded results in memory ++<strong>(default)</strong>++</li><li>EAGER_LOADINGâ€”the mapper instance loads the data as soon as the list is initialized</li><li>ITERATION_ONLYâ€”you can only use an Iterator to read from the list. During the iteration, the list will clear all the previous results before loading the next page, so that the list will keep at most one page of the loaded results in memory. This also means the list can only be iterated once. This strategy is recommended when handling large items, in order to reduce memory overhead</li></ul></li><li>DynamoDBMapperConfig.SaveBehavior enumeration value - Specifies how the mapper instance should deal with attributes during save operations<ul><li>UPDATEâ€”during a save operation, all modeled attributes are updated, and unmodeled attributes are unaffected. Primitive number types (byte, int, long) are set to 0. Object types are set to null. ++<strong>(default)</strong>++</li><li>CLOBBERâ€”clears and replaces all attributes, included unmodeled ones, during a save operation. This is done by deleting the item and re-creating it. Versioned field constraints are also disregarded.</li></ul></li><li>DynamoDBMapperConfig.TableNameOverride objectâ€”Instructs the mapper instance to ignore the table name specified by a classâ€™s DynamoDBTable annotation, and instead use a different table name that you supply. This is useful when partitioning your data into multiple tables at run time.</li></ul><h2 id="4-6-Example-CRUD-Operations"><a href="#4-6-Example-CRUD-Operations" class="headerlink" title="4.6 Example: CRUD Operations"></a>4.6 Example: CRUD Operations</h2><p>The following Java code example declares a CatalogItem class that has Id, Title, ISBN and Authors properties. It uses the annotations to map these properties to the ProductCatalog table in DynamoDB. The code example then uses the DynamoDBMapper to save a book object, retrieve it, update it and delete the book item.</p><pre><code>package com.amazonaws.codesamples.datamodeling;import java.io.IOException;import java.util.Arrays;import java.util.HashSet;import java.util.Set;import com.amazonaws.services.dynamodbv2.AmazonDynamoDB;import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClientBuilder;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBAttribute;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBHashKey;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapper;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapperConfig;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBTable;public class DynamoDBMapperCRUDExample {    static AmazonDynamoDB client = AmazonDynamoDBClientBuilder.standard().build();    public static void main(String[] args) throws IOException {        testCRUDOperations();        System.out.println(&quot;Example complete!&quot;);    }    @DynamoDBTable(tableName = &quot;ProductCatalog&quot;)    public static class CatalogItem {        private Integer id;        private String title;        private String ISBN;        private Set&lt;String&gt; bookAuthors;        // Partition key        @DynamoDBHashKey(attributeName = &quot;Id&quot;)        public Integer getId() {            return id;        }        public void setId(Integer id) {            this.id = id;        }        @DynamoDBAttribute(attributeName = &quot;Title&quot;)        public String getTitle() {            return title;        }        public void setTitle(String title) {            this.title = title;        }        @DynamoDBAttribute(attributeName = &quot;ISBN&quot;)        public String getISBN() {            return ISBN;        }        public void setISBN(String ISBN) {            this.ISBN = ISBN;        }        @DynamoDBAttribute(attributeName = &quot;Authors&quot;)        public Set&lt;String&gt; getBookAuthors() {            return bookAuthors;        }        public void setBookAuthors(Set&lt;String&gt; bookAuthors) {            this.bookAuthors = bookAuthors;        }        @Override        public String toString() {            return &quot;Book [ISBN=&quot; + ISBN + &quot;, bookAuthors=&quot; + bookAuthors + &quot;, id=&quot; + id + &quot;, title=&quot; + title + &quot;]&quot;;        }    }    private static void testCRUDOperations() {        CatalogItem item = new CatalogItem();        item.setId(601);        item.setTitle(&quot;Book 601&quot;);        item.setISBN(&quot;611-1111111111&quot;);        item.setBookAuthors(new HashSet&lt;String&gt;(Arrays.asList(&quot;Author1&quot;, &quot;Author2&quot;)));        // Save the item (book).        DynamoDBMapper mapper = new DynamoDBMapper(client);        mapper.save(item);        // Retrieve the item.        CatalogItem itemRetrieved = mapper.load(CatalogItem.class, 601);        System.out.println(&quot;Item retrieved:&quot;);        System.out.println(itemRetrieved);        // Update the item.        itemRetrieved.setISBN(&quot;622-2222222222&quot;);        itemRetrieved.setBookAuthors(new HashSet&lt;String&gt;(Arrays.asList(&quot;Author1&quot;, &quot;Author3&quot;)));        mapper.save(itemRetrieved);        System.out.println(&quot;Item updated:&quot;);        System.out.println(itemRetrieved);        // Retrieve the updated item.        DynamoDBMapperConfig config = new DynamoDBMapperConfig(DynamoDBMapperConfig.ConsistentReads.CONSISTENT);        CatalogItem updatedItem = mapper.load(CatalogItem.class, 601, config);        System.out.println(&quot;Retrieved the previously updated item:&quot;);        System.out.println(updatedItem);        // Delete the item.        mapper.delete(updatedItem);        // Try to retrieve deleted item.        CatalogItem deletedItem = mapper.load(CatalogItem.class, updatedItem.getId(), config);        if (deletedItem == null) {            System.out.println(&quot;Done - Sample item is deleted.&quot;);        }    }}</code></pre><h2 id="4-7-Examples-Batch-Write-Query-Scan-Optimistic-Locking-with-Version-Number"><a href="#4-7-Examples-Batch-Write-Query-Scan-Optimistic-Locking-with-Version-Number" class="headerlink" title="4.7 Examples: Batch Write + Query + Scan + Optimistic Locking with Version Number"></a>4.7 Examples: Batch Write + Query + Scan + Optimistic Locking with Version Number</h2><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBMapper.BatchWriteExample.html" target="_blank" rel="noopener">BatchWrite</a></p><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBMapper.QueryScanExample.html" target="_blank" rel="noopener">Query and Scan</a></p><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBMapper.OptimisticLocking.html" target="_blank" rel="noopener">Optimistic Locking With Version Number</a></p><h2 id="4-8-Example-Mapping-Arbitrary-Data"><a href="#4-8-Example-Mapping-Arbitrary-Data" class="headerlink" title="4.8 Example: Mapping Arbitrary Data"></a>4.8 Example: Mapping Arbitrary Data</h2><p>In addtion to the supported java types, you can use types in your application for which there is no direct mapping to the DynamoDB types. </p><blockquote><p> To map these types, you must provide an implementation that converts your complex type to a DynamoDB supported type and vice-versa, and annotate the complex type accessor method using the @DynamoDBTypeConverted annotation. </p></blockquote><p>The converter code transforms data when objects are saved or loaded. It is also used for all operations that consume complex types. Note that when comparing data during query and scan operations, the comparisons are made against the data stored in DynamoDB.</p><p>For example, consider the following CatalogItem class that defines a property, Dimension, that is of DimensionType. This property stores the item dimensions, as height, width, and thickness. Assume that you decide to store these item dimensions as a string (such as 8.5x11x.05) in DynamoDB. The following example provides converter code that converts the DimensionType object to a string and a string to the DimensionType.</p><pre><code>package com.amazonaws.codesamples.datamodeling;import java.io.IOException;import java.util.Arrays;import java.util.HashSet;import java.util.Set;import com.amazonaws.regions.Regions;import com.amazonaws.services.dynamodbv2.AmazonDynamoDB;import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClientBuilder;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBAttribute;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBHashKey;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapper;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBTypeConverted;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBTypeConverter;import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBTable;public class DynamoDBMapperExample {    static AmazonDynamoDB client;    public static void main(String[] args) throws IOException {        // Set the AWS region you want to access.        Regions usWest2 = Regions.US_WEST_2;        client = AmazonDynamoDBClientBuilder.standard().withRegion(usWest2).build();        DimensionType dimType = new DimensionType();        dimType.setHeight(&quot;8.00&quot;);        dimType.setLength(&quot;11.0&quot;);        dimType.setThickness(&quot;1.0&quot;);        Book book = new Book();        book.setId(502);        book.setTitle(&quot;Book 502&quot;);        book.setISBN(&quot;555-5555555555&quot;);        book.setBookAuthors(new HashSet&lt;String&gt;(Arrays.asList(&quot;Author1&quot;, &quot;Author2&quot;)));        book.setDimensions(dimType);        DynamoDBMapper mapper = new DynamoDBMapper(client);        mapper.save(book);        Book bookRetrieved = mapper.load(Book.class, 502);        System.out.println(&quot;Book info: &quot; + &quot;\n&quot; + bookRetrieved);        bookRetrieved.getDimensions().setHeight(&quot;9.0&quot;);        bookRetrieved.getDimensions().setLength(&quot;12.0&quot;);        bookRetrieved.getDimensions().setThickness(&quot;2.0&quot;);        mapper.save(bookRetrieved);        bookRetrieved = mapper.load(Book.class, 502);        System.out.println(&quot;Updated book info: &quot; + &quot;\n&quot; + bookRetrieved);    }    @DynamoDBTable(tableName = &quot;ProductCatalog&quot;)    public static class Book {        private int id;        private String title;        private String ISBN;        private Set&lt;String&gt; bookAuthors;        private DimensionType dimensionType;        // Partition key        @DynamoDBHashKey(attributeName = &quot;Id&quot;)        public int getId() {            return id;        }        public void setId(int id) {            this.id = id;        }        @DynamoDBAttribute(attributeName = &quot;Title&quot;)        public String getTitle() {            return title;        }        public void setTitle(String title) {            this.title = title;        }        @DynamoDBAttribute(attributeName = &quot;ISBN&quot;)        public String getISBN() {            return ISBN;        }        public void setISBN(String ISBN) {            this.ISBN = ISBN;        }        @DynamoDBAttribute(attributeName = &quot;Authors&quot;)        public Set&lt;String&gt; getBookAuthors() {            return bookAuthors;        }        public void setBookAuthors(Set&lt;String&gt; bookAuthors) {            this.bookAuthors = bookAuthors;        }        @DynamoDBTypeConverted(converter = DimensionTypeConverter.class)        @DynamoDBAttribute(attributeName = &quot;Dimensions&quot;)        public DimensionType getDimensions() {            return dimensionType;        }        @DynamoDBAttribute(attributeName = &quot;Dimensions&quot;)        public void setDimensions(DimensionType dimensionType) {            this.dimensionType = dimensionType;        }        @Override        public String toString() {            return &quot;Book [ISBN=&quot; + ISBN + &quot;, bookAuthors=&quot; + bookAuthors + &quot;, dimensionType= &quot;                + dimensionType.getHeight() + &quot; X &quot; + dimensionType.getLength() + &quot; X &quot; + dimensionType.getThickness()                + &quot;, Id=&quot; + id + &quot;, Title=&quot; + title + &quot;]&quot;;        }    }    static public class DimensionType {        private String length;        private String height;        private String thickness;        public String getLength() {            return length;        }        public void setLength(String length) {            this.length = length;        }        public String getHeight() {            return height;        }        public void setHeight(String height) {            this.height = height;        }        public String getThickness() {            return thickness;        }        public void setThickness(String thickness) {            this.thickness = thickness;        }    }    // Converts the complex type DimensionType to a string and vice-versa.    static public class DimensionTypeConverter implements DynamoDBTypeConverter&lt;String, DimensionType&gt; {        @Override        public String convert(DimensionType object) {            DimensionType itemDimensions = (DimensionType) object;            String dimension = null;            try {                if (itemDimensions != null) {                    dimension = String.format(&quot;%s x %s x %s&quot;, itemDimensions.getLength(), itemDimensions.getHeight(),                        itemDimensions.getThickness());                }            }            catch (Exception e) {                e.printStackTrace();            }            return dimension;        }        @Override        public DimensionType unconvert(String s) {            DimensionType itemDimension = new DimensionType();            try {                if (s != null &amp;&amp; s.length() != 0) {                    String[] data = s.split(&quot;x&quot;);                    itemDimension.setLength(data[0].trim());                    itemDimension.setHeight(data[1].trim());                    itemDimension.setThickness(data[2].trim());                }            }            catch (Exception e) {                e.printStackTrace();            }            return itemDimension;        }    }}</code></pre><h1 id="5-Best-Practices"><a href="#5-Best-Practices" class="headerlink" title="5. Best Practices"></a>5. Best Practices</h1><h2 id="5-1-Partition-Key-Design"><a href="#5-1-Partition-Key-Design" class="headerlink" title="5.1 Partition Key Design"></a>5.1 Partition Key Design</h2><p>Generally speaking, you should design your application for <strong>uniform activity across all logical partition keys</strong> in the Table and its secondary indexes. You can determine the access patterns that your application requires, and estimate the total RCUs and WCUs that each table and secondary Index requires.</p><p>As traffic starts to flow, DynamoDB automatically supports your access patterns using the throughput you have provisioned, as long as the traffic against a given partition key does not exceed 3000 RCUs or 1000 WCUs.</p><h3 id="5-1-1-Using-Burst-Capacity-Effectively"><a href="#5-1-1-Using-Burst-Capacity-Effectively" class="headerlink" title="5.1.1 Using Burst Capacity Effectively"></a>5.1.1 Using Burst Capacity Effectively</h3><p>DynamoDB provides some flexibility in your per-partition throughput provisioning by providing burst capacity, as follows. Whenever you are not fully using a partitionâ€™s throughput, DynamoDB reserves a portion of that unused capacity for later bursts of throughput to handle usage spikes.</p><p>DynamoDB currently retains up to <strong>five minutes (300 seconds)</strong> of unused read and write capacity. During an occasional burst of read or write activity, these extra capacity units can be consumed quicklyâ€”even faster than the per-second provisioned throughput capacity that youâ€™ve defined for your table.</p><h3 id="5-1-2-Adaptive-Capacity"><a href="#5-1-2-Adaptive-Capacity" class="headerlink" title="5.1.2 Adaptive Capacity"></a>5.1.2 Adaptive Capacity</h3><p>When data access is imbalanced, a â€œhotâ€ partition can receive such a higher volume of read and write traffic compared to other partitions. In extreme cases, throttling can occur if a single partition receives more than 3,000 RCUs or 1,000 WCUs. </p><p>To better accommodate uneven access patterns, DynamoDB adaptive capacity enables your application to continue reading and writing to hot partitions without being throttled, provided that traffic does not exceed your tableâ€™s total provisioned capacity or the partition maximum capacity. Adaptive capacity works by automatically increasing throughput capacity for partitions that receive more traffic.</p><h1 id="6-Working-with-Stream"><a href="#6-Working-with-Stream" class="headerlink" title="6. Working with Stream"></a>6. Working with Stream</h1><p>DynamoDB streams captures a time-ordered sequence of item-level modifications in any DynamoDB table, and stores this information in a log for up to 24 hours. Applications can access this log and view the data items as they appeared before and after they were modified, in near real time.</p><blockquote><p>A DynamoDB stream is an ordered flow of information about changes to items in an Amazon DynamoDB table. When you enable a stream on a table, DynamoDB captures information about every modification to data items in the table. </p></blockquote><p>Whenever an application creates, updates, or deletes items in the table, DynamoDB Streams writes a stream record with the primary key attribute(s) of the items that were modified. A stream record contains information about a data modification to a single item in a DynamoDB table. You can configure the stream so that the stream records capture additional information, such as the â€œbeforeâ€ and â€œafterâ€ images of modified items.</p><p>DynamoDB Streams guarantees the following: </p><ul><li>Each stream record appears exactly once in the stream </li><li><strong>For each item that is modified in a DynamoDB table, the stream records appear in the same sequence as the actual modifications to the item.</strong></li></ul><p>DynamoDB Streams writes stream records in near real time, so that you can build applications that consume these streams and take action based on the contents.</p><p>Use one endpoint for accessing DynamoDB, and another endpoint within same region for accessing DynamoDB streams. </p><h2 id="6-1-Reading-and-Processing-a-Stream"><a href="#6-1-Reading-and-Processing-a-Stream" class="headerlink" title="6.1 Reading and Processing a Stream"></a>6.1 Reading and Processing a Stream</h2><p>To read and process a stream, your application will need to connect to a DynamoDB Streams endpoint and issue API requests. </p><p>A stream consists of stream records. Each stream record represents a single data modification in the DynamoDB table to which the stream belongs. Each stream record is assigned a sequence number, reflecting the order in which the record was published to the stream.</p><p>Stream records are organized into groups, or shards. Each shard acts as a container for multiple stream records, and contains information required for accessing and iterating through these records. The stream records within a shard are removed automatically after 24 hours.</p><p>Shards are ephemeral: They are created and deleted automatically, as needed. Any shard can also split into multiple new shards; this also occurs automatically. (Note that it is also possible for a parent shard to have just one child shard.) A shard might split in response to high levels of write activity on its parent table, so that applications can process records from multiple shards in parallel.</p><p>Because shards have a lineage (parent and children), an application must always process a parent shard before it processes a child shard. This will ensure that the stream records are also processed in the correct order. (If you use the DynamoDB Streams Kinesis Adapter, this is handled for you: Your application will process the shards and stream records in the correct order, and automatically handle new or expired shards, as well as shards that split while the application is running.</p><p>To access a stream and process the stream records within, you must do the following: </p><ul><li>Determine the unique Amazon Resource Name (ARN) of the stream that you want to access.</li><li>Determine which shard(s) in the stream contain the stream records that you are interested in.</li><li>Access the shard(s) and retrieve the stream records that you want</li></ul><h2 id="6-2-DynamoDB-Streams-API"><a href="#6-2-DynamoDB-Streams-API" class="headerlink" title="6.2 DynamoDB Streams API"></a>6.2 DynamoDB Streams API</h2><p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Operations_Amazon_DynamoDB_Streams.html" target="_blank" rel="noopener">API Instructions</a></p><h3 id="6-2-1-ListStreams"><a href="#6-2-1-ListStreams" class="headerlink" title="6.2.1 ListStreams"></a>6.2.1 ListStreams</h3><p>returns a list of stream descriptors for the current account and endpoint. You can optionally request just the stream descriptors for a particular table name.</p><h3 id="6-2-2-DescribeStream"><a href="#6-2-2-DescribeStream" class="headerlink" title="6.2.2 DescribeStream"></a>6.2.2 DescribeStream</h3><p>returns detailed information about a given stream. The output includes a list of shards associated with the stream, including the shard IDs.</p><h3 id="6-2-3-GetShardIterator"><a href="#6-2-3-GetShardIterator" class="headerlink" title="6.2.3 GetShardIterator"></a>6.2.3 GetShardIterator</h3><p>returns a shard iterator, which describes a location within a shard. You can request that the iterator provide access to the oldest point, the newest point, or a particular point in the stream.</p><h3 id="6-2-4-GetRecords"><a href="#6-2-4-GetRecords" class="headerlink" title="6.2.4 GetRecords"></a>6.2.4 GetRecords</h3><p>returns the stream records from within a given shard. </p><h2 id="6-3-Using-the-DynamoDB-Streams-Kinesis-Adapter-to-Process-Stream-Records"><a href="#6-3-Using-the-DynamoDB-Streams-Kinesis-Adapter-to-Process-Stream-Records" class="headerlink" title="6.3 Using the DynamoDB Streams Kinesis Adapter to Process Stream Records"></a>6.3 Using the DynamoDB Streams Kinesis Adapter to Process Stream Records</h2><p><a href="https://aws.amazon.com/blogs/database/how-to-perform-ordered-data-replication-between-applications-by-using-amazon-dynamodb-streams/" target="_blank" rel="noopener">How to perform ordered data replication between applications by using Amazon DynamoDB Streams</a></p>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> DynamoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.11 Deploying Applications</title>
      <link href="/Developing-on-AWS-Note-11-Deploying-Applications/"/>
      <url>/Developing-on-AWS-Note-11-Deploying-Applications/</url>
      
        <content type="html"><![CDATA[<h1 id="1-DevOps"><a href="#1-DevOps" class="headerlink" title="1. DevOps"></a>1. DevOps</h1><ul><li>Application is the application plus all of the associated infrastructure</li><li>includes<ul><li>VPCs </li><li>load balancers</li><li>auto scaling groups </li><li>Amazon RDS databases</li><li>Amazon S3 bucket </li><li>elastiCache servers</li></ul></li><li>deploying in the cloud helps break down these traditional silos. Bugs due to different environment. </li><li>practices<ul><li>microservices</li><li>CI/ CD</li><li>Infrastructure as code </li></ul></li><li>Tools <ul><li>AWS Code Services </li></ul></li><li>Under a DevOps model, development and operations are no longer siloed. </li><li>Sometimes, those two functions are merged into a single team where engineers work across the entire application lifecycle, from development and test to deployment to operations, and develop a range of skills not limited to a single function. </li><li>Quality assurance and security teams could become more tightly integrated with development and operations throughout the application lifecycle. </li></ul><h1 id="2-Release-Processes-Major-Phases"><a href="#2-Release-Processes-Major-Phases" class="headerlink" title="2. Release Processes Major Phases"></a>2. Release Processes Major Phases</h1><p>Each steps can be automated without the entire release process being automated. </p><ul><li>Source<ul><li>Check in source code such as .java files </li><li>Code review</li></ul></li><li>Build<ul><li>Compile code </li><li>style checkers</li><li>code metrics</li><li>create container images </li></ul></li><li>Test <ul><li>Integration tests with other systems</li><li>load testing</li><li>UI tests</li><li>penetration testing </li></ul></li><li>Deploy<ul><li>Deployment to production environments </li></ul></li><li>Monitor<ul><li>Monitor in production to quickly detect unusual activity or errors</li></ul></li></ul><h1 id="3-Understanding-CI-amp-CD"><a href="#3-Understanding-CI-amp-CD" class="headerlink" title="3. Understanding CI &amp; CD"></a>3. Understanding CI &amp; CD</h1><ul><li><p>Continuous Integration </p><ul><li>The practice of checking code and verifying each change with an automated build and test process</li><li>Require teams to write automated tests which can improve the quality of the software being released and reduce the time it takes to validate that the new version of software is good. </li><li>Architecture for cloud Continuous Integration<ul><li>Developer commits changes to the central repo. Pre-commit hooks should run and verify that the code meets specified requirements</li><li>A CI server pulls the changes from the central repo and builds the code</li><li>The CI server runs all required tests against the new branch or mainline change. </li><li>The CI server returns a report to developer and stops the build job if a failure occurs. </li><li>If the changes pass the required tests, the CI server builds the artifacts</li><li>The CI server pushes artifacts to the package builder</li><li>The <strong>package builder</strong> gets configuration information from the version control system </li><li>The pacakge builder uses the configuration information and the artifacts to build the specified packages </li><li>the packages are stored in a repository </li><li>the repo uses a post-receive hook to deploy specific packages to staging. </li><li>Do not fear rollbacks. Errors will happen, mistakes will be made, and the benefit of employing version control systems is that when appropriate, you can always revert to a previously working state and save yourself the time and effort of trying to debug </li></ul></li></ul></li><li><p>Continuous Delivery</p><ul><li>It extends continuous Integration to include testing out to production-like stages and running verification testing against those deployments. </li><li>CD may extend all the way to a production deployment, but they have some form of manual intervention between a code check-in and when that code is available for customers to use</li></ul></li><li><p>Continuous Deployment </p><ul><li>extends continuous delivery and is the automated release of software to customers from check in through to production without human intervention.  </li></ul></li></ul><h1 id="4-How-do-you-deploy-all-infrastructure-along-with-your-application"><a href="#4-How-do-you-deploy-all-infrastructure-along-with-your-application" class="headerlink" title="4. How do you deploy all infrastructure along with your application?"></a>4. How do you deploy all infrastructure along with your application?</h1><ul><li>Infrastructure as code <ul><li>Define your AWS environment so that it can be created in a repeatable automated fashion </li><li>stand up identical dev/ test environments on demand </li><li>use the same code to create your production environment that you used to create your other environments</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> CI/ CD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.10 Docker, ECS, Security</title>
      <link href="/Developing-on-AWS-Note-10-Docker-ECS-Security/"/>
      <url>/Developing-on-AWS-Note-10-Docker-ECS-Security/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Why-Containers"><a href="#1-Why-Containers" class="headerlink" title="1. Why Containers?"></a>1. Why Containers?</h1><h2 id="1-1-Benefits"><a href="#1-1-Benefits" class="headerlink" title="1.1 Benefits"></a>1.1 Benefits</h2><ul><li>software development lifecycle<ul><li>source code</li><li>code repository </li><li>build env</li><li>artifact repository </li><li>test environment</li><li>deployment env</li></ul></li><li>Containers<ul><li>a method of <strong>operating system virtualization</strong> that allow you to run an application and its dependencies in resource-isolated processes. Containers allow you to easily package an applicationâ€™s code, configurations, and dependencies into easy to use building blocks that deliver <strong>environmental consistency, operational efficiency, developer productivity, and version control</strong> </li><li>help resolve problems<ul><li>different application stacks</li><li>different hardware deployment environments</li><li>run applications across different envs</li><li>migration to different envs</li></ul></li><li>benefits<ul><li>allow you to easily package an applicationâ€™s code, configurations, and dependencies into easy to use building blocks that deliver environmental consistency, operational efficiency, developer productivity, and version control</li></ul></li></ul></li><li>docker containers<ul><li>decouple applications from operating systems </li></ul></li><li>Containers vs VM <ul><li>Containers can run on any Linux system with appropriate kernel feature support and the Docker daemon present. This makes them extremely portable. Your laptop, your VM, your EC2 instance, and your bare metal server are all potential hosts.</li><li>The lack of a hypervisor requirement also results in almost no noticeable performance overhead. The processes are talking directly to the kernel and are largely unaware of their container silo. Most containers boot in just a couple of seconds.</li><li>Where VMs are isolated at the operating system level, containers are isolated at the kernel level. This means that several applications can run on a single host operating system, and yet still have their own file system, storage, RAM, libraries, essentially, their own â€œviewâ€ of the system. </li></ul></li></ul><h2 id="1-2-When-to-use-Docker-Containers"><a href="#1-2-When-to-use-Docker-Containers" class="headerlink" title="1.2 When to use Docker Containers"></a>1.2 When to use Docker Containers</h2><ul><li>Distributed apps and microservices<ul><li>breaking up monoliths </li><li>service oriented architecture</li></ul></li><li>Batch Jobs<ul><li>short lived jobs</li><li>variety and flexibility </li><li>elastic</li></ul></li><li>CI/ CD pipelins<ul><li>packaging your code in a Docker images</li><li>test</li><li>deploy in production </li></ul></li></ul><h2 id="1-3-Microservices-architecture-with-Containers"><a href="#1-3-Microservices-architecture-with-Containers" class="headerlink" title="1.3 Microservices architecture with Containers"></a>1.3 Microservices architecture with Containers</h2><p>Using Docker, all of the different tiers of your Web application architecture could be <strong>constructed as independent Docker containers</strong>. If you are deploying a microservices architecture, you could <strong>implement each service as its own separate Docker container</strong>. Such an approach has several advantages: </p><ul><li>You can distribute running services across instances on an Amazon EC2 fleet.</li><li>You can <strong>run multiple services on a single Amazon EC2 instance within your fleet</strong>. This allows maximizing the CPU and memory usage of your existing instances.</li><li>You can <strong>run multiple different versions of a service simultaneously</strong> - even on the same machine, assuming that they bind to different ports. This allows you to release breaking changes in services while retaining backward compatibility with applications that may not have yet been modified to work against the new version.</li></ul><h2 id="1-4-Docker-Image-Registry"><a href="#1-4-Docker-Image-Registry" class="headerlink" title="1.4 Docker Image Registry"></a>1.4 Docker Image Registry</h2><ul><li>Amazon Elastic Container Registry (Amazon ECR) is a fully-managed Docker container registry that makes it easy for you to store, manage, and deploy Docker container images. </li><li>Amazon ECR can be used standalone and also has deep integration with Amazon ECS, simplifying your development to production workflow. </li><li>Amazon ECR eliminates the need to operate your own container repositories or worry about scaling the underlying infrastructure. </li><li>Amazon ECR hosts your images in a highly available and scalable architecture, allowing you to reliably deploy containers for your applications.</li></ul><h1 id="2-Amazon-Container-Services"><a href="#2-Amazon-Container-Services" class="headerlink" title="2. Amazon Container Services"></a>2. Amazon Container Services</h1><ul><li>You need a way to intelligently place your containers on the hosts that have the resources and that means you need to know the state of everything in your system.</li><li>Amazon Container Services<ul><li>management <ul><li>deploy, schedule, scale,</li><li>Elastic Container Service (ECS)</li><li>Elastic Container Service for Kubernetes (EKS)</li></ul></li><li>hosting <ul><li>Amazon EC2</li><li>AWS Fargate</li></ul></li><li>Image Registry <ul><li>Amazon Elastic Container Registry (ECR)</li></ul></li></ul></li></ul><h1 id="3-Developing-Secure-Applications"><a href="#3-Developing-Secure-Applications" class="headerlink" title="3. Developing Secure Applications"></a>3. Developing Secure Applications</h1><h2 id="3-1-AWS-Certificates-Manager"><a href="#3-1-AWS-Certificates-Manager" class="headerlink" title="3.1 AWS Certificates Manager"></a>3.1 AWS Certificates Manager</h2><ul><li>AWS Certificate Manager is a service that lets you easily provision, manage, and deploy public and private Secure Sockets Layer/ Transport Layer Security (SSL/ TLS) certificates for use with AWS services and your internal connected resources. </li><li>SSL/ TLS are used to secure network communications and establish the identity of websites over the internet as well as resources on private networks. </li><li>With ACM, you can quickly request a certificate, deploy it on ACM-integrated AWS resources, such as Elastic Load Balancing, Amazon CloudFront distributions, and APIs on API Gateway, and let ACM handle certificate renewals. </li><li>It also enables you to create private certificates for your internal resources and manage the certificate lifecycle centrally. Public and private certificates provisioned through ACM for use with ACM-integrated services are free.</li></ul><h2 id="3-2-AWS-Secrets-Manager"><a href="#3-2-AWS-Secrets-Manager" class="headerlink" title="3.2 AWS Secrets Manager"></a>3.2 AWS Secrets Manager</h2><ul><li>Rotate, manage, and retrieve databse credentials, API keys, and other secrets throughout their lifecycle. </li><li>IT administrators<ul><li>store and manage access to secrets securely and at scale</li></ul></li><li>Security administrators<ul><li>audit and monitor the use of secrets, and rotate secrets without a risk of breaking applications </li><li>offer secret rotation with build-in integration for Amazon RDS for MySQL, PostgreSQL and Amazon Aurora. </li></ul></li><li>Developers<ul><li>avoid dealing with secrets in the applications </li></ul></li></ul><h2 id="3-3-AWS-Security-Token-Service"><a href="#3-3-AWS-Security-Token-Service" class="headerlink" title="3.3 AWS Security Token Service"></a>3.3 AWS Security Token Service</h2><ul><li>provides trusted users with temporary security credentials </li><li>configurable credential lifetime</li><li>once expired, cannot be reused</li><li>use IAM policies to control the privileges </li><li>no limit on the number of temporary credentials issued </li><li>Important points<ul><li>all calls go to the global endpoint, by default</li><li>global endpoint maps to the US East region </li><li>Regional endpoints are activated by default</li><li>use AWS cloudTrail to log SRS calls</li></ul></li></ul><h2 id="3-4-Identity-Providers"><a href="#3-4-Identity-Providers" class="headerlink" title="3.4 Identity Providers"></a>3.4 Identity Providers</h2><ul><li>an alternative to create IAM users in AWS account</li><li>can manage user identities outside of AWS, and you can give these external user identities permissions to use AWS resources in account </li><li>To use an identity provider, create an IAM identity provider entity to establish trust between your AWS account and the external identity provider.</li></ul><h2 id="3-5-Security-Assetion-Markup-Language-SAML"><a href="#3-5-Security-Assetion-Markup-Language-SAML" class="headerlink" title="3.5 Security Assetion Markup Language (SAML)"></a>3.5 Security Assetion Markup Language (SAML)</h2><ul><li>Use single sign-on to sign in to all of your SAML-enbabled applications by using a single set of credentials </li><li>Manage access to your applications centrally </li></ul><h2 id="3-6-Amazon-Cognito"><a href="#3-6-Amazon-Cognito" class="headerlink" title="3.6 Amazon Cognito"></a>3.6 Amazon Cognito</h2><ul><li>Allow saving and synchronizing user data on different devices</li><li>Allow access to AWS cloud services using <ul><li>public login providers</li><li>own user identity system </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Security </tag>
            
            <tag> Docker </tag>
            
            <tag> ECS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.9 Step Functions, ElasticCache</title>
      <link href="/Developing-on-AWS-Note-9-Step-Functions-ElasticCache/"/>
      <url>/Developing-on-AWS-Note-9-Step-Functions-ElasticCache/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Understanding-the-need-for-step-functions"><a href="#1-Understanding-the-need-for-step-functions" class="headerlink" title="1. Understanding the need for step functions"></a>1. Understanding the need for step functions</h1><ul><li><p>Step functions make it easy to coordinate components of distributed applications and microservices by using visual workflows. </p></li><li><p>Microservices are processes that communicate with each other over a network to complete a larger goal. </p></li><li><p>Applications built as a collections of microservices are more resilient and easier to scale. </p></li><li><p>Have cases that we begin to have more functions and they continue to grow</p></li><li><p>Need a mechanism to scale out, easily handle errors and timeouts, easily build and operate</p></li></ul><h1 id="2-Intro-to-AWS-Step-Functions"><a href="#2-Intro-to-AWS-Step-Functions" class="headerlink" title="2. Intro to AWS Step Functions"></a>2. Intro to AWS Step Functions</h1><ul><li>define a workflow called a state machine made up of states</li><li>each order is an execution through this state machine </li><li>each execution starts with an input and the states transform it</li><li>step functions keep track of the state of each execution </li><li>actually, itâ€™s a web service that enables you to coordinate the components of distributed applications and microservices using visual workflows.</li><li>provides a reliable way to coordinate components and step through the functions of your application. </li><li>automatically triggers and tracks each step, and retries when there are errors</li><li>lifecycle<ul><li>define workflow as a series of steps and transitions between each step, also known as a state machine</li><li>step functions ingests your JSON template and turns it into a real-time graphical view , help you make sense of your state machineâ€™s current state</li></ul></li><li>benefits <ul><li>productivity<ul><li>build applications quickly  </li></ul></li><li>agility<ul><li>scale and recover reliably </li></ul></li><li>resilience <ul><li>evolve applications easily </li></ul></li></ul></li><li>Terminology<ul><li>state machine - workflow template<ul><li>an object that has a set number of operating conditions that depend on its previous condition to determine output </li><li>AWS step functions allows you to create and automate state machines within the AWS env<ul><li>with the use of a JSON-based Amazon State Language</li><li>a collection states, that can to work (task states), determine which states to transition to next (Choicestates), stop an execution with an error</li></ul></li><li>state common features<ul><li>each state must have a type field indicating what type of state it is</li><li>each state can have an optinal comment field to hold a human readable comment about, or description of, the state</li><li>Each state (except a Succeed or Fail state) requires a Next field or, alternatively, can become a terminal state by specifying an End field.</li></ul></li><li>state types<ul><li>task </li><li>choise - adds branching logic</li><li>parallel </li><li>wait</li><li>fail</li><li>succeed </li><li>pass</li></ul></li></ul></li><li>execution - specific workflow based on template</li><li>task - lambda function or activity <ul><li>An activity consists of program code or a task that waits for <strong>an operator to perform</strong> an action or to provide input. You can host activities on Amazon EC2, on Amazon ECS, or even on mobile devices. Activities poll Step Functions using the <strong>GetActivityTask</strong> and <strong>SendTaskSuccess</strong>, <strong>SendTaskFailure</strong>, and <strong>SendTaskHeartbeat</strong> API actions. Activities represent workers (processes or threads), implemented and hosted by you, that perform a specific task.</li><li>A Lambda function is a cloud-native task that runs on AWS Lambda. You can write Lambda functions in a variety of programming languages, using the AWS Management Console or by uploading code to Lambda. Lambda functions execute a function using AWS Lambda. To specify a Lambda function, use the ARN of the Lambda function in the Resource field </li></ul></li><li>activity - handle for external compute</li><li>task token - ID for instance of activity </li><li>heartbeat - ping from task indicating that it is still running </li><li>failure </li><li>success </li></ul></li></ul><h1 id="3-Caching-for-scalibility"><a href="#3-Caching-for-scalibility" class="headerlink" title="3. Caching for scalibility"></a>3. Caching for scalibility</h1><h2 id="3-1-Caching-Overview"><a href="#3-1-Caching-Overview" class="headerlink" title="3.1 Caching Overview"></a>3.1 Caching Overview</h2><ul><li>Benefits<ul><li>Provides high throughput, low latency access to commonly accessed application data, <strong>by storing the data in memory</strong></li><li>imrpove the speed </li><li>reduce the response latency </li><li>the following types of information or applications can benefit from caching:<ul><li>results of database queries</li><li>results of intensive calculations</li><li>results of remote API calls </li></ul></li></ul></li></ul><ul><li>when to consider caching your data<ul><li>data that requires a slow and expensive query to acquire </li><li>relatively static and frequently accessed data </li><li>information that can afford to be stale for some time</li><li>data should be relatively static and frequently accessed</li><li>Cache data should always be considered and treated as stale</li></ul></li></ul><h2 id="3-2-Caching-Strategy"><a href="#3-2-Caching-Strategy" class="headerlink" title="3.2 Caching Strategy"></a>3.2 Caching Strategy</h2><h1 id="4-Amazon-ElastiCache"><a href="#4-Amazon-ElastiCache" class="headerlink" title="4. Amazon ElastiCache"></a>4. Amazon ElastiCache</h1><ul><li>a webservice that makes it easy to deploy, operate and scale an in-memory cache in the cloud</li><li>ElastiCache improves the performance of web applications by allowing you to retrieve information from fast, managed, in-memory caches, instead of relying entirely on slower disk-based databases </li><li>ElastiCache supports<ul><li>Memcached</li><li>Redis</li></ul></li></ul><h2 id="4-1-Memcached-vs-Redis"><a href="#4-1-Memcached-vs-Redis" class="headerlink" title="4.1 Memcached vs Redis"></a>4.1 Memcached vs Redis</h2><ul><li>Memcached<ul><li>multithreading </li><li>low maintenance </li><li>easy horizontal scalability with auto discovery </li><li>single AZ </li><li>lack persistence<ul><li>if you terminate node or scale it down, you lose the data stored in that cache memory  </li></ul></li></ul></li><li>Redis<ul><li>single thread </li><li>support for data structures <ul><li>strings</li><li>hashes</li><li>lists</li><li>sets</li><li>sorted sets with range queries</li><li>bitmaps</li><li>hypolog</li><li>geospatial indexes with radius queries</li></ul></li><li>persistence </li><li>atomic operations </li><li>pub/ sub messaging</li><li>read replicas/ failover</li><li>cluster mode/ sharded clusters</li><li>multiple AZ </li></ul></li></ul><h2 id="4-2-Terminology"><a href="#4-2-Terminology" class="headerlink" title="4.2 Terminology"></a>4.2 Terminology</h2><ul><li>node<ul><li>smallest building block of an ElastiCache deployment </li></ul></li><li>cluster<ul><li>a logical grouping of one or more nodes</li></ul></li><li>replication group<ul><li>a collection of Redis clusters</li><li>with one primary read-write cluster and up to five secondary, read only clusters, which are called read replicas. </li><li>each read replica maintains a copy of the data from the primary cluster</li><li>asynchronous replication mechanisms are used to keep the read-replicas synchronized with the primary cluster </li><li>applications can <strong>read from any cluster in the replication group</strong> </li><li>applications can write only to the primary cluster</li><li>read replicas enhance scalability and guard against data loss </li></ul></li></ul><h2 id="4-3-Cache-hit-amp-Cache-Miss-Scenarios"><a href="#4-3-Cache-hit-amp-Cache-Miss-Scenarios" class="headerlink" title="4.3 Cache hit &amp; Cache Miss Scenarios"></a>4.3 Cache hit &amp; Cache Miss Scenarios</h2><ul><li>cache hit occurs when the cache contains the information required</li><li>cache miss occurs when the cache does not contain the information requested</li><li>ElastiCache caches data as key-value pairs.</li><li>An application can retrieve a value corresponding to a specific key. </li><li>An application can store an item in cache by specifying a key, value, and an expiration time(TTL). </li></ul><h2 id="4-4-Cache-strategies"><a href="#4-4-Cache-strategies" class="headerlink" title="4.4 Cache strategies"></a>4.4 Cache strategies</h2><ul><li>Lazy loading<ul><li>Whenever your application requests data, it first makes the request to the ElastiCache cache. </li><li>If the data exists in the cache and is current, ElastiCache returns the data to your application. </li><li>If the data does not exist in the cache, or the data in the cache has expired, your application requests the data from your data store which returns the data to your application. </li><li>Your application then writes the data received from the store to the cache so it can be more quickly retrieved next time it is requested.</li><li>Lazy Loading is a caching strategy that loads data into the cache only when necessary. </li><li>Avoid filling up the cache with unnecessary data</li><li>advantages<ul><li>Only requested data is cached. Since most data is never requested, lazy loading avoids filling up the cache with data that isnâ€™t requested.</li><li>Node failures are not fatal. </li><li>When a node fails and is replaced by a new, empty node the application continues to function, though with increased latency. As requests are made to the new node each cache miss results in a query of the database and adding the data copy to the cache so that subsequent requests are retrieved from the cache.</li></ul></li><li>disadvantages<ul><li>a cache miss penalty, each cache miss results in 3 trips<ul><li>initial request for data from the cache</li><li>query of the database for the data</li><li>write the data to the cache </li></ul></li><li>may receive stale data because another application may have updated the data in the database behind the scenes. </li></ul></li></ul></li><li>write through <ul><li>this strategy adds data or updates data in the cache whenever data is written to the database </li><li>advantages<ul><li>data in the cache is never stale, always current</li></ul></li><li>disadvantages<ul><li>write penalty, involve two trips<ul><li>a write to cache, and a write to the database</li><li>missing data: When a new node is created to scale up or to replace a failed node, the node does not contain all data. Data continues to be missing until it is added or updated in the database. In this scenario, you might choose to use a lazy caching approach to repopulate the cache</li><li>Unused data: Since most data is never read, there can be a lot of data in the cluster that is never read.</li><li>Cache churn: The cache may be updated often if certain records are updated repeatedly.</li></ul></li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Step Functions </tag>
            
            <tag> ElasticCache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.8 SQS, SNS</title>
      <link href="/Developing-on-AWS-Note-8-SQS-SNS/"/>
      <url>/Developing-on-AWS-Note-8-SQS-SNS/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Why-use-a-queuing-service"><a href="#1-Why-use-a-queuing-service" class="headerlink" title="1. Why use a queuing service?"></a>1. Why use a queuing service?</h1><p>Consider a scenario where an application produces messages that must be processed by a consumer downstream. The producer needs to know how to connect to the consumer. If the consumer fails for some reason, then messages may be lost. If new consumer instances are launched to recover from failure or to keep up with an increased workload, the producer needs to be explicitly made aware of the new consumer instances. In this scenario, the producer is tightly coupled with the consumers and the coupling is prone to brittleness.</p><p>In this way, there will be a strong interdependency between teh consumer and the producer, which is a <strong>tightly coupled system</strong>. which is not fault tolerant, if any one component in our system fails, the entire system will fail. </p><ul><li>Having a queue service decouples the producer from the consumer.<ul><li>queue is a temprary repositiory for messages that are awaiting processing. </li><li>acts as a buffer between the component producing data and the component receiving the data for processing. </li><li>A queue supports multiple producers and consumers interacting with the same queue. </li><li>A single queue can be used <strong>simultaneously</strong> by many distributed application components, with no need for those components to coordinate with each other to share the queue. A queue delivers each message at least once.</li><li>In this way, a producer can put messages on the queue regardless if they are being read by the consumer or not. </li></ul></li></ul><h1 id="2-Developing-with-Amazon-Simple-Queue-Service-Amazon-SQS"><a href="#2-Developing-with-Amazon-Simple-Queue-Service-Amazon-SQS" class="headerlink" title="2. Developing with Amazon Simple Queue Service (Amazon SQS)"></a>2. Developing with Amazon Simple Queue Service (Amazon SQS)</h1><h2 id="2-1-Types"><a href="#2-1-Types" class="headerlink" title="2.1 Types"></a>2.1 Types</h2><ul><li>Standard queues<ul><li>message ordering is not guranteed</li><li>message may be duplicated </li><li>maximum throughput </li></ul></li><li>FIFO queue<ul><li>message ordering is preserved</li><li>message only receive once</li><li>limited throughput (300 transactions per second)</li></ul></li></ul><h2 id="2-2-Used-to-solve-tightly-linked-systems"><a href="#2-2-Used-to-solve-tightly-linked-systems" class="headerlink" title="2.2 Used to solve tightly linked systems"></a>2.2 Used to solve tightly linked systems</h2><ul><li>problem to be solved<ul><li>An example of image processing: the sequential operations of uploading, storing, and encoding the image, creating a thumbnail, and copyrighting are tightly linked to each other. This tight linkage complicates the recovery operations when there has been a failure.</li></ul></li><li>queuing chain pattern<ul><li>Achieve loose coupling of systems by using queues between systems and exchanging messages that transfer jobs</li><li>This enables asynchronous linking of systems.</li><li>lets you increase the number of virtual servers that receive and process the messages in parallel. </li><li>If there is no image to process, you can configure auto scaling to terminate the servers that are in excess.</li></ul></li></ul><h2 id="2-3-Operations"><a href="#2-3-Operations" class="headerlink" title="2.3 Operations"></a>2.3 Operations</h2><h3 id="2-3-1-Client"><a href="#2-3-1-Client" class="headerlink" title="2.3.1 Client"></a>2.3.1 Client</h3><ul><li><p>sendMessage </p><ul><li>send message to a specific queue</li><li>max size: 256 KB </li><li>parameters of a sendMessage operation<ul><li>QueueUrl: specify the url of the queue that the message should be sent to</li><li>MessageBody: specify the message to send </li><li>DelaySeconds: specify the number of seconds to delay a specific message. Messages will become available for processing after the delay time is finished. </li><li>MessageAttributes <ul><li>specify structured metadata about the message<ul><li>timestamp</li><li>signature</li><li>geospatial data</li></ul></li></ul></li></ul></li></ul></li><li><p>receiveMessage</p><ul><li>specify short polling or long polling </li><li>When requesting to get a message from the queue, <strong>you cannot specify which message to get</strong>. You simply specify the maximum number of messages you want to get (up to 10), and Amazon SQS returns up to that maximum number.</li><li>parameters <ul><li>WaitTimeSeconds</li><li>MaxNumberOfMessages</li><li>VisibilityTimeout<ul><li>period of time that a message is invisible to the rest of your application after an application component gets it from the queue.</li><li>prevents multiple components from processing the same message </li><li>during the visibility time, the component that received the message usually processes it and then delete it from the queue. </li><li>this prevents multiple components from processing the same message </li></ul></li></ul></li><li>polling types<ul><li>short polling<ul><li>Amazon SQS samples a subset of the servers (based on a weighted random distribution) and returns messages from only the sampled servers</li><li>if you keep retrieving from your queues, SQS samples all the servers, and you will eventually receive all of your messages. </li><li>occurs when the WaitTimeSeconds parameter of a ReceiveMessage call is set to 0 or the queue attribute ReceiveMessageWaitTimeSeconds is 0</li></ul></li><li>long polling<ul><li>better and preferred way to retrieve messages </li><li>if your application has a single thread polling multiple queues, switching from short polling to long polling will likely not work, because the single thread will wait for the long poll timeout on any empty queues, delaying the processing of any queues which may contain messages. </li><li>Amazon SQS long polling doesnâ€™t return a response until a message arrives in the queue or the long poll times out </li><li>inexpensive </li><li>unless the connection time out, the response to the ReceiveMessage request will contain at least one of the available messages. </li><li>Reduce the cost of using Amazon SQS by reducing the number of empty responsed and false empty responses. </li></ul></li></ul></li></ul></li></ul><ul><li>deleteMessage<ul><li>When you receive the message, you <strong>must delete it from the queue</strong> to acknowledge that you processed the message and no longer need it. </li><li>You specify which message to delete by providing the <strong>receipt handle</strong> that Amazon SQS returned when you received the message.</li></ul></li><li>deleteMessageBatch</li><li>PuregeQueue<ul><li>delete all the messages in an AmazonSQS queue without deleting the queue itself.  </li></ul></li></ul><h3 id="2-3-2-Basic-Queue-Operations"><a href="#2-3-2-Basic-Queue-Operations" class="headerlink" title="2.3.2 Basic Queue Operations"></a>2.3.2 Basic Queue Operations</h3><ul><li>CreateQueue <ul><li>attributes<ul><li>delaySeconds<ul><li>the delivery of all messages in the queue will be delayed </li><li>default 0, maximum 15 min</li></ul></li><li>maximumMessageSize<ul><li>the limit of how many bytes a message can contain before Amazon SQS rejects it </li><li>max 256 KB</li></ul></li><li>messageRetentionPeriod<ul><li>seconds SQS retains a message </li></ul></li><li>ReceiveMessageWaitTimeSeconds<ul><li>time for which a ReceiveMessage call will wait for a message to arrive </li><li>max configurable wait time is 20 seconds </li><li>default 0</li></ul></li><li>VisibilityTimeout<ul><li>period of time that a message is invisbile to the rest of your application  </li></ul></li></ul></li></ul></li><li>SetQueueAttributes</li><li>GetQueueAttributes</li><li>GetQueueUrl</li><li>ListQueues</li><li>DeleteQueue</li></ul><h2 id="2-4-Message-Lifecycle"><a href="#2-4-Message-Lifecycle" class="headerlink" title="2.4 Message Lifecycle"></a>2.4 Message Lifecycle</h2><ul><li>Immediately after a message is received, it <strong>remains in the queue</strong>. To prevent other consumers from processing the message again, Amazon SQS sets a visibility timeout, a period of time during which Amazon SQS prevents other consumers from receiving and processing the message. </li><li>The default visibility timeout for a message is 30 seconds. The maximum is 12 hours.</li><li>Or consumer could send a separate request which acknowledges that you no longer need the message because you have successfully received and processed it </li><li>Maximum message retention period<ul><li>SQS automatically deletes messages that have been in a queue for more than maximum message retension period</li><li>default is 4 days </li><li>can be set from 60 seconds to 14 days </li></ul></li></ul><h2 id="2-5-Queue-and-Message-Identifiers"><a href="#2-5-Queue-and-Message-Identifiers" class="headerlink" title="2.5 Queue and Message Identifiers"></a>2.5 Queue and Message Identifiers</h2><ul><li>Queue URL <ul><li>when creating a new queue, must provide a queue name that is unique within the scope of all your queues. </li><li>AWS assgin each queue an identifier called a <strong>queue URL</strong>, which includes the queue name and other components that Amazon SQS determines. </li></ul></li><li>Message ID<ul><li>For each message, Amazon SQS returns a system-assigned message ID in the SendMessage response. </li></ul></li><li>Receipt Handle<ul><li>Each time you receive a message from a queue, you receive a receipt handle for that message. </li><li>The handle is assoiciated with the act of receiving the message, not with the message itself. </li><li>To delete a message, you need the messageâ€™s receipt handle instead of the message ID. </li></ul></li></ul><h2 id="2-6-Dead-letter-queues"><a href="#2-6-Dead-letter-queues" class="headerlink" title="2.6 Dead letter queues"></a>2.6 Dead letter queues</h2><ul><li>A queue of messages that were not able to be processed </li><li>Use dead-letter queues with standard queues.</li><li>Dead letter queues help you troubleshoot incorrect message transmission operations </li></ul><h2 id="2-7-Sharing-a-Queue"><a href="#2-7-Sharing-a-Queue" class="headerlink" title="2.7 Sharing a Queue"></a>2.7 Sharing a Queue</h2><ul><li>Shared queues<ul><li>Queue can be shared with other AWS accounts</li><li>Queue can be shared anonymously </li><li>A permission gives access to another person to use your queue in some particular way</li><li>A policy is the actual document that contains the permissions you granted </li></ul></li></ul><h2 id="2-8-Use-cases"><a href="#2-8-Use-cases" class="headerlink" title="2.8 Use cases"></a>2.8 Use cases</h2><ul><li>Work queues<ul><li>decouple components of a distributed application that may not all process the same amount of work simultaneourly </li></ul></li><li>Buffer and batch operations<ul><li>add scalability and reliability to your architecture and smooth out temporary volume spikes without losing messages or increasing latency </li></ul></li><li>request offloading<ul><li>move slow operations off of interactive request paths by enqueuing the request</li></ul></li><li>Auto scaling<ul><li>Use queue to help determine the load on an application, and when combined with auto sclaing, you can sclae the numebr of Amazon Ec3 intances out or in, depending on the volumne of traffic </li></ul></li><li>fan out<ul><li>combine SQS with SNS to send identical copies of a message to multiple queues in parallel for simultaneous processing  </li></ul></li></ul><h1 id="3-Amazon-Simple-Notification-Service"><a href="#3-Amazon-Simple-Notification-Service" class="headerlink" title="3. Amazon Simple Notification Service"></a>3. Amazon Simple Notification Service</h1><h2 id="3-1-Introduction"><a href="#3-1-Introduction" class="headerlink" title="3.1 Introduction"></a>3.1 Introduction</h2><ul><li>A web service that makes it easy to set up, operate and send notifications from the cloud.</li><li>Follow the publish-subscribe messaging paradigm, with notifications being delivered to clients using a push mechanism that eliminates the need to periodically check or poll for new information and updates </li><li>When using Amazon SNS, you (as the owner) create a <strong>topic</strong> and <strong>control access to it by defining policies</strong> that determine which publishers and subscribers can communicate with the topic. </li><li>A publisher sends messages to topics they have created or to topics they have permission to publish to. </li><li>Instead of including a specific destination address in each message, a publisher sends a message to the topic. </li><li>Amazon SNS matches the topic to a list of subscribers who have subscribed to that topic and delivers the message to each of those subscribers. </li><li>Each topic has a <strong>unique name</strong> that identifies the Amazon SNS endpoint for <strong>publishers to post messages and subscribers to register for notifications</strong>. Subscribers receive all messages published to the topics that they subscribe to, and all subscribers to a topic receive the same messages.</li><li>Subscriber<ul><li>Web servers </li><li>email addresses</li><li>amazon sqs queues</li><li>aws lambda</li></ul></li><li>topic <ul><li>an access point for allowing recipients to dynamically subscribe for identical copies of the same notification </li></ul></li></ul><h2 id="3-2-Use-case-Fan-out"><a href="#3-2-Use-case-Fan-out" class="headerlink" title="3.2 Use case: Fan out"></a>3.2 Use case: Fan out</h2><ul><li>An Amazon SNS message is sent to a topic and then replicated and pushed to multiple Amazon SQS queues, HTTP endpoints, or email addresses. </li><li>Allow for parallel asynchronous processing</li><li>All subscribers get identical information </li></ul><h2 id="3-3-Operations"><a href="#3-3-Operations" class="headerlink" title="3.3 Operations"></a>3.3 Operations</h2><ul><li>CreateTopic<ul><li>Input: Topic name </li><li>Output: ARN of topic </li><li>creates a topic to which notifications can be published </li><li>action is idempotent, so if the requester already owns a topic with the specified name, that topicâ€™s ARN is returned without creating a new topic </li></ul></li><li>Subscribe<ul><li>Input<ul><li>subscriberâ€™s endpoint</li><li>protocol </li><li>ARN of topic </li></ul></li><li>prepare to subscribe an endpoint by sending the endpoint a confirmation message</li><li>to actually create a subscription, the endpoint owner must call the confirmSubscription action with the token from the confirmation message. </li><li>The ConfirmSubscription request verify an endpoint ownerâ€™s intent to receive messages by validating the token sent to the endpoint by an earlier Subscribe action. </li><li>If the token is valid, the action creates a new subscription and returns its ARN </li></ul></li><li>DeleteTopic <ul><li>Input<ul><li>ARN of topic  </li></ul></li><li>Deleting a topic might prevent some messages previously sent to the topic being delivered to subscribers</li><li>Action is idempotent, will not result in an error if the topic doesnâ€™t exist</li></ul></li><li>Publish <ul><li>Input <ul><li>Message</li><li>Messsage attributes</li><li>Message structure : json</li><li>subject </li><li>ARN of topic </li></ul></li><li>output <ul><li>message ID </li></ul></li><li>Sends a message to all of a topicâ€™s subscribed endpoints.</li><li>When a messageId is returned, the message has been saved and Amazon SNS will attempt to deliver it to the topicâ€™s subscribers shortly. </li><li>The format of the outgoing message to each subscribed endpoint depends on the notification protocol selected.</li></ul></li></ul><h2 id="3-4-Best-practices"><a href="#3-4-Best-practices" class="headerlink" title="3.4 Best practices"></a>3.4 Best practices</h2><h3 id="3-4-1-Characteristics-of-Amazon-SNS"><a href="#3-4-1-Characteristics-of-Amazon-SNS" class="headerlink" title="3.4.1 Characteristics of Amazon SNS"></a>3.4.1 Characteristics of Amazon SNS</h3><ul><li>Each notification message contains a single published message</li><li>Message order is not guaranteed</li><li>A message cannot be deleted after it has been published </li><li>Amazon SNS delivery policy can be used to control retries in case of message delivery failure</li><li>Message can contain up to 256 kb of text data</li></ul><h3 id="3-4-2-Manage-Access-to-Amazon-SNS"><a href="#3-4-2-Manage-Access-to-Amazon-SNS" class="headerlink" title="3.4.2 Manage Access to Amazon SNS"></a>3.4.2 Manage Access to Amazon SNS</h3><ul><li>which endpoints</li><li>who can publish notifications</li><li>who can subscribe to notifications</li></ul><h3 id="3-4-3-SQS-vs-SNS"><a href="#3-4-3-SQS-vs-SNS" class="headerlink" title="3.4.3 SQS vs SNS"></a>3.4.3 SQS vs SNS</h3><ul><li>both messaging services within AWS</li><li>SNS<ul><li>allow applications to send time-critical messages to multiple subscribers through a push mechanism</li><li>eliminate the need to periodically check or poll for updates </li></ul></li><li>SQS <ul><li>message queue service used by distributed applications to exchange messages through a polling model, and it can be used to decouple sending and receiving components. </li><li>provides flexibility for distributed components of applications to send and receive messages without requiring each component to be concurrently available</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> SQS </tag>
            
            <tag> SNS </tag>
            
            <tag> Notification Service </tag>
            
            <tag> Queue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.7 API Gateway</title>
      <link href="/Developing-on-AWS-Note-7-API-Gateway/"/>
      <url>/Developing-on-AWS-Note-7-API-Gateway/</url>
      
        <content type="html"><![CDATA[<h1 id="1-What-is-Amazon-API-Gateway"><a href="#1-What-is-Amazon-API-Gateway" class="headerlink" title="1. What is Amazon API Gateway?"></a>1. What is Amazon API Gateway?</h1><h2 id="1-1-Functionalities"><a href="#1-1-Functionalities" class="headerlink" title="1.1 Functionalities"></a>1.1 Functionalities</h2><ul><li>enables developers to create, publish, maintain, monitor and secure APIs</li><li>allow you to connect your applications to AWS services and other public or private websites</li><li>provides consistent RESTFUL APIs for mobile and web applications to access AWS services and other resources hosted outside of AWS</li><li>Handles all the tasks involved in <strong>accepting and processing</strong> up to hundreds of thousands of concurrent API calls, including <strong>traffic management, authorization and access control, monitoring and API version management</strong></li></ul><h2 id="1-2-Use-cases"><a href="#1-2-Use-cases" class="headerlink" title="1.2 Use cases"></a>1.2 Use cases</h2><ul><li><p>Create a unified API frontend for multiple microservices</p></li><li><p>DDoS protection and throttling for backend </p></li><li><p>Authenticate and authorize requests to a backend</p></li><li><p>Throttle, meter, and monetize API usage by third party developers </p></li><li><p>message transformation and validation</p><ul><li><strong>models</strong> can be created to define a schema for reqeust/ response messages</li><li>A <strong>Mapping Template</strong> can then be used to transform data from one model to another</li><li>request/ response payload and header can be validated against the model</li><li>message transformation and mapping can be done using API Gateway</li><li>customers will often map request messages to a canonical format for downstream applications using API Gateway.  â€“&gt; <strong>transform a response body from the backend data format to the frontend data format</strong></li></ul></li><li><p>Expose backend resources</p><ul><li>allow you to create an API that acts as a front door for applications to access data, business logic or functionality from your backend service</li><li>expose<ul><li>HTTP endpoints</li><li>AWS services</li><li>AWS Lambda functions</li></ul></li></ul></li><li><p>Increase API performance : Cache</p><ul><li>eploy APIs to Regional or Edge-optimized endpoints to bring them closer to their clients. Cache API responses to the API Gateway response cache.</li><li>You can also enable API caching in Amazon API Gateway to cache your endpointâ€™s response. </li><li>With caching, you can reduce the number of calls made to your endpoint and also improve the latency of the requests to your API. When you enable caching for a stage, API Gateway caches responses from your endpoint for a specified time-to-live (TTL) period, in seconds. </li><li>API Gateway then responds to the request by looking up the endpoint response from the cache instead of making a request to your endpoint</li></ul></li><li><p>Control Access to APIs</p><ul><li>method level throttling </li><li>client usage throttling and quota limits sepcified in a usage plan </li><li>help prevent one customer from consuming all of your backend systemâ€™s capacity</li></ul></li><li><p>Secure API method invocations</p><ul><li>creating a resource policy <ul><li>a JSON policy document that you attach to an API to control whether a specified principal(IAM user or role) can invoke the API </li><li>You can use a resource policy to enable users from a different AWS account to securely access your API or to allow the API to be invoked only from specified source IP address ranges or Classless Inter-Domain Routing (CIDR) blocks.</li></ul></li><li>Creating IAM permission policy, can protect: <ul><li>the creation, deployment, and management of an API</li><li>the invocation of the methods in the API and refresh of its cache</li></ul></li><li>Creating a Private API endpoint that can only be accessed by a VPC client</li><li>Integrating with Amazon Cognito or Lambda authorizers to authenticate and authorize clients before accessing backend resources</li><li>Resource policy and IAM permission capabilities offer flexible and robust access controls that can be applied to an entire API set or individual methods. <h1 id="2-Best-practices"><a href="#2-Best-practices" class="headerlink" title="2. Best practices"></a>2. Best practices</h1></li></ul></li></ul><h2 id="2-1-Developing-an-API"><a href="#2-1-Developing-an-API" class="headerlink" title="2.1 Developing an API"></a>2.1 Developing an API</h2><ul><li>WHen API client requests come from the same region where the API is deployed, choose a regional API endpoint type</li><li>Test invking the API before deploying it</li><li>Use HTTP 500 error code for error handling </li><li>Cache only GET methods </li></ul><h1 id="3-Serverless-Application-Model-SAM"><a href="#3-Serverless-Application-Model-SAM" class="headerlink" title="3. Serverless Application Model (SAM)"></a>3. Serverless Application Model (SAM)</h1><p>Template driven development model for defining serverless apps</p><ul><li>supports <ul><li>Lambda</li><li>API Gateway</li><li>DynamoDB table</li><li>Any resource that AWS CloudFormation supports </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RESTFul </tag>
            
            <tag> AWS </tag>
            
            <tag> Gateway </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.6 AWS Serverless platform, Lambda</title>
      <link href="/Developing-on-AWS-Note-6-AWS-Serverless-platform-Lambda/"/>
      <url>/Developing-on-AWS-Note-6-AWS-Serverless-platform-Lambda/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Serverless-Computing"><a href="#1-Serverless-Computing" class="headerlink" title="1. Serverless Computing"></a>1. Serverless Computing</h1><h2 id="1-1-Benefits"><a href="#1-1-Benefits" class="headerlink" title="1.1 Benefits"></a>1.1 Benefits</h2><ul><li>with serverless deployment and operation, only need to<ul><li>build and deploy apps</li><li>monitor and maintain apps</li></ul></li><li>no need to provision, scale and manage any servers </li></ul><h2 id="1-2-Use-cases"><a href="#1-2-Use-cases" class="headerlink" title="1.2 Use cases"></a>1.2 Use cases</h2><ul><li>web applications <ul><li>automatically scale up and down </li><li>run in a highly available configuration across multiple data centers </li></ul></li><li>backends<ul><li>build serverless backends using AWS lambda to handle web, mobile, internet of Things(IoT), and 3rd party APR requests </li></ul></li><li>mobile backends</li><li>data processing <ul><li>execute code in response to triggers <ul><li>changes in data </li><li>shifts in system state</li><li>actions by users</li></ul></li></ul></li></ul><h1 id="2-AWS-serverless-Platform"><a href="#2-AWS-serverless-Platform" class="headerlink" title="2. AWS serverless Platform"></a>2. AWS serverless Platform</h1><ul><li>Compute<ul><li>AWS lambda</li><li>AWS Fargate</li></ul></li><li>API Proxy<ul><li>Amazon API Gateway</li><li>AWS AppSync</li></ul></li><li>Storage<ul><li>Amazon S3</li></ul></li><li>Database<ul><li>Amazon DynamoDB</li><li>Amazon Aurora</li></ul></li><li>Interprocess Messaging<ul><li>Amazon SNS</li><li>Amazon SQS</li></ul></li><li>Orchetration<ul><li>AWS Step Functions </li></ul></li><li>Analytics<ul><li>Amazon Kinesis</li><li>Amazon Athena</li></ul></li><li>Developer Tools<ul><li>Frameworks</li><li>SDKs</li><li>Libraries</li></ul></li></ul><p>Serverless applications donâ€™t require provisioning, maintaining, and administering servers for backend components such as compute, databases, storage, stream processing, message queueing, and more. You also no longer need to worry about ensuring application fault tolerance and availability.</p><h1 id="3-AWS-Lambda"><a href="#3-AWS-Lambda" class="headerlink" title="3. AWS Lambda"></a>3. AWS Lambda</h1><h2 id="3-1-What-is-AWS-Lambda"><a href="#3-1-What-is-AWS-Lambda" class="headerlink" title="3.1 What is AWS Lambda?"></a>3.1 What is AWS Lambda?</h2><ul><li>Compute service that enables you to run code without provisioning or managing servers. </li><li>Pay only for the compute time you consume </li><li>Run code for virtually any type of application or backend service, all with zero administration. </li><li>can set up code to automatically trigger from other AWS services or call it directly from any web or mobile app</li></ul><h2 id="3-2-Concepts"><a href="#3-2-Concepts" class="headerlink" title="3.2 Concepts"></a>3.2 Concepts</h2><ul><li>Event source - what triggers the call<ul><li>Used to pass in event data to the handler </li><li>java/C# supports simple data types and stream input/ output</li><li>includes all of the data and metadata Lambda needs</li></ul></li><li>Context object<ul><li>provides handler runtime information </li><li>interact with Lambda execution environment </li><li>contain<ul><li>AWS requestId - Used to track specific invocations of a Lambda function</li><li>Remaining time - The amount of time in milliseconds that remain before your function timeout occurs</li><li>logging - Each language runtime provides the ability to stream log statements to Amazon CloudWatch Logs.</li></ul></li></ul></li><li>Language choice</li><li>Execution environment - permissions and resources</li><li>Runtime <ul><li>a program that runs a lambda functionâ€™s handler method when the function is invoked</li><li>can include a runtime in your functionâ€™s deployment package in the form of an executable file named bootstrap</li><li>responsible for running the functionâ€™s setup code</li><li>read the handler name</li><li>read invocation events from the runtime API</li><li>runtime passes the event data to the function handler, and posts response from the handler back to Lambda</li></ul></li><li>handler function<ul><li>When a Lambda function is invoked, code execution begins at what is called the handler. The handler is a specific code method (Java, C#) or function (Node.js, Python) that youâ€™ve created and included in your package. </li></ul></li></ul><h2 id="3-3-Using-Lambda"><a href="#3-3-Using-Lambda" class="headerlink" title="3.3 Using Lambda"></a>3.3 Using Lambda</h2><ul><li>Bring own code <ul><li>bring own libraries</li><li>custom runtimes </li></ul></li><li>Simple resource model <ul><li>CPU and network allocated proportionately</li></ul></li><li>Flexible Use<ul><li>Synchronous/ Asynchronous</li><li>Integrated with other AWS services</li></ul></li><li>Flexible Authorization<ul><li>securely grant access to resources and VPCs </li><li>Fine grained control for invoking your functions </li></ul></li></ul><h2 id="3-4-How-it-works"><a href="#3-4-How-it-works" class="headerlink" title="3.4 How it works"></a>3.4 How it works</h2><p>Function can be invoked by</p><ul><li>push model<ul><li>event based invocation </li><li>event sources invoke your Lambda function </li><li>e.g<ul><li>S3, SNS, Cognito, Echo </li></ul></li></ul></li><li>request-response invocation <ul><li>causes Lambda to execute the function <strong>synchronously</strong> and returns the response immediately to the calling application. This invocation type is available for custom applications</li></ul></li><li>pull event model<ul><li>Lambda polls the event source and invokes function when it detects an event</li><li>E.G<ul><li>DynamoDB, SQS, Kinesis </li></ul></li></ul></li></ul><h2 id="3-5-Develop-and-deploy-workflow"><a href="#3-5-Develop-and-deploy-workflow" class="headerlink" title="3.5 Develop and deploy workflow"></a>3.5 Develop and deploy workflow</h2><ul><li>create a lambda handler class in code</li><li>create lambda function </li><li>allow Lambda to assume an IAM role</li><li>upload the code</li><li>invoke the AWS Lambda Function </li><li>Monitor function </li></ul><h2 id="3-6-Lambda-Layers"><a href="#3-6-Lambda-Layers" class="headerlink" title="3.6 Lambda Layers"></a>3.6 Lambda Layers</h2><ul><li><p>Centrally manage code and data that is shared across multiple functions</p><ul><li>reduce size of deployments</li><li>speed up deployment </li><li>Limits<ul><li>5 layers</li><li>250 MB</li></ul></li></ul></li><li><p>Layer</p><ul><li>ZIP archive that contain libraries, a custom runtime, or other dependencies</li><li>with layers, you can use libraries in your function without needing to include them in deployment package</li><li>extracted to the /opt directory in the function execution env </li><li>use AWS Serverless Application Model (AWS SAM) to manage layers and your functionâ€™s layer configuration</li></ul></li></ul><h2 id="3-7-Best-practices"><a href="#3-7-Best-practices" class="headerlink" title="3.7 Best practices"></a>3.7 Best practices</h2><ul><li>Function Code<ul><li>Separate the Lambda handler (entry point) from your core logic <ul><li>can make a more unit-testable function </li></ul></li><li>take advantage of Execution Context reuse<ul><li>make sure any externalized configuration or dependencies that your code retrieves are stored and referenced locally after initial execution</li><li>Limit the re-initialization of variables/objects on every invocation. Instead use static initialization/constructor, global/static variables and singletons. Keep alive and reuse connections (HTTP, database, etc.) that were established during a previous invocation.</li></ul></li><li>use environment variables</li><li>control the dependencies in your functionâ€™s deployment package</li><li>minimize the complexity of your dependencies <ul><li>Prefer simpler Java dependency injection frameworks like Dagger or Guice, over more complex ones like Spring Framework</li></ul></li><li>avoid using recursive code </li><li>share common dependencies with layers</li></ul></li><li>Function Configuration<ul><li>performance testing your Lambda function for memory<ul><li>crucial part in ensuring you pick the optimum memory size configuration</li><li>Any increase in memory size triggers an equivalent increase in CPU available to your function. </li><li>The memory usage for your function is determined per-invoke and can be viewed in AWS CloudWatch logs.</li></ul></li><li>Load test Lambda Function<ul><li>Determine an optimum timeout value</li><li>Important to analyze how long your function runs so that you can better determine any problems with a dependency service that may increase the concurrency of the function beyond what you expect</li><li>This is especially important when your Lambda function makes network calls to resources that may not handle Lambdaâ€™s scaling.</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Lambda </tag>
            
            <tag> Serverless </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.5 DynamoDB</title>
      <link href="/Developing-on-AWS-Note-5-DynamoDB/"/>
      <url>/Developing-on-AWS-Note-5-DynamoDB/</url>
      
        <content type="html"><![CDATA[<h1 id="1-AWS-Database-Options"><a href="#1-AWS-Database-Options" class="headerlink" title="1. AWS Database Options"></a>1. AWS Database Options</h1><h2 id="1-1-SQL-vs-NoSQL-database"><a href="#1-1-SQL-vs-NoSQL-database" class="headerlink" title="1.1 SQL vs NoSQL database"></a>1.1 SQL vs NoSQL database</h2><table><thead><tr><th>Attr</th><th>SQL</th><th>NoSQL</th></tr></thead><tbody><tr><td>Data Storage</td><td>rows and columns</td><td>key-value, document, wide-column, graph</td></tr><tr><td>Schemas</td><td>fixed</td><td>dynamic</td></tr><tr><td>Querying</td><td>Using SQL</td><td>Focused on collection of documents</td></tr><tr><td>Scalability</td><td>Vertical</td><td>Horizontal</td></tr><tr><td>Transactions</td><td>Supported</td><td>Support varies</td></tr><tr><td>Consistency</td><td>Strong</td><td>Eventual and strong</td></tr></tbody></table><ul><li>Relational Database supports vertical scaling which means that a single server must be made more powerful </li><li>Relational Database support ACID transactions<ul><li>atomicity</li><li>consistency</li><li>isolation </li><li>durability</li></ul></li><li>Relational databases automatically support strong data consistency due to ACID properties of transactions.</li></ul><h2 id="1-2-AWS-database-Options"><a href="#1-2-AWS-database-Options" class="headerlink" title="1.2 AWS database Options"></a>1.2 AWS database Options</h2><table><thead><tr><th>Type</th><th>SQL</th><th>NoSQL</th></tr></thead><tbody><tr><td>Transactional Databses</td><td>Amazon RDS</td><td>Amazon DynamoDB</td></tr><tr><td>Data Analytics/ Relationshiups</td><td>Amazon Redshift</td><td>Amazon Neptune</td></tr><tr><td>In-memory Data Store and Cache</td><td></td><td>Amazon ElastiCache</td></tr></tbody></table><ul><li>Amazon Relational Database Service(RDS): provides relational database services in the cloud with support for the following db engines: <ul><li>AMazon Aurora</li><li>PostgreSQL</li><li>MySQL</li><li>MariaDB</li><li>Oracle</li><li>Microsoft SQL server </li></ul></li><li>Amazon Redshift: fast, fully managed data warehouse<ul><li>includes Redshift Spectrum, allowing you to directly run SQL queries against exabytes of unstructured data in Amazon S3. </li></ul></li><li>Amazon DynamoDB: NoSQL db that supports both document and key-value store models </li><li>Amazon Neptune: fully managed graph databse service<ul><li>fully manged graoh databse service </li><li>purpose-built, high-performance <strong>graph database engine</strong> optimized for storing billions of <strong>relationships</strong> and querying the graph with milliseconds latency.</li><li>A graph database is ideal when you need to create relationships between data and quickly query these relationships. </li><li>This type of requirement is challenging to satisfy using a relational database because you would need multiple tables with multiple foreign keys. </li><li>In addition, SQL queries to navigate this data would require nested queries and complex joins that could quickly become complex and inefficient as your data size grows over time. </li><li>Neptune uses graph structures such as nodes (data entities), edges (relationships), and properties to represent and store data. </li><li>The relationships are stored as first order citizens of the data model. </li><li>This allows data in nodes to be directly linked, dramatically improving the performance of queries that navigate relationships in the data.</li></ul></li><li>Amazon ElastiCache: <strong>in-memory data cache</strong> that supports a fully managed Redis or Memcached engine<ul><li>easier to deploy, operate, and scale an in-memory data store or cache in the cloud. </li><li>improve the performance of web applications by allowing you to retrieve information from fast, managed, in memory caches</li><li>provides <ul><li>redis</li><li>memcached</li></ul></li></ul></li></ul><h1 id="2-DynamoDB"><a href="#2-DynamoDB" class="headerlink" title="2. DynamoDB"></a>2. DynamoDB</h1><h2 id="2-1-Intro"><a href="#2-1-Intro" class="headerlink" title="2.1 Intro"></a>2.1 Intro</h2><p>Amazon DynamoDB is a fast and flexible non-relational database service for all applications that need consistent, <strong>single-digit millisecond latency</strong> at any scale. It is a fully managed cloud database and supports both document and key-value store models.</p><h2 id="2-2-Components"><a href="#2-2-Components" class="headerlink" title="2.2 Components"></a>2.2 Components</h2><ul><li>Table <ul><li>data is stored in tables </li><li>contain<ul><li>item with attributes </li></ul></li></ul></li><li>Partition<ul><li>ddb can divide a tableâ€™s items into multiple partitions based on the primary key value. </li><li>an allocation of storage for a table</li><li>backed by SSDs and automatically replicated across multiple Availability Zones within an AWS region</li><li>partition key (hashkey), ddb use this to do partition </li></ul></li><li>sort key (range key) A sort key can be defined to store all of the items with the same partition key value <strong>physically close together and order them by sort key value in the partition</strong>. It represents a one-to-many relationship based on the partition key and enables querying on the sort key attribute.</li><li>Primary key - uniquely identify an Item<ul><li>types<ul><li>partition primary key</li><li>partition and sort primary key</li></ul></li></ul></li><li>item (400 KB at most)<ul><li>collection of attributes </li><li>not cosntrained by a predefined schema</li><li>items in a table can have different types of attributes </li></ul></li><li>attribute<ul><li>name</li><li>data type<ul><li>scalar<ul><li>number, string, binary, boolean, null</li></ul></li><li>multi-valued types <ul><li>string set</li><li>number set</li><li>binary set</li></ul></li><li>Document types<ul><li>List</li><li>Map</li></ul></li></ul></li><li>value</li></ul></li><li>Read/ Write Consistency<ul><li>Read<ul><li>eventually consistent</li><li>strongly consistent: return most up-to-date data</li><li>transactional: provides ACID consistency</li></ul></li><li>write<ul><li>standard</li><li>transactional </li></ul></li></ul></li><li>Read/ write Throughput<ul><li>RCU: number of strongly consistent reads per second of items up to <strong>4KB</strong> in size </li><li>WCU: number of <strong>1KB</strong> writes per second</li></ul></li><li>Secondary Indexes<ul><li>allow you to query data based on non-primary key attributes</li><li>contain<ul><li>alternate key attributes</li><li>primary key attributes</li><li>optinal subset of other attributes from the base table </li></ul></li><li>type<ul><li>GSI<ul><li>queries on this index can span all the data in a table, across all partitions</li><li>can have different partition key and sort key from original table</li><li>key values do not to be unique</li><li>can be deleted </li><li>supports eventually consistent only </li><li>its own provisioned WCU and RCU</li><li>*<em>queries only return attributes that are projected into the index *</em></li></ul></li><li>LSI<ul><li>index is located on the same table partition</li><li>sort key can be any scalar attribute </li><li>cannot be deleted </li><li>support eventually consitent and strong consistent </li><li>use tableâ€™s read and write capacity units</li></ul></li></ul></li></ul></li><li>Streams<ul><li>Ordered flow of information about changes to a table </li><li>contains changes to items in a single table </li><li>When you make an update to a table, DynamoDB first <strong>persists the data durably</strong> to the table. </li><li>It then asynchronously updates the corresponding stream with information about the changes made. </li><li>The asynchronous update is made to the stream with <strong>sub-second latency</strong>. </li><li>The update to the stream does not affect the write throughput of the table</li><li><strong>stricly in the order</strong> </li><li>each change contains exactly one stream record, available for 24 hours</li><li>streams scale by splitting data across shards </li><li>shards in detail<ul><li>A shard is created per partition in your DynamoDB table. If a partition split is required due to too many items in the same partition, the shard gets split into children as well.</li><li>DynamoDB Streams captures a time-ordered sequence of item-level modifications in your DynamoDB table. This time-ordered sequence is preserved at a per shard level. In other words, the order within a shard is established based on the order in which items were created, updated or deleted. </li></ul></li><li>configuration<ul><li>StreamEnabled: specify whether a stream is enabled or disabled </li><li>StreamViewType: specify the information that will be written to the stream whenever data in the table is modified<ul><li>KEYS_ONLY: only the key attributes </li><li>NEW_IMAGE: entire item, as it appears after modified</li><li>OLD_IMAGE: entire item, as it appears before modified</li><li>NEW_AND_OLD_IMAGES: both the new and old images of the item</li></ul></li></ul></li><li>when a stream is created, DDB assigns an ARN(Amazon Resource Name) that can be used to retrieve information about a stream. </li></ul></li><li>Global table<ul><li>A collection of one or more DynamoDB tables, all ownd by a single AWS account, identified as replica tables </li><li>A replica table (or replica, for short) is a single DynamoDB table that functions as a part of a global table. Each replica stores the same set of data items.</li><li>data replication<ul><li>Any changes made to any item in any replica table will be replicated to all of the other replicas within the same global table. </li><li>propagate within seconds </li></ul></li><li>concurrent updates <ul><li>all replicas agree on the latest update, and converge toward a state in which they all have identical data</li></ul></li><li>Read Consistency <ul><li>An application can read and write data to any replica table. </li><li>If your application only uses eventually consistent reads, and only issues reads against one AWS region, then it will work without any modification. </li><li>However, if your application requires strongly consistent reads, then it must perform all of its strongly consistent reads and writes in the same region. DynamoDB does not support strongly consistent reads across AWS regions; </li><li>therefore, if you write to one region and read from another region, the read response might include stale data that doesnâ€™t reflect the results of recently-completed writes in the other region. </li></ul></li></ul></li><li>Backup and Restore<ul><li>on-demand backup and restore capabilities </li><li>all backups in DDB work without consuming any provisioned throughput on the table </li><li>point-in-time recovery can restore the table to any point in time during last 35 days</li></ul></li></ul><h2 id="2-3-APIs-and-operations"><a href="#2-3-APIs-and-operations" class="headerlink" title="2.3 APIs and operations"></a>2.3 APIs and operations</h2><h3 id="2-3-1-Control-operations"><a href="#2-3-1-Control-operations" class="headerlink" title="2.3.1 Control operations"></a>2.3.1 Control operations</h3><p>Create and manage DynamoDB tables. Let you work with indexes, streams, and other objects that are dependent on tables. </p><h3 id="2-3-2-Data-operations"><a href="#2-3-2-Data-operations" class="headerlink" title="2.3.2 Data operations"></a>2.3.2 Data operations</h3><p>Perform CRUD actions on data in a table. Also let you read data from a secondary index. </p><ul><li>PutItem<ul><li>create a new item or replace an existing item </li></ul></li><li>GetItem<ul><li>reads an item from a table</li></ul></li><li>UpdateItem<ul><li>edit an existing itemâ€™s attributes, or adds a new item to the table</li><li>can perform a conditional update on an existing item </li><li>can only bring some attributes instead of all comparing with putItem</li></ul></li><li>deleteItem<ul><li>can delete an item in a table using its primary key  </li></ul></li></ul><h3 id="2-3-3-Stream-operations"><a href="#2-3-3-Stream-operations" class="headerlink" title="2.3.3 Stream operations"></a>2.3.3 Stream operations</h3><p>Enable or disable a stream on a table, and allow access to the data modification records contained in a stream. </p><h3 id="2-3-4-Object-persistence-Model"><a href="#2-3-4-Object-persistence-Model" class="headerlink" title="2.3.4 Object persistence Model"></a>2.3.4 Object persistence Model</h3><ul><li>Allow you to persist client-side objects in DynamoDB<ul><li>supports the mapping of objects to tables</li></ul></li><li>Provides higher-level programming interfaces to:<ul><li>connect to DynamoDB</li><li>perform CRUD operations</li><li>execute queries</li></ul></li></ul><h3 id="2-3-5-Batch-Operations"><a href="#2-3-5-Batch-Operations" class="headerlink" title="2.3.5 Batch Operations"></a>2.3.5 Batch Operations</h3><ul><li>BatchGetItem<ul><li>Read up to 16MB of data consisting of up to 100 items from multiple tables</li></ul></li><li>BatchWriteItem<ul><li>write up to 16MB of data consisting of up to 25 put or delete requests in multiple tables </li></ul></li><li>retry <ul><li>if one request in a batch fails, the entire operation does not fail</li><li>retry with failed keys and data returned </li></ul></li></ul><h3 id="2-3-6-Transactional-Operations"><a href="#2-3-6-Transactional-Operations" class="headerlink" title="2.3.6 Transactional Operations"></a>2.3.6 Transactional Operations</h3><ul><li>TransactWriteItems<ul><li>contains a write set </li><li>includes one or more PutItem, updateItem, and DeleteItem operations across</li></ul></li><li>TransactGetItems<ul><li>contains a read set </li><li>includes one or more getItem operations across multiple tables</li></ul></li></ul><h2 id="2-4-On-demand-mode"><a href="#2-4-On-demand-mode" class="headerlink" title="2.4 On-demand mode"></a>2.4 On-demand mode</h2><p>Amazon DynamoDB on-demand is a flexible billing option capable of serving thousands of requests per second without capacity planning. DynamoDB on-demand offers pay-per-request pricing for read and write requests so that you pay only for what you use. </p><h2 id="2-5-Query-and-Scan"><a href="#2-5-Query-and-Scan" class="headerlink" title="2.5 Query and Scan"></a>2.5 Query and Scan</h2><ul><li>Query <ul><li>reads from a table or secondary index only the items that match the primary key specified in the key condition expression.  </li><li>parameters<ul><li>tableName</li><li>KeyContditionExpression<ul><li>must specify partition key name and value</li></ul></li><li>ProjectExpression </li><li>ConsistentRead</li><li>FilterExpression<ul><li>a string that contains conditions that DDB applies after the query operation, but before the data is returned to you </li><li>all other records are discarded </li></ul></li></ul></li></ul></li><li>Scan <ul><li>reads all items from the table or index </li><li>parameters <ul><li>tableName</li><li>ProjectionExpression <ul><li>a string that identify one or more attributes to retrieve from the table </li></ul></li><li>consistentRead</li><li>filterExpression </li></ul></li></ul></li></ul><h2 id="2-6-Best-Practices"><a href="#2-6-Best-Practices" class="headerlink" title="2.6 Best Practices"></a>2.6 Best Practices</h2><ul><li>Uniform workloads</li><li>One-To-Many tables<ul><li>If your table has items that store a large number of values in an attribute of set type, such as string set or number set, consider removing the set attribute from the table and splitting it as separate items in another table.</li><li>If you frequently access large items in a table but do not use the large attribute values, consider storing frequently accessed smaller attributes in a separate table</li></ul></li><li>Optimistic Locking with Version Number <ul><li>Use optimistic locking with a version number to make sure that an item has not changed since the last time you read it. </li><li>Maintain a version number to check that the item has not been updated between the last read and update </li></ul></li></ul><h2 id="2-7-DynamoDB-Accelerator-DAX"><a href="#2-7-DynamoDB-Accelerator-DAX" class="headerlink" title="2.7 DynamoDB Accelerator (DAX)"></a>2.7 DynamoDB Accelerator (DAX)</h2><ul><li>deliver fast response times for accessing eventually consistent data </li><li>DAX is a DynamoDB compatible caching service that enables you to benefit from fast in memory performance for demanding applications. It addresses three core scenarios: <ul><li>reduce the response times of eventually consistent read workloads by an order of magnitude, from single-digit milliseconds to microsends</li><li>reduce operational and application complexity by providing a managed service that is API-compatible with Amazon DynamoDB</li><li>DAX provides increased throughput and potential operational cost savings by reducing the need to over-provision read capacity units</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> DynamoDB </tag>
            
            <tag> NoSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.4 Storage Options, S3 in detail</title>
      <link href="/Developing-on-AWS-Note-4-Storage-Options-S3-in-detail/"/>
      <url>/Developing-on-AWS-Note-4-Storage-Options-S3-in-detail/</url>
      
        <content type="html"><![CDATA[<h1 id="1-AWS-Storage-Options"><a href="#1-AWS-Storage-Options" class="headerlink" title="1. AWS Storage Options"></a>1. AWS Storage Options</h1><ul><li>Amazon S3<ul><li>Scalable, highly durable object storage in the cloud</li></ul></li><li>Amazon Glacier<ul><li>Low-cost, highly durable <strong>archive</strong> storage in the cloud</li></ul></li><li>Amazon EFS<ul><li>Scalable network file storage for Amazon EC2 instances</li><li>network file system that can grow to petabytes </li><li>allows massively parallel access from EC2 instances to your data within a region</li><li>designed to <strong>meet the performance needs of big data and analytics</strong></li></ul></li><li>Amazon EBS<ul><li>Network attached volumes that provide durable block-level storage for Amazon EC2 instances </li></ul></li><li>AWS storage gateway<ul><li>change to hybrid later </li><li>connects an on-premises software appliance with cloud-based storage to provide seamless and secure storage integration between an organizationâ€™s on-premises IT environment and the AWS storage infrastructure like Amazon S3, Amazon Glacier and EBS.</li></ul></li></ul><h1 id="2-Amazon-S3"><a href="#2-Amazon-S3" class="headerlink" title="2. Amazon S3"></a>2. Amazon S3</h1><p>Amazon Simple Storage Service provides develipers with <strong>high secure, durable, and scalable object storage</strong>. </p><h2 id="2-1-Use-cases"><a href="#2-1-Use-cases" class="headerlink" title="2.1 Use cases"></a>2.1 Use cases</h2><ul><li>storage solution <ul><li>content storage and distribution</li></ul></li><li>backup</li><li>archiving </li><li>big data analytics</li><li>static web site hosting</li><li>disaster recovery <ul><li>cross region replication(CRR) automatically replicates every S3 object to a destination bucket located in a different AWS Region. </li></ul></li></ul><h2 id="2-2-Components"><a href="#2-2-Components" class="headerlink" title="2.2 Components"></a>2.2 Components</h2><ul><li>bucket<ul><li>global unique</li><li>use only lower case letters, numbers and hyphens</li><li>associated with a region<ul><li>choose region by considering<ul><li>latency</li><li>cost</li><li>regulatory requirements </li></ul></li></ul></li></ul></li><li>Object<ul><li>S3 refers to files as objects </li><li>you can store any number of objects inside bucket</li><li>each object is <strong>identified by a unique key</strong></li><li>object metadata</li><li>version<ul><li>each object has a version ID if you enable this feature</li><li>Object locking supported on versioned buckets<ul><li>use object lock to prevent data from being changed, overwritten, or deleted </li></ul></li></ul></li><li>URLs for S3 Objects<ul><li>Path style URL<ul><li><code>http://&lt;region-specific endpoint&gt;/&lt;bucket name&gt;/&lt;object name&gt;</code></li></ul></li><li>virtual hosted-style URL<ul><li><code>http://&lt;bucket name&gt;.s3.amazonaws.com/&lt;object key&gt;</code> </li></ul></li></ul></li></ul></li><li>Key<ul><li>unique identifier for each object in an S3 bucket </li></ul></li><li>Object Url<ul><li>specify region, bucket name, object name(key)</li></ul></li></ul><h2 id="2-3-Operations"><a href="#2-3-Operations" class="headerlink" title="2.3 Operations"></a>2.3 Operations</h2><h3 id="2-3-1-put"><a href="#2-3-1-put" class="headerlink" title="2.3.1 put"></a>2.3.1 put</h3><ul><li>upload object</li><li>copy object <ul><li>create copies of an object </li><li>rename obejcts by creating a copy and deleting the original object </li><li>move objects across S3 locations </li><li>update object metadata </li></ul></li><li>limits<ul><li>5 GB at most in a single PUT operation </li><li>recommened: use multipart upload if size &gt; 100MB<ul><li>Multipart upload allows you to upload a single object as a set of parts. </li><li>You can upload each part separately. </li><li>If one of the parts fails to upload, you can retransmit that particular part without retransmitting the remaining parts. After all the parts of your object are uploaded to the server, you must send a complete multipart upload request that indicates that multipart upload has been completed. </li><li>Amazon S3 then assembles these parts and creates the complete object. </li><li>Amazon S3 retains all parts on the server until you complete or abort the upload.</li><li>You can upload parts in parallel to improve throughput, recover quickly from network issues, pause and resume object uploads </li></ul></li></ul></li></ul><h3 id="2-3-2-Get"><a href="#2-3-2-Get" class="headerlink" title="2.3.2 Get"></a>2.3.2 Get</h3><ul><li>retrieve a complete object in a single GET request </li><li>You can also retrieve an object in parts by specifying the range of bytes needed. This is useful in scenarios where network connectivity is poor or your application can or must process only subsets of object data.</li></ul><h3 id="2-3-3-Select"><a href="#2-3-3-Select" class="headerlink" title="2.3.3 Select"></a>2.3.3 Select</h3><ul><li>Select content from Object instead of retrieving Object </li><li>filter of content handled at S3 service level <ul><li>works by providing the ability to retrieve a subset of data from an object in Amazon S3 using simple SQL expressions </li><li>simply change API from get to select </li></ul></li></ul><h3 id="2-3-4-Delete"><a href="#2-3-4-Delete" class="headerlink" title="2.3.4 Delete"></a>2.3.4 Delete</h3><ul><li>can delete a single object or delete multiple objects in a single delete request <ul><li>versioning disabled <ul><li>can permanently delete an object by specifying the key that you want to delete</li></ul></li><li>versioning enabled <ul><li>can permanently delete an object by invoking a delete request with a key and version ID</li><li>must delete each individual version to completely remove an object </li></ul></li></ul></li></ul><h3 id="2-3-5-Listing-Keys"><a href="#2-3-5-Listing-Keys" class="headerlink" title="2.3.5 Listing Keys"></a>2.3.5 Listing Keys</h3><ul><li>There is no hierarchy of objects in S3 buckets. You can use prefixes in key names to group similar items. </li><li>You can use delimiters (any string such as / or _) in key names to organize your keys and create a logical hierarchy</li></ul><h2 id="2-4-Features"><a href="#2-4-Features" class="headerlink" title="2.4 Features"></a>2.4 Features</h2><h3 id="2-4-1-Pre-Signed-URLs"><a href="#2-4-1-Pre-Signed-URLs" class="headerlink" title="2.4.1 Pre-Signed URLs"></a>2.4.1 Pre-Signed URLs</h3><ul><li>Provide access to PUT/ GET objects without opening permissions to do anything else </li><li>Use permissions of the user who creates the URL</li><li>Provide security credentials, a bucket name, an object key, HTTP method and expiration date and time </li><li>onlu valid until expiration time </li></ul><h3 id="2-4-2-Date-Encryption"><a href="#2-4-2-Date-Encryption" class="headerlink" title="2.4.2 Date Encryption"></a>2.4.2 Date Encryption</h3><ul><li>Securing data in transit <ul><li>SSL-encrypted endpoints with HTTPS</li><li>client-side encryption - via SDKs</li><li>server-side encryption<ul><li>S3 encrypts your data at the object level  </li></ul></li></ul></li><li>Securing data at rest on server<ul><li>Amazon S3 managed keys (SSE-S3)</li><li>AWS KMS-managed keys (SSE-KMS)</li><li>Customer-provided keys (SSE-C)</li></ul></li></ul><h3 id="2-4-3-Corss-Origin-Resource-Sharing-CORS"><a href="#2-4-3-Corss-Origin-Resource-Sharing-CORS" class="headerlink" title="2.4.3 Corss Origin Resource Sharing (CORS)"></a>2.4.3 Corss Origin Resource Sharing (CORS)</h3><ul><li>defines a way for client web applications that are loaded in one domain to interact with resources in a different domain.</li></ul><h2 id="2-5-Best-practices"><a href="#2-5-Best-practices" class="headerlink" title="2.5 Best practices"></a>2.5 Best practices</h2><ul><li>Avoid unnecessary requests <ul><li>handle noSuchBucket errors instead of checking for existence of fixed buckets </li><li>set the object metadata before uploading an object </li><li>avoid using the copy operation to update metadata</li><li>cache bucket and key names if your application design allows it </li></ul></li><li>Network latency<ul><li>choose the bucket region closest to latency-sensitive customers </li><li>consider compressing data stored in Amazon S3 to reduce the size of data transferred and storage used</li><li>use a CDN to distribute content </li></ul></li><li>Data integrity<ul><li>ensure the data has not been corrupted in transit</li><li>check MD5 checksum of the object retrieved from the GET and PUT operation <ul><li>AWS SDK automatically specifies MD5 checksum in a PUT operation. Amazon S3 recalculates MD5 checksum and compares it with the specified value. </li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> S3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.3  - CloudWatch, CloudTrail, server-design for fail</title>
      <link href="/Developing-on-AWS-Note-3-CloudWatch-CloudTrail-server-design-for-fail/"/>
      <url>/Developing-on-AWS-Note-3-CloudWatch-CloudTrail-server-design-for-fail/</url>
      
        <content type="html"><![CDATA[<h1 id="1-CloudWatch"><a href="#1-CloudWatch" class="headerlink" title="1. CloudWatch"></a>1. CloudWatch</h1><h2 id="Why-use-Amazon-CloudWatch"><a href="#Why-use-Amazon-CloudWatch" class="headerlink" title="Why use Amazon CloudWatch?"></a>Why use Amazon CloudWatch?</h2><p>Need it to: </p><ul><li>monitor CPU, memory, disk I/O, network  -&gt; metrics</li><li>react to application log events and availability -&gt; logs/ event</li><li>automatically scale ec2 instance fleet -&gt; logs/ event</li><li>view operational status and identify issues -&gt; alarms, dashboard </li></ul><p>Actually, we could use Amazon CloudWatch to gain <strong>system-wide visibility</strong> into <strong>resource utilization</strong>, <strong>application performance</strong>, and <strong>operational health</strong>. You can use these insights to react and keep your application running smoothly. Amazon CloudWatch monitors your AWS Cloud resources and your cloud-powered applications. It tracks the metrics so that you can visualize and review them. You can also set alarms that will fire when a metric goes beyond a limit that you specified. CloudWatch gives you visibility into resource utilization, application performance, and operational health.</p><h1 id="2-CloudTrail"><a href="#2-CloudTrail" class="headerlink" title="2. CloudTrail"></a>2. CloudTrail</h1><p>CloudTrail is integrated with several AWS services. </p><ul><li>EC2</li><li>VPC</li><li>S3</li><li>EBS</li><li>DDB</li><li>RDS</li><li>Redshift</li><li>CloudFormation </li><li>IAM</li><li>â€¦etc. </li></ul><p>AWS CloudTrail is an AWS service that generates logs of calls to the AWS API. AWS CloudTrail can <strong>record all activity</strong> against the services it monitors. Here are questions that you can answer using CloudTrail logs: <strong>who, when, what, which, where</strong>? While the coverage is extensive, not all services are covered in CloudTrail logs. You can use the AWS API <strong>call history produced by CloudTrail to track changes to AWS resources</strong>, including creation, modification, and deletion of AWS resources such as Amazon EC2 instances, Amazon VPC security groups, and Amazon EBS volumes.</p><p>You can use the CloudTrail console to view the last 90 days of recorded API activity and events in an AWS region. You can also download a file with that info, or a subset of info based on the filter and time range you choose</p><h1 id="3-Best-practices-of-developing-cloud-apps"><a href="#3-Best-practices-of-developing-cloud-apps" class="headerlink" title="3. Best practices of developing cloud apps"></a>3. Best practices of developing cloud apps</h1><ul><li>consider designing applications that are <strong>loosely coupled</strong>. <ul><li>think of your application as a consumer and provider of services </li><li>design and develop app as <strong>granular components</strong> that can be delivered and scaled independently. </li></ul></li><li>Architect for resilience; <ul><li>Set up your servers to scale automatically based on the number of users concurrently visiting your application.</li><li>Autoscaling would enable your application to handle a surge in volumn during a sale or propmotion and go back to normal </li><li>set up a <strong>cluster of nodes</strong> such that when one node fails, another node automatically picks up all the traffic. </li><li>Consider setting up <strong>read replicas for your database</strong>. </li></ul></li><li>design for failure<ul><li>In case of service failure, your application may log the failure and retry at a later time.</li><li>If the service is slow to respond, your application could retry by using an exponential backoff algorithm: retry after increasing amounts of time between attempts.<ul><li>This approach attempts to <strong>reach the service without overwhelming it</strong> with repeated requests and potentially aggravating the latency issue. </li></ul></li></ul></li><li>log metrics and monitor performance </li><li>implement a strong DevOps model<ul><li>Operationalize the development and deployment process for your application</li><li>Develop a <strong>modular, automated, and continuous build</strong> process. </li><li>Ensure <strong>consistency</strong> in the development, staging, and production environments. Set up scripts or use robust tools to consistently configure your environments.</li></ul></li><li>implement security in every layer <ul><li>infrastructure</li><li>application</li><li>data at transit and at rest </li><li>user authentication and authorization</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> CloudWatch </tag>
            
            <tag> CloudTrail </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.2  - IAM</title>
      <link href="/Developing-on-AWS-Note-2-IAM/"/>
      <url>/Developing-on-AWS-Note-2-IAM/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Why-need-IAM"><a href="#1-Why-need-IAM" class="headerlink" title="1. Why need IAM?"></a>1. Why need IAM?</h1><p>IAM: AWS Identity and Access Management</p><ul><li><p>web service that helps you securely control access to AWS resources for your users. </p></li><li><p>You use IAM to control <strong>who</strong> can use your AWS resources (<strong>authentication</strong>) and <strong>what resources</strong> they can use and in what ways (<strong>authorization</strong>).</p></li><li><p>To set up your dev env to wrok with the AWS SDK. </p><ul><li>Need an AWS acount and AWS credentials </li><li>Use an IAM user to provide access credentials to <strong><em>increase the security of your AWS account</em></strong>. </li></ul></li><li><p>grant least privilege - <strong>grant only permissions required to perform a task</strong></p></li></ul><h1 id="2-Concepts"><a href="#2-Concepts" class="headerlink" title="2. Concepts"></a>2. Concepts</h1><p><img src="https://i.loli.net/2020/01/29/TbyX6r1jtKR2VuJ.png" alt="fig1.png"></p><ul><li>User<ul><li>we can set up a user account for every developer in organization </li><li>each user has credentials that they <strong>must</strong> use to access AWS services. </li></ul></li><li>groups </li><li>roles <ul><li>trusted entities </li><li>A role has policies granting access to specific services and operations </li><li>create role like developer, and associate it with each developer user account</li><li>developer role can be configured with policies that control which services and operations that role has access to </li><li>a role does not have standard long-term credentials(pwd or access keys) associated with it</li></ul></li><li>Policy<ul><li>contain permissions which specify which actions an entity can perform and on which resources </li><li>a JSON document that defines effect, actions, resources, and optional conditions for what API calls an entity can invoke </li><li>Type<ul><li>Managed policy<ul><li>standablon policies that you can attach to multiplke users, groups and roles </li><li>reusability </li><li>central change management </li><li>version</li><li>rollback </li></ul></li><li>Inline policy<ul><li>embedded in a principal entity like a user, group, or role. </li><li>you can use the same policy across multiple entities, but those entities are not sharing the policy </li></ul></li></ul></li></ul></li><li>Resources <ul><li>The user, role, group, and policy objects that are stored in IAM</li><li>you can add, edit, and remove resources from IAM</li></ul></li><li>Identities <ul><li>The IAM resource objects that are used to identify and group. These include users, groups, and roles.</li></ul></li><li>Entities<ul><li>The IAM resource objects that AWS uses for authentication</li><li>includes users and roles </li></ul></li><li>Principles<ul><li>a person or application that uses an entity to sign in and make requests </li></ul></li><li>Authentication<ul><li>As a principal, you must be authenticated (signed in to AWS) using an IAM entity to send a request to AWS.</li><li>Must provide your access key and secret key when accessing by CLI</li></ul></li><li>Authorization <ul><li>Must be authorized to complete request </li><li>AWS uses values from the request context to check for policies that apply to the request. </li></ul></li></ul><h1 id="3-Features"><a href="#3-Features" class="headerlink" title="3. Features"></a>3. Features</h1><ul><li>management<ul><li>user, role, federated users </li></ul></li><li>Shared access to your AWS account </li><li>Granular permissions <ul><li>grant different permissions to different people for different resources</li></ul></li><li>secire access tp AWS respirces for applications that run on Amazon EC2 </li><li>multi factor authentication </li><li>eventually consistent </li><li>identity based permissions<ul><li>attached to the IAM user and indicate what the user is permitted to do.</li><li>attached to a resource and indicate what a specified user (or group of users) is permitted to do with it. <strong>Amazon S3, Amazon Simple Queue Service (Amazon SQS), Amazon Simple Notification Service (Amazon SNS), and AWS OpsWorks are the only services that support resource-based permissions</strong>.</li></ul></li><li>resource based permissions</li><li>IAM Evaluation logic (In order)<ul><li>By default, all requests are denied. (In general, requests made using the account/root credentials for resources in the account are always allowed.)</li><li>An explicit allow overrides this default.</li><li>An explicit deny overrides any allows</li></ul></li></ul><h1 id="4-IAM-best-practice"><a href="#4-IAM-best-practice" class="headerlink" title="4. IAM best practice"></a>4. IAM best practice</h1><ul><li>IAM policies are specified with JSON-formatted text.</li><li>Policies are used to control access permissions for AWS APIs and other AWS resources. </li><li>They are not used for operating system permissions or application permissions. For those, use LDAP or Active Directory/Active Directory Federation Services (AD FS).</li><li>When you create IAM policies, follow the standard security advice of granting least privilege; <ul><li>i.e., grant only the permissions required to perform a task. </li><li>Determine what users need to do, and then craft policies for them that let the users perform only those tasks. </li><li>Similarly, create policies for individual resources that identify precisely who is allowed to access the resource, and allow only the minimal permissions for those users. </li></ul></li></ul><h1 id="5-Amazon-Shared-Responsibility-Model"><a href="#5-Amazon-Shared-Responsibility-Model" class="headerlink" title="5. Amazon Shared Responsibility Model"></a>5. Amazon Shared Responsibility Model</h1><p>Customer and AWS table the responsibility together: </p><ul><li>customer<ul><li>responsible for what you implement using AWS and for the applications you connect to AWS</li></ul></li><li>AWS<ul><li>goes from the ground up to the hypervisor. </li><li>secure the hardware, software, facilities, and networks that run all of our products and services. Customers are responsible for securely configuring the services they sign up for and anything they put on those services. </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> Identity and Access Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Developing on AWS Note.1  - AWS Models, EC2, ELB, autoScaling</title>
      <link href="/Developing-on-AWS-Note-1-AWS-Models-EC2-ELB-autoScaling/"/>
      <url>/Developing-on-AWS-Note-1-AWS-Models-EC2-ELB-autoScaling/</url>
      
        <content type="html"><![CDATA[<h1 id="0-Overview"><a href="#0-Overview" class="headerlink" title="0. Overview"></a>0. Overview</h1><p>We use SDKs to interract with Application Programing Interface(API), and then connect to all AWS services. </p><h1 id="1-Cloud-computing-definition"><a href="#1-Cloud-computing-definition" class="headerlink" title="1.  Cloud computing definition"></a>1.  Cloud computing definition</h1><ul><li>enable you to stop thinking of your infrastructure as hardware, and instead think of it and use it as software. </li></ul><h1 id="2-Models-of-Cloud-Computing"><a href="#2-Models-of-Cloud-Computing" class="headerlink" title="2. Models of Cloud Computing"></a>2. Models of Cloud Computing</h1><ul><li><p>IaaS (Infrastructure as a Service)</p><ul><li>basic buiding blocks for Cloud IT <ul><li>Networking features </li><li>Computers </li><li>Data storage space </li></ul></li><li>PaaS (Platform as a Service)<ul><li>enables you to run applications without the need to manage underlying infrastructure(hardware and operating systems)</li></ul></li><li>SaaS (Software as a Service)<ul><li>A complete product that is run and managed by the service provider<h1 id="3-AWS-Service-Stack"><a href="#3-AWS-Service-Stack" class="headerlink" title="3. AWS Service Stack"></a>3. AWS Service Stack</h1></li></ul></li></ul></li><li><p>Infrastructure </p><ul><li>Regions </li><li>Availability Zones </li><li>Edge Locations </li></ul></li><li><p>Foundation Services </p><ul><li>Compute<ul><li>virtual instances </li><li>auto scaling </li><li>load balancing </li></ul></li><li>networking </li><li>storage <ul><li>object </li><li>block </li><li>archive </li></ul></li></ul></li><li><p>Platform Services </p><ul><li>Compute<ul><li>AWS Lambda</li><li>AWS Elastic Beanstalk </li><li>Amazon ECS</li><li>Amazon EKS </li></ul></li><li>database<ul><li>relational </li><li>No SQL </li><li>Caching </li><li>Products <ul><li>DynamoDB</li><li>RDS - relational database service </li><li>Elastic Cache </li><li>Redshift - data warehouse, for analysis and migration </li></ul></li></ul></li><li>Analytics <ul><li>Cluster computing </li><li>real time </li><li>data warehouse </li><li>data workflows </li><li>Products <ul><li>EMR - managed hadoop framework </li><li>Kinesis </li><li>CloudSearch </li><li>ElasticSearch </li></ul></li></ul></li><li>App services <ul><li>Queuing </li><li>Orchestration </li><li>App streaming </li><li>Transcoding </li><li>Email </li><li>Search </li><li>Products <ul><li>SQS </li><li>SNS </li><li>SES </li><li>Amazon Step Functions </li></ul></li></ul></li><li>Deployment and management <ul><li>containers </li><li>Dev/ ops tools </li><li>resource templates </li><li>usage tracking </li><li>monitoring and logs </li><li>products <ul><li>CodeCommit </li><li>CodeDeploy </li><li>CodePipeline </li><li>CodeBuild </li><li>X-Ray </li></ul></li></ul></li><li>Mobile Services <ul><li>identity </li><li>sync </li><li>mobile analytics </li><li>notifications </li><li>products <ul><li>Cognito </li><li>Pinpoint </li><li>API gateway </li></ul></li></ul></li></ul></li><li><p>Applications </p><ul><li>Virtual Desktops </li><li>Collaboration and Sharing </li></ul></li></ul><h1 id="4-Compute-services"><a href="#4-Compute-services" class="headerlink" title="4. Compute services"></a>4. Compute services</h1><h2 id="4-1-EC2"><a href="#4-1-EC2" class="headerlink" title="4.1 EC2"></a>4.1 EC2</h2><ul><li>Computers in the cloud. </li><li>Can create images of your servers at any time with a few clicks or simple API call. </li><li>different instance type for different use cases:<ul><li>low traffic websites </li><li>small database </li><li>high performance web services </li><li>high performance databases </li><li>distributed memory caches </li><li>data warehousing </li><li>log or data-processing applications </li><li>3D visualizations </li><li>Machine learning </li></ul></li><li>Pricing <ul><li>on demand </li><li>reserved instances </li><li>spot instances </li></ul></li></ul><h2 id="4-2-ELB-Elastic-Load-Balancing"><a href="#4-2-ELB-Elastic-Load-Balancing" class="headerlink" title="4.2 ELB - Elastic Load Balancing"></a>4.2 ELB - Elastic Load Balancing</h2><ul><li><p>distribute traffic across multiple EC2 instances, in multiple Availability Zones </p></li><li><p>Support health checks to detect unhealthy Amazon EC2 instances </p><ul><li>To discover the availability of instances, a ELB periodically sends pings, attempts connections or sends requests to test the EC2 instances.  </li></ul></li><li><p>Supports the routing and load balancing of traffic to Amazon EC2 instances. </p></li><li><p>when the LB determins that an instance is unhealthy, it stops routing requests to that instance. </p></li><li><p>sticky sessions</p><ul><li>enables the load balancer to bind a userâ€™s session to a <strong>specific server instance</strong>. </li></ul></li><li><p>we should get rid of sticky sessions since: </p><ul><li>limit applicationâ€™s scalability </li><li>lead to unequal load across servers </li><li>affect end-user response time since a single userâ€™s load isnâ€™t even spread across servers. </li></ul></li><li><p>Instead of using sticky sessions: cache </p><ul><li>manage user sessions by<ul><li>store locally to the node responding to the HTTP request </li><li>designate a layer which can store those sessions in a scalable and robust manner. </li></ul></li><li>Duration based session stickiness<ul><li>LB uses a special LB generated cookie to rack the application instance for each request. <strong>When the load balancer reveives a request, it first checks to see whether this cookie is present in the request</strong>.  If so, the reqeust is sent to the application instance specified in the cookie. If not, the LB chooses an application instance based on the existing load balancing algo. <strong>A cookie is inserted into the response for binding subsequent requests from the same user to that application instance</strong>. The stickiness policy configuration defines a cookie expiration, which establishes the duration of validity for each cookie. Cookie will be automatically updated after its duration expires. </li></ul></li><li>Application base session stickiness <ul><li>LB uses a <strong>special cookie</strong> to associate the session with the original server that handled the reqeust. But follows the lifetime of the application-generated cookie corresponding to the cookie name specified in the policy configuration. </li><li>The LB only inserts a new stickiness cookie if the application response includes a new application cookie. </li><li>The load balancer stickiness cookie does not update with each request. If the application cookie is explicitly removed or expires, the session stops being sticky until a new application cookie is issued.</li><li>Application often store session data in memory, but this approach does not scale well</li></ul></li></ul></li><li><p>Methods available to manage session data without sticky sessions include: </p><ul><li>using ElasticCache to store session data </li><li>using Amazon DynamoDB to store session data </li></ul></li></ul><h2 id="4-3-Auto-Scaling"><a href="#4-3-Auto-Scaling" class="headerlink" title="4.3 Auto Scaling"></a>4.3 Auto Scaling</h2><p>Auto Scaling helps you ensure that you have the correct number of EC2 instances available to handle the load for your application. Auto Scaling is particularly well-suited for applications that experience hourly, daily, or weekly variability in usage.</p><h1 id="5-Exceptions-and-Errors-handle"><a href="#5-Exceptions-and-Errors-handle" class="headerlink" title="5. Exceptions and Errors handle"></a>5. Exceptions and Errors handle</h1><ul><li>400 series: handle error in application </li><li>500 series: retry operations </li></ul><p>Java SDK throes the following unchecked(runtime) exceptions when error occur:</p><ul><li>AmazonServiceException<ul><li>indicates that the reqeust was correctly transmitted to the service, but for some reason, the service was not able to process it, and returned an error response instead. </li></ul></li><li>AmazonClientException <ul><li>indicates that a problem occured inside the hava client code <ul><li>try to send a request to AWS </li><li>try to parse a response from AWS </li></ul></li></ul></li><li>IllegalArgumentException <ul><li>throw if you pass an illegal argument when performing an operation on a service  </li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
            <tag> EC2 </tag>
            
            <tag> ELB </tag>
            
            <tag> AutoScaling </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºä»€ä¹ˆè¦åˆå¹¶HTTPè¯·æ±‚?</title>
      <link href="/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%90%88%E5%B9%B6HTTP%E8%AF%B7%E6%B1%82/"/>
      <url>/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%90%88%E5%B9%B6HTTP%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<p>æ€è€ƒè·¯å¾„ï¼š<br>ä¸ºä»€ä¹ˆè¦å®ç°batch call? -&gt; å‡å°‘ç½‘ç»œä¸­çš„ä¼ è¾“æŸè€— -&gt; å¦‚ä½•å‡å°‘çš„? -&gt; é€šè¿‡åˆå¹¶HTTPè¯·æ±‚ -&gt; åˆå¹¶HTTPè¯·æ±‚æ˜¯å¦‚ä½•å‡å°‘ç½‘ç»œæŸè€—çš„ï¼Ÿ </p><p>æœ¬æ–‡å°†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¸€èµ·çœ‹çœ‹å•ä¸ªè¯·æ±‚æºè½½å¤§é‡ä¿¡æ¯å’Œå¤šä¸ªè¯·æ±‚æºè½½å°é‡ä¿¡æ¯å¯¹äºæ•´ä¸ªæ—¶é—´çš„å½±å“ã€‚</p><h1 id="1-Clientå‘å‡ºè¯·æ±‚"><a href="#1-Clientå‘å‡ºè¯·æ±‚" class="headerlink" title="1. Clientå‘å‡ºè¯·æ±‚"></a>1. Clientå‘å‡ºè¯·æ±‚</h1><h2 id="1-1-HTTP-1-1"><a href="#1-1-HTTP-1-1" class="headerlink" title="1.1 HTTP 1.1"></a>1.1 HTTP 1.1</h2><p>å¯ä»¥ä¿æŒé•¿è¿æ¥ï¼Œä½†æ˜¯æ¯ä¸ªä¸åŒçš„è¯·æ±‚ä¹‹é—´ï¼Œclientè¦å‘serverå‘ä¸€ä¸ªè¯·æ±‚å¤´</p><p>è¯·æ±‚æ— æ³•å¹¶è¡Œæ‰§è¡Œçš„ï¼Œåœ¨ä¸€ä¸ªè¿æ¥é‡Œé¢</p><p>å‡è®¾å¦‚æœä¸åˆå¹¶çš„è¯éœ€è¦å»ºç«‹Nä¸ªè¿æ¥ï¼Œé‚£ä¹ˆåˆå¹¶å°±å¯ä»¥çœå»(N-1)*RTTçš„æ—¶é—´ï¼ŒRTTæŒ‡ç½‘ç»œå»¶è¿Ÿï¼ˆåœ¨ä¼ è¾“ä»‹è´¨ä¸­ä¼ è¾“æ‰€ç”¨çš„æ—¶é—´ï¼Œå³ä»æŠ¥æ–‡å¼€å§‹è¿›å…¥ç½‘ç»œåˆ°å®ƒå¼€å§‹ç¦»å¼€ç½‘ç»œä¹‹é—´çš„æ—¶é—´ï¼‰ã€‚</p><h2 id="1-2-TCPä¸¢åŒ…é—®é¢˜"><a href="#1-2-TCPä¸¢åŒ…é—®é¢˜" class="headerlink" title="1.2 TCPä¸¢åŒ…é—®é¢˜"></a>1.2 TCPä¸¢åŒ…é—®é¢˜</h2><p>æ…¢å¯åŠ¨ï¼Œæ‹¥å¡æ§åˆ¶çª—å£</p><p>TCPæŠ¥æ–‡ä¹±åºåˆ°è¾¾ï¼Œåˆå¹¶åçš„æ–‡ä»¶å¯ä»¥å…è®¸é˜Ÿé¦–ä¸¢åŒ…ä»¥ååœ¨é˜Ÿä¸­è¡¥ä¸Šæ¥ï¼Œä½†æ˜¯åˆ†å¼€èµ„æºçš„æ—¶å€™ï¼Œå‰ä¸€ä¸ªèµ„æºæœªåŠ è½½å®Œæˆåé¢çš„èµ„æºæ˜¯ä¸èƒ½åŠ è½½çš„ï¼Œä¼šæœ‰æ›´ä¸¥é‡çš„é˜Ÿé¦–é˜»å¡é—®é¢˜ï¼Œä¸¢åŒ…ç‡ä¼šä¸¥é‡å½±å“Keep aliveæƒ…å†µä¸‹å¤šä¸ªæ–‡ä»¶çš„ä¼ è¾“é€Ÿç‡ã€‚</p><h2 id="1-3-æµè§ˆå™¨çº¿ç¨‹æ•°é™åˆ¶"><a href="#1-3-æµè§ˆå™¨çº¿ç¨‹æ•°é™åˆ¶" class="headerlink" title="1.3 æµè§ˆå™¨çº¿ç¨‹æ•°é™åˆ¶"></a>1.3 æµè§ˆå™¨çº¿ç¨‹æ•°é™åˆ¶</h2><p>å¤šä¸º2-6ä¸ªçº¿ç¨‹ï¼Œä¼šåœ¨æ¯ä¸ªè¿æ¥ä¸Šä¸²è¡Œå‘é€è‹¥å¹²ä¸ªè¯·æ±‚ã€‚TCPè¿æ¥å¤ªå¤šï¼Œä¼šç»™æœåŠ¡å™¨é€ æˆå¾ˆå¤§çš„å‹åŠ›çš„ã€‚</p><h2 id="1-4-DNSç¼“å­˜é—®é¢˜"><a href="#1-4-DNSç¼“å­˜é—®é¢˜" class="headerlink" title="1.4 DNSç¼“å­˜é—®é¢˜"></a>1.4 DNSç¼“å­˜é—®é¢˜</h2><p> æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦æ‰¾DNSç¼“å­˜ï¼Œå¤šä¸ªè¯·æ±‚å°±éœ€è¦æŸ¥æ‰¾å¤šæ¬¡ï¼Œè€Œä¸”ç¼“å­˜æœ‰å¯èƒ½è¢«æ— æ•…æ¸…ç©º</p><h1 id="2-æœåŠ¡å™¨å¤„ç†è¯·æ±‚"><a href="#2-æœåŠ¡å™¨å¤„ç†è¯·æ±‚" class="headerlink" title="2. æœåŠ¡å™¨å¤„ç†è¯·æ±‚"></a>2. æœåŠ¡å™¨å¤„ç†è¯·æ±‚</h1><p>æ¯ä¸ªè¯·æ±‚éœ€è¦ä½¿ç”¨ä¸€ä¸ªè¿æ¥ï¼Œå»ºç«‹ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ†é…ä¸€éƒ¨åˆ†CPU, å¯¹äºCPUè€Œè¨€ï¼Œæ˜¯ç§è´Ÿæ‹…ï¼Œå°¤å…¶æ˜¯ä¸€èˆ¬æ¥è¯´å»ºç«‹äº†è¿æ¥ä»¥åï¼Œå“ªæ€•å‘å›äº†è¯·æ±‚ï¼Œè¿™ä¸ªè¿æ¥è¿˜ä¼šä¿æŒä¸€æ®µæ—¶é—´æ‰ä¼štimeoutã€‚è¿™ç§æ—¶å€™ï¼Œç»´æŒè¿æ¥æ˜¯å¯¹æœåŠ¡å™¨èµ„æºçš„ä¸€ç§å·¨å¤§çš„æµªè´¹ã€‚</p><h1 id="3-HTTP-2-0"><a href="#3-HTTP-2-0" class="headerlink" title="3. HTTP 2.0"></a>3. HTTP 2.0</h1><p>ä¸Šé¢æè¿°çš„æ‰€æœ‰éƒ½æ˜¯åŸºäºHTTP/1.1çš„ä¸€äº›ç‰¹æ€§ï¼Œæˆ–è€…è¯´å¼Šç«¯ï¼Œæœ‰é•¿è¿æ¥ä½†æ˜¯æ— æ³•å¹¶è¡Œå¤„ç†è¯·æ±‚ï¼ŒTCPçš„æ…¢å¯åŠ¨å’Œæ‹¥å¡æ§åˆ¶ï¼Œé˜Ÿé¦–é˜»å¡é—®é¢˜éƒ½ç»™æ•´ä¸ªæ€§èƒ½å¸¦æ¥å¾ˆå¤šå¼Šç«¯ï¼Œå› æ­¤æˆ‘ä»¬æœ‰äº†HTTP2.0æ¥åšé’ˆå¯¹æ€§çš„æ”¹è¿›ã€‚å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œç›´æ¥çœ‹å›¾ï¼š </p><ul><li><p>HTTP/1.1 networkçš„è¯·æ±‚å›¾<br><img src="https://i.loli.net/2020/01/29/JPaxGAR2lrnKh6b.png" alt="http1-waterfall.png"></p></li><li><p>HTTP/2 networkçš„è¯·æ±‚å›¾<br><img src="https://i.loli.net/2020/01/29/C64pmQAVzZrtyus.png" alt="http2-waterfall.png"></p></li></ul><p>å°±æ˜¯è¿™ä¹ˆé…·ç‚«ï¼ŒHTTP/2å¤šäº†å¾ˆå¤šç‰¹æ€§æ¥è§£å†³HTTP/1.1çš„å¾ˆå¤šé—®é¢˜</p><h2 id="3-1-Fully-multiplexed"><a href="#3-1-Fully-multiplexed" class="headerlink" title="3.1 Fully multiplexed"></a>3.1 Fully multiplexed</h2><p>è§£å†³äº†é˜Ÿé¦–é˜»å¡çš„é—®é¢˜ã€‚å¯¹äºåŒä¸€ä¸ªTCPè¿æ¥ï¼Œç°åœ¨å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚ï¼Œæ¥æ”¶å¤šä¸ªå›åº”äº†ï¼åœ¨HTTP/1.1é‡Œé¢ï¼Œå¦‚æœåœ¨ä¸€ä¸ªè¿æ¥é‡Œä¸Šä¸€ä¸ªè¯·æ±‚å‘ç”Ÿäº†ä¸¢åŒ…ï¼Œé‚£ä¹ˆåé¢çš„æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»ç­‰ç¬¬ä¸€ä¸ªè¯·æ±‚è¡¥ä¸ŠåŒ…ï¼Œæ”¶åˆ°å›åº”ä»¥åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚è€Œåœ¨HTTP/2é‡Œé¢ï¼Œå¯ä»¥ç›´æ¥å¹¶è¡Œå¤„ç†ã€‚</p><h2 id="3-2-Header-Compression"><a href="#3-2-Header-Compression" class="headerlink" title="3.2 Header Compression"></a>3.2 Header Compression</h2><p>æ‰€æœ‰çš„HTTP requestå’Œresponseéƒ½æœ‰headerï¼Œä½†æ˜¯headeré‡Œå¾ˆå¯èƒ½åŒ…å«ç¼“å­˜ä¿¡æ¯ï¼Œå¯¼è‡´ä»–çš„å¤§å°ä¼šè¿…é€Ÿå¢å¤§çš„ã€‚ä½†æ˜¯åœ¨ä¸€ä¸ªè¿æ¥é‡Œå¤§éƒ¨åˆ†è¯·æ±‚çš„è¯·æ±‚å¤´å…¶å®æºå¸¦çš„ä¿¡æ¯éƒ½å¾ˆç±»ä¼¼ï¼Œæ‰€ä»¥HTTP/2ä½¿ç”¨äº†ç´¢å¼•è¡¨ï¼Œå­˜å‚¨äº†ç¬¬ä¸€æ¬¡å‡ºç°çš„è¯·æ±‚çš„è¯·æ±‚å¤´ï¼Œç„¶ååé¢çš„ç±»ä¼¼çš„è¯·æ±‚åªéœ€è¦æºå¸¦è¿™ä¸ªç´¢å¼•çš„æ•°å­—å°±å¥½äº†ã€‚å¤´éƒ¨å‹ç¼©å¹³å‡å‡å°‘äº†30%çš„å¤´éƒ¨å¤§å°ï¼ŒåŠ å¿«äº†æ•´ä½“çš„ç½‘ç»œä¸­ä¼ è¾“çš„é€Ÿåº¦ã€‚</p><p>è¿™ä¸¤ç‚¹æ˜¯å’Œæœ¬æ–‡å…³ç³»æœ€å¤§çš„ï¼Œæœ‰äº†è¿™ä¸¤ç‚¹ï¼Œå®è´¨ä¸Šåˆå¹¶HTTPè¯·æ±‚çš„å¥½å¤„åœ¨HTTP/2çš„åè®®ä¸‹ï¼Œå·²ç»åŸºæœ¬ä¸Šæ¶ˆå¤±äº†ã€‚åˆå¹¶ä¸åˆå¹¶è¯·æ±‚ï¼Œæ›´å¤šçš„æ˜¯çœ‹ä¸šåŠ¡ä¸Šçš„éœ€æ±‚ï¼Œåç«¯çš„ä¸€äº›é…ç½®ã€‚</p><h1 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4. æ€»ç»“"></a>4. æ€»ç»“</h1><p>Itâ€™s a trade-off. å…¶å®æœ€é‡è¦çš„æ˜¯çœ‹ä½ ä¼ è¾“ä»€ä¹ˆä¸œè¥¿ï¼Œå› ä¸ºåˆå¹¶HTTPè¯·æ±‚å®è´¨ä¸Šæ˜¯å‡å°‘äº†ç½‘ç»œå»¶æ—¶ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨æœåŠ¡å™¨ä¸Šå¤„ç†çš„æ—¶é—´è¿œè¿œå¤§äºç½‘ç»œå»¶æ—¶çš„æ—¶é—´çš„æ—¶å€™ï¼Œé‚£ä¹ˆåˆå¹¶HTTPè¯·æ±‚å¹¶ä¸ä¼šç»™ä½ å¸¦æ¥å¾ˆå¤šæ€§èƒ½ä¸Šçš„æå‡ã€‚è€Œä¸”å¤§æ•°æ®é‡çš„ä¼ è¾“ä¸€å®šä¼šé™ä½æµè§ˆå™¨çš„cache hit rate,å¯¹äºç¼“å­˜çš„åˆ©ç”¨ç‡ä¼šé™ä½å¾ˆå¤šã€‚ä½†æ˜¯å¯¹äºHTTPè¯·æ±‚æºå¸¦çš„æ•°æ®é‡æ¯”è¾ƒå°‘çš„æƒ…å†µï¼Œåˆå¹¶è¯·æ±‚å¸¦æ¥çš„æ€§èƒ½æå‡ä¼šæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.zhihu.com/question/34689035" target="_blank" rel="noopener">1. ç½‘ç»œå»¶è¿Ÿ</a></p><p><a href="https://www.zhihu.com/question/34401250" target="_blank" rel="noopener">2.çŸ¥ä¹:åˆå¹¶HTTPè¯·æ±‚æ˜¯å¦çœŸçš„æœ‰æ„ä¹‰ï¼Ÿ</a></p><p><a href="https://deliciousbrains.com/performance-best-practices-http2/" target="_blank" rel="noopener">3. HTTP/2 Intro</a></p><p><a href="https://www.tutorialdocs.com/article/merge-parallel-http-request.html" target="_blank" rel="noopener">4. Merge parallel htto requests</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> HTTP </tag>
            
            <tag> Network </tag>
            
            <tag> Batch Processing </tag>
            
            <tag> Web Development </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java-Synchronizedæ–¹æ³•</title>
      <link href="/Java-Synchronized%E6%96%B9%E6%B3%95/"/>
      <url>/Java-Synchronized%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="1-synchronized-type"><a href="#1-synchronized-type" class="headerlink" title="1. synchronized type"></a>1. synchronized type</h1><ol><li>Synchronized methods</li><li>Synchronized statements </li></ol><h1 id="2-Synchronized-Methods"><a href="#2-Synchronized-Methods" class="headerlink" title="2. Synchronized Methods"></a>2. Synchronized Methods</h1><p>ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å¯¹è±¡å®ä¾‹çš„é”ã€‚ä¿®é¥°é™æ€æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰ç±»å¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰ç±»å¯¹è±¡çš„é”ã€‚ </p><h2 id="2-1-ä¸å¯æ’å…¥"><a href="#2-1-ä¸å¯æ’å…¥" class="headerlink" title="2.1 ä¸å¯æ’å…¥"></a>2.1 ä¸å¯æ’å…¥</h2><p>It is not possible for two invocations of synchronized methods on the same object to interleave. When one thread is executing a synchronized method for an object, all other threads that invoke synchronized methods for the same object block (suspend execution) until the first thread is done with the object.</p><p>å½“ä¸€ä¸ªæ–¹æ³•æ˜¯åŒæ­¥çš„æ—¶å€™ï¼Œå½“å‰çº¿ç¨‹åœ¨æ‰§è¡Œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹éƒ½ä¼šåœæ­¢è¿è¡Œï¼Œç›´åˆ°çº¿ç¨‹å®Œæˆå·¥ä½œï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p><h2 id="2-2-è‡ªåŠ¨ä¼ é€’çŠ¶æ€"><a href="#2-2-è‡ªåŠ¨ä¼ é€’çŠ¶æ€" class="headerlink" title="2.2 è‡ªåŠ¨ä¼ é€’çŠ¶æ€"></a>2.2 è‡ªåŠ¨ä¼ é€’çŠ¶æ€</h2><p>when a synchronized method exits, it automatically establishes a happens-before relationship with any subsequent invocation of a synchronized method for the same object. This guarantees that changes to the state of the object are visible to all threads.</p><p>ä¿è¯çŠ¶æ€å¯è§ï¼Œä¸Šä¸ªçº¿ç¨‹å¯¹å¯¹è±¡çš„æ“ä½œç»“æœä¼šä½œä¸ºè¾“å…¥ç»™ä¸‹ä¸€ä¸ªçº¿ç¨‹æ¥ä½¿ç”¨ã€‚ </p><h1 id="3-Synchronized-Statements"><a href="#3-Synchronized-Statements" class="headerlink" title="3. Synchronized Statements"></a>3. Synchronized Statements</h1><p>ä¿®é¥°ä»£ç å—ï¼ŒæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šå¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚</p><p>Synchronized statements must specify the object that provides the intrinsic lock. </p><pre><code>public void addName(String name) {    synchronized(this) {        lastName = name;        nameCount++;    }    nameList.add(name);}</code></pre><p>è¿™é‡Œlastname å’Œnamecountéƒ½è¦æ”¹å˜ï¼Œæ˜¯åŒæ­¥çš„ã€‚ä½†è¦æ³¨æ„åœ¨å£°æ˜é‡Œä¸å¯ä»¥è°ƒç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•ã€‚</p><h1 id="4-åº•å±‚å®ç°åŸç†"><a href="#4-åº•å±‚å®ç°åŸç†" class="headerlink" title="4. åº•å±‚å®ç°åŸç†"></a>4. åº•å±‚å®ç°åŸç†</h1><p>å¯ä»¥é”ä»£ç å—ï¼Œä¹Ÿå¯ä»¥é”æ–¹æ³•ã€‚å¦‚æœé”çš„æ˜¯ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯é”è¿™ä¸ªã€‚å¦‚æœé”çš„æ˜¯ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆå°½ç®¡newå¤šä¸ªå®ä¾‹å¯¹è±¡ï¼Œä»–ä»¬ä»ç„¶å±äºåŒä¸€ä¸ªç±»ï¼Œä¾ç„¶ä¼šè¢«é”ä½ï¼Œå³çº¿ç¨‹ä¹‹é—´ä¿è¯åŒæ­¥å…³ç³»ã€‚</p><p><code>synchronized</code> åŒæ­¥è¯­å¥å—çš„å®ç°ä½¿ç”¨çš„æ˜¯ <code>monitorenter</code> å’Œ <code>monitorexit</code> æŒ‡ä»¤ï¼Œå…¶ä¸­ <code>monitorenter</code> æŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œ<code>monitorexit</code> æŒ‡ä»¤åˆ™æŒ‡æ˜åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®ã€‚</p><p>å½“æ‰§è¡Œ monitorenter æŒ‡ä»¤æ—¶ï¼Œçº¿ç¨‹è¯•å›¾è·å–é”ä¹Ÿå°±æ˜¯è·å– monitor(monitorå¯¹è±¡å­˜åœ¨äºæ¯ä¸ªJavaå¯¹è±¡çš„å¯¹è±¡å¤´ä¸­ï¼Œsynchronized é”ä¾¿æ˜¯é€šè¿‡è¿™ç§æ–¹å¼è·å–é”çš„ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆJavaä¸­ä»»æ„å¯¹è±¡å¯ä»¥ä½œä¸ºé”çš„åŸå› ) çš„æŒæœ‰æƒ.å½“è®¡æ•°å™¨ä¸º0åˆ™å¯ä»¥æˆåŠŸè·å–ï¼Œè·å–åå°†é”è®¡æ•°å™¨è®¾ä¸º1ä¹Ÿå°±æ˜¯åŠ 1ã€‚ç›¸åº”çš„åœ¨æ‰§è¡Œ monitorexit æŒ‡ä»¤åï¼Œå°†é”è®¡æ•°å™¨è®¾ä¸º0ï¼Œè¡¨æ˜é”è¢«é‡Šæ”¾ã€‚å¦‚æœè·å–å¯¹è±¡é”å¤±è´¥ï¼Œé‚£å½“å‰çº¿ç¨‹å°±è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°é”è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾ä¸ºæ­¢ã€‚</p><p>æœ€å¼€å§‹çš„Synchronizedæ˜¯è°ƒç”¨OSçš„mutex lockï¼Œè¦å®Œæˆcontext switch ï¼Œæ˜ å°„åˆ°åŸç”Ÿæ“ä½œç³»ç»Ÿé‡Œï¼Œä»ç”¨æˆ·æ€è½¬åˆ°å†…æ ¸æ€ã€‚ç°åœ¨ä»JVMå±‚é¢åšäº†å¤§é‡çš„ä¼˜åŒ–ï¼Œå‡å°‘äº†é”å¼€é”€ã€‚</p><h1 id="5-synchronized-ä¼˜åŒ–"><a href="#5-synchronized-ä¼˜åŒ–" class="headerlink" title="5. synchronized ä¼˜åŒ–"></a>5. synchronized ä¼˜åŒ–</h1><p>synchronizedæ˜¯äº’æ–¥çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾æ–¹æ³•åŠ å¿«ä¸­é—´è¿‡ç¨‹ï¼Œæ¯”å¦‚ä¼ ç»Ÿçš„é›¶å”®äº¤é’±æ’é˜Ÿï¼Œæ‰¾é›¶åˆ°æ‰«ç ä»˜è´¹çš„è½¬å˜ã€‚è¿™é‡Œä»‹ç»è½»é‡çº§é”ï¼Œåå‘é”ã€‚</p><h2 id="5-1-CASæ“ä½œ"><a href="#5-1-CASæ“ä½œ" class="headerlink" title="5.1 CASæ“ä½œ"></a>5.1 CASæ“ä½œ</h2><p>ä½¿ç”¨é”çš„æ—¶å€™ï¼Œçº¿ç¨‹è·å–é”æ˜¯ä¸€ç§æ‚²è§‚é”ï¼Œå³è®¤ä¸ºæ¯ä¸€æ¬¡æ‰§è¡Œä¸´ç•ŒåŒºçš„ä»£ç éƒ½ä¼šäº§ç”Ÿå†²çªï¼Œæ‰€ä»¥å½“å‰çº¿ç¨‹è·å–é”çš„æ—¶å€™åŒæ—¶ä¼šå µå¡å…¶ä»–çº¿ç¨‹è·å–é”ã€‚è€ŒCASæ˜¯ä¸€ç§ä¹è§‚é”ç­–ç•¥ï¼Œ<strong>å‡è®¾æ‰€æœ‰çº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„æ—¶å€™ä¸ä¼šå‡ºç°å†²çª</strong>ã€‚å‡ºç°äº†å†²çªä»¥åé‡‡å–CAS(compare and swap) ç­–ç•¥ï¼Œç”¨æ¥æ¯”è¾ƒäº¤æ¢ï¼Œçœ‹çº¿ç¨‹ä¹‹é—´æ˜¯å¦å‡ºç°äº†å†²çªã€‚</p><h3 id="5-1-1-æ“ä½œè¿‡ç¨‹"><a href="#5-1-1-æ“ä½œè¿‡ç¨‹" class="headerlink" title="5.1.1 æ“ä½œè¿‡ç¨‹"></a>5.1.1 æ“ä½œè¿‡ç¨‹</h3><p>CASæ¯”è¾ƒäº¤æ¢çš„è¿‡ç¨‹å¯ä»¥é€šä¿—çš„ç†è§£ä¸ºCAS(V,O,N)ï¼ŒåŒ…å«ä¸‰ä¸ªå€¼åˆ†åˆ«ä¸ºï¼šV å†…å­˜åœ°å€å­˜æ”¾çš„å®é™…å€¼ï¼›O é¢„æœŸçš„å€¼ï¼ˆæ—§å€¼ï¼‰ï¼›N æ›´æ–°çš„æ–°å€¼ã€‚å½“Vå’ŒOç›¸åŒæ—¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ—§å€¼å’Œå†…å­˜ä¸­å®é™…çš„å€¼ç›¸åŒè¡¨æ˜è¯¥å€¼æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹æ›´æ”¹è¿‡ï¼Œå³è¯¥æ—§å€¼Oå°±æ˜¯ç›®å‰æ¥è¯´æœ€æ–°çš„å€¼äº†ï¼Œè‡ªç„¶è€Œç„¶å¯ä»¥å°†æ–°å€¼Nèµ‹å€¼ç»™Vã€‚åä¹‹ï¼ŒVå’ŒOä¸ç›¸åŒï¼Œè¡¨æ˜è¯¥å€¼å·²ç»è¢«å…¶ä»–çº¿ç¨‹æ”¹è¿‡äº†åˆ™è¯¥æ—§å€¼Oä¸æ˜¯æœ€æ–°ç‰ˆæœ¬çš„å€¼äº†ï¼Œæ‰€ä»¥ä¸èƒ½å°†æ–°å€¼Nèµ‹ç»™Vï¼Œè¿”å›Vå³å¯ã€‚å½“å¤šä¸ªçº¿ç¨‹ä½¿ç”¨CASæ“ä½œä¸€ä¸ªå˜é‡æ˜¯ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šæˆåŠŸï¼Œå¹¶æˆåŠŸæ›´æ–°ï¼Œå…¶ä½™ä¼šå¤±è´¥ã€‚å¤±è´¥çš„çº¿ç¨‹ä¼šé‡æ–°å°è¯•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©æŒ‚èµ·çº¿ç¨‹ã€‚</p><p>It compares the contents of a memory location with a given value and, only if they are the same, modifies the contents of that memory location to a new given value. This is done as a single atomic operation. The atomicity guarantees that the new value is calculated based on up-to-date information; if the value had been updated by another thread in the meantime, the write would fail.</p><p>éé˜»å¡åŒæ­¥ã€‚</p><h3 id="5-1-2-å­˜åœ¨çš„é—®é¢˜"><a href="#5-1-2-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="5.1.2 å­˜åœ¨çš„é—®é¢˜"></a>5.1.2 å­˜åœ¨çš„é—®é¢˜</h3><ol><li>ABAé—®é¢˜</li></ol><p>å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†åˆå˜äº†å›å»ã€‚ï¼ˆåŠ ä¸Šåºå·æ¥è§£å†³ï¼‰</p><ol start="2"><li>è‡ªæ—‹æ—¶é—´è¿‡é•¿</li><li>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</li></ol><h2 id="5-2-å¯¹è±¡å¤´"><a href="#5-2-å¯¹è±¡å¤´" class="headerlink" title="5.2 å¯¹è±¡å¤´"></a>5.2 å¯¹è±¡å¤´</h2><p>å¯¹è±¡çš„é” -&gt;  å¯¹è±¡çš„æ ‡è®°ï¼Œå­˜åœ¨javaå¯¹è±¡çš„å¯¹è±¡å¤´é‡Œé¢ã€‚å­˜æ”¾æœ‰</p><ol><li>é”çŠ¶æ€<ul><li>æ— é”çŠ¶æ€</li><li>åå‘é”çŠ¶æ€</li><li>è½»é‡çº§é”çŠ¶æ€</li><li>é‡é‡çº§é”çŠ¶æ€</li></ul></li><li>å¯¹è±¡çš„hashcode</li><li>å¯¹è±¡åˆ†ä»£å¹´é¾„</li><li>æ˜¯å¦æ˜¯åå‘é”</li><li>é”æ ‡å¿—ä½</li></ol><blockquote><p>Tips: çº§åˆ«ä»ä½åˆ°é«˜ä¾æ¬¡æ˜¯ï¼šæ— é”çŠ¶æ€ã€åå‘é”çŠ¶æ€ã€è½»é‡çº§é”çŠ¶æ€å’Œé‡é‡çº§é”çŠ¶æ€ï¼Œè¿™å‡ ä¸ªçŠ¶æ€ä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ã€‚é”å¯ä»¥å‡çº§ä½†ä¸èƒ½é™çº§ï¼Œæ„å‘³ç€åå‘é”å‡çº§æˆè½»é‡çº§é”åä¸èƒ½é™çº§æˆåå‘é”ã€‚è¿™ç§é”å‡çº§å´ä¸èƒ½é™çº§çš„ç­–ç•¥ï¼Œç›®çš„æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡ã€‚</p></blockquote><h2 id="5-3-åå‘é”"><a href="#5-3-åå‘é”" class="headerlink" title="5.3 åå‘é”"></a>5.3 åå‘é”</h2><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œè€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾—ï¼Œä¸ºäº†è®©çº¿ç¨‹è·å¾—é”çš„ä»£ä»·æ›´ä½è€Œå¼•å…¥äº†åå‘é”ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—å¹¶è·å–é”æ—¶ï¼Œä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§ä¸­çš„é”è®°å½•é‡Œå­˜å‚¨é”åå‘çš„çº¿ç¨‹IDï¼Œä»¥åè¯¥çº¿ç¨‹åœ¨è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶ä¸éœ€è¦è¿›è¡ŒCASæ“ä½œæ¥åŠ é”å’Œè§£é”ï¼Œåªéœ€ç®€å•åœ°æµ‹è¯•ä¸€ä¸‹å¯¹è±¡å¤´çš„Mark Wordé‡Œæ˜¯å¦å­˜å‚¨ç€æŒ‡å‘å½“å‰çº¿ç¨‹çš„åå‘é”ã€‚å¦‚æœæµ‹è¯•æˆåŠŸï¼Œè¡¨ç¤ºçº¿ç¨‹å·²ç»è·å¾—äº†é”ã€‚å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œåˆ™éœ€è¦å†æµ‹è¯•ä¸€ä¸‹Mark Wordä¸­åå‘é”çš„æ ‡è¯†æ˜¯å¦è®¾ç½®æˆ1ï¼ˆè¡¨ç¤ºå½“å‰æ˜¯åå‘é”ï¼‰ï¼šå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™ä½¿ç”¨CASç«äº‰é”ï¼›å¦‚æœè®¾ç½®äº†ï¼Œåˆ™å°è¯•ä½¿ç”¨CASå°†å¯¹è±¡å¤´çš„åå‘é”æŒ‡å‘å½“å‰çº¿ç¨‹</p><p>åå‘é”ä½¿ç”¨äº†ä¸€ç§ç­‰åˆ°ç«äº‰å‡ºç°æ‰é‡Šæ”¾é”çš„æœºåˆ¶ï¼Œæ‰€ä»¥å½“å…¶ä»–çº¿ç¨‹å°è¯•ç«äº‰åå‘é”æ—¶ï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ã€‚</p><h2 id="5-4-è½»é‡çº§é”"><a href="#5-4-è½»é‡çº§é”" class="headerlink" title="5.4 è½»é‡çº§é”"></a>5.4 è½»é‡çº§é”</h2><p>çº¿ç¨‹åœ¨æ‰§è¡ŒåŒæ­¥å—ä¹‹å‰ï¼ŒJVMä¼šå…ˆåœ¨å½“å‰çº¿ç¨‹çš„æ ˆæ¡¢ä¸­åˆ›å»ºç”¨äºå­˜å‚¨é”è®°å½•çš„ç©ºé—´ï¼Œå¹¶å°†å¯¹è±¡å¤´ä¸­çš„Mark Wordå¤åˆ¶åˆ°é”è®°å½•ä¸­ï¼Œå®˜æ–¹ç§°ä¸ºDisplaced Mark Wordã€‚ç„¶åçº¿ç¨‹å°è¯•ä½¿ç”¨CASå°†å¯¹è±¡å¤´ä¸­çš„Mark Wordæ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚å¦‚æœæˆåŠŸï¼Œå½“å‰çº¿ç¨‹è·å¾—é”ï¼Œå¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºå…¶ä»–çº¿ç¨‹ç«äº‰é”ï¼Œå½“å‰çº¿ç¨‹ä¾¿å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥è·å–é”ã€‚</p><p>è½»é‡çº§è§£é”æ—¶ï¼Œä¼šä½¿ç”¨åŸå­çš„CASæ“ä½œå°†Displaced Mark Wordæ›¿æ¢å›åˆ°å¯¹è±¡å¤´ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰ç«äº‰å‘ç”Ÿã€‚å¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºå½“å‰é”å­˜åœ¨ç«äº‰ï¼Œé”å°±ä¼šè†¨èƒ€æˆé‡é‡çº§é”ã€‚</p><h2 id="5-5-æ¯”è¾ƒ"><a href="#5-5-æ¯”è¾ƒ" class="headerlink" title="5.5 æ¯”è¾ƒ"></a>5.5 æ¯”è¾ƒ</h2><p><img src="https://i.loli.net/2020/01/29/meDvzPd6g24ITU9.png" alt="é”æ¯”è¾ƒ.png"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://en.wikipedia.org/wiki/Compare-and-swap" target="_blank" rel="noopener">1. Wiki: Compare and swap</a></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Concurrency </tag>
            
            <tag> Synchronized </tag>
            
            <tag> Lock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Volatileå…³é”®å­—</title>
      <link href="/Volatile%E5%85%B3%E9%94%AE%E5%AD%97/"/>
      <url>/Volatile%E5%85%B3%E9%94%AE%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Synchronized-vs-volatile"><a href="#1-Synchronized-vs-volatile" class="headerlink" title="1. Synchronized vs volatile"></a>1. Synchronized vs volatile</h1><p>synchronizedæ˜¯é˜»å¡å¼åŒæ­¥ï¼Œåœ¨çº¿ç¨‹ç«äº‰æ¿€çƒˆçš„æƒ…å†µä¸‹ä¼šå‡çº§ä¸ºé‡é‡çº§é”ã€‚è€Œvolatileæ˜¯javaè™šæ‹Ÿæœºæä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚è€Œé’ˆå¯¹volatileä¿®é¥°çš„å˜é‡ç»™javaè™šæ‹Ÿæœºç‰¹æ®Šçš„çº¦å®šï¼Œçº¿ç¨‹å¯¹volatileå˜é‡çš„ä¿®æ”¹ä¼šç«‹åˆ»è¢«å…¶ä»–çº¿ç¨‹æ‰€æ„ŸçŸ¥ï¼Œå³ä¸ä¼šå‡ºç°æ•°æ®è„è¯»çš„ç°è±¡ï¼Œä»è€Œä¿è¯æ•°æ®çš„â€œå¯è§æ€§â€ã€‚</p><p><strong>è¢«volatileä¿®é¥°çš„å˜é‡èƒ½å¤Ÿä¿è¯æ¯ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–è¯¥å˜é‡çš„æœ€æ–°å€¼ï¼Œä»è€Œé¿å…å‡ºç°æ•°æ®è„è¯»çš„ç°è±¡ã€‚</strong></p><h1 id="2-å®ç°åŸç†"><a href="#2-å®ç°åŸç†" class="headerlink" title="2. å®ç°åŸç†"></a>2. å®ç°åŸç†</h1><p>ç”Ÿæˆæ±‡ç¼–ä»£ç æ—¶ä¼šåœ¨Volatileä¿®é¥°çš„å…±äº«å˜é‡è¿›è¡Œå†™æ“ä½œçš„æ—¶å€™å¤šå‡ºlockå‰ç¼€çš„æŒ‡ä»¤ï¼š<strong>è¯¥æŒ‡ä»¤ä¼šå°†å½“å‰å¤„ç†å™¨ç¼“å­˜è¡Œçš„æ•°æ®å†™ä¼šç³»ç»Ÿå†…å­˜ï¼›è¿™ä¸ªå†™å›å†…å­˜çš„æ“ä½œä¼šä½¿å¾—å…¶ä»–CPUé‡Œç¼“å­˜äº†è¯¥å†…å­˜åœ°å€çš„æ•°æ®æ— æ•ˆ</strong></p><p>ä¸ºäº†æé«˜å¤„ç†é€Ÿåº¦ï¼Œå¤„ç†å™¨ä¸ç›´æ¥å’Œå†…å­˜è¿›è¡Œé€šä¿¡ï¼Œè€Œæ˜¯å…ˆå°†ç³»ç»Ÿå†…å­˜çš„æ•°æ®è¯»åˆ°<strong>å†…éƒ¨ç¼“å­˜ï¼ˆL1ï¼ŒL2æˆ–å…¶ä»–</strong>ï¼‰åå†è¿›è¡Œæ“ä½œï¼Œä½†æ“ä½œå®Œä¸çŸ¥é“ä½•æ—¶ä¼šå†™åˆ°å†…å­˜ã€‚å¦‚æœå¯¹å£°æ˜äº†volatileçš„å˜é‡è¿›è¡Œå†™æ“ä½œï¼ŒJVMå°±ä¼šå‘å¤„ç†å™¨å‘é€ä¸€æ¡Lockå‰ç¼€çš„æŒ‡ä»¤ï¼Œå°†è¿™ä¸ªå˜é‡æ‰€åœ¨ç¼“å­˜è¡Œçš„æ•°æ®å†™å›åˆ°ç³»ç»Ÿå†…å­˜ã€‚ä½†æ˜¯ï¼Œå°±ç®—å†™å›åˆ°å†…å­˜ï¼Œå¦‚æœå…¶ä»–å¤„ç†å™¨ç¼“å­˜çš„å€¼è¿˜æ˜¯æ—§çš„ï¼Œå†æ‰§è¡Œè®¡ç®—æ“ä½œå°±ä¼šæœ‰é—®é¢˜ã€‚æ‰€ä»¥ï¼Œåœ¨å¤šå¤„ç†å™¨ä¸‹ï¼Œä¸ºäº†ä¿è¯å„ä¸ªå¤„ç†å™¨çš„ç¼“å­˜æ˜¯ä¸€è‡´çš„ï¼Œå°±ä¼šå®ç°<strong>ç¼“å­˜ä¸€è‡´æ€§å</strong>è®®ï¼Œ<strong>æ¯ä¸ªå¤„ç†å™¨é€šè¿‡å—…æ¢åœ¨æ€»çº¿ä¸Šä¼ æ’­çš„æ•°æ®æ¥æ£€æŸ¥è‡ªå·±ç¼“å­˜çš„å€¼æ˜¯ä¸æ˜¯è¿‡æœŸäº†ï¼Œå½“å¤„ç†å™¨å‘ç°è‡ªå·±ç¼“å­˜è¡Œå¯¹åº”çš„å†…å­˜åœ°å€è¢«ä¿®æ”¹ï¼Œå°±ä¼šå°†å½“å‰å¤„ç†å™¨çš„ç¼“å­˜è¡Œè®¾ç½®æˆæ— æ•ˆçŠ¶æ€ï¼Œå½“å¤„ç†å™¨å¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹æ“ä½œçš„æ—¶å€™ï¼Œä¼šé‡æ–°ä»ç³»ç»Ÿå†…å­˜ä¸­æŠŠæ•°æ®è¯»åˆ°å¤„ç†å™¨ç¼“å­˜é‡Œã€‚</strong>å› æ­¤ï¼Œç»è¿‡åˆ†ææˆ‘ä»¬å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š</p><ol><li>lockå‰ç¼€çš„æŒ‡ä»¤ä¼šå¼•èµ·å¤„ç†å™¨ç¼“å­˜å†™å›å†…å­˜</li><li>ä¸€ä¸ªå¤„ç†å™¨çš„ç¼“å­˜å›å†™åˆ°å†…å­˜ä¼šå¯¼è‡´å…¶ä»–å¤„ç†å™¨çš„ç¼“å­˜å¤±æ•ˆ</li><li>å½“å¤„ç†å™¨å‘ç°æœ¬åœ°ç¼“å­˜å¤±æ•ˆåï¼Œå°±ä¼šä»å†…å­˜ä¸­é‡è¯»è¯¥å˜é‡æ•°æ®ï¼Œå³å¯ä»¥è·å¾—å½“å‰æœ€æ–°å€¼</li></ol><h1 id="3-volatileçš„happen-beforeå…³ç³»"><a href="#3-volatileçš„happen-beforeå…³ç³»" class="headerlink" title="3. volatileçš„happen beforeå…³ç³»"></a>3. volatileçš„happen beforeå…³ç³»</h1><p>å†™åè¯»ï¼Œçº¿ç¨‹Aæ”¹æœ¬åœ°å†…å­˜çš„å˜é‡ï¼ŒåŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œçº¿ç¨‹Bçš„æœ¬åœ°å†…å­˜åºŸå¼ƒï¼Œåˆ°ä¸»å†…å­˜ä¸­æ‹¿åˆ°æ›´æ–°çš„æ•°æ®ã€‚</p><h1 id="4-volatileçš„å†…å­˜è¯­ä¹‰å®ç°"><a href="#4-volatileçš„å†…å­˜è¯­ä¹‰å®ç°" class="headerlink" title="4. volatileçš„å†…å­˜è¯­ä¹‰å®ç°"></a>4. volatileçš„å†…å­˜è¯­ä¹‰å®ç°</h1><p>ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼ŒJMMåœ¨ä¸æ”¹å˜æ­£ç¡®è¯­ä¹‰çš„å‰æä¸‹ï¼Œä¼šå…è®¸ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤åºåˆ—è¿›è¡Œé‡æ’åºï¼Œé‚£å¦‚æœæƒ³é˜»æ­¢é‡æ’åºè¦æ€ä¹ˆåŠäº†ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥æ·»åŠ å†…å­˜å±éšœã€‚</p><p>å†…å­˜å±éšœç±»å‹ï¼š </p><p><img src="https://i.loli.net/2020/01/29/kIQaATpeCf56nxs.png" alt="å†…å­˜å±éšœ.png"></p><p><img src="https://i.loli.net/2020/01/29/RKDH1XxFAJeQVjY.png" alt="é‡æ’åº.png"></p><p>â€œNOâ€è¡¨ç¤ºç¦æ­¢é‡æ’åºã€‚ä¸ºäº†å®ç°volatileå†…å­˜è¯­ä¹‰æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼šåœ¨æŒ‡ä»¤åºåˆ—ä¸­æ’å…¥å†…å­˜å±éšœæ¥ç¦æ­¢ç‰¹å®šç±»å‹çš„å¤„ç†å™¨é‡æ’åºã€‚å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œå‘ç°ä¸€ä¸ªæœ€ä¼˜å¸ƒç½®æ¥æœ€å°åŒ–æ’å…¥å±éšœçš„æ€»æ•°å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä¸ºæ­¤ï¼ŒJMMé‡‡å–äº†ä¿å®ˆç­–ç•¥ï¼š</p><ol><li>åœ¨æ¯ä¸ªvolatileå†™æ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ªStoreStoreå±éšœï¼›</li><li>åœ¨æ¯ä¸ªvolatileå†™æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ªStoreLoadå±éšœï¼›</li><li>åœ¨æ¯ä¸ªvolatileè¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ªLoadLoadå±éšœï¼›</li><li>åœ¨æ¯ä¸ªvolatileè¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ªLoadStoreå±éšœã€‚</li></ol><p><img src="https://i.loli.net/2020/01/29/8JCkKYZg2NfMzP5.png" alt="volatileå†…å­˜å±éšœ.png"><br><img src="https://i.loli.net/2020/01/29/uY9qUvorMLK5a1V.png" alt="volatileè¯»æ’å…¥å†…å­˜å±éšœç¤ºæ„å›¾.png"></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Concurrency </tag>
            
            <tag> BackEnd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå¹¶å‘å›¾è°±</title>
      <link href="/Java%E5%B9%B6%E5%8F%91%E5%9B%BE%E8%B0%B1/"/>
      <url>/Java%E5%B9%B6%E5%8F%91%E5%9B%BE%E8%B0%B1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨ç½‘ä¸Šçœ‹åˆ°çš„æè¿°Javaå¹¶å‘çš„éå¸¸æ£’çš„çŸ¥è¯†å›¾è°±ï¼Œåˆ†äº«/æ ‡æ³¨ä¸€æ³¢ã€‚</p></blockquote><p>åŒ…å«ï¼š </p><ol><li>å¹¶å‘ç†è®º</li><li>å¹¶å‘å…³é”®å­—</li><li>Lockä½“ç³»</li><li>å¹¶å‘å®¹å™¨</li></ol><p><img src="https://i.loli.net/2020/01/29/neDuY6XEaA2FsV9.png" alt="java-concurrency.png"></p>]]></content>
      
      
      <categories>
          
          <category> BackEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Concurrency </tag>
            
            <tag> BackEnd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµè§ˆå™¨è¾“å…¥urlä»¥åéƒ½å‘ç”Ÿäº†ä»€ä¹ˆ</title>
      <link href="/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BE%93%E5%85%A5url%E4%BB%A5%E5%90%8E%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/"/>
      <url>/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BE%93%E5%85%A5url%E4%BB%A5%E5%90%8E%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<p>ä»è¾“å…¥ä¸€ä¸ªç½‘å€å¼€å§‹ï¼Œéƒ½è°ƒç”¨äº†å“ªäº›æœåŠ¡ï¼Œç»å†äº†å“ªäº›æ­¥éª¤ï¼Œæ·±åº¦è§£æã€‚ä»¥è¾“å…¥<a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> ä¸ºä¾‹ã€‚</p><h1 id="1-Clientç«¯"><a href="#1-Clientç«¯" class="headerlink" title="1. Clientç«¯"></a>1. Clientç«¯</h1><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™é‡Œçš„ClientæŒ‡ç”¨æˆ·ï¼Œå³browseræµè§ˆå™¨ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥è¾“å…¥google.comä¸ºä¾‹ã€‚</p><h2 id="1-1-è¾“å…¥æç¤º"><a href="#1-1-è¾“å…¥æç¤º" class="headerlink" title="1.1 è¾“å…¥æç¤º"></a>1.1 è¾“å…¥æç¤º</h2><p>æµè§ˆå™¨ä¼šæ ¹æ®å†å²è®¿é—®ï¼Œä¹¦ç­¾ç­‰ä¿¡æ¯ç»™å‡ºè¾“å…¥å»ºè®®ã€‚</p><p>è¿˜ä¼šæ ¹æ®é»˜è®¤æœç´¢å¼•æ“çš„æœç´¢è®°å½•ï¼Œå»åŒ¹é…æœ€è¿‘çš„æœç´¢è®°å½•ã€‚</p><h2 id="1-2-urlè§£æ"><a href="#1-2-urlè§£æ" class="headerlink" title="1.2 urlè§£æ"></a>1.2 urlè§£æ</h2><p>å¦‚æœæ˜¯ä¸åˆæ³•çš„åœ°å€ï¼Œä¼šè½¬ç»™é»˜è®¤çš„æœç´¢å¼•æ“,ä¾‹å¦‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨chromeï¼Œå¯ä»¥åœ¨urlè¾“å…¥æ¡†è¾“å…¥ä½ æƒ³è¦æœç´¢çš„å†…å®¹ï¼Œç„¶åæœç´¢å¼•æ“ä¼šæ ¹æ®å…³é”®å­—è¿›è¡Œæœç´¢ã€‚</p><p>HSTSåˆ—è¡¨ å®‰å…¨ç­–ç•¥æœºåˆ¶ï¼Œå¼ºè¡Œä½¿ç”¨https</p><h2 id="1-3-DNSè§£æ"><a href="#1-3-DNSè§£æ" class="headerlink" title="1.3 DNSè§£æ"></a>1.3 DNSè§£æ</h2><p>åŸŸåé€šè¿‡DNSè½¬åŒ–ä¸ºipåœ°å€ï¼Œè¿™ä¸ªè½¬åŒ–ä¸»è¦æ˜¯ä¸ºäº†äººæœºäº¤äº’çš„å‹å¥½å‹ã€‚æ²¡æœ‰äººå–œæ¬¢è®°ä¸€å †æ•°å­—æ¥è®¿é—®ä¸€ä¸ªç½‘ç«™ã€‚DNSåšçš„äº‹æƒ…å°±æ˜¯æŠŠä½ è¾“å…¥çš„<a href="http://www.google.comç¿»è¯‘æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„IPåœ°å€ï¼Œç±»ä¼¼äº192.188.1.1è¿™ç§æ ·å­ã€‚" target="_blank" rel="noopener">www.google.comç¿»è¯‘æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„IPåœ°å€ï¼Œç±»ä¼¼äº192.188.1.1è¿™ç§æ ·å­ã€‚</a></p><h3 id="1-3-1æŸ¥è¯¢è¿‡ç¨‹"><a href="#1-3-1æŸ¥è¯¢è¿‡ç¨‹" class="headerlink" title="1.3.1æŸ¥è¯¢è¿‡ç¨‹"></a>1.3.1æŸ¥è¯¢è¿‡ç¨‹</h3><p>åœ¨è§£æçš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨ä¼šç”±è¿‘åŠè¿œå¯»æ‰¾æ˜¯å¦æœ‰ç¼“å­˜ä¿¡æ¯ï¼Œå³å­˜æ²¡å­˜ä»åŸŸååˆ°åœ°å€çš„æ˜ å°„ï¼Œæ•´ä¸ªæŸ¥è¯¢è¿‡ç¨‹åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸€æ—¦æŸ¥è¯¢åˆ°ï¼Œå°±ä¼šç«‹åˆ»è¿”å›ï¼Œä¸ä¼šå†ç»§ç»­æ‰§è¡Œä¸‹å»äº†ã€‚</p><ol><li>æŸ¥çœ‹æµè§ˆå™¨å†…éƒ¨ç¼“å­˜</li></ol><p>æµè§ˆå™¨å†…ä¼šä¼šå­˜æœ‰åœ¨ä¸€æ®µæ—¶é—´å†…ä½ æ›¾ç»è®¿é—®è¿‡çš„ç½‘ç«™çš„åŸŸååœ°å€çš„æ˜ å°„ã€‚</p><ol start="2"><li>ç³»ç»Ÿç¼“å­˜</li></ol><p>æ“ä½œç³»ç»Ÿçš„ç¼“å­˜ã€‚æµè§ˆå™¨ä¼šå‘å‡ºsystem callï¼Œ å»è¯¢é—®æ“ä½œç³»ç»Ÿæ˜¯å¦å­˜æœ‰ç›¸åº”çš„æ˜ å°„ã€‚</p><ol start="3"><li>è·¯ç”±å™¨ç¼“å­˜ï¼Œ ISPç¼“å­˜</li></ol><p>æŸ¥è¯¢è·¯ç”±å™¨çš„ç¼“å­˜ã€‚å¦‚æœåœ¨è·¯ç”±å™¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°æ˜ å°„ï¼Œå°±ä¼šå»ISP(Internet Service Provider)å¤„å»å¯»æ‰¾</p><ol start="4"><li><p>æœ¬åœ°DNSæœåŠ¡å™¨</p></li><li><p>åŸŸåæœåŠ¡å™¨  æ ¹åŸŸæœåŠ¡å™¨  -&gt; é¡¶çº§åŸŸåæœåŠ¡å™¨</p></li></ol><p>å¯»æ‰¾æ–¹å¼ç±»ä¼¼äºä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»æœ€åº•å±‚çš„å­å¶å¼€å§‹å‘ä¸Šéå†ï¼Œä¸åœå‘æ›´é«˜çº§çš„åŸŸåæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸åœå‘é€æºå¸¦æœ‰è¯·æ±‚å’ŒIPåœ°å€çš„æ•°æ®åŒ…ï¼Œä¼šç»è¿‡åœ¨clientå’Œserverä¹‹é—´çš„å¤šä¸ªç½‘è·¯è®¾å¤‡ç›´åˆ°å…¶åˆ°è¾¾æ­£ç¡®çš„DNSæœåŠ¡å™¨ã€‚</p><h1 id="2-ç½‘ç»œ"><a href="#2-ç½‘ç»œ" class="headerlink" title="2 ç½‘ç»œ"></a>2 ç½‘ç»œ</h1><p>æ‰¾åˆ°äº†æ­£ç¡®çš„IPåœ°å€ä»¥åå°±è¦å¼€å§‹å»ºç«‹è¿æ¥äº†ï¼Œå»ºç«‹è¿æ¥çš„è¿‡ç¨‹ä¸€èˆ¬ä¼šä½¿ç”¨TCPåè®®ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ã€‚</p><h2 id="2-1-TCPè¿æ¥"><a href="#2-1-TCPè¿æ¥" class="headerlink" title="2.1 TCPè¿æ¥"></a>2.1 TCPè¿æ¥</h2><p>ä¼šç”¨TCPï¼Œå»ºç«‹è¿æ¥ã€‚å¹¶åœ¨Clientå’ŒServerä¹‹é—´ä¼ é€’æ•°æ®åŒ…ã€‚</p><h3 id="2-1-1-IPå°è£…-socket"><a href="#2-1-1-IPå°è£…-socket" class="headerlink" title="2.1.1 IPå°è£…  socket"></a>2.1.1 IPå°è£…  socket</h3><h3 id="2-1-2-TCP-ä¸‰æ¬¡æ¡æ‰‹"><a href="#2-1-2-TCP-ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="2.1.2 TCP ä¸‰æ¬¡æ¡æ‰‹"></a>2.1.2 TCP ä¸‰æ¬¡æ¡æ‰‹</h3><ol><li>Client å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ã€‚æ•°æ®åŒ…æºå¸¦æœ‰<code>SYN</code>ã€‚</li><li>å¦‚æœServeræœ‰å¼€æ”¾çš„ç«¯å£ï¼Œå¯ä»¥æ¥å—å¹¶å»ºç«‹è¿æ¥ï¼Œé‚£ä¹ˆserverä¼šè¿”å›<code>SYN</code> + <code>ACK</code>, å‘Šè¯‰Clientæˆ‘å¯ä»¥æ¥å—ä½ çš„è¯·æ±‚ã€‚</li><li>Clientæ”¶åˆ°Serverçš„å›åº”ï¼Œå‘é€<code>ACK</code>ç»™Serverã€‚ è¿æ¥å»ºç«‹ã€‚</li></ol><p>ç»™ä¸€ä¸ªçŸ¥ä¹è¿æ¥ï¼Œ<a href="https://www.zhihu.com/question/24853633" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸æ˜¯ä¸¤æ¬¡æˆ–è€…å››æ¬¡ï¼Ÿ</a>  éå¸¸æœ‰æ„æ€çš„ä¾‹å­ã€‚</p><h3 id="2-1-3-TCP-å››æ¬¡æŒ¥æ‰‹"><a href="#2-1-3-TCP-å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="2.1.3 TCP å››æ¬¡æŒ¥æ‰‹"></a>2.1.3 TCP å››æ¬¡æŒ¥æ‰‹</h3><ol><li>Clientå‘èµ·ä¸­æ–­è¯·æ±‚ï¼Œå‘é€<code>FIN</code>åˆ°server</li><li>Serveræ”¶åˆ°è¯·æ±‚ï¼Œå¯èƒ½æ•°æ®è¿˜æ²¡æœ‰å‘å®Œã€‚è¿™ä¸ªæ—¶å€™ä¸ä¼šå…³é—­socketï¼Œè€Œæ˜¯å›å¤<code>ACK</code>ï¼Œå‘Šè¯‰ClientçŸ¥é“äº†</li><li>Clientè¿›å…¥<code>Fin_Wait</code>çŠ¶æ€ï¼Œç»§ç»­ç­‰å¾…Serverç«¯çš„<code>FIN</code>æŠ¥æ–‡ã€‚Serverç«¯å‘é€å®Œæ¯•åï¼Œä¼šå‘Clientå‘é€<code>FIN</code></li><li>Clientæ”¶åˆ°åå°±å›å¤<code>ACK</code>ï¼Œå¹¶å…³é—­è¿æ¥</li></ol><h1 id="3-Server"><a href="#3-Server" class="headerlink" title="3 Server"></a>3 Server</h1><p>è¿™é‡Œä¸»è¦æè¿°TCPè¿æ¥å»ºç«‹å’Œæ–­å¼€ä¹‹é—´å‘ç”Ÿçš„ä¸€äº›äº‹æƒ…ã€‚</p><p>TCP/IPæ˜¯ä¸ªåè®®ç»„ï¼Œæ˜¯ç½‘ç»œå±‚å’Œä¼ è¾“å±‚çš„åè®®ã€‚Clienté¦–å…ˆå»ºç«‹ä¸€æ¡ä¸æœåŠ¡å™¨çš„TCPè¿æ¥ï¼ˆä¸Šæ–‡ä¸­çš„ä¸‰æ¬¡æ¡æ‰‹ï¼‰ã€‚è€ŒåClientå‘é€HTTPè¯·æ±‚ï¼Œè¿™é‡Œä¸ºäº†è·å¾—é¡µé¢ï¼Œä¼šå‘é€ä¸€ä¸ªGETè¯·æ±‚ç»™æœåŠ¡å™¨ã€‚è¯·æ±‚ä¼šåŒ…å«æµè§ˆå™¨IDï¼Œç”¨æˆ·æ•°æ®å¤´ï¼Œè¿æ¥å¤´ï¼ˆåŒ…å«é¢å¤–ä¿¡æ¯ï¼Œæ¯”å¦‚æ˜¯å¦éœ€è¦ä¿æŒTCPè¿æ¥ç­‰ï¼‰ï¼Œä»cookieè·å–çš„æ•°æ®ç­‰ã€‚</p><p>Serveræ”¶åˆ°Clientçš„Requestï¼Œä¼šå°†è¯·æ±‚ä¼ é€’ç»™Request Handlerï¼Œå»å¤„ç†è¯·æ±‚ï¼ˆä»æ•°æ®åº“æŸ¥æ‰¾æ•°æ®ï¼Œå¤„ç†æ•°æ®ï¼Œæ„å»ºResponseï¼‰ã€‚æ„å»ºå®Œæ¯•åä¼šè¿”å›ä¸€ä¸ªResponseã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªResponseé‡Œä¼šå«æœ‰çŠ¶æ€ä¿¡æ¯ï¼š </p><ul><li>1xx informational message only  â€”â€” åŒ…å«ä¿¡æ¯</li><li>2xx success of some kind  â€”â€”æˆåŠŸä¿¡æ¯</li><li>3xx redirects the client to another URL  â€”â€”å°†Clientè½¬åˆ°å…¶ä»–URL</li><li>4xx indicates an error on the clientâ€™s part  â€”â€”Clientç«¯é”™è¯¯ </li><li>5xx indicates an error on the serverâ€™s part  â€”â€”Serverç«¯é”™è¯¯</li></ul><h1 id="4-é¡µé¢æ¸²æŸ“"><a href="#4-é¡µé¢æ¸²æŸ“" class="headerlink" title="4 é¡µé¢æ¸²æŸ“"></a>4 é¡µé¢æ¸²æŸ“</h1><p>æµè§ˆå™¨æ ¹æ®Resonseè¿”å›æ•°æ®ï¼Œæ¸²æŸ“å‡ºDOMæ ‘ï¼Œå°†è¿”å›çš„æ•°æ®å‘ˆç°åœ¨é¡µé¢ä¸Šã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://github.com/sunyongjian/blog/issues/34" target="_blank" rel="noopener">https://github.com/sunyongjian/blog/issues/34</a></p>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> Browser </tag>
            
            <tag> CDN </tag>
            
            <tag> network </tag>
            
            <tag> TCP/ IP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactåˆæ¢</title>
      <link href="/React%E5%88%9D%E6%8E%A2/"/>
      <url>/React%E5%88%9D%E6%8E%A2/</url>
      
        <content type="html"><![CDATA[<p>åˆæ¢React,å¾ˆå–œæ¬¢Componentè¿™ç§æ–¹å¼ï¼Œå¾ˆå¤§ç¨‹åº¦æé«˜äº†å¤ç”¨æ€§ï¼Œå¦‚æœæŠ›é™¤C/Sçš„åŒºåˆ«ï¼Œæ„Ÿè§‰æœ‰ç‚¹åƒmasonï¼Œæ¯•ç«Ÿåˆšåˆšå¼ƒæ‰masonçš„å‘ï¼Œå¾ˆæœ‰æ„æ€çš„Reactã€‚</p><h1 id="1-Hello-World"><a href="#1-Hello-World" class="headerlink" title="1. Hello World"></a>1. Hello World</h1><p>React.Component   A component takes in parameters, called props and returns a hierarchy of views to display via the render method. </p><p>To collect data from multiple children, or to have two child components communicate with each other, you need to declare the shared state in their parent component instead. <strong>The parent component can pass the state back down to the children by using props; this keeps the child components in sync with each other and with the parent component.</strong> </p><pre><code>ReactDOM.render(    &lt;h1&gt;Hello, world!&lt;/h1&gt;,    document.getElementById(&#39;root&#39;));</code></pre><h1 id="2-JSX"><a href="#2-JSX" class="headerlink" title="2. JSX"></a>2. JSX</h1><p>jsx, ä¸€ç§JavaScriptçš„è¯­æ³•æ‰©å±•ã€‚ç”¨æ¥å£°æ˜Reactå½“ä¸­çš„å…ƒç´ ã€‚å¯ä»¥ä»»æ„åœ¨<strong>å¤§æ‹¬å·{}</strong>é‡Œé¢ä½¿ç”¨<strong>JSè¡¨è¾¾å¼</strong>.</p><h2 id="2-1-JSè¡¨è¾¾å¼"><a href="#2-1-JSè¡¨è¾¾å¼" class="headerlink" title="2.1 JSè¡¨è¾¾å¼"></a>2.1 JSè¡¨è¾¾å¼</h2><blockquote><p>Any valid unit of code that resolves to a value. </p></blockquote><h3 id="2-1-1-åˆ†ç±»"><a href="#2-1-1-åˆ†ç±»" class="headerlink" title="2.1.1 åˆ†ç±»"></a>2.1.1 åˆ†ç±»</h3><ul><li><p>Arithmetic</p></li><li><p>String </p></li><li><p>Logical</p></li><li><p>Primary Expressions</p></li></ul><p>Basic keywords and general expressions in JS.</p><ol><li><p>this: refer to the current object.</p></li><li><p>grouping operator() : controls the precedence of evaluation in expressions. </p></li><li><p>new: to create an instance of a user-defined object type </p></li><li><p>super: call functions on an objectâ€™s parent.</p></li><li><p>spread operator: allow an expression to be expanded in places where multiple arguments or multiple elements are expected. </p><pre><code>  function f(x, y, z) { } var args = [0, 1, 2]; f(...args);</code></pre></li></ol><ul><li>Left hand side expressions</li></ul><h2 id="2-2-JSX-å±æ€§"><a href="#2-2-JSX-å±æ€§" class="headerlink" title="2.2 JSX å±æ€§"></a>2.2 JSX å±æ€§</h2><p>ç¼–è¯‘ä¹‹åï¼Œä¼šè¢«è½¬åŒ–ä¸ºæ™®é€šçš„JSå¯¹è±¡ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨if æˆ–è€…forè¯­å¥é‡Œä½¿ç”¨JSXï¼Œå°†å…¶èµ‹å€¼ç»™å˜é‡ï¼Œå½“åšå‚æ•°ä¼ å…¥æˆ–è€…ä½œä¸ºè¿”å›å€¼éƒ½å¯ä»¥ã€‚</p><pre><code>// ä½¿ç”¨å¼•å·å®šä¹‰ä»¥å­—ç¬¦ä¸²ä¸ºå€¼å¾—å±æ€§const element = &lt;div tabIndex=&quot;0&quot;&gt;&lt;/div&gt;;// ä½¿ç”¨å¤§æ‹¬å·æ¥å®šä¹‰ä»¥jsè¡¨è¾¾å¼ä¸ºå€¼å¾—å±æ€§const element = &lt;img src={user.avatarUrl}&gt;&lt;/img&gt;;</code></pre><p>JSXä»£è¡¨Objects, Babelè½¬è¯‘å™¨ä¼šæŠŠJSXè½¬æ¢æˆä¸€ä¸ªåä¸ºReact.createEliment()çš„æ–¹æ³•æ¥è°ƒç”¨</p><h2 id="2-3-åµŒå¥—ä¸é˜²æ³¨å…¥æ”»å‡»"><a href="#2-3-åµŒå¥—ä¸é˜²æ³¨å…¥æ”»å‡»" class="headerlink" title="2.3 åµŒå¥—ä¸é˜²æ³¨å…¥æ”»å‡»"></a>2.3 åµŒå¥—ä¸é˜²æ³¨å…¥æ”»å‡»</h2><pre><code>const element = (  &lt;div&gt;    &lt;h1&gt;Hello!&lt;/h1&gt;    &lt;h2&gt;Good to see you here.&lt;/h2&gt;  &lt;/div&gt;);React DOMåœ¨æ¸²æŸ“ä¹‹å‰ä¼šè¿‡æ»¤æ‰€æœ‰ä¼ å…¥çš„å€¼ï¼Œå¯ä»¥ç¡®ä¿åº”ç”¨ä¸ä¼šè¢«æ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºæ‰€æœ‰å†…å®¹æ¸²æŸ“ä¹‹å‰éƒ½å·²ç»è¢«è½¬åŒ–ä¸ºäº†å­—ç¬¦ä¸²ï¼Œæœ‰æ•ˆé˜²æ­¢XSSã€‚ </code></pre><h1 id="3-å…ƒç´ æ¸²æŸ“"><a href="#3-å…ƒç´ æ¸²æŸ“" class="headerlink" title="3. å…ƒç´ æ¸²æŸ“"></a>3. å…ƒç´ æ¸²æŸ“</h1><p>Reactä¸­çš„å…ƒç´ å®é™…ä¸Šæ˜¯æ™®é€šçš„å¯¹è±¡ï¼ŒReact DOMå¯ä»¥ç¡®ä¿æµè§ˆå™¨DOMçš„æ•°æ®å†…å®¹ä¸Reactå…ƒç´ ä¿æŒä¸€è‡´ã€‚<br>å¯»æ‰¾React æ ¹èŠ‚ç‚¹ï¼Œæ¸²æŸ“åœ¨æ ¹èŠ‚ç‚¹ä¸Š</p><pre><code>const element = &lt;h1&gt;Hello, world&lt;/h1&gt;;ReactDOM.render(element, document.getElementById(&#39;root&#39;));</code></pre><h2 id="3-1-æ›´æ–°å…ƒç´ æ¸²æŸ“"><a href="#3-1-æ›´æ–°å…ƒç´ æ¸²æŸ“" class="headerlink" title="3.1 æ›´æ–°å…ƒç´ æ¸²æŸ“"></a>3.1 æ›´æ–°å…ƒç´ æ¸²æŸ“</h2><p>React å…ƒç´ éƒ½æ˜¯immutableçš„ï¼Œæ›´æ–°ç•Œé¢çš„æ–¹å¼å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œç„¶åå°†å…¶ä¼ å…¥<code>ReactDOM.render()</code> </p><p>React DOM ä¼šæ¯”è¾ƒå…ƒç´ çš„å†…å®¹çš„å…ˆåçš„ä¸åŒï¼Œè€Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­åªä¼šæ›´æ–°æ”¹å˜äº†çš„éƒ¨åˆ†ã€‚</p><h1 id="4-ç»„ä»¶-amp-props"><a href="#4-ç»„ä»¶-amp-props" class="headerlink" title="4. ç»„ä»¶ &amp; props"></a>4. ç»„ä»¶ &amp; props</h1><p>ç»„ä»¶å°†UIåˆ‡åˆ†æˆä¸€äº›ç‹¬ç«‹çš„ï¼Œå¯å¤ç”¨çš„éƒ¨ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥ä¸“æ³¨äºæ„å»ºæ¯ä¸€ä¸ªå•ç‹¬çš„éƒ¨ä»¶ã€‚æ¦‚å¿µä¸Šåƒ<strong>å‡½æ•°</strong>ä¸€æ ·ï¼Œå¯ä»¥æ¥å—ä»»æ„çš„è¾“å…¥å€¼(props)ï¼Œå¹¶è¿”å›ä¸€ä¸ªåœ¨é¡µé¢ä¸Šå±•ç¤ºçš„Reactå…ƒç´ ã€‚</p><h2 id="4-1-å‡½æ•°å®šä¹‰ç»„ä»¶"><a href="#4-1-å‡½æ•°å®šä¹‰ç»„ä»¶" class="headerlink" title="4.1 å‡½æ•°å®šä¹‰ç»„ä»¶"></a>4.1 å‡½æ•°å®šä¹‰ç»„ä»¶</h2><pre><code>function Welcome(props) {    return &lt;h1&gt;Hello, {props.name}&lt;/h1&gt;;}</code></pre><h2 id="4-2-ES6-class-å®šä¹‰ç»„ä»¶"><a href="#4-2-ES6-class-å®šä¹‰ç»„ä»¶" class="headerlink" title="4.2 ES6 class å®šä¹‰ç»„ä»¶"></a>4.2 ES6 class å®šä¹‰ç»„ä»¶</h2><pre><code>class Welcome extends React.Component {    render() {        return &lt;h1&gt;Hello, {this.props.name}&lt;/h1&gt;    }}</code></pre><h2 id="4-3-ç»„ä»¶æ¸²æŸ“"><a href="#4-3-ç»„ä»¶æ¸²æŸ“" class="headerlink" title="4.3 ç»„ä»¶æ¸²æŸ“"></a>4.3 ç»„ä»¶æ¸²æŸ“</h2><pre><code>// React å…ƒç´ å¯ä»¥ä½¿ç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶const element = &lt;Welcome name=&quot;Sara&quot; /&gt;;</code></pre><p><strong>å½“Reacté‡åˆ°çš„å…ƒç´ æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œå®ƒä¼šå°†JSXå±æ€§ä½œä¸ºå•ä¸ªå¯¹è±¡ä¼ é€’ç»™è¯¥ç»„ä»¶ï¼Œè¿™ä¸ªå¯¹è±¡è¢«ç§°ä¸ºâ€propsâ€</strong></p><blockquote><p>ç»„ä»¶åç§°å¿…é¡»å¤§å†™</p></blockquote><h2 id="4-4-ç»„åˆç»„ä»¶"><a href="#4-4-ç»„åˆç»„ä»¶" class="headerlink" title="4.4 ç»„åˆç»„ä»¶"></a>4.4 ç»„åˆç»„ä»¶</h2><p>ç»„ä»¶å¯ä»¥åœ¨å®ƒçš„è¾“å‡ºä¸­å¼•ç”¨å…¶ä»–ç»„ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨åŒä¸€ç»„ä»¶æ¥æŠ½è±¡å‡ºä»»æ„å±‚æ¬¡çš„ç»†èŠ‚ã€‚</p><blockquote><p>ä¸€ä¸ªæ–°çš„Reactåº”ç”¨ç¨‹åºçš„é¡¶éƒ¨æ˜¯ä¸€ä¸ªAppç»„ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦å°†Reacté›†æˆåˆ°ç°æœ‰åº”ç”¨ç¨‹åºä¸­ï¼Œåˆ™å¯ä»¥ä»ä¸‹è€Œä¸Šä½¿ç”¨åƒButtonè¿™æ ·çš„å°ç»„ä»¶ä½œä¸ºå¼€å§‹ï¼Œå¹¶é€æ¸è¿ç”¨åˆ°è§†å›¾å±‚çš„é¡¶éƒ¨ã€‚</p></blockquote><blockquote><p>ç»„ä»¶çš„è¿”å›å€¼åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¦ç”¨ä¸€ä¸ª<div>æ¥åŒ…è£¹æ‰€æœ‰<Welcome />å…ƒç´ çš„åŸå› ã€‚</p></blockquote><h2 id="4-5-æå–ç»„ä»¶"><a href="#4-5-æå–ç»„ä»¶" class="headerlink" title="4.5 æå–ç»„ä»¶"></a>4.5 æå–ç»„ä»¶</h2><p>åˆ†å‰²ç»„ä»¶ï¼Œ</p><h2 id="4-6-Propsçš„åªè¯»æ€§"><a href="#4-6-Propsçš„åªè¯»æ€§" class="headerlink" title="4.6 Propsçš„åªè¯»æ€§"></a>4.6 Propsçš„åªè¯»æ€§</h2><p>æ‰€æœ‰çš„Reactç»„ä»¶å¿…é¡»åƒçº¯å‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒä»¬çš„props</p><h1 id="5-State-amp-ç”Ÿå‘½å‘¨æœŸ"><a href="#5-State-amp-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5. State &amp; ç”Ÿå‘½å‘¨æœŸ"></a>5. State &amp; ç”Ÿå‘½å‘¨æœŸ</h1><p>æ›´æ–°UIçš„æ–¹æ³•ï¼š <code>ReactDOM.render()</code></p><p>è¿˜å¯ä»¥é€šè¿‡æ›´æ–°çŠ¶æ€æ¥æ›´æ–°UIï¼Œ<strong>çŠ¶æ€æ˜¯ç§æœ‰çš„ï¼Œå®Œå…¨å—æ§äºå½“å‰ç»„ä»¶</strong></p><h2 id="5-1-å°†å‡½æ•°è½¬æ¢ä¸ºç±»"><a href="#5-1-å°†å‡½æ•°è½¬æ¢ä¸ºç±»" class="headerlink" title="5.1 å°†å‡½æ•°è½¬æ¢ä¸ºç±»"></a>5.1 å°†å‡½æ•°è½¬æ¢ä¸ºç±»</h2><p>å®šä¹‰ä¸ºç±»çš„ç»„ä»¶æœ‰çŠ¶æ€è¿™ä¸ªç‰¹æ€§ï¼Œè¿˜æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚</p><p>å‡½æ•°è½¬æ¢ä¸ºç±»çš„æ­¥éª¤ï¼š </p><ol><li>åˆ›å»ºä¸€ä¸ªåç§°æ‰©å±•ä¸º<code>React.Component</code>çš„ç±»</li><li>åˆ›å»ºä¸€ä¸ª<code>render()</code>ç©ºæ–¹æ³•</li><li>å°†å‡½æ•°ä½“ç§»åŠ¨åˆ°render()æ–¹æ³•ä¸­</li><li>åœ¨render()æ–¹æ³•ä¸­ï¼Œä½¿ç”¨this.propsæ›¿æ¢props</li><li>åˆ é™¤å‰©ä½™çš„ç©ºå‡½æ•°å£°æ˜</li></ol><h2 id="5-2-ä¸ºç±»æ·»åŠ å±€éƒ¨çŠ¶æ€"><a href="#5-2-ä¸ºç±»æ·»åŠ å±€éƒ¨çŠ¶æ€" class="headerlink" title="5.2 ä¸ºç±»æ·»åŠ å±€éƒ¨çŠ¶æ€"></a>5.2 ä¸ºç±»æ·»åŠ å±€éƒ¨çŠ¶æ€</h2><pre><code>Class Clock extends React.Component {    constructor(props) {        super(props);        this.state = {date: new Date()};    }    render() {        return (            &lt;div&gt;                &lt;h1&gt;Hello, world!&lt;/h1&gt;                &lt;h2&gt;It is {this.state.date.toLocaleTimeString()}.&lt;/h2&gt;            &lt;/div&gt;        );    }}ReactDOM.render(    &lt;Clock/&gt;    document.getElementById(&#39;root&#39;));</code></pre><h2 id="5-3-æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åˆ°ç±»ä¸­"><a href="#5-3-æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åˆ°ç±»ä¸­" class="headerlink" title="5.3 æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åˆ°ç±»ä¸­"></a>5.3 æ·»åŠ ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åˆ°ç±»ä¸­</h2><p>å½“ç»„ä»¶ç¬¬ä¸€æ¬¡åŠ è½½åˆ°DOMä¸­æ—¶ï¼Œç”Ÿæˆå®šæ—¶å™¨ï¼ŒæŒ‚è½½</p><pre><code>componentDidMount() {}</code></pre><p>å½“Clockç”Ÿæˆçš„è¿™ä¸ªDOMè¢«ç§»é™¤æ—¶ï¼Œæ¸…é™¤å®šæ—¶å™¨ï¼Œå¸è½½</p><pre><code>componentWillUnmount() {}</code></pre><p>ä¸€ä¸ªå®Œæ•´çš„Clockçš„ä¾‹å­ï¼š </p><pre><code>class Clock extends React.Component {    constructor(props) {        super(props);        this.state = {date: new Date()};    }    // 3. Called when Clock&#39;s output is injected into DOM     componentDidMount() {        this.timerID = setInterval(            () =&gt; this.tick(),                1000        );    }    componentWillUnmount() {        clearInterval(this.timerID);    }    // 4. when setState() is being called, render() is called     tick() {        this.setState({            date: new Date()        });    }    // 2. Call render(), react know what need to be shown on screen. Update DOM     render() {        return (          &lt;div&gt;            &lt;h1&gt;Hello, world!&lt;/h1&gt;            &lt;h2&gt;It is {this.state.date.toLocaleTimeString()}.&lt;/h2&gt;          &lt;/div&gt;        );    }}ReactDOM.render(// 1. call Clock&#39;s constructor  &lt;Clock /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h2 id="5-4-å¦‚ä½•ä½¿ç”¨çŠ¶æ€"><a href="#5-4-å¦‚ä½•ä½¿ç”¨çŠ¶æ€" class="headerlink" title="5.4 å¦‚ä½•ä½¿ç”¨çŠ¶æ€"></a>5.4 å¦‚ä½•ä½¿ç”¨çŠ¶æ€</h2><ol><li><p>ä¸è¦ç›´æ¥æ›´æ–°çŠ¶æ€</p><p> use: this.setState({comment: â€˜hiâ€™});</p></li></ol><blockquote><p>æ„é€ å‡½æ•°æ˜¯å”¯ä¸€èƒ½å¤Ÿåˆå§‹åŒ–this.stateçš„åœ°æ–¹</p></blockquote><ol start="2"><li>çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„</li></ol><p>Reactå¯ä»¥å°†å¤šä¸ª<code>setState()</code>è°ƒç”¨åˆå¹¶æˆä¸€ä¸ªæ¥æé«˜æ€§èƒ½</p><pre><code>// Wrongthis.setState({  counter: this.state.counter + this.props.increment,});// Correctthis.setState((prevState, props) =&gt; ({  counter: prevState.counter + props.increment}));// Correctthis.setState(function(prevState, props) {  return {    counter: prevState.counter + props.increment  };});</code></pre><ol start="3"><li>å½“è°ƒç”¨<code>setState()</code>çš„æ—¶å€™ï¼ŒReactä¼šå°†ä½ æä¾›çš„å¯¹è±¡åˆå¹¶åˆ°å½“å‰çŠ¶æ€ã€‚å¯ä»¥åªæä¾›stateçš„ä¸€éƒ¨åˆ†ã€‚</li></ol><h2 id="5-5-æ•°æ®æµåŠ¨æ–¹å‘ï¼š-è‡ªé¡¶å‘ä¸‹"><a href="#5-5-æ•°æ®æµåŠ¨æ–¹å‘ï¼š-è‡ªé¡¶å‘ä¸‹" class="headerlink" title="5.5 æ•°æ®æµåŠ¨æ–¹å‘ï¼š è‡ªé¡¶å‘ä¸‹"></a>5.5 æ•°æ®æµåŠ¨æ–¹å‘ï¼š è‡ªé¡¶å‘ä¸‹</h2><p>çˆ¶ç»„ä»¶æˆ–å­ç»„ä»¶éƒ½ä¸çŸ¥é“æŸä¸ªç»„ä»¶æ˜¯å¦æœ‰çŠ¶æ€ï¼Œç»„ä»¶å¯ä»¥é€‰æ‹©å°†å…¶çŠ¶æ€ä½œä¸ºå±æ€§ä¼ é€’ç»™å…¶å­ç»„ä»¶ã€‚</p><h1 id="6-äº‹ä»¶å¤„ç†"><a href="#6-äº‹ä»¶å¤„ç†" class="headerlink" title="6. äº‹ä»¶å¤„ç†"></a>6. äº‹ä»¶å¤„ç†</h1><p>Reactäº‹ä»¶ç»‘å®šå±æ€§çš„å‘½åé‡‡ç”¨é©¼å³°å¼å†™æ³•</p><p>é‡‡ç”¨jsxçš„è¯­æ³•ä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><pre><code>&lt;button onClick={activateLasers}&gt;    Activate Lasers&lt;/button&gt;</code></pre><h2 id="6-1-Toggle"><a href="#6-1-Toggle" class="headerlink" title="6.1 Toggle"></a>6.1 Toggle</h2><pre><code>class Toggle extends React.Component {    constructor(props) {    super(props);    this.state = {isToggleOn: true};    // This binding is necessary to make `this` work in the callback    this.handleClick = this.handleClick.bind(this);    }    handleClick() {        this.setState(prevState =&gt; ({            isToggleOn: !prevState.isToggleOn        }));    }    render() {        return (        // &lt;button onClick={(e) =&gt; this.handleClick(e)}&gt;         // é—®é¢˜Læ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¸åŒçš„å›è°ƒå‡½æ•°            &lt;button onClick={this.handleClick}&gt;                {this.state.isToggleOn ? &#39;ON&#39; : &#39;OFF&#39;}            &lt;/button&gt;        );    }}ReactDOM.render(    &lt;Toggle /&gt;,    document.getElementById(&#39;root&#39;));</code></pre><p>å¿…é¡»è°¨æ…å¯¹å¾…JSXå›è°ƒå‡½æ•°ä¸­çš„thisï¼Œç±»çš„æ–¹æ³•é»˜è®¤ä¸ä¼šç»‘å®šthisçš„ã€‚å¦‚æœä½ å¿˜è®°ç»‘å®š <code>this.handleClick</code> å¹¶æŠŠå®ƒä¼ å…¥ <code>onClick</code>, å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ <code>this</code> çš„å€¼ä¼šæ˜¯ <code>undefined</code>ã€‚</p><h2 id="6-2-Todolist"><a href="#6-2-Todolist" class="headerlink" title="6.2 Todolist"></a>6.2 Todolist</h2><pre><code>class TodoApp extends React.Component {    constructor(props) {        super(props);        this.state = { items: [], text: &#39;&#39; };        this.handleChange = this.handleChange.bind(this);        this.handleSubmit = this.handleSubmit.bind(this);    }    render() {        return (            &lt;div&gt;                &lt;h3&gt;TODO&lt;/h3&gt;                &lt;TodoList items={this.state.items} /&gt;                &lt;form onSubmit={this.handleSubmit}&gt;                  &lt;input                    onChange={this.handleChange}                    value={this.state.text}                  /&gt;                  &lt;button&gt;                    Add #{this.state.items.length + 1}                  &lt;/button&gt;                &lt;/form&gt;            &lt;/div&gt;        );    }    handleChange(e) {        this.setState({ text: e.target.value });    }    handleSubmit(e) {        e.preventDefault();        if (!this.state.text.length) {            return;        }        const newItem = {            text: this.state.text,            id: Date.now()        };        this.setState(prevState =&gt; ({            items: prevState.items.concat(newItem),            text: &#39;&#39;        }));    }}class TodoList extends React.Component {    render() {        return (            &lt;ul&gt;                {this.props.items.map(item =&gt; (                  &lt;li key={item.id}&gt;{item.text}&lt;/li&gt;                ))}            &lt;/ul&gt;        );    }}ReactDOM.render(&lt;TodoApp /&gt;, mountNode);</code></pre><h2 id="6-3-å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°"><a href="#6-3-å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°" class="headerlink" title="6.3 å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°"></a>6.3 å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°</h2><pre><code>&lt;button onClick={(e) =&gt; this.deleteRow(id, e)}&gt;Delete Row&lt;/button&gt;&lt;button onClick={this.deleteRow.bind(this, id)}&gt;Delete Row&lt;/button&gt;</code></pre><p>å‚æ•° e ä½œä¸º React äº‹ä»¶å¯¹è±¡å°†ä¼šè¢«ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œä¼ é€’ã€‚é€šè¿‡ç®­å¤´å‡½æ•°çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡å¿…é¡»æ˜¾å¼çš„è¿›è¡Œä¼ é€’ï¼Œä½†æ˜¯é€šè¿‡ bind çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡ä»¥åŠæ›´å¤šçš„å‚æ•°å°†ä¼šè¢«éšå¼çš„è¿›è¡Œä¼ é€’ã€‚</p><h2 id="6-4-bind-å‘ç›‘å¬å‡½æ•°ä¼ å‚ï¼Œ-äº‹ä»¶å¯¹è±¡eéœ€è¦æ”¾åœ¨æœ€å"><a href="#6-4-bind-å‘ç›‘å¬å‡½æ•°ä¼ å‚ï¼Œ-äº‹ä»¶å¯¹è±¡eéœ€è¦æ”¾åœ¨æœ€å" class="headerlink" title="6.4 bind å‘ç›‘å¬å‡½æ•°ä¼ å‚ï¼Œ äº‹ä»¶å¯¹è±¡eéœ€è¦æ”¾åœ¨æœ€å"></a>6.4 bind å‘ç›‘å¬å‡½æ•°ä¼ å‚ï¼Œ äº‹ä»¶å¯¹è±¡eéœ€è¦æ”¾åœ¨æœ€å</h2><pre><code>class Popper extends React.Component{    constructor(){        super();        this.state = {name:&#39;Hello world!&#39;};    }    preventPop(name, e){    //äº‹ä»¶å¯¹è±¡eè¦æ”¾åœ¨æœ€å        e.preventDefault();        alert(name);    }    render(){        return (            &lt;div&gt;                &lt;p&gt;hello&lt;/p&gt;                {/* Pass params via bind() method. */}                &lt;a href=&quot;https://reactjs.org&quot; onClick={this.preventPop.bind(this,this.state.name)}&gt;Click&lt;/a&gt;            &lt;/div&gt;        );    }}</code></pre><h1 id="7-æ¡ä»¶æ¸²æŸ“"><a href="#7-æ¡ä»¶æ¸²æŸ“" class="headerlink" title="7. æ¡ä»¶æ¸²æŸ“"></a>7. æ¡ä»¶æ¸²æŸ“</h1><p>å¯ä»¥åˆ›å»ºä¸åŒçš„ç»„ä»¶æ¥å°è£…å„ç§ä½ éœ€è¦çš„è¡Œä¸ºã€‚ç„¶åæ ¹æ®åº”ç”¨çš„çŠ¶æ€å˜åŒ–åªæ¸²æŸ“å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚(if)</p><pre><code>function Greeting(props) {    const isLoggedIn = props.isLoggedIn;    if (isLoggedIn) {        return &lt;UserGreeting /&gt;;    }    return &lt;GuestGreeting /&gt;;}ReactDOM.render(  // Try changing to isLoggedIn={true}:  &lt;Greeting isLoggedIn={false} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h2 id="7-1-ä¸è¿ç®—ç¬¦-amp-amp"><a href="#7-1-ä¸è¿ç®—ç¬¦-amp-amp" class="headerlink" title="7.1 ä¸è¿ç®—ç¬¦ &amp;&amp;"></a>7.1 ä¸è¿ç®—ç¬¦ &amp;&amp;</h2><pre><code>function Mailbox(props) {    const unreadMessages = props.unreadMessages;    return (        &lt;div&gt;          &lt;h1&gt;Hello!&lt;/h1&gt;          {unreadMessages.length &gt; 0 &amp;&amp;            &lt;h2&gt;              You have {unreadMessages.length} unread messages.            &lt;/h2&gt;          }        &lt;/div&gt;    );}const messages = [&#39;React&#39;, &#39;Re: React&#39;, &#39;Re:Re: React&#39;];ReactDOM.render(  &lt;Mailbox unreadMessages={messages} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><p><strong>åœ¨ JavaScript ä¸­ï¼Œtrue &amp;&amp; expression æ€»æ˜¯è¿”å› expressionï¼Œè€Œ false &amp;&amp; expression æ€»æ˜¯è¿”å› falseã€‚</strong></p><h2 id="7-2-é˜»æ­¢ç»„ä»¶æ¸²æŸ“"><a href="#7-2-é˜»æ­¢ç»„ä»¶æ¸²æŸ“" class="headerlink" title="7.2 é˜»æ­¢ç»„ä»¶æ¸²æŸ“"></a>7.2 é˜»æ­¢ç»„ä»¶æ¸²æŸ“</h2><pre><code>function WarningBanner(props) {    if (!props.warn) {        return null;    }    return (        &lt;div className=&quot;warning&quot;&gt;            Warning!        &lt;/div&gt;    );}class Page extends React.Component {    constructor(props) {        super(props);        this.state = {showWarning: true}        this.handleToggleClick = this.handleToggleClick.bind(this);    }    handleToggleClick() {        this.setState(prevState =&gt; ({            showWarning: !prevState.showWarning        }));    }    render() {        return (            &lt;div&gt;                &lt;WarningBanner warn={this.state.showWarning} /&gt;                &lt;button onClick={this.handleToggleClick}&gt;                {this.state.showWarning ? &#39;Hide&#39; : &#39;Show&#39;}                &lt;/button&gt;            &lt;/div&gt;        );    }}ReactDOM.render(  &lt;Page /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h1 id="8-åˆ—è¡¨-amp-Keys"><a href="#8-åˆ—è¡¨-amp-Keys" class="headerlink" title="8. åˆ—è¡¨ &amp; Keys"></a>8. åˆ—è¡¨ &amp; Keys</h1><h2 id="8-1-æ¸²æŸ“å¤šä¸ªç»„ä»¶"><a href="#8-1-æ¸²æŸ“å¤šä¸ªç»„ä»¶" class="headerlink" title="8.1 æ¸²æŸ“å¤šä¸ªç»„ä»¶"></a>8.1 æ¸²æŸ“å¤šä¸ªç»„ä»¶</h2><pre><code>const numbers = [1, 2, 3, 4, 5];const listItems = numbers.map(    (number) =&gt; &lt;li&gt;{number}&lt;/li&gt;);ReactDOM.render(    &lt;ul&gt;{listItems}&lt;/ul&gt;    documnet.getElementById(&#39;root&#39;));</code></pre><h2 id="8-2-åŸºç¡€åˆ—è¡¨ç»„ä»¶"><a href="#8-2-åŸºç¡€åˆ—è¡¨ç»„ä»¶" class="headerlink" title="8.2 åŸºç¡€åˆ—è¡¨ç»„ä»¶"></a>8.2 åŸºç¡€åˆ—è¡¨ç»„ä»¶</h2><pre><code>function NumberList(props) {    const numbers = props.numbers;    const listItems = numbers.map((number) =&gt;        &lt;li key={number.toString()}&gt;            {number}        &lt;/li&gt;    );    return (        &lt;ul&gt;{listItems}&lt;/ul&gt;    );}const numbers = [1, 2, 3, 4, 5];ReactDOM.render(  &lt;NumberList numbers={numbers} /&gt;,  document.getElementById(&#39;root&#39;));</code></pre><h2 id="8-3-Keys"><a href="#8-3-Keys" class="headerlink" title="8.3 Keys"></a>8.3 Keys</h2><p>Keyså¯ä»¥åœ¨DOMä¸­çš„æŸäº›å…ƒç´ è¢«å¢åŠ æˆ–åˆ é™¤çš„æ—¶å€™å¸®åŠ©Reactè¯†åˆ«å“ªäº›å…ƒç´ å‘ç”Ÿäº†å˜åŒ–ã€‚æœ€å¥½æ˜¯è¯¥å…ƒç´ åœ¨åˆ—è¡¨ä¸­æ‹¥æœ‰çš„ç‹¬ä¸€æ— äºŒçš„å­—ç¬¦ä¸²ã€‚ä½¿ç”¨æ¥è‡ªæ•°æ®çš„idä½œä¸ºå…ƒç´ çš„key</p><p>å…ƒç´ çš„keyåªæœ‰åœ¨å®ƒå’Œå®ƒçš„å…„å¼ŸèŠ‚ç‚¹å¯¹æ¯”æ—¶æ‰æœ‰æ„ä¹‰ã€‚</p><h1 id="9-è¡¨å•"><a href="#9-è¡¨å•" class="headerlink" title="9.è¡¨å•"></a>9.è¡¨å•</h1><p>HTML è¡¨å•å…ƒç´ ä¸Reactä¸­å…¶ä»–DOMå…ƒç´ æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºè¡¨å•å…ƒç´ æœ¬æ¥å°±ä¿ç•™ä¸€äº›å†…éƒ¨çŠ¶æ€äº†ã€‚ä¼šæ„é€ ä¸€ä¸ªå¤„ç†æäº¤è¡¨å•å¹¶å¯è®¿é—®ç”¨æˆ·è¾“å…¥è¡¨å•æ•°æ®çš„å‡½æ•°ã€‚æ ‡å‡†æ–¹æ³•æ˜¯ä½¿ç”¨å—æ§ç»„ä»¶ã€‚</p><h2 id="9-1-å—æ§ç»„ä»¶"><a href="#9-1-å—æ§ç»„ä»¶" class="headerlink" title="9.1 å—æ§ç»„ä»¶"></a>9.1 å—æ§ç»„ä»¶</h2><p>åœ¨HTMLå½“ä¸­ï¼Œåƒ<code>&lt;input&gt;,&lt;textarea&gt;, å’Œ &lt;select&gt;</code>è¿™ç±»è¡¨å•å…ƒç´ ä¼šç»´æŒè‡ªèº«çŠ¶æ€ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œæ›´æ–°ã€‚ä½†åœ¨Reactä¸­ï¼Œå¯å˜çš„çŠ¶æ€é€šå¸¸ä¿å­˜åœ¨ç»„ä»¶çš„çŠ¶æ€å±æ€§ä¸­ï¼Œå¹¶ä¸”åªèƒ½ç”¨ setState() æ–¹æ³•è¿›è¡Œæ›´æ–°ã€‚</p><pre><code>class NameForm extends React.Component {    constructor(props) {        super(props);        this.state = {value: &#39;&#39;};        this.handleChange = this.handleChange.bind(this);        this.handleSubmit = this.handleSubmit.bind(this);    }    handleChange(event) {        this.setState({value: event.target.value});    }    handleSubmit(event) {        alert(&#39;A name was submitted: &#39; + this.state.value);        event.preventDefault();    }    render() {        return (            &lt;form onSubmit={this.handleSubmit}&gt;                &lt;label&gt;                  Name:                  &lt;input type=&quot;text&quot; value={this.state.value} onChange={this.handleChange} /&gt;                &lt;/label&gt;                &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;            &lt;/form&gt;        );    }}</code></pre><h2 id="9-2-textareaæ ‡ç­¾"><a href="#9-2-textareaæ ‡ç­¾" class="headerlink" title="9.2 textareaæ ‡ç­¾"></a>9.2 textareaæ ‡ç­¾</h2><pre><code>class EssayForm extends React.Component {    constructor(props) {        super(props);        this.state = {          value: &#39;Please write an essay about your favorite DOM element.&#39;        };        this.handleChange = this.handleChange.bind(this);        this.handleSubmit = this.handleSubmit.bind(this);    }    handleChange(event) {        this.setState({value: event.target.value});    }    handleSubmit(event) {        alert(&#39;An essay was submitted: &#39; + this.state.value);        event.preventDefault();    }    render() {        return (            &lt;form onSubmit={this.handleSubmit}&gt;                &lt;label&gt;                Name:                &lt;textarea value={this.state.value} onChange={this.handleChange} /&gt;                &lt;/label&gt;                &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;            &lt;/form&gt;        );    }}</code></pre><h2 id="9-3-selectæ ‡ç­¾"><a href="#9-3-selectæ ‡ç­¾" class="headerlink" title="9.3 selectæ ‡ç­¾"></a>9.3 selectæ ‡ç­¾</h2><p>Reactä¸­ï¼Œä¸é€‚ç”¨selectedå±æ€§è¡¨æ˜é€‰ä¸­é¡¹ï¼Œè€Œæ˜¯åœ¨æ ¹selectæ ‡ç­¾ä¸Šç”¨valueå±æ€§æ¥è¡¨ç¤ºé€‰ä¸­é¡¹ã€‚è¿™åœ¨å—æ§ç»„ä»¶ä¸­æ›´æ–¹ä¾¿ï¼Œå› ä¸ºåªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æ›´æ–°ç»„ä»¶ã€‚</p><pre><code>class FlavorForm extends React.Component {    constructor(props) {    super(props);    this.state = {value: &#39;coconut&#39;};    this.handleChange = this.handleChange.bind(this);    this.handleSubmit = this.handleSubmit.bind(this);}handleChange(event) {    this.setState({value: event.target.value});}handleSubmit(event) {    alert(&#39;Your favorite flavor is: &#39; + this.state.value);    event.preventDefault();}    render() {        return (            &lt;form onSubmit={this.handleSubmit}&gt;                &lt;label&gt;                    Pick your favorite La Croix flavor:                    &lt;select value={this.state.value} onChange={this.handleChange}&gt;                    &lt;option value=&quot;grapefruit&quot;&gt;Grapefruit&lt;/option&gt;                    &lt;option value=&quot;lime&quot;&gt;Lime&lt;/option&gt;                    &lt;option value=&quot;coconut&quot;&gt;Coconut&lt;/option&gt;                    &lt;option value=&quot;mango&quot;&gt;Mango&lt;/option&gt;                    &lt;/select&gt;                &lt;/label&gt;                &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;            &lt;/form&gt;        );    }}</code></pre><h2 id="9-4-å¤šä¸ªè¾“å…¥çš„è§£å†³æ–¹æ³•"><a href="#9-4-å¤šä¸ªè¾“å…¥çš„è§£å†³æ–¹æ³•" class="headerlink" title="9.4 å¤šä¸ªè¾“å…¥çš„è§£å†³æ–¹æ³•"></a>9.4 å¤šä¸ªè¾“å…¥çš„è§£å†³æ–¹æ³•</h2><p>é€šè¿‡ç»™æ¯ä¸ªå…ƒç´ æ·»åŠ ä¸€ä¸ªnameå±æ€§ï¼Œæ¥è®©å¤„ç†å‡½æ•°æ ¹æ®event.target.nameçš„å€¼æ¥é€‰æ‹©åšä»€ä¹ˆ</p><pre><code>class Reservation extends React.Component {    constructor(props) {        super(props);        this.state = {            isGoing: true,            numberOfGuests: 2        };        this.handleInputChange = this.handleInputChange.bind(this);    }    handleInputChange(event) {        const target = event.target;        const value = target.type === &#39;checkbox&#39; ? target.checked : target.value;        const name = target.name;        this.setState({            [name]: value        });    }    render() {        return (            &lt;form&gt;                &lt;label&gt;                    Is going:                    &lt;input                        name=&quot;isGoing&quot;                        type=&quot;checkbox&quot;                        checked={this.state.isGoing}                        onChange={this.handleInputChange} /&gt;                &lt;/label&gt;                &lt;br /&gt;                &lt;label&gt;                    Number of guests:                    &lt;input                        name=&quot;numberOfGuests&quot;                        type=&quot;number&quot;                        value={this.state.numberOfGuests}                        onChange={this.handleInputChange} /&gt;                &lt;/label&gt;            &lt;/form&gt;        );    }}</code></pre><h1 id="10-çŠ¶æ€æå‡"><a href="#10-çŠ¶æ€æå‡" class="headerlink" title="10. çŠ¶æ€æå‡"></a>10. çŠ¶æ€æå‡</h1><h2 id="10-1-æ‘„æ°åº¦åæ°åº¦çš„ä¾‹å­"><a href="#10-1-æ‘„æ°åº¦åæ°åº¦çš„ä¾‹å­" class="headerlink" title="10.1 æ‘„æ°åº¦åæ°åº¦çš„ä¾‹å­"></a>10.1 æ‘„æ°åº¦åæ°åº¦çš„ä¾‹å­</h2><p>çŠ¶æ€åˆ†äº«æ˜¯é€šè¿‡å°†stateæ•°æ®æå‡è‡³ç¦»éœ€è¦è¿™äº›æ•°æ®çš„ç»„ä»¶æœ€è¿‘çš„çˆ¶ç»„ä»¶æ¥å®Œæˆçš„</p><pre><code>class Calculator extends React.Component {    constructor(props) {        super(props);        this.handleCelsiusChange = this.handleCelsiusChange.bind(this);        this.handleFahrenheitChange = this.handleFahrenheitChange.bind(this);        this.state = {temperature: &#39;&#39;, scale: &#39;c&#39;};    }    handleCelsiusChange(temperature) {        this.setState({scale: &#39;c&#39;, temperature});    }    handleFahrenheitChange(temperature) {        this.setState({scale: &#39;f&#39;, temperature});    }    render() {        const scale = this.state.scale;        const temperature = this.state.temperature;        const celsius = scale === &#39;f&#39; ? tryConvert(temperature, toCelsius) : temperature;        const fahrenheit = scale === &#39;c&#39; ? tryConvert(temperature, toFahrenheit) : temperature;        return (          &lt;div&gt;            &lt;TemperatureInput              scale=&quot;c&quot;              temperature={celsius}              onTemperatureChange={this.handleCelsiusChange} /&gt;            &lt;TemperatureInput              scale=&quot;f&quot;              temperature={fahrenheit}              onTemperatureChange={this.handleFahrenheitChange} /&gt;            &lt;BoilingVerdict              celsius={parseFloat(celsius)} /&gt;          &lt;/div&gt;        );    }}</code></pre>]]></content>
      
      
      <categories>
          
          <category> FrontEnd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FrontEnd </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒæˆ˜æ—¶é—´çº¿</title>
      <link href="/%E4%BA%8C%E6%88%98%E6%97%B6%E9%97%B4%E7%BA%BF/"/>
      <url>/%E4%BA%8C%E6%88%98%E6%97%B6%E9%97%B4%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<!--toc--><blockquote><p>å¯¹äºŒæˆ˜å¾ˆæ„Ÿå…´è¶£ï¼Œä¾æ—§åœ¨ä¸æ–­äº†è§£ä¸­ã€‚æœªäº†è§£å‰å®Œå…¨æ²¡æƒ³åˆ°åœ¨ä¸åˆ°80å¹´å‰ï¼Œæˆ‘ä»¬è¿™ä¸ªä¸–ç•Œå› ä¸ºæˆ˜äº‰åœ¨çŸ­çŸ­åå¤šå¹´é—´æ­»å»äº†7000ä¸‡äººã€‚ä¸­é—´æœ‰å¤ªå¤šçš„æ³¯ç­äººæ€§ï¼Œäº¦æœ‰å¾ˆå¤šäººæ€§çš„å…‰è¾‰ã€‚ä¸çŸ¥é“åˆ—å®æ ¼å‹’ï¼Œå¦‚ä»Šçš„åœ£å½¼å¾—å ¡çš„å±…æ°‘ï¼Œåœ¨ä¸¤å¹´åŠçš„è¢«å›´åŸä¸­æ˜¯å¦‚ä½•æ´»ä¸‹æ¥çš„ï¼Œæ¯ä¸ªäººï¼Œéƒ½çœŸçš„æ˜¯æŒºç›´äº†è…°èƒŒï¼Œè¿™ä¸€åˆ»ï¼Œå°Šä¸¥æ¯”å‘½é‡è¦ã€‚æœ‰å¤ªå¤šçš„ç»†èŠ‚å¯ä»¥æ¢å¯»ï¼Œä¹Ÿæœ‰å¾ˆå¤šå¾®å¦™çš„èŠ‚ç‚¹ï¼Œå¥½å¤šæ¬¡ç›Ÿå†›çš„èƒœåˆ©æ˜¯å› ä¸ºä¸€äº›ä¸æœŸè€Œé‡çš„å˜åŒ–ï¼Œå°äººç‰©çš„é€‰æ‹©ï¼Œå¤©æ°”çš„çªç„¶æ”¾æ™´ã€‚æ¯æ¯è¯»åˆ°è¿™ç§æ—¶å€™ï¼Œå¿ƒé‡Œæ€»ä¼šé•¿èˆ’ä¸€å£æ°”ï¼Œåº†å¹¸å•Šã€‚ï¼ˆPS: æœ‰éƒ¨ç¾å‰§ï¼Œå°±ç‰¹åœ°å¼€äº†è„‘æ´ï¼Œè®²äºŒæˆ˜è½´å¿ƒå›½èƒœåˆ©ä»¥åçš„ä¸–ç•Œçš„æ ·å­â€¦ ä¸€ä¸ªçœŸçš„æ•¢æ‹ï¼Œä¸€ä¸ªçœŸçš„æ•¢æ’­ï¼Œhhh ï¼‰Anywayï¼Œé“­è®°å†å²~ </p></blockquote><h1 id="æ—¶é—´çº¿ï¼ˆæ¬§æ´²æˆ˜åœº-and-å¤ªå¹³æ´‹æˆ˜åœºï¼‰"><a href="#æ—¶é—´çº¿ï¼ˆæ¬§æ´²æˆ˜åœº-and-å¤ªå¹³æ´‹æˆ˜åœºï¼‰" class="headerlink" title="æ—¶é—´çº¿ï¼ˆæ¬§æ´²æˆ˜åœº and å¤ªå¹³æ´‹æˆ˜åœºï¼‰"></a>æ—¶é—´çº¿ï¼ˆæ¬§æ´²æˆ˜åœº and å¤ªå¹³æ´‹æˆ˜åœºï¼‰</h1><p>äºŒæˆ˜æ•´ä¸ªè¿‡ç¨‹ï¼Œå¾·å›½ä¸œå¾æ³¢å…°ï¼ŒåŒ—ä¼åŒ—æ¬§ã€è¥¿åæ³•å›½ã€å—å¹¶å·´å°”å¹²ï¼Œåœ¨æ¬§æ´²å¤§é™†ä¸Šå¤§æ€å››æ–¹ï¼Œæ— äººå¯æŒ¡ã€‚ä½†åˆ°äº†ç¬¬äºŒé˜¶æ®µï¼Œè‹è”ä»¥å¼ºå¤§çš„åŠ›é‡é˜»éäº†å¾·å›½çš„é—ªç”µæ”»åŠ¿ï¼Œè€Œå¹´åº•æ—¥æœ¬å¯¹ç¾å›½çš„å·è¢­æ›´å°†å¯æ€•çš„æ•Œäººæ‹‰å…¥äº†æˆ˜äº‰ã€‚åœ¨ç¬¬ä¸‰é˜¶æ®µï¼ŒåŒç›Ÿå›½åœ¨å¤ªå¹³æ´‹æˆ˜åœºã€åŒ—éæˆ˜åœºã€ä¸œçº¿æˆ˜åœºç›¸ç»§èµ¢å¾—è½¬æŠ˜ç‚¹æ€§è´¨çš„èƒœåˆ©ã€‚åœ¨ç¬¬å››é˜¶æ®µï¼Œæ‰«æ¸…äº†åŒ—éçš„ç›Ÿå†›å¼€å§‹è¿›æ”»è¥¿æ¬§å¤§é™†ï¼Œè‹è”åœ¨ä¸œé¢çš„æˆ˜åœºå¤§ä¸¾åæ”»ã€‚åˆ°ç¬¬äº”é˜¶æ®µï¼Œè½´å¿ƒå›½å´©æºƒï¼Œå¾·å›½ã€æ—¥æœ¬ç›¸ç»§æŠ•é™ï¼ˆæ„å¤§åˆ©æ—©åœ¨ä¸Šä¸€é˜¶æ®µå°±å·²æŠ•é™ï¼‰ï¼Œæˆ˜äº‰ç»“æŸã€‚</p><h2 id="1939-1940"><a href="#1939-1940" class="headerlink" title="1939 - 1940"></a>1939 - 1940</h2><ul><li>1939.9 </li></ul><p>å¾·å›½è¿›æ”»æ³¢å…°ï¼Œé—ªç”µæˆ˜ï¼Œæ³¢å…°è¿…é€Ÿå´©æºƒã€‚æ³¢å…°ç›Ÿå‹è‹±æ³•å‘å¾·å›½å®£æˆ˜ï¼Œå´æ²¡æœ‰é‡‡å–å¤§è§„æ¨¡è¡ŒåŠ¨ï¼Œå½¢æˆäº†è¥¿çº¿æ— æˆ˜äº‹çš„å¥‡æ€ªçš„æˆ˜äº‰ã€‚ä¸å¾·å›½ç­¾è®¢æœ‰ã€Šå¾·è‹äº’ä¸ä¾µçŠ¯æ¡çº¦ã€‹çš„è‹è”æ›´æ˜¯è¶æœºä»ä¸œé¢å…¥ä¾µäº†æ³¢å…°ï¼Œä¸€ä¸ªæœˆï¼Œæˆ˜äº‰ç»“æŸï¼Œæ³¢å…°è¢«å¾·è‹ä¸¤å›½ç“œåˆ†ã€‚</p><ul><li>1940.11</li></ul><p>è‹è”å…¥ä¾µèŠ¬å…°ï¼Œåœ¨èŠ¬å…°äººçš„æŠµæŠ—ä¸‹ï¼Œè‹è”æŸå¤±æƒ¨é‡ã€‚ä¸¤æ–¹é¢åŸå› ï¼ŒèŠ¬å…°äººè‹±å‹‡æŠµæŠ—ï¼Œè‹è”åœ¨å¤§æ¸…æ´—ä¸­æ´—æ‰äº†å¤§é‡çš„ä¼˜ç§€å†›å®˜ã€‚æœ€ç»ˆè‹è”æƒ¨èƒœï¼Œç­¾è®¢ã€Šè«æ–¯ç§‘å’Œå¹³åå®šã€‹ã€‚</p><ul><li>1940.5 </li></ul><p>å¾·å›½å¾·å›½å…µé”‹è¥¿æŒ‡ï¼Œå‡ å¤©å†…å°±æ”»é™·äº†è·å…°å’Œæ¯”åˆ©æ—¶ï¼Œé©»å®ˆåœ¨<strong><em>é©¬å…¶è¯ºé˜²çº¿</em></strong>åŒ—ä¾§çš„è‹±å†›ã€æ³•å†›åŒ—ä¸Šè¿å‡»ï¼Œè¿™è½å…¥äº†æ›¼æ–½å¦å› çš„åœˆå¥—ï¼Œå¾·å†›å‡ºå…¶ä¸æ„åœ°ä»<strong>é˜¿ç™»å±±åŒº</strong>çªå…¥ï¼Œâ€œé—ªå‡»æˆ˜ä¹‹çˆ¶â€å¤å¾·é‡Œå®‰ç‡é¢†å¦å…‹éƒ¨é˜Ÿæœæ–­å‰è¿›ï¼Œåˆ‡å…¥åˆ°ç›Ÿå†›ä¾§èƒŒï¼Œå½¢æˆå›´æ­¼ä¹‹åŠ¿ã€‚ç›Ÿå†›è¢«è¿«åœ¨æ•¦åˆ»å°”å…‹ä¹˜è‹±å›½çš„å¤§å°èˆ¹åªæ’¤é€€åˆ°è‹±å›½ï¼Œè¿™å°±æ˜¯ä»£å·ä¸ºâ€œå‘ç”µæœºè¡ŒåŠ¨â€çš„æ•¦åˆ»å°”å…‹å¤§æ’¤é€€ã€‚æ— åŠ›æŠµæŠ—çš„æ³•å›½åœ¨å¾·å†›çš„ç»§ç»­è¿›æ”»ä¸‹è¢«è¿«æŠ•é™ï¼Œä¸€éƒ¨åˆ†å›½åœŸè¢«å¾·å›½å’Œæ„å¤§åˆ©å é¢†ï¼Œå¦ä¸€éƒ¨åˆ†å›½åœŸåˆ™ç”±è´å½“çš„â€œç»´å¸Œæ³•å›½â€ç®¡ç†ã€‚æˆ´é«˜ä¹åœ¨ä¼¦æ•¦å‘è¡¨æ¼”è¯´ï¼Œä¸æ‰¿è®¤ç»´å¸Œæ³•å›½çš„åˆæ³•æ€§ï¼Œç»„ç»‡è‡ªç”±æ³•å›½ç»§ç»­æŠ—äº‰ã€‚å‡ ä¹ä¸æ­¤åŒæ—¶ï¼Œè‹è”åå¹¶äº†ä½äºæ³¢ç½—çš„æµ·çš„ä¸‰ä¸ªå›½å®¶â€”â€”çˆ±æ²™å°¼äºšã€æ‹‰è„±ç»´äºšå’Œç«‹é™¶å®›ã€‚</p><ul><li>1940.8</li></ul><p>æ”»å æ³•å›½åï¼Œå¸Œç‰¹å‹’å¼€å§‹ç€çœ¼äºè‹±å›½ï¼Œåˆ¶å®šäº†â€œæµ·ç‹®è®¡åˆ’â€å‡†å¤‡ç™»é™†è‹±å›½ã€‚ä¸ºäº†äº‰å¤ºç™»é™†ä½œæˆ˜çš„åˆ¶ç©ºæƒï¼Œå¾·å›½ç©ºå†›ä»8æœˆä»½å¼€å§‹å¯¹è‹±å›½çš„ç©ºä¸­æ”»åŠ¿ï¼Œè‹±å›½å†›æ°‘åœ¨ä¸˜å‰å°”çš„é¢†å¯¼ä¸‹å¥‹å‹‡æŠµæŠ— â€”â€” ä¸åˆ—é¢ ç©ºæˆ˜ã€‚1941å¹´ä¸åˆ—é¢ ç©ºæˆ˜ä¸­ï¼Œè‹±å›½å–å¾—äº†æœ€ç»ˆèƒœåˆ©ã€‚</p><ul><li>1940.9</li></ul><p>åˆ©æ¯”äºšçš„æ„å¤§åˆ©å†›é˜Ÿå…¥ä¾µåŸƒåŠï¼Œè€Œåè¢«è‹±å†›å‡»è´¥å¹¶åœ¨12æœˆåæ¨è‡³åˆ©æ¯”äºšã€‚10æœˆï¼Œæ„å¤§åˆ©å…¥ä¾µå¸Œè…Šï¼Œå´è¿…é€Ÿå¤±è´¥åè€Œè¢«å¸Œè…Šå†›é˜Ÿåæ¨åˆ°é˜¿å°”å·´å°¼äºšã€‚å¾·å›½è¢«è¿«å·å…¥æˆ˜äº‰ï¼Œå…¥ä¾µå—æ–¯æ‹‰å¤«å’Œå¸Œè…Šã€‚ç»è¿‡ä¸€ç³»åˆ—æˆ˜å½¹åï¼Œå·´å°”å¹²åŠå²›ä¸Šçš„æˆ˜äº‰æœ€ç»ˆä»¥è½´å¿ƒå›½çš„èƒœåˆ©ç»“æŸï¼Œæ•´ä¸ªå·´å°”å¹²åŠå²›éƒ½è½å…¥äº†è½´å¿ƒå›½çš„æŒæ§ä¹‹å†…ã€‚å¸Œç‰¹å‹’åœ¨æ¬¡å¹´åˆå°†éš†ç¾å°”æ´¾å¾€åŒ—éè¥æ•‘æ„å¤§åˆ©ã€‚éš†ç¾å°”å–å¾—äº†ä¸€ç³»åˆ—èƒœåˆ©ï¼Œèµ¢å¾—äº†â€œæ²™æ¼ ä¹‹ç‹â€çš„ç¾èª‰ã€‚è½´å¿ƒå›½åœ¨åœ°ä¸­æµ·ã€åŒ—éæˆ˜åœºå–å¾—äº†ä¸€å®šè¿›å±•ï¼Œä½†å¾·å†›å› æ­¤æ¨è¿Ÿäº†å…¥ä¾µè‹è”çš„æ—¶é—´ï¼Œå¸Œç‰¹å‹’åæ¥ä¸ºä¹‹æ‡Šæ¼ä¸å·²ã€‚</p><h2 id="1941"><a href="#1941" class="headerlink" title="1941"></a>1941</h2><ul><li>1941.6</li></ul><p>å¾·å›½å·´å·´ç½—è¨è¡ŒåŠ¨ï¼Œä¸‰è·¯å¤§å†›å…¥ä¾µè‹è”ã€‚åŒ—æ–¹é›†å›¢å†›ç¾¤æ”»å æ³¢ç½—çš„æµ·ä¸‰å›½ï¼Œä¿å«åˆ—å®æ ¼å‹’ï¼Œåˆ—å®æ ¼å‹’ä¿å«æˆ˜å¼€å§‹ã€‚ä¸­å¤®é›†å›¢å†›æ”»å…‹æ–¯æ‘©æ£±æ–¯å…‹ï¼Œç›´æŒ‡è«æ–¯ç§‘ã€‚å—æ–¹å†›å›¢åœ¨åŸºè¾…å¤§èƒœè‹å†›ï¼Œå®Œæˆäº†å†å²ä¸Šæœ€å¤§è§„æ¨¡çš„æ­¼ç­æˆ˜ã€‚</p><ul><li>1941.7</li></ul><p>è‹±ç¾å†»ç»“æ—¥æœ¬çš„èµ„äº§ï¼Œç¾å›½å¯¹æ—¥æœ¬å®æ–½äº†çŸ³æ²¹ç¦è¿æ”¿ç­–ï¼Œé‡œåº•æŠ½è–ªä¹‹ç­–å•Šã€‚</p><ul><li>1941.12</li></ul><p>æ—¥æœ¬åœ¨å¤ªå¹³æ´‹ä¸Šå¯¹è‹±ç¾å‘èµ·äº†è¿›æ”»ã€‚å±±æœ¬äº”åå…­å·è¢­çç æ¸¯ï¼ˆ12.7ï¼‰ï¼Œç¾å›½ä»å­¤ç«‹ä¸»ä¹‰è½¬å‘å‚æˆ˜ã€‚ç¾å›½æ€»ç»Ÿç½—æ–¯ç¦å¯¹æ—¥æœ¬å®£æˆ˜ï¼ŒåŠå¹´å†…æ—¥å†›ä¾æ—§åœ¨å¤ªå¹³æ´‹æˆ˜åœºå æ®ä¼˜åŠ¿ã€‚å¾·å†›æ½œè‰‡éƒ¨é˜Ÿåœ¨é‚“å°¼èŒ¨çš„æŒ‡æŒ¥ä¸‹ï¼Œè¿ç”¨ç‹¼ç¾¤æˆ˜æœ¯ï¼Œå¯¹ç›Ÿå†›èˆªè¿èˆ¹åªé€ æˆäº†å·¨å¤§çš„ä¼¤å®³ã€‚ </p><h2 id="1942"><a href="#1942" class="headerlink" title="1942"></a>1942</h2><ul><li>1942.5 </li></ul><p>å¤ªå¹³æ´‹çŠç‘šæµ·ï¼Œæ—¥å†›å¯¹æŠ—ç›Ÿå†›èˆªæ¯ï¼Œæ—¥å†›èˆªæ¯ç¥¥å‡¤å·è¢«å‡»æ²‰ï¼Œç¿”é¹¤å·å—åˆ°é‡åˆ›ï¼Œç‘é¹¤å·é£æœºæŸè€—ä¸¥é‡ã€‚ç¾å†›èˆªæ¯åˆ—æ˜Ÿé¡¿å·æ²‰æ²¡ï¼Œçº¦å…‹åŸå·å—ä¼¤ã€‚è¿™æ˜¯æ—¥æœ¬åœ¨å¤ªå¹³æ´‹æˆ˜åœºä¸Šçš„æ‰©å¼ åŠ¿å¤´ç¬¬ä¸€æ¬¡å—åˆ°é˜»éï¼Œç›Ÿå†›ä¿ä½äº†ç¾å›½åˆ°æ¾³å¤§åˆ©äºšé—´çš„äº¤é€šçº¿ã€‚</p><ul><li>1942.6 </li></ul><p>ä¸­é€”å²›æµ·æˆ˜çˆ†å‘ã€‚é…·ç‚«çš„åœˆå¥—å’Œååœˆå¥—ä½œæˆ˜ï¼Œæœ€ç»ˆæ—¥å†›å››è‰˜èˆªæ¯å…¨æ²‰æ²¡äº†ã€‚æ­¤æˆ˜åï¼Œæ—¥å†›åœ¨å¤ªå¹³æ´‹æˆ˜åœºä¸Šçš„ä¼˜åŠ¿ä¸å¤å­˜åœ¨ã€‚</p><ul><li>1942.5-6</li></ul><p>åŒ—éæˆ˜åœºï¼Œâ€œæ²™æ¼ ä¹‹ç‹â€éš†ç¾å°”ç‡é¢†è½´å¿ƒå›½å†›é˜Ÿåœ¨åŠ æŸ¥æ‹‰æˆ˜å½¹ä¸­æˆ˜èƒœäº†å¥¥é‡‘è±å…‹æŒ‡æŒ¥çš„ç›Ÿå†›ï¼Œç›Ÿå†›å‘ä¸œé€€å®ˆé˜¿æ‹‰æ›¼é˜²çº¿ã€‚7æœˆï¼Œéš†ç¾å°”è¿›æ”»é˜¿æ‹‰æ›¼é˜²çº¿ï¼Œå¥¥é‡‘è±å…‹ç‡å†›æŠµæŠ—ï¼Œä¸¤å†›æ‰“æˆäº†æ¶ˆè€—æˆ˜ã€‚8æœˆï¼Œå¥¥é‡‘è±å…‹çš„æŒ‡æŒ¥èŒåŠ¡è¢«è’™å“¥é©¬åˆ©å–ä»£ã€‚10æœˆï¼Œç¬¬äºŒæ¬¡é˜¿æ‹‰æ›¼æˆ˜å½¹æ‰“å“ï¼Œåœ¨æ‹¥æœ‰åˆ¶ç©ºæƒå’Œåå‹¤æ–¹é¢çš„ä¼˜åŠ¿æ¡ä»¶ä¸‹ï¼Œè’™å“¥é©¬åˆ©å‡»è´¥äº†éš†ç¾å°”ï¼Œä¸€è·¯è¿½åˆ°äº†çªå°¼æ–¯ã€‚</p><ul><li>1942.7</li></ul><p>æ–¯å¤§æ—æ ¼å‹’æˆ˜å½¹æ‰“å“ï¼Œå¾·å†›æ”»å…¥äº†æ–¯å¤§æ—æ ¼å‹’ï¼Œä½†æ˜¯ä¸è‹å†›å±•å¼€å··æˆ˜ï¼Œé­åˆ°è‹±å‹‡æŠµæŠ—ã€‚11æœˆï¼Œå¤©ç‹æ˜Ÿè®¡åˆ’ï¼Œå®Œæˆäº†ååŒ…å›´ã€‚å¾·å†›åœ¨æ•´ä¸ªæˆ˜äº‰è¿‡ç¨‹ä¸­ç¬¬ä¸€ä¸ªå¤§è§„æ¨¡å¤±è´¥ï¼Œè¢«ä¿˜90ï¼Œ000ä½™äººã€‚è½¬æŠ˜ç‚¹ï¼Œç›Ÿå†›è¿›å…¥æˆ˜ç•¥åæ”»é˜¶æ®µã€‚</p><h2 id="1943"><a href="#1943" class="headerlink" title="1943"></a>1943</h2><ul><li>1942.11 </li></ul><p>åŒ—éç«ç‚¬è¡ŒåŠ¨ï¼Œåœ¨é˜¿å°”åŠåˆ©äºšå’Œæ‘©æ´›å“¥ç™»é™†åï¼Œå‘çªå°¼æ–¯çš„è½´å¿ƒå›½å†›é˜Ÿè¿›æ”»ã€‚åˆ°1943å¹´5æœˆï¼Œåœ¨å®åŠ›é›„åšçš„ç›Ÿå†›çš„ä¸¤é¢å¤¹å‡»ä¹‹ä¸‹ï¼Œè½´å¿ƒå›½çš„éƒ¨é˜Ÿå®Œå…¨å¤±è´¥ï¼Œé™¤äº†ä¸€éƒ¨åˆ†é€ƒèµ°å¤–ï¼Œå…¨éƒ¨å‘ç›Ÿå†›æŠ•é™ã€‚è‡³æ­¤ç›Ÿå†›å–å¾—äº†åœ¨åŒ—éæˆ˜åœºä¸Šçš„å…¨é¢èƒœåˆ©ï¼Œä»–ä»¬å¯ä»¥æŠŠç›®å…‰æŠ•å‘åœ°ä¸­æµ·å¯¹é¢çš„æ„å¤§åˆ©äº†ã€‚</p><ul><li>1943.7 </li></ul><p>ç›Ÿå†›è¿›æ”»è¥¿è¥¿é‡Œå²›ï¼Œå–å¾—èƒœåˆ©ã€‚</p><p>ä¸œçº¿ï¼Œå¾·å†›å…ƒå¸…æ›¼æ–½å¦å› å¯¹é˜µè‹å†›å…ƒå¸…æœ±å¯å¤«ã€‚æ›¼æ–½å¦å› æƒ³ç”¨é’³å½¢æ”»åŠ¿æ”»å‡»çªå‡ºçš„åº“å°”æ–¯å…‹åœ°åŒºï¼Œå´è¢«æœ±å¯å¤«æŠµæŒ¡ä½ã€‚æˆ˜äº‰å‘å±•æˆäº†å†å²ä¸Šè§„æ¨¡æœ€å¤§çš„å¦å…‹å¤§ä¼šæˆ˜ï¼Œè‹è”äººçš„æŸå¤±æ¯”å¾·å›½æ›´å¤§ï¼Œä½†ä»–ä»¬èƒ½æ‰¿å—è¿™äº›ã€‚æœ€åï¼Œç”±äºç›Ÿå†›åœ¨è¥¿è¥¿é‡Œå²›çš„å…¥ä¾µï¼Œå¸Œç‰¹å‹’æ€¥éœ€ä»ä¸œçº¿æŠ½è°ƒå…µåŠ›ï¼Œæ›¼æ–½å¦å› è¢«è¿«æ’¤é€€ã€‚ä»æ­¤è‹è”äººå¼€å§‹å¤§è§„æ¨¡æ”¶å¤å¤±åœ°ï¼Œå¾·å›½äººèŠ‚èŠ‚è´¥é€€ã€‚</p><ul><li>1943.9</li></ul><p>ç›Ÿå†›å…¥ä¾µæ„å¤§åˆ©æœ¬åœŸï¼Œå¢¨ç´¢é‡Œå°¼ä¸‹å°ï¼Œæ„å¤§åˆ©æ”¿åºœæŠ•é™ã€‚</p><ul><li>1943.11</li></ul><p>å¼€ç½—ä¼šè®® - è‹±ç¾ä¸­</p><p>å¾·é»‘å…°ä¼šè®® - è‹ç¾è‹±  å•†è®¨è¿›æ”»è½´å¿ƒå›½çš„æˆ˜ç•¥å’Œæˆ˜åçš„å®‰æ’</p><h1 id="1944-1945"><a href="#1944-1945" class="headerlink" title="1944 - 1945"></a>1944 - 1945</h1><ul><li>1944.1 </li></ul><p>é•¿è¾¾ä¸¤å¹´å››ä¸ªæœˆçš„åˆ—å®æ ¼å‹’å›´åŸæˆ˜ç»ˆäºç»“æŸäº†ã€‚è‹è”æ³•åŠŸåæ¬¡æ–¯å¤§æ—çªè¿›ã€‚åˆ°å¹´åº•ï¼Œæ”¶å›äº†å…¨éƒ¨é¢†åœŸï¼Œæ›´æ§åˆ¶äº†ä¸œæ¬§å¤§éƒ¨åˆ†å›½å®¶ã€‚</p><ul><li>1944.6</li></ul><p>ç›Ÿå†›éœ¸ç‹è¡ŒåŠ¨ï¼Œè¯ºæ›¼åº•ç™»é™†ï¼Œä¸‰ç™¾ä¸‡å£«å…µæ¨ªæ¸¡è‹±å‰åˆ©æµ·å³¡ã€‚å·´é¡¿å°†å†›ç‡éƒ¨æ¨ªæ‰«æ³•å…°è¥¿ã€‚8æœˆï¼Œæ³•å›½è§£æ”¾ã€‚</p><ul><li>1944.12</li></ul><p>12æœˆï¼Œå¾·å›½è¿›è¡Œæœ€åçš„æŒ£æ‰ï¼Œåœ¨é˜¿ç™»åœ°åŒºå‘ç›Ÿå†›å‘åŠ¨æ”»åŠ¿ï¼Œè«å¾·å°”æˆåŠŸåœ°åœ¨å¸ƒè±å¾·åˆ©çš„é˜²çº¿ä¸Šæ‰“å‡ºäº†ä¸€ä¸ªâ€œçªå‡ºéƒ¨â€ï¼Œæ‰€ä»¥è¿™åœºæˆ˜å½¹è¢«ç§°ä¸ºçªå‡ºéƒ¨æˆ˜å½¹ã€‚å¾·å†›å°†å°è‚¡ç›Ÿå†›åŒ…å›´åœ¨å·´æ–¯æ‰˜å°¼ã€‚åœ¨å®ˆå†›å³å°†å´©æºƒçš„æ—¶å€™ï¼Œå¤©æ°”æ”¾æ™´ï¼Œç›Ÿå†›çš„ç©ºå†›ä¼˜åŠ¿å¾—ä»¥å‘æŒ¥ï¼Œä»–ä»¬å¯¹å¾·å†›è¿›è¡Œäº†çŒ›çƒˆçš„è½°ç‚¸ï¼Œå¹¶å°†ç‰©èµ„ç©ºæŠ•åˆ°å·´æ–¯æ‰˜å°¼ã€‚å·´é¡¿çš„æ´å†›è¿…é€ŸåŒ—ä¸Šï¼Œå¾·å†›å¤§åŠ¿å·²å»ã€‚å¸Œç‰¹å‹’ç»ˆäºåŒæ„äº†è«å¾·å°”çš„æ’¤å†›è¯·æ±‚ï¼Œä»–çš„å­¤æ³¨ä¸€æ·å¤±è´¥äº†ã€‚</p><ul><li>1945.2 </li></ul><p>é›…å°”å¡”ä¼šè®® â€”â€” è‹ç¾è‹±</p><ul><li>1945.4</li></ul><p>æœ±å¯å¤«ç‡é¢†è‹å†›æ”»å æŸæ—ï¼Œå é¢†å›½ä¼šå¤§å¦ï¼Œå¸Œç‰¹å‹’è‡ªæ€ã€‚</p><p>å¤ªå¹³æ´‹æˆ˜åœºï¼Œç›Ÿå†›åœ¨éº¦å…‹é˜¿ç‘Ÿçš„ç‡é¢†ä¸‹ï¼Œç”¨è›™è·³å¼è·ƒå²›æˆ˜æœ¯ã€‚å†²ç»³å²›ä½œæˆ˜ã€‚</p><ul><li>1945.7 </li></ul><p>æ³¢èŒ¨å¦ä¼šè®® â€”â€” è‹ç¾è‹±ï¼Œå•†è®¨æˆ˜åæ¬§æ´²é—®é¢˜åŠå¯¹æ—¥æœ¬ä½œæˆ˜çš„é—®é¢˜</p><ul><li>1945.8 </li></ul><p>å¹¿å²›é•¿å´åŸå­å¼¹</p><p>è‹è”çº¢å†›æ”»è¿›ä¸­å›½ä¸œåŒ—ï¼Œå‡»æºƒå…³ä¸œå†›ã€‚</p><p>æ—¥æœ¬å®£å¸ƒæ¥æ”¶ã€Šæ³¢èŒ¨å¦å…¬å‘Šã€‹å…¬å‘Šï¼Œæ— æ¡ä»¶æŠ•é™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> history </tag>
            
            <tag> world war </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯»æ‡‚è´¢æŠ¥</title>
      <link href="/%E8%AF%BB%E6%87%82%E8%B4%A2%E6%8A%A5/"/>
      <url>/%E8%AF%BB%E6%87%82%E8%B4%A2%E6%8A%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="1-èµ„äº§è´Ÿå€ºè¡¨"><a href="#1-èµ„äº§è´Ÿå€ºè¡¨" class="headerlink" title="1 èµ„äº§è´Ÿå€ºè¡¨"></a>1 èµ„äº§è´Ÿå€ºè¡¨</h1><h2 id="1-1-èµ„äº§è´Ÿå€ºè¡¨-åˆ†ç±»"><a href="#1-1-èµ„äº§è´Ÿå€ºè¡¨-åˆ†ç±»" class="headerlink" title="1.1 èµ„äº§è´Ÿå€ºè¡¨ åˆ†ç±»"></a>1.1 èµ„äº§è´Ÿå€ºè¡¨ åˆ†ç±»</h2><p>ä¼ä¸šéœ€è¦åšä¸‰å¼ æŠ¥è¡¨ï¼Œåˆ†åˆ«æ˜¯</p><ul><li>èµ„äº§è´Ÿå€ºè¡¨</li><li>åˆ©æ¶¦è¡¨</li><li>ç°é‡‘æµ</li></ul><h2 id="1-2-è´¢åŠ¡æŠ¥è¡¨æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ"><a href="#1-2-è´¢åŠ¡æŠ¥è¡¨æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ" class="headerlink" title="1.2 è´¢åŠ¡æŠ¥è¡¨æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ"></a>1.2 è´¢åŠ¡æŠ¥è¡¨æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ</h2><p>ä¼ä¸šä»äº‹çš„ç»è¥æ´»åŠ¨çš„ç§ç±»æœ‰ï¼š</p><ul><li>ç»è¥æ´»åŠ¨</li></ul><p>æ¯”å¦‚ä¸€ä¸ªä¼ä¸šéœ€è¦ç”Ÿäº§äº§å“ã€é”€å”®äº§å“ã€å›æ”¶è´§æ¬¾ç­‰ç­‰</p><ul><li>æŠ•èµ„æ´»åŠ¨</li></ul><p>å¦‚æœä¸€ä¸ªä¼ä¸šæƒ³è¦åˆ°ä¸€ä¸ªæ–°çš„åœ°åŒºå»å¼€å±•ä¸šåŠ¡ï¼Œæƒ³è¿›å…¥ä¸€ä¸ªæ–°çš„ä¸šåŠ¡é¢†åŸŸï¼Œæˆ–è€…æƒ³è®¾è®¡ç”Ÿäº§ä¸€ä¸ªæ–°çš„äº§å“</p><ul><li>èèµ„æ´»åŠ¨</li></ul><p>åœ¨ç»è¥å’ŒæŠ•èµ„çš„è¿‡ç¨‹ä¸­ï¼Œå½“ç¼ºé’±äº†çš„æ—¶å€™ï¼Œéœ€è¦å»é“¶è¡Œå€Ÿé’±ï¼Œæˆ–è€…æ‰¾åˆ«äººæ¥æŠ•èµ„è‡ªå·±</p><p>å¯ä»¥è¿™æ ·å­è¯´ï¼Œä¼ä¸šä¸€è¾ˆå­åªåšè¿™ä¸‰ä»¶äº‹ï¼Œç»è¥ï¼ŒæŠ•èµ„ä»¥åŠèèµ„ã€‚åœ¨è¿™æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ— è®ºå…¶å¤„åœ¨ä»€ä¹ˆå‘å±•é˜¶æ®µï¼Œå…¶æ—¥å¸¸ç»æµæ´»åŠ¨éƒ½å¯ä»¥æŠ½è±¡æˆè¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼Œä»ç°é‡‘å¼€å§‹ï¼Œè½¬äº†ä¸€åœˆå†æåˆ°ç°é‡‘çš„è¿‡ç¨‹ã€‚</p><h2 id="1-3-èµ„äº§è´Ÿå€ºè¡¨è¯¦è§£"><a href="#1-3-èµ„äº§è´Ÿå€ºè¡¨è¯¦è§£" class="headerlink" title="1.3 èµ„äº§è´Ÿå€ºè¡¨è¯¦è§£"></a>1.3 èµ„äº§è´Ÿå€ºè¡¨è¯¦è§£</h2><p>åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š </p><ul><li>èµ„äº§ - æµåŠ¨èµ„äº§</li><li>èµ„äº§ - éæµåŠ¨èµ„äº§</li><li>è´Ÿå€º - æµåŠ¨è´Ÿå€º</li><li>è´Ÿå€º - éæµåŠ¨è´Ÿå€º</li><li>è‚¡ä¸œæƒç›Š</li></ul><h3 id="1-3-1-æµåŠ¨èµ„äº§"><a href="#1-3-1-æµåŠ¨èµ„äº§" class="headerlink" title="1.3.1 æµåŠ¨èµ„äº§"></a>1.3.1 æµåŠ¨èµ„äº§</h3><ul><li>è´§å¸èµ„é‡‘</li></ul><p>æ”¾åœ¨é“¶è¡Œé‡Œé¢æˆ–è€…æ”¾åœ¨å…¬å¸é‡Œé¢çš„é’±ã€‚åŒ…æ‹¬åº“å­˜ç°é‡‘ï¼Œé“¶è¡Œè´·æ¬¾ï¼Œå’Œå…¶ä»–è´§å¸èµ„é‡‘ä¸‰ä¸ªé¡¹ç›®çš„æœŸæœ«ä½™é¢ã€‚</p><ul><li>åº”æ”¶è´¦æ¬¾</li></ul><p>é”€å”®äº§å“çš„æ—¶å€™ï¼Œå‘ç”Ÿçš„å–æ‰äº§å“ä½†æ˜¯æ”¶ä¸åˆ°é’±çš„æƒ…å†µã€‚<br>å³éœ€è¦æ ¸ç®—çš„ä¼ä¸šå› ä¸ºé”€å”®å•†å“ã€æä¾›åŠ³åŠ¡ç­‰ç»è¥æ´»åŠ¨åº”æ”¶å–çš„æ¬¾é¡¹ã€‚</p><ul><li>å…¶ä»–åº”æ”¶æ¬¾</li></ul><p>ä¼ä¸šé™¤äº†å­˜å‡ºä¿è¯é‡‘ï¼ˆç§Ÿæˆ¿å­æ—¶äº¤ä»˜çš„æœªæ¥å°†é€€å›çš„ä¿è¯é‡‘ã€æŠ¼é‡‘ç­‰ï¼‰ã€ä¹°å…¥è¿”å”®çš„é‡‘èèµ„äº§ã€åº”æ”¶ç¥¨æ®ã€åº”æ”¶è´¦æ¬¾ã€é¢„ä»˜è´¦æ¬¾ã€åº”æ”¶è‚¡åˆ©ã€åº”æ”¶åˆ©æ¯ã€åº”æ”¶ä»£ä½è¿½å¿æ¬¾ã€åº”æ”¶åˆ†ä¿è´¦æ¬¾ã€åº”æ”¶åˆ†åŒ…åˆåŒå‡†å¤‡é‡‘ã€é•¿æœŸåº”æ”¶æ¬¾ç­‰ä»¥å¤–çš„å…¶ä»–å„ç§åº”æ”¶åŠæš‚ä»˜æ¬¾é¡¹ã€‚</p><ul><li>é¢„ä»˜è´¦æ¬¾</li></ul><p>åŸºæœ¬å‘ç”Ÿåœ¨è´§å“å¾ˆç´§ç¼ºï¼Œå¸¦äº†ä¸€ç§å‘å–æ–¹æ”¶æ¬¾çš„æƒåˆ©ã€‚é¢„ä»˜è´¦æ¬¾ä¹Ÿæ˜¯ä¸€ç§èµ„äº§ã€‚</p><ul><li>å­˜è´§</li></ul><p>ç”Ÿäº§äº§å“æ‰€éœ€çš„åŸææ–™ï¼Œç”Ÿäº§å‡ºæ¥çš„äº§æˆå“ï¼Œä»¥åŠå°šä¸”å¤„åœ¨ç”Ÿäº§è¿‡ç¨‹ä¸­çš„æ²¡æœ‰å®Œæˆçš„åœ¨äº§å“</p><ul><li>å¾…æ‘Šè´¹ç”¨</li></ul><p>èµ„äº§ vs è´¹ç”¨ã€‚ å¦‚æœè¿™ç¬”é’±å¯ä»¥æ¢æ¥å¯¹å°†æ¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå°±æ˜¯èµ„äº§ã€‚å¦‚æœç”»å®Œå°±å®Œäº†ï¼Œå°±æ˜¯è´¹ç”¨ã€‚</p><p>å„é¡¹æµåŠ¨èµ„äº§åœ¨èµ„äº§è´Ÿå€ºè¡¨ä¸­æ˜¯æŒ‰ç…§<strong>å„è‡ªè½¬æ¢ä¸ºç°é‡‘çš„é€Ÿåº¦</strong>æ¥æ’åºçš„ã€‚</p><h3 id="1-3-2-éæµåŠ¨èµ„äº§"><a href="#1-3-2-éæµåŠ¨èµ„äº§" class="headerlink" title="1.3.2 éæµåŠ¨èµ„äº§"></a>1.3.2 éæµåŠ¨èµ„äº§</h3><p>è¿”å›ç°é‡‘çš„æ—¶é—´é•¿åº¦ï¼Œæ— æ³•åœ¨ä¸€ä¸ªå¾ªç¯å†…å®Œæˆçš„ã€‚</p><ul><li>é•¿æœŸæŠ•èµ„</li></ul><p>æŒ‡ä¸æ»¡è¶³çŸ­æœŸæŠ•èµ„æ¡ä»¶çš„æŠ•èµ„ï¼Œå³ä¸å‡†å¤‡åœ¨ä¸€å¹´æˆ–é•¿äºä¸€å¹´çš„ç»è¥å‘¨æœŸä¹‹å†…è½¬å˜ä¸ºç°é‡‘çš„æŠ•èµ„ã€‚å¯ä»¥åˆ†ä¸ºé•¿æœŸè‚¡ç¥¨æŠ•èµ„ï¼Œé•¿æœŸå€ºåˆ¸æŠ•èµ„ï¼Œå…¶ä»–é•¿æœŸæŠ•èµ„</p><ul><li>å›ºå®šèµ„äº§</li></ul><p>æŒ‡åŒæ—¶å…·æœ‰ä»¥ä¸‹ç‰¹å¾çš„æœ‰å½¢èµ„äº§ï¼š ï¼ˆ1ï¼‰ä¸ºç”Ÿäº§å•†å“ã€æä¾›åŠ³åŠ¡ã€å‡ºç§Ÿæˆ–ç»è¥ç®¡ç†è€ŒæŒæœ‰çš„ï¼› ï¼ˆ2ï¼‰ä½¿ç”¨å¯¿å‘½è¶…è¿‡äº†ä¸€ä¸ªä¼šè®¡å¹´åº¦</p><ul><li>æ— å½¢èµ„äº§</li></ul><p>ä¸“åˆ©æƒï¼Œç‰ˆæƒç­‰ï¼Œè¿˜æœ‰åœŸåœ°ä½¿ç”¨æƒ</p><p>æŒ‡ä¼ä¸šæ‹¥æœ‰æˆ–è€…æ§åˆ¶çš„æ²¡æœ‰å®ç‰©å½¢æ€çš„å¯è¾¨è®¤çš„éè´§å¸æ€§çš„èµ„äº§ã€‚åŒ…æ‹¬ä¸“åˆ©æƒã€éä¸“åˆ©æŠ€æœ¯ã€å•†æ ‡æƒã€è‘—ä½œæƒã€åœŸåœ°ä½¿ç”¨æƒç­‰ã€‚</p><h3 id="1-3-3-èµ„äº§-gt-ä¼ä¸š"><a href="#1-3-3-èµ„äº§-gt-ä¼ä¸š" class="headerlink" title="1.3.3 èµ„äº§ -&gt; ä¼ä¸š"></a>1.3.3 èµ„äº§ -&gt; ä¼ä¸š</h3><p> å›ºå®šèµ„äº§å¤šï¼Œåº”æ”¶è´¦æ¬¾å¤šï¼Œå¯èƒ½æ˜¯æœ‰ç»è¥å‹åŠ›çš„ä¼ ç»Ÿä¼ä¸š</p><p> ç”Ÿç‰©èµ„äº§ï¼ŒæŒ‡æœ‰ç”Ÿå‘½çš„åŠ¨ç‰©å’Œæ¤ç‰©ï¼Œç”Ÿç‰©èµ„äº§åˆ†ä¸ºæ¶ˆè€—æ€§ç”Ÿç‰©èµ„äº§ï¼Œç”Ÿäº§æ€§ç”Ÿç‰©èµ„äº§å’Œå…¬ç›Šæ€§ç”Ÿç‰©èµ„äº§ã€‚</p><p> èµ„äº§çš„ç»“æ„ä¼šå‘Šè¯‰ä½ è¿™å®¶å…¬å¸æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ </p><h3 id="1-3-4-èµ„äº§å¦‚ä½•è®¡ä»·ï¼Ÿ"><a href="#1-3-4-èµ„äº§å¦‚ä½•è®¡ä»·ï¼Ÿ" class="headerlink" title="1.3.4 èµ„äº§å¦‚ä½•è®¡ä»·ï¼Ÿ"></a>1.3.4 èµ„äº§å¦‚ä½•è®¡ä»·ï¼Ÿ</h3><p> ä¼šè®¡ä»¬ä¼šç”¨åŸæ¥è´­ä¹°çš„èµ„äº§ä»·æ ¼å½“åšè¿™ä¸ªèµ„äº§çš„ä»·å€¼ã€‚</p><blockquote><p>å†å²æˆæœ¬</p></blockquote><blockquote><p>èµ„äº§åœ¨å…¶å–å¾—æ—¶ä¸ºå…¶æ‰€æ”¯ä»˜çš„ç°é‡‘æˆ–ç°é‡‘ç­‰ä»·ç‰©çš„é‡‘é¢ã€‚è´Ÿå€ºåœ¨æ­£å¸¸ç»è¥æ´»åŠ¨ä¸­ä¸ºäº¤æ¢è€Œæ”¶åˆ°æˆ–ä¸ºå¿ä»˜å°†è¦æ”¯ä»˜çš„ç°é‡‘æˆ–ç°é‡‘ç­‰ä»·ç‰©çš„é‡‘é¢ã€‚</p></blockquote><blockquote><p>Bug: å†å²æˆæœ¬æ— æ³•ä½“ç°å‡ºèµ„äº§çš„å˜åŒ–ã€‚æ•…è§£å†³æ–¹æ¡ˆä¸ºï¼š å¦‚æœèµ„äº§ä»·å€¼å‡å°äº†ï¼Œå°±æŠŠå‡å€¼è®°ä¸‹æ¥ã€‚å› ä¸ºèµ„äº§è®¡ä»·ä½“ç³»æ˜¯ä¸€ä¸ªå†å²æˆæœ¬çš„ä½“ç³»ï¼Œä¸€å®šè¦åœ¨å†å²æˆæœ¬çš„åŸºç¡€ä¸Šæ‰£é™¤è¿™ä¸ªèµ„äº§çš„å‡å€¼ã€‚ </p></blockquote><ul><li>å†å²æˆæœ¬çš„å«ä¹‰</li></ul><ol><li>åªæœ‰èŠ±äº†çš„é’±æ‰èƒ½è®°åœ¨è´¦ä¸Šã€‚</li><li>åœ¨å†å²æˆæœ¬çš„è®¡ä»·ä½“ç³»ä¸‹ï¼Œå¢åŠ èµ„äº§ä»·å€¼çš„å”¯ä¸€é€”å¾„æ˜¯å‘ç”Ÿä¸€ä¸ªæ–°çš„äº¤æ˜“ã€‚</li></ol><h3 id="1-3-5-è´Ÿå€º"><a href="#1-3-5-è´Ÿå€º" class="headerlink" title="1.3.5 è´Ÿå€º"></a>1.3.5 è´Ÿå€º</h3><blockquote><p>è´Ÿå€ºï¼šç”±äºè¿‡å»çš„äº¤æ˜“æˆ–äº‹åŠ¡æ‰€å¼•èµ·çš„å…¬å¸ä¼ä¸šçš„ç°æœ‰å€ºåŠ¡ï¼Œè¿™ç§å€ºåŠ¡éœ€è¦ä¼ä¸šåœ¨å°†æ¥ä»¥è½¬ç§»èµ„äº§æˆ–æä¾›åŠ³åŠ¡åŠ ä»¥æ¸…å¿ï¼Œä»è€Œå¼•èµ·æœªæ¥ç»æµåˆ©ç›Šçš„æµå‡ºã€‚<br>å…¶ä»–ï¼šæ˜¯ä¸ºäº†ç®€åŒ–ï¼Œæ¬ å‘˜å·¥çš„å·¥èµ„ï¼Œå› ä¸ºæ˜¯æœˆåº•å‘é’±ï¼› æ¬ ç¨åŠ¡å±€çš„é’±ã€‚è¿™äº›éƒ½æ˜¯æµåŠ¨è´Ÿå€ºã€‚éæµåŠ¨è´Ÿå€ºï¼š åº”ä»˜å€ºåˆ¸ã€‚</p></blockquote><blockquote><p>åº”ä»˜å€ºåˆ¸ï¼šä¼ä¸šä¸ºäº†ç­¹é›†èµ„é‡‘è€Œå¯¹å¤–å‘è¡Œçš„æœŸé™åœ¨ä¸€å¹´ä»¥ä¸Šçš„é•¿æœŸå€Ÿæ¬¾æ€§è´¨çš„ä¹¦é¢è¯æ˜ï¼Œçº¦å®šåœ¨ä¸€å®šæœŸé™å†…è¿˜æœ¬ä»˜æ¯çš„ä¸€ç§ä¹¦é¢æ‰¿è¯ºã€‚</p></blockquote><h3 id="1-3-6-è‚¡ä¸œæƒç›Š"><a href="#1-3-6-è‚¡ä¸œæƒç›Š" class="headerlink" title="1.3.6 è‚¡ä¸œæƒç›Š"></a>1.3.6 è‚¡ä¸œæƒç›Š</h3><blockquote><p>è‚¡ä¸œæƒç›Šï¼š å…¬å¸æ€»èµ„äº§ä¸­æ‰£é™¤è´Ÿå€ºå‰©ä½™çš„éƒ¨åˆ†ï¼Œä¹Ÿæˆä¸ºå‡€èµ„äº§ï¼Œåæ˜ äº†å…¬å¸çš„è‡ªæœ‰èµ„æœ¬ã€‚</p></blockquote><blockquote><p>è‚¡æœ¬ï¼š è‚¡æœ¬é‡‘é¢ç›¸å½“äºå…¬å¸çš„æ³¨å†Œèµ„æœ¬ã€‚è‚¡æœ¬çš„æ€»é¢ä½“ç°äº†è¿™ä¸ªå…¬å¸å¯¹å¤–æ‰¿æ‹…æ³•å¾‹è´£ä»»çš„ä¸Šé™ã€‚è‚¡æœ¬çš„ç»„æˆåˆ™ç¡®å®šäº†å¤šä¸ªè‚¡ä¸œä¹‹é—´çš„æƒåˆ©ä¹‰åŠ¡å…³ç³»ã€‚</p></blockquote><blockquote><p>èµ„æœ¬å…¬ç§¯ï¼š ä¼ä¸šæ”¶åˆ°çš„æŠ•èµ„è€…çš„è¶…å‡ºå…¶åœ¨ä¼ä¸šæ³¨å†Œèµ„æœ¬æ‰€å ä»½é¢ï¼Œä»¥åŠç›´æ¥è®¡å…¥æ‰€æœ‰è€…æƒç›Šçš„åˆ©å¾—å’ŒæŸå¤±ç­‰ã€‚</p></blockquote><blockquote><p>è‚¡ä¸œæƒç›Š + è´Ÿå€º = èµ„äº§</p></blockquote><p>æ³¨æ„èµ„äº§è´Ÿå€ºè¡¨æ˜¯ä¸€ä¸ªæ—¶é—´ç‚¹çš„æ¦‚å¿µï¼Œæ˜¯çŠ¶æ€ï¼Œä¸æ˜¯è¿‡ç¨‹ã€‚</p><h1 id="2-åˆ©æ¶¦è¡¨"><a href="#2-åˆ©æ¶¦è¡¨" class="headerlink" title="2. åˆ©æ¶¦è¡¨"></a>2. åˆ©æ¶¦è¡¨</h1><p>èµ„äº§è´Ÿå€ºè¡¨ï¼š å¯ä»¥çœ‹åˆ°æŠ•å…¥çš„æœ¬é‡‘æ˜¯å¦å¾—åˆ°ä¿éšœã€‚åˆ©æ¶¦è¡¨ï¼Œåˆ™èƒ½å¾—çŸ¥æŠ•å…¥çš„æœ¬é‡‘æœ‰æ²¡æœ‰èµšé’±ã€‚</p><p>æ¯›åˆ© = è¥ä¸šæ”¶å…¥ - è¥ä¸šæˆæœ¬</p><h2 id="2-1-ç¨ç§"><a href="#2-1-ç¨ç§" class="headerlink" title="2.1 ç¨ç§"></a>2.1 ç¨ç§</h2><ul><li>è¥ä¸šç¨</li></ul><p>å›½å®¶å¯¹å·¥å•†è¥åˆ©äº‹ä¸šæŒ‰ç…§è¥ä¸šé¢å¾æ”¶çš„ç¨</p><ul><li>è¥ä¸šç¨é‡‘åŠé™„åŠ </li></ul><p>ä¼ä¸šç»è¥æ´»åŠ¨åº”è´Ÿæ‹…çš„ç›¸å…³ç¨è´¹ï¼ŒåŒ…æ‹¬è¥ä¸šç¨ã€æ¶ˆè´¹ç¨ã€åŸå¸‚ç»´æŠ¤å»ºè®¾ç¨ã€èµ„æºç¨ã€æ•™è‚²è´¹é™„åŠ ç­‰ã€‚ä¸æ˜¯æ‰€å¾—ç¨ï¼Œæ˜¯æµè½¬ç¨ï¼Œåªè¦æ˜¯æœ‰ä¸šåŠ¡çš„ä¼ä¸šå°±å¾—ç¼´çº³æµè½¬ç¨ã€‚</p><ul><li>å¸¸è§çš„æµè½¬ç¨ï¼š è¥ä¸šç¨ï¼ˆä»·å†…ç¨ï¼‰ + å¢å€¼ç¨ï¼ˆä»·å¤–ç¨ï¼‰</li><li>ä»·å†…ç¨ï¼š ç¨é‡‘åŒ…å«åœ¨å•†å“ä»·å€¼æˆ–ä»·æ ¼ä¹‹å†…</li><li>ä»·å¤–ç¨ï¼š ç¨æ¬¾ä¸åŒ…æ‹¬åœ¨ä»·æ ¼å†…</li><li>å¢å€¼ç¨ï¼š ä¸€ç§é”€å”®ç¨ï¼Œæ˜¯æ¶ˆè´¹è€…æ‰¿æ‹…çš„ç¨è´¹ï¼Œå±äºç´¯é€€ç¨ï¼Œæ˜¯åŸºäºå•†å“æˆ–æœåŠ¡çš„å¢å€¼è€Œå¢ç¨çš„ä¸€ç§é—´æ¥ç¨</li></ul><h2 id="2-2-å…¶ä»–é¡¹ç›®"><a href="#2-2-å…¶ä»–é¡¹ç›®" class="headerlink" title="2.2 å…¶ä»–é¡¹ç›®"></a>2.2 å…¶ä»–é¡¹ç›®</h2><ul><li>è¡¥è´´æ”¶å…¥<br>ä¸­å›½ç‰¹è‰²ï¼š æ”¿åºœä¸ºä¸€äº›ä¼ä¸šæä¾›çš„è¡¥è´´ã€‚</li></ul><h2 id="2-3-åˆ©æ¶¦è¡¨çš„åˆ†æ"><a href="#2-3-åˆ©æ¶¦è¡¨çš„åˆ†æ" class="headerlink" title="2.3 åˆ©æ¶¦è¡¨çš„åˆ†æ"></a>2.3 åˆ©æ¶¦è¡¨çš„åˆ†æ</h2><p>å‘Šè¯‰äº†æ˜¯å¦èµšé’±ï¼Œåœ¨å“ªäº›æ–¹é¢èµšé’±çš„åŸºæœ¬ä¿¡æ¯ã€‚åŒæ—¶å› ä¸ºå°†å¯æŒç»­çš„å’Œä¸å¯æŒç»­çš„è¥ä¸šæ”¶å…¥åˆ†å¼€ï¼Œå°±å¯ä»¥å¸®åŠ©ä¼ä¸šæ¨æ–­å‡ºè‡ªå·±æœªæ¥ä¸€æ®µæ—¶é—´ä»¥å†…çš„æ”¶ç›Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reading </tag>
            
            <tag> finance </tag>
            
            <tag> stock </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
